<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">104262</article-id>
<article-id pub-id-type="doi">10.7554/eLife.104262</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.104262.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A behavioral architecture for realistic simulations of <italic>Drosophila</italic> larva locomotion and foraging</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1033-5387</contrib-id>
<name>
<surname>Sakagiannis</surname>
<given-names>Panagiotis</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
    <xref ref-type="author-notes" rid="n1">†</xref>
<email>p.sakagiannis@uni-koeln.de</email>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7871-1887</contrib-id>
<name>
<surname>Jürgensen</surname>
<given-names>Anna-Maria</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
    <xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4133-6419</contrib-id>
<name>
<surname>Nawrot</surname>
<given-names>Martin Paul</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
    <xref ref-type="author-notes" rid="n1">†</xref>
<email>mnawrot@uni-koeln.de</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00rcxh774</institution-id><institution>Computational Systems Neuroscience, University of Cologne</institution></institution-wrap>, <city>Cologne</city>, <country country="DE">Germany</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Cardona</surname>
<given-names>Albert</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Cambridge</institution>
</institution-wrap>
<city>Cambridge</city>
<country>United Kingdom</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Cardona</surname>
<given-names>Albert</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Cambridge</institution>
</institution-wrap>
<city>Cambridge</city>
<country>United Kingdom</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
    <fn id="n1" fn-type="present-address"><label>†</label><p>Present address: Computational Systems Neuroscience, Institute of Zoology, University of Cologne, Cologne, Germany</p></fn>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-04-10">
<day>10</day>
<month>04</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP104262</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-12-18">
<day>18</day>
<month>12</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-10-09">
<day>09</day>
<month>10</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2021.07.07.451470"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Sakagiannis et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Sakagiannis et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-104262-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>The <italic>Drosophila</italic> larva is extensively used as model organism in neuroethological studies where precise behavioral tracking enables the statistical analysis of individual and population-level behavioral metrics that can inform mathematical models of larval behavior. Here, we propose a hierarchical model architecture comprising three layers to facilitate modular model construction, closed-loop simulations, and direct comparisons between empirical and simulated data. At the basic layer, the autonomous locomotory model is capable of performing exploration. Based on novel kinematic analyses our model features intermittent forward crawling that is phasically coupled to lateral bending. At the second layer, navigation is achieved via active sensing in a simulated environment and top-down modulation of locomotion. At the top layer, behavioral adaptation entails associative learning. We evaluate virtual larval behavior across agent-based simulations of autonomous free exploration, chemotaxis, and odor preference testing. Our behavioral architecture is ideally suited for the modular combination of neuromechanical, neural or mere statistical model components, facilitating their evaluation, comparison, extension and integration into multifunctional control architectures.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Python code used for modeling and simulations now published as the larvaworld python package;
Theoretical background,Methods elaborated;
Figure 3 added;
Appendix 1,2 added;
Figures 1,2,4,5,6 revised;</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p><italic>Drosophila</italic> larvae express a fairly tractable behavioral repertoire that is consistent across the 4-5 days of the larval life stage (<xref ref-type="bibr" rid="c1">Almeida-Carvalho et al., 2017</xref>). Most of the larval lifetime is dedicated to foraging for suitable nutrients while avoiding threats via stereotyped evasive behaviors. Behavioral control is achieved via neural circuits conserved throughout development (<xref ref-type="bibr" rid="c19">Gerhard et al., 2017</xref>), that span the entire tripartite CNS consisting of the brain, the subesophageal zone (SEZ) and the ventral nerve cord (VNC), making the larva a formidable system for studying control, execution and adaptation of behavior (<xref ref-type="bibr" rid="c99">Zarin et al., 2019</xref>; <xref ref-type="bibr" rid="c27">Jovanic, 2020</xref>; <xref ref-type="bibr" rid="c14">Eschbach and Zlatic, 2020</xref>; <xref ref-type="bibr" rid="c26">Imambocus et al., 2022</xref>). After reaching critical mass for pupation, homeostatic signals switch behavior towards food aversion, hypermobility and collaborative burrowing (<xref ref-type="bibr" rid="c95">Wu et al., 2003</xref>), terminating the feeding state and leading to pupation and metamorphosis.</p>
    <p>High resolution methods for behavioral tracking (<xref ref-type="bibr" rid="c50">Ohyama et al., 2013</xref>; <xref ref-type="bibr" rid="c61">Risse et al., 2017</xref>; <xref ref-type="bibr" rid="c77">Schumann and Triphan, 2020</xref>; <xref ref-type="bibr" rid="c84">Tadres and Louis, 2020</xref>; <xref ref-type="bibr" rid="c86">Thane et al., 2023</xref>; <xref ref-type="bibr" rid="c37">Laurent et al., 2024</xref>), now routinely used in neuroethological experiments, have revealed detailed insight in the organisation of larval foraging behavior. In the absence of food resources, larvae engage in free exploration to locate food patches (<xref ref-type="bibr" rid="c79">Sims et al., 2019</xref>) with a characteristic alternation of locomotory activity and brief pauses (<xref ref-type="bibr" rid="c64">Sakagiannis et al., 2020</xref>), a property also reported for adult fly behavior (<xref ref-type="bibr" rid="c89">Ueno et al., 2012</xref>; <xref ref-type="bibr" rid="c59">Reynolds et al., 2015</xref>). Food consumption involves repetitive feeding motion and digging into the substrate (<xref ref-type="bibr" rid="c32">Kim et al., 2017</xref>). Statistical regularities that govern foraging behavior have been un-veiled by analysis at the microscale of body kinematics and at the macroscale of larva trajectories (<xref ref-type="bibr" rid="c10">Denisov et al., 2013</xref>; <xref ref-type="bibr" rid="c61">Risse et al., 2017</xref>; <xref ref-type="bibr" rid="c31">Karagyozov et al., 2018</xref>). Locomotion combines the basic sensorimotor primitives of crawling and turning, and has been in the main focus of recent studies (<xref ref-type="bibr" rid="c24">Heckscher et al., 2012</xref>; <xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>; <xref ref-type="bibr" rid="c79">Sims et al., 2019</xref>), whereas studies of feeding behavior remain scarce (<xref ref-type="bibr" rid="c63">Ruiz-Dubreuil et al., 1996</xref>). Both, crawling and feeding consist of recurring sensorimotor cycles controlled by central pattern generating circuits (<xref ref-type="bibr" rid="c24">Heckscher et al., 2012</xref>; <xref ref-type="bibr" rid="c42">Mantziaris et al., 2020</xref>; <xref ref-type="bibr" rid="c47">Miroschnikow et al., 2018a</xref>).</p>
    <p>Salient olfactory cues can trigger appetitive or aversive chemotaxis, during which larvae navigate up or down a chemical gradient (<xref ref-type="bibr" rid="c22">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="c80">Slater et al., 2015</xref>; <xref ref-type="bibr" rid="c68">Schleyer et al., 2015a</xref>; <xref ref-type="bibr" rid="c33">Klein et al., 2017</xref>). During appetitive chemotaxis, the detection of minor concentration changes during lateral bending causes a directional bias in the turning movement, establishing a mechanism of active sensing (<xref ref-type="bibr" rid="c21">Gomez-Marin and Louis, 2012</xref>; <xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>; <xref ref-type="bibr" rid="c87">Thane et al., 2019</xref>). Encounters with novel odorants in the presence of a food reward or a negative reinforcement such as the bitter taste substance quinine can induce olfactory learning, enabling short- and long-term behavioral adaptations (<xref ref-type="bibr" rid="c70">Schleyer et al., 2011</xref>; <xref ref-type="bibr" rid="c69">Schleyer et al., 2015b</xref>; <xref ref-type="bibr" rid="c17">Gerber and Stocker, 2007</xref>; <xref ref-type="bibr" rid="c11">Diegelmann et al., 2013</xref>; <xref ref-type="bibr" rid="c93">Widmann et al., 2018</xref>; <xref ref-type="bibr" rid="c91">Weiglein et al., 2019</xref>; <xref ref-type="bibr" rid="c29">Jürgensen et al., 2024</xref>). For quantification of choice behavior, widely-used standard group assays for behavioral preference testing have been established (<xref ref-type="bibr" rid="c17">Gerber and Stocker, 2007</xref>; <xref ref-type="bibr" rid="c18">Gerber et al., 2014</xref>; <xref ref-type="bibr" rid="c68">Schleyer et al., 2015a</xref>; <xref ref-type="bibr" rid="c69">Schleyer et al., 2015b</xref>; <xref ref-type="bibr" rid="c70">Schleyer et al., 2011</xref>).</p>
<p>The routine access to detailed behavioral data, and the broad approaches to neuroethological experiments makes the <italic>Drosophila</italic> larva an ideal model system for computational modeling studies on behavioral control principles. Existing generative models typically aim at specific aspects of larval behavior and can vary widely in model type and abstraction level, ranging from basic neuromechanics to the abstract mathematical description. We therefore propose the concept of the behavioral architecture, a three-layered hierarchical and modular framework, nested from behavioral primitives to high-level function, to integrate models of diverse types and different levels of abstraction (<xref rid="fig1" ref-type="fig">Figure 1<italic>A</italic></xref>). At the basic layer we establish a refined coupled-oscillator model for larval locomotion capable of autonomous exploratory behavior. To this end we provide a detailed analysis of larval tracking data from experiments of free exploration. Introducing sensory modulation at the second layer allows us to reproduce several experimental findings of appetitive chemotaxis. The combination with a biologically realistic spiking neural network model for associative learning at the adaptive layer reproduces empirical population-level learning scores across a multiple trial training protocol. The architecture allows for agent-based, potentially closed-loop, simulations of virtual larvae in virtual environments and generates simulated data at the level of the experimentally observed behavior facilitating model calibration and evaluation.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Behavioral architecture for larva foraging.</title>
<p><bold>A:</bold> In the trilayer architecture the bottom layer consists of three basic sensorimotor effectors that constitute the locomotory model. The intermediate layer features innate reactive behavior in response to sensory input that reflects changes in the environment. The top layer allows for behavioral adaptation through experience. Framed areas denote more complex behaviors that require subsumption of subordinate behaviors. <bold>B:</bold> Suggested implementation of basic behavioral modules at the bottom layer. Initiation or cessation of a behavior is controlled by the intermittency module. The turner and crawler module are phasically coupled during forward locomotion, while crawling and feeding are implemented as mutually exclusive sensorimotor primitives.</p></caption>
<graphic xlink:href="451470v2_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2">
<title>Model</title>
<sec id="s2a">
<title>Behavioral architecture</title>
<p>Larval behavior is hierarchically structured, i.e. sensorimotor primitives such as crawling, bending and feeding can be integrated into more complex behaviors such as exploration, taxis or exploitation. It has been proposed that the hierarchy of animal behavior is reflected by the underlying neuroanatomy as a hierarchy of nested sensorimotor loops (<xref ref-type="bibr" rid="c55">Prescott et al., 1999</xref>; <xref ref-type="bibr" rid="c94">Wilson and Prescott, 2022</xref>; <xref ref-type="bibr" rid="c56">Prescott and Wilson, 2023</xref>). A functional modeling paradigm that exploits this idea regards the neural system as a layered control architecture (or subsumption architecture) (<xref ref-type="bibr" rid="c8">Brooks, 1986</xref>) where low-level stereotyped reflexive and repetitive behaviors are autonomously generated by localized peripheral motor circuitries, while multisynaptic loops involving more centralized neural circuits act as descending modulators on the local circuits in order to coordinate global and complex behavior. The central idea is that energy-efficient decentralized neural control is the rule, while higher centers are recruited only when more extensive integration is needed e.g. in order to react suitably to unexpected sensory stimulation. Furthermore, there are only limited degrees of freedom by which higher layers can influence local sensorimotor loops via descending pathways e.g. by starting or stopping, or by accelerating, decelerating or inverting their autonomous function (<xref ref-type="bibr" rid="c78">Sen et al., 2017</xref>; <xref ref-type="bibr" rid="c16">Feng et al., 2020</xref>; <xref ref-type="bibr" rid="c7">Bidaye et al., 2020</xref>). The complexity of inter-layer top-down modulation is thus predicted to be considerably lower than the complexity of signal integration within layers. Layered control architectures have been used mainly in behavior-based robotics (<xref ref-type="bibr" rid="c6">Bicho, 1999</xref>), allowing sequential calibration and modular integration of partial neuroscientific models under a common framework (<xref ref-type="bibr" rid="c8">Brooks, 1986</xref>; <xref ref-type="bibr" rid="c55">Prescott et al., 1999</xref>).</p>
<p>We here propose a three-layered behavioral architecture for <italic>Drosophila</italic> larva foraging as illustrated in <xref rid="fig1" ref-type="fig">Figure 1<italic>A</italic></xref>. The bottom layer consists of three basic behaviors: crawling, turning and feeding. Each is realized by a low-level local sensorimotor loop between motor effectors and sensory feedback. For exploration this involves proprioception and mechanoreception, for feeding it additionally involves gustatory input. Integration of these basic behaviors within the layer gives rise to composite behaviors. For example while exploration in stimulus-free conditions only entails crawling and turning, differences in the temporal microstructure between these two yield a spectrum from localized search to remote dispersal. The peripheral ventral nerve cord (VNC) circuits mediating exploration have been shown to be capable of autonomous, decentralised function without the need for any top-down regulation (<xref ref-type="bibr" rid="c79">Sims et al., 2019</xref>).</p>
<p>The intermediate layer introduces salient sensory stimulation of different modalities and therefore allows for reactive behavior in the face of presented risks and opportunities. Following the subsumption architecture paradigm, we only assume a single modulatory input from the intermediate to the bottom layer. This assumption is in line with the idea of pre-motor integration of signals from different sensory modalities into a final integrated descending modulatory pathway, which eventually affects behavior (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>; <xref ref-type="bibr" rid="c14">Eschbach and Zlatic, 2020</xref>). Modulation of exploratory behavior in the presence of salient stimulation enables coherent navigation along sensory gradients. In the present study we consider odor-driven chemotaxis as a process of active sensing in which the larva constantly samples the odor concentration during lateral bending motions, enabling odorscape navigation and odor source discovery. In an alternative application, we recently simulated larval behavior during active sensing in thermotaxis experiments across different <italic>Drosophila</italic> species (<xref ref-type="bibr" rid="c30">Kafle et al., 2024</xref>).</p>
    <p>Finally, at the top layer, associative learning biases the evaluation of recurring sensory stimuli and can modulate the innate valence of odors to allow for experience-dependent adaptation of navigation. Again, the modulatory top-down signal to the underlying layers is limited to the modulation of approach versus avoidance behavior, in line with the research on the mushroom body output signal in <italic>Drosophila</italic> (<xref ref-type="bibr" rid="c17">Gerber and Stocker, 2007</xref>; <xref ref-type="bibr" rid="c18">Gerber et al., 2014</xref>; <xref ref-type="bibr" rid="c68">Schleyer et al., 2015a</xref>; <xref ref-type="bibr" rid="c69">Schleyer et al., 2015b</xref>; <xref ref-type="bibr" rid="c70">Schleyer et al., 2011</xref>; <xref ref-type="bibr" rid="c52">Owald and Waddell, 2015</xref>).</p>
<p>The proposed behavioral architecture is naive to the level of model abstraction of the underlying neural mechanisms. Its role is to create a modular framework where diverse and potentially competing models can be positioned, integrated and tested in behavioral simulations. It is therefore justified to use simple generative models to bridge the gaps that have not yet been studied in detail until they can be substituted by more elaborate future versions. To ensure flexibility and compatibility, every module has a defined basic input and output regardless of the internal structure, complexity, level of abstraction and spatiotemporal scale of its possible instantiations. For the purpose of modeling under the behavioral architecture framework we provide the <italic>larvaworld</italic> python package available at <ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/larvaworld/">https://pypi.org/project/larvaworld/</ext-link>.</p>
</sec>
<sec id="s2b">
<title>Locomotory model</title>
<p>We propose a model for locomotion in the two-dimensional plane that defines the momentary body state by the instantaneous forward velocity <italic>v</italic> and angular velocity <italic>ω</italic> as generated through crawling and bending, respectively. Extending on previous models (see Discussion) we incorporate two new features based on our kinematic analysis of larval locomotion: (i) the peristaltic cycle phase dependent attenuation of angular motion, and (ii) the intermittent crawling as transitions between runs and pauses. We briefly describe the modular components of our model. A detailed mathematical description is provided in the Materials and Methods section. The complete pipeline for model calibration is described in <xref ref-type="app" rid="app2">Appendix 2</xref>.</p>
<p>We choose to simplify the larva to a two-segment body (<xref rid="fig2" ref-type="fig">Figure 2<italic>F</italic></xref>). This abstraction allows to describe the body state at any point in time by only three variables: (i) position of a selected spine midpoint (<xref ref-type="fig" rid="figA1_1">Appendix 1-Figure 1</xref>), (ii) absolute orientation of the front segment <italic>θ</italic>, and (iii) bending angle <italic>θ</italic><sub><italic>b</italic></sub> between the front and rear segments. This approach is in line with the common practice of quantifying larva bending via a single angle between one anterior and one posterior vector (<xref ref-type="bibr" rid="c22">Gomez-Marin et al., 2011</xref>; <xref ref-type="bibr" rid="c36">Lahiri et al., 2011</xref>; <xref ref-type="bibr" rid="c53">Paisios et al., 2017</xref>).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption>
<title>Kinematic analysis of a single Drosophila larva in locomotion.</title>
<p><bold>A:</bold> Individual larva trajectory tracking a posterior point along the midline of the animal . Trajectory color denotes the forward velocity <italic>v</italic> from 0 (red) to maximum (green). Inset focuses on a shorter track epoch analyzed in C and G. The full-length trajectory and the epoch in the inset are shown in Figure 2—video 1 and Figure 2—video 2 respectively. Dark green rectangle denotes the single stride described in B. <bold>B:</bold> Sketch of the single crawling stride indicated in A. The larva first stretches its head forward, anchors it to the substrate and then drags its body forward via peristaltic contraction. Scaled stride displacement <inline-formula><inline-graphic xlink:href="451470v2_inline43.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is defined as the resulting displacement <italic>d</italic> divided by the body-length <italic>l</italic>. <bold>C:</bold> Scaled forward velocity <italic>v</italic> during the 40 s track epoch selected in A (inset). Green and red markers denote the local maxima and minima used for stride annotation. Individual strides are tiled by vertical dashed lines. Successive strides constitute uninterrupted stridechains (white). Epochs that do not show any strides are annotated as crawl-pauses (gray). <bold>D:</bold> Scaled forward velocity <italic>v</italic> of head, midpoint and tail as a function of the stride cycle phase Φ. All detected strides have been interpolated to a stride oscillation cycle of period 2<italic>π</italic>. Solid lines denote the median, shaded areas the lower and upper quartiles across strides. <bold>E:</bold> Same trajectory as in (A) now tracking the head segment. Color denotes the absolute orientation angular velocity <italic>ω</italic> from 0 (red) to maximum (green). The full-length trajectory and the epoch in the inset are shown in Figure 2—video 1 and Figure 2—video 2 respectively. <bold>F:</bold> Definition of bending angle <italic>θ</italic><sub><italic>b</italic></sub> and orientation angle <italic>θ</italic> for the original 12-segment (blue) and the simplified 2-segment (red) larvae. <bold>G:</bold> Three angular parameters during the same track epoch shown in (C). Bending angle <italic>θ</italic><sub><italic>b</italic></sub>, bend and orientation angular velocities <italic>ω</italic><sub><italic>b</italic></sub>, <italic>ω</italic> are shown. Background shadings denote left and right turning bouts. For illustration purposes only turns resulting in a change of orientation angle Δ<italic>θ</italic> &gt; 20<sub>°</sub> are shown. <bold>H:</bold> Absolute orientation angular velocity <italic>ω</italic> during the stride cycle, as shown for <italic>v</italic> in (D).</p>
</caption>
<graphic xlink:href="451470v2_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Locomotion is achieved via forward crawling and lateral body bending. Crawling moves the midpoint along the orientation vector. Bending reorients the front segment by rotation around the midpoint. Forward displacement restores <italic>θ</italic><sub><italic>b</italic></sub> back to zero by gradually aligning the rear segment to the orientation axis. A demonstration of the bisegmental model simplification is shown in Video 4.</p>
    <p>Based on our empirical results (<xref rid="fig2" ref-type="fig">Figure 2</xref> and <xref rid="fig3" ref-type="fig">Figure 3</xref>), we propose a coupled oscillator model of locomotion that generates both, weathervaning and headcasts. To this end we implement an oscillatory process (crawler) that generates the forward-velocity <italic>v</italic> during subsequent stride cycles (<xref rid="fig1" ref-type="fig">Figure 1<italic>B</italic></xref>) where a tonic input <italic>I</italic><sub><italic>C</italic></sub> modulates crawling frequency <italic>f</italic><sub><italic>C</italic></sub> . A second oscillator (turner) generates alternating left-right bending as previously proposed by (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>) with oscillatory amplitude <italic>A</italic><sub><italic>T</italic></sub> . To incorporate the empirically observed crawl-bend interference, we couple the two oscillators by imposing a crawler-phase dependent suppression on <italic>A</italic><sub><italic>T</italic></sub> where the phase-dependent modulation is modelled as Gaussian function and fitted to the empirical data (red profile in <xref rid="fig3" ref-type="fig">Figure 3<italic>C</italic></xref>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Population-level analysis.</title>
<p><bold>A:</bold> Fourier analysis of the forward <italic>v</italic> (red) and angular <italic>ω</italic> (blue) velocity across 100 larvae. Inset shows the respective dominant frequencies within suitable ranges 1 ⩽ <italic>f</italic><sub><italic>C</italic></sub> ⩽ 2.5 and 0.1 ⩽ <italic>f</italic><sub><italic>T</italic></sub> ⩽ 0.8 for <italic>v</italic> and <italic>ω</italic>, respectively. Crawling exhibits a dominant frequency of around 1.4 while lateral bending has a slower more variable rhythm of around 0.4. <bold>B:</bold> Epoch-duration distribution. Dots describe the cumulative probability density over logarithmic bins for the length of stridechains and the duration of crawl-pauses pooled across the larva population. Lines indicate the distribution with the lowest Kolmogorov-Smirnov distance among the best-fitting power-law, exponential, log-normal and Levy distributions. Stridechain length and pause duration are best approximated by log-normal distributions. <bold>C-D</bold>: Crawl-bend interference. The stride cycle kinematics are depicted for a single individual. All detected strides have been interpolated into a 64-bin oscillation cycle of period 2<italic>π</italic>. <bold>C:</bold> Forward velocity of 5 points along the larva midline. Velocity is scaled to the larva body-length. <bold>D:</bold> Absolute angular velocity <italic>ω</italic> (blue) normalized by the average value <inline-formula><inline-graphic xlink:href="451470v2_inline44.gif" mime-subtype="gif" mimetype="image"/></inline-formula> computed during the pause epochs. Fitted Gaussian function (red) describes well the phase-dependent attenuation imposed on <italic>ω</italic> and is used for the implementation of the coupled-oscillator locomotory model. Solid lines denote the median, shaded areas the lower and upper quartiles. Vertical dashed lines denote the cycle phase where the respective velocity reaches its maximum value. Inset : Phase offset Δ<italic>ϕ</italic> between the peak phase of each midline point’s forward velocity <inline-formula><inline-graphic xlink:href="451470v2_inline45.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and the peak phase of angular velocity <inline-formula><inline-graphic xlink:href="451470v2_inline46.gif" mime-subtype="gif" mimetype="image"/></inline-formula> across a dataset of 100 tracked larvae. Notably, <italic>ω</italic> reaches its maximum just before the head forward velocity reaches its maximum.</p></caption>
<graphic xlink:href="451470v2_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To accommodate the intermittent behavior with alternating crawling runs and crawling pauses, we chose to implement a stochastic model approach where the number of strides per stridechain and the pause durations each follows a log-normal distribution fitted to the empirical data (<xref rid="fig3" ref-type="fig">Figure 3<italic>B</italic></xref>). For a demonstration of the locomotory model in different configurations see Video 1.</p>
<p>Under the constraints of the subsumption architecture paradigm the crawler and turner can be influenced by higher-order circuits in a limited number of ways. In the case of the crawler, frequency modulation and the initiation or cessation of the oscillation-cycle are the two available top-down modulations. Likewise for the turner, top-down modulation of the tonic input affects both, the frequency and the amplitude of oscillation.</p>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Kinematic analysis of larva locomotion</title>
<p>We start out with the kinematic analysis of experimental larva trajectories and body postures in order to infer and parameterize several aspects of larva locomotion that will inform our modeling approach. Using diverse metrics that capture spatial and temporal dynamics we specifically assess the oscillation of forward velocity during consecutive peristaltic strides and its influence on lateral bending, the less pronounced oscillation of angular velocity, the intermittent nature of crawling, and the inter-individual variability of a number of locomotion-related parameters across different larvae.</p>
<p>We analyzed the trajectory of each single larva by tracking the forward velocity <italic>v</italic> of a posterior midline point (<xref rid="fig2" ref-type="fig">Figure 2<italic>A</italic></xref>) and the head orientation angular velocity <italic>ω</italic> (<xref rid="fig2" ref-type="fig">Figure 2<italic>E</italic></xref>). The former illustrates that forward locomotion indeed consists of consecutive steps (strides) that are characterized by the alternation of increased (green) and decreased (red) values of <italic>v</italic>. The latter confirms that lateral bending occurs both, during crawl-runs (weathervaning) and during stationary crawl-pauses (headcasts). The individual trajectory depicted in <xref rid="fig2" ref-type="fig">Figure 2</xref> can be seen in full length in Figure 2—video 1, while the short epoch depicted in the inset is shown in Figure 2—video 2.</p>
<p>To characterize both types of oscillations we first perform a Fourier analysis of <italic>v</italic> and <italic>ω</italic> on each of 100 larva tracks (<xref rid="fig3" ref-type="fig">Figure 3<italic>A</italic></xref>). Across larvae we observe a robust peristaltic rhythm with a crawling frequency <italic>f</italic><sub><italic>C</italic></sub> normally distributed around 1.4 Hz in line with earlier results (<xref ref-type="bibr" rid="c24">Heckscher et al., 2012</xref>; <xref ref-type="bibr" rid="c42">Mantziaris et al., 2020</xref>; <xref ref-type="bibr" rid="c86">Thane et al., 2023</xref>). We also confirm previous reports that lateral bending manifests a slower, more variable rhythm <italic>f</italic><sub><italic>T</italic></sub> around 0.4 Hz (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>). Then we detect all strides performed by an individual animal and verify their stereotypical structure in terms of stride duration, resulting body displacement, and the phase-dependence of <italic>v</italic> (<xref rid="fig2" ref-type="fig">Figure 2<italic>D</italic></xref>).</p>
<p>In order to quantify the phase-dependence of angular motion we interpolate each detected stride into a 64-bin oscillation cycle of period 2<italic>π</italic>. The progression of forward velocity from head to tail during the peristaltic cycle is illustrated in <xref rid="fig3" ref-type="fig">Figure 3<italic>C</italic></xref> (top). To analyze the angular metrics during the peristaltic cycle we consider the absolute angular change ignoring the left or right direction of a turn. This analysis reveals a robust phase dependence of the angular velocity <italic>ω</italic> and acceleration <inline-formula><inline-graphic xlink:href="451470v2_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and of the bend angle <italic>θ</italic><sub><italic>b</italic></sub> (<xref rid="figA2_1" ref-type="fig">Appendix 2-Figure 1<italic>A</italic></xref>). Specifically, the angular velocity <italic>ω</italic> exhibits a smooth unimodal dependency on the stride period peaking during the early stride phase and just before the head forward velocity reaches its maximum (<xref rid="fig3" ref-type="fig">Figure 3<italic>C</italic></xref>). Nevertheless, <italic>ω</italic> during crawling is lower than during pauses as shown when we normalize it by dividing with the average <inline-formula><inline-graphic xlink:href="451470v2_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula> computed during the pause epochs (<xref rid="fig3" ref-type="fig">Figure 3<italic>C</italic></xref>, bottom). This implies a phasic attenuating interference of the peristaltic cycle on the lateral bending mechanism (<xref rid="fig1" ref-type="fig">Figure 1<italic>B</italic></xref>). A plausible mechanistic explanation featuring bodily interference of crawling and bending is suggested in the Discussion.</p>
<p>Larvae intermittently pause crawling before re-assuming it. This results in sequences of concatenated strides (runs or stridechains) that alternate with brief crawl-pauses (<xref rid="fig2" ref-type="fig">Figure 2<italic>C</italic></xref>). We analyzed the stridechain length with respect to the number of strides and the pause duration in the experimental dataset. To this end we pooled both measures across 100 larvae to obtain the empirical distributions. Testing power-law, exponential, log-normal and Levy distributions revealed the highest quality of fit for the log-normal distribution for both parameters (<xref rid="fig3" ref-type="fig">Figure 3<italic>B</italic></xref>).</p>
</sec>
<sec id="s3b">
<title>Simulation of behavioral experiments</title>
<p>In this section we simulate increasingly complex behavioral experiments. Starting from stimulus-free exploration we advance to chemotactic navigation and finally to adaptive odor preference experiments. We simulate individual larvae using the model as calibrated in <xref ref-type="app" rid="app2">Appendix 2</xref> and all model parameters are shown in <xref rid="figA2_1" ref-type="fig">Appendix 2-Figure 1<italic>A</italic></xref>. Larval populations are constructed by pooling individual virtual larvae that behave independently as they move through the spatial arena and odorscape (<xref ref-type="bibr" rid="c49">Niewalda et al., 2014</xref>).</p>
</sec>
<sec id="s3c">
<title>Exploration</title>
<p>In the first virtual experiment, we consider free exploration (<xref rid="fig4" ref-type="fig">Figure 4</xref>) and evaluate our simulation results against an empirical data set (see Materials and Methods). To this end we simulate a population of 200 virtual larvae during three minutes while exploring a stimulus-free environment on a non-nutritious substrate in a Petri-dish, mimicking the experimental lab conditions (<xref rid="fig4" ref-type="fig">Figure 4</xref>). Due to the absence of sensory input and food, the proposed intermittent coupled-oscillator locomotory model at the basic layer is sufficient to autonomously generate exploratory movement.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Free exploration in simulation and experiment.</title>
<p><bold>A:</bold> Dispersal of 200 larvae in experiment (left) and simulation (right) during 40 seconds. Individual tracks have been transposed to originate from the center of the arena. The entire temporal course shown in Figure 4—video 1. <bold>B:</bold> Dispersal from origin. Line indicates the group median while shaded area denotes first and third quartiles. <bold>C:</bold> Histograms for total number of strides, time ratio allocated to crawling and pathlength. (arena dimensions = 500×500mm, N = 200 larvae, experiment duration = 3 minutes, simulation timestep =1/16).</p>
</caption>
<graphic xlink:href="451470v2_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Larvae are initially placed at the center of the dish, each with a random body orientation. Over the course of the experiment, both the simulated and the real larval population disperses in space (<xref rid="fig4" ref-type="fig">Figure 4<italic>A</italic></xref>, Figure 4—video 1).</p>
<p>The quantitative comparison shows a good agreement between simulated and empirical data with respect to the radial dispersal from the initial position (<xref rid="fig4" ref-type="fig">Figure 4<italic>B</italic></xref>). Importantly, the variability across individual animals is well captured by the variability between individual model instances as shown for the number of strides, the crawling time, and the total distance travelled by each larva (<xref rid="fig4" ref-type="fig">Figure 4<italic>C</italic></xref>).</p>
<sec id="s3c1">
<title>Chemotaxis</title>
<p>Chemotaxis describes the process of exploiting an odor gradient in space to locate an attractive or avoid a repelling odor source. An olfactory sensor (olfactor) placed at the front end of the virtual body enables active sensing during body bending and allows detection of concentration changes that modulate turning behavior accordingly. Sensory-driven behavior is enabled via modulation of the frequency and amplitude of the lateral oscillator (turner) by sensory feedback, while the peristaltic oscillator is not affected, as proposed in (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>).</p>
<p>To assess the chemotactic efficiency of our coupled-oscillator model we reconstruct the arena and odor landscape (odorscape) of two behavioral experiments described in (<xref ref-type="bibr" rid="c22">Gomez-Marin et al., 2011</xref>). In the first, larvae are placed on the left side of the arena facing to the right. An appetitive odor source is placed on the right side. The virtual larvae navigate up the odor gradient approaching the source (<xref rid="fig5" ref-type="fig">Figure 5<italic>A,C,E</italic></xref>), reproducing the experimental observation in Fig.1 C in (<xref ref-type="bibr" rid="c22">Gomez-Marin et al., 2011</xref>). In the second, both the odor source and the virtual larvae are placed at the center of the arena. The larvae perform localized exploration, generating trajectories across and around the odor source. (<xref rid="fig5" ref-type="fig">Figure 5<italic>B,D,F</italic></xref>), again replicating the observation in <xref ref-type="fig" rid="fig1">Fig.1 D</xref> in (<xref ref-type="bibr" rid="c22">Gomez-Marin et al., 2011</xref>). Two sample simulations can be seen in Figure 5—video 1.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Simulation of chemotaxis.</title>
<p><bold>A:</bold> Experiment 1: A single odor source of 8.9<italic>μM</italic> peak concentration is placed on the right side of the rectangular arena creating a chemical gradient as indicated by the color scale. Larvae are placed on the left side facing to the right. Larvae are expected to navigate up the gradient approaching the source. A single larva trajectory is shown. This setup mimics the first experiment in (<xref ref-type="bibr" rid="c22">Gomez-Marin et al., 2011</xref>). <bold>B:</bold> Experiment 2: A single odor source of 2.0<italic>μM</italic> peak concentration is placed at the center of the rectangular arena. Larvae are placed in close proximity to the odor source. Larvae are expected to locally explore generating trajectories around and across the source. A single larva trajectory is shown. This setup mimics the second experiment in (<xref ref-type="bibr" rid="c22">Gomez-Marin et al., 2011</xref>). <bold>C,D:</bold> The trajectories of 25 virtual larvae during the two experiments. <bold>E,F:</bold> The odor concentration encountered by the virtual larvae as a function of time. Red curves refer to the single larva in A and B. Gray denotes the mean and quartiles of all 25 larvae in C and D. The simulation results fit well to the experimental estimates of concentration sensing during larval chemotaxis in (<xref ref-type="bibr" rid="c22">Gomez-Marin et al., 2011</xref>). (arena dimensions = 100×60mm, N = 30 larvae, experiment duration = 3 and 5 minutes respectively, simulation timestep =1/16).</p>
</caption>
<graphic xlink:href="451470v2_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s3c2">
<title>Odor preference test</title>
<p>We simulate the odor preference paradigm as described in the Maggot Learning Manual (<xref ref-type="bibr" rid="c46">Michels et al., 2017</xref>). Larvae are placed at the center of a dish containing two odor sources in opposite sides and left to freely explore. The odor concentrations are Gaussian-shaped and overlapping, resulting in an odorscape of appetitive and/or aversive opposing gradients. After 3 minutes the final situation is evaluated. The established population-level metric used is the olfactory preference index (PI), computed for the left odor as <inline-formula><inline-graphic xlink:href="451470v2_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> where <italic>N</italic><sub><italic>l</italic></sub> and <italic>N</italic><sub><italic>r</italic></sub> is the number of larvae on the left and right side of the dish while <italic>N</italic> is the total number of larvae.</p>
<p>The extend of olfactory modulation on the turning behavior is determined by the odor-specific gain <italic>G</italic>. As this is measured in arbitrary units, we first need to define a realistic value range that correlates with the behaviorally measured PI. We perform a parameter-space search independently varying the gain for left and right odors and measuring the resulting PI in simulations of 30 larvae. The results for a total of 25<sup>2</sup> gain combinations within a suitable range of <italic>G</italic> ∈ [−100, 100] are illustrated in <xref rid="fig6" ref-type="fig">Figure 6<italic>A</italic></xref>. Simulation examples for one appetitive and one aversive odor are shown in Figure 6—video 1.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><title>Simulation of innate and learned odor preference.</title>
<p><bold>A:</bold> A total of 25<sup>2</sup> simulations are shown with the resulting Preference Index for different gains of the left and right odor. On the top left the initial state is shown with the larvae randomly generated at the center of the dish. The final state of three additional simulations is depicted on the top right and bottom left and right. See Figure 6—video 1 for videos of two sample simulations. <bold>B:</bold> The pipeline used for coupling the Mushroom Body (MB) model with the behavioral simulation. First a MB model is trained via a classical conditioning experiment where olfactory input is combined with reward. The resulting odor valence <italic>MB</italic><sub><italic>out</italic></sub> is then converted to odor gain <italic>G</italic> via a simple linear transformation and used to generate a virtual larva. Finally the odor preference of a virtual larva population is evaluated in a behavioral simulation. <bold>C:</bold> The spiking neural network comprising the MB model. The number of neurons comprising each layer is indicated. <bold>D:</bold> The resulting PIs for 100 simulations per number of training trials. In each of the 100 simulations per condition a population of 30 virtual larvae was generated and evaluated using a different random seed, always bearing the exact same 30 odor gains derived from the respective group of 30 trained MB models (arena dimensions = 100<italic>x</italic>100mm, N = 30 larvae, experiment duration = 3 minutes, simulation timestep =0.1.</p>
</caption>
<graphic xlink:href="451470v2_fig6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>In order to simulate larval group behavior in response to an associative learning paradigm we interface our behavioral simulation with the spiking mushroom body (MB) model introduced in (<xref ref-type="bibr" rid="c29">Jürgensen et al., 2024</xref>) (<xref rid="fig6" ref-type="fig">Figure 6<italic>C</italic></xref>). It implements a biologically realistic neural network model of the olfactory pathway according to detailed anatomical data using leaky integrate-and-fire neurons (<xref ref-type="bibr" rid="c28">Jürgensen et al., 2021</xref>). The MB network undergoes associative plasticity at the synapses between the Kenyon cells and two MB output neurons as a result of concurrent stimulation with an odor and a reward signal. Both, odor and reward is simulated as spike train input to the receptor neurons and the reinforcement signalling dopaminergic neuron, respectively. The model employs two output neurons (<italic>MB</italic><sub>+</sub>, <italic>MB</italic><sub>−</sub>), representing a larger number of MB compartments associated with approach/avoidance learning respectively (<xref ref-type="bibr" rid="c65">Saumweber et al., 2018</xref>). The initially balanced firing rates between <italic>MB</italic><sub>+</sub> and <italic>MB</italic><sub>−</sub> are skewed after learning and encode the acquired odor valence (<xref ref-type="bibr" rid="c51">Owald et al., 2015</xref>; <xref ref-type="bibr" rid="c52">Owald and Waddell, 2015</xref>) here defined as:
<disp-formula id="ueqn1">
<graphic xlink:href="451470v2_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>We first trained the MB model via a classical conditioning experiment where, in each conditioning trial, it experiences an odor (conditioned stimulus, <italic>CS</italic><sub>+</sub>) in combination with a sugar reward during 5 min, following the standard training protocol in (<xref ref-type="bibr" rid="c46">Michels et al., 2017</xref>). 5 groups of 30 MB models undergo between 1 and 5 sequential conditioning trials (<xref ref-type="bibr" rid="c91">Weiglein et al., 2019</xref>). The resulting odor valence <italic>MB</italic><sub><italic>out</italic></sub> from each MB model was converted to an odor gain <italic>G</italic> via a simple linear transformation and used to generate a virtual larva (<xref rid="fig6" ref-type="fig">Figure 6<italic>B</italic></xref>). Each population of 30 larvae was then tested in an odor preference simulation. The larvae were placed on a dish in presence of the previously rewarded odor (CS+) and a neutral odor in opposite sides of the dish (Figure 6—video 1), again following standard experimental procedures (<xref ref-type="bibr" rid="c46">Michels et al., 2017</xref>). To obtain robust results we replicated the experiment 100 times per population with a different random seed for a total of 600 simulations. The obtained preference indexes (PI) are illustrated in <xref rid="fig6" ref-type="fig">Figure 6<italic>D</italic></xref>. The PI increase with increasing number of trials as well as its saturation resembles empirical observations (<xref ref-type="bibr" rid="c91">Weiglein et al., 2019</xref>). Note that the variability of the PI across the 100 simulations per condition is introduced solely by the behavioral simulation and resembles that seen across real experiments.</p>
<p>The current implementation only sequentially couples a trained MB model to be tested in a behavioral simulation. In the discussion we further elaborate on a possible extension featuring their closed-loop integration allowing for full behavioral simulations of both the training and the testing phase of the associative learning paradigm in a virtual environment.</p>
</sec>
</sec>
</sec>
<sec id="s4">
<title>Discussion</title>
<sec id="s4a">
<title>Experimental evidence for layered behavioral architecture</title>
<p>The proposed behavioral architecture is based on two underlying principles that justify our modular, hierarchically layered approach. Firstly, we attempt to horizontally structure it into behaviorally functional modules, each generating a well-defined behavior. Secondly, we vertically parse it into semi-independent layers, each under top-down modulation from the ones above but still capable of generating behavior independently of them. We summarize the neuroanatomical observations and behavioral experiments that support this approach.</p>
    <p>The neural mechanisms underlying the three basic larval behaviors (<xref rid="fig1" ref-type="fig">Figure 1<italic>A</italic></xref>, basic layer) have been extensively studied. Crawling is characterized by fairly stereotypical repetitive strides. Initial contraction of the head and tail segments driven by a ‘visceral piston’ mechanism is followed by a laterally symmetric peristaltic wave traversing neighboring segments longitudinally from back to front (<xref ref-type="bibr" rid="c24">Heckscher et al., 2012</xref>) (<xref rid="fig2" ref-type="fig">Figure 2<italic>B</italic></xref>). Segmental central pattern generators (CPGs) coupled via intersegmental short- and long-range connectivity motifs involving also premotor neurons constitute the underlying neural circuitry (<xref ref-type="bibr" rid="c34">Kohsaka et al., 2019</xref>; <xref ref-type="bibr" rid="c99">Zarin et al., 2019</xref>; <xref ref-type="bibr" rid="c42">Mantziaris et al., 2020</xref>). Lateral bending results from asymmetric contraction of body musculature initiated at the thoracic segments (<xref ref-type="bibr" rid="c4">Berni, 2015</xref>). Feeding is generated via a network of mono- and multi-synaptic sensorimotor loops from enteric, pharyngeal and external sensory organs to motor neurons controlling mouth-hook movement, head-tilt and pharyngeal pumping (<xref ref-type="bibr" rid="c48">Miroschnikow et al., 2018b</xref>; <xref ref-type="bibr" rid="c73">Schoofs et al., 2024</xref>). A noteworthy facet of these behaviors is their autonomous generation with-out the need for descending control. This has been demonstrated by continued exploration even after brain ablation (<xref ref-type="bibr" rid="c79">Sims et al., 2019</xref>). Exploitation of a nutritious substrate requires all three basic behaviors as the larva constantly consumes food and re-positions its body. According to the layer-independence principle, we postulate that peripheral consummatory circuits at the sub-esophageal zone (SEZ) are also capable of autonomous exploitation.</p>
    <p>Higher brain centers play a pivotal role in behavior modulation, with neurotransmitters like dopamine, serotonin, acetylcholine, and octopamine being key players in this intricate process (<xref ref-type="bibr" rid="c5">Berni et al., 2012</xref>; <xref ref-type="bibr" rid="c100">Zhang et al., 2013</xref>; <xref ref-type="bibr" rid="c48">Miroschnikow et al., 2018b</xref>; <xref ref-type="bibr" rid="c41">Malloy et al., 2019</xref>; <xref ref-type="bibr" rid="c13">Eschbach et al., 2020</xref>; <xref ref-type="bibr" rid="c90">Vogt et al., 2021</xref>). It has been suggested that the transition between exploration and exploitation (feeding) is acutely induced via dopaminergic signaling (<xref ref-type="bibr" rid="c71">Schleyer et al., 2020</xref>) while their long-term balance is regulated via hugin-mediated homeostatic neuromodulation (<xref ref-type="bibr" rid="c72">Schoofs et al., 2014</xref>). Identification of sensory pathways towards motor effector neuropiles further elucidates the role of interoception in behavioral modulation (<xref ref-type="bibr" rid="c57">Qian et al., 2018</xref>).</p>
    <p>The neural mechanisms that underlie olfactory modulation of the basic locomotory behavior are also under intense investigation. Chemotactic approach and avoidance to innately valenced odors has been attributed to a predominantly innate pathway involving the antennal lobe (AL) and its direct projection to the lateral horn (LH), both in the larva (<xref ref-type="bibr" rid="c76">Schulze et al., 2015</xref>; <xref ref-type="bibr" rid="c90">Vogt et al., 2021</xref>) and in the adult fly (<xref ref-type="bibr" rid="c2">de Belle and Heisenberg, 1994</xref>; <xref ref-type="bibr" rid="c82">Strutz et al., 2014</xref>; <xref ref-type="bibr" rid="c12">Dolan et al., 2018</xref>). Modulation of behavior by learned odors strongly involves descending control by the MB in juvenile (<xref ref-type="bibr" rid="c65">Saumweber et al., 2018</xref>; <xref ref-type="bibr" rid="c13">Eschbach et al., 2020</xref>) and adult (<xref ref-type="bibr" rid="c80">Slater et al., 2015</xref>) stages. Both pathways have similar modulating effects on foraging behavior and are likely integrated in a premotor network downstream of the AL (<xref ref-type="bibr" rid="c68">Schleyer et al., 2015a</xref>; <xref ref-type="bibr" rid="c13">Eschbach et al., 2020</xref>). In the sensorimotor loop, descending pathways involving the LH control cessation of crawling, possibly triggering sharper re-orientation when navigating down-gradient, facilitating chemotaxis (<xref ref-type="bibr" rid="c85">Tastekin et al., 2018</xref>). Finally, the internal homeostatic state (e.g. starvation vs. satiation) is implicated in behavioral regulation via neurotransmitter release at multiple levels, including AL, LH and MB and neuropeptide expression (<xref ref-type="bibr" rid="c90">Vogt et al., 2021</xref>; <xref ref-type="bibr" rid="c88">de Tredern et al., 2024</xref>).</p>
</sec>
<sec id="s4b">
<title>Previous computational models of larva locomotion</title>
<p>Larva locomotion has been modeled extensively. Generative models of peristaltic crawling feature neural and/or neuromuscular dynamics. Sequential neural activity patterns across the segmental body can be generated by longitudinally repeated CPGs of paired excitatory and inhibitory population rate units, possibly involving proprioceptive feedback (<xref ref-type="bibr" rid="c20">Gjorgjieva et al., 2013</xref>; <xref ref-type="bibr" rid="c54">Pehlevan et al., 2016</xref>). This relatively abstract CPG model has been elaborated into a connectome-based circuitry of premotor and motor neurons. Under tonic activation the model exhibits two functionally distinct, though structurally overlapping, recurring patterns of neuromuscular activity, responsible for forward and backward peristalsis respectively (<xref ref-type="bibr" rid="c99">Zarin et al., 2019</xref>). At the other end of the modeling spectrum the contribution of the visceral-piston mechanism to the peristaltic cycle has been assessed in a biomechanical model (<xref ref-type="bibr" rid="c62">Ross et al., 2015</xref>). A more elaborate neuromechanical model, based on segmental localized reflexes and substrate frictional forces and assuming empirically informed axial and transverse oscillatory frequencies, has been shown to generate forward and backward crawling without the need for any neural activation pattern (<xref ref-type="bibr" rid="c39">Loveless et al., 2019</xref>).</p>
<p>Lateral bending has also been captured in statistical (<xref ref-type="bibr" rid="c9">Davies et al., 2015</xref>) or generative models (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>; <xref ref-type="bibr" rid="c39">Loveless et al., 2019</xref>; <xref ref-type="bibr" rid="c40">Loveless and Webb, 2018</xref>). In the context of free-exploration it has been shown to be a byproduct of chaotic body neuromechanics underlying peristalsis (<xref ref-type="bibr" rid="c39">Loveless et al., 2019</xref>). In the context of chemotaxis it has been attributed to a distinct oscillatory process, autonomous (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>) or semi-autonomous to crawling (<xref ref-type="bibr" rid="c9">Davies et al., 2015</xref>). In the former case oscillation is driven by mutual inhibition between excitatory-inhibitory circuits. In the latter, bending behavior is dissected into low-amplitude weathervaning while crawling and high-amplitude headcasting during crawl-pauses, an approach essentially equivalent to an attenuation of the lateral oscillation amplitude due to crawling. Autonomous exploration and chemotaxis can be generated by an integration of the neuromechanical and the independent lateral oscillator models (<xref ref-type="bibr" rid="c40">Loveless and Webb, 2018</xref>).</p>
<p>Apart from the rare occasion where such models implement mutually exclusive mechanistic hypotheses and are indubitably incompatible to each other, in most cases they are indeed complementary, overlapping, nested or disconnected in terms of the generative mechanisms they aim to capture and could potentially coexist under a broader control system. In this context our unifying architecture for larval behavior in which any partial model can be positioned can be valuable for modelers and roboticists, interested in a behavior-based synthetic approach.</p>
</sec>
<sec id="s4c">
<title>Intermittent coupled-oscillator model for realistic locomotion</title>
<p>Each of the above models could be adjusted so that at minimum it generates the 2D translational and angular motion of a virtual body and could therefore populate the basic locomotory layer of the behavioral architecture. In this study we propose such a model, assembled in a synthetic approach by distinct modules, which either extend previously proposed locomotory models or integrate novel findings derived from our analysis of kinematic parameters. Given a simplified bisegmental body, a simple oscillator under frequency-regulating tonic activation is adequate for generating recurrent strides, efficiently summarizing the complex underlying neural and neuromechanical dynamics (<xref ref-type="bibr" rid="c24">Heckscher et al., 2012</xref>; <xref ref-type="bibr" rid="c42">Mantziaris et al., 2020</xref>). Concerning angular motion, the previously introduced lateral oscillator model (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>) meets the requirements and can therefore be coupled to the forward oscillator.</p>
<p>Our proposed model contributes two novel features. First, the intermittent nature of crawling as transitions between runs and pauses (<xref rid="fig3" ref-type="fig">Figure 3<italic>B</italic></xref>). And, second, the peristaltic cycle-phase dependent attenuation of angular motion (<xref rid="fig3" ref-type="fig">Figure 3<italic>D</italic></xref>). By combining these two features, the two bending behavioral modes termed weathervaning and head-casting are naturally generated via a phasic coupling between the two oscillators.</p>
<sec id="s4c1">
<title>Behavioral intermittency</title>
    <p>Larval locomotion is intermittent meaning that crawling runs are transiently intermitted by brief pauses. Transitions between these two behavioral states occur autonomously in stimulus-free conditions as during free exploration. Traditionally, in the context of movement ecology, intermittency has been studied in the spatial regime by characterizing the distributions of run distances and turn amplitudes occurring during brief stationary reorientation events (pauses). Power-law distributed runs in line with Levy-walk theoretical models (<xref ref-type="bibr" rid="c23">Günther et al., 2016</xref>; <xref ref-type="bibr" rid="c79">Sims et al., 2019</xref>) and diffusion-like kinematics have been reported (<xref ref-type="bibr" rid="c33">Klein et al., 2017</xref>). On the other hand, the turn amplitude distribution diverges from the original Levy-walk-predicted uniform distribution, as it is highly skewed towards small amplitudes, even if only significant reorientation events are taken into account (<xref ref-type="bibr" rid="c79">Sims et al., 2019</xref>). Moreover, the speed-curvature power-law relationship has been disputed (<xref ref-type="bibr" rid="c97">Zago et al., 2016</xref>; <xref ref-type="bibr" rid="c43">Marken and Shaffer, 2017</xref>; <xref ref-type="bibr" rid="c98">Zago et al., 2017</xref>; <xref ref-type="bibr" rid="c44">Marken and Shaffer, 2018</xref>). Regarding the temporal dynamics of intermittency, the duration distribution of these pauses is commonly neglected in traditional Levy-walk literature as they are usually characterised via the amplitude distribution of their resulting turning events. A recent analysis of larval tracks reported that the duration of pauses follows a power-law while that of activity bouts a log-normal distribution (<xref ref-type="bibr" rid="c64">Sakagiannis et al., 2020</xref>), partly in line with findings in adult-fly studies (<xref ref-type="bibr" rid="c89">Ueno et al., 2012</xref>; <xref ref-type="bibr" rid="c59">Reynolds et al., 2015</xref>). In our current study we found log-normal best fits for both pause duration and stridechain length. The disagreement over the pause duration might be attributed to the different timescale assessed in the two studies. Contrary to the high-resolution 180-sec tracks in this study, those analyzed previously lasted at minimum 1024 sec and up to 1 hour, allowing for the detection of longer pauses and imposing the necessity to fit over 4 orders of magnitude bypassing the apparent drop around 10 sec, also seen in Fig.3 of (<xref ref-type="bibr" rid="c64">Sakagiannis et al., 2020</xref>).</p>
<p>Concerning computational modeling, the contribution of behavioral intermittency to locomotion has not been adequately appreciated. Candidate generative models can either simply sample statistical distributions (<xref ref-type="bibr" rid="c79">Sims et al., 2019</xref>) or feature a generative mechanism that yields state transitions. Stochastic state-transitions have been included in a model of larva exploration yielding exponentially distributed epochs of both runs and stationary headcasts (<xref ref-type="bibr" rid="c9">Davies et al., 2015</xref>). At a mechanistic level, a recent study presented a simple binary-neuron model exhibiting state transitions between power-law and non power-law regimes via self-limiting neuronal avalanches and proposed a plausible underlying mechanism that explains initiation/cessation of crawling (<xref ref-type="bibr" rid="c64">Sakagiannis et al., 2020</xref>). All these attempts can be considered instantiations of a behavioral intermittency module (<xref rid="fig1" ref-type="fig">Figure 1<italic>B</italic></xref>) controlling cessation and re-initiation of crawling, central for generating epoch transitions. In the present study, we chose stochastic sampling from the empirically fitted parametric distribution models.</p>
</sec>
<sec id="s4c2">
<title>Crawl-bend interference</title>
<p>Crawling includes mouth hook motion. Specifically, the first phase of a crawling stride consists of concurrent forward motion of head and tail segments, aided by a ‘visceral pistoning’ mechanism that generates forward displacement of the gut. Subsequently, the mouth hooks anchor the head to the substrate so that the second phase of peristaltic motion can drag all other segments forward as well, completing the stride (<xref ref-type="bibr" rid="c24">Heckscher et al., 2012</xref>). With respect to turning, it is still debated whether individual turns should be considered as discrete reorientation events that are temporally non-overlapping with crawling bouts (<xref ref-type="bibr" rid="c79">Sims et al., 2019</xref>), or whether lateral bending occurs in an oscillatory fashion generating turns both during crawling (weathervaning) and during pauses (headcasts) (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>; <xref ref-type="bibr" rid="c87">Thane et al., 2019</xref>). The latter is supported by detailed eigenshape analysis confirming that larvae rarely crawl straight, rather forward locomotion is always accompanied by continuous small amplitude lateral bending (<xref ref-type="bibr" rid="c83">Szigeti et al., 2015</xref>). It follows that crawling does not exclude bending, rather the two strictly co-occur.</p>
<p>Crawling and bending partially recruit the same effector neural circuitry and body musculature at least at the level of the thorax. Peristaltic motion during crawling includes sequential symmetric bilateral contraction of all segments while bending occurs due to asymmetric unilateral contraction of the thoracic segments. This partial effector overlap could result in interference between the two processes. Indeed here we report a phase-dependent attenuation of angular velocity (<xref rid="fig3" ref-type="fig">Figure 3<italic>C</italic></xref>). Attenuation reaches a minimum at a specific phase of the cycle, closely preceding the increase of head forward velocity (<xref rid="fig3" ref-type="fig">Figure 3</xref><italic>C:inset</italic>). This coincides with the stride phase when the head stops being anchored to the substrate and is therefore free to move laterally. When applying a phase-dependent Gaussian attenuation kernel on angular velocity we managed to accurately reproduce the empirical relation (<xref rid="figA2_1" ref-type="fig">Appendix 2-Figure 1<italic>C</italic></xref>).</p>
<p>A reasonable hypothesis would then be that the asymmetric thoracic contraction generating lateral bending becomes easier when the head is not anchored to the substrate therefore during a specific phase interval of the stride cycle. We propose that crawling phasically interferes with lateral bending because of these bodily constraints. A consequence of this hypothesis is that the amplitude of turns generated during crawl-pauses (headcasts) is larger in comparison to those generated during crawling (weathervaning) because during pauses the crawling interference to lateral bending is lifted. It is this phenomenon that dominates the description of larva exploration as a Levy-walk with non-overlapping straight runs and reorientation events, where weathervaning is neglected (<xref ref-type="bibr" rid="c23">Günther et al., 2016</xref>; <xref ref-type="bibr" rid="c79">Sims et al., 2019</xref>). Nevertheless, it has been included in a previous stochastic model of larva exploration, where it has been treated as entirely distinct to headcasts, occurring during crawl-pauses, via the application of differential constraints on both the angular velocity and the resulting turn amplitude (<xref ref-type="bibr" rid="c9">Davies et al., 2015</xref>). By implementing a coupled-oscillator locomotory model we avoid such dual treatment of headcasts and weathervaning.</p>
</sec>
</sec>
<sec id="s4d">
<title>Olfactory learning in closed loop behavioral simulations</title>
    <p>We have reproduced the results of a basic associative learning experiment in the fruit fly larva (<xref ref-type="bibr" rid="c67">Schleyer et al., 2018</xref>; <xref ref-type="bibr" rid="c29">Jürgensen et al., 2024</xref>) by the open-loop simulation of classical conditioning trials and subsequent closed-loop behavioral simulation during the memory retention test for individual virtual larvae (<xref rid="fig6" ref-type="fig">Figure 6</xref><italic>B-D</italic>). This modeling approach can be extended in multiple ways. First, the larva demonstrates a number of additional learning capabilities such as differential conditioning (<xref ref-type="bibr" rid="c70">Schleyer et al., 2011</xref>; <xref ref-type="bibr" rid="c69">Schleyer et al., 2015b</xref>; <xref ref-type="bibr" rid="c67">Schleyer et al., 2018</xref>), extinction learning (<xref ref-type="bibr" rid="c15">Felsenberg and Waddell, 2019</xref>; <xref ref-type="bibr" rid="c38">Lesar et al., 2021</xref>), and relief learning (<xref ref-type="bibr" rid="c65">Saumweber et al., 2018</xref>; <xref ref-type="bibr" rid="c91">Weiglein et al., 2019</xref>; <xref ref-type="bibr" rid="c18">Gerber et al., 2014</xref>; <xref ref-type="bibr" rid="c35">König et al., 2018</xref>). Interfacing neural network simulations with candidate circuit and synaptic mechanisms of plasticity with our behavioral model allows to directly compare virtual and empirical behavioral experiments, both at the level of individual and group assays. Second, while information about odor concentration is provided through active sensing, simultaneous input from a feeder module could activate the dopaminergic reward pathway required for synaptic plasticity in the mushroom body. At the same time, simulation of food uptake and energy expenditure will regulate the agent’s energy homeostasis. This would further allow realistic foraging scenarios with food depletion and competition among animals.</p>
<p>Closing the loop from active sensing to associative memory formation and behavioral control requires to synchronize a (spiking) neural network at the adaptive layer with the sensory module (reactive layer), and the locomotory and feeding modules at the basic layer (<xref rid="fig1" ref-type="fig">Figure 1<italic>A</italic></xref>). This will enable the simulation of virtual larvae experiencing spatial and temporal dynamics in a virtual environment or on a robotic platform (<xref ref-type="bibr" rid="c25">Helgadottir et al., 2013</xref>), and it will allow to test model hypotheses on sensory-motor integration and to infer predictions for experimental interventions such as optogenetic stimulation (<xref ref-type="bibr" rid="c65">Saumweber et al., 2018</xref>) or genetic manipulation (<xref ref-type="bibr" rid="c66">Saumweber et al., 2011</xref>; <xref ref-type="bibr" rid="c45">Michels et al., 2011</xref>; <xref ref-type="bibr" rid="c92">Widmann et al., 2016</xref>; <xref ref-type="bibr" rid="c81">Springer and Nawrot, 2021</xref>).</p>
</sec>
</sec>
<sec id="s5">
<title>Materials and Methods</title>
<p>We first describe the experimental dataset and the software package used in this study. Then we explicitly describe each of the computational modules that comprise the proposed behavioral architecture. The metrics used throughout the analyses of both real and simulated datasets are described in <xref ref-type="app" rid="app1">Appendix 1</xref>.</p>
<sec id="s5a">
<title>Dataset description</title>
<p>The larva-tracking dataset was obtained by M.Schleyer and J. Thoener at the Leipzig Institute of Neurobiology. It consists of 31 experimental groups. Each group of ∼ 30 third-instar larvae (Canton S) was placed on agarose-filled Petri dishes of 15 cm diameter with no particular stimuli and video-filmed from above at a framerate of 16 <italic>Hz</italic> for 3 minutes. During video-tracking, 12 points are detected along the longitudinal axis of each larva. For the present study groups were pooled together in a single population and timepoints of detected collisions have been excluded. A subset consisting of the 200 most complete, uninterrupted tracks was selected. The x-y coordinate timeseries have been filtered with a first-order butterworth low-pass filter with a cutoff frequency of 2 <italic>Hz</italic> in order to decrease tracking-related noise but retain the behaviorally relevant crawling frequency of <italic>f</italic><sub><italic>C</italic></sub> ≃ 1.4 <italic>Hz</italic>. The effect of inadequate and excessive filtering is illustrated in Video 3.</p>
</sec>
<sec id="s5b">
<title>Software package and code availability</title>
<p>All data processing, data analyses and model simulations were performed using our freely available python package <italic>Larvaworld</italic> (<ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/larvaworld/">https://pypi.org/project/larvaworld/</ext-link>), a behavioral analysis and simulation platform for <italic>Drosophila</italic> larva. In <italic>Larvaworld</italic> simulated and empirical data are treated indistinguishably, meaning that the exact same analysis pipeline and behavioral metrics are applied to both. Concerning modeling, the behavioral architecture we propose here comprises the backbone for the construction, extension, configuration and fitting of behavioral models in <italic>Larvaworld</italic>. Moreover, the intermittent coupled-oscillator model as introduced in the present manuscript is available for simulations alongside other preconfigured models. Extensive documentation can be found at <ext-link ext-link-type="uri" xlink:href="https://larvaworld.readthedocs.io">https://larvaworld.readthedocs.io</ext-link>.</p>
</sec>
<sec id="s5c">
<title>Inter-individual variability in virtual populations</title>
<p>The dominant methodological approach in animal behavioral modeling yields generative models that capture the average behavior of a group of animals. Each model therefore strives to generate behavior resembling that of an idealized average animal, neglecting inter-individual variability. To challenge this, we contrast it with a group-level modeling approach that preserves individuality within the population. Here, the generative model is instantiated by a group of non-identical animats, with parameter combinations drawn from a fitted multivariate normal distribution, preserving their pairwise correlations. We first measured a number of endpoint parameters across a population of 200 larvae and fitted a multivariate Gaussian distribution. A subset of three of these parameters, body-length <italic>l</italic>, crawling frequency <italic>f</italic><sub><italic>C</italic></sub>, and scaled stride displacement <inline-formula><inline-graphic xlink:href="451470v2_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is shown in <xref rid="fig7" ref-type="fig">Figure 7</xref>. The univariate and bivariate empirical distributions are illustrated in blue, while the bivariate projections are shown in red.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7.</label>
<caption><title>Individuality: empirical (blue) and fitted (red) parameter distributions.</title>
<p>Diagonal: Histogram and kernel density estimates (KDE) for body-length <italic>l</italic>, crawling frequency <italic>f</italic><sub><italic>C</italic></sub> and mean scaled displacement per stride <inline-formula><inline-graphic xlink:href="451470v2_inline47.gif" mime-subtype="gif" mimetype="image"/></inline-formula> across a population of 200 larvae in the experimental dataset. Below: Bivariate projection of 3-dim. KDE outlined contours for each parameter pair. Above: Red ellipses represent the bivariate projections of the 3-dim. fitted Gaussian distributions at 0.5, 1, 2 and 3 standard deviations. In our model this Gaussian is used to sample a parameter set for each individual larva. The blue dots denote the empirically measured parameters.</p></caption>
<graphic xlink:href="451470v2_fig7.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s5d">
<title>Module definition</title>
<p>The building blocks comprising the behavioral architecture are described as separate modules of defined input and output. The modular architecture only specifies the required placeholders and remains agnostic to the specific module implementations. Nevertheless, in what follows, the specific modular implementation for the proposed coupled-oscillator locomotory model will be described alongside the general module-placeholder definition. Calibration of each module on the empirical dataset and parameter specification is described in detail in <xref ref-type="app" rid="app2">Appendix 2</xref>. The parameters of the final model configuration are shown in <xref rid="tbl1" ref-type="table">Table 1</xref>.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
    <caption><title>Locomotory model configuration.</title><p>The parameters of the calibrated average locomotory model, organized per module.</p></caption>
<graphic xlink:href="451470v2_tbl1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<sec id="s5d1">
<title>Bisegmental body</title>
<p>The virtual body is the architecture’s interface with the simulated environment. It moves through space under the control of the motor effectors comprising the basic locomotory layer of the architecture, and thereby repositions the sensors introduced in the intermediate reactive layer. For the simplest case of 2D locomotion it is therefore imperative to define at least the forward velocity <italic>v</italic> and the angular orientation velocity <italic>ω</italic>. Any locomotory model dynamically generating these two parameters is adequate for an abstract point-body or a single-segment body implementation.</p>
<p>For the proposed coupled-oscillator model we choose a bisegmental body implementation, additionally featuring the bending angle (posture) <italic>θ</italic><sub><italic>b</italic></sub> between the front and rear segment. Following (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>), the body is modeled as a torsional analog of the mass-spring damper model. Torque angularly accelerates an inertia <italic>I</italic> against angular damping that resists motion and viscoelastic forces that resist deformation (lateral bending). The original mass-spring damper model and its torsional analogue are defined by the equations:
<disp-formula id="ueqn2">
<graphic xlink:href="451470v2_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="ueqn3">
<graphic xlink:href="451470v2_ueqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>We introduce simplified coefficients for angular damping <italic>z</italic> = <sup><italic>Z</italic></sup>/<sub><italic>I</italic></sub> in <italic>sec</italic><sup>−1</sup> and bend deformation resistance <italic>k</italic> = <sup><italic>K</italic></sup>/<sub><italic>I</italic></sub> in <italic>sec</italic><sup>−2</sup> as the dimensions of inertia <italic>ML</italic><sup>2</sup> cancel out. Similarly, the external torque-per-unit-of-inertia is now in angular acceleration units <inline-formula><inline-graphic xlink:href="451470v2_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula> This drive is generated by the turner module and will be described below. Additionally we introduce a crawl-phase dependent suppression of angular motion during crawling described by the coefficient <italic>c</italic><sub><italic>CT</italic></sub> (<italic>t</italic>) = <italic>c</italic><sub><italic>CT</italic></sub> (<italic>ϕ</italic><sub><italic>C</italic></sub>), which will also be described below.
<disp-formula id="eqn1">
<graphic xlink:href="451470v2_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>In its original implementation (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>) the torsional body model deliberately neglects two aspects of the real turning behavior of the larva. First, there is no distinction between bending <italic>ω</italic><sub><italic>b</italic></sub> and orientation <italic>ω</italic> angular velocities. Second, there is no correction of the bending angle <italic>θ</italic><sub><italic>b</italic></sub> due to forward motion. We tackle the first via the bisegmental body so that <italic>ω</italic><sub><italic>b</italic></sub> between the front and rear vector is distinct from the front vector’s <italic>ω</italic>. Regarding the second, we introduce a simple linear bending-angle correction as the rear vector is aligned to the front vector’s orientation during forward motion, according to the equation:
<disp-formula id="ueqn4">
<graphic xlink:href="451470v2_ueqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>d</italic> is the linear displacement during a timestep, <inline-formula><inline-graphic xlink:href="451470v2_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>θ</italic><sub><italic>b</italic></sub> is the bending angle before and after correction, <italic>l</italic> is the body length and <italic>c</italic><sub><italic>b</italic></sub> = 1 is the bend correction coefficient.</p>
<p>Concerning the forward motion, the simple kinematic implementation of the crawler module directly generates forward velocity <italic>v</italic> without taking into account any biomechanical dynamics.</p>
</sec>
<sec id="s5d2">
<title>Crawler module</title>
<p>The crawler module generates forward velocity <italic>v</italic>, under a continuous (tonic) activation signal <italic>I</italic><sub><italic>C</italic></sub> and an additional intermittent initiation/cessation signal generated by the intermittency module. Velocity generation involves three parameters : the larval body-length <italic>l</italic>, the scaled displacement per stride <inline-formula><inline-graphic xlink:href="451470v2_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and the crawling frequency <italic>f</italic><sub><italic>C</italic></sub>. The latter linearly reflects the tonic input <italic>I</italic><sub><italic>C</italic></sub>, which is kept constant during the short-duration simulations. For an individual virtual larva <inline-formula><inline-graphic xlink:href="451470v2_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>f</italic><sub><italic>C</italic></sub> are set during initialization, where <inline-formula><inline-graphic xlink:href="451470v2_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are the mean and standard deviation of <inline-formula><inline-graphic xlink:href="451470v2_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
<p>In the present study crawling behavior is modeled as an oscillatory process. Each oscillation generates a cycle of forward velocity <italic>v</italic> increase-decrease resulting in displacement <inline-formula><inline-graphic xlink:href="451470v2_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula> of the larva along the axis of its front-segment, simplistically modeling the result of exactly one peristaltic stride. After termination of a stride a new <inline-formula><inline-graphic xlink:href="451470v2_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is sampled. An analytically tractable curve is fitted to the average empirical velocity curve measured during strides by setting all 5 crawler-related parameters to the median empirically measured value (<xref rid="figA2_1" ref-type="fig">Appendix 2-Figure 1<italic>B</italic></xref>):
<disp-formula id="eqn2">
<graphic xlink:href="451470v2_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn3">
<graphic xlink:href="451470v2_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>ϕ</italic><sub><italic>C</italic></sub> is the instantaneous phase of the crawler oscillation iterating from 0 to 2<italic>π</italic> during an oscillatory cycle, <inline-formula><inline-graphic xlink:href="451470v2_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the maximum scaled velocity during the cycle and <inline-formula><inline-graphic xlink:href="451470v2_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the phase where the maximum velocity occurs.</p>
</sec>
<sec id="s5d3">
<title>Turner module</title>
<p>The turner module is defined as the generative model of a torque-like output <italic>A</italic><sub><italic>T</italic></sub> (<italic>t</italic>) under a continuous activation signal <italic>I</italic><sub><italic>T</italic></sub> (<italic>t</italic>). The (considered non-dimensional) output is scaled to angular acceleration by a coefficient <italic>c</italic><sub><italic>T</italic></sub> in <italic>sec</italic><sup>−2</sup> and applied to the body as external bending drive (<xref ref-type="disp-formula" rid="eqn1">Equation 1</xref>):
<disp-formula id="eqn4">
<graphic xlink:href="451470v2_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
    which is then applied to the body yielding the instantaneous angular velocity <italic>ω</italic>(<italic>t</italic>) and angular acceleration <inline-formula><inline-graphic xlink:href="451470v2_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula> bending the virtual body laterally. It has been previously suggested that an underlying oscillatory process drives alternating bending to the left and right side (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>). We empirically confirmed this by detecting a slow,variable rhythm <italic>f</italic><sub><italic>T</italic></sub> ≈ 0.4 on the angular velocity timeseries of individual larvae. Based on this observation we adopt an oscillatory approach for the alternating lateral bending and extend the lateral oscillator model described in (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>). It consists of two mutually inhibiting components each having an excitatory and inhibitory neuron (<italic>E</italic><sub><italic>L&amp;</italic></sub><italic>C</italic><sub><italic>L</italic></sub> vs <italic>E</italic><sub><italic>R&amp;</italic></sub><italic>C</italic><sub><italic>R</italic></sub>). The spike-response of a neuron to a cumulative input <italic>x</italic> is given by <italic>R</italic>(<italic>x, h</italic>) where <italic>h</italic> is the half-response threshold. The neuromodulatory activation <italic>I</italic><sub><italic>T</italic></sub> (<italic>t</italic>) excites both components but also affects the gain <italic>g</italic>(<italic>I</italic><sub><italic>T</italic></sub>) and time constant <italic>τ</italic><sub><italic>H</italic></sub> (<italic>I</italic><sub><italic>T</italic></sub>) of an additional adaptation component <italic>H</italic><sub><italic>x</italic></sub> of each neuron. The left and right components quickly settle in antiphase, while adaptation ensures that periodic transitions occur. Under the baseline activation <inline-formula><inline-graphic xlink:href="451470v2_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula> the oscillations occur at a dominant frequency <italic>f</italic><sub><italic>T</italic></sub> . Perturbations of this external drive cause transient changes in both amplitude and frequency because both, up to transient loss of oscillation. This feature is exploited during olfactory modulation. The resulting oscillator activity is defined as the instantaneous difference in the firing rates <italic>A</italic><sub><italic>T</italic></sub> = (<italic>E</italic><sub><italic>L</italic></sub> − <italic>E</italic><sub><italic>R</italic></sub>).
<disp-formula id="eqn5">
<graphic xlink:href="451470v2_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Calibration of the turner module parameters in order to achieve a resulting angular motion that is in agreement to the empirical observations requires concurrent specification of the angularmotion related angular damping <italic>z</italic>, bend deformation resistance <italic>k</italic> and torque scaling coefficient <italic>c</italic><sub><italic>T</italic></sub> . The calibration process is described in detail in <xref ref-type="app" rid="app2">Appendix 2</xref>.</p>
</sec>
<sec id="s5d4">
<title>Crawler-turner coupling</title>
<p>We couple the crawler and turner oscillators by imposing a crawler-phase dependent attenuation <italic>c</italic><sub><italic>CT</italic></sub> (<italic>ϕ</italic><sub><italic>C</italic></sub>) on the angular velocity <italic>ω</italic> (<xref ref-type="disp-formula" rid="eqn1">Equation 1</xref>). During the entire stride-cycle <italic>ω</italic> is scaled by a baseline suppression coefficient <inline-formula><inline-graphic xlink:href="451470v2_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Our kinematic analysis revealed that this baseline attenuation is partially lifted during a phase interval of the stride-cycle. The maximum additional relief is defined by the relief coefficient <inline-formula><inline-graphic xlink:href="451470v2_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Concerning the mode of transition from <inline-formula><inline-graphic xlink:href="451470v2_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to <inline-formula><inline-graphic xlink:href="451470v2_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and back to <inline-formula><inline-graphic xlink:href="451470v2_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, we study two implementations, each defined by an additional parameter. In the “square” mode there is an acute transition to maximum relief and back to baseline for a specific interval of the cycle <inline-formula><inline-graphic xlink:href="451470v2_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. In the “phase” mode the transition is described as a Gaussian kernel reaching maximum relief at phase <inline-formula><inline-graphic xlink:href="451470v2_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula> when crawl-induced angular attenuation is minimum and the anterior body is maximally free to bend laterally, as shown in the equation:
<disp-formula id="eqn6">
<graphic xlink:href="451470v2_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn7">
<graphic xlink:href="451470v2_eqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The parameter set is optimized to match the average empirically measured angular motion observed during the stride cycle. The optimization process used is described in <xref ref-type="app" rid="app2">Appendix 2</xref>. The optimal Gaussian kernel is shown in <xref rid="fig3" ref-type="fig">Figure 3</xref>.</p>
</sec>
<sec id="s5d5">
<title>Intermittency module</title>
<p>We define the intermittency module as a placeholder for any model capable of generating transitions between runs and pauses (or equivalently runs and headcasts) (<xref rid="fig1" ref-type="fig">Figure 1<italic>B</italic></xref>). During pauses, the input to the crawler module <italic>I</italic><sub><italic>C</italic></sub> = 0 and therefore forward velocity <italic>v</italic> = 0 while during runs this is unaffected. For the specific study we implement a statistical model where the duration for both the run and pause states is sampled at each initiation from a distribution that has been fitted to the experimental data. In the case of pauses the duration is normally measured in time units. For runs we employ an equivalent metric and therefore measure them as number of consecutive crawling strides (stridechains). The fitted distributions are shown in <xref rid="tbl1" ref-type="table">Table 1</xref>.</p>
</sec>
<sec id="s5d6">
<title>Olfactory sensor</title>
<p>Olfaction is introduced in the intermediate layer of the behavioral architecture allowing chemotactic behavior. The olfactory sensor is located at the front end of the virtual larva therefore any reorientation and/or displacement influences sensory input. As in (<xref ref-type="bibr" rid="c22">Gomez-Marin et al., 2011</xref>) we assume that olfactory perception <italic>A</italic><sub><italic>O</italic></sub> relates to changes in odor concentration <italic>C</italic> according to the Weber-Fechner law, meaning that Δ<italic>A</italic><sub><italic>O</italic></sub> ∼ ln Δ<italic>C</italic>. We further add a decay term that slowly resets <italic>A</italic><sub><italic>O</italic></sub> back to 0. The rate of change is given in <xref ref-type="disp-formula" rid="eqn8">Equation 8</xref> where <italic>c</italic><sub><italic>O</italic></sub> = 1 is the olfactory decay coefficient, <italic>G</italic><sub><italic>i</italic></sub> is the gain for odor <italic>i</italic> and <italic>C</italic><sub><italic>i</italic></sub> the respective odor concentration:
<disp-formula id="eqn8">
<graphic xlink:href="451470v2_eqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Concerning how the perceived olfactory stimulation <italic>A</italic><sub><italic>O</italic></sub> modulates exploratory behavior we adopt the mechanism proposed in (<xref ref-type="bibr" rid="c96">Wystrach et al., 2016</xref>) (<xref rid="fig5" ref-type="fig">Figure 5</xref>). According to this model, the turner activation <italic>I</italic> is perturbed from its baseline value <inline-formula><inline-graphic xlink:href="451470v2_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula> within a suitable range <inline-formula><inline-graphic xlink:href="451470v2_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula>:
<disp-formula id="eqn9">
<graphic xlink:href="451470v2_eqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s5d7">
<title>Mushroom body module</title>
    <p>The underlying spiking network model of the <italic>Drosophila</italic> larva olfactory pathway and mushroom body (<italic>MB</italic>) implements the model published by (<xref ref-type="bibr" rid="c29">Jürgensen et al., 2024</xref>). It consists of conductance-based leaky integrate-and-fire neurons. It encompasses 21 olfactory receptor neurons (<italic>ORNs</italic>) and the same number of projection neurons (<italic>PNs</italic>) and local interneurons (<italic>LNs</italic>) that receive input from the <italic>ORNs</italic> in a one-to-one manner (<xref rid="fig6" ref-type="fig">Figure 6<italic>C</italic></xref>). <italic>LNs</italic> form inhibitory connections with the <italic>PNs</italic>. In the <italic>MB</italic>, each of the 72 Kenyon cells (<italic>KC</italic>) receive excitatory input from 2-6 random <italic>PNs</italic>. Feedback inhibition to the <italic>KCs</italic> is provided via the single GABAergic anterior paired lateral neuron (<italic>APL</italic>). All <italic>KC</italic> provide excitatory input to two <italic>MB</italic> output neurons (<italic>MBONs</italic>). The two <italic>MBONs</italic> represent two different types of output neurons that exist in the larval <italic>MB</italic> and either represent approach or avoidance behavior. Plasticity at the <italic>KC</italic> :: <italic>MBON</italic> synapses facilitates the association of odors with reward or punishment (associative learning). <italic>KC</italic> :: <italic>MBON</italic> synapses employ a two factor learning rule: Pre-synaptic activation by an odor stimulus (action potential of the KC) triggers an exponentially decaying eligibility trace <italic>e</italic>(<italic>t</italic>), which determines the window of opportunity for synaptic change. Additional neuromodulatory input <italic>r</italic>(<italic>t</italic>) from one of the two <italic>DANs</italic> will lead to a reduction in synaptic strength (<xref rid="fig6" ref-type="fig">Figure 6<italic>C</italic></xref>) proportional to <italic>e</italic>(<italic>t</italic>) · <italic>r</italic>(<italic>t</italic>). The acquired imbalance between the outputs of the two <italic>MBONs</italic> (behavioral bias) represents the association of odors with rewards/punishments. An initially balanced interaction of excitatory and inhibitory feedback components from <italic>MBONs</italic> onto both <italic>DANs</italic> encodes the models’ learning history in form of a prediction error. The concept of prediction error suggests that associative learning about stimulus A is proportional to the difference between the reinforcement currently received with stimulus A minus the reinforcement predicted by stimulus A (previously learned association) (<xref ref-type="bibr" rid="c58">Rescorla, 1972</xref>). In vertebrates an implementation of this error signal has been demonstrated in dopaminergic neurons (<xref ref-type="bibr" rid="c74">Schultz, 2015</xref>, <xref ref-type="bibr" rid="c75">2016</xref>) and a similar mechanism is proposed for learning in the insect <italic>MB</italic> (<xref ref-type="bibr" rid="c60">Riemensperger et al., 2005</xref>; <xref ref-type="bibr" rid="c81">Springer and Nawrot, 2021</xref>; <xref ref-type="bibr" rid="c3">Bennett et al., 2021</xref>; <xref ref-type="bibr" rid="c29">Jürgensen et al., 2024</xref>). The time-resolved behavioral bias is used to compute gains for odors, which bias motor output of the virtual larvae.</p>
</sec>
</sec>
</sec>
</body>
<back>
<sec id="s8">
<title>Videos</title>
<p>Here we provide the videos cited in the text. All videos are derived from real or simulated experiments as visualized via the <italic><ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/larvaworld/">Larvaworld</ext-link></italic> software package, after some additional editing.</p>
</sec>
<ack>
<title>Acknowledgments</title>
<p>This project received funding from the Ministry of Culture and Science of the State of Northrhine Westphalia through the science network ‘iBehave’ (<ext-link ext-link-type="uri" xlink:href="https://ibehave.nrw/">https://ibehave.nrw/</ext-link>) within the program “Netzwerke 2021”, and from the German Research Foundation through the Research Unit ‘Structure, Plasticity and Behavioral Function of the <italic>Drosophila</italic> mushroom body’ (DFG-FOR 2705, grant no. 365082554, <ext-link ext-link-type="uri" xlink:href="https://www.unigoettingen.de/en/601524.html">https://www.unigoettingen.de/en/601524.html</ext-link>). PS received a stipendship within the Research Training Group ‘Neural Circuit Analysis’ (DFG-RTG 1960, grant no. 233886668). We would like to thank Michael Schleyer and Juliane Thoener for providing the tracking dataset and for valuable discussions on the data analyses. We thank Bertram Gerber for valuable discussion and Anna Morozova for substantial support with the generation of the video and figure material.</p>
</ack>
    <sec id="supp" sec-type="supplementary-material">
        <title>Additional files</title>
        <supplementary-material id="supp1">
            <label>Video 1.</label>
            <caption><title>Locomotory model for Drosophila larva.</title>
                <p>The function of the locomotory model in <xref rid="fig1" ref-type="fig">Figure 1<italic>B</italic></xref> is illustrated by gradually integrating its 4 modules (crawler, turner, oscillator-coupling, crawling-intermittency). In each of the 6 videos the implemented modules are shown in the inset.</p></caption>
            <media xlink:href="supplements/451470v2_video01.mp4"/>
        </supplementary-material>
        <supplementary-material id="supp2">
            <label>Video 2.</label>
            <caption><title>Free exploration simulation.</title>
                <p>A population of 25 real (left) or virtual (right) larvae is placed on a dish and left to freely explore. The body of the real larvae has been simplified into 2 segments as described in Video 4.</p></caption>
            <media xlink:href="supplements/451470v2_video02.mp4"/>
        </supplementary-material>
        <supplementary-material id="supp3">
            <label>Video 3.</label>
            <caption><title>Filter selection.</title>
                <p>The effect of inadequate or excessive filtering of the empirical larva recordings is illustrated. The left video shows the jittery original recording while the effect of lowpass filtering at cut-off frequencies of 4 Hz, 2 Hz and 0.5 Hz is shown on the rest. Selection of an intermediate 2 Hz cut-off frequency eliminates the unrealistic jitter while preserving the behaviorally relevant crawling frequency.</p></caption>
            <media xlink:href="supplements/451470v2_video03.mp4"/>
        </supplementary-material>
        <supplementary-material id="supp4">
            <label>Video 4.</label>
            <caption><title>Bisegmental larva-body simplification.</title>
                <p>The first video shows the original larva body as recorded by the tracker. 12 points are tracked along its longitudinal axis defining 11 segments while 22 points constitute the body contour. In the second video the body contour is dropped. In the third video an artificial rectangular contour is added for each body segment. In the last video the body-midline is segmented into 2 segments. The absolute head orientation angle <italic>θ</italic> is preserved while the single bending angle between the 2 segments is defined as <inline-formula><inline-graphic xlink:href="451470v2_inline48.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p></caption>
            <media xlink:href="supplements/451470v2_video04.mp4"/>
        </supplementary-material>
        <supplementary-material id="supp5">
            <label>Figure 2—video 1.</label>
            <caption><p>The full-length trajectory (A, E) colored according to angular and forward velocity.</p></caption>
            <media xlink:href="supplements/451470v2_video05.mp4"/>
        </supplementary-material>
        <supplementary-material id="supp6">
            <label>Figure 2—video 2.</label>
            <caption><p>The short track epoch depicted in the insets (A, E) colored according to forward and angular velocity.</p></caption>
            <media xlink:href="supplements/451470v2_video06.mp4"/>
        </supplementary-material>
        <supplementary-material id="supp7">
            <label>Figure 4—video 1.</label>
            <caption><p>The temporal course of dispersal for real (left) and virtual (right) larvae shown in (A).</p></caption>
            <media xlink:href="supplements/451470v2_video07.mp4"/>
        </supplementary-material>
        <supplementary-material id="supp8">
            <label>Figure 5—video 1.</label>
            <caption><p>Time course of the two simulated chemotaxis experiments.</p></caption>
            <media xlink:href="supplements/451470v2_video08.mp4"/>
        </supplementary-material>
        <supplementary-material id="supp9">
            <label>Figure 6—video 1.</label>
            <caption><p>Two odor preference simulations, one with an appetitive and one with an aversive odor source placed on the left side of the dish. A non-valenced odor source is placed on the right side.</p></caption>
            <media xlink:href="supplements/451470v2_video09.mp4"/>
        </supplementary-material>
    </sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Almeida-Carvalho</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Berh</surname> <given-names>D</given-names></string-name>, <string-name><surname>Braun</surname> <given-names>A</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>YC</given-names></string-name>, <string-name><surname>Eichler</surname> <given-names>K</given-names></string-name>, <string-name><surname>Eschbach</surname> <given-names>C</given-names></string-name>, <string-name><surname>Fritsch</surname> <given-names>PMJ</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B</given-names></string-name>, <string-name><surname>Hoyer</surname> <given-names>N</given-names></string-name>, <string-name><surname>Jiang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Kleber</surname> <given-names>J</given-names></string-name>, <string-name><surname>Klämbt</surname> <given-names>C</given-names></string-name>, <string-name><surname>König</surname> <given-names>C</given-names></string-name>, <string-name><surname>Louis</surname> <given-names>M</given-names></string-name>, <string-name><surname>Michels</surname> <given-names>B</given-names></string-name>, <string-name><surname>Miroschnikow</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mirth</surname> <given-names>C</given-names></string-name>, <string-name><surname>Miura</surname> <given-names>D</given-names></string-name>, <string-name><surname>Niewalda</surname> <given-names>T</given-names></string-name>, <string-name><surname>Otto</surname> <given-names>N</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>The Ol1mpiad: Concordance of behavioural faculties of stage 1 and stage 3 Drosophila larvae</article-title>. <source>J Exp Biol</source>. <year>2017</year>; <volume>220</volume>(<issue>13</issue>):<fpage>2452</fpage>–<lpage>2475</lpage>. doi: <pub-id pub-id-type="doi">10.1242/jeb.156646</pub-id>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Belle</surname> <given-names>JS</given-names></string-name>, <string-name><surname>Heisenberg</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Associative Odor Learning in Drosophila Abolished by Chemical Ablation of Mushroom Bodies</article-title>. <source>Science</source>. <year>1994</year>; <volume>263</volume>(<issue>5147</issue>):<fpage>692</fpage>–<lpage>695y</lpage>. doi: <pub-id pub-id-type="doi">10.1126/science.8303280</pub-id>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bennett</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Philippides</surname> <given-names>A</given-names></string-name>, <string-name><surname>Nowotny</surname> <given-names>T.</given-names></string-name></person-group> <article-title>Learning with reinforcement prediction errors in a model of the Drosophila mushroom body</article-title>. <source>Nature communications</source>. <year>2021</year>; <volume>12</volume>(<issue>1</issue>):<fpage>2569</fpage>. doi: <pub-id pub-id-type="doi">10.1038/s41467-021-22592-4</pub-id>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berni</surname> <given-names>J.</given-names></string-name></person-group> <article-title>Genetic dissection of a regionally differentiated network for exploratory behavior in drosophila larvae</article-title>. <source>Curr Biol</source>. <year>2015</year>; <volume>25</volume>(<issue>10</issue>):<fpage>1319</fpage>–<lpage>1326</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.cub.2015.03.023</pub-id>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berni</surname> <given-names>J</given-names></string-name>, <string-name><surname>Pulver</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Griffith</surname> <given-names>LC</given-names></string-name>, <string-name><surname>Bate</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Autonomous circuitry for substrate exploration in freely moving drosophila larvae</article-title>. <source>Curr Biol</source>. <year>2012</year>; <volume>22</volume>(<issue>20</issue>):<fpage>1861</fpage>–<lpage>1870</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.cub.2012.07.048</pub-id>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="thesis"><person-group person-group-type="author"><string-name><surname>Bicho</surname> <given-names>E.</given-names></string-name></person-group> <article-title>Dynamic approach to behavior-based robotics : design, specification, analysis, simulation and implementation</article-title>, <publisher-name>University of Minho</publisher-name>; <year>1999</year>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bidaye</surname> <given-names>SS</given-names></string-name>, <string-name><surname>Laturney</surname> <given-names>M</given-names></string-name>, <string-name><surname>Chang</surname> <given-names>AK</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Bockemühl</surname> <given-names>T</given-names></string-name>, <string-name><surname>Büschges</surname> <given-names>A</given-names></string-name>, <string-name><surname>Scott</surname> <given-names>K.</given-names></string-name></person-group> <article-title>Two brain pathways initiate distinct forward walking programs in Drosophila</article-title>. <source>Neuron</source>. <year>2020</year>; <volume>108</volume>(<issue>3</issue>):<fpage>469</fpage>–<lpage>485</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2020.07.032</pub-id>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brooks</surname> <given-names>R.</given-names></string-name></person-group> <article-title>A Robust Layered Control System For A Mobile Robot</article-title>. <source>IEEE J Robot Autom</source>. <year>1986</year>; <volume>RA-2</volume>(<issue>I</issue>):<fpage>14</fpage>–<lpage>23</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davies</surname> <given-names>A</given-names></string-name>, <string-name><surname>Louis</surname> <given-names>M</given-names></string-name>, <string-name><surname>Webb</surname> <given-names>B.</given-names></string-name></person-group> <article-title>A Model of Drosophila Larva Chemotaxis</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>; <volume>11</volume>(<issue>11</issue>):<fpage>1</fpage>–<lpage>24</lpage>. doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004606</pub-id>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Denisov</surname> <given-names>G</given-names></string-name>, <string-name><surname>Ohyama</surname> <given-names>T</given-names></string-name>, <string-name><surname>Jovanic</surname> <given-names>T</given-names></string-name>, <string-name><surname>Zlatic</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Model-based detection and analysis of animal behaviors using signals extracted by automated tracking</article-title>. <conf-name>BIOSIGNALS 2013 - Proc Int Conf Bio-Inspired Syst Signal Process</conf-name>. <year>2013</year>; p. <fpage>175</fpage>–<lpage>181</lpage>. doi: <pub-id pub-id-type="doi">10.5220/0004235101750181</pub-id>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diegelmann</surname> <given-names>S</given-names></string-name>, <string-name><surname>Klagges</surname> <given-names>B</given-names></string-name>, <string-name><surname>Michels</surname> <given-names>B</given-names></string-name>, <string-name><surname>Schleyer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Maggot learning and synapsin function</article-title>. <source>J Exp Biol</source>. <year>2013</year>; <volume>216</volume>(<issue>6</issue>):<fpage>939</fpage>–<lpage>951</lpage>. doi: <pub-id pub-id-type="doi">10.1242/jeb.076208</pub-id>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dolan</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Belliart-Guérin</surname> <given-names>G</given-names></string-name>, <string-name><surname>Bates</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Frechter</surname> <given-names>S</given-names></string-name>, <string-name><surname>Lampin-Saint-Amaux</surname> <given-names>A</given-names></string-name>, <string-name><surname>Aso</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Roberts</surname> <given-names>RJV</given-names></string-name>, <string-name><surname>Schlegel</surname> <given-names>P</given-names></string-name>, <string-name><surname>Wong</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hammad</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bock</surname> <given-names>D</given-names></string-name>, <string-name><surname>Rubin</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Preat</surname> <given-names>T</given-names></string-name>, <string-name><surname>Plaçais</surname> <given-names>PY</given-names></string-name>, <string-name><surname>Jefferis</surname> <given-names>GSXE.</given-names></string-name></person-group> <article-title>Communication from Learned to Innate Olfactory Processing Centers Is Required for Memory Retrieval in Drosophila</article-title>. <source>Neuron</source>. <year>2018</year>; <volume>100</volume>(<issue>3</issue>):<fpage>651</fpage>–<lpage>668.e8.</lpage> doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2018.08.037</pub-id>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eschbach</surname> <given-names>C</given-names></string-name>, <string-name><surname>Fushiki</surname> <given-names>A</given-names></string-name>, <string-name><surname>Winding</surname> <given-names>M</given-names></string-name>, <string-name><surname>Schneider-Mizell</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Shao</surname> <given-names>M</given-names></string-name>, <string-name><surname>Arruda</surname> <given-names>R</given-names></string-name>, <string-name><surname>Eichler</surname> <given-names>K</given-names></string-name>, <string-name><surname>Valdes-Aleman</surname> <given-names>J</given-names></string-name>, <string-name><surname>Ohyama</surname> <given-names>T</given-names></string-name>, <string-name><surname>Thum</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B</given-names></string-name>, <string-name><surname>Fetter</surname> <given-names>RD</given-names></string-name>, <string-name><surname>Truman</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Litwin-Kumar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Zlatic</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Recurrent architecture for adaptive regulation of learning in the insect brain</article-title>. <source>Nat Neurosci</source>. <year>2020</year>; <volume>23</volume>(<issue>4</issue>):<fpage>544</fpage>–<lpage>555</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41593-020-0607-9</pub-id>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eschbach</surname> <given-names>C</given-names></string-name>, <string-name><surname>Zlatic</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Useful road maps: studying Drosophila larva’s central nervous system with the help of connectomics</article-title>. <source>Curr Opin Neurobiol</source>. <year>2020</year>; <volume>65</volume>:<fpage>129</fpage>–<lpage>137</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.conb.2020.09.008</pub-id>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Felsenberg</surname> <given-names>J</given-names></string-name>, <string-name><surname>Waddell</surname> <given-names>S.</given-names></string-name></person-group> <article-title>Switching Gears, Structuring the Right Search Strategy</article-title>. <source>Neuron</source>. <year>2019</year>; <volume>102</volume>(<issue>2</issue>):<fpage>273</fpage>–<lpage>275</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2019.03.040</pub-id>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Feng</surname> <given-names>K</given-names></string-name>, <string-name><surname>Sen</surname> <given-names>R</given-names></string-name>, <string-name><surname>Minegishi</surname> <given-names>R</given-names></string-name>, <string-name><surname>Dübbert</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bockemühl</surname> <given-names>T</given-names></string-name>, <string-name><surname>Büschges</surname> <given-names>A</given-names></string-name>, <string-name><surname>Dickson</surname> <given-names>BJ</given-names></string-name></person-group>. <article-title>Distributed control of motor circuits for backward walking in Drosophila</article-title>. <source>Nature Communications</source>. <year>2020</year> <month>Dec</month>; <volume>11</volume>(<issue>1</issue>):<fpage>6166</fpage>. <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/s41467-020-19936-x">https://www.nature.com/articles/s41467-020-19936-x</ext-link>, doi: <pub-id pub-id-type="doi">10.1038/s41467-020-19936-x</pub-id>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gerber</surname> <given-names>B</given-names></string-name>, <string-name><surname>Stocker</surname> <given-names>RF</given-names></string-name></person-group>. <article-title>The drosophila larva as a model for studying chemosensation and chemosensory learning: A review</article-title>. <source>Chem Senses</source>. <year>2007</year>; <volume>32</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>89</lpage>. doi: <pub-id pub-id-type="doi">10.1093/chemse/bjl030</pub-id>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gerber</surname> <given-names>B</given-names></string-name>, <string-name><surname>Yarali</surname> <given-names>A</given-names></string-name>, <string-name><surname>Diegelmann</surname> <given-names>S</given-names></string-name>, <string-name><surname>Wotjak</surname> <given-names>CT</given-names></string-name>, <string-name><surname>Pauli</surname> <given-names>P</given-names></string-name>, <string-name><surname>Fendt</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Pain-relief learning in flies, rats, and man: Basic research and applied perspectives</article-title>. <source>Learn Mem</source>. <year>2014</year>; <volume>21</volume>(<issue>4</issue>):<fpage>232</fpage>–<lpage>252</lpage>. doi: <pub-id pub-id-type="doi">10.1101/lm.032995.113</pub-id>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gerhard</surname> <given-names>S</given-names></string-name>, <string-name><surname>Andrade</surname> <given-names>I</given-names></string-name>, <string-name><surname>Fetter</surname> <given-names>RD</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Schneider-Mizell</surname> <given-names>CM</given-names></string-name></person-group>. <article-title>Conserved neural circuit structure across drosophila larval development revealed by comparative connectomics</article-title>. <source>eLife</source>. <year>2017</year>; <volume>6</volume>:<fpage>1</fpage>–<lpage>17</lpage>. doi: <pub-id pub-id-type="doi">10.7554/eLife.29089</pub-id>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gjorgjieva</surname> <given-names>J</given-names></string-name>, <string-name><surname>Berni</surname> <given-names>J</given-names></string-name>, <string-name><surname>Evers</surname> <given-names>JF</given-names></string-name>, <string-name><surname>Eglen</surname> <given-names>SJ</given-names></string-name></person-group>. <article-title>Neural circuits for peristaltic wave propagation in crawling drosophila larvae: Analysis and modeling</article-title>. <source>Front Comput Neurosci</source>. <year>2013</year>; <volume>7</volume>(<issue>MAR</issue>):<fpage>1</fpage>–<lpage>19</lpage>. doi: <pub-id pub-id-type="doi">10.3389/fncom.2013.00024</pub-id>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gomez-Marin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Louis</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Active sensation during orientation behavior in the Drosophila larva: More sense than luck</article-title>. <source>Curr Opin Neurobiol</source>. <year>2012</year>; <volume>22</volume>(<issue>2</issue>):<fpage>208</fpage>–<lpage>215</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.conb.2011.11.008</pub-id>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gomez-Marin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Stephens</surname> <given-names>GJ</given-names></string-name>, <string-name><surname>Louis</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Active sampling and decision making in Drosophila chemotaxis</article-title>. <source>Nat Commun</source>. <year>2011</year>; <volume>2</volume>(<issue>1</issue>):<fpage>410</fpage>–<lpage>441</lpage>. doi: <pub-id pub-id-type="doi">10.1038/ncomms1455</pub-id>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Günther</surname> <given-names>MN</given-names></string-name>, <string-name><surname>Nettesheim</surname> <given-names>G</given-names></string-name>, <string-name><surname>Shubeita</surname> <given-names>GT</given-names></string-name></person-group>. <article-title>Quantifying and predicting Drosophila larvae crawling phenotypes</article-title>. <source>Sci Rep</source>. <year>2016</year>; <volume>6</volume>:<fpage>1</fpage>–<lpage>10</lpage>. doi: <pub-id pub-id-type="doi">10.1038/srep27972</pub-id>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heckscher</surname> <given-names>ES</given-names></string-name>, <string-name><surname>Lockery</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Doe</surname> <given-names>CQ</given-names></string-name></person-group>. <article-title>Characterization of Drosophila Larval Crawling at the Level of Organism, Segment, and Somatic Body Wall Musculature</article-title>. <source>J Neurosci</source>. <year>2012</year>; <volume>32</volume>(<issue>36</issue>):<fpage>12460</fpage>–<lpage>12471</lpage>. doi: <pub-id pub-id-type="doi">10.1523/jneurosci.0222-12.2012</pub-id>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Helgadottir</surname> <given-names>LI</given-names></string-name>, <string-name><surname>Haenicke</surname> <given-names>J</given-names></string-name>, <string-name><surname>Landgraf</surname> <given-names>T</given-names></string-name>, <string-name><surname>Rojas</surname> <given-names>R</given-names></string-name>, <string-name><surname>Nawrot</surname> <given-names>MP</given-names></string-name></person-group>. <article-title>Conditioned behavior in a robot controlled by a spiking neural network</article-title>. <conf-name>Int. IEEE/EMBS Conf. Neural Eng. NER</conf-name>; <year>2013</year>. doi: <pub-id pub-id-type="doi">10.1109/NER.2013.6696078</pub-id>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Imambocus</surname> <given-names>BN</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>F</given-names></string-name>, <string-name><surname>Formozov</surname> <given-names>A</given-names></string-name>, <string-name><surname>Wittich</surname> <given-names>A</given-names></string-name>, <string-name><surname>Tenedini</surname> <given-names>FM</given-names></string-name>, <string-name><surname>Hu</surname> <given-names>C</given-names></string-name>, <string-name><surname>Sauter</surname> <given-names>K</given-names></string-name>, <string-name><surname>Macarenhas Varela</surname> <given-names>E</given-names></string-name>, <string-name><surname>Herédia</surname> <given-names>F</given-names></string-name>, <string-name><surname>Casimiro</surname> <given-names>AP</given-names></string-name>, <string-name><surname>Macedo</surname> <given-names>A</given-names></string-name>, <string-name><surname>Schlegel</surname> <given-names>P</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>CH</given-names></string-name>, <string-name><surname>Miguel-Aliaga</surname> <given-names>I</given-names></string-name>, <string-name><surname>Wiegert</surname> <given-names>JS</given-names></string-name>, <string-name><surname>Pankratz</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Gontijo</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Soba</surname> <given-names>P.</given-names></string-name></person-group> <article-title>A neuropeptidergic circuit gates selective escape behavior of Drosophila larvae</article-title>. <source>Current Biology</source>. <year>2022</year>; <volume>32</volume>(<issue>1</issue>):<fpage>149</fpage>–<lpage>163.e8.</lpage> doi: <pub-id pub-id-type="doi">10.1016/j.cub.2021.10.069</pub-id>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jovanic</surname> <given-names>T.</given-names></string-name></person-group> <article-title>Studying neural circuits of decision-making in Drosophila larva</article-title>. <source>J Neurogenet</source>. <year>2020</year>; <volume>34</volume>(<issue>1</issue>):<fpage>162</fpage>–<lpage>170</lpage>. doi: <pub-id pub-id-type="doi">10.1080/01677063.2020.1719407</pub-id>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jürgensen</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Khalili</surname> <given-names>A</given-names></string-name>, <string-name><surname>Chicca</surname> <given-names>E</given-names></string-name>, <string-name><surname>Indiveri</surname> <given-names>G</given-names></string-name>, <string-name><surname>Nawrot</surname> <given-names>MP</given-names></string-name></person-group>. <article-title>A neuromorphic model of olfactory processing and sparse coding in the Drosophila larva brain</article-title>. <source>Neuromorphic Comput Eng</source>. <year>2021</year>; doi: <pub-id pub-id-type="doi">10.1088/2634-4386/ac3ba6</pub-id>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jürgensen</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Sakagiannis</surname> <given-names>P</given-names></string-name>, <string-name><surname>Schleyer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B</given-names></string-name>, <string-name><surname>Nawrot</surname> <given-names>MP</given-names></string-name></person-group>. <article-title>Prediction error drives associative learning and conditioned behavior in a spiking model of Drosophila larva</article-title>. <source>iScience</source>. <year>2024</year> <month>Jan</month>; <volume>27</volume>(<issue>1</issue>):<fpage>108640</fpage>. <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S2589004223027177">https://linkinghub.elsevier.com/retrieve/pii/S2589004223027177</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.isci.2023.108640</pub-id>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Kafle</surname> <given-names>T</given-names></string-name>, <string-name><surname>Grub</surname> <given-names>M</given-names></string-name>, <string-name><surname>Sakagiannis</surname> <given-names>P</given-names></string-name>, <string-name><surname>Nawrot</surname> <given-names>MP</given-names></string-name>, <string-name><surname>Arguello</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Fast and recurrent evolution of temperature preference among drosophilids</article-title>. <source>bioRxiv</source>. <year>2024</year> <month>Mar</month>; <ext-link ext-link-type="uri" xlink:href="http://biorxiv.org/lookup/doi/10.1101/2024.03.15.585210">http://biorxiv.org/lookup/doi/10.1101/2024.03.15.585210</ext-link>, doi: <pub-id pub-id-type="doi">10.1101/2024.03.15.585210</pub-id>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karagyozov</surname> <given-names>D</given-names></string-name>, <string-name><surname>Mihovilovic Skanata</surname> <given-names>M</given-names></string-name>, <string-name><surname>Lesar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gershow</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Recording Neural Activity in Unrestrained Animals with Three-Dimensional Tracking Two-Photon Microscopy</article-title>. <source>Cell Reports</source>. <year>2018</year> <month>Oct</month>; <volume>25</volume>(<issue>5</issue>):<fpage>1371</fpage>–<lpage>1383.e10.</lpage> <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S2211124718315766">https://linkinghub.elsevier.com/retrieve/pii/S2211124718315766</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.celrep.2018.10.013</pub-id>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname> <given-names>D</given-names></string-name>, <string-name><surname>Alvarez</surname> <given-names>M</given-names></string-name>, <string-name><surname>Lechuga</surname> <given-names>LM</given-names></string-name>, <string-name><surname>Louis</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Species-specific modulation of food-search behavior by respiration and chemosensation in Drosophila larvae</article-title>. <source>eLife</source>. <year>2017</year>; <volume>6</volume>:<fpage>1</fpage>–<lpage>23</lpage>. doi: <pub-id pub-id-type="doi">10.7554/eLife.27057</pub-id>.</mixed-citation></ref>
    <ref id="c33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname> <given-names>M</given-names></string-name>, <string-name><surname>Krivov</surname> <given-names>SV</given-names></string-name>, <string-name><surname>Ferrer</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Luo</surname> <given-names>L</given-names></string-name>, <string-name><surname>Samuel</surname> <given-names>AD</given-names></string-name>, <string-name><surname>Karplus</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Exploratory search during directed navigation in C. elegans and Drosophila larva</article-title>. <source>Elife</source>. <year>2017</year>; <volume>6</volume>:<fpage>1</fpage>–<lpage>14</lpage>. doi: <pub-id pub-id-type="doi">10.7554/elife.30503</pub-id>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kohsaka</surname> <given-names>H</given-names></string-name>, <string-name><surname>Zwart</surname> <given-names>MF</given-names></string-name>, <string-name><surname>Fushiki</surname> <given-names>A</given-names></string-name>, <string-name><surname>Fetter</surname> <given-names>RD</given-names></string-name>, <string-name><surname>Truman</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Nose</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Regulation of forward and backward locomotion through intersegmental feedback circuits in Drosophila larvae</article-title>. <source>Nat Commun</source>. <year>2019</year>; <volume>10</volume>(<issue>1</issue>):<fpage>2654</fpage>. <ext-link ext-link-type="uri" xlink:href="http://www.nature.com/articles/s41467-019-10695-y">http://www.nature.com/articles/s41467-019-10695-y</ext-link>, doi: <pub-id pub-id-type="doi">10.1038/s41467-019-10695-y</pub-id>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>König</surname> <given-names>C</given-names></string-name>, <string-name><surname>Khalili</surname> <given-names>A</given-names></string-name>, <string-name><surname>Ganesan</surname> <given-names>M</given-names></string-name>, <string-name><surname>Nishu</surname> <given-names>AP</given-names></string-name>, <string-name><surname>Garza</surname> <given-names>AP</given-names></string-name>, <string-name><surname>Niewalda</surname> <given-names>T</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B</given-names></string-name>, <string-name><surname>Aso</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Yarali</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Reinforcement signaling of punishment versus relief in fruit flies</article-title>. <source>Learn Mem</source>. <year>2018</year>; <volume>25</volume>(<issue>6</issue>):<fpage>247</fpage>–<lpage>257</lpage>. doi: <pub-id pub-id-type="doi">10.1101/lm.047308.118</pub-id>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lahiri</surname> <given-names>S</given-names></string-name>, <string-name><surname>Shen</surname> <given-names>K</given-names></string-name>, <string-name><surname>Klein</surname> <given-names>M</given-names></string-name>, <string-name><surname>Tang</surname> <given-names>A</given-names></string-name>, <string-name><surname>Kane</surname> <given-names>E</given-names></string-name>, <string-name><surname>Gershow</surname> <given-names>M</given-names></string-name>, <string-name><surname>Garrity</surname> <given-names>P</given-names></string-name>, <string-name><surname>Samuel</surname> <given-names>ADT</given-names></string-name></person-group>. <article-title>Two alternating motor programs drive navigation in Drosophila larva</article-title>. <source>PLoS One</source>. <year>2011</year>; <volume>6</volume>(<issue>8</issue>). doi: <pub-id pub-id-type="doi">10.1371/journal.pone.0023180</pub-id>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laurent</surname> <given-names>F</given-names></string-name>, <string-name><surname>Blanc</surname> <given-names>A</given-names></string-name>, <string-name><surname>May</surname> <given-names>L</given-names></string-name>, <string-name><surname>Gándara</surname> <given-names>L</given-names></string-name>, <string-name><surname>Cocanougher</surname> <given-names>BT</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>BMW</given-names></string-name>, <string-name><surname>Hague</surname> <given-names>P</given-names></string-name>, <string-name><surname>Barré</surname> <given-names>C</given-names></string-name>, <string-name><surname>Vestergaard</surname> <given-names>CL</given-names></string-name>, <string-name><surname>Crocker</surname> <given-names>J</given-names></string-name>, <string-name><surname>Zlatic</surname> <given-names>M</given-names></string-name>, <string-name><surname>Jovanic</surname> <given-names>T</given-names></string-name>, <string-name><surname>Masson</surname> <given-names>JB</given-names></string-name></person-group>. <article-title>LarvaTagger: manual and automatic tagging of Drosophila larval behaviour</article-title>. <source>Bioinformatics</source>. <year>2024</year> <month>Jul</month>; <volume>40</volume>(<issue>7</issue>):<fpage>btae441</fpage>. <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/bioinformatics/article/doi/10.1093/bioinformatics/btae441/7708398">https://academic.oup.com/bioinformatics/article/doi/10.1093/bioinformatics/btae441/7708398</ext-link>, doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btae441</pub-id>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lesar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Tahir</surname> <given-names>J</given-names></string-name>, <string-name><surname>Wolk</surname> <given-names>J</given-names></string-name>, <string-name><surname>Gershow</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Switch-like and persistent memory formation in individual Drosophila larvae</article-title>. <source>eLife</source>. <year>2021</year>; <volume>10</volume>:<elocation-id>e70317</elocation-id>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Loveless</surname> <given-names>J</given-names></string-name>, <string-name><surname>Lagogiannis</surname> <given-names>K</given-names></string-name>, <string-name><surname>Webb</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Modelling the neuromechanics of exploration in larval Drosophila</article-title>. <source>PLoS Comput Biol</source>. <year>2019</year>; <volume>15</volume>:<fpage>7</fpage>. doi: <pub-id pub-id-type="doi">10.5281/zenodo.1432637</pub-id>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Loveless</surname> <given-names>J</given-names></string-name>, <string-name><surname>Webb</surname> <given-names>B.</given-names></string-name></person-group> <article-title>A Neuromechanical Model of Larval Chemotaxis</article-title>. <source>Integr Comp Biol</source>. <year>2018</year>; <volume>58</volume>(<issue>5</issue>):<fpage>906</fpage>–<lpage>914</lpage>. doi: <pub-id pub-id-type="doi">10.1093/icb/icy094</pub-id>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malloy</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Somasundaram</surname> <given-names>E</given-names></string-name>, <string-name><surname>Omar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bhutto</surname> <given-names>U</given-names></string-name>, <string-name><surname>Medley</surname> <given-names>M</given-names></string-name>, <string-name><surname>Dzubuk</surname> <given-names>N</given-names></string-name>, <string-name><surname>Cooper</surname> <given-names>RL</given-names></string-name></person-group>. <article-title>Pharmacological identification of cholinergic receptor subtypes: modulation of locomotion and neural circuit excitability in Drosophila larvae</article-title>. <source>Neuroscience</source>. <year>2019</year>; <volume>411</volume>:<fpage>47</fpage>–<lpage>64</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.neuroscience.2019.05.016</pub-id>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mantziaris</surname> <given-names>C</given-names></string-name>, <string-name><surname>Bockemühl</surname> <given-names>T</given-names></string-name>, <string-name><surname>Büschges</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Central Pattern Generating Networks in Insect Locomotion</article-title>. <source>Dev Neurobiol</source>. <year>2020</year>; <volume>00</volume>(<issue>October 2019</issue>):<fpage>1</fpage>–<lpage>15</lpage>. doi: <pub-id pub-id-type="doi">10.1002/dneu.22738</pub-id>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marken</surname> <given-names>RS</given-names></string-name>, <string-name><surname>Shaffer</surname> <given-names>DM</given-names></string-name></person-group>. <article-title>The power law of movement : an example of a behavioral illusion</article-title>. <source>Exp Brain Res</source>. <year>2017</year>; <volume>235</volume>(<issue>6</issue>):<fpage>1835</fpage>–<lpage>1842</lpage>. doi: <pub-id pub-id-type="doi">10.1007/s00221-017-4939-y</pub-id>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marken</surname> <given-names>RS</given-names></string-name>, <string-name><surname>Shaffer</surname> <given-names>DM</given-names></string-name></person-group>. <article-title>The power law as behavioral illusion: reappraising the reappraisals</article-title>. <source>Exp Brain Res</source>. <year>2018</year>; <volume>236</volume>(<issue>5</issue>):<fpage>1537</fpage>–<lpage>1544</lpage>. doi: <pub-id pub-id-type="doi">10.1007/s00221-018-5208-4</pub-id>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Michels</surname> <given-names>B</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>YC</given-names></string-name>, <string-name><surname>Saumweber</surname> <given-names>T</given-names></string-name>, <string-name><surname>Mishra</surname> <given-names>D</given-names></string-name>, <string-name><surname>Tanimoto</surname> <given-names>H</given-names></string-name>, <string-name><surname>Schmid</surname> <given-names>B</given-names></string-name>, <string-name><surname>Engmann</surname> <given-names>O</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Cellular site and molecular mode of synapsin action in associative learning</article-title>. <source>Learn Mem</source>. <year>2011</year>; <volume>18</volume>(<issue>5</issue>):<fpage>332</fpage>–<lpage>344</lpage>. doi: <pub-id pub-id-type="doi">10.1101/lm.2101411</pub-id>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Michels</surname> <given-names>B</given-names></string-name>, <string-name><surname>Saumweber</surname> <given-names>T</given-names></string-name>, <string-name><surname>Biernacki</surname> <given-names>R</given-names></string-name>, <string-name><surname>Thum</surname> <given-names>J</given-names></string-name>, <string-name><surname>Glasgow</surname> <given-names>RDV</given-names></string-name>, <string-name><surname>Schleyer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>YC</given-names></string-name>, <string-name><surname>Eschbach</surname> <given-names>C</given-names></string-name>, <string-name><surname>Stocker</surname> <given-names>RF</given-names></string-name>, <string-name><surname>Toshima</surname> <given-names>N</given-names></string-name>, <string-name><surname>Tanimura</surname> <given-names>T</given-names></string-name>, <string-name><surname>Louis</surname> <given-names>M</given-names></string-name>, <string-name><surname>Arias-Gil</surname> <given-names>G</given-names></string-name>, <string-name><surname>Marescotti</surname> <given-names>M</given-names></string-name>, <string-name><surname>Benfenati</surname> <given-names>F</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Pavlovian conditioning of larval Drosophila: An illustrated, multilingual, hands-on manual for odor-taste associative learning in maggots</article-title>. <source>Front Behav Neurosci</source>. <year>2017</year>; <volume>11</volume>(<issue>April</issue>):<fpage>1</fpage>–<lpage>6</lpage>. doi: <pub-id pub-id-type="doi">10.3389/fnbeh.2017.00045</pub-id>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miroschnikow</surname> <given-names>A</given-names></string-name>, <string-name><surname>Schlegel</surname> <given-names>P</given-names></string-name>, <string-name><surname>Schoofs</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hueckesfeld</surname> <given-names>S</given-names></string-name>, <string-name><surname>Li</surname> <given-names>F</given-names></string-name>, <string-name><surname>Schneider-Mizell</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Fetter</surname> <given-names>RD</given-names></string-name>, <string-name><surname>Truman</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pankratz</surname> <given-names>MJ</given-names></string-name></person-group>. <article-title>Convergence of monosynaptic and polysynaptic sensory paths onto common motor outputs in a Drosophila feeding connectome</article-title>. <source>eLife</source>. <year>2018</year> <conf-date>ec</conf-date>; <volume>7</volume>:<elocation-id>e40247</elocation-id>. doi: <pub-id pub-id-type="doi">10.7554/eLife.40247</pub-id>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miroschnikow</surname> <given-names>A</given-names></string-name>, <string-name><surname>Schlegel</surname> <given-names>P</given-names></string-name>, <string-name><surname>Schoofs</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hueckesfeld</surname> <given-names>S</given-names></string-name>, <string-name><surname>Li</surname> <given-names>F</given-names></string-name>, <string-name><surname>Schneider-Mizell</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Fetter</surname> <given-names>RD</given-names></string-name>, <string-name><surname>Truman</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pankratz</surname> <given-names>MJ</given-names></string-name></person-group>. <article-title>The Feeding Connectome: Convergence of Monosynaptic and Polysynaptic Sensory Paths onto Common Motor Outputs</article-title>. <source>eLife</source>. <year>2018</year>; <volume>7</volume>:<fpage>1</fpage>–<lpage>23</lpage>. doi: <pub-id pub-id-type="doi">10.7554/elife.40247</pub-id>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Niewalda</surname> <given-names>T</given-names></string-name>, <string-name><surname>Jeske</surname> <given-names>I</given-names></string-name>, <string-name><surname>Michels</surname> <given-names>B</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> ‘<article-title>Peer pressure’ in larval Drosophila</article-title>? <source>Biol Open</source>. <year>2014</year>; <volume>3</volume>(<issue>7</issue>):<fpage>575</fpage>–<lpage>582</lpage>. doi: <pub-id pub-id-type="doi">10.1242/bio.20148458</pub-id>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ohyama</surname> <given-names>T</given-names></string-name>, <string-name><surname>Jovanic</surname> <given-names>T</given-names></string-name>, <string-name><surname>Denisov</surname> <given-names>G</given-names></string-name>, <string-name><surname>Dang</surname> <given-names>TC</given-names></string-name>, <string-name><surname>Hoffmann</surname> <given-names>D</given-names></string-name>, <string-name><surname>Kerr</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Zlatic</surname> <given-names>M.</given-names></string-name></person-group> <article-title>High-Throughput Analysis of Stimulus-Evoked Behaviors in Drosophila Larva Reveals Multiple Modality-Specific Escape Strategies</article-title>. <source>PLoS One</source>. <year>2013</year>; <volume>8</volume>(<issue>8</issue>). doi: <pub-id pub-id-type="doi">10.1371/journal.pone.0071706</pub-id>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Owald</surname> <given-names>D</given-names></string-name>, <string-name><surname>Felsenberg</surname> <given-names>J</given-names></string-name>, <string-name><surname>Talbot</surname> <given-names>CB</given-names></string-name>, <string-name><surname>Das</surname> <given-names>G</given-names></string-name>, <string-name><surname>Perisse</surname> <given-names>E</given-names></string-name>, <string-name><surname>Huetteroth</surname> <given-names>W</given-names></string-name>, <string-name><surname>Waddell</surname> <given-names>S.</given-names></string-name></person-group> <article-title>Activity of defined mushroom body output neurons underlies learned olfactory behavior in Drosophila</article-title>. <source>Neuron</source>. <year>2015</year>; <volume>86</volume>(<issue>2</issue>):<fpage>417</fpage>–<lpage>427</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2015.03.025</pub-id>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Owald</surname> <given-names>D</given-names></string-name>, <string-name><surname>Waddell</surname> <given-names>S.</given-names></string-name></person-group> <article-title>Olfactory learning skews mushroom body output pathways to steer behavioral choice in Drosophila</article-title>. <source>Curr Opin Neurobiol</source>. <year>2015</year>; <volume>35</volume>(<issue>Figure 1</issue>):<fpage>178</fpage>–<lpage>184</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.conb.2015.10.002</pub-id>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paisios</surname> <given-names>E</given-names></string-name>, <string-name><surname>Rjosk</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pamir</surname> <given-names>E</given-names></string-name>, <string-name><surname>Schleyer</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Common microbehavioral “footprint” of two distinct classes of conditioned aversion</article-title>. <source>Learn Mem</source>. <year>2017</year>; <volume>24</volume>(<issue>5</issue>):<fpage>191</fpage>–<lpage>198</lpage>. doi: <pub-id pub-id-type="doi">10.1101/lm.045062.117</pub-id>.</mixed-citation></ref>
    <ref id="c54"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pehlevan</surname> <given-names>C</given-names></string-name>, <string-name><surname>Paoletti</surname> <given-names>P</given-names></string-name>, <string-name><surname>Mahadevan</surname> <given-names>L.</given-names></string-name></person-group> <article-title>Integrative neuromechanics of crawling in D. melanogaster larvae</article-title>. <source>Elife</source>. <year>2016</year>; <volume>5</volume>:<fpage>1</fpage>–<lpage>23</lpage>. doi: <pub-id pub-id-type="doi">10.7554/elife.11031</pub-id>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Prescott</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Redgrave</surname> <given-names>P</given-names></string-name>, <string-name><surname>Gurney</surname> <given-names>K.</given-names></string-name></person-group> <article-title>Layered control architectures in robots and vertebrates</article-title>. <source>Adapt Behav</source>. <year>1999</year>; <volume>7</volume>(<issue>1</issue>):<fpage>99</fpage>–<lpage>127</lpage>. doi: <pub-id pub-id-type="doi">10.1177/105971239900700105</pub-id>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Prescott</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>SP</given-names></string-name></person-group>. <article-title>Understanding brain functional architecture through robotics</article-title>. <source>Science Robotics</source>. <year>2023</year> <month>May</month>; <volume>8</volume>(<issue>78</issue>). <ext-link ext-link-type="uri" xlink:href="https://www.science.org/doi/10.1126/scirobotics.adg6014">https://www.science.org/doi/10.1126/scirobotics.adg6014</ext-link>, doi: <pub-id pub-id-type="doi">10.1126/scirobotics.adg6014</pub-id>, publisher: <publisher-name>American Association for the Advancement of Science (AAAS)</publisher-name>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qian</surname> <given-names>CS</given-names></string-name>, <string-name><surname>Kaplow</surname> <given-names>M</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>JK</given-names></string-name>, <string-name><surname>Grueber</surname> <given-names>WB</given-names></string-name></person-group>. <article-title>Diversity of internal sensory neuron axon projection patterns is controlled by the POU-domain protein pdm3 in drosophila larvae</article-title>. <source>J Neurosci</source>. <year>2018</year>; <volume>38</volume>(<issue>8</issue>):<fpage>2081</fpage>–<lpage>2093</lpage>. doi: <pub-id pub-id-type="doi">10.1523/JNEUROSCI.2125-17.2018</pub-id>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rescorla</surname> <given-names>RA</given-names></string-name></person-group>. <article-title>Informational Variables in Pavlovian Conditioning</article-title>. <source>Psychol Learn Motiv</source>. <year>1972</year>; <volume>6</volume>:<fpage>1</fpage>–<lpage>64</lpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reynolds</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>HBC</given-names></string-name>, <string-name><surname>Hill</surname> <given-names>JK</given-names></string-name>, <string-name><surname>Pearson</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>K</given-names></string-name>, <string-name><surname>Wolf</surname> <given-names>S</given-names></string-name>, <string-name><surname>Lim</surname> <given-names>KS</given-names></string-name>, <string-name><surname>Reynolds</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Chapman</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Reynolds</surname> <given-names>AM</given-names></string-name></person-group>. <article-title>Evidence for a pervasive ‘idling-mode’ activity template in flying and pedestrian insects</article-title>. <source>R Soc Open Sci</source>. <year>2015</year>; <volume>2</volume>. doi: <pub-id pub-id-type="doi">10.1098/rsos.150085</pub-id>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Riemensperger</surname> <given-names>T</given-names></string-name>, <string-name><surname>Völler</surname> <given-names>T</given-names></string-name>, <string-name><surname>Stock</surname> <given-names>P</given-names></string-name>, <string-name><surname>Buchner</surname> <given-names>E</given-names></string-name>, <string-name><surname>Fiala</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Punishment prediction by dopaminergic neurons in Drosophila</article-title>. <source>Curr Biol</source>. <year>2005</year>; <volume>15</volume>(<issue>21</issue>):<fpage>1953</fpage>–<lpage>1960</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.cub.2005.09.042</pub-id>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Risse</surname> <given-names>B</given-names></string-name>, <string-name><surname>Berh</surname> <given-names>D</given-names></string-name>, <string-name><surname>Otto</surname> <given-names>N</given-names></string-name>, <string-name><surname>Klämbt</surname> <given-names>C</given-names></string-name>, <string-name><surname>Jiang</surname> <given-names>X.</given-names></string-name></person-group> <article-title>FIMTrack: An open source tracking and locomotion analysis software for small animals</article-title>. <source>PLoS Comput Biol</source>. <year>2017</year>; <volume>13</volume>(<issue>5</issue>):<fpage>1</fpage>–<lpage>15</lpage>. doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005530</pub-id>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ross</surname> <given-names>D</given-names></string-name>, <string-name><surname>Lagogiannis</surname> <given-names>K</given-names></string-name>, <string-name><surname>Webb</surname> <given-names>B.</given-names></string-name></person-group> <chapter-title>A Model of Larval Biomechanics Reveals Exploitable Passive Properties for Efficient Locomotion</chapter-title>. In: <person-group person-group-type="editor"><string-name><surname>Wilson</surname> <given-names>SP</given-names></string-name>, <string-name><surname>Verschure</surname> <given-names>PFMJ</given-names></string-name>, <string-name><surname>Mura</surname> <given-names>A</given-names></string-name>, <string-name><surname>Prescott</surname> <given-names>TJ</given-names></string-name></person-group>, editors. <source>Biomimetic and Biohybrid Systems</source> <publisher-loc>Cham</publisher-loc>: <publisher-name>Sprimger International Publishing</publisher-name>; <year>2015</year>. p. <fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruiz-Dubreuil</surname> <given-names>G</given-names></string-name>, <string-name><surname>Burnet</surname> <given-names>B</given-names></string-name>, <string-name><surname>Connolly</surname> <given-names>K</given-names></string-name>, <string-name><surname>Furness</surname> <given-names>P.</given-names></string-name></person-group> <article-title>Larval foraging behaviour and competition in Drosophila melanogaster</article-title>. <source>Heredity (Edinb)</source>. <year>1996</year>; <volume>76</volume>(<issue>1</issue>):<fpage>55</fpage>–<lpage>64</lpage>. doi: <pub-id pub-id-type="doi">10.1038/hdy.1996.7</pub-id>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sakagiannis</surname> <given-names>P</given-names></string-name>, <string-name><surname>Aguilera</surname> <given-names>M</given-names></string-name>, <string-name><surname>Nawrot</surname> <given-names>MP</given-names></string-name></person-group>. <chapter-title>A Plausible Mechanism for Drosophila Larva Intermittent Behavior</chapter-title>. In: <person-group person-group-type="editor"><string-name><surname>Vouloutsi</surname> <given-names>V</given-names></string-name>, <string-name><surname>Mura</surname> <given-names>A</given-names></string-name>, <string-name><surname>Tauber</surname> <given-names>F</given-names></string-name>, <string-name><surname>Speck</surname> <given-names>T</given-names></string-name>, <string-name><surname>Prescott</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Verschure</surname> <given-names>PFMJ</given-names></string-name></person-group>, editors. <source>Biomimetic and Biohybrid Systems</source> <publisher-loc>Cham</publisher-loc>: <publisher-name>Sprimger International Publishing</publisher-name>; <year>2020</year>. p. <fpage>288</fpage>–<lpage>299</lpage>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saumweber</surname> <given-names>T</given-names></string-name>, <string-name><surname>Rohwedder</surname> <given-names>A</given-names></string-name>, <string-name><surname>Schleyer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Eichler</surname> <given-names>K</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>Yc</given-names></string-name>, <string-name><surname>Aso</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Eschbach</surname> <given-names>C</given-names></string-name>, <string-name><surname>Kobler</surname> <given-names>O</given-names></string-name>, <string-name><surname>Voigt</surname> <given-names>A</given-names></string-name>, <string-name><surname>Durairaja</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mancini</surname> <given-names>N</given-names></string-name>, <string-name><surname>Zlatic</surname> <given-names>M</given-names></string-name>, <string-name><surname>Truman</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Thum</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Functional architecture of reward learning in mushroom body extrinsic neurons of larval Drosophila</article-title>. <source>Nat Commun</source>. <year>2018</year>; p. <fpage>1</fpage>–<lpage>19</lpage>, doi: <pub-id pub-id-type="doi">10.1038/s41467-018-03130-1</pub-id>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saumweber</surname> <given-names>T</given-names></string-name>, <string-name><surname>Weyhersmüller</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hallermann</surname> <given-names>S</given-names></string-name>, <string-name><surname>Diegelmann</surname> <given-names>S</given-names></string-name>, <string-name><surname>Michels</surname> <given-names>B</given-names></string-name>, <string-name><surname>Bucher</surname> <given-names>D</given-names></string-name>, <string-name><surname>Funk</surname> <given-names>N</given-names></string-name>, <string-name><surname>Reisch</surname> <given-names>D</given-names></string-name>, <string-name><surname>Krohne</surname> <given-names>G</given-names></string-name>, <string-name><surname>Wegener</surname> <given-names>S</given-names></string-name>, <string-name><surname>Buchner</surname> <given-names>E</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Behavioral and synaptic plasticity are impaired upon lack of the synaptic protein SAP47</article-title>. <source>J Neurosci</source>. <year>2011</year>; <volume>31</volume>(<issue>9</issue>):<fpage>3508</fpage>–<lpage>3518</lpage>. doi: <pub-id pub-id-type="doi">10.1523/JNEUROSCI.2646-10.2011</pub-id>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schleyer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Fendt</surname> <given-names>M</given-names></string-name>, <string-name><surname>Schuller</surname> <given-names>S</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Associative learning of stimuli paired and unpaired with reinforcement: Evaluating evidence from maggots, flies, bees, and rats</article-title>. <source>Front Psychol</source>. <year>2018</year>; <volume>9</volume>(<issue>AUG</issue>):<fpage>1</fpage>–<lpage>15</lpage>. doi: <pub-id pub-id-type="doi">10.3389/fpsyg.2018.01494</pub-id>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schleyer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Miura</surname> <given-names>D</given-names></string-name>, <string-name><surname>Tanimura</surname> <given-names>T</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Learning the specific quality of taste reinforcement in larval Drosophila</article-title>. <source>eLife</source>. <year>2015</year>; <volume>4</volume>. doi: <pub-id pub-id-type="doi">10.7554/eLife.04711</pub-id>.</mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schleyer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Reid</surname> <given-names>SF</given-names></string-name>, <string-name><surname>Pamir</surname> <given-names>E</given-names></string-name>, <string-name><surname>Saumweber</surname> <given-names>T</given-names></string-name>, <string-name><surname>Paisios</surname> <given-names>E</given-names></string-name>, <string-name><surname>Davies</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B</given-names></string-name>, <string-name><surname>Louis</surname> <given-names>M.</given-names></string-name></person-group> <article-title>The impact of odor-reward memory on chemotaxis in larval Drosophila</article-title>. <source>Learn Mem</source>. <year>2015</year>; <volume>22</volume>(<issue>5</issue>):<fpage>267</fpage>–<lpage>277</lpage>. doi: <pub-id pub-id-type="doi">10.1101/lm.037978.114</pub-id>.</mixed-citation></ref>
<ref id="c70"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schleyer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Saumweber</surname> <given-names>T</given-names></string-name>, <string-name><surname>Nahrendorf</surname> <given-names>W</given-names></string-name>, <string-name><surname>Fischer</surname> <given-names>B</given-names></string-name>, <string-name><surname>von Alpen</surname> <given-names>D</given-names></string-name>, <string-name><surname>Pauls</surname> <given-names>D</given-names></string-name>, <string-name><surname>Thum</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> <article-title>A behavior-based circuit model of how outcome expectations organize learned behavior in larval Drosophila</article-title>. <source>Learn Mem</source>. <year>2011</year>; <volume>18</volume>(<issue>10</issue>):<fpage>639</fpage>–<lpage>653</lpage>. doi: <pub-id pub-id-type="doi">10.1101/lm.2163411</pub-id>.</mixed-citation></ref>
<ref id="c71"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schleyer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Weiglein</surname> <given-names>A</given-names></string-name>, <string-name><surname>Thoener</surname> <given-names>J</given-names></string-name>, <string-name><surname>Strauch</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hartenstein</surname> <given-names>V</given-names></string-name>, <string-name><surname>Weigelt</surname> <given-names>MK</given-names></string-name>, <string-name><surname>Schuller</surname> <given-names>S</given-names></string-name>, <string-name><surname>Saumweber</surname> <given-names>T</given-names></string-name>, <string-name><surname>Eichler</surname> <given-names>K</given-names></string-name>, <string-name><surname>Rohwedder</surname> <given-names>A</given-names></string-name>, <string-name><surname>Merhof</surname> <given-names>D</given-names></string-name>, <string-name><surname>Zlatic</surname> <given-names>M</given-names></string-name>, <string-name><surname>Thum</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Identification of dopaminergic neurons that can both establish associative memory and acutely terminate its behavioral expression</article-title>. <source>J Neurosci</source>. <year>2020</year>; <volume>40</volume>(<issue>31</issue>):<fpage>5990</fpage>– <lpage>6006</lpage>. doi: <pub-id pub-id-type="doi">10.1523/JNEUROSCI.0290-20.2020</pub-id>.</mixed-citation></ref>
<ref id="c72"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schoofs</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hückesfeld</surname> <given-names>S</given-names></string-name>, <string-name><surname>Schlegel</surname> <given-names>P</given-names></string-name>, <string-name><surname>Miroschnikow</surname> <given-names>A</given-names></string-name>, <string-name><surname>Peters</surname> <given-names>M</given-names></string-name>, <string-name><surname>Zeymer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Spieß</surname> <given-names>R</given-names></string-name>, <string-name><surname>Chiang</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Pankratz</surname> <given-names>MJ</given-names></string-name></person-group>. <article-title>Selection of Motor Programs for Suppressing Food Intake and Inducing Locomotion in the Drosophila Brain</article-title>. <source>PLoS Biol</source>. <year>2014</year>; <volume>12</volume>(<issue>6</issue>). doi: <pub-id pub-id-type="doi">10.1371/journal.pbio.1001893</pub-id>.</mixed-citation></ref>
<ref id="c73"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schoofs</surname> <given-names>A</given-names></string-name>, <string-name><surname>Miroschnikow</surname> <given-names>A</given-names></string-name>, <string-name><surname>Schlegel</surname> <given-names>P</given-names></string-name>, <string-name><surname>Zinke</surname> <given-names>I</given-names></string-name>, <string-name><surname>Schneider-Mizell</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pankratz</surname> <given-names>MJ</given-names></string-name></person-group>. <article-title>Serotonergic modulation of swallowing in a complete fly vagus nerve connectome</article-title>. <source>Current Biology</source>. <year>2024</year> <month>Sep</month>; p. S0960982224011370. <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S0960982224011370">https://linkinghub.elsevier.com/retrieve/pii/S0960982224011370</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.cub.2024.08.025</pub-id>.</mixed-citation></ref>
<ref id="c74"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schultz</surname> <given-names>W.</given-names></string-name></person-group> <article-title>Neuronal reward and decision signals: From theories to data</article-title>. <source>Physiol Rev</source>. <year>2015</year>; <volume>95</volume>(<issue>3</issue>):<fpage>853</fpage>–<lpage>951</lpage>. doi: <pub-id pub-id-type="doi">10.1152/physrev.00023.2014</pub-id>.</mixed-citation></ref>
<ref id="c75"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schultz</surname> <given-names>W.</given-names></string-name></person-group> <article-title>Dopamine reward prediction error coding</article-title>. <source>Dialogues Clin Neurosci</source>. <year>2016</year>; <volume>18</volume>(<issue>1</issue>):<fpage>23</fpage>.</mixed-citation></ref>
<ref id="c76"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schulze</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gomez-Marin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Rajendran</surname> <given-names>VG</given-names></string-name>, <string-name><surname>Lott</surname> <given-names>G</given-names></string-name>, <string-name><surname>Musy</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ahammad</surname> <given-names>P</given-names></string-name>, <string-name><surname>Deogade</surname> <given-names>A</given-names></string-name>, <string-name><surname>Sharpe</surname> <given-names>J</given-names></string-name>, <string-name><surname>Riedl</surname> <given-names>J</given-names></string-name>, <string-name><surname>Jarriault</surname> <given-names>D</given-names></string-name>, <string-name><surname>Trautman</surname> <given-names>ET</given-names></string-name>, <string-name><surname>Werner</surname> <given-names>C</given-names></string-name>, <string-name><surname>Venkadesan</surname> <given-names>M</given-names></string-name>, <string-name><surname>Druckmann</surname> <given-names>S</given-names></string-name>, <string-name><surname>Jayaraman</surname> <given-names>V</given-names></string-name>, <string-name><surname>Louis</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Dynamical feature extraction at the sensory periphery guides chemotaxis</article-title>. <source>eLife</source>. <year>2015</year>; <volume>4</volume>(<issue>JUNE</issue>):<fpage>1</fpage>–<lpage>52</lpage>. doi: <pub-id pub-id-type="doi">10.7554/eLife.06694</pub-id>.</mixed-citation></ref>
<ref id="c77"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schumann</surname> <given-names>I</given-names></string-name>, <string-name><surname>Triphan</surname> <given-names>T.</given-names></string-name></person-group> <article-title>The PEDtracker: An Automatic Staging Approach for Drosophila melanogaster Larvae</article-title>. <source>Front Behav Neurosci</source>. <year>2020</year>; <volume>14</volume>. doi: <pub-id pub-id-type="doi">10.3389/fnbeh.2020.612313</pub-id>.</mixed-citation></ref>
<ref id="c78"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sen</surname> <given-names>R</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Branson</surname> <given-names>K</given-names></string-name>, <string-name><surname>Robie</surname> <given-names>A</given-names></string-name>, <string-name><surname>Rubin</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Dickson</surname> <given-names>BJ</given-names></string-name></person-group>. <article-title>Moonwalker Descending Neurons Mediate Visually Evoked Retreat in Drosophila</article-title>. <source>Current Biology</source>. <year>2017</year>; <volume>27</volume>(<issue>5</issue>):<fpage>766</fpage>–<lpage>771</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.cub.2017.02.008</pub-id>, publisher: <publisher-name>Elsevier Ltd</publisher-name>.</mixed-citation></ref>
<ref id="c79"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sims</surname> <given-names>DW</given-names></string-name>, <string-name><surname>Humphries</surname> <given-names>NE</given-names></string-name>, <string-name><surname>Hu</surname> <given-names>N</given-names></string-name>, <string-name><surname>Medan</surname> <given-names>V</given-names></string-name>, <string-name><surname>Berni</surname> <given-names>J.</given-names></string-name></person-group> <article-title>Optimal searching behaviour generated intrinsically by the central pattern generator for locomotion</article-title>. <source>eLife</source>. <year>2019</year>; <volume>8</volume>:<fpage>1</fpage>–<lpage>31</lpage>. <ext-link ext-link-type="uri" xlink:href="https://elifesciences.org/articles/50316">https://elifesciences.org/articles/50316</ext-link>, doi: <pub-id pub-id-type="doi">10.7554/eLife.50316</pub-id>.</mixed-citation></ref>
<ref id="c80"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Slater</surname> <given-names>G</given-names></string-name>, <string-name><surname>Levy</surname> <given-names>P</given-names></string-name>, <string-name><surname>Andrew Chan</surname> <given-names>KL</given-names></string-name>, <string-name><surname>Larsen</surname> <given-names>C.</given-names></string-name></person-group> <article-title>A central neural pathway controlling odor tracking in drosophila</article-title>. <source>J Neurosci</source>. <year>2015</year>; <volume>35</volume>(<issue>5</issue>):<fpage>1831</fpage>–<lpage>1848</lpage>. doi: <pub-id pub-id-type="doi">10.1523/JNEUROSCI.2331-14.2015</pub-id>.</mixed-citation></ref>
<ref id="c81"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Springer</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Nawrot</surname> <given-names>MP</given-names></string-name></person-group>. <article-title>A mechanistic model for reward prediction and extinction learning in the fruit fly</article-title>. <source>eNeuro - Press</source>. <year>2021</year> <month>mar</month>; <ext-link ext-link-type="uri" xlink:href="https://www.eneuro.org/content/early/2021/03/27/ENEURO.0549-20.2021">https://www.eneuro.org/content/early/2021/03/27/ENEURO.0549-20.2021</ext-link>, doi: <pub-id pub-id-type="doi">10.1523/ENEURO.0549-20.2021</pub-id>.</mixed-citation></ref>
<ref id="c82"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strutz</surname> <given-names>A</given-names></string-name>, <string-name><surname>Soelter</surname> <given-names>J</given-names></string-name>, <string-name><surname>Baschwitz</surname> <given-names>A</given-names></string-name>, <string-name><surname>Farhan</surname> <given-names>A</given-names></string-name>, <string-name><surname>Grabe</surname> <given-names>V</given-names></string-name>, <string-name><surname>Rybak</surname> <given-names>J</given-names></string-name>, <string-name><surname>Knaden</surname> <given-names>M</given-names></string-name>, <string-name><surname>Schmuker</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hansson</surname> <given-names>BS</given-names></string-name>, <string-name><surname>Sachse</surname> <given-names>S.</given-names></string-name></person-group> <article-title>Decoding odor quality and intensity in the Drosophila brain</article-title>. <source>eLife</source>. <year>2014</year>; <volume>3</volume>:<fpage>1</fpage>–<lpage>21</lpage>. doi: <pub-id pub-id-type="doi">10.7554/elife.04147</pub-id>.</mixed-citation></ref>
<ref id="c83"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Szigeti</surname> <given-names>B</given-names></string-name>, <string-name><surname>Deogade</surname> <given-names>A</given-names></string-name>, <string-name><surname>Webb</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Searching for motifs in the behaviour of larval Drosophila melanogaster and Caenorhabditis elegans reveals continuity between behavioural states</article-title>. <source>J R Soc Interface</source>. <year>2015</year>; <volume>12</volume>(<issue>113</issue>). doi: <pub-id pub-id-type="doi">10.1098/rsif.2015.0899</pub-id>.</mixed-citation></ref>
<ref id="c84"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tadres</surname> <given-names>D</given-names></string-name>, <string-name><surname>Louis</surname> <given-names>M.</given-names></string-name></person-group> <article-title>PiVR: An affordable and versatile closed-loop platform to study unrestrained sensorimotor behavior</article-title>. <source>PLoS Biol</source>. <year>2020</year>; <volume>18</volume>(<issue>7</issue>):<fpage>1</fpage>–<lpage>25</lpage>, doi: <pub-id pub-id-type="doi">10.1371/jour-nal.pbio.3000712</pub-id>.</mixed-citation></ref>
<ref id="c85"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tastekin</surname> <given-names>I</given-names></string-name>, <string-name><surname>Khandelwal</surname> <given-names>A</given-names></string-name>, <string-name><surname>Tadres</surname> <given-names>D</given-names></string-name>, <string-name><surname>Fessner</surname> <given-names>ND</given-names></string-name>, <string-name><surname>Truman</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Zlatic</surname> <given-names>M</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Louis</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Sensorimotor pathway controlling stopping behavior during chemotaxis in the Drosophila melanogaster larva</article-title>. <source>eLife</source>. <year>2018</year>; <volume>7</volume>:<fpage>1</fpage>–<lpage>38</lpage>. doi: <pub-id pub-id-type="doi">10.7554/elife.38740</pub-id>.</mixed-citation></ref>
<ref id="c86"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thane</surname> <given-names>M</given-names></string-name>, <string-name><surname>Paisios</surname> <given-names>E</given-names></string-name>, <string-name><surname>Stöter</surname> <given-names>T</given-names></string-name>, <string-name><surname>Krüger</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Gläß</surname> <given-names>S</given-names></string-name>, <string-name><surname>Dahse</surname> <given-names>AK</given-names></string-name>, <string-name><surname>Scholz</surname> <given-names>N</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B</given-names></string-name>, <string-name><surname>Lehmann</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Schleyer</surname> <given-names>M.</given-names></string-name></person-group> <article-title>High-resolution analysis of individual Drosophila melanogaster larvae uncovers individual variability in locomotion and its neurogenetic modulation</article-title>. <source>Open Biology</source>. <year>2023</year> <month>Apr</month>; <volume>13</volume>(<issue>4</issue>):<fpage>220308</fpage>. <ext-link ext-link-type="uri" xlink:href="https://royalsocietypublishing.org/">https://royalsocietypublishing.org/</ext-link> doi/10.1098/rsob.220308, doi: <pub-id pub-id-type="doi">10.1098/rsob.220308</pub-id>.</mixed-citation></ref>
<ref id="c87"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thane</surname> <given-names>M</given-names></string-name>, <string-name><surname>Viswanathan</surname> <given-names>V</given-names></string-name>, <string-name><surname>Meyer</surname> <given-names>TC</given-names></string-name>, <string-name><surname>Paisios</surname> <given-names>E</given-names></string-name>, <string-name><surname>Schleyer</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Modulations of microbehaviour by associative memory strength in Drosophila larvae</article-title>. <source>PLoS One</source>. <year>2019</year>; <volume>14</volume>(<issue>10</issue>):<fpage>e0224154</fpage>. doi: <pub-id pub-id-type="doi">10.1371/journal.pone.0224154</pub-id>.</mixed-citation></ref>
<ref id="c88"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>de Tredern</surname> <given-names>E</given-names></string-name>, <string-name><surname>Manceau</surname> <given-names>D</given-names></string-name>, <string-name><surname>Blanc</surname> <given-names>A</given-names></string-name>, <string-name><surname>Sakagiannis</surname> <given-names>P</given-names></string-name>, <string-name><surname>Barre</surname> <given-names>C</given-names></string-name>, <string-name><surname>Sus</surname> <given-names>V</given-names></string-name>, <string-name><surname>Viscido</surname> <given-names>F</given-names></string-name>, <string-name><surname>Hasan</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Autran</surname> <given-names>S</given-names></string-name>, <string-name><surname>Nawrot</surname> <given-names>M</given-names></string-name>, <string-name><surname>Mason</surname> <given-names>JB</given-names></string-name>, <string-name><surname>Jovanic</surname> <given-names>T.</given-names></string-name></person-group> <article-title>Feeding-state dependent neuropeptidergic modulation of reciprocally interconnected inhibitory neurons biases sensorimotor decisions in Drosophila</article-title>. <source>bioRxiv</source>. <year>2024</year> <month>Apr</month>; doi: <pub-id pub-id-type="doi">10.1101/2023.12.26.573306</pub-id>.</mixed-citation></ref>
<ref id="c89"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ueno</surname> <given-names>T</given-names></string-name>, <string-name><surname>Masuda</surname> <given-names>N</given-names></string-name>, <string-name><surname>Kume</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kume</surname> <given-names>K.</given-names></string-name></person-group> <article-title>Dopamine Modulates the Rest Period Length without Perturbation of Its Power Law Distribution in Drosophila melanogaster</article-title>. <source>PLoS One</source>. <year>2012</year>; <volume>7</volume>(<issue>2</issue>). doi: <pub-id pub-id-type="doi">10.1371/journal.pone.0032007</pub-id>.</mixed-citation></ref>
<ref id="c90"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vogt</surname> <given-names>K</given-names></string-name>, <string-name><surname>Zimmerman</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Schlichting</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hernandez-Nunez</surname> <given-names>L</given-names></string-name>, <string-name><surname>Qin</surname> <given-names>S</given-names></string-name>, <string-name><surname>Malacon</surname> <given-names>K</given-names></string-name>, <string-name><surname>Rosbash</surname> <given-names>M</given-names></string-name>, <string-name><surname>Pehlevan</surname> <given-names>C</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Samuel</surname> <given-names>ADT</given-names></string-name></person-group>. <article-title>Internal state configures olfactory behavior and early sensory processing in Drosophila larvae</article-title>. <source>Sci Adv</source>. <year>2021</year>; <volume>7</volume>:<issue>1</issue>, <fpage>eabd6900</fpage>. doi: <pub-id pub-id-type="doi">10.1126/sciadv.abd6900</pub-id>.</mixed-citation></ref>
<ref id="c91"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weiglein</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gerstner</surname> <given-names>F</given-names></string-name>, <string-name><surname>Mancini</surname> <given-names>N</given-names></string-name>, <string-name><surname>Schleyer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gerber</surname> <given-names>B.</given-names></string-name></person-group> <article-title>One-trial learning in larval Drosophila</article-title>. <source>Learn Mem</source>. <year>2019</year>; <volume>26</volume>(<issue>4</issue>):<fpage>109</fpage>–<lpage>120</lpage>. doi: <pub-id pub-id-type="doi">10.1101/lm.049106.118</pub-id>.</mixed-citation></ref>
<ref id="c92"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Widmann</surname> <given-names>A</given-names></string-name>, <string-name><surname>Artinger</surname> <given-names>M</given-names></string-name>, <string-name><surname>Biesinger</surname> <given-names>L</given-names></string-name>, <string-name><surname>Boepple</surname> <given-names>K</given-names></string-name>, <string-name><surname>Peters</surname> <given-names>C</given-names></string-name>, <string-name><surname>Schlechter</surname> <given-names>J</given-names></string-name>, <string-name><surname>Selcho</surname> <given-names>M</given-names></string-name>, <string-name><surname>Thum</surname> <given-names>AS</given-names></string-name></person-group>. <article-title>Genetic Dissection of Aversive Associative Olfactory Learning and Memory in Drosophila Larvae</article-title>. <source>PLoS Genet</source>. <year>2016</year>; <volume>12</volume>(<issue>10</issue>):<fpage>1</fpage>–<lpage>32</lpage>. doi: <pub-id pub-id-type="doi">10.1371/journal.pgen.1006378</pub-id>.</mixed-citation></ref>
<ref id="c93"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Widmann</surname> <given-names>A</given-names></string-name>, <string-name><surname>Eichler</surname> <given-names>K</given-names></string-name>, <string-name><surname>Selcho</surname> <given-names>M</given-names></string-name>, <string-name><surname>Thum</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Pauls</surname> <given-names>D.</given-names></string-name></person-group> <article-title>Odor-taste learning in Drosophila larvae</article-title>. <source>J Insect Physiol</source>. <year>2018</year>; <volume>106</volume>(<issue>August</issue>):<fpage>47</fpage>–<lpage>54</lpage>, doi: <pub-id pub-id-type="doi">10.1016/j.jinsphys.2017.08.004</pub-id>.</mixed-citation></ref>
<ref id="c94"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilson</surname> <given-names>SP</given-names></string-name>, <string-name><surname>Prescott</surname> <given-names>TJ</given-names></string-name></person-group>. <article-title>Scaffolding layered control architectures through constraint closure: insights into brain evolution and development</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>. <year>2022</year> <month>Feb</month>; <volume>377</volume>(<issue>1844</issue>). <ext-link ext-link-type="uri" xlink:href="https://royalsocietypublishing.org/doi/10.1098/rstb.2020.0519">https://royalsocietypublishing.org/doi/10.1098/rstb.2020.0519</ext-link>, doi: <pub-id pub-id-type="doi">10.1098/rstb.2020.0519</pub-id>, publisher: <publisher-name>The Royal Society</publisher-name>.</mixed-citation></ref>
<ref id="c95"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Wen</surname> <given-names>T</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>G</given-names></string-name>, <string-name><surname>Park</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Cai</surname> <given-names>HN</given-names></string-name>, <string-name><surname>Shen</surname> <given-names>P.</given-names></string-name></person-group> <article-title>Developmental control of foraging and social behavior by the Drosophila neuropeptide Y-like system</article-title>. <source>Neuron</source>. <year>2003</year>; <volume>39</volume>(<issue>1</issue>):<fpage>147</fpage>–<lpage>161</lpage>. doi: <pub-id pub-id-type="doi">10.1016/S0896-6273(03)00396-9</pub-id>.</mixed-citation></ref>
<ref id="c96"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wystrach</surname> <given-names>A</given-names></string-name>, <string-name><surname>Lagogiannis</surname> <given-names>K</given-names></string-name>, <string-name><surname>Webb</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Continuous lateral oscillations as a core mechanism for taxis in Drosophila larvae</article-title>. <source>eLife</source>. <year>2016</year>; <volume>5</volume>. doi: <pub-id pub-id-type="doi">10.7554/elife.15504</pub-id>.</mixed-citation></ref>
<ref id="c97"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zago</surname> <given-names>M</given-names></string-name>, <string-name><surname>Lacquaniti</surname> <given-names>F</given-names></string-name>, <string-name><surname>Gomez-marin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gomez-marin</surname> <given-names>A.</given-names></string-name></person-group> <article-title>The speed - curvature power law in Drosophila larval locomotion</article-title>. <source>Biol Lett</source>. <year>2016</year>; <volume>12</volume>. doi: <pub-id pub-id-type="doi">10.6084/m9.fig-share.c.3517350</pub-id>.</mixed-citation></ref>
<ref id="c98"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zago</surname> <given-names>M</given-names></string-name>, <string-name><surname>Matic</surname> <given-names>A</given-names></string-name>, <string-name><surname>Flash</surname> <given-names>T</given-names></string-name>, <string-name><surname>Gomez-Marin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Lacquaniti</surname> <given-names>F.</given-names></string-name></person-group> <article-title>The speed - curvature power law of movements: a reappraisal</article-title>. <source>Exp Brain Res</source>. <year>2017</year>; <volume>236</volume>:<fpage>69</fpage>–<lpage>82</lpage>. doi: <pub-id pub-id-type="doi">10.1007/s00221-017-5108-z</pub-id>.</mixed-citation></ref>
<ref id="c99"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zarin</surname> <given-names>AA</given-names></string-name>, <string-name><surname>Mark</surname> <given-names>B</given-names></string-name>, <string-name><surname>Cardona</surname> <given-names>A</given-names></string-name>, <string-name><surname>Litwin-Kumar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Doe</surname> <given-names>CQ</given-names></string-name></person-group>. <article-title>A multilayer circuit architecture for the generation of distinct locomotor behaviors in Drosophila</article-title>. <source>eLife</source>. <year>2019</year>; <volume>8</volume>:<fpage>1</fpage>–<lpage>34</lpage>. doi: <pub-id pub-id-type="doi">10.7554/eLife.51781</pub-id>.</mixed-citation></ref>
<ref id="c100"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname> <given-names>T</given-names></string-name>, <string-name><surname>Branch</surname> <given-names>A</given-names></string-name>, <string-name><surname>Shen</surname> <given-names>P.</given-names></string-name></person-group> <article-title>Octopamine-mediated circuit mechanism underlying controlled appetite for palatable food in Drosophila</article-title>. <source>Proc Natl Acad Sci</source>. <year>2013</year>; <volume>110</volume>(<issue>38</issue>):<fpage>15431</fpage>–<lpage>15436</lpage>. doi: <pub-id pub-id-type="doi">10.1073/pnas.1308816110</pub-id>.</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<title>Appendix 1</title>
<sec id="s6">
<title>Metric definition</title>
<sec id="s6a">
<title>Body length</title>
<p>The instantaneous body-length of an individual larva fluctuates during crawling due to sub-sequent stretching and contraction. Its histogram is well fitted by a Gaussian distribution (data not shown). Therefore individual larva length <italic>l</italic> is defined as the median of the midline length across time (total length of the line connecting all 12 midline points). All spatial parameters including displacement and velocity can be scaled to this body-length, converting spatial units <italic>m</italic> or <italic>mm</italic> to dimensionless body-length units. Scaled spatial metrics are denoted by an additional° over the metric symbol.</p>
</sec>
<sec id="s6b">
<title>Segmentation and angular metrics</title>
<p>To specify the body segmentation providing the most suitable contact/rotation point for the definition of the bending <italic>ω</italic><sub><italic>b</italic></sub> and orientation <italic>ω</italic> angular velocities we analyse their relationship in a subset of 40 larvae. Tracking of 12 midline points allows computation of the absolute orientation of 11 body-segments and the respective 10 angles <italic>θ</italic><sub>1−10</sub> between successive body segments (<xref rid="fig2" ref-type="fig">Figure 2<italic>F</italic></xref>). We define <italic>θ</italic> as the head-segment absolute orientation in reference to the x-axis because this defines the movement orientation of the animal. We ask how <italic>ω</italic> results from the bending of the body as this is captured by the 10 angular velocities <italic>ω</italic><sub>1−10</sub>. The regression analysis depicted in <xref rid="fig1" ref-type="fig">Figure 1<italic>B</italic></xref> shows as expected that <italic>ω</italic> depends primarily on the front angular velocities while this dependence decays as we move towards the rear segments, in line with previous studies (<xref ref-type="bibr" rid="c36">Lahiri et al., 2011</xref>). Timeshift analysis also shows that the front 3 angles change concurrently while angles further down the midline are increasingly lagging behind (data not shown). The correlation analysis depicted in <xref rid="fig1" ref-type="fig">Figure 1<italic>C</italic></xref> shows that the sum of the front 5 angular velocities best correlates to <italic>ω</italic>. In other words the cumulative body bend of the front 5 segments best predicts head reorientation. Therefore we define the reorientation-relevant bending angle as <inline-formula><inline-graphic xlink:href="451470v2_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref rid="fig2" ref-type="fig">Figure 2<italic>F</italic></xref>). The remaining 5 angles between the rear body-segments can safely be neglected as they do not contribute to reorientation. This analysis results in a segmentation of the body in a front and a rear segments of length ratio 5 : 6. The segmentation process is demonstrated in Video 4.</p>
</sec>
<sec id="s6c">
<title>Forward velocity</title>
<p>To define forward velocity we need to choose which midline-point is most suitable to track and which velocity metric to use for defining the start and end of a stride. To this end we perform stride annotation of 3-minute tracks of a population of 20 larvae using each of 24 candidate instantaneous velocity metrics, namely the velocities of the 12 points, the component velocities of the rearest 11 points parallel to their front segment’s absolute orientation and finally the centroid velocity. To compare the candidate metrics we compute the spatial <italic>cv</italic><sub><italic>s</italic></sub> and temporal <italic>cv</italic><sub><italic>t</italic></sub> coefficient of variation of the annotated strides for each larva to assess how variant their time duration and displacement is. We finally compute the mean <inline-formula><inline-graphic xlink:href="451470v2_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="451470v2_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula> across individuals. In <xref rid="fig1" ref-type="fig">Figure 1<italic>A</italic></xref> the spatiotemporal stride variance is shown for each candidate metric. We choose the metric that provides the minimal spatial and temporal stride variance, assuming that strides of an individual larva are more or less stereotypical in both duration and displacement (<xref ref-type="bibr" rid="c24">Heckscher et al., 2012</xref>). Our study reveals that the centroid velocity is the most suitable metric for stride annotation. All spatial metrics are therefore computed via this point’s displacement.</p>
<fig id="figA1_1" position="float" fig-type="figure">
<label>Appendix 1—figure 1.</label>
<caption><title>Segmentation and velocity definition.</title>
<p><bold>A:</bold> Forward velocity definition. 13 candidate velocity metrics are compared for use in stride annotation of 3-minute tracks of a population of 30 larvae. For each candidate the mean coefficient of variation of temporal duration <inline-formula><inline-graphic xlink:href="451470v2_inline49.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and spatial displacement <inline-formula><inline-graphic xlink:href="451470v2_inline50.gif" mime-subtype="gif" mimetype="image"/></inline-formula> of the annotated strides is shown. Midline point 9 velocity provides the most temporally and spatially stereotypical strides, therefore it is selected as the reference forward velocity for stride annotation and model fitting. <italic>v</italic><sub><italic>cen</italic></sub> : centroid velocity, <italic>v</italic><sub>1</sub> − <italic>v</italic><sub>12</sub> : 1<sup><italic>st</italic></sup>-12<sup><italic>th</italic></sup> point’s velocity. <bold>B:</bold> Regression analysis of individual and cumulative angular velocities <italic>ω</italic><sub><italic>i</italic>=1−10</sub> to orientation angular velocity <italic>ω</italic>. When considered individually, <italic>ω</italic><sub>2</sub> best predicts reorientation with the <italic>ω</italic><sub>3</sub> and <italic>ω</italic><sub>1</sub> following. When considered cumulatively the anterior 4 <italic>ω</italic><sub><italic>i</italic></sub> allow optimal prediction of reorientation velocity. <bold>C:</bold> Correlation analysis of the sum of all possible <italic>ω</italic><sub><italic>i</italic></sub> combinations to <italic>ω</italic>. The sum <inline-formula><inline-graphic xlink:href="451470v2_inline51.gif" mime-subtype="gif" mimetype="image"/></inline-formula> shows the highest correlation therefore we define <inline-formula><inline-graphic xlink:href="451470v2_inline52.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as shown in A. For illustration purposes only the 5 highest correlations are shown.</p></caption>
<graphic xlink:href="451470v2_figA1_1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s6d">
<title>Track tortuosity</title>
<p>Track tortuosity is quantified by the straightness index (S.I), a metric previously used in larva-track analysis (<xref ref-type="bibr" rid="c79">Sims et al., 2019</xref>), computed by advancing a fixed time window along the track and calculating at each point the ratio of the straight line distance to the actual distance travelled. This index, which varies from 0 (no movement) to 1 (straight line movement), can capture very well the complexity of the movement at various scales (set by the window time frame) throughout the track. As the time window decreases the smoothing effect is also reduced revealing increasing track details. Different window sizes have been used ranging from 2 to 20 seconds in order to capture both large-scale spatial trajectories and small-scale local movements. Tortuosity was computed for each larva through time and revealed changes in movement as larva alternated between straight line relocation, changes of direction and different degrees of tortuosity. Hence, a change in the S.I. along a larva’s track captures the magnitude of the change in movement pattern from intensive, area-restricted searching movements (higher tortuosity) to extensive, straighter line movements (lower tortuosity), and vice versa, across a wide range of spatial scales.</p>
</sec>
<sec id="s6e">
<title>Epoch annotation</title>
<p>Strides (<italic>S</italic>) are annotated using the scaled forward velocity <inline-formula><inline-graphic xlink:href="451470v2_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula> First we apply fourier analysis to detect the dominant crawling frequency within a suitable range 1 ⩽ <italic>f</italic><sub><italic>C</italic></sub> ⩽ 2.5 (<xref rid="fig3" ref-type="fig">Figure 3<italic>A</italic></xref>). From this we derive the reference stride duration <inline-formula><inline-graphic xlink:href="451470v2_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula> Then epochs are annotated under a number of constraints (<xref rid="fig2" ref-type="fig">Figure 2<italic>C</italic></xref>):</p>
<list list-type="bullet">
<list-item><p>Each stride is contained between two <inline-formula><inline-graphic xlink:href="451470v2_inline31.gif" mime-subtype="gif" mimetype="image"/></inline-formula> local minima.</p></list-item>
<list-item><p>The <inline-formula><inline-graphic xlink:href="451470v2_inline32.gif" mime-subtype="gif" mimetype="image"/></inline-formula> local maxima contained in the epoch needs to exceed a threshold <inline-formula><inline-graphic xlink:href="451470v2_inline33.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p></list-item>
<list-item><p>The duration of the epoch <italic>t</italic> needs to range within <inline-formula><inline-graphic xlink:href="451470v2_inline33a.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. This allows individual strides to temporally vary without overlapping so that adjacent strides can be concatenated in stridechains.</p></list-item>
</list>
<p>After stride annotation the displacement due to each individual stride is computed for each larva and divided by the larva’s body-length (<xref rid="fig2" ref-type="fig">Figure 2</xref><italic>A-C</italic>). The individual distributions are well fitted by Gaussians (data not shown). Therefore <inline-formula><inline-graphic xlink:href="451470v2_inline34.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are defined as the average and standard deviation of the scaled displacement per stride for each larva.</p>
<p>Crawling runs (<italic>R</italic>) are defined as uninterrupted sequences of successive strides, also termed stridechains (<xref rid="fig2" ref-type="fig">Figure 2<italic>C</italic></xref>). Stridechain length is the number of concatenated strides in a run and is a discrete metric equivalent to the continuous crawling run duration. If the locomotory model under evaluation does not generate <italic>v</italic> oscillations and therefore strides can not be detected, runs are annotated using the plain forward velocity <italic>v</italic> timeseries as in a previous study (<xref ref-type="bibr" rid="c64">Sakagiannis et al., 2020</xref>). We first define a suitable threshold <italic>v</italic><sub><italic>thr</italic></sub> by detecting the minima of the pooled <italic>v</italic> bimodal distribution. Then we define runs as epochs where constantly <italic>v</italic> ⩾ <italic>v</italic><sub><italic>thr</italic></sub>. Pauses are then defined as epochs containing no strides (or equivalently not overlapping with runs) and during which <inline-formula><inline-graphic xlink:href="451470v2_inline35.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (or <italic>v</italic> ≤ <italic>v</italic><sub><italic>thr</italic></sub>).</p>
<p>Turn epochs (<italic>T</italic>) are contained between pairs of successive sign changes of orientation angular velocity <italic>ω</italic>. Annotated epochs of left (<italic>T</italic><sub><italic>L</italic></sub>) and right (<italic>T</italic><sub><italic>R</italic></sub>) turns yield the respective turn angle amplitudes <inline-formula><inline-graphic xlink:href="451470v2_inline36.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="451470v2_inline37.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as the absolute total change of orientation angle <italic>θ</italic> (<xref rid="fig2" ref-type="fig">Figure 2<italic>G</italic></xref>), which can then be pooled into the overall absolute turn-angle amplitudes <italic>θ</italic><sub><italic>T</italic></sub> . Notably by this definition turns include both headcasts (<italic>H</italic>) occurring during crawl-pauses and weathervaning (<italic>W</italic>) occurring during runs. Turns happening exclusively during runs and pauses yield the turn-angle amplitudes of weathervaning <italic>θ</italic><sub><italic>W</italic></sub> and headcasts <italic>θ</italic><sub><italic>H</italic></sub> respectively.</p>
</sec>
</sec>
</app>
<app id="app2">
<title>Appendix 2</title>
<sec id="s7">
<title>Model calibration</title>
<p>Here we describe in detail the calibration procedure for a locomotory model of an average idealized individual based on a reference dataset of 150 larvae tracked while freely exploring a Petri-dish over 3 minutes. The pipeline consists of 3 initial steps, which can be performed independently of each other and set the configuration parameters of the crawler, intermittency and turner modules respectively. In a final step that builds upon the results of the initial three, the parameters of the crawl-bend phase-locked interference are set. The first two steps are directly defined by the kinematic analysis results. The third and the final steps involve an optimization process to reach the parameter set best fitting the empirical data. Notably, along with the intrinsic parameters of a module, a number of additional module-related parameters might need to be defined, such as the body-length for the crawler module and the angular-motion relevant physical parameters for the turner module.</p>
<fig id="figA2_1" position="float" fig-type="figure">
<label>Appendix 2—figure 1.</label>
<caption><title>Average locomotory model summary.</title>
<p><bold>A:</bold> Distribution of stride-cycle related parameters over the empirical dataset. Red dotted line denotes the median value used in the Crawler module of the average locomotory model. <bold>B:</bold> Normalized average curves of angular metrics during the stride cycle for each individual larva. Red line denotes the group median. <bold>C:</bold> Pooled distribution of runs and pauses over the entire dataset (blue). Runs are detected as chains of concatenated strides (stridechains). Stridechains and pauses generated by the fitted distributions are shown in red. These distributions are used in the Intermitter module of the average locomotory model. <bold>D:</bold> Sample simulation of the model with all modules active. The model features additionally bend correction due to forward motion and crawling phase-coupled suppression of angular motion.</p></caption>
<graphic xlink:href="451470v2_figA2_1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>For the hereby described average-larva model no noise is introduced to any module input or output and no parameter variability is allowed across the population of the generated virtual larvae. The sole source of stochasticity then is due to the random distribution sampling processes operated during the behavioral simulations. For the analysis of the generated datasets the exact same pipeline is used as for the empirical dataset. The configuration of the final locomotory model is illustrated in <xref rid="tbl1" ref-type="table">Table 1</xref>.</p>
<sec id="s7a">
<title>Forward motion</title>
<p>For the Crawler module a set of 5 parameters need to be defined, along with a default body-length. This parameter-set is adequate to dynamically generate realistic forward velocity <italic>v</italic> oscillations as defined in <xref ref-type="disp-formula" rid="eqn3">Equation 3</xref>. All parameters are set to the median value across the empirical larva group. In <xref rid="fig1" ref-type="fig">Figure 1<italic>A</italic></xref> the empirical distributions of the 5 crawler-module parameters are shown along with the median value selected for the average module.</p>
</sec>
<sec id="s7b">
<title>Crawl intermittency</title>
<p>For the Intermittency module the sampling distributions for the run and pause epochs need to be defined. For both a continuous time-duration distribution is define while for the former an additional discrete distribution of number of concatenated strides per stridechain (run) is computed. In all cases, the pooled distribution of the given epoch across the entire dataset is approximated by power-law, exponential, Levy, log-normal and combined log-normal/power-law distributions. All distributions are truncated within an empirically observed range and are fully defined by their usual arguments. The best-fitting candidates from each class are sorted according to their Kolmogorov-Smirnov distance <italic>D</italic><sub><italic>KS</italic></sub> from the empirical distribution and the one exhibiting the minimum <italic>D</italic><sub><italic>KS</italic></sub> is selected for use in the model’s intermittency module (<xref rid="tbl1" ref-type="table">Table 1</xref>). A validation is shown in <xref rid="fig1" ref-type="fig">Figure 1<italic>D</italic></xref> where the distributions of the generated epochs (blue) match the empirical ones (red).</p>
</sec>
<sec id="s7c">
<title>Angular motion</title>
<p>Realistically calibrating the locomotory model in the angular domain is more demanding. The Turner module only generates a torque-equivalent output while the torsional-spring body model applies both angular damping and restorative force due to the body-bend angle (<xref ref-type="disp-formula" rid="eqn1">Equation 1</xref>). We need to calibrate the 3 involved physics parameters, namely the angular damping <italic>z</italic> in <italic>sec</italic><sup>−1</sup>, the bend deformation resistance <italic>k</italic> in <italic>sec</italic><sup>−2</sup> and the torque coefficient <italic>c</italic><sub><italic>T</italic></sub> in <italic>sec</italic><sup>−2</sup>. Additionally the parameters of the turner module itself need to be specified. Here we study two implementations. The first is the above described neural oscillator, for which we need to define the baseline tonic input <inline-formula><inline-graphic xlink:href="451470v2_inline38.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, the spike-response steepness coefficient <italic>n</italic><sub><italic>T</italic></sub> and the time constant <italic>τ</italic><sub><italic>T</italic></sub> . The second is a simple sinusoidal oscillator, for which we need to define the baseline amplitude <inline-formula><inline-graphic xlink:href="451470v2_inline39.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and frequency <italic>f</italic><sub><italic>T</italic></sub> . In order to have an empirical reference for isolated angular-only motion while avoiding the effect of crawling on the angular motion and we select the detected pause epochs exceeding 3 seconds and derive the pooled distributions for 3 angular metrics, namely the bending angle <italic>θ</italic><sub><italic>b</italic></sub>, the angular velocity <italic>ω</italic> and the angular acceleration <inline-formula><inline-graphic xlink:href="451470v2_inline40.gif" mime-subtype="gif" mimetype="image"/></inline-formula> We run an optimization algorithm aiming to minimize the Kolmogorov-Smirnov distance between the simulated and empirical distributions for these 3 angular metrics. In each iteration a Turner module of a given configuration is simulated for 3 minutes while <xref ref-type="disp-formula" rid="eqn1">Equation 1</xref> is applied to derive <italic>θ</italic><sub><italic>b</italic></sub> and <italic>ω</italic>. The obtained optimal turner and physics parameters are shown in <xref rid="tbl1" ref-type="table">Table 1</xref>.</p>
</sec>
<sec id="s7d">
<title>Crawl-bend interference</title>
<p>For the crawl-phase dependent attenuation of angular motion we study two implementations, each having three parameters that define the attenuation coefficient <italic>c</italic><sub><italic>CT</italic></sub> (<italic>ϕ</italic><sub><italic>C</italic></sub>) during the stride-cycle (<xref ref-type="disp-formula" rid="eqn6">Equation 6</xref>). To achieve this we use a genetic algorithm (GA) optimization process to reach a best-fitting parameter-set for this module. Although optimization is only allowed to search the parameter space for these three parameters, each configuration is evaluated using a complete virtual larva model, combined with the optimal configurations of all other modules defined in the previous three calibration steps. During each iteration of the GA process a group of 30 model configurations is simulated for 3 minutes in free exploration conditions. The best 6 configurations are then mutated and/or combined in a novel generation. The evaluation function minimized is two-fold.Firstly the distributions of the three angular metrics derived from the simulated track, namely the bending angle <italic>θ</italic><sub><italic>b</italic></sub>, the angular velocity <italic>ω</italic> and the angular acceleration <inline-formula><inline-graphic xlink:href="451470v2_inline41.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are compared to the empirically measured target distributions via the Kolmogorov-Smirnov distance as described above for the angular motion. Secondly, stride-cycle analysis is carried out for each simulated larva. Detected strides are interpolated in over <italic>n</italic> = 64 bins in a 2<italic>π</italic> cycle and direction-normalized by inverting the right-turning strides. The average stride-cycle curve <inline-formula><inline-graphic xlink:href="451470v2_inline42.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is then computed for each of the three metrics and compared to the average empirically measured curve <italic>x</italic> via the evaluation metric defined below. The metric has been selected so that the different scales of angles, angular velocities and accelerations are normalized before being summed. The final evaluation metric to be minimized is defined as the cumulative error across the three angular metrics for both the distributions and the average stride-cycle curves.
<disp-formula id="eqn10">
<graphic xlink:href="451470v2_eqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Here we study two configurations for the crawl phase-dependent suppression of the angular motion, namely a smooth gaussian relief curve and an acute square transition as described in <xref ref-type="disp-formula" rid="eqn6">Equation 6</xref>.The target empirical and optimal model’s average curve for the angular velocity <italic>ω</italic> are shown in <xref rid="fig1" ref-type="fig">Figure 1<italic>B</italic></xref>.</p>
<p>A sample simulation of the complete model is shown in <xref rid="fig1" ref-type="fig">Figure 1<italic>D</italic></xref>. The Crawler-generated forward velocity oscillations (1st row) attenuate the angular motion in a phase-locked manner (2nd row) resulting in low angular velocity during runs and acute headcasts during pauses (3rd row). The bending angle is additionally restored to 0 during forward motion (4th row).</p>
</sec>
</sec>
</app>
</app-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104262.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Cardona</surname>
<given-names>Albert</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Cambridge</institution>
</institution-wrap>
<city>Cambridge</city>
<country>United Kingdom</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Useful</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>useful</bold> study presents a hierarchical computational model that integrates locomotion, navigation, and learning in Drosophila larvae. The evidence supporting the model is <bold>solid</bold>, as it qualitatively replicates empirical behavioral data, but the experimental data is <bold>incomplete</bold>. While some simplifications in neuromechanical representation and sensory-motor integration are limiting factors, the study could be of use to researchers interested in computational modeling of biological movement and adaptive behavior.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104262.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The paper presents a three-layered hierarchical model for simulating Drosophila larva locomotion, navigation, and learning. The model consists of a basic locomotory layer that generates crawling and turning using a coupled oscillator framework, incorporating intermittency in movement through alternating runs and pauses. The intermediate layer enables navigation by allowing larvae to actively sense and respond to odor gradients, facilitating chemotaxis. The adaptive learning layer integrates a spiking neural network model of the Mushroom Body, simulating associative learning where larvae modify their behavior based on past experiences. The model is validated through simulations of free exploration, chemotaxis, and odor preference learning, demonstrating close agreement with empirical behavioral data. This modular framework provides a valuable advance for modeling larva behavior.</p>
<p>Strengths:</p>
<p>Every modeling paper requires certain assumptions and abstractions. The main strength of this paper lies in its modular and hierarchical approach to modeling behavior, making connections to influential theories of motor control in the brain. The authors also provide a convincing discussion of the experimental evidence supporting their layered behavioral architecture. This abstraction is valuable, offering researchers a useful conceptual framework and marking a significant step forward in the field. Connections to empirical larval movement are another major strength.</p>
<p>Weaknesses:</p>
<p>While the model represents a conceptual advance in the field, some of its assumptions and choices fall behind state-of-the-art approaches. One limitation is the paper's simplified representation of larval neuromechanics, in which the body is reduced to a two-segment structure with basic neural control. Another limitation is the absence of an explicit neuromuscular control system, which would better capture the role of segmental central pattern generators (CPGs) and neuronal circuits in regulating peristalsis and turning in Drosophila larvae. Many detailed neuromechanical models, as cited by the authors, have already been published. These abstractions overlook valuable experimental studies that detail segmental dynamics during crawling and the larval connectome.</p>
<p>The strength of the model could also be its weakness. The model follows a subsumption architecture, where low-level behaviors operate autonomously while higher layers modulate them. However, this approach may underestimate the complexity of real neural circuits, which likely exhibit more intricate feedback mechanisms between sensory input and motor execution.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104262.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>Sakagiannis et al. propose a hierarchically layer architecture to larval locomotion and foraging. They go from exploration to chemotaxis and odour preference test after associative learning.</p>
<p>Strengths:</p>
<p>A new locomotion model based on two oscillators that also incorporates peristaltic strides.</p>
<p>Weaknesses:</p>
<p>• The model is not always clearly or sufficiently explained (chemotaxis and odour test).</p>
<p>• Data analysis of the model movement is not very thorough.</p>
<p>• Comparisons with locomotion of behaving animals missing in chemotaxis and odour preference test after associative learning.</p>
<p>• Overall it is hard to judge the descriptive and predictive value of the model.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104262.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This paper presents a framework for a multilevel agent-based model of the drosophila larva, using a simplified larval body and locomotor equations coupled to oscillators and sensory input. The model itself is built upon significant existing literature, particularly Wystrach, Lagogiannis, and Webb 2016 and Jürgensen et al. 2024. The aim is to generate an easily configurable, well-documented platform for organism-scale behavioral simulation in specific experiments. The authors demonstrate qualitative similarity between in vivo behavioral experiments to calibrated models.</p>
<p>Strengths:</p>
<p>The goal is excellent - a system to rapidly run computational experiments that align naturally with behavioral experiments would be well-suited to develop intuitions and cut through hypotheses. The authors provide quantitative descriptions that show that the best-fit parameters in their models produce results that agree with several properties of larval locomotion.</p>
<p>The description of model calibration in the appendix is clear and explains several aspects of the model better than the main text.</p>
<p>In addition, the code is well-organized using contemporary Python tooling and the documentation is nicely in progress (although it remains incomplete). However, see notes for difficulties with installation.</p>
<p>Weaknesses:</p>
<p>(1) As presented here the modeling itself is described in an unclear fashion and without a particular scientific question. The majority of the effort appears to be calibrating modest extensions of existing models and applying them to very simple experiments. This could be an effective first part of a paper on the software tool, but the paper needs to point to a scientific question or, if it is a tool paper, a gap in the current state of modeling tools needed to address scientific goals. While the manuscript has a good overview of larval behavioral papers, the discussion of modeling is more of an afterthought. However, the paper is a modeling paper and the contribution is to modeling and particularly with this work's minor adaptions of existing models, it is unclear what the principle contribution is intended to be.</p>
<p>(2) While the models presented do qualitatively agree with experimental data in specific situations, there is no effort to challenge the model assumptions or compare them to alternative models. Simply because the data is consistent in a small number of simple experiments does not mean that the models are correct. Moreover, given the highly empirical nature of the modeling, I wonder what results are largely the model putting out what was put in, particularly with regards to kinematic results like frequency and body length or the effect of learning simply changing the sensory gain constant. It is difficult to imagine how at this level of empirical modeling, it would appear quite difficult to integrate the type of cell-type-specific perturbation or functional observation that is common in larval experiments.</p>
<p>(3) The central framing of a &quot;layered control architecture&quot; does not have a significant impact on the work presented here and the paper would do better with less emphasis on it. Given the limited empirical models, there are only so many parameters where different components can influence one another, and as best as I can tell from the paper there is only chemotaxis and modulation of a chemotactic gain constant that are incorporated so far. However, since these are empirical functions it says little about how the layers are actually controlled by the nervous system - indeed, the larval nervous system appears to have many levels of local and long-range module of circuits at both the sensory and motor layers. It is not clear how this aspect would contribute beyond the well-appreciated concept of a relatively finite set of behavioral primitives in an insect brain, particularly for the fly larva. What would be a contradictory model and how would the authors differentiate between that and the one they currently propose? If focusing only on olfactory learning and chemotaxis, how does the current framing add to the existing understanding?</p>
<p>(4) The paper uses experimental data to calibrate the models, however, the experiments are not described at all in the text.</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104262.1.sa4</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Sakagiannis</surname>
<given-names>Panagiotis</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1033-5387</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Jürgensen</surname>
<given-names>Anna-Maria</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7871-1887</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Nawrot</surname>
<given-names>Martin Paul</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4133-6419</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>We thank all three anonymous reviewers for their thoughtful evaluations of our manuscript and for recognizing the conceptual advance in combining agent-based behavioral simulations with systems neuroscience models. We are especially encouraged by the acknowledgement of the framework’s potential to support simulation of neural control of individual animal behavior in realistic sensory environments.</p>
<p>Below, we respond to each reviewer’s public comments in turn. Throughout, we have aimed to clarify our rationale for modeling choices, acknowledge limitations, and outline concrete steps for improvement in the revised manuscript.</p>
<p>Furthermore, the call for a better description of the model implementation as voiced by all three reviewers and additional requests from community members has prompted us to formulate a separate technically detailed description of the publicly available <italic>larvaworld</italic> software package as well as of the readily implemented models in form of a preprint paper (Sakagiannis et al., 2025, bioRxiv, DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/2025.06.15.659765">https://doi.org/10.1101/2025.06.15.659765</ext-link>).</p>
<p><bold>Reviewer #1:</bold></p>
<p>We are happy to read that this reviewer considers the proposed behavioral architecture ‘a significant step forward in the field’, and that she/he recognizes the strengths of our work in the modular and hierarchical approach that provides connections to influential theories of motor control in the brain, in the experimental evidence it is based on, and in the valuable abstractions that we have chosen for the larval behavioral modeling.</p>
<p>The reviewer raises important points about the simplifications we have made, both conceptually and in the specific implementation of larval behaviors. Our main goal in this study is to introduce a conceptual framework that integrates agent-based modeling with systems neuroscience models in a modular fashion. To serve this purpose, we aimed for a minimal yet representative implementation at the motor layer of the architecture, calibrated to larval locomotion kinematics. This choice enables efficient simulation while allowing us to test top-down modulation and adaptive mechanisms in higher layers without the computational overhead of a full neuromechanical model. In addition to chemotaxis, we have recently used this simplified approach to model thermotaxis in larvae (Kafle et al., 2025, iScience, DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.isci.2025.112809">https://doi.org/10.1016/j.isci.2025.112809</ext-link>).</p>
<p>The reviewer notes the absence of explicit segmental neuromuscular control or central pattern generators (CPGs). We deliberately abstracted from these mechanisms, representing the larval body as two segments with basic kinematic control, to focus on reproducing overall locomotor patterns. This bisegmental simplification, which we illustrate in Supplemental Video “Bisegmental larva-body simplification”, retains the behavioral features relevant to our current aims. However, the modular structure of the framework means that more detailed neuromechanical models—incorporating CPG dynamics or connectome-derived circuit models—can be integrated in future work without altering the architecture as a whole.</p>
<p>We fully agree that real neural circuits are more complex than a strict subsumption architecture implies. In the Drosophila larva, there is clear evidence for ascending sensory feedback from the motor periphery to premotor and higher brain circuits, as well as neuromodulatory influences. These add layers of complexity beyond the predominantly descending control in our present model. At the same time, both larval and adult connectome data show that across-level descending and ascending connections are sparse compared to the dense within-layer connectivity. We see value in casting our model as a hierarchical control system precisely to make the strengths and limitations of such an abstraction explicit. The revised manuscript will include further discussion of these points.</p>
<p>In summary, our design choices reflect a trade-off: by limiting the biological detail in the lower layers, we gain computational efficiency and maintain a clear modular structure that can host models at different levels of abstraction. This ensures that the architecture remains both a tool for immediate behavioral simulation and a scaffold for integrating richer neural and biomechanical models as they become available.</p>
<p><bold>Reviewer #2:</bold></p>
<p>We thank the reviewer for recognizing the novelty of our locomotory model, particularly the implementation of peristaltic strides based on our new analyses of empirical larval tracks, and for providing constructive feedback that will help us improve the manuscript.</p>
<p>The reviewer highlights the need for clearer explanations of the chemotaxis and odor preference modules. We expand these sections in the revised manuscript with more explicit descriptions of model structure, parameterization, and calibration. As mentioned above, we have also prepared a separate preprint dedicated to the <italic>larvaworld</italic> Python package, which contains detailed implementation notes and hands-on tutorials that allow users to adapt or extend individual modules.</p>
<p>Regarding the comparison to empirical behavior in chemotaxis, our present analysis is indeed primarily qualitative. However, we would like to emphasize that the temporal profile of odor concentration at the larval head in our simulations matches that measured in Gomez-Marin et al. (Nature Comm., 2011, DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/ncomms1455">https://doi.org/10.1038/ncomms1455</ext-link>) using only one additional free parameter, while all parameters of the basic locomotory model had been fitted to a separate exploration dataset before and were kept fixed in the chemotaxis experiments. In addition to the simulation of chemotaxis in the present paper, we recently used <italic>larvaworld</italic> in a practical model application to estimate a species-specific parameter of thermotaxis from experiments across different drosophilids (Kafle et al., 2025, iScience, DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.isci.2025.112809">https://doi.org/10.1016/j.isci.2025.112809</ext-link>).</p>
<p>The preference index in our simulations was computed using the same definition as in the established experimental group assay for larval memory retention, enabling a direct quantitative comparison between simulated and empirical results. Variability in the simulated outcomes arose naturally from inter-individual differences in body length and locomotory parameters, derived from real larval measurements, as well as from the random initial orientation of each individual in the arena. These factors contributed to variation in individual tracks and ultimately produced preference index values that closely matched those observed experimentally. In the revised manuscript, we also discuss handedness, as highlighted by the reviewer, as another meaningful expression of inter-individual variability in <italic>Drosophila</italic> larvae and insects more generally.</p>
<p>Finally, we acknowledge the reviewer’s concern about the scalability and broader applicability of the model. While the present paper focuses on three specific behavioral paradigms (exploration, chemotaxis, odor preference), the modular structure of the architecture is designed for flexibility: modules at any layer can be exchanged for more detailed or alternative implementations, and new sensory modalities or behaviors can be integrated without redesigning the system. The <italic>larvaworld</italic> package, associated codebase, and documentation are openly available to encourage adoption and adaptation by the larval research community.</p>
<p><bold>Reviewer #3:</bold></p>
<p>This public review provides an excellent account of our central aim to build an easily configurable, well-documented platform for organism-scale behavioral simulation and we are happy to read that the reviewer considers this an excellent goal.</p>
<p>We thank the reviewer for her/his account of our well-organized code using contemporary Python tooling. We are currently further improving code readability and code documentation, and we will release a new version of the <italic>larvaworld</italic> Python package. We further agree with the reviewer’s assessment that understanding the model calibration currently requires reading of the appendix. For the revised manuscript we thus aim at improving our description of all calibration and modeling steps along the way. We will also make sure to improve the description of the experimental datasets used for calibration.</p>
<p>We recognize that our description of the paper’s scientific contribution could be clearer. In revision, we will sharpen the Introduction and Discussion to highlight our main contributions:</p>
<p>(1) Promoting a shift from isolated neural circuit modeling to integrated agent-based simulations in realistic environments.</p>
<p>(2) Proposing the layered behavioral architecture, adopting the subsumption paradigm for modular integration.</p>
<p>(3) Providing the <italic>larvaworld</italic> software as a ready-to-use, extensible modeling platform.</p>
<p>(4) Implementing an empirically calibrated locomotory model and demonstrating its integration with navigation and learning modules in replicated behavioral paradigms.</p>
<p>We agree with the reviewer that the next challenge is to integrate the empirically based behavioral simulations presented here with functional brain models capable of reproducing or predicting experimental findings at the level of cellular neurophysiology, including the effects of cell-type-specific manipulations such as gene knock-down or optogenetic activation/inhibition. However, based on our experience with systems-level modeling, we deliberately invested in behavioral simulation because functional models of the nervous system—including our own—often lack translation into simulated agent behavior. In many cases, model output is limited to one or more variables that can at best be interpreted as a behavioral bias, and most often represents an “average animal” that fails to capture inter-individual differences. By linking our spiking mushroom body model to behavioral simulations in a group of individual agents during memory retention tests (Figure 6C,D), we were able to achieve a first successful direct comparison between simulated and experimental behavior metrics—in this case, the behavioral preference index reported in Jürgensen et al. (iScience, 2024, DOI: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.isci.2023.108640">https://doi.org/10.1016/j.isci.2023.108640</ext-link>).</p>
<p>Finally, we reiterate that the layered behavioral architecture is designed to promote a modular modeling paradigm. Our adoption of a subsumption architecture does not conflict with the concept of behavioral primitives; on the contrary, the notion that such primitives follow (semi-)autonomous motor programs and can be combined into more complex behaviors was the starting point for our implementation of the architecture in the fly larva. In our view, a genuinely contradictory paradigm for neural control of behavior would require a non-modular, strictly non-hierarchical organization of the nervous system and, by extension, of behavioral control.</p>
</body>
</sub-article>
</article>