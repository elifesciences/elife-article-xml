<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">93795</article-id>
<article-id pub-id-type="doi">10.7554/eLife.93795</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.93795.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Light-adaptation clamp: a tool to predictably manipulate photoreceptor light responses</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Chen</surname>
<given-names>Qiang</given-names>
</name>
<xref ref-type="aff" rid="a1">†</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ingram</surname>
<given-names>Norianne T.</given-names>
</name>
<xref ref-type="aff" rid="a1">†</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Baudin</surname>
<given-names>Jacob</given-names>
</name>
<xref ref-type="aff" rid="a1">†</xref>
<xref ref-type="author-notes" rid="n1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Angueyra</surname>
<given-names>Juan M.</given-names>
</name>
<xref ref-type="aff" rid="a1">†</xref>
<xref ref-type="author-notes" rid="n2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sinha</surname>
<given-names>Raunak</given-names>
</name>
<xref ref-type="aff" rid="a1">†</xref>
<xref ref-type="author-notes" rid="n3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Rieke</surname>
<given-names>Fred</given-names>
</name>
<xref ref-type="aff" rid="a1">†</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>†</label><institution>Department of Physiology and Biophysics University of Washington</institution>, Seattle, WA 98195</aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Baccus</surname>
<given-names>Stephen A</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Stanford University</institution>
</institution-wrap>
<city>Stanford</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Moore</surname>
<given-names>Tirin</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Stanford University, Howard Hughes Medical Institute</institution>
</institution-wrap>
<city>Stanford</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>Correspondence: <email>rieke@uw.edu</email></corresp>
<fn id="n1" fn-type="present-address"><label>1</label><p>Health and Machine Learning, Google, Seattle, WA</p></fn>
<fn id="n2" fn-type="present-address"><label>2</label><p>Department of Biology, University of Maryland, College Park, MD</p></fn>
<fn id="n3" fn-type="present-address"><label>3</label><p>Department of Neuroscience, University of Wisconsin-Madison, Madison, WI</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-02-02">
<day>02</day>
<month>02</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP93795</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-11-27">
<day>27</day>
<month>11</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-10-23">
<day>23</day>
<month>10</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.10.20.563304"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Chen et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Chen et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-93795-v1.pdf"/>
<abstract>
<title>Abstract</title><p>Computation in neural circuits relies on judicious use of nonlinear circuit components. In many cases, multiple nonlinear components work collectively to control circuit outputs. Separating the contributions of these different components is difficult, and this hampers our understanding of the mechanistic basis of many important computations. Here, we introduce a tool that permits the design of light stimuli that predictably alter rod and cone phototransduction currents - including the compensation for nonlinear properties such as light adaptation. This tool, based on well-established models for the rod and cone phototransduction cascade, permits the separation of nonlinearities in phototransduction from those in downstream circuits. This will allow, for example, direct tests of the role of photoreceptor adaptation in downstream visual signals or in perception.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>A central goal in neuroscience is to understand how behaviorally-significant computations are implemented by cellular and synaptic mechanisms (see (<xref ref-type="bibr" rid="c13">Churchland and Abbott 2016</xref>)). Such computations typically rely on a diverse collection of interacting circuit mechanisms, many of which are nonlinear (<xref ref-type="bibr" rid="c46">Zador 2000</xref>; <xref ref-type="bibr" rid="c24">Gollisch and Meister 2010</xref>; <xref ref-type="bibr" rid="c28">Jadzinsky and Baccus 2013</xref>; <xref ref-type="bibr" rid="c27">Isaacson and Scanziani 2011</xref>). Circuit outputs - which are often most amenable to experimental measurement - typically do not uniquely identify the role of specific circuit mechanisms. Hence progress towards understanding the mechanistic basis of circuit function requires better tools to manipulate specific mechanisms and identify their contribution to circuit output.</p>
<p>Sensory systems provide a clear example of these issues. Sensory processing is strongly shaped by the properties of the sensory receptors themselves and by post-receptor circuit mechanisms. Yet separating the contributions of receptor and post-receptor mechanisms to circuit outputs can be difficult, and computational models often make untested assumptions about their relative importance. For example, models for retinal processing generally assume that photoreceptor responses are linear or near-linear, despite decades of direct evidence that this is not the case (reviewed by (<xref ref-type="bibr" rid="c9">Burns and Baylor 2001</xref>; G. <xref ref-type="bibr" rid="c38">Schwartz 2021</xref>)). Adaptation to changes in mean light intensity provides a specific and important example. Both photoreceptors and post-photoreceptor circuits adjust response properties such as gain and kinetics to match the prevailing light inputs (reviewed by (<xref ref-type="bibr" rid="c20">Dunn and Rieke 2006</xref>; <xref ref-type="bibr" rid="c16">Demb 2008</xref>)), yet models for retinal outputs typically start by passing light inputs through a linear spatio-temporal filter; this architecture includes linear-nonlinear (<xref ref-type="bibr" rid="c12">Chichilnisky 2001</xref>), generalized-linear (<xref ref-type="bibr" rid="c32">Pillow et al. 2008</xref>) and computational neural network (CNN) (<xref ref-type="bibr" rid="c30">McIntosh et al. 2016</xref>; <xref ref-type="bibr" rid="c40">Turner et al. 2019</xref>) models. Models with an initial linear filtering stage cannot capture the spatially local adaptation produced by photoreceptors. Tools that separate receptor and post-receptor contributions to adaptation are needed to better understand how this salient aspect of retinal processing works.</p>
<p>Here, we show how we can predictably manipulate the responses of rod and cone photoreceptors to causally probe their role in shaping responses of downstream visual neurons. We build on decades of work identifying and testing biophysical models for rod and cone phototransduction (<xref ref-type="bibr" rid="c33">Pugh and Lamb 1993</xref>; <xref ref-type="bibr" rid="c35">Rieke and Baylor 1998</xref>; Nikonov, Lamb, and Pugh 2000; <xref ref-type="bibr" rid="c44">Younger, McCarthy, and Owen 1996</xref>). We show that existing phototransduction models, with appropriate parameters, can account for responses of rod and cone photoreceptors from both primate and mouse to a broad range of inputs. We then show that these models can be mathematically inverted - enabling the design of stimuli that will give rise to photoreceptor responses with specific desired properties such as a linear dependence on light input. Direct recordings of responses to these stimuli show that they work as designed. This approach allows us to determine the impact of specific properties of the phototransduction currents on visual signaling. For example, we can negate the impact of photoreceptor adaptation and test how adaptation in the responses of retinal ganglion cells is altered.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Biochemical model</title>
<p>We chose a model architecture based on the biochemical interactions that comprise the phototransduction cascade. We chose this model rather than empirical models (e.g. (<xref ref-type="bibr" rid="c14">Clark et al. 2013</xref>); see (<xref ref-type="bibr" rid="c2">Angueyra et al. 2022</xref>) for comparison of the biochemical model with the Clark model) because it was more clearly connected to the mechanistic operation of the phototransduction cascade and because it was exactly invertible.</p>
<p>Combined work in biochemistry, molecular biology and physiology has produced a clear understanding of the operation of the phototransduction cascade (<xref rid="fig1" ref-type="fig">Figure 1A</xref>; reviewed by (<xref ref-type="bibr" rid="c9">Burns and Baylor 2001</xref>; <xref ref-type="bibr" rid="c35">Rieke and Baylor 1998</xref>; G. <xref ref-type="bibr" rid="c38">Schwartz 2021</xref>). In brief, the phototransduction current flows through cGMP-gated channels in the photoreceptor outer segment. Levels of cGMP, and hence the phototransduction current, are maximal in darkness. Light activates (via a G-protein coupled receptor and a G-protein) a cGMP-phosphodiesterase. The resulting decrease in cGMP concentration allows some cGMP-gated channels to close and decreases the current. Levels of cGMP are restored by synthesis of cGMP by a guanylate cyclase; cyclase activity is sped by a calcium-feedback pathway that strongly shapes light responses (<xref ref-type="bibr" rid="c11">Burns et al. 2002</xref>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Model and fitting procedure. <bold>A.</bold> Phototransduction cascade and differential equations that describe operation of key components. Abbreviations are as follows: Stim: stimulus; R: receptor (photopigment) activity; P: phosphodiesterase activity; G: cGMP concentration; S: rate of cGMP synthesis; I: membrane current; C: calcium concentration. <bold>B.</bold> Fits (red) of a model with four free parameters (γ, σ, η, K<sub>GC</sub>) to the responses of a mouse rod (see Matlab code for parameter values). All measured responses are from the same rod, and all model responses use the same values for the free parameters. Responses to different flash strengths or flash timing have been displaced vertically in the left two panels. The weakest flash in the far left panel produced on average ∼3 activated rhodopsin molecules, and each successive flash was twice as bright. The bottom trace in the middle panel was to a light step alone, while the other traces in this panel each had 5 superimposed flashes. The horizontal scale bar for the inset in B is 1 sec.</p></caption>
<graphic xlink:href="563304v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The biochemical understanding summarized in <xref rid="fig1" ref-type="fig">Figure 1A</xref> has led to several quantitative models for phototransduction (<xref ref-type="bibr" rid="c33">Pugh and Lamb 1993</xref>; <xref ref-type="bibr" rid="c35">Rieke and Baylor 1998</xref>; Nikonov, Lamb, and Pugh 2000; <xref ref-type="bibr" rid="c44">Younger, McCarthy, and Owen 1996</xref>). We focus on a set of differential equations that form the core of these models. Our goal was to develop a model that generalized across stimuli rather than one in which the parameters accurately reflected the operation of components of the cascade. Below we show that the model illustrated in <xref rid="fig1" ref-type="fig">Figure 1A</xref>, with appropriate parameters, captures the responses of rod and cone photoreceptors to a variety of stimuli. Most importantly for our purposes here, the models are sufficiently accurate to enable us to accurately predict stimuli that elicit desired photoreceptor responses, as tested in <xref rid="fig5" ref-type="fig">Figures 5</xref>-<xref rid="fig8" ref-type="fig">8</xref>.</p>
<p>Our phototransduction model has a total of eleven parameters (<xref rid="fig1" ref-type="fig">Figure 1A</xref>). Two of these parameters can be expressed in terms of others using steady-state conditions, several are well constrained by direct measurements, and several have a similar impact on model output and hence do not need to be treated as independent free parameters (see Methods). These considerations allowed us to reduce the number of free model parameters to 4 for rods and 5 for cones. This choice reflects a balance of minimizing the number of free model parameters while providing sufficient flexibility to capture key aspects of the light response.</p>
<p>The free parameters consisted of the gain <italic>γ</italic> with which photons are converted to photopigment activity, the photopigment decay rate <italic>σ</italic>, the spontaneous PDE activation rate <italic>η</italic>, the constant <italic>K<sub>GC</sub></italic> specifying the calcium sensitivity of the cGMP synthesis rate, and (for cones) the rate <italic>β</italic> of Ca<sup>2+</sup> extrusion. This choice of free parameters is not unique given the similar impact of some parameters (such as <italic>σ</italic> and the PDE decay rate <italic>Ф</italic>). But, as indicated below, it provided sufficient flexibility to capture measured responses to a variety of stimuli. We numerically identified optimal values for these parameters separately for each photoreceptor type (see first section of associated Matlab code). As described below, we used different fitting procedures for rod and cone photoreceptors due to differences in how much data we could collect from individual cells via different recording techniques (see Methods for more details).</p>
<sec id="s2a1">
<title>Fitting rod phototransduction models</title>
<p>We used suction electrode recordings to measure responses of mouse and macaque rod photoreceptors to a set of stimuli consisting of a family of brief flashes of different strengths, flashes delivered at several times relative to the onset and offset of a light step, and a “variable mean noise stimulus” consisting of Gaussian noise with periodic changes in mean intensity (<xref rid="fig1" ref-type="fig">Figure 1B</xref>; see Methods for experimental details). The variable mean noise stimulus approximates the large and frequent changes in input produced by eye movements and the structure of natural images (<xref ref-type="bibr" rid="c23">Frazor and Geisler 2006</xref>). These large (up to 30-fold) changes in mean intensity strongly engage photoreceptor adaptation, and the superimposed Gaussian noise probes sensitivity to rapidly varying inputs.</p>
<p>We recorded responses to this collection of stimuli for each rod in our data set. We fit mouse and macaque rods separately, in each case seeking a common model (i.e. with the same parameters) that fit responses across stimuli. We identified model parameters by numerically minimizing the mean-squared error between the model predictions and measured responses across stimuli.</p>
<p><xref rid="fig1" ref-type="fig">Figure 1B</xref> compares the predicted and measured responses of a mouse rod photoreceptor. Predicted and measured responses are not identical - e.g. the model predicts a faster initial rising phase of the flash response than that measured. Nonetheless, a common model specified by four free parameters (<italic>γ, σ, η,</italic> and <italic>K<sub>GC</sub></italic>) accounts for many aspects of the responses to this set of stimuli. These parameters were well-constrained by fitting the measured responses: best fit parameters varied by ∼10% across different photoreceptors, and the mean-squared error increased significantly for 10-20% changes in parameters.</p>
<p>To arrive at consensus models for rod transduction currents, we fit measured responses from multiple rods from either primate or mouse simultaneously. We first used the measured dark current and the previously-measured relation between current and cGMP (Eq. 4 in <xref rid="fig1" ref-type="fig">Figure 1</xref>; (<xref ref-type="bibr" rid="c34">Rieke and Baylor 1996</xref>)) to specify the cGMP concentration in darkness for each cell. We then allowed <italic>γ</italic> to vary between cells to account for differences in sensitivity. The remaining parameters (<italic>σ, η,</italic> and <italic>K<sub>GC</sub></italic>) were constrained to have the same value across cells. These consensus models provide our best estimate of how an unrecorded cell of a given type will respond; these models provide the foundation for the manipulations of the photoreceptor responses in <xref rid="fig5" ref-type="fig">Figures 5</xref>-<xref rid="fig9" ref-type="fig">9</xref>. Consensus parameters for mouse and primate rods were very similar (see Matlab code for consensus model parameters and examples of fitting procedures).</p>
</sec>
<sec id="s2a2">
<title>Fitting cone phototransduction models</title>
<p>We recorded the responses of mouse and macaque cones using whole-cell patch clamp approaches. Light responses in these recordings run down quickly, and hence we recorded responses to a single stimulus from each individual cone. Based on the rod recordings described above, and earlier work on primate cones (<xref ref-type="bibr" rid="c2">Angueyra et al. 2022</xref>), we identified the variable mean noise stimulus as the single stimulus that best constrained the models. Models fit to the variable mean noise stimulus generalized well to other stimuli (see Figure 2 - Figure Supplement 1).</p>
<p>We identified consensus cone models by fitting measured responses to the variable mean noise stimulus from multiple cones simultaneously, as described above for the rods. Consensus parameters for mouse and primate cones differed substantially, reflecting the ∼2-fold faster kinetics of primate cone responses (flash response time-to-peak is ∼35 ms in primate cones, and ∼70 ms in mouse cones; see Matlab code for model parameters). For primate cones, performance using these consensus parameters was very similar to that from the parameters in (<xref ref-type="bibr" rid="c2">Angueyra et al. 2022</xref>); for consistency we used these published parameters for our consensus model.</p>
</sec>
<sec id="s2a3">
<title>Model performance</title>
<p><xref rid="fig2" ref-type="fig">Figure 2</xref> tests the performance of the consensus models for both rod and cone photoreceptors. We focused on the variable mean noise stimulus since it probes responses to rapid stimulus variations and slower changes in mean intensity. For each individual cell, we specified the dark cGMP concentration using the measured dark current and allowed the overall gain <italic>Y</italic> to vary; the remaining parameters were set to the consensus model values. The resulting models (red) captured the measured responses (black) well.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><p>Photoreceptor model and fits. <bold>A</bold>. Comparison of measured responses (black) with predictions of full (red) and linear model (blue) to variable mean noise stimulus (gray). Full model responses use consensus parameters from fitting responses of multiple cells of each type simultaneously, with the dark current and sensitivity allowed to vary between cells (see Methods). The linear model was generated from fitting the low-contrast responses of the full model (see Methods). Insets expand regions in gray boxes. <bold>B</bold>. Fraction of variance explained for the full model fit to each cell individually (y-axis) plotted against that for the consensus model that has fixed parameters across cells except for the dark current and sensitivity.</p></caption>
<graphic xlink:href="563304v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p><xref rid="fig2" ref-type="fig">Figure 2</xref> also shows predictions of a linear phototransduction model (blue) (see Methods). Rod and cone phototransduction currents depend linearly on light intensity for low contrast inputs (e.g. (<xref ref-type="bibr" rid="c25">Hass et al. 2015</xref>; <xref ref-type="bibr" rid="c36">Schnapf et al. 1990</xref>; <xref ref-type="bibr" rid="c5">Baylor, Lamb, and Yau 1979</xref>)). Hence, the linear model was fit to responses of the full model to low contrast inputs (see Methods for model construction details); this means that the differences between the linear and full model responses can be directly attributed to nonlinearities in phototransduction. Linear predictions deviated from the measured responses considerably more than did predictions of our biochemical model. Specifically, linear models overpredicted responses at high mean light levels, and underpredicted responses at low mean light levels. Some of these issues could be resolved by adding a time-independent nonlinearity to the linear model (i.e. a linear-nonlinear model); however, responses to many stimuli show clear time-dependent nonlinearities that are not captured by linear-nonlinear models (e.g. <xref rid="fig5" ref-type="fig">Figure 5</xref>; see also (<xref ref-type="bibr" rid="c2">Angueyra et al. 2022</xref>)). The biochemical model, though not perfect, tracked the measured responses quite well. For each recorded cell, the consensus models captured more than 80% of the variance of the responses (<xref rid="fig2" ref-type="fig">Figure 2B</xref>); on average these models captured ∼90% of the variance.</p>
<p>We compared the performance of the consensus models with that of models fit to each cell individually. Consensus models and models fit to individual cells performed similarly (<xref rid="fig2" ref-type="fig">Figure 2B</xref>). Models also generalized well across stimuli and to cells that did not contribute to the fits (Figure 2 - Figure Supplement 1). This suggests that the consensus models can be used to predict responses of unrecorded cells.</p>
<p><xref rid="fig1" ref-type="fig">Figures 1</xref> and <xref rid="fig2" ref-type="fig">2</xref> indicate that the known components of the phototransduction cascade, with appropriate parameters, can account for the full time course of the rod and cone photocurrents, including the changes produced by adaptation. Our central goal was to use these models to design stimuli that permit predictable manipulations of the photoreceptor responses. We directly evaluate whether the models are adequate for this goal below.</p>
</sec>
</sec>
<sec id="s2b">
<title>Model Inversion</title>
<p>In this section we show that the model illustrated in <xref rid="fig1" ref-type="fig">Figure 1A</xref> can be exactly inverted to identify the stimulus that corresponds to a specific desired photoreceptor response. Model inversion requires a one-to-one relationship between inputs and outputs - i.e. for every input there must be a unique output and vice versa. Mathematically, this holds for the phototransduction model summarized in <xref rid="fig1" ref-type="fig">Figure 1A</xref>: the model consists of linear elements (Eqs. 1, 2 and 5), static nonlinear elements (Eqs. 4 and 6) and a time-dependent nonlinear element (Eq. 3). The linear elements can be described as linear filters, and inverted by deconvolution. The static nonlinear elements consist of one-to-one mappings of inputs to outputs, and can be inverted correspondingly. The time-dependent nonlinear component can be rearranged and solved analytically (see Methods). The result is an analytical relationship between the phototransduction current and the stimulus - in other words an inverse model that takes the photocurrent as input and identifies the corresponding stimulus.</p>
<p><xref rid="fig3" ref-type="fig">Figure 3</xref> illustrates the steps in this procedure, using the current response generated by the forward model to the variable mean noise stimulus as an example “target” (far right). The first step is to convert this target current response to corresponding time-varying concentrations of cGMP and calcium using Eqs. 4 and 5 (step 1). In step 2, the time courses of cGMP and calcium are used to determine the time-varying PDE activity using Eqs. 3 and 6. In the final step (step 3), the PDE activity is used to determine the stimulus through Eqs. 1 and 2. In this case, as expected, we recover exactly the stimulus that we started with, confirming that mathematically the phototransduction model can be inverted.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><p>Steps in model inversion. A test current was generated from a variable mean noise stimulus using the full model (far right). Step 1 (right) converts this current into changes in cGMP and calcium using Eqs. 4 and 5 (see Figure 1). Step 2 converts the time course of the cGMP and calcium into that of the PDE activity using Eqs. 3 and 6. Finally, step 3 converts the PDE to the stimulus using Eqs. 1 and 2. The estimated stimulus is identical to the initial stimulus because there is no added noise and the inversion process is exact.</p></caption>
<graphic xlink:href="563304v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The procedure illustrated in <xref rid="fig3" ref-type="fig">Figure 3</xref> is exact in the context of the phototransduction model - i.e. given the architecture of the model, there is a one-to-one mapping of inputs to outputs. In practice, we would like to use this procedure to predict stimuli that will elicit specific photoreceptor responses. At least two issues could cause these model-based predictions to fail. First, the forward model may not accurately capture aspects of the real photoreceptor responses that are important for inversion. The model, for example, may capture some temporal frequencies of the response better than others, and this could limit the accuracy of the model inversion at those frequencies that are not captured well. Second, inversion could be highly sensitive to noise. The limited ability to recover spatial information in deconvolution microscopy provides an example of how noise can limit model inversion even with a good forward model. Noise in deconvolution microscopy is controlled by choosing not to try to recover spatial frequencies at which the noise is too high.</p>
<p>To test how well the model inversion process works on real responses, we applied it to measured photoreceptor responses to the variable mean noise stimulus. As described above, noise in the measured responses could cause the estimate to be better at some temporal frequencies than others; this is particularly true at high temporal frequencies that are poorly encoded by the photoreceptors. To minimize this effect while also probing the limits of the estimation approach, we limited the frequency content of the stimulus to temporal frequencies that we could reasonably expect to recover (0-60 Hz for primate cones, 0-30 Hz for mouse cones, 0-15 Hz for both primate and mouse rods) and required that the power spectrum of our estimate matched that of the true stimulus (see Methods). <xref rid="fig4" ref-type="fig">Figure 4A</xref> shows stimulus estimates based on measured responses for each photoreceptor type. The estimates closely approximate the actual stimulus, including recovering rapid stimulus fluctuations (insets). For each photoreceptor type, stimulus estimates based on model inversion captured the majority of the stimulus variance (<xref rid="fig4" ref-type="fig">Figure 4B</xref>).</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><p>Test of model inversion based on measured responses. <bold>A.</bold> Stimulus (gray in top panel), measured response (black in lower panels) and estimated stimulus (blue in top panels) calculated by using the measured response as input to the inverse model as in <xref rid="fig3" ref-type="fig">Figure 3</xref>. Estimates are able to recover both the periodic changes in mean intensity and the more rapid superimposed stimulus modulations (insets). <bold>B.</bold> Variance explained for stimulus estimates based on the average response across multiple stimulus trials compared to that based on individual responses. Since the model captures only the deterministic part of the response, noise in the individual responses lowers the accuracy of the estimates and causes the points to fall below the unity line. This effect is modest but systematic.</p></caption>
<graphic xlink:href="563304v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Variance explained, as in <xref rid="fig4" ref-type="fig">Figure 4B</xref>, mixes low temporal frequencies for which we might expect inversion to work well with high temporal frequencies for which it is expected to do less well. To explore the accuracy of the inversion across temporal frequencies, we compared the power spectrum of the stimulus with that of the residuals given by the difference between the stimulus and estimate (Figure 4 - Figure Supplement 1). At low temporal frequencies, stimulus power was much greater than that of the residuals, consistent with accurate stimulus estimation at these frequencies. This difference decreased with increasing frequency, and the two power spectra converged near 30 Hz for primate cones, 10 Hz for mouse cones, and 2-3 Hz for both primate and mouse rods. This provides an estimate of the frequency range over which stimulus inversion is possible.</p>
<p>The ability to convert photoreceptor responses to input stimuli is useful in several ways (see Discussion). Our focus in the remainder of the Results is using it to design stimuli that alter the photoreceptor responses in specific ways, such as negating the impact of adaptation and shaping response kinetics.</p>
</sec>
<sec id="s2c">
<title>Light-adaptation clamp examples</title>
<p><xref rid="fig5" ref-type="fig">Figure 5</xref> illustrates how we can use the model inversion procedure to predictably manipulate photoreceptor responses, in this case using the cone model and (for simplicity) a sinusoidal stimulus. We start with a desired or target response. For the specific applications described below, the aim was to remove nonlinearities in photoreceptor responses and hence we generate the target response from a linear phototransduction model. As for <xref rid="fig2" ref-type="fig">Figure 2</xref> above, the linear model used to generate the target response was obtained by fitting responses of the full phototransduction model to low contrast stimuli (see Methods). The response of the linear model to a sinusoidal stimulus is, as expected, another sinusoid (<xref rid="fig5" ref-type="fig">Figure 5</xref>, second panel from left). The response of real cones, and of the full cone model, deviates strongly from a sinusoid (black trace in the far right panel; (<xref ref-type="bibr" rid="c2">Angueyra et al. 2022</xref>)).</p>
<p>Adaptive nonlinearities in phototransduction cause the responses to sinusoidal light inputs to deviate from sinusoids. These time-dependent nonlinearities operate sufficiently rapidly to shape each cycle of the response, causing responses to decreases in light intensity to be larger than those to increases and causing the responses to light-to-dark transitions to be slower than those to dark-to-light transitions. To eliminate the impact of these nonlinear response properties, we seek a stimulus that will cause the response of the full model to match the target response - i.e. a stimulus that “clamps” the cone response to the target. The model inversion process identifies such a stimulus directly (red trace in second panel from right). Our primary interest is not in the shape of the stimulus itself but instead in the response that the stimulus produces. The right panel in <xref rid="fig5" ref-type="fig">Figure 5</xref> compares measured cone responses to the original (black) and modified (red) stimuli; responses to the modified stimulus are considerably more sinusoidal than those to the original stimulus.</p>
<p>The approach outlined in <xref rid="fig5" ref-type="fig">Figure 5</xref> is exact in principle, but could fail due either to inadequacies of the model or to cell-to-cell variability in the photoreceptor responses. Hence, a key step is testing whether the calculated stimuli produce the expected responses. <xref rid="fig6" ref-type="fig">Figures 6</xref>-<xref rid="fig8" ref-type="fig">8</xref> test this approach quantitatively for several stimulus manipulations.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><p>Light-adaptation clamp procedure. Starting with an initial stimulus (left), we generate a target or desired response (second panel from right). In this case, the target was chosen to be the response of a linear phototransduction model; for a sinusoidal input, a linear model produces a sinusoidal output. We use the (linear) target response as the input to the inverse phototransduction model and identify the stimulus required to elicit that response (red in third panel from left). Substantial stimulus modifications are required for the full model to produce a sinusoidal output. Finally, we confirm that the modified stimulus works as designed in direct recordings, in this case from a primate cone (right panel).</p></caption>
<graphic xlink:href="563304v1_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption><p>Compensating for increment/decrement asymmetries in responses to sinusoidal stimuli. <bold>A</bold>. Photoreceptor responses (bottom, black) to original sinusoidal stimuli (top, black) and modified stimuli (red). Thin lines in the bottom panels are best-fitting sinusoids for reference. Original and modified stimuli are shown above the recorded responses. <bold>B</bold>. Mean-squared-error between measured responses and best fitting sinusoids for modified stimuli plotted against that for original stimuli for each recorded cell. Sinusoidal fits had lower error for the modified stimuli compared to the original stimuli.</p></caption>
<graphic xlink:href="563304v1_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s2c1">
<title>Sinusoidal stimuli</title>
<p>We start with the sinusoidal stimuli illustrated in <xref rid="fig5" ref-type="fig">Figure 5</xref>. As predicted by the model, responses of both rod and cone photoreceptors to high-contrast sinusoidal light inputs are strongly nonsinusoidal: responses to decreases in light intensity are larger than those to increases, and responses to dark-to-light transitions are faster than those to corresponding light-to-dark transitions (<xref rid="fig6" ref-type="fig">Figure 6A</xref>). These nonlinearities in the photoreceptor responses are clear from the substantial deviations between the measured responses and the best-fitting sinusoids (thin lines in <xref rid="fig6" ref-type="fig">Figure 6A</xref>). These response asymmetries are important in interpreting responses of downstream visual neurons to similar stimuli. For example, asymmetries in signaling of On and Off RGCs are often attributed to differences in On and Off retinal circuits (e.g. (<xref ref-type="bibr" rid="c39">Stockman, Petrova, and Henning 2014</xref>)), and the possibility that they arise at least in part in the photoreceptors themselves is rarely considered.</p>
<p>We measured responses of rod and cone photoreceptors to sinusoidal stimuli and stimuli designed to compensate for adaptive nonlinearities in phototransduction. Responses to the modified stimuli (red traces in <xref rid="fig6" ref-type="fig">Figure 6A</xref>) were much closer to sinusoidal than responses to the original sinusoidal stimuli (black traces). Specifically, asymmetries between increment and decrement responses and light-to-dark vs dark-to-light transitions were substantially reduced for the modified stimuli. We quantified how much measured responses deviated from a sinusoid by computing the mean-squared error (MSE) between the responses and the best-fit sinusoid for the original and modified stimuli (<xref rid="fig6" ref-type="fig">Figure 6B</xref>). Sinusoidal fits to responses to the modified stimuli had considerably lower MSE than those to the original stimuli in each rod and cone tested.</p>
<p>Neither the sinusoidal stimuli nor the specific cells that contribute to <xref rid="fig6" ref-type="fig">Figure 6</xref> were used in fitting the phototransduction models. Hence <xref rid="fig6" ref-type="fig">Figure 6</xref> tests the ability of the model-based inversion process to generalize across photoreceptors and across stimuli.</p>
</sec>
<sec id="s2c2">
<title>Steps and flashes</title>
<p>As a second example of the light-adaptation clamp, we generated stimuli that compensate for the adaptive changes in gain of photoreceptor responses produced by changes in mean light intensity. These gain changes cause responses to a fixed strength flash to become smaller and faster when the mean light intensity increases (black traces in <xref rid="fig7" ref-type="fig">Figure 7A</xref>).</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption><p>Compensating for adaptation produced by changes in mean light level. A. Responses to a brief light flash delivered before and during a step in light intensity. For the original stimuli, flashes delivered before and during the step are identical, and the resulting responses decrease in amplitude ∼2-fold (summarized on x-axis of bottom panels). Red traces show responses to stimuli designed to compensate for the adaptation produced by the change in light intensity (following approach in Figure 5). B. Summary of gain changes (amplitude of response during the step divided by that of response prior to step) for responses to modified (y-axis) and original (x-axis) stimuli.</p></caption>
<graphic xlink:href="563304v1_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The control stimulus consisted of identical flashes delivered at two mean light levels. As expected, responses to this stimulus (black in <xref rid="fig7" ref-type="fig">Figure 7A</xref>) showed clear effects of adaptation. Specifically, the response to the flash decreased ∼2-fold at the higher mean light level (summarized in <xref rid="fig7" ref-type="fig">Figure 7B</xref>). We then passed this original stimulus through a linear model to estimate the photoreceptor response without adaptation. This linear prediction provided the target response in the stimulus identification process illustrated in <xref rid="fig5" ref-type="fig">Figure 5</xref>; the resulting modified stimuli are shown in red at the top of <xref rid="fig7" ref-type="fig">Figure 7A</xref>.</p>
<p>The red traces in <xref rid="fig7" ref-type="fig">Figure 7A</xref> (bottom) show responses to the stimuli designed to compensate for adaptation. Responses to the test flashes had similar amplitudes at the low and high mean light level. This similarity held across cells (the ratio of the response amplitudes is plotted on the y-axes in <xref rid="fig7" ref-type="fig">Figure 7B</xref>), demonstrating that the modified stimuli effectively compensated for the reduction in response gain produced by adaptation. None of the cells in <xref rid="fig7" ref-type="fig">Figure 7</xref> went into the model fitting, so this again tests the ability of the models to generalize across photoreceptors.</p>
</sec>
<sec id="s2c3">
<title>Altering kinetics</title>
<p>As for adaptation, separating the contributions of phototransduction and post-transduction circuit mechanisms to the kinetics of responses of downstream cells is difficult. Hence we sought to use the model inversion process to predictably alter the kinetics of the photoreceptor responses and determine their impact on the kinetics of downstream responses. For example, compensating for the speeding of photoreceptor responses that occurs with increasing light intensity would isolate the kinetics of the post-transduction circuitry and determine if they change independently from the changes in kinetics of the photoreceptor responses.</p>
<p>Slowing down the kinetics is conceptually straightforward - we slow down the kinetics of the stimulus itself and that will also cause the response to slow down. We apply this to responses to brief flashes. To test if we can do this in a predictable manner, we stretched the time axis of the linear responses to a brief flash by factors of 1.25-4, and used the resulting response as the target for the model inversion as in <xref rid="fig5" ref-type="fig">Figure 5</xref>. We omitted mouse cones because these experiments required longer-lasting recordings with stable kinetics, which were difficult to achieve with mouse cones. <xref rid="fig8" ref-type="fig">Figure 8A</xref> compares measured (thick traces) and predicted (thin traces) responses to the original flash and to stimuli designed to slow down the photoreceptor response slightly (left) and more substantially (right). The measured responses to the modified stimuli follow the predictions well for both rod and cone photoreceptors (summarized in <xref rid="fig8" ref-type="fig">Figure 8C</xref>).</p>
<p>Speeding up the responses is similarly straightforward in principle but more difficult in practice. Stimuli that speed up the response consist of a brief increment followed by a decrement - which together cause all but the initial rising phase of the response to cancel. In practice, this approach is limited because the contrast of the decrement cannot exceed 100%. Nonetheless, speeding up responses by 20-30% is possible (<xref rid="fig8" ref-type="fig">Figure 8B</xref>), and again measured responses closely follow predictions (<xref rid="fig8" ref-type="fig">Figure 8C</xref>).</p>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure">
<label>Figure 8:</label>
<caption><p>Manipulating kinetics of photoreceptor responses. <bold>A.</bold> Responses of primate cones and mouse rods to brief flashes (black) and stimuli designed to slow down responses slightly (left) and more substantially (right) (red). Thin traces show the target responses used to generate the modified stimuli. <bold>B.</bold> As in A for stimuli designed to speed up responses. <bold>C.</bold> Measured change in time-to-peak plotted against predicted change for a variety of manipulations of kinetics as in A and B.</p></caption>
<graphic xlink:href="563304v1_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s2d">
<title>Impact of cone adaptation on ganglion cell responses</title>
<p>Here, we show one example of how the ability to manipulate photoreceptor responses can be applied to reveal adaptational mechanisms at different locations in retinal circuits. Specifically, we compare responses of primate cones and downstream retinal neurons to the step plus flash stimulus used in <xref rid="fig7" ref-type="fig">Figure 7</xref>.</p>
<p><xref rid="fig9" ref-type="fig">Figure 9A</xref> shows responses of a primate cone, a horizontal cell, and an On parasol ganglion cell to the original step plus flash stimulus (black) and the modified stimulus that negates the cone adaptation (red). The stimuli used for the three cells illustrated are identical. As shown in <xref rid="fig6" ref-type="fig">Figure 6</xref>, the modified stimulus effectively negates adaptation in the cone transduction currents, and the responses to the cone responses to the two flashes are similar. Negating adaptation in the cones also eliminated most or all of the adaptation in downstream responses (summarized in <xref rid="fig9" ref-type="fig">Figure 9B</xref>).</p>
<fig id="fig9" position="float" orientation="portrait" fig-type="figure">
<label>Figure 9:</label>
<caption><p>Cone and post-cone adaptation. <bold>A.</bold> Responses of a cone (top), horizontal cell (middle) and On parasol RGC (bottom) to the step and flash protocol for both original and modified stimuli. <bold>B.</bold> Summary of experiments like those in A, plotting the change in gain for the modified stimuli against that for the original stimuli.</p></caption>
<graphic xlink:href="563304v1_fig9.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Previous work reached a similar conclusion by quantitatively comparing adaptation measured in cones and RGCs (<xref ref-type="bibr" rid="c19">Dunn, Lankheet, and Rieke 2007</xref>). Negating cone adaptation provides an alternative approach to this issue and similar questions about the contributions of photoreceptor and post-photoreceptor adaptation. <xref rid="fig9" ref-type="fig">Figure 9</xref> is a simple example of how the stimulus design approach developed here can be used. We return to other possible applications in the Discussion.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Rod and cone photoreceptors play an essential role in the responses of downstream visual neurons and visual perception. Refining this picture to identify the specific contributions of photoreceptors and post-photoreceptor circuitry to the computations that underlie vision has been difficult. Here, we have created and tested a tool that allows predictable manipulations of the photoreceptor responses to reveal their role in downstream signaling. Direct tests indicate that this tool is effective, and that it generalizes well across photoreceptors and stimuli. We envision this being useful to causally test how responses of downstream cells or perception are shaped by specific aspects of the photoreceptor responses such as adaptation.</p>
<sec id="s3a">
<title>Applications</title>
<sec id="s3a1">
<title>“Front end” for encoding models for downstream responses and perception</title>
<p>Two broad classes of encoding models have been used to describe responses of retinal ganglion cells and cells in downstream visual areas. Empirical models take light stimuli as inputs and convert these, through a series of linear and nonlinear elements, to predicted responses (<xref ref-type="bibr" rid="c12">Chichilnisky 2001</xref>; <xref ref-type="bibr" rid="c32">Pillow et al. 2008</xref>). Time-dependent nonlinearities are particularly hard to capture in such models, and few existing models account for them. Computational neural network (CNN) models similarly take light input and convert it, via the learned CNN weights, to predicted neural responses (<xref ref-type="bibr" rid="c30">McIntosh et al. 2016</xref>; <xref ref-type="bibr" rid="c40">Turner et al. 2019</xref>). Like empirical models, time-dependent nonlinearities such as adaptation are generally not well described by such models. As a result, these models work best when stimulus parameters such as mean light intensity do not change.</p>
<p>The photoreceptor models described here convert light inputs to photoreceptor responses, capturing time-dependent nonlinearities in this process. Empirical or CNN models could then be used to describe the conversion of photoreceptor signals to downstream neural responses. This architecture - a phototransduction model front end followed by an empirical model - should decrease the demand placed on the empirical model and improve the ability to capture responses to stimuli that strongly engage photoreceptor adaptation.</p>
<p>Models for visual perception could similarly incorporate a photoreceptor front end, and by doing so directly test which aspects of perception can be explained by phototransduction and which are due to downstream processing.</p>
</sec>
<sec id="s3a2">
<title>“Back end” to decoding models</title>
<p>Approaches to decode neural responses and estimate stimulus properties could similarly benefit from the photoreceptor models. Current decoding approaches either empirically fit response-stimulus relationships or invert encoding models to compute the likelihood of particular stimuli given the neural response (<xref ref-type="bibr" rid="c6">Bialek et al. 1991</xref>; <xref ref-type="bibr" rid="c8">Brackbill et al. 2020</xref>; <xref ref-type="bibr" rid="c42">Wu et al. 2022</xref>). In either case, decoding in the context of stimuli that strongly engage time-dependent nonlinearities has proven difficult.</p>
<p>Incorporating the inverse photoreceptor model into decoding approaches should improve decoding performance. Specifically, existing decoding approaches could be used to estimate the photoreceptor signal from downstream neural responses (e.g. those of RGCs), and then the inverse phototransduction model would convert the estimated photoreceptor signals to estimated stimuli. This again could decrease the demand placed on the decoding model. For example, under conditions in which much of retinal adaptation is accounted for by adaptation in the photoreceptors, the model used to estimate photoreceptor responses from RGC responses would need to vary little, and the inverse photoreceptor model would account for photoreceptor adaptation. A RGC→photoreceptor model should be simpler to fit and hence perform better than a full RGC→stimulus model.</p>
</sec>
<sec id="s3a3">
<title>Manipulations of phototransduction currents</title>
<p>The models that we introduce here provide a new tool to causally test the impact of alterations in photoreceptor responses on downstream responses and perception. For example, asymmetries in how increments and decrements in light intensity are processed have been well studied, including responses in retina, cortex and perception (<xref ref-type="bibr" rid="c29">Lu and Sperling 2012</xref>; <xref ref-type="bibr" rid="c7">Bowen, Pokorny, and Smith 1989</xref>). Parallel On and Off visual pathways are initiated at the cone output synapse, and asymmetries in downstream responses or perception are often attributed to asymmetries in the On and Off retinal circuits conveying photoreceptor signals to the ganglion cells (e.g. (<xref ref-type="bibr" rid="c39">Stockman, Petrova, and Henning 2014</xref>)). The implicit assumption is that photoreceptor inputs to On and Off retinal circuits are symmetrical. While this is likely the case for low contrast stimuli, adaptation in phototransduction means that high contrast stimuli will often not produce symmetric input to those circuits, and On/Off asymmetries may originate at least in part from asymmetric photoreceptor responses to light increments and decrements (<xref ref-type="bibr" rid="c2">Angueyra et al. 2022</xref>; <xref ref-type="bibr" rid="c14">Clark et al. 2013</xref>; <xref ref-type="bibr" rid="c21">Endeman and Kamermans 2010</xref>).</p>
<p>The ability to invert the phototransduction model permits the design of stimuli that minimize such asymmetries in the photoreceptor responses to test how they contribute to On/Off differences in downstream responses (e.g. (<xref ref-type="bibr" rid="c45">Yu et al. 2022</xref>)). More generally, the ability to shape photoreceptor responses in predictable ways provides a needed tool to isolate the effects of photoreceptor and post-photoreceptor circuits to shaping responses of downstream neurons and perception.</p>
</sec>
<sec id="s3a4">
<title>Complementing genetic approaches</title>
<p>Genetic manipulations provide another approach to alter photoreceptor responses and characterize the impact on responses of downstream visual neurons or behavior. Such approaches have the advantage of associating specific molecular components with alterations in vision - e.g. the role of arrestin (<xref ref-type="bibr" rid="c43">Xu et al. 1997</xref>; <xref ref-type="bibr" rid="c10">Burns et al. 2006</xref>) and rhodopsin kinase (<xref ref-type="bibr" rid="c48">Zhao, Palczewski, and Ohguro 1995</xref>; <xref ref-type="bibr" rid="c41">Wilden, Hall, and Kuhn 1986</xref>; <xref ref-type="bibr" rid="c3">Arshavsky 2002</xref>) in specific forms of stationary night blindness (<xref ref-type="bibr" rid="c18">Dryja 2000</xref>; <xref ref-type="bibr" rid="c47">Zeitz, Robson, and Audo 2014</xref>). But interpretation of these genetic manipulations can be limited by compensatory changes.</p>
<p>The approach that we introduce here complements genetic manipulations in at least two ways. First, it would be used in conjunction with genetic manipulations - e.g. to restore normal kinetics in photoreceptors in which the genetic alteration changes response kinetics. Second, the stimulus design approach provides an alternative that provides less detailed mechanistic information, but which allows more specific functional manipulations to be made and does not require genetic access.</p>
</sec>
</sec>
<sec id="s3b">
<title>Limitations</title>
<sec id="s3b1">
<title>Model validation</title>
<p>The procedure that we use to invert the phototransduction cascade is only as good as the model upon which it is based. Thus a focus of the experiments presented here was to test a range of manipulations for stimuli and photoreceptors that did not contribute to the model fits. We did this by fitting consensus models to recordings from one set of photoreceptors of a given type, and then testing the stimuli generated by these models on different photoreceptors from different retinas. Discrepancies between the predicted and measured responses to these new stimuli reflect both failures of the model inversion and cell-to-cell variability. Systematic differences between predicted and measured responses were small, and most of the differences appear to reflect variability between cells (e.g. due to cell-to-cell differences in sensitivity).</p>
</sec>
<sec id="s3b2">
<title>Focus on phototransduction</title>
<p>Our model describes the relationship between light inputs and phototransduction currents. We restricted our consideration to photocurrents rather than photoreceptor synaptic output because the latter is shaped by several mechanisms (e.g. electrical coupling between photoreceptors (E. A. <xref ref-type="bibr" rid="c37">Schwartz 1976</xref>; <xref ref-type="bibr" rid="c15">Copenhagen and Owen 1976</xref>; <xref ref-type="bibr" rid="c17">Detwiler and Hodgkin 1979</xref>) and horizontal feedback (<xref ref-type="bibr" rid="c4">Baylor, Fuortes, and O’Bryan 1971</xref>)) that are less well understood than phototransduction. A similar approach could be extended beyond phototransduction when additional quantitative information is available.</p>
</sec>
<sec id="s3b3">
<title>Photopigment bleaching</title>
<p>The model that we used does not consider photopigment bleaching and regeneration via the pigment epithelium. We omitted these aspects of photoreceptor function because the experiments to which we fit and test the model require that we remove the pigment epithelium. We restricted total light exposure in these experiments to minimize bleaching, and this limits the range of light levels over which the model is applicable. This is less of a concern for rods, where rod saturation occurs for light levels at which a small fraction of the rod pigment is bleached, and correspondingly our models cover most or all of the range of rod signals. For cones, the model is limited to light levels &lt; 50,000 R*/s (similar to typical indoor lighting conditions).</p>
</sec>
<sec id="s3b4">
<title>Speeding vs slowing responses</title>
<p>Not all manipulations of the photoreceptor responses are equally easily achieved. Speeding responses is particularly difficult because it requires increasing the amplitude of high temporal frequencies, and the ability to do that is limited by the requirement that light intensities not assume negative values. This means that low contrast stimuli can be sped more than high contrast stimuli.</p>
</sec>
<sec id="s3b5">
<title>Calibrations</title>
<p>The accuracy of the model predictions also depends critically on accurate light calibrations. We have detailed our procedure in Methods.</p>
</sec>
</sec>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Recordings</title>
<p>We performed electrophysiological recordings from primate (<italic>Macaca fascicularis, nemestrina and mulatta,</italic> either sex, 2-20 years) and mouse retina (C57/BL6 or sv-129, either sex, 1-12 months) in accordance with the University of Washington Institutional Animal Care and Use Committee. Primate retinas were obtained through the Tissue Distribution Program of the University of Washington Regional Primate Research Center. Primate recordings were all at &gt; 20° eccentricity.</p>
<p>Rod responses were recorded with suction electrodes (<xref ref-type="bibr" rid="c22">Field and Rieke 2002</xref>). These recordings were sufficiently stable that we could record responses to all three test stimuli in <xref rid="fig1" ref-type="fig">Figure 1B</xref>. Periodic standardized flashes tested for changes in kinetics or amplitude of the light response, and recordings were terminated if such changes were apparent. Most recordings were stable for at least 10-15 min before changes in kinetics were apparent.</p>
<p>Cones were recorded with whole-cell patch clamp techniques in slices (mouse; (<xref ref-type="bibr" rid="c26">Ingram, Sampath, and Fain 2019</xref>)) and whole-mount preparations (primate; (<xref ref-type="bibr" rid="c1">Angueyra and Rieke 2013</xref>)). Cone responses in these recordings run down quickly due to intracellular dialysis of the cell; hence responses to only one of the stimuli in <xref rid="fig1" ref-type="fig">Figure 1B</xref> were recorded from each cone. All data reported here were collected within 2-3 min of patch rupture and the onset of intracellular dialysis,</p>
</sec>
<sec id="s4b">
<title>Light calibrations</title>
<p>Optical power was measured at the preparation with a calibrated power meter (Graseby). Power readings were converted to isomerizations per second (R*/sec) using the photoreceptor spectral sensitivities, the LED spectral outputs, and collecting areas of rods and cones (1 and 0.37 µm<sup>2</sup> for primates, 0.5 and 0.2 µm<sup>2</sup> for mouse). Light stimuli from the LEDs were focused on the preparation via the microscope condenser or objective. Stimuli uniformly illuminated a 600 µm diameter spot. LED outputs were carefully checked for linearity. For rod recordings, we used an LED with peak output at 470 nm, near the peak of the rod spectral sensitivity. For cone recordings, we used an LED with peak output at 405 nm, which produced near-equal (within 10%) activation of L and M cones in primate and S and M cones in mouse.</p>
</sec>
<sec id="s4c">
<title>Forward model</title>
<p>The phototransduction cascade was modeled with the set of differential equations illustrated in <xref rid="fig1" ref-type="fig">Figure 1</xref>. This follows previous modeling work in both rods and cones (<xref ref-type="bibr" rid="c33">Pugh and Lamb 1993</xref>; Nikonov, Lamb, and Pugh 2000; <xref ref-type="bibr" rid="c35">Rieke and Baylor 1998</xref>; <xref ref-type="bibr" rid="c44">Younger, McCarthy, and Owen 1996</xref>). Our model has 11 parameters. In the first step of the model, the light stimulus (Stim) activates opsin molecules, converting inactive opsin (<italic>R</italic>) to active opsin (<italic>R*</italic>). Active opsin decays with a rate constant <italic>σ</italic> (<xref rid="fig1" ref-type="fig">Figure 1A</xref>, Equation 1). Next, phosphodiesterase (PDE) molecules are activated by active opsin molecules via the G-protein transducin; the resulting PDE activity (<italic>P</italic>) decays with a rate constant <italic>Ф</italic> (<xref rid="fig1" ref-type="fig">Figure 1A</xref>, Equation 2). We assume that the delay caused by transducin activation is negligible and hence omit this step for simplicity. The opsin decay rate <italic>σ</italic> and the PDE decay rate <italic>Ф</italic> were interchangeable, and the model output depended only on the smaller of these (i.e. the slower process). Hence <italic>σ</italic> and <italic>Ф</italic> were constrained to be equal.</p>
<p>The concentration of cGMP in the outer segment (<italic>G</italic>) is determined by the balance of cGMP hydrolysis mediated by PDE and synthesis (<italic>S</italic>) through guanylate cyclase (<italic>GC</italic>) (<xref rid="fig1" ref-type="fig">Figure 1A</xref>, Equation 3). For physiological conditions, the outer segment current (<italic>I</italic>) through cGMP-gated channels depends on a power of the cGMP concentration (<xref rid="fig1" ref-type="fig">Figure 1A</xref>, Equation 4; (<xref ref-type="bibr" rid="c34">Rieke and Baylor 1996</xref>)).</p>
<p>Calcium enters the outer segment through open cGMP channels and is removed by an exchange protein, with a rate constant <italic>p</italic> (<xref rid="fig1" ref-type="fig">Figure 1A</xref>, Equation 5). The calcium concentration (<italic>C</italic>) regulates the rate of cGMP synthesis (<italic>S</italic>); this dependence is modeled as a Hill curve (<xref rid="fig1" ref-type="fig">Figure 1A</xref>, Equation 6).</p>
<p>Two model parameters were fixed by steady state conditions and prior measurements. First, the constant <italic>q</italic> that relates current and changes in calcium can be expressed in terms of the dark calcium concentration, dark current, and rate constant <italic>β</italic> for calcium extrusion. Second, the maximal cyclase rate (<italic>S<sub>max</sub></italic>) can be written in terms of <italic>φ, η, K<sub>GC</sub>, h</italic>, and the dark calcium and cGMP concentrations. We fixed the constants k and n that determine the relation between cGMP and current (e.g. (Rieke and Baylor 1996)). Using these constants, the cGMP concentration in darkness was estimated from the measured dark current using Eq. 3 (e.g. the response to a saturating light flash) for each recorded cell. We also fixed <italic>m</italic> for both rods and cones and γ for rods based on previous measurements, and the dark calcium concentration (for rods and cones) because model outputs were insensitive to it.</p>
<p>This left a total of 4 free parameters for rod models (<italic>γ, η, σ, K<sub>GC</sub></italic>), and 5 for cone models (<italic>γ η, β, σ, K<sub>GC</sub>).</italic> These parameters were determined by minimizing the mean-squared difference between the measured responses and model predictions while the remaining model parameters were held fixed. Some combinations of model parameters can trade for each other, resulting in similar model performance (e.g. the parameters controlling the calcium concentration and its action on the rate of cGMP synthesis). Our goal here was to identify a model that captures photoreceptor responses across a range of stimuli, rather than a model in which the fit parameters were predictions of the underlying biochemical parameters.</p>
<p>Parameters of consensus models were determined by simultaneously fitting measured responses across all recorded cells of a given type. <italic>Y</italic> was allowed to vary between cells to account for differences in sensitivity, while the remaining parameters were constrained to be identical. These parameters are given in the associated Matlab code.</p>
</sec>
<sec id="s4d">
<title>Inverse model</title>
<p>The differential equations that comprise our model consist of several time-independent nonlinearities (Eqs. 4 and 6), several linear differential equations (Eqs. 1, 2, 5), and one nonlinear differential equation (Eq. 3). The time-independent nonlinearities can be inverted directly as a look-up table - e.g. the cGMP depends directly on the current as <italic>G = (I/k)<sup>1/n</sup></italic>. The linear differential equations can be solved directly by deconvolution - e.g. the Fourier transform of the calcium concentration from Eq. 5 is obtained directly from the Fourier transform of the measured current (<italic>I(f)</italic>) as
<disp-formula id="eqn1">
<graphic xlink:href="563304v1_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>f</italic> is the temporal frequency. The nonlinear differential equation (Eq. 3) can be reexpressed as an equation for the PDE activity <italic>P</italic> in terms of the cGMP concentration <italic>G</italic> and its derivative <italic>dG/dt</italic> as
<disp-formula id="eqn2">
<graphic xlink:href="563304v1_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
This equation can be solved given <italic>G</italic> (obtained from the current via Eq. 4), and <italic>S</italic> (obtained from the calcium concentration <italic>C(t)</italic> and Eq. 6). These steps in the inversion process are illustrated in <xref rid="fig3" ref-type="fig">Figure 3</xref>.</p>
<p>This process results in an exact mapping between responses and stimuli - i.e. every response <italic>I(t)</italic> has a corresponding unique stimulus <italic>Stim(t)</italic>. In practice, noise in the measured responses can corrupt the estimated stimuli. This is a general problem in deconvolution of noisy data – e.g. in microscopy. As indicated in the text, we controlled this noise when necessary by imposing that the power spectrum of our estimated stimulus be equal to the power spectrum of the true stimulus. This constraint was imposed by generating the estimated stimulus as described above, and then reweighting the power spectrum of the estimated stimulus to match the power spectrum of the true stimulus. This constraint was used in generating the estimated stimuli in <xref rid="fig4" ref-type="fig">Figure 4</xref>.</p>
</sec>
<sec id="s4e">
<title>Predictably altering photoreceptor responses</title>
<p>Model inversion as described above allowed us to identify stimuli that would produce a desired phototransduction current (which we refer to as a target response). For the applications in <xref rid="fig5" ref-type="fig">Figures 5</xref>-<xref rid="fig9" ref-type="fig">9</xref> we generated this response using a linear model of the transduction cascade. We passed an initial stimulus (e.g. a sinusoid in <xref rid="fig5" ref-type="fig">Figures 5</xref> and <xref rid="fig6" ref-type="fig">6</xref>) through the linear model to generate the target response. The model inversion process for the full (i.e. nonlinear) phototransduction cascade model then determined the stimulus which, when delivered to the full model, would produce the linear target response. In particular, this allowed us to identify stimuli that negated the impact of adaptation on the photoreceptor responses.</p>
<p>The linear models used to generate target responses were obtained by fitting a parameterized linear filter to responses of the full model to low contrast Gaussian noise. The filter had the form
<disp-formula id="eqn3">
<graphic xlink:href="563304v1_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>a</italic> is a scaling factor and <italic>t<sub>D</sub></italic>and <italic>t<sub>R</sub></italic> are time constants. This model provides good fits to measured responses of rods and cones (<xref ref-type="bibr" rid="c1">Angueyra and Rieke 2013</xref>). Photoreceptor responses to low contrast stimuli depend linearly on the stimulus (<xref ref-type="bibr" rid="c25">Hass et al. 2015</xref>), and hence this approach ensured that the linear model matched the full model for such stimuli. Linear models were fit at a specific mean light intensity matched to that of the stimulus for the full model. Hence the target response reflected how a linear photoreceptor model, at a given mean light level, would respond to the initial stimulus.</p>
<p>To manipulate the response kinetics, the time constants of the linear model were scaled and the process above repeated to generate appropriate stimuli.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>We thank Shellee Cunnington for excellent technical support. We are grateful for assistance from the WaNPRC staff, especially Chris English, for access to primate tissue. Shane Boniec, Greg Horwitz and Saad Idrees provided invaluable feedback on a draft of the manuscript. This work was supported by NIH grant EY028542 (FR) and the Air Force Office of Scientific Research under award number FA9550-21-1-0230 (special thanks to the AFOSR’s Cognitive &amp; Computational Neuroscience Program.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Angueyra</surname>, <given-names>J. M.</given-names></string-name>, and <string-name><given-names>F.</given-names> <surname>Rieke</surname></string-name>. <year>2013</year>. “<article-title>Origin and Effect of Phototransduction Noise in Primate Cone Photoreceptors</article-title>.” <source>Nature Neuroscience</source> <volume>16</volume> (<issue>11</issue>): <fpage>1692</fpage>–<lpage>1700</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Angueyra</surname>, <given-names>J. M.</given-names></string-name>, <string-name><given-names>Jacob</given-names> <surname>Baudin</surname></string-name>, <string-name><given-names>Gregory W.</given-names> <surname>Schwartz</surname></string-name>, and <string-name><given-names>Fred</given-names> <surname>Rieke</surname></string-name>. <year>2022</year>. “<article-title>Predicting and Manipulating Cone Responses to Naturalistic Inputs</article-title>.” <source>The Journal of Neuroscience: The Official Journal of the Society for Neuroscience</source> <volume>42</volume> (<issue>7</issue>): <fpage>1254</fpage>–<lpage>74</lpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Arshavsky</surname>, <given-names>V. Y</given-names></string-name>. <year>2002</year>. “<article-title>Rhodopsin Phosphorylation: From Terminating Single Photon Responses to Photoreceptor Dark Adaptation</article-title>.” <source>Trends in Neurosciences</source> <volume>25</volume> (<issue>3</issue>): <fpage>124</fpage>–<lpage>26</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Baylor</surname>, <given-names>D. A.</given-names></string-name>, <string-name><given-names>M. G.</given-names> <surname>Fuortes</surname></string-name>, and <string-name><given-names>P. M.</given-names> <surname>O’Bryan</surname></string-name>. <year>1971</year>. “<article-title>Receptive Fields of Cones in the Retina of the Turtle</article-title>.” <source>The Journal of Physiology</source> <volume>214</volume> (<issue>2</issue>): <fpage>265</fpage>–<lpage>94</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Baylor</surname>, <given-names>D. A.</given-names></string-name>, <string-name><given-names>T. D.</given-names> <surname>Lamb</surname></string-name>, and <string-name><given-names>K. W.</given-names> <surname>Yau</surname></string-name>. <year>1979</year>. “<article-title>The Membrane Current of Single Rod Outer Segments</article-title>.” <source>The Journal of Physiology</source> <volume>288</volume> (<issue>March</issue>): <fpage>589</fpage>–<lpage>611</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Bialek</surname>, <given-names>W.</given-names></string-name>, <string-name><given-names>F.</given-names> <surname>Rieke</surname></string-name>, <string-name><given-names>R. R.</given-names> <surname>de Ruyter van Steveninck</surname></string-name>, and <string-name><given-names>D.</given-names> <surname>Warland</surname></string-name>. <year>1991</year>. “<article-title>Reading a Neural Code</article-title>.” <source>Science</source> <volume>252</volume> (<issue>5014</issue>): <fpage>1854</fpage>–<lpage>57</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Bowen</surname>, <given-names>R. W.</given-names></string-name>, <string-name><given-names>J.</given-names> <surname>Pokorny</surname></string-name>, and <string-name><given-names>V. C.</given-names> <surname>Smith</surname></string-name>. <year>1989</year>. “<article-title>Sawtooth Contrast Sensitivity: Decrements Have the Edge</article-title>.” <source>Vision Research</source> <volume>29</volume> (<issue>11</issue>): <fpage>1501</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Brackbill</surname>, <given-names>Nora</given-names></string-name>, <string-name><given-names>Colleen</given-names> <surname>Rhoades</surname></string-name>, <string-name><given-names>Alexandra</given-names> <surname>Kling</surname></string-name>, <string-name><given-names>Nishal P.</given-names> <surname>Shah</surname></string-name>, <string-name><given-names>Alexander</given-names> <surname>Sher</surname></string-name>, <string-name><given-names>Alan M.</given-names> <surname>Litke</surname></string-name>, and <string-name><given-names>E. J.</given-names> <surname>Chichilnisky</surname></string-name>. <year>2020</year>. “<article-title>Reconstruction of Natural Images from Responses of Primate Retinal Ganglion Cells</article-title>.” <source>eLife</source> <volume>9</volume> (<issue>November</issue>). <pub-id pub-id-type="doi">10.7554/eLife.58516</pub-id>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Burns</surname>, <given-names>M. E.</given-names></string-name>, and <string-name><given-names>D. A.</given-names> <surname>Baylor</surname></string-name>. <year>2001</year>. “<article-title>Activation, Deactivation, and Adaptation in Vertebrate Photoreceptor Cells</article-title>.” <source>Annual Review of Neuroscience</source> <volume>24</volume>: <fpage>779</fpage>–<lpage>805</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Burns</surname>, <given-names>M. E.</given-names></string-name>, <string-name><given-names>A.</given-names> <surname>Mendez</surname></string-name>, <string-name><given-names>C. K.</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Almuete</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Quillinan</surname></string-name>, <string-name><given-names>M. I.</given-names> <surname>Simon</surname></string-name>, <string-name><given-names>D. A.</given-names> <surname>Baylor</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Chen</surname></string-name>. <year>2006</year>. “<article-title>Deactivation of Phosphorylated and Nonphosphorylated Rhodopsin by Arrestin Splice Variants</article-title>.” <source>The Journal of Neuroscience: The Official Journal of the Society for Neuroscience</source> <volume>26</volume> (<issue>3</issue>): <fpage>1036</fpage>–<lpage>44</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Burns</surname>, <given-names>M. E.</given-names></string-name>, <string-name><given-names>A.</given-names> <surname>Mendez</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Chen</surname></string-name>, and <string-name><given-names>D. A.</given-names> <surname>Baylor</surname></string-name>. <year>2002</year>. “<article-title>Dynamics of Cyclic GMP Synthesis in Retinal Rods</article-title>.” <source>Neuron</source> <volume>36</volume> (<issue>1</issue>): <fpage>81</fpage>–<lpage>91</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Chichilnisky</surname>, <given-names>E. J</given-names></string-name>. <year>2001</year>. “<article-title>A Simple White Noise Analysis of Neuronal Light Responses</article-title>.” <source>Network</source> <volume>12</volume> (<issue>2</issue>): <fpage>199</fpage>–<lpage>213</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Churchland</surname>, <given-names>Anne K.</given-names></string-name>, and <string-name><given-names>L. F.</given-names> <surname>Abbott</surname></string-name>. <year>2016</year>. “<article-title>Conceptual and Technical Advances Define a Key Moment for Theoretical Neuroscience</article-title>.” <source>Nature Neuroscience</source> <volume>19</volume> (<issue>3</issue>): <fpage>348</fpage>–<lpage>49</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Clark</surname>, <given-names>D. A.</given-names></string-name>, <string-name><given-names>R.</given-names> <surname>Benichou</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Meister</surname></string-name>, and R. <string-name><surname>Azeredo da Silveira</surname></string-name>. <year>2013</year>. “<article-title>Dynamical Adaptation in Photoreceptors</article-title>.” <source>PLoS Computational Biology</source> <volume>9</volume> (<issue>11</issue>): <fpage>e1003289</fpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Copenhagen</surname>, <given-names>D. R.</given-names></string-name>, and <string-name><given-names>W. G.</given-names> <surname>Owen</surname></string-name>. <year>1976</year>. “<article-title>Functional Characteristics of Lateral Interactions between Rods in the Retina of the Snapping Turtle</article-title>.” <source>The Journal of Physiology</source> <volume>259</volume> (<issue>2</issue>): <fpage>251</fpage>–<lpage>82</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Demb</surname>, <given-names>J. B</given-names></string-name>. <year>2008</year>. “<article-title>Functional Circuitry of Visual Adaptation in the Retina</article-title>.” <source>The Journal of Physiology</source> <volume>586</volume> (<issue>Pt 18</issue>): <fpage>4377</fpage>–<lpage>84</lpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Detwiler</surname>, <given-names>P. B.</given-names></string-name>, and <string-name><given-names>A. L.</given-names> <surname>Hodgkin</surname></string-name>. <year>1979</year>. “<article-title>Electrical Coupling between Cones in Turtle Retina</article-title>.” <source>The Journal of Physiology</source> <volume>291</volume> (<issue>June</issue>): <fpage>75</fpage>–<lpage>100</lpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Dryja</surname>, <given-names>T. P</given-names></string-name>. <year>2000</year>. “<article-title>Molecular Genetics of Oguchi Disease, Fundus Albipunctatus, and Other Forms of Stationary Night Blindness: LVII Edward Jackson Memorial Lecture</article-title>.” <source>American Journal of Ophthalmology</source> <volume>130</volume> (<issue>5</issue>): <fpage>547</fpage>–<lpage>63</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Dunn</surname>, <given-names>F. A.</given-names></string-name>, <string-name><given-names>M. J.</given-names> <surname>Lankheet</surname></string-name>, and <string-name><given-names>F.</given-names> <surname>Rieke</surname></string-name>. <year>2007</year>. “<article-title>Light Adaptation in Cone Vision Involves Switching between Receptor and Post-Receptor Sites</article-title>.” <source>Nature</source> <volume>449</volume> (<issue>7162</issue>): <fpage>603</fpage>–<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Dunn</surname>, <given-names>F. A.</given-names></string-name>, and <string-name><given-names>F.</given-names> <surname>Rieke</surname></string-name>. <year>2006</year>. “<article-title>The Impact of Photoreceptor Noise on Retinal Gain Controls</article-title>.” <source>Current Opinion in Neurobiology</source> <volume>16</volume> (<issue>4</issue>): <fpage>363</fpage>–<lpage>70</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Endeman</surname>, <given-names>D.</given-names></string-name>, and <string-name><given-names>M.</given-names> <surname>Kamermans</surname></string-name>. <year>2010</year>. “<article-title>Cones Perform a Non-Linear Transformation on Natural Stimuli</article-title>.” <source>The Journal of Physiology</source> <volume>588</volume> (<issue>Pt 3</issue>): <fpage>435</fpage>–<lpage>46</lpage>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Field</surname>, <given-names>G. D.</given-names></string-name>, and <string-name><given-names>F.</given-names> <surname>Rieke</surname></string-name>. <year>2002</year>. “<article-title>Mechanisms Regulating Variability of the Single Photon Responses of Mammalian Rod Photoreceptors</article-title>.” <source>Neuron</source> <volume>35</volume> (<issue>4</issue>): <fpage>733</fpage>–<lpage>47</lpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Frazor</surname>, <given-names>R. A.</given-names></string-name>, and <string-name><given-names>W. S.</given-names> <surname>Geisler</surname></string-name>. <year>2006</year>. “<article-title>Local Luminance and Contrast in Natural Images</article-title>.” <source>Vision Research</source> <volume>46</volume> (<issue>10</issue>): <fpage>1585</fpage>–<lpage>98</lpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Gollisch</surname>, <given-names>T.</given-names></string-name>, and <string-name><given-names>M.</given-names> <surname>Meister</surname></string-name>. <year>2010</year>. “<article-title>Eye Smarter than Scientists Believed: Neural Computations in Circuits of the Retina</article-title>.” <source>Neuron</source> <volume>65</volume> (<issue>2</issue>): <fpage>150</fpage>–<lpage>64</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Hass</surname>, <given-names>C. A.</given-names></string-name>, <string-name><given-names>J. M.</given-names> <surname>Angueyra</surname></string-name>, <string-name><given-names>Z.</given-names> <surname>Lindbloom-Brown</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Rieke</surname></string-name>, and <string-name><given-names>G. D.</given-names> <surname>Horwitz</surname></string-name>. <year>2015</year>. “<article-title>Chromatic Detection from Cone Photoreceptors to V1 Neurons to Behavior in Rhesus Monkeys</article-title>.” <source>Journal of Vision</source> <volume>15</volume> (<issue>15</issue>): <fpage>1</fpage>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Ingram</surname>, <given-names>Norianne T.</given-names></string-name>, <string-name><given-names>Alapakkam P.</given-names> <surname>Sampath</surname></string-name>, and <string-name><given-names>Gordon L.</given-names> <surname>Fain</surname></string-name>. <year>2019</year>. “<article-title>Voltage-Clamp Recordings of Light Responses from Wild-Type and Mutant Mouse Cone Photoreceptors</article-title>.” <source>The Journal of General Physiology</source> <volume>151</volume> (<issue>11</issue>): <fpage>1287</fpage>–<lpage>99</lpage>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Isaacson</surname>, <given-names>J. S.</given-names></string-name>, and <string-name><given-names>M.</given-names> <surname>Scanziani</surname></string-name>. <year>2011</year>. “<article-title>How Inhibition Shapes Cortical Activity</article-title>.” <source>Neuron</source> <volume>72</volume> (<issue>2</issue>): <fpage>231</fpage>–<lpage>43</lpage>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Jadzinsky</surname>, <given-names>P. D.</given-names></string-name>, and <string-name><given-names>S. A.</given-names> <surname>Baccus</surname></string-name>. <year>2013</year>. “<article-title>Transformation of Visual Signals by Inhibitory Interneurons in Retinal Circuits</article-title>.” <source>Annual Review of Neuroscience</source> <volume>36</volume>: <fpage>403</fpage>–<lpage>28</lpage>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Lu</surname>, <given-names>Zhong-Lin</given-names></string-name>, and <string-name><given-names>George</given-names> <surname>Sperling</surname></string-name>. <year>2012</year>. “<article-title>Black–white Asymmetry in Visual Perception</article-title>.” <source>Journal of Vision</source> <volume>12</volume> (<issue>10</issue>): <fpage>8</fpage>–<lpage>8</lpage>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>McIntosh</surname>, <given-names>L. T.</given-names></string-name>, <string-name><given-names>N.</given-names> <surname>Maheswaranathan</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Nayebi</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Ganguli</surname></string-name>, and <string-name><given-names>S. A.</given-names> <surname>Baccus</surname></string-name>. <year>2016</year>. “<article-title>Deep Learning Models of the Retinal Response to Natural Scenes</article-title>.” <source>Advances in Neural Information Processing Systems</source> <volume>29</volume>: <fpage>1369</fpage>–<lpage>77</lpage>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Nikonov</surname>, <given-names>S.</given-names></string-name>, <string-name><given-names>T. D.</given-names> <surname>Lamb</surname></string-name>, and <string-name><given-names>E. N.</given-names> <surname>Pugh Jr</surname></string-name>. <year>2000</year>. “<article-title>The Role of Steady Phosphodiesterase Activity in the Kinetics and Sensitivity of the Light-Adapted Salamander Rod Photoresponse</article-title>.” <source>The Journal of General Physiology</source> <volume>116</volume> (<issue>6</issue>): <fpage>795</fpage>–<lpage>824</lpage>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Pillow</surname>, <given-names>J. W.</given-names></string-name>, <string-name><given-names>J.</given-names> <surname>Shlens</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Paninski</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Sher</surname></string-name>, <string-name><given-names>A. M.</given-names> <surname>Litke</surname></string-name>, <string-name><given-names>E. J.</given-names> <surname>Chichilnisky</surname></string-name>, and <string-name><given-names>E. P.</given-names> <surname>Simoncelli</surname></string-name>. <year>2008</year>. “<article-title>Spatio-Temporal Correlations and Visual Signalling in a Complete Neuronal Population</article-title>.” <source>Nature</source>. .</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Pugh</surname>, <given-names>E. N.</given-names>, <suffix>Jr</suffix></string-name>, and <string-name><given-names>T. D.</given-names> <surname>Lamb</surname></string-name>. <year>1993</year>. “<article-title>Amplification and Kinetics of the Activation Steps in Phototransduction</article-title>.” <source>Biochimica et Biophysica Acta</source> <volume>1141</volume> (<issue>2-3</issue>): <fpage>111</fpage>–<lpage>49</lpage>.</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Rieke</surname>, <given-names>F.</given-names></string-name>, and <string-name><given-names>D. A.</given-names> <surname>Baylor</surname></string-name>. <year>1996</year>. “<article-title>Molecular Origin of Continuous Dark Noise in Rod Photoreceptors</article-title>.” <source>Biophysical Journal</source> <volume>71</volume> (<issue>5</issue>): <fpage>2553</fpage>–<lpage>72</lpage>.</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Rieke</surname>, <given-names>F.</given-names></string-name>, and <string-name><given-names>D. A.</given-names> <surname>Baylor</surname></string-name>. <year>1998</year>. “<article-title>Single-Photon Detection by Rod Cells of the Retina</article-title>.” <source>Reviews of Modern Physics</source> <volume>70</volume>: <fpage>1027</fpage>–<lpage>36</lpage>.</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Schnapf</surname>, <given-names>J. L.</given-names></string-name>, <string-name><given-names>B. J.</given-names> <surname>Nunn</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Meister</surname></string-name>, and <string-name><given-names>D. A.</given-names> <surname>Baylor</surname></string-name>. <year>1990</year>. “<article-title>Visual Transduction in Cones of the Monkey Macaca Fascicularis</article-title>.” <source>The Journal of Physiology</source> <volume>427</volume> (<issue>August</issue>): <fpage>681</fpage>–<lpage>713</lpage>.</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><surname>Schwartz</surname>, <given-names>E. A</given-names></string-name>. <year>1976</year>. “<article-title>Electrical Properties of the Rod Syncytium in the Retina of the Turtle</article-title>.” <source>The Journal of Physiology</source> <volume>257</volume> (<issue>2</issue>): <fpage>379</fpage>–<lpage>406</lpage>.</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="book"><string-name><surname>Schwartz</surname>, <given-names>Greg</given-names></string-name>. <year>2021</year>. <source>Retinal Computation</source>. <publisher-name>Academic Press</publisher-name>.</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><surname>Stockman</surname>, <given-names>A.</given-names></string-name>, <string-name><given-names>D.</given-names> <surname>Petrova</surname></string-name>, and <string-name><given-names>G. B.</given-names> <surname>Henning</surname></string-name>. <year>2014</year>. “<article-title>Color and Brightness Encoded in a Common L- and M-Cone Pathway with Expansive and Compressive Nonlinearities</article-title>.” <source>Journal of Vision</source> <volume>14</volume> (<issue>3</issue>): <fpage>1</fpage>.</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><surname>Turner</surname>, <given-names>Maxwell H</given-names></string-name>., <string-name><given-names>Luis Gonzalo Sanchez</given-names> <surname>Giraldo</surname></string-name>, <string-name><given-names>Odelia</given-names> <surname>Schwartz</surname></string-name>, and <string-name><given-names>Fred</given-names> <surname>Rieke</surname></string-name>. <year>2019</year>. “<article-title>Stimulus- and Goal-Oriented Frameworks for Understanding Natural Vision</article-title>.” <source>Nature Neuroscience</source> <volume>22</volume> (<issue>1</issue>): <fpage>15</fpage>–<lpage>24</lpage>.</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><string-name><surname>Wilden</surname>, <given-names>U.</given-names></string-name>, <string-name><given-names>S. W.</given-names> <surname>Hall</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>Kuhn</surname></string-name>. <year>1986</year>. “<article-title>Phosphodiesterase Activation by Photoexcited Rhodopsin Is Quenched When Rhodopsin Is Phosphorylated and Binds the Intrinsic 48-k$\uppercase{D}$a Protein of Rod Outer Segments</article-title>.” <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>83</volume> (<issue>5</issue>): <fpage>1174</fpage>–<lpage>78</lpage>.</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>Eric</given-names></string-name>, <string-name><given-names>Nora</given-names> <surname>Brackbill</surname></string-name>, <string-name><given-names>Alexander</given-names> <surname>Sher</surname></string-name>, <string-name><given-names>Alan</given-names> <surname>Litke</surname></string-name>, <string-name><given-names>Eero</given-names> <surname>Simoncelli</surname></string-name>, and <string-name><given-names>E. J.</given-names> <surname>Chichilnisky</surname></string-name>. <year>2022</year>. “<article-title>Maximum a Posteriori Natural Scene Reconstruction from Retinal Ganglion Cells with Deep Denoiser Priors</article-title>.” <source>Advances in Neural Information Processing Systems</source> <volume>35</volume> (<issue>December</issue>): <fpage>27212</fpage>–<lpage>24</lpage>.</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><string-name><surname>Xu</surname>, <given-names>J.</given-names></string-name>, <string-name><given-names>R. L.</given-names> <surname>Dodd</surname></string-name>, <string-name><given-names>C. L.</given-names> <surname>Makino</surname></string-name>, <string-name><given-names>M. I.</given-names> <surname>Simon</surname></string-name>, <string-name><given-names>D. A.</given-names> <surname>Baylor</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Chen</surname></string-name>. <year>1997</year>. “<article-title>Prolonged Photoresponses in Transgenic Mouse Rods Lacking Arrestin</article-title>.” <source>Nature</source> <volume>389</volume> (<issue>6650</issue>): <fpage>505</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><string-name><surname>Younger</surname>, <given-names>J. P.</given-names></string-name>, <string-name><given-names>S. T.</given-names> <surname>McCarthy</surname></string-name>, and <string-name><given-names>W. G.</given-names> <surname>Owen</surname></string-name>. <year>1996</year>. “<article-title>Light-Dependent Control of Calcium in Intact Rods of the Bullfrog Rana Catesbeiana</article-title>.” <source>Journal of Neurophysiology</source> <volume>75</volume> (<issue>1</issue>): <fpage>354</fpage>–<lpage>66</lpage>.</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><string-name><surname>Yu</surname>, <given-names>Zhou</given-names></string-name>, <string-name><given-names>Maxwell H.</given-names> <surname>Turner</surname></string-name>, <string-name><given-names>Jacob</given-names> <surname>Baudin</surname></string-name>, and <string-name><given-names>Fred</given-names> <surname>Rieke</surname></string-name>. <year>2022</year>. “<article-title>Adaptation in Cone Photoreceptors Contributes to an Unexpected Insensitivity of Primate On Parasol Retinal Ganglion Cells to Spatial Structure in Natural Images</article-title>.” <source>eLife</source> <volume>11</volume> (<issue>March</issue>). <pub-id pub-id-type="doi">10.7554/eLife.70611</pub-id>.</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><string-name><surname>Zador</surname>, <given-names>A. M</given-names></string-name>. <year>2000</year>. “<article-title>The Basic Unit of Computation</article-title>.” <source>Nature Neuroscience</source> <volume>3 Suppl</volume> (<issue>November</issue>): <fpage>1167</fpage>.</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><string-name><surname>Zeitz</surname>, <given-names>C.</given-names></string-name>, <string-name><given-names>A. G.</given-names> <surname>Robson</surname></string-name>, and <string-name><given-names>I.</given-names> <surname>Audo</surname></string-name>. <year>2014</year>. “<article-title>Congenital Stationary Night Blindness: An Analysis and Update of Genotype-Phenotype Correlations and Pathogenic Mechanisms</article-title>.” <source>Prog Retin Eye Res</source>. <pub-id pub-id-type="doi">10.1016/j.preteyeres.2014.09.001</pub-id>.</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><string-name><surname>Zhao</surname>, <given-names>X.</given-names></string-name>, <string-name><given-names>K.</given-names> <surname>Palczewski</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>Ohguro</surname></string-name>. <year>1995</year>. “<article-title>Mechanism of Rhodopsin Phosphorylation</article-title>.” <source>Biophysical Chemistry</source> <volume>56</volume> (<issue>1-2</issue>): <fpage>183</fpage>–<lpage>88</lpage>.</mixed-citation></ref>
</ref-list>
<sec>
<fig id="figs2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2 - Figure supplement 1:</label>
<caption><p>Tests of the ability of the model to generalize across stimuli and across cells. <bold>A.</bold> Generalization across stimuli. Responses of primate and mouse rods were fit to the variable mean noise stimulus only and model performance was evaluated for responses to the flash family and flashes and steps, using the fraction of variance explained to evaluate the fits (see <xref rid="fig1" ref-type="fig">Figure 1</xref>). This generalization performance to stimuli not included in the fit (y-axis) is compared to performance when the model is fit to all stimuli (x-axis). <bold>B.</bold> Generalization across cells. Models were fit to the variable mean noise stimulus. The performance of each cell was evaluated for a model in which all cells were fit (x-axis), or in which the test cell was excluded from the fit (y-axis).</p></caption>
<graphic xlink:href="563304v1_figs2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4 - Figure supplement 1:</label>
<caption><p>Errors in stimulus estimation. Power spectra of stimulus and residual (stimulus - estimate) for example primate and mouse rods and cones. The stimulus and residual power spectra diverge strongly at low frequencies where the estimates are close to the actual stimulus, and converge at higher frequencies when the estimate becomes poor. The convergence point depends on photoreceptor type, as expected for the different kinetics of rod and cone responses.</p></caption>
<graphic xlink:href="563304v1_figs4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.93795.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Baccus</surname>
<given-names>Stephen A</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Stanford University</institution>
</institution-wrap>
<city>Stanford</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This paper provides a <bold>valuable</bold> method that uses a computational model to predict photoreceptor currents in mammalian photoreceptors. By inverting the model, visual stimuli can be constructed to produce desired photoreceptor current responses. The authors provide <bold>convincing</bold> evidence that this approach can disentangle the effects of photoreceptor nonlinearities including light adaptation from downstream nonlinear processing, thus facilitating future studies of the higher visual system.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.93795.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
This manuscript aims at a quantitative model of how visual stimuli, given as time-dependent light intensity signals, are transduced into electrical currents in photoreceptors of macaque and mouse retina. Based on prior knowledge of the fundamental biophysical steps of the transduction cascade and a relatively small number of free parameters, the resulting model is found to fairly accurately capture measured photoreceptor currents under a range of diverse visual stimuli and with parameters that are (mostly) identical for photoreceptors of the same type.</p>
<p>Furthermore, as the model is invertible, the authors show that it can be used to derive visual stimuli that result in a desired, predetermined photoreceptor response. As demonstrated with several examples, this can be used to probe how the dynamics of phototransduction affect downstream signals in retinal ganglion cells, for example, by manipulating the visual stimuli in such a way that photoreceptor signals are linear or have reduced or altered adaptation. This innovative approach had already previously been used by the same lab to probe the contribution of photoreceptor adaptation to differences between On and Off parasol cells (Yu et al, eLife 2022), but the present paper extends this by describing and testing the photoreceptor model more generally and in both macaque and mouse as well as for both rods and cones.</p>
<p>Strengths:</p>
<p>
The presentation of the model is thorough and convincing, and the ability to capture responses to stimuli as different as white noise with varying mean intensity and flashes with a common set of model parameters across cells is impressive. Also, the suggested approach of applying the model to modify visual stimuli that effectively alter photoreceptor signal processing is thought-provoking and should be a powerful tool for future investigations of retinal circuit function. The examples of how this approach can be applied are convincing and corroborate, for example, previous findings that adaptation to ambient light in the primate retina, as measured by responses to light flashes, mostly originates in photoreceptors.</p>
<p>Weaknesses:</p>
<p>
In the current form of the presentation, it doesn't become fully clear how easily the approach is applicable at different mean light levels and where exactly the limits for the model inversion are at high frequency. Also, accessibility and applicability by others could be strengthened by including more details about how parameters are fixed and what consensus values are selected.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.93795.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
This manuscript proposes a modeling approach to capture nonlinear processes of photocurrents in mammalian (mouse, primate) rod and cone photoreceptors. The ultimate goal is to separate these nonlinearities at the level of photocurrent from subsequent nonlinear processing that occurs in retinal circuitry. The authors devised a strategy to generate stimuli that cancel the major nonlinearities in photocurrents. For example, modified stimuli would generate genuine sinusoidal modulation of the photocurrent, whereas a sinusoidal stimulus would not (i.e., because of asymmetries in the photocurrent to light vs. dark changes); and modified stimuli that could cancel the effects of light adaptation at the photocurrent level. Using these modified stimuli, one could record downstream neurons, knowing that any nonlinearities that emerge must happen post-photocurrent. This could be a useful method for separating nonlinear mechanisms across different stages of retinal processing, although there are some apparent limitations to the overall strategy.</p>
<p>Strengths:</p>
<p>
1. This is a very quantitative and thoughtful approach and addresses a long-standing problem in the field: determining the location of nonlinearities within a complex circuit, including asymmetric responses to different polarities of contrast, adaptation, etc.</p>
<p>
2. The study presents data for two primary models of mammalian retina, mouse, and primate, and shows that the basic strategy works in each case.</p>
<p>
3. Ideally, the present results would generalize to the work in other labs and possibly other sensory systems. How easy would this be? Would one lab have to be able to record both receptor and post-receptor neurons? Would in vitro recordings be useful for interpreting in vivo studies? It would be useful to comment on how well the current strategy could be generalized.</p>
<p>Weaknesses:</p>
<p>
1. The model is limited to describing photoreceptor responses at the level of photocurrents, as opposed to the output of the cell, which takes into account voltage-dependent mechanisms, horizontal cell feedback, etc., as the authors acknowledge. How would one distinguish nonlinearities that emerge at the level of post-photocurrent processing within the photoreceptor as opposed to downstream mechanisms? It would seem as if one is back to the earlier approach, recording at multiple levels of the circuit (e.g., Dunn et al., 2006, 2007).</p>
<p>
2. It would have been nice to see additional confirmations of the approach beyond what is presented in Figure 9. This is limited by the sample (n = 1 horizontal cell) and the number of conditions (1). It would have been interesting to at least see the same test at a dimmer light level, where the major adaptation mechanisms are supposed to occur beyond the photoreceptors (Dunn et al., 2007).</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.93795.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
The authors propose to invert a mechanistic model of phototransduction in mouse and rod photoreceptors to derive stimuli that compensate for nonlinearities in these cells. They fit the model to a large set of photoreceptor recordings and show in additional data that the compensation works. This can allow the exclusion of photoreceptors as a source of nonlinear computation in the retina, as desired to pinpoint nonlinearities in retinal computation. Overall, the recordings made by the authors are impressive and I appreciate the simplicity and elegance of the idea. The data support the authors' conclusions but the presentation can be improved.</p>
<p>Strengths:</p>
<p>
- The authors collected an impressive set of recordings from mouse and primate photoreceptors, which is very challenging to obtain.</p>
<p>
- The authors propose to exploit mechanistic mathematical models of well-understood phototransduction to design light stimuli that compensate for nonlinearities.</p>
<p>
- The authors demonstrate through additional experiments that their proposed approach works.</p>
<p>Weaknesses:</p>
<p>
- The authors use numerical optimization for fitting the parameters of the photoreceptor model to the data. Recently, the field of simulation-based inference has developed methods to do so, including quantification of the uncertainty of the resulting estimates. Since the authors state that two different procedures were used due to the different amounts of data collected from different cells, it may be worthwhile to rather test these methods, as implemented e.g. in the SBI toolbox (<ext-link ext-link-type="uri" xlink:href="https://joss.theoj.org/papers/10.21105/joss.02505">https://joss.theoj.org/papers/10.21105/joss.02505</ext-link>). This would also allow them to directly identify dependencies between parameters, and obtain associated uncertainty estimates. This would also make the discussion of how well constrained the parameters are by the data or how much they vary more principled because the SBI uncertainty estimates could be used.</p>
<p>- In several places, the authors refer the reader to look up specific values e.g. of parameters in the associated MATLAB code. I don't think this is appropriate, important values/findings/facts should be in the paper (lines 142, 114, 168). I would even find the precise values that the authors measure interesting, so I think the authors should show them in a figure/table. In general, I would like to see also the average variance explained by different models summarized in a table and precise mean/median values for all important quantities (like the response amplitude ratios in Figures 6/9).</p>
<p>- If the proposed model is supposed to model photoreceptor adaptation on a longer time scale, I fail to see why this can be an invertible model. Could the authors explain this better? I suspect that the model is mainly about nonlinearities as the authors also discuss in lines 360ff.</p>
<p>- The important Figures 6-8 are very hard to read, as it is not easy to see what the stimulus is, the modified stimulus, the response with and without modification, what the desired output looks like, and what is measured for part B. Reworking these figures would be highly recommended.</p>
<p>- If I understand Figure 6 correctly, part B is about quantifying the relative size of the response to the little first flash to the little second flash. While clearly, the response amplitude of the second flash is only 50% for the second flash compared to the first flash in primate rod and cones in the original condition, the modified stimulus seems to overcompensate and result in 130% response for the second flash. How do the authors explain this? A similar effect occurs in Figure 9, which the authors should also discuss.</p>
</body>
</sub-article>
</article>