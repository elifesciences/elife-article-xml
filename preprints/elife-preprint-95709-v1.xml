<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">95709</article-id>
<article-id pub-id-type="doi">10.7554/eLife.95709</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.95709.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Anti-drift pose tracker (ADPT): A transformer-based network for robust animal pose estimation cross-species</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0008-2318-2624</contrib-id>
<name>
<surname>Tang</surname>
<given-names>Guoling</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1650-2262</contrib-id>
<name>
<surname>Han</surname>
<given-names>Yaning</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Liu</surname>
<given-names>Quanying</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="corresp" rid="cor1">‡</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1845-8856</contrib-id>
<name>
<surname>Wei</surname>
<given-names>Pengfei</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">‡</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Shenzhen Institute of Advanced Technology, Chinese Academy of Sciences</institution>, Shenzhen, <country>China</country></aff>
<aff id="a2"><label>2</label><institution>University of Chinese Academy of Sciences</institution>, Beijing, <country>China</country></aff>
<aff id="a3"><label>3</label><institution>Department of Biomedical Engineering, Southern University of Science and Technology</institution>, Shenzhen, <country>China</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Takahashi</surname>
<given-names>Daniel Y</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Federal University of Rio Grande do Norte</institution>
</institution-wrap>
<city>Natal</city>
<country>Brazil</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Wassum</surname>
<given-names>Kate M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of California, Los Angeles</institution>
</institution-wrap>
<city>Los Angeles</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>‡</label>corresponding author <bold>For correspondence:</bold> <email>pf.wei@siat.ac.cn</email> (P.W); <email>liuqy@sustech.edu.cn</email> (Q.L)</corresp>
<fn id="n1" fn-type="equal"><label>†</label><p>These authors contributed equally to this work</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-05-14">
<day>14</day>
<month>05</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP95709</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-02-06">
<day>06</day>
<month>02</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-02-08">
<day>08</day>
<month>02</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.02.06.579164"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Tang et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Tang et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-95709-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Deep learning-based methods for animal pose estimation have recently made substantial progress in improving the accuracy and efficiency of quantitative descriptions of animal behavior. However, these methods commonly suffer from tracking drifts, i.e., sudden jumps in the estimated position of a body point due to noise, thus reducing the reliability of behavioral study results. Here, we present a transformer-based animal pose estimation tool, called Anti-Drift Pose Tracker (ADPT), for eliminating tracking drifts in behavior analysis. To verify the anti-drift performance of ADPT, we conduct extensive experiments in multiple cross-species datasets, including long-term recorded mouse and monkey behavioral datasets collected by ourselves, as well as two public Drosophilas and macaques datasets. Our results show that ADPT greatly reduces the rate of tracking drifts, and significantly outperforms the existing deep-learning methods, such as DeepLabCut, SLEAP, and DeepPoseKit. Moreover, ADPT is compatible with multi-animal pose estimation, enabling animal identity recognition and social behavioral study. Specifically, ADPT provided an identification accuracy of 93.16% for 10 unmarked mice, and of 90.36% for free-social unmarked mice which can be further refined to 99.72%. Compared to other multi-stage network-based tools like multi-animal DeepLabCut, SIPEC and Social Behavior Atlas, the end-to-end structure of ADPT supports its lower computational costs and meets the needs of real-time analysis. Together, ADPT is a versatile anti-drift animal behavior analysis tool, which can greatly promote the accuracy, robustness, and reproducibility of animal behavioral studies. The code of ADPT is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/tangguoling/ADPT">https://github.com/tangguoling/ADPT</ext-link>.</p>
</abstract>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Animal behavior is a complex and dynamic phenomenon that is shaped by a wide range of factors, including environment, genetics, diseases, cognitive states, and social interactions <bold><italic><xref ref-type="bibr" rid="c39">Robinson et al. (2008</xref></italic></bold>). Understanding the underlying mechanisms and neural correlates of animal behaviors requires accurate and detailed pose tracking as they move freely <bold><italic><xref ref-type="bibr" rid="c37">Pereira et al. (2020</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c20">Krakauer et al. (2017</xref></italic></bold>). Recently, deep learning-based tools such as DeepLabCut, SLEAP, and DeepPoseKit have offered the feasibility of automatically quantifying complex freely-moving animal behaviors from videos recorded by contactless cameras <bold><italic><xref ref-type="bibr" rid="c32">Mathis et al. (2018</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c10">Graving et al. (2019</xref></italic></bold>). Nevertheless, these deep learning methods are susceptible to uncertainty and noise interference, leading to tracking drift in the estimated keypoint dynamics <bold><italic><xref ref-type="bibr" rid="c55">Weinreb et al. (2023</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c16">Hsu and Yttri (2021</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c28">Lonini et al. (2022</xref></italic></bold>). Such drift in keypoints estimates can broadly affect subsequent animal behavior statistics and downstream tasks, such as behavior classification, individual identification, and social behavior clustering <bold><italic><xref ref-type="bibr" rid="c44">Sheppard et al. (2022</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c17">Huang et al. (2021</xref></italic></bold>). It severely jeopardizes the reliability and repeatability of ethological studies. Thus, there is an urgent need for an anti-drift pose tracking tool for animal behavior analysis.</p>
<p>Tracking drift of pose estimation, occurring at the upstream behavioral analysis, generally hinders all downstream behavior-related studies. For example, animal gait analysis relies on accurate tracking of limbs and paws <bold><italic><xref ref-type="bibr" rid="c44">Sheppard et al. (2022</xref></italic></bold>), and behavioral classification relies on the dynamics of body keypoints <bold><italic><xref ref-type="bibr" rid="c17">Huang et al. (2021</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c13">Han et al. (2022</xref></italic></bold>). So far, deep learning pose estimation has not achieved the reliability of classical kinematic gait analysis. One major reason is tracking drift. The drifted keypoints may be unsystematically distributed within each predefined behavior class, misleading the decision boundaries of the behavior class, thereby reducing the performance of supervised behavior classification <bold><italic><xref ref-type="bibr" rid="c9">Gabriel et al. (2022</xref></italic></bold>) or unsupervised behavior representation <bold><italic><xref ref-type="bibr" rid="c17">Huang et al. (2021</xref></italic></bold>). Even the state-of-the-art (SOTA) deep learning methods such as DeepLabCut, SLEAP, and DeepPoseKit have no effective strategies to avoid the tracking drift <bold><italic><xref ref-type="bibr" rid="c32">Mathis et al. (2018</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c10">Graving et al. (2019</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c21">Lauer et al. (2022</xref></italic></bold>). Inherited from the tracking drifts, the inaccuracy of pose estimation, gait analysis, and behavioral classification may result in wrong behavioral discoveries, such as those investigating behavioral correlates of genes, neural circuits, and neuropsychiatric diseases <bold><italic><xref ref-type="bibr" rid="c44">Sheppard et al. (2022</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c17">Huang et al. (2021</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c27">Liu et al. (2021</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c13">Han et al. (2022</xref></italic></bold>). Concerns about the safety of deep learning have largely limited the application of deep learning-based tools in behavioral analysis and slowed down the development of ethology.</p>
<p>There are three strategies to eliminate tracking drift in current SOTA methods of animal pose estimation. The first strategy is human refinement or human in the loop <bold><italic><xref ref-type="bibr" rid="c32">Mathis et al. (2018</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>). DeepLabCut and SLEAP both embed a user interface to allow humans to exclude and rectify outliers frame by frame <bold><italic><xref ref-type="bibr" rid="c32">Mathis et al. (2018</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>). Although it would be the golden criterion to reduce the tracking drift, this strategy restricts the efficiency of the biological experiment when the human faces millions of drifted frames. The second strategy is signal processing filters such as median filter and low pass filter <bold><italic><xref ref-type="bibr" rid="c45">Stenum et al. (2021</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c36">Pereira et al. (2019</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c29">Luxem et al. (2022</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c55">Weinreb et al. (2023</xref></italic></bold>); <bold><italic>Han et al. (2023a</italic></bold>); <bold><italic><xref ref-type="bibr" rid="c23">Li and Lee (2021</xref></italic></bold>). They can efficiently remove most of the drifted points without human intervention, but they will also remove the subtle behaviors with high-frequency features such as self-grooming in autism mouse models <bold><italic><xref ref-type="bibr" rid="c17">Huang et al. (2021</xref></italic></bold>) or tremor in animal models of Parkinson’s disease <bold><italic><xref ref-type="bibr" rid="c2">Baker et al. (2022</xref></italic></bold>). The third strategy is fitting the drifted frames using linear dynamic models such as Keypoint-Moseq <bold><italic><xref ref-type="bibr" rid="c55">Weinreb et al. (2023</xref></italic></bold>) and adaptive Kalman filter <bold><italic><xref ref-type="bibr" rid="c18">Huang et al. (2022</xref></italic></bold>). They can reduce the drift and maintain the high-frequency behaviors at the same time. Nevertheless, the performance of these models would drop sharply when processing continuous and long-duration drifted frames. These three strategies are only expedient to reduce tracking drift after pose estimation, whose performances are also restricted by the tracking accuracy of raw frames. Therefore, the elimination of tracking drift should be tackled from the beginning of the deep learning pose estimation step.</p>
<p>The structure design of the artificial neural network (ANN) is the first step to correct tracking drift. DeepLabCut, SLEAP, and DeepPoseKit all take the convolutional neural network (CNN) as the main component of pose estimation ANNs, which is the core problem causing tracking drift <bold><italic><xref ref-type="bibr" rid="c32">Mathis et al. (2018</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c10">Graving et al. (2019</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c21">Lauer et al. (2022</xref></italic></bold>). The limited working memory of the CNN makes it easy to be influenced by the content-independent parameters to predict the wrong locations of keypoints and finally cause tracking drift <bold><italic><xref ref-type="bibr" rid="c60">Yang et al. (2021</xref></italic></bold>). To avoid this drawback, the Transformer becomes a better option to construct pose estimation ANNs because it is more efficient to capture global dependent features of images <bold><italic><xref ref-type="bibr" rid="c60">Yang et al. (2021</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c46">Stoffl et al. (2021</xref></italic></bold>); <bold><italic><xref rid="c58" ref-type="bibr">Xu et al. (2022b</xref></italic></bold>). Although Transformer-based ANNs have achieved new SOTA in lots of human pose estimation datasets, it is rarely applied in animal pose estimation. Different from human poses, animal poses have more indistinct body structures because they are covered by furs <bold><italic><xref ref-type="bibr" rid="c53">Vidal et al. (2021</xref></italic></bold>). In addition, the well-annotated animal pose datasets are not abundant enough to cover various experiment settings. Experimenters always need to make customized datasets for their specific applications <bold><italic><xref rid="c12" ref-type="bibr">Han et al. (2023a</xref></italic></bold>). Therefore, the application of the Transformer to reduce tracking drift in the animal pose estimation task still needs an elaborate design of ANN structures.</p>
<p>To import the Transformer to overcome the tracking drift of animals, we designed an anti-drift pose tracker (ADPT) following the characteristics of animal behavior data. CNN and Transformer are cascaded with skip connections to capture subtle animal appearance features from only hundreds of labeled frames <bold><italic><xref ref-type="bibr" rid="c15">He et al. (2016</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c22">LeCun et al. (2015</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c52">Vaswani et al. (2017</xref></italic></bold>). This structure design makes ADPT show significantly fewer tracking drifts than DeepLabCut and SLEAP <bold><italic><xref ref-type="bibr" rid="c32">Mathis et al. (2018</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>). The effect of anti-drift of ADPT is universally validated in the public datasets and our customized datasets including Drosophilas, mice, and macaques, which demonstrates that ADPT is robust in broad application scenarios cross-species <bold><italic><xref ref-type="bibr" rid="c36">Pereira et al. (2019</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c3">Bala et al. (2020</xref></italic></bold>); <bold><italic><xref rid="c12" ref-type="bibr">Han et al. (2023a</xref></italic></bold>). ADPT also achieves robust pose estimation and identity recognition of free-interactive mice combined with a mix-up dataset generation strategy. The results of markerless identity recognition show that the feature extraction of ADPT is reliable enough to cover both multi-animal pose estimation and identity recognition tasks, which are more difficult than the single-animal pose estimation task <bold><italic><xref ref-type="bibr" rid="c1">Agezo and Berman (2022</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c21">Lauer et al. (2022</xref></italic></bold>); <bold><italic><xref rid="c12" ref-type="bibr">Han et al. (2023a</xref></italic></bold>). It reduces the computational time cost and increases the throughput of behavioral data processing because ADPT does not need a multi-stage neural network such as SIPEC <bold><italic><xref ref-type="bibr" rid="c31">Marks et al. (2022</xref></italic></bold>) or Social Behavior Atlas <bold><italic><xref rid="c12" ref-type="bibr">Han et al. (2023a</xref></italic></bold>). Together, ADPT would be an accessible tool to reduce the pose tracking shift across species from the upstream of behavior analysis. ADPT has the potential to improve the reliability of computational ethology-based biological studies.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Anti-drift pose tracker</title>
<p>Existing deep learning-based methods often produce some unreliable pose estimation, such as interference caused by similar objects, keypoint drift, and failures of body part detection (<xref rid="fig1" ref-type="fig">Figure 1A</xref>). These estimation errors largely compromise the robustness of pose estimation in freely behaving animals, which can affect the statistical results of behavioral analyses and sometimes even lead to erroneous scientific findings. In this study, we present a reliable animal behavioral analysis tool, called the anti-drift pose tracker (ADPT). ADPT can effectively eliminate estimated drifts (<xref rid="fig1" ref-type="fig">Figure 1B</xref>). ADPT is a heatmap based pose estimation network that inferences input image to confidence heatmap, location refinement and low resolution semantic segmentation (LRSS) (<xref rid="fig1" ref-type="fig">Figure 1C</xref>). In the network architecture of ADPT (<xref rid="fig1" ref-type="fig">Figure 1D</xref>), we utlize the convolutional structure to extract local information on the one hand, and the transformer attention mechanism to learn the long-term global dependencies on the other hand. Compared with purely attention-based network structures (such as ViT <bold><italic><xref ref-type="bibr" rid="c60">Yang et al. (2021</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c46">Stoffl et al. (2021</xref></italic></bold>); <bold><italic><xref rid="c58" ref-type="bibr">Xu et al. (2022b</xref></italic></bold>), our CNN-transformer structure can significantly reduce the number of model parameters and therefore requires fewer training data samples. It is particularly suitable for data-limited applications such as animal behavior analysis.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><p>Anti-drift pose tracker (ADPT). <bold>A</bold> Three examples of drifts in deep learning-based animal behavioral analysis. Similar object disturbance means that the object similar to a specific body part misleads the deep learning-based methods. Inexplicable keypoint drift is caused by the high confidence score predicted on the wrong place by the network. Failure to detect the keypoint is probably caused by the the predicted low confidence score. <bold>B</bold> The anti-drift effects of ADPT. <bold>C</bold> The general workflow of ADPT. The network is trained to predict confidence heatmap, LRSS, and location refinement. <bold>D</bold> The network architecture of ADPT.</p></caption>
<graphic xlink:href="579164v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2b">
<title>Customized behavioral videos for testing ADPT</title>
<p>The identification of drifting keypoints relies heavily on videos generated during inference or visualized coordinates. Yet there is no publicly available video dataset specifically designed for anti-drift evaluation. To fill this gap, we collected behavioral data from mice and monkeys (see supplement videos 1). We recorded videos from free-moving mice and monkeys with 4 cameras and then hand-labeled randomly extracted frames. For mice, we labeled these frames with 16 keypoints, including nose, eyes, ears, front limbs, front claws, back, hind limbs, hind claws, root tail, mid tail and tip tail. For monkeys, we labeled these frames with 17 keypoints, including nose, eyes, ears, shoulders, elbows, hands, hips, knees, and ankle. Given the popularity of mouse behavioral study, mice served as our primary subjects for evaluation, with videos obtained from 4 different perspectives involving 4 distinct individuals. Each mouse video spanned 15 minutes. The training dataset comprised 440 randomly extracted images from these videos and other collected videos(training:validation=95%:5%). Monkey videos, on the other hand, encompassed 8 different viewpoints, featuring multiple individuals, from which a 30 minutes video was used for performance evaluation. The training set consisted of 3488 randomly sampled images (training:validation=95%:5%). Using our dataset, we trained ADPT, DeepLabCut, and SLEAP models, separately, to track body keypoints from behavioral videos. The behavioral data is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/tangguoling/ADPT/data">https://github.com/tangguoling/ADPT/data</ext-link>.</p>
</sec>
<sec id="s2c">
<title>ADPT demonstrates the remarkable anti-drift performance</title>
<p>We first visualized the time course of seventeen estimated key body parts from a one-minute segment of mouse videos (<xref rid="fig2" ref-type="fig">Figure 2A</xref>), demonstrating the anti-drift effects of ADPT. In contrast, the other two deep learning-based methods suffer from drift and misses of body parts. Then, we zoomed into the frames of failures in <xref rid="fig2" ref-type="fig">Figure 2B</xref>. The quantitative results of 240-minute videos from two mice were shown in <xref rid="fig2" ref-type="fig">Figure 2C&amp;D</xref>. Interestingly, DeepLabCut has almost the same probability of generating drift and misses, while SLEAP was more prone to misses. As presented in <xref rid="fig2" ref-type="fig">Figure 2D</xref>, the tip tail was the most challenging part of the body for both drifts and missed due to the long distance from the tip tail to the rest of the body. For CNN-based methods such as DeepLabCut and SLEAP, learning such long-range tail-body relationships is particularly difficult, while the attention mechanism of ADPT allows it to learn long-range dependencies. Due to frequent occlusion in the video, the left and right claws could be easily missed or drifted. Our model evaluations show that ADPT has significantly lower root mean squared errors compared to SLEAP and achieves comparable or improved accuracy compared to DeepLabCut (<xref rid="fig2" ref-type="fig">Figure 2E</xref>), suggesting that ADPT can reliably detect the hind claws, offering a potential tool for gait analysis and tail-related behavior paradigms.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><p>Analysis of ADPT’s anti-drift performance in a mouse dataset collected by our lab. <bold>A</bold> The time course of the <italic>y</italic>-axis position of sixteen body parts extracted from a one-minute video using ADPT, DeepLabCut and SLEAP tools. It showed that ADPT successfully tracked all 17 body parts of a mouse, whereas DeepLabCut and SLEAP encountered inexplicable tracking drifts. <bold>B</bold> Two anti-drift examples from ADPT, where the tail was drifted by DeepLabCut and the hind claw failed to detect by SLEAP. <bold>C</bold> Overall percentage of tracking drift and failing to detect (miss) frames from three methods. ADPT demonstrated a significantly lower drift percentage than other methods. <bold>D</bold> The percentage of frames with tracking drift (left) and failing to detect (right). Drifts were mainly from the top four body parts, including the tip tail, the left and the right hind claws, and the middle tail. <bold>E</bold> The averaged RMSE across all body parts (left) and RMSE of the top four body parts with drifts (right). ADPT achieved the smallest RMSE than other two tools when thresholded at 0.2. *: P&lt;0.05, **: P&lt;0.01, ***: P&lt;0.001, ****: P&lt;0.0001. RMSE: root mean square error.</p></caption>
<graphic xlink:href="579164v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2d">
<title>Anti-drift performance remains consistent irrespective of the video background and individual animals</title>
<p>Any measuring tool that exhibits biased measurement errors towards specific subjects introduces inaccuracies in its assessments. For example, if the model accurately estimates the posture of mouse A but experiences greater posture drift in estimating mouse B, this discrepancy leads to measurement errors, impacting subsequent behavioral analyses. Hence, to evaluate the independence of posture estimation’s anti-drift effect concerning individual animals or background factors, we conducted one-way ANOVA on the tracking results. We trained ADPT, DeepLabCut, and SLEAP five times each and applied these models to infer behavioral videos across different individuals and video backgrounds. Firstly, we compared ADPT’s anti-drift performance across different individuals and backgrounds. The results showed that ADPT exhibited significantly lower drift percentages than the other two methods across different individuals and video backgrounds (<xref rid="fig3" ref-type="fig">Figure 3 A&amp;C</xref>).Then, the inference results were grouped based on individual animals and video backgrounds, respectively, for five individual one-way ANOVA analyses. The results of these five ANOVA analyses are presented in <xref rid="fig3" ref-type="fig">Figure 3 B&amp;D</xref>. Our analyses revealed that drift occurrences were more significantly affected by backgrounds in DeepLabCut, while individual variations had a more significant impact on SLEAP. However, ADPT showed slight susceptibility to background influence. Consequently, we assert that in comparison to DeepLabCut and SLEAP, ADPT only demonstrates a lesser susceptibility to the influence of individual animals and background factors. This resilience significantly mitigates biases in tracking results. ADPT’s ability to generate fewer biases due to individual or background factors during inference holds promise for achieving better consistency in downstream behavioral analyses.This analysis also underscores the importance, when using ADPT, of minimizing background variations, ideally maintaining consistent backgrounds.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><p>Anti-drift performance cross background and individual, where the percentage of frames includes two types of drift phenomena: drift and miss. <bold>A</bold> The overall cross-individual anti-drift performance of ADPT and the other methods. The drift percentage of ADPT is significant lower than other methods. <bold>B</bold> After training the model 5 times on the dataset shuffle, the cross-individual drift percentage for each shuffle was analyse using one-way ANOVA. The ANOVA results revealed that there are differences in the inference results of the SLEAP model among individual, and there were no differences for ADPT or DeepLabCut. <bold>C</bold> The overall cross-background anti-drift performance of ADPT and the other methods. The drift percentage of ADPT is significant lower than other methods. <bold>D</bold> The cross-background drift percentage for each shuffle was analyse using one-way ANOVA. The ANOVA results revealed that there are slight differences in the inference results of the DeepLabCut model among individual, and there were no differences for ADPT or SLEAP. ns.: no significant, *: P&lt;0.05, **: P&lt;0.01, ***: P&lt;0.001, ****: P&lt;0.0001.</p></caption>
<graphic xlink:href="579164v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2e">
<title>Cross-species anti-drift capability of ADPT is reliable</title>
<p>While ADPT has demonstrated exceptional anti-drift abilities in mice, numerous other animal models are employed in behavioral studies. To validate the robustness of ADPT in tracking different species, particularly those posing significant tracking challenges, we selected cynomolgus monkey as a specie known for its complexities in tracking. We utilzed the models to track a video in which both humans and monkey appeared simultaneously, presenting similar objects in the scene. Visualizing the keypoint tracking results from 1-minute time course featuring both entities allowed us to showcase the anti-drift efficacy of ADPT (<xref rid="fig4" ref-type="fig">Figure 4A</xref>). In contrast, the other two methods exhibited tracking failures when humans were present, as illustrated in the zoomed-in frames of failure in <xref rid="fig4" ref-type="fig">Figure 4B</xref>. When humans were present, both DeepLabCut and SLEAP exhibited instances of tracking drift, whereas ADPT remained unaffected by the presence of similar objects. Similarly, we evaluated the performance of ‘drift’ and ‘miss’ for various body parts in this scenario. We observed that ADPT consistently outperformed the other two methods overall (<xref rid="fig4" ref-type="fig">Figure 4C&amp;D</xref>). However, given the more complex experimental setup and animal movements, ADPT exhibited slight instances of drift and ‘fail to detect’ effects.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Analysis of ADPT’s anti-drift performance on monkey data, showing the cross species anti-drift ability. <bold>A</bold> The time course of the <italic>y</italic>-axis position of sixteen body parts extracted from a one-minute video using ADPT, DeepLabCut and SLEAP tools. It showed that ADPT successfully tracked all 17 body parts of a monkey, while the other two methods encountered tracking drift because of the appearance of humans. <bold>B</bold> DeepLabCut and SLEAP both mistakenly located the monkey’s eyes on humans when they appeared, while ADPT can achieve robust tracking. <bold>C, D</bold> The percentage of frames with tracking drift and failing to detect (miss). The occurrence of drift was mainly concentrated in the limbs, because the appearance of humans.</p></caption>
<graphic xlink:href="579164v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Consequently, our findings suggest that our approach demonstrates remarkable anti-drift performance, cross-individual and cross-view capabilities. Notably, our anti-drift performance was more pronounced in consistent experimental scenarios. Our experiments with monkeys substantiated our method’s profound cross-species anti-drift capability, emphasizing its significance in behavioral studies involving diverse animal models.</p>
</sec>
<sec id="s2f">
<title>Public datasets confirm the outperformance of ADPT in precision and practicality</title>
<p>In adddition to evaluating ADPT’s performance on behavioral study videos, we recognized the significance of image datasets as benchmarks for assessing pose estimation effectiveness. Thus, to comprehensively evaluate the generalizability of ADTP performance to animals in skeletal complexity and body size, and the background complexity of videos, we used two public datasets, a single fly dataset (<xref rid="fig5" ref-type="fig">Figure 5A</xref> <bold><italic><xref ref-type="bibr" rid="c36">Pereira et al. (2019</xref></italic></bold>), and a macaque OMS_Datase <bold><italic><xref ref-type="bibr" rid="c3">Bala et al. (2020</xref></italic></bold>). The single fly dataset contains 1500 annotated frames of 32-node skeleton fly. To ensure a fair comparison, we followed the same dataset split strategy and data augmentation strategy described in <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>). The evaluation metric used was mean Average Precision (mAP), which measures the accuracy of keypoint localization for all body parts, following the protocol established in <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>). On the other hand, The OMS_Dataset <bold><italic><xref ref-type="bibr" rid="c3">Bala et al. (2020</xref></italic></bold>) is a large database of annotated macaque images (<xref rid="fig5" ref-type="fig">Figure 5F</xref>). To evaluate the performance of our methods, we randomly selected 5000 images out of 195,228 images from this dataset and resized them to 368 × 368 resolution. We split the dataset into 40% training data and 60% validation data. We employed the same strategy used in the default configuration of DeepLabCut toolbox to augment the data. The average distance (root square mean errors, RMSE) between the ground truth and predicted keypoints and the mAP were used as evaluation metrics. <xref rid="fig5" ref-type="fig">Figure 5A</xref> and <xref rid="fig5" ref-type="fig">Figure 5F</xref> presented several examples annotated by ADPT on these two datasets, respectively. Furthermore, to verify the practicality of ADPT, we also evaluated the amount of required training data and the inference speed of the model. Finally, we evaluated the scalability of ADPT on the StanfordExtra dataset <bold><italic><xref ref-type="bibr" rid="c4">Biggs et al. (2020</xref></italic></bold>). Our results demonstrated the capability of ADPT on non-laboratory dogs (Supplementary Figure 1 and Supplementary Video 2). These evaluations underscore ADPT’s versatility, showcasing its robustness and accuracy in diverse animal contexts, thereby affirming its potential as a highly adaptable tool for comprehensive hehavioral studies.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><p>Results of public datasets evaluation. <bold>A</bold> Samples of prediction on single fly dataset. <bold>B</bold> Mean average precision (mAP) on fly dataset, where ADPT achieved average 92.8% accuracy (the best model achieved 93.27%). <bold>C</bold> RSS improved the average accuracy by 0.3% on single fly dataset. <bold>D</bold> Relationship between annotated image and accuracy of ADPT on fly dataset where ADPT achieved acceptable performance with only 350 annotated images in a simple laboratory environment. Points indicate the validation accuracy of model training on specific number of labels dataset. <bold>E</bold> Transformer improved the average accuracy by 0.4% on single fly dataset. <bold>F</bold> Samples of prediction on OMS_Dataset. <bold>G</bold> Root mean square error (RMSE) on OMS_Dataset, where ADPT achieved smaller RMSE than SLEAP when threshold = 0.2, and smaller than DeepLabCut when threshold = 0.6. P value, **: 0.001862, ns.: 0.243472, ***: 8.700e-06. <bold>H</bold> RMSE comparison on hip and tail of OMS_Dataset.P value, ***: 0.000561, Hip ns. :0.023766, Tail ns. :0.336642, *: 0.035782.</p></caption>
<graphic xlink:href="579164v1_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s2f1">
<title>ADPT offers higher tracking accuracy than existing SOTA methods</title>
<p>The tracking performance of ADPT was compared with the existing SOTA methods, such as DeepLabCut and SLEAP (<xref rid="fig5" ref-type="fig">Figure 5B, G</xref> and <xref rid="fig5" ref-type="fig">H</xref>). On the single-fly dataset, ADPT exceled with an average mAP of 92.83%, surpassing both DeepLabCut and SLEAP (<xref rid="fig5" ref-type="fig">Figure 5B</xref>). On the OMS Dataset, ADPT exhibited significant advantages in terms of mAP, RMSE (threshold = 0.2), RMSE (threshold = 0.6), achieving values of 30.9%, 8.32, and 6.25, which were significantly superior to SLEAP, and slightly outper-forming DeepLabCut when the threshold set as 0.6 (<xref rid="fig5" ref-type="fig">Figure 5G</xref>, supplement Table 1). Moreover, we further examined the tracking of macaque hip and tail on OMS_Dataset (<xref rid="fig5" ref-type="fig">Figure 5H</xref>). We found that ADPT’s tracking performance of tail is better than DeepLabCut and SLEAP, while the hip tracking is equivalent to DeepLabCut and better than SLEAP. This further demonstrates the superiority of ADPT in tail-related behavior paradigms. By conducting evaluations on these diverse datasets, we aimed to assess the robustness and generalizability of our methods across more different animal species, pose complexities, and environmental conditions. The results obtained from these evaluations provide solid proof of the performance and potential of our methods for single-animal pose estimation.</p>
</sec>
<sec id="s2f2">
<title>ADPT only needs a small amount of annotated data</title>
<p>Since annotating behavioral data is tedious, a deep learning-based method that does not require large amounts of annotated data is crucial. Here, we studied how the accuracy of ADPT changes with the amount of annotated data. Notably, ADPT achieved acceptable performance using only 350 annotated images (<xref rid="fig5" ref-type="fig">Figure 5D</xref>), indicating that ADPT is data efficient.</p>
</sec>
<sec id="s2f3">
<title>ADPT’s fast inference enables real-time applications</title>
<p>Here we evaluate the inference speed of ADPT. We compared it with DeepLabCut and SLEAP on mouse videos at 1288 x 964 resolution. Our method exhibited an impressive prediction speed of 90±4 frames per second (fps), faster than DeepLabCut (44±2 fps) and equivalent to SLEAP (106±4 fps). These results highlighted the efficient inference capabilities of ADPT, which is crucial for real-time applications and the analysis of large-scale behavioral data.</p>
</sec>
<sec id="s2f4">
<title>LRSS and transformer help improve tracking accuracy</title>
<p>To examine the contribution of the low-resolution semantic segmentation (LRSS) and the transformer architecture to ADPT, we conducted two ablation studies using the fly dataset. We compared multiple variants to uncover the impacts of the LRSS module and the transformer module on pose estimation performance. Firstly, we explored the influence of LRSS by comparing the performance of the complete ADPT with the one removed LRSS. As shown in <xref rid="fig5" ref-type="fig">Figure 5C</xref>, LRSS module can improve the average accuracy by 0.2%. Moreover, to assess the role of transformer architecture, we conducted a comparative analysis between the complete ADPT with the transformer and a variant of the model where the transformer was removed. As shown in <xref rid="fig5" ref-type="fig">Figure 5E</xref>, the transformer improved the average accuracy by 0.4%, suggesting the benefits of the transformer architecture in pose estimation.</p>
</sec>
<sec id="s2f5">
<title>ADPT can accurately track the non-laboratory dog</title>
<p>To test the generalizability of our approach beyond laboratory-behavior animals, we applied ADPT to the keypoint detection task for the non-laboratory dog. The dataset is from <bold><italic><xref ref-type="bibr" rid="c4">Biggs et al. (2020</xref></italic></bold>). We randomly divided the dataset into 85% and 15% training and validation data. ADPT was instantiated with the same network architecture for laboratory animal pose estimation, showcasing the versatility of ADPT. We followed <bold><italic><xref ref-type="bibr" rid="c4">Biggs et al. (2020</xref></italic></bold>) and used Percentage of Correct Keypoints (PCK) metric to evaluate the accuracy of keypoint detection. The results showed that ADPT achieved an average 86.54% PCK score (legs: 85.54%, tail: 79.89%, ears: 88.61%, face: 95%). Examples of identified keypoints of dogs were shown in Supplement <xref rid="fig1" ref-type="fig">Figure 1</xref> and Supplement Video 2. These results supported the flexibility of ADPT in different animal species and potentially more challenging real-world scenarios.</p>
</sec>
</sec>
<sec id="s2g">
<title>ADPT can be adapted for end-to-end pose estimation and identification of freely social animals</title>
<p>We adapted ADPT to end-to-end tracking of the socially interacting mice with similar appearances. To this end, we added additional heads after feature concatenation and utilized LRSS to confirm the identities of the mice. We generated a multi-animal dataset for social tracking by mixing up two labeled frames from single mouse videos (<xref rid="fig6" ref-type="fig">Figure 6</xref>). The evaluation of our social tracking capability was performed by visualizing the predicted video data (see supplement Videos 3 and 4).</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><p>Illustration for mix-up social animal dataset generation. <bold>A</bold> Frames originating from different videos and corresbonding background. <bold>B</bold> Mix-up image. <bold>C</bold> Represents schematic diagrams illustrating the keypoint generated from single animal pose estimation of ADPT. <bold>D</bold> Represents an augmented mix-up image. <bold>E</bold> Represents schematic diagrams of augmented annotation. <bold>F</bold> Represents augmented keypoints. <bold>G</bold> Represents augmented LRSS. <bold>H</bold> Represents schematic diagrams of augmented Body Affinity Fields(BAF), inspired by Part Affinity Fileds(<bold><italic><xref ref-type="bibr" rid="c6">Cao et al. (2021</xref></italic></bold>)).</p></caption>
<graphic xlink:href="579164v1_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Prior to social tracking, we evaluated identity-tracking accuracy using a dataset consisting of 10 mouse videos of different individuals. The overall workflow of these extended applications is depicted in <xref rid="fig7" ref-type="fig">Figure 7</xref>. Initially, we utilized a variant of ADPT (empowering LRSS with identity information) for simultaneous animal pose estimation and identity-synchronized tracking. For each frame, identity recognition was based on the LRSS output by ADPT (<xref rid="fig7" ref-type="fig">Figure 7A</xref>). Although the appearance of the mice is very similar, our experimental results showcased a remarkable 93.16% accuracy in identity recognition (<xref rid="fig7" ref-type="fig">Figure 7B</xref>). This approach demonstrates LRSS’s capability to record individual identities like semantic segmentation masks. The outcomes, showcased in supplement Videos 3, manifested synchronized tracking of identity and pose estimation.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7.</label>
<caption><p>Applications of ADPT for multi-animal pose tracking. <bold>A</bold> Left: The pipeline for the multi-animal identity-pose tracking task. <bold>B</bold> Confusion matrix of the 10-mice classification (accuracy=93.16%).<bold>C</bold> Social mice tracking pipeline with identification accuracy of 99.72%.</p></caption>
<graphic xlink:href="579164v1_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Subsequently, we tested the tracking performance with free-social animals. Inspired by Part Affinity Fileds <bold><italic><xref ref-type="bibr" rid="c6">Cao et al. (2021</xref></italic></bold>), we created Body Affinity Fileds (BAF) to help distinguish different individuals. BAF and LRSS were used together to identify individuals. We trained ADPT on the Mixup social animal dataset and employed it to predict 1-minute free-social video of mice with similar appearance. Without additional temporal post-processing, ADPT achieved a 90.36% accuracy in identity recognition, as referenced in supplement Video 4A. Following temporal identity correction, ADPT remarkably achieved a 99.72% accuracy in identity recognition (<xref rid="fig7" ref-type="fig">Figure 7C</xref>), as shown in supplement Video 4B.</p>
<p>Together, these two different applications demonstrate the versatility of ADPT, ranging from single animal pose estimation to complex situations involving social interactions. ADPT’s versatility and adaptability paves the way for comprehensive behavioral studies.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Here, we have presented ADPT, a Transformer-based pose tracker, to address the pose drift problem in animal pose estimation. The core of ADPT is the elaborate combination of the convolutional network <bold><italic><xref ref-type="bibr" rid="c22">LeCun et al. (2015</xref></italic></bold>) and transformer layers <bold><italic><xref ref-type="bibr" rid="c52">Vaswani et al. (2017</xref></italic></bold>), with the goal of capturing both local details and global context. This architecture helps ADPT achieve a more reliable feature extraction on animal objects, resulting in higher accuracy in tracking the poses frame by frame with less drifts or misses, compared to DeepLabCut and SLEAP <bold><italic><xref ref-type="bibr" rid="c21">Lauer et al. (2022</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>). In addition, we presented the procedure for the data generation of Mix-up social animals, which is convenient and effective for exponentially synthesizing new data to improve the performance of ADPT. We showed that ADPT can be used for multi-animal pose estimation and identification. These two tasks were considered much more difficult than single-animal pose estimation <bold><italic><xref ref-type="bibr" rid="c21">Lauer et al. (2022</xref></italic></bold>). The end-to-end network structure of ADPT only needs to calculate one model loss so it is more computationally efficient than the multi-stage methods such as SIPEC and Social Behavior Atlas <bold><italic><xref ref-type="bibr" rid="c31">Marks et al. (2022</xref></italic></bold>); <bold><italic><xref rid="c12" ref-type="bibr">Han et al. (2023a</xref></italic></bold>). These advances show that ADPT is an accurate, universal, and efficient method, suggesting broader application scenarios in neuroscience, genetics, and drug discovery.</p>
<p>As the higher resolution of microscopy promotes the discovery of biological microstructures, the higher precision of animal pose estimation helps to detect subtle behavior structures and patterns, advancing ethology research. Behavior structures have been proven to be the signatures, fingerprints, and biomarkers to indicate disease developments <bold><italic><xref ref-type="bibr" rid="c5">Bohic et al. (2023</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c11">Gschwind et al. (2023</xref></italic></bold>), genetic mutations <bold><italic><xref ref-type="bibr" rid="c27">Liu et al. (2021</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c17">Huang et al. (2021</xref></italic></bold>); <bold><italic><xref rid="c12" ref-type="bibr">Han et al. (2023a</xref></italic></bold>), and drug effects <bold><italic><xref ref-type="bibr" rid="c57">Wiltschko et al. (2020</xref></italic></bold>); <bold><italic>Han et al. (2023b</italic></bold>). Although these studies refine the behavior to module level <bold><italic><xref ref-type="bibr" rid="c56">Wiltschko et al. (2015</xref></italic></bold>), this spatiotemporal scale of behavior structures is not sufficient to support finer animal studies such as decoding millisecond neural recordings with un-drifted poses <bold><italic><xref ref-type="bibr" rid="c43">Schneider et al. (2023</xref></italic></bold>). Therefore, improving the accuracy and reliability of animal pose estimation is of high need for behavioral studies. ADPT provides such a tool for animal pose estimation.</p>
<p>ADPT enables a wide range of downstream applications, for instance, aligning behavioral manifold from keypoint dynamics with the neural manifold from large-scale neural recordings <bold><italic><xref ref-type="bibr" rid="c51">Urai et al. (2022</xref></italic></bold>). Recent advances in neural decoding of speech <bold><italic><xref ref-type="bibr" rid="c25">Li et al. (2023</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c33">Metzger et al. (2023</xref></italic></bold>) and vision <bold><italic><xref ref-type="bibr" rid="c43">Schneider et al. (2023</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c48">Takagi and Nishimoto (2023</xref></italic></bold>) have achieved incredible performance, but the accurate neural decoding of poses is still an existing problem. ADPT can quantify the poses of animals to reach a high resolution like the microphone for speech acquisition or visual pixels, which is an improvement from the aspect of behavior data acquisition. The second application is the gait analysis for 3D movements. Non-human primates are not restricted to moving on the ground, and the 3D gait would reflect their abnormal state after modeling treatment <bold><italic><xref ref-type="bibr" rid="c26">Liang et al. (2023</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c49">Thota and Alberts (2013</xref></italic></bold>). ADPT decreases the pose drift caused by body occlusion of single-view frames, which would reduce the error of 3D gait reconstruction. It also reduces the number of cameras for view angle compensation except for the profound understanding of 3D gait-related disorders <bold><italic><xref ref-type="bibr" rid="c3">Bala et al. (2020</xref></italic></bold>). The third application is behavior-based drug screening <bold><italic><xref ref-type="bibr" rid="c57">Wiltschko et al. (2020</xref></italic></bold>). Although MoSeq has built up the relationship between behavior syllables and psychoactive drugs <bold><italic><xref ref-type="bibr" rid="c56">Wiltschko et al. (2015</xref></italic></bold>, 2020), the resolution of behavior only exists at the syllable level. It is predictable for ADPT to improve the behavior resolution of MoSeq even Keypoint-MoSeq to a finer level to be not limited to the screen of psychoactive drugs <bold><italic><xref ref-type="bibr" rid="c56">Wiltschko et al. (2015</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c55">Weinreb et al. (2023</xref></italic></bold>). In summary, solving the anti-drift problem from the very beginning of ADPT determines that it has widespread applications.</p>
<p>One potential improvement of ADPT is the design of positional encoding. With the increase in image size, the positional encoding would occupy more memory of the graphics processing unit. The process of high-resolution videos has to resize the frame to avoid being out of memory, in which the pixel-level information could be missed. Conditional positional encoding would be a possible solution to improve ADPT to face high-resolution frames <bold><italic><xref ref-type="bibr" rid="c8">Chu et al. (2021</xref></italic></bold>). Another improvement of ADPT is using a more powerful backbone neural network. To facilitate the comparison between ADPT with other methods, the ResNet50 is used in all of the validation <bold><italic><xref ref-type="bibr" rid="c15">He et al. (2016</xref></italic></bold>). Recent advances in the backbone such as RegNet <bold><italic><xref rid="c58" ref-type="bibr">Xu et al. (2022a</xref></italic></bold>) could be the better choice to replace ResNet and improve the performance of ADPT.</p>
</sec>
<sec id="s4">
<title>Methods and materials</title>
<p>In this section, we first present ADPT method, then introduce the datasets used in each experiment, and finally describe the details of multi-animal experiments.</p>
<sec id="s4a">
<title>The details of ADPT</title>
<p>Here we present the key components and details of ADPT. We also provide the code for ADPT at <ext-link ext-link-type="uri" xlink:href="https://github.com/tangguoling/ADPT/code">https://github.com/tangguoling/ADPT/code</ext-link></p>
<sec id="s4a1">
<title>The network architecture</title>
<p>Applying transformer in freely behaving animal pose estimation can help us alleviate keypoint tracking drift. Thus, we created a heatmap-based pose estimation model, called ADPT. The overall structure of the method and network is illustrated in <xref rid="fig1" ref-type="fig">Figure 1C</xref> and <xref rid="fig1" ref-type="fig">D</xref>. Initially, the network employs the stack1-2 of the ResNet50 model to extract shallow-level features from the input images. At this stage, the images are extracted into features with a size of one-fourth of their original dimensions. Subsequently, network separately process these features in three branches, compute features at scale of one-fourth, one-eight and one-sixteenth, and generate one-eight scale features using convolution layer or deconvolution layer. Of particular significance is the utilization of the one-sixteenth scale feature, which is input into a transformer module for computation. This large-scale feature’s involvement in the multi-head attention mechanism substantially enhances the model’s ability to capture global relationships within the data. Finally, model concatenates these features by skip connections and compute them using convolution layers to generating output, including keypoint position confidence heatmaps, location refinement maps, low-resolution semantic segmentation map, and body affinity fields map.</p>
</sec>
<sec id="s4a2">
<title>Low resolution semantic segmentation</title>
<p>In addition to generating the animal’s skeletal keypoints, we also create a low-resolution semantic segmentation map (LRSS) of the animal. This segmentation map captures the coarse-level information about the different body parts or regions of the animal. By connecting the skeletal keypoints, the model can infer the boundaries, shapes and identities of these regions. According to keypoints set <italic>kps</italic> of all individuals in frame, the pixel <italic>p</italic> value at segmentation map is defined as,
<disp-formula id="eqn1">
<graphic xlink:href="579164v1_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
The low-resolution map plays a crucial role in training our model. It allows the model to learn the correlation between the skeletal keypoints and the semantic information of the animal’s body. By incorporating the segmentation map into the training process, the model can better understand the spatial relationships between different keypoints and improve the accuracy and robustness of pose estimation.</p>
</sec>
<sec id="s4a3">
<title>Network training details</title>
<p>In our single-animal pose estimation tasks, we employed specific training configurations to optimize the performance of our models. The following training details were utilized. We trained the models for a total of 190 epochs. Additionally, we included 10 warm-up epochs at the beginning of the training process. The batch size used during training was set to 8. We utilized the <italic>AdamW</italic> optimizer, and the weight decay rate was set to 1e-4. We employed a warmup cosine decay schedule for the learning rate. Initially, the learning rate was warmed up from 1e-5 to 1e-3 over the warm-up epochs. Subsequently, the learning rate gradually decayed to 1e-5 using a cosine decay function. For optimizing the keypoint confidence heatmaps and location refinement maps, we utilized root square error (RMSE) as the loss function. RMSE measures the average squared difference between the predicted and ground truth key points, providing a measure of the accuracy of the model’s predictions. Additionally, for training the low-resolution semantic segmentation map, we used sparse categorical cross-entropy loss, which is suitable for multi-class segmentation tasks. We early stop the training procedure when it reaches a plateau for 30 epochs according to validation loss. These training details were carefully chosen to ensure effective training and optimization of our models for single animal pose estimation. For data augmentation, we followed DeepLabCut augmentation strategy <bold><italic><xref ref-type="bibr" rid="c32">Mathis et al. (2018</xref></italic></bold>) in training ADPT, and followed <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>) specifically for single fly dataset. The image inputs of ADPT were resized to a size that can be trained on the computer. For mouse images, it was reduced to half of the original size. For monkey images, it was reduced to 0.8 of the original size. For macaque and fruit flies, there is no resizing, while for dogs, it was resized to 224 × 224 resolution.</p>
<p>The specific values and configurations may vary depending on the dataset, network architecture, and specific requirements of the task.</p>
</sec>
<sec id="s4a4">
<title>Network implementation</title>
<p>We implementated ADPT in the Python programming language(python 3.9). We used tensorflow 2.9.1 for all deep learning models. We used imgaug for image and annotation augmentation. We used OpenCV for video reading/writing and matplotlib for image reading. The hardware condition includes RTX4090 GPU, Intel 12900K CPU, Samsung 980 Pro hard disk, and 128 GB DDR5 memory. For comparison, we used DeepLabCut 2.2.1 with default configuration during training, in which ‘global_scale’ parameter was adjusted to match with ADPT resizing configuration. Similarly, SLEAP 1.2.9 was used with the baseline_medium_rf.single configuration, adjusting the ‘input scaling’ to align with ADPT’s resizing configuration.</p>
</sec>
</sec>
<sec id="s4b">
<title>Datasets</title>
<p>To comprehensively evaluate the robust performance of ADPT, we selected datasets consider factors such as skeletal complexity, body size, and background complexity. However, there exists no publicly available video dataset specifically designed for anti-drift evaluation. Therefore, we also collected behavioral video data involving mice and monkeys. We also provide code to transfer DeepLabCut format labeled dataset to our ADPT format dataset, which may allow users to make deeper study toward the past behavioral data. Code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/tangguoling/ADPT/data/dlc2adpt.py">https://github.com/tangguoling/ADPT/data/dlc2adpt.py</ext-link>.</p>
<sec id="s4b1">
<title>Mouse dataset</title>
<p>The mouse dataset is a customized single animal dataset collected by ourselves. We recorded a C57BL/6 mouse freely behaving in an open field from four different view. The dataset contained 440 labeled image in 1288 × 964 resolution across 4 different backgrounds and 11 individuals, 16 single mouse videos with the same resolution across 4 different individuals and 4 backgrounds. Each video spans 15 minutes.</p>
</sec>
<sec id="s4b2">
<title>Monkey dataset</title>
<p>The monkey dataset is a customized single animal dataset collected by ourselves. We recorded a cynomolgus monkey freely behaving in behavioral cage. The dataset contained 3488 labeled image in 640 × 360 resolution across 8 different backgrounds and multiple individuals, and one specific 30 minutes video in which a monkey and people appeared simultaneously.</p>
</sec>
<sec id="s4b3">
<title>Single fly dataset</title>
<p>The single fly dataset is a benchmark dataset used in animal pose estimation <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>). It contained 1500 manual labeled frames which was split into 1,200 training, 150 validation and 150 test frames. The fly in the dataset was annotated with 32-node skeleton.</p>
</sec>
<sec id="s4b4">
<title>OpenMonkeyStudio Dataset</title>
<p>The OpenMonkeyStudio dataset is a macaque pose estimation dataset, containing 195,228 labeled frames with 13-node skeletons <bold><italic><xref ref-type="bibr" rid="c3">Bala et al. (2020</xref></italic></bold>). we randomly selected 5000 images and resized them to 368 × 368 resolution to evaluate the performance of our methods. We randomly divided this selected dataset into a 40% -60% training and validation split.</p>
</sec>
<sec id="s4b5">
<title>StanfordExtradataset</title>
<p>StanfordExtra StanfordExtradataset is a large-scale dog dataset with 2D keypoint and silhouette annotations, containing 12,000 images of dogs with 24-node skeletons <bold><italic><xref ref-type="bibr" rid="c4">Biggs et al. (2020</xref></italic></bold>). We randomly split the dataset into 85% training and 15% validation.</p>
</sec>
<sec id="s4b6">
<title>Mouse videos of different individuals</title>
<p>Videos in 1288 × 964 resolution across 4 different backgrounds and 10 individuals. Each video spans 15 minutes.</p>
</sec>
<sec id="s4b7">
<title>Free-social mice video</title>
<p>A 1 minute video in 1288 × 964 resolution of free-social mice.</p>
</sec>
</sec>
<sec id="s4c">
<title>Mix-up social animal dataset generation</title>
<statement id="alg1">
<label>Algorithm 1</label>
<p>Generation of Mix-up Social Animal Data</p>
<p><fig id="alg1a" position="float" fig-type="figure">
<graphic xlink:href="579164v1_alg1.tif" mimetype="image" mime-subtype="tiff"/>
</fig></p>
</statement>
<p>To address the challenge of acquiring labeled datasets for multi-animal pose estimation, we introduce a novel data augmentation strategy. This strategy involves mixing up a background picture and 2 labeled frames from single animal videos predicted by single animal model, generating synthetic data with multiple animals. The process is illustrated in <xref rid="fig6" ref-type="fig">Figure 6</xref>, and the algorithm is detailed in <xref ref-type="statement" rid="alg1">Algorithm 1</xref>. Initially, we employ the ADPT model to predict keypoint position for two images originating from different videos, resulting in two frame annotation sets of keypoints. Using these frames and the corresponding background image (<xref rid="fig6" ref-type="fig">Figure 6 A</xref>), we create a mix-up image, as shown in <xref rid="fig6" ref-type="fig">Figure 6B</xref>. We utilize two frame annotations to generate Mix-up annotation heatmaps. These heatmaps associate each keypoint with its corresponding location on the mix-up image, as shown in <xref rid="fig6" ref-type="fig">Figure 6 C</xref>. For the augmented image as shown in <xref rid="fig6" ref-type="fig">Figure 6 D</xref>, we generated augmented annotations as shown in <xref rid="fig6" ref-type="fig">Figure 6 E</xref>, and <xref rid="fig6" ref-type="fig">Figure 6 F</xref> represents augmented keypoints. Importantly, we leverage LRSS to distinguish between animals’ identities, as indicated in the <xref rid="fig6" ref-type="fig">Figure 6 G</xref>. Finally, we leverage body affinity fields (BAF) to match the body parts and identity, as indicated in the <xref rid="fig6" ref-type="fig">Figure 6 H</xref> in which we set back as the center point.</p>
<sec id="s4c1">
<title>Body affinity fields</title>
<p>Inspired by PAF, we create Body Affinity Fields for associating body part to instance identity. Considering all individuals in frame, the pixel <italic>p</italic> value at BAF map is defined as,
<disp-formula id="eqn2">
<graphic xlink:href="579164v1_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>p</italic><sub><italic>x</italic></sub> and <italic>p</italic><sub><italic>y</italic></sub> represents pixel <italic>p</italic>’s location (x and y coordination), and <italic>center</italic><sub><italic>x,y</italic></sub> represents the center location.</p>
<p>Combining BAF and LRSS, we can infer pixels identities. We only used this map in social animal tracking.</p>
</sec>
</sec>
<sec id="s4d">
<title>Experiments for ten mice identity tracking</title>
<p>In this experiment, we used videos featuring different identified mice, allocating 80% of the data for model training and the remaining 20% for accuracy validation. We configured the output channels of the model’s LRSS to be 11 (1 background channel + 10 identity channels). Finally, we determined the identity of mice in the image by analyzing the proportion of each category within the LRSS image. For data augmentation, random rotation (±30°), random pixel translation (x:[-100,100], y:[-30,15]) and random scale (0.9,1.1) were used in training ADPT.</p>
<p>Following metrics was used for identity determination:
<disp-formula id="eqn3">
<graphic xlink:href="579164v1_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>p</italic><sub><italic>identity</italic></sub> represents pixel <italic>p</italic> value at LRSS.</p>
</sec>
<sec id="s4e">
<title>Experiments for social mice tracking</title>
<p>In this experiment, we randomly selected two mice. We created a Mix-up Social Keypoint Dataset using individual videos of these mice and randomly captured background. We computed the BAF centered on the back of the mice. For the social interaction task, the LRSS channels of the model were set to 3 (1 background channel and 2 identity channels), while 2 channels were introduced for the newly incorporated BAF (representing a two-dimensional vector). Random pixel translation (x:[-100,100], y:[-30,15]) was the only augmentation method used in training ADPT.</p>
<p>We trained the model on this mix-up dataset and used it to predict real social interaction videos of mice spanning 1 minute. In practical application, we employed a bidirectional approach both bottom-up and top-down to ascertain mouse identities. Specifically, we utilized the BAF image to confirm the center position pointed by each pixel. Then, based on the identity information from LRSS corresponding to the center positions, we determined the identity information of each pixel (body pixels) to generate an identity map. Finally, by matching the location heatmap with the identity map, we calculated the posture information of the interacting animals.</p>
<p>Both manual verification and following metrics was used for evaluating identity exchange rate:
<disp-formula id="eqn4">
<graphic xlink:href="579164v1_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>y</italic><sub><italic>i</italic></sub> represents center location of each individual, and α represent drift distance threshold which was set as 75 pixels.</p>
<p>In our ten mice identity tracking and social mice tracking task, we trained the model for a total of 300 epochs with 10 warm-up epochs. We early stop the training procedure when it reaches a plateau for 30 epochs according to training loss. The batch size used during training was set to 8. Each epoch has 250 iterations for the first task and 50 iterations for the social task. To optimize the BAF maps, we utilized RMSE as the loss function.</p>
</sec>
<sec id="s4f">
<title>Evaluation metrics</title>
<p>To evaluate keypoint tracking drift, we use following metrics: for each keypoint,
<disp-formula id="eqn5">
<graphic xlink:href="579164v1_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>F</italic> represents the total number of frames, <italic>y</italic><sub><italic>i</italic></sub> represent a predicted keypoint position, α represent the drift distance threshold which was set as 50 pixels on mice, and 30 pixels on monkey, and <italic>δ</italic> is an indicator function that equals 1 when <inline-formula><inline-graphic xlink:href="579164v1_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and 0 otherwise.
<disp-formula id="eqn6">
<graphic xlink:href="579164v1_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>y</italic><sub><italic>i,conf idencescore</italic></sub> represents the confidence score of the predicted heatmap of i-th frames. We used the following metrics for single animal pose estimation: <email>PCK@0.15</email>, RMSE, mAP
<disp-formula id="eqn7">
<graphic xlink:href="579164v1_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>N</italic> represents the total number of keypoints, <italic>d</italic><sub><italic>i</italic></sub> is the Euclidean distance for the i-th keypoint, <italic>L</italic><sub><italic>i</italic></sub> is the normalized limb scale associated with the i-th keypoint.
<disp-formula id="eqn8">
<graphic xlink:href="579164v1_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where α is the bounding box area occupied by the GT instance, <italic>v</italic><sub><italic>i</italic></sub> is a visibility flag for the i-th keypoint, and <italic>s</italic> is the uncertainty factor(set to 0.025 for all measurements, the same as SLEAP)
<disp-formula id="eqn9">
<graphic xlink:href="579164v1_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where α represent the accuracy threshold.
<disp-formula id="eqn10">
<graphic xlink:href="579164v1_eqn10.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn11">
<graphic xlink:href="579164v1_eqn11.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>y</italic><sub><italic>i</italic></sub> represent a predicted keypoint position and <italic>y</italic><sub>true,<italic>i</italic></sub> is its’ ground truth.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>We acknowledge the effort from Wenhao Liu who recorded the mouse behavioral data and Professor Sen Yan’s laboratory who recorded the monkey behavioral data. This work was supported in part by National Natural Science Foundation of China (32222036 to PF. W), the Research Fund for International Senior Scientists (T2250710685 to PF. W), and Shenzhen Science and Technology Innovation Committee (2022410129 to Q. L). We thank ChatGPT for the English language editing of this paper.</p>
</ack>
<sec id="s6">
<title>Additional information</title>
<sec id="s6a">
<title>Author contributions</title>
<p>Guoling Tang, Conceptualization, Data acquisition, Code, Data analysis, Validation, Investigation, Visualization, Methodology, Writing - original draft, Writing - review and editing; Yaning Han, Conceptualization, Data acquisition, Validation, Investigation, Visualization, Methodology, Writing - review and editing; Quanying Liu, Conceptualization, Supervision, Funding acquisition, Validation, Investigation, Visualization, Writing - review and editing; Pengfei Wei, Conceptualization, Supervision, Funding acquisition, Data acquisition, Validation, Investigation, Methodology, Writing - review and editing.</p>
</sec>
<sec id="s6b">
<title>Funding</title>
<table-wrap id="tblu1" orientation="portrait" position="float">
<graphic xlink:href="579164v1_tblu1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s6c">
<title>Ethics</title>
<p>All experimental procedures of mice in this study were approved by Animal Care and Use Committees at the Shenzhen Institute of Advanced Technology, Chinese Academy of Sciences. And all experimental procedures of monkey adhered to the Guidelines for the Care and Use of Laboratory Animals established by Jinan University.</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Agezo</surname> <given-names>S</given-names></string-name>, <string-name><surname>Berman</surname> <given-names>GJ</given-names></string-name>. <article-title>Tracking together: estimating social poses</article-title>. <source>Nature Methods</source>. <year>2022</year>; <volume>19</volume>(<issue>4</issue>):<fpage>410</fpage>–<lpage>411</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Baker</surname> <given-names>S</given-names></string-name>, <string-name><surname>Tekriwal</surname> <given-names>A</given-names></string-name>, <string-name><surname>Felsen</surname> <given-names>G</given-names></string-name>, <string-name><surname>Christensen</surname> <given-names>E</given-names></string-name>, <string-name><surname>Hirt</surname> <given-names>L</given-names></string-name>, <string-name><surname>Ojemann</surname> <given-names>SG</given-names></string-name>, <string-name><surname>Kramer</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Kern</surname> <given-names>DS</given-names></string-name>, <string-name><surname>Thompson</surname> <given-names>JA</given-names></string-name>. <article-title>Automatic extraction of upper-limb kinematic activity using deep learning-based markerless tracking during deep brain stimulation implantation for Parkinson’s disease: a proof of concept study</article-title>. <source>Plos one</source>. <year>2022</year>; <volume>17</volume>(<issue>10</issue>):<fpage>e0275490</fpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Bala</surname> <given-names>PC</given-names></string-name>, <string-name><surname>Eisenreich</surname> <given-names>BR</given-names></string-name>, <string-name><surname>Yoo</surname> <given-names>SBM</given-names></string-name>, <string-name><surname>Hayden</surname> <given-names>BY</given-names></string-name>, <string-name><surname>Park</surname> <given-names>HS</given-names></string-name>, <string-name><surname>Zimmermann</surname> <given-names>J.</given-names></string-name> <article-title>Automated markerless pose estimation in freely moving macaques with OpenMonkeyStudio</article-title>. <source>Nature Communications</source>. <year>2020</year>; <volume>11</volume>. doi: <pub-id pub-id-type="doi">10.1038/s41467-020-18441-5</pub-id>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="book"><string-name><surname>Biggs</surname> <given-names>B</given-names></string-name>, <string-name><surname>Boyne</surname> <given-names>O</given-names></string-name>, <string-name><surname>Charles</surname> <given-names>J</given-names></string-name>, <string-name><surname>Fitzgibbon</surname> <given-names>A</given-names></string-name>, <string-name><surname>Cipolla</surname> <given-names>R.</given-names></string-name> <chapter-title>Who left the dogs out? 3d animal reconstruction with expectation maximization in the loop</chapter-title>. In: <source>Computer Vision–ECCV 2020: 16th European Conference, Glasgow, UK, August 23–28, 2020, Proceedings, Part XI 16</source> <publisher-name>Springer</publisher-name>; <year>2020</year>. p. <fpage>195</fpage>–<lpage>211</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Bohic</surname> <given-names>M</given-names></string-name>, <string-name><surname>Pattison</surname> <given-names>LA</given-names></string-name>, <string-name><surname>Jhumka</surname> <given-names>ZA</given-names></string-name>, <string-name><surname>Rossi</surname> <given-names>H</given-names></string-name>, <string-name><surname>Thackray</surname> <given-names>JK</given-names></string-name>, <string-name><surname>Ricci</surname> <given-names>M</given-names></string-name>, <string-name><surname>Mossazghi</surname> <given-names>N</given-names></string-name>, <string-name><surname>Foster</surname> <given-names>W</given-names></string-name>, <string-name><surname>Ogundare</surname> <given-names>S</given-names></string-name>, <string-name><surname>Twomey</surname> <given-names>CR</given-names></string-name>, <etal>et al.</etal> <article-title>Mapping the neuroethological signatures of pain, analgesia, and recovery in mice</article-title>. <source>Neuron</source>. <year>2023</year>; <volume>111</volume>(<issue>18</issue>):<fpage>2811</fpage>–<lpage>2830</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Cao</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Hidalgo</surname> <given-names>G</given-names></string-name>, <string-name><surname>Simon</surname> <given-names>T</given-names></string-name>, <string-name><surname>Wei</surname> <given-names>SE</given-names></string-name>, <string-name><surname>Sheikh</surname> <given-names>Y.</given-names></string-name> <article-title>OpenPose: Realtime Multi-Person 2D Pose Estimation Using Part Affinity Fields</article-title>. <source>IEEE Transactions on Pattern Analysis and Machine Intelligence</source>. <year>2021</year>; <volume>43</volume>. doi: <pub-id pub-id-type="doi">10.1109/TPAMI.2019.2929257</pub-id>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="other"><string-name><surname>Chen</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Peng</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Yu</surname> <given-names>G</given-names></string-name>, <string-name><surname>Sun</surname> <given-names>J.</given-names></string-name> <article-title>Cascaded pyramid network for multi-person pose estimation</article-title>. In: <source>Proceedings of the IEEE conference on computer vision and pattern recognition</source>; <year>2018</year>. p. <fpage>7103</fpage>–<lpage>7112</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="other"><string-name><surname>Chu</surname> <given-names>X</given-names></string-name>, <string-name><surname>Tian</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>B</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Wei</surname> <given-names>X</given-names></string-name>, <string-name><surname>Xia</surname> <given-names>H</given-names></string-name>, <string-name><surname>Shen</surname> <given-names>C.</given-names></string-name> <article-title>Conditional positional encodings for vision transformers</article-title>. <source>arXiv</source> preprint arXiv:<pub-id pub-id-type="arxiv">210210882</pub-id>. <year>2021</year>;.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="other"><string-name><surname>Gabriel</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Zeidler</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Jin</surname> <given-names>B</given-names></string-name>, <string-name><surname>Guo</surname> <given-names>C</given-names></string-name>, <string-name><surname>Goodpaster</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Kashay</surname> <given-names>AQ</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>A</given-names></string-name>, <string-name><surname>Delaney</surname> <given-names>M</given-names></string-name>, <string-name><surname>Cheung</surname> <given-names>J</given-names></string-name>, <string-name><surname>Difazio</surname> <given-names>LE</given-names></string-name>, <string-name><surname>Sharpe</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Aharoni</surname> <given-names>D</given-names></string-name>, <string-name><surname>Wilke</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Denardo</surname> <given-names>LA</given-names></string-name>. <article-title>Behavior DEPOT is a simple, flexible tool for automated behavioral detection based on marker less pose tracking</article-title>. <source>eLife</source>. <year>2022</year>; <volume>11</volume>. doi: <pub-id pub-id-type="doi">10.7554/eLife.74314</pub-id>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Graving</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Chae</surname> <given-names>D</given-names></string-name>, <string-name><surname>Naik</surname> <given-names>H</given-names></string-name>, <string-name><surname>Li</surname> <given-names>L</given-names></string-name>, <string-name><surname>Koger</surname> <given-names>B</given-names></string-name>, <string-name><surname>Costelloe</surname> <given-names>BR</given-names></string-name>, <string-name><surname>Couzin</surname> <given-names>ID</given-names></string-name>. <article-title>Deepposekit, a software toolkit for fast and robust animal pose estimation using deep learning</article-title>. <source>eLife</source>. <year>2019</year>; <volume>8</volume>. doi: <pub-id pub-id-type="doi">10.7554/eLife.47994</pub-id>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Gschwind</surname> <given-names>T</given-names></string-name>, <string-name><surname>Zeine</surname> <given-names>A</given-names></string-name>, <string-name><surname>Raikov</surname> <given-names>I</given-names></string-name>, <string-name><surname>Markowitz</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Gillis</surname> <given-names>WF</given-names></string-name>, <string-name><surname>Felong</surname> <given-names>S</given-names></string-name>, <string-name><surname>Isom</surname> <given-names>LL</given-names></string-name>, <string-name><surname>Datta</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Soltesz</surname> <given-names>I.</given-names></string-name> <article-title>Hidden behavioral fingerprints in epilepsy</article-title>. <source>Neuron</source>. <year>2023</year>; <volume>111</volume>(<issue>9</issue>):<fpage>1440</fpage>–<lpage>1452</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="other"><string-name><surname>Han</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>K</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>W</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Liao</surname> <given-names>J</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Han</surname> <given-names>C</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>K</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Cai</surname> <given-names>S</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Gao</surname> <given-names>G</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>N</given-names></string-name>, <string-name><surname>Li</surname> <given-names>J</given-names></string-name>, <string-name><surname>Song</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Li</surname> <given-names>J</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>G</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>L</given-names></string-name>, <etal>et al.</etal> <article-title>Social Behavior Atlas: A computational framework for tracking and mapping 3D close interactions of free-moving animals</article-title>. <source>bixRxiv</source>. <year>2023</year>; doi: <pub-id pub-id-type="doi">10.1101/2023.03.05.531235</pub-id>;.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="other"><string-name><surname>Han</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>K</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>K</given-names></string-name>, <string-name><surname>Pan</surname> <given-names>H</given-names></string-name>, <string-name><surname>Ju</surname> <given-names>F</given-names></string-name>, <string-name><surname>Long</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Gao</surname> <given-names>G</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>R</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>A</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>L</given-names></string-name>, <etal>et al.</etal> <article-title>MouseVenue3D: A markerless three-dimension behavioral tracking system for matching two-photon brain imaging in free-moving mice</article-title>. <source>Neuroscience Bulletin</source>. <year>2022</year>; p. <fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="other"><string-name><surname>Han</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Mo</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Jiang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Tian</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>L</given-names></string-name>, <string-name><surname>Wei Sr</surname> <given-names>P</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>Z</given-names></string-name>, <etal>et al.</etal> <article-title>MiceVAPORDot: A novel automated approach for high-throughput behavioral characterization during E-cigarette exposure in mice</article-title>. <source>bioRxiv</source>. <year>2023</year>; p. <fpage>2023</fpage>–<lpage>10</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>He</surname> <given-names>K</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Ren</surname> <given-names>S</given-names></string-name>, <string-name><surname>Sun</surname> <given-names>J.</given-names></string-name> <article-title>Deep residual learning for image recognition</article-title>. In: <source>Proceedings of the IEEE conference on computer vision and pattern recognition</source>; <year>2016</year>. p. <fpage>770</fpage>–<lpage>778</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Hsu</surname> <given-names>AI</given-names></string-name>, <string-name><surname>Yttri</surname> <given-names>EA</given-names></string-name>. <article-title>B-SOiD, an open-source unsupervised algorithm for identification and fast prediction of behaviors</article-title>. <source>Nature Communications</source>. <year>2021</year>; <volume>12</volume>. doi: <pub-id pub-id-type="doi">10.1038/s41467-021-25420-x</pub-id>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Huang</surname> <given-names>K</given-names></string-name>, <string-name><surname>Han</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>K</given-names></string-name>, <string-name><surname>Pan</surname> <given-names>H</given-names></string-name>, <string-name><surname>Zhao</surname> <given-names>G</given-names></string-name>, <string-name><surname>Yi</surname> <given-names>W</given-names></string-name>, <string-name><surname>Li</surname> <given-names>X</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>S</given-names></string-name>, <string-name><surname>Wei</surname> <given-names>P</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>L.</given-names></string-name> <article-title>A hierarchical 3D-motion learning framework for animal spontaneous behavior mapping</article-title>. <source>Nature Communications</source>. <year>2021</year>; <volume>12</volume>. doi: <pub-id pub-id-type="doi">10.1038/s41467-021-22970-y</pub-id>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Huang</surname> <given-names>K</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Han</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>L</given-names></string-name>, <string-name><surname>Wei</surname> <given-names>P.</given-names></string-name> <article-title>An Easily Compatible Eye-tracking System for Freely-moving Small Animals</article-title>. <source>Neuroscience Bulletin</source>. <year>2022</year>; <volume>38</volume>. doi: <pub-id pub-id-type="doi">10.1007/s12264-022-00834-9</pub-id>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="book"><string-name><surname>Insafutdinov</surname> <given-names>E</given-names></string-name>, <string-name><surname>Pishchulin</surname> <given-names>L</given-names></string-name>, <string-name><surname>Andres</surname> <given-names>B</given-names></string-name>, <string-name><surname>Andriluka</surname> <given-names>M</given-names></string-name>, <string-name><surname>Schiele</surname> <given-names>B.</given-names></string-name> <chapter-title>Deepercut: A deeper, stronger, and faster multi-person pose estimation model</chapter-title>. In: <source>Computer Vision–ECCV 2016: 14th European Conference, Amsterdam, The Netherlands, October 11-14, 2016, Proceedings, Part VI 14</source> <publisher-name>Springer</publisher-name>; <year>2016</year>. p. <fpage>34</fpage>–<lpage>50</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="other"><string-name><surname>Krakauer</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Ghazanfar</surname> <given-names>AA</given-names></string-name>, <string-name><surname>Gomez-Marin</surname> <given-names>A</given-names></string-name>, <string-name><surname>MacIver</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Poeppel</surname> <given-names>D.</given-names></string-name> <article-title>Neuroscience Needs Behavior: Correcting a Reductionist Bias</article-title>. <source>Neuron</source>. <year>2017</year>; <volume>93</volume>. doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2016.12.041</pub-id>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Lauer</surname> <given-names>J</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ye</surname> <given-names>S</given-names></string-name>, <string-name><surname>Menegas</surname> <given-names>W</given-names></string-name>, <string-name><surname>Schneider</surname> <given-names>S</given-names></string-name>, <string-name><surname>Nath</surname> <given-names>T</given-names></string-name>, <string-name><surname>Rahman</surname> <given-names>MM</given-names></string-name>, <string-name><surname>Di Santo</surname> <given-names>V</given-names></string-name>, <string-name><surname>Soberanes</surname> <given-names>D</given-names></string-name>, <string-name><surname>Feng</surname> <given-names>G</given-names></string-name>, <etal>et al.</etal> <article-title>Multi-animal pose estimation, identification and tracking with DeepLabCut</article-title>. <source>Nature Methods</source>. <year>2022</year>; <volume>19</volume>(<issue>4</issue>):<fpage>496</fpage>–<lpage>504</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>LeCun</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Bengio</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Hinton</surname> <given-names>G.</given-names></string-name> <article-title>Deep learning</article-title>. <source>nature</source>. <year>2015</year>; <volume>521</volume>(<issue>7553</issue>):<fpage>436</fpage>–<lpage>444</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="other"><string-name><surname>Li</surname> <given-names>C</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>GH</given-names></string-name>. <article-title>From synthetic to real: Unsupervised domain adaptation for animal pose estimation</article-title>. In: <source>Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</source>; <year>2021</year>. p. <fpage>1482</fpage>–<lpage>1491</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="other"><string-name><surname>Li</surname> <given-names>K</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>S</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>W</given-names></string-name>, <string-name><surname>Tu</surname> <given-names>Z.</given-names></string-name> <article-title>Pose recognition with cascade transformers</article-title>. In: <source>Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</source>; <year>2021</year>. p. <fpage>1944</fpage>–<lpage>1953</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="other"><string-name><surname>Li</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Anumanchipalli</surname> <given-names>GK</given-names></string-name>, <string-name><surname>Mohamed</surname> <given-names>A</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Carney</surname> <given-names>LH</given-names></string-name>, <string-name><surname>Lu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chang</surname> <given-names>EF</given-names></string-name>. <article-title>Dissecting neural computations in the human auditory pathway using deep neural networks for speech</article-title>. <source>Nature Neuroscience</source>. <year>2023</year>; p. <fpage>1</fpage>–<lpage>13</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Liang</surname> <given-names>F</given-names></string-name>, <string-name><surname>Yu</surname> <given-names>S</given-names></string-name>, <string-name><surname>Pang</surname> <given-names>S</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Jie</surname> <given-names>J</given-names></string-name>, <string-name><surname>Gao</surname> <given-names>F</given-names></string-name>, <string-name><surname>Song</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Li</surname> <given-names>B</given-names></string-name>, <string-name><surname>Liao</surname> <given-names>WH</given-names></string-name>, <string-name><surname>Yin</surname> <given-names>M.</given-names></string-name> <article-title>Non-human primate models and systems for gait and neurophysiological analysis</article-title>. <source>Frontiers in Neuroscience</source>. <year>2023</year>; <volume>17</volume>:<fpage>1141567</fpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Liu</surname> <given-names>N</given-names></string-name>, <string-name><surname>Han</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Ding</surname> <given-names>H</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>K</given-names></string-name>, <string-name><surname>Wei</surname> <given-names>P</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>L.</given-names></string-name> <article-title>Objective and comprehensive re-evaluation of anxiety-like behaviors in mice using the Behavior Atlas</article-title>. <source>Biochemical and Biophysical Research Communications</source>. <year>2021</year>; <volume>559</volume>:<fpage>1</fpage>–<lpage>7</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Lonini</surname> <given-names>L</given-names></string-name>, <string-name><surname>Moon</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Embry</surname> <given-names>K</given-names></string-name>, <string-name><surname>Cotton</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>McKenzie</surname> <given-names>K</given-names></string-name>, <string-name><surname>Jenz</surname> <given-names>S</given-names></string-name>, <string-name><surname>Jayaraman</surname> <given-names>A.</given-names></string-name> <article-title>Video-Based Pose Estimation for Gait Analysis in Stroke Survivors during Clinical Assessments: A Proof-of-Concept Study</article-title>. <source>Digital Biomarkers</source>. <year>2022</year>; <volume>6</volume>. doi: <pub-id pub-id-type="doi">10.1159/000520732</pub-id>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Luxem</surname> <given-names>K</given-names></string-name>, <string-name><surname>Mocellin</surname> <given-names>P</given-names></string-name>, <string-name><surname>Fuhrmann</surname> <given-names>F</given-names></string-name>, <string-name><surname>Kürsch</surname> <given-names>J</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Palop</surname> <given-names>JJ</given-names></string-name>, <string-name><surname>Remy</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bauer</surname> <given-names>P.</given-names></string-name> <article-title>Identifying behavioral structure from deep variational embeddings of animal motion</article-title>. <source>Communications Biology</source>. <year>2022</year>; <volume>5</volume>. doi: <pub-id pub-id-type="doi">10.1038/s42003-022-04080-7</pub-id>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="other"><string-name><surname>Mao</surname> <given-names>W</given-names></string-name>, <string-name><surname>Ge</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Shen</surname> <given-names>C</given-names></string-name>, <string-name><surname>Tian</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Z.</given-names></string-name> <article-title>Tfpose: Direct human pose estimation with transformers</article-title>. <source>arXiv</source> preprint arXiv:<pub-id pub-id-type="arxiv">210315320</pub-id>. <year>2021</year>;.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Marks</surname> <given-names>M</given-names></string-name>, <string-name><surname>Jin</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Sturman</surname> <given-names>O</given-names></string-name>, <string-name><surname>von Ziegler</surname> <given-names>L</given-names></string-name>, <string-name><surname>Kollmorgen</surname> <given-names>S</given-names></string-name>, <string-name><surname>von der Behrens</surname> <given-names>W</given-names></string-name>, <string-name><surname>Mante</surname> <given-names>V</given-names></string-name>, <string-name><surname>Bohacek</surname> <given-names>J</given-names></string-name>, <string-name><surname>Yanik</surname> <given-names>MF</given-names></string-name>. <article-title>Deep-learning-based identification, tracking, pose estimation and behaviour classification of interacting primates and mice in complex environments</article-title>. <source>Nature Machine Intelligence</source>. <year>2022</year>; <volume>4</volume>. doi: <pub-id pub-id-type="doi">10.1038/s42256-022-00477-5</pub-id>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Mathis</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mamidanna</surname> <given-names>P</given-names></string-name>, <string-name><surname>Cury</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Abe</surname> <given-names>T</given-names></string-name>, <string-name><surname>Murthy</surname> <given-names>VN</given-names></string-name>, <string-name><surname>Mathis</surname> <given-names>MW</given-names></string-name>, <string-name><surname>Bethge</surname> <given-names>M.</given-names></string-name> <article-title>DeepLabCut: markerless pose estimation of user-defined body parts with deep learning</article-title>. <source>Nature Neuroscience</source>. <year>2018</year>; <volume>21</volume>. doi: <pub-id pub-id-type="doi">10.1038/s41593-018-0209-y</pub-id>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Metzger</surname> <given-names>SL</given-names></string-name>, <string-name><surname>Littlejohn</surname> <given-names>KT</given-names></string-name>, <string-name><surname>Silva</surname> <given-names>AB</given-names></string-name>, <string-name><surname>Moses</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Seaton</surname> <given-names>MP</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>R</given-names></string-name>, <string-name><surname>Dougherty</surname> <given-names>ME</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>P</given-names></string-name>, <string-name><surname>Berger</surname> <given-names>MA</given-names></string-name>, <etal>et al.</etal> <article-title>A high-performance neuroprosthesis for speech decoding and avatar control</article-title>. <source>Nature</source>. <year>2023</year>; <volume>620</volume>(<issue>7976</issue>):<fpage>1037</fpage>– <lpage>1046</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Monsees</surname> <given-names>A</given-names></string-name>, <string-name><surname>Voit</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Wallace</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Sawinski</surname> <given-names>J</given-names></string-name>, <string-name><surname>Charyasz</surname> <given-names>E</given-names></string-name>, <string-name><surname>Scheffler</surname> <given-names>K</given-names></string-name>, <string-name><surname>Macke</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Kerr</surname> <given-names>JND</given-names></string-name>. <article-title>Estimation of skeletal kinematics in freely moving rodents</article-title>. <source>Nature Methods</source>. <year>2022</year>; <volume>19</volume>. doi: <pub-id pub-id-type="doi">10.1038/s41592-022-01634-9</pub-id>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="book"><string-name><surname>Newell</surname> <given-names>A</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>K</given-names></string-name>, <string-name><surname>Deng</surname> <given-names>J.</given-names></string-name> <chapter-title>Stacked hourglass networks for human pose estimation</chapter-title>. In: <source>Computer Vision–ECCV 2016: 14th European Conference, Amsterdam, The Netherlands, October 11-14, 2016, Proceedings, Part VIII 14</source> <publisher-name>Springer</publisher-name>; <year>2016</year>. p. <fpage>483</fpage>–<lpage>499</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Pereira</surname> <given-names>TD</given-names></string-name>, <string-name><surname>Aldarondo</surname> <given-names>DE</given-names></string-name>, <string-name><surname>Willmore</surname> <given-names>L</given-names></string-name>, <string-name><surname>Kislin</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>SSH</given-names></string-name>, <string-name><surname>Murthy</surname> <given-names>M</given-names></string-name>, <string-name><surname>Shaevitz</surname> <given-names>JW</given-names></string-name>. <article-title>Fast animal pose estimation using deep neural networks</article-title>. <source>Nature Methods</source>. <year>2019</year>; <volume>16</volume>. doi: <pub-id pub-id-type="doi">10.1038/s41592-018-0234-5</pub-id>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Pereira</surname> <given-names>TD</given-names></string-name>, <string-name><surname>Shaevitz</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Murthy</surname> <given-names>M.</given-names></string-name> <article-title>Quantifying behavior to understand the brain</article-title>. <source>Nature Neuroscience</source>. <year>2020</year>; <volume>23</volume>. doi: <pub-id pub-id-type="doi">10.1038/s41593-020-00734-z</pub-id>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Pereira</surname> <given-names>TD</given-names></string-name>, <string-name><surname>Tabris</surname> <given-names>N</given-names></string-name>, <string-name><surname>Matsliah</surname> <given-names>A</given-names></string-name>, <string-name><surname>Turner</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Li</surname> <given-names>J</given-names></string-name>, <string-name><surname>Ravindranath</surname> <given-names>S</given-names></string-name>, <string-name><surname>Papadoyannis</surname> <given-names>ES</given-names></string-name>, <string-name><surname>Normand</surname> <given-names>E</given-names></string-name>, <string-name><surname>Deutsch</surname> <given-names>DS</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>ZY</given-names></string-name>, <string-name><surname>McKenzie-Smith</surname> <given-names>GC</given-names></string-name>, <string-name><surname>Mitelut</surname> <given-names>CC</given-names></string-name>, <string-name><surname>Castro</surname> <given-names>MD</given-names></string-name>, <string-name><surname>D’Uva</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kislin</surname> <given-names>M</given-names></string-name>, <string-name><surname>Sanes</surname> <given-names>DH</given-names></string-name>, <string-name><surname>Kocher</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>SSH</given-names></string-name>, <string-name><surname>Falkner</surname> <given-names>AL</given-names></string-name>, <string-name><surname>Shaevitz</surname> <given-names>JW</given-names></string-name>, <etal>et al.</etal> <article-title>SLEAP: A deep learning system for multi-animal pose tracking</article-title>. <source>Nature Methods</source>. <year>2022</year>; <volume>19</volume>. doi: <pub-id pub-id-type="doi">10.1038/s41592-022-01426-1</pub-id>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Robinson</surname> <given-names>GE</given-names></string-name>, <string-name><surname>Fernald</surname> <given-names>RD</given-names></string-name>, <string-name><surname>Clayton</surname> <given-names>DF</given-names></string-name>. <article-title>Genes and social behavior</article-title>. <source>Science</source>. <year>2008</year>; <volume>322</volume>. doi: <pub-id pub-id-type="doi">10.1126/science.1159277</pub-id>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="book"><string-name><surname>Ronneberger</surname> <given-names>O</given-names></string-name>, <string-name><surname>Fischer</surname> <given-names>P</given-names></string-name>, <string-name><surname>Brox</surname> <given-names>T.</given-names></string-name> <chapter-title>U-net: Convolutional networks for biomedical image segmentation</chapter-title>. In: <source>Medical Image Computing and Computer-Assisted Intervention–MICCAI 2015: 18th International Conference, Munich, Germany, October 5-9, 2015, Proceedings, Part III 18</source> <publisher-name>pringer</publisher-name>; <year>2015</year>. p. <fpage>234</fpage>–<lpage>241</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Russakovsky</surname> <given-names>O</given-names></string-name>, <string-name><surname>Deng</surname> <given-names>J</given-names></string-name>, <string-name><surname>Su</surname> <given-names>H</given-names></string-name>, <string-name><surname>Krause</surname> <given-names>J</given-names></string-name>, <string-name><surname>Satheesh</surname> <given-names>S</given-names></string-name>, <string-name><surname>Ma</surname> <given-names>S</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Karpathy</surname> <given-names>A</given-names></string-name>, <string-name><surname>Khosla</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bernstein</surname> <given-names>M</given-names></string-name>, <string-name><surname>Berg</surname> <given-names>AC</given-names></string-name>, <string-name><surname>Fei-Fei</surname> <given-names>L.</given-names></string-name> <article-title>ImageNet Large Scale Visual Recognition Challenge</article-title>. <source>International Journal of Computer Vision</source>. <year>2015</year>; <volume>115</volume>. doi: <pub-id pub-id-type="doi">10.1007/s11263-015-0816-y</pub-id>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Sandler</surname> <given-names>M</given-names></string-name>, <string-name><surname>Howard</surname> <given-names>A</given-names></string-name>, <string-name><surname>Zhu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Zhmoginov</surname> <given-names>A</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>LC</given-names></string-name>. <article-title>Mobilenetv2: Inverted residuals and linear bottlenecks</article-title>. In: <source>Proceedings of the IEEE conference on computer vision and pattern recognition</source>; <year>2018</year>. p. <fpage>4510</fpage>–<lpage>4520</lpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Schneider</surname> <given-names>S</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Mathis</surname> <given-names>MW</given-names></string-name>. <article-title>Learnable latent embeddings for joint behavioural and neural analysis</article-title>. <source>Nature</source>. <year>2023</year>; p. <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Sheppard</surname> <given-names>K</given-names></string-name>, <string-name><surname>Gardin</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sabnis</surname> <given-names>GS</given-names></string-name>, <string-name><surname>Peer</surname> <given-names>A</given-names></string-name>, <string-name><surname>Darrell</surname> <given-names>M</given-names></string-name>, <string-name><surname>Deats</surname> <given-names>S</given-names></string-name>, <string-name><surname>Geuther</surname> <given-names>B</given-names></string-name>, <string-name><surname>Lutz</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Kumar</surname> <given-names>V.</given-names></string-name> <article-title>Stride-level analysis of mouse open field behavior using deep-learning-based pose estimation</article-title>. <source>Cell reports</source>. <year>2022</year>; <volume>38</volume>(<issue>2</issue>).</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Stenum</surname> <given-names>J</given-names></string-name>, <string-name><surname>Rossi</surname> <given-names>C</given-names></string-name>, <string-name><surname>Roemmich</surname> <given-names>RT</given-names></string-name>. <article-title>Two-dimensional video-based analysis of human gait using pose estimation</article-title>. <source>PLoS Computational Biology</source>. <year>2021</year>; <volume>17</volume>. doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008935</pub-id>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Stoffl</surname> <given-names>L</given-names></string-name>, <string-name><surname>Vidal</surname> <given-names>M</given-names></string-name>, <string-name><surname>Mathis</surname> <given-names>A.</given-names></string-name> <article-title>End-to-end trainable multi-instance pose estimation with transformers</article-title>. <source>arXiv</source> preprint arXiv:<pub-id pub-id-type="arxiv">210312115</pub-id>. <year>2021</year>;.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Sun</surname> <given-names>K</given-names></string-name>, <string-name><surname>Xiao</surname> <given-names>B</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>D</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>J.</given-names></string-name> <article-title>Deep high-resolution representation learning for human pose estimation</article-title>. In: <source>Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</source>; <year>2019</year>. p. <fpage>5693</fpage>–<lpage>5703</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="other"><string-name><surname>Takagi</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Nishimoto</surname> <given-names>S.</given-names></string-name> <article-title>High-resolution image reconstruction with latent diffusion models from human brain activity</article-title>. In: <source>Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</source>; <year>2023</year>. p. <fpage>14453</fpage>–<lpage>14463</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="other"><string-name><surname>Thota</surname> <given-names>AK</given-names></string-name>, <string-name><surname>Alberts</surname> <given-names>JL</given-names></string-name>. <article-title>Novel use of retro-reflective paint to capture 3d kinematic gait data in non-human primates</article-title>. In: <source>2013 29th Southern Biomedical Engineering Conference IEEE</source>; <year>2013</year>. p. <fpage>113</fpage>–<lpage>114</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Toshev</surname> <given-names>A</given-names></string-name>, <string-name><surname>Szegedy</surname> <given-names>C.</given-names></string-name> <article-title>Deeppose: Human pose estimation via deep neural networks</article-title>. In: <source>Proceedings of the IEEE conference on computer vision and pattern recognition</source>; <year>2014</year>. p. <fpage>1653</fpage>–<lpage>1660</lpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Urai</surname> <given-names>AE</given-names></string-name>, <string-name><surname>Doiron</surname> <given-names>B</given-names></string-name>, <string-name><surname>Leifer</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Churchland</surname> <given-names>AK</given-names></string-name>. <article-title>Large-scale neural recordings call for new insights to link brain and behavior</article-title>. <source>Nature neuroscience</source>. <year>2022</year>; <volume>25</volume>(<issue>1</issue>):<fpage>11</fpage>–<lpage>19</lpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Vaswani</surname> <given-names>A</given-names></string-name>, <string-name><surname>Shazeer</surname> <given-names>N</given-names></string-name>, <string-name><surname>Parmar</surname> <given-names>N</given-names></string-name>, <string-name><surname>Uszkoreit</surname> <given-names>J</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>L</given-names></string-name>, <string-name><surname>Gomez</surname> <given-names>AN</given-names></string-name>, <string-name><surname>Kaiser</surname> <given-names>Ł</given-names></string-name>, <string-name><surname>Polosukhin</surname> <given-names>I.</given-names></string-name> <article-title>Attention is all you need</article-title>. <source>Advances in neural information processing systems</source>. <year>2017</year>; <volume>30</volume>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><surname>Vidal</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wolf</surname> <given-names>N</given-names></string-name>, <string-name><surname>Rosenberg</surname> <given-names>B</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>BP</given-names></string-name>, <string-name><surname>Mathis</surname> <given-names>A.</given-names></string-name> <article-title>Perspectives on individual animal identification from biology and computer vision</article-title>. <source>Integrative and comparative biology</source>. <year>2021</year>; <volume>61</volume>(<issue>3</issue>):<fpage>900</fpage>–<lpage>916</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="other"><string-name><surname>Wei</surname> <given-names>SE</given-names></string-name>, <string-name><surname>Ramakrishna</surname> <given-names>V</given-names></string-name>, <string-name><surname>Kanade</surname> <given-names>T</given-names></string-name>, <string-name><surname>Sheikh</surname> <given-names>Y.</given-names></string-name> <article-title>Convolutional pose machines</article-title>. In: <source>Proceedings of the IEEE conference on Computer Vision and Pattern Recognition</source>; <year>2016</year>. p. <fpage>4724</fpage>–<lpage>4732</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="other"><string-name><surname>Weinreb</surname> <given-names>C</given-names></string-name>, <string-name><surname>Abdal</surname> <given-names>M</given-names></string-name>, <string-name><surname>Osman</surname> <given-names>M</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>L</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>S</given-names></string-name>, <string-name><surname>Pearl</surname> <given-names>J</given-names></string-name>, <string-name><surname>Annapragada</surname> <given-names>S</given-names></string-name>, <string-name><surname>Conlin</surname> <given-names>E</given-names></string-name>, <string-name><surname>Gillis</surname> <given-names>WF</given-names></string-name>, <string-name><surname>Jay</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ye</surname> <given-names>S</given-names></string-name>, <string-name><surname>Mathis</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mathis</surname> <given-names>MW</given-names></string-name>, <string-name><surname>Pereira</surname> <given-names>T</given-names></string-name>, <string-name><surname>Linderman</surname> <given-names>SW</given-names></string-name>, <string-name><surname>Datta</surname> <given-names>SR</given-names></string-name>. <article-title>Keypoint-MoSeq: parsing behavior by linking point tracking to pose dynamics</article-title>. <source>bioRxiv</source>. <year>2023</year>;.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Wiltschko</surname> <given-names>AB</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Iurilli</surname> <given-names>G</given-names></string-name>, <string-name><surname>Peterson</surname> <given-names>RE</given-names></string-name>, <string-name><surname>Katon</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Pashkovski</surname> <given-names>SL</given-names></string-name>, <string-name><surname>Abraira</surname> <given-names>VE</given-names></string-name>, <string-name><surname>Adams</surname> <given-names>RP</given-names></string-name>, <string-name><surname>Datta</surname> <given-names>SR</given-names></string-name>. <article-title>Mapping sub-second structure in mouse behavior</article-title>. <source>Neuron</source>. <year>2015</year>; <volume>88</volume>(<issue>6</issue>):<fpage>1121</fpage>–<lpage>1135</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Wiltschko</surname> <given-names>AB</given-names></string-name>, <string-name><surname>Tsukahara</surname> <given-names>T</given-names></string-name>, <string-name><surname>Zeine</surname> <given-names>A</given-names></string-name>, <string-name><surname>Anyoha</surname> <given-names>R</given-names></string-name>, <string-name><surname>Gillis</surname> <given-names>WF</given-names></string-name>, <string-name><surname>Markowitz</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Peterson</surname> <given-names>RE</given-names></string-name>, <string-name><surname>Katon</surname> <given-names>J</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Datta</surname> <given-names>SR</given-names></string-name>. <article-title>Revealing the structure of pharmacobehavioral space through motion sequencing</article-title>. <source>Nature neuroscience</source>. <year>2020</year>; <volume>23</volume>(<issue>11</issue>):<fpage>1433</fpage>–<lpage>1443</lpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="other"><string-name><surname>Xu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Pan</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Pan</surname> <given-names>X</given-names></string-name>, <string-name><surname>Hoi</surname> <given-names>S</given-names></string-name>, <string-name><surname>Yi</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>Z.</given-names></string-name> <article-title>RegNet: self-regulated network for image classification</article-title>. <source>IEEE Transactions on Neural Networks and Learning Systems</source>. <year>2022</year>;.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><surname>Xu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Tao</surname> <given-names>D.</given-names></string-name> <article-title>Vitpose: Simple vision transformer baselines for human pose estimation</article-title>. <source>Advances in Neural Information Processing Systems</source>. <year>2022</year>; <volume>35</volume>:<fpage>38571</fpage>–<lpage>38584</lpage>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="other"><string-name><surname>Yang</surname> <given-names>S</given-names></string-name>, <string-name><surname>Quan</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Nie</surname> <given-names>M</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>W.</given-names></string-name> <article-title>Transpose: Keypoint localization via transformer</article-title>. In: <source>Proceedings of the IEEE/CVF International Conference on Computer Vision</source>; <year>2021</year>. p. <fpage>11802</fpage>–<lpage>11812</lpage>.</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<title>Appendix 1</title>
<sec id="s5">
<title>deep learning pose estimation</title>
<p>Pose estimation is a well-established computer vision task that has achieved significant advancements in human pose estimation. Traditional CNN-based algorithms for human pose estimation<bold><italic><xref ref-type="bibr" rid="c35">Newell et al. (2016</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c6">Cao et al. (2021</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c50">Toshev and Szegedy (2014</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c7">Chen et al. (2018</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c54">Wei et al. (2016</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c19">Insafutdinov et al. (2016</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c47">Sun et al. (2019</xref></italic></bold>) have been widely applied and have shown promising results. With the recent rise of transformer-based models, researchers have explored the use of transformers for human pose estimation<bold><italic><xref ref-type="bibr" rid="c60">Yang et al. (2021</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c24">Li et al. (2021</xref></italic></bold>); <bold><italic><xref rid="c58" ref-type="bibr">Xu et al. (2022b</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c30">Mao et al. (2021</xref></italic></bold>), leading to improved accuracy and performance. At the same time, some of these works<bold><italic><xref ref-type="bibr" rid="c35">Newell et al. (2016</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c54">Wei et al. (2016</xref></italic></bold>); <bold><italic><xref ref-type="bibr" rid="c19">Insafutdinov et al. (2016</xref></italic></bold>); <bold><italic><xref rid="c58" ref-type="bibr">Xu et al. (2022b</xref></italic></bold>)has also been extended to the field of animal pose estimation. Notably, keypoint detection methods typically employ two main approaches: heatmap-based and regression-based methods. Heatmap-based methods generate keypoint heatmaps, calculate the index of the maximum confidence score within these heatmaps, and obtain keypoint coordinates. Heatmap-based methods have the advantage of providing confidence scores, allowing researchers to gauge the reliability of each keypoint’s estimate. However, they can be computationally intensive due to the generation of multiple heatmaps. Conversely, regression-based methods directly output keypoint coordinates from the model. Regression-based methods are often computationally efficient and can provide accurate results. However, they may lack the ability to express the confidence or uncertainty associated with each keypoint prediction, which heatmap-based methods can provide. The choice between these methods depends on the specific requirements of the pose estimation task.</p>
<p>In the domain of behavioral studies, specific estimation methods have been developed and widely used. Notable examples include DeepLabCut <bold><italic><xref ref-type="bibr" rid="c32">Mathis et al. (2018</xref></italic></bold>), SLEAP <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>), and DeepPoseKit <bold><italic><xref ref-type="bibr" rid="c10">Graving et al. (2019</xref></italic></bold>). These methods have found extensive application in experimental animal pose estimation, where the estimated poses are used for quantifying and analyzing animal behavior. They are heatmap-based methods. DeepLabCut is a popular toolbox utilized for animal pose estimation, employing CNNs such as ResNets <bold><italic><xref ref-type="bibr" rid="c15">He et al. (2016</xref></italic></bold>) or MobileNets <bold><italic><xref ref-type="bibr" rid="c42">Sandler et al. (2018</xref></italic></bold>) that initial pretrained on ImageNet <bold><italic><xref ref-type="bibr" rid="c41">Russakovsky et al. (2015</xref></italic></bold>) to accurately estimate animal poses. It has been widely adopted in various experimental settings, enabling researchers to track and analyze animal behavior with high precision. Similarly, SLEAP is another widely used tool for multi-animal pose estimation, leveraging U-NET <bold><italic><xref ref-type="bibr" rid="c40">Ronneberger et al. (2015</xref></italic></bold>) liked CNN architectures to estimate poses and facilitate behavior analysis in animals. Additionally, DeepPoseKit is another notable software toolkit using Stacked DenseNet for behavioral animal pose estimation. The results of pose estimation serve as a critical component in quantifying and analyzing animal behavior. By accurately estimating animal poses, researchers can extract valuable insights into the kinematics <bold><italic><xref ref-type="bibr" rid="c34">Monsees et al. (2022</xref></italic></bold>), dynamics <bold><italic><xref ref-type="bibr" rid="c29">Luxem et al. (2022</xref></italic></bold>), and patterns of animal movements <bold><italic><xref ref-type="bibr" rid="c17">Huang et al. (2021</xref></italic></bold>). This information further contributes to a better understanding of animal behavior, cognition, and underlying neural mechanisms.</p>
<p>According to literature report <bold><italic><xref ref-type="bibr" rid="c38">Pereira et al. (2022</xref></italic></bold>), SLEAP and DeepLabCut have similar accuracy on a benchmark single-fly datasets <bold><italic><xref ref-type="bibr" rid="c36">Pereira et al. (2019</xref></italic></bold>), with mean average precision scores(mAP) of 92.7% and 92.8%, respectively. Their accuracies are significantly higher than that of DeepPoseKit(86.4%). Additionally, SLEAP demonstrates the highest inference speed among the three tools. Therefore, currently, SLEAP and DeepLabCut are considered to have the best performance in freely behaving animal pose estimation. However, these methods are still limited by their robustness, which refers to the presence of uncertainty or noise interference in the estimated positions of keypoints due to the inherent limitations of the algorithms or noise in the image. For instance, the limited receptive fields of convolutional kernels may hinder their ability to capture the global dependencies within an image. This constraint can be particularly relevant in tasks that require modeling complex spatial relationships or long-range interactions. ADPT primarily aims to compare and improve upon these two methods.</p>
<p>In summary, various pose estimation methods, including DeepLabCut, SLEAP, and DeepPoseKit, have been developed and extensively employed in the field of experimental animal pose estimation. These methods leverage CNN-based models to estimate animal poses, enabling researchers to conduct detailed behavior quantification and analysis.</p>
</sec>
</app>
</app-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95709.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Takahashi</surname>
<given-names>Daniel Y</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Federal University of Rio Grande do Norte</institution>
</institution-wrap>
<city>Natal</city>
<country>Brazil</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Useful</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study introduces a <bold>useful</bold> deep learning-based algorithm that tracks animal postures with reduced drift by incorporating transformers for more robust keypoint detection. The efficacy of this new algorithm for single-animal pose estimation was demonstrated through comparisons with two popular algorithms. However, the analysis is <bold>incomplete</bold> and would benefit from comparisons with other state-of-the-art methods and consideration of multi-animal tracking.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95709.1.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this paper, the authors introduce a new deep learning-based algorithm for tracking animal poses, especially in minimizing drift effects. The algorithm's performance was validated by comparing it with two other popular algorithms, DeepLabCut and LEAP.</p>
<p>Strengths:</p>
<p>The authors showcased the effectiveness of their new algorithm in a systematic manner, covering individual levels of mice, drosophilas, macaques, and multi-animal poses.</p>
<p>Weaknesses:</p>
<p>(1) The accessibility of this tool for biological research is not clearly addressed, despite its potential usefulness. Researchers in biology often have limited expertise in deep learning training, deployment, and prediction. A detailed, step-by-step user guide is crucial, especially for applications in biological studies.</p>
<p>(2) The proposed algorithm focuses on tracking and is compared with DLC and LEAP, which are more adept at detection rather than tracking.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95709.1.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors present a new model for animal pose estimation. The core feature they highlight is the model's stability compared to existing models in terms of keypoint drift. The authors test this model across a range of new and existing datasets. The authors also test the model with two mice in the same arena. For the single animal datasets the authors show a decrease in sudden jumps in keypoint detection and the number of undetected keypoints compared with DeepLabCut and SLEAP. Overall average accuracy, as measured by root mean squared error, generally shows similar but sometimes superior performance to DeepLabCut and better performance compared to SLEAP. The authors confusingly don't quantify the performance of pose estimation in the multi (two) animal case instead focusing on detecting individual identity. This multi-animal model is not compared with the model performance of the multi-animal mode of DeepLabCut or SLEAP.</p>
<p>Strengths:</p>
<p>The major strength of the paper is successfully demonstrating a model that is less likely to have incorrect large keypoint jumps compared to existing methods. As noted in the paper, this should lead to easier-to-interpret descriptions of pose and behavior to use in the context of a range of biological experimental workflows.</p>
<p>Weaknesses:</p>
<p>There are two main types of weaknesses in this paper. The first is a tendency to make unsubstantiated claims that suggest either model performance that is untested or misrepresents the presented data, or suggest excessively large gaps in current SOTA capabilities. One obvious example is in the abstract when the authors state ADPT &quot;significantly outperforms the existing deep-learning methods, such as DeepLabCut, SLEAP, and DeepPoseKit.&quot; All tests in the rest of the paper, however, only discuss performance with DeepLabCut and SLEAP, not DeepPoseKit. At this point, there are many animal pose estimation models so it's fine they didn't compare against DeepPoseKit, but they shouldn't act like they did. Similar odd presentation of results are statements like &quot;Our method exhibited an impressive prediction speed of 90{plus minus}4 frames per second (fps), faster than DeepLabCut (44{plus minus}2 fps) and equivalent to SLEAP (106{plus minus}4 fps).&quot; Why is 90{plus minus}4 fps considered &quot;equivalent to SLEAP (106{plus minus}4 fps)&quot; and not slower? I agree they are similar but they are not the same. The paper's point of view of what is &quot;equivalent&quot; changes when describing how &quot;On the single-fly dataset, ADPT excelled with an average mAP of 92.83%, surpassing both DeepLabCut and SLEAP (Figure 5B)&quot; When one looks at Figure 5B, however, ADPT and DeepLabCut look identical. Beyond this, oddly only ADPT has uncertainty bars (no mention of what uncertainty is being quantified) and in fact, the bars overlap with the values corresponding to SLEAP and DeepPoseKit. In terms of making claims that seem to stretch the gaps in the current state of the field, the paper makes some seemingly odd and uncited statements like &quot;Concerns about the safety of deep learning have largely limited the application of deep learning-based tools in behavioral analysis and slowed down the development of ethology&quot; and &quot;So far, deep learning pose estimation has not achieved the reliability of classical kinematic gait analysis&quot; without specifying which classical gait analysis is being referred to. Certainly, existing tools like DeepLabCut and SLEAP are already widely cited and used for research.</p>
<p>The other main weakness in the paper is the validation of the multi-animal pose estimation. The core point of the paper is pose estimation and anti-drift performance and yet there is no validation of either of these things relating to multi-animal video. All that is quantified is the ability to track individual identity with a relatively limited dataset of 10 mice IDs with only two in the same arena (and see note about train and validation splits below). While individual tracking is an important task, that literature is not engaged with (i.e. papers like Walter and Couzin, eLife, 2021: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.7554/eLife.64000">https://doi.org/10.7554/eLife.64000</ext-link>) and the results in this paper aren't novel compared to that field's state of the art. On the other hand, while multi-animal pose estimation is also an important problem the paper doesn't engage with those results either. The two methods already used for comparison in the paper, SLEAP and DeepPoseKit, already have multi-animal modes and multi-animal annotated datasets but none of that is tested or engaged with in the paper. The paper notes many existing approaches are two-step methods, but, for practitioners, the difference is not enough to warrant a lack of comparison. The authors state that &quot;The evaluation of our social tracking capability was performed by visualizing the predicted video data (see supplement Videos 3 and 4).&quot; While the authors report success maintaining mouse ID, when one actually watches the key points in the video of the two mice (only a single minute was used for validation) the pose estimation is relatively poor with tails rarely being detected and many pose issues when the mice get close to each other.</p>
<p>Finally, particularly in the methods section, there were a number of places where what was actually done wasn't clear. For example in describing the network architecture, the authors say &quot;Subsequently, network separately process these features in three branches, compute features at scale of one-fourth, one-eight and one-sixteenth, and generate one-eight scale features using convolution layer or deconvolution layer.&quot; Does only the one-eight branch have deconvolution or do the other branches also? Similarly, for the speed test, the authors say &quot;Here we evaluate the inference speed of ADPT. We compared it with DeepLabCut and SLEAP on mouse videos at 1288 x 964 resolution&quot;, but in the methods section they say &quot;The image inputs of ADPT were resized to a size that can be trained on the computer. For mouse images, it was reduced to half of the original size.&quot; Were different image sizes used for training and validation? Or Did ADPT not use 1288 x 964 resolution images as input which would obviously have major implications for the speed comparison? Similarly, for the individual ID experiments, the authors say &quot;In this experiment, we used videos featuring different identified mice, allocating 80% of the data for model training and the remaining 20% for accuracy validation.&quot; Were frames from each video randomly assigned to the training or validation sets? Frames from the same video are very correlated (two frames could be just 1/30th of a second different from each other), and so if training and validation frames are interspersed with each other validation performance doesn't indicate much about performance on more realistic use cases (i.e. using models trained during the first part of an experiment to maintain ids throughout the rest of it.)</p>
</body>
</sub-article>
</article>