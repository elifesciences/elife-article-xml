<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">108198</article-id>
<article-id pub-id-type="doi">10.7554/eLife.108198</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.108198.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories><title-group>
<article-title>Subtle methodological variations substantially impact correlation test results in ecological time series</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8478-8207</contrib-id>
<name>
<surname>Cannistra</surname>
<given-names>Caroline</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hoang</surname>
<given-names>Linh</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Yuan</surname>
<given-names>Alex E</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Shou</surname>
<given-names>Wenying</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<email>w.shou@ucl.ac.uk</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04gyf1771</institution-id><institution>University of California, Irvine</institution></institution-wrap>, <city>Irvine</city>, <country country="US">United States</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>Department of Genetics, Evolution and Environment, University College London</institution></institution-wrap>, <city>London</city>, <country country="GB">United Kingdom</country></aff>
<aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jx3x895</institution-id><institution>Centre for Life‚Äôs Origins and Evolution, University College London</institution></institution-wrap>, <city>London</city>, <country country="GB">United Kingdom</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Bitbol</surname>
<given-names>Anne-Florence</given-names>
</name>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1020-494X</contrib-id><role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution>
</institution-wrap>
<city>Lausanne</city>
<country country="CH">Switzerland</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Walczak</surname>
<given-names>Aleksandra M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>CNRS</institution>
</institution-wrap>
<city>Paris</city>
<country country="FR">France</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-10-21">
<day>21</day>
<month>10</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP108198</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2025-07-20">
<day>20</day>
<month>07</month>
<year>2025</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-10-15">
<day>15</day>
<month>10</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.10.11.617506"/>
</event>
</pub-history>
<permissions>
<copyright-statement>¬© 2025, Cannistra et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Cannistra et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-108198-v1.pdf"/>
<abstract>
<p>Correlation analyses using ecological time series can indicate phenomena such as interspecific interactions or an environmental factor that affects several populations. However, methodological choices in these analyses can significantly impact the results, potentially leading to spurious correlations or missed true associations. In this study, we explore how different decisions affect the performance of statistical tests for correlations between pairs of time series in simulated two-species ecosystems. We show that when performing nonparametric ‚Äúsurrogate data‚Äù tests, both the choice of statistic and the method of generating the null distribution can affect true positive and false positive rates. We also show how seemingly closely related methods of accounting for lagged correlation produce vastly different false positive rates. For methods that establish a null model by simulating the dynamics of one of the two species, we show that the choice of species simulated can influence test behavior. Additionally, we identify scenarios where the outcomes of analyses can be highly sensitive to the initial conditions of an ecosystem, even under simple mathematical models. Our results indicate the importance of thoughtful consideration and documentation of the statistical choices investigated here. To make this work broadly accessible, we include visual explanations of most methods tested in an appendix.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>

</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Research in ecology and environmental science frequently relies on the analysis of time series to discover interactions or shared influences among variables. However, this approach is subject to the well-known issue of spurious correlation. That is, a pair of time series might lack interactions or shared influences, but nevertheless appear to have a visually or numerically impressive correlation, such as the sizes of two populations that happen to both be growing during the data collection period [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c4">4</xref>]. To avoid drawing misinformed conclusions from such spurious correlations, statistical tests designed to handle time series are essential.</p>
<p>A statistical test of correlation between a pair of time series typically involves three elements. First, one must select a null hypothesis, often that the two variables are independent (Box 1). Independence is a meaningful null hypothesis because disproving it indicates that one of the variables influences the other, or that they share a common causal influence [<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c6">6</xref>]. Second, one needs a correlation statistic (<italic>œÅ</italic>) to measure a possible effect. Often a symmetric statistic is used in which <italic>œÅ</italic>(<italic>x, y</italic>) = <italic>œÅ</italic>(<italic>y, x</italic>) such as Pearson‚Äôs correlation coefficient [<xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>], but some studies use an asymmetric statistic to suggest a directed relationship [<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c12">12</xref>]. Third, determining the null distribution - how the correlation statistic behaves under the null hypothesis - is crucial (<xref rid="fig1" ref-type="fig">Fig 1</xref>). For certain correlation statistics, there may be an analytical expression for the null distribution (e.g. [<xref ref-type="bibr" rid="c7">7</xref>]). Alternatively, the null distribution may be estimated using surrogate data. To test for independence via this approach, one selects one of the variables to simulate ‚Äì for instance <italic>y</italic> - and generates simulated copies of <italic>y</italic>, known as <italic>y</italic>* surrogates, without using information from <italic>x</italic>. Then, the null distribution is estimated as the histogram of correlations between <italic>x</italic> and the various <italic>y</italic>* surrogates [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c14">14</xref>].</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Choices of statistic and surrogate data method both affect test performance in two-species competition systems.</title>
<p>(A, D): Models of competition. Two microbial species inhibit each other‚Äôs growth either directly (A) or indirectly through reduction of a shared resource <italic>R</italic> which is continuously added to the system (D). Populations are also subject to random fluctuations such as from stochastic immigration, modeled as noise terms (<italic>Œµ</italic><sub><italic>x,t</italic></sub> and <italic>Œµ</italic><sub><italic>y,t</italic></sub> in <xref ref-type="disp-formula" rid="eqn1">Eq. 1</xref>) drawn from a uniform distribution between 0 and 0.025 at regular intervals of step size Œî<italic>t</italic> = 0.05. The ‚Äúmeasured‚Äù time series (B, E) to which dependence tests are applied have a lower sampling rate of once every five Œî<italic>t</italic> steps. (B, E): Negative correlation between population densities of competing species. (C, F): False positive and true positive rates when analyzing time series data using different combinations of statistic (rows) and surrogate data method or analytical test (columns). We show Granger causality and cross map skill in only one direction because the system is symmetrical and therefore results are the same in both directions. Solid shade, hatched shade, and white-out respectively represent ideal (<italic>‚â§</italic> 6.2%), questionable (between 6.2% and 10%), and unacceptable (<italic>‚â•</italic> 10) false positive rates. The number inside the box represents the percentage of true positives rounded to the nearest whole number, with a grey color used for tests with unacceptable false positive rates.</p></caption>
<graphic xlink:href="617506v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Given this grand buffet of methodological choices, it is no surprise that efforts to detect interspecies associations via time series analysis vary substantially between projects in their analysis pipelines. These differences, particularly when compounded with differences in experimental settings, can potentially contribute to inter-laboratory variation in results, even if multiple groups are studying the same system [<xref ref-type="bibr" rid="c15">15</xref>]. A better understanding of how these ‚Äúdevils in the details‚Äù impact results will empower researchers to better understand barriers to reproducibility and develop best practices for the field.</p>
<p>Here we explore this issue using a collection of two-species simulated ecosystems, with a focus on microbial communities. We report on four factors - other than the interaction network itself - that can impact the results of a correlation analysis. First, we show that both the correlation statistic and the method of generating the null distribution influence the true and false positive rates of tests. Second, we consider the issue of detecting correlations with a coupling lag, and we show that the true and false positive rates can vary widely depending on how a coupling lag is incorporated into the analysis. Third, for asymmetric correlation statistics, we show how initial conditions of an ecological system can influence the results of an association analysis in potentially surprising ways. Finally, in the context of surrogate data tests, we show that analysis results can vary substantially depending on which variable is chosen to be simulated.</p>
<boxed-text>
<label>Box 1</label>
<sec>
<title>Key Terminology</title>
<sec>
<title>Dependence</title>
<p>Two events <italic>A</italic> and <italic>B</italic> are called independent if the probability that they co-occur is the same as the product of the probabilities that each occurs individually, i.e. <italic>P</italic>(<italic>A</italic> and <italic>B</italic>) = <italic>P</italic>(<italic>A</italic>)<italic>P</italic>(<italic>B</italic>). Likewise, two temporal processes <italic>x</italic> and <italic>y</italic> are called independent if the probability that <italic>x</italic> has some trajectory <italic>x</italic>‚Ä≤ and <italic>y</italic> has some trajectory <italic>y</italic>‚Ä≤ is the same as the product of the individual probabilities of these respective trajectories, i.e. <italic>P</italic>(<italic>x</italic> = <italic>x</italic>‚Ä≤ and <italic>y</italic> = <italic>y</italic>‚Ä≤) = <italic>P</italic>(<italic>x</italic> = <italic>x</italic>‚Ä≤)<italic>P</italic>(<italic>y</italic> = <italic>y</italic>‚Ä≤). Conversely, if there is some <italic>x</italic>‚Ä≤ and <italic>y</italic>‚Ä≤ such that this equation does not hold, then the processes are dependent. Dependence between two variables does not necessarily imply that one variable causes the other; two variables may be dependent if they share a common influence.</p>
</sec>
<sec>
<title>Independent and identically distributed</title>
<p>Random variables are ‚Äúindependent and identically distributed‚Äù (i.i.d.) if the possible state of each random variable is independent of the possible state of every other random variable, and if each random variable follows the same probability distribution. Data within a time series are usually not independent of each other because the past can influence the future.</p>
</sec>
<sec>
<title>Surrogate data</title>
<p>Artificial data generated from the observed data to simulate a null hypothesis. Surrogate data come with modeling assumptions, and violating the assumptions can lead to an invalid test (<xref rid="tbl2" ref-type="table">Table 2</xref>).</p>
</sec>
<sec>
<title>Stationarity</title>
<p>A stationary time series is one whose statistical properties do not change systematically over time. Formally, we call a time series (<italic>x</italic><sub>1</sub>, ‚Ä¶, <italic>x</italic><sub><italic>n</italic></sub>) ‚Äústationary‚Äù if for any length <italic>l &lt; n</italic>, the length-<italic>l</italic> subsequence (<italic>x</italic><sub><italic>i</italic></sub>, <italic>x</italic><sub><italic>i</italic>+1</sub>, ‚Ä¶, <italic>x</italic><sub><italic>i</italic>+<italic>l</italic>‚àí1</sub>) is time-invariant, meaning that its statistical properties do not depend on <italic>i</italic>.</p>
</sec>
</sec>
</boxed-text>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Choice of both statistic and surrogate data method can affect test performance</title>
<p>We assembled a collection of tests for correlation and evaluated their true and false positive rates in simulated ecosystems consisting of two interacting species, whose population density values will be denoted by <italic>x</italic> and <italic>y</italic> respectively. To calculate true positive rates, we presented tests with data from the same simulation. To calculate false positive rates, we presented each test with the <italic>x</italic> time series from one simulation and the <italic>y</italic> time series from an identical but independent simulation of the same ecosystem. This is analogous to growing two replicate test tubes of the same microbial ecosystem and testing for a correlation between the <italic>x</italic> species of one tube and the <italic>y</italic> of another tube. In all cases, true and false positive rates were calculated as the percentage of detections (<italic>p ‚â§</italic> 0.05) reported out of 1000 total pairs of <italic>x</italic> and <italic>y</italic> time series.</p>
<p>We used 6 different methods for generating surrogate time series (<xref rid="tbl2" ref-type="table">Table 2</xref>) together with 5 different correlation statistics (<xref rid="tbl1" ref-type="table">Table 1</xref>), resulting in 6 √ó 5 = 30 combinatorially unique surrogate data testing procedures. See Appendix for a detailed introduction to each statistic and procedure. For three of the statistics we also included a parametric test (<xref rid="fig1" ref-type="fig">Fig 1C,F</xref>). All testing procedures are designed to test the null hypothesis that the two time series are independent, except for the parametric Granger causality test, which tests the null hypothesis of ‚ÄúGranger non-causality‚Äù (i.e. that the past of <italic>x</italic> does not contain unique information about the future of <italic>y</italic> [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c17">17</xref>]). However, this exception does not matter for our purposes since all of our independent cases are also Granger non-causal, and all of our dependent cases are constructed to be Granger-causal in both directions.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><title>Statistics for measuring correlation between time series.</title></caption>
<graphic xlink:href="617506v1_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>We first assessed how well these tests perform when given time series of population densities from a pair of species engaged in competition. We used stochastic simulations based on two underlying models: a Lotka-Volterra model [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c20">20</xref>] where each species‚Äô growth equation includes an interaction term that directly encodes the negative impact of its competitor (<xref rid="fig1" ref-type="fig">Fig 1A</xref>), and a resource-mediated interaction model [<xref ref-type="bibr" rid="c21">21</xref>] where species compete via their shared need of a finite resource (1D).</p>
<p>False positive rates of surrogate data tests are sensitive to both the null model and the correlation statistic (<xref rid="fig1" ref-type="fig">Fig. 1C, F</xref>). Notably, the random shuffle and block bootstrap null models produce unacceptable false positive rates with most correlation statistics (except Granger causality). The poor performance of these null models is unsurprising since both scramble data in time, destroying the original autocorrelation to varying degrees. True positive rates are also sensitive to both the surrogate procedure and the correlation statistic.</p>
<p>We asked whether the ranking of correlation statistics by statistical power depends on the null model, and vice versa. In both the Lotka-Volterra and chemical interaction settings, the ranking of null models is identical across statistics with only one exception that was not statistically significant (<italic>p &gt;</italic> 0.1, two-tailed z-test of proportions). In contrast the ranking of statistics can depend on the null model. For example, in the chemical interaction setting, mutual information has higher power than local similarity with circular and truncated time shift, but the reverse is true when twin or random phase surrogates are used. We recovered the same result (with <italic>p &lt;</italic> 0.005) when repeating each of these 4 comparisons with a separate random number seed (to avoid the need to statistically account for <inline-formula><inline-graphic xlink:href="617506v1_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula> possible pairwise comparisons). Thus, to maximize power, a researcher may need to select their correlation statistic based on the null model they are using.</p>
</sec>
<sec id="s2b">
<title>Different methods of accounting for lagged correlation affect test performance</title>
<p>Often the effects of interactions only become apparent after a delay, leading to a pair of time series whose correlation is detectable only when one time series is shifted relative to the other by an appropriate lag. In this case, a method is required to choose a lag for both the original and surrogate time series. One way is to choose the lag that gives the highest correlation between the two original time series, and then use the same lag when constructing the null distribution with surrogate time series. We call this the ‚Äúfixed lag‚Äù approach. We suspected that under the fixed lag approach, tests are likely to produce high false positive rates because the original time series enjoys an optimized lag, but the surrogates do not, resulting in an unfair null model (<xref rid="fig2" ref-type="fig">Fig. 2Bii-iii</xref>, condition <italic>b</italic>). Alternatively, one can optimize the lag for the original correlation and then independently optimize the lag for surrogate correlations (‚Äútailored lags‚Äù). Since the tailored lag approach applies the same pre-processing steps to both the original and surrogate data, it seems more likely to produce valid tests (<xref rid="fig2" ref-type="fig">Fig. 2Bii-iii</xref>, condition <italic>a</italic>).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Different strategies of choosing a lag in the correlation function lead to substantially different test performance.</title>
<p>(<bold>A</bold>) Lagged correlation may be required to reveal dependence with a delayed response. Here the <italic>x</italic> variable (Ai) influences the <italic>y</italic> variable (Aii) with a lag of 2. Aii depicts the original <italic>y</italic> series (black circles), the series shifted by <italic>l</italic> = ‚àí2 (light grey diamonds), and shifted by <italic>l</italic> = 2 (dark grey squares). The Pearson correlation between <italic>x</italic><sub><italic>i</italic></sub> and <italic>y</italic><sub><italic>i</italic>‚àí<italic>l</italic></sub> is calculated at different time lags <italic>l</italic> (Aiii), peaking at lag <italic>l</italic> = ‚àí2 (light grey diamond). (<bold>B</bold>) Three strategies for choosing correlation lags. Bi illustrates time series from a Lotka-Volterra predator-prey system in which predator dynamics lag behind prey dynamics, with the top panel showing a predator (<italic>y</italic>; blue) and prey (<italic>x</italic>; red) from the same simulation and the bottom panel showing a predator (<italic>y</italic>) and prey (<italic>X</italic>; brown) from different simulations. Both panels share identical <italic>y</italic> series and random phase surrogates (<italic>y</italic>*; grey). Bii depicts correlations between <italic>x</italic> and the original <italic>y</italic> calculated at different lags <italic>l</italic> (black curve), or between <italic>x</italic> and five representative surrogates <italic>y</italic>* (grey curves). Shown are three ways to choose original and surrogate lagged correlations. With no lag (<italic>a</italic>, bold dots on green line), all correlations are calculated at lag <italic>l</italic> = 0. With a ‚Äúfixed lag‚Äù (<italic>b</italic>, bold dots on gold line), all chosen correlations are calculated at the lag that maximises that of the original series. With ‚Äútailored lags‚Äù (<italic>c</italic>, black and cyan open circles), for each pair of time series, either original (black) or surrogates (cyan), the lag with the highest correlation is used. Biii shows the original and surrogate correlations under each lag method isolated on a line to clarify their ranking. An asterisk (*) indicates detection of a significant correlation with <italic>p</italic> = 1/6 (in practice, at least 19 surrogates are needed to achieve <italic>p</italic> = 0.05). A check mark indicates a correct inference (rejecting the null hypothesis when <italic>x</italic> and <italic>y</italic> are truly dependent, or failing to reject when <italic>x</italic> and <italic>y</italic> are truly independent);, incorrect inference is represented by a slashed circle. In this simplified example, the ‚Äúno lag‚Äù approach always fails to detect a correlation, the ‚Äúfixed lag‚Äù approach always detects a correlation, and the ‚Äútailored lag‚Äù approach produces correct results. (<bold>C</bold>) A simulation benchmark of the three strategies. Lags, when used, were chosen from between ‚àí10 and 10 in steps of size 2. Analytical tests were included in the ‚Äúno lag‚Äù condition. We also tried applying analytical tests at each lag, reporting the lowest <italic>p</italic>-value and then performing a Bonferroni correction; this procedure‚Äôs results are shown next to the ‚Äútailored lags‚Äù table (<italic>Ana</italic>.* column). Interpretation of figure (C) is similar to 1. See Methods for simulation details.</p></caption>
<graphic xlink:href="617506v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We verify these expectations by applying the different lag strategies to detect dependence between the density of a predator and its prey in a predator-prey Lotka-Volterra simulation. When the two species are in the same system, predator dynamics lag behind prey dynamics. When no lags are used in the analysis (<xref rid="fig2" ref-type="fig">Fig 2C</xref>), tests mostly either produce unacceptable false positive rates, or very low true positive rates. The exceptions are tests using Granger causality and cross map skill‚Äìthe two correlation methods among those we tested that necessarily incorporate lags into the calculation of the statistic. The fixed lag approach produced mostly unacceptable false positive rates, as expected. Finally, the tailored lag approach tended to result in broadly superior performance, with false positive rates similar to the no-lag condition, but with true positive rates generally exceeding those of the no-lag condition.</p>
</sec>
<sec id="s2c">
<title>Tests based on Granger causality and cross map skill are sensitive to system state</title>
<p>Microbial ecosystems often feature multiple steady states. That is, due to chance events, similar microbial communities can settle into distinct states characterized by unique species compositions. Here we show that, perhaps counterintuitively, the results of Granger causality or cross map skill analyses can be highly sensitive to the system‚Äôs state.</p>
<p>To illustrate, consider a two-species competitive microbial community that is symmetric in the sense that the equations describing their dynamics follow precisely the same form, with identical parameters for growth, self-inhibition, and cross-inhibition. This system has two stable states characterized by the dominance of one or the other species. We choose an initial condition in which the <italic>x</italic> species is more abundant than <italic>y</italic>. Consequently, <italic>y</italic> remains at high density with some minor fluctuations, while the <italic>x</italic> density remains near zero (<xref rid="fig3" ref-type="fig">Fig. 3A</xref>, top half). Since Granger causality and cross map skill are both directional statistics, we can think of applying these statistics in the <italic>x ‚Üí y</italic> and <italic>y ‚Üí x</italic> directions as applying them to the same system in different states.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><title>In multi-stable microbial communities, tests based on Granger causality and cross map skill can depend on community state.</title>
<p>(<bold>A</bold>, top): A two-species competitive microbial community in which the two species (<italic>x</italic> and <italic>y</italic>) have identical parameters for growth, self-inhibition, and cross-inhibition. There are two steady states (dominance of one or the other species). The system is initialized in the state where <italic>x</italic> dominates. Both populations experience random fluctuations, so the suppressed species is not permanently extinct. (A, bottom): Similar to the top panel of (A), except here, if a species‚Äô population density drops below 0.4, its intrinsic growth rate is increased by 0.2. (<bold>B</bold>): Surrogate data tests of dependence using Granger causality or cross map skill applied in either the <italic>x ‚Üí y</italic> direction (corresponding roughly to the alternative hypothesis that <italic>x</italic> drives the dynamics of <italic>y</italic>), or in the <italic>y ‚Üí x</italic> direction. Analytical Granger causality tests are also shown. The top and bottom tables correspond to the top and bottom panels shown in (A), respectively. (<bold>C</bold>): A vector field plot corresponding to the differential equations shown in the top half of (A), indicating that at the stable community state, changes in <italic>y</italic> lead to large changes in <italic>dx</italic>/<italic>dt</italic> (written as <inline-formula><inline-graphic mime-subtype="gif" mimetype="image" xlink:href="617506v1_inline2.gif"/></inline-formula> to conserve space), whereas the reverse does not hold. See Methods for simulation details.</p></caption>
<graphic xlink:href="617506v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Since the interaction parameters are equal, we might expect that tests using directional statistics would detect dependence regardless of the statistic‚Äôs direction. However, the tests that use Granger causality in the <italic>y ‚Üí x</italic> direction enjoy statistical power close to 100%, whereas the same tests in the reverse direction have power below 20% (<xref rid="fig3" ref-type="fig">Fig. 3B</xref>, top half). This effect occurs in both the analytical Granger causality test (a genuine test of prediction improvement, i.e. ‚ÄúGranger causality‚Äù) and the surrogate data-based tests (which are technically tests of independence). One possible explanation for this asymmetry becomes apparent upon inspecting the vector field plot for the deterministic version of the system. Specifically, changes in the density of the suppressed species (<italic>y</italic>) have a relatively large effect on the dynamics of the dominant species (<italic>x</italic>), whereas the reverse does not hold (<xref rid="fig3" ref-type="fig">Fig 3C</xref>). Cross map skill is less sensitive to changes in the direction (<xref rid="fig3" ref-type="fig">Fig. 3B</xref>, top half;<italic>x ‚Üí y</italic> versus <italic>y ‚Üí x</italic>).</p>
<p>To determine whether this effect is entirely due to one species being at near-zero abundance, we also examine a system of two competing microbial species that coexist at different densities. Here, both species have a faster birth rate when their density falls below a threshold, so the lower-density species tends to stay near this threshold and away from zero (<xref rid="fig3" ref-type="fig">Fig. 3A-B</xref>, bottom half). Once again, the Granger causality test in the <italic>y ‚Üí x</italic> direction achieves greater power, although the difference is less dramatic in this case. Moreover, in this setting, cross map skill can also exhibit modest sensitivity to the direction, achieving greater power in the <italic>x ‚Üí y</italic> direction than <italic>y ‚Üí x</italic> with circular time shift surrogates (96% versus 89%; <italic>p &lt;</italic> 10<sup>‚àí8</sup>) and truncated time shift surrogates (50% versus 37%; <italic>p &lt;</italic> 10<sup>‚àí8</sup>).</p>
</sec>
<sec id="s2d">
<title>Choice of surrogate template affects test performance</title>
<p>Surrogate data testing is most commonly implemented by replacing just one of the time series with surrogates, not both. This has the theoretical advantage that only one time series must satisfy the assumptions of the surrogates in order for the test to be valid. Yet, the decision of which time series to use as the surrogate template often appears arbitrary and a rationale is rarely given in practice.</p>
<p>Here we show that test performance can depend on which variable is used as the surrogate data template. We use as our ground-truth a two-species competition model similar to that of <xref rid="fig3" ref-type="fig">Fig 3A</xref> (but with a shorter sampling period; see <xref rid="tbl3" ref-type="table">Table 3</xref>) where <italic>x</italic> tends to dominate <italic>y</italic> due to a greater initial density. We assessed the performance of tests when either <italic>x</italic> or <italic>y</italic> was used as the surrogate data template (<xref rid="fig4" ref-type="fig">Fig 4C</xref>, ‚ÄúsurrX‚Äù and ‚ÄúsurrY‚Äù respectively).</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><title>Surrogate data generation methods.</title>
<p>Graphical explanations can be found in the appendix. <sup><italic>a</italic></sup>A test is exactly valid under its modeling assumption if the following criterion is strictly satisfied: The false positive rate - the chance of erroneously reporting dependence - will be no more than the significance level <italic>Œ±</italic> if we infer dependence only when the <italic>p</italic> value is equal to or less than <italic>Œ±</italic>.</p></caption>
<graphic xlink:href="617506v1_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3:</label>
<caption><title>Simulation parameters for each figure.</title>
<p>Unif(<italic>a, b</italic>) and ùí©(<italic>Œº, œÉ</italic><sup>2</sup>) denote a uniform distribution between <italic>a</italic> and <italic>b</italic> and a normal distribution with mean of <italic>Œº</italic> and standard deviation of <italic>œÉ</italic> respectively. The integration step size Œî<italic>t</italic> is 0.05 for all systems.</p></caption>
<graphic xlink:href="617506v1_tbl3.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><title>The behavior of surrogate tests differs between using surrogates <italic>x</italic>* and surrogates <italic>y</italic>*.</title>
<p>(A) System equations used for simulation. (B) Example time series. Simulations begin with <italic>x</italic> at a greater population size than <italic>y</italic>, introducing an asymmetry wherein <italic>x</italic> is the dominant competitor. (C) Test performance. Each test is performed using either surrogates of <italic>y</italic> (surrY) or surrogates of <italic>x</italic> (surrX). Lags such as in <xref ref-type="fig" rid="fig2">Fig 2</xref> were not used in these correlation tests. See Methods for simulation details.</p></caption>
<graphic xlink:href="617506v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The effect of surrogate template choice was particularly striking when twin surrogates were used with cross-map skill, a directed statistic commonly associated with a method that attempts to infer the direction of causality (<xref rid="tbl1" ref-type="table">Table 1</xref>). Producing surrogates from the presumed causee variable (<xref rid="fig4" ref-type="fig">Fig 4C</xref>, <italic>y ‚Üí x</italic> with surrX or <italic>x ‚Üí y</italic> with surrY) led to false positive rates above 20%. Conversely, when the presumed causer variable was used as the template (e.g. <italic>y ‚Üí x</italic> with surrY), tests based on cross map skill and twin surrogates produced more modest false positive rates below 8%.</p>
<p>It is also possible for non-directional statistics to exhibit sensitivity to the choice of surrogate template. The twin surrogate test with mutual information as the statistic enjoyed greater statistical power when surrogate were generated from <italic>y</italic> than <italic>x</italic> (93% versus 85%, <italic>p &lt;</italic> 10<sup>‚àí7</sup>).</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>The numerical experiments presented here indicate that within a surrogate data test for correlation, there exist numerous consequential choices. Test performance is sensitive to both the correlation statistic and the null model, and the two elements interact in such a way that the preference of one statistic over another may depend on which null model is used (<xref rid="fig1" ref-type="fig">Fig 1F</xref>). Test results can depend on whether and how lags are included in the correlation analysis, with a naive method (<xref rid="fig2" ref-type="fig">Fig 2</xref>, ‚Äúfixed lag‚Äù) producing unacceptably high false positive rates. Changing which variable is used as the surrogate template can impact test performance (<xref rid="fig4" ref-type="fig">Fig 4C</xref>). This effect was particularly striking in the case of a test using cross map skill as the statistic and twin surrogates as the null model, where using the presumed causing variable as the surrogate template produced a false positive rate under 8%, while producing surrogates from the presumed causee led to a false positive rate above 20%. Note that both the presumed causer and causee have been used as the surrogate template when testing the significance of cross map skill [<xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c25">25</xref>].</p>
<p>Choices such as these represent opportunities for research results to reflect a scientist‚Äôs preferred statistical recipe, perhaps as much as they reflect the data. What is to be done? We offer two suggestions. First, when a choice presents itself (e.g. among correlation statistics, null models, or the choice of surrogate template), we recommend that researchers consider performing their analysis on at least two variations to assess whether and how the analysis conclusions are affected. Second, we advocate for greater transparency in testing methodology. For instance, introducing lags into correlation tests is commonplace, but it is not always clear whether studies are using the correct ‚Äútailored lags‚Äù approach or the naive ‚Äúfixed lag‚Äù method. Similarly, It is routine to use surrogate data procedures to test the significance of a correlation, but it is often unclear which time series is used as the surrogate template.</p>
<p>Beyond the effects of decisions within statistical procedures, we illustrated that for microbial communities with multiple stable states, the community state can profoundly impact the results of an analysis (<xref rid="fig4" ref-type="fig">Fig 4</xref>). Thus, the correlation networks that often result from analyses of time series may themselves be best conceptualized as time-dependent. Overall the various sources of uncertainty documented here underscore the importance of transparent analysis, as well as the need for humility when drawing scientific conclusions.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Benchmarking statistical tests</title>
<p>We determined the true and false positive rates of various correlation tests by applying them to data from simulated ecosystems of two interacting species <italic>x</italic> and <italic>y</italic>. To calculate true positive rates, tests were presented with data from the same simulation. To calculate false positive rates, we presented each test with the <italic>x</italic> time series from one simulation and the <italic>y</italic> time series from an identical but independent simulation of the same ecosystem. True and false positive rates were calculated as the percentage of detections (<italic>p ‚â§</italic> 0.05) obtained by tests out of 1000 total pairs of <italic>x</italic> and <italic>y</italic> time series.</p>
<p>Based on their false positive rates, tests were considered either ‚Äúideal‚Äù (false positive rate <italic>‚â§</italic> 6.2%), ‚Äúquestionable‚Äù (6.2% to 10%) or ‚Äúunacceptable‚Äù (<italic>‚â•</italic> 10%), as shown in, e.g., <xref rid="fig1" ref-type="fig">Fig 1C</xref> and <xref ref-type="fig" rid="fig1">1F</xref>. We set 6.2% rather than 5% as the threshold for an ideal test to account for random fluctuations. More precisely, for a perfectly calibrated test with a true false positive rate of 5%, the number of false positives in 1000 trials follows a binomial distribution centered around 50. By setting our cutoff at 62 (i.e. 6.2% of 1000), we ensure that the probability of observing more than false positives than the cutoff is less than or equal to 5%.</p>
<p>For surrogate data tests, we first computed the correlation between the original <italic>x</italic> and <italic>y</italic>, and then compared this to a null distribution made from correlations between <italic>x</italic> and various <italic>y</italic>* surrogates. In <xref rid="fig4" ref-type="fig">Fig 4</xref>, we also performed the reverse test, where the null distribution was made from correlations between <italic>y</italic> and <italic>x</italic>* surrogates. For all surrogate methods except truncated time shift, the <italic>p</italic>-value was calculated as (1 + <italic>n</italic><sub><italic>larger</italic></sub>)/(1 + <italic>n</italic><sub><italic>surr</italic></sub>) where <italic>n</italic><sub><italic>larger</italic></sub> is the number of surrogate correlations that are as large as or larger than the original correlation, and <italic>n</italic><sub><italic>surr</italic></sub> is the total number of surrogate correlations. For surrogates produced by the random shuffle, stationary bootstrap, random phase, and twin methods, we used <italic>n</italic><sub><italic>surr</italic></sub> = 99 surrogates. For the circular time shift method, we used all possible surrogates (see Appendix). For the truncated time shift method, the number of surrogates and procedure to calculate the <italic>p</italic>-value are described in Appendix.</p>
<p>We set up surrogate data tests by pairing each of the 5 correlation statistics described in <xref rid="tbl2" ref-type="table">Table 2</xref> with each of the 6 surrogate data procedures described in <xref rid="tbl1" ref-type="table">Table 1</xref>. See Appendix for a detailed introduction to each statistic and procedure.</p>
<p>For 3 correlation statistics (Pearson‚Äôs correlation coefficient, local similarity analysis, and Granger causality), we also assessed an analytical test‚Äìwhere the null distribution is obtained directly from a derived equation, rather than from surrogates. In the Pearson correlation test, the sample Pearson correlation coefficient is transformed into a <italic>t</italic>-statistic, whose null distribution is a <italic>t</italic>-distribution with an adjusted degrees of freedom based on the amount of autocorrelation in the time series [<xref ref-type="bibr" rid="c7">7</xref>]. For the analytical local similarity test, we estimate the ‚Äúlong-run variance‚Äù of the element-wise product of the two time series, and use that estimate to find a theoretical approximation for the <italic>p</italic>-value [<xref ref-type="bibr" rid="c26">26</xref>]. The analytical test for Granger causality was based on an <italic>F</italic>-test [<xref ref-type="bibr" rid="c27">27</xref>]. More detailed descriptions of these tests can be found in the Appendix.</p>
<p>All the above testing procedures are designed to test the null hypothesis that the two time series are independent, except for the analytical Granger causality test, which tests the null hypothesis of ‚ÄúGranger non-causality‚Äù (i.e. that the past of <italic>x</italic> does not contain unique information about the future of <italic>y</italic> [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c17">17</xref>]). However, this exception is inconsequential for us since all of our independent cases are also Granger non-causal, and all of our dependent cases are constructed to be Granger-causal in both directions.</p>
</sec>
<sec id="s4b">
<title>Simulating two-species ecosystems</title>
<p>For each benchmark, we simulate the population dynamics in a pair of interacting species by integrating a system of ordinary differential equations over time steps of Œî<italic>t</italic> = 0.05 using the RK45 differential equations solver implemented in the package Scipy[<xref ref-type="bibr" rid="c41">41</xref>] and adding random process noise‚Äìrepresenting population fluctuations such as from migration or stochastic environmental perturbations‚Äìto each variable between integration steps:
<disp-formula id="eqn1">
<graphic xlink:href="617506v1_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>x</italic><sub><italic>t</italic></sub> and <italic>y</italic><sub><italic>t</italic></sub> are the population density values of two species, <italic>Œµ</italic><sub><italic>x,t</italic></sub>; <italic>Œµ</italic><sub><italic>y,t</italic></sub> are random variables, and Œî<italic>t</italic> = 0.05 is the time between instances of process noise. Since negative biomass is impossible, if a process noise term brought the population density of a species below zero, our simulation simply set the density to zero. For each simulation, functional forms for the rates of change (<italic>dx</italic>/<italic>dt</italic>; <italic>dy</italic>/<italic>dt</italic>) are depicted in the relevant figure, except for <xref rid="fig2" ref-type="fig">Fig 2</xref>, where the equations are
<disp-formula id="ueqn1">
<graphic xlink:href="617506v1_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
We start collecting time points after 3000 integration steps. This gives the system time to relax from its initial conditions and reach equilibrium, reducing dependence of the results on initial conditions. Then, we record observations of <italic>x</italic> and <italic>y</italic> every <italic>n</italic><sub><italic>s</italic></sub> integration steps, where <italic>n</italic><sub><italic>s</italic></sub> is typically 5 (which means the time between sampling points is <italic>n</italic><sub><italic>s</italic></sub>Œî<italic>t</italic> = 0.25). In figures, time points are indexed with the variable <italic>i</italic>, where <italic>i</italic> = (<italic>t</italic> ‚àí 150)/(<italic>n</italic><sub><italic>s</italic></sub>Œî<italic>t</italic>). For simulations with relatively smooth dynamics, we add measurement noise to each time point after simulation, which prevents numerical errors when computing correlation statistics. The measurement noise is drawn from a normal distribution centered at 0, with a variance chosen based on the stable population densities (e.g. 10<sup>‚àí2</sup> for the prey-predator system or 10<sup>‚àí6</sup> for competition). The details of these parameters on a per-simulation basis are given in <xref rid="tbl3" ref-type="table">Table 3</xref>.</p>
</sec>
</sec>
</body>
<back>
<sec id="additional-files" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="supp1">
<label>Appendix</label>
<media xlink:href="supplements/617506_file02.pdf"/>
</supplementary-material>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G. U.</given-names> <surname>Yule</surname></string-name></person-group>, ‚Äú<article-title>Why do we sometimes get nonsense-correlations between time-series?‚Äìa study in sampling and the nature of time-series</article-title>,‚Äù <source>Journal of the royal statistical society</source>, vol. <volume>89</volume>, no. <issue>1</issue>, pp. <fpage>1</fpage>‚Äì<lpage>63</lpage>, <year>1926</year>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C. W.</given-names> <surname>Granger</surname></string-name> and <string-name><given-names>P.</given-names> <surname>Newbold</surname></string-name></person-group>, ‚Äú<article-title>Spurious regressions in econometrics</article-title>,‚Äù <source>Journal of econometrics</source>, vol. <volume>2</volume>, no. <issue>2</issue>, pp. <fpage>111</fpage>‚Äì<lpage>120</lpage>, <year>1974</year>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A. R.</given-names> <surname>Coenen</surname></string-name>, <string-name><given-names>S. K.</given-names> <surname>Hu</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Luo</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Muratore</surname></string-name>, and <string-name><given-names>J. S.</given-names> <surname>Weitz</surname></string-name></person-group>, ‚Äú<article-title>A primer for microbiome time-series analysis</article-title>,‚Äù <source>Frontiers in genetics</source>, vol. <volume>11</volume>, p. <fpage>310</fpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A. E.</given-names> <surname>Yuan</surname></string-name> and <string-name><given-names>W.</given-names> <surname>Shou</surname></string-name></person-group>, ‚Äú<article-title>Data-driven causal analysis of observational biological time series</article-title>,‚Äù <source>eLife</source>, vol. <volume>11</volume>, p. <elocation-id>e72518</elocation-id>, <year>2022</year>. <pub-id pub-id-type="doi">10.7554/eLife.72518</pub-id></mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>H.</given-names> <surname>Reichenbach</surname></string-name></person-group>, <source>The direction of time</source>. <publisher-name>Univ of California Press</publisher-name>, <year>1956</year>, vol. <volume>65</volume>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Runge</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Bathiany</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Bollt</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Camps-Valls</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Coumou</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Deyle</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Glymour</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Kretschmer</surname></string-name>, <string-name><given-names>M. D.</given-names> <surname>Mahecha</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Mu√±oz-Mar√≠</surname></string-name> <etal>et al.</etal></person-group>, ‚Äú<article-title>Inferring causation from time series in earth system sciences</article-title>,‚Äù <source>Nature communications</source>, vol. <volume>10</volume>, no. <issue>1</issue>, p. <fpage>2553</fpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>Dutilleul</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Clifford</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Richardson</surname></string-name>, and <string-name><given-names>D.</given-names> <surname>Hemon</surname></string-name></person-group>, ‚Äú<article-title>Modifying the t test for assessing the correlation between two spatial processes</article-title>,‚Äù <source>Biometrics</source>, pp. <fpage>305</fpage>‚Äì<lpage>314</lpage>, <year>1993</year>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>W.</given-names> <surname>Ebisuzaki</surname></string-name></person-group>, ‚Äú<article-title>A method to estimate the statistical significance of a correlation when the data are serially correlated</article-title>,‚Äù <source>Journal of climate</source>, vol. <volume>10</volume>, no. <issue>9</issue>, pp. <fpage>2147</fpage>‚Äì<lpage>2153</lpage>, <year>1997</year>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Q.</given-names> <surname>Ruan</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Dutta</surname></string-name>, <string-name><given-names>M. S.</given-names> <surname>Schwalbach</surname></string-name>, <string-name><given-names>J. A.</given-names> <surname>Steele</surname></string-name>, <string-name><given-names>J. A.</given-names> <surname>Fuhrman</surname></string-name>, and <string-name><given-names>F.</given-names> <surname>Sun</surname></string-name></person-group>, ‚Äú<article-title>Local similarity analysis reveals unique associations among marine bacterioplankton species and environmental factors</article-title>,‚Äù <source>Bioinformatics</source>, vol. <volume>22</volume>, no. <issue>20</issue>, pp. <fpage>2532</fpage>‚Äì<lpage>2538</lpage>, 07 <year>2006</year>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btl417</pub-id></mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G.</given-names> <surname>Sugihara</surname></string-name>, <string-name><given-names>R.</given-names> <surname>May</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Ye</surname></string-name>, <string-name><given-names>C. hao</given-names> <surname>Hsieh</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Deyle</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Fogarty</surname></string-name>, and <string-name><given-names>S.</given-names> <surname>Munch</surname></string-name></person-group>, ‚Äú<article-title>Detecting causality in complex ecosystems</article-title>,‚Äù <source>Science</source>, vol. <volume>338</volume>, no. <issue>6106</issue>, pp. <fpage>496</fpage>‚Äì<lpage>500</lpage>, <year>2012</year>. <ext-link ext-link-type="uri" xlink:href="https://www.science.org/doi/abs/10.1126/science.1227079">https://www.science.org/doi/abs/10.1126/science.1227079</ext-link></mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Papana</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Kyrtsou</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Kugiumtzis</surname></string-name>, and <string-name><given-names>C.</given-names> <surname>Diks</surname></string-name></person-group>, ‚Äú<article-title>Assessment of resampling methods for causality testing: A note on the us inflation behavior</article-title>,‚Äù <source>PloS one</source>, vol. <volume>12</volume>, no. <issue>7</issue>, p. <fpage>e0180852</fpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>F.</given-names> <surname>Barraquand</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Picoche</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Detto</surname></string-name>, and <string-name><given-names>F.</given-names> <surname>Hartig</surname></string-name></person-group>, ‚Äú<article-title>Inferring species interactions using granger causality and convergent cross mapping</article-title>,‚Äù <source>Theoretical Ecology</source>, vol. <volume>14</volume>, no. <issue>1</issue>, pp. <fpage>87</fpage>‚Äì<lpage>105</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R. G.</given-names> <surname>Andrzejak</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Kraskov</surname></string-name>, <string-name><given-names>H.</given-names> <surname>St√∂gbauer</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Mormann</surname></string-name>, and <string-name><given-names>T.</given-names> <surname>Kreuz</surname></string-name></person-group>, ‚Äú<article-title>Bivariate surrogate techniques: necessity, strengths, and caveats</article-title>,‚Äù <source>Physical review E</source>, vol. <volume>68</volume>, no. <issue>6</issue>, p. <fpage>066202</fpage>, <year>2003</year>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G.</given-names> <surname>Lancaster</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Iatsenko</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Pidde</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Ticcinelli</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Stefanovska</surname></string-name></person-group>, ‚Äú<article-title>Surrogate data for hypothesis testing of physical systems</article-title>,‚Äù <source>Physics Reports</source>, vol. <volume>748</volume>, pp. <fpage>1</fpage>‚Äì<lpage>60</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>N.</given-names> <surname>Breznau</surname></string-name>, <string-name><given-names>E. M.</given-names> <surname>Rinke</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Wuttke</surname></string-name>, <string-name><given-names>H. H.</given-names> <surname>Nguyen</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Adem</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Adriaans</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Alvarez-Benjumea</surname></string-name>, <string-name><given-names>H. K.</given-names> <surname>Andersen</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Auer</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Azevedo</surname></string-name> <etal>et al.</etal></person-group>, ‚Äú<article-title>Observing many researchers using the same data and hypothesis reveals a hidden universe of uncertainty</article-title>,‚Äù <source>Proceedings of the National Academy of Sciences</source>, vol. <volume>119</volume>, no. <issue>44</issue>, p. <fpage>e2203150119</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C. W.</given-names> <surname>Granger</surname></string-name></person-group>, ‚Äú<article-title>Investigating causal relations by econometric models and cross-spectral methods</article-title>,‚Äù <source>Econometrica: journal of the Econometric Society</source>, pp. <fpage>424</fpage>‚Äì<lpage>438</lpage>, <year>1969</year>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C. W.</given-names> <surname>Granger</surname></string-name></person-group>, ‚Äú<article-title>Testing for causality: a personal viewpoint</article-title>,‚Äù <source>Journal of Economic Dynamics and control</source>, vol. <volume>2</volume>, pp. <fpage>329</fpage>‚Äì<lpage>352</lpage>, <year>1980</year>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R. R.</given-names> <surname>Stein</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Bucci</surname></string-name>, <string-name><given-names>N. C.</given-names> <surname>Toussaint</surname></string-name>, <string-name><given-names>C. G.</given-names> <surname>Buffie</surname></string-name>, <string-name><given-names>G.</given-names> <surname>R√§tsch</surname></string-name>, <string-name><given-names>E. G.</given-names> <surname>Pamer</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Sander</surname></string-name>, and <string-name><given-names>J. B.</given-names> <surname>Xavier</surname></string-name></person-group>, ‚Äú<article-title>Ecological modeling from time-series inference: insight into dynamics and stability of intestinal microbiota</article-title>,‚Äù <source>PLoS computational biology</source>, vol. <volume>9</volume>, no. <issue>12</issue>, p. <fpage>e1003388</fpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>V.</given-names> <surname>Bucci</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Tzen</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Li</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Simmons</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Tanoue</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Bogart</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Deng</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Yeliseyev</surname></string-name>, <string-name><given-names>M. L.</given-names> <surname>Delaney</surname></string-name>, <string-name><given-names>Q.</given-names> <surname>Liu</surname></string-name> <etal>et al.</etal></person-group>, ‚Äú<article-title>Mdsine: Microbial dynamical systems inference engine for microbiome time-series analyses</article-title>,‚Äù <source>Genome biology</source>, vol. <volume>17</volume>, no. <issue>1</issue>, pp. <fpage>1</fpage>‚Äì<lpage>17</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>H.-T.</given-names> <surname>Cao</surname></string-name>, <string-name><given-names>T. E.</given-names> <surname>Gibson</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Bashan</surname></string-name>, and <string-name><given-names>Y.-Y.</given-names> <surname>Liu</surname></string-name></person-group>, ‚Äú<article-title>Inferring human microbial dynamics from temporal metagenomics data: Pitfalls and lessons</article-title>,‚Äù <source>BioEssays</source>, vol. <volume>39</volume>, no. <issue>2</issue>, p. <fpage>1600188</fpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Niehaus</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Boland</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Liu</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Fu</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Henckel</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Chaung</surname></string-name>, <string-name><given-names>S. E.</given-names> <surname>Miranda</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Dyckman</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Crum</surname></string-name> <etal>et al.</etal></person-group>, ‚Äú<article-title>Microbial coexistence through chemical-mediated interactions</article-title>,‚Äù <source>Nature communications</source>, vol. <volume>10</volume>, no. <issue>1</issue>, pp. <fpage>1</fpage>‚Äì<lpage>12</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.</given-names> <surname>Cobey</surname></string-name> and <string-name><given-names>E. B.</given-names> <surname>Baskerville</surname></string-name></person-group>, ‚Äú<article-title>Limits to causal inference with state-space reconstruction for infectious disease</article-title>,‚Äù <source>PloS one</source>, vol. <volume>11</volume>, no. <issue>12</issue>, p. <fpage>e0169050</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.</given-names> <surname>Stathopoulos</surname></string-name>, <string-name><given-names>A. A.</given-names> <surname>Tsonis</surname></string-name>, and <string-name><given-names>K.</given-names> <surname>Kourtidis</surname></string-name></person-group>, ‚Äú<article-title>On the cause-and-effect relations between aerosols, water vapor, and clouds over east asia</article-title>,‚Äù <source>Theoretical and Applied Climatology</source>, vol. <volume>144</volume>, pp. <fpage>711</fpage>‚Äì<lpage>722</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G.</given-names> <surname>Bonotto</surname></string-name>, <string-name><given-names>T. J.</given-names> <surname>Peterson</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Fowler</surname></string-name>, and <string-name><given-names>A. W.</given-names> <surname>Western</surname></string-name></person-group>, ‚Äú<article-title>Identifying causal interactions between groundwater and streamflow using convergent cross-mapping</article-title>,‚Äù <source>Water Resources Research</source>, vol. <volume>58</volume>, no. <issue>8</issue>, p. <fpage>e2021WR030231</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Frassineti</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Manfredi</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Ermini</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Fabbri</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Olmi</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Lanat√†</surname></string-name></person-group>, ‚Äú<article-title>Analysis of brain-heart interactions in newborns with and without seizures using the convergent cross mapping approach</article-title>,‚Äù In <conf-name>2022 44th annual international conference of the IEEE Engineering in Medicine &amp; Biology Society (EMBC)</conf-name>. <publisher-name>IEEE</publisher-name>, <year>2022</year>, pp. <fpage>36</fpage>‚Äì<lpage>39</lpage>.</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>F.</given-names> <surname>Zhang</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Sun</surname></string-name>, and <string-name><given-names>Y.</given-names> <surname>Luan</surname></string-name></person-group>, ‚Äú<article-title>Statistical significance approximation for local similarity analysis of dependent time series data</article-title>,‚Äù <source>BMC bioinformatics</source>, vol. <volume>20</volume>, no. <issue>1</issue>, pp. <fpage>1</fpage>‚Äì<lpage>15</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><given-names>S.</given-names> <surname>Seabold</surname></string-name> and <string-name><given-names>J.</given-names> <surname>Perktold</surname></string-name></person-group>, ‚Äú<article-title>statsmodels: Econometric and statistical modeling with python</article-title>,‚Äù In <conf-name>9th Python in Science Conference</conf-name>, <year>2010</year>.</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Kraskov</surname></string-name>, <string-name><given-names>H.</given-names> <surname>St√∂gbauer</surname></string-name>, and <string-name><given-names>P.</given-names> <surname>Grassberger</surname></string-name></person-group>, ‚Äú<article-title>Estimating mutual information</article-title>,‚Äù <source>Physical Review E</source>, vol. <volume>69</volume>, no. <issue>6</issue>, <month>Jun</month> <year>2004</year>. <pub-id pub-id-type="doi">10.1103/PhysRevE.69.066138</pub-id></mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>W.</given-names> <surname>Endo</surname></string-name>, <string-name><given-names>F. P.</given-names> <surname>Santos</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Simpson</surname></string-name>, <string-name><given-names>C. D.</given-names> <surname>Maciel</surname></string-name>, and <string-name><given-names>P. L.</given-names> <surname>Newland</surname></string-name></person-group>, ‚Äú<article-title>Delayed mutual information infers patterns of synaptic connectivity in a proprioceptive neural network</article-title>,‚Äù <source>Journal of computational neuroscience</source>, vol. <volume>38</volume>, no. <issue>2</issue>, pp. <fpage>427</fpage>‚Äì<lpage>438</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R. T.</given-names> <surname>Dean</surname></string-name> and <string-name><given-names>W.</given-names> <surname>Dunsmuir</surname></string-name></person-group>, ‚Äú<article-title>Dangers and uses of cross-correlation in analyzing time series in perception, performance, movement, and neuroscience: The importance of constructing transfer function autoregressive models</article-title>,‚Äù <source>Behavior research methods</source>, vol. <volume>48</volume>, no. <issue>2</issue>, pp. <fpage>783</fpage>‚Äì<lpage>802</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Barnett</surname></string-name> and <string-name><given-names>A. K.</given-names> <surname>Seth</surname></string-name></person-group>, ‚Äú<article-title>The mvgc multivariate granger causality toolbox: a new approach to granger-causal inference</article-title>,‚Äù <source>Journal of neuroscience methods</source>, vol. <volume>223</volume>, pp. <fpage>50</fpage>‚Äì<lpage>68</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>C.</given-names> <surname>Diks</surname></string-name> and <string-name><given-names>J.</given-names> <surname>DeGoede</surname></string-name></person-group>, ‚Äú<chapter-title>A general nonparametric bootstrap test for granger causality</chapter-title>,‚Äù In <person-group person-group-type="editor"><string-name><given-names>HW</given-names> <surname>Broer</surname></string-name>, <string-name><given-names>B</given-names> <surname>Krauskopf</surname></string-name> and <string-name><given-names>G</given-names> <surname>Vegter</surname></string-name></person-group> (Eds) <source>Global analysis of dynamical systems</source>. <publisher-name>CRC Press</publisher-name>, <year>2001</year>, pp. <fpage>393</fpage>‚Äì<lpage>405</lpage>.</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>H.</given-names> <surname>Ye</surname></string-name>, <string-name><given-names>E. R.</given-names> <surname>Deyle</surname></string-name>, <string-name><given-names>L. J.</given-names> <surname>Gilarranz</surname></string-name>, and <string-name><given-names>G.</given-names> <surname>Sugihara</surname></string-name></person-group>, ‚Äú<article-title>Distinguishing time-delayed causal interactions using convergent cross mapping</article-title>,‚Äù <source>Scientific reports</source>, vol. <volume>5</volume>, no. <issue>1</issue>, pp. <fpage>1</fpage>‚Äì<lpage>9</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Hemerik</surname></string-name> and <string-name><given-names>J.</given-names> <surname>Goeman</surname></string-name></person-group>, ‚Äú<article-title>Exact testing with random permutations</article-title>,‚Äù <source>Test</source>, vol. <volume>27</volume>, no. <issue>4</issue>, pp. <fpage>811</fpage>‚Äì<lpage>825</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>E. L.</given-names> <surname>Lehmann</surname></string-name> and <string-name><given-names>J. P.</given-names> <surname>Romano</surname></string-name></person-group>, <source>Testing statistical hypotheses</source>. <publisher-name>Springer</publisher-name>, <year>1986</year>, vol. <volume>3</volume>.</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>D. N.</given-names> <surname>Politis</surname></string-name> and <string-name><given-names>J. P.</given-names> <surname>Romano</surname></string-name></person-group>, ‚Äú<article-title>The stationary bootstrap</article-title>,‚Äù <source>Journal of the American Statistical association</source>, vol. <volume>89</volume>, no. <issue>428</issue>, pp. <fpage>1303</fpage>‚Äì<lpage>1313</lpage>, <year>1994</year>.</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>A. E.</given-names> <surname>Yuan</surname></string-name> and <string-name><given-names>W.</given-names> <surname>Shou</surname></string-name></person-group>, ‚Äú<article-title>An exactly valid and distribution-free statistical significance test for correlations between time series</article-title>,‚Äù <source>bioRxiv</source>, <year>2022</year>.</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T.</given-names> <surname>Schreiber</surname></string-name> and <string-name><given-names>A.</given-names> <surname>Schmitz</surname></string-name></person-group>, ‚Äú<article-title>Improved surrogate data for nonlinearity tests</article-title>,‚Äù <source>Physical review letters</source>, vol. <volume>77</volume>, no. <issue>4</issue>, p. <fpage>635</fpage>, <year>1996</year>.</mixed-citation></ref>
<ref id="c39"><label>[39]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T.</given-names> <surname>Schreiber</surname></string-name> and <string-name><given-names>A.</given-names> <surname>Schmitz</surname></string-name></person-group>, ‚Äú<article-title>Surrogate time series</article-title>,‚Äù <source>Physica D: Nonlinear Phenomena</source>, vol. <volume>142</volume>, no. <issue>3-4</issue>, pp. <fpage>346</fpage>‚Äì<lpage>382</lpage>, <year>2000</year>.</mixed-citation></ref>
<ref id="c40"><label>[40]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M.</given-names> <surname>Thiel</surname></string-name>, <string-name><given-names>M. C.</given-names> <surname>Romano</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Kurths</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Rolfs</surname></string-name>, and <string-name><given-names>R.</given-names> <surname>Kliegl</surname></string-name></person-group>, ‚Äú<article-title>Twin surrogates to test for complex synchronisation</article-title>,‚Äù <source>EPL (Europhysics Letters)</source>, vol. <volume>75</volume>, no. <issue>4</issue>, p. <fpage>535</fpage>, <year>2006</year>.</mixed-citation></ref>
<ref id="c41"><label>[41]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>Virtanen</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Gommers</surname></string-name>, <string-name><given-names>T. E.</given-names> <surname>Oliphant</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Haberland</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Reddy</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Cournapeau</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Burovski</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Peterson</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Weckesser</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Bright</surname></string-name> <etal>et al.</etal></person-group>, ‚Äú<article-title>Scipy 1.0: fundamental algorithms for scientific computing in python</article-title>,‚Äù <source>Nature methods</source>, vol. <volume>17</volume>, no. <issue>3</issue>, pp. <fpage>261</fpage>‚Äì<lpage>272</lpage>, <year>2020</year>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.108198.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Bitbol</surname>
<given-names>Anne-Florence</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1020-494X</contrib-id>
<aff>
<institution-wrap>
<institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution>
</institution-wrap>
<city>Lausanne</city>
<country>Switzerland</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study presents a <bold>valuable</bold> in-depth comparison of statistical methods for the analysis of ecological time series data, and shows that different analyses can generate different conclusions, emphasizing the importance of carefully choosing methods and of reporting methodological details. The evidence supporting the claims, based on simulated data for a two-species ecosystem, is <bold>solid</bold>, although testing on more complex datasets could be of further benefit. This paper should be of broad interest to researchers in ecology.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.108198.1.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The manuscript investigates methods for the analysis of time series data, in particular ecological time series. Such data can be analyzed using a myriad of approaches, with choices being made in both the statistical test performed and the generation of artificial datasets for comparison. The simulated data is for a two-species ecosystem. The main finding is that the rates of false positives and negatives strongly depend on the choices made during analysis, and that no one methodology is an optimal choice for all contexts. A few different scenarios were analyzed, including analysis with a time lag and communities with different species ratios.</p>
<p>Strengths:</p>
<p>The paper sets up a clear problem to motivate the study. The writing is easy to follow, given the dense subject matter. A broad range of approaches was compared for both statistical tests and surrogate data generation. The appendix will be helpful for readers, especially those readers hoping to implement these findings into their own work. The topic of the manuscript should be of interest to many readers, and the authors have put in extra effort to make the writing as clear as possible.</p>
<p>Weaknesses:</p>
<p>
The main conclusions are rather unsatisfying: &quot;use more than one method of analysis&quot;, &quot;be more transparent in how testing is done&quot;, and there is a &quot;need for humility when drawing scientific conclusions&quot;. In fact, the findings are not instructions for how to analyze data, but instead highlight the extreme dependence of the interpretation of results on choices made during analysis. The conclusions reached in this study would be of interest to a specialized subset of researchers focused on the biostatistics of ecological data. Ending the article with a few specific recommendations for how to apply these conclusions to a broad range of datasets would increase the impact of the work.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.108198.1.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This manuscript tackles an important and often neglected aspect of time-series analysis in ecology - the multitude of &quot;small&quot; methodological choices that can alter outcomes. The findings are solid, though they may be limited in terms of generalizability, due to the simple use case tested.</p>
<p>Strengths:</p>
<p>(1) Comprehensive Methodological Benchmarking:</p>
<p>The study systematically evaluates 30 test variants (5 correlation statistics √ó 6 surrogate methods), which is commendable and provides a broad view of methodological behavior.</p>
<p>(2) Important Practical Recommendations:</p>
<p>The manuscript provides valuable real-world guidance, such as the superiority of tailored lags over fixed lags, the risks of using shuffling-based nulls, and the importance of selecting appropriate surrogate templates for directional tests.</p>
<p>(3) Novel Insights into System Dependence:</p>
<p>A key contribution is the demonstration that test results can vary dramatically with system state (e.g., initial conditions or abundance asymmetries), even when interaction parameters remain constant. This highlights a real-world issue for ecological inference.</p>
<p>(4) Clarification of Surrogate Template Effects:</p>
<p>The study uncovers a rarely discussed but critical issue: that the choice of which variable to surrogate in directional tests (e.g., convergent cross mapping) can drastically affect false-positive rates.</p>
<p>(5) Lag Selection Analysis:</p>
<p>The comparison of lag selection methods is a valuable addition, offering a clear takeaway that fixed-lag strategies can severely inflate false positives and that tailored-lag approaches are preferred.</p>
<p>(6) Transparency and Reproducibility Focus:</p>
<p>The authors advocate for full methodological transparency, encouraging researchers to report all analytical choices and test multiple methods.</p>
<p>Weaknesses / Areas for Improvement:</p>
<p>(1) Limited Model Generality:</p>
<p>The study relies solely on two-species systems and two types of competitive dynamics. This limits the ecological realism and generalizability of the findings. It's unclear how well the results would transfer to more complex ecosystems or interaction types (e.g., predator-prey, mutualism, or chaotic systems).</p>
<p>(2) Method Description Clarity:</p>
<p>Some method descriptions are too terse, and table references are mislabeled (e.g., Table 1 vs. Table 2 confusion). This reduces reproducibility and clarity for readers unfamiliar with the specific tests.</p>
<p>(3) Insufficient Discussion of Broader Applicability:</p>
<p>While the pairwise test setup justifies two-species models, the authors should more explicitly address whether the observed test sensitivities (e.g., effect of system state, template choice) are expected to hold in multi-species or networked settings.</p>
<p>(4) Lack of Practical Summary:</p>
<p>The paper offers great insights, but currently spreads recommendations throughout the text. A dedicated section or table summarizing &quot;Best Practices&quot; would increase accessibility and application by practitioners.</p>
<p>(5) No Real-World Validation:</p>
<p>The work is based entirely on simulation. Including or referencing an empirical case study would help illustrate how these methodological choices play out in actual ecological datasets.</p>
</body>
</sub-article>
</article>