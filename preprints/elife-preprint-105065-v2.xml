<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">105065</article-id>
<article-id pub-id-type="doi">10.7554/eLife.105065</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.105065.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.4</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories><title-group>
<article-title>The general version of Hamilton’s rule</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8290-9212</contrib-id>
<name>
<surname>van Veelen</surname>
<given-names>Matthijs</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>c.m.vanveelen@uva.nl</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04dkp9463</institution-id><institution>Department of Economics, Universiteit van Amsterdam</institution></institution-wrap>, <city>Amsterdam</city>, <country country="NL">Netherlands</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Rainey</surname>
<given-names>Paul B</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Evolutionary Biology</institution>
</institution-wrap>
<city>Plön</city>
<country country="DE">Germany</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Perry</surname>
<given-names>George H</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Pennsylvania State University</institution>
</institution-wrap>
<city>University Park</city>
<country country="US">United States</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-03-24">
<day>24</day>
<month>03</month>
<year>2025</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-06-13">
<day>13</day>
<month>06</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP105065</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-11-18">
<day>18</day>
<month>11</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-11-27">
<day>27</day>
<month>11</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.11.25.625193"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2025-03-24">
<day>24</day>
<month>03</month>
<year>2025</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.105065.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.105065.1.sa3">eLife Assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.105065.1.sa2">Reviewer #1 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.105065.1.sa1">Reviewer #2 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.105065.1.sa0">Reviewer #3 (Public review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, van Veelen</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>van Veelen</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-105065-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>The generality of Hamilton’s rule<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref></sup> is much debated<sup><xref ref-type="bibr" rid="c3">3</xref>–<xref ref-type="bibr" rid="c14">14</xref></sup>. In this paper, I show that this debate can be resolved by constructing a general version of Hamilton’s rule, which allows for a large variety of ways in which the fitness of an individual can depend on the social behaviour of oneself and of others. For this, I first derive the Generalized Price equation, which reconnects the Price equation<sup><xref ref-type="bibr" rid="c15">15</xref></sup> with the statistics it borrows its terminology from.</p>
<p>The Generalized Price equation moreover shows that there is not just one Price equation, but there is a Price-like equation for every possible true model. This implies that there are also multiple, nested rules to describe selection. The simplest rule is the rule for selection of non-social traits with linear fitness effects. This rule is nested in the classical version of Hamilton’s rule, for which there is consensus that it works for social traits with linear, independent fitness effects. The classical version of Hamilton’s rule, in turn, is nested in more general rules, that for instance allow for nonlinear and/or interdependent fitness effects, like Queller’s rule<sup><xref ref-type="bibr" rid="c16">16</xref></sup>. The general version of Hamilton’s rule therefore is a constructive solution, that allows us to accurately describe when costly cooperation evolves in a wide variety of circumstances. As a byproduct, we also find a hierarchy of nested rules for selection of non-social traits.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>I made a few small edits to improve the text.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Hamilton’s rule<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref></sup> is one of the more famous rules in evolutionary biology. The rule states that altruism will evolve if <italic>rb</italic> &gt; <italic>c</italic>, where <italic>b</italic> is the fitness benefit to the recipient, <italic>c</italic> is the fitness cost to the donor, and <italic>r</italic> is the genetic relatedness between them. The generality of Hamilton’s rule however has always been a topic of contention<sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c4">4</xref></sup>, and positions range all the way from “<italic>Hamilton’s rule almost never holds</italic>”<sup><xref ref-type="bibr" rid="c6">6</xref></sup> to “<italic>Inclusive fitness is as general as the genetical theory of natural selection itself</italic>”<sup><xref ref-type="bibr" rid="c7">7</xref></sup>.</p>
<p>The claim of generality is not based on the original derivation of Hamilton’s rule<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c17">17</xref></sup>, but on later derivations <sup><xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c18">18</xref>–<xref ref-type="bibr" rid="c23">23</xref></sup> that use the Price equation<sup><xref ref-type="bibr" rid="c15">15</xref></sup>. This tradition also started with Hamilton himself<sup><xref ref-type="bibr" rid="c18">18</xref>,<xref ref-type="bibr" rid="c19">19</xref></sup>. The usefulness of the Price equation as a tool for doing theory, however, is not undisputed <sup><xref ref-type="bibr" rid="c9">9</xref>,<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c24">24</xref>–<xref ref-type="bibr" rid="c27">27</xref></sup>. One of the remarkable characteristics of the Price equation literature is that it borrows terms from statistics, like regression coefficients, without also inheriting the natural preoccupations of statistics, such as worrying about model choice or statistical significance.</p>
<p>In this paper, I will show that this debate can be resolved by deriving general versions of the Price equation and of Hamilton’s rule. The Generalized Price equation in regression form generates a set of Price-like equations; one for every different choice for a statistical model, that may describe how the fitness of an individual depends on its genetic makeup. This makes the original Price equation in regression form a special case; it is the Generalized Price equation in regression form, combined with a linear model. The Generalized Price equation repairs the broken link between the Price equation and statistics; when applied to data, standard statistical considerations concerning model choice now translate one-to-one to considerations concerning which of these Price-like equation describes the population genetic dynamics. I will also consider the application of the Generalized Price equation in the modeling domain, and it will be helpful to always discuss the application to data and to modeling separately.</p>
<p>With the Generalized Price equation, I then derive the general version of Hamilton’s rule. Both the limitations of the original Price equation, and ways to overcome these limitations by using the generalized version, are mirrored in the limitations of Hamilton’s rule as we know it, and ways to overcome those. Just like there is not just one Price equation, but a multitude of Price-like equations, there is not just one Hamilton’s rule, but a multitude of Hamilton-like rules. All of them are correct, and all of them are general, but none of them is generally meaningful. A specific Hamilton’s rule, though always correct, is only meaningful if based on the Generalized Price equation, in combination with a model that is appropriately specified for the evolutionary system under study.</p>
<p>The Generalized Price equation puts the debate concerning the validity of Hamilton’s rule in perspective by showing that some arguments are not as decisive as they are currently perceived to be. The side of the debate that claims full generality has repeatedly stressed that Hamilton’s rule, derived with the Price equation, is an identity that holds generally<sup><xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c11">11</xref></sup> (that is, it holds, whatever the parent and the offspring generations are).</p>
<p>This is correct, but the general version of Hamilton’s rule shows that being an identity that holds generally cannot be the only relevant characteristic for regarding it as the proper, the right, or the most insightful rule that describes evolution. The reason why this cannot be, is that all Price-like equations generated by the Generalized Price equation, and thereby all Hamilton-like rules produced by them, have those properties; they are all identities that hold with exactly the same generality. To decide between the different Hamilton-like rules, we therefore need additional criteria. When doing empirics, we then have to resort to classical statistics, to see which model agrees with the data. With sufficiently many data, this will then point to a statistical model, and by doing so, it will also point to one of these Hamilton-like rules. An indication that the approach suggested in this paper does indeed pick a Hamilton-like rule that is well-specified, both with modeling and with empirics, is that the quantities in it that we treat as constants are in fact constant, and that they do not change with the composition of the parent population.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>The Generalized Price equation in combination with models for non-social traits</title>
<p>I would like to start with describing how generalizing the Price equation works. By applying this to linear and non-linear fitness functions in a non-social context, I would moreover like to illustrate that for the Price-like equations that this generates, and that are meant to describe population genetic dynamics, there is scope for under- and for overspecification in the same way that there is scope for under- and for overspecification in statistics.</p>
<p>Assume that we track a set of genes, summarized by a <italic>p</italic>-score<sup><xref ref-type="bibr" rid="c20">20</xref></sup>. This <italic>p</italic>-score is a value between 0 and 1. In the simplest possible haploid setup, this reflects the presence or absence of a single gene, in which case an individual’s <italic>p</italic>-score would be 1 if the gene is present, and 0 if it is absent. In less simple setups, the <italic>p</italic>-score can for instance reflect a set of genes that affect the same trait. The change in average <italic>p</italic>-score between the parent and the offspring generation can then be written as a sum of two terms, in what Price called the “covariance form” of his equation<sup><xref ref-type="bibr" rid="c15">15</xref></sup>.
<disp-formula id="eqn1">
<graphic xlink:href="625193v4_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>Here, <inline-formula><inline-graphic xlink:href="625193v4_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the average fitness in the parent generation; <inline-formula><inline-graphic xlink:href="625193v4_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the change in average <italic>p</italic>-score between parent and offspring generation; <inline-formula><inline-graphic xlink:href="625193v4_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula> times the sample covariance between fitness and <italic>p</italic>-score (or, in other words, the sample covariance without Bessel’s correction; see Section 2 of Appendix A for details about the terminology); and <italic>E</italic>(<italic>w</italic>Δ<italic>p</italic>) is the fitness-weighted average difference between the <italic>p</italic>-scores of the parents, and, in an asexual model, the <italic>p</italic>-scores of their offspring, or, in a model with sexual reproduction, the <italic>p</italic>-scores of their successful gametes (all details are in Appendix A).</p>
<p>In order to get to the Generalized Price equation in covariance form, we assume a statistical model that has fitness as a dependent variable, and that contains, at least, 1) a constant term, and 2) a linear term for the <italic>p</italic>-score as an explanatory variable. Besides those two terms, the statistical model may contain any number of other terms as well. This statistical model is then combined with the transition we want to apply the Generalized Price equation to. A transition implies that we know what the <italic>p</italic>-score is for all individuals in the parent population, and that we know how many offspring all individuals have, and therefore what their realized fitness is (this is the number of offspring divided by the ploidy). Combining a transition with a statistical model here means that we choose the parameters of the model so that they minimize the sum of squared differences between the model-predicted fitness <inline-formula><inline-graphic xlink:href="625193v4_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and the realized fitnesses <italic>w</italic><sub><italic>i</italic></sub>, for individuals <italic>i</italic> = 1, …, <italic>n</italic>. For any model that does indeed include a constant term and a linear term for the <italic>p</italic>-score, we can then replace the realized fitnesses <italic>w</italic><sub><italic>i</italic></sub> in the Price equation with the estimated fitnesses <inline-formula><inline-graphic xlink:href="625193v4_inline5.gif" mimetype="image" mime-subtype="gif"/></inline-formula> according to the model. This leads to the Generalized Price equation in covariance form:
<disp-formula id="eqn2">
<graphic xlink:href="625193v4_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>The algebra to show that this is an identity is in Appendix A, on pages 12–14. While replacing <italic>w</italic> with <inline-formula><inline-graphic xlink:href="625193v4_inline6.gif" mimetype="image" mime-subtype="gif"/></inline-formula> seems like a minimal change, the important thing to keep in mind, is that this equation is an identity for <italic>any</italic> model that contains a constant, and a linear term for the <italic>p</italic>-score. In other words, for any given transition (that is, for any combination of a parent and an offspring population), the model-predicted fitnesses <inline-formula><inline-graphic xlink:href="625193v4_inline7.gif" mimetype="image" mime-subtype="gif"/></inline-formula> that result from minimizing the sum of squared differences will typically differ, depending on what the model is, but <inline-formula><inline-graphic xlink:href="625193v4_inline8.gif" mimetype="image" mime-subtype="gif"/></inline-formula> equals the sample covariance <italic>Cov</italic>(<italic>w, p</italic>) for all of these models.</p>
<p>In order to get to what Price calls the “regression form” of the equation, we now choose a set of models for non-social traits, all of which contain a constant and a linear term (which makes it satisfy the condition for the Generalized Price equation to hold). The set of models we choose here is given by
<disp-formula id="ueqn1">
<graphic xlink:href="625193v4_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>w</italic><sub><italic>i</italic></sub> is the number of offspring of individual <italic>i</italic>; <italic>p</italic><sub><italic>i</italic></sub> is the <italic>p</italic>-score of individual <italic>i</italic>; <italic>α</italic> is a constant term; <italic>β</italic><sub>1</sub>,…, <italic>β</italic><sub><italic>R</italic></sub> are the other coefficients of the model; <italic>ε</italic><sub><italic>i</italic></sub> is the error term for individual <italic>i</italic>; and where we assume that <italic>R</italic> ≥ 1. This gives a different model for every <italic>R</italic>; a linear model for <italic>R</italic> = 1; a quadratic one for <italic>R</italic> = 2; and so on. If we now minimize the sum of squared differences between the model-predicted fitnesses <inline-formula><inline-graphic xlink:href="625193v4_inline9.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (the right hand side of the equation above, but without the error term) and the realized fitnesses (on the left hand side of the same equation), then we arrive at values <inline-formula><inline-graphic xlink:href="625193v4_inline10.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for the regression coefficients.</p>
<p>In Appendix A, on page 15, I show that, for every <italic>R</italic> ≥ 1, and thereby for every model in this set, we can rewrite the Generalized Price equation as follows:
<disp-formula id="eqn3">
<graphic xlink:href="625193v4_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>In line with Price’s terminology<sup><xref ref-type="bibr" rid="c15">15</xref></sup>, this would be the “regression form” of the Generalized Price equation. If we take the linear model (<italic>R</italic> = 1), then, using <italic>Cov(p, p</italic>) = Var(<italic>p</italic>), the above equation becomes
<disp-formula id="ueqn2">
<graphic xlink:href="625193v4_ueqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>Below we will refer to the linear model as Model A. If instead we take the quadratic model (<italic>R</italic> = 2), the equation becomes
<disp-formula id="ueqn3">
<graphic xlink:href="625193v4_ueqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>Below we will refer to the quadratic model as Model B. Again, it is important to remember that both of these equations are identities for every possible transition from a parent to an offspring generation. It is also important to recognize that the <inline-formula><inline-graphic xlink:href="625193v4_inline11.gif" mimetype="image" mime-subtype="gif"/></inline-formula> that we arrive at if we combine Model A with a given transition, and the <inline-formula><inline-graphic xlink:href="625193v4_inline12.gif" mimetype="image" mime-subtype="gif"/></inline-formula> that we arrive at if we use Model B for the same transition, may, and generically will, differ, as we will see.</p>
</sec>
<sec id="s2b">
<title>The Generalized Price equation applied to two artificial datasets</title>
<p>The following example illustrates how the flexibility of the Generalized Price equation in regression form comes with scope for under- and overspecification. The two Price-like equations above – the one with Model A as a reference model, and the one with Model B as a reference model – are combined with two artificial datasets; one where the offspring generation is generated by Model A; and one where the offspring generation is generated by Model B. Because both equations are identities for all possible transitions between parent and offspring generation, they are also both identities for both of these datasets. Depending on the system under study, the terms in these equations however are not equally meaningful as a description of the population genetic dynamics.</p>
<p>The Generalized Price equation in regression form for Model A, in combination with the offspring generation generated by Model A, returns a value for <inline-formula><inline-graphic xlink:href="625193v4_inline13.gif" mimetype="image" mime-subtype="gif"/></inline-formula> that is very close to the true <italic>β</italic><sub>1</sub>; <inline-formula><inline-graphic xlink:href="625193v4_inline14.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, while <italic>β</italic><sub>1</sub> = 1. This is depicted in <xref rid="fig1" ref-type="fig">Fig. 1a</xref>. All details are in Detailed Calculations A.6 at the end of the Appendices.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1.</label>
<caption><title>Two Price-like equations and two models.</title>
<p>In Model A, the number of offspring follows a binomial distribution with an expected number of offspring of <italic>α</italic> + <italic>β</italic><sub>1</sub><italic>p</italic><sub><italic>i</italic></sub>. This means that the model can be summarized as <italic>w</italic><sub><italic>i</italic></sub> = <italic>α</italic> + <italic>β</italic><sub>1</sub><italic>p</italic><sub><italic>i</italic></sub> + <italic>ε</italic><sub><italic>i</italic></sub> (see Detailed Calculations A.6 at the end of the Appendices for details). For the transition depicted in panels a and c, we generated an offspring generation using Model A, with <italic>α</italic> = 1 and <italic>β</italic><sub>1</sub> = 1. Combining the Generalized Price equation in regression form with Model A includes choosing <inline-formula><inline-graphic xlink:href="625193v4_inline70.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="625193v4_inline71.gif" mimetype="image" mime-subtype="gif"/></inline-formula> so that they minimize the sum of squared differences between <italic>w</italic><sub><italic>i</italic></sub> and <inline-formula><inline-graphic xlink:href="625193v4_inline72.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. In Model B, the number of offspring follows a binomial distribution with an expected number of offspring of <italic>α</italic> + <italic>β</italic><sub>1</sub><italic>p</italic><sub><italic>i</italic></sub> + <italic>β</italic><sub>1</sub><italic>p</italic><sub><italic>i</italic></sub><sup>2</sup>, which means that <italic>w</italic><sub><italic>i</italic></sub> = <italic>α</italic> + <italic>β</italic><sub>1</sub><italic>p</italic><sub><italic>i</italic></sub> + <italic>β</italic><sub>1</sub><italic>p</italic><sub><italic>i</italic></sub><sup>2</sup> + <italic>ε</italic><sub><italic>i</italic></sub>. For the transition depicted in panels b and d, we generated an offspring generation using Model B, with <italic>α</italic> = 1, <italic>β</italic><sub>1</sub> = 0, and <italic>β</italic><sub>2</sub> = 1. Combining the Generalized Price equation in regression form with Model B includes choosing <inline-formula><inline-graphic xlink:href="625193v4_inline73.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="625193v4_inline74.gif" mimetype="image" mime-subtype="gif"/></inline-formula> so that they minimize the sum of squared differences between <italic>w</italic><sub><italic>i</italic></sub> and <inline-formula><inline-graphic xlink:href="625193v4_inline75.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. Reproduction is asexual, so parents and their offspring are always identical, and <italic>E</italic>(<italic>w</italic>Δ<italic>p</italic>) = 0 by definition. For both of these models, we started with a population consisting of 2500 parents for each <italic>p</italic>-score, ranging from 0 to 1 in increments of 0.1. The four panels represent the four combinations of the two Price-like equations and the two datasets. The red lines in all panels represent the estimated fitnesses as a function of the <italic>p</italic>-score, as implied by the respective Price-like equations. The aim of this example is not to show that the estimated fitnesses from Price-like equation A match the data generated by Model A, and the estimated fitnesses from Price-like equation B match the data generated by Model B, but the estimated fitnesses from Price equation A do not match the data generated by Model B; that part is obvious. The purpose of this example, instead, is to illustrate that both Price-like equations remain identities, also when they are overspecified (panel c) or underspecified (panel b) with respect to the transition between parent and offspring population they are applied to. With underspecification, it is also visually clear that the estimated fitnesses do <italic>not</italic> match the data, even though Price-like equation A remains an identity, also when combined with data generated by Model B.</p></caption>
<graphic xlink:href="625193v4_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The Generalized Price equation in regression form for Model B, in combination with the offspring generation generated by Model B, returns values for <inline-formula><inline-graphic xlink:href="625193v4_inline15.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="625193v4_inline16.gif" mimetype="image" mime-subtype="gif"/></inline-formula> that are also close to their true values; <inline-formula><inline-graphic xlink:href="625193v4_inline17.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, while <italic>β</italic><sub>1</sub> = 0; and <inline-formula><inline-graphic xlink:href="625193v4_inline18.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, while <italic>β</italic><sub>1</sub> = 1. This is depicted in <xref rid="fig1" ref-type="fig">Fig. 1d</xref>.</p>
<p>If we combine the Generalized Price equation in regression form for Model B with the offspring generation generated by Model A, then this returns values for <inline-formula><inline-graphic xlink:href="625193v4_inline19.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="625193v4_inline20.gif" mimetype="image" mime-subtype="gif"/></inline-formula> that are also close to their true values; <inline-formula><inline-graphic xlink:href="625193v4_inline21.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, while <italic>β</italic><sub>1</sub> = 1; and <inline-formula><inline-graphic xlink:href="625193v4_inline22.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, while <italic>β</italic><sub>2</sub> = 0. This is depicted in <xref rid="fig1" ref-type="fig">Fig. 1b</xref>. Appropriate statistical tests reject that the true <italic>β</italic><sub>2</sub> is different from 0, but the harm done by using the Generalized Price equation in regression form for Model B – which is overspecified for data generated by Model A, because it includes a parameter for <inline-formula><inline-graphic xlink:href="625193v4_inline23.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, which is really 0 – is therefore limited; the estimated coefficient for <italic>β</italic><sub>2</sub> is very close to 0.</p>
<p>The Generalized Price equation in regression form for Model A, in combination with the offspring generation generated by Model B, however, does not return values for <inline-formula><inline-graphic xlink:href="625193v4_inline24.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="625193v4_inline25.gif" mimetype="image" mime-subtype="gif"/></inline-formula> that are close to their true values. For <inline-formula><inline-graphic xlink:href="625193v4_inline26.gif" mimetype="image" mime-subtype="gif"/></inline-formula> that is obvious, because the statistical model specification sets it to 0, while <italic>β</italic><sub>1</sub> = 1. Moreover, <inline-formula><inline-graphic xlink:href="625193v4_inline27.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and this is also rather different from the true <italic>β</italic><sub>1</sub>, which is 0. These differences are the result of underspecification. What is important to note here, is that none of this keeps the Generalized Price equation in regression form for Model A from being an identity, also for data that are really generated by Model B. Being an identity therefore does not guarantee that the regression coefficients in it have a meaningful interpretation; in this case the <inline-formula><inline-graphic xlink:href="625193v4_inline28.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is <italic>not</italic> the linear effect of the <italic>p</italic>-score on fitness.</p>
<p>This also illustrates a general property of the Generalized Price equation. If the data are generated by the model that matches the model that we combine the Generalized Price equation with, then the <inline-formula><inline-graphic xlink:href="625193v4_inline29.gif" mimetype="image" mime-subtype="gif"/></inline-formula> that feature in the regression form are unbiased estimators of the true <italic>β</italic><sub>1</sub>,…, <italic>β</italic><sub><italic>R</italic></sub>. This is exemplified by panel a, where the Generalized Price equation for Model A is applied to an offspring generation that is really generated by Model A, and by panel d, where the Generalized Price equation for Model B is applied to an offspring generation that is really generated by Model B. If, on the other hand, the model that we combine the Generalized Price equation with is underspecified for the underlying model that generated the data – as it is in the panel b of <xref rid="fig1" ref-type="fig">Fig. 1</xref> – then the regression coefficients are not unbiased estimators of any parameter of the true model. As a symptom of this, if the offspring population is indeed generated by a richer model, then the expected values of the regression coefficients <inline-formula><inline-graphic xlink:href="625193v4_inline30.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (that is, what values for <inline-formula><inline-graphic xlink:href="625193v4_inline31.gif" mimetype="image" mime-subtype="gif"/></inline-formula> we will find, on average, if we repeatedly draw an offspring population according to the true model) will depend on the composition of the parent population. Again, none of this keeps the Generalized Price equation for Model A from being an identity, also when applied to data generated by Model B.</p>
<p>The regression form of the original Price equation coincides with the regression form of the Generalized Price equation, combined with the linear model for <italic>R</italic> = 1 (Price Equation A in <xref rid="fig1" ref-type="fig">Fig. 1</xref>). This implies that limitations of the latter are shared with the original Price equation.</p>
<p>In the Price equation literature, the fact that regression coefficients may not be constant is conflated with, and inadequately labelled as, dynamic insufficiency. We will return to this point after introducing the Generalized Price equation in combination with social traits, but it is worthwhile already here to stress that regression coefficients depending on the composition of the parent population is not a sign of dynamic insufficiency, but rather an indication of misspecification.</p>
</sec>
<sec id="s2c">
<title>The Generalized Price equation applied in a modeling context</title>
<p>The next example shows that the problem of misspecification is not limited to applications of the Generalized Price equation in a statistical setting. Misspecification is also possible when the Generalized Price equation is applied to a theoretical model. Section 5 in Appendix A describes the conditions under which one can in fact apply the Generalized Price equation in a modeling setting, so here we will assume that those conditions are satisfied; we assume an infinitely large population, error terms with expected value 0, and, if reproduction is sexual, fair meiosis.</p>
<p>In a modeling setting, it seems almost trivial that there is room for misspecification, if we apply the Generalized Price equation for one model to transitions that follow a different model. It will however be useful to acknowledge that this possibility exists. Below, we will therefore consider a linear model, <italic>w</italic><sub><italic>i</italic></sub> = <italic>α</italic> + <italic>β</italic><sub>1</sub><italic>p</italic><sub><italic>i</italic></sub> + <italic>ε</italic><sub><italic>i</italic></sub>, which we will again refer to as Model A, and a quadratic one, <italic>w</italic><sub><italic>i</italic></sub> = <italic>α</italic> + <italic>β</italic><sub>1</sub><italic>p</italic><sub><italic>i</italic></sub> + <italic>β</italic><sub>2</sub><italic>p</italic><sub><italic>i</italic></sub><sup>2</sup> + <italic>ε</italic><sub><italic>i</italic></sub>, which we will refer to as Model B. With infinite populations, such a model then implies that every parent population produces an offspring generation deterministically. If we minimize the squared differences in this transition, with respect to the model that generated the transition, we recover the coefficients of the model exactly (and not with some noise, as in the statistical example above). With two models to combine the Generalized Price equation with, and two models to apply these Price-like equations to, we again have four possible combinations.</p>
<p>As a preparation for moving on to generalizing Hamilton’s rule, I will also point to the rules for selection that the Price-like equations produce.</p>
<list list-type="order">
<list-item><p><italic>The Generalized Price equation for Model A applied to transitions following Model A</italic>.</p>
<p>The Generalized Price equation in regression form for Model A is
<disp-formula id="ueqn4">
<graphic xlink:href="625193v4_ueqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>If this equation is applied to a transition that does indeed follow Model A, then the <inline-formula><inline-graphic xlink:href="625193v4_inline32.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in this Price-like equation is equal to the model parameter <italic>β</italic><sub>1</sub>. Translating this equation into a criterion for when higher <italic>p</italic>-scores are selected for is straightforward: higher <italic>p</italic>-scores are selected for at all frequencies if and only if <inline-formula><inline-graphic xlink:href="625193v4_inline33.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. With transitions that are generated by Model A, this means that higher <italic>p</italic>-scores are selected for if and only if <italic>β</italic><sub>1</sub> &gt; 0.</p></list-item>
<list-item><p><italic>The Generalized Price equation for Model B applied to transitions following Model B</italic>.</p>
<p>The Generalized Price equation in regression form for Model B is
<disp-formula id="ueqn5">
<graphic xlink:href="625193v4_ueqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>If this equation is applied to a transition that does indeed follow Model B, <inline-formula><inline-graphic xlink:href="625193v4_inline34.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is equal to the model parameter <italic>β</italic><sub>1</sub>, and <inline-formula><inline-graphic xlink:href="625193v4_inline35.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is equal to the model parameter <italic>β</italic><sub>2</sub>. If we now translate this equation into a criterion for when higher <italic>p</italic>-scores are selected for, then this is still straightforward, but less concise:
<disp-formula id="ueqn6">
<graphic xlink:href="625193v4_ueqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>This can be used to describe, for instance, the population genetic dynamics for cases with heterozygote advantage (see Example 3.2 in Appendix A). This is a nice bycatch in the non-social domain of this endeavour, which was meant to solve a long-standing debate in the social domain. If we furthermore assume random mating between generations (see Section 5 of Appendix A), then this simplifies to
<disp-formula id="ueqn7">
<graphic xlink:href="625193v4_ueqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="625193v4_inline36.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the average <italic>p</italic>-score in the parent population. With transitions that are indeed generated by Model B, this means that higher <italic>p</italic>-scores are selected for if and only if <inline-formula><inline-graphic xlink:href="625193v4_inline37.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. The rule for the Generalized Price equation in regression form for Model A, applied to transitions that follow Model A, is nested in this rule here, in the sense that if we choose <italic>β</italic><sub>2</sub> = 0, this rule reverts to <italic>β</italic><sub>1</sub> &gt; 0.</p></list-item>
<list-item><p><italic>The Generalized Price equation for Model B applied to transitions following Model A</italic></p>
<p>The Generalized Price equation in regression form for Model B is still
<disp-formula id="ueqn8">
<graphic xlink:href="625193v4_ueqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>If this equation is applied to a transition that follows Model A, then <inline-formula><inline-graphic xlink:href="625193v4_inline38.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is equal to the model parameter <italic>β</italic><sub>1</sub>, and <inline-formula><inline-graphic xlink:href="625193v4_inline39.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is equal to the model parameter <italic>β</italic><sub>2</sub>, which is 0. The overspecification therefore is inconsequential; we end up with the same equation that we arrived at when we applied the Generalized Price equation in regression form for Model A to a transition that follows Model A.</p></list-item>
<list-item><p><italic>The Generalized Price equation for Model A applied to transitions following Model B</italic></p>
</list-item>
</list>
<p>The Generalized Price equation in regression form for Model A is still
<disp-formula id="ueqn9">
<graphic xlink:href="625193v4_ueqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>If applied to a transition that follows Model B, then this implies that <inline-formula><inline-graphic xlink:href="625193v4_inline40.gif" mimetype="image" mime-subtype="gif"/></inline-formula>.</p>
<p>What is important to realize, is that now <inline-formula><inline-graphic xlink:href="625193v4_inline41.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is no longer a constant, as it depends on the population state through the <inline-formula><inline-graphic xlink:href="625193v4_inline42.gif" mimetype="image" mime-subtype="gif"/></inline-formula>-term. Also, it would be wrong to interpret <inline-formula><inline-graphic xlink:href="625193v4_inline43.gif" mimetype="image" mime-subtype="gif"/></inline-formula> as the linear effect of the gene on fitness, because here <inline-formula><inline-graphic xlink:href="625193v4_inline44.gif" mimetype="image" mime-subtype="gif"/></inline-formula>.</p>
<p>If we translate this equation into a criterion for when higher <italic>p</italic>-scores are is selected for, then this would be the same rule as the one we arrived at when the Generalized Price equation in regression form for Model A was applied to Model A, which is that higher <italic>p</italic>-scores are selected for if <inline-formula><inline-graphic xlink:href="625193v4_inline45.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. This is still a rule, and it gets the direction of selection right, but the <inline-formula><inline-graphic xlink:href="625193v4_inline46.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in it does not have a meaningful interpretation anymore. The fact that the regression coefficient <inline-formula><inline-graphic xlink:href="625193v4_inline47.gif" mimetype="image" mime-subtype="gif"/></inline-formula> here changes with the population state moreover reflects misspecification, but now in a modeling context, and also here this does not reflect dynamic insufficiency.</p>
</sec>
<sec id="s2d">
<title>The general version of Hamilton’s rule</title>
<p>For the derivation of the general version of Hamilton’s rule, we need a richer setup, with two variables instead of one: a <italic>p</italic>-score and a <italic>q</italic>-score. The <italic>p</italic>-score represents a set of genes that code for some social behaviour, and the <italic>q</italic>-score of an individual represents the <italic>p</italic>-score of its interaction partner. We assume that both can take values in [0,1]. We will combine the Generalized Price equation in regression form with a general set of models for social traits. This requires some formal notation.</p>
<p>Here we choose a set of models, in which a model is defined by its non-zero coefficients. That is, a model is a choice for a set of non-zero coefficients <italic>E</italic>, where (<italic>k, l</italic>) ∈ <italic>E</italic> if the term <italic>p</italic><sub><italic>i</italic></sub><sup><italic>k</italic></sup><italic>q</italic><sub><italic>i</italic></sub><sup><italic>l</italic></sup> in the model has a non-zero coefficient <italic>β</italic><sub><italic>k,l</italic></sub>. This then defines a model as follows:
<disp-formula id="ueqn10">
<graphic xlink:href="625193v4_ueqn10.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>ε</italic><sub><italic>i</italic></sub> is a noise term with expected value 0. We assume that coefficients <italic>β</italic><sub>0,0</sub> and <italic>β</italic><sub>1,0</sub> are included, or, in other words, that the model contains a constant and a linear term for the <italic>p</italic>-score.</p>
<p>We can take any such model as a reference model for the Generalized Price equation in regression form. If we do, we find the following Price-like equation for the population genetic dynamics (see Section 4 of Appendix A for details).
<disp-formula id="ueqn11">
<graphic xlink:href="625193v4_ueqn11.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>If we define <italic>E</italic>′ as the set of non-zero coefficients of the model, besides the constant term and the linear term for the <italic>p</italic>-score, then the generalized version of Hamilton’s rule is that <inline-formula><inline-graphic xlink:href="625193v4_inline48.gif" mimetype="image" mime-subtype="gif"/></inline-formula> if and only if
<disp-formula id="ueqn12">
<graphic xlink:href="625193v4_ueqn12.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>c</italic> = −<italic>β</italic><sub>1,0</sub>, <italic>bk,l</italic> = <italic>β</italic><sub><italic>k,l</italic></sub>, and <inline-formula><inline-graphic xlink:href="625193v4_inline49.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, both for all (<italic>k, l</italic>) ∈ <italic>E</italic>′. The linear term for the <italic>p</italic>-score still features in this equation, because that is what <italic>c</italic> represents. Details are in Section 3 of Appendix B. In Section 5 of Appendix B this is generalized further to include interactions between more than two individuals.</p>
<p>The general version of Hamilton’s rule produces a set of rules; one for every model of how traits affect fitnesses. Less general models, that are nested in more general ones, come with rules that are nested in more general rules. This includes rules for non-social traits. We get the rules for non-social traits, if the set of model coefficients, besides a constant, only includes coefficients <italic>β</italic><sub><italic>k</italic>,0</sub>, and no coefficients for terms that relate to the <italic>q</italic>-score. The simplest such rule is the linear one that we have seen above, and that we get if the true model only contains a constant, and a term for the linear effect of the <italic>p</italic>-score. Above, we referred to this model as Model A. This rule is nested in the rule for the quadratic model, which has a constant, a term for the linear effect of the <italic>p</italic>-score, and a term for the quadratic effect of the <italic>p</italic>-score. We referred to this model as Model B above. This describes selection in case of, for instance, heterozygote advantage (see Appendix A, Sections 3 and 5). This rule, in turn, is nested in more general rules for selection of non-social traits that include coefficients <italic>β</italic><sub><italic>k</italic>,0</sub> for <italic>k</italic> &gt; 2.</p>
<p>If we then go back to the rule for non-social traits, but with linear fitness effects only, then this rule is also nested in the classical Hamilton’s rule. The classical Hamilton’s rule is the rule that we get for a model that includes a constant, a term for the linear effect of the <italic>p</italic>-score, and a term for the linear effect of the <italic>q</italic>-score. This rule, in turn, is nested in the rule that we get when an interaction effect between the <italic>p</italic>- and the <italic>q</italic>-score is added to the model. The classical Hamilton’s rule therefore is itself nested in what is best refered to as Queller’s rule<sup><xref ref-type="bibr" rid="c16">16</xref></sup>. These rules moreover allow for further nesting, if the model we are interested in is more general, or if the data suggest that the true model includes additional non-zero coefficients. Below, we will however restrict attention to these three nested models in order to illustrate how they produce three rules that are nested, and how using the generalized version of Hamilton’s rule allows us to see the debate on the generality of the classical Hamilton’s rule in a new light.</p>
</sec>
<sec id="s2e">
<title>Three models and three rules</title>
<p>In Model 1, the <italic>p</italic>-score relates to a non-social trait, that only affects the fitness of its carrier. We also referred to this model as Model A before, where we nested it in a different, also non-social, but more general model.
<disp-formula id="ueqn13">
<graphic xlink:href="625193v4_ueqn13.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>In Model 2, the <italic>p</italic>-score relates to a social trait, that affects the fitness of its carrier, and the fitness of the partner of its carrier. In the fitness function, this is reflected by the effect of the <italic>p</italic>-score of the partner (the <italic>q</italic>-score) on individual <italic>i</italic>. These effects are moreover assumed to be independent; the effect on the partner is the same, irrespective of the <italic>p</italic>-score of the partner.
<disp-formula id="ueqn14">
<graphic xlink:href="625193v4_ueqn14.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>In Model 3, the <italic>p</italic>-score also relates to a social trait, but now the effects are not assumed to be independent; the effect on the partner may depend on the <italic>p</italic>-score of the partner. This is reflected by the interaction term.
<disp-formula id="ueqn15">
<graphic xlink:href="625193v4_ueqn15.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<sec id="s2e1">
<title>Model 1: selection of a non-social trait</title>
<p>The Generalized Price equation in regression form for Model 1 is
<disp-formula id="ueqn16">
<graphic xlink:href="625193v4_ueqn16.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>The rule that this Price-like equation produces is that higher <italic>p</italic>-scores will be selected for if and only if <inline-formula><inline-graphic xlink:href="625193v4_inline50.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. This is also the rule that we found above, when we referred to Model 1 as Model A. If the model under consideration is indeed Model 1, then <inline-formula><inline-graphic xlink:href="625193v4_inline51.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, both in the Price-like equation, and in the rule for selection.</p>
</sec>
<sec id="s2e2">
<title>Model 2: selection of a linear social trait</title>
<p>The Generalized Price equation in regression form for Model 2 is
<disp-formula id="ueqn17">
<graphic xlink:href="625193v4_ueqn17.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>From this, we can see that <inline-formula><inline-graphic xlink:href="625193v4_inline52.gif" mimetype="image" mime-subtype="gif"/></inline-formula> if and only if <inline-formula><inline-graphic xlink:href="625193v4_inline53.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. If the model under consideration is indeed Model 2, then, with an infinitely large population, the regression coefficients <inline-formula><inline-graphic xlink:href="625193v4_inline54.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="625193v4_inline55.gif" mimetype="image" mime-subtype="gif"/></inline-formula> will coincide with the true values of the parameters <italic>β</italic><sub>1,0</sub> and <italic>β</italic><sub>0,1</sub>, respectively, and <inline-formula><inline-graphic xlink:href="625193v4_inline56.gif" mimetype="image" mime-subtype="gif"/></inline-formula> will coincide with relatedness <italic>r</italic> between the individuals that interact. If we then define <italic>c</italic> = −<italic>β</italic><sub>1,0</sub> and <italic>b</italic> = <italic>β</italic><sub>0,1</sub>, we can rewrite this as
<disp-formula id="ueqn18">
<graphic xlink:href="625193v4_ueqn18.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>Here we naturally recognize the classical Hamilton’s rule, because this implies that <inline-formula><inline-graphic xlink:href="625193v4_inline57.gif" mimetype="image" mime-subtype="gif"/></inline-formula> if and only if <italic>rb</italic> &gt; <italic>c</italic>.</p>
<p>At this point, it is useful to observe that if this is a social trait, and the true model is Model 2, but we combine it with the Generalized Price equation in regression form for Model 1, the latter still gets the direction of selection right. In that case, we would still use
<disp-formula id="ueqn19">
<graphic xlink:href="625193v4_ueqn19.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
but now with <inline-formula><inline-graphic xlink:href="625193v4_inline58.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. This however is typically not how we describe the evolution of social traits. The reason why we do not describe selection of a social trait with the rule for the non-social model is however <italic>not</italic> that this rule would get the direction of selection wrong; it would not. As a matter of fact, this rule always gets the direction of selection right too. The reason that here we use the classical version of Hamilton’s rule instead, is that the classical version of Hamilton’s rule reveals the actual population genetic dynamics that govern selection; with a social trait for which <italic>rb</italic> &gt; <italic>c</italic>, the reason why the genes for the trait are selected is not that the behaviour they induce is good for the fitness of the individual that carries these genes itself; the reason is that the fitness costs of the associated behaviour to the individual itself are outweighed by how much fitness benefits carriers get through related individuals, compared to how much such benefits non-carriers get. In a theory model, this is postulated. With data, and if the sample size is large enough, statistical tests would make the same determination, by pointing to Model 2, and not Model 1, as the true model, if it is in fact the true model.</p>
<p>At this point, we therefore have two Price-like equations: the one for Model 1 and the one for Model 2. Both of these Price-like equations are identities, and both of them are general. When applied to Model 2, however, the Price-like equation for Model 1 is not meaningful, in the sense that the regression coefficient <inline-formula><inline-graphic xlink:href="625193v4_inline59.gif" mimetype="image" mime-subtype="gif"/></inline-formula> does not reflect the effect of the behaviour on the individual itself. As a symptom of this, it is not a constant, and varies with the population state. The core point of the original derivation of Hamilton’s rule, using the original Price equation, therefore is to not use an underspecified model. It is useful to keep this in mind when we are faced with an analogous choice between Price-like equations, and between rules based on them, below.</p>
</sec>
<sec id="s2e3">
<title>Model 3: selection of a social trait with an interaction effect</title>
<p>The Generalized Price equation in regression form for the third model is
<disp-formula id="ueqn20">
<graphic xlink:href="625193v4_ueqn20.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>If the model under consideration is indeed Model 3, and we assume an infinite population, the regression coefficients <inline-formula><inline-graphic xlink:href="625193v4_inline60.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="625193v4_inline61.gif" mimetype="image" mime-subtype="gif"/></inline-formula> will coincide with the true values of the parameters <italic>β</italic><sub>1,0</sub>, <italic>β</italic><sub>0,1</sub>, and <italic>β</italic><sub>1,1</sub>, respectively. Also, in an infinite population model, <inline-formula><inline-graphic xlink:href="625193v4_inline62.gif" mimetype="image" mime-subtype="gif"/></inline-formula> will coincide with relatedness <italic>r</italic>, which we call <italic>r</italic><sub>0,1</sub> here, in order to distinguish it from <inline-formula><inline-graphic xlink:href="625193v4_inline63.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. The latter is what <inline-formula><inline-graphic xlink:href="625193v4_inline64.gif" mimetype="image" mime-subtype="gif"/></inline-formula> will be in an infinite population (see Appendix B). If we then define <italic>c</italic> = −<italic>β</italic><sub>1,0</sub>, <italic>b</italic><sub>0,1</sub> = <italic>β</italic><sub>0,1</sub>, and <italic>b</italic><sub>1,1</sub> = <italic>β</italic><sub>1,1</sub>, we can rewrite the Generalized Price equation in regression form for the third model as
<disp-formula id="ueqn21">
<graphic xlink:href="625193v4_ueqn21.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>This does not give us the classical Hamilton’s rule that we are familiar with. It does however give us a correct criterion for when higher <italic>p</italic>-scores are selected for; <inline-formula><inline-graphic xlink:href="625193v4_inline65.gif" mimetype="image" mime-subtype="gif"/></inline-formula> if and only if <italic>r</italic><sub>0,1</sub><italic>b</italic><sub>0,1</sub> + <italic>r</italic><sub>1,1</sub><italic>b</italic><sub>1,1</sub> &gt; <italic>c</italic>. This criterion features two benefits and two relatednesses; besides the classical, linear benefit <italic>b</italic>, which we call <italic>b</italic><sub>0,1</sub> here, it also has an interaction benefit <italic>b</italic><sub>1,1</sub>, that only fully materializes if both the individual itself and its partner have a <italic>p</italic>-score of 1. If <italic>b</italic><sub>1,1</sub> = 0, then we are back in Model 2, and this rule reverts to the classical Hamilton’s rule. The rule with a non-zero interaction effect is the same as the rule suggested by Queller<sup><xref ref-type="bibr" rid="c16">16</xref></sup>, if we assume that genotype and phenotype correlate perfectly (see also Section 2 of Appendix B).</p>
<p>We can, of course, still apply the Generalized Price equation in regression form for Model 1, or the Generalized Price equation for Model 2, to Model 3 in the same way that we can apply the Generalized Price equation for Model 1 to Model 2, as we did above. We do this in detail in Section 2 of Appendix B to make sure that there can be no misunderstanding concerning the details, and the results are shown in <xref rid="fig2" ref-type="fig">Figure 2</xref>. The important observation to make here is that both of these rules <italic>also</italic> get the direction of selection right. The argument for not using these rules for Model 3, even though they do get the direction of selection right, is identical to the argument for not using the rule for selection of non-social traits for social traits: the rule for non-social traits just does not describe the population genetic dynamics for a social trait accurately. This is why we use the conventional version of Hamilton’s rule when modelling social behaviour, and not the rule that we would get if we applied the Generalized Price equation in regression form for the non-social model (Model 1). The Price-like equation for the non-social model also gets the direction of selection right, but we know that this version is incomplete, precisely because it leaves out the true social effects we care about unveiling when we use the conventional Hamilton’s rule. For exactly analogous reasons, we should not rely on underspecified versions of the Price equation in other instances, including the case where the conventional Hamilton’s rule itself, in turn, is based on an underspecified Price-like equation.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig. 2.</label>
<caption><title>Three rules and three models.</title>
<p>This table gives all combinations of the three rules and the three models discussed in the example. All rules indicate the direction of selection correctly for all models. Yellow indicates a combination of a rule and a model, where the rule is more general than is needed for the model. This leads to one or more <italic>b</italic>’s being 0. These are relatively harmless overspecifications. Red indicates a combination of a rule and a model, where the rule is not general enough (underspecified) for the model. This leads to <italic>b</italic>’s and <italic>c</italic>’s that depend on the population state. Terms that depend on the population state are abbreviated as follows: <inline-formula><inline-graphic xlink:href="625193v4_inline76.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="625193v4_inline77.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (see Detailed Calculations B.3 at the end of the Appendices for calculations). Rule 1 is the standard rule for non-social evolution for linear non-social traits. Rule 2 is the classical Hamilton’s rule. Rule 3 is Queller’s rule<sup><xref ref-type="bibr" rid="c16">16</xref></sup>, which is a rule that allows for an interaction effect. Rule 1 is nested in Rule 2, which is nested in Rule 3, which can be nested in a more general rules as well.</p></caption>
<graphic xlink:href="625193v4_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>As a symptom of underspecification, if we apply the Generalized Price equation in regression form for Model 1 to Model 3, then the value for <inline-formula><inline-graphic xlink:href="625193v4_inline66.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is not a constant, and depends on the population state. Similarly, if we apply the Generalized Price equation for Model 2 to Model 3, then the values for <inline-formula><inline-graphic xlink:href="625193v4_inline67.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="625193v4_inline68.gif" mimetype="image" mime-subtype="gif"/></inline-formula> are not constants, and depend on the population state.</p>
<p>The part of the literature on Hamilton’s rule that has emphasized its full generality, has however insisted that we always use one and the same equation, even if it is underspecified, and incorporate more general models, such as Model 3, within the classical version of Hamilton’s rule<sup><xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c23">23</xref>,<xref ref-type="bibr" rid="c28">28</xref>,<xref ref-type="bibr" rid="c29">29</xref></sup>.</p>
<p>The relation between these examples can be summarized in a table that, for the three models and the three rules, represents all nine combinations of them (see <xref rid="fig2" ref-type="fig">Fig. 2</xref>). This matrix of combinations of models and rules also helps to understand what causes the contentiousness of the debate on the generality of Hamilton’s rule. Rule 2, which is the rule that we get from applying the standard Price equation (also known as using the regression method), is a completely general rule, in the sense that whatever the true model is, it always gets the direction of selection right. This is true, but that fact is not a good argument for singling this rule out as more helpful, meaningful, or insightful than other rules. In the example above, we have seen that if we apply the Generalized Price equation in regression form (which one could also describe as using the regression method, but now with a richer menu of alternative underlying statistical models) then this can also give us Rule 1 or Rule 3, depending on the statistical reference model we use. These rules are equally correct, in the sense that they also always get the direction of selection right. They are also equally general, in the sense that they also get it right for every possible model. Being a general rule, that always gets the direction of selection right, therefore, cannot be a criterion for elevating Rule 2 (which is the classical Hamilton’s rule), above the other ones, because Rules 1 and 3 are also general rules, that always get the direction of selection right.</p>
<p>Since being completely general and always getting the direction of selection right does not single out any of the possible rules, we need additional criteria. A natural criterion would be that besides being correct, the terms in the rule would have to be meaningful. More precisely, we think the rule should do what Rule 1 (the rule for evolution of non-social traits) does for Model 1, and what Rule 2 (the classical Hamilton’s rule) does for Model 2, and that is to separate model parameters from properties of the population state, in order to produce an equation that describes the population genetic dynamics. That is what Rule 3 does for Model 3. Ever more general models would moreover require ever more general rules to accurately capture the population dynamics.</p>
<p>The debate in the literature on the generality of Hamilton’s rule is so long-lasting because it mostly focuses on whether or not rules are correct, and not on whether the rules are (also) meaningful. One side of the debate tends to return to the argument that Rule 2 is general and correct<sup><xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c11">11</xref></sup>. The other side of the debate tends to return to models that do not fit Model 2<sup><xref ref-type="bibr" rid="c3">3</xref>–<xref ref-type="bibr" rid="c5">5</xref></sup>. Sometimes arguments on this side take a completely different approach, and rather than describing selection with the Price equation, and then worry about whether or not one can interpret regression coefficients in it as benefits and costs, they start with models with a priori interpretable definitions for <italic>b</italic> and <italic>c</italic>. This is called the counterfactual approach to defining costs and benefits<sup><xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>, as opposed to the regression approach, and because it has a different definition of the costs and benefits, it can result in rules that end up getting the direction of selection wrong<sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>.</p>
<p>Another recurrent point is that when regression coefficients in the Price equation are found to vary with the state of the parent population, this is often claimed to be the result of the Price equation being dynamically insufficient. In order to point out why that is inaccurate, we can first point to ways in which an underlying model <italic>can</italic> be dynamically insufficient. If we have a model that describes how the fitness of an individual depends on its <italic>p</italic>- and <italic>q</italic>-score, and we are given a parent population, then this model would produce the <italic>p</italic>-scores in the new generation. It would however not generate which individuals are partnered up with whom in the new generation, and therefore it would not identify who has which <italic>q</italic>-score in the new generation. In this case a full model would have to include more than just the fitness function, but in the absense of assumptions about the matching in the new generation, such a model would be dynamically insufficient. It is however important to notice that this is <italic>not</italic> the same as the regression coefficients <inline-formula><inline-graphic xlink:href="625193v4_inline69.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, depending on the population state, which is regularly also referred to as dynamical insufficiency. Describing this as dynamical insufficiency is incorrect, and the dependence on the population state is really a symptom of misspecification. Section 6 of Appendix A elaborates on this point in a more precise way<sup><xref ref-type="bibr" rid="c30">30</xref></sup>.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>The general version of Hamilton’s rule provides a positive resolution of a long-standing, heated debate. I derived the Generalized Price equation, which reconnects the Price equation with statistics, and allows us to base rules for selection properly on dynamical models for population genetics that offer the flexibility needed to accommodate a variety of ways in which fitness can depend on traits of individuals and their interaction partners.</p>
<p>While previous work focused on the limitations of the original Price equation<sup><xref ref-type="bibr" rid="c24">24</xref>,<xref ref-type="bibr" rid="c25">25</xref>,<xref ref-type="bibr" rid="c27">27</xref></sup>, and on limitations of the classical version of Hamilton’s rule, when there are interaction effects <sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c9">9</xref>,<xref ref-type="bibr" rid="c12">12</xref>–<xref ref-type="bibr" rid="c14">14</xref></sup>, the Generalized Price equation, and the general version of Hamilton’s rule that is derived with it, are constructive contributions that offer alternatives for a large variety of forms the fitness function can have. The insight that comes with it has major implications, also for empirical research on kin selection. It implies that whether or not Hamilton’s rule holds, is not a meaningful empirical question. As a field, we have nonetheless spent quite some time and energy on trying to answer this question<sup><xref ref-type="bibr" rid="c31">31</xref></sup>. Because the question turns out to be ill-posed, we can stop trying to answer it. The meaningful empirical question that we should focus on instead, is what form the fitness function has, and which version of Hamilton’s rule therefore applies to which social trait.</p>
</sec>

</body>
<back>
<sec id="suppd1e1774" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="d1e1765">
<label>Appendix A and B</label>
<media xlink:href="supplements/625193_file02.pdf"/>
</supplementary-material>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamilton</surname>, <given-names>W. D.</given-names></string-name></person-group> <article-title>The genetical evolution of social behaviour. I</article-title>. <source>J Theor Biol</source> <volume>7</volume>, <fpage>1</fpage>–<lpage>16</lpage> (<year>1964</year>).</mixed-citation></ref>
<ref id="c2"><label>2</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamilton</surname>, <given-names>W. D.</given-names></string-name></person-group> <article-title>The genetical evolution of social behaviour. II</article-title>. <source>J Theor Biol</source> <volume>7</volume>, <fpage>17</fpage>–<lpage>52</lpage> (<year>1964</year>).</mixed-citation></ref>
<ref id="c3"><label>3</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karlin</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Matessi</surname>, <given-names>C.</given-names></string-name></person-group> <article-title>The eleventh R. A. Fisher Memorial Lecture - Kin selection and altruism</article-title>. <source>Proc R Soc Lond B Biol Sci</source> <volume>219</volume>, <fpage>327</fpage>–<lpage>353</lpage> (<year>1983</year>).</mixed-citation></ref>
<ref id="c4"><label>4</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matessi</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Karlin</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>On the evolution of altruism by kin selection</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>81</volume>, <fpage>1754</fpage>–<lpage>1758</lpage> (<year>1984</year>).</mixed-citation></ref>
<ref id="c5"><label>5</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Group selection, kin selection, altruism and cooperation: When inclusive fitness is right and when it can be wrong</article-title>. <source>J Theor Biol</source> <volume>259</volume>, (<year>2009</year>).</mixed-citation></ref>
<ref id="c6"><label>6</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nowak</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Tarnita</surname>, <given-names>C. E.</given-names></string-name> &amp; <string-name><surname>Wilson</surname>, <given-names>E. O.</given-names></string-name></person-group> <article-title>The evolution of eusociality</article-title>. <source>Nature</source> <volume>466</volume>, <fpage>1057</fpage>–<lpage>1062</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c7"><label>7</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abbot</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Inclusive fitness theory and eusociality</article-title>. <source>Nature</source> <volume>471</volume>, <fpage>E1</fpage>–<lpage>E4</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c8"><label>8</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardner</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>West</surname>, <given-names>S. A.</given-names></string-name> &amp; <string-name><surname>Wild</surname>, <given-names>G.</given-names></string-name></person-group> <article-title>The genetical theory of kin selection</article-title>. <source>J Evol Biol</source> <volume>24</volume>, <fpage>1020</fpage>–<lpage>1043</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c9"><label>9</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Nowak</surname>, <given-names>M. A.</given-names></string-name> &amp; <string-name><surname>Wilson</surname>, <given-names>E. O.</given-names></string-name></person-group> <article-title>Limitations of inclusive fitness</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>110</volume>, <fpage>20135</fpage>–<lpage>20139</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c10"><label>10</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Marshall</surname>, <given-names>J. A. R.</given-names></string-name></person-group> <source>Social Evolution and Inclusive Fitness Theory: An Introduction</source>. (<publisher-name>Princeton University Press</publisher-name>, <year>2015</year>).</mixed-citation></ref>
<ref id="c11"><label>11</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rousset</surname>, <given-names>F.</given-names></string-name></person-group> <article-title>Regression, least squares, and the general version of inclusive fitness</article-title>. <source>Evolution (N Y)</source> <volume>69</volume>, <fpage>2963</fpage>–<lpage>2970</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c12"><label>12</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nowak</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>McAvoy</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Allen</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Wilson</surname>, <given-names>E. O.</given-names></string-name></person-group> <article-title>The general form of Hamilton’s rule makes no predictions and cannot be tested empirically</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>114</volume>, <fpage>5665</fpage>–<lpage>5670</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c13"><label>13</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Allen</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Hoffman</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Simon</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Veller</surname>, <given-names>C.</given-names></string-name></person-group> <article-title>Hamilton’s rule</article-title>. <source>J Theor Biol</source> <volume>414</volume>, (<year>2017</year>).</mixed-citation></ref>
<ref id="c14"><label>14</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Can Hamilton’s rule be violated?</article-title> <source>eLife</source> <volume>7</volume>, (<year>2018</year>).</mixed-citation></ref>
<ref id="c15"><label>15</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname>, <given-names>G. R.</given-names></string-name></person-group> <article-title>Selection and Covariance</article-title>. <source>Nature</source> <volume>227</volume>, <fpage>520</fpage>–<lpage>521</lpage> (<year>1970</year>).</mixed-citation></ref>
<ref id="c16"><label>16</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Queller</surname>, <given-names>D. C.</given-names></string-name></person-group> <article-title>Kinship, reciprocity and synergism in the evolution of social behaviour</article-title>. <source>Nature</source> <volume>318</volume>, <fpage>366</fpage>–<lpage>367</lpage> (<year>1985</year>).</mixed-citation></ref>
<ref id="c17"><label>17</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Hamilton’s missing link</article-title>. <source>J Theor Biol</source> <volume>246</volume>, (<year>2007</year>).</mixed-citation></ref>
<ref id="c18"><label>18</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamilton</surname>, <given-names>W. D.</given-names></string-name></person-group> <article-title>Selfish and Spiteful Behaviour in an Evolutionary Model</article-title>. <source>Nature</source> <volume>228</volume>, <fpage>1218</fpage>–<lpage>1220</lpage> (<year>1970</year>).</mixed-citation></ref>
<ref id="c19"><label>19</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Hamilton</surname>, <given-names>W. D.</given-names></string-name></person-group> <chapter-title>Innate social aptitudes of man: an approach from evolutionary genetics</chapter-title>. in <source>Narrow roads of gene land. Vol. 1: Evolution of social behaviour</source> (ed. <person-group person-group-type="editor"><string-name><surname>Fox</surname>, <given-names>R.</given-names></string-name></person-group>) <fpage>315</fpage>–<lpage>352</lpage> (<year>1975</year>).</mixed-citation></ref>
<ref id="c20"><label>20</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grafen</surname>, <given-names>A.</given-names></string-name></person-group> <article-title>A geometric view of relatedness</article-title>. <source>Oxford surveys in evolutionary biology</source> <volume>2</volume>, <fpage>28</fpage>–<lpage>89</lpage>. (<year>1985</year>).</mixed-citation></ref>
<ref id="c21"><label>21</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taylor</surname>, <given-names>P. D.</given-names></string-name></person-group> <article-title>Evolutionary stability in one-parameter models under weak selection</article-title>. <source>Theor Popul Biol</source> <volume>36</volume>, <fpage>125</fpage>–<lpage>143</lpage> (<year>1989</year>).</mixed-citation></ref>
<ref id="c22"><label>22</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taylor</surname>, <given-names>P. D.</given-names></string-name> &amp; <string-name><surname>Frank</surname>, <given-names>S. A.</given-names></string-name></person-group> <article-title>How to Make a Kin Selection Model</article-title>. <source>J Theor Biol</source> <volume>180</volume>, <fpage>27</fpage>–<lpage>37</lpage> (<year>1996</year>).</mixed-citation></ref>
<ref id="c23"><label>23</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grafen</surname>, <given-names>A.</given-names></string-name></person-group> <article-title>Optimization of inclusive fitness</article-title>. <source>J Theor Biol</source> <volume>238</volume>, <fpage>541</fpage>–<lpage>563</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c24"><label>24</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>On the use of the Price equation</article-title>. <source>J Theor Biol</source> <volume>237</volume>, (<year>2005</year>).</mixed-citation></ref>
<ref id="c25"><label>25</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>García</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Sabelis</surname>, <given-names>M. W.</given-names></string-name> &amp; <string-name><surname>Egas</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Group selection and inclusive fitness are not equivalent; the Price equation vs. models and statistics</article-title>. <source>J Theor Biol</source> <volume>299</volume>, (<year>2012</year>).</mixed-citation></ref>
<ref id="c26"><label>26</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frank</surname>, <given-names>S. A.</given-names></string-name></person-group> <article-title>Natural selection. IV. The Price equation*</article-title>. <source>J Evol Biol</source> <volume>25</volume>, <fpage>1002</fpage>–<lpage>1019</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c27"><label>27</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>The problem with the Price equation</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>375</volume>, <fpage>20190355</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c28"><label>28</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Queller</surname>, <given-names>D. C.</given-names></string-name></person-group> <article-title>A general model for kin selection</article-title>. <source>Evolution (N Y)</source> <volume>46</volume>, <fpage>376</fpage>–<lpage>380</lpage> (<year>1992</year>).</mixed-citation></ref>
<ref id="c29"><label>29</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grafen</surname>, <given-names>A.</given-names></string-name></person-group> <article-title>News and Views. Evolutionary theory: Hamilton’s rule OK</article-title>. <source>Nature</source> <volume>318</volume>, <fpage>310</fpage>–<lpage>311</lpage> (<year>1985</year>).</mixed-citation></ref>
<ref id="c30"><label>30</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Fisher’s fundamental theorem of natural selection, dynamic sufficiency, and the necessity of higher moments</article-title>. <source>J Theor Biol</source> <volume>437</volume>, (<year>2018</year>).</mixed-citation></ref>
<ref id="c31"><label>31</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bourke</surname>, <given-names>A. F. G.</given-names></string-name></person-group> <article-title>Hamilton’s rule and the causes of social evolution</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>369</volume>, <fpage>20130362</fpage> (<year>2014</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105065.2.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Rainey</surname>
<given-names>Paul B</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Evolutionary Biology</institution>
</institution-wrap>
<city>Plön</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Compelling</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Landmark</kwd>
</kwd-group>
</front-stub>
<body>
<p>Kin selection and inclusive fitness have generated significant controversy. This paper reconsiders the general form of Hamilton's rule in which benefits and costs are defined as regression coefficients, with higher-order coefficients being added to accommodate non-linear interactions. The paper is a <bold>landmark</bold> contribution to the field with <bold>compelling</bold>, systematic analysis, giving clarity to long-standing debates.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105065.2.sa1</article-id>
<title-group>
<article-title>Joint Public Review:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This manuscript reconsiders the &quot;general form&quot; of Hamilton's rule, in which &quot;benefit&quot; and &quot;cost&quot; are defined as regression coefficients. It points out that there is no reason to insist on Hamilton's rule of the form -c+br&gt;0, and that, in fact, arbitrarily many terms (i.e. higher-order regression coefficients) can be added to Hamilton's rule to reflect nonlinear interactions. Furthermore, it argues that insisting on a rule of the form -c+br&gt;0 can result in conditions that are true but meaningless and that statistical considerations should be employed to determine which form of Hamilton's rule is meaningful for a given dataset or model.</p>
<p>Comments on latest version:</p>
<p>The authors have provided a robust, valuable and detailed response to the previous reviews.</p>
<p>Comments from Reviewer #1: I have nothing further to add.</p>
<p>Comments from Reviewer #2: I appreciate the clarifications the author has made to the manuscript regarding (i) &quot;sample covariance&quot; terminology, (ii) the generality of the &quot;generalized Price equation&quot;, and (iii) the distinction between the covariance and regression forms of the Price equation. I also appreciate that the ms now engages more deeply with some of the previous literature on regression-based Hamilton's rules (e.g. Smith et al., 2010; Rousset 2015). I feel these revisions make this contribution more valuable, and also more technically sound, since the term &quot;sample covariance&quot; is no longer used incorrectly.</p>
<p>I also add that I agree with the substance of the authors' response to Reviewer #3. That is, the original submission was very clear that the regression-based Hamilton's rule is already completely general in the range of situations to which it applies, and that the added &quot;generality&quot; in the present ms refers to the variety of regression models that can be applied to these situations. In this way, the original ms already anticipates and addresses the criticism that Reviewer #3 raises.</p>
<p>Reviewer #3 did not provide comments on the revised version.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105065.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>van Veelen</surname>
<given-names>Matthijs</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8290-9212</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Public review):</bold></p>
<p>Summary:</p>
<p>There has been intense controversy over the generality of Hamilton's inclusive fitness rule for how evolution works on social behaviors. All generally agree that relatedness can be a game changer, for example allowing for otherwise unselectable altruistic behaviors when 𝑐 &lt; 𝑟𝑏, where 𝑐 is the fitness cost to the altruism, 𝑏 is the fitness benefit to another, and 𝑟 their relatedness. Many complications have been successfully incorporated into the theory, including different reproductive values and viscous population structures.</p>
</disp-quote>
<p>I agree, especially if by incorporating viscous population structures, the reviewer means the discovery of the cancellation effect (Wilson, Pollock, and Dugatkin, 1992, Taylor, 1992).</p>
<disp-quote content-type="editor-comment">
<p>The controversy has centered on another dimension; Hamilton's original model was for additive fitness, but how does his result hold when fitnesses are non-additive? One approach has been not to worry about a general result but just find results for particular cases. A consistent finding is that the results depend on the frequency of the social allele - nonadditivity causes frequency dependence that was absent in Hamilton's approach.</p>
</disp-quote>
<p>Just to be extra precise: Hamilton’s (1964) original model did not use the Price equation nor the regression approach to define costs and benefits, and it did indeed simply presuppose fixed, additive fitness effects.</p>
<p>Also for extra precision on terminology: many researchers will describe all fitnesses in social evolution as frequency dependent. The reason they do, is that with or without additivity, both the fitness of cooperators (with the social allele) and the fitness of defectors (without the social alle) typically increase in the frequency of cooperators in the population; the more cooperators there are, the more individuals run into them, which increases average fitness. The result depending on the frequency I take to mean that which of those two fitnesses is larger flips at a certain frequency, which automatically implies that the difference between them is depending on the frequency of the social allele. This is indeed the result of non-additivity. We will return to this in more detail in the response to Reviewer #3. Also at the end of Appendix B I have added a bit to be extra precise regarding frequency dependence.</p>
<disp-quote content-type="editor-comment">
<p>Two other approaches derive from Queller via the Price equation. Queller 1 is to find forms like Hamilton's rule, but with additional terms that deal with non-additive interaction, each with an r-like population structure variable multiplied by a b-like fitness effect (Queller, 1985). Queller 2 redefines the fitness effects c and b as partial regressions of the actor's and recipient's genes on fitness. This leaves Hamilton's rule intact, just with new definitions of c and b that depend on frequency (Queller, 1992a).</p>
<p>Queller 2 is the version that has been most adopted by the inclusive fitness community along with assertions that Hamilton's rule in completely general. In this paper, van Veelen argues that Queller 1 is the correct approach. He derives a general form that Queller only hinted at. He does so within a more rigorous framework that puts both Price's equation and Hamilton's rule on firmer statistical ground. Within that framework, the Queller 2 approach is seen to be a statistical misspecification - it employs a model without interaction in cases that actually do have interaction. If we accept that this is a fatal flaw, the original version of Hamilton's rule is limited to linear fitness models, which might not be common.</p>
</disp-quote>
<p>I totally agree.</p>
<disp-quote content-type="editor-comment">
<p>Strengths:</p>
<p>While the approach is not entirely new, this paper provides a more rigorous approach and a more general result. It shows that both Queller 1 and Queller 2 are identities and give accurate results, because both are derived from the Price equation, which is an identity. So why prefer Queller 1? It identifies the misspecification issue with the Queller 2 approach and points out its consequences. For example, it will not give the minimum squared differences between the model and data. It does not separate the behavioral effects of the individuals from the population state (𝑏 and 𝑐 become dependent on 𝑟 and the population frequency).</p>
</disp-quote>
<p>Just to be precise on a detail: in the data domain, as long as the number of parameters in a statistical model is lower than the number of data points, adding parameters typically (generically) lowers the sum of squared errors. That is to say, for an underspecified statistical model, the sum of squared errors goes down if a parameter is added, but for an already overspecified statistical model, the same is still true (although, typically, by how much the sum of squared errors is reduced will differ). The model specification task for a statistician includes knowing when to keep adding parameters, because the data suggest that the model is still underspecified, and when to stop adding parameters, because the model is well-specified, even if adding parameters still reduces the sum of squared errors.</p>
<p>In a modeling context, on the other hand, one can say that sum of squared differences will stop decreasing at the point where the statistical model is well-specified, that is: when it matches the model we are considering.</p>
<disp-quote content-type="editor-comment">
<p>The paper also shows how the same problems can apply to non-social traits. Epistasis is the non-additivity of effects of two genes within the individual. (So one wonders why have we not had a similarly fierce controversy over how we should treat epistasis?)</p>
<p>The paper is clearly written. Though somewhat repetitive, particularly in the long supplement, most of that repetition has the purpose of underscoring how the same points apply equally to a variety of different models.</p>
<p>Finally, this may be a big step towards reconciliation in the inclusive fitness wars. Van Veelen has been one of the harshest critics of inclusive fitness, and now he is proposing a version of it.</p>
</disp-quote>
<p>I am very happy to hear this, because I am indeed hopeful for reconciliation. I would like to add a comment, though. The debate on Hamilton’s rule/inclusive fitness is regularly thought of as a battle between two partizan camps, where both sides care at least as much about winning as they do about getting things right. This is totally understandable, because to some degree that is true. Also, I agree that it is fair to position me in the camp that is critical of the inclusive fitness literature. However, I would like to think that I have not been taking random shots at Hamilton’s rule. I have pointed to problems with the typical use of the Price equation and Hamilton’s rule, and I think I did for very good reasons. I am obviously very happy that finding the Generalized Price equation, and the general version of Hamilton’s rule, allowed me to go beyond this, and (finally) offer a correct alternative, and I totally appreciate that this opens the door for reconciliation, as this reviewer points out. But I would not describe this as a road-toDamascus moment. In order to illustrate the continuity in my work, I would like to point to three papers.</p>
<p>In van Veelen (2007), I pointed to the missing link between the central result in Hamilton’s (1964) famous paper (which states that selection dynamics take the population to a state where mean inclusive fitness is maximized), and Hamilton’s actual rule (which states that selection will lead to individuals maximizing their individual inclusive fitness). My repair stated the additional assumptions that were necessary to make the latter follow from the former. I would say that this can hardly be characterized as an attack on Hamilton’s rule. Reading Hamilton (1964) with enough care to notice something is missing, and then repairing it, I think is a sign of respect, and not an attack.</p>
<p>Van Veelen (2011) is about the replicator dynamics for n-player games, with the possibility of assortment. This puts the paper in a domain that does not assume weak selection, and that is typically not much oriented towards inclusive fitness. I included a theorem that implies that, under the condition of linearity, inclusive fitness not only gets the direction of selection right, but 𝑟𝑏 − 𝑐 becomes a parameter that also determines the speed of selection. This I think is representative, in the sense that in many of my papers, I carefully stake out when the classic version of Hamilton’s rule does work.</p>
<p>In Akdeniz and van Veelen (2020), we moreover take a totally standard inclusive fitness approach in a model of the cancellation effect at the group level.</p>
<p>I would say that this does not line up with the image of a harsh critic that takes random shots at Hamilton’s rule or inclusive fitness.</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses:</p>
<p>van Veelen argues that the field essentially abandoned the Queller 1 approach after its publication. I think this is putting it too strongly - there have been a number of theoretical studies that incorporate extra terms with higher-order relatednesses. It is probably accurate to say that there has been relative neglect. But perhaps this is partly due to a perception that this approach is difficult to apply.</p>
</disp-quote>
<p>I can imagine that the perceived difficulty in application may have played a role in the neglect of the Queller 1 approach. What for sure has played a role, and I would think a much bigger one, is that the literature has been pretty outspoken that the Queller 1 approach is the wrong way to go. The main text cites a number of papers that hold this position very emphatically (The first one of those was a News and Views by Alan Grafen (1985) that accompanied the paper in which Queller presented his Queller 1 approach. I am very happy that Appendix B shows on how many levels this News and Views was wrong.). There is only a handful of papers that follow the Queller 1 example.</p>
<disp-quote content-type="editor-comment">
<p>The model in this paper is quite elegant and helps clarify conceptual issues, but I wonder how practical it will turn out to be. In terms of modeling complicated cases, I suspect most practitioners will continue doing what they have been doing, for example using population genetics or adaptive dynamics, without worrying about neatly separating out a series of terms multiplying fitness coefficients and population structure coefficients.</p>
</disp-quote>
<p>I am not sure if I see what the reviewer envisions practitioners that use population genetics will keep on doing. I would think that the Generalized Price equation in regression form is a description of population genetic dynamics, and therefore, if practitioners will not make an effort to “neatly separate out a series of terms multiplying fitness coefficients and population structure coefficients”, then all I can say is that they should. I cannot do more than explain why, if they do not, they are at risk of mischaracterizing what gets selected and why.</p>
<p>Regarding those that use adaptive dynamics, I would say that this is a whole different approach. Within this approach, one can also apply inclusive fitness; see Section 6 and Appendix D of van Veelen et al. (2017). Appendix D is full of deep technical results and was done by Benjamin Allen.</p>
<disp-quote content-type="editor-comment">
<p>For empirical studies, it is going to be hard to even try to estimate all those additional parameters. In reality, even the standard Hamilton's rule is rarely tested by trying to estimate all its parameters. Instead, it is commonly tested more indirectly, for example by comparative tests of the importance of relatedness. That of course would not distinguish between additive and non-additive models that both depend on relatedness, but it does test the core idea of kin selection. It will be interesting to see if van Veelen's approach stimulates new ways of exploring the real world.</p>
</disp-quote>
<p>Regarding the impact on empirical studies, there are a few things that I would like to say. The first is that I would just like to repeat, maybe a bit more elaborately, what I wrote at the end of the main text. Given that the generalized version of Hamilton’s rule produces a host of Hamilton-like rules, and given the fact that all of them by construction indicate the direction of selection accurately, the question whether or not Hamilton’s rule holds turns out to be illposed. That means that we can stop doing empirical tests of Hamilton’s rule, which are predicated on the idea that Hamilton’s rule, with benefits and costs being determined by the regression method, could be violated – which it cannot (Side note: it is possible to violate Hamilton’s rule, if costs and benefits are defined according to the counterfactual method; see van Veelen et al. (2017) and van Veelen (2018). This way of defining costs and benefits is less common, although there are authors that find this definition natural enough to assume that this is the way in which everybody defines costs and benefits (Karlin and Matessi, 1983, Matessi and Karlin, 1984).). Instead, we should do empirical studies to find out which version of Hamilton’s rule applies to which behaviour in which species.</p>
<p>would like to not understate what a step forward this is. The size of the step forwards is of course also due to the dismal point of departure. As theorists, we have failed our empiricists, because all 12 studies included in the review by Bourke (2014) of papers that explicitly test Hamilton’s rule are based on the misguided idea that the traditional Hamilton’s rule, with costs and benefits defined according to the regression method, can be violated. While the field does sometimes have disdain for mathematical nit-picking, this is a point where a little more attention to detail would have really helped. If the hypothesis is that Hamilton’s rule holds, and the null is that it does not, then trying to specify how the empirical quantity that reflects inclusive fitness would be distributed under the null hypothesis (in order to do the right statistical tests) would have forced researchers to do something with the information that this quantity is not distributed at all, because Hamilton’s rule is general (in the sense that it holds for any way in which the world works). If one would prefer to reverse the null and the alternative hypothesis, one would run into similar problems. Understanding that the question is ill-posed therefore is a big step forwards from the terrible state of statistics and the waste of research time, attention and money on the empirical side of this field (see also Section 8 of van Veelen et al., 2017).</p>
<p>I would agree that doing comparative statics may not be much affected by this. Section 5 of van Veelen et al. (2017) indicates that there can be a large set of circumstances under which the general idea “relatedness up → cooperation up” still applies. But that may be a bit unambitious, and Section 8 of van Veelen et al. (2017), and the final section of van Veelen (2018) contain some reflections on empirical testing that may allow us to go beyond that. As long as there is change happening in the Generalized Price equation, the population is not in equilibrium. For empirical tests, one can either aim to capture selection as it happens, or assume that what we observe reflects properties of an equilibrium. This leads to interesting reflections on how to do empirics, which may differ between traits that are continuous and traits that are discrete (again: see van Veelen et al. (2017), and van Veelen (2018).</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public review):</bold></p>
<p>Summary:</p>
<p>This manuscript reconsiders the &quot;general form&quot; of Hamilton's rule, in which &quot;benefit&quot; and &quot;cost&quot; are defined as regression coefficients. It points out that there is no reason to insist on Hamilton's rule of the form −𝑐 + 𝑏𝑟 &gt; 0, and that, in fact, arbitrarily many terms (i.e. higherorder regression coefficients) can be added to Hamilton's rule to reflect nonlinear interactions. Furthermore, it argues that insisting on a rule of the form −𝑐 + 𝑏𝑟 &gt; 0 can result in conditions that are true but meaningless and that statistical considerations should be employed to determine which form of Hamilton's rule is meaningful for a given dataset or model.</p>
</disp-quote>
<p>Totally right. I cannot help to want to be extra precise, though, by distinguishing between the data domain and the modelling domain. In the data domain, statistical considerations apply in order to avoid misspecification. In this domain, avoiding misspecification can be complicated, because we do not know the underlying data generating process, and we depend on noisy data to make a best guess. In the modeling domain, however, there is no excuse for misspecification, as the model is postulated by the modeler. I therefore would think that in this domain, it does not really require “statistical considerations” to minimize the probability of misspecification; we can get the probability of misspecification all the way down to 0 by just choosing not to do it.</p>
<disp-quote content-type="editor-comment">
<p>Strengths:</p>
<p>The point is an important one. While it is not entirely novel-the idea of adding extra terms to Hamilton's rule has arisen sporadically (Queller, 1985, 2011; Fletcher et al., 2006; van Veelen et al., 2017)--it is very useful to have a systematic treatment of this point. I think the manuscript can make an important contribution by helping to clarify a number of debates in the literature. I particularly appreciate the heterozygote advantage example in the SI.</p>
</disp-quote>
<p>Me too, and I really hope the readers make it this far! I have thought of putting it in the main text, but did not know where that would fit.</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses:</p>
<p>Although the mathematical analysis is rigorously done and I largely agree with the conclusions, I feel there are some issues regarding terminology, some regarding the state of the field, and the practice of statistics that need to be clarified if the manuscript is truly to resolve the outstanding issues of the field. Otherwise, I worry that it will in some ways add to the confusion.</p>
<p>(1) The &quot;generalized&quot; Price equation: I agree that the equations labeled (PE.C) and (GPE.C) are different in a subtle yet meaningful way. But I do not see any way in which (GPE.C) is more general than (PE.C). That is, I cannot envision any circumstance in which (GPE.C) applies but (PE.C) does not. A term other than &quot;generalized&quot; should be used.</p>
</disp-quote>
<p>This is a great point! Just to make sure that those that read the reports online understand this point, let me add some detail. The equation labeled (PE.C) – which is short for Price equation in covariance form – is</p>
<disp-formula id="sa2equ1">
<graphic mime-subtype="jpg" xlink:href="elife-105065-sa2-equ1.jpg" mimetype="image"/>
</disp-formula>
<p>The derivation in Appendix A then assumes that we have a statistical model that includes a constant and a linear term for the p-score. It then defines the model-estimated fitness of individual 𝑖 as <inline-formula id="sa2equ2"><inline-graphic xlink:href="elife-105065-sa2-equ2.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, where 𝑤<sub> 𝑖</sub> is the realized number of offspring of individual 𝑖, and 𝜀<sub> 𝑖</sub> is the error term – and it is the sum over all individuals of this error term-squared that is minimized. The vector of model-estimated fitnesses <inline-formula id="sa2equ3"><inline-graphic xlink:href="elife-105065-sa2-equ3.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> will typically be different for different choices of the statistical model. Appendix A then goes on to show that, whatever the statistical model is that is used, for all of them <inline-formula id="sa2equ4"><inline-graphic xlink:href="elife-105065-sa2-equ4.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, as long as the statistical model includes a constant and a linear term for the p-score. That means that we can rewrite (PE.C) as</p>
<disp-formula id="sa2equ5">
<graphic mime-subtype="jpg" xlink:href="elife-105065-sa2-equ5.jpg" mimetype="image"/>
</disp-formula>
<p>The point that the reviewer is making, is that this is not really a generalization. For a given dataset (or, more generally, for a given population transition, whether empirical or in a model), <inline-formula id="sa2equ6"><inline-graphic xlink:href="elife-105065-sa2-equ6.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> is just a number, and it happens to be the case that 𝐶𝑜𝑣(𝑤:, 𝑝) returns the same number, whatever statistical model we use for determining what the model-estimated fitnesses 𝑤<sub> 𝑖</sub> are (as long as the statistical model includes a constant and a linear term for the p-score). In other words, (PE.C) is not really nested in (GPE.C), so (GPE.C) is not a proper generalization of (PE.C).</p>
<p>This is a totally correct point, and I had actually struggled a bit with the question what terminology to use here. Equation (GPE.C) is definitely general, in the sense that we can change the statistical model, and thereby change the vector of model-estimated fitnesses <inline-formula id="sa2equ7"><inline-graphic xlink:href="elife-105065-sa2-equ7.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, but as long as we keep the constant and the linear term in the statistical model, the equation still applies. But it is not a generalization of (PE.C).</p>
<p>I do however have a hard time coming up with a better label. The General Price equation may be a bit better, but it still suggests generalization. The Statistical Model-based Price equation does not suggest or imply generalization, but it does not convey how general it is, and it suggests that it could be an alternative to the normal Price equation that one may or may not choose to use – while this version really is the one we should use. It may moreover create the impression that this is only for doing statistics, and one might use the traditional Price equation for anything that is not statistics. I cannot really think of other good alternatives, but I am of course open to suggestions.</p>
<p>So, by lack of a better label, I called this the Generalized Price equation in covariance form. Though clearly imperfect, there are still a few good things about this label. The first is that, as mentioned above, this equation is general, in the sense that it holds, regardless of the statistical model. The second reason is that this is Step 1 in a sequence of three steps., the other two of which do produce proper generalizations. Step 2 goes from this equation in covariance form to the Generalized Price Equation in regression form, which is a proper generalization of the traditional Price equation in regression form. Step 3 goes from the Generalized Price Equation in regression form to the general version of Hamilton’s rule, which is also a proper generalization of the classical Hamilton’s rule. Since I would suggest that Step 1 on its own is kind of useless, and therefore Step 1 and Step 2 will typically come as a package, I would be tempted to think that this justifies the abuse of terminology for the Price Equation in covariance form. I did however add the observation made by the reviewer at the point where the Generalized Price equation (in both forms) is derived, so I hope this at least partly addresses this concern.</p>
<disp-quote content-type="editor-comment">
<p>(2) Regression vs covariance forms of the Price equation: I think the author uses &quot;generalized&quot; in reference to what Price called the &quot;regression form&quot; of his equation. But to almost everyone in the field, the &quot;Price Equation&quot; refers to the covariance form. For this reason, it is very confusing when the manuscript refers to the regression form as simply &quot;the Price Equation&quot;.</p>
<p>As an example, in the box on p. 15, the manuscript states &quot;The Price equation can be generalized, in the sense that one can write a variety of Price-like equations for a variety of possible true models, that may have generated the data.&quot; But it is not the Price equation (covariance form) that is being generalized here. It is only the regression that Price used that is being generalized.</p>
<p>To be consistent with the field, I suggest the term &quot;Price Equation&quot; be used only to refer to the covariance form unless it is otherwise specified as in &quot;regression form of the Price equation&quot;.</p>
</disp-quote>
<p>I am not sure about the level of confusion induced here, but I totally see that it can be helpful to avoid all ambiguity. I therefore went over everything, and whenever I wrote “Price equation”, I tried to make sure it comes either with “in covariance form” or with “in regression form”. At some places, it is a bit over the top to keep repeating “in regression form”, when it is abundantly clear which form is being discussed. Also, I added no qualifiers if a statement is true for both forms of the Price equation, or if the claim refers to the whole package of going through Step 1 and Step 2 mentioned above.</p>
<disp-quote content-type="editor-comment">
<p>(3) Sample covariance: The author refers to the covariance in the Price equation as “sample covariance”. This is not correct, since sample covariance has a denominator of N-1 rather than N (Bessel’s correction). The correct term, when summing over an entire population, is “population covariance”. Price (1972) was clear about this: “In this paper we will be concerned with population functions and make no use of sample functions”. This point is elaborated on by Frank (2012), in the subsection “Interpretation of Covariance”.</p>
</disp-quote>
<p>I totally agree. See page 418 of van Veelen (2005</p>
<p>The reviewer also quotes Price (1972), page 485:</p>
<p>“In this paper we will be concerned with population functions and make no use of sample functions”.</p>
<p>Below, the reviewer will return to the issue of distinguishing between the sample covariance with Bessel’s correction, and the sample covariance without Bessel’s correction, where the latter is regularly also referred to as the population covariance. A natural interpretation of the quote from Price (1972), if we read a bit around this quote in the paper, is that the difference between his “population functions” and his “sample functions” is indeed Bessel’s correction.</p>
<p>The reviewer also states that Frank (2012) elaborates on this in the subsection “Interpretation of Covariance”. What is interesting, though, is that, when Frank (2012) writes, on page 1017 “It is important to distinguish between population measures and sample measures”, the difference between those is not that one does, and the other does not include Bessel’s correction. The difference between “population measures” and “sample measures” in Frank (2012), page 1017, is that “In many statistical applications, one only has data on a subset of the full population, that subset forming a sample.”</p>
<p>The distinction between a population covariance and a sample covariance in Frank (2012) therefore is that they are “covariances” of different things (where the word covariances is in quotation marks, because, again, they are not really covariances). Besides just making sure that Price (1972) and Frank (2012) are not using these terms in the same way, this also perfectly illustrates the mix-up between statistical populations (or data generating processes) and biological populations that I discuss on pages 8 and 9 of Appendix A. I will return to this below, when I explain why I want to avoid using the word “population covariance” for the sample covariance without Bessel’s correction.</p>
<p>Of course, the difference is negligible when the population is large. However, the author applies the covariance formula to populations as small as 𝑁 = 2, for which the correction factor is significant.</p>
<p>Absolutely right.</p>
<disp-quote content-type="editor-comment">
<p>The author objects to using the term &quot;population covariance&quot; (SI, pp. 8-9) on the grounds that it might be misleading if the covariance, regression coefficients, etc. are used for inference because in this case, what is being inferred is not a population statistic but an underlying relationship. However, I am not convinced that statistical inference is or should be the primary use of the Price equation (see next point). At any rate, avoiding potential confusion is not a sufficient reason to use incorrect terminology.</p>
</disp-quote>
<p>There are a few related, but separate issues. One is what to call the 𝐶𝑜𝑣(𝑤, 𝑝)-term. Another, somewhat broader, is to avoid mixing up statistical populations and biological populations. A third is what the primary use of the Price equation is. The third issue I will respond to below, where it reappears. Here I will focus on the first two, which can be discussed without addressing the third.</p>
<p>In a data context, I now call the 𝐶𝑜𝑣(𝑤, 𝑝)-term “<inline-formula id="sa2equ8"><inline-graphic xlink:href="elife-105065-sa2-equ8.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>’&quot; times the sample covariance, or, in other words, the sample covariance without Bessel’s correction”. This should be unambiguous. In a modeling context I refer to 𝐶𝑜𝑣(𝑤, 𝑝)-term as “the 𝐶𝑜𝑣(𝑤, 𝑝)-term” and describe it as a summary statistic or a notational convention. There are two reasons for this choice.</p>
<p>The first is that neither of these use the word “population”. I like this, because there is a persistent scope for confusion between statistical populations and biological populations (as exemplified by Frank, 2012). This leads to an incorrect, but widespread intuition that if we “know the entire (biological) population” in a data context, there is nothing that can be estimated. This is what pages 8 and 9 of Appendix A are all about.</p>
<p>The second reason is that by using two labels, I also differentiate between the data context and the modeling context. This is important for reasons I will return to later.</p>
<disp-quote content-type="editor-comment">
<p>Relatedly, I suggest avoiding using 𝐸 for the second term in the Price equation, since (as the ms points out), it is not the expectation of any random variable. It is a population mean. There is no reason not to use something like Avg or bar notation to indicate population mean. Price (1972) uses &quot;ave&quot; for average.</p>
</disp-quote>
<p>I totally agree that the second term in the Price equation is not an expectation. I made this point in van Veelen (2005), and I repeated this in the manuscript. This remark by the reviewer prompted me to spell this out a bit more emphatically in Appendix A. That still leaves me with the choice what notation to use.</p>
<p>I therefore looked up all contributions to the Theme issue “Fifty years of the Price equation” in the Philosophical Transactions of the Royal Society B, and found that almost all contributions use 𝐸, sometimes saying that this refers to an expectation or an average. Of course, this is wrong. However (and this is another argument), it is equally wrong as using 𝐶𝑜𝑣 or 𝑉𝑎𝑟. The terms abbreviated as 𝐶𝑜𝑣 and 𝑉𝑎𝑟 are equally much not a covariance and a variance as the term abbreviated as 𝐸 is not an expectation. So I would think that there are a few reasons for sticking with 𝐸 here; 1) consistency with the literature; 2) consistency with the treatment of other terms; and 3) the fact that this term is not really of any importance in this manuscript. I do however totally understand the reviewer’s reasons, which I suppose include that for using 𝐸, there are relatively unproblematic alternatives (ave or upper bar) that are not available for the other terms. I hope therefore that being a bit more emphatic in the manuscript about 𝐸 not being an expectation at least partly addresses this concern.</p>
<disp-quote content-type="editor-comment">
<p>I should add, however, that the distinction between population statistics vs sample statistics goes away for regression coefficients (e.g. b, c, and r in Hamilton's rule) since in this case, Bessel's correction cancels out.</p>
</disp-quote>
<p>Totally correct.</p>
<disp-quote content-type="editor-comment">
<p>(4) Descriptive vs. inferential statistics: When discussing the statistical quantities in the Price Equation, the author appears to treat them all as inferential statistics. That is, he takes the position that the population data are all generated by some probabilistic model and that the goal of computing the statistical quantities in the Price Equation is to correctly infer this model.</p>
</disp-quote>
<p>Before I respond to this, I would like to point out that this literature has started going off the rails right from the very beginning. One of the initial construction errors was to use the ungeneralized Price equation in regression form. The other one is that the paper in which Price (1970) presented his equation is inconsistent, and suggests that the equation can be used for constructing hypotheses and for testing them at the same time (see van Veelen (2005), page 416). That, of course, is not possible; the first happens in the theory/modeling domain, and the second in the empirical testing/statistics domain, and they are separate exercises.</p>
<p>These construction errors have warped the literature based on it, and have resulted in a lot of mental gymnastics and esoteric statements, which are needed if we are not willing to consider the possibility that there could be anything amiss with the original paper by Price (1970).</p>
<p>In this paper, I undo both of these construction errors. Undoing the second one means exploring both domains separately. In Sections 2-4 of Appendix A I explore the possibility that the Price equation is applied to data. In Section 5 of Appendix A I explore the possibility that it is used in a modelling context. The primary effort here is just to do it right, and I have not read anything to suggest that I did not succeed in doing this. Secondarily, of course, I also want to contrast this to what happens in the existing literature. That is what this point by the reviewer is about. It is therefore important to be aware that seeing the contrast accurately is complicated by the apologetic warp in the existing literature.</p>
<p>As a first effort to unwarp, I would like to point to the fact that I am not taking any position on what the Price equation should be used for. All I do here is explore (and find) possibilities, both in the statistical inference domain and in the modeling domain. I also find that there is scope for misspecification in both, and that, in both domains, we should want to avoid misspecification. The thing that I criticize in the existing literature therefore is not the choice of domain. The thing that I criticize is the insistence on, and celebrating of what is most accurately described as misspecification. This typically happens in the modeling domain.</p>
<disp-quote content-type="editor-comment">
<p>It is worth pointing out that those who argue in favor of the Price Equation do not see it this way: &quot;it is a mistake to assume that it must be the evolutionary theorist, writing out covariances, who is performing the equivalent of a statistical analysis.&quot; (Gardner, West, and Wild, 2011); &quot;Neither data nor inferences are considered here&quot; (Rousset, 2015). From what I can tell, to the supporters of the Price equation and the regression form of Hamilton's rule, the statistical quantities involved are either population-level *descriptive* statistics (in an empirical context), or else are statistics of random variables (in a stochastic modeling context).</p>
</disp-quote>
<p>Again, this description of the friction between my paper and the existing literature is predicated on the suggestion that I have only one domain in mind where the Price equation can be applied. That is not the case; I consider both.</p>
<p>In the previous paragraph, the reviewer states that I “treat statistical quantities as inferential statistics”, and in this paragraph the reviewer contrasts that with the supporters of the (ungeneralized) Price equation that supposedly treat the same quantities as “descriptive statistics”. This is also beside the point, but it will take some effort to sort out the spaghetti of entangled arguments (where the spaghetti is the result of the history in this field, as indicated earlier).</p>
<p>First of all, it is not unimportant to point out that the way most people use the terms “inferential statistics” and “descriptive statistics” is that the first refers to an activity, and the second to a function of a bunch of numbers, typically data. Inferential statistics is a combination of parameter estimation and model specification (those are activities). Descriptive statistics are for instance the average values of variables of interest (which makes them a function of a set of numbers). When doing inferential statistics (or statistical inference), looking at the descriptive statistics of the dataset is just a routine before the real work begins. It is important to remember that.</p>
<p>Now I suppose that this reviewer uses these words a little differently. When he or she writes that I “treat statistical quantities as inferential statistics”, I assume that the reviewer means that I want to use a term like <inline-formula id="sa2equ9"><inline-graphic xlink:href="elife-105065-sa2-equ9.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> for doing statistical inference, or that, when I want to interpret such a term, I include considerations typical of statistical inference. Within the data domain, that is totally correct. In the paper I argue that there are very good reasons for this. We would like to know what the data can tell us about the actual fitness function, and if we do our statistical inference right, and choose our Price-like equation accordingly, then that means that we would be able to give a meaningful interpretation to a term like <inline-formula id="sa2equ10"><inline-graphic xlink:href="elife-105065-sa2-equ10.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. It also means that we then have an equation that describes the genetic population dynamics accurately.</p>
<p>When the reviewer states that other papers treat them as “population level descriptive statistics” in an empirical context, I have a hard time coming up with papers for which that is the case. Most papers apply the Price equation in the modeling domain (That is to say: this is true in evolution. In ecology the Price equation is often applied to data; see Pillai and Gouhier (2019) and Bourrat et al. (2023)). But even if there are researchers that apply the Price equation to data, then considering these statistical quantities as “descriptive statistics” would not make sense. Looking at the descriptive statistics alone is not an empirical exercise; it is just a routine that happens before the actual statistical inference starts. In a data context, saying that considerations that are standard in statistical inference do not apply, because one is just not doing statistical inference, is the equivalent of an admission of guilt. If you do not consider statistical significance, and never mention that sample size could matter, because you are using these terms as “descriptive statistics, not inferential statistics”, then you’re basically admitting to not doing a serious empirical study.</p>
<p>Besides treating statistical quantities as descriptive statistics in a data context, the reviewer also states that, in a stochastic modeling context, other researchers treat the same statistical quantities as “statistics of random variables”. This is first of all very generous to the existing literature. I imagine that the reviewer is imagining a modeling exercise where for instance the covariance between two variables is postulated. A theory exercise would then take that as a starting point for the derivation of some theoretical result. This, however, is not what happens in most of the literature.</p>
<p>There are two things that I would like to point out. First of all, postulating covariances and deriving results from assumptions regarding those covariances is not an activity that requires using the Price equation. There are many stochastic models that function perfectly fine without the Price equation. This is maybe a detail, but it is important to realize that what the reviewer probably thinks of as a legitimate theoretical exercise may be something that can very well be done without the Price equation.</p>
<p>Secondly, I would like to repeat something that I have pointed out before, which is that the Price equation can be written for any transition, whether this transition is likely or unlikely, given a model, and even for transitions that are impossible. For all of those transitions, one can write the (ungeneralized) Price equation, and for all of those, the Price equation will be an identity, and it will contain the things that the reviewer refers to as “statistical quantities”. It is important to realize that these “statistical quantities”, therefore, are properties of a transition, and that every transition comes with its own ”statistical quantity”. That implies that they are not properties of random variables; they reflect something regarding one transition. What one could imagine, though, is the following. To fix ideas, let’s take the Price equation in regression form, and focus on <inline-formula id="sa2equ11"><inline-graphic xlink:href="elife-105065-sa2-equ11.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. A meaningful modeling exercise starts with assumptions about the likelihood of all different transitions, and therefore the likelihood of different values of 𝛽 materializing – or it starts with assumptions that imply those probabilities. In a theoretical exercise, one could then derive statements about the expectation and variance of those “statistical quantities”. For instance, one can calculate the expected value 𝐸[𝛽] =𝐸<inline-formula id="sa2equ12"><inline-graphic xlink:href="elife-105065-sa2-equ12.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, and the variance 𝑉𝑎𝑟[𝛽] = 𝑉𝑎𝑟 <inline-formula id="sa2equ13"><inline-graphic xlink:href="elife-105065-sa2-equ13.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, where this expectation is a proper expectation (taken over the probabilities with which these transitions materialize) and this variance is a proper variance, for the same reason.</p>
<p>This is what I do on page 416 of van Veelen (2005) and in Section 5 of Appendix A. I think something like this is what the reviewer may have in mind, but it is worth pointing out that this still does not mean that the <inline-formula id="sa2equ14"><inline-graphic xlink:href="elife-105065-sa2-equ14.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> from the Price equation for any given transition is now a property of a random variable. Much of the literature, however, is not at the level of sophistication that I imagine the reviewer has in mind – although there are papers that are; see the discussion below of Rousset and Billiard (2000) and Van Cleve (2015).</p>
<p>In the appendix to this reply, I will address the quotes from Gardner, West, and Wild (2011) and Rousset (2015). This takes up some space, so that is why it is at the end of this reply.</p>
<disp-quote content-type="editor-comment">
<p>In short, the manuscript seems to argue that Price equation users are performing statistical inference incorrectly, whereas the users insist that they are not doing statistical inference at all.</p>
</disp-quote>
<p>That is not what the manuscript argues, but I am happy to clarify. The manuscript explores both the use of the Price equation when applied to data (and therefore for statistical inference) and when applied to transitions in a model. The criticism on the existing literature is not that it performs statistical inference incorrectly. The criticism is that the literature insists on misspecification, which typically happens in a modelling context.</p>
<disp-quote content-type="editor-comment">
<p>The problem (and here I think the author would agree with me) arises when users of the Price equation go on to make predictive or causal claims that would require the kind of statistical analysis they claim not to be doing. Claims of the form &quot;Hamilton's rule predicts..&quot; or use of terms like &quot;benefit&quot; and &quot;cost&quot; suggest that one has inferred a predictive or causal relationship in the given data, while somehow bypassing the entire theory of statistical inference.</p>
</disp-quote>
<p>I do not really know how to interpret this paragraph. The use of the word “data” suggests that this pertains to a data context, but I do not know what would qualify as a “predictive claim” in that domain, or how any study would go from data to a claim of the form “Hamilton’s rule predicts …”. Again, I do not really know papers that apply the Price equation to data. None of the empirical papers reviewed in Bourke (2014) for instance do. I would however agree that it is close to obvious that an approach that does indeed bypass the entire theory of statistical inference cannot identify causal relations in datasets. I think the examples in Section 2 of Appendix A also clearly illustrate that a literature in which the word “sample size” is absent, cannot be doing statistical inference.</p>
<disp-quote content-type="editor-comment">
<p>There is also a third way to use the Price equation which is entirely unobjectionable: as a way to express the relationship between individual-level fitness and population-level gene frequency change in a form that is convenient for further algebraic manipulation. I suspect that this is actually the most common use of the Price equation in practice.</p>
</disp-quote>
<p>I am not sure if I understand what it means for the Price equation to “express the relationship between individual-level fitness and population-level gene frequency change”. That is a bit reminiscent of how John Maynard Smith saw the Price equation (Okasha, 2005), but he also emphasized that he was unable to follow George Price and his equation. For sure, it cannot be that one side of the Price equation reflects something at the individual level and the other something at the population level, because both sides of the Price equation are equally aggregated over the population. Just to be safe, and to avoid unwarranted associative thinking, I would therefore choose to be minimalistic, and say that the Price equation is an identity for a transition between a parent population and an offspring population.</p>
<p>Regardless of the words we choose, however, the question how harmless or objectionable the use of the Price equation is in the literature is absolutely relevant. In earlier papers I have tried to cover a spectrum of examples of different ways to use (or misuse) the Price equation. In van Veelen (2005) I cover Grafen (1985a), Taylor (1989), Price (1972), and Sober and Wilson (2007). The main paper that is discussed in van Veelen et al. (2012) is Queller (1992b), but Section 7 of that paper also discusses the way the Price equation is used in Rousset and Billiard (2000), Taylor (1989), Queller (1985), and Page and Nowak (2002). These discussions also come with a description of how much it takes to repair them, and this varies all the way from nothing, or a bit of minor rewording, to being beyond repair.</p>
<p>What is good to observe, is that the papers in which the use of the Price equation is the least problematic, are also the papers in which, if the reference to the Price equation would be taken out, nothing really changes. These are papers that start with a model, or a collection of models, and that, at some point in the derivation of their results, point to a step that can, but does not have to be described as using the Price equation. An example of this is Rousset and Billiard (2000); see the detailed description in Section 7 of van Veelen et al. (2012).</p>
<p>I am happy to point to a few more papers on the no harm, no foul end of the spectrum here.</p>
<p>Allen and Tarnita (2012) discuss properties of the dynamics in a well-defined set of models.</p>
<p>Towards the end of the paper, a version of the Price equation more or less naturally appears. This is more of an interesting aside, though, and does not really play a role in derivation of the core results of the paper. Van Cleve (2015) is similar to Rousset and Billiard (2000), in that the “application of the Price equation” there is a minor ingredient of the derivation of the results. (A detail that this reviewer may find worth mentioning, given earlier comments, is that Van Cleve (2015) writes the left-hand side of the Price equation as 𝐸(𝑤Δ𝑝|𝐩), instead of <inline-formula id="sa2equ15"><inline-graphic xlink:href="elife-105065-sa2-equ15.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. First two very unimportant things. Van Cleve (2015) uses 𝑤 for mean fitness, for which <inline-formula id="sa2equ16"><inline-graphic xlink:href="elife-105065-sa2-equ16.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> is a more common symbol. Another detail of lesser importance is that it includes the vector of parent p-scores in the notation, which in their notation is 𝐩. More importantly, however, is that Van Cleve (2015) writes 𝐸(Δ𝑝) for <inline-formula id="sa2equ17"><inline-graphic xlink:href="elife-105065-sa2-equ17.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, which extends the (mis)use of the symbol 𝐸 for what really is just an average. This is consistent within the Price equation, in the sense that it now denotes the average with 𝐸, both on the right-hand side and on the left-hand side of the Price equation. It can however be a little bit confusing, because when Rousset and Billiard (2000) write <inline-formula id="sa2equ18"><inline-graphic xlink:href="elife-105065-sa2-equ18.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, then this is a proper expectation. In their case, this summarizes all possible transitions out of a given state, and weighs them by their probabilities of happening, given a state summarized by 𝑝.). I am also happy to extend the spectrum a bit here. Some papers on inclusive fitness do not use the Price equation at all, even though one could imagine places where it could be inserted. A nice example of such a paper is Taylor et al. (2007).</p>
<p>In this paper, I hope I can be excused from taking a complete inventory of this literature, and I hope that I do not have to count how many papers fall into the different categories. This would help assess the veracity of the suspicion the reviewer has, which is that the most common use of the Price equation is entirely unobjectionable, but I just do not have the time. I would however not want to underestimate the aggregate damage done in this field. The spectrum spanned in my earlier papers does include a fair amount of nonsense results. This typically happens in papers that do not study a specific model or set of models, but that take the Price equation as their point of departure for their theorizing. Also there seems to be a positive correlation between how exalted and venerating the language is that is used when describing the wonders and depths of the Price equation, and how little sense the claims make that are “derived” with it.</p>
<p>We also should not set the bar too low. This is a literature that, at the starting point, has a few construction errors in it, as described in the paper. That is reason for concern. Moreover, one of the main end products of this literature is what we send our empiricists to the field with. As Section 8 of van Veelen et al. (2017) indicates, what we have supplied to our empiricists to work with is nothing short of terrible. I would therefore want to maintain that the damage done is enormous, and if there are also a few papers around that may use the ungeneralized Price equation in an innocuous way, then that is not enough redemption for my taste. We are still facing a literature in which, at every instance where the Price equation is used, we still need to check in which category it falls.</p>
<disp-quote content-type="editor-comment">
<p>For a paper that aims to clarify these thorny concepts in the literature, I think it is worth pointing out these different interpretations of statistical quantities in the Price equation (descriptive statistics vs inferential statistics vs algebraic manipulation). One can then critique the conclusions that are inappropriately drawn from the Price equation, which would require rigorous statistical inference to draw. Without these clarifications, supporters of the Price equation will again argue that this manuscript has misunderstood the purpose of the equation and that they never claimed to do inference in the first place.</p>
</disp-quote>
<p>I would like to return to the point that I made at the beginning of my response to point (4), which is that the “thorniness” of these concepts is the result of the warp in the literature, resulting from the construction errors in Price (1970). If people want to understand how to apply the Price equation right, I think that reading Appendix A and B would work just fine. Again, I have not read anything that suggests that there is anything incorrect in there, so if the literature contains “thorny” concepts, it might just be that this is the result of the mental gymnastics necessitated by the unwillingness to accept that there might be something not completely right with Price (1970). Moreover, given my experiences in the field, I am not sure that there is anything that I could say that would convince the supporters of the ungeneralized Price equation.</p>
<disp-quote content-type="editor-comment">
<p>(5) &quot;True&quot; models: Even if one accepts that the statistical quantities in the Price equation are inferential in nature, the author appears to go a step further by asserting that, even in empirical populations, there is a specific &quot;true&quot; model which it is our goal to infer. This assumption manifests at many points in the SI when the author refers to the &quot;true model&quot; or &quot;true, underlying population structure&quot; in the context of an empirical population.</p>
</disp-quote>
<p>Again, in Appendix A I explore both a data context and a modeling context. In the modeling context none of this applies, because in such a context, there is only the model that we postulate. In the part in which I explore what the Price equation can do in a data context, I do indeed use words like “true model” or &quot;true underlying population structure&quot;.</p>
<disp-quote content-type="editor-comment">
<p>I do not think it is necessary or appropriate, in empirical contexts, to posit the existence of a Platonic &quot;true&quot; model that is generating the data. Real populations are not governed by mathematical models. Moreover, the goal of statistical inference is not to determine the &quot;true model&quot; for given data but to say whether a given statistical model is justified based on this data. Fitting a linear model, for example, does not rule out the possibility there may be higher-order interactions - it just means we do not have a statistical basis to infer these higher-order interactions from the data (say, because their p-scores are insignificant), and so we leave them out.</p>
</disp-quote>
<p>This remark suggests that the statistical approach in Sections 2-4 of Appendix A is more naïve than it should be, and that I would overlook the possibility of, for instance, interaction effects that are really nonzero, but that are statistically not significant. Now first of all, at a superficial level, I would like to say that this strikes me as somewhat inconsistent. In the remarks further back, the reviewer seems to excuse those that use the Price equation on data without any statistical considerations whatsoever. The reason why the reviewer is giving them a pass, is that they are “just not doing statistical inference”. Instead, they are doing this whole other thing with, you know, descriptive statistics. As I indicated above, that is just a fancy way of saying that they are not doing serious statistics – or serious empirics, for that matter.</p>
<p>In this comment, on the other hand, the reviewer also suggests that the statistics that I use to replace the total absence of any statistical considerations with, is not quite up to snuff. Below, I will indicate why that is not the case at all, but I think it is also worth registering a touch of irony there.</p>
<p>In order to address this issue, it is worth first observing that the whole of classical statistics is based on probability theory in the following sense. We are always asking ourselves the question: if the data generating process works like this, what would the likelihood be of certain outcomes (datasets); and if the data generating process works some other way (sometimes: the complement of whatever “this” is), what would the likelihood then be of the same outcomes. By comparing those, we draw inferences about the underlying data generating process (which is a word suggestive of a “Platonic” world view that the reviewer seems to reject). Therefore, if one would impose a ban on using Platonic words like “true data generating process”; “actual fitness function”; or “the population structure that is out there”, it would be impossible to teach any course in statistics, basic or advanced. Also it would be impossible to practice, and talk about, applied statistics.</p>
<p>Now the reviewer claims that “Real populations are not governed by mathematical models”. I do not really know if I agree or disagree with that statement, but the example that the reviewer gives does not fit that claim. The reviewer suggests that if we find a higher order term not to be statistically significant (and therefore we reject the hypothesis that it is nonzero), then that would not necessarily mean that it is not there. That is totally true, and statisticians tend to be fully aware of that. But that does not imply that there is no true data-generating process; the whole premise of this example is that there is, but that the sample size is not large enough to determine it in a detailed enough way so as to include this interaction effect, that apparently is small relative to the sample size.</p>
<p>The third thing to reflect on here, is that the reviewer seems to suggest that the Generalized Price equation in regression form, as presented in my paper, comes with a specific statistical approach, that he or she classifies as philosophically naïve or unsophisticated. That, however, is not the case, and I am very grateful that this remark by this reviewer allows me to make a point that I think shines a light on how the Generalized Price equation puts the train that started going off the rails in 1970 back on track, and reconnects it with the statistics it borrows its terminology from. To see that, it is good to be aware that statistics never gives certainty. The whole discipline is built around the awareness that it is possible to draw the wrong inference, and the aim is to determine, minimize, and balance, the likelihoods of making different wrong inferences. So, statistics produces statements about the confidence with which one can say that something works one way or the other. In some instances, the data are not enough to say anything with any confidence. In other cases, the data are rich enough so that it is really unlikely that we incorrectly infer that for instance a certain gene matters for fitness.</p>
<p>The nice thing about the setup with the Generalized Price equation, is that those statistical considerations translate one-to-one to considerations regarding which Price-like equation to choose. If the data do not allow us to pick any model with confidence, then we should be equally agnostic about which Price-like equation describes the population genetic dynamics accurately. If the statistics gives us high confidence that a certain model matches the data, then we should pick the matching Price-like equation with the same confidence. This also carries over to higher level statistical considerations.</p>
<p>If we think about terms that, if we would gather a gargantuan amount of data, might be statistically significant, but very small, then economists call those statistically significant, but economically insignificant. When rejecting the statistical significance on the basis of a not gargantuan dataset, statisticians are aware that terms that really have a zero effect, as well as terms, the effect of which is really small, are rejected with the same statistical test – and that we should be fine with that. All such considerations carry over to what we think of regarding the choice of a Price-like equation to describe the population genetic dynamics. Even if people disagree about whether or not to include a term that is statistically significant, but relatively small, such a disagreement can still happen within this setup, and just translates to a disagreement on which Price-like equation to choose.</p>
<p>Similarly, people could also disagree about whether it is justified to use polynomials to characterize a fitness function. If we decide that we can, because of Taylor expansions, then the core result of the paper implies that the population genetic dynamics can be summarized by a generalized Hamilton’s rule (as long as the fitness function includes a constant and a linear term regarding the p-score). On the other hand, if we do not believe this is justified, and prefer to use an altogether different family of fitness functions, then we can no longer do this. All of this leaves space for all kinds of statistical considerations and disagreements, that just carry over to the choice for one or the other Price-like equation as an accurate description of the population genetic dynamics. Or, if one does not believe polynomials should be used, then this leads to not picking any Price-like equation at all.</p>
<p>So, this is a long way of saying that the Generalized Price equation creates space for all statistical considerations to regain their place, and does not hinge on one approach to statistics or another.</p>
<disp-quote content-type="editor-comment">
<p>What we can say is that if we apply the statistical model to data generated by a probabilistic model, and if these models match, then as the number of observations grows to infinity, the estimators in the statistical model converge to the parameters of the data-generating one.</p>
<p>But this is a mathematical statement, not a statement about real-world populations.</p>
</disp-quote>
<p>Again, I do not know if I agree or disagree with the last sentence. However, that does not really matter, because either option only has implications for how we are to think of the relation between a Price-like equation describing a population genetic dynamics and real-world populations. It is not relevant for the question which Price-like equation to pick, or whether to pick one at all.</p>
<disp-quote content-type="editor-comment">
<p>A resolution I suggest to points 3, 4, and 5 above is:</p>
<p>*A priori, the statistical quantities in the Price Equation are descriptive statistics, pertaining only to the specific population data given.</p>
<p>*If one wishes to impute any predictive power, generalizability, or causal meaning to these statistics, all the standard considerations of inferential statistics apply. In particular, one must choose a statistical model that is justified based on the given data. In this case, one is not guaranteed to obtain the standard (linear) Hamilton's rule and may obtain any of an infinite family of rules.</p>
<p>*If one uses a model that is not justified based on the given data, the results will still be correct for the given population data but will lack any meaning or generalizability beyond that.</p>
<p>*In particular, if one considers data generated by a probabilistic model, and applies a statistical model that does not match the data-generating one, the results will be misleading, and will not generalize beyond the randomly generated realization one uses.</p>
<p>Of course, the author may propose a different resolution to points 3-5, but they should be resolved somehow. Otherwise, the terminology in the manuscript will be incorrect and the ms will not resolve confusion in the field.</p>
</disp-quote>
<p>I have outlined my solutions extensively above. I really appreciate that Reviewers #1 and #2 have spent time and attention on the manuscript and on the long appendices.</p>
<p>Appendix to the response to reviewer #2: Some remarks on Gardner, West &amp; Wild (2011), Frank (2012), and Rousset (2015)</p>
<p>An accurate response to the quote from Gardner, West, and Wild (2011) in the review report takes up space. I therefore wanted to put that in an appendix to the response to reviewer #2. I also include a few paragraphs regarding Frank (2012) and Rousset (2015), both of which are also mentioned by reviewer #2. All of this might also be of interest to people that are curious about how what I find in my paper relates to the existing literature.</p>
<p>Gardner, West &amp; Wild (2011) The quote I am responding to is “it is a mistake to assume that it must be the evolutionary theorist, writing out covariances, who is performing the equivalent of a statistical analysis” I want to put that into context, so I will go over the whole paragraph that surrounds the quote. The paragraph is called Statistics and Evolutionary Theory and can be found on page 1038 of the paper. I think that it is worth pointing out that it is not easy to respond to their somewhat impressionistic collages of words and formulas. I will therefore cut the paragraph up in a few smaller bits and try to make sense of it bit by bit. The paragraph begins with:</p>
<p>“Our account of the general theory of kin selection has been framed in statistical terms.” Based on what they write two sentences down, the best match between those words and what they do in the paper would be: “our account uses words like “covariance”, “variance” and “expectation” for things that are not what “covariance”, “variance” and “expectation” mean in probability theory and statistics.” I would be totally open to an argument why that is nonetheless OK to do, but the way Gardner, West, and Wild (2011) phrase it obscures the fact that this needs any justification or reflection at all. “Framing something in statistical terms” is unspecific enough to sound completely harmless.</p>
<p>“The use of statistical methods in the mathematical development of Darwinian theory has itself been subjected to recent criticism (van Veelen, 2005; Nowak et al., 2010b), so we address this criticism here.</p>
<p>Also here, specifics would be helpful. The “use of statistical methods” sounds like it is more than just using terms from statistics, so this might refer to the minimizing of the sum of squared differences, which is also mentioned a sentence down in Gardner, West, and Wild (2011). If it does, then it is worth observing that in statistics, the minimizing of the sum of squared differences (or residuals, or errors) comes with theorems that point very clearly to what is being achieved by doing this. The Gauss–Markov theorem states that the ordinary least squares (OLS) estimator has the lowest variance within the class of linear unbiased estimators. This implies that minimizing the sum of squared errors helps answering a well-defined question in statistics; under certain conditions, an OLS estimator is our best shot at uncovering an unknown relation between variables. To also minimize a sum of squared differences, but now in the modeling domain, qualifies as “use of statistical methods” only in a very shallow way. It means that a similar minimization is performed. Without an equivalent of the Gauss-Markov theorem that would shine a light on what it is that is being achieved by doing so, that does not carry the same weight as it does in the statistics domain – in that it does not carry any weight at all.</p>
<p>“The concern is that statistical terms – such as covariances and least-squares regressions – should properly be reserved for conventional statistical analyses, where hypotheses are tested against explicit data, and that they are out of place in the foundations of evolutionary theory (van Veelen, 2005; Nowak et al., 2010b).”</p>
<p>Again, a few things are a bit vague. What are “explicit data”? Are there data that are not explicit? Why the generic “foundations of evolutionary theory”, instead of a more specific description of what these statistical terms are used for? But either way, this is a misrepresentation of what I wrote in van Veelen (2005). I did not suggest to “reserve statistical terms for conventional statistical analysis” just because. As I do here in the current paper, what I did there was explore the possibilities for the Price equation to help with what I then called Type I and Type II questions. Type I questions find themselves in the modeling domain and Type II questions find themselves in the statistical domain. I was not arguing for a ban on applying statistical concepts outside of the domain of statistical inference. All that I said is that in its current practice, it does not really help answering questions of either type.</p>
<p>“However, this concern is misplaced. First, natural selection is a statistical process, and it is therefore natural that this should be defined in terms of aggregate statistics, even if only strictly by analogy (Frank, 1997a, 1998).”</p>
<p>This is a vague non-argument. Almost nothing is well-defined here. What does it mean for natural selection to be a statistical process? Is that just an unusual term for a random process? If so, then I suppose I agree, but that has nothing to do with what I state or claim. And what does it mean to be defined in terms of aggregate statistics? What is the alternative? I have no idea how any of this relates to anything that I claim or state in my papers.</p>
<p>“Second, Fisher (1930, p198) coined the term ‘covariance’ in the context of his exposition of the genetical theory of natural selection, so the evolutionary usage of this term has precedent over the way the term is used in other fields.”</p>
<p>This is what I would call a “historic fallacy”. The fact that Fisher coined the term “covariance” in a book on genetics and natural selection does not mean that any “evolutionary usage” of the term “covariance”, however nonsensical, now has precedent over the way the term is used in other fields. Irrespective of the path that the history of science, genetics, or statistics took, right now we are in a place where about every student at every university anywhere in the world that takes a course in probability theory and/or statistics, learns that covariance is a property of a random variable (see also Wikipedia). And they do for a very good reason; it is essential in recognizing the relation between probability theory on the one hand and statistics on the other. Being curious how this “evolutionary usage” of the term covariance works, if covariance turns out not to be a property of a random variable, is therefore perfectly justified, and “Fisher coined the term” is not a safe word that exempts it from scrutiny.</p>
<p>Third, it is a mistake to assume that it must be the evolutionary theorist, writing out covariances, who is performing the equivalent of a statistical analysis.</p>
<p>Again, that is just not what anyone is saying. Nobody is suggesting that an evolutionary theorist should perform the equivalent of statistical analysis. All I did was point to how little is being achieved by transferring formulas from statistics to a modeling context.</p>
<p>A better analogy is to regard Mother Nature in the role of statistician, analysing fitness effects of genes by the method of least-squares, and driving genetic change according to the results of her analyses (cf. Crow, 2008).</p>
<p>I have no idea what any of this means. Mother Nature is a personification of something that is not a person, and that does not have cognition. Without sentience, “Mother Nature” cannot assume the role of statistician, and cannot analyse fitness effects.</p>
<p>More generally, analogy is the basis of all understanding, so when isomorphisms arise unexpectedly between different branches of mathematics (in this case, theoretical population genetics and statistical least-squares analysis) this represents an opportunity for advancing scientific progress and not an anomaly that is to be avoided.</p>
<p>This is a strawman argument, puffed up with platitudes. Nobody is arguing against analogies. But what is the analogy supposed to be here? Just taking least squares from statistical inference and performing it in a modeling context does not make it an analogy. The GaussMarkov theorem, which is the basis for why least squares helps answering questions in statistics, just does not mean anything in a modeling context. OLS in modeling is just willful misspecification, and nothing that it does in statistics translates to anything meaningful in modeling. Again, declaring it an analogy, or an isomorphism, does not make it one.</p>
<p>Frank (2012) Because the reviewer also mentions Frank (2012), I would like to include a small remark on this paper too. “Natural Selection. IV. The Price equation” by Frank (2012) is partly a response to my earlier criticism of the use of the Price equation. Much like Gardner, West, and Wild (2011), I would describe this paper as what is called a ”flight forwards” in Dutch. While the questions I ask are relatively prosaic (such as: how does the Price equation help derive a prediction from model assumptions?), Frank (2012) pivots to suggesting that there is a profound philosophy-of-science disagreement that I am on the wrong side of. It is close to impossible to respond to Frank (2012), because it is a labyrinth of arguments that sound deep and impressive, but that are just not specific enough to know how they relate to points that I made – or even just what they mean in general. Just to pick a random paragraph:</p>
<p>“Is there some reorientation for the expression of natural selection that may provide subtle perspective, from which we can understand our subject more deeply and analyse our problems with greater ease and greater insight? My answer is, as I have mentioned, that the Price equation provides that sort of reorientation. To argue the point, I will have to keep at the distinction between the concrete and the abstract, and the relative roles of those two endpoints in mature theoretical understanding.”</p>
<p>For many of those terms, I have no real idea what they mean, and also reading the rest of the paper does not help understanding what this has to do with the more prosaic questions that are waiting for an answer. What is “reorientation”? What does “concrete” versus “abstract” have to do with the question what is being achieved by doing least squares regressions in modeling? What would be an example of a mature and an immature theoretical understanding?</p>
<p>Rousset (2015) is also mentioned by the reviewer. This paper is not esoteric. It states, as reviewer #2 points out, that &quot;neither data nor inferences are considered&quot;. This paper therefore finds itself in the modeling domain, and not in the data domain. It does however still dodge the question what the benefits are of misspecification in the modeling domain. As a matter of fact, it denies that there is misspecification at all.</p>
<p>“In the presence of synergies, the residuals have zero mean and are uncorrelated to the predictors. No further assumption is made about the distribution of the residuals. Thus, there is no sense in which the regression is misspecified.”</p>
<p>This is a remarkable quote, and testament to the lasting impact of the construction errors in Price (1970). Misspecification is literally defined as getting the model wrong. In statistics, avoiding misspecification can be complicated, because of the noise in the data. The real datagenerating process is unknown, and because of the noise, there is always the possibility that data that are generated by one model look like they could also have been generated by another. The challenge is to reduce the odds of getting the model wrong to acceptable proportions, which is what statistical tests are for. But in modeling, we know what the model is; it is postulated by the modeler. Therefore, misspecification can be avoided by just not replacing it with a different model.</p>
<p>What is being discussed in this part of Rousset (2015) is replacing what in this manuscript is called Model 3 (𝑤<sub>𝑖</sub> = 𝛼 + 𝛽<sub>1,0</sub>𝑝<sub>𝑖</sub> + 𝛽<sub>1,1</sub>𝑝<sub>𝑖</sub> + 𝛽<sub>1,1</sub>𝑝<sub>𝑖</sub>𝑞<sub>𝑖</sub> + 𝜀<sub>𝑖</sub>) with Model 2 (𝑤<sub>𝑖</sub> = 𝛼 + 𝛽<sub>1,0</sub>𝑝<sub>𝑖</sub>+ 𝛽<sub>1,0</sub>𝑝<sub>𝑖</sub>𝑞<sub>𝑖</sub> + 𝜀<sub>𝑖</sub>), and choosing the parameters in Model 2 so that it is as close as it can be to Model</p>
<p>(3) This is just the definition of misspecification. That is to say: the misspecification part is the choosing of Model 2 as a reference model. The minimizing of the sum of squared residuals one could consider as minimizing the damage.</p>
<p>While Rousset (2015) finds itself in the modeling domain, it does nonetheless point to the field of statistics here, by stating that “the residuals have zero mean and are uncorrelated to the predictors”. From this, the paper concludes that “there is no sense in which the regression is misspecified”. That is just plain wrong. Minimizing the sum of the squared residuals guarantees that the residuals are uncorrelated with the variables that are included in the reference model, with respect to which the squared sum of residuals is minimized. The criterion that Rousset (2015) uses is that the model is well-specified if there is no correlation between the residuals (here: <inline-formula id="sa2equ19"><inline-graphic xlink:href="elife-105065-sa2-equ19.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>) and the variables included in the reference model (here: 𝑝<sub>𝑖</sub> and 𝑞<sub>𝑖</sub>). But according to this criterion, all models would always be well-specified, and no model could ever be misspecified. The correct criterion, however, also requires that the residuals are not correlated with variables not included in the reference model. And here, the residuals are in fact correlated with 𝑝<sub>𝑖</sub>𝑞<sub>𝑖</sub>, which is the variable that is included in Model 3, but not in Model 2. Therefore, according to the correct version of this criterion, this model is in fact misspecified – as it should be, because getting the model wrong is the definition of misspecification.</p>
<p>In order to make sure that there can be no misunderstanding, I have added subsections at the end of Section 2 and Section 4 of Appendix A, and at the end of Section 2 of Appendix B. These subsections show that the algebra of minimizing the sum of squared errors implies that there is no correlation between the errors, or the residuals, and the variables that are included in the model. This is by no means something new; it is the reason why we do OLS to begin with. For additional details about misspecification, I would refer to Section 1b (viii) in van Veelen (2020).</p>
<p>Finally, there is a detail worth noticing. In the main text, as well as in Appendix B, I use an analogy (and, unlike what Gardner, West, and Wild, 2011, refer to as an analogy, this actually is one). This is an analogy between two choices. On the one hand, there is the choice between Price-like equation 1 (based on Model 1 as a reference model) and Price-like equation 2 (based on Model 2 as a reference model) both applied to Model 2. On the other hand, there is the choice between Price-like equation 2 (based on Model 2 as a reference model) and Price-like equation 3 (based on Model 3 as a reference model) both applied to Model 3. Model 1 is the non-social model, Model 2 is the social model without interaction term, and Model 3 is the social model with interaction term. That makes the first choice a choice between treating a social model as a social model, or as a non-social model. The second choice is between treating a social model with interaction term as a social model with interaction term, or as a social model without interaction term. The power of this analogy is that every argument against treating the social model as if it is a non-social model is also an argument against treating the social model with interaction term as if it is a social model without interaction term.</p>
<p>This ties in with the incorrect criterion for when a model is well-specified from Rousset (2015) as follows. His criterion (that there should be no correlation between the residuals and the variables in the model) declares the social model without interaction term well-specified as a reference model, when we are considering a social model with interaction term. According to the same criterion, however, the non-social model would also have to be declared to be wellspecified as a reference model, when the model we are considering is a social model. The reason is that also here, there is no correlation between the residuals and the variables that are included in this model. This is clearly not what anyone is advocating for, and for good reasons. The residuals here would, after all, be correlated with the p-score of the partner, which is a variable that is not included in the non-social model. This is a good indication that we should not use the non-social model for a social trait.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public review):</bold></p>
</disp-quote>
<p>Before responding to this review, I would like to express that I appreciate the fact that the reviews and the responses are public at eLife. Besides just being useful in general, this also allows readers to get a behind the scenes glimpse into the state of the field, and the level of the reviewing. While the reports by Reviewers #1 and #2 show openness and an interest in getting things right, the report by Reviewer #3 is representative of the many review reports that I have received from the inclusive fitness community in the past. These reports tend to be rhetorically strong, and to those who do not have the time to dig deeper in the details, these reports are probably also convincing. I will therefore go through this review line by line to show how little there is behind the confident off-hand dismissal.</p>
<disp-quote content-type="editor-comment">
<p>There is an interesting mathematical connection - an &quot;isomorphism&quot;-between Price's equation and least-squares linear regression.</p>
</disp-quote>
<p>This is esoteric and needlessly vague. Why is the word “isomorphism” used? In mathematics, an isomorphism is a structure-preserving mapping. The Price equation is an equation, or an identity, which makes it a bit difficult to imagine what the set of objects is on one end of the mapping. Least-squares linear regression can perhaps be seen as a function of a dataset, which would make it a single object (one function). This complicates things at the other end of the mapping too, if that set is a singleton set. The only isomorphism that I can think of is a trivial isomorphism where one equation is mapped onto one function and vice versa. It seems unlikely that this is what the reviewer means. The word isomorphism moreover is in quotes, so maybe this is supposed to be figurative. But what would it be that is being suggested here by this figure of speech? Just saying that there is, as the reviewer puts it, an “interesting mathematical connection”, does not make it so. It would already be a start to just specify what the mathematical connection is, because I have a hard time seeing what that would be. Is it just that, if you divide the Cov(𝑤, 𝑝)-term by the Var(𝑝)-term, then you get a regression coefficient? If that is what the reviewer has in mind, that would be a rather shallow observation.</p>
<disp-quote content-type="editor-comment">
<p>Some people have misinterpreted this connection as meaning that there is a generalitylimiting assumption of linearity within Price's equation, and hence that Hamilton's rule-which is derived from Price's equation-provides only an approximation of the action of natural selection.</p>
</disp-quote>
<p>Here, the reviewer pulls a switcheroo. The use of the word “general”, or “generality”, here refers to the fact that the classical Price equation is an identity for all possible transitions between a parent and an offspring population. This is the sense in which the inclusive fitness literature uses the word general, and so do I in the relevant places in the manuscript. When I do, I make sure to add phrases like “in the sense that whatever the true model is, it always gets the direction of selection right”. As a consequence, the classical Hamilton’s rule is also totally general, in the same sense.</p>
<p>One of the core points of the paper is that this is not unique to the classical Price equation. As a matter of fact, there is a large set of Price-like equations and Hamilton-like rules that are equally much identities, and equally much general (in the sense that they get the direction of selection right for all possible transitions). The being an identity and being completely general (in this sense) therefore cannot be a decisive criterion in favour of the classical Price equation and the classical Hamilton’s rule.</p>
<p>On the other hand, the way in which my Generalized Price equation and my generalized version of Hamilton’s rule are general, is that they do not restrict the statistical model with respect to which errors are squared, summed and minimized to one linear statistical model. This generalization generates the variety of Price-like equations and Hamilton-like rules mentioned above (all of which are general in the sense of always getting the direction of selection right) and it gives us the flexibility to pick one that separates terms that reflect the fitness function from terms that reflect the population state.</p>
<p>In response to my generalizing the Price equation and Hamilton’s rule in this second sense, the criticism of the reviewer comes down to saying that the Price equation and Hamilton’s rule do not need generalizing, because they already are general – the switcheroo being that this refers to generality in the first sense. That makes it sound like this could be an honest mistake, confusing one way in which these can be described as general with another. However, I really hammered this point home in the manuscript. Even a cursory reading of the manuscript reveals that I am fully aware that the classical Price equation and the classical Hamilton’s rule are general in the first sense.</p>
<p>It is also not helpful that, as a description of what I supposedly claim, this is impressionistic, and lacks specificity. The Price equation is an equation, or an identity. What does it mean for there to be an “assumption of linearity” within it? For the classical Price equation in covariance form (which Reviewer #2 argues is what most people think of as “the Price equation”) there is no way in which one can transform this into a meaningful statement. There is just nothing in there to which the adjective “linear” can be applied. Linearity only becomes a thing when we ask ourselves how we can interpret the regression coefficient in the classical Price equation in regression form. That would be the linearity of the statistical model the differences with which are squared, summed and minimized in the regression.</p>
<disp-quote content-type="editor-comment">
<p>This is in contrast to the majority view that Hamilton's rule is a fully general and exact result.</p>
</disp-quote>
<p>Again, in this manuscript, I write, time and again, that the classical Hamilton’s rule is fully general (in the sense that it is applies to any transition), and exact (if that means that it always gets the direction of selection right). So, this is clearly not where the contrast with the majority view lies. The contrast with the majority view is that the majority insist on misspecification, and I suggest not to do that.</p>
<disp-quote content-type="editor-comment">
<p>To briefly give some mathematical details: Price's equation defines the action of natural selection in relation to a trait of interest as the covariance between fitness 𝑤 and the genetic breeding value 𝑔 for the trait, i.e. Cov(𝑤, 𝑔);</p>
</disp-quote>
<p>The Price equation is an identity, not a definition. When deciding on a definition, there is some freedom. We can choose to define ⊂ so that 𝐴 ⊂ 𝐵 means that 𝐴 is a strict subset of 𝐵; or we can choose to define ⊂ so that 𝐴 ⊂ 𝐵 means that 𝐴 is a (not necessarily strict) subset of 𝐵. The Price equation does not “define the action of natural selection”, because it is an identity. There is no freedom to “define” <inline-formula id="sa2equ20"><inline-graphic xlink:href="elife-105065-sa2-equ20.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> any other way.</p>
<p>The more serious reason why this is conceptually also a little dangerous, is the following. Imagine a locus with two alleles. Both of them are non-coding bits of DNA. Selection therefore does not act on either of them. Now imagine a parent population with an average p-score of 0.5, or, in other words, the frequency of these alleles in the parent population is 50-50. That makes the expected value of the p-score in the offspring population 0.5 too. In finite populations, however, randomness can make the p-score grow a bit larger or a bit smaller than 0.5. If the parent population is small, the variance (the expected squared deviation from 0.5) can actually be sizeable. If the p-score in the offspring population lands above 0.5, then the Price equation has a <inline-formula id="sa2equ21"><inline-graphic xlink:href="elife-105065-sa2-equ21.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>&gt; 0 and a <italic>Cov</italic>(<italic>ω</italic>, <italic>p</italic>) &gt; 0. Describing the Price equation as “defining the action of natural selection” now suggests that higher p-scores have been selected for (or, in other words, that “the action of natural selection in relation to a trait of interest” is positive). With equal probability, however, <inline-formula id="sa2equ22"><inline-graphic xlink:href="elife-105065-sa2-equ22.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>&lt; 0 and therefore also <italic>Cov</italic>(<italic>ω</italic>, <italic>p</italic>) &lt; 0, and this would then make us draw the opposite conclusion, that natural selection has acted to lower the p-scores in the population. Both of those would be wrong, because in this situation, it would have been randomness that changed the average p-score.</p>
<disp-quote content-type="editor-comment">
<p>this is a fully general result that applies exactly to any arbitrary set of (𝑔, <italic>ω</italic>) data; without any loss of generality this covariance can be expressed as the product of genetic variance Var(𝑝) and a coefficient <italic>b</italic>(𝑔, <italic>ω</italic>), the coefficient simply being defined as <italic>b</italic>(𝑔, <italic>ω</italic>) for all Var(<italic>p</italic>) &gt; 0; it happens that if one fits a straight line to the same (𝑔, <italic>ω</italic>) data by means of least-squares regression then the slope of that line is equal to <italic>b</italic>(𝑔, <italic>ω</italic>).</p>
</disp-quote>
<p>Why this needs to be explained is a bit of a mystery. These “mathematical details” are in almost all Price equation papers, and they are the point of departure of my Appendix A (it is on page 7 of a more than 90 page long set of appendices). Seeing the need to explain this suggests that the reviewer thinks that there is a chance that I or anyone reading this paper would have missed this. I have not, and, more importantly, none of this invalidates the point I make in the paper.</p>
<disp-quote content-type="editor-comment">
<p>All of this has already been discussed, repeatedly, in the literature.</p>
</disp-quote>
<p>All of this has already been discussed, repeatedly, in the literature indeed. It is just that it does not engage with anything I write in the manuscript, or that I wrote in my other papers.</p>
<disp-quote content-type="editor-comment">
<p>Now turn to the present paper: the first sentence of the Abstract says &quot;The generality of Hamilton's rule is much debated&quot;, and then the next sentence says &quot;In this paper, I show that this debate can be resolved by constructing a general version of Hamilton's rule&quot;.</p>
</disp-quote>
<p>This is correct.</p>
<disp-quote content-type="editor-comment">
<p>But immediately it's clear that this isn't really resolving the debate, what this paper is actually doing is asserting the correctness of the minority view (i.e. that Hamilton's rule as it currently stands is not a general result)</p>
</disp-quote>
<p>It seems to me that the reason why this is “immediately clear” to this reviewer is that the reviewer has not processed the contents of the paper. I am not sure if I have to repeat this, but I am not saying that “Hamilton’s rule as it currently stands” is not general (in the sense that it always gets the direction of selection right). It is, and I say that it is a bunch of times. But so are other rules.</p>
<disp-quote content-type="editor-comment">
<p>and then attempting to build a more general form of Hamilton's rule upon that shaky foundation.</p>
</disp-quote>
<p>I am not just “attempting to build a more general form of Hamilton's rule”. I did in fact build a more general form of Hamilton’s rule (where the generality refers to the richer set of reference statistical models).</p>
<disp-quote content-type="editor-comment">
<p>Predictably, the paper erroneously interprets the standard formulation of Hamilton's rule as a linear approximation and develops non-linear extensions to improve the goodness of fit for a result that is already exactly correct.</p>
</disp-quote>
<p>Nowhere in the paper or the appendices do I describe the standard formulation of Hamilton’s rule (or, for that matter, any formulation of Hamilton’s rule) as an “approximation”. It is just not a word that has anything to do with this. If we are doing statistical inference, and the sum of squared errors that is minimized decreases by adding a variable in the statistical model with regard to which the sum of squared errors is minimized, then that will typically improve the goodness of fit. In statistics this is not described that as an improvement in how well the statistical model “approximates” the data, or whatever it is that the reviewer would suggest is being approximated here.</p>
<disp-quote content-type="editor-comment">
<p>This is not a convincing contribution. It will not change minds or improve understanding of the topic.</p>
</disp-quote>
<p>There is indeed plenty of scope for this not to change minds or improve understanding of the topic. It will not change the minds or improve the understanding of those that are not really interested in getting this right. Obviously, it will also not convince those that do not read it.</p>
<disp-quote content-type="editor-comment">
<p>Nor is it particularly novel. Smith et al (2010, &quot;A generalisation of Hamilton's rule for the evolution of microbial cooperation&quot; Science 328, 1700-1703) similarly interpreted Hamilton's rule as a linear model and provided a corresponding polynomial expansion - usefully fitting the model to microbial data so as to learn something about the costs and benefits of cooperation in an empirical setting. it's odd that this paper isn't cited here.</p>
</disp-quote>
<p>Let me begin by pointing to what I agree with. Given that smith et al. (2010) and my manuscript are both in the business of generalizing Hamilton’s rule, it would be helpful to the reader if my paper includes more information about how the two efforts relate. I will discuss the relation below, and I will also include that in Appendix B, and point to it in the main text. Before I do, however, I would like to point to two details in the review report that fit a pattern.</p>
<p>The first is that the reviewer describes what smith et al. (2010) do as “useful”, and seems to think of fitting polynomial expansions as a legitimate way to “learn something about the costs and benefits of cooperation in an empirical setting”. That sounds quite positive. My paper, in which I supposedly repeat this, however, is characterized as misguided. This fits a pattern; all of the reviews I received from the inclusive fitness community include a “done before”, and regularly the done before is described approvingly, while my paper is described as fundamentally flawed.</p>
<p>Also customary is the lack of detail. What would be really useful here, is something like “equation A.14 in this manuscript is the same as equation 6 in smith et al. (2010) if we choose <inline-formula id="sa2equ23"><inline-graphic xlink:href="elife-105065-sa2-equ23.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. This kind of statement would pin down the way in which what I do has been done before. That, however, would require going into detail, at the risk of finding out that what is done in my manuscript is actually quite different from what happens in smith et al. (2010). That is also a recurrent thing. When I look up the done before, I typically find something that is not quite the same.</p>
<p>Now on to the paper. What smith et al. (2010) try to do is something that I wholeheartedly support. It is an empirical study that tries to capture non-linearity. A first point of order is that it is worth asking ourselves: linear or non-linear in what? For that, I would like to go back to the setup of my manuscript. Model 2 from the Main Text is</p>
<disp-formula id="sa2equ24">
<graphic mime-subtype="jpg" xlink:href="elife-105065-sa2-equ24.jpg" mimetype="image"/>
</disp-formula>
<p>In this fitness function, 𝑝! is the p-score of individual 𝑖 and 𝑞! is the p-score of the partner that individual 𝑖 is matched with. This is a standard model of social behaviour if 𝛽<sub>1,0</sub> &lt; 0 and 𝛽<sub>0,1</sub> &gt; 0. Such choices for 𝛽<sub>1,0</sub> and 𝛽<sub>0,1</sub> indicate that having a higher p-score decreases the fitness of individual 𝑖 and increases the fitness of its partner. Here we assume that 𝛼 = 1, 𝛽<sub>1,0</sub> = −1, and 𝛽<sub>0,1</sub> = 2. We assume that p-scores can only be 0 or 1, or, in other words, we assume that there are only cooperators and defectors in the population (or, in terms of smith et al., 2010: cooperators and cheaters).</p>
<p>For a well-mixed population, where the likelihood of being matched with a cooperator is the same for cooperators and defectors (it is equal to the frequency of cooperators for both), we can now plot the fitnesses of cooperators (red) and defectors (blue) as a function of the frequency of cooperators (Appendix 1-figure 6 left).</p>
<p>We can do the same for a population with relatedness <inline-formula id="sa2equ25"><inline-graphic xlink:href="elife-105065-sa2-equ25.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> where the probability of being matched with a cooperator is <inline-formula id="sa2equ26"><inline-graphic xlink:href="elife-105065-sa2-equ26.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>+ <sub>c</sub> for cooperators, and <inline-formula id="sa2equ27"><inline-graphic xlink:href="elife-105065-sa2-equ27.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> 𝑓<sub>c</sub> for defectors, where 𝑓<sub>c</sub> is the frequency of cooperators (Appendix 1-figure 6 right). For relatedness 𝑟 = 0 and 𝑟 = &quot;7, cooperation is selected against at every frequency.<inline-formula id="sa2equ28"><inline-graphic xlink:href="elife-105065-sa2-equ28.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> 𝑓</p>
<p>Increasing relatedness further, we would find that for 𝑟 = <inline-formula id="sa2equ29"><inline-graphic xlink:href="elife-105065-sa2-equ29.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> the lines coincide, which implies that at every frequency, cooperation is neither selected for nor against. For 𝑟 &gt; &quot;: cooperation will be selected for at every frequency. This pattern implies that, as we have seen in the manuscript, the classical Hamilton’s rule works perfectly fine for Model 2; with 𝑐 = −𝛽<sub>1,0</sub> = 1 and 𝑏 = 𝛽<sub>0,1</sub> = 2, cooperation is selected for if and only if 𝑟𝑏 &gt; 𝑐. The fitnesses of cooperators and defectors as functions of the frequency of cooperators, moreover, are always parallel lines, regardless of relatedness.</p>
<p>Model 3 in the main text extends Model 2 by adding an interaction term:</p>
<disp-formula id="sa2equ30">
<graphic mime-subtype="jpg" xlink:href="elife-105065-sa2-equ30.jpg" mimetype="image"/>
</disp-formula>
<p>Now we choose 𝛼 = 1, 𝛽<sub>1,0</sub> = −1, 𝛽<sub>1,0</sub> = 1, and 𝛽<sub>1,1</sub>  = 1. We again draw the fitnesses of cooperators and defectors, both at relatedness 𝑟 = 0 (Appendix 1-figure 7 left) and at relatedness 𝑟 = <inline-formula id="sa2equ31"><inline-graphic xlink:href="elife-105065-sa2-equ31.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> (Appendix 1-figure 7 right). In the manuscript, I argue that the appropriate version of Hamilton’s rule here is Queller’s rule: 𝑟<sub>0,1</sub>𝑏<sub>0,1</sub> + 𝑟<sub>1,1</sub>𝑏<sub>1,1</sub> &gt; 𝑐 with 𝑐 = −𝛽<sub>1,0</sub> = 1, 𝑏<sub>0,1</sub> = 𝛽<sub>0,1</sub> = 1, and 𝑏<sub>1,1</sub> = 𝛽<sub>1,1</sub> = 1. The fitnesses of cooperators and defectors as functions of the frequency of cooperators are still straight lines, but they are no longer parallel.</p>
<p>The first thing to observe, therefore, is that a model with synergy, in which the classic version of Hamilton’s rule would be misspecified, and Queller’s rule would be well-specified, does not require the fitnesses as functions of the frequencies of cooperators to be non-linear. All that changes with the addition of the interaction term, is that they stop being parallel.</p>
<p>The paper by smith et al. (2010) is an effort to capture non-linearities in the way fitnesses depend on the frequency of cooperators. That, therefore, goes beyond the step from Model 2 to Model 3. Whether it uses the right method to capture those non-linearities, we will come back to in a second, but it is important to realize that also without these non-linearities, the classic version of Hamilton’s rule can be too limiting to accurately describe selection. (Here, I should add that this implies that we were wrong in Wu et al. (2013), when we suggested that “for this experiment, it seems unnecessary to use the generalized Hamilton’s rule, if instead the Malthusian fitness is adopted. In other words, the Wrightian fitness approach calls for a generalization of Hamilton’s rule, whereas the Malthusian fitness approach does not (or at least not in a drastic way, as Malthusian fitnesses are almost linear in the frequency of cooperators).” Using Malthusian fitnesses, the functions were close to linear, but not close to parallel, and therefore also here, Hamilton’s rule needs generalizing - albeit in a different way than smith et al. (2010) did).</p>
<p>The cooperation that is observed in the Myxococcus xanthus studied by smith et al. (2010) is not a good match with a model where individuals are matched in pairs for an interaction that determines their fitnesses. These microbes cooperate in large groups, and a better match would therefore be the n-player public goods games studied in van Veelen (2018). There, we see that simple, straightforward ways to describe synergies (or anti-synergies) can easily lead to fitnesses not being linear in the frequency of cooperators.</p>
<p>The way smith et al. (2010) try to capture those non-linearities, however, is not free of complications. We addressed those in Wu et al. (2013), and I summarized them, shortly, in van Veelen (2018). One of the issues is that most of the non-linearity smith et al. (2010) pick up is the result of considering Wrightian fitness rather than Malthusian fitness. In a continuous time model with a constant growth rate, the population size at time 𝑡 is 𝑁(𝑡) = 𝑒<sup>mt</sup>𝑁(0), where 𝑚 is the Malthusian fitness. In a discrete time model with a constant average number of offspring per individual, the population at time 𝑡 is 𝑁(𝑡) = 𝑤<sup>t</sup>𝑁(0), where 𝑤 is the Wrightian fitness. If we take 𝑚 = ln 𝑤, these are the same, and if 𝑤 is close to 1, then 𝑚 can be approximated by 𝑤 − 1. That also implies that if 𝑤 is close to 1 (or, equivalently, if 𝑚 is close to 0) one is locally linear if the other is too. However, in the experiment by smith et al. (2010) the aggregate fitness effects are not small, and what is highly nonlinear in terms of Wrightian fitness is close to linear in Malthusian fitness.</p>
<p>Another complication is that the Taylor coefficients that smith et al. (2010) find are the result of a combination of the data and the choice of a functional form they choose to first apply to their data. That means that a different choice of a functional form would have given different Taylor coefficients, while the in-between transformation can also be skipped. Also, the number of Taylor coefficients is larger than the dimensionality of the data, which are based on averages for 6 frequencies. For more details on these complications, I would like to refer to Wu et al. (2013) and van Veelen (2018). A nice detail is that if we consider the way the fitnesses of cooperators and defectors compare when using Malthusian fitnesses, then a comparison of the slopes actually suggests anti-synergies, which leads to a stable mix of cooperators and cheaters, already in the absence of population structure. This matches what is suggested by Archetti and Scheuring, (2011, 2012) and Archetti (2018).</p>
<p>Besides these technical complications, smith et al. (2010) is also different, in the sense that it is an empirical paper. It does not contain the Generalized Price equation, it contains no insights regarding how to derive population genetic dynamics from the Generalized Price equation, or how to derive the appropriate rules from those, and it has a very different approach to separating fitness effects and population structure.</p>
<p>To end on a positive note, I would like to quote a bit out of Wu et al. (2013):</p>
<p>“While we criticise these mathematical issues, we are convinced that smith et al. (2010) aim into the right direction: to incorporate the nonlinearities characteristic of biology into social evolution, we may have to extend and generalize the approach of inclusive fitness. It would be beautiful if such a generalization would ultimately include Hamilton’s original rule as a special case […].”</p>
<p>I like to think that this is exactly what I have done in this paper.</p>
<p>References</p>
<p>Akdeniz, A., &amp; van Veelen, M. (2020). The cancellation effect at the group level. Evolution, 74(7), 1246–1254. doi: 10.1111/evo.13995</p>
<p>Allen, B., &amp; Tarnita, C. E. (2012). Measures of success in a class of evolutionary models with fixed population size and structure. Journal of Mathematical Biology, 68, 109–143. doi: 10.1007/s00285-012-0622-x</p>
<p>Archetti, M. (2018). How to Analyze Models of Nonlinear Public Goods. Games 2018, Vol. 9, Page 17, 9(2), 17. doi: 10.3390/g9020017</p>
<p>Archetti, M., &amp; Scheuring, I. (2011). Coexistence of cooperation and defection in public goods games. Evolution, 65(4), 1140–1148. doi: 10.1111/j.1558-5646.2010.01185.x</p>
<p>Archetti, M., &amp; Scheuring, I. (2012). Review: Game theory of public goods in one-shot social dilemmas without assortment. Journal of Theoretical Biology, 299, 9–20. doi: 10.1016/j.jtbi.2011.06.018</p>
<p>Bourke, A. F. G. (2014). Hamilton’s rule and the causes of social evolution. Philosophical Transactions of the Royal Society B: Biological Sciences, 369(1642), 20130362. doi: 10.1098/rstb.2013.0362</p>
<p>Bourrat, P., Godsoe, W., Pillai, P., Gouhier, T. C., Ulrich, W., Gotelli, N. J., &amp; van Veelen, M. (2023). What is the price of using the Price equation in ecology? Oikos, 2023(8). doi: 10.1111/oik.10024</p>
<p>Crow, J. F. (2008). Commentary: Haldane and beanbag genetics. International Journal of Epidemiology, 37(3), 442–445. doi: 10.1093/ije/dyn048</p>
<p>Fisher, R. (1930). The genetical theory of natural selection. Retrieved from <ext-link ext-link-type="uri" xlink:href="https://www.cabidigitallibrary.org/doi/full/10.5555/19601600934">https://www.cabidigitallibrary.org/doi/full/10.5555/19601600934</ext-link></p>
<p>Fletcher, J. A., &amp; Zwick, M. (2006). Unifying the theories of inclusive fitness and reciprocal altruism. American Naturalist, 168(2), 252–262. doi: 10.1086/506529</p>
<p>Frank, S. A. (1997). The Price equation, Fisher’s fundamental theorem, kin selection, and causal analysis. Evolution, 51(6), 1712–1729. doi: 10.1111/j.1558-5646.1997.tb05096.x</p>
<p>Frank, S. A. (1998). Foundations of social evolution. Princeton: Princeton University Press.</p>
<p>Frank, S. A. (2012). Natural selection. IV. The Price equation*. Journal of Evolutionary Biology, 25(6), 1002–1019. doi: 10.1111/j.1420-9101.2012.02498.x</p>
<p>Gardner, A., West, S. A., &amp; Wild, G. (2011). The genetical theory of kin selection. Journal of Evolutionary Biology, 24(5), 1020–1043. doi: 10.1111/j.1420-9101.2011.02236.x</p>
<p>Grafen, A. (1985a). A geometric view of relatedness. Oxford Surveys in Evolutionary Biology, 2(2), 28-89.</p>
<p>Grafen, A. (1985b). News and Views. Evolutionary theory: Hamilton’s rule OK. Nature, 318(6044), 310–311. doi: 10.1038/318310a0</p>
<p>Hamilton, W. D. (1964). The genetical evolution of social behaviour. I. Journal of Theoretical Biology, 7(1), 1–16. doi: 10.1016/0022-5193(64)90038-4</p>
<p>Karlin, S., &amp; Matessi, C. (1983). The eleventh R. A. Fisher Memorial Lecture - Kin selection and altruism. Proceedings of the Royal Society of London. Series B. Biological Sciences, 219(1216), 327–353. doi: 10.1098/rspb.1983.0077</p>
<p>Matessi, C., &amp; Karlin, S. (1984). On the evolution of altruism by kin selection. Proceedings of the National Academy of Sciences, 81(6), 1754–1758. doi: 10.1073/pnas.81.6.1754</p>
<p>Nowak, M. A., Tarnita, C. E., &amp; Wilson, E. O. (2010). The evolution of eusociality. Nature, 466(7310), 1057–1062. doi: 10.1038/nature09205</p>
<p>Okasha, S. (2005). Maynard Smith on the levels of selection question. Biology and Philosophy, 20(5), 989–1010. doi: 10.1007/S10539-005-9019-1/METRICS</p>
<p>Page, K. M., &amp; Nowak, M. A. (2002). Unifying evolutionary dynamics. Journal of Theoretical Biology, 219(1). doi: 10.1016/S0022-5193(02)93112-7</p>
<p>Pillai, P., &amp; Gouhier, T. C. (2019). Not even wrong: the spurious measurement of biodiversity’s effects on ecosystem functioning. Ecology, 100(7), e02645. doi: 10.1002/ecy.2645</p>
<p>Price, G. R. (1970). Selection and Covariance. Nature, 227(5257), 520–521. doi: 10.1038/227520a0</p>
<p>Price, G. R. (1972). Extension of covariance selection mathematics. Annals of Human Genetics, 35(4), 485-490.</p>
<p>Queller, D. C. (1985). Kinship, reciprocity and synergism in the evolution of social behaviour. Nature, 318(6044), 366–367. doi: 10.1038/318366a0</p>
<p>Queller, D. C. (1992a). A general model for kin selection. Evolution, 46(2), 376–380. doi: 10.1111/j.1558-5646.1992.tb02045.x</p>
<p>Queller, D. C. (1992b). Quantitative Genetics, Inclusive Fitness, and Group Selection. The American Naturalist, 139(3), 540–558. doi: 10.1086/285343</p>
<p>Queller, D. C. (2011). Expanded social fitness and Hamilton’s rule for kin, kith, and kind. Proceedings of the National Academy of Sciences, 108(supplement_2), 10792–10799. doi: 10.1073/pnas.1100298108</p>
<p>Rousset, &amp; Billiard. (2000). A theoretical basis for measures of kin selection in subdivided populations: Finite populations and localized dispersal. Journal of Evolutionary Biology, 13(5). doi: 10.1046/j.1420-9101.2000.00219.x</p>
<p>Rousset, F. (2015). Regression, least squares, and the general version of inclusive fitness. Evolution, 69(11), 2963–2970. doi: 10.1111/evo.12791</p>
<p>Smith, J., Van Dyken, J. D., &amp; Zee, P. C. (2010). A generalization of hamilton’s rule for the evolution of microbial cooperation. Science, 328(5986), 1700–1703. doi: 10.1126/science.1189675</p>
<p>Sober, Elliott., &amp; Wilson, D. Sloan. (2007). Unto others : the evolution and psychology of unselfish behavior. 394. Retrieved from <ext-link ext-link-type="uri" xlink:href="https://www.hup.harvard.edu/books/9780674930476">https://www.hup.harvard.edu/books/9780674930476</ext-link></p>
<p>Taylor, P. D. (1992). Altruism in viscous populations - an inclusive fitness model. Evolutionary Ecology, 6(4), 352–356. doi: 10.1007/bf02270971</p>
<p>Taylor, Peter D. (1989). Evolutionary stability in one-parameter models under weak selection. Theoretical Population Biology, 36(2), 125–143. doi: 10.1016/00405809(89)90025-7</p>
<p>Taylor, Peter D., Day, T., &amp; Wild, G. (2007). Evolution of cooperation in a finite homogeneous graph. Nature, 447(7143), 469–472. doi: 10.1038/nature05784</p>
<p>Van Cleve, J. (2015). Social evolution and genetic interactions in the short and long term. Theoretical Population Biology, 103. doi: 10.1016/j.tpb.2015.05.002</p>
<p>van Veelen, M. (2005). On the use of the Price equation. Journal of Theoretical Biology, 237(4). doi: 10.1016/j.jtbi.2005.04.026</p>
<p>van Veelen, M. (2007). Hamilton’s missing link. Journal of Theoretical Biology, 246(3). doi: 10.1016/j.jtbi.2007.01.001</p>
<p>van Veelen, M. (2011). The replicator dynamics with n players and population structure. Journal of Theoretical Biology, 276(1). doi: 10.1016/j.jtbi.2011.01.044</p>
<p>van Veelen, M. (2018). Can Hamilton’s rule be violated? ELife, 7. doi: 10.7554/eLife.41901</p>
<p>van Veelen, M. (2020). The problem with the Price equation. Philosophical Transactions of the Royal Society B: Biological Sciences, 375(1797), 20190355. doi: 10.1098/rstb.2019.0355</p>
<p>van Veelen, M., Allen, B., Hoffman, M., Simon, B., &amp; Veller, C. (2017). Hamilton’s rule. Journal of Theoretical Biology, 414. doi: 10.1016/j.jtbi.2016.08.019</p>
<p>van Veelen, M., García, J., Sabelis, M. W., &amp; Egas, M. (2012). Group selection and inclusive fitness are not equivalent; the Price equation vs. models and statistics. Journal of Theoretical Biology, 299. doi: 10.1016/j.jtbi.2011.07.025</p>
<p>Wilson, D. S., Pollock, G. B., &amp; Dugatkin, L. A. (1992). Can altruism evolve in purely viscous populations? Evolutionary Ecology, 6(4), 331–341. doi: 10.1007/bf02270969</p>
<p>Wu, B., Gokhale, C. S., van Veelen, M., Wang, L., &amp; Traulsen, A. (2013). Interpretations arising from Wrightian and Malthusian fitness under strong frequency dependent selection. Ecology and Evolution, 3(5). doi: 10.1002/ece3.500</p>
</body>
</sub-article>
</article>