<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">86943</article-id>
<article-id pub-id-type="doi">10.7554/eLife.86943</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.86943.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Remapping in a recurrent neural network model of navigation and context inference</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6465-8459</contrib-id>
<name>
<surname>Low</surname>
<given-names>Isabel I.C.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0416-2528</contrib-id>
<name>
<surname>Giocomo</surname>
<given-names>Lisa M.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5853-103X</contrib-id>
<name>
<surname>Williams</surname>
<given-names>Alex H.</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Zuckerman Mind Brain Behavior Institute, Columbia University</institution></aff>
<aff id="a2"><label>2</label><institution>Department of Neurobiology, Stanford University</institution></aff>
<aff id="a3"><label>3</label><institution>Center for Computational Neuroscience, Flatiron Institute</institution></aff>
<aff id="a4"><label>4</label><institution>Center for Neural Science, New York University</institution></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Ostojic</surname>
<given-names>Srdjan</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>École Normale Supérieure - PSL</institution>
</institution-wrap>
<city>Paris</city>
<country>France</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Colgin</surname>
<given-names>Laura L</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Texas at Austin</institution>
</institution-wrap>
<city>Austin</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>Correspondence to: <email>il2419@columbia.edu</email>, <email>alex.h.williams@nyu.edu</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-05-09">
<day>09</day>
<month>05</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2023-06-16">
<day>16</day>
<month>06</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP86943</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-02-13">
<day>13</day>
<month>02</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-01-27">
<day>27</day>
<month>01</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.01.25.525596"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-05-09">
<day>09</day>
<month>05</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.86943.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.86943.1.sa3">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.86943.1.sa2">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.86943.1.sa1">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.86943.1.sa0">Reviewer #3 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Low et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Low et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-86943-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>Neurons in navigational brain regions provide information about position, orientation, and speed relative to environmental landmarks. These cells also change their firing patterns (“remap”) in response to changing contextual factors such as environmental cues, task conditions, and behavioral state, which influence neural activity throughout the brain. How can navigational circuits preserve their local computations while responding to global context changes? To investigate this question, we trained recurrent neural network models to track position in simple environments while at the same time reporting transiently-cued context changes. We show that these combined task constraints (navigation and context inference) produce activity patterns that are qualitatively similar to population-wide remapping in the entorhinal cortex, a navigational brain region. Furthermore, the models identify a solution that generalizes to more complex navigation and inference tasks. We thus provide a simple, general, and experimentally-grounded model of remapping as one neural circuit performing both navigation and context inference.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>Recurrent neural network models</kwd>
<kwd>dynamic coding</kwd>
<kwd>latent state</kwd>
<kwd>attractor manifolds</kwd>
<kwd>population coding</kwd>
<kwd>medial entorhinal cortex</kwd>
<kwd>navigation</kwd>
</kwd-group>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Minor changes, incorporating reviewer comments.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Neural circuit computations throughout the brain, from primary sensory cortex (<xref ref-type="bibr" rid="c5">Bennett et al., 2013</xref>; <xref ref-type="bibr" rid="c37">Niell and Stryker, 2010</xref>; <xref ref-type="bibr" rid="c53">Vinck et al., 2015</xref>; <xref ref-type="bibr" rid="c57">Zhou et al., 2014</xref>) to higher cognitive areas, (<xref ref-type="bibr" rid="c6">Boccara et al., 2019</xref>; <xref ref-type="bibr" rid="c7">Butler et al., 2019</xref>; <xref ref-type="bibr" rid="c26">Hardcastle et al., 2017b</xref>; <xref ref-type="bibr" rid="c28">Hulse et al., 2017</xref>; <xref ref-type="bibr" rid="c39">Pettit et al., 2022</xref>) are shaped by combinations of internal and external factors. Internal state changes, such as shifts in attention (<xref ref-type="bibr" rid="c19">Fenton et al., 2010</xref>; <xref ref-type="bibr" rid="c31">Kentros et al., 2004</xref>; <xref ref-type="bibr" rid="c39">Pettit et al., 2022</xref>), thirst (<xref ref-type="bibr" rid="c1">Allen et al., 2019</xref>), arousal (<xref ref-type="bibr" rid="c50">Stringer et al., 2019</xref>), and impulsivity (<xref ref-type="bibr" rid="c12">Cowley et al., 2020</xref>), can profoundly alter neural activity across multiple brain areas. This raises a question: how can individual brain regions with specialized functions integrate global state changes without compromising their local processing dynamics?</p>
<p>For example, neurons in the medial entorhinal cortex typically represent one or more features such as spatial position, heading direction, and environmental landmarks and are therefore thought to support navigation (<xref ref-type="bibr" rid="c16">Diehl et al., 2017</xref>; <xref ref-type="bibr" rid="c21">Gil et al., 2018</xref>; <xref ref-type="bibr" rid="c23">Hafting et al., 2005</xref>; <xref ref-type="bibr" rid="c25">Hardcastle et al., 2017a</xref>; <xref ref-type="bibr" rid="c27">Høydal et al., 2019</xref>; <xref ref-type="bibr" rid="c36">Moser et al., 2014</xref>; <xref ref-type="bibr" rid="c45">Sargolini et al., 2006</xref>; <xref ref-type="bibr" rid="c48">Solstad et al., 2008</xref>). At the same time, these neurons change their firing rates and shift their spatial firing positions—or “remap”—under a variety of circumstances, even when navigational cues remain stable (<xref ref-type="bibr" rid="c3">Bant et al., 2020</xref>; <xref ref-type="bibr" rid="c6">Boccara et al., 2019</xref>; <xref ref-type="bibr" rid="c7">Butler et al., 2019</xref>; <xref ref-type="bibr" rid="c8">Campbell et al., 2021</xref>, <xref ref-type="bibr" rid="c9">2018</xref>; <xref ref-type="bibr" rid="c26">Hardcastle et al., 2017b</xref>; <xref ref-type="bibr" rid="c34">Low et al., 2021</xref>). It is difficult to pinpoint the reason for these <italic>spontaneous remapping events</italic>—i.e., remapping not driven by changes in navigational features—in biological experiments. Theoretical models of this phenomenon propose that remapping occurs because these cells are responding to global contextual cues (like arousal or attention) in order to decorrelate related experiences with distinct contextual relevance (<xref ref-type="bibr" rid="c10">Colgin et al., 2008</xref>; <xref ref-type="bibr" rid="c44">Sanders et al., 2020</xref>). This process could enable animals to form distinct memories or choose appropriate actions for a given set of circumstances. However, these normative models (<xref ref-type="bibr" rid="c33">Levenstein et al., 2020</xref>) (i.e., theories for <italic>why</italic> remapping occurs) do not address how a biological system might implement this strategy.</p>
<p>To bridge the gap between existing theoretical models and biological observations of remapping in the entorhinal cortex, we sought to establish a minimal set of task constraints that could reproduce the essential dynamics of remapping in a computational model. Specifically, we tested the normative hypothesis that remapping occurs when a population of neurons must maintain its local navigational processing, while at the same time responding to global latent state changes (e.g., changes in behavioral state, task conditions, etc.; see <xref ref-type="bibr" rid="c44">Sanders et al. (2020)</xref>). We trained recurrent neural network models (RNNs) to maintain an estimate of position in a simple environment, while at the same time reporting a changing, transiently-cued latent state variable. In isolation, neither of these tasks is novel to the RNN literature—e.g., <xref ref-type="bibr" rid="c15">Cueva and Wei (2018)</xref> trained RNNs to path integrate in complex environments while <xref ref-type="bibr" rid="c51">Sussillo and Barak (2013)</xref> trained RNNs on a “1-bit flip-flop” memory task akin to our latent state inference task. Here we combine these two tasks to ask how a network would solve them simultaneously and to probe how this combination of tasks relates to remapping in navigational circuits.</p>
<p>We found that RNNs trained to navigate while inferring latent state changes exhibited network-wide activity patterns that were strikingly similar to those found in the brain (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>), suggesting a possible function for spontaneous remapping in the entorhinal cortex and other navigational brain areas. These activity patterns comprise a geometrically simple solution to the task of combining navigation with latent state inference. The RNN geometry and algorithmic principles readily generalized from a simple task to more complex settings. Furthermore, we performed a new analysis of experimental data published in <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref> and found a similar geometric structure in neural activity from a subset of sessions with more than two stable spatial maps. Overall, these results provide an interpretable and experimentally grounded account of how a single neural population might flexibly represent global brain state changes (corresponding here to remapping) and localized circuit computations (corresponding here to navigation) in orthogonal subspaces (<xref ref-type="bibr" rid="c30">Kaufman et al., 2014</xref>; <xref ref-type="bibr" rid="c42">Rule et al., 2020</xref>).</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>A recurrent neural network model of 1D navigation and context inference remaps between aligned ring manifolds</title>
<p>To investigate a putative functional role for spontaneous remapping in an unchanging environment, we developed a task that requires simultaneous latent state inference and navigation in a single neural circuit. To ground our model in experimental data, we designed our task to reflect the basic structure of a recent study (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>) (<xref rid="fig1" ref-type="fig">Figure 1A</xref>–<xref ref-type="fig" rid="fig1">D</xref>). In this study, Low et al. demonstrated that remapping in the medial entorhinal cortex simultaneously recruited large populations of neurons across the entorhinal cortical circuit. Remapping comprised discrete transitions between aligned neural activity manifolds, which each represented a distinct map of an unchanging, virtual reality 1D environment (<xref rid="fig1" ref-type="fig">Figure 1C</xref>–<xref ref-type="fig" rid="fig1">D</xref>). Remapping was not aligned to particular track positions, rewards, or landmarks. Instead, remapping correlated with transient decreases in running speed (<xref rid="fig1" ref-type="fig">Figure 1B</xref>), which could correspond to discrete changes in latent state (such as shifts in arousal, task engagement, or other behavioral states). Thus, we developed a task that requires a single neural circuit to navigate a 1D circular environment while inferring transiently cued, discrete latent state changes. We hypothesized that these task constraints would produce a manifold structure similar to that observed in Low et al. (<xref rid="fig1" ref-type="fig">Figure 1D</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>RNN models and biological neural circuits remap between aligned spatial maps of a single 1D environment</title>
<p>(A - D) are modified from Low et al.(<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>)</p>
<p>(A) Schematized task. Mice navigated virtual 1D circular-linear tracks with unchanging environmental cues and task conditions. Neuropixels recording probes were inserted during navigation.</p>
<p>(B)Schematic: slower running speeds correlated with remapping of neural firing patterns.</p>
<p>(C, left) An example medial entorhinal cortex neuron switches between two maps of the same track (top, spikes by trial and track position; bottom, average firing rate by position across trials from each map; red, map 1; black, map 2). (C, right/top) Correlation between the spatial firing patterns of all co-recorded neurons for each pair of trials in the same example session (dark gray, high correlation; light gray, low correlation). The population-wide activity is alternating between two stable maps across blocks of trials. (C, right/bottom) K-means clustering of spatial firing patterns results in a map assignment for each trial.</p>
<p>(D) PCA projection of the manifolds associated with the two maps (colorbar indicates track position).</p>
<p>(E) RNN models were trained on a simultaneous 1D navigation (velocity signal, top) and latent state inference (transient, binary latent state signal, bottom) task.</p>
<p>(F) Example showing high prediction performance for position (top) and latent state (bottom).</p>
<p>(G) As in (C), but for RNN units and network activity. Map is the predominant latent state on each trial.</p>
<p>(H) Example PCA projection of the moment-to-moment RNN activity (colormap indicates track position).</p>
<p>(I) Total variance explained by the principal components for network-wide activity across maps (top 3 principal components, red points).</p>
<p>(J) Normalized manifold misalignment scores across models (0, perfectly aligned; 1, p = 0.25 of shuffle).</p>
<p>(K) Cosine similarity between the latent state and position input and output weights onto the remap dimension (left) and the position subspace (right).</p></caption>
<graphic xlink:href="525596v3_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We trained recurrent neural network models (RNNs) with <italic>N</italic> = 248 units to integrate a 1D velocity input along a circular environment (equivalent to a 1D virtual track with seamless teleportation, as in <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref>)(<xref rid="fig1" ref-type="fig">Figure 1E</xref>, top) and to concurrently remember a binary latent state signal (<xref rid="fig1" ref-type="fig">Figure 1E</xref>, bottom). Trained RNNs achieve high performance in both tasks, indicating that they can correctly form a persistent representation of each latent state while maintaining a stable position estimate across states (100% correct state estimation; average angular position error after 300 steps (mean ± standard deviation): 8.13° ± 0.51°)(<xref rid="fig1" ref-type="fig">Figure 1F</xref>). To visualize trial-by-trial RNN activity, we provided the trained model with nonnegative velocity inputs and divided the resulting session into track traversals, labeling each traversal by the predominant latent state (<xref rid="fig1" ref-type="fig">Figure 1G</xref>, red, context 1; black, context 2). As in biological data (<xref rid="fig1" ref-type="fig">Figure 1C</xref>), single units and network-wide activity alternated between distinct maps of the same environment across the two latent states (<xref rid="fig1" ref-type="fig">Figure 1G</xref>). Similar to biological neurons, single RNN units remapped heterogeneously (<xref rid="figS1" ref-type="fig">Supplemental Figure 1</xref>). Units changed their spatial firing field locations to a similar extent as biological neurons, but changes in firing rate were more common in the model units.</p>
<p>When we projected the hidden layer activity into the subspace defined by the first three principle components, the activity occupied two distinct rings, where position along each ring corresponded to position on the linear track (<xref rid="fig1" ref-type="fig">Figure 1H</xref>, red to blue color map). Together, these top 3 components explained ∼50% of the variance (<xref rid="fig1" ref-type="fig">Figure 1I</xref>, red points). As in <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref>, we used Procrustes shape analysis to demonstrate that these rings were more aligned in high-dimensional activity space than expected by chance for all trained models, such that the position along one ring matched the position on the second ring (<xref rid="fig1" ref-type="fig">Figure 1J</xref>). Thus, these task constraints are sufficient to organize randomly initialized synaptic weights into a network model that qualitatively reproduces the remapping dynamics and representational geometry that Low et al. observed in the entorhinal cortex (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>).</p>
</sec>
<sec id="s2b">
<title>RNN geometry is interpretable</title>
<p>We next considered the network geometry in more detail, asking how much of the geometry arises necessarily from the task design. Some basic features of the network structure follow intuitively from components of the task. First, the RNN must maintain an estimate of 1D circular position, which is best achieved through approximate ring attractors (<xref ref-type="bibr" rid="c14">Cueva et al., 2019</xref>). Thus we expect the model to form two ring attractors, one for each of the two distinct latent state conditions, which would explain the two ring-shaped manifolds that we observe. Second, the network must track two statistically independent information streams and should therefore develop separate orthogonal subspaces for each stream (<xref ref-type="bibr" rid="c30">Kaufman et al., 2014</xref>). One subspace, the “position subspace,” should contain the position tuning curves for all neurons, as well as the RNN readout weights for position. The other subspace, the “remapping dimension,” should be tuned to changes in latent state and contain the readout weights for state. We confirmed that these dimensions were orthogonal to one another (<xref rid="fig1" ref-type="fig">Figure 1K</xref>, <xref rid="figS2" ref-type="fig">Supplemental Figure 2</xref>, Methods), such that changes in latent state do not interfere with changes in position and vice versa.</p>
<p>However, as we show in detail below, the task does not require the two ring manifolds to be strictly aligned in high dimensional activity space. The RNN maintains a stable position estimate in spite of switches in latent state—which we call “remapping events”—that may occur anywhere along the circular track. To do so, the RNN must implement an invertible remapping function to match track locations across the two ring manifolds. This remapping function could be complex and high dimensional (<xref rid="fig2" ref-type="fig">Figure 2A</xref>), resulting in misaligned manifolds, or it could take the form of a simple translation in firing rate space (<xref rid="fig2" ref-type="fig">Figure 2B</xref>), resulting in aligned manifolds. The RNN could implement a complex remapping function using its recurrent dynamics, but this implementation could lead to a delay between the latent state signal and remapping. We therefore reasoned that the RNN might converge to the simpler configuration, allowing the linear input layer to implement remapping and thereby enabling rapid remapping in a single timestep.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><title>The ring attractors are more aligned than strictly required by the task.</title>
<p>(A) Schematic illustrating how the two attractor rings could be misaligned in the nullspace of the position output weights (left) while still allowing linear position decoding (right)(colormap, track position; solid arrows, remapping vectors; dashed arrow, projection onto the position subspace).</p>
<p>(B) Schematic illustrating perfect manifold alignment (colors as in A)</p>
<p>(C) Normalized difference between the true remapping vectors for all position bins and all models and the ideal remapping vector (dashed line, p = 0.025 of shuffle; n = 50 position bins, 15 models).</p>
<p>(D) Dimensionality of the remapping vectors for an example model. (Right) Total variance explained by the principal components for the remapping vectors (red points, top 2 PCs). (Left) Relative variance explained by the remapping vectors (red) and the position rings (blue)(1 = total network variance).</p>
<p>(E) The remapping vectors vary smoothly over position. (Right) Projection of the remapping vectors onto the first 2 PCs. (Left) Normalized covariance of the remapping vectors for each position bin (blue, min; yellow, max).</p></caption>
<graphic xlink:href="525596v3_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>It is useful to mathematically formalize these ideas to show that the alignment of the two ring manifolds is not strictly imposed by the task. Consider an RNN with <italic>N</italic> neurons and, for simplicity, consider a discrete grid of <italic>P</italic> position bins indexed by <italic>p</italic> ∈ {1, …, <italic>P</italic>}. Let <italic>x</italic> <sub><italic>p</italic></sub> <sup>(1)</sup> denote an <italic>N</italic>-dimensional vector corresponding to the neural firing rates in spatial bin <italic>p</italic> along the first ring attractor (i.e. position <italic>p</italic> in state 1). Likewise, let <italic>x</italic> <sub><italic>p</italic></sub> <sup>(2)</sup> denote the corresponding firing rate vector in the second ring attractor (i.e. position <italic>p</italic> in state 2). We can compute <italic>x</italic> <sub><italic>p</italic></sub> <sup>(1)</sup> and <italic>x</italic> <sub><italic>p</italic></sub> <sup>(2)</sup> by averaging the RNN activations across many simulated trials, similar to how spatial tuning curves are estimated in biological data.</p>
<p>Let <italic>W</italic> denote the 2 × <italic>N</italic> matrix holding the readout layer weights used to decode angular position θ by predicting cos θ and sin θ (see STAR Methods). The linearity of this decoder imposes a constraint that <italic>Wx</italic> <sub><italic>p</italic></sub><sup>(1)</sup> = <italic>Wx</italic> <sub><italic>p</italic></sub><sup>(2)</sup> for all <italic>p</italic>; otherwise, the decoded position will erroneously depend on which latent state is active. Importantly, this constraint does not imply that the two rings must have the same shape nor that they must be aligned. To see this let ξ<sub>1</sub>, …, ξ <sub><italic>P</italic></sub> denote any arbitrary set of <italic>N</italic>-dimensional vectors in the nullspace of <italic>W</italic> (i.e., we have <italic>W</italic>ξ <sub><italic>P</italic></sub>= 0) and define <italic>x</italic><sub><italic>p</italic></sub> <sup>(2)</sup> = <italic>x</italic><sub><italic>p</italic></sub> <sup>(1)</sup> + ξ<sub><italic>p</italic></sub> . Then it is easy to see that the constraint is satisfied,
<disp-formula id="ueqn1">
<alternatives><graphic xlink:href="525596v3_ueqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>Because each ξ <sub><italic>p</italic></sub> was chosen arbitrarily from the nullspace of <italic>W</italic>, an (<italic>N</italic> − 2)-dimensional subspace, there are many configurations of the two rings that are compatible with linear decoding of position (<xref rid="fig2" ref-type="fig">Figure 2A</xref>). An alternative, lower-dimensional network geometry would instead remap along a constant <italic>N</italic>-dimensional translation vector <italic>v</italic>, such that we have <italic>x</italic> <sub><italic>p</italic></sub> <sup>(2)</sup> = <italic>x</italic> <sub><italic>p</italic></sub> <sup>(1)</sup> + <bold><italic>v</italic></bold> (approximately) for all positions <italic>p</italic> (<xref rid="fig2" ref-type="fig">Figure 2B</xref>).</p>
<p>We now explore each of these intuitions in our data to see how well the trained RNN matches our expectations. First, how closely do the manifolds match the best alignment wherein<italic>x</italic><sub><italic>p</italic></sub> <sup>(2)</sup> = <italic>x</italic><sub><italic>p</italic></sub> <sup>(1)</sup> + <bold><italic>v</italic></bold> ? We computed the empirical remapping vectors ξ<sub><italic>p</italic></sub> = <italic>x</italic><sub><italic>p</italic></sub> <sup>(2)</sup> − <italic>x</italic><sub><italic>p</italic></sub> <sup>(1)</sup> for each position bin and verified that <italic>W</italic>ξ<sub><italic>p</italic></sub> ≈ 0 for all positions (mean <italic>W</italic>ξ<sub><italic>p</italic></sub> ± sem: 9x10<sup>−6</sup> ± 10<sup>−5</sup>). We then defined <bold><italic>v</italic></bold> to be the average of these remapping vectors, <bold><italic>v</italic></bold> = ⟨ξ<sub><italic>p</italic></sub> ⟩. If the manifolds were perfectly aligned then we would observe ξ<sub><italic>p</italic></sub> = <bold><italic>v</italic></bold> for all positions <italic>p</italic>.</p>
<p>We instead find that there is some variability in the remapping vectors, such that ξ<sub>1</sub>, …, ξ<sub><italic>p</italic></sub> are not exactly equal to one another (<xref rid="fig2" ref-type="fig">Figure 2C</xref>). Indeed, when we perform PCA on the <italic>p</italic> × <italic>N</italic> matrix formed by concatenating the vectors ξ<sub>1</sub>, …, ξ<sub><italic>p</italic></sub>, we find that remapping dimensions lie within a 2-dimensional subspace (<xref rid="fig2" ref-type="fig">Figure 2D, E</xref>), in contrast to our original conjecture that remapping vectors would be effectively zero-dimensional (i.e. ξ<sub><italic>p</italic></sub> = <bold><italic>v</italic></bold> for all positions). Nonetheless, the idealized model in which each ξ<sub><italic>p</italic></sub> ≈ <bold><italic>v</italic></bold> is a much better fit to the observed RNN dynamics than would be expected by chance. When we randomly rotate the orientation of the two rings in the nullspace of <italic>W</italic>, we find that this approximation is much worse (<xref rid="fig2" ref-type="fig">Figure 2C</xref>, dashed line).</p>
<p>Altogether, these findings suggest that RNN models trained on a simultaneous latent state inference and navigation task converge to a geometrically simple solution out of the space of all possible, high-dimensional solutions. This simpler solution recapitulates the geometry of entorhinal cortical dynamics during remapping in virtual reality environments (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>). Notably, neither the RNN nor the biological data are consistent with the simplest 3-dimensional solution, as evidenced by the imperfect ring alignment (<xref ref-type="bibr" rid="c34">Low et al. (2021)</xref> and <xref rid="fig1" ref-type="fig">Figure 1J</xref>), the variable remapping vectors (<xref rid="fig2" ref-type="fig">Fig. 2C-D</xref>), and the dimensionality of the network (which is &gt; 3; <xref rid="fig1" ref-type="fig">Figure 1I</xref>).</p>
</sec>
<sec id="s2c">
<title>RNN dynamics follow two ring attractor manifolds</title>
<p>While neural manifold geometry can provide clues about the computational mechanisms at play in the system, one advantage of RNN models is that we can precisely characterize the structure and logic of their dynamics using tools from nonlinear systems analysis (<xref ref-type="bibr" rid="c35">Maheswaranathan et al., 2019</xref>; <xref ref-type="bibr" rid="c51">Sussillo and Barak, 2013</xref>). As we describe below, these tools reveal several insights into the underlying network computations that are not easy to experimentally demonstrate in biological networks.</p>
<p>Each RNN defines a nonlinear, discrete-time dynamical system, <italic>x</italic> <sub><italic>t</italic>+1</sub> = <italic>f</italic>(<italic>x</italic> <sub><italic>t</italic></sub>, <bold><italic>u</italic></bold> <sub><italic>t</italic></sub>), where <italic>f</italic>(·, ·) is a nonlinear function parameterized by synaptic weight matrices and <bold><italic>u</italic></bold><sub>1</sub>, …, <bold><italic>u</italic></bold> <sub><italic>T</italic></sub> defines a sequence of latent state cues and velocity inputs to the network. Using methods pioneered in <xref ref-type="bibr" rid="c51">Sussillo &amp; Barak (2013)</xref>, we used numerical optimization to identify <italic>approximate fixed points</italic>, which are N-dimensional vectors <italic>x</italic><sub>*</sub> that satisfy <italic>f</italic>(<italic>x</italic><sub>*</sub>, <bold><italic>u</italic></bold>) ≈ <italic>x</italic><sub>*</sub> for a specified input <bold><italic>u</italic></bold>. In particular, we studied the case where <bold><italic>u</italic></bold> = 0, corresponding to a situation where no velocity or context input is provided to the network. Intuitively, the network should approach a fixed point when no velocity or context input is provided because the position and latent state is unchanging.</p>
<p>The fixed points of the RNN provide a backbone for understanding its dynamics. While the global RNN dynamics are complex and nonlinear, the dynamics near any fixed point <italic>x</italic><sub>*</sub> can be approximated as a linear dynamical system governed by the <italic>N</italic> × <italic>N</italic> Jacobian matrix of partial derivatives ∂<italic>f</italic> <sub><italic>i</italic></sub> /∂<italic>x</italic> <sub><italic>j</italic></sub> evaluated at <italic>x</italic> = <italic>x</italic><sub>*</sub> and <bold><italic>u</italic></bold> = 0 (see STAR Methods).</p>
<p>We computed these Jacobian matrices across 988 fixed points in the trained RNN shown in <xref rid="fig1" ref-type="fig">Figure 1</xref>. Roughly 60% of these fixed points were located on one of the two previously described ring manifolds and largely had marginally stable linear dynamics (largest Jacobian eigenvalue ≈ 1; <xref rid="fig3" ref-type="fig">Figure 3</xref>, color-coded green). The remaining fixed points were located between the two ring manifolds and had unstable dynamics (largest Jacobian eigenvalue &gt; 1; <xref rid="fig3" ref-type="fig">Figure 3</xref>, color-coded gold). In essence, this analysis confirms that the RNN dynamics indeed implemented a pair of ring attractors. Further, a collection of unstable fixed points form a boundary between the two stable ring attractor basins. In line with observations by Susillo &amp; Barak (2013)on a discrete flip-flop task, these intermediate fixed points are unstable along a small number of dimensions (i.e. saddle fixed points; <xref rid="fig3" ref-type="fig">Figure 3D</xref>, gold points) which “funnel” neural activity to the appropriate location during a remapping event.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><title>RNN dynamics follow stable ring attractor manifolds mediated by a ring of saddle points</title>
<p>(A) Fixed points (gray) reside on the two ring manifolds and in a ring between them (gray, all fixed points; colors, example fixed points for B and D).</p>
<p>(B) The maximum real component of each fixed point (shading, marginally stable or unstable points; colored points, examples from A). Dashed red lines indicate cut-off values for fixed points to be considered marginally stable (λ ≈ 1).</p>
<p>(C) Projection of fixed points onto the remapping dimension (-1, map 1 centroid; 1, map 2 centroid; 0, midpoint between manifolds).</p>
<p>(D) Distribution of eigenvalues (colored points) in the complex plane for each example fixed point from (A) (black line, unit circle).</p>
<p>(E) Cosine similarity between the eigenvectors associated with the largest magnitude eigenvalue of each fixed point and the remap dimension (top) or the position subspace (bottom).</p>
<p>(F) Eigenvector directions for 48 example fixed points (black lines, eigenvectors).</p>
<p>(G) Projection of the example fixed points closest to each manifold onto the respective position subspace (top) and zoom on an example fixed point for each manifold (bottom, red box)(purple, estimated activity manifold; dashed line, approximate position estimate).</p>
<p>Green indicates marginally stable points and gold indicates unstable points throughout.</p></caption>
<graphic xlink:href="525596v3_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>This interpretation is supported by examining the principal eigenvector—i.e. the eigenvector associated with the largest magnitude eigenvalue—for each fixed point. For the fixed points along the two ring attractors, this eigenvector corresponds to a slow dimension along which <italic>x</italic> does not grow or decay (i.e., its associated eigenvalue λ ≈ 1)(<xref rid="fig3" ref-type="fig">Figure 3D</xref>, green points). Consistent with a mechanism for integrating positional information, these eigenvectors were nearly orthogonal to the remapping dimension and aligned with the position subspace (<xref rid="fig3" ref-type="fig">Figure 3E-G</xref>, green). Conversely, for the unstable fixed points, the principal eigenvector corresponds to a dimension along which <italic>x</italic> moves rapidly away from the fixed point (i.e., its associated eigenvalue λ &gt; 1)(<xref rid="fig3" ref-type="fig">Figure 3D</xref>, gold points). Consistent with a mechanism for “funneling” activity during remapping events, these eigenvectors were aligned with the remapping dimension and nearly orthogonal to the position subspace (<xref rid="fig3" ref-type="fig">Figure 3E-F</xref>, yellow).</p>
</sec>
<sec id="s2d">
<title>Aligned toroidal manifolds emerge in a 2D generalization of the task</title>
<p>Virtual 1D tracks are an ideal setting to experimentally study spontaneous remapping: the environmental cues can be tightly controlled and it is possible to sample an identical spatial trajectory hundreds of times, such that remapping events can be easily identified from the neural activity alone. But navigation is often studied in 2D environments, in which it is more difficult to control the animal’s experience and the animal can pursue an essentially infinite number of trajectories through the environment. Thus, while it is of interest to understand what remapping in the entorhinal cortex might look like in 2D spaces, it remains challenging to identify spontaneous remapping in biological data. In contrast, the RNN modeling framework that we have developed here can be readily generalized to 2D spatial environments. Are the computational solutions identified by the RNNs fundamentally different in this case? Or do RNNs use similar geometric structures and algorithmic principles across these related tasks?</p>
<p>To investigate this question, we again trained models to simultaneously integrate velocity inputs and estimate latent state from transient state cues, but this time we provided two velocity inputs and asked the models to estimate position on a 2D circular track (<xref rid="fig4" ref-type="fig">Figure 4A</xref>, right). As before, the models performed well on both components of the task (mean loss ± sem: position estimate, 0.036 ± 1.1x10<sup>−3</sup>; latent state estimate, 0.002 ± 1.9x10<sup>−5</sup>)(<xref rid="fig4" ref-type="fig">Figure 4A</xref>) and single unit activity was modulated by both spatial position and latent state (<xref rid="fig4" ref-type="fig">Figure 4B</xref>). When we projected the activity into a subspace defined by the first three principal components, the activity occupied two distinct toroidal manifolds with position on each torus corresponding to the position in the 2D space (<xref rid="fig4" ref-type="fig">Figure 4C</xref>). Notably, each toroidal manifold alone is reminiscent of networks trained to store two circular variables without remapping (Cueva, Ardalan, et al., 2021). In keeping with these qualitative observations, four principal components explained ∼50% of the variance in network activity (<xref rid="fig4" ref-type="fig">Figure 4D</xref>) and the manifolds were again highly, though not perfectly, aligned in the full-dimensional activity space (<xref rid="fig4" ref-type="fig">Figure 4E</xref>). By holding either the horizontal (X) or vertical (Y) position variable constant during the RNN simulation, we recover a pair of 1D aligned ring manifolds (<xref rid="fig4" ref-type="fig">Figure 4F</xref>). That is, we can recover the geometry of the original 1D task (see <xref rid="fig1" ref-type="fig">Figure 1</xref>) by taking “slices” through the toroidal manifolds. The remapping and position dimensions were again orthogonalized in these models (<xref rid="fig4" ref-type="fig">Figure 4G</xref>). Thus models trained on a 2D navigation task with latent state inference identified a geometrically similar solution to those trained on a 1D task. These findings demonstrate that spontaneous remapping is possible in 2D and may operate under similar mechanisms as in 1D.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><title>An RNN model of 2D navigation and context inference remaps between aligned toroidal manifolds</title>
<p>(A) (Left) Schematic illustrating the 2D navigation with simultaneous latent state inference task. (Right) As in <xref ref-type="fig" rid="fig1">Fig. 1E</xref>, but RNN models were trained to integrate two velocity inputs (X, Y) and output a 2D position estimate, in addition to simultaneous latent state inference.</p>
<p>(B) Position-binned activity for three example units in latent state 1 (top) and latent state 2 (bottom)(colormap indicates normalized firing rate; blue, minimum; yellow, maximum).</p>
<p>(C) Example PCA projection of the moment-to-moment RNN activity from a single session into three dimensions (colormap indicates position; left, X position; right, Y position). Note that the true tori are not linearly embeddable in 3 dimensions, so this projection is an approximation of the true torus structure.</p>
<p>(D) Average cumulative variance explained by the principal components for network-wide activity across maps (top 4 principal components, red points).</p>
<p>(E) Normalized manifold misalignment scores for all models (0, perfectly aligned; 1, p = 0.25 of shuffle).</p>
<p>(F) Example PCA projection of slices from the toroidal manifold where Y (left) or X (right) position is held constant, illustrating the substructure of RNN activity.</p>
<p>(G) Cosine similarity between the latent state and position input and output weights onto the remap dimension (left) and the position subspace (right), defined for each pair of maps.</p></caption>
<graphic xlink:href="525596v3_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2e">
<title>Manifold alignment generalizes to three or more maps</title>
<p>It is simplest to consider remapping as switches between two maps, but neural activity can conceivably switch between any number of maps. Indeed, while Low et al. most commonly observed remapping between two maps of the same virtual track, they occasionally found transitions between more than two maps (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>). Because these “multi-map” sessions were rare, Low et al. predominantly limited their analysis to the more common “2-map” sessions. Nonetheless, there were notable similarities between the 2-map and multi-map sessions. In particular, remapping was correlated with changes in running speed and position was preserved across remapping events (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>). We reasoned that we could study the geometry of “multi-map” sessions using RNN models to gain insight into what we might expect to see in biological data. In particular, do multiple ring manifolds corresponding to multiple spatial maps emerge and are these ring manifolds still geometrically aligned with each other?</p>
<p>We trained models to integrate a 1D velocity input, while tracking three (instead of two) binary state switch cues (<xref rid="fig5" ref-type="fig">Figure 5A</xref>). Models performed well on both task components (mean loss ± sem: position estimate, 0.013 ± 3.6x10<sup>−4</sup>; latent state estimate, 0.0039 ± 4.9x10<sup>−5</sup>) and single unit activity was modulated by both spatial position and latent state (<xref rid="fig5" ref-type="fig">Figure 5B</xref>). Importantly, we found that the same essential geometry of the original task was preserved. When we visualized each pair of maps using PCA, the ring manifolds were again qualitatively aligned (<xref rid="fig5" ref-type="fig">Figure 5C</xref>, right). Projecting the activity from all three maps into the same subspace revealed that they were further organized as vertices of an equilateral triangle (<xref rid="fig5" ref-type="fig">Figure 5C</xref>, left)—i.e. the acute angle between any two remapping dimensions was 60° (<xref rid="fig5" ref-type="fig">Figure 5D</xref>). Again, the network geometry was relatively low-dimensional (4 principal components explained ∼60% of the variance; 14 principal components, ∼90% of the variance)(<xref rid="fig5" ref-type="fig">Figure 5E</xref>). Procrustes analysis revealed that all pairs of manifolds were highly aligned relative to chance, with a similar degree of alignment across ring manifold pairs and across RNNs (<xref rid="fig5" ref-type="fig">Figure 5F</xref>). Finally, positional and latent state information were orthogonalized, as before (<xref rid="fig5" ref-type="fig">Figure 5G</xref>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><title>An RNN model of 1D navigation and identification of three latent states remaps between three aligned ring manifolds.</title>
<p>(A) (Left) RNN models were trained to navigate in 1D (velocity signal, top) and discriminate between three distinct contexts (transient, binary latent state signal, bottom). (Right) Example showing high prediction performance for position (top) and context (bottom).</p>
<p>(B) Position-binned activity for six example single RNN units, split by context (colors as in (A)).</p>
<p>(C) Example PCA projection of the moment-to-moment RNN activity into three dimensions (colormap indicates track position) for all three contexts (left) and for each pair of contexts (right).</p>
<p>(D) Schematic: (Top) The hypothesized orthogonalization of the position and context input and output weights. (Bottom) Across maps, corresponding locations on the 1D track occupy a 2D remapping subspace in which the remapping dimensions between each pair are maximally separated (60°).</p>
<p>(E) Total variance explained by the principal components for network-wide activity across maps (top 4 principal components, red points).</p>
<p>(F) Normalized manifold misalignment scores between each pair of maps across all models (0, perfectly aligned; 1, p = 0.25 of shuffle).</p>
<p>(G) Cosine similarity between the latent state and position input and output weights onto the remap dimension (left) and the position subspace (right), defined for each pair of maps.</p></caption>
<graphic xlink:href="525596v3_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In <xref rid="figS3" ref-type="fig">Supplemental Figure 3</xref>, we show that RNNs are capable of solving this task with larger numbers of latent states (more than three; for simplicity, we consider up to 10 states). Further, the RNN dynamics and geometry generalize accordingly: each latent state is associated with a different ring attractor and every pair of ring attractors is highly aligned. Motivated by these observations, we revisited a subset of experimental sessions from <xref ref-type="bibr" rid="c34">Low et al (2021)</xref> (N = 4 sessions from 2 mice) that exhibited remapping between 3 – 4 stable maps of the same virtual track (<xref rid="fig6" ref-type="fig">Figure 6A-B</xref>; <xref rid="figS4" ref-type="fig">Supplemental Figure 4</xref>) for a pilot comparison with the RNN models, which we hope will inspire future experimental analysis. As in <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref> we first confirmed that these remapping events did not reflect recording probe movement by comparing the waveforms from different maps across the session, which were highly stable (<xref rid="fig6" ref-type="fig">Figure 6B</xref>, right; <xref rid="figS4" ref-type="fig">Supplemental Figure 4</xref>).</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><title>Biological recordings with more than two maps recapitulate many geometric features of the recurrent neural network models.</title>
<p>(A - B) are modified from (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>)</p>
<p>(A) Schematic: Mice navigated virtual 1D circular-linear tracks with unchanging environmental cues and task conditions. Neuropixels recording probes were inserted during navigation.</p>
<p>(B) Examples from the 3-map Session A. (Left/top) Network-wide trial-by-trial correlations for the spatial firing pattern of all co-recorded neurons in the same example session (colorbar indicates correlation). (Left/bottom) k-means map assignments. (Middle) An example medial entorhinal cortex neuron switches between three maps of the same track (top, raster; bottom, average firing rate by position; teal, map 1; red, map 2; black, map 3). (Right) Overlay of average waveforms sampled from each of the three maps.</p>
<p>(C) PCA projection of the manifolds associated with each pair of maps from the 4-map Session D (colorbar indicates virtual track position).</p>
<p>(D) Normalized manifold misalignment scores between each pair of maps across all sessions (0, perfectly aligned; 1, p = 0.25 of shuffle).</p>
<p>(E) (Left) Schematic: maximal separation between all remapping dimensions for 3 and 4 maps. (Right) Angle between adjacent pairs of remapping dimensions for all sessions (dashes, ideal angle).</p></caption>
<graphic xlink:href="525596v3_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To examine the manifold structure of the neural data, we projected the neural tuning curves associated with each pair of maps into the subspace defined by the first three principle components. In many sessions, population-wide activity across the two maps occupied distinct, qualitatively aligned rings, where position along each ring corresponded to position along the virtual track (<xref rid="fig6" ref-type="fig">Figure 6C</xref>). Procrustes analysis revealed that these pairs of maps were largely more aligned than expected by chance (<xref rid="fig6" ref-type="fig">Figure 6D</xref>; 13/18 map pairs more aligned than shuffle). Notably, 5 map pairs from one mouse (3 in session A, 2 in session D) were not aligned (<xref rid="fig6" ref-type="fig">Figure 6D</xref>, black and teal points), suggesting that manifold alignment does not always emerge in biological data. Finally, we asked whether the remapping dimensions from the biological sessions were organized symmetrically, as in the model (<xref rid="fig6" ref-type="fig">Figure 6E</xref>, left). We found that there were a range of acute angles between pairs of remapping dimensions (<xref rid="fig6" ref-type="fig">Figure 6E</xref>, right), suggesting that there was more asymmetry in the biological network geometry than in the model.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Previous experimental studies have found that neurons in the medial entorhinal cortex change their firing patterns in response to changes in task conditions, behavioral state, or visual and motor cues (<xref ref-type="bibr" rid="c3">Bant et al., 2020</xref>; <xref ref-type="bibr" rid="c6">Boccara et al., 2019</xref>; <xref ref-type="bibr" rid="c7">Butler et al., 2019</xref>; <xref ref-type="bibr" rid="c8">Campbell et al., 2021</xref>, <xref ref-type="bibr" rid="c9">2018</xref>; <xref ref-type="bibr" rid="c26">Hardcastle et al., 2017b</xref>). In virtual reality environments, these remapping events can recruit neurons across the entorhinal cortical circuit to rapidly switch between distinct maps of the same track (<xref ref-type="bibr" rid="c8">Campbell et al., 2021</xref>; <xref ref-type="bibr" rid="c34">Low et al., 2021</xref>). Here, we used RNN models to explore a normative hypothesis that these remapping dynamics reflect hidden state inference (<xref ref-type="bibr" rid="c10">Colgin et al., 2008</xref>; <xref ref-type="bibr" rid="c44">Sanders et al., 2020</xref>). We showed that RNNs initialized from random synaptic weights recapitulate the essential features of biological data—aligned ring manifolds (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>)—when trained to remember a binary latent state variable and to simultaneously integrate a velocity signal in a circular environment. RNNs learn to represent positional and state change information in orthogonal subspaces such that navigation and latent state inference co-occur without interference. Further, we demonstrated that the geometry and algorithmic principles of this solution readily generalize to more complex tasks including navigation in 2D environments and tasks involving three or more latent states. These findings provide a jumping off point for new analyses of remapping in neural data, which we demonstrated in a pilot analysis of neural data from <xref ref-type="bibr" rid="c34">Low et al (2021)</xref>.</p>
<p>These results complement an existing body of theoretical and experimental work on the neural basis of navigation. <xref ref-type="bibr" rid="c19">Fenton et al. (2010)</xref> proposed that the hippocampus constructs multiple spatial maps that are anchored to different landmarks; when the animal’s attention switches between these reference points, hippocampal cells remap (see also ref. (<xref ref-type="bibr" rid="c32">Kubie et al., 2020</xref>)). This proposal is consistent with the idea that the hippocampal circuit groups navigational episodes into discrete categories by combining internal context with external landmarks (<xref ref-type="bibr" rid="c10">Colgin et al., 2008</xref>; <xref ref-type="bibr" rid="c20">Fuhs and Touretzky, 2007</xref>; <xref ref-type="bibr" rid="c44">Sanders et al., 2020</xref>). Related experimental work demonstrates that an animal’s prior experience with an environment can shape how the hippocampus delineates these categories (<xref ref-type="bibr" rid="c40">Plitt and Giocomo, 2021</xref>). Each of these hypotheses can be seen as layering a discrete latent variable (e.g. changes in reference landmarks, task context, or prior experience) on top of a distributed neural code of position, which are the essential ingredients of our RNN task. While we draw explicit comparisons with spontaneous remapping in the entorhinal cortex (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>), <xref ref-type="bibr" rid="c47">Sheintuch et al. (2020)</xref> reported similar experimental findings in the hippocampus, highlighting the broad relevance of this remapping phenomenon and our modeling efforts. We explored these topics in a general modeling framework applicable to any circuit that supports navigation through physical space and even navigation of abstract cognitive spaces (<xref ref-type="bibr" rid="c2">Aronov et al., 2017</xref>; <xref ref-type="bibr" rid="c11">Constantinescu et al., 2016</xref>; <xref ref-type="bibr" rid="c54">Whittington et al., 2020</xref>).</p>
<p>In our task, discrete switches in latent state are signaled by brief impulses to the RNN, such that the navigational circuit must maintain a persistent representation of the latent state based on these transient cues. This simple task design allowed us to clearly identify the minimal set of constraints that produces aligned ring attractors. In particular, our results suggest that aligned ring attractors could emerge even if upstream circuits trigger latent state changes and signal these changes to downstream navigational circuits. Indeed, Low et al. found that remapping was correlated with brief decreases in running speed (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>), suggesting that this temporary behavioral state change—which is known to have widespread impacts on global brain activity (<xref ref-type="bibr" rid="c50">Stringer et al., 2019</xref>)—may serve as an external trigger of remapping in the entorhinal cortex. Extensions to our task could build on this basic framework by asking the network to infer state changes given a noisy input or using a more complex interaction with the environment (e.g., through reinforcement learning paradigms (<xref ref-type="bibr" rid="c52">Uria et al., 2020</xref>)).</p>
<p>The mechanisms of remapping in biological circuits are still poorly understood, but have been modeled using multistable attractor dynamics for several decades (<xref ref-type="bibr" rid="c43">Samsonovich and McNaughton, 1997</xref>). Classically, these models were engineered and hand-tuned to produce the desired attractor dynamics. In contrast, RNN models are indirectly engineered by specifying task constraints and a learning algorithm (<xref ref-type="bibr" rid="c56">Yang and Wang, 2021</xref>). Thus, our observation that trained RNNs produce multistable attractor manifolds is nontrivial, because different solutions might have, in principle, emerged. Despite this key similarity, there are notable differences between our models and classical multistable attractor models. Classical models typically store completely decorrelated spatial maps (<xref ref-type="bibr" rid="c43">Samsonovich and McNaughton, 1997</xref>), while our RNNs produce distinct maps that are, by construction, perfectly correlated in the position readout dimensions. <xref ref-type="bibr" rid="c41">Romani &amp; Tsodyks (2010)</xref> studied the effects of adding correlation to spatial maps in forward-engineered multistable attractor networks, as did <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref> Fundamentally, these and other forward-engineered models provide insights into <italic>how</italic> neural circuits may remap, but do not answer <italic>why</italic> they do so. We investigated the latter question in this work by identifying a minimal set of task constraints that provide a putative explanation for why the entorhinal cortex spontaneously remaps.</p>
<p>Other work has studied remapping in trained artificial networks performing navigation (<xref ref-type="bibr" rid="c46">Schøyen et al., 2022</xref>; <xref ref-type="bibr" rid="c52">Uria et al., 2020</xref>). Unlike our results, these papers typically consider remapping across different physical environments. Whittengton et al. (2020) propose a normative model and a neural circuit that supports non-spatial remapping, which is perhaps most similar to the task constraints we studied. However, our investigation focused on a simpler and more targeted computational task to draw a tighter link to a specific biological finding and to perform a deeper examination of the resulting population geometry and dynamical structure.</p>
<p>While we were motivated to study remapping in the specific context of navigational circuits, our results have broader implications for understanding how RNNs perform complex, context-dependent computations. This topic has attracted significant interest. For example, RNNs trained in many computational tasks develop modular neural populations and dynamical motifs that are re-used across tasks (<xref ref-type="bibr" rid="c17">Driscoll et al., 2022</xref>; <xref ref-type="bibr" rid="c55">Yang et al., 2019</xref>). When RNN architecture is explicitly designed to include dedicated neural subpopulations, these subpopulations can improve model performance on particular types of tasks (<xref ref-type="bibr" rid="c4">Beiran et al., 2021</xref>; <xref ref-type="bibr" rid="c18">Dubreuil et al., 2022</xref>). Thus, there is an emerging conclusion that RNNs use simple dynamical motifs as building blocks for more general and complex computations, which our results support. In particular, aligned ring attractors are a recurring, dynamical motif in our results, appearing first in a simple task setting (2 maps of a 1D environment) and subsequently as a component of RNN dynamics in more complex settings (e.g., as sub-manifolds of toroidal attractors in a 2D environment, see <xref rid="fig4" ref-type="fig">Figure 4</xref>). We can therefore conceptualize a pair of aligned ring manifolds as a dynamical “building block” that RNNs utilize to solve higher-dimensional generalizations of the task. Intriguingly, our novel analysis of neural data from <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref> revealed that similar principles may hold in biological circuits—when three or more spatial maps were present in a recording, the pairs of ring manifolds tended to be aligned.</p>
<p>Ultimately, our model provides a strong foundation for future experimental investigations of the functional role of remapping in navigational circuits. Our findings suggest that latent state changes can drive remapping; an experimental task that explicitly requires animals to report a latent internal state would provide substantial insight into this hypothesis. We also identify concrete predictions for how the representational geometry of neural populations generalizes from the dynamics found in 1D virtual reality environments (<xref ref-type="bibr" rid="c8">Campbell et al., 2021</xref>; <xref ref-type="bibr" rid="c34">Low et al., 2021</xref>) to more complex settings. We found direct support for one of these predictions by re-analyzing an existing experimental dataset. Our work therefore provides a parsimonious, plausible, and testable model for the neural population geometry of remapping navigational circuits under a variety of task conditions.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>We thank Dmitriy Aronov and Selmaan Chettih for providing feedback on the manuscript. We thank Scott Linderman, members of the Aronov Lab, members of the Giocomo Lab, and members of the Williams Lab for discussions and feedback. This work was supported by funding from the Wu Tsai Neurosciences Institute under Stanford Interdisciplinary Graduate Fellowships (to I.I.C.L.); the Office of Naval Research (N00141812690), the Simons Foundation (SCGB 542987SPI), NIMH (1R01MH126904-01A1 and U19NS118284), the Vallee Foundation, and the James S. McDonnell Foundation (to L.M.G.); and the Simons Foundation (to A.H.W.).</p>
</ack>
<sec id="s4">
<title>Author contributions</title>
<p>I.I.C.L., conceptualization, methodology, formal analysis, investigation, writing – original draft, writing – review &amp; editing, and visualization; L.M.G., conceptualization, writing – review &amp; editing, supervision, and funding; A.H.W., conceptualization, methodology, formal analysis, investigation, writing – original draft, writing – review &amp; editing, visualization, supervision, and funding.</p>
</sec>
<sec id="s5">
<title>Declaration of interests</title>
<p>The authors declare no competing interests.</p>
</sec>
<sec id="s6">
<title>Methods</title>
<sec id="s6a">
<title>Resource Availability</title>
<sec id="s6a1">
<title>Lead Contact</title>
<p>Further information and requests for resources and reagents should be directed to and will be fulfilled by the Lead Contact, Alex H. Williams (<email>alex.h.williams@nyu.edu</email>).</p>
</sec>
<sec id="s6a2">
<title>Materials Availability</title>
<p>This study did not generate new unique reagents.</p>
</sec>
<sec id="s6a3">
<title>Data and Code Availability</title>
<p>Code to train RNN models and reproduce the figures of this paper are provided in a GitHub repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/ahwillia/rnn_remapping_paper">https://github.com/ahwillia/rnn_remapping_paper</ext-link>).</p>
<p>Any additional information required to reanalyze the data reported in this paper is available from the lead contact upon request.</p>
</sec>
</sec>
<sec id="s6b">
<title>Experimental Model and Subject Details</title>
<sec id="s6b1">
<title>RNN Model and Training Procedure</title>
<p>We examined Elman RNNs (“vanilla” RNNs), which are perhaps the simplest RNN architecture capable of theoretically representing any nonlinear dynamical system,(<xref ref-type="bibr" rid="c24">Hammer, 2000</xref>) and which can be viewed as an approximation to continuous time firing rate models of neural circuits.(<xref ref-type="bibr" rid="c49">Song et al., 2016</xref>) At each time index <italic>t</italic> ∈ {1, ···, <italic>T</italic>} the activation vector of <italic>N</italic> hidden units is denoted by <italic>x</italic><sub><italic>t</italic></sub> ∈ ℝ<sup><italic>N</italic></sup>. Loosely, we can think of <italic>x</italic><sub><italic>t</italic></sub> as the firing rates of <italic>N</italic> neurons in a biological circuit at time <italic>t</italic>. The activation vector is updated according to:
<disp-formula id="ueqn2">
<alternatives><graphic xlink:href="525596v3_ueqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where Re<italic>LU</italic>(<italic>x</italic>) denotes a rectifying linear unit function (i.e., an element-wise maximum between the vector <italic>x</italic> and a vector of zeros), <bold>A</bold> ∈ ℝ <sup><italic>N</italic>×<italic>N</italic></sup> is a matrix holding the recurrent synaptic connection weights, <bold><italic>u</italic></bold><sub><italic>t</italic></sub> ∈ ℝ <sup><italic>M</italic></sup> is a vector of input signals at time <italic>t</italic>, <bold>B</bold> ∈ ℝ <sup><italic>N</italic>×<italic>M</italic></sup> is a matrix holding the input connection weights, and <bold><italic>β</italic></bold> ∈ ℝ<sup><italic>N</italic></sup> is a vector holding bias terms for each hidden unit. The output of the network at time <italic>t</italic> is defined by:
<disp-formula id="ueqn3">
<alternatives><graphic xlink:href="525596v3_ueqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>Where <bold><italic>y</italic></bold><sub><italic>t</italic></sub> ∈ ℝ <sup><italic>L</italic></sup> is a vector of <italic>L</italic> output units, <bold>C</bold> ∈ ℝ <sup><italic>L</italic>×<italic>N</italic></sup> is a matrix holding output connection weights, and <bold><italic>α</italic></bold> ∈ ℝ <sup><italic>L</italic></sup> is a vector holding bias terms for each output unit. Finally, the initial condition <italic>x</italic><sub>0</sub> ∈ ℝ<sup><italic>N</italic></sup> for each dynamical sequence was set by:
<disp-formula id="ueqn4">
<alternatives><graphic xlink:href="525596v3_ueqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <inline-formula><alternatives><inline-graphic xlink:href="525596v3_inline1.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is a vector of <italic>M</italic><sub>0</sub> inputs used to define the initial condition, <inline-formula><alternatives><inline-graphic xlink:href="525596v3_inline2.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is a matrix holding connection weights, and <inline-formula><alternatives><inline-graphic xlink:href="525596v3_inline3.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is a vector holding bias terms. The connection weights were randomly initialized from the uniform distribution <inline-formula><alternatives><inline-graphic xlink:href="525596v3_inline4.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, which is the default initialization scheme in PyTorch. As described below, the vector <bold><italic>z</italic></bold> is used to define the initial position on the circular track, which is randomized on each trial. Altogether, these equations define an RNN model with trainable parameters {<bold>A, B, <italic>β</italic>, C, <italic>α</italic>, D, <italic>γ</italic></bold>}.</p>
<p>The number of inputs, <italic>M</italic>, and outputs, <italic>L</italic>, varied depending on the computational task the RNN was trained to perform. Specifically, <italic>M</italic> is given by the number of latent states (“contexts”) plus the number of spatial dimensions. Thus, for the 1D navigation task with binary state cues diagrammed in <xref rid="fig1" ref-type="fig">Figure 1E</xref>, the number of network inputs was <italic>M</italic> = 3 (whereas the tasks diagrammed in <xref rid="fig4" ref-type="fig">Figure 4A</xref> and <xref rid="fig5" ref-type="fig">Figure 5A</xref> each have <italic>M</italic> = 4 inputs). The number of network outputs, <italic>L</italic>, is given by the number of latent states plus two times the number of spatial dimensions. Thus, for the task diagrammed in <xref rid="fig1" ref-type="fig">Figure 1E</xref>, <italic>L</italic> = 4 (for <xref rid="fig4" ref-type="fig">Figure 4A</xref>, <italic>L</italic> = 6; for <xref rid="fig5" ref-type="fig">Figure 5A</xref>, <italic>L</italic> = 5). The additional spatial output dimensions can be understood as follows: Due to the periodic boundary conditions, the network must output a predicted spatial position θ<sub><italic>t</italic></sub> ∈ [0, 2π) for each spatial dimension. Predicting this raw angular position would require the network to implement something akin to an arctan (·) function. Because this function is highly nonlinear and discontinuous, the linear readout layer of the RNN will struggle to predict θ<sub><italic>t</italic></sub> directly in a fashion that is numerically stable. We therefore trained the networks to predict sin θ<sub><italic>t</italic></sub> and cos θ<sub><italic>t</italic></sub> for each spatial dimension, which requires an extra factor of two spatial output dimensions. Similarly, for the initial condition <italic>x</italic><sub>0</sub>, the number of input variables <italic>M</italic><sub>0</sub> is given by two times the number of spatial dimensions, and the input vector <bold><italic>z</italic></bold> is formed by concatenating sin θ<sub>0</sub> and cos θ<sub>0</sub> for each spatial dimension.</p>
<p>The network was trained by randomly generated input sequences with a ground truth target output. The input vector at each time step, <bold><italic>u</italic></bold><sub><italic>t</italic></sub>, contained the angular velocity along each spatial dimension as well as state change cues (see schematic in <xref rid="fig1" ref-type="fig">Figure 1E</xref>). The output vector at each time step, <bold><italic>y</italic></bold><sub><italic>t</italic></sub>, contains disjoint dimensions that predict spatial position and the latent state or “context” (see schematic in <xref rid="fig1" ref-type="fig">Figure 1F</xref>). For each sequence, the overall loss function is a sum of two terms: <italic>(i)</italic> the mean-squared-error between the ground truth sine and cosine of angular position, sin θ<sub><italic>t</italic></sub> and cos θ<sub><italic>t</italic></sub>, and the network’s prediction of these terms, and <italic>(ii)</italic> the cross-entropy of the true latent state and the network’s prediction. This second term is the usual loss function for multi-class classification tasks; it coincides with a negative log-likelihood criterion on a categorical variable (see <bold>torch.nn.CrossEntropyLoss</bold> class in the PyTorch library(<xref ref-type="bibr" rid="c38">Paszke et al., 2019</xref>)).</p>
<p>We trained networks with <italic>N</italic> = 248 hidden units using stochastic gradient descent with a batch size of 124 sequences and gradient clipping (gradient norm clipped to be less than or equal to 2). At the beginning of training, we trained RNNs on sequence lengths of <italic>T</italic> = 1 and increased the sequence length by one every 50 parameter updates. We performed 30,000 parameter updates, so that by the end of training the RNNs were training on sequence lengths of <italic>T</italic> = 600. We found that this gradual increase in task complexity along with gradient clipping were necessary to achieve good performance. Intuitively, training on short sequences at the beginning helps the network learn suitable parameter values for {<bold>C, <italic>α</italic>, D, <italic>γ</italic></bold>} without worrying about the typical challenges (e.g. exploding and vanishing gradients) associated with RNN training. Then, the remaining parameters {<bold>A, B, <italic>β</italic></bold>} can be fine-tuned with gradually increasing sequence lengths.</p>
<p>Each sequence was randomly generated. For each spatial dimension, the initial angular position, θ<sub>0</sub>, was sampled uniformly between [0, 2π). The angular velocity at each time step was given by <inline-formula><alternatives><inline-graphic xlink:href="525596v3_inline5.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> where <inline-formula><alternatives><inline-graphic xlink:href="525596v3_inline6.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> denotes the mean velocity and ϵ<sub><italic>t</italic></sub> was sampled randomly from a normal distribution with mean zero and standard deviation of 0.3 radians. For each sequence the mean velocity, <inline-formula><alternatives><inline-graphic xlink:href="525596v3_inline7.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, was sampled from a normal distribution with mean zero and standard deviation of 0.1 radians. The initial latent state was chosen randomly from the available states. State change cues occurred randomly according to a homogeneous Poisson process with an expected rate of one state change per 50 time steps. In <xref rid="fig5" ref-type="fig">Figure 5</xref>, we trained networks to switch between three or more states—for each state change one of the inactive states was chosen uniformly at random to be the new active state. State changes were cued by a pulse lasting two time steps.</p>
<p>For <xref rid="fig1" ref-type="fig">Figure 1G</xref>, the trained model was provided velocity inputs with an initial position of θ<sub>0</sub> = 0 and non-negative angular velocity at each time step, <inline-formula><alternatives><inline-graphic xlink:href="525596v3_inline8.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, so that the RNN output would follow a trial structure comparable to the biological data. Similarly, state changes occurred less frequently (at an expected rate of once per 500 time steps) to better match the biologically observed remapping rate. For comparison with the biological data, we truncated each sequence to remove incomplete track traversals and concatenated 50 sequences into a single session. For visualization purposes, we computed the smoothed, position-binned (n bins = 50) firing rates for 5 example units and labeled each track traversal according to the most commonly reported latent state for that traversal.</p>
</sec>
</sec>
<sec id="s6c">
<title>Mice</title>
<p>All experimental data reported here were collected for a previous publication, <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref> and were approved by the Institutional Animal Care and Use Committee at Stanford University School of Medicine. More information on data collection and analyses can be found in Method Details, below, and in the Methods section of <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref></p>
</sec>
</sec>
<sec id="s7">
<title>Method Details</title>
<sec id="s7a">
<title>Manifold Geometry Analyses</title>
<p>We used Procrustes shape analysis (<xref ref-type="bibr" rid="c22">Gower and Dijksterhuis, 2004</xref>) according to the methods described in <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref> to determine the degree to which manifolds from different maps were aligned in the high-dimensional activity space. Briefly, we divided the track into 50 position bins and computed the average activity for all units within each position bin for each latent state to obtain an estimate of the manifold associated with each map. We then mean-centered these manifolds and rescaled them to have unit norm. We compute the root-mean-squared error (RMSE) between these two manifolds (the “observed” RMSE). We then find the rotation matrix that optimally aligns the two manifolds and calculate the RMSE between the optimally aligned manifolds. We report the observed RMSE relative to the RMSE after optimal (misalignment = 0) and random (misalignment = 1) rotation. For <xref rid="fig5" ref-type="fig">Figure 5</xref> and <xref rid="figS3" ref-type="fig">Supplemental Figure 3</xref>, which had more than two latent states, we computed this score for all pairs of manifolds.</p>
<p>In <xref rid="fig1" ref-type="fig">Figures 1</xref>, <xref rid="fig3" ref-type="fig">3</xref>, <xref rid="fig4" ref-type="fig">4</xref>, and <xref rid="fig5" ref-type="fig">5</xref> we consider the network in terms of subspaces tuned to the two task components—position and latent state. We define the “position subspace” as a two-dimensional subspace containing the position-binned average firing rates of all units. We divided the track into 250 position bins and computed the average activity for all units within each position bin for each latent state. To find the position subspace across maps—as in <xref rid="fig1" ref-type="fig">Figure 1K</xref>, <xref rid="fig3" ref-type="fig">Figure 3E</xref>, <xref rid="fig4" ref-type="fig">Figure 4G</xref>, and <xref rid="fig5" ref-type="fig">Figure 5G</xref>—we performed 2-factor Principal Components Analysis (PCA) on the position-binned activity across both latent states. To find the position subspace for a single map—as in <xref rid="fig3" ref-type="fig">Figure 3G</xref>—we performed 2-factor PCA on the average activity from just one latent state. We define the “remapping dimension” as the dimension separating the manifold centroids, which we find by computing the average activity for each unit within each map and taking the difference across the two maps.</p>
<p>In <xref rid="fig1" ref-type="fig">Figure 1K</xref>, <xref ref-type="fig" rid="fig4">4G</xref>, <xref ref-type="fig" rid="fig5">5G</xref>, and <xref rid="figS2" ref-type="fig">Supplementary Figure 2B</xref>, we calculate the angles between the input and output weights and the position subspace or remapping dimension. To find this angle, we calculated the cosine similarity between each weight vector and each subspace. Cosine similarity of 0 indicates that the weights were orthogonal to the subspace, while a similarity of 1 indicates that the weight vector was contained within the subspace.</p>
</sec>
<sec id="s7b">
<title>Fixed Point Analysis</title>
<p>We numerically identified fixed points according to the methods described in Sussillo &amp; Barak.(<xref ref-type="bibr" rid="c51">Sussillo and Barak, 2013</xref>) Briefly, we used stochastic gradient descent to minimize ||<italic>x</italic> − Re<italic>LU</italic>(<bold>A</bold><italic>x</italic> + <bold><italic>β</italic></bold>)|| <sub>2</sub> over hidden layer activation vectors <italic>x</italic>. Values of <italic>x</italic> that minimize the expression close to zero, correspond to approximate fixed points of the recurrent RNN dynamics when the input is held constant <bold><italic>u</italic></bold><sub><italic>t</italic></sub> = <bold>0</bold>. At each numerical fixed point <italic>x</italic><sub>*</sub>, we can use standard autodifferentiation tools in PyTorch to compute the <italic>N</italic> × <italic>N</italic> Jacobian matrix <inline-formula><alternatives><inline-graphic xlink:href="525596v3_inline9.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> evaluated at <italic>x</italic> = <italic>x</italic><sub>*</sub> . The eigenvalues and eigenvectors of this matrix then provide a local linear dynamical approximation to the full system as explained in <xref ref-type="bibr" rid="c51">Sussillo &amp; Barak (2013)</xref> and in the main text.</p>
</sec>
<sec id="s7c">
<title>Single Unit Analysis</title>
<p>To characterize single unit remapping properties for <xref rid="figS1" ref-type="fig">Supplemental Figure 1</xref>, we performed the rate remapping versus global remapping analysis described in Low et al.(<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>) For each model, we computed the average firing rate for all units in each map, smoothing with a Gaussian filter (standard deviation, 2 position bins). We then calculated the percent change in peak firing rate (i.e., rate remapping). To compute a spatial dissimilarity score (i.e., global remapping), we subtracted 1 from the cosine similarity between firing rate vectors (dissimilarity score of 0 indicates identical spatial firing, 1 indicates orthogonal spatial representations).</p>
</sec>
<sec id="s7d">
<title>Experimental Data</title>
<p>The experimental data included in <xref rid="fig1" ref-type="fig">Figure 1</xref>, <xref rid="fig6" ref-type="fig">Figure 6</xref>, and <xref rid="figS4" ref-type="fig">Supplemental Figure 4</xref> were collected for a previous publication (<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>). Briefly, mice were trained to navigate a 1D virtual reality track with tower landmarks and floor cues to provide optic flow. The landmarks repeated seamlessly every 400 cm such that the track was circular-linear. The mice received randomly distributed, visually cued rewards within the middle 300cm of the track. During behavior, neural activity was recorded using Neuropixels 1.0 silicon recording probes (<xref ref-type="bibr" rid="c29">Jun et al., 2017</xref>), which were acutely inserted into the medial entorhinal cortex. Behavioral and neural data were processed as described in <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref> <xref rid="fig1" ref-type="fig">Figure 1A</xref>–<xref ref-type="fig" rid="fig1">D</xref> are modified from Low et al.</p>
<p>The pilot analyses in <xref rid="fig6" ref-type="fig">Figure 6</xref> and <xref rid="figS4" ref-type="fig">Supplemental Figure 4</xref> are performed on a subset of the data from Low et al. (n = 684 cells from 4 sessions in 2 mice)(<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>). As described in that publication, we used k-means clustering to divide these sessions into 3 or 4 maps. We then assessed the trial-by-trial spatial stability of the population-wide neural activity within each map in order to restrict our analysis to stable trials. We divided the session according to the k-means map labels and computed the Pearson correlation between the position-binned firing rates (n bins = 80) of all neurons for each pair of trials within each map. We excluded trials that were spatially unstable from our analysis (average correlation with all other trials &lt; 0.25). (We performed the same analysis of trial-by-trial spatial stability to obtain the similarity matrices in <xref rid="fig1" ref-type="fig">Figure 1C</xref> and <xref ref-type="fig" rid="fig1">G</xref>.)</p>
<p>To assess the geometry of the neural population activity, we used the k-means cluster centroids as an estimate for the neural activity manifold associated with each map. We then performed Procrustes shape analysis to assess manifold alignment and identified the remapping dimensions, as described above.</p>
<p>To ensure that remapping was not an artifact of probe movement or multi-unit activity, we compared the spike waveforms for all cells across remapping events, as described in <xref ref-type="bibr" rid="c34">Low et al. (2021)</xref> Briefly, we identified the longest epoch of trials for each map and extracted waveforms for 100 spikes for each cell from each epoch. We then computed the average waveforms within each epoch. To determine waveform similarity, we computed the Pearson correlation between the vectorized average waveforms for each pair of maps and then calculated the average correlation across pairs. For all waveform analyses, we used waveforms from the 20 channels closest to the Kilosort2-identified depth for each cell.</p>
</sec>
</sec>
<sec id="s8">
<title>Quantification and Statistical Analysis</title>
<sec id="s8a">
<title>Statistics</title>
<p>All data were analyzed in Python, using the scipy stats library to compute statistics. Unless otherwise noted, all tests are two-sided, correlation coefficients represent Pearson’s correlation, and values are presented as mean ± standard error of the mean (SEM). Statistical tests are listed following the relevant result given in the Results, figure legend, or Method Details. Unless otherwise stated, p &lt; 0.05 was taken as the criterion for significance.</p>
</sec>
</sec>
<sec id="s9">
<title>Supplementary Information</title>
<fig id="figS1" position="float" fig-type="figure">
<label>Supplemental Figure 1:</label>
<caption><title>single RNN units remap heterogeneously.</title>
<p>(A) Absolute fold change in peak firing rate versus spatial dissimilarity across latent state changes for all units from 2-map RNN models (points, single units; histograms, density distributions for each variable). Median change in peak firing rate (horizontal red dashes) = 1.9-fold; 95<sup>th</sup> percentile (horizontal gold dashes) = 3-fold. Median spatial dissimilarity (vertical red dashes) = 0.025; 95<sup>th</sup> percentile (vertical gold dashes) = 0.21.</p>
<p>(B) Modified from Low et al.(<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>) As in (A) but for biological neurons from 2-map sessions. Median change in peak firing rate (horizontal red dashes) = 1.28-fold. Median spatial dissimilarity (vertical red dashes) = 0.031; 95<sup>th</sup> percentile (vertical gold dashes) = 0.22.</p></caption>
<graphic xlink:href="525596v3_figS1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Supplemental Figure 2:</label>
<caption><title>RNN geometry is interpretable.</title>
<p>(A) Schematic showing the relative orientation of the position output weights and the context input and output weights to the position and state tuning subspaces.</p>
<p>(B) Reproduced from <xref rid="fig1" ref-type="fig">Figure 1K</xref>.</p>
<p>(C-D) Schematic to interpret why the position input weights are orthogonal to the position tuning subspace. These schematics illustrate how a single velocity input (blue arrows) updates the position estimate (yellow to red points) from a given starting position (blue points).</p>
<p>(C, not observed) Velocity input lies in the position tuning subspace (gray plane). Note that the same velocity input pushes the network clockwise or counterclockwise along the ring depending on the circular position</p>
<p>(D, observed) Velocity input is orthogonal to the position tuning subspace and pushes neural activity out of the subspace.</p>
<p>(E) Schematic of possible flow fields in each of three planes (numbers correspond to planes in C and D). We conjecture that these dynamics would enable a given orthogonal velocity input to nonlinearly update the position estimate, resulting in the correct translation around the ring regardless of starting position (as in D).</p></caption>
<graphic xlink:href="525596v3_figS2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Supplemental Figure 3:</label>
<caption><title>Manifold geometry generalizes for up to 10 latent states.</title>
<p>(A) (Left) RNN models were trained to navigate in 1D (velocity signal, top) and discriminate between many (2–10) distinct contexts (transient, binary latent state signal, bottom). (Right) Example showing high prediction performance for position (top) and context (bottom) for 5 latent states.</p>
<p>(B)Position-binned activity for six example single RNN units, split by latent state (colors as in (A)).</p>
<p>(C)Models accurately estimated position (top) and latent state (bottom) for different numbers of latent states or “maps.”</p>
<p>(D)Angle between remapping dimensions for different numbers of maps. The remapping dimensions were always maximally separated.</p>
<p>(E)Manifold misalignment score for all pairs of maps across all models (0, perfectly aligned; 1, p = 0.25 of shuffle). All pairs of manifolds were more aligned than expected by chance.</p></caption>
<graphic xlink:href="525596v3_figS3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Supplemental Figure 4:</label>
<caption><title>Medial entorhinal cortex can remap between 3 or 4 maps and many geometric features are preserved.</title>
<p>Experimental data for 4 example multi-map sessions from Low et al.(<xref ref-type="bibr" rid="c34">Low et al., 2021</xref>)</p>
<p>(A) Examples from the 3-map Session A (n = 142 cells).</p>
<p>(A1)(Left) Network-wide trial-by-trial correlations for the spatial firing patterns of all co-recorded neurons in the same example session (colorbar indicates correlation). (Left/bottom) k-means map assignments. (Right) Three example medial entorhinal cortex neurons switch between three maps of the same track (top, raster; bottom, average firing rate by position; teal, map 1; red, map 2; black, map 3).</p>
<p>(A2) Comparisons of average spike waveforms sampled from each of the three maps (approximate sampling epochs indicated by black lines, A1 far right).</p>
<p>(Left) Across map correlations for average spike waveforms from all cells (horizontal bar, median = 0.978; vertical line, 5<sup>th</sup> – 95<sup>th</sup> percentile, 5<sup>th</sup> percentile = 0.935).</p>
<p>(Right) Overlay of average waveforms sampled from each map for the three example cells from (A2). (A3) PCA projection of the manifolds associated with each pair of maps (colorbar indicates virtual track position). Text: average normalized manifold misalignment score for all pairs of maps (0, perfectly aligned; 1, p = 0.25 of shuffle).</p>
<p>(B–D) As in (A), but for the 3-map Session B (n = 184 cells; median waveform correlation = 0.988), 4-map Session C (n = 196 cells; median waveform correlation = 0.995), and 4-map Session D (n = 162 cells; median waveform correlation = 0.99).</p></caption>
<graphic xlink:href="525596v3_figS4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="other"><string-name><surname>Allen</surname> <given-names>WE</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>MZ</given-names></string-name>, <string-name><surname>Pichamoorthy</surname> <given-names>N</given-names></string-name>, <string-name><surname>Tien</surname> <given-names>RH</given-names></string-name>, <string-name><surname>Pachitariu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Luo</surname> <given-names>L</given-names></string-name>, <string-name><surname>Deisseroth</surname> <given-names>K.</given-names></string-name> <year>2019</year>. <article-title>Thirst regulates motivated behavior through modulation of brainwide neural population dynamics</article-title>. <source>Science</source>. doi:<pub-id pub-id-type="doi">10.1126/science.aav3932</pub-id></mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Aronov</surname> <given-names>D</given-names></string-name>, <string-name><surname>Nevers</surname> <given-names>R</given-names></string-name>, <string-name><surname>Tank</surname> <given-names>DW</given-names></string-name>. <year>2017</year>. <article-title>Mapping of a non-spatial dimension by the hippocampal-entorhinal circuit</article-title>. <source>Nature</source> <volume>543</volume>:<fpage>719</fpage>–<lpage>722</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Bant</surname> <given-names>JS</given-names></string-name>, <string-name><surname>Hardcastle</surname> <given-names>K</given-names></string-name>, <string-name><surname>Ocko</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Giocomo</surname> <given-names>LM</given-names></string-name>. <year>2020</year>. <article-title>Topography in the Bursting Dynamics of Entorhinal Neurons</article-title>. <source>Cell Rep</source> <volume>30</volume>:<fpage>2349</fpage>–<lpage>2359</lpage>.e7.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="other"><string-name><surname>Beiran</surname> <given-names>M</given-names></string-name>, <string-name><surname>Dubreuil</surname> <given-names>A</given-names></string-name>, <string-name><surname>Valente</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mastrogiuseppe</surname> <given-names>F</given-names></string-name>, <string-name><surname>Ostojic</surname> <given-names>S.</given-names></string-name> <year>2021</year>. <article-title>Shaping Dynamics With Multiple Populations in Low-Rank Recurrent Networks</article-title>. <source>Neural Computation</source>. doi:<pub-id pub-id-type="doi">10.1162/neco_a_01381</pub-id></mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Bennett</surname> <given-names>C</given-names></string-name>, <string-name><surname>Arroyo</surname> <given-names>S</given-names></string-name>, <string-name><surname>Hestrin</surname> <given-names>S.</given-names></string-name> <year>2013</year>. <article-title>Subthreshold mechanisms underlying state-dependent modulation of visual responses</article-title>. <source>Neuron</source> <volume>80</volume>:<fpage>350</fpage>–<lpage>357</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Boccara</surname> <given-names>CN</given-names></string-name>, <string-name><surname>Nardin</surname> <given-names>M</given-names></string-name>, <string-name><surname>Stella</surname> <given-names>F</given-names></string-name>, <string-name><surname>O’Neill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Csicsvari</surname> <given-names>J.</given-names></string-name> <year>2019</year>. <article-title>The entorhinal cognitive map is attracted to goals</article-title>. <source>Science</source> <volume>363</volume>:<fpage>1443</fpage>–<lpage>1447</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Butler</surname> <given-names>WN</given-names></string-name>, <string-name><surname>Hardcastle</surname> <given-names>K</given-names></string-name>, <string-name><surname>Giocomo</surname> <given-names>LM</given-names></string-name>. <year>2019</year>. <article-title>Remembered reward locations restructure entorhinal spatial maps</article-title>. <source>Science</source> <volume>363</volume>:<fpage>1447</fpage>–<lpage>1452</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Campbell</surname> <given-names>MG</given-names></string-name>, <string-name><surname>Attinger</surname> <given-names>A</given-names></string-name>, <string-name><surname>Ocko</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Ganguli</surname> <given-names>S</given-names></string-name>, <string-name><surname>Giocomo</surname> <given-names>LM</given-names></string-name>. <year>2021</year>. <article-title>Distance-tuned neurons drive specialized path integration calculations in medial entorhinal cortex</article-title>. <source>Cell Rep</source> <volume>36</volume>:<fpage>109669</fpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Campbell</surname> <given-names>MG</given-names></string-name>, <string-name><surname>Ocko</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Mallory</surname> <given-names>CS</given-names></string-name>, <string-name><surname>Low</surname> <given-names>IIC</given-names></string-name>, <string-name><surname>Ganguli</surname> <given-names>S</given-names></string-name>, <string-name><surname>Giocomo</surname> <given-names>LM</given-names></string-name>. <year>2018</year>. <article-title>Principles governing the integration of landmark and self-motion cues in entorhinal cortical codes for navigation</article-title>. <source>Nat Neurosci</source> <volume>21</volume>:<fpage>1096</fpage>–<lpage>1106</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Colgin</surname> <given-names>LL</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>EI</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>M-B.</given-names></string-name> <year>2008</year>. <article-title>Understanding memory through hippocampal remapping</article-title>. <source>Trends Neurosci</source> <volume>31</volume>:<fpage>469</fpage>–<lpage>477</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Constantinescu</surname> <given-names>AO</given-names></string-name>, <string-name><surname>O’Reilly</surname> <given-names>JX</given-names></string-name>, <string-name><surname>Behrens</surname> <given-names>TEJ</given-names></string-name>. <year>2016</year>. <article-title>Organizing conceptual knowledge in humans with a gridlike code</article-title>. <source>Science</source> <volume>352</volume>:<fpage>1464</fpage>–<lpage>1468</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Cowley</surname> <given-names>BR</given-names></string-name>, <string-name><surname>Snyder</surname> <given-names>AC</given-names></string-name>, <string-name><surname>Acar</surname> <given-names>K</given-names></string-name>, <string-name><surname>Williamson</surname> <given-names>RC</given-names></string-name>, <string-name><surname>Yu</surname> <given-names>BM</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>MA</given-names></string-name>. <year>2020</year>. <article-title>Slow Drift of Neural Activity as a Signature of Impulsivity in Macaque Visual and Prefrontal Cortex</article-title>. <source>Neuron</source> <volume>108</volume>:<fpage>551</fpage>–<lpage>567</lpage>.e8.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="other"><string-name><surname>Cueva</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Ardalan</surname> <given-names>A</given-names></string-name>, <string-name><surname>Tsodyks</surname> <given-names>M</given-names></string-name>, <string-name><surname>Qian</surname> <given-names>N.</given-names></string-name> <year>2021</year>. <article-title>Recurrent neural network models for working memory of continuous variables: activity manifolds, connectivity patterns, and dynamic codes</article-title>. <source>arXiv</source> [q-bioNC].</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="other"><string-name><surname>Cueva</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>PY</given-names></string-name>, <string-name><surname>Chin</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wei</surname> <given-names>X-X.</given-names></string-name> <year>2019</year>. <article-title>Emergence of functional and structural properties of the head direction system by optimization of recurrent neural networks</article-title>. <source>arXiv</source> [q-bioNC].</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="other"><string-name><surname>Cueva</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Wei</surname> <given-names>X-X.</given-names></string-name> <year>2018</year>. <article-title>Emergence of grid-like representations by training recurrent neural networks to perform spatial localization</article-title>. <source>arXiv</source> [q-bioNC].</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Diehl</surname> <given-names>GW</given-names></string-name>, <string-name><surname>Hon</surname> <given-names>OJ</given-names></string-name>, <string-name><surname>Leutgeb</surname> <given-names>S</given-names></string-name>, <string-name><surname>Leutgeb</surname> <given-names>JK</given-names></string-name>. <year>2017</year>. <article-title>Grid and Nongrid Cells in Medial Entorhinal Cortex Represent Spatial Location and Environmental Features with Complementary Coding Schemes</article-title>. <source>Neuron</source> <volume>94</volume>:<fpage>83</fpage>–<lpage>92</lpage>.e6.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="other"><string-name><surname>Driscoll</surname> <given-names>L</given-names></string-name>, <string-name><surname>Shenoy</surname> <given-names>K</given-names></string-name>, <string-name><surname>Sussillo</surname> <given-names>D.</given-names></string-name> <year>2022</year>. <article-title>Flexible multitask computation in recurrent networks utilizes shared dynamical motifs</article-title>. <source>bioRxiv</source>. doi:<pub-id pub-id-type="doi">10.1101/2022.08.15.503870</pub-id></mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Dubreuil</surname> <given-names>A</given-names></string-name>, <string-name><surname>Valente</surname> <given-names>A</given-names></string-name>, <string-name><surname>Beiran</surname> <given-names>M</given-names></string-name>, <string-name><surname>Mastrogiuseppe</surname> <given-names>F</given-names></string-name>, <string-name><surname>Ostojic</surname> <given-names>S.</given-names></string-name> <year>2022</year>. <article-title>The role of population structure in computations through neural dynamics</article-title>. <source>Nature Neuroscience</source> <volume>25</volume>:<fpage>783</fpage>–<lpage>794</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Fenton</surname> <given-names>AA</given-names></string-name>, <string-name><surname>Lytton</surname> <given-names>WW</given-names></string-name>, <string-name><surname>Barry</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Lenck-Santini</surname> <given-names>P-P</given-names></string-name>, <string-name><surname>Zinyuk</surname> <given-names>LE</given-names></string-name>, <string-name><surname>Kubík</surname> <given-names>Š</given-names></string-name>, <string-name><surname>Bureš</surname> <given-names>J</given-names></string-name>, <string-name><surname>Poucet</surname> <given-names>B</given-names></string-name>, <string-name><surname>Muller</surname> <given-names>RU</given-names></string-name>, <string-name><surname>Olypher</surname> <given-names>AV</given-names></string-name>. <year>2010</year>. <article-title>Attention-like modulation of hippocampus place cell discharge</article-title>. <source>Journal of Neuroscience</source> <volume>30</volume>:<fpage>4613</fpage>–<lpage>4625</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Fuhs</surname> <given-names>MC</given-names></string-name>, <string-name><surname>Touretzky</surname> <given-names>DS</given-names></string-name>. <year>2007</year>. <article-title>Context learning in the rodent hippocampus</article-title>. <source>Neural Comput</source> <volume>19</volume>:<fpage>3173</fpage>–<lpage>3215</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="other"><string-name><surname>Gil</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ancau</surname> <given-names>M</given-names></string-name>, <string-name><surname>Schlesiger</surname> <given-names>MI</given-names></string-name>, <string-name><surname>Neitz</surname> <given-names>A</given-names></string-name>, <string-name><surname>Allen</surname> <given-names>K</given-names></string-name>, <string-name><surname>De Marco</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Monyer</surname> <given-names>H.</given-names></string-name> <year>2018</year>. <article-title>Impaired path integration in mice with disrupted grid cell firing</article-title>. <source>Nature Neuroscience</source>. doi:<pub-id pub-id-type="doi">10.1038/s41593-017-0039-3</pub-id></mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="book"><string-name><surname>Gower</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Dijksterhuis</surname> <given-names>GB</given-names></string-name>. <year>2004</year>. <source>Procrustes Problems</source>. <publisher-name>OUP Oxford</publisher-name>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Hafting</surname> <given-names>T</given-names></string-name>, <string-name><surname>Fyhn</surname> <given-names>M</given-names></string-name>, <string-name><surname>Molden</surname> <given-names>S</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>M-B</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>EI</given-names></string-name>. <year>2005</year>. <article-title>Microstructure of a spatial map in the entorhinal cortex</article-title>. <source>Nature</source> <volume>436</volume>:<fpage>801</fpage>–<lpage>806</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Hammer</surname> <given-names>B.</given-names></string-name> <year>2000</year>. <article-title>On the approximation capability of recurrent neural networks</article-title>. <source>Neurocomputing</source> <volume>31</volume>:<fpage>107</fpage>–<lpage>123</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Hardcastle</surname> <given-names>K</given-names></string-name>, <string-name><surname>Ganguli</surname> <given-names>S</given-names></string-name>, <string-name><surname>Giocomo</surname> <given-names>LM</given-names></string-name>. <year>2017a</year>. <article-title>Cell types for our sense of location: where we are and where we are going</article-title>. <source>Nat Neurosci</source> <volume>20</volume>:<fpage>1474</fpage>–<lpage>1482</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Hardcastle</surname> <given-names>K</given-names></string-name>, <string-name><surname>Maheswaranathan</surname> <given-names>N</given-names></string-name>, <string-name><surname>Ganguli</surname> <given-names>S</given-names></string-name>, <string-name><surname>Giocomo</surname> <given-names>LM</given-names></string-name>. <year>2017b</year>. <article-title>A Multiplexed, Heterogeneous, and Adaptive Code for Navigation in Medial Entorhinal Cortex</article-title>. <source>Neuron</source> <volume>94</volume>:<fpage>375</fpage>–<lpage>387</lpage>.e7.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Høydal</surname> <given-names>ØA</given-names></string-name>, <string-name><surname>Skytøen</surname> <given-names>ER</given-names></string-name>, <string-name><surname>Andersson</surname> <given-names>SO</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>M-B</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>EI</given-names></string-name>. <year>2019</year>. <article-title>Object-vector coding in the medial entorhinal cortex</article-title>. <source>Nature</source> <volume>568</volume>:<fpage>400</fpage>–<lpage>404</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Hulse</surname> <given-names>BK</given-names></string-name>, <string-name><surname>Lubenov</surname> <given-names>EV</given-names></string-name>, <string-name><surname>Siapas</surname> <given-names>AG</given-names></string-name>. <year>2017</year>. <article-title>Brain State Dependence of Hippocampal Subthreshold Activity in Awake Mice</article-title>. <source>Cell Rep</source> <volume>18</volume>:<fpage>136</fpage>–<lpage>147</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Jun</surname> <given-names>JJ</given-names></string-name>, <string-name><surname>Steinmetz</surname> <given-names>NA</given-names></string-name>, <string-name><surname>Siegle</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Denman</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Bauza</surname> <given-names>M</given-names></string-name>, <string-name><surname>Barbarits</surname> <given-names>B</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>AK</given-names></string-name>, <string-name><surname>Anastassiou</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Andrei</surname> <given-names>A</given-names></string-name>, <string-name><surname>Aydin</surname> <given-names>Ç</given-names></string-name>, <string-name><surname>Barbic</surname> <given-names>M</given-names></string-name>, <string-name><surname>Blanche</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Bonin</surname> <given-names>V</given-names></string-name>, <string-name><surname>Couto</surname> <given-names>J</given-names></string-name>, <string-name><surname>Dutta</surname> <given-names>B</given-names></string-name>, <string-name><surname>Gratiy</surname> <given-names>SL</given-names></string-name>, <string-name><surname>Gutnisky</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Häusser</surname> <given-names>M</given-names></string-name>, <string-name><surname>Karsh</surname> <given-names>B</given-names></string-name>, <string-name><surname>Ledochowitsch</surname> <given-names>P</given-names></string-name>, <string-name><surname>Lopez</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Mitelut</surname> <given-names>C</given-names></string-name>, <string-name><surname>Musa</surname> <given-names>S</given-names></string-name>, <string-name><surname>Okun</surname> <given-names>M</given-names></string-name>, <string-name><surname>Pachitariu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Putzeys</surname> <given-names>J</given-names></string-name>, <string-name><surname>Rich</surname> <given-names>PD</given-names></string-name>, <string-name><surname>Rossant</surname> <given-names>C</given-names></string-name>, <string-name><surname>Sun</surname> <given-names>W-L</given-names></string-name>, <string-name><surname>Svoboda</surname> <given-names>K</given-names></string-name>, <string-name><surname>Carandini</surname> <given-names>M</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>KD</given-names></string-name>, <string-name><surname>Koch</surname> <given-names>C</given-names></string-name>, <string-name><surname>O’Keefe</surname> <given-names>J</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>TD</given-names></string-name>. <year>2017</year>. <article-title>Fully integrated silicon probes for high-density recording of neural activity</article-title>. <source>Nature</source> <volume>551</volume>:<fpage>232</fpage>–<lpage>236</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Kaufman</surname> <given-names>MT</given-names></string-name>, <string-name><surname>Churchland</surname> <given-names>MM</given-names></string-name>, <string-name><surname>Ryu</surname> <given-names>SI</given-names></string-name>, <string-name><surname>Shenoy</surname> <given-names>KV</given-names></string-name>. <year>2014</year>. <article-title>Cortical activity in the null space: permitting preparation without movement</article-title>. <source>Nat Neurosci</source> <volume>17</volume>:<fpage>440</fpage>–<lpage>448</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Kentros</surname> <given-names>CG</given-names></string-name>, <string-name><surname>Agnihotri</surname> <given-names>NT</given-names></string-name>, <string-name><surname>Streater</surname> <given-names>S</given-names></string-name>, <string-name><surname>Hawkins</surname> <given-names>RD</given-names></string-name>, <string-name><surname>Kandel</surname> <given-names>ER</given-names></string-name>. <year>2004</year>. <article-title>Increased attention to spatial context increases both place field stability and spatial memory</article-title>. <source>Neuron</source> <volume>42</volume>:<fpage>283</fpage>–<lpage>295</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Kubie</surname> <given-names>JL</given-names></string-name>, <string-name><surname>Levy</surname> <given-names>ERJ</given-names></string-name>, <string-name><surname>Fenton</surname> <given-names>AA</given-names></string-name>. <year>2020</year>. <article-title>Is hippocampal remapping the physiological basis for context?</article-title> <source>Hippocampus</source> <volume>30</volume>:<fpage>851</fpage>–<lpage>864</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="other"><string-name><surname>Levenstein</surname> <given-names>D</given-names></string-name>, <string-name><surname>Alvarez</surname> <given-names>VA</given-names></string-name>, <string-name><surname>Amarasingham</surname> <given-names>A</given-names></string-name>, <string-name><surname>Azab</surname> <given-names>H</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>ZS</given-names></string-name>, <string-name><surname>Gerkin</surname> <given-names>RC</given-names></string-name>, <string-name><surname>Hasenstaub</surname> <given-names>A</given-names></string-name>, <string-name><surname>Iyer</surname> <given-names>R</given-names></string-name>, <string-name><surname>Jolivet</surname> <given-names>RB</given-names></string-name>, <string-name><surname>Marzen</surname> <given-names>S</given-names></string-name>, <string-name><surname>Monaco</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Prinz</surname> <given-names>AA</given-names></string-name>, <string-name><surname>Quraishi</surname> <given-names>S</given-names></string-name>, <string-name><surname>Santamaria</surname> <given-names>F</given-names></string-name>, <string-name><surname>Shivkumar</surname> <given-names>S</given-names></string-name>, <string-name><surname>Singh</surname> <given-names>MF</given-names></string-name>, <string-name><surname>Traub</surname> <given-names>R</given-names></string-name>, <string-name><surname>Rotstein</surname> <given-names>HG</given-names></string-name>, <string-name><surname>Nadim</surname> <given-names>F</given-names></string-name>, <string-name><surname>Redish</surname> <given-names>AD</given-names></string-name>. <year>2020</year>. <article-title>On the role of theory and modeling in neuroscience</article-title>. <source>arXiv</source> [q-bioNC].</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="other"><string-name><surname>Low</surname> <given-names>IIC</given-names></string-name>, <string-name><surname>Williams</surname> <given-names>AH</given-names></string-name>, <string-name><surname>Campbell</surname> <given-names>MG</given-names></string-name>, <string-name><surname>Linderman</surname> <given-names>SW</given-names></string-name>, <string-name><surname>Giocomo</surname> <given-names>LM</given-names></string-name>. <year>2021</year>. <article-title>Dynamic and reversible remapping of network representations in an unchanging environment</article-title>. <source>Neuron</source>. doi:<pub-id pub-id-type="doi">10.1016/j.neuron.2021.07.005</pub-id></mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Maheswaranathan</surname> <given-names>N</given-names></string-name>, <string-name><surname>Williams</surname> <given-names>AH</given-names></string-name>, <string-name><surname>Golub</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Ganguli</surname> <given-names>S</given-names></string-name>, <string-name><surname>Sussillo</surname> <given-names>D.</given-names></string-name> <year>2019</year>. <article-title>Reverse engineering recurrent networks for sentiment classification reveals line attractor dynamics</article-title>. <source>Adv Neural Inf Process Syst</source> <volume>32</volume>:<fpage>15696</fpage>–<lpage>15705</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Moser</surname> <given-names>EI</given-names></string-name>, <string-name><surname>Roudi</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Witter</surname> <given-names>MP</given-names></string-name>, <string-name><surname>Kentros</surname> <given-names>C</given-names></string-name>, <string-name><surname>Bonhoeffer</surname> <given-names>T</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>M-B.</given-names></string-name> <year>2014</year>. <article-title>Grid cells and cortical representation</article-title>. <source>Nat Rev Neurosci</source> <volume>15</volume>:<fpage>466</fpage>–<lpage>481</lpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Niell</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Stryker</surname> <given-names>MP</given-names></string-name>. <year>2010</year>. <article-title>Modulation of visual responses by behavioral state in mouse visual cortex</article-title>. <source>Neuron</source> <volume>65</volume>:<fpage>472</fpage>–<lpage>479</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="other"><string-name><surname>Paszke</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gross</surname> <given-names>S</given-names></string-name>, <string-name><surname>Massa</surname> <given-names>F</given-names></string-name>, <string-name><surname>Lerer</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bradbury</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chanan</surname> <given-names>G</given-names></string-name>, <string-name><surname>Killeen</surname> <given-names>T</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Gimelshein</surname> <given-names>N</given-names></string-name>, <string-name><surname>Antiga</surname> <given-names>L</given-names></string-name>, <string-name><surname>Desmaison</surname> <given-names>A</given-names></string-name>, <string-name><surname>Köpf</surname> <given-names>A</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>E</given-names></string-name>, <string-name><surname>DeVito</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Raison</surname> <given-names>M</given-names></string-name>, <string-name><surname>Tejani</surname> <given-names>A</given-names></string-name>, <string-name><surname>Chilamkurthy</surname> <given-names>S</given-names></string-name>, <string-name><surname>Steiner</surname> <given-names>B</given-names></string-name>, <string-name><surname>Fang</surname> <given-names>L</given-names></string-name>, <string-name><surname>Bai</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chintala</surname> <given-names>S.</given-names></string-name> <year>2019</year>. <article-title>PyTorch: An Imperative Style, High-Performance Deep Learning Library</article-title>. <source>arXiv</source> [csLG].</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="other"><string-name><surname>Pettit</surname> <given-names>NL</given-names></string-name>, <string-name><surname>Yuan</surname> <given-names>XC</given-names></string-name>, <string-name><surname>Harvey</surname> <given-names>CD</given-names></string-name>. <year>2022</year>. <article-title>Hippocampal place codes are gated by behavioral engagement</article-title>. <source>Nat Neurosci</source>. doi:<pub-id pub-id-type="doi">10.1038/s41593-022-01050-4</pub-id></mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Plitt</surname> <given-names>MH</given-names></string-name>, <string-name><surname>Giocomo</surname> <given-names>LM</given-names></string-name>. <year>2021</year>. <article-title>Experience-dependent contextual codes in the hippocampus</article-title>. <source>Nat Neurosci</source> <volume>24</volume>:<fpage>705</fpage>–<lpage>714</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Romani</surname> <given-names>S</given-names></string-name>, <string-name><surname>Tsodyks</surname> <given-names>M.</given-names></string-name> <year>2010</year>. <article-title>Continuous attractors with morphed/correlated maps</article-title>. <source>PLoS Comput Biol</source> <volume>6</volume>. doi:<pub-id pub-id-type="doi">10.1371/journal.pcbi.1000869</pub-id></mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="other"><string-name><surname>Rule</surname> <given-names>ME</given-names></string-name>, <string-name><surname>Loback</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Raman</surname> <given-names>DV</given-names></string-name>, <string-name><surname>Driscoll</surname> <given-names>L</given-names></string-name>, <string-name><surname>Harvey</surname> <given-names>CD</given-names></string-name>, <string-name><surname>O’Leary</surname> <given-names>T.</given-names></string-name> <year>2020</year>. <article-title>Stable task information from an unstable neural population</article-title>. <source>bioRxiv</source>. doi:<pub-id pub-id-type="doi">10.1101/796334</pub-id></mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Samsonovich</surname> <given-names>A</given-names></string-name>, <string-name><surname>McNaughton</surname> <given-names>BL</given-names></string-name>. <year>1997</year>. <article-title>Path integration and cognitive mapping in a continuous attractor neural network model</article-title>. <source>J Neurosci</source> <volume>17</volume>:<fpage>5900</fpage>–<lpage>5920</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Sanders</surname> <given-names>H</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Gershman</surname> <given-names>SJ</given-names></string-name>. <year>2020</year>. <article-title>Hippocampal remapping as hidden state inference</article-title>. <source>Elife</source> <volume>9</volume>. doi:<pub-id pub-id-type="doi">10.7554/eLife.51140</pub-id></mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Sargolini</surname> <given-names>F</given-names></string-name>, <string-name><surname>Fyhn</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hafting</surname> <given-names>T</given-names></string-name>, <string-name><surname>McNaughton</surname> <given-names>BL</given-names></string-name>, <string-name><surname>Witter</surname> <given-names>MP</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>M-B</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>EI</given-names></string-name>. <year>2006</year>. <article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title>. <source>Science</source> <volume>312</volume>:<fpage>758</fpage>–<lpage>762</lpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="other"><string-name><surname>Schøyen</surname> <given-names>VS</given-names></string-name>, <string-name><surname>Pettersen</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Holzhausen</surname> <given-names>K.</given-names></string-name> <year>2022</year>. <article-title>Navigating Multiple Environments with Emergent Grid Cell Remapping</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Sheintuch</surname> <given-names>L</given-names></string-name>, <string-name><surname>Geva</surname> <given-names>N</given-names></string-name>, <string-name><surname>Baumer</surname> <given-names>H</given-names></string-name>, <string-name><surname>Rechavi</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Rubin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Ziv</surname> <given-names>Y.</given-names></string-name> <year>2020</year>. <article-title>Multiple Maps of the Same Spatial Context Can Stably Coexist in the Mouse Hippocampus</article-title>. <source>Curr Biol</source> <volume>30</volume>:<fpage>1467</fpage>–<lpage>1476</lpage>.e6.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Solstad</surname> <given-names>T</given-names></string-name>, <string-name><surname>Boccara</surname> <given-names>CN</given-names></string-name>, <string-name><surname>Kropff</surname> <given-names>E</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>M-B</given-names></string-name>, <string-name><surname>Moser</surname> <given-names>EI</given-names></string-name>. <year>2008</year>. <article-title>Representation of geometric borders in the entorhinal cortex</article-title>. <source>Science</source> <volume>322</volume>:<fpage>1865</fpage>–<lpage>1868</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Song</surname> <given-names>HF</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>GR</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X-J.</given-names></string-name> <year>2016</year>. <article-title>Training Excitatory-Inhibitory Recurrent Neural Networks for Cognitive Tasks: A Simple and Flexible Framework</article-title>. <source>PLoS Comput Biol</source> <volume>12</volume>:<fpage>e1004792</fpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Stringer</surname> <given-names>C</given-names></string-name>, <string-name><surname>Pachitariu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Steinmetz</surname> <given-names>N</given-names></string-name>, <string-name><surname>Reddy</surname> <given-names>CB</given-names></string-name>, <string-name><surname>Carandini</surname> <given-names>M</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>KD</given-names></string-name>. <year>2019</year>. <article-title>Spontaneous behaviors drive multidimensional, brainwide activity</article-title>. <source>Science</source> <volume>364</volume>:<fpage>255</fpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Sussillo</surname> <given-names>D</given-names></string-name>, <string-name><surname>Barak</surname> <given-names>O.</given-names></string-name> <year>2013</year>. <article-title>Opening the black box: low-dimensional dynamics in high-dimensional recurrent neural networks</article-title>. <source>Neural Comput</source> <volume>25</volume>:<fpage>626</fpage>–<lpage>649</lpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="other"><string-name><surname>Uria</surname> <given-names>B</given-names></string-name>, <string-name><surname>Ibarz</surname> <given-names>B</given-names></string-name>, <string-name><surname>Banino</surname> <given-names>A</given-names></string-name>, <string-name><surname>Zambaldi</surname> <given-names>V</given-names></string-name>, <string-name><surname>Kumaran</surname> <given-names>D</given-names></string-name>, <string-name><surname>Hassabis</surname> <given-names>D</given-names></string-name>, <string-name><surname>Barry</surname> <given-names>C</given-names></string-name>, <string-name><surname>Blundell</surname> <given-names>C.</given-names></string-name> <year>2020</year>. <article-title>A model of egocentric to allocentric understanding in mammalian brains</article-title>. <source>bioRxiv</source>. doi:<pub-id pub-id-type="doi">10.1101/2020.11.11.378141</pub-id></mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><surname>Vinck</surname> <given-names>M</given-names></string-name>, <string-name><surname>Batista-Brito</surname> <given-names>R</given-names></string-name>, <string-name><surname>Knoblich</surname> <given-names>U</given-names></string-name>, <string-name><surname>Cardin</surname> <given-names>JA</given-names></string-name>. <year>2015</year>. <article-title>Arousal and locomotion make distinct contributions to cortical activity patterns and visual encoding</article-title>. <source>Neuron</source> <volume>86</volume>:<fpage>740</fpage>–<lpage>754</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>Whittington</surname> <given-names>JCR</given-names></string-name>, <string-name><surname>Muller</surname> <given-names>TH</given-names></string-name>, <string-name><surname>Mark</surname> <given-names>S</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>G</given-names></string-name>, <string-name><surname>Barry</surname> <given-names>C</given-names></string-name>, <string-name><surname>Burgess</surname> <given-names>N</given-names></string-name>, <string-name><surname>Behrens</surname> <given-names>TEJ</given-names></string-name>. <year>2020</year>. <article-title>The Tolman-Eichenbaum Machine: Unifying Space and Relational Memory through Generalization in the Hippocampal Formation</article-title>. <source>Cell</source> <volume>183</volume>:<fpage>1249</fpage>–<lpage>1263</lpage>.e23.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><surname>Yang</surname> <given-names>GR</given-names></string-name>, <string-name><surname>Joglekar</surname> <given-names>MR</given-names></string-name>, <string-name><surname>Song</surname> <given-names>HF</given-names></string-name>, <string-name><surname>Newsome</surname> <given-names>WT</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X-J.</given-names></string-name> <year>2019</year>. <article-title>Task representations in neural networks trained to perform many cognitive tasks</article-title>. <source>Nat Neurosci</source> <volume>22</volume>:<fpage>297</fpage>–<lpage>306</lpage>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Yang</surname> <given-names>GR</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X-J.</given-names></string-name> <year>2021</year>. <article-title>Artificial neural networks for neuroscientists: a primer</article-title>. <source>Neuron</source> <volume>109</volume>:<fpage>739</fpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Zhou</surname> <given-names>M</given-names></string-name>, <string-name><surname>Liang</surname> <given-names>F</given-names></string-name>, <string-name><surname>Xiong</surname> <given-names>XR</given-names></string-name>, <string-name><surname>Li</surname> <given-names>L</given-names></string-name>, <string-name><surname>Li</surname> <given-names>H</given-names></string-name>, <string-name><surname>Xiao</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Tao</surname> <given-names>HW</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>LI</given-names></string-name>. <year>2014</year>. <article-title>Scaling down of balanced excitation and inhibition by active behavioral states in auditory cortex</article-title>. <source>Nat Neurosci</source> <volume>17</volume>:<fpage>841</fpage>–<lpage>850</lpage>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.86943.2.sa4</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ostojic</surname>
<given-names>Srdjan</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>École Normale Supérieure - PSL</institution>
</institution-wrap>
<city>Paris</city>
<country>France</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>important</bold> work provides evidence that artificial recurrent neural networks can be used to investigate neural mechanisms underlying reversible remapping of spatial representations. Authors perform <bold>convincing</bold> state of the art analyses showing how population activity preserves the encoding of spatial position despite remappings due to the tracking of an internal variable. This paper will be of interest to neuroscientists studying contextual computations, neural representation of space and links between artificial neural networks and the brain.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.86943.2.sa3</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Based on a recent report of spontaneous and reversible remapping of spatial representations in the enthorhinal cortex (Low et al 2021), this study sets out to examine possible mechanisms by which a network can simultaneously represent a positional variable and an uncorrelated binary internal state. To this end, the authors analyse the geometry of activity in recurrent neural networks trained to simultaneously encode an estimate of position in a one-dimensional track and a transiently-cued binary variable. They find that network activity is organised along two separate ring manifolds. The key result is that these two manifolds are significantly more aligned than expected by chance, as previously found in neural recordings. Importantly, the authors show that this is not a direct consequence of the design of the model, and clarify scenarios by which weaker alignment could be achieved. The model is then extended to a two-dimensional track, and to more than two internal variables. The latter case is compared with experimental data that had not been previously analysed.</p>
<p>Strengths:</p>
<list list-type="bullet">
<list-item><p>rigorous and careful analysis of activity in trained recurrent neural networks</p>
</list-item>
<list-item><p>particular care is taken to show that the obtained results are not a necessary consequence of the design of the model</p>
</list-item>
<list-item><p>the writing is very clear and pleasant to read</p>
</list-item>
<list-item><p>close comparison with experimental data</p>
</list-item>
<list-item><p>extensions beyond the situations studied in experiments (two-dimensional track, more than two internal states)</p>
</list-item>
</list>
<p>Weaknesses:</p>
<list list-type="bullet">
<list-item><p>no major weaknesses</p>
</list-item>
<list-item><p>(minor) the comparison with previous models of remapping could be expanded</p>
</list-item>
</list>
<p>Altogether the conclusions claimed by the authors seem to be strongly supported and convincing.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.86943.2.sa2</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This important work presents an example of a contextual computation in a navigation task through a comparison of task driven RNNs and mouse neuronal data. Authors perform convincing state of the art analyses demonstrating compositional computation with valuable properties for shared and distinct readouts. This work will be of interest to those studying contextual computation and navigation in biological and artificial systems.</p>
<p>This work advances intuitions about recent remapping results. Authors trained RNNs to output spatial position and context given velocity and 1-bit flip-flops. Both of these tasks have been trained separately, but this is the first time to my knowledge that one network was trained to output both context and spatial position. This work is also somewhat similar to previous work where RNNs were trained to perform a contextual variation on the Ready-Set-Go with various input configurations (Remington et al. 2018). Additionally findings in the context of recent motor and brain machine interface tasks are consistent with these findings (Marino et al in prep). In all cases contextual input shifts neural dynamics linearly in state space. This shift results in a compositional organization where spatial position can be consistently decoded across contexts. This organization allows for generalization in new contexts. These findings in conjunction with the present study make a consistent argument that remapping events are the result of some input (contextual or otherwise) that moves the neural state along the remapping dimension.</p>
<p>The strength of this paper is that it tightly links theoretical insights with experimental data, demonstrating the value of running simulations in artificial systems for interpreting emergent properties of biological neuronal networks. For those familiar with RNNs and previous work in this area, these findings may not significantly advance intuitions beyond those developed in previous work. It's still valuable to see this implementation and satisfying demonstration of state of the art methods. The analysis of fixed points in these networks should provide a model for how to reverse engineer and mechanistically understand computation in RNNs.</p>
<p>I'm curious how the results might change or look the same if the network doesn't need to output context information. One prediction might be that the two rings would collapse resulting in completely overlapping maps in either context. I think this has interesting implications about the outputs of the biological system. What information should be maintained for potential readout and what information should be discarded? This is relevant for considering the number of maps in the network. Additionally, I could imagine the authors might reproduce their current findings in another interesting scenario: Train a network on the spatial navigation task without a context output. Fix the weights. Then provide a new contextual input for the network. I'm curious whether the geometric organization would be similar in this case. This would be an interesting scenario because it would show that any random input could translate the ring attractor that maintains spatial position information without degradation. It might not work, but it could be interesting to try!</p>
<p>I was curious and interested in the authors choice to not use activity or weight regularization in their networks. My expectation is that regularization might smooth the ring attractor to remove coding irrelevant fluctuations in neural activity. This might make Supplementary Figure 1 look more similar across model and biological remapping events (Line 74). I think this might also change the way authors describe potential complex and high dimensional remapping events described in Figure 2A.</p>
<p>Overall this is a nice demonstration of state-of-the-art methods to reverse engineer artificial systems to develop insights about biological systems. This work brings together concepts for various tasks and model organisms to provide a satisfying analysis of this remapping data.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.86943.2.sa1</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This important work provides convincing evidence that artificial recurrent neural networks can be used to model neural activity during remapping events while an animal is moving along a one-dimensional circular track. This will be of interest to neuroscientists studying the neural dynamics of navigation and memory, as well as the community of researchers seeking to make links between artificial neural networks and the brain.</p>
<p>Low et al. trained artificial recurrent neural networks (RNNs) to keep track of their location during a navigation task and then compared the activity of these model neurons to the firing rates of real neurons recorded while mice performed a similar task. This study shows that a simple set of ingredients, namely, keeping track of spatial location along a one-dimensional circular track, along with storing the memory of a binary variable (representing which of the two spatial maps are currently being used), are enough to obtain model firing rates that reproduce features of real neural recordings during remapping events. This offers both a normative explanation for these neural activity patterns as well as a potential biological implementation.</p>
<p>One advantage of this modeling approach using RNNs is that this gives the authors a complete set of firing rates that can be used to solve the task. This makes analyzing these RNNs easier, and opens the door for analyses that are not always practical with limited neural data. The authors leverage this to study the stable and unstable fixed points of the model. However, in this paper there appear to be a few places where analyses that were performed on the RNNs were not performed on the neural data, missing out on an opportunity to appreciate the similarity, or identify differences and pose challenges for future modeling efforts. For example, in the neural data, what is the distribution of the differences between the true remapping vectors for all position bins and the average remapping vector? What is the dimensionality of the remapping vectors? Do the remapping vectors vary smoothly over position? Do the results based on neural data look similar to the results shown for the RNN models (Figures 2C-E)?</p>
<p>There are many choices that must be made when simulating RNNs and there is a growing awareness that these choices can influence the kinds of solutions RNNs develop. For example, how are the parameters of the RNN initialized? How long is the RNN trained on the task? Are the firing rates encouraged to be small or smoothly varying during training? For the most part these choices are not explored in this paper so I would interpret the authors' results as highlighting a single slice of the solution space while keeping in mind that other potential RNN solutions may exist. For example, the authors note that the RNN and biological data do not appear to solve the 1D navigation and remapping task with the simplest 3-dimensional solution. However, it seems likely that an RNN could also be trained such that it only encodes the task relevant dynamics of this 3-dimensional solution, by training longer or with some regularization on the firing rates. Similarly, a higher-dimensional RNN solution may also be possible and this would likely be necessary to explain the more variable manifold misalignment reported in the experimental data of Low et al. 2021 as opposed to the more tightly aligned distribution for the RNNs in this paper. However, thanks to the modeling work done in this paper, the door has now been opened to these and many other interesting research directions.</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.86943.2.sa0</article-id>
<title-group>
<article-title>Author Response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Low</surname>
<given-names>Isabel I.C.</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-6465-8459</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Giocomo</surname>
<given-names>Lisa M.</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0416-2528</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Williams</surname>
<given-names>Alex H.</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5853-103X</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors' response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p>
<p>This is a list of suggestions the authors could use to improve the details of the manuscript:</p>
<p>
- it is not immediately clear what is meant by &quot;modular&quot; on line 38 and the corresponding paragraph. This aspect is not mentioned or developed in the Results.</p>
<p>
- the discussion of remapping vectors on lines 119-137 is particularly illuminating. It could have been interesting to generate surrogate manifolds separated by arbitrary remapping vectors and see how much the alignment metric (Procrustes shape) is sensitive to the dimensionality or amplitude of remapping vectors.</p>
<p>
- A visual comparison between Fig 1 D and H suggests a difference between the manifold geometry in experiments and in the model. It seems that the embedding dimensionality of ring manifolds is higher in the data than in the model. Is that the case? It could have been interesting to explore how much embedding dimensionality influences the alignment metric.</p>
<p>
- I could not find information about the initialization of the connectivity weights. An important possibility is that the degree of alignment (and the organization of remapping vectors) depends on the strength of initial random connectivity.</p>
<p>
- It might have been interesting to comment on the relationship between the top three PCS in Fig1 and the three readout vectors. To which extent are they aligned?</p>
<p>
- I found panels C and G in Fig 1 somewhat difficult to read. In panel C, the remapping seems to be aligned to the same position across all trials. This is not the case in panel G. I am not certain what the comparison is meant to convey, but it would help to have a similar alignment in C and G. Similarly, I was not sure what to conclude from the matrix in the right part of panel C, perhaps the legend should be expanded.</p>
<p>
- the comparison with remapping models of Misha Tsodyks could be expanded. The current discussion implies that the model of Romani &amp; Tsodyks leads to less alignment than found in trained networks, but no direct evidence is given for that statement as far as I can tell.</p>
<p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p>
<p>Minor points:</p>
<p>All mentions of 'modularity' should be replaced with 'compositionality'.</p>
<p>I found Supplementary Figure 2 highly confusing. I thought it was meant to help understand the analysis in Figure 1K and related figures. In the end, I never really understood what was happening in these figures. Do authors make perturbations along these different coding dimensions and compare the resulting maps? I wasn't sure what exactly the authors were calculating cosine similarity for. Maybe more exposition on this in the methods would help other readers as well.</p>
<p>Was there any behavioral difference when the maps were not aligned?</p>
<p>Why did the authors only go up to 10 contexts? Was this dependent on size of the network? Sorry if I missed this.</p>
<p>Are remapping event aligned to unit axes? Would this change with different nonlinearities? This could be interesting in the context of (Driscoll et all 2022) and (Wittington et al 2022).</p>
<p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p>
<p>Cueva, Ardalan, et al. 2021 arXiv:2111.01275 showed that RNNs trained to remember two circular variables develop a toroidal geometry to store this information, so consider citing this in your section on the toroidal manifolds.</p>
</disp-quote>
<p>We thank the reviewers for their thoughtful comments. We appreciate that all three reviewers affirmed the importance of our work and the rigor of our approach. We believe that no major weaknesses were identified by the reviews. In our view, the comparisons between recurrent neural network models and experimental data are one of the most important contributions of our work, and all reviewers agreed that this was a core strength of the manuscript.</p>
<p>The reviewers highlighted several future modeling directions that are raised by our results and that we did not explore in the manuscript. For example, Reviewer 2 suggests that we train networks on a navigation task alone, freeze the weights, and then train on a context discrimination task. We agree that this kind of contextual learning paradigm is of interest and could provide insight into biological remapping, such as that observed by Low et al. (2021). We also agree with Reviewer 3’s broader point that “There are many choices that must be made when simulating RNNs and there is a growing awareness that these choices can influence the kinds of solutions RNNs develop.” It is notable that we were able to reproduce the qualitative features of the experimental data without finely tuning hyperparameters (we used default settings in PyTorch layers), using a very basic training protocol (gradient descent with gradient clipping), and without adding any hand crafted regularization (though we agree that regularization could make the RNN solution look even more like the data).</p>
<p>We believe that readers will benefit from reading the reviewers' suggestions, which are insightful and well-motivated. Having weighed the reviewer comments carefully, we feel that our manuscript stands as a complete scientific story. We hope that the public reviewer comments will inspire future investigations to fully explore these possibilities and unpack their outcomes at a level of detail that would not be possible in the context of our manuscript.</p>
<p>Thus, we have chosen to implement the following minor changes suggested by the reviewers, which we hope will improve the clarity of the text and figures (summarized below). These changes do not alter the fundamental content of the manuscript.</p>
<p>Text:</p>
<list list-type="bullet">
<list-item><p>We corrected a few minor typos.</p>
</list-item>
<list-item><p>We updated the citations to follow the eLife citation style.</p>
</list-item>
<list-item><p>To address comments from Reviewers 1 and 2: we reworded the final paragraph of the Introduction (p. 3) to remove the term “modularity” and clarify our main finding. Those sentences now read, “The RNN geometry and algorithmic principles readily generalized from a simple task to more complex settings. Furthermore, we performed a new analysis of experimental data published in Low et al.26 and found a similar geometric structure in neural activity from a subset of sessions with more than two stable spatial maps.”</p>
</list-item>
<list-item><p>To address comments from Reviewer 1: in the first paragraph of the Results section <italic>A recurrent neural network model of 1D navigation and context inference remaps between aligned ring manifolds</italic> (p. 3), we added the sentence, “Remapping was not aligned to particular track positions, rewards, or landmarks.” to clarify that experimental result from Low et al. (2021).</p>
</list-item>
<list-item><p>To address comments from Reviewer 3: in the final paragraph of the Results section <italic>Aligned toroidal manifolds emerge in a 2D generalization of the task</italic> (p. 11) we clarified that models were trained “to estimate position on a 2D circular track.” We also added a citation to Cueva, Ardalan et al. (2021) with the following sentence, “Notably, each toroidal manifold alone is reminiscent of networks trained to store two circular variables without remapping.”</p>
</list-item>
</list>
<list list-type="bullet">
<list-item><p>To address a question from Reviewer 2: in the final paragraph of the Results section <italic>Manifold alignment generalizes to three or more maps</italic> (p. 13), we added the following clarification: “In Supplemental Figure 3, we show that RNNs are capable of solving this task with larger numbers of latent states (more than three<bold>;</bold> for simplicity, we consider up to 10 states).”</p>
</list-item>
<list-item><p>To address a comment from Reviewer 1: in the fourth paragraph of the Discussion (p. 17), we removed the sentence, “Notably, our model captured aspects of the data that these previous forward-engineered models did not explore—namely, that the ring manifolds corresponding to the correlated spatial maps were much more aligned than expected by chance and than strictly required by the task.” to focus on the key point in the following sentence that, “forward-engineered models provide insights into <italic>how</italic> neural circuits may remap, but do not answer <italic>why</italic> they do so.”</p>
</list-item>
<list-item><p>To address comments from Reviewers 1 and 2: we reworded the penultimate paragraph of the Discussion (p. 17–18) to clarify our findings and remove the term “modularity” (except when referencing papers that themselves use that term (Driscoll et al., 2022; Yang et al., 2019)). Those sentences now read:</p>
</list-item>
</list>
<p>“When RNN architecture is explicitly designed to include dedicated neural subpopulations, these subpopulations can improve model performance on particular types of tasks (Beiran et al., 2021; Dubreuil et al., 2022). Thus, there is an emerging conclusion that RNNs use simple dynamical motifs as building blocks for more general and complex computations, which our results support. In particular, aligned ring attractors are a recurring, dynamical motif in our results, appearing first in a simple task setting (2 maps of a 1D environment) and subsequently as a component of RNN dynamics in more complex settings (e.g., as sub-manifolds of toroidal attractors in a 2D environment, see Figure 4). We can therefore conceptualize a pair of aligned ring manifolds as a dynamical “building block” that RNNs utilize to solve higher-dimensional generalizations of the task. Intriguingly, our novel analysis of neural data from Low et al. (2021) revealed that similar principles may hold in biological circuits—when three or more spatial maps were present in a recording, the pairs of ring manifolds tended to be aligned.”</p>
<list list-type="bullet">
<list-item><p>To address questions from Reviewers 2 and 3: in the first paragraph of the Methods section <italic>RNN Model and Training Procedure</italic> (p. 21), we added the sentence: “The connection weights were randomly initialized from the uniform distribution 𝑈(−√1/N, √1/N), which is the default initialization scheme in PyTorch.”</p>
</list-item></list>
<list list-type="bullet">
<list-item><p>To address a question from Reviewer 2: we added a third paragraph to the Methods section <italic>Manifold Geometry Analysis</italic> (p. 23), as follows:</p>
</list-item></list>
<p>“In Figure 1K, 4G, 5G, and Supplementary Figure 2B, we calculate the angles between the input and output weights and the position subspace or remapping dimension. To find this angle, we calculated the cosine similarity between each weight vector and each subspace. Cosine similarity of 0 indicates that the weights were orthogonal to the subspace, while a similarity of 1 indicates that the weight vector was contained within the subspace.”</p>
<list list-type="bullet">
<list-item><p>To address a question from Reviewer 1: we added the following sentence to the second paragraph of the Methods section <italic>Experimental Data</italic> (p. 24), “We performed the same analysis of trial-by-trial spatial stability to obtain the similarity matrices in Figure 1C and G.”</p>
</list-item></list>
<p>Figures and legends:</p>
<list list-type="bullet">
<list-item><p>To address a question from Reviewer 1: in Figure 1C and G, we added x-axis labels to the similarity matrices to clarify that these are trial-by-trial correlations.</p>
</list-item>
<list-item><p>To address a question from Reviewer 1: we expanded the Figure 1C legend to clarify the experimental results as follows:</p>
</list-item>
</list>
<p><italic>Old legend:</italic></p>
<p>(C, left) An example medial entorhinal cortex neuron switches between two maps of the same track (top, raster; bottom, average firing rate by position; red, map 1; black, map 2). (C, right/top) Network-wide trial-by-trial correlations for the spatial firing pattern of all co-recorded neurons in the same example session (colorbar indicates correlation). (C, right/bottom) k-means map assignment.</p>
<p><italic>New legend:</italic></p>
<p>(C, left) An example medial entorhinal cortex neuron switches between two maps of the same track (top, spikes by trial and track position; bottom, average firing rate by position across trials from each map; red, map 1; black, map 2). (C, right/top) Correlation between the spatial firing patterns of all co-recorded neurons for each pair of trials in the same example session (dark gray, high correlation; light gray, low correlation). The population-wide activity is alternating between two stable maps across blocks of trials. (C, right/bottom) K-means clustering of spatial firing patterns results in a map assignment for each trial.</p>
<list list-type="bullet">
<list-item><p>To address comments from Reviewer 3: in the legend of Figure 4C, we added the sentence “Note that the true tori are not linearly embeddable in 3 dimensions, so this projection is an approximation of the true torus structure.”</p>
</list-item>
<list-item><p>To address a question from Reviewer 2: we expanded the legend for Supplementary Figure 2 to clarify the purpose of the figure schematics as follows:</p>
</list-item>
</list>
<p><italic>Old legend:</italic></p>
<p>(A)  Schematic showing the orthogonalization of the position and context input and output weights.</p>
<p>(B)  Reproduced from Figure 1K.</p>
<p>(C-D) Schematic: How a single velocity input (blue arrows) updates the position estimate (yellow to red points) from the starting position (blue points).</p>
<p>(C)  Velocity input lies in the position tuning subspace (gray plane)(hypothetical). Note that the same velocity input results in different final positions.</p>
<p>(D)  Velocity input is orthogonal to the position tuning subspace (observed).</p>
<p>(E)  Schematic of possible flow fields in each of the three planes (numbers correspond to planes in C and D), which would result in the correct positional estimate given orthogonal velocity inputs at different positions (D).</p>
<p><italic>New legend:</italic></p>
<p>(A)  Schematic showing the relative orientation of the position output weights and the context input and output weights to the position and state tuning subspaces.</p>
<p>(B)  Reproduced from Figure 1K.</p>
<p>(C-D) Schematic to interpret why the position input weights are orthogonal to the position tuning subspace. These schematics illustrate how a single velocity input (blue arrows) updates the position estimate (yellow to red points) from a given starting position (blue points).</p>
<p>(C, not observed) Velocity input lies in the position tuning subspace (gray plane). Note that the same velocity input pushes the network clockwise or counterclockwise along the ring depending on the circular position</p>
<p>(D, observed) Velocity input is orthogonal to the position tuning subspace and pushes neural activity out of the subspace.</p>
<p>(E) Schematic of possible flow fields in each of three planes (numbers correspond to planes in C and D). We conjecture that these dynamics would enable a given orthogonal velocity input to nonlinearly update the position estimate, resulting in the correct translation around the ring regardless of starting position (as in D).</p>
</body>
</sub-article>
</article>