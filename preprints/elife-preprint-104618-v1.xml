<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">104618</article-id>
<article-id pub-id-type="doi">10.7554/eLife.104618</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.104618.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Raw signal segmentation for estimating RNA modification from Nanopore direct RNA sequencing data</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0008-6160-3637</contrib-id>
<name>
<surname>Cheng</surname>
<given-names>Guangzhao</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2164-9469</contrib-id>
<name>
<surname>Vehtari</surname>
<given-names>Aki</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6391-2360</contrib-id>
<name>
<surname>Cheng</surname>
<given-names>Lu</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<email>lu.cheng@uef.fi</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/020hwjq30</institution-id><institution>Department of Computer Science, Aalto University</institution></institution-wrap>, <city>Espoo</city>, <country country="FI">Finland</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00cyydd11</institution-id><institution>Institute of Biomedicine, University of Eastern Finland</institution></institution-wrap>, <city>Kuopio</city>, <country country="FI">Finland</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Altemose</surname>
<given-names>Nicolas</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Stanford University</institution>
</institution-wrap>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Moses</surname>
<given-names>Alan M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Toronto</institution>
</institution-wrap>
<city>Toronto</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-03-06">
<day>06</day>
<month>03</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP104618</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-12-04">
<day>04</day>
<month>12</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-10-10">
<day>10</day>
<month>10</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.01.11.575207"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Cheng et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Cheng et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-104618-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Estimating RNA modifications from Nanopore direct RNA sequencing data is a critical task for the RNA research community. However, current computational methods often fail to deliver satisfactory results due to inaccurate segmentation of the raw signal. We have developed a new method, SegPore, which leverages a molecular jiggling translocation hypothesis to improve raw signal segmentation. SegPore is a pure white-box model with enhanced interpretability, significantly reducing structured noise in the raw signal. We demonstrate that SegPore outperforms state-of-the-art methods, such as Nanopolish and Tombo, in raw signal segmentation across three large benchmark datasets. Moreover, the improved signal segmentation achieved by SegPore enables SegPore+m6Anet to deliver state-of-the-art performance in site-level m6A identification. Additionally, SegPore surpasses baseline methods like CHEUI in single-molecule level m6A identification.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Add single molecule estimation. Supplemental files updated.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>RNA modifications play important roles in different diseases, such as Acute Myeloid Leukemia (<xref ref-type="bibr" rid="c1">1</xref>) and Fragile X Syndrome (<xref ref-type="bibr" rid="c2">2</xref>), as well as fundamental biological processes like cell differentiation (<xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c4">4</xref>) and immune response (<xref ref-type="bibr" rid="c5">5</xref>). To date, researchers have identified over 150 different types of RNA modifications (<xref ref-type="bibr" rid="c6">6</xref>-<xref ref-type="bibr" rid="c9">9</xref>), highlighting the complexity and diversity of RNA regulation. These modifications are essential for proper RNA function, including maintaining secondary structures and facilitating accurate protein synthesis, such as the role of tRNA modifications in decoding mRNA codons (<xref ref-type="bibr" rid="c10">10</xref>).</p>
<p>The practical applications of RNA modifications are far-reaching. For instance, N1-methylpseudouridine (m1Ψ) has been used to enhance the efficacy of COVID-19 mRNA vaccines, highlighting their therapeutic potential (<xref ref-type="bibr" rid="c11">11</xref>). However, identifying and characterizing RNA modifications presents significant challenges due to the limitations of existing experimental techniques.</p>
<p>Traditional methods for RNA modification detection, such as MeRIP-Seq (<xref ref-type="bibr" rid="c12">12</xref>), miCLIP (<xref ref-type="bibr" rid="c13">13</xref>), and m6ACE-Seq (<xref ref-type="bibr" rid="c14">14</xref>), rely on immunoprecipitation techniques that use modification-specific antibodies. While effective, these methods have several drawbacks. First, each method requires a separate antibody for each RNA modification, making it difficult to study multiple modifications simultaneously. Additionally, these techniques can only infer modification locations from next-generation sequencing (NGS) data, rather than measuring the modifications directly. As a result, they struggle to provide single-molecule resolution, limiting their accuracy and scope.</p>
<p>Recent advancements in direct RNA sequencing (DRS) by Oxford Nanopore Technologies (ONT) offer a promising alternative. DRS allows for the direct measurement of electrical currents as RNA molecules translocate through a nanopore, providing a potential avenue for detecting RNA modifications at the single-molecule level. In this technique, five nucleotides (5mers) reside in the nanopore at a time, and each 5mer generates a characteristic current signal based on its unique sequence and chemical properties (<xref ref-type="bibr" rid="c16">16</xref>). By analyzing these signals, it is possible to infer the original RNA sequence and detect modifications like N6-methyladenosine (m6A).</p>
<p>However, significant computational challenges remain. Segmenting the raw current signal into distinct 5mers and distinguishing between normal nucleotides and their modified counterparts is a complex task. Current methods, such as Nanopolish (<xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c16">16</xref>) and Tombo (<xref ref-type="bibr" rid="c17">17</xref>), employ models like Hidden Markov Models (HMM) to segment the signal, but they are prone to noise and inaccuracies, which degrade performance in downstream tasks like RNA modification prediction. The root of this issue lies in the fact that these methods do not accurately model the physical process of Nanopore sequencing, particularly the dynamics of the motor protein that drives RNA through the pore. As a result, the segmentation process is not well-aligned with the actual translocation mechanics, leading to signal noise that hinders precise modification detection.</p>
<p>This is where <bold>SegPore</bold>, our novel DRS segmentation and RNA modification prediction tool, steps in. SegPore was specifically developed to address the limitations of current methods by modeling the motor protein dynamics involved in RNA translocation. By incorporating these dynamics into its segmentation algorithm, SegPore significantly reduces signal noise, enabling more accurate segmentation results. This cleaner segmentation foundation improves downstream analyses, allowing for more reliable RNA sequence and modification predictions.</p>
<p>Furthermore, a key limitation of current RNA modification tools, such as m6Anet (<xref ref-type="bibr" rid="c18">18</xref>), lies in the interpretability of their predictions. These deep neural network (DNN)-based methods classify modified and unmodified nucleotides using complex signal features that are not human-readable. This lack of interpretability can be problematic when applying these methods to new datasets, as researchers may struggle to trust the predictions without a clear understanding of how the results were generated. This severely limits their utility in real biological research, where transparency is critical.</p>
<p>In contrast, SegPore offers greater interpretability by using a simpler, more transparent Gaussian Mixture Model (GMM) to differentiate between modified and unmodified nucleotides. Instead of relying on complex, opaque features, SegPore leverages baseline current levels to distinguish between, for example, m6A and normal adenosine. This straightforward approach allows researchers to easily understand the basis of modification predictions, making it more suitable for biological applications where confidence in the prediction process is essential.</p>
<p>By introducing SegPore, we bridge the gaps left by traditional tools. SegPore utilizes a hierarchical hidden Markov model (HHMM) for more precise segmentation and combines it with a GMM for RNA modification prediction, offering both greater accuracy and interpretability. This enables robust m6A modification detection at the single-molecule level, facilitating reliable, transparent predictions for both site-specific and molecule-wide m6A modifications.</p>
</sec>
<sec id="s2">
<title>Material and methods</title>
<sec id="s2a">
<title>SegPore workflow</title>
<sec id="s2a1">
<title>Workflow overview</title>
<p>An overview of SegPore is illustrated in <xref rid="fig1" ref-type="fig">Fig. 1A</xref>, which outlines its five-step process. The output of Step 3 is the “eventalign,” which is analogous to the output generated by the Nanopolish “eventalign” command and can be used as input for downstream models such as m6Anet. Step 4 allows for direct modification prediction at both the site and single-molecule levels. Notably, a key feature of SegPore is the 5mer parameter table, which defines the mean and standard deviation for each 5mer in either an unmodified or modified state. During the training phase, Steps 3∼5 are iterated multiple times to stabilize the parameters in the 5mer table, which are subsequently fixed and applied for modification prediction on the test data. A detailed description of the model is provided in Supplementary Note 1.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>SegPore workflow.</title>
<p>(A) General workflow. The workflow consists of five steps: (<xref ref-type="bibr" rid="c1">1</xref>) First, raw current signals are basecalled and mapped using Guppy and Minimap2. The raw current signal fragments are paired with the corresponding reference RNA sequence fragments. (<xref ref-type="bibr" rid="c2">2</xref>) Next, the raw current signal of each read is segmented using a hierarchical hidden Markov model (HHMM), which provides an estimated mean (<italic>μ</italic><sub><italic>i</italic></sub>) for each segment. (<xref ref-type="bibr" rid="c3">3</xref>) These segments are then aligned with the 5mer list of the reference sequence fragment using a full/partial alignment algorithm, based on a 5mer parameter table. For example, <italic>A</italic><sub>j</sub> denotes the base “A” at the j-th position on the reference. (<xref ref-type="bibr" rid="c4">4</xref>) All signals aligned to the same 5mer across different genomic locations are pooled together, and a two-component Gaussian Mixture Model (GMM) is used to predict the modification at the site-level or single-molecule level. One component of the GMM represents the unmodified state, while the other represents the modified state. (<xref ref-type="bibr" rid="c5">5</xref>) GMM is used to re-estimate the 5mer parameter table.</p>
<p>(B) Hierarchical hidden Markov model (HHMM). The outer HMM segments the current signal into alternating base and transition blocks. The inner HMM approximates the emission probability of a base block by considering neighboring 5mers. A linear model is used to approximate the emission probability of a transition block.</p>
<p>(C) Full/partial alignment algorithms. Rows represent the estimated means of base blocks from the HHMM, and columns represent the 5mers of the reference sequence. Each 5mer can be aligned with multiple estimated means from the current signal.</p>
<p>(D) Gaussian mixture model (GMM) for estimating modification states. The GMM consists of two components: the green component models the unmodified state of a 5mer, and the blue component models the modified state. Each component is described by three parameters: mean (μ), standard deviation (σ), and weight (ω).</p></caption>
<graphic xlink:href="575207v3_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2a2">
<title>Preprocessing</title>
<p>We begin by performing basecalling on the input fast5 file using Guppy, which converts the raw signal data into base sequences. Next, we align the basecalled sequences to the reference genome using Minimap2 (<xref ref-type="bibr" rid="c19">19</xref>), generating a mapping between the reads and the reference sequences. Once aligned, we use Nanopolish’s eventalign to obtain paired raw current signal segments and the corresponding fragments of the reference sequence, providing a precise association between the raw signals and the nucleotide sequence.</p>
<p>To standardize the signal for downstream analyses, we extract the raw current signal segments corresponding to the polyA tail of each read. Since the polyA tail provides a stable reference, we normalize the raw current signals across reads, ensuring that the mean and standard deviation of the polyA tail are consistent across all reads. This step is crucial for reducing variability between different reads and ensuring more accurate signal segmentation and modification prediction in subsequent steps.</p>
</sec>
<sec id="s2a3">
<title>Signal segmentation via hierarchical Hidden Markov model</title>
<p>The RNA translocation hypothesis naturally leads to the use of a hierarchical Hidden Markov Model (HHMM) to segment the raw current signal. As shown in <xref rid="fig1" ref-type="fig">Fig. 1B</xref>, the HHMM consists of two layers. The outer HMM divides the raw signal into alternating base and transition blocks, represented by hidden states “B” (base) and “T” (transition) in <xref rid="fig1" ref-type="fig">Fig. 1B</xref>. Within each base block, the inner HMM models the current signal at a more granular level.</p>
<p>The inner HMM includes four hidden states: “prev,” “next,” “curr,” and “noise.” These correspond to the previous, next, and current 5mer in the pore, while “noise” refers to random fluctuations. Each raw current measurement is emitted from one of these hidden states, providing a detailed model of the signal within the base blocks. A linear model with a large absolute slope is used to represent sharp changes in the transition blocks.</p>
<p>To segment the signal, we first model the likelihood of the HHMM. Given the raw current signal</p>
<p><bold><italic>y</italic></bold> of a read, the hidden states of the outer hidden HMM are denoted by <bold><italic>g. y</italic></bold> and <bold><italic>g</italic></bold> are divided into 2<italic>K</italic> + 1 blocks <bold><italic>c</italic></bold>, where <bold><italic>y</italic></bold><sup>(<italic>k</italic>)</sup>, <bold><italic>g</italic></bold><sup>(<italic>k</italic>)</sup> correspond to <italic>k</italic> th block and <bold><italic>c</italic></bold> = (<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>, …, <italic>c</italic><sub><italic>k</italic></sub>, …, <italic>c</italic><sub>2<italic>K</italic>+1</sub>), <italic>c</italic><sub><italic>k</italic></sub> ∈ {B, T}. Blocks with odd indices (<italic>k</italic> = 1, 3, 5, …, 2<italic>K</italic> + 1) are base blocks, while those with even indices (<italic>k</italic> = 2, 4, …, 2<italic>K</italic>) are transition blocks. The likelihood of the HHMM is given by
<disp-formula id="eqn1">
<graphic xlink:href="575207v3_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn2">
<graphic xlink:href="575207v3_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn3">
<graphic xlink:href="575207v3_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn4">
<graphic xlink:href="575207v3_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="575207v3_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the transition matrix of the outer HMM and <inline-formula><inline-graphic xlink:href="575207v3_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the probability for the first hidden state. It is obviously seen that the first part of the <xref ref-type="disp-formula" rid="eqn2">Eq. 2</xref> are emission probabilities, and the second part are the transition probabilities. It is not possible to directly compute the emission probabilities of the outer HMM (<xref ref-type="disp-formula" rid="eqn3">Eq. 3</xref>) since there exist dependencies for the current signal measurements within a base or transition block. Therefore, we use the inner HMM and linear model (<xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref>) to handle the dependencies and approximate emission probabilities.</p>
<p>The inner HMM models transitions between the “prev,” “next,” “curr,” and “noise” states. For the “prev,” “next,” and “curr” states, a Gaussian distribution is used to model the emission probabilities, while a uniform distribution models the “noise” state. The forward-backward algorithm is used to compute the marginal likelihood of the inner HMM, which approximates the emission probabilities for base blocks. For transition blocks, a standard linear model computes the emission probabilities.</p>
<p>For any given <bold><italic>g</italic></bold>, we can calculate the joint likelihood (<xref ref-type="disp-formula" rid="eqn1">Eq. 1</xref>). We enumerate different configurations and select the one with the highest likelihood. This process segments the raw current signal into alternating base and transition blocks, where one or more base blocks may correspond to a single 5mer. Each base block is characterized by its mean and standard deviation, which are used as input for downstream alignment tasks.</p>
<p>Due to the large size of fast5 files (which can reach terabytes), parameter inference for this model is computationally intensive. To address this, we developed a GPU-based inference algorithm that significantly accelerates the process. More details on this algorithm can be found in Supplementary Note 2.</p>
<p>In summary, the HHMM allows us to accurately segment the raw current signal, providing more precise estimates of the mean and variance for each base block, which are crucial for downstream analyses such as RNA modification prediction.</p>
</sec>
<sec id="s2a4">
<title>5mer parameter table</title>
<p>We downloaded the kmer models “r9.4_180mv_70bps_5mer_RNA” from the GitHub repository of Oxford Nanopore Technologies (ONT) (<ext-link ext-link-type="uri" xlink:href="https://github.com/nanoporetech/kmer_models">https://github.com/nanoporetech/kmer_models</ext-link>). The columns labeled “level_mean” and “level_stdv” in these models were used as the mean and standard deviation values for the unmodified 5mers. These values serve as the initial parameters in the 5mer parameter table for SegPore, which we refer to as the <italic>ONT 5mer parameter table</italic>.</p>
<p>The initialization of the 5mer parameter table is a critical step in SegPore’s workflow. By leveraging ONT’s established kmer models, we ensure that the initial estimates for unmodified 5mers are grounded in empirical data. These initial estimates are refined through SegPore’s iterative parameter estimation process, enabling the model to accurately differentiate between modified and unmodified 5mers during segmentation and modification prediction tasks. The refined 5mer parameters also provide a foundation for downstream analysis, such as alignment and m6A identification.</p>
</sec>
<sec id="s2a5">
<title>Alignment of raw signal segment with reference sequence</title>
<p>After segmenting the raw current signal of a read into base and transition blocks using HHMM, we align the means of base blocks with the 5mer list of the reference sequence.</p>
<sec id="s2a51">
<title>The alignment process involves three main cases</title>
<list list-type="order">
<list-item><p>Base block matching with a 5mer: In this case, a base block aligns with a 5mer, which is modeled by a Gaussian distribution. The 5mer may exist in either an unmodified or modified state, and the corresponding Gaussian parameters are retrieved from the 5mer parameter table.</p></list-item>
<list-item><p>Base block matching with an insertion: Here, the base block aligns with an indel (“-”), indicating an inserted nucleotide in the read.</p></list-item>
<list-item><p>Deletion in the read: In this case, an indel (0.0) matches with a 5mer, representing a deleted nucleotide in the read.</p></list-item>
</list>
<p>The alignment score function models these matching cases as follows. For the first case (a base block matching a 5mer), we calculate the probability that the base block mean is sampled from either the unmodified or modified 5mer’s Gaussian distribution. The larger of the two probabilities is used as the match score. For the second and third cases, the alignment is treated as noise, and a fixed uniform distribution is used to calculate the match score.</p>
<p>An important distinction from classical global alignment algorithms is that one or multiple base blocks may align with a single 5mer. Given the base block means <bold>μ</bold> = (μ<sub>1</sub>, μ<sub>2,…,</sub>μ<sub>i</sub>, …, μ<sub><italic>m</italic></sub>) and 5mer list <bold><italic>s</italic></bold> = (<italic>s</italic><sub>1,</sub><italic>s</italic><sub>2,…,</sub><italic>s</italic><sub><italic>j</italic></sub>, …, <italic>s</italic><sub><italic>n</italic></sub>), we define (<italic>m</italic> + 1) × (<italic>n</italic> + 1) the score matrix as <bold><italic>M</italic></bold> (<xref rid="fig1" ref-type="fig">Fig. 1C</xref>). The first row and column of the matrix are reserved for indels (“0.0” and “-”), representing insertions or deletions in the base blocks or 5mers, respectively.</p>
<p>We denote the score function by <italic>f</italic> The recursion formula of the dynamic programming alignment algorithm is given by
<disp-formula id="eqn5">
<graphic xlink:href="575207v3_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
, where <italic>f</italic> is the score function. It can be seen that we can still align μ<sub>i</sub> with <italic>s</italic><sub><italic>j</italic></sub> after we have aligned μ<sub>i−1</sub> with <italic>s</italic><sub><italic>j</italic></sub>, which fulfills the special consideration that one or multiple base blocks might be aligned with one 5mer.</p>
<p>We implement two types of alignment algorithms (<xref rid="fig1" ref-type="fig">Fig. 1C</xref>) based on the score matrix <bold><italic>M</italic></bold>:</p>
<list list-type="order">
<list-item><p>Full Alignment Algorithm: This algorithm aligns the full list of base block means with the full list of 5mers, similar to classical global alignment. It traces back from the (<italic>m</italic> + 1,<italic>n</italic> + 1) position in the score matrix.</p></list-item>
<list-item><p>Partial Alignment Algorithm: This aligns the full list of base blocks with the initial part of the 5mer list, with no indels allowed in the base block means or the 5mer list. The trace back starts from the maximum value in the last row of the score matrix.</p></list-item>
</list>
<p>A detailed description of both alignment algorithms is provided in Supplementary Note 1. The output of the alignment algorithm is an eventalign, which pairs the base blocks with the 5mers from the reference sequence for each read (<xref rid="fig1" ref-type="fig">Fig. 1C</xref>).</p>
</sec>
</sec>
<sec id="s2a6">
<title>Modification prediction</title>
<p>After obtaining the eventalign results, we estimate the modification state of each motif using the 5mer parameter table. Specifically, for each 5mer, we compare the probability that the base block mean is sampled from either the modified or unmodified 5mer’s Gaussian distribution. If the probability under the modified 5mer distribution is higher, the 5mer is predicted to be in the modification state, and vice versa for the unmodified state.</p>
<p>Since a single 5mer can be aligned with multiple base blocks, we merge all aligned base blocks by calculating a weighted mean. This weighted mean represents the single base block mean aligned with the given 5mer, allowing us to estimate the modification state for each site of a read.</p>
<p>To estimate the overall modification rate at a specific genomic location, we pool all reads that map to that location on the reference sequence. The modification rate is calculated as the proportion of reads that are predicted to be in the modification state at that location. A detailed description of the modification state prediction process can be found in Supplementary Note 1.</p>
</sec>
<sec id="s2a7">
<title>GMM for 5mer parameter table re-estimation</title>
<p>To improve alignment accuracy and enhance modification predictions, we use a Gaussian Mixture Model (GMM) to iteratively fine-tune the 5mer parameter table. As illustrated in <xref rid="fig1" ref-type="fig">Fig. 1A</xref>, the rows of the 5mer parameter table represent the 5mers, while the columns provide the mean and standard deviation for both the unmodified and modified states. We denote a 5mer by <italic>s</italic>, with its relevant parameters as μ<sub><italic>s, un</italic></sub>, δ<sub><italic>s, un</italic>,</sub> μ<sub><italic>s, mod</italic></sub>, δ<sub><italic>s, mod</italic></sub>.</p>
<p>Using the alignment results from all reads, we collect the base block means aligned to the same 5mer (denoted by <italic>s</italic>) across different reads and genomic locations, particularly those with high modification rates. A two-component GMM is then fit to these base blocks. In this process, the mean of the first component is fixed to μ<sub><italic>s, un</italic></sub>, From the GMM, we update the parameters δ<sub><italic>s, un</italic></sub>, <italic>ω</italic><sub><italic>s, un</italic></sub>, μ <sub><italic>s, mod</italic></sub>, δ<sub><italic>s, mod</italic></sub>, and <italic>ω</italic><sub><italic>s, mod</italic></sub>, where <italic>ω</italic><sub><italic>s,un</italic></sub>, <italic>ω</italic><sub><italic>s, mod</italic></sub> represent the weights for the unmodified and modified components, respectively. Afterward, we manually adjust the 5mer parameter table using heuristics to ensure that the modified 5mer distribution is significantly distinct from the unmodified distribution.</p>
<p>This re-estimation process is only performed on the training data. The initial 5mer parameter table is based on the table provided by ONT. After each iteration of updating the table, we rerun the SegPore workflow from the alignment step onward. Typically, the process is repeated three to five times until the 5mer parameter table stabilizes. Once the table is fixed, it is used for RNA modification estimation in the test data without further updates. A more detailed description of the GMM re-estimation process is provided in Supplementary Note 1.</p>
</sec>
</sec>
<sec id="s2b">
<title>Segmentation benchmark</title>
<p>To benchmark the segmentation performance, we used the default parameters for SegPore, Nanopolish (v0.14.0), and Tombo (v1.5.1) to generate the segmentation results, specifically the eventalign outputs. Using the estimated mean and standard deviation for each 5mer, we calculated two metrics: the average log-likelihood and the standard deviation (details provided in Supplementary Note 1, Section 8).</p>
<p>These metrics offer a quantitative assessment of how well each method segments the raw current signals and aligns them to the reference 5mers. The log-likelihood measures how well the segmented raw signal fits the Gaussian distribution of the reference 5mer, with a higher value indicating better alignment. The standard deviation (std) of the aligned segments provides insights into the variability and noise in the segmentation, with lower values indicating less noise.</p>
</sec>
<sec id="s2c">
<title>m6A site level benchmark</title>
<p>The HEK293T wild-type (WT) samples were downloaded from the ENA database (accession number PRJEB40872), while the HCT116 samples were obtained from ENA under accession PRJEB44348. The reference sequence (Homo_sapiens.GRCh38.cdna.ncrna_wtChrIs_modified.fa) was downloaded from <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.4587661">https://doi.org/10.5281/zenodo.4587661</ext-link>. Ground truth data were sourced from Supplementary Data 1 of Pratanwanich, P.N. et al. (<xref ref-type="bibr" rid="c20">20</xref>). Fast5 files for the test dataset (mESC WT samples, mESCs_Mettl3_WT_fast5.tar.gz) (<xref ref-type="bibr" rid="c21">21</xref>) were retrieved from the NCBI Sequence Read Archive (SRA) under accession SRP166020.</p>
<p>During training, we initialized the 5mer parameter table using ONT’s data. The standard SegPore workflow was executed on the training data (HEK293T WT samples), using the full alignment algorithm. The 5mer parameter table estimation was iterated five times. For mapping, reads were first aligned to the cDNA and subsequently converted to genomic locations using Ensembl GTF file (GRCh38, v9). The same 5mer across different genomic locations was pooled together. A 5mer was considered significantly modified if its read coverage exceeded 1,500 and the distance between the means of the two Gaussian components in the GMM was greater than 5. As a result, modification parameters were specified for ten significant 5mers, as illustrated in Supplementary Fig. S2A.</p>
<p>With the estimated 5mer parameter table from the training data, we then ran the SegPore workflow on the test data. The transcript sequences from GENCODE release version M18 were used as the reference sequence for mapping, with the corresponding GTF file (gencode.vM18.chr_patch_hapl_scaff.annotation.gtf) downloaded from GENCODE to convert transcript locations into genomic coordinates. It is important to note that the 5mer parameter table was not re-estimated for the test data. Instead, modification states for each read were directly estimated using the fixed 5mer parameter table. Due to the differences between human (Supplementary Fig. S2A) and mouse (Supplementary Fig. S2B), only six 5mers were found to have m6A annotations in the test data’s ground truth (Supplementary Fig. S2C). For a genomic location to be identified as a true m6A modification site, it had to correspond to one of these six common 5mers and have a read coverage of greater than 20. SegPore derived the ROC and PR curves for benchmarking based on the modification rate at each genomic location.</p>
<p>In the SegPore+m6Anet analysis, we fine-tuned the m6Anet model using SegPore’s eventalign results to demonstrate improved m6A identification. We started with the pre-trained m6Anet model (available at <ext-link ext-link-type="uri" xlink:href="https://github.com/GoekeLab/m6anet">https://github.com/GoekeLab/m6anet</ext-link>, model version: HCT116_RNA002) and fine-tuned it using the eventalign results from HCT116 samples. SegPore’s eventalign output provided the pairing between each genomic location and its corresponding raw signal segment, which allowed us to extract normalized features such as the normalized mean μ<sub>i</sub>, standard deviation σ<sub>i</sub>, dwell time <italic>l</italic><sub>i</sub>. For genomic location i, m6Anet extracts a feature vector <italic>x</italic><sub>i</sub> = {μ<sub>i−1,</sub>σ<sub>i−1,</sub><italic>l</italic><sub>i−1,</sub>μ<sub>i</sub>, σ<sub>i</sub>, <italic>l</italic><sub>i</sub>, μ<sub>i+1,</sub>σ<sub>i+1,</sub><italic>l</italic><sub>i+1</sub>}, which was used as input for m6Anet. Feature vectors from 80% of the genomic locations were used for training, while the remaining 20% were set aside for validation. We ran 100 epochs during fine-tuning, selecting the model that performed best on the validation set.</p>
<p>Ground truth data and the performance of other methods (Tombo v1.5.1, Nanom6A v2.0, m6Anet v1.0, and Epinano v1.2.0) on the mESC dataset were provided through personal communications with Prof. Luo Guanzheng, the corresponding author of the benchmark study referenced (<xref ref-type="bibr" rid="c22">22</xref>).</p>
</sec>
<sec id="s2d">
<title>m6A single molecule level benchmark</title>
<p>The benchmark IVT data for single molecule m6A identification was downloaded from NCBI-SRA with accession number SRP166020. CHEUI was used for the benchmark. For the ground truth, every A in every read of the IVT_m6A sample is treated as a m6A modification and every A in every read of the IVT_normalA is treated as a normal A. Detailed methods for calculating modification probability at single molecule level were provided in Supplementary Note 1, Section 6.1-6.2.</p>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>RNA translocation hypothesis</title>
<p>Accurate segmentation of raw current signals in direct RNA sequencing remains a major challenge, largely because the precise dynamics of RNA translocation through the pore are not fully understood. To address this, we propose a hypothesis that better reflects the physical movement of the RNA molecule. In traditional basecalling algorithms such as Guppy and Albacore, we implicitly assume that the RNA molecule is translocated through the pore by the motor protein in a monotonic fashion, i.e., the RNA is pulled through the pore unidirectionally. In the DNN training process of Guppy and Albacore, we try to align the current signal with the reference RNA sequence. The alignment is unidirectional, which is the source of the implicit monotonic translocating assumption.</p>
<p>Contrary to the conventional assumption of monotonic translocation, the raw current data suggests that the motor protein drives RNA both forward and backward during sequencing. <xref rid="fig2" ref-type="fig">Fig. 2B</xref> illustrates this with several example fragments of DRS raw current signal (<xref ref-type="bibr" rid="c21">21</xref>), where each fragment roughly corresponds to three neighboring 5mers. The raw current signals, as shown in <xref rid="fig1" ref-type="fig">Fig. 1B</xref>, strongly support this hypothesis, with several instances of measured current intensities matching both the previous and next 5mer’s baseline. These repeated patterns, observed across multiple DRS datasets, provide empirical evidence of the jiggling translocation. Similar patterns are widely observed across the whole data. This suggests that the RNA molecule may move forward and backward while passing through the pore. This observation is also supported by previous reports (<xref ref-type="bibr" rid="c23">23</xref>,<xref ref-type="bibr" rid="c24">24</xref>), in which the helicase (the motor protein) translocates the DNA strand through the nanopore in a back-and-forth manner.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>RNA translocation hypothesis.</title>
<p>(A) Jiggling RNA translocation hypothesis. The top panel shows the raw current signal of Nanopore direct RNA sequencing, with gray areas representing SegPore-estimated transition blocks. We focus on three neighboring 5mers, considering the central 5mer (CTACG) as the current 5mer. The RNA molecule may briefly move forward or backward during the translocation of the current 5mer. If the RNA molecule is pulled backward, the previous 5mer is placed in the pore, and the current signal (“prev” state, red dots) resembles the previous 5mer’s baseline (mean and standard deviation highlighted by red lines and shades). If the RNA is pushed forward, the current signal (“next” state, blue dots) is similar to the next 5mer’s baseline.</p>
<p>(B) Example raw current signals supporting the jiggling hypothesis. The dashed rectangles highlight base blocks, with red and blue points representing measurements corresponding to the previous and next 5mer, respectively. Red points align closely with the previous 5mer’s baseline, and blue points match the next 5mer’s baseline, reinforcing the hypothesis that the RNA molecule jiggles between neighboring 5mers. The raw current signals were extracted from mESC WT samples of the training data in the m6A benchmark experiment.</p></caption>
<graphic xlink:href="575207v3_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Based on the reported kinetic model (<xref ref-type="bibr" rid="c23">23</xref>), we hypothesize that the RNA is translocated through the pore in a jiggling manner. This “jiggling” hypothesis presents a significant departure from the traditionally accepted view of unidirectional RNA translocation and aligns better with recent evidence from studies on DNA translocation (<xref ref-type="bibr" rid="c23">23</xref>,<xref ref-type="bibr" rid="c24">24</xref>). Incorporating this hypothesis into segmentation algorithms could lead to more accurate predictions of RNA modifications by accounting for the dynamic nature of translocation. On average, the motor protein sequentially translocates 5mers on the RNA strand forward, and each 5mer resides in the pore for a short time. During the short period of a single 5mer, the motor protein may swiftly drive the RNA molecule forward and backward by 0.5∼1 nucleotide in the translocation process of the current 5mer (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>), which makes the measured current intensity occasionally similar to the previous or the next 5mer. When the motor protein does not move the RNA molecule, we hypothesize that the RNA molecule undergoes slight thermal fluctuations, causing it to oscillate slightly within the pore and produce a stable current close to its baseline. In contrast, sharp changes in current intensity between consecutive 5mers define transition blocks, where one 5mer is replaced by the next.</p>
<p>We also assume that the raw current signal of a read can be segmented into a series of alternating base and transition blocks. In the ideal case, a base block corresponds to the base state where the 5mer resides in the pore and jiggles between neighboring 5mers, i.e., the current 5mer can transiently jump to the previous or the next 5mer. A transition block corresponds to the transition state between two consecutive base states where one 5mer translocates to the next 5mer in the pore. The current signal should be relatively flat in the base blocks, while a sharp change is expected in the transition blocks. One challenge we encountered was the overestimation of transition blocks. This occurs because subtle transitions within a base block may be mistaken for transitions between blocks, leading to inflated transition counts. To address this, SegPore’s alignment algorithms were refined to consolidate multiple base blocks into a single 5mer, improving segmentation accuracy.</p>
</sec>
<sec id="s3b">
<title>SegPore Workflow</title>
<p>The SegPore workflow (<xref rid="fig1" ref-type="fig">Fig. 1</xref>) consists of five key steps: (<xref ref-type="bibr" rid="c1">1</xref>) Preprocess fast5 files to pair raw current signal segments with corresponding RNA sequence fragments; (<xref ref-type="bibr" rid="c2">2</xref>) Segment each raw current signal using a hierarchical hidden Markov model (HHMM) into base and transition blocks; (<xref ref-type="bibr" rid="c3">3</xref>) Align the derived base blocks with the paired RNA sequence; (<xref ref-type="bibr" rid="c4">4</xref>) Fit a two-component GMM to estimate the modification state at the single-molecule level or the modification rate at the site level; (<xref ref-type="bibr" rid="c5">5</xref>) Use the results from Step (<xref ref-type="bibr" rid="c4">4</xref>) to update relevant parameters. Steps (<xref ref-type="bibr" rid="c3">3</xref>) to (<xref ref-type="bibr" rid="c5">5</xref>) are iterative and continue until the estimated parameters stabilize.</p>
<p>The final outputs of SegPore are the “eventalign” and modification state predictions. The SegPore “eventalign” output is similar to Nanopolish’s “eventalign” command, pairing raw current signal segments with the corresponding RNA reference 5mers. For selected 5mers, SegPore also provides the modification rate for each site and the modification state of that site on individual reads.</p>
<p>A key component of SegPore is the 5mer parameter table, which specifies the mean and standard deviation for each 5mer in both modified and unmodified states (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>). Since the peaks (representing modified and unmodified states) are separable for only a subset of 5mers, SegPore can provide modification parameters for these specific 5mers. For other 5mers, modification state predictions are unavailable.</p>
</sec>
<sec id="s3c">
<title>Segmentation benchmark</title>
<p>To evaluate SegPore’s performance in raw signal segmentation, we compared SegPore with Nanopolish (v0.14.0) and Tombo (v1.5.1) using three Nanopore direct RNA sequencing (DRS) datasets: two HEK293T datasets (wild type and Mettl3 knockout) (<xref ref-type="bibr" rid="c20">20</xref>) and the HCT116 dataset (<xref ref-type="bibr" rid="c25">25</xref>). Nanopolish and SegPore employed the “eventalign” method to align 5mers on each read with their corresponding raw signals, producing the mean and standard deviation (std) of the aligned signal segments. Tombo used the “resquiggle” method to segment the raw signals, and we standardized the segments using the polyA tail to ensure a fair comparison.</p>
<p>To benchmark segmentation performance, we used two key metrics: (<xref ref-type="bibr" rid="c1">1</xref>) the log-likelihood of the segment mean, which measures how closely the segment matches ONT’s 5mer parameter table (used as ground truth), and (<xref ref-type="bibr" rid="c2">2</xref>) the standard deviation (std) of the segment, where a lower std indicates reduced noise and better segmentation quality. If the raw signal segment aligns correctly with the corresponding 5mer, its mean should closely match ONT’s reference, yielding a high log-likelihood. A lower std of the segment reflects less noise and better performance overall.</p>
<p>As shown in <xref rid="tbl1" ref-type="table">Table 1</xref>, SegPore consistently achieved the best performance across all datasets, with the highest log-likelihood and the lowest std values. These results suggest that SegPore provides a more accurate segmentation of the raw signal with significantly reduced noise compared to Nanopolish and Tombo.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>Segmentation benchmark</title></caption>
<graphic xlink:href="575207v3_tbl1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>To provide a more intuitive comparison, the segmentation results for two example raw signal clips are illustrated in Supplementary Fig. S1. These examples demonstrate the clearer, more precise segmentation achieved by SegPore compared to Nanopolish.</p>
</sec>
<sec id="s3d">
<title>m6A identification at the site level</title>
<p>We evaluated SegPore’s performance in raw signal segmentation and m6A identification using independent public datasets as both training and test data. Since m6A modifications typically occur at DRACH motifs (where D denotes A, G, or U, and H denotes A, C, or U) (<xref ref-type="bibr" rid="c13">13</xref>), this study focuses on estimating m6A modifications on these motifs.</p>
<p>To begin, we estimated the 5mer parameter table for m6A modifications using Nanopore direct RNA sequencing (DRS) data from three wild-type human HEK293T cell samples (<xref ref-type="bibr" rid="c20">20</xref>). The fast5 files from all samples were concatenated, and the full SegPore workflow was run to obtain the 5mer parameter table. The parameter estimation process was iterated five times to ensure stabilization, refining the modification parameters for ten 5mers where the modification state distribution significantly differs from the unmodified state.</p>
<p>Next, we applied SegPore’s segmentation and m6A identification to test data from wild-type mouse embryonic stem cells (mESCs) (<xref ref-type="bibr" rid="c22">22</xref>). Given the comparable methods and input data requirements, we benchmarked SegPore against several baseline tools, including Tombo, MINES (<xref ref-type="bibr" rid="c26">26</xref>), Nanom6A (<xref ref-type="bibr" rid="c27">27</xref>), m6Anet, Epinano (<xref ref-type="bibr" rid="c28">28</xref>), and CHEUI (<xref ref-type="bibr" rid="c29">29</xref>). Based on the output of SegPore eventalign, we fine-tune m6Anet using the HCT116 data at all DRACH motifs, aiming to demonstrate that the performance of SegPore benefits downstream models. Additionally, due to the differences of the kmer motifs between human and mouse (Supplementary Fig. S2), six shared 5mers were selected to demonstrate SegPore’s performance in modification prediction directly. By utilizing the 5mer parameter table derived from the training data, SegPore employs a two-component GMM to calculate the modification rates at the selected m6A sites.</p>
<p>SegPore demonstrated improved segmentation compared to Nanopolish. <xref rid="fig3" ref-type="fig">Figure 3A</xref> shows the eventalign results at an example genomic location with m6A modifications. SegPore’s results show a more pronounced bimodal distribution in the raw signal segment mean, indicating clearer separation of modified and unmodified signals. Furthermore, when pooling all reads mapped to m6A-modified locations at the GGACT motif, SegPore showed prominent peaks (<xref rid="fig3" ref-type="fig">Fig. 3B</xref>), suggesting reduced noise and improved modification detection.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>m6A identification at the site level.</title>
<p>(A) Histogram of current signals mapped to an example m6A-modified genomic location (chr10:128548315, GGACT) across all reads in the training data, comparing Nanopolish (left) and SegPore (right).</p>
<p>(B) Histogram of current signals mapped to the GGACT motif at all annotated m6A-modified genomic locations in the training data, again comparing Nanopolish (left) and SegPore (right).</p>
<p>(C) Site-level benchmark results for m6A identification across all DRACH motifs, showing performance comparisons between SegPore+m6Anet and other methods.</p>
<p>(D) Benchmark results for m6A identification on six selected motifs at the site level, comparing SegPore and other baseline methods.</p></caption>
<graphic xlink:href="575207v3_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>We evaluated m6A predictions using two approaches: (<xref ref-type="bibr" rid="c1">1</xref>) SegPore’s segmentation results were fed into m6Anet, referred to as SegPore+m6Anet, which works for all DRACH motifs and (<xref ref-type="bibr" rid="c2">2</xref>) direct m6A predictions from SegPore’s Gaussian Mixture Model (GMM), which is limited to the six selected 5mers.</p>
<p>In terms of m6A identification, SegPore performed strongly on the test data. Using miCLIP2 (<xref ref-type="bibr" rid="c30">30</xref>) data as the ground truth, we calculated the area under the curve (AUC) for both the receiver operating characteristic (ROC) and precision-recall (PR) curves. SegPore+m6Anet achieved the best performance with an ROC AUC of 89.0% and a PR AUC of 43.8% (<xref rid="fig3" ref-type="fig">Fig. 3C</xref>). For six selected m6A motifs, SegPore achieved an ROC AUC of 82.7% and a PR AUC of 38.7%, earning the third best performance compared with deep leaning methods m6Anet and CHEUI (<xref rid="fig3" ref-type="fig">Fig. 3D</xref>). It is noteworthy that SegPore’s GMM for m6A estimation is a very simple model, utilizing far fewer parameters than DNN-based methods. Achieving the decent performance with such a simple model is a significant accomplishment. These results highlight SegPore’s robust performance in m6A identification.</p>
</sec>
<sec id="s3e">
<title>m6A identification at the single molecule level</title>
<p>SegPore naturally identifies m6A modifications at the single-molecule level, which is crucial for understanding the heterogeneity of RNA modifications across individual transcripts. We benchmarked SegPore against CHEUI using an <italic>in vitro</italic> transcription (IVT) dataset containing two samples—one transcribed with m6A and the other with normal adenosine (<xref ref-type="bibr" rid="c21">21</xref>). This dataset provides clear ground truth for m6A modifications at the single-molecule level, with all adenosine positions replaced by m6A in the ivt_m6A sample, and all adenosines unmodified in the ivt_normalA sample. We used 60% of the data for training and 40% for testing, with both SegPore and CHEUI estimating the m6A modification probability at each adenosine site on each read. Based on these probabilities, we calculated the ROC-AUC and PR-AUC by varying the modification probability threshold.</p>
<p>As shown in <xref rid="fig4" ref-type="fig">Fig. 4A</xref>, SegPore outperformed CHEUI on this benchmark dataset, achieving better performance in both PR-AUC (94.7% vs 90.3%) and ROC-AUC (93% vs 89.9%). These results clearly demonstrate SegPore’s accuracy and robustness in detecting single-molecule m6A modifications.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>m6A identification at the single-molecule level.</title>
<p>(A) Benchmark results for single-molecule m6A identification on IVT data. SegPore shows better performance compared to CHEUI in both PR-AUC and ROC-AUC.</p>
<p>(B) Comparison of “eventalign” results from SegPore and Nanopolish for five consecutive kmers. Note that DRS is sequenced from 3’ to 5’, so the kmers enters the pore from right to left. A total of 100 reads were randomly sampled from transcript locations A1 (positions 711-719) in both the IVT_normalA and IVT_m6A samples (SRA: SRP166020). Each line represents an individual read, and the y-axis shows the raw signal intensity in picoampere (pA). Pink lines represent the IVT_m6A sample, and gray lines represent the IVT_normalA sample. The kmers “GCGGA,” “CGGAC,” “GGACT,” “GACTT,” and “ACTTT” all contain N6-Methyladenosine (m6A) in the IVT_m6A sample. SegPore’s results show clearer separation between m6A and normal adenosine, especially for “CGGAC” and “GGACT,” compared to Nanopolish.</p>
<p>(C) The upper panel shows the modification rate for selected genomic locations in the example gene ENSMUSG00000003153. The lower panel displays the modification states of all reads mapped to this gene. The black borders in the heatmap highlight the biclustering results, showing distinct modification patterns across different read clusters.</p></caption>
<graphic xlink:href="575207v3_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Next, we demonstrate SegPore’s interpretability through an example comparison of raw signal clips from both ivt_m6A and ivt_normalA samples (<xref rid="fig4" ref-type="fig">Fig. 4B</xref>). The raw signal segments (means) are aligned to a randomly selected m6A site as well as its neighbouring sites in the reference sequence. Each line represents an individual read, with pink lines from the ivt_m6A sample and gray lines from the ivt_normalA sample. SegPore’s segmentation clearly distinguishes between m6A and normal adenosine at the single-molecule level, while Nanopolish’s segmentation shows less distinction.</p>
<p>Interestingly, we observed that the position of m6A within a 5mer can affect the signal intensity. For instance, a clear difference between m6A and adenosine is evident when m6A occupies the fourth position in the 5mer (e.g., “CGGAC”), but this difference is less pronounced when m6A is in the second position (e.g., “GACTT”).</p>
<p>To illustrate the benefits of single-molecule m6A estimation, we present an example gene (ENSMUSG00000003153) from the mESC dataset used in site-level m6A identification. <xref rid="fig4" ref-type="fig">Fig. 4C</xref> shows a heatmap of highly modified genomic locations (modification rate &gt; 0.1), where rows represent reads and columns represent genomic locations. Biclustering reveals six clusters of reads and three clusters of genomic locations.</p>
<p>The heatmap in <xref rid="fig4" ref-type="fig">Fig. 4C</xref> suggests heterogeneity in m6A modification patterns across different reads of the same gene. Biclustering reveals that modifications at the 6th, 7th, and 8th genomic locations are specific to certain clusters of reads (clusters 4, 5, and 6), while the first five genomic locations show similar modification patterns across all reads. Additionally, high modification rates are observed at the 3rd and 5th positions across the majority of reads. These results suggest that m6A modification patterns can vary significantly even within a single gene. This observation highlights the complexity of RNA modification regulation and underscores the importance of single-molecule resolution for understanding RNA function at a finer scale.</p>
</sec>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>One of the main computational challenges in direct RNA sequencing (DRS) lies in accurately segmenting the raw current signal. We developed a segmentation algorithm that leverages the jiggling property in the physical process of DRS, resulting in cleaner current signals for m6A identification at both the site and single-molecule levels. Our results show that m6Anet achieves superior performance, driven by SegPore’s enhanced segmentation. We believe that the de-noised current signals will be beneficial for other downstream tasks. Nevertheless, several open questions remain for future research. In SegPore, we assume a drastic change between two consecutive 5mers, which may hold for 5mers with large difference in their current baselines but may not hold for those with small difference. Another key question concerns the physical interpretation of the derived base blocks. Ideally, one base block would correspond to a single 5mer, but in practice, multiple base blocks often align with one 5mer. We hypothesize that the HHMM may segment a 5mer’s current signal into multiple base blocks, where the 5mer oscillates between different sub-states, each characterized by distinct baselines.</p>
<p>Currently, SegPore models only the modification state of the central nucleotide within the 5mer. However, modifications at other positions may also affect the signal, as shown in <xref rid="fig4" ref-type="fig">Fig. 4B</xref>. Therefore, introducing multiple states to the 5mer could help to improve the performance of the model. This approach, however, would significantly increase model complexity— introducing two states per location results in 2<sup>5</sup> = 32 modification states per 5mer, a challenge for simple GMMs. It remains to be investigated how to model multiple modification states properly to improve the performance in RNA modification estimation. While the current two-state assumption simplifies the model, it has proven effective, as demonstrated by improved performance on m6A benchmarks at both site and single-molecule levels.</p>
<p>A key advantage of SegPore is its interpretability, which sets it apart from DNN-based methods. SegPore provides a clearer understanding of RNA modification predictions. A limitation of DNN-based approaches is that they often struggle to differentiate between m6A and normal adenosine signals, as their intensity levels are quite similar (<xref rid="fig4" ref-type="fig">Fig. 4B</xref>, Supplementary Fig. S3). This causes a problem when apply DNN-based methods to new dataset without short read sequencing-based ground truth. Human could not confidently judge if a predicted m6A modification is a real m6A modification. SegPore codes current intensity levels for different 5mers in a parameter table, where unmodified and modified 5mers are modeled using two Gaussian distributions. One can generally observe a clear difference in the intensity levels between 5mers with a m6A and normal adenosine, which is easier for human to interpret if a predicted m6A site is real. One challenge is the relatively small number of 5mers showing significant changes in their modification states. To improve accuracy, larger training datasets and expanding the scope to 7mers or 9mers could help capture more context, potentially revealing more significant baseline changes.</p>
<p>Although SegPore provides clear interpretability and noise reduction through its GMM-based approach, there is potential to explore DNN-based models that can directly leverage SegPore’s segmentation results. Currently, m6Anet computes features (e.g., mean and standard deviation) from raw signal segments, which are then fed into a neural network for m6A prediction. However, a more direct approach—where raw signal segments are used as input to a DNN— could allow for the extraction of more intricate features that may exist within the signal but are currently underexplored. These high-order features might capture subtle aspects of the raw signal, leading to improved m6A estimation. Since SegPore currently models only the mean and standard deviation, further work involving advanced DNNs could extend beyond this, uncovering finer patterns in the signal that traditional statistical models might miss.</p>
<p>Computation speed is also a concern when processing fast5 files. We addressed this by implementing a GPU-accelerated inference algorithm in SegPore, resulting in a 10-to 20-fold speedup compared to the CPU-based version. We believe that the GPU-implementation will unlock the full potential of SegPore for a wider range of downstream tasks and larger datasets.</p>
<p>In summary, we developed a novel software SegPore that considered the conformation changes of motor protein to segment raw current signal of Nanopore direct RNA sequencing. SegPore effectively reduces noise in the raw signal, leading to improved m6A identification at both site and single-molecule levels.</p>
</sec>

</body>
<back>
<sec id="s5" sec-type="data-availability">
<title>Data availability</title>
<p>The data utilized in this study are obtained from publicly available repositories. Details regarding the accession number and data processing can be found in Methods. The resulting data from this work are provided in supplementary files. The source code is hosted on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/guangzhaocs/SegPore">https://github.com/guangzhaocs/SegPore</ext-link>).</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>We would like to thank Prof. Zhijie Tan from Wuhan University for a useful discussion about the molecule dynamics of Nanopore sequencing, Dr. Dan Zhang from Sichuan University for helpful tutorials about Nanopore analysis workflows. We also thank Prof. Luo Guanzheng for sharing the m6A benchmark baseline results. G.C. and L.C. acknowledge the computational resources provided by the Aalto Science-IT project.</p>
</ack>
<sec id="d1e1199" sec-type="additional-information">
<title>Additional information</title>
<sec id="s6">
<title>Supplementary data</title>
<p>Supplementary Data are available at NAR online.</p>
</sec>
<sec id="s7">
<title>Author contributions</title>
<p>Guangzhao Cheng: Formal analysis, Methodology, Validation, Writing—original draft &amp; editing. Aki Vehtari: Writing—review. Lu Cheng: Conceptualization, Formal analysis, Methodology, Writing—original draft &amp; review.</p>
</sec>
<sec id="s8">
<title>Funding</title>
<p>This work was supported by Research Council of Finland grants [335858, 358086 to GC and LC].</p>
</sec>
</sec>
<sec id="suppd1e1199" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="d1e1190">
<label>Supplementary Figures and Notes</label>
<media xlink:href="supplements/575207_file02.pdf"/>
</supplementary-material>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yankova</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Aspris</surname>, <given-names>D.</given-names></string-name> and <string-name><surname>Tzelepis</surname>, <given-names>K.</given-names></string-name></person-group> (<year>2021</year>) <article-title>The N6-methyladenosine RNA modification in acute myeloid leukemia</article-title>. <source>Curr Opin Hematol</source>, <volume>28</volume>, <fpage>80</fpage>–<lpage>85</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Prieto</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Folci</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>Martin</surname>, <given-names>S.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Post-translational modifications of the Fragile X Mental Retardation Protein in neuronal function and dysfunction</article-title>. <source>Mol Psychiatry</source>, <volume>25</volume>, <fpage>1688</fpage>–<lpage>1703</lpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bellodi</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>McMahon</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Contreras</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Juliano</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Kopmar</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Nakamura</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Maltby</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Burlingame</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Savage</surname>, <given-names>S.A.</given-names></string-name>, <string-name><surname>Shimamura</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>Ruggero</surname>, <given-names>D.</given-names></string-name></person-group> (<year>2013</year>) <article-title>H/ACA small RNA dysfunctions in disease reveal key roles for noncoding RNA modifications in hematopoietic stem cell differentiation</article-title>. <source>Cell Rep</source>, <volume>3</volume>, <fpage>1493</fpage>–<lpage>1502</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Bao</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Qian</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Geula</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Leslie</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Hanna</surname>, <given-names>J.H.</given-names></string-name> and <string-name><surname>Ding</surname>, <given-names>L.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Stage-specific requirement for Mettl3-dependent m(6)A mRNA methylation during haematopoietic stem cell differentiation</article-title>. <source>Nat Cell Biol</source>, <volume>21</volume>, <fpage>700</fpage>–<lpage>709</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quin</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Sedmik</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Vukic</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Khan</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Keegan</surname>, <given-names>L.P.</given-names></string-name> and <string-name><surname>O’Connell</surname>, <given-names>M.A.</given-names></string-name></person-group> (<year>2021</year>) <article-title>ADAR RNA Modifications, the Epitranscriptome and Innate Immunity</article-title>. <source>Trends Biochem Sci</source>, <volume>46</volume>, <fpage>758</fpage>–<lpage>771</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boccaletto</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Stefaniak</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Ray</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Cappannini</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Mukherjee</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Purta</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Kurkowska</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Shirvanizadeh</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Destefanis</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Groza</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal></person-group> (<year>2022</year>) <article-title>MODOMICS: a database of RNA modification pathways. 2021 update</article-title>. <source>Nucleic Acids Res</source>, <volume>50</volume>, <fpage>D231</fpage>–<lpage>D235</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zimna</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Dolata</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Szweykowska-Kulinska</surname>, <given-names>Z.</given-names></string-name> and <string-name><surname>Jarmolowski</surname>, <given-names>A.</given-names></string-name></person-group> (<year>2023</year>) <article-title>The expanding role of RNA modifications in plant RNA polymerase II transcripts: highlights and perspectives</article-title>. <source>J Exp Bot</source>, <volume>74</volume>, <fpage>3975</fpage>–<lpage>3986</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ohira</surname>, <given-names>T.</given-names></string-name> and <string-name><surname>Suzuki</surname>, <given-names>T.</given-names></string-name></person-group> (<year>2024</year>) <article-title>Transfer RNA modifications and cellular thermotolerance</article-title>. <source>Mol Cell</source>, <volume>84</volume>, <fpage>94</fpage>–<lpage>106</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>, <given-names>A.Y.</given-names></string-name>, <string-name><surname>Owens</surname>, <given-names>M.C.</given-names></string-name> and <string-name><surname>Liu</surname>, <given-names>K.F.</given-names></string-name></person-group> (<year>2023</year>) <article-title>Coordination of RNA modifications in the brain and beyond</article-title>. <source>Mol Psychiatry</source>, <volume>28</volume>, <fpage>2737</fpage>–<lpage>2749</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Agris</surname>, <given-names>P.F.</given-names></string-name>, <string-name><surname>Narendran</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Sarachan</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Vare</surname>, <given-names>V.Y.P.</given-names></string-name> and <string-name><surname>Eruysal</surname>, <given-names>E.</given-names></string-name></person-group> (<year>2017</year>) <article-title>The Importance of Being Modified: The Role of RNA Modifications in Translational Fidelity</article-title>. <source>Enzymes</source>, <volume>41</volume>, <fpage>1</fpage>–<lpage>50</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nance</surname>, <given-names>K.D.</given-names></string-name> and <string-name><surname>Meier</surname>, <given-names>J.L.</given-names></string-name></person-group> (<year>2021</year>) <article-title>Modifications in an Emergency: The Role of N1-Methylpseudouridine in COVID-19 Vaccines</article-title>. <source>ACS Cent Sci</source>, <volume>7</volume>, <fpage>748</fpage>–<lpage>756</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meyer</surname>, <given-names>K.D.</given-names></string-name>, <string-name><surname>Saletore</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Zumbo</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Elemento</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Mason</surname>, <given-names>C.E.</given-names></string-name> and <string-name><surname>Jaffrey</surname>, <given-names>S.R.</given-names></string-name></person-group> (<year>2012</year>) <article-title>Comprehensive analysis of mRNA methylation reveals enrichment in 3’ UTRs and near stop codons</article-title>. <source>Cell</source>, <volume>149</volume>, <fpage>1635</fpage>–<lpage>1646</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Linder</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Grozhik</surname>, <given-names>A.V.</given-names></string-name>, <string-name><surname>Olarerin-George</surname>, <given-names>A.O.</given-names></string-name>, <string-name><surname>Meydan</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Mason</surname>, <given-names>C.E.</given-names></string-name> and <string-name><surname>Jaffrey</surname>, <given-names>S.R.</given-names></string-name></person-group> (<year>2015</year>) <article-title>Single-nucleotide-resolution mapping of m6A and m6Am throughout the transcriptome</article-title>. <source>Nat Methods</source>, <volume>12</volume>, <fpage>767</fpage>–<lpage>772</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Koh</surname>, <given-names>C.W.Q.</given-names></string-name>, <string-name><surname>Goh</surname>, <given-names>Y.T.</given-names></string-name> and <string-name><surname>Goh</surname>, <given-names>W.S.S.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Atlas of quantitative single-base-resolution N(6)-methyl-adenine methylomes</article-title>. <source>Nat Commun</source>, <volume>10</volume>, <fpage>5636</fpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Loman</surname>, <given-names>N.J.</given-names></string-name>, <string-name><surname>Quick</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Simpson</surname>, <given-names>J.T.</given-names></string-name></person-group> (<year>2015</year>) <article-title>A complete bacterial genome assembled de novo using only nanopore sequencing data</article-title>. <source>Nat Methods</source>, <volume>12</volume>, <fpage>733</fpage>–<lpage>735</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simpson</surname>, <given-names>J.T.</given-names></string-name>, <string-name><surname>Workman</surname>, <given-names>R.E.</given-names></string-name>, <string-name><surname>Zuzarte</surname>, <given-names>P.C.</given-names></string-name>, <string-name><surname>David</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Dursi</surname>, <given-names>L.J.</given-names></string-name> and <string-name><surname>Timp</surname>, <given-names>W.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Detecting DNA cytosine methylation using nanopore sequencing</article-title>. <source>Nat Methods</source>, <volume>14</volume>, <fpage>407</fpage>–<lpage>410</lpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Stoiber</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Quick</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Egan</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Eun Lee</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Celniker</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Neely</surname>, <given-names>R.K.</given-names></string-name>, <string-name><surname>Loman</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Pennacchio</surname>, <given-names>L.A.</given-names></string-name> and <string-name><surname>Brown</surname>, <given-names>J.</given-names></string-name></person-group> (<year>2017</year>) <article-title>De novo Identification of DNA Modifications Enabled by Genome-Guided Nanopore Signal Processing</article-title>. <source>biorxiv</source>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hendra</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Pratanwanich</surname>, <given-names>P.N.</given-names></string-name>, <string-name><surname>Wan</surname>, <given-names>Y.K.</given-names></string-name>, <string-name><surname>Goh</surname>, <given-names>W.S.S.</given-names></string-name>, <string-name><surname>Thiery</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>Goke</surname>, <given-names>J.</given-names></string-name></person-group> (<year>2022</year>) <article-title>Detection of m6A from direct RNA sequencing using a multiple instance learning framework</article-title>. <source>Nat Methods</source>, <volume>19</volume>, <fpage>1590</fpage>–<lpage>1598</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>, <given-names>H.</given-names></string-name></person-group> (<year>2018</year>) <article-title>Minimap2: pairwise alignment for nucleotide sequences</article-title>. <source>Bioinformatics</source>, <volume>34</volume>, <fpage>3094</fpage>–<lpage>3100</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pratanwanich</surname>, <given-names>P.N.</given-names></string-name>, <string-name><surname>Yao</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Koh</surname>, <given-names>C.W.Q.</given-names></string-name>, <string-name><surname>Wan</surname>, <given-names>Y.K.</given-names></string-name>, <string-name><surname>Hendra</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Poon</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Goh</surname>, <given-names>Y.T.</given-names></string-name>, <string-name><surname>Yap</surname>, <given-names>P.M.L.</given-names></string-name>, <string-name><surname>Chooi</surname>, <given-names>J.Y.</given-names></string-name> <etal>et al.</etal></person-group> (<year>2021</year>) <article-title>Identification of differential RNA modifications from nanopore direct RNA sequencing with xPore</article-title>. <source>Nat Biotechnol</source>, <volume>39</volume>, <fpage>1394</fpage>–<lpage>1402</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jenjaroenpun</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Wongsurawat</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Wadley</surname>, <given-names>T.D.</given-names></string-name>, <string-name><surname>Wassenaar</surname>, <given-names>T.M.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Dai</surname>, <given-names>Q.</given-names></string-name>, <string-name><surname>Wanchai</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Akel</surname>, <given-names>N.S.</given-names></string-name>, <string-name><surname>Jamshidi-Parsian</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Franco</surname>, <given-names>A.T.</given-names></string-name> <etal>et al.</etal></person-group> (<year>2021</year>) <article-title>Decoding the epitranscriptional landscape from native RNA sequences</article-title>. <source>Nucleic Acids Res</source>, <volume>49</volume>, <fpage>e7</fpage>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhong</surname>, <given-names>Z.D.</given-names></string-name>, <string-name><surname>Xie</surname>, <given-names>Y.Y.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>H.X.</given-names></string-name>, <string-name><surname>Lan</surname>, <given-names>Y.L.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>X.H.</given-names></string-name>, <string-name><surname>Ji</surname>, <given-names>J.Y.</given-names></string-name>, <string-name><surname>Wu</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Jin</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Mak</surname>, <given-names>D.W.</given-names></string-name> <etal>et al.</etal></person-group> (<year>2023</year>) <article-title>Systematic comparison of tools used for m(6)A mapping from nanopore direct RNA sequencing</article-title>. <source>Nat Commun</source>, <volume>14</volume>, <fpage>1906</fpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Craig</surname>, <given-names>J.M.</given-names></string-name>, <string-name><surname>Laszlo</surname>, <given-names>A.H.</given-names></string-name>, <string-name><surname>Brinkerhoff</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Derrington</surname>, <given-names>I.M.</given-names></string-name>, <string-name><surname>Noakes</surname>, <given-names>M.T.</given-names></string-name>, <string-name><surname>Nova</surname>, <given-names>I.C.</given-names></string-name>, <string-name><surname>Tickman</surname>, <given-names>B.I.</given-names></string-name>, <string-name><surname>Doering</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>de Leeuw</surname>, <given-names>N.F.</given-names></string-name> and <string-name><surname>Gundlach</surname>, <given-names>J.H.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Revealing dynamics of helicase translocation on single-stranded DNA using high-resolution nanopore tweezers</article-title>. <source>Proc Natl Acad Sci U S A</source>, <volume>114</volume>, <fpage>11932</fpage>–<lpage>11937</lpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caldwell</surname>, <given-names>C.C.</given-names></string-name> and <string-name><surname>Spies</surname>, <given-names>M.</given-names></string-name></person-group> (<year>2017</year>) <article-title>Helicase SPRNTing through the nanopore</article-title>. <source>Proc Natl Acad Sci U S A</source>, <volume>114</volume>, <fpage>11809</fpage>–<lpage>11811</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Chen</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Davidson</surname>, <given-names>N.M.</given-names></string-name>, <string-name><surname>Wan</surname>, <given-names>Y.K.</given-names></string-name>, <string-name><surname>Patel</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Yao</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Low</surname>, <given-names>H.M.</given-names></string-name>, <string-name><surname>Hendra</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Watten</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Sim</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Sawyer</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> (<year>2021</year>) <article-title>A systematic benchmark of Nanopore long read RNA sequencing for transcript level analysis in human cell lines</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lorenz</surname>, <given-names>D.A.</given-names></string-name>, <string-name><surname>Sathe</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Einstein</surname>, <given-names>J.M.</given-names></string-name> and <string-name><surname>Yeo</surname>, <given-names>G.W.</given-names></string-name></person-group> (<year>2020</year>) <article-title>Direct RNA sequencing enables m(6)A detection in endogenous transcript isoforms at base-specific resolution</article-title>. <source>RNA</source>, <volume>26</volume>, <fpage>19</fpage>–<lpage>28</lpage>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Wu</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Xi</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Kohnen</surname>, <given-names>M.V.</given-names></string-name>, <string-name><surname>Reddy</surname>, <given-names>A.S.N.</given-names></string-name> and <string-name><surname>Gu</surname>, <given-names>L.</given-names></string-name></person-group> (<year>2021</year>) <article-title>Quantitative profiling of N(6)-methyladenosine at single-base resolution in stem-differentiating xylem of Populus trichocarpa using Nanopore direct RNA sequencing</article-title>. <source>Genome Biol</source>, <volume>22</volume>, <fpage>22</fpage>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Begik</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Lucas</surname>, <given-names>M.C.</given-names></string-name>, <string-name><surname>Ramirez</surname>, <given-names>J.M.</given-names></string-name>, <string-name><surname>Mason</surname>, <given-names>C.E.</given-names></string-name>, <string-name><surname>Wiener</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Schwartz</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Mattick</surname>, <given-names>J.S.</given-names></string-name>, <string-name><surname>Smith</surname>, <given-names>M.A.</given-names></string-name> and <string-name><surname>Novoa</surname>, <given-names>E.M.</given-names></string-name></person-group> (<year>2019</year>) <article-title>Accurate detection of m(6)A RNA modifications in native RNA sequences</article-title>. <source>Nat Commun</source>, <volume>10</volume>, <fpage>4079</fpage>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Acera Mateos</surname>, <given-names>P.</given-names></string-name>, <collab>A, J.S</collab>., <string-name><surname>Ravindran</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Srivastava</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Woodward</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Mahmud</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Kanchi</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Guarnacci</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Xu</surname>, <given-names>J. Z W.S.Y.</given-names></string-name> <etal>et al.</etal></person-group> (<year>2024</year>) <article-title>Prediction of m6A and m5C at single-molecule resolution reveals a transcriptome-wide co-occurrence of RNA modifications</article-title>. <source>Nat Commun</source>, <volume>15</volume>, <fpage>3899</fpage>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kortel</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Ruckle</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Zhou</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Busch</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hoch-Kraft</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Sutandy</surname>, <given-names>F.X.R.</given-names></string-name>, <string-name><surname>Haase</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Pradhan</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Musheev</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Ostareck</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal></person-group> (<year>2021</year>) <article-title>Deep and accurate detection of m6A RNA modifications using miCLIP2 and m6Aboost machine learning</article-title>. <source>Nucleic Acids Res</source>, <volume>49</volume>, <fpage>e92</fpage>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104618.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Altemose</surname>
<given-names>Nicolas</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Stanford University</institution>
</institution-wrap>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study presents SegPore, a <bold>valuable</bold> new method for processing direct RNA nanopore sequencing data, which improves the segmentation of raw signals into individual bases and boosts the accuracy of modified base detection. The evidence presented to benchmark SegPore is <bold>solid</bold> and the authors provide a fully documented implementation of the method. If updated to process newer RNA nanopore sequencing data types, SegPore will be of great interest to researchers studying RNA modifications.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104618.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this manuscript, the authors describe a new computational method (SegPore), which segments the raw signal from nanopore-direct RNA-Seq data to improve the identification of RNA modifications. In addition to signal segmentation, SegPore includes a Gaussian Mixture Model approach to differentiate modified and unmodified bases. SegPore uses Nanopolish to define a first segmentation, which is then refined into base and transition blocks. SegPore also includes a modification prediction model that is included in the output. The authors evaluate the segmentation in comparison to Nanopolish and Tombo, and they evaluate the impact on m6A RNA modification detection using data with known m6A sites. In comparison to existing methods, SegPore appears to improve the ability to detect m6A, suggesting that this approach could be used to improve the analysis of direct RNA-Seq data.</p>
<p>Strengths:</p>
<p>SegPore addresses an important problem (signal data segmentation). By refining the signal into transition and base blocks, noise appears to be reduced, leading to improved m6A identification at the site level as well as for single-read predictions. The authors provide a fully documented implementation, including a GPU version that reduces run time. The authors provide a detailed methods description, and the approach to refine segments appears to be new.</p>
<p>Weaknesses:</p>
<p>In addition to Nanopolish and Tombo, f5c and Uncalled4 can also be used for segmentation, however, the comparison to these methods is not shown. The overall improvement in accuracy appears to be relatively small. The run time and resources that are required to run SegPore are not shown, however, it appears that the GPU version is essential, which could limit the application of this method in practice. The method was only applied to data from the RNA002 direct RNA-Sequencing version, which is not available anymore, currently, it remains unclear if the methods still work on RNA004.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104618.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The work seeks to improve the detection of RNA m6A modifications using Nanopore sequencing through improvements in raw data analysis. These improvements are said to be in the segmentation of the raw data, although the work appears to position the alignment of raw data to the reference sequence and some further processing as part of the segmentation, and result statistics are mostly shown on the 'data-assigned-to-kmer' level.</p>
<p>As such, the title, abstract, and introduction stating the improvement of just the 'segmentation' does not seem to match the work the manuscript actually presents, as the wording seems a bit too limited for the work involved.</p>
<p>The work itself shows minor improvements in m6Anet when replacing Nanopolish eventalign with this new approach, but clear improvements in the distributions of data assigned per kmer. However, these assignments were improved well enough to enable m6A calling from them directly, both at site-level and at read-level.</p>
<p>Strengths:</p>
<p>A large part of the improvements shown appear to stem from the addition of extra, non-base/kmer specific, states in the segmentation/assignment of the raw data, removing a significant portion of what can be considered technical noise for further analysis. Previous methods enforced the assignment of all raw data, forcing a technically optimal alignment that may lead to suboptimal results in downstream processing as data points could be assigned to neighbouring kmers instead, while random noise that is assigned to the correct kmer may also lead to errors in modification detection.</p>
<p>For an optimal alignment between the raw signal and the reference sequence, this approach may yield improvements for downstream processing using other tools.</p>
<p>
Additionally, the GMM used for calling the m6A modifications provides a useful, simple, and understandable logic to explain the reason a modification was called, as opposed to the black models that are nowadays often employed for these types of tasks.</p>
<p>Weaknesses:</p>
<p>The work seems limited in applicability largely due to the focus on the R9's 5mer models. The R9 flow cells are phased out and not available to buy anymore. Instead, the R10 flow cells with larger kmer models are the new standard, and the applicability of this tool on such data is not shown. We may expect similar behaviour from the raw sequencing data where the noise and transition states are still helpful, but the increased kmer size introduces a large amount of extra computing required to process data and without knowledge of how SegPore scales, it is difficult to tell how useful it will really be. The discussion suggests possible accuracy improvements moving to 7mers or 9mers, but no reason why this was not attempted.</p>
<p>The manuscript suggests the eventalign results are improved compared to Nanopolish. While this is believably shown to be true (Table 1), the effect on the use case presented, downstream differentiation between modified and unmodified status on a base/kmer, is likely limited as during actual modification calling the noisy distributions are usually 'good enough', and not skewed significantly in one direction to really affect the results too terribly.</p>
<p>Furthermore, looking at alternative approaches where this kind of segmentation could be applied, Nanopolish uses the main segmentation+alignment for a first alignment and follows up with a form of targeted local realignment/HMM test for modification calling (and for training too), decreasing the need for the near-perfect segmentation+alignment this work attempts to provide. Any tool applying a similar strategy probably largely negates the problems this manuscript aims to improve upon.</p>
<p>Finally, in the segmentation/alignment comparison to Nanopolish, the latter was not fitted(/trained) on the same data but appears to use the pre-trained model it comes with. For the sake of comparing segmentation/alignment quality directly, fitting Nanopolish on the same data used for SegPore could remove the influences of using different training datasets and focus on differences stemming from the algorithm itself.</p>
<p>Appraisal:</p>
<p>The authors have shown their method's ability to identify noise in the raw signal and remove their values from the segmentation and alignment, reducing its influences for further analyses. Figures directly comparing the values per kmer do show a visibly improved assignment of raw data per kmer. As a replacement for Nanopolish eventalign it seems to have a rather limited, but improved effect, on m6Anet results. At the single read level modification modification calling this work does appear to improve upon CHEUI.</p>
<p>Impact:</p>
<p>With the current developments for Nanopore-based modification largely focusing on Artificial Intelligence, Neural Networks, and the like, improvements made in interpretable approaches provide an important alternative that enables a deeper understanding of the data rather than providing a tool that plainly answers the question of whether a base is modified or not, without further explanation. The work presented is best viewed in the context of a workflow where one aims to get an optimal alignment between raw signal data and the reference base sequence for further processing. For example, as presented, as a possible replacement for Nanopolish eventalign. Here it might enable data exploration and downstream modification calling without the need for local realignments or other approaches that re-consider the distribution of raw data around the target motif, such as a 'local' Hidden Markov Model or Neural Networks. These possibilities are useful for a deeper understanding of the data and further tool development for modification detection works beyond m6A calling.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104618.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>Nucleotide modifications are important regulators of biological function, however, until recently, their study has been limited by the availability of appropriate analytical methods. Oxford Nanopore direct RNA sequencing preserves nucleotide modifications, permitting their study, however, many different nucleotide modifications lack an available base-caller to accurately identify them. Furthermore, existing tools are computationally intensive, and their results can be difficult to interpret.</p>
<p>Cheng et al. present SegPore, a method designed to improve the segmentation of direct RNA sequencing data and boost the accuracy of modified base detection.</p>
<p>Strengths:</p>
<p>This method is well-described and has been benchmarked against a range of publicly available base callers that have been designed to detect modified nucleotides.</p>
<p>Weaknesses:</p>
<p>However, the manuscript has a significant drawback in its current version. The most recent nanopore RNA base callers can distinguish between different ribonucleotide modifications, however, SegPore has not been benchmarked against these models.</p>
<p>I recommend that re-submission of the manuscript that includes benchmarking against the rna004_130bps_hac@v5.1.0 and rna004_130bps_sup@v5.1.0 dorado models, which are reported to detect m5C, m6A_DRACH, inosine_m6A and PseU.</p>
<p>A clear demonstration that SegPore also outperforms the newer RNA base caller models will confirm the utility of this method.</p>
</body>
</sub-article>
</article>