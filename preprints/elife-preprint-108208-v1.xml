<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">108208</article-id>
<article-id pub-id-type="doi">10.7554/eLife.108208</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.108208.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories><title-group>
<article-title>Realistic coupling enables flexible macroscopic traveling waves in the mouse cortex</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3710-2807</contrib-id>
<name>
<surname>Sun</surname>
<given-names>Guanhua</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Hazelden</surname>
<given-names>James</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
<xref ref-type="author-notes" rid="n2">§</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kim</surname>
<given-names>Ruby</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7581-4031</contrib-id>
<name>
<surname>Forger</surname>
<given-names>Daniel B</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<email>forger@umich.edu</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00jmfr291</institution-id><institution>Department of Mathematics, University of Michigan</institution></institution-wrap>, <city>Ann Arbor</city>, <country country="US">United States</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00jmfr291</institution-id><institution>Gilbert S. Omenn Department of Computational Medicine and Bioinformatics, University of Michigan</institution></institution-wrap>, <city>Ann Arbor</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Kuan</surname>
<given-names>Aaron</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Yale School of Medicine</institution>
</institution-wrap>
<city>New Haven</city>
<country country="US">United States</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Poirazi</surname>
<given-names>Panayiota</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>FORTH Institute of Molecular Biology and Biotechnology</institution>
</institution-wrap>
<city>Heraklion</city>
<country country="GR">Greece</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>†</label><p>These authors contributed equally to this work</p></fn>
<fn id="n2" fn-type="present-address"><label>§</label><p>Present address: Department of Applied Mathematics, University of Washington, United States</p></fn>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-09-09">
<day>09</day>
<month>09</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP108208</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2025-07-05">
<day>05</day>
<month>07</month>
<year>2025</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2025-07-05">
<day>05</day>
<month>07</month>
<year>2025</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2025.07.05.663278"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Sun et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Sun et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-108208-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Traveling waves are ubiquitous in neuronal systems across different spatial scales. While microscopic and mesoscopic waves are relatively well studied, the mechanisms underlying the emergence of macroscopic traveling waves remain less understood. Here, by modeling the mouse cortex using spatial transcriptomic and connectivity data, we show that realistic cortical connectivity can generate a significantly higher level of macroscopic traveling waves than local and uniform connectivity. By quantifying the traveling waves in the 3-D domain, we discovered that the level of macroscopic traveling waves depends not only on the network connectivity but also non-monotonically depends on the coupling strength between neurons in the network. We also found that slow oscillations (0.5 - 4 Hz) are more likely to form large-scale, macroscopic traveling waves than other faster oscillations in the network with realistic connectivity. Together, our work shows how flexible macroscopic traveling waves can emerge in the mouse cortex and offers a computational framework to further study traveling waves in the mouse brain at the single-cell level.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>

</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Traveling waves have emerged as a central topic among different large-scale spatiotemporal dy-namics observed in neuronal systems <xref ref-type="bibr" rid="c37">Muller et al. (2018</xref>). These waves are observed at different frequencies during various brain activities, ranging from slow-wave activity <xref ref-type="bibr" rid="c33">Massimini (2004)</xref>; <xref ref-type="bibr" rid="c29">Liang et al. (2021</xref>), sleep spindles <xref ref-type="bibr" rid="c38">Muller et al. (2016</xref>), to faster oscillations in alpha <xref ref-type="bibr" rid="c57">Zhang et al. (2018)</xref>; <xref ref-type="bibr" rid="c25">van Kerkoerle et al. (2014</xref>), beta <xref ref-type="bibr" rid="c4">Bhattacharya et al. (2022)</xref>; <xref ref-type="bibr" rid="c47">Rubino et al. (2006)</xref>; <xref ref-type="bibr" rid="c12">Davis et al. (2020</xref>), and gamma <xref ref-type="bibr" rid="c25">van Kerkoerle et al. (2014)</xref>; <xref ref-type="bibr" rid="c1">Aggarwal et al. (2022</xref>) frequency bands. These waves also appear in various brain regions across species, including the hippocampus <xref ref-type="bibr" rid="c30">Lubenov and Siapas (2009)</xref>; <xref ref-type="bibr" rid="c42">Patel et al. (2012)</xref>; <xref ref-type="bibr" rid="c56">Zhang and Jacobs (2015</xref>), visual cortex <xref ref-type="bibr" rid="c48">Sato et al. (2012</xref>), prefrontal cor-tex <xref ref-type="bibr" rid="c4">Bhattacharya et al. (2022</xref>), motor cortex <xref ref-type="bibr" rid="c47">Rubino et al. (2006</xref>), or span across multiple brain regions <xref ref-type="bibr" rid="c28">Liang et al. (2023</xref>). More importantly, these waves have long been conjectured to regulate brain functions through mechanisms such as synaptic plasticity <xref ref-type="bibr" rid="c17">Ermentrout and Kleinfeld (2001)</xref>; <xref ref-type="bibr" rid="c37">Muller et al. (2018</xref>). Indeed, researchers have recently found that traveling waves can modulate important brain functions such as memory, visual processing, and sleep <xref ref-type="bibr" rid="c36">Mohan et al. (2024)</xref>; <xref ref-type="bibr" rid="c1">Aggarwal et al. (2022)</xref>; <xref ref-type="bibr" rid="c34">Miyamoto et al. (2017</xref>).</p>
<p>The prevalence and important implications of traveling waves have prompted researchers to investigate their causes and organization. In these studies, computational modeling has been use-ful due to its flexibility. Researchers have developed both microscopic models <xref ref-type="bibr" rid="c12">Davis et al. (2020)</xref>; <xref ref-type="bibr" rid="c39">Naze et al. (2015)</xref>; <xref ref-type="bibr" rid="c17">Ermentrout and Kleinfeld (2001</xref>) and mesoscopic models such as neural mass models <xref ref-type="bibr" rid="c45">Roberts et al. (2019)</xref>; <xref ref-type="bibr" rid="c28">Liang et al. (2023</xref>) to explore the mechanical properties and computational implications of traveling waves. However, most of these studies focus on microscopic or mesoscopic waves that appear in a single brain region. Large-scale, macroscopic waves across multiple brain regions have been less studied. Moreover, these models are usually constructed with local or uniform connectivity and lack the realistic geometry and connectivity of the brain. It has been shown that in a network of coupled non-linear oscillators, certain dynamics only arise when the number of oscillators is high enough, where local and global activities can coexist in the network <xref ref-type="bibr" rid="c5">Budzinski et al. (2022</xref>). At the same time, it has been argued that modeling neuronal networks at single-cell resolution will yield more precise discoveries than the mean-field model <xref ref-type="bibr" rid="c14">Deco et al. (2008</xref>). Therefore, it is ideal to study traveling waves in a large domain such as the cortex at single-cell resolution.</p>
<p>However, there are two significant challenges: First, a microscopic wiring diagram of the mouse brain at the whole-brain level is not available. However, we have mesoscopic connectivity data provided by the Allen Brain Atlas <xref ref-type="bibr" rid="c40">Oh et al. (2014)</xref>; <xref ref-type="bibr" rid="c26">Knox et al. (2018)</xref>; <xref ref-type="bibr" rid="c22">Harris et al. (2019</xref>), which will be used in this work. Second, simulating and measuring wave activity in a large 3D computational domain with realistic brain geometry is computationally expensive. Simulations of such scale are usually conducted on supercomputers <xref ref-type="bibr" rid="c55">Yamaura et al. (2020)</xref>; <xref ref-type="bibr" rid="c32">Markram et al. (2015</xref>), and there are no established methods to quantify wave patterns on a large 3D domain.</p>
<p>In this work, we overcome these two challenges in order to study the emergence and propagation of macroscopic traveling waves in the mouse cortex. First, we propose an algorithm that integrates a spatial transcriptomic dataset that provides the detailed spatial and molecular profile of neurons <xref ref-type="bibr" rid="c58">Zhang et al. (2023</xref>), with voxelized connectivity data <xref ref-type="bibr" rid="c26">Knox et al. (2018</xref>) of the mouse brain. We use this algorithm to create neuron-to-neuron connectivity for one hemisphere of the mouse cortex, which we call <italic>Allen</italic> connectivity. We then constructed a 3D computational model with both excitatory and inhibitory neurons on top of the Allen connectivity. To overcome the second difficulty, we built our own parallel computational framework that can simulate the constructed model with a desktop GPU. We also extend the previously established method designed for 2-D data to our 3-D data to quantify the wave activities observed in simulations.</p>
<p>In our simulations, we found that the realistic Allen connectivity is capable of generating macroscopic waves across the mouse cortex with realistic propagating directions. Further quantification shows that Allen connectivity can generate a higher level of macroscopic wave activities than local and uniform connectivity. Moreover, we discover that the coupling strength between neurons non-monotonically affects the level of macroscopic wave activities that can emerge from different connectivity. Finally, we show that the realistic Allen connectivity is capable of generating a higher level of macroscopic traveling waves with different frequencies, especially in the Delta band (0.5 - 4 Hz), than uniform and local connectivity. Our work shows how realistic connectivity can enable flexible macroscopic waves across the mouse cortex. We also provide a computational framework to further study such traveling waves in the mouse brain at single-cell resolution.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Construction of the cortical connectivity</title>
<p>A recent spatial transcriptomic dataset (Zhuang-ABCA1) <xref ref-type="bibr" rid="c58">Zhang et al. (2023</xref>) provides detailed positions of neurons in the mouse brain along with their molecular properties, including the neurotransmitter information (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>, Use of the spatial transcriptomic data). Our goal is to connect neurons in Zhuang-ABCA1 based on realistic connectivity data of the mouse brain that has been experimentally measured. Previously, <xref ref-type="bibr" rid="c40">Oh et al. (2014</xref>) and <xref ref-type="bibr" rid="c22">Harris et al. (2019</xref>) have provided a mesoscopic connectivity matrix, known as the “projectome”, of the mouse brain. The projectome is derived from thousands of viral tracing experiments carried out within the mouse brain, and it measures the strength of connections between different brain regions at a regional level. This pro-Consider constructing a connectivity for N neurons that are contained in M voxels, and let <italic>X</italic><sub><italic>i</italic></sub> represent the physical position of the ith neuron. We have access to the voxelized projection matrix W, where <italic>W</italic><sub><italic>ab</italic></sub> denotes the projection strength from voxel a to voxel b. Our connectivity algorithm requires only a single density parameter, <italic>ρ</italic>, which determines the average number of connections per neuron, thereby controlling the network’s sparsity (Use of the voxelized connectivity data). Using this information, we propose the following algorithm to construct the connectivity for the target neurons (<xref rid="fig1" ref-type="fig">Fig. 1b</xref> and Methods):</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Construction of the cortical connectivity.</title>
<p><bold>(a)</bold> Visualization of all neurons in the hemispherical dataset we use to build the cortical connectivity. The hemisphere contains about 1 million neurons in total, including about 300,000 cortical neurons. <bold>(b)</bold> Algorithm of building the connectome: i) First, we identify neuronal excitatory/inhibitory information based on the spatial transcriptomic data. ii) We then identify the voxelized position for all the neurons. iii) Based on the voxelized projection data, we calculate the number of connections between every pair of voxels (see Use of the voxelized connectivity data). iv) Connections are created randomly between the neurons in each pair of voxels. v) Repeat for all voxels in regions of interest. vi) Complete the connectivity. <bold>(c)</bold> The connectivity matrix shows the number of connections between different cortical regions(in log 10 scale). A full version of the connectivity matrix with annotated regions is shown in <xref ref-type="fig" rid="fig1_S1">Figure 1—figure supplement 1</xref>. <bold>(d)</bold> Visualization of outgoing connections from sampled neurons in the primary visual cortex (VISp, left), primary auditory cortex (AUDp, middle), and the ventral anterior cingulate areas (ACAv, right).</p></caption>
<graphic xlink:href="663278v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<statement id="alg1">
<label>Algorithm 1</label>
<p>Construction of cortical connectivity</p>
<p><fig id="alg1a" position="float" fig-type="figure">
<graphic xlink:href="663278v1_alg1.tif" mimetype="image" mime-subtype="tiff"/>
</fig></p>
</statement>
<p>Applying this algorithm to all cortical neurons identified in Zhuang-ABCA1, we obtain a cortical connectivity that consists of 297,812 neurons, and each neuron has 300 connections on average, resulting in a network sparsity of around 0.1 % (Construction and storage of the connectivity). The cortical connectivity we constructed is highly heterogeneous, where the number of connections between different regions can vary across four orders of magnitude (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>). At the same time, both the in-degree and out-degree distribution of the connectome follow a realistic log-normal distribution <xref ref-type="bibr" rid="c6">Buzsáki and Mizuseki (2014</xref>) (<xref ref-type="fig" rid="fig1_S1">Figure 1—figure supplement 1</xref>). Since the complete connectome is difficult to visualize, we show some connections from different cortical regions, including the primary visual, auditory cortex, and the ventral anterior cingulate area (<xref rid="fig1" ref-type="fig">Fig. 1d</xref>).</p>
</sec>
<sec id="s2b">
<title>Network model and simulation</title>
<p>To simulate the Allen connectivity we just constructed, we now develop a computational model of the mouse cortex for computer simulation. The model incorporates both excitatory glutamatergic (AMPA) and inhibitory GABAergic neurons, with excitatory and inhibitory information provided by the original dataset (Zhuang-ABCA1). Both neurons are modeled as single-compartment, Hodgkin-Huxley type of neuron, whose firing behavior has been extensively described in <xref ref-type="bibr" rid="c44">Pospischil et al. (2008</xref>). Consequently, our network model contains two kinds of synapses (GABA and AMPA), both described by a first-order kinetic model (Neuronal and synaptic model).</p>
<p>Now, we need a mechanism to generate traveling waves in the simulation. According to previous studies, traveling waves can emerge in the mouse cortex both after sensory stimuli <xref ref-type="bibr" rid="c35">Mohajerani et al. (2013</xref>) or during spontaneous activities <xref ref-type="bibr" rid="c28">Liang et al. (2023</xref>). Here, we electrically stimulate all layer 4 neurons with an applied current as a way to simulate subcortical input to the cortex, since layer 4 is known to be the input layer <xref ref-type="bibr" rid="c46">Rockland (2019</xref>). Different levels of stimuli can be given by adjusting the magnitude of the applied current. Each simulation lasts for 3 seconds, during which the neurons are constantly under stimulation. To make such large-scale simulations possible on realistic time frames, we construct our own computational engine utilizing GPUs for simulation and visualization (Simulation).</p>
</sec>
<sec id="s2c">
<title>Macroscopic traveling waves arise from realistic connectivity</title>
<p>Simulating the model with Allen connectivity, we immediately observe macroscopic traveling waves emerge in the network caused by the electrical stimuli to layer 4 neurons. In <xref rid="fig2" ref-type="fig">Figure 2</xref> and Videos, we present a simulation in which a rhythmic oscillation occurs. The oscillation itself is well synchronized across the cortex, as shown by calculating the average voltage across the cortex and the raster plots of 40,000 sampled neurons (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>). Next, we properly choose the time window to visualize the voltage activities of all the neurons in the network. We first visualize the intracellular voltage of all the individual neurons in the network (Fig. S2), but since the number of neurons are large, we proceed to visualize the average of the intracellular voltage of 300 neurons nearby at each location (<xref rid="fig2" ref-type="fig">Fig. 2b</xref> and <xref ref-type="fig" rid="fig2">d</xref>). This reveals an apparent macroscopic traveling wave in the anterior-posterior direction through the cortex, which has been previously reported <xref ref-type="bibr" rid="c33">Massimini (2004)</xref>; <xref ref-type="bibr" rid="c29">Liang et al. (2021)</xref>; <xref ref-type="bibr" rid="c2">Aggarwal et al. (2024</xref>). We also observe the anterior-posterior macroscopic wave in both directions (<xref rid="fig2" ref-type="fig">Fig. 2c</xref> and <xref ref-type="fig" rid="fig2">2e</xref>). In fact, the two waves can propagate in the reverse direction right after each other, indicating a possible feedforward-feedback mechanism.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Anterior-posterior macroscopic traveling waves emerge from Allen connectivity</title>
<p><bold>(a)</bold> Top: The average intracellular voltage of all neurons; bottom: Raster plots for 40000 neurons, which are evenly sampled from different cortical regions. The red and blue dashed lines indicate the time windows that are visualized in <bold>(b-e). (b)</bold> Visualization of average intracellular voltage across different locations in the cortex during the time window indicated by the red dashed lines in <bold>(a). (c)</bold> Visualization of the macroscopic traveling wave by coloring the neurons based on the first time they fire during the same time window visualized in <bold>(b). (d-e)</bold> Same plot as <bold>(b-c)</bold>, but they visualize a different time window of the same simulation, indicated by the blue dashed lines in <bold>(a)</bold>. The direction of the traveling wave is opposite to the one shown in the previous figures. See Videos for the movie of the simulation.</p>
<p><xref ref-type="fig" rid="fig2_S1">Figure 2—figure supplement 1</xref>. Visualization of the macroscopic traveling waves at single-neuron resolution. <bold>(a-b)</bold> Visualization of the same</p></caption>
<graphic xlink:href="663278v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2d">
<title>Higher level of macroscopic wave emerges from realistic connectivity</title>
<p>In past modeling studies of traveling waves, it is common to adopt uniform-random, local, or a combination of the two kinds of connectivity <xref ref-type="bibr" rid="c28">Liang et al. (2023</xref>). Therefore, we now simulate the same model with different connectivity in order to compare and investigate whether such macroscopic waves that are presented in <xref rid="fig2" ref-type="fig">Figure 2</xref> only emerge from the Allen connectivity. For comparison, we constructed two additional types of connectivity that are common in past studies of traveling waves:</p>
<list list-type="order">
<list-item><p>Uniform connectivity: Neurons are connected across the entire cortex randomly (<xref rid="fig3" ref-type="fig">Fig. 3b</xref>).</p></list-item>
<list-item><p>Local connectivity: Neurons are connected to a fixed number of their closest neighbors (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>).</p></list-item>
</list>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><p>Top: schematics of Allen <bold>(a)</bold>, local <bold>(b)</bold>, and uniform connectivity <bold>(c)</bold>; bottom: Visualization of outgoing connections from the same 50 randomly selected neurons in the primary visual cortex (VISp) for the three connectivity. <xref ref-type="fig" rid="fig3_S1">Figure 3—figure supplement 1</xref>. Comparison of the three connectivity matrices: <bold>a</bold> Allen, <bold>b</bold> local and <bold>c</bold> uniform connectivity. For local connectivity, the diagonal terms represent the connections within the same region. And the off-diagonal terms exist because these regions are physically adjacent to each other.</p></caption>
<graphic xlink:href="663278v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Here we visualize the outgoing connections from 50 randomly selected neurons in the primary visual cortex to show the difference between the three connectivity. Under Allen connectivity, the outgoing connections project to different regions heterogeneously (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>); with local connectivity, the outgoing connections only reach around the adjacent areas where the sampled neurons are located (<xref rid="fig3" ref-type="fig">Fig. 3b</xref>); and with uniform connectivity, the outgoing connections tend to cover the whole cortex evenly (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>). Although the topology of three connectivity is different, they share the same out-degree distribution based on the way they are constructed (see Construction and storage of the connectivity).</p>
<p>To properly quantify the traveling wave observed in simulations, we applied a phase-based method from image processing <xref ref-type="bibr" rid="c18">Fleet and Jepson (1990</xref>), which has been adopted to analyze neuronal dynamics <xref ref-type="bibr" rid="c47">Rubino et al. (2006</xref>), to our simulation data. First, we performed the Hilbert transform on the time series of the intracellular voltage signal for all neurons (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>) to transform the voltage signal into a phase signal. Since neurons are spatially distributed according to a realistic dataset rather than arranged on a regular grid required for further calculations, we constructed a Cartesian grid defined by the Allen Brain Atlas at a resolution of 100 <italic>µm</italic> and interpolate the phase signal of neurons onto the grid points (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>) to obtain the phase field. We then compute the gradient field of the phase field on the 3D grid (<xref rid="fig4" ref-type="fig">Fig. 4c</xref>). This allows us to calculate the phase gradient directionality (PGD), an indicator for planar wave activity <xref ref-type="bibr" rid="c47">Rubino et al. (2006</xref>), which will be used to measure the level of macroscopic wave activities in our simulations (see Quantitative measurement of neuronal activity).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Schematics of analyzing 3D spatiotemporal data using phase gradient.</title>
<p><bold>(a)</bold> A single frame from a simulation with Allen connectivity, where neurons are colored based on their intracellular voltage. <bold>(b)</bold> The same frame as in <bold>(a)</bold>, but with voltage data transformed into a generalized phase and interpolated onto a regular 3D grid. <bold>(c)</bold> Calculation of phase gradient field based on the phase field presented in <bold>(b)</bold>. The arrows indicate the gradient directions at different locations. Please see Quantitative measurement of neuronal activity for details of the calculation presented in this figure.</p></caption>
<graphic xlink:href="663278v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In <xref rid="fig5" ref-type="fig">Figure 5</xref> and Videos, we compare the PGD produced by three representative simulations with different connectivity but the same parameters otherwise. We compare three time windows of the same length (70ms) where PGD reaches its maximum during the corresponding simulations. Although both Allen and local connectivity produce visible wave activity, Allen connectivity produces waves that are much more macroscopic, while local connectivity is capable of producing locally organized planar waves, which are the most frequently form of waves observed in previous expeimental studies <xref ref-type="bibr" rid="c30">Lubenov and Siapas (2009)</xref>; <xref ref-type="bibr" rid="c4">Bhattacharya et al. (2022</xref>) and computational models with local connectivity <xref ref-type="bibr" rid="c24">Keane and Gong (2015</xref>). However, uniform connectivity did not generate any apparent structure. This qualitative observation was confirmed by the PGD calculations: uniform connectivity exhibited correspondingly lowest PGD, whereas Allen connectivity resulted in significantly higher phase gradient directionality (<xref rid="fig5" ref-type="fig">Fig. 5d</xref>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Allen connectivity produces a higher level of macroscopic wave activity than local and uniform connectivity.</title>
<p><bold>(a-c)</bold> Time sequences of three simulations with Allen <bold>(a)</bold>, local <bold>(b)</bold> and uniform <bold>(c)</bold> connectivity under the same stimulus. Colors represent the generalized phase of each neuron, which is further normalized for each simulation between 0 and 1. <bold>(d)</bold> Phase gradient directionality (PGD) of the corresponding simulations with respect to time. The three time windows are chosen such that the maximum PGD is reached. Please see Video 2 for animation of the three simulations.</p></caption>
<graphic xlink:href="663278v1_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2e">
<title>Dynamic regime of the network affects macroscopic traveling waves</title>
<p>Traveling waves are known to propagate differently in a network under different states, depending on the excitability of the neurons and the strength of connections between them, even if the connectivity remains the same <xref ref-type="bibr" rid="c37">Muller et al. (2018</xref>). Here, after comparing the wave activities that emerge in three different connectivity for one parameter setting, we proceed to examine whether the Allen connectivity always generates more macroscopic wave activities under different conditions. To do so, we systematically alternate the coupling strength of the network and the level of stimuli, while fixing other parameters for each connectivity in each simulation (Simulation).</p>
<p>As a result, we observe that various kinds of oscillations arise from different connectivity under different conditions. As presented in <xref rid="fig6" ref-type="fig">Figure 6</xref> and Videos, when the network is weakly coupled, all three connectivity are able to produce a certain level of macroscopic wave activities, indicated by the PGD calculation (<xref rid="fig7" ref-type="fig">Fig. 7b</xref>). Still, Allen connectivity produces the highest level of wave activity in this coupling threshold. We also found the network to be well synchronized for both Allen and uniform connectivity, but not for the local connectivity (<xref rid="fig6" ref-type="fig">Fig. 6a-c</xref>). However, when the coupling strength doubles from this level, the network goes into an asynchronous state for both Allen and uniform connectivity (<xref rid="fig6" ref-type="fig">Fig. 6d-f</xref>). This asynchronous firing behavior also disrupts the macroscopic wave activity that arises previously in the weakly coupled network. Interestingly, the local connectivity is capable of retaining the same level of macroscopic wave activities, which are higher then the Allen and uniform connectivity for this coupling threshold (<xref rid="fig7" ref-type="fig">Fig. 7b</xref>). Furthermore, if we keep increasing the coupling strength of the network, the synchrony will return to a high level for Allen and uniform connectivity, consequently increasing the level of macroscopic wave activity in the network (<xref rid="fig6" ref-type="fig">Fig. 6g-i</xref>).</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><title>Different oscillations and spatiotemporal patterns emerge from the cortical network with different connectivity and coupling strength.</title>
<p>For each panel, the raster plot (top) shows the firing behavior of the population and the visualization (bottom) shows the intracellular voltage activity across the cortical surface during the period marked in red dashed lines on the corresponding raster plot. There are 9 panels in total, corresponding to three different connectivity and coupling strengths. <bold>Left to right</bold>: Allen, local and uniform connectivity; <bold>Top to bottom</bold>: weak (50% baseline), medium (baseline) and strong (150% baseline) coupling strength.</p></caption>
<graphic xlink:href="663278v1_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7.</label>
<caption><title>Macroscopic wave activity is strongly affected by the coupling strength of the network and the frequency of the oscillation.</title>
<p><bold>(a-b)</bold> The average phase gradient directionality (PGD) calculated from simulations of different connectivity under different applied currents <bold>(a)</bold> or coupling strengths <bold>(b)</bold>. The error bar represents the values from other simulations with different coupling strengths <bold>(a)</bold> or applied currents <bold>(b). (c)</bold> The average PGD calculated from simulations of different connectivity under different kinds of oscillations categorized by the dominant oscillation frequency (see Quantitative measurement of neuronal activity).</p></caption>
<graphic xlink:href="663278v1_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>From these simulations, we found that the level of macroscopic wave activity is relatively insensitive to the magnitude of the stimuli: under the same coupling strength, changing the level of the stimuli does not strongly change the level of macroscopic wave activity. However, the coupling strength in the network can drastically change the level of macroscopic wave activity non-monotonically (<xref rid="fig7" ref-type="fig">Figure 7</xref> and <xref ref-type="fig" rid="fig7_S1">Figure 7—figure supplement 1</xref>). We found that the level of PGD produced with local connectivity is largely consistent across different dynamic regimes. However, Allen and uniform connectivity are much more sensitive to the change of coupling strength. For Allen connectivity, a high level of macroscopic wave activity can emerge at both low and high coupling strengths, but not during medium coupling strength, in which local connectivity creates the highest wave activities at this threshold, as can be seen from previous <xref rid="fig6" ref-type="fig">Figure 6</xref>. At the same time, the uniform connectivity consistently creates a lower level of wave activities across different coupling strengths, except at the weakest coupling strengths.</p>
</sec>
<sec id="s2f">
<title>Slow oscillations are more likely to form macroscopic traveling waves</title>
<p>In the study of neural oscillations, researchers have found that different frequencies usually indicate different brain functions and behaviors <xref ref-type="bibr" rid="c8">Buzsáki and Draguhn (2004</xref>). As we mentioned in the introduction, traveling waves are observed across a wide range of frequencies, but it is unclear whether there is a relationship between the kind of oscillation and the scope of the traveling wave that can arise from the oscillation. Because we are able to induce a range of oscillations of different frequencies, as shown in <xref rid="fig6" ref-type="fig">Figure 6</xref>, these results now allow us to investigate the relationship between the frequency of the oscillation and its corresponding scope. For each simulation, we conduct spectral analysis on the average voltage of the whole population and find out the dominant frequency of the voltage oscillation based on the power density. For each frequency band (Delta: 0.5 - 4 Hz, Theta: 4 - 8 Hz, Alpha: 8 - 12 Hz, Beta: 12 - 30 Hz and Gamma: 30 - 100 Hz), we gather the simulations that produce the oscillation in the frequency band and calculate the average PGD across these simulations (Quantitative measurement of neuronal activity).</p>
<p>Surprisingly, from <xref rid="fig7" ref-type="fig">Fig. 7c</xref>, we found that the level of PGD is highly correlated with the frequency band of the oscillation. For slow oscillations in the Delta frequency band, the Allen connectivity is able to support a much higher level of macroscopic wave activity on average than uniform and local connectivity. However, for Theta oscillations, the level of PGD for Allen connectivity significantly drops to the same level that is comparable to local connectivity. For Alpha oscillations, the level of macroscopic wave activity rises again, and drops for faster oscillations in Beta and Gamma frequencies. If we compare across connectivity, local connectivity again supports a similar level of PGD across all oscillation frequencies, while Allen connectivity particularly favors the slow frequency. Uniform connectivity again produces the lowest level of macroscopic wave activity compared to the other two connectivity. These findings conjecture that slow oscillations are more likely to propagate as macroscopic traveling waves within the mouse cortex.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<sec id="s3a">
<title>Construction of the Allen connectivity</title>
<p>In this work, we present an algorithm that integrates the spatial transcriptomic dataset that provides the spatial distribution and molecular properties of neurons across the mouse brain, and the mesoscopic connectivity dataset that offers the connectivity information between brain regions on a voxelized level. The algorithm is efficient and can be easily adapted for similar datasets of the mouse brain or for even other species. In essence, our algorithm belongs to the family of community generating algorithms, in particular the stochastic block model <xref ref-type="bibr" rid="c23">Holland et al. (1983</xref>). The projectomme <xref ref-type="bibr" rid="c26">Knox et al. (2018</xref>) we use to build the Allen connectivity is derived from a series of viral-tracing experiments that potentially reflect the connection strength between different regions <xref ref-type="bibr" rid="c40">Oh et al. (2014</xref>). However, the relationship between the actual connectome and the mesoscopic projectome remains unclear. For instance, we did not account for variations in synaptic strength across different connections. Moreover, the projection data used is not cell-type specific. A more updated thalamocortical dataset <xref ref-type="bibr" rid="c22">Harris et al. (2019</xref>) exists but is only on the regional level and therefore was not used in this work. An important future direction will be to improve the algorithm to integrate more comprehensive data on different types of connectivity in the cortex.</p>
</sec>
<sec id="s3b">
<title>Cortical model and simulation</title>
<p>Compared to previous large-scale models <xref ref-type="bibr" rid="c9">Capone et al. (2023)</xref>; <xref ref-type="bibr" rid="c45">Roberts et al. (2019</xref>), our model advances in incorporating the detailed spatial distribution of neurons in the 3-D computational domain. Without this information, spatiotemporal dynamics cannot be accurately analyzed and visualized. Recent research <xref ref-type="bibr" rid="c41">Pang et al. (2023)</xref>; <xref ref-type="bibr" rid="c20">Gulbinaite et al. (2024</xref>) has highlighted the significant role that brain geometry plays in neuronal functions. In this work, we did not further use the spatial information of neurons to model aspects such as the layered structure of the cortex, which would be an interesting direction for future work.</p>
<p>At the same time, although we are using one of the largest spatial transcriptomic datasets up to date, 300,000 neurons are still only a small portion of the total neuronal population in the mouse cortex. The number of neurons in a network will have important effects on aspects such as synaptic scaling. Among the total population, we only modeled two kinds of neurons, which is also a simplification. Therefore, enriching our model by including a higher number of different types of neurons and studying how they affect the conclusion in this paper is highly meaningful.</p>
<p>For simulations, we choose to stimulate the total population of layer 4 neurons as a way to generate traveling waves, which is quite rare under biologically normal conditions. We also did not include any subcortical structure, such as the thalamus, which is vital in cortical dynamics like slow-wave activity <xref ref-type="bibr" rid="c50">Steriade et al. (1993</xref>). In this work, we choose two parameters that affect the dynamic regime of the network, which are the level of the stimuli controlled by the applied current and the coupling strength between neurons. There are many other things that affect the dynamical regime of a network, for example, the excitatory and inhibitory balance is vital for different cortical functions <xref ref-type="bibr" rid="c3">Ahmadian and Miller (2021</xref>). Incorporating these perspectives is also important for future investigations.</p>
<p>Synaptic and conduction delays are essential to cortical dynamics such as traveling waves <xref ref-type="bibr" rid="c43">Petkoski and Jirsa (2022)</xref>; <xref ref-type="bibr" rid="c13">Deco et al. (2009)</xref>; <xref ref-type="bibr" rid="c19">Golomb and Ermentrou (2000</xref>). In our model, because the synapses are modeled by a first-order kinetic model (Neuronal and synaptic model), both excitatory and inhibitory synapses have a rising time that mimics the synaptic delay. However, we did not include conduction delay in our study. Conduction delay is thought to have a proportional relationship with the white matter path length of the connection between two neurons <xref ref-type="bibr" rid="c27">Lemaréchal et al. (2022</xref>). In our model, although we have the 3D positions of neurons, we do not have geometric information about the cortical manifold. Two neurons can be very close in the Cartesian coordinates measured by the Euclidean distance, but very far in terms of the length of the actual connection in the brain. Therefore, incorporating accurate conduction delay in the model is an important future direction.</p>
</sec>
<sec id="s3c">
<title>Quantitative measurements of 3-D traveling waves</title>
<p>There are many techniques available for identifying and measuring large-scale neuronal spatiotemporal patterns <xref ref-type="bibr" rid="c52">Townsend and Gong (2018)</xref>; <xref ref-type="bibr" rid="c21">Gutzen et al. (2024</xref>). However, most of these algorithms are designed to analyze 2-D data. Our simulation data is intrinsically 3-D, thus presenting new challenges for measurement. For instance, we need to identify neuron boundaries to exclude unrealistic boundary effects when calculating the phase gradient field (Quantitative measurement of neuronal activity). Additionally, working with high-resolution 3-D data is computationally expensive. Despite these challenges, we extended and verified the previous phase-based method to quantify the level of macroscopic wave activity in our simulations. However, as noted in the original work <xref ref-type="bibr" rid="c47">Rubino et al. (2006</xref>), phase gradient directionality only indicates planar wave activity and may fail to identify other wave types such as spiral waves, which are observed in the cortex <xref ref-type="bibr" rid="c38">Muller et al. (2016</xref>). We also did not analyze other cortical dynamics, such as sinks and sources, which have appeared in our simulation. Extending more sophisticated methods from 2-D to 3-D to identify diverse spatiotemporal patterns in experimental or simulated data will be a meaningful direction for future research.</p>
</sec>
<sec id="s3d">
<title>Comparing with experimental data</title>
<p>Across the paper, we have chosen the intracellular voltage of neurons as the primary data for the analysis. The voltage signals, though do not directly resemble experimental measures such as local field potential (LFP), provide a quick way to analyze the overall dynamics of the whole network. There is strong experimental evidence of cortical spatiotemporal waves from measurements of LFP and multiunit activity reflecting extracellular electrical potentials in regions across the cortex <xref ref-type="bibr" rid="c15">Destexhe et al. (1999</xref>). Recent experimental studies of cortical wave patterns have achieved significant improvements in spatiotemporal resolution via methods such as wide-field calcium imaging <xref ref-type="bibr" rid="c31">Manley et al. (2024</xref>) and optical voltage imaging <xref ref-type="bibr" rid="c29">Liang et al. (2021</xref>). Our simulation framework allows many opportunities to compare with these experimental data.</p>
<p>However, one must be careful when comparing these simulations to experimental data, especially LFPs or other methods measuring extracellular potential rather than intracellular activity. Further work is needed to connect high-resolution mathematical models with experimental data based on the imaging techniques used. For example, <xref ref-type="bibr" rid="c12">Davis et al. (2020</xref>) has simulated LFP from a high-resolution leaky integrate-and-fire (LIF) network model to compare with real LFP recordings. In future work, we plan to develop new methods to compare model voltage traces with electro-physiological recordings.</p>
</sec>
<sec id="s3e">
<title>Neural oscillation and traveling wave</title>
<p>Different neural oscillations are known to have different generating mechanisms. For example, the gamma oscillation is conjectured to be caused by coordinated interaction of excitatory and inhibitory neurons in the cortex <xref ref-type="bibr" rid="c7">Buzsáki and Wang (2012</xref>). And slow-wave activity is conjectured to be caused by thalamocortical interaction <xref ref-type="bibr" rid="c50">Steriade et al. (1993</xref>). In our work, we did not fully investigate how different kinds of oscillations emerge in the network, but only study how these oscillations produce different traveling waves in the cortex a posteriori. Through statistical observation, we found that the slow oscillations are more likely to form macroscopic traveling waves. In the future, it is essential to combine established understanding of mechanisms behind different oscillations with experiments to further verify the conclusions drawn in this work.</p>
</sec>
</sec>
<sec id="s4">
<title>Methods and Materials</title>
<sec id="s4a">
<title>Use of the spatial transcriptomic data</title>
<p>The original spatial transcriptomic study <xref ref-type="bibr" rid="c58">Zhang et al. (2023</xref>) provides four datasets of cell information identified from the mouse brain. Among these, we selected the largest dataset, Zhuang-ABCA-1, which includes 2.8 million cells from one hemisphere, with approximately 2.6 million (N = 2,616,328) cells registered to the Allen Brain Atlas. Of these 2.6 million cells, about half are non-neuronal cells and were removed before constructing the connectivity. Since we are only modeling the glutamatergic and GABA-ergic neurons, we only kept these two kinds of neuronal populations, totaling approximately 1 million neurons (N = 1,050,440). As a result, our final dataset consists of N = 1,050,440 neurons (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>) in one hemisphere. Within this population, the isocortex contains 297,812 neurons. The cortical connectivity is constructed by applying our algorithm to the total cortical population.</p>
</sec>
<sec id="s4b">
<title>Use of the voxelized connectivity data</title>
<p>The projection data we use in this study comes from <xref ref-type="bibr" rid="c26">Knox et al. (2018</xref>), which provides the connection strength between any pairwise voxel in the isocortex. The most important part of using the projection data is determining the number of connections between neurons in any pairwise voxels based on the connection strength. Let <italic>W</italic> represent the voxelized connectivity matrix, where <italic>W</italic><sub><italic>ab</italic></sub> represents the connection strength from voxel <italic>a</italic> to voxel <italic>b</italic>. In this work, we assume the number of connections between two voxels is proportional to the connection strength, meaning the number of connections from voxel <italic>a</italic> to voxel <italic>b</italic> is <italic>N</italic><sub><italic>ab</italic></sub> = <italic>λW</italic><sub><italic>ab</italic></sub>, where <italic>λ</italic> is a fact that will be calculated based on the density parameter.</p>
<p>Before building the connectivity, we first choose the density parameter, <italic>ρ</italic>, which is the average number of connections per neuron. Let vector <italic>x</italic> represents the number of neurons in each voxel. If <italic>λ</italic> = 1, then the total number of connections in the whole connectivity is <italic>N</italic><sub><italic>total</italic></sub> = <italic>xT W x</italic>, and the average number of connections per neurons is <inline-formula><inline-graphic xlink:href="663278v1_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, where <italic>M</italic> is the total number of neurons. Therefore, if we let <inline-formula><inline-graphic xlink:href="663278v1_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, we will get the ideal average number of connections per neurons. Consequently,<inline-formula><inline-graphic xlink:href="663278v1_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. In the code, after calculating beforehand, we can multiply the whole projection matrix <italic>W</italic> by <italic>λ</italic> to derive a connection matrix, whose each entry now represents the number of connections between any two voxels.</p>
</sec>
<sec id="s4c">
<title>Construction and storage of the connectivity</title>
<p>Three types of connectivity are used in our simulations: Allen, local and uniform connectivity. Allen connectivity is constructed by applying our algorithm to the cortical neurons in Zhuang-ABCA1 based on the method described above. Uniform and local connectivity are constructed in a similar fashion: for each neuron, we first read out the number of outgoing connections in the corresponding Allen connectivity, then we randomly choose the same number of neurons from the total population without repetition for the uniform connectivity, or the same number of nearest neighbors for local connectivity. By this way, the out-degree distribution of all three connectivity will be the same, making them more comparable. In partiuclar, local connectivity is constructed through nearest-neighbor coupling, where we use the K-nearest neighbors (KNN) algorithm <xref ref-type="bibr" rid="c10">Cover and Hart (1967</xref>) to choose a fixed number of outgoing connections to nearest neighbors for each neuron based on spatial position. For all three connectivity, self-connection is not allowed.</p>
<p>When running our connectivity algorithm to build the Allen connectivity, a large number of neurons can pose some challenges to our connectivity algorithm. To tackle this challenge, we loop through the voxels for a significant speed-up. As a result, our algorithm will take <italic>O</italic>(<italic>MN</italic>) time, where M is the number of neurons that contain all the neurons and N is the number of voxels. N has a maximum since the computational domain is finite, and in the end, this algorithm is about two orders of magnitude faster than iterating through every neuron.</p>
<p>In our model, we choose <italic>ρ</italic> = 300, which means there are about 90 million synapses in the model since we have 297,812 neurons. To store such huge connectivity, we use a compressed row form representation of the connectivity matrix, which is also used in similar packages <xref ref-type="bibr" rid="c11">Dai et al. (2020</xref>).</p>
</sec>
<sec id="s4d">
<title>Neuronal and synaptic model</title>
<p>We use a Hodgkin-Huxley type neuron model that can produce different firing behaviors of a cortical neuron <xref ref-type="bibr" rid="c44">Pospischil et al. (2008</xref>). Each neuron has four ionic channels: voltage-gated sodium, voltage-gated potassium, slow non-inactivating potassium, and leak channels. The pyramidal neurons will have all four ionic channels, while the inhibitory neurons do not have the slow non-inactivating potassium channels because they are fast-firing and do not usually exhibit firing adaptation. Detailed equations of each current and the change of gating variables are provided in the appendix. The parameters of the neuronal model are also drawn from the original paper and presented in Table S1 in the appendix.</p>
<p>For synapses, we model both glutamatergic (AMPA) or GABAergic synapses in our cortical network. Both synpases are modeled by a conducatance-based, first-order kinetic model. Please see the supplement for more details.</p>
</sec>
<sec id="s4e">
<title>Simulation</title>
<p>In our system, we have to solve two sets of equations at every time step: the Hodgkin-Huxley equations for the electrophysiology model and the conductance-coupled synaptic equations. We solve the Hodgkin-Huxley equations using an established implicit leapfrog method <xref ref-type="bibr" rid="c16">DeWoskin et al. (2015</xref>), allowing for large timesteps due to increased stability. Both electrophysiology and synaptic equations are solved parallelly on GPU in our framework. The overall parallelism is based on the neuron, which means each set of Hodgkin-Huxley equations of a neuron is put up on an individual thread of GPU to solve at every timestep. Similarly, at any time step, we first check for all neurons firing and then assign each thread to process each of the firing neurons’ downstream connections. Please see the supplements for a detailed description of the numerical methods.</p>
<p>Each simulation lasts for 3 seconds, and we only record the last 1 second of the simulation to avoid the transient at the beginning of the simulation. The initial conditions of all neurons are randomly chosen at the beginning of each simulation. To be more specific, the initial voltage of all neurons is drawn from a uniform distribution between -65 mV and -5 mV, and all gate variables are drawn from a uniform distribution between 0.02 and 0.05. For each simulation, we collect the voltage traces of all neurons with a sampling frequency of 2000 Hz.</p>
<p>In all simulations, the total excitatory population of layer 4 neurons is electrically stimulated with an applied current. All layer 4 neurons receive the same level of applied current and all synapses have the same weight throughout each simulation. In order to adjust the level of stimuli, we change the applied current that ranges from 0.9 nA to 1.9 nA with a step of 0.1 nA. In the simulations, we also modify the coupling strength of the network, which is done by factoring the conductance of both excitatory and inhibitory synapses at the same time. The baseline conductance of an excitatory synapse is 30 nS, and we change the conductance within 15 to 50 nS with a step of 5 nS. The inhibitory conductance is always 10% of the excitaory conductance.</p>
</sec>
<sec id="s4f">
<title>Quantitative measurement of neuronal activity</title>
<p>To better quantify spatiotemporal dynamics, we extend a phase-based method <xref ref-type="bibr" rid="c47">Rubino et al. (2006</xref>) that has primarily been used for 2-D data but naturally generalizes to 3-D. First, we apply the Hilbert transform to the voltage traces of all neurons and extract their phase, treating each neuron as a nonlinear oscillator. Next, we construct a regular 3-D Cartesian grid following the discretization of the Allen Brain Atlas common coordinate framework (ABA-ccf), resulting in a grid of size 132 ∗ 80 ∗ 114, with a spatial resolution of 100<italic>µm</italic> in each direction. We then linearly interpolate the generalized phase of all neurons to their adjacent grid points, effectively mapping neuronal phase information onto the 3-D grid.</p>
<p>Let <italic>ϕ</italic>(<italic>x, t</italic>) represent the interpolated phase field on the 3-D grid. To compute phase gradient directionality (PGD), we first calculate the phase field gradient, ∇<italic>ϕ</italic>, using a finite difference method. We then apply the following formula to calculate <italic>P</italic>, which represents the PGD:
<disp-formula id="eqn1">
<graphic xlink:href="663278v1_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Note that the horizontal bar means taking the average across the whole spatial domain, and <italic>P</italic> is a function of time. Higher PGD means the gradient field at different spatial locations is aligned, and lower PGD means the opposite. In calculating the gradient field, the boundary cells that contain no neurons are excluded. This is done by using the PyVistas package <xref ref-type="bibr" rid="c51">Sullivan and Kaszynski (2019</xref>) by masking off the points that have no neurons to interpolate for. Both phase field interpolation and gradient computation are done by using the intrinsic functions in the 3-D Visualization Toolkit (VTK) <xref ref-type="bibr" rid="c49">Schroeder et al. (1998</xref>).</p>
<p>For spectral analysis of the oscillation, we first calculate the global average voltage by averaging the intracellular voltages of all neurons. We then apply a discrete Fourier transform to the average voltage trace with the signal.periodogram function from the SciPy package <xref ref-type="bibr" rid="c53">Virtanen et al. (2020</xref>). Given a sampling frequency of 2000 Hz, we compute the one-sided power spectral density for frequencies ranging from 0 to 1000 Hz and identify the frequency with the highest density, which we define as the dominant frequency. This value is used in plotting 7 and 2.</p>
</sec>
<sec id="s4g">
<title>Visualization</title>
<p>Throughout the paper, we visualize neurons by coloring them based on their intracellular voltage. The visualization is straightforward for a single neuron such as in 1, but in 2, 5 and 6, we also need to calculate the average voltage of 300 neurons nearby. This is done by identifying the closest 300 neighbors for each neuron based on their spatial distributions and is calculated in post-processing. Additionally, <xref rid="fig2" ref-type="fig">Fig. 2c</xref> and e are visualized based on the time that each neuron fires for the first time under the chosen time window. For 6, the majority of the time window is chosen manually to fully show the spatiotemporal patterns of the corresponding simulation. All visualizations are made using the PyVistas package (<xref ref-type="bibr" rid="c51">Sullivan and Kaszynski (2019</xref>)).</p>
</sec>
</sec>
</body>
<back>
<sec>
<fig id="fig1_S1" position="float" fig-type="figure">
<label>Figure 1. figure supplement 1.</label>
<caption><title>Connectivity matrix with detail region legend and degree distribution.</title>
<p><bold>a</bold> The same connectivity matrix shown in <xref rid="fig1" ref-type="fig">Fig. 1c</xref>, but with detailed region legend. <bold>b</bold> The out and in-degree distribution of all neurons in log 2 scale.</p><p>jectome was later refined to a finer level using a statistical model introduced by <xref ref-type="bibr" rid="c26">Knox et al. (2018</xref>), where the strength of connections is provided on a voxel (100<italic>µm</italic>3) resolution. Because both neuronal (Zhuang-ABCA1) and the voxelized connectivity data are registered with the Allen Brain Atlas Common Coordinate Framework (ABA-CCF) <xref ref-type="bibr" rid="c54">Wang et al. (2020</xref>), we now introduce an algorithm that integrates the two datasets to construct a neuron-to-neuron connectivity.</p></caption>
<graphic xlink:href="663278v1_fig1_S1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S1" position="float" fig-type="figure">
<label>Figure 2. figure supplement 1.</label>
<caption><title>Visualization of the macroscopic traveling waves at single-neuron resolution.</title>
<p><bold>(a-b)</bold> Visualization of the same simulation presented in <xref rid="fig2" ref-type="fig">Fig. 2</xref>, but showing intracellular voltage at single-neuron resolution.</p></caption>
<graphic xlink:href="663278v1_fig2_S1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig3_S1" position="float" fig-type="figure">
<label>Figure 3. figure supplement 1.</label>
<caption><p>Comparison of the three connectivity matrices: <bold>a</bold> Allen, <bold>b</bold> local and <bold>c</bold> uniform connectivity. For local connectivity, the diagonal terms represent the connections within the same region. And the off-diagonal terms exist because these regions are physically adjacent to each other.</p></caption>
<graphic xlink:href="663278v1_fig3_S1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig7_S1" position="float" fig-type="figure">
<label>Figure 7. figure supplement 1.</label>
<caption><title>Detailed plots of phase gradient directionality (PGD) measured in simulations conducted in different conditions.</title>
<p><bold>a-c</bold> The average PGD versus applied currents when the coupling is weak (15ns, a), medium (30ns, b), or strong (45ns, c). <bold>d-f</bold> The average PGD versus different coupling strengths when the applied current is weak (1.2nA, d), medium (1.5nA, e), or strong (1.8nA, f)</p></caption>
<graphic xlink:href="663278v1_fig7_S1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig7_S2" position="float" fig-type="figure">
<label>Figure 7. figure supplement 2.</label>
<caption><title>Spectrum analysis and correlation with phase gradient directionality (PGD):</title>
<p><bold>(a-c)</bold> In each plot, the top panel shows the average voltage of all neurons versus time, and the bottom panel shows the power spectral density of the corresponding voltage trace. For all three plots, the simulations are conducted with an applied current of 0.9 nA and coupling strengths of 15 nS (a), 30 nS (b), and 45 nS (c). <bold>(d)</bold> Each point represents a simulation, where the x-axis represents the dominant frequency of the oscillation calculated from the spectral analysis, y-axis represents the phase gradient directionality (PGD) measured in the same simulation.</p></caption>
<graphic xlink:href="663278v1_fig7_S2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>

<ack>
<title>Acknowledgements</title>
<p>We thank Ningyuan Wang for a helpful discussion about work and coding. This work is dedicated to Steven Brown, who provided many helpful suggestions.</p>
<p>We acknowledge the following funding: ARO MURI W911NF-22-1-0223, NSF DMS 2052499 and HFSP RGP0019/2018,.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aggarwal</surname> <given-names>A</given-names></string-name>, <string-name><surname>Brennan</surname> <given-names>C</given-names></string-name>, <string-name><surname>Luo</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chung</surname> <given-names>H</given-names></string-name>, <string-name><surname>Contreras</surname> <given-names>D</given-names></string-name>, <string-name><surname>Kelz</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Proekt</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Visual evoked feedforward–feedback traveling waves organize neural activity across the cortical hierarchy in mice</article-title>. <source>Nature Communications</source>. <year>2022</year>; <volume>13</volume>(<issue>1</issue>):<fpage>4754</fpage>. <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/s41467-022-32378-x.pdf">https://www.nature.com/articles/s41467-022-32378-x.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1038/s41467-022-32378-x</pub-id>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aggarwal</surname> <given-names>A</given-names></string-name>, <string-name><surname>Luo</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chung</surname> <given-names>H</given-names></string-name>, <string-name><surname>Contreras</surname> <given-names>D</given-names></string-name>, <string-name><surname>Kelz</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Proekt</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Neural assemblies coordinated by cortical waves are associated with waking and hallucinatory brain states</article-title>. <source>Cell Reports</source>. <year>2024</year>; <volume>43</volume>(<issue>4</issue>):<fpage>114017</fpage>. <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S2211124724003450">https://www.sciencedirect.com/science/article/pii/S2211124724003450</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.celrep.2024.114017</pub-id>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ahmadian</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>KD</given-names></string-name></person-group>. <article-title>What is the dynamical regime of cerebral cortex?</article-title> <source>Neuron</source>. <year>2021</year>; <volume>109</volume>(<issue>21</issue>):<fpage>3373</fpage>–<lpage>3391</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bhattacharya</surname> <given-names>S</given-names></string-name>, <string-name><surname>Brincat</surname> <given-names>SL</given-names></string-name>, <string-name><surname>Lundqvist</surname> <given-names>M</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>EK</given-names></string-name></person-group>. <article-title>Traveling waves in the prefrontal cortex during working memory</article-title>. <source>PLoS Comput Biol</source>. <year>2022</year>; <volume>18</volume>(<issue>1</issue>):<fpage>e1009827</fpage>. doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1009827</pub-id>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Budzinski</surname> <given-names>RC</given-names></string-name>, <string-name><surname>Nguyen</surname> <given-names>TT</given-names></string-name>, <string-name><surname>Doan</surname> <given-names>J</given-names></string-name>, <string-name><surname>Minac</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sejnowski</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Muller</surname> <given-names>LE</given-names></string-name></person-group>. <article-title>Geometry unites synchrony, chimeras, and waves in nonlinear oscillator networks</article-title>. <source>Chaos</source>. <year>2022</year>; <volume>32</volume>(<issue>3</issue>):<fpage>031104</fpage>. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/35364855">https://www.ncbi.nlm.nih.gov/pubmed/35364855</ext-link> <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8947818/pdf/CHAOEH-000032-031104_1.pdf">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8947818/pdf/CHAOEH-000032-031104_1.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1063/5.0078791</pub-id>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buzsáki</surname> <given-names>G</given-names></string-name>, <string-name><surname>Mizuseki</surname> <given-names>K.</given-names></string-name></person-group> <article-title>The log-dynamic brain: how skewed distributions affect network operations</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2014</year>; <volume>15</volume>(<issue>4</issue>):<fpage>264</fpage>–<lpage>278</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buzsáki</surname> <given-names>G</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>XJ</given-names></string-name></person-group>. <article-title>Mechanisms of gamma oscillations</article-title>. <source>Annual review of neuroscience</source>. <year>2012</year>; <volume>35</volume>(<issue>1</issue>):<fpage>203</fpage>–<lpage>225</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buzsáki</surname> <given-names>G</given-names></string-name>, <string-name><surname>Draguhn</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Neuronal oscillations in cortical networks</article-title>. <source>Science</source>. <year>2004</year>; <volume>304</volume>(<issue>5679</issue>):<fpage>1926</fpage>–<lpage>9</lpage>. doi: <pub-id pub-id-type="doi">10.1126/science.1099745</pub-id>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Capone</surname> <given-names>C</given-names></string-name>, <string-name><surname>De Luca</surname> <given-names>C</given-names></string-name>, <string-name><surname>De Bonis</surname> <given-names>G</given-names></string-name>, <string-name><surname>Gutzen</surname> <given-names>R</given-names></string-name>, <string-name><surname>Bernava</surname> <given-names>I</given-names></string-name>, <string-name><surname>Pastorelli</surname> <given-names>E</given-names></string-name>, <string-name><surname>Simula</surname> <given-names>F</given-names></string-name>, <string-name><surname>Lupo</surname> <given-names>C</given-names></string-name>, <string-name><surname>Tonielli</surname> <given-names>L</given-names></string-name>, <string-name><surname>Resta</surname> <given-names>F</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Simulations approaching data: cortical slow waves in inferred models of the whole hemisphere of mouse</article-title>. <source>Communications biology</source>. <year>2023</year>; <volume>6</volume>(<issue>1</issue>):<fpage>266</fpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cover</surname> <given-names>T</given-names></string-name>, <string-name><surname>Hart</surname> <given-names>P.</given-names></string-name></person-group> <article-title>Nearest neighbor pattern classification</article-title>. <source>IEEE transactions on information theory</source>. <year>1967</year>; <volume>13</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>27</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dai</surname> <given-names>K</given-names></string-name>, <string-name><surname>Gratiy</surname> <given-names>SL</given-names></string-name>, <string-name><surname>Billeh</surname> <given-names>YN</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>R</given-names></string-name>, <string-name><surname>Cai</surname> <given-names>B</given-names></string-name>, <string-name><surname>Cain</surname> <given-names>N</given-names></string-name>, <string-name><surname>Rimehaug</surname> <given-names>AE</given-names></string-name>, <string-name><surname>Stasik</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Einevoll</surname> <given-names>GT</given-names></string-name>, <string-name><surname>Mihalas</surname> <given-names>S</given-names></string-name>, <string-name><surname>Koch</surname> <given-names>C</given-names></string-name>, <string-name><surname>Arkhipov</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Brain Modeling ToolKit: An open source software suite for multiscale modeling of brain circuits</article-title>. <source>PLOS Computational Biology</source>. <year>2020</year>; <volume>16</volume>(<issue>11</issue>):<fpage>e1008386</fpage>. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7728187/pdf/pcbi.1008386.pdf">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7728187/pdf/pcbi.1008386.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1008386</pub-id>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davis</surname> <given-names>ZW</given-names></string-name>, <string-name><surname>Muller</surname> <given-names>L</given-names></string-name>, <string-name><surname>Martinez-Trujillo</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sejnowski</surname> <given-names>T</given-names></string-name>, <string-name><surname>Reynolds</surname> <given-names>JH</given-names></string-name></person-group>. <article-title>Spontaneous travelling cortical waves gate perception in behaving primates</article-title>. <source>Nature</source>. <year>2020</year>; <volume>587</volume>(<issue>7834</issue>):<fpage>432</fpage>–<lpage>436</lpage>, doi: <pub-id pub-id-type="doi">10.1038/s41586-020-2802-y</pub-id>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deco</surname> <given-names>G</given-names></string-name>, <string-name><surname>Jirsa</surname> <given-names>V</given-names></string-name>, <string-name><surname>McIntosh</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Sporns</surname> <given-names>O</given-names></string-name>, <string-name><surname>Kötter</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Key role of coupling, delay, and noise in resting brain fluctuations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2009</year>; <volume>106</volume>(<issue>25</issue>):<fpage>10302</fpage>–<lpage>10307</lpage>, doi:<pub-id pub-id-type="doi">10.1073/pnas.0901831106</pub-id>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deco</surname> <given-names>G</given-names></string-name>, <string-name><surname>Jirsa</surname> <given-names>VK</given-names></string-name>, <string-name><surname>Robinson</surname> <given-names>PA</given-names></string-name>, <string-name><surname>Breakspear</surname> <given-names>M</given-names></string-name>, <string-name><surname>Friston</surname> <given-names>K.</given-names></string-name></person-group> <article-title>The Dynamic Brain: From Spiking Neurons to Neural Masses and Cortical Fields</article-title>. <source>PLOS Computational Biology</source>. <year>2008</year>; <volume>4</volume>(<issue>8</issue>):<fpage>e1000092</fpage>, doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000092</pub-id>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Destexhe</surname> <given-names>A</given-names></string-name>, <string-name><surname>Contreras</surname> <given-names>D</given-names></string-name>, <string-name><surname>Steriade</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Spatiotemporal analysis of local field potentials and unit discharges in cat cerebral cortex during natural wake and sleep states</article-title>. <source>Journal of Neuroscience</source>. <year>1999</year>; <volume>19</volume>(<issue>11</issue>):<fpage>4595</fpage>–<lpage>4608</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DeWoskin</surname> <given-names>D</given-names></string-name>, <string-name><surname>Myung</surname> <given-names>J</given-names></string-name>, <string-name><surname>Belle</surname> <given-names>MDC</given-names></string-name>, <string-name><surname>Piggins</surname> <given-names>HD</given-names></string-name>, <string-name><surname>Takumi</surname> <given-names>T</given-names></string-name>, <string-name><surname>Forger</surname> <given-names>DB</given-names></string-name></person-group>. <article-title>Distinct roles for GABA across multiple timescales in mammalian circadian timekeeping</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2015</year>; <volume>112</volume>(<issue>29</issue>):<fpage>E3911</fpage>–<lpage>E3919</lpage>. doi: <pub-id pub-id-type="doi">10.1073/pnas.1420753112</pub-id>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ermentrout</surname> <given-names>GB</given-names></string-name>, <string-name><surname>Kleinfeld</surname> <given-names>D.</given-names></string-name></person-group> <article-title>Traveling Electrical Waves in Cortex: Insights from Phase Dynamics and Speculation on a Computational Role</article-title>. <source>Neuron</source>. <year>2001</year>; <volume>29</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>44</lpage>, doi: <pub-id pub-id-type="doi">10.1016/S0896-6273(01)00178-7</pub-id>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fleet</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Jepson</surname> <given-names>AD</given-names></string-name></person-group>. <article-title>Computation of component image velocity from local phase information</article-title>. <source>International Journal of Computer Vision</source>. <year>1990</year>; <volume>5</volume>(<issue>1</issue>):<fpage>77</fpage>–<lpage>104</lpage>, doi: <pub-id pub-id-type="doi">10.1007/BF00056772</pub-id>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Golomb</surname> <given-names>D</given-names></string-name>, <string-name><surname>Ermentrou</surname> <given-names>GB</given-names></string-name></person-group>. <article-title>Effects of delay on the type and velocity of travelling pulses in neuronal networks with spatially decaying connectivity</article-title>. <source>Network</source>. <year>2000</year>; <volume>11</volume>(<issue>3</issue>):<fpage>221</fpage>–<lpage>46</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gulbinaite</surname> <given-names>R</given-names></string-name>, <string-name><surname>Nazari</surname> <given-names>M</given-names></string-name>, <string-name><surname>Rule</surname> <given-names>ME</given-names></string-name>, <string-name><surname>Bermudez-Contreras</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Cohen</surname> <given-names>MX</given-names></string-name>, <string-name><surname>Mohajerani</surname> <given-names>MH</given-names></string-name>, <string-name><surname>Heimel</surname> <given-names>JA</given-names></string-name></person-group>. <article-title>Spatiotemporal resonance in mouse primary visual cortex</article-title>. <source>Current Biology</source>. <year>2024</year>; <volume>34</volume>(<issue>18</issue>):<fpage>4184</fpage>–<lpage>4196.e7</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0960982224010595">https://www.sciencedirect.com/science/article/pii/S0960982224010595</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.cub.2024.07.091</pub-id>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gutzen</surname> <given-names>R</given-names></string-name>, <string-name><surname>De Bonis</surname> <given-names>G</given-names></string-name>, <string-name><surname>De Luca</surname> <given-names>C</given-names></string-name>, <string-name><surname>Pastorelli</surname> <given-names>E</given-names></string-name>, <string-name><surname>Capone</surname> <given-names>C</given-names></string-name>, <string-name><surname>Allegra Mascaro</surname> <given-names>AL</given-names></string-name>, <string-name><surname>Resta</surname> <given-names>F</given-names></string-name>, <string-name><surname>Manasanch</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pavone</surname> <given-names>FS</given-names></string-name>, <string-name><surname>Sanchez-Vives</surname> <given-names>MV</given-names></string-name>, <string-name><surname>Mattia</surname> <given-names>M</given-names></string-name>, <string-name><surname>Grün</surname> <given-names>S</given-names></string-name>, <string-name><surname>Paolucci</surname> <given-names>PS</given-names></string-name>, <string-name><surname>Denker</surname> <given-names>M.</given-names></string-name></person-group> <article-title>A modular and adaptable analysis pipeline to compare slow cerebral rhythms across heterogeneous datasets</article-title>. <source>Cell Reports Methods</source>. <year>2024</year>; <volume>4</volume>(<issue>1</issue>), doi: <pub-id pub-id-type="doi">10.1016/j.crmeth.2023.100681</pub-id>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Mihalas</surname> <given-names>S</given-names></string-name>, <string-name><surname>Hirokawa</surname> <given-names>KE</given-names></string-name>, <string-name><surname>Whitesell</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Choi</surname> <given-names>H</given-names></string-name>, <string-name><surname>Bernard</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bohn</surname> <given-names>P</given-names></string-name>, <string-name><surname>Caldejon</surname> <given-names>S</given-names></string-name>, <string-name><surname>Casal</surname> <given-names>L</given-names></string-name>, <string-name><surname>Cho</surname> <given-names>A</given-names></string-name>, <string-name><surname>Feiner</surname> <given-names>A</given-names></string-name>, <string-name><surname>Feng</surname> <given-names>D</given-names></string-name>, <string-name><surname>Gaudreault</surname> <given-names>N</given-names></string-name>, <string-name><surname>Gerfen</surname> <given-names>CR</given-names></string-name>, <string-name><surname>Graddis</surname> <given-names>N</given-names></string-name>, <string-name><surname>Groblewski</surname> <given-names>PA</given-names></string-name>, <string-name><surname>Henry</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Ho</surname> <given-names>A</given-names></string-name>, <string-name><surname>Howard</surname> <given-names>R</given-names></string-name>, <string-name><surname>Knox</surname> <given-names>JE</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Hierarchical organization of cortical and thalamic connectivity</article-title>. <source>Nature</source>. <year>2019</year>; <volume>575</volume>(<issue>7781</issue>):<fpage>195</fpage>. <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/s41586-019-1716-z.pdf">https://www.nature.com/articles/s41586-019-1716-z.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1038/s41586-019-1716-z</pub-id>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Holland</surname> <given-names>PW</given-names></string-name>, <string-name><surname>Laskey</surname> <given-names>KB</given-names></string-name>, <string-name><surname>Leinhardt</surname> <given-names>S.</given-names></string-name></person-group> <article-title>Stochastic blockmodels: First steps</article-title>. <source>Social Networks</source>. <year>1983</year>; <volume>5</volume>(<issue>2</issue>):<fpage>109</fpage>–<lpage>137</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/0378873383900217">https://www.sciencedirect.com/science/article/pii/0378873383900217</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/0378-8733(83)90021-7</pub-id>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keane</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gong</surname> <given-names>P.</given-names></string-name></person-group> <article-title>Propagating waves can explain irregular neural dynamics</article-title>. <source>J Neurosci</source>. <year>2015</year>; <volume>35</volume>(<issue>4</issue>):<fpage>1591</fpage>–<lpage>605</lpage>. doi: <pub-id pub-id-type="doi">10.1523/jneurosci.1669-14.2015</pub-id>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Kerkoerle</surname> <given-names>T</given-names></string-name>, <string-name><surname>Self</surname> <given-names>MW</given-names></string-name>, <string-name><surname>Dagnino</surname> <given-names>B</given-names></string-name>, <string-name><surname>Gariel-Mathis</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Poort</surname> <given-names>J</given-names></string-name>, <string-name><surname>van der Togt</surname> <given-names>C</given-names></string-name>, <string-name><surname>Roelfsema</surname> <given-names>PR</given-names></string-name></person-group>. <article-title>Alpha and gamma oscillations characterize feedback and feedforward processing in monkey visual cortex</article-title>. <source>Proc Natl Acad Sci U S A</source>. <year>2014</year>; <volume>111</volume>(<issue>40</issue>):<fpage>14332</fpage>–<lpage>41</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/25205811">https://www.ncbi.nlm.nih.gov/pubmed/25205811</ext-link>, doi: <pub-id pub-id-type="doi">10.1073/pnas.1402773111</pub-id>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knox</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>KD</given-names></string-name>, <string-name><surname>Graddis</surname> <given-names>N</given-names></string-name>, <string-name><surname>Whitesell</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Zeng</surname> <given-names>HK</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Shea-Brown</surname> <given-names>E</given-names></string-name>, <string-name><surname>Mihalas</surname> <given-names>S.</given-names></string-name></person-group> <article-title>High-resolution data-driven model of the mouse connectome</article-title>. <source>Network Neuroscience</source>. <year>2018</year>; <volume>3</volume>(<issue>1</issue>):<fpage>217</fpage>–<lpage>236</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6372022/pdf/netn-03-217.pdf">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6372022/pdf/netn-03-217.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1162/netn_a_00066</pub-id>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemaréchal</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Jedynak</surname> <given-names>M</given-names></string-name>, <string-name><surname>Trebaul</surname> <given-names>L</given-names></string-name>, <string-name><surname>Boyer</surname> <given-names>A</given-names></string-name>, <string-name><surname>Tadel</surname> <given-names>F</given-names></string-name>, <string-name><surname>Bhattacharjee</surname> <given-names>M</given-names></string-name>, <string-name><surname>Deman</surname> <given-names>P</given-names></string-name>, <string-name><surname>Tuyisenge</surname> <given-names>V</given-names></string-name>, <string-name><surname>Ayoubian</surname> <given-names>L</given-names></string-name>, <string-name><surname>Hugues</surname> <given-names>E</given-names></string-name>, <string-name><surname>Chanteloup-Forêt</surname> <given-names>B</given-names></string-name>, <string-name><surname>Saubat</surname> <given-names>C</given-names></string-name>, <string-name><surname>Zouglech</surname> <given-names>R</given-names></string-name>, <string-name><surname>Reyes Mejia</surname> <given-names>GC</given-names></string-name>, <string-name><surname>Tourbier</surname> <given-names>S</given-names></string-name>, <string-name><surname>Hagmann</surname> <given-names>P</given-names></string-name>, <string-name><surname>Adam</surname> <given-names>C</given-names></string-name>, <string-name><surname>Barba</surname> <given-names>C</given-names></string-name>, <string-name><surname>Bartolomei</surname> <given-names>F</given-names></string-name>, <string-name><surname>Blauwblomme</surname> <given-names>T</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>A brain atlas of axonal and synaptic delays based on modelling of cortico-cortical evoked potentials</article-title>. <source>Brain</source>. <year>2022</year>; <volume>145</volume>(<issue>5</issue>):<fpage>1653</fpage>–<lpage>1667</lpage>. doi: <pub-id pub-id-type="doi">10.1093/brain/awab362</pub-id>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Liang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Song</surname> <given-names>C</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Knöpfel</surname> <given-names>T</given-names></string-name>, <string-name><surname>Gong</surname> <given-names>P</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>C.</given-names></string-name></person-group> <article-title>Complexity of cortical wave patterns of the wake mouse cortex</article-title>. <source>Nature Communications</source>. <year>2023</year>; <volume>14</volume>(<issue>1</issue>):<fpage>1434</fpage>, doi: <pub-id pub-id-type="doi">10.1038/s41467-023-37088-6</pub-id>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Song</surname> <given-names>C</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gong</surname> <given-names>P</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>C</given-names></string-name>, <string-name><surname>Knöpfel</surname> <given-names>T.</given-names></string-name></person-group> <article-title>Cortex-Wide Dynamics of Intrinsic Electrical Activities: Propagating Waves and Their Interactions</article-title>. <source>The Journal of Neuroscience</source>. <year>2021</year>; <volume>41</volume>(<issue>16</issue>):<fpage>3665</fpage>–<lpage>3678</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.jneurosci.org/content/jneuro/41/16/3665.full.pdf">https://www.jneurosci.org/content/jneuro/41/16/3665.full.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1523/jneurosci.0623-20.2021</pub-id>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lubenov</surname> <given-names>EV</given-names></string-name>, <string-name><surname>Siapas</surname> <given-names>AG</given-names></string-name></person-group>. <article-title>Hippocampal theta oscillations are travelling waves</article-title>. <source>Nature</source>. <year>2009</year>; <volume>459</volume>(<issue>7246</issue>):<fpage>534</fpage>–<lpage>539</lpage>, doi: <pub-id pub-id-type="doi">10.1038/nature08010</pub-id>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Manley</surname> <given-names>J</given-names></string-name>, <string-name><surname>Lu</surname> <given-names>S</given-names></string-name>, <string-name><surname>Barber</surname> <given-names>K</given-names></string-name>, <string-name><surname>Demas</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>H</given-names></string-name>, <string-name><surname>Meyer</surname> <given-names>D</given-names></string-name>, <string-name><surname>Traub</surname> <given-names>FM</given-names></string-name>, <string-name><surname>Vaziri</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Simultaneous, cortex-wide dynamics of up to 1 million neurons reveal unbounded scaling of dimensionality with neuron number</article-title>. <source>Neuron</source>. <year>2024</year>; <volume>112</volume>(<issue>10</issue>):<fpage>1694</fpage>–<lpage>1709.e5</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2024.02.011</pub-id>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Markram</surname> <given-names>H</given-names></string-name>, <string-name><surname>Muller</surname> <given-names>E</given-names></string-name>, <string-name><surname>Ramaswamy</surname> <given-names>S</given-names></string-name>, <string-name><surname>Reimann</surname> <given-names>M</given-names></string-name>, <string-name><surname>Abdellah</surname> <given-names>M</given-names></string-name>, <string-name><surname>Sanchez</surname> <given-names>C</given-names></string-name>, <string-name><surname>Ailamaki</surname> <given-names>A</given-names></string-name>, <string-name><surname>Alonso-Nanclares</surname> <given-names>L</given-names></string-name>, <string-name><surname>Antille</surname> <given-names>N</given-names></string-name>, <string-name><surname>Arsever</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kahou</surname> <given-names>G</given-names></string-name>, <string-name><surname>Berger</surname> <given-names>T</given-names></string-name>, <string-name><surname>Bilgili</surname> <given-names>A</given-names></string-name>, <string-name><surname>Buncic</surname> <given-names>N</given-names></string-name>, <string-name><surname>Chalimourda</surname> <given-names>A</given-names></string-name>, <string-name><surname>Chindemi</surname> <given-names>G</given-names></string-name>, <string-name><surname>Courcol</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Delalondre</surname> <given-names>F</given-names></string-name>, <string-name><surname>Delattre</surname> <given-names>V</given-names></string-name>, <string-name><surname>Druckmann</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Reconstruction and Simulation of Neocortical Microcircuitry</article-title>. <source>Cell</source>. <year>2015</year>; <volume>163</volume>(<issue>2</issue>):<fpage>456</fpage>–<lpage>492</lpage>, doi: <pub-id pub-id-type="doi">10.1016/j.cell.2015.09.029</pub-id>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Massimini</surname> <given-names>M.</given-names></string-name></person-group> <article-title>The Sleep Slow Oscillation as a Traveling Wave</article-title>. <source>Journal of Neuroscience</source>. <year>2004</year>; <volume>24</volume>(<issue>31</issue>):<fpage>6862</fpage>–<lpage>6870</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6729597/pdf/0246862.pdf">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6729597/pdf/0246862.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1523/jneurosci.1318-04.2004</pub-id>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miyamoto</surname> <given-names>D</given-names></string-name>, <string-name><surname>Hirai</surname> <given-names>D</given-names></string-name>, <string-name><surname>Murayama</surname> <given-names>M.</given-names></string-name></person-group> <article-title>The Roles of Cortical Slow Waves in Synaptic Plasticity and Memory Consolidation</article-title>. <source>Front Neural Circuits</source>. <year>2017</year>; <volume>11</volume>:<fpage>92</fpage>. doi: <pub-id pub-id-type="doi">10.3389/fncir.2017.00092</pub-id>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mohajerani</surname> <given-names>MH</given-names></string-name>, <string-name><surname>Chan</surname> <given-names>AW</given-names></string-name>, <string-name><surname>Mohsenvand</surname> <given-names>M</given-names></string-name>, <string-name><surname>LeDue</surname> <given-names>J</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>R</given-names></string-name>, <string-name><surname>McVea</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Boyd</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>YT</given-names></string-name>, <string-name><surname>Reimers</surname> <given-names>M</given-names></string-name>, <string-name><surname>Murphy</surname> <given-names>TH</given-names></string-name></person-group>. <article-title>Spontaneous cortical activity alternates between motifs defined by regional axonal projections</article-title>. <source>Nature Neuroscience</source>. <year>2013</year>; <volume>16</volume>(<issue>10</issue>):<fpage>1426</fpage>–<lpage>1435</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nn.3499.pdf">https://www.nature.com/articles/nn.3499.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1038/nn.3499</pub-id>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mohan</surname> <given-names>UR</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Ermentrout</surname> <given-names>B</given-names></string-name>, <string-name><surname>Jacobs</surname> <given-names>J.</given-names></string-name></person-group> <article-title>The direction of theta and alpha travelling waves modulates human memory processing</article-title>. <source>Nature Human Behaviour</source>. <year>2024</year>; <volume>8</volume>(<issue>6</issue>):<fpage>1124</fpage>–<lpage>1135</lpage>, doi: <pub-id pub-id-type="doi">10.1038/s41562-024-01838-3</pub-id>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muller</surname> <given-names>L</given-names></string-name>, <string-name><surname>Chavane</surname> <given-names>F</given-names></string-name>, <string-name><surname>Reynolds</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sejnowski</surname> <given-names>TJ</given-names></string-name></person-group>. <article-title>Cortical travelling waves: mechanisms and computational principles</article-title>. <source>Nat Rev Neurosci</source>. <year>2018</year>; <volume>19</volume>(<issue>5</issue>):<fpage>255</fpage>–<lpage>268</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/29563572">https://www.ncbi.nlm.nih.gov/pubmed/29563572</ext-link> <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nrn.2018.20.pdf">https://www.nature.com/articles/nrn.2018.20.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1038/nrn.2018.20</pub-id>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muller</surname> <given-names>L</given-names></string-name>, <string-name><surname>Piantoni</surname> <given-names>G</given-names></string-name>, <string-name><surname>Koller</surname> <given-names>D</given-names></string-name>, <string-name><surname>Cash</surname> <given-names>SS</given-names></string-name>, <string-name><surname>Halgren</surname> <given-names>E</given-names></string-name>, <string-name><surname>Sejnowski</surname> <given-names>TJ</given-names></string-name></person-group>. <article-title>Rotating waves during human sleep spindles or-ganize global patterns of activity that repeat precisely through the night</article-title>. <source>eLife</source>. <year>2016</year>; <volume>5</volume>. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/27855061">https://www.ncbi.nlm.nih.gov/pubmed/27855061</ext-link> <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5114016/pdf/elife-17267.pdf">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5114016/pdf/elife-17267.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.7554/eLife.17267</pub-id>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Naze</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bernard</surname> <given-names>C</given-names></string-name>, <string-name><surname>Jirsa</surname> <given-names>V.</given-names></string-name></person-group> <article-title>Computational modeling of seizure dynamics using coupled neuronal networks: factors shaping epileptiform activity</article-title>. <source>PLoS Comput Biol</source>. <year>2015</year>; <volume>11</volume>(<issue>5</issue>):<fpage>e1004209</fpage>. doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004209</pub-id>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oh</surname> <given-names>SW</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Ng</surname> <given-names>L</given-names></string-name>, <string-name><surname>Winslow</surname> <given-names>B</given-names></string-name>, <string-name><surname>Cain</surname> <given-names>N</given-names></string-name>, <string-name><surname>Mihalas</surname> <given-names>S</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Lau</surname> <given-names>C</given-names></string-name>, <string-name><surname>Kuan</surname> <given-names>L</given-names></string-name>, <string-name><surname>Henry</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Mortrud</surname> <given-names>MT</given-names></string-name>, <string-name><surname>Ouellette</surname> <given-names>B</given-names></string-name>, <string-name><surname>Nguyen</surname> <given-names>TN</given-names></string-name>, <string-name><surname>Sorensen</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Slaughterbeck</surname> <given-names>CR</given-names></string-name>, <string-name><surname>Wakeman</surname> <given-names>W</given-names></string-name>, <string-name><surname>Li</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Feng</surname> <given-names>D</given-names></string-name>, <string-name><surname>Ho</surname> <given-names>A</given-names></string-name>, <string-name><surname>Nicholas</surname> <given-names>E</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>A mesoscale connectome of the mouse brain</article-title>. <source>Nature</source>. <year>2014</year>; <volume>508</volume>(<issue>7495</issue>):<fpage>207</fpage>–<lpage>214</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nature13186.pdf">https://www.nature.com/articles/nature13186.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1038/nature13186</pub-id>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pang</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Aquino</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Oldehinkel</surname> <given-names>M</given-names></string-name>, <string-name><surname>Robinson</surname> <given-names>PA</given-names></string-name>, <string-name><surname>Fulcher</surname> <given-names>BD</given-names></string-name>, <string-name><surname>Breakspear</surname> <given-names>M</given-names></string-name>, <string-name><surname>Fornito</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Geometric constraints on human brain function</article-title>. <source>Nature</source>. <year>2023</year>; <volume>618</volume>(<issue>7965</issue>):<fpage>566</fpage>–<lpage>574</lpage>, doi: <pub-id pub-id-type="doi">10.1038/s41586-023-06098-1</pub-id>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patel</surname> <given-names>J</given-names></string-name>, <string-name><surname>Fujisawa</surname> <given-names>S</given-names></string-name>, <string-name><surname>Berényi</surname> <given-names>A</given-names></string-name>, <string-name><surname>Royer</surname> <given-names>S</given-names></string-name>, <string-name><surname>Buzsáki</surname> <given-names>G.</given-names></string-name></person-group> <article-title>Traveling Theta Waves along the Entire Septotemporal Axis of the Hippocampus</article-title>. <source>Neuron</source>. <year>2012</year>; <volume>75</volume>(<issue>3</issue>):<fpage>410</fpage>–<lpage>417</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0896627312006666">https://www.sciencedirect.com/science/article/pii/S0896627312006666</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2012.07.015</pub-id>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Petkoski</surname> <given-names>S</given-names></string-name>, <string-name><surname>Jirsa</surname> <given-names>VK</given-names></string-name></person-group>. <article-title>Normalizing the brain connectome for communication through synchronization</article-title>. <source>Network Neuroscience</source>. <year>2022</year>; <volume>6</volume>(<issue>3</issue>):<fpage>722</fpage>–<lpage>744</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pospischil</surname> <given-names>M</given-names></string-name>, <string-name><surname>Toledo-Rodriguez</surname> <given-names>M</given-names></string-name>, <string-name><surname>Monier</surname> <given-names>C</given-names></string-name>, <string-name><surname>Piwkowska</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Bal</surname> <given-names>T</given-names></string-name>, <string-name><surname>Frégnac</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Markram</surname> <given-names>H</given-names></string-name>, <string-name><surname>Destexhe</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Minimal Hodgkin–Huxley type models for different classes of cortical and thalamic neurons</article-title>. <source>Biological Cybernetics</source>. <year>2008</year>; <volume>99</volume>:<fpage>427</fpage>–<lpage>441</lpage>, doi: <pub-id pub-id-type="doi">10.1007/s00422-008-0263-8</pub-id>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roberts</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Gollo</surname> <given-names>LL</given-names></string-name>, <string-name><surname>Abeysuriya</surname> <given-names>RG</given-names></string-name>, <string-name><surname>Roberts</surname> <given-names>G</given-names></string-name>, <string-name><surname>Mitchell</surname> <given-names>PB</given-names></string-name>, <string-name><surname>Woolrich</surname> <given-names>MW</given-names></string-name>, <string-name><surname>Breakspear</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Metastable brain waves</article-title>. <source>Nature Communications</source>. <year>2019</year>; <volume>10</volume>(<issue>1</issue>):<fpage>1056</fpage>, doi: <pub-id pub-id-type="doi">10.1038/s41467-019-08999-0</pub-id>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rockland</surname> <given-names>KS</given-names></string-name></person-group>. <article-title>What do we know about laminar connectivity?</article-title> <source>Neuroimage</source>. <year>2019</year>; <volume>197</volume>:<fpage>772</fpage>–<lpage>784</lpage>. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2017.07.032</pub-id>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rubino</surname> <given-names>D</given-names></string-name>, <string-name><surname>Robbins</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Hatsopoulos</surname> <given-names>NG</given-names></string-name></person-group>. <article-title>Propagating waves mediate information transfer in the motor cortex</article-title>. <source>Nature Neuroscience</source>. <year>2006</year>; <volume>9</volume>(<issue>12</issue>):<fpage>1549</fpage>–<lpage>1557</lpage>, doi: <pub-id pub-id-type="doi">10.1038/nn1802</pub-id>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sato</surname> <given-names>TK</given-names></string-name>, <string-name><surname>Nauhaus</surname> <given-names>I</given-names></string-name>, <string-name><surname>Carandini</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Traveling waves in visual cortex</article-title>. <source>Neuron</source>. <year>2012</year>; <volume>75</volume>(<issue>2</issue>):<fpage>218</fpage>–<lpage>229</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Schroeder</surname> <given-names>W</given-names></string-name>, <string-name><surname>Martin</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Lorensen</surname> <given-names>WE</given-names></string-name></person-group>. <source>The visualization toolkit an object-oriented approach to 3D graphics</source>. <publisher-name>Prentice-Hall, Inc</publisher-name>.; <year>1998</year>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steriade</surname> <given-names>M</given-names></string-name>, <string-name><surname>Mccormick</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Sejnowski</surname> <given-names>TJ</given-names></string-name></person-group>. <article-title>Thalamocortical Oscillations in the Sleeping and Aroused Brain</article-title>. <source>Science</source>. <year>1993</year>; <volume>262</volume>(<issue>5134</issue>):<fpage>679</fpage>–<lpage>685</lpage>, doi: DOI <pub-id pub-id-type="doi">10.1126/science.8235588</pub-id>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sullivan</surname> <given-names>C</given-names></string-name>, <string-name><surname>Kaszynski</surname> <given-names>A.</given-names></string-name></person-group> <article-title>PyVista: 3D plotting and mesh analysis through a streamlined interface for the Visualization Toolkit (VTK)</article-title>. <source>Journal of Open Source Software</source>. <year>2019</year>; <volume>4</volume>(<issue>37</issue>):<fpage>1450</fpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Townsend</surname> <given-names>RG</given-names></string-name>, <string-name><surname>Gong</surname> <given-names>P.</given-names></string-name></person-group> <article-title>Detection and analysis of spatiotemporal patterns in brain activity</article-title>. <source>PLOS Computational Biology</source>. <year>2018</year>; <volume>14</volume>(<issue>12</issue>):<fpage>e1006643</fpage>, doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006643</pub-id>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virtanen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Gommers</surname> <given-names>R</given-names></string-name>, <string-name><surname>Oliphant</surname> <given-names>TE</given-names></string-name>, <string-name><surname>Haberland</surname> <given-names>M</given-names></string-name>, <string-name><surname>Reddy</surname> <given-names>T</given-names></string-name>, <string-name><surname>Cournapeau</surname> <given-names>D</given-names></string-name>, <string-name><surname>Burovski</surname> <given-names>E</given-names></string-name>, <string-name><surname>Peterson</surname> <given-names>P</given-names></string-name>, <string-name><surname>Weckesser</surname> <given-names>W</given-names></string-name>, <string-name><surname>Bright</surname> <given-names>J</given-names></string-name>, <string-name><surname>van der Walt</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Brett</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>J</given-names></string-name>, <string-name><surname>Millman</surname> <given-names>KJ</given-names></string-name>, <string-name><surname>Mayorov</surname> <given-names>N</given-names></string-name>, <string-name><surname>Nelson</surname> <given-names>ARJ</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>E</given-names></string-name>, <string-name><surname>Kern</surname> <given-names>R</given-names></string-name>, <string-name><surname>Larson</surname> <given-names>E</given-names></string-name>, <string-name><surname>Carey</surname> <given-names>CJ</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nature Methods</source>. <year>2020</year>; <volume>17</volume>(<issue>3</issue>):<fpage>261</fpage>–<lpage>272</lpage>, doi: <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Ding</surname> <given-names>SL</given-names></string-name>, <string-name><surname>Li</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Royall</surname> <given-names>J</given-names></string-name>, <string-name><surname>Feng</surname> <given-names>D</given-names></string-name>, <string-name><surname>Lesnar</surname> <given-names>P</given-names></string-name>, <string-name><surname>Graddis</surname> <given-names>N</given-names></string-name>, <string-name><surname>Naeemi</surname> <given-names>M</given-names></string-name>, <string-name><surname>Facer</surname> <given-names>B</given-names></string-name>, <string-name><surname>Ho</surname> <given-names>A</given-names></string-name>, <string-name><surname>Dolbeare</surname> <given-names>T</given-names></string-name>, <string-name><surname>Blanchard</surname> <given-names>B</given-names></string-name>, <string-name><surname>Dee</surname> <given-names>N</given-names></string-name>, <string-name><surname>Wakeman</surname> <given-names>W</given-names></string-name>, <string-name><surname>Hirokawa</surname> <given-names>KE</given-names></string-name>, <string-name><surname>Szafer</surname> <given-names>A</given-names></string-name>, <string-name><surname>Sunkin</surname> <given-names>SM</given-names></string-name>, <string-name><surname>Oh</surname> <given-names>SW</given-names></string-name>, <string-name><surname>Bernard</surname> <given-names>A</given-names></string-name>, <string-name><surname>Phillips</surname> <given-names>JW</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>The Allen Mouse Brain Common Coordinate Framework: A 3D Reference Atlas</article-title>. <source>Cell</source>. <year>2020</year>; <volume>181</volume>(<issue>4</issue>):<fpage>936</fpage>–<lpage>953.e20</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0092867420304025">https://www.sciencedirect.com/science/article/pii/S0092867420304025</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.cell.2020.04.007</pub-id>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yamaura</surname> <given-names>H</given-names></string-name>, <string-name><surname>Igarashi</surname> <given-names>J</given-names></string-name>, <string-name><surname>Yamazaki</surname> <given-names>T.</given-names></string-name></person-group> <article-title>Simulation of a human-scale cerebellar network model on the k computer</article-title>. <source>Frontiers in neuroinformatics</source>. <year>2020</year>; <volume>14</volume>:<fpage>16</fpage>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Jacobs</surname> <given-names>J.</given-names></string-name></person-group> <article-title>Traveling Theta Waves in the Human Hippocampus</article-title>. <source>The Journal of Neuroscience</source>. <year>2015</year>; <volume>35</volume>(<issue>36</issue>):<fpage>12477</fpage>–<lpage>12487</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.jneurosci.org/content/jneuro/35/36/12477.full.pdf">https://www.jneurosci.org/content/jneuro/35/36/12477.full.pdf</ext-link>, doi: <pub-id pub-id-type="doi">10.1523/jneurosci.5102-14.2015</pub-id>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Watrous</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Patel</surname> <given-names>A</given-names></string-name>, <string-name><surname>Jacobs</surname> <given-names>J.</given-names></string-name></person-group> <article-title>Theta and alpha oscillations are traveling waves in the human neocortex</article-title>. <source>Neuron</source>. <year>2018</year>; <volume>98</volume>(<issue>6</issue>):<fpage>1269</fpage>–<lpage>1281.</lpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname> <given-names>M</given-names></string-name>, <string-name><surname>Pan</surname> <given-names>X</given-names></string-name>, <string-name><surname>Jung</surname> <given-names>W</given-names></string-name>, <string-name><surname>Halpern</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Eichhorn</surname> <given-names>SW</given-names></string-name>, <string-name><surname>Lei</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Cohen</surname> <given-names>L</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Tasic</surname> <given-names>B</given-names></string-name>, <string-name><surname>Yao</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Zeng</surname> <given-names>H</given-names></string-name>, <string-name><surname>Zhuang</surname> <given-names>X.</given-names></string-name></person-group> <article-title>Molecularly defined and spatially resolved cell atlas of the whole mouse brain</article-title>. <source>Nature</source>. <year>2023</year>; <volume>624</volume>(<issue>7991</issue>):<fpage>343</fpage>– <lpage>354</lpage>, doi: <pub-id pub-id-type="doi">10.1038/s41586-023-06808-9</pub-id>.</mixed-citation></ref>
</ref-list>
<app-group>
<app>
<title>Appendix for manuscript: Realistic coupling enables flexible macroscopic traveling waves in the mouse cortex</title>
<sec id="s6a">
<title>Neuronal and synaptic model</title>
<p>As we described in the main manuscript, each neuron is modeled as a single-compartment Hodgkin-Huxley neuron, whose intracellular voltage is governed by the following equation:
<disp-formula id="ueqn1">
<graphic xlink:href="663278v1_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Where <italic>C</italic> and <italic>A</italic> represent the specific membrane capacitance and membrane area, <italic>V</italic> is the membrane potential, <italic>I</italic><sub><italic>L</italic></sub> is the leak current, <italic>I</italic><sub><italic>Na</italic></sub> and <italic>I</italic><sub><italic>K</italic></sub> are the voltage-dependent sodium and potassium currents, and <italic>I</italic><sub><italic>M</italic></sub> is a slow non-inactivating potassium current that is responsible for firing frequency adaptation. <italic>I</italic><sub>app</sub> and <italic>I</italic><sub>syn</sub> are the applied and synaptic currents. The ionic currents are based on descriptions in [1]. Please see the following for equations that describe each ionic current:</p>
<sec id="s6a1">
<title>Ionic Currents</title>
<p><disp-formula id="ueqn2">
<graphic xlink:href="663278v1_ueqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
</sec>
<sec id="s6a2">
<title>Synaptic Currents</title>
<p>In our model, the synaptic current <italic>I</italic><sub>syn</sub> can be excitatory AMPA current or inhibitory GABA current. For the synaptic current, we follow the conductance-based model described in [2]. Each synaptic current is calculated as:
<disp-formula id="ueqn3">
<graphic xlink:href="663278v1_ueqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where: <italic>x</italic> indicates the synaptic type (AMPA or GABA), <italic>T</italic><sub>in</sub> is the total synaptic input, <italic>s</italic><sub><italic>x</italic></sub> is the gating variable. To calculate the synaptic input for the <italic>i</italic>th neuron:
<disp-formula id="ueqn4">
<graphic xlink:href="663278v1_ueqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>W</italic> is the connectivity matrix, <italic>T</italic><sub>out</sub> is modeled as a sigmoidal function, and <italic>V</italic><sub><italic>T s</italic></sub> and <italic>K</italic><sub><italic>T</italic></sub> are parameters that control the synaptic output for each neuron.</p>
<p>Based on this model, when a pre-synaptic neuron fires, it will generate a synaptic input that excites the post-synaptic neuron’s synaptic channel and further generates a post-synaptic current. All parameters used in the simulation are presented in Table S1.</p>
</sec>
</sec>
<sec id="s6b">
<title>Numerical method</title>
<p>Both electrophysiology and synaptic equations are solved with an implicit second-order method, which is based on the trapezoidal rule. We refer to the original manuscript [3] for the details of the numerical method.</p>
<table-wrap id="tblS1" orientation="portrait" position="float">
<label>Table S1:</label>
<caption><title>Parameters used in the simulations</title></caption>
<graphic xlink:href="663278v1_tblS1.tif" mimetype="image" mime-subtype="tiff"/>
<graphic xlink:href="663278v1_tblS1a.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s5" sec-type="data-availability">
<title>Data availability</title>
<p>Raw data related to this study, including the neuronal and connectivity data, has been uploaded to the following repository: <ext-link ext-link-type="uri" xlink:href="https://figshare.com/s/9d68a15dbf33a6f94880">https://figshare.com/s/9d68a15dbf33a6f94880</ext-link>. The related code and simulation data will be uploaded upon acceptance for publication.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="sc1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pospischil</surname> <given-names>M</given-names></string-name>, <string-name><surname>Toledo-Rodriguez</surname> <given-names>M</given-names></string-name>, <string-name><surname>Monier</surname> <given-names>C</given-names></string-name>, <string-name><surname>Piwkowska</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Bal</surname> <given-names>T</given-names></string-name>, <string-name><surname>Frégnac</surname> <given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Minimal Hodgkin–Huxley type models for different classes of cortical and thalamic neurons</article-title>. <source>Biological Cybernetics</source>. <year>2008</year>;<volume>99</volume>(<issue>4-5</issue>):<fpage>427</fpage>–<lpage>41</lpage>. <pub-id pub-id-type="doi">10.1007/s00422-008-0263-8.pdf</pub-id>.</mixed-citation></ref>
<ref id="sc2"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ermentrout</surname> <given-names>B</given-names></string-name>, <string-name><surname>Terman</surname> <given-names>DH</given-names></string-name></person-group>. <source>Mathematical foundations of neuroscience</source>. vol. <volume>35</volume>. <publisher-name>Springer</publisher-name>; <year>2010</year>.</mixed-citation></ref>
<ref id="sc3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>DeWoskin</surname> <given-names>D</given-names></string-name>, <string-name><surname>Myung</surname> <given-names>J</given-names></string-name>, <string-name><surname>Belle</surname> <given-names>MDC</given-names></string-name>, <string-name><surname>Piggins</surname> <given-names>HD</given-names></string-name>, <string-name><surname>Takumi</surname> <given-names>T</given-names></string-name>, <string-name><surname>Forger</surname> <given-names>DB</given-names></string-name></person-group>. <article-title>Distinct roles for GABA across multiple timescales in mammalian circadian timekeeping</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>. <year>2015</year>;<volume>112</volume>(<issue>29</issue>):<fpage>E3911</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
</ref-list>
</app>
</app-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.108208.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Kuan</surname>
<given-names>Aaron</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Yale School of Medicine</institution>
</institution-wrap>
<city>New Haven</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>valuable</bold> work presents a novel computational framework for modeling macroscopic traveling waves in the mouse cortex by integrating open-source connectomic and transcriptomic data into a spiking network model. This approach allows the computational model to assign excitatory/inhibitory connections based on neurotransmitter profiles and extends simulations to the 3D domain. The authors present results that demonstrate how spatiotemporal dynamics such as slow oscillations (0.5-4 Hz) emerge and self-organize at the whole-brain scale. This study provides <bold>convincing</bold> initial insights into the structural basis of traveling waves at the whole-brain scale in the mouse.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.108208.1.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The manuscript &quot;Realistic coupling enables flexible macroscopic traveling waves in the mouse cortex&quot; by Sun, Forger, and colleagues presents a novel computational framework for studying macroscopic traveling waves in the mouse cortex by integrating realistic brain connectivity data with large-scale neural simulations.</p>
<p>The key contributions include:</p>
<p>
(1) developing an algorithm that combines spatial transcriptomic data (providing detailed neuron positions and molecular properties) with voxelized connectivity data from the Allen Brain Atlas to construct neuron-to-neuron connections across ~300,000 cortical neurons;</p>
<p>
(2) building a GPU-accelerated simulation platform capable of modeling this large-scale network with both excitatory and inhibitory Hodgkin-Huxley neurons;</p>
<p>
(3) extending phase-based analysis methods from 2D to 3D to quantify traveling wave activity in the realistic brain geometry; and</p>
<p>
(4) demonstrating that realistic Allen connectivity generates significantly higher levels of macroscopic traveling waves compared to simplified local or uniform connectivity patterns.</p>
<p>The study reveals that wave activity depends non-monotonically on coupling strength and that slow oscillations (0.5-4 Hz) are particularly conducive to large-scale wave propagation, providing new insights into how anatomical connectivity enables flexible spatiotemporal dynamics across the cortex.</p>
<p>Strengths:</p>
<p>The authors leverage two existing dense datasets of spatial transcriptomic data and connection strength between pairwise voxels in the mouse cortex in a novel way, allowing for the computational model to capture molecular and functional properties of neurons as determined by their neurotransmitter profiles, rather than making arbitrary assignments of excitatory/inhibitory roles. Additionally, the author's expansion of 2D phase dynamics to 3D phase gradient analysis methods is important and can be widely applied to calcium imaging, LFP recordings, and likely other electrophysiological recordings.</p>
<p>Weaknesses:</p>
<p>Despite these important computational advancements, a few aspects of this model, particularly the inability to validate the model with experimental neural data, diminish my enthusiasm for this paper:</p>
<p>(1) The model's Allen connectivity approach overlooks critical aspects of real cortical dynamics. Most importantly, it excludes subcortical structures, especially the thalamus, which drives cortical traveling waves through thalamocortical interactions. The authors' method of electrically stimulating all layer 4 neurons simultaneously to initiate waves is artificially crude and bears little resemblance to natural wave generation mechanisms.</p>
<p>(2) The model handles voxel-to-voxel connections crudely when neurons have mixed excitatory/inhibitory properties and varying synaptic strengths. Real connectivity differs dramatically between neuron types (pyramidal cells vs. interneurons, across cortical layers), but the model only distinguishes excitatory and inhibitory neurons. Additionally, uniform synaptic weights ignore natural variations in connection strength based on neuron type, distance, and functional role. Integrating the updated thalamocortical dataset mentioned by the authors, even at regional resolution, would substantially improve the model.</p>
<p>(3) While the authors bridge microscopic (single neuron) and mesoscopic (regional connectivity) data to study macroscopic (whole-cortex) waves, they don't integrate the distinct mechanisms operating at each scale. The framework demonstrates that realistic connectivity enables macroscopic waves but fails to connect how wave dynamics emerge and interact across spatial scales systematically.</p>
<p>(4) Claims that Allen connectivity produces higher phase gradient directionality (PGD) than local connectivity appear limited to delta oscillations at very specific coupling strengths and applied currents. Few parameter combinations show significantly higher PGD for Allen connectivity, and these are generally low PGD values overall.</p>
<p>(5) Broadly, it's unclear how this computational framework can study memory, learning, sleep, sensory processing, or disease states, given the disconnect between simulated intracellular voltages and the local field potentials or other electrophysiological measurements typically used to study cortical traveling waves. While computationally impressive, the practical research applications remain vague.</p>
<p>(6) The paper needs a clearer explanation for why medium coupling (100%) eliminates waves in Allen connectivity (Figure 6) while stronger coupling (150%) restores them.</p>
<p>(7) Does using a single connectivity parameter (ρ = 300) across all regions miss important regional differences in cortical connectivity density?</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.108208.1.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This work presents a spiking network model of traveling waves at the whole-brain scale in the mouse neocortex. The authors use data from the Allen Institute to reconstruct connectivity between different neocortical sites. They then quantify macroscopic traveling waves following stimulation of all layer 4 neurons in the neocortex.</p>
<p>Strengths:</p>
<p>Overall, the results are interesting and shed new light on the dynamic organization of activity across the neocortex of the mouse. The paper uses realistic neuron models specifically fit to intracellular recordings, demonstrating that traveling waves occur in the mouse neocortex with both realistic connectivity and realistic single-neuron dynamics. The paper is also well-written in general. For these reasons, the authors have generally achieved their aims in this work.</p>
<p>Weaknesses:</p>
<p>(1) Description of Algorithm 1:</p>
<p>
While the Methods section clearly explains the density parameter \rho, the statement on line 358 concerning the &quot;ideal&quot; average number of connections is a little unclear. The authors should explicitly clarify that \rho is a free parameter that can be adjusted to balance computational feasibility (for a given set of computational resources) and biological fidelity.</p>
<p>(2) Lines 102-103:</p>
<p>
The \rho parameter used here results in approximately 300 connections per neuron on average. The authors should state clearly that the number of connections per cell is the key determinant of computational feasibility (cf. Morrison et al., Neural Computation, 2005). The authors should also review neuronal density and synaptic connectivity in the mouse neocortex and clearly reference density and connectivity in their model to the biological scales found in the mouse.</p>
<p>(3) Line 131:</p>
<p>
From the plots in Figure 2, it is not clear that the stimulus response is necessarily a rhythmic oscillation, in the sense of a single narrowband frequency.</p>
<p>(4) Line 217:</p>
<p>
The authors should clarify how these findings relate to the results from Mohajerani et al. (Nature Neuroscience, 2013) or differ from them.</p>
<p>(5) Line 230:</p>
<p>
Because higher temporal frequency activity also tends to be more spatially localized, a correlation between PGD and temporal frequency could be an inherent consequence of this relationship, rather than a meaningful result.</p>
<p>(6) Line 247-248:</p>
<p>
It is not clear that the algorithm for generating connections between neurons presented here really relates to those for community detection. For example, in the case of the Allen Institute data, the communities are essentially in the data already.</p>
<p>(7) Line 284-285:</p>
<p>
The relationship between conduction delay is more direct than this sentence suggests. Conduction delay is fundamentally determined by the time required for action potentials to propagate along axons, making it intrinsically linked to anatomical distance.</p>
<p>(8) Line 287-288:</p>
<p>
The authors suggest at this point that they do not have enough information to estimate time delays due to axonal conduction along white matter fibers. However, experimental data from white matter connections typically includes information about fiber length, which does enable estimating conduction delays. These estimations have been previously implemented for Allen Institute connectome data in the mouse (Choi and Mihalas, PLoS Comput Biology, 2019) and human connectome data (Budzinski et al., Physical Review Research, 2023).</p>
<p>(9) Lines 294-295:</p>
<p>
Several methods do exist for detecting and characterizing wave dynamics in three-dimensional data (Budzinski et al., Physical Review Research, 2023).</p>
</body>
</sub-article>
</article>