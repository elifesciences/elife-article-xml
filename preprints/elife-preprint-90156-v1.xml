<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">90156</article-id>
<article-id pub-id-type="doi">10.7554/eLife.90156</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.90156.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Ecology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Synthetic Eco-Evolutionary Dynamics in Simple Molecular Environment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Casiraghi</surname>
<given-names>Luca</given-names>
</name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3712-3595</contrib-id>
<name>
<surname>Mambretti</surname>
<given-names>Francesco</given-names>
</name>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tovo</surname>
<given-names>Anna</given-names>
</name>
<xref ref-type="aff" rid="a2">b</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Paraboschi</surname>
<given-names>Elvezia Maria</given-names>
</name>
<xref ref-type="aff" rid="a3">c</xref>
<xref ref-type="aff" rid="a4">d</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1603-8375</contrib-id>
<name>
<surname>Suweis</surname>
<given-names>Samir</given-names>
</name>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Bellini</surname>
<given-names>Tommaso</given-names>
</name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>a</label><institution>Dipartimento di Biotecnologie Mediche e Medicina Traslazionale, Università degli Studi di Milano</institution>, Via Fratelli Cervi, 93 - L.I.T.A., Segrate, 20054, <country>Italy</country></aff>
<aff id="a2"><label>b</label><institution>Dipartimento di Fisica e Astronomia, Università degli Studi di Padova</institution>, Via Marzolo 8, Padova, 35131, <country>Italy</country></aff>
<aff id="a3"><label>c</label><institution>Department of Biomedical Sciences, Humanitas University</institution>, Via Rita Levi Montalcini 4, Pieve Emanuele, 20072, <country>Italy</country></aff>
<aff id="a4"><label>d</label><institution>IRCCS, Humanitas Clinical and Research Center</institution>, Via Manzoni 56, Rozzano, 20089, <country>Italy</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Bitbol</surname>
<given-names>Anne-Florence</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution>
</institution-wrap>
<city>Lausanne</city>
<country>Switzerland</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Walczak</surname>
<given-names>Aleksandra M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>CNRS</institution>
</institution-wrap>
<city>Paris</city>
<country>France</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label><bold>For correspondence:</bold> <email>elvezia_maria.paraboschi@hunimed.eu</email> (EMP); <email>samir.suweis@unipd.it</email> (SS); <email>tommaso.bellini@unimi.it</email> (TB)</corresp>
<fn id="n1" fn-type="equal"><label>†</label><p>These authors contributed equally to this work.</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-09-12">
<day>12</day>
<month>09</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP90156</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-06-29">
<day>29</day>
<month>06</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-07-25">
<day>25</day>
<month>07</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.07.21.549992"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Casiraghi et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Casiraghi et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-90156-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>The understanding of eco-evolutionary dynamics, and in particular the mechanism of emergence of species, is still fragmentary and in need of test bench model systems. To this aim we developed a variant of SELEX in-vitro selection to study the evolution of a population of ∼ 10<sup>15</sup> single-strand DNA oligonucleotide ‘individuals’. We begin with a seed of random sequences which we select via affinity capture from ∼ 10<sup>12</sup> DNA oligomers of fixed sequence (‘resources’) over which they compete. At each cycle (‘generation’), the ecosystem is replenished via PCR amplification of survivors. Massive parallel sequencing indicates that across generations the variety of sequences (‘species’) drastically decreases, while some of them become populous and dominate the ecosystem. The simplicity of our approach, in which survival is granted by hybridization, enables a quantitative investigation of fitness through a statistical analysis of binding energies. We find that the strength of individual-resource binding dominates the selection in the first generations, while inter and intra-individual interactions becomes important in later stages, in parallel with the emergence of prototypical forms of mutualism and parasitism.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>A central effort in theoretical biology and ecology is to provide an effective description of the intimate but often subtle relationship between a given environment and the evolution of its ecosystem. In the case of simple environments without geographical isolation and physical barriers, as the one here considered, the emergence of species and phenotyping clustering <bold><italic>Davis (1943); <xref ref-type="bibr" rid="c36">Rundle and Nosil (2005)</xref>; <xref ref-type="bibr" rid="c25">Keymer et al. (2012)</xref>; <xref ref-type="bibr" rid="c20">Gupta et al. (2021)</xref></italic></bold> is generally considered an outcome of the competition for the limited available resources <bold><italic><xref ref-type="bibr" rid="c14">Dieckmann and Doebeli (1999)</xref>; <xref ref-type="bibr" rid="c33">Pigolotti et al. (2007)</xref>; <xref ref-type="bibr" rid="c2">de Aguiar et al. (2009)</xref>; <xref ref-type="bibr" rid="c3">Anceschi et al. (2018)</xref></italic></bold>. The coexistence of stable species is ecologically understood in terms of “niches”, indicating the unique role and position that a particular species occupies within an ecosystem. According to the “niche hypothesis” <bold><italic><xref ref-type="bibr" rid="c10">Chase and Leibold (2009)</xref>; <xref ref-type="bibr" rid="c32">Peterson (2011)</xref>; <xref ref-type="bibr" rid="c3">Anceschi et al. (2018)</xref></italic></bold>, biodiversity is limited by the number of “niches” (or types of resources) that are present since no two species can occupy the same niche indefinitely, as one would eventually out-compete the other <bold><italic><xref ref-type="bibr" rid="c26">Levin (1970)</xref>; <xref ref-type="bibr" rid="c20">Gupta et al. (2021)</xref></italic></bold>.</p>
<p><italic>Fitness</italic>, which quantifies species reproductive success and thus also their relationship with the environment <bold><italic><xref ref-type="bibr" rid="c12">De Visser and Krug (2014)</xref></italic></bold>, cannot generally be defined in a predictive way even in the most idealized systems <bold><italic><xref ref-type="bibr" rid="c41">Thurner et al. (2010)</xref>; <xref ref-type="bibr" rid="c46">Wiser and Lenski (2015)</xref></italic></bold>. Indeed, despite the efforts to identify simple case study systems, the evolution of populations formed by a variety of species remains difficult to model and to quantitatively characterize because of the inherent complexity of ecosystems and living beings, of the large number of potentially relevant variables of difficult access, and of the role of stochasticity <bold><italic><xref ref-type="bibr" rid="c8">Catalán et al. (2017)</xref></italic></bold>.</p>
<p>In this scenario, introducing new tools to explore and test eco-evolutionary models, concepts and interpretations appear as the best strategy toward new understanding <bold><italic><xref ref-type="bibr" rid="c40">Solé (2016)</xref></italic></bold>. Along this line, various synthetic biological platforms have been proposed in the last years <bold><italic><xref ref-type="bibr" rid="c22">Ichihashi et al. (2013)</xref>; <xref ref-type="bibr" rid="c42">Tizei et al. (2016)</xref>; <xref ref-type="bibr" rid="c31">Parrilla-Gutierrez et al. (2017)</xref>; <xref ref-type="bibr" rid="c24">Kauffman et al. (2018)</xref>; <xref ref-type="bibr" rid="c1">Adamala and Szostak (2013)</xref>; <xref ref-type="bibr" rid="c23">Katla et al. (2023)</xref></italic></bold> that exploit different principles and mechanisms, and focused on in-vivo, in-vitro, ex-vivo, or in-silico approaches. For example, in <bold><italic><xref ref-type="bibr" rid="c22">Ichihashi et al. (2013)</xref></italic></bold> a “cell-like” model system is proposed, in which the evolution of one long genomic RNA (&gt; 2,000 nt-long) was investigated in detail under the action of a selective pressure ultimately provided by its biological meaning. Despite the tremendous simplification provided by this approach, the constructed artificial cell is still a complex system that includes ribosomes, lipids, translation factors, accessory proteins, tRNAs and amino acids. While most of the synthetic biological platforms are based on the establishment of cell-like, compartmentalized systems involving complex biomolecular milieus and processes <bold><italic><xref ref-type="bibr" rid="c42">Tizei et al. (2016)</xref></italic></bold>, a few are devoted to investigate, with distinct strategies, the competition between two coexisting vescicle-based species competing for resources (vescicle-forming molecules) in a non-biochemical context <bold><italic><xref ref-type="bibr" rid="c1">Adamala and Szostak (2013)</xref>; <xref ref-type="bibr" rid="c23">Katla et al. (2023)</xref></italic></bold>. These articles demonstrate that typical evolution concepts, such as competition or resources and niche exclusion principle, can be applied to “non-biological” systems.</p>
<p>We here propose a synthetic eco-evolutionary scheme, with no cell-like compartmentalization and no connection to the molecular biology of the cell: no coding sequences, no translation, no proteins involved. We consider an ecosystem formed by a large crowd (∼ 10<sup>15</sup>) of distinct molecular individuals interacting with each other and competing for survival in an environment with fixed resources, and we focus on the process by which selection and competition drive the emergence of dominating species. Specifically, we study solutions of 50-base-long single strand DNA oligomers with random sequences, thus initially all distinct, whose mechanisms of survival and mutual interactions are based on DNA hybridization. By exploiting the wealth of tools and knowledge around DNA code selective pairing and DNA synthesis, amplification and sequencing, we create a condition in which a limited number of accessible and computable variables controls the destiny of an ecosystem formed by biological molecules that evolve in a non-biological way, i.e. with no reference to the biological meaning of their sequence.</p>
<p>The results of our work, demonstrating the intimate connection between fitness and ecological interactions, belong to the growing body of studies <bold><italic><xref ref-type="bibr" rid="c18">Fussmann et al. (2007)</xref>; <xref ref-type="bibr" rid="c45">Vetsigian (2017)</xref>; <xref ref-type="bibr" rid="c7">Camacho Mateu et al. (2021)</xref></italic></bold> showing that ecological and evolutionary processes are strictly connected in the emergence and maintenance of species.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Affinity-based DNA Synthetic Evolution</title>
<p>We introduce here a variant of SELEX for in-vitro synthetic evolution of oligonucleotides to develop protein-binding aptamers <bold><italic><xref ref-type="bibr" rid="c16">Ellington and Szostak (1990)</xref>; <xref ref-type="bibr" rid="c44">Tuerk and Gold (1990)</xref></italic></bold>. In standard SELEX protocol, the evolving oligonucleotides are selected at each cycle by their interactions of with the target protein. In the experiment here reported, we implemented a selective mechanism based on the affinity capture provided by magnetic beads carrying single-stranded DNA (ssDNA) filaments of fixed length <italic>L</italic> = 20 and sequence, that act as targets (or resources, <xref rid="fig1" ref-type="fig">Figure1a</xref>). Selection is thus primarily based on the sequence of the DNA individuals and its level of complementarity to the targets. This marks a significant difference with SELEX, in which the aptamer-protein interaction depends instead on higher order factors such as the secondary structure of the oligonucleotides and the variety of binding sites on the folded protein. Being these hard to model, predict and control, SELEX has never been considered, to the best of our knowledge, as a useful experimental test bench to understand evolution.</p>
<p>In our Affinity-based DNA Synthetic Evolution (ADSE) protocol, evolution start from an initial pool of DNA Individuals (DNAi), chosen to be of fixed length <italic>L</italic> = 50 and random-sequence. Since the potential molecular variety is 4<sup>50</sup> ∼ 10<sup>30</sup> while our experiments use about 10<sup>15</sup> initial molecules, each sequence is represented one time only. The following evolution process is sketched in <xref rid="fig1" ref-type="fig">Figure1b</xref>, Figure 1-figure supplement 2, and is given by three steps.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><p>Affinity-based DNA Synthetic Evolution (ADSE). a: structure of the DNA oligomers participating in ADSE as individuals (DNAi) and resources (Figure 1-figure supplement 1). b: steps in the ADSE (Figure 1-figure supplement 2). The process starts with a random-sequence DNAi population. The capture by magnetic bead-conjugated resources provides the selection: bead-bound DNAi are amplified to form the new generation, a small fraction of which is sequenced by MPS. The rest of the original solution is discarded. Red arrows mark the steps of each ADSE cycle. c: possible interactions involving DNAi. The online version of this article includes the following figure supplement(s) for Figure 1: <bold>Figure 1-figure supplement 1</bold> DNA individuals structure and its interaction with the oligos. <bold>Figure 1-figure supplement 2</bold> Schematic representation of the Affinity-based DNA Synthetic Evolution protocol.</p></caption>
<graphic xlink:href="549992v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<list list-type="roman-lower">
<list-item><p><italic>Selection</italic>: the seed population is mixed with a given amount of dispersed capture beads. After a suitable incubation time, the beads are extracted from the solution and the bound oligomers released and saved. The rest of the original solution is discarded;</p></list-item>
<list-item><p><italic>Amplification</italic>: the pool of “survived” oligomers is PCR amplified about 1000 times to recover the initial molarity;</p></list-item>
<list-item><p><italic>Sequencing</italic>: a small portion of the amplified sample (1-3 10<sup>6</sup> molecules) is analyzed by massive parallel sequencing.</p></list-item>
</list>
<p>These steps constitute a cycle - one generation of evolution - that we repeated up to 24 times in two independent evolution histories.</p>
<p>In actuality, to enable amplification and sequencing, DNAi are built by flanking the 50mer with two 25 base long fixed sequences that enable primer binding for a total length of 100 bases. Such two terminal segments of the DNAi are made inactive during selection by hybridization with oligomers of perfect complementarity, as sketched in <xref rid="fig1" ref-type="fig">Figure 1a</xref>, Figure 1-figure supplement 1.</p>
<p>A key feature of ADSE is that DNAi can interact not only with the resources, but also with itself and with each other, and also potentially form complexes binding to the affinity beads as summarized in <xref rid="fig1" ref-type="fig">Figure 1c</xref>. Indeed, the choice of a length of 50 for the DNAi interaction was thought to enable - in principle - simultaneous resource and mutual binding.</p>
<p>PCR amplification can be of high fidelity or error-prone, the latter choice enabling genetic drift and, potentially, speciation. Since our primary goal was to first investigate fitness in a pool of competing species within a given niche - defined in our case by the 20 base long resources, we opted for a high fidelity amplification, and left the investigation of high mutations regimes to a follow-up experiment. Because of the many PCR cycles required in the ADSE scheme, the amplification inevitably leads to the formation of artifacts in the form of longer sequences <bold><italic><xref ref-type="bibr" rid="c43">Tolle et al. (2014)</xref></italic></bold>, a phenomenon that intrinsically sets a limit to the number of generations that can be explored (see <xref ref-type="app" rid="app1">Appendix 1</xref>).</p>
<p>As detailed below, the ADSE protocol enables observing a non-trivial evolution of the DNAi ecosystem across generations, the emergence of dominating species and nonmonotonic population evolution. It also enables to appreciate the role of inter-specific interactions and their contribution to fitness.</p>
</sec>
<sec id="s2b">
<title>Evolution of the DNAi ecosystem</title>
<p>The main output of the synthetic evolution that we are proposing is the dataset {DNAi}<sub><italic>j</italic></sub> obtained by sequencing DNAi at the various cycles (1 ≤ <italic>j</italic> ≤ 24 being the index of the cycle). We find that the initial random ecosystem markedly changes with ADSE generations as shown in <xref rid="fig2" ref-type="fig">Figure 2a</xref>, in which we have plotted the evolution of: (i) the fraction <italic>F</italic><sub><italic>D</italic></sub> of the total population formed by distinct nucleotide sequences (red dots). <italic>F</italic><sub><italic>D</italic></sub> drops from 1 to nearly 0, indicating that initially DNAi are all different from each other, while after 24 generations the number of distinct sequences is much smaller than the number of DNAi. This indicates that most of the initial sequences become progressively “extinct”; (ii) The fraction <italic>F</italic><sub>10</sub> of the total population formed by the 10 most abundant DNA sequences (black dots). <italic>F</italic><sub>10</sub> is initially close to 0 - being each sequence represented by a single DNAi, and grows to about 25% at cycle 12 and 55% at cycle 24 - indicating that the offspring of 10 initial “mother” sequences becomes the majority of the system. This loss of diversity can also be quantified by the zipped file size of the list of sequences <bold><italic><xref ref-type="bibr" rid="c5">Benedetto et al. (2002)</xref></italic></bold> or by computing its Shannon entropy <bold><italic><xref ref-type="bibr" rid="c21">Hill (1973)</xref></italic></bold>, both markedly decreasing during evolution (see <xref ref-type="app" rid="app1">Appendix 1</xref>).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><p>Evolution of the DNAi population. Time is expressed in ADSE cycles. a: fraction <italic>F</italic><sub><italic>D</italic></sub> of the total population formed by different sequences obtained from experiment (red dots) and computed with the IBEE model (green line); fraction <italic>F</italic><sub>10</sub> of the total population formed by the 10 most abundant sequences (experimental: black dots, IBEE model: grey line). c: boxplots and scatterplots of ⟨ Δ<italic>G</italic><sub><italic>DR</italic></sub>⟩ in ensembles of 1000 random sequences (left), 1000 sequences extracted from the experimental population at cycle 24 (middle) and top-10 most populous sequences at the same cycle (right). The color code is assigned to each point based on its <italic>ω</italic> value (color bar). d-f: probability distributions <italic>P</italic> (<italic>ω</italic>) for at cycles 0 (d), 12 (e) and 24 (f). The orange points and line are the distributions evaluated with the null model. g-i: evolution of the abundance (expressed as fraction of the total population <italic>F</italic>) of sequences whose <italic>ω</italic> is low (3 ≤ <italic>ω</italic> ≤ 5-panel g), medium (6 ≤ <italic>ω</italic> ≤ 10 - panel h) and high (11 ≤ <italic>ω</italic> - panel i) as obtained from the experiments (dots) and with the IBEE model (green lines). Model results are averages over 20 simulations. The online version of this article includes the following figure supplement(s) for Figure 2: <bold>Figure 2-figure supplement 1</bold>. Time evolution of the fraction of PCR by-products and of their ⟨<italic>ω</italic>⟩. <bold>Figure 2-figure supplement 2</bold>. Probability distributions <italic>P</italic> (⟨<italic>ω</italic>⟩) of PCR by-products at cycles 0 and 24. <bold>Figure 2-figure supplement 3</bold>. Time evolution of ⟨ <italic>ω</italic> ⟩for the replica Oligo2. <bold>Figure 2-figure supplement 4</bold>. Probability distributions <italic>P</italic> (⟨<italic>ω</italic>⟩) at cycles 0 and 18 for the replica Oligo2. <bold>Figure 2-figure supplement 5</bold>. Experimental vs IBEE time evolution of the population zip ratio and of the Shannon Entropy associated to the RSA distribution. <bold>Figure 2-figure supplement 6</bold>. Experimental vs IBEE ⟨<italic>ω</italic>⟩ time evolution, for two different IBEE hyperparameters choices. <bold>Figure 2-figure supplement 7</bold>. Experimental vs IBEE ⟨<italic>ω</italic>⟩ time evolution, for different IBEE starting population sizes and compositions.</p></caption>
<graphic xlink:href="549992v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Since in ADSE survival depends on bead capture, we expect the DNAi-resource binding strength to be an essential ingredient of fitness. To this aim we computed the mean DNAi-resources binding free energy Δ<italic>G</italic><sub><italic>DR</italic></sub> across generations, plotted in <xref rid="fig2" ref-type="fig">Figure2b</xref> (blue squares, right-hand side <italic>y</italic>-axis). Specifically, Δ<italic>G</italic><sub><italic>DR</italic></sub> has been computed based on DNAi and resource sequences by using the standard “nearest-neighbor approximation” for the thermodynamics of DNA hybridization <bold><italic>SantaLucia Jr (1998); <xref ref-type="bibr" rid="c19">Ghosh et al. (2019)</xref>; <xref ref-type="bibr" rid="c34">Plata et al. (2021)</xref></italic></bold>, as implemented in the NUPACK tool in Python <bold><italic><xref ref-type="bibr" rid="c48">Zadeh et al. (2011)</xref></italic></bold>. Being this computation of some complexity, we could perform it only on batches of 1000 DNAi randomly chosen within {<italic>DNA</italic><sub><italic>i</italic></sub>}<sub><italic>j</italic></sub>, the error bars expressing the uncertainty introduced by such downsampling (see Material and Methods section).</p>
<p>To perform a faster - and thus complete - analysis of the resource-binding energy in the evolving population, we introduced a simpler, albeit more approximate, quantifier: the length <italic>ω</italic> of the longest consecutive number of basis within each DNAi that is complementary to the resource sequence (considering all possible relative positions of the two), in which we allow for single pairing errors and 1-base bulges <bold><italic>Mambretti et al. (2022a)</italic></bold>. While ⟨<italic>ω</italic>⟩, missing key ingredients such as the fraction of CG vs. AT base pairs and their sequence, is certainly inadequate to evaluate the binding strength of a specific DNAi, we find that its average value ⟨<italic>ω</italic>⟩computed for the whole population in each generation (<xref rid="fig2" ref-type="fig">Figure2b</xref>, full red dots, left-hand side y-axis) grows almost identically to ⟨Δ<italic>G</italic><sub><italic>DR</italic></sub>⟩. The ⟨<italic>ω</italic>⟩ axis has been scaled so to make its value computed on a pool of ideal randomly sequence DNAi (dashed red line) match, on the plot, ⟨Δ<italic>G</italic><sub><italic>DR</italic></sub>⟩ computed on the same population (dashed blue line). A more detailed comparison between <italic>ω</italic> and Δ<italic>G</italic><sub><italic>DR</italic></sub> is in <xref rid="fig2" ref-type="fig">Figure2c</xref>, showing box plots with Δ<italic>G</italic><sub><italic>DR</italic></sub> on the y axis and <italic>ω</italic> expressed through color code, built on a random selection of 1000 distinct DNAi in the initial (left hand side box) and the final populations (central box), and on top 10 most frequent sequences in the final generation (right hand side box). The result further strengthens the validity, in our statistical context, of <italic>ω</italic> as a quantifier of interaction strength to the resources <bold><italic>Mambretti et al. (2022a)</italic></bold>.</p>
<p><xref rid="fig2" ref-type="fig">Figure2b</xref> reveals that, during ADSE, <italic>ω</italic> tends to saturate at a value <italic>ω</italic><sub><italic>sat</italic></sub> ≈ 10, indicating that no relevant selective advantage is gained when <italic>ω</italic> &gt; 10, in agreement with the notion that the residence time of hybridized oligomers becomes larger than typical experimental times when <italic>ω</italic> &gt; 12 <bold><italic><xref ref-type="bibr" rid="c13">Di Leo et al. (2022)</xref></italic></bold>.</p>
<p><xref rid="fig2" ref-type="fig">Figure 2d-f</xref> describes the evolution of the ecosystem {DNAi<sub><italic>j</italic></sub> by showing <italic>P</italic> (<italic>ω</italic>), the fraction of DNAi having overlap <italic>ω</italic> with the resource evaluated in the initial pool (panel d) and at generation 12 (e) and 24 (f). <italic>P</italic> (<italic>ω</italic>) clearly evolves, its small <italic>ω</italic> components being progressively lost, while individuals with large <italic>ω</italic> grow in number, as they are more successful in being selected and amplified. It might be worth pointing out that the appearance of non-zero <italic>p</italic>(<italic>ω</italic> &gt; 13) at generation 12, while <italic>p</italic>(<italic>ω</italic> &gt; 13) = 0 in the initial distribution, is a pure effect of the undersampling involved in the sequencing procedure.</p>
<p>The different destiny of DNAi with distinct <italic>ω</italic> values is shown in <xref rid="fig2" ref-type="fig">Figure 2g-i</xref>, where we show the temporal (i.e. across generation) evolution of the fraction of the total population whose <italic>ω</italic> is in the following ranges: 3 ≤ <italic>ω</italic> ≤ 5 (panel g), 6 ≤ <italic>ω</italic> ≤ 10 (panel h) and 11 ≤ <italic>ω</italic> (panel i). As expected, DNAi with weak affinity to the resources decrease while those with large affinity increase. Interestingly, DNAi with intermediate affinity exhibit a non-monotonic behavior, indicating that the conditions for survival change during the evolution, reflecting the evolution of the ecosystem.</p>
</sec>
<sec id="s2c">
<title>Null Model and Eco-evolutionary Algorithm</title>
<p>In order to better understand the experimental outcomes, we first build a null random model without evolution and then an Individual-Based Eco-Evolutionary (IBEE) model enabling predictions for <italic>P</italic> (<italic>ω</italic>).</p>
<p>The null model describes the interaction between individuals in the initial pool {DNAi<sub><italic>j</italic>=0</sub>} of random sequences and the resources within a purely combinatorial framework (see Methods and <xref ref-type="app" rid="app3">Appendix 3</xref> for mathematical details). In this model, we attach a random string of length 50 to the resource string in a random position, and we compute the maximum consecutive overlap, accepting the binding only if it is at least formed by 3 complementary basis. For analytical tractability we do not allow the random string to shift over the resource, but we calculate the <italic>ω</italic> constrained to a specific binding position.</p>
<p>The resulting analytical <italic>p</italic><sub>0</sub>(<italic>ω</italic>), plotted in <xref rid="fig2" ref-type="fig">Figure 2d</xref> (orange crosses) closely matches the data obtained from sequencing, confirming the random-sequence nature of {DNAi<sub><italic>j</italic>=0</sub>}. The analytical <italic>P</italic><sub>0</sub>(<italic>ω</italic>) extends to a <italic>ω</italic> range where no data are available because of the limited size of the sequenced pool. The comparison between <italic>P</italic><sub>0</sub>(<italic>ω</italic>) and <italic>P</italic> (<italic>ω</italic>) in panels e and f shows that the exponential decay of <italic>P</italic><sub>0</sub>(<italic>ω</italic>) at large <italic>ω</italic> is maintained even in generation 12 and partly in generation 24, further supporting the notion that the selective advantage of <italic>ω</italic> saturates at large <italic>ω</italic>.</p>
<p>In the IBEE algorithm we consider <italic>N</italic><sub><italic>p</italic></sub> individuals. Each has a fitness <italic>f</italic><sub><italic>i</italic></sub>(<italic>ω</italic>) (<italic>i</italic> = 1, 2, .., <italic>N</italic><sub><italic>p</italic></sub>) that depends on its affinity <italic>ω</italic> with the resource. At time <italic>t</italic> = 0 we assign <italic>ω</italic> to each individual based on <italic>P</italic><sub>0</sub>(<italic>ω</italic>) from the null model. Then, for each evolutive cycle we model competition and selection so that out of <italic>N</italic><sub><italic>p</italic></sub> individuals, only <italic>N</italic><sub><italic>r</italic></sub> survives. This is attained as a combination of two processes: a fraction <italic>x</italic> of the <italic>N</italic><sub><italic>r</italic></sub> sequences results from sampling individuals from the <italic>N</italic><sub><italic>p</italic></sub> population, each with a survival probability <italic>f</italic> (<italic>ω</italic>) <italic>∈</italic> (0, 1); the remaining fraction 1 − <italic>x</italic> is formed by a straight random selection from the <italic>N</italic><sub><italic>p</italic></sub> individuals. The latter group is meant to mimic “neutral drift” (as it would be expressed in evolutionary language) provided by non-specific binding to the beads. The <italic>N</italic><sub><italic>r</italic></sub> survivers are amplified by identical copying back to <italic>N</italic><sub><italic>p</italic></sub>, the starting population of the next evolutionary cycle (the introduction of very rare mutations do not affect the results). We perform 24 evolutionary cycles.</p>
<p>As expected, the outcome of the eco-evolutionary dynamics strongly depends on the shape of the fitness function. We model it as:
<disp-formula id="ueqn1">
<alternatives><graphic xlink:href="549992v1_ueqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>ω</italic><sub><italic>max</italic></sub> is the (cycle-dependent) largest value of <italic>ω</italic> within the actual population and, <italic>ω</italic><sup>*</sup> = <italic>ω</italic> if <italic>ω</italic> &lt; <italic>ω</italic><sub><italic>sat</italic></sub>, while <italic>ω</italic><sup>*</sup> = <italic>ω</italic><sub><italic>sat</italic></sub> otherwise. <italic>ω</italic><sub><italic>sat</italic></sub> and <italic>γ</italic> are parameters to be tuned in the comparison with the observed⟨<italic>ω</italic>⟩. <italic>ω</italic><sub><italic>sat</italic></sub> expresses the loss of fitness gain for <italic>ω</italic> &gt; <italic>ω</italic><sub><italic>sat</italic></sub> yielding the saturation of⟨<italic>ω</italic>⟩. <italic>γ</italic> represents the strength with which <italic>f</italic> (<italic>ω</italic>) depends on <italic>ω</italic>, and thus the rate at which low <italic>ω</italic> individuals are discarded. <italic>γ</italic> may of course depend on time on account of the evolving ecosystem.</p>
<p>After grid search we find <italic>x</italic> = 0.9, indicating that the random drift contributes to about 10% of survival at each cycle, and <italic>ω</italic><sub><italic>th</italic></sub> = 10, in agreement with the observations prompted by the saturating behavior of ⟨<italic>ω</italic>⟩. We also find that the data cannot be approximated with a single value of <italic>γ</italic>, but they can be very well matched assuming <italic>γ</italic> = 3 for the first 5 cycles and <italic>γ</italic> = 1 for the remaining cycles, as shown in <xref rid="fig2" ref-type="fig">Figure 2b</xref>, green line. With the same choice of parameters, the IBEE fitness based model captures the decrease in the diversity of the DNAi ecosystem (<xref rid="fig2" ref-type="fig">Figure 2a</xref>, green and grey lines) and the temporal (i.e. across generations) evolution of the relative population abundance of DNAi in the three <italic>ω</italic> intervals in <xref rid="fig2" ref-type="fig">Figure 2</xref>, panels g, h and i.</p>
<p>The effect of the system size and initial conditions on the IBEE results, discussed in the <xref ref-type="app" rid="app2">Appendix 2</xref>, do not qualitatively change the models results. Error-bars on simulations have been obtained by averaging 20 independent runs, starting from the same initial conditions. As it can be observed, the variability among simulations is negligible.</p>
<p>The change in <italic>γ</italic>, and thus in fitness, necessary to reproduce the observed ⟨<italic>ω</italic>⟩ with the IBEE model is remarkable because it contrasts with the generally simple (fixed resource and low mutation rate) conditions of ADSE environment and indicates that survival is controlled by more than affinity to the resources, as discussed in the analysis below.</p>
</sec>
<sec id="s2d">
<title>Self and mutual DNAi interactions are evolutionary drivers</title>
<p>While <italic>ω</italic> is certainly a key driver of the observed evolution, it is clearly not the only one. The fact that the top 10 most represented sequences come to be, in the last cycle, about 55% of the total population (<xref rid="fig2" ref-type="fig">Figure 2a</xref>) implies that, even among sequences with large <italic>ω</italic>, only a tiny minority come to dominate, while the largest part of them eventually disappear. Moreover, the 10 most represented sequences do not stand out for their particularly large Δ<italic>G</italic><sub><italic>DR</italic></sub> or <italic>ω</italic>, as noticeable in <xref rid="fig2" ref-type="fig">Figure. 2c</xref>. The same data are plotted in <xref rid="fig3" ref-type="fig">Figure 3a</xref> as a <italic>P</italic> (Δ<italic>G</italic><sub><italic>DR</italic></sub>) distribution to enable comparing the free energy distribution in the initial population (purple shading), in the final population (blue columns) and in the top 10 (black columns). These elements support the notion that survival and dominance must be also due to factors other than <italic>ω</italic>, which we thus explored.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><p>Distribution and evolution of free energy quantifiers. a: probability distribution for the DNAi-resource binding free energy computed by NUPACK, <italic>p</italic>(⟨Δ<italic>G</italic><sub>DR</sub>⟩), for the initial population (grey shading), for the final population (random choice of 1000 DNAi - cyan columns, top 10 most populous sequences - black columns). b: time evolution, expressed in cycles, for various mean free energies⟨Δ<italic>G</italic>⟩, normalized to their value computed on pools of random sequences. All ⟨Δ<italic>G</italic>⟩ are computed by NUPACK on sets of 1000 individuals: Δ<italic>G</italic><sub>DR</sub> (blue dots); unimolecular self interaction ⟨Δ<italic>G</italic>self⟩ (green dots); bimolecular mutual DNAi interaction ⟨Δ<italic>G</italic><sub>DD</sub>⟩ (red dots); mutual, self-subtracted interaction ⟨ΔΔ<italic>G</italic>⟩ (yellow dots). c: scatter plot of ⟨Δ<italic>G</italic>self⟩ vs. Δ<italic>G</italic><sub>DR</sub> computed for 1000 DNAi in the final population (blue squares). Red dots mark the point relative to the 10 most populous sequences, as identified by the labels. Note that the x-axis scale of panels a and c is the same, enabling identifying sequences. d: scatter plot computed on 10<sup>4</sup> DNAi pairs from the final population comparing Δ<italic>G</italic>self<sub>j</sub> + Δ<italic>G</italic>self<sub>,l</sub> and Δ<italic>G</italic><sub>DD,kl</sub> (green squares). Red dots mark the pair formed by the 10 most populous sequences, some of which identified by labels. With respect to the condition Δ<italic>G</italic><sub>DD,kl</sub> = ⟨ Δ<italic>G</italic>self⟩<sub>,j</sub> + ⟨ Δ<italic>G</italic>self⟩<sub>,l</sub> (black line), data are on average displaced by ΔΔ<italic>G</italic> ∼ 7.5 kcal/mol (yellow arrow). The online version of this article includes the following figure supplement(s) for Figure 3: <bold>Figure 3-figure supplement 1</bold>. Three examples of different relative positions for sequence-sequence attachment. <bold>Figure 3-figure supplement 2</bold>. Scheme of target-consumer interaction, from a combinatorial standpoint. <bold>Figure 3-figure supplement 3</bold>. Null model without threshold, analytical and simulated, with an even and uneven nucleotides distribution. <bold>Figure 3-figure supplement 4</bold>. Null model with/without threshold, simulated and analytical.</p></caption>
<graphic xlink:href="549992v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p><xref rid="fig3" ref-type="fig">Figure 3b</xref> shows the value, across the 24 generations, of two other contributions to the total free energy, normalized to their value computed in random sequences, so to enable comparing their relative variations: ⟨⟨ Δ<italic>G</italic>self⟩⟩ (green symbols), the average unimolecular free energy, expressing the average strength of the internal folding of each DNAi; ⟨Δ<italic>G</italic><sub><italic>DD</italic></sub>⟩ (red dots), the total bimolecular DNAi-DNAi free energy, comprising both self and mutual interactions. For comparison, we also plot the normalized value of ⟨Δ<italic>G</italic><sub><italic>DR</italic></sub>⟩ (blue dots). As for the case of Δ<italic>G</italic><sub><italic>DR</italic></sub>⟩, ⟨⟨ Δ<italic>G</italic>self⟩⟩ and ⟨Δ<italic>G</italic><sub><italic>DD</italic></sub>⟩ are computed by randomly selecting 1000 individuals or pairs, respectively, from the population at cycle <italic>j</italic> and using the NUPACK tool to compute the values.</p>
<p><xref rid="fig3" ref-type="fig">Figure 3b</xref> reveals that ⟨⟨ Δ<italic>G</italic>self⟩⟩ grows in time even more than ⟨ Δ<italic>G</italic><sub><italic>DR</italic></sub>⟩, but with a different progression: Δ<italic>G</italic><sub><italic>DR</italic></sub> grows faster in the first cycles to later saturate, while the growth of ⟨Δ<italic>G</italic>self⟩is more uniform.</p>
<p>Since Δ<italic>G</italic><sub><italic>DR</italic></sub> is computed as the free energy of the whole DNAi-resource structure, it includes contributions of self energy associated to hairpins in the DNAi. Thus the growth of Δ<italic>G</italic><sub><italic>DR</italic></sub> could actually depend on the growth in ⟨Δ<italic>G</italic>self⟩(but not the contrary). To investigate this possibility, <xref rid="fig3" ref-type="fig">Figure 3c</xref> displays the scatter plot between Δ<italic>G</italic><sub><italic>DR</italic></sub> and ⟨ ⟨ Δ<italic>G</italic>self⟩⟩, for a randomly chosen subset of DNAi at <italic>j</italic> = 24. In evidence are the 10 points corresponding to the 10 most populous sequences. The plot shows weak or no correlation, and a relevant shift with respect to Δ<italic>G</italic>self= Δ<italic>G</italic><sub><italic>DR</italic></sub> (black line), indicating that there is no dependence of Δ<italic>G</italic><sub><italic>DR</italic></sub> on ⟨Δ<italic>G</italic>self⟩ and indicating that these two quantities reflect two independent driving forces in the selection mechanism of ADSE. Their behavior suggests that in the first stages of ADSE the selection is mostly dominated by the affinity with the resources, while in the later stages the requirement of a stronger unimolecular folding becomes more important.</p>
<p>A similar scatter plot analysis for ⟨Δ<italic>G</italic><sub><italic>DD</italic></sub>⟩ yields a different outcome. <xref rid="fig3" ref-type="fig">Figure 3d</xref> compares Δ<italic>G</italic><sub><italic>DD</italic></sub> computed for two selected DNAi (individual “k” and “l”) and the sum of Δ<italic>G</italic>self of the same two DNAi. The apparent correlation indicates that, <italic>on average</italic>, a large part of ⟨Δ<italic>G</italic><sub><italic>DD</italic></sub>⟩ simply embodies the growth of self-energy, although the difference ΔΔ<italic>G</italic> ≡ Δ<italic>G</italic><sub><italic>DD,kl</italic></sub> − ⟨ Δ<italic>G</italic>self⟩<sub>,<italic>k</italic></sub> − ⟨ Δ<italic>G</italic>self⟩<sub>,<italic>l</italic></sub> (orange arrow) is non-negligible. <xref rid="fig3" ref-type="fig">Figure 3b</xref> shows the behavior of ΔΔ<italic>G</italic> across cycles (orange squares). Despite the resulting mild growth of ΔΔ<italic>G</italic> might appear not relevant, it actually indicated that ADSE, independently of <italic>ω</italic>, select strings that have higher reciprocal affinity than a random DNAi set (see <xref ref-type="app" rid="app2">Appendix 2</xref>). Indeed, as we could have obtained a significant decrease of the same quantity. It should also be noted that mutual interactions might involve the unfolding of hairpins self-structures, in which case their strength would be much larger than ΔΔ<italic>G</italic>.</p>
<p>Self-interactions and mutual interactions can compete with the binding of DNAi to the resources either when they involve the same nucleobases or through steric hindrance. Therefore, we could expect that the increase of Δ<italic>G</italic><sub><italic>DR</italic></sub> would lead to a decrease of both ⟨ Δ<italic>G</italic>self⟩ and Δ<italic>G</italic><sub><italic>DD</italic></sub>. Their unfore-seen growth in the ADSE process is hence an indication of the selective advantage they convey. We interpret this behavior as an indirect sign that mutual DNAi interactions, more than just a impediment, are a major deadly threats for their survival. To avoid them, DNAi need screening. Indeed, the strong growth of self interactions, and the mild increment in mutual interactions, could represent the emergence of “defensive” strategies, as discussed below.</p>
<p>In our search for evolution quantifiers other than resource binding strength we also found that selection favors binding to resource sequences close to their resource 3’ terminal, away from the bead surface (see Figure 4 - figure supplement 2). While this is expected, being that terminal much less constrained and in a less crowded environment, it also provide useful clues to further analysis.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Natural history of DNAi species. a: fraction <italic>F</italic> of {DNAi} that belong to a choice of specific species as a function of the ADSE cycles, in linear (left) and logarithmic (right) scale. Arrows connect the initial condition (one individual per species) to the earliest detection via sequencing, across the 6 order of magnitudes gap (grey shading) between the population of DNAi survived at each cycle and the amount of sequenced DNAi. The same growth is assumed for species 12.1, suggesting its appearance by mutation occurred at generation 9. b-f: self interactions (b1, c1, e1), resource interactions (b2, c2, e2, d1, d2) and mutual interactions (b3, c3, e3, d1, d2, f) of selected species, sketched as per the NUPACK output. Nucleobases color coded (G -black, C - blue, A - green, T - red). Paired bases are connected. Double and single stand regions are represented as straight and curved, respectively. As in <xref rid="fig1" ref-type="fig">Figure 1a</xref>, terminal blocks of DNAi are marked as graphic double helices colored according to the legend of panel a, and beads as sketched yellow spheres. Yellow shading: section of DNAi complementary to resources. Pink frames: regions of hybridization between DNAi. b: interactions involving species 13.0 including its homodimerization (b3). c: interactions involving species 8.0, including its binding to 13.0 (c3). e: interactions involving species 12.1, including its homodimerization (e3). d and f: DNAi heterodimers interactions suggesting parasitism (d1), and possibly mutualism (d2) and mutual damage (f). The online version of this article includes the following figure supplement(s) for Figure 4: <bold>Figure 4-figure supplement 1</bold>. Evolution of the intra-species interaction strengths (⟨Δ<italic>G</italic><sub><italic>pp</italic></sub>⟩). <bold>Figure 4-figure supplement 2</bold>. 2D probability for a consumer, shown at different experimental cycles, to have a given ⟨<italic>ω</italic>⟩ jointly with a given attachment coordinate to a target strand.</p></caption>
<graphic xlink:href="549992v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2e">
<title>The evolution of DNAi species</title>
<p>While the trends in average free energies offer some insight into the nature of the ADSE ecosystem, it has also become clear that they do not enable full understanding, especially since the dominant species are not - as one could naively expect - at the extremes of the energies distributions. To gain further insight, we examined the change in numerosity of the groups of DNAi having equal sequence, which might be regarded as the “species” of ADSE. Accordingly, the 10 most populous sequences are the 10 most successful <italic>species</italic>. The evolution of the populousness, expressed as the fraction <italic>F</italic> of the total population that belong to a given species, is shown in <xref rid="fig4" ref-type="fig">Figure 4a</xref> for a limited set of (mainly) successful species (for a larger selection see SI). Species that are later becoming dominant “appear” in our analysis only at generation 5 in a single or a few copies. This is reasonable since we sequence a sample of ∼ 10<sup>6</sup> DNAi over the much larger population of ∼ 10<sup>12</sup> survived individuals. Species are named after their <italic>ω</italic> value, combined with an index (e.g. “12.0”, “12.1”, “12.2” …) expressing their ranking in populousness.</p>
<p>ADSE species populations do not have standard patterns of evolution. This is true even when limiting the observation to the successful species in <xref rid="fig4" ref-type="fig">Figure 4a</xref> whose population growths are varied and do not reflect in any simple way the energy quantifiers. Conversely, species with similar energy quantifiers may have opposite fate, either becoming dominant or rapidly extinguishing or else displaying a non-monotonic population evolution. It is worth pointing out that all species start equal, each represented in the original pool by a single molecule, which on this scale would appear as a <italic>F</italic> ≈ 10<sup>−12</sup> (black dot in <xref rid="fig4" ref-type="fig">Figure 4a</xref>).</p>
<p>We thus decided to seek further understanding on the survival of the fittest in ADSE by inspecting the “natural history” of a few species (see Tables 2, 3).</p>
<p>13.0 and 11.0 (orange and gray dots in <xref rid="fig4" ref-type="fig">Figure. 4a</xref>) are, respectively, the most and second most populous species in the last generation. It might be relevant to mention that the replica of ADSE described in the SI leads to different dominant sequences, as expected on the basis of the distinct initial pool and on the key role of randomness and sampling in the first cycles. At generation 24, 13.0 and 11.0 have grown to more than 85% and 53% of DNAi with <italic>ω</italic> = 13 and <italic>ω</italic> = 11, respectively, a further indication that <italic>ω</italic> is only one of the ingredients of the fitness. 13.0, and 11.0 likewise, have a weak self-interaction (<xref rid="fig3" ref-type="fig">Figure 3c</xref>), corresponding to hairpins that provide a mild defense to mutual interactions, as schematically sketched in <xref rid="fig4" ref-type="fig">Figure 4</xref>, panel b1. The hairpins involve most of the bases that are complementary to the resource (green shading), leaving however a few unpaired bases that might act as toehold to initiate resource binding. The resource binding takes place at its 3’ terminus (panel b2). A bit puzzled about the success of these two species we also explored their capacity of mutual interactions and found that both of them are capable of forming homodimers, as shown in panel b3 for 13.0 (binding energy marked in <xref rid="fig3" ref-type="fig">Figure 3d</xref>). Such dimers can bind resources at both ends (green shading regions), giving 13.0 and 11.0 self-screening and divalent binding capacity. We argue this to be a crucial drive toward success of these two species, which also explains why their growth has such an increment in the latest generations, following the probability of dimer formation.</p>
<p>The third most populous sequence (species 8.0) is characterized by a weak resource interaction which includes a bulge (see <xref rid="fig3" ref-type="fig">Figure 3c</xref>). While its survival rationale appears clear - good defensive self-binding (panel c1) and interaction targeting the 3’ end of the resource (panel c2) - it is hard to accept this could be the cause of the success. Again, inspecting the mutual interaction we found that 8.0 efficiently interacts with 13.0 (as marked <xref rid="fig3" ref-type="fig">Figure 3d</xref>), in a region (pink shading) that does not conflict with the capacity of 13.0 to bind to the resource (panel c3). We speculate that this parasitic capacity of 8.0 adds to the weak intrinsic binding to lead to a remarkable success of this species.</p>
<p>As a test to this concept, we focused on species 5.1, whose binding strength to the resource is the weakest in the top 10 species and one of the weakest among all the survivors of generation 24 (<xref rid="fig3" ref-type="fig">Figure 3c</xref>), a situation that cannot justify its success. However, by inspecting mutual interactions, we find its binding to 11.0 to be strong and stable (pink shading panel d1 and <xref rid="fig3" ref-type="fig">Figure 3d</xref>). An analogous behavior is found for species 5.0 and its interaction to 12.0 (panel d2), confirming that parasitism is an emerging successful survival solution in ADSE.</p>
<p>We then inspected 12.1 since it has largest Δ<italic>G</italic><sub><italic>DR</italic></sub> and ⟨ Δ<italic>G</italic>self⟩ among the top 10 species (<xref rid="fig3" ref-type="fig">Figure 3c</xref>). Species 12.1 has all the features to succeed in ADSE: it forms a weak hairpin with the bases involved in the binding with the resources and a strong hairpin that protects the rest of the ssDNA segment (panel e1); it strongly binds to the resource with the bond ending at its 3’ terminal (panel e2); it forms homodimers capable of double resource binding, analogous to that of 13.0 (panel e3). Remarkably, 12.1 emerges only late in ADSE (<xref rid="fig4" ref-type="fig">Figure 4a</xref>, blue dots), a very unusual behavior when compared to the other many species we have considered. The combination of this late appearance and of the remarkable growth in <italic>F</italic> afterward suggests that 12.1 is the outcome of one of the rare <italic>mutations</italic> that can occur even with the high quality PCR that we adopted. By assuming the initial growth as with the dominant species (black arrows in panel a), we argue that such mutation occurred around generation 9, where we have found ancestors having sequence equal to 12.1 except for 4 bases.</p>
<p><italic>F</italic> has a monotonic increase for most of the species that become dominant in the latest generations. This behavior is however not at all general. Non-monotonic <italic>F</italic>, growing in the first generation and decreasing to extinction afterward, is the general behavior for the majority of species that do not become extinct in the first cycle, as also shown - as mean behavior - in <xref rid="fig2" ref-type="fig">Figure 2h</xref>. An examples of these is species 7.X, which we plot in panel a of <xref rid="fig4" ref-type="fig">Figure 4</xref> (empty dots).</p>
<p>More intriguing is when a non-monotonic behavior is observed for one of the dominating species. This is the case of 11.1, whose growth can be again attributed to an effective screening and a good binding to the resources, but whose decrease is harder to justify. To understand it we again investigated mutual interactions, and we found a strong 11.0-11.1 bond (sketched in panel f), which, differently from the DNAi-DNAi complex examined above, competes with resource binding. We thus speculate that the fall of 11.1 is a consequence of the rise of 11.0, which has become frequent enough to make the formation of the complex 11.0-11.1 probable, which lowers the survival probability of both species. This could also explain why species 11.0 has such an irregular growth pattern, with a slowing down when 11.1 becomes highly populated.</p>
<p>The insight gained by these case-studies enables appreciating how self and mutual interactions can affect the fate of species in ADSE beyond what we could discern through distributions and average quantifiers. Indeed, this analysis shows that the success of the dominant ASDE species can be achieved through different combinations of resource and mutual DNAi interactions, a fact that makes the evolution of population so varied and generation dependent and explains why, in the latest generations of ADSE, the population distribution <italic>p</italic>(Δ<italic>G</italic>) (<xref rid="fig3" ref-type="fig">Figure 3a</xref>) is so irregular.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion and Conclusion</title>
<p>We have here introduced ADSE, a synthetic molecular evolution protocol that exploits sequencing technology and DNA interaction computability to provide a test-bed for key concepts in ecology and evolution. We performed experiments by adopting the most simple environment within this protocol, <italic>i</italic>.<italic>e</italic>. by holding fixed the capture sequence and minimizing mutations, to achieve a condition dominated by competition and selection, which could enable investigating the nature of fitness in this simplified evolution process.</p>
<p>Our experiments and their comparison with theoretical models indicate that fitness is not a simple function of the direct competitive advantage of strong binding to the resources, as it could have been naively expected. Resource binding is indeed the dominant factor in the first part of the evolution (cycles 1-5), producing a fast growth of ⟨<italic>ω</italic>⟩ compatible with a strong dependence of the survival probability on ⟨ <italic>ω</italic> ⟩(<italic>f ∝ ω</italic><sup>3</sup>). However, as <italic>ω</italic> reaches a value corresponding to bonds of moderate stability <bold><italic><xref ref-type="bibr" rid="c47">Woodside et al. (2006)</xref></italic></bold> - approximately from generation 6 onward - the selective pressure related to resource binding decreases (<italic>f ∝ ω</italic>), a condition enabling to appreciate other factors at play. Which are these factors is suggested by the different growth patterns of Δ<italic>G</italic><sub><italic>DR</italic></sub> and ⟨ Δ<italic>G</italic>self⟩, the former dominating the first cycles while the latter drives the later stages. However, the quantification of binding energies isn’t sufficient to predict the fate of individual species, that also depends on interaction details (location of binding and hairpin spots, secondary structures) and possibly on kinetics.</p>
<p>In fact, by design, DNAi can interact with themselves, both internally - forming hairpin-like structures - and mutually - leading to the formation of complexes. These interactions can either coexist-when they involve non-overlapping sequences - or they can become competitive. Our experiments reveal that, among the wide variety of conditions made available by the initial random seed, ADSE generally promotes those that combine a good interaction with the resources and a structure capable of screening from mutual DNAi interactions conflicting with binding to the beads. By exploring hybridisation-dependent DNAi secondary structures - the only ones accessible with simple analytical tools, we found three basic motifs: hairpins due to self-interactions (as for species 12.1), formation of DNAi homoduplets (as for species 13.0 and 11.0), and formation of dimers of DNAi belonging to distinct species. The latter can bring to distinct prototypical behavior: it can be the basis of <italic>parasitism</italic>, as in the case of the pairs 8.0-13.0 and 5.1-11.0, it can lead to <italic>extinction</italic> with no benefit for either species (as in the case of 15.0-12.0), or it can provide - at least in principle - <italic>mutualism</italic>. While we do not have a solid proof, clues suggest that cooperation might be the case of the interaction between species 5.0 and 12.0, since 12.0 has a weak self-defensive system and since the populations of 12.0 and 5.0 evolve very similarly (see Table 2). Finally, we cannot exclude a possible role of the formation of multi-DNAi multivalent complexes. This is the case of species 12.0 and 15.0 whose pattern of multivalent mutual interactions can, in principle, allow higher order interactions (see <xref ref-type="app" rid="app2">Appendix 2</xref>).</p>
<p>Fitness in ADSE is the outcome of a complex interplay of all these elements. The history of single species in <xref rid="fig4" ref-type="fig">Figure 4</xref> indicates that the nature of fitness is beyond what can be captured by analyzing the probability distributions of the relevant parameters describing structure and interactions. Moreover, the variety of population evolution enlightens the fundamental fact that despite the constancy of resources, the progressive modification of the ecosystem brings about a change in the competition patterns and thus in fitness. A forthcoming work focused on a limited number of species will be devoted to better disentangle the nature of fitness in ADSE.</p>
<p>The evolution of the ADSE ecosystem, which corresponds to a marked decrement of its entropy - with 2/3 of the initial species become extinct in the first 5 generations - and potentially terminating with the indication of a single winner species leads instead, in the last cycles, to a significant number of dominant species all still growing at the expenses of subservient ones, indicating that in their direct competition none of them is strongly prevailing despite - or maybe thanks to - their distinct survival strategies and their very different population share. Hence, while the niche hypothesis could still be verified in the long run - beyond the experimental limitations due to PCR - it is clear that its drive is weak, suggesting that it could be overcome by environmental fluctuations, thus allowing for coexistence of different species even in a single niche environment.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<p>Our experimental design takes advantage of a selective capture mechanism where magnetic beads carrying single-stranded DNA filaments of fixed length and sequence (resources) target DNA individuals (DNAi) (<xref rid="fig1" ref-type="fig">Figure 1</xref> - figure supplement 1) present in a DNA library based on their level of complementarity. This process of selection is carried out through subsequent steps that are described in detail in the next paragraphs and represented in Figure 1-figure supplement 2.</p>
<sec id="s4a">
<title>Library design</title>
<p>The DNA library contains 100-nt-long sequences where a randomized central region of 50 nu-cleotides is flanked by 25-nt-long fixed sequences at both its 5’ and 3’ ends. The fixed regions provide an anchor point for primer annealing, required to perform PCR reactions during the amplification phase (see below). These terminal segments are made inactive by hybridization with oligomers of perfect complementarity (blockers), so that they are not involved in the selection phase. The blockers, as well as the fixed regions of the DNA library, have been designed to avoid any interactions with the resources. In addition, the blockers carry a phosphate group at their 3<sup>′</sup> end to prevent them from functioning as primers during the PCR amplification. Following the above described criteria, we designed two sets of sequences (Table 1), called Oligo1 (whose results are presented in the main text) and Oligo2 that was used as a replication experiment. All the oligonucleotides used in this work were purchased from Integrated DNA Technologies, Coralville, IA, USA (Table 1).</p>
</sec>
<sec id="s4b">
<title>Beads preparation</title>
<p>The capture of DNAi within the DNA library was performed with carboxylic acid magnetic beads (M-270 Dynabeads, Invitrogen, Carlsbad, CA) coated with the resources. The resources are 20-nucleotide-long, 5’-amino-modified oligonucleotides. Their coupling to the beads surface was performed according to the manufacturer’s instructions. Following the activation and coupling procedure, the beads were washed in Tris-HCl (50mM, pH 7.4), and stored in the same buffer in single-use aliquotes.</p>
</sec>
<sec id="s4c">
<title>Sample preparation</title>
<p>The starting samples were prepared in 1X SSC buffer (0.15M sodium chloride, 15mM sodium citrate, pH 7.0). In detail, the Oligo1 (or Oligo2) library (0.75nmol) was mixed with the blockers (2.25nmol) in 1:3 molar ratio to saturate all the available interaction sites between the blockers and the fixed regions of the DNA library. The sample was then denatured at 95°C for 5 minutes, then slowly brought to room temperature using a thermal cycler (MasterCycler Nexus Gradient, Eppendorf, Hamburg, Germany).</p>
</sec>
<sec id="s4d">
<title>Selection phase</title>
<p>The beads, coupled with the resources, are mixed with the sample, prepared as described above. The capture of the DNAi is carried out at 40°C for 2 hours in stirring (600rpm, ThermoMixer, Eppendorf). Once the selection phase is completed, the sample is incubated for 2 minutes on a magnet and the supernatant is removed. The beads, that are now bound to the captured DNAi, are washed three times in SSC 1X buffer to eliminate the aspecific sequences. Finally, the beads are resuspended in water and incubated for 5 minutes at 60°C to recover the DNAi from the resources. The sample is quickly placed on the magnet and after 2 minutes the supernatant containing the selected DNAi is collected.</p>
</sec>
<sec id="s4e">
<title>Amplification phase</title>
<p>The captured DNAi are then amplified by PCR with Q5® Hot Start High-Fidelity DNA Polymerase (New England Biolabs, Ipswich, MA, USA). DNA samples were diluted 10 times and 3<italic>μ</italic>l were used for each PCR reaction. The PCR was performed in a final volume of 25<italic>μ</italic>L using 0.25<italic>μ</italic>L of polymerase, and each primer had a final primer concentration of 2.5<italic>μ</italic>M. To allow the regeneration of the single strand library, the reverse primer was designed to carry a 5<sup>′</sup> biotin modification (see next paragraph for details). The thermal protocol was the following: i) denaturation step at 98 ? C for 2 minutes, ii) 28 cycles characterized by three thermal steps: 10 seconds at 98?C, 10 seconds at 68?C for Oligo1 (69?C for Oligo2) and 1 second at 72?C, iii) 2 minutes at 72?C. For each generation, 10 different PCR reactions were performed. The PCR products were then checked for size on a 2% TBE 1X agarose gel.</p>
</sec>
<sec id="s4f">
<title>Regeneration phase</title>
<p>PCR products were purified by precipitation with 2.5 volumes of ethanol and 0.1 volumes of sodium acetate 2M, pH 5.2. After an overnight precipitation at -20?C, the pellet was washed with ethanol 75%, resuspended in water and quantified using the Qubit fluorometer (Invitrogen, Waltham, MA, USA). The single-strand regeneration was performed with streptavidin-coated magnetic beads (M-270 Dynabeads, Invitrogen, Carlsbad, CA) according to manufacturer’s instructions. Briefly, the PCR product was incubated for 15 minutes on a rotator with the magnetic beads. After 2 washes with binding and washing buffer (10mM Tris–HCl pH 7.5, 1mM EDTA, 0.2M NaCl) and a third one with SSC 1X buffer, an alkaline denaturation was performed by incubating the beads with 150mM NaOH for 10 minutes to induce the separation of the two DNA strands. This way it is possible to recover the unlabeled DNA strand in solution. The ssDNA is then collected and buffered with 1.25M acetic acid and TE 1X. The regenerated ssDNA is ready for the next round of selection and amplification.</p>
</sec>
<sec id="s4g">
<title>Sequencing of the recovered products</title>
<p>To check the growth of DNAi species in our experimental model, some generations were sequenced through next-generation sequencing techniques. To prepare the sample for sequencing, the DNAi species captured as described in the “Selection phase” paragraph were first PCR-amplified using the same conditions discussed before. However, in this case, both forward and reverse primers were unlabelled. After PCR purification, performed as already described (see “regeneration phase” paragraph), the products were quantified and used to obtain libraries. About 300ng of DNA were used as starting material for the NEBNext® Ultra™ II DNA Library Prep Kit for Illumina® (New England Biolabs), and libraries were prepared following the manufacturer’s instruction. Sequencing was performed with the NextSeq™ 550 sequencer (Illumina, San Diego, CA, USA) and a paired-end strategy to obtain 75-nt long reads.</p>
</sec>
<sec id="s4h">
<title>Replicas</title>
<p>The experimental workflow was repeated on two different sets of DNA libraries: Oligo1, whose results are described in the main text, and Oligo2, used as a replicate. The experimental conditions and procedures were the same for both sets of oligonucleotides, the only differences being the sequences of the fixed parts of the DNA libraries (and hence of the blockers and primers) and of the resources (Table 1). As a consequence, also the PCR conditions had to be adjusted, in terms of the annealing temperature that is one degree higher for Oligo2.</p>
</sec>
<sec id="s4i">
<title>Eco-Evolutionary algorithm</title>
<p>To support experimental observation with a simple abstract model, we developed an Evolutionary Algorithm where a population of <italic>N</italic><sub><italic>p</italic></sub> sequences evolves in presence of <italic>N</italic><sub><italic>r</italic></sub> &lt; <italic>N</italic><sub><italic>p</italic></sub> shorter sequences. In particular, <italic>N</italic><sub><italic>r</italic></sub> individuals in this population are selected at each cycle depending on their fitness, i.e. on their affinity to the resource, expressed via their <italic>ω</italic> with it. These survived sequences are then amplified by a factor of (roughly) <italic>N</italic><sub><italic>p</italic></sub>/<italic>N</italic><sub><italic>r</italic></sub>. In this work, two types of fitness functions have been explored: the first one is merely linearly proportional to the <italic>ω</italic> of each individual (i.e.<inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline1.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, where Σ<italic>ω</italic> is the sum of the <italic>ω</italic> values of the whole population), while the other one is a modification of the previous fitness which sets it to be <inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline2.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> beyond a threshold value <italic>ω</italic><sub><italic>th</italic></sub>. The code is written in C++, exploiting MPI <bold><italic><xref ref-type="bibr" rid="c29">Message Passing Interface Forum (2021)</xref></italic></bold> and Armadillo <bold><italic><xref ref-type="bibr" rid="c37">Sanderson and Curtin (2016</xref></italic></bold>, 2018) libraries for acceleration.</p>
</sec>
<sec id="s4j">
<title>NUPACK calculations</title>
<p>We resorted to NUPACK for nucleotide sequences analysis, for the prediction of their free energies at equilibrium, either alone or when binding to one or two other oligomers. Schemes like those shown in <xref rid="fig4" ref-type="fig">Figure 4</xref> have been obtained via the NUPACK web application <bold><italic><xref ref-type="bibr" rid="c48">Zadeh et al. (2011)</xref></italic></bold>, while massive Δ<italic>G</italic> calculations have been performed with custom Python codes exploiting NU-PACK Python package (v4.0.0.27) <bold><italic><xref ref-type="bibr" rid="c17">Fornace et al. (2020)</xref>; <xref ref-type="bibr" rid="c15">Dirks et al. (2007)</xref></italic></bold>. The model is dna04 and ensemble=‘some-nupack3’; <italic>T</italic> = 40?C and [<italic>Na</italic><sup>+</sup>] = 0.24 M, as in the experiments. Concentration of each species in the tube has been arbitrarily set to 10<sup>−6</sup> M. Detection of hairpins and other secondary structures has been performed visually (thanks to the oxView software <bold><italic><xref ref-type="bibr" rid="c6">Bohlin et al. (2022)</xref>; <xref ref-type="bibr" rid="c35">Poppleton et al. (2020)</xref></italic></bold>).</p>
</sec>
</sec>
<sec id="d1e1703" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e1792">
<label>Supplementary Information</label>
<media xlink:href="supplements/549992_file02.pdf"/>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>T.B. acknowledges support from MIUR-PRIN (Grant No. 2017Z55KCW). F.M. and S.S. acknowledge CloudVeneto (<ext-link ext-link-type="uri" xlink:href="http://cloudveneto.it">http://cloudveneto.it</ext-link>, <bold><italic><xref ref-type="bibr" rid="c4">Andreetto et al. (2019)</xref></italic></bold>) for the use of computing and storage facilities, through the SEDES and HPC-Physics projects.</p>
</ack>
<sec id="s5">
<title>Conflict of interest</title>
<p>The authors declare no conflict of interest.</p>
</sec>
<sec id="s6">
<title>Availability of data and materials</title>
<p>The datasets generated and analysed during the current study are available from the corresponding author on reasonable request.</p>
</sec>
<sec id="s7">
<title>Code availability</title>
<p>The Jupyter Notebooks used for the present analysis are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/francescomambretti/stat_phys_synthetic_biodiversity">https://github.com/francescomambretti/stat_phys_synthetic_biodiversity</ext-link>.</p>
</sec>
<sec id="s8">
<title>Author Contributions</title>
<p>SS, EMP and TB conceived and designed the study; LC and EMP designed protocols and performed the experiments; FM, AT and SS analyzed the data and developed the theoretical models; LC and FM performed NUPACK analysis; LC, FM, SS and TB interpreted the data and wrote the manuscript.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Adamala</surname> <given-names>K</given-names></string-name>, <string-name><surname>Szostak</surname> <given-names>JW</given-names></string-name>. <article-title>Competition between model protocells driven by an encapsulated catalyst</article-title>. <source>Nature Chemistry</source>. <year>2013</year> <month>May</month>; <volume>5</volume>(<issue>6</issue>):<fpage>495</fpage>–<lpage>501</lpage>. <pub-id pub-id-type="doi">10.1038/nchem.1650</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nchem.1650</pub-id>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>de Aguiar</surname> <given-names>MAM</given-names></string-name>, <string-name><surname>Baranger</surname> <given-names>M</given-names></string-name>, <string-name><surname>Baptestini</surname> <given-names>EM</given-names></string-name>, <string-name><surname>Kaufman</surname> <given-names>LS</given-names></string-name>, <string-name><surname>Bar-Yam</surname> <given-names>Y.</given-names></string-name> <article-title>Global patterns of speciation and diversity</article-title>. <source>Nature</source>. <year>2009</year>; <volume>460</volume>:<fpage>384</fpage>–<lpage>387</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="other"><string-name><surname>Anceschi</surname> <given-names>N</given-names></string-name>, <string-name><surname>Hidalgo</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bellini</surname> <given-names>T</given-names></string-name>, <string-name><surname>Maritan</surname> <given-names>A</given-names></string-name>, <string-name><surname>Suweis</surname> <given-names>S.</given-names></string-name> <article-title>How neutral and niche forces contribute to speciation processes</article-title>. <source>arXiv: Populations and Evolution</source>. <year>2018</year>; .</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="other"><string-name><surname>Andreetto</surname> <given-names>P</given-names></string-name>, <string-name><surname>Chiarello</surname> <given-names>F</given-names></string-name>, <string-name><surname>Costa</surname> <given-names>F</given-names></string-name>, <string-name><surname>Crescente</surname> <given-names>A</given-names></string-name>, <string-name><surname>Fantinel</surname> <given-names>S</given-names></string-name>, <string-name><surname>Fanzago</surname> <given-names>F</given-names></string-name>, <string-name><surname>Konomi</surname> <given-names>E</given-names></string-name>, <string-name><surname>Mazzon</surname> <given-names>P</given-names></string-name>, <string-name><surname>Menguzzato</surname> <given-names>M</given-names></string-name>, <string-name><surname>Segatta</surname> <given-names>M</given-names></string-name>, <string-name><surname>Sella</surname> <given-names>G</given-names></string-name>, <string-name><surname>Sgaravatto</surname> <given-names>M</given-names></string-name>, <string-name><surname>Traldi</surname> <given-names>S</given-names></string-name>, <string-name><surname>Verlato</surname> <given-names>M</given-names></string-name>, <string-name><surname>Zangrando</surname> <given-names>L.</given-names></string-name> <article-title>Merging OpenStack-based private clouds: the case of CloudVeneto.it</article-title>. <source>EPJ Web of Conferences</source>. <year>2019</year>; .</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Benedetto</surname> <given-names>D</given-names></string-name>, <string-name><surname>Caglioti</surname> <given-names>E</given-names></string-name>, <string-name><surname>Loreto</surname> <given-names>V.</given-names></string-name> <article-title>Language trees and zipping</article-title>. <source>Physical Review Letters</source>. <year>2002</year>; <volume>88</volume>(<issue>4</issue>):<fpage>048702</fpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Bohlin</surname> <given-names>J</given-names></string-name>, <string-name><surname>Matthies</surname> <given-names>M</given-names></string-name>, <string-name><surname>Poppleton</surname> <given-names>E</given-names></string-name>, <string-name><surname>Procyk</surname> <given-names>J</given-names></string-name>, <string-name><surname>Mallya</surname> <given-names>A</given-names></string-name>, <string-name><surname>Yan</surname> <given-names>H</given-names></string-name>, <string-name><surname>Šulc</surname> <given-names>P.</given-names></string-name> <article-title>Design and simulation of DNA, RNA and hybrid protein–nucleic acid nanostructures with oxView</article-title>. <source>Nature Protocols</source>. <year>2022</year> <month>Aug</month>; <volume>17</volume>(<issue>8</issue>):<fpage>1762</fpage>–<lpage>1788</lpage>. <pub-id pub-id-type="doi">10.1038/s41596-022-00688-5</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/s41596-022-00688-5</pub-id>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Camacho Mateu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sireci</surname> <given-names>M</given-names></string-name>, <string-name><surname>Muñoz</surname> <given-names>MA</given-names></string-name>. <article-title>Phenotypic-dependent variability and the emergence of tolerance in bacterial populations</article-title>. <source>PLoS computational biology</source>. <year>2021</year>; <volume>17</volume>(<issue>9</issue>):<fpage>e1009417</fpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Catalán</surname> <given-names>P</given-names></string-name>, <string-name><surname>Arias</surname> <given-names>CF</given-names></string-name>, <string-name><surname>Cuesta</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Manrubia</surname> <given-names>S.</given-names></string-name> <article-title>Adaptive multiscapes: an up-to-date metaphor to visualize molecular adaptation</article-title>. <source>Biology Direct</source>. <year>2017</year>; <volume>12</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Charalambides</surname> <given-names>CA</given-names></string-name>. <article-title>Enumerative Combinatorics</article-title>. <source>SIGACT News</source>. <year>2008</year> <month>nov</month>; <volume>39</volume>(<issue>4</issue>):<fpage>25</fpage>–<lpage>27</lpage>. <pub-id pub-id-type="doi">101145/1466390.1466395</pub-id>., doi: <pub-id pub-id-type="doi">10.1145/1466390.1466395</pub-id>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="book"><string-name><surname>Chase</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Leibold</surname> <given-names>MA</given-names></string-name>. <source>Ecological niches</source>. <publisher-name>University of Chicago Press</publisher-name>; <year>2009</year>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="book"><string-name><surname>Davis</surname> <given-names>WB.</given-names></string-name> <string-name><surname>Mayr</surname>, <given-names>Ernst.</given-names></string-name> <chapter-title>Systematics and the Origin of Species</chapter-title>. <publisher-name>Columbia University Press</publisher-name>, 334 pp., 29 figs. <source>Journal of Mammalogy</source>. <year>1943</year> 06; <volume>24</volume>(<issue>2</issue>):<fpage>273</fpage>–<lpage>274</lpage>. <pub-id pub-id-type="doi">10.2307/1374810</pub-id>, doi: <pub-id pub-id-type="doi">10.2307/1374810</pub-id>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>De Visser</surname> <given-names>JAG</given-names></string-name>, <string-name><surname>Krug</surname> <given-names>J.</given-names></string-name> <article-title>Empirical fitness landscapes and the predictability of evolution</article-title>. <source>Nature Reviews Genetics</source>. <year>2014</year>; <volume>15</volume>(<issue>7</issue>):<fpage>480</fpage>–<lpage>490</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Di Leo</surname> <given-names>S</given-names></string-name>, <string-name><surname>Marni</surname> <given-names>S</given-names></string-name>, <string-name><surname>Plata</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Fraccia</surname> <given-names>TP</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>GP</given-names></string-name>, <string-name><surname>Maritan</surname> <given-names>A</given-names></string-name>, <string-name><surname>Suweis</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bellini</surname> <given-names>T.</given-names></string-name> <article-title>Pairing statistics and melting of random DNA oligomers: Finding your partner in superdiverse environments</article-title>. <source>PLoS computational biology</source>. <year>2022</year>; <volume>18</volume>(<issue>4</issue>):<fpage>e1010051</fpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Dieckmann</surname> <given-names>U</given-names></string-name>, <string-name><surname>Doebeli</surname> <given-names>M.</given-names></string-name> <article-title>On the origin of species by sympatric speciation</article-title>. <source>Nature</source>. <year>1999</year>; <volume>400</volume>:<fpage>354</fpage>–<lpage>357</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Dirks</surname> <given-names>RM</given-names></string-name>, <string-name><surname>Bois</surname> <given-names>JS</given-names></string-name>, <string-name><surname>Schaeffer</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Winfree</surname> <given-names>E</given-names></string-name>, <string-name><surname>Pierce</surname> <given-names>NA</given-names></string-name>. <article-title>Thermodynamic Analysis of Interacting Nucleic Acid Strands</article-title>. <source>SIAM Review</source>. <year>2007</year>; <volume>49</volume>(<issue>1</issue>):<fpage>65</fpage>–<lpage>88</lpage>. <pub-id pub-id-type="doi">10.1137/060651100</pub-id>, doi: <pub-id pub-id-type="doi">10.1137/060651100</pub-id>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Ellington</surname> <given-names>AD</given-names></string-name>, <string-name><surname>Szostak</surname> <given-names>JW</given-names></string-name>. <article-title>In vitro selection of RNA molecules that bind specific ligands</article-title>. <source>Nature</source>. <year>1990</year> <month>Aug</month>; <volume>346</volume>(<issue>6287</issue>):<fpage>818</fpage>–<lpage>822</lpage>. <pub-id pub-id-type="doi">10.1038/346818a0</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/346818a0</pub-id>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Fornace</surname> <given-names>ME</given-names></string-name>, <string-name><surname>Porubsky</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Pierce</surname> <given-names>NA</given-names></string-name>. <article-title>A Unified Dynamic Programming Framework for the Analysis of Interacting Nucleic Acid Strands: Enhanced Models, Scalability, and Speed</article-title>. <source>ACS Synthetic Biology</source>. <year>2020</year>; <volume>9</volume>(<issue>10</issue>):<fpage>2665</fpage>–<lpage>2678</lpage>. <pub-id pub-id-type="doi">10.1021/acssynbio.9b00523</pub-id>, doi: <pub-id pub-id-type="doi">10.1021/acssynbio.9b00523</pub-id>, pMID: <pub-id pub-id-type="pmid">32910644</pub-id>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="other"><string-name><surname>Fussmann</surname> <given-names>GF</given-names></string-name>, <string-name><surname>Loreau</surname> <given-names>M</given-names></string-name>, <string-name><surname>Abrams</surname> <given-names>PA</given-names></string-name>. <article-title>Eco-evolutionary dynamics of communities and ecosystems</article-title>. <source>Functional ecology</source>. <year>2007</year>; p. <fpage>465</fpage>–<lpage>477</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Ghosh</surname> <given-names>S</given-names></string-name>, <string-name><surname>Takahashi</surname> <given-names>S</given-names></string-name>, <string-name><surname>Endoh</surname> <given-names>T</given-names></string-name>, <string-name><surname>Tateishi-Karimata</surname> <given-names>H</given-names></string-name>, <string-name><surname>Hazra</surname> <given-names>S</given-names></string-name>, <string-name><surname>Sugimoto</surname> <given-names>N.</given-names></string-name> <article-title>Validation of the nearest-neighbor model for Watson–Crick self-complementary DNA duplexes in molecular crowding condition</article-title>. <source>Nucleic acids research</source>. <year>2019</year>; <volume>47</volume>(<issue>7</issue>):<fpage>3284</fpage>–<lpage>3294</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Gupta</surname> <given-names>D</given-names></string-name>, <string-name><surname>Garlaschi</surname> <given-names>S</given-names></string-name>, <string-name><surname>Suweis</surname> <given-names>S</given-names></string-name>, <string-name><surname>Azaele</surname> <given-names>S</given-names></string-name>, <string-name><surname>Maritan</surname> <given-names>A.</given-names></string-name> <article-title>Effective resource competition model for species coexistence</article-title>. <source>Physical review letters</source>. <year>2021</year>; <volume>127</volume>(<issue>20</issue>):<fpage>208101</fpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Hill</surname> <given-names>MO</given-names></string-name>. <article-title>Diversity and evenness: a unifying notation and its consequences</article-title>. <source>Ecology</source>. <year>1973</year>; <volume>54</volume>(<issue>2</issue>):<fpage>427</fpage>–<lpage>432</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Ichihashi</surname> <given-names>N</given-names></string-name>, <string-name><surname>Usui</surname> <given-names>K</given-names></string-name>, <string-name><surname>Kazuta</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Sunami</surname> <given-names>T</given-names></string-name>, <string-name><surname>Matsuura</surname> <given-names>T</given-names></string-name>, <string-name><surname>Yomo</surname> <given-names>T.</given-names></string-name> <article-title>Darwinian evolution in a translation-coupled RNA replication system within a cell-like compartment</article-title>. <source>Nature Communications</source>. <year>2013</year> <month>Oct</month>; <volume>4</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.1038/ncomms3494</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/ncomms3494</pub-id>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Katla</surname> <given-names>SK</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>C</given-names></string-name>, <string-name><surname>Pérez-Mercader</surname> <given-names>J.</given-names></string-name> <article-title>Competitive exclusion principle among synthetic non-biochemical proto-cells</article-title>. <source>Cell Reports Physical Science</source>. <year>2023</year> <month>Apr</month>; <volume>4</volume>(<issue>4</issue>):<fpage>101359</fpage>. <pub-id pub-id-type="doi">10.1016/j.xcrp.2023.101359</pub-id>, doi: <pub-id pub-id-type="doi">10.1016/j.xcrp.2023.101359</pub-id>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Kauffman</surname> <given-names>WB</given-names></string-name>, <string-name><surname>Guha</surname> <given-names>S</given-names></string-name>, <string-name><surname>Wimley</surname> <given-names>WC</given-names></string-name>. <article-title>Synthetic molecular evolution of hybrid cell penetrating peptides</article-title>. <source>Nature Communications</source>. <year>2018</year> <month>Jul</month>; <volume>9</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.1038/s41467-018-04874-6</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/s41467-018-04874-6</pub-id>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Keymer</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Fuentes</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Marquet</surname> <given-names>PA</given-names></string-name>. <article-title>Diversity emerging: from competitive exclusion to neutral coexistence in ecosystems</article-title>. <source>Theoretical Ecology</source>. <year>2012</year>; <volume>5</volume>:<fpage>457</fpage>–<lpage>463</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Levin</surname> <given-names>SA</given-names></string-name>. <article-title>Community equilibria and stability, and an extension of the competitive exclusion principle</article-title>. <source>The American Naturalist</source>. <year>1970</year>; <volume>104</volume>(<issue>939</issue>):<fpage>413</fpage>–<lpage>423</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Mambretti</surname> <given-names>F</given-names></string-name>, <string-name><surname>Pedrani</surname> <given-names>N</given-names></string-name>, <string-name><surname>Casiraghi</surname> <given-names>L</given-names></string-name>, <string-name><surname>Paraboschi</surname> <given-names>EM</given-names></string-name>, <string-name><surname>Bellini</surname> <given-names>T</given-names></string-name>, <string-name><surname>Suweis</surname> <given-names>S.</given-names></string-name> <article-title>OxDNA to Study Species Interactions</article-title>. <source>Entropy</source>. <year>2022</year>; <volume>24</volume>(<issue>4</issue>). <ext-link ext-link-type="uri" xlink:href="https://www.mdpi.com/1099-4300/24/4/458">https://www.mdpi.com/1099-4300/24/4/458</ext-link>, doi: <pub-id pub-id-type="doi">10.3390/e24040458</pub-id>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Mambretti</surname> <given-names>F</given-names></string-name>, <string-name><surname>Pedrani</surname> <given-names>N</given-names></string-name>, <string-name><surname>Casiraghi</surname> <given-names>L</given-names></string-name>, <string-name><surname>Paraboschi</surname> <given-names>EM</given-names></string-name>, <string-name><surname>Bellini</surname> <given-names>T</given-names></string-name>, <string-name><surname>Suweis</surname> <given-names>S.</given-names></string-name> <article-title>OxDNA to Study Species Interactions</article-title>. <source>Entropy</source>. <year>2022</year>; <volume>24</volume>(<issue>4</issue>). <ext-link ext-link-type="uri" xlink:href="https://www.mdpi.com/1099-4300/24/4/458">https://www.mdpi.com/1099-4300/24/4/458</ext-link>, doi: <pub-id pub-id-type="doi">10.3390/e24040458</pub-id>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="web"><collab>Message Passing Interface Forum</collab>. <source>MPI: A Message-Passing Interface Standard Version 4.0</source>; <year>2021</year>, <ext-link ext-link-type="uri" xlink:href="https://www.mpi-forum.org/docs/mpi-4.0/mpi40-report.pdf">https://www.mpi-forum.org/docs/mpi-4.0/mpi40-report.pdf</ext-link>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Metropolis</surname> <given-names>N</given-names></string-name>, <string-name><surname>Rosenbluth</surname> <given-names>AW</given-names></string-name>, <string-name><surname>Rosenbluth</surname> <given-names>MN</given-names></string-name>, <string-name><surname>Teller</surname> <given-names>AH</given-names></string-name>, <string-name><surname>Teller</surname> <given-names>E.</given-names></string-name> <article-title>Equation of state calculations by fast computing machines</article-title>. <source>J Chem Phys</source>. <year>1953</year> 3; <volume>6</volume>(<issue>21</issue>). doi: <pub-id pub-id-type="doi">10.2172/4390578</pub-id>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Parrilla-Gutierrez</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Tsuda</surname> <given-names>S</given-names></string-name>, <string-name><surname>Grizou</surname> <given-names>J</given-names></string-name>, <string-name><surname>Taylor</surname> <given-names>J</given-names></string-name>, <string-name><surname>Henson</surname> <given-names>A</given-names></string-name>, <string-name><surname>Cronin</surname> <given-names>L.</given-names></string-name> <article-title>Adaptive artificial evolution of droplet protocells in a 3D-printed fluidic chemorobotic platform with configurable environments</article-title>. <source>Nature Communications</source>. <year>2017</year> <month>Oct</month>; <volume>8</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.1038/s41467-017-01161-8</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/s41467-017-01161-8</pub-id>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Peterson</surname> <given-names>AT</given-names></string-name>. <article-title>Ecological niche conservatism: A time-structured review of evidence</article-title>. <source>Journal of Biogeography</source>. <year>2011</year>; <volume>38</volume>(<issue>5</issue>):<fpage>817</fpage>–<lpage>827</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="other"><string-name><surname>Pigolotti</surname> <given-names>S</given-names></string-name>, <string-name><surname>López</surname> <given-names>C</given-names></string-name>, <string-name><surname>Hernández-García</surname> <given-names>E.</given-names></string-name> <article-title>Species clustering in competitive Lotka-Volterra models</article-title>. <source>Phys Rev Lett</source>. <year>2007</year>; doi: <pub-id pub-id-type="doi">10.1103/PhysRevLett.98.258101</pub-id>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Plata</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Marni</surname> <given-names>S</given-names></string-name>, <string-name><surname>Maritan</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bellini</surname> <given-names>T</given-names></string-name>, <string-name><surname>Suweis</surname> <given-names>S.</given-names></string-name> <article-title>Statistical physics of DNA hybridization</article-title>. <source>Physical Review E</source>. <year>2021</year>; <volume>103</volume>(<issue>4</issue>):<fpage>042503</fpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Poppleton</surname> <given-names>E</given-names></string-name>, <string-name><surname>Bohlin</surname> <given-names>J</given-names></string-name>, <string-name><surname>Matthies</surname> <given-names>M</given-names></string-name>, <string-name><surname>Sharma</surname> <given-names>S</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>F</given-names></string-name>, <string-name><surname>Šulc</surname> <given-names>P.</given-names></string-name> <article-title>Design, optimization and analysis of large DNA and RNA nanostructures through interactive visualization, editing and molecular simulation</article-title>. <source>Nucleic Acids Res</source>. <year>2020</year> <month>Jul</month>; <volume>48</volume>(<issue>12</issue>):<fpage>e72</fpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="other"><string-name><surname>Rundle</surname> <given-names>H</given-names></string-name>, <string-name><surname>Nosil</surname> <given-names>P.</given-names></string-name> <article-title>Ecological speciation - Rundle - 2005 - Ecology Letters - Wiley Online Library</article-title>. <source>Ecology letters</source>. <year>2005</year> 01; .</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Sanderson</surname> <given-names>C</given-names></string-name>, <string-name><surname>Curtin</surname> <given-names>R.</given-names></string-name> <article-title>Armadillo: a template-based C++ library for linear algebra</article-title>. <source>Journal of Open Source Software</source>. <year>2016</year>; <volume>1</volume>(<issue>2</issue>):<fpage>26</fpage>. <pub-id pub-id-type="doi">10.21105/joss.00026</pub-id>, doi: <pub-id pub-id-type="doi">10.21105/joss.00026</pub-id>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="book"><string-name><surname>Sanderson</surname> <given-names>C</given-names></string-name>, <string-name><surname>Curtin</surname> <given-names>R.</given-names></string-name> <chapter-title>A User-Friendly Hybrid Sparse Matrix Class in C++</chapter-title>. In: <person-group person-group-type="editor"><string-name><surname>Davenport</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Kauers</surname> <given-names>M</given-names></string-name>, <string-name><surname>Labahn</surname> <given-names>G</given-names></string-name>, <string-name><surname>Urban</surname> <given-names>J</given-names></string-name></person-group>, editors. <source>Mathematical Software – ICMS 2018</source> Cham: <publisher-name>Springer International Publishing</publisher-name>; <year>2018</year>. p. <fpage>422</fpage>–<lpage>430</lpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>SantaLucia</surname> <suffix>Jr</suffix> <given-names>J.</given-names></string-name> <article-title>A unified view of polymer, dumbbell, and oligonucleotide DNA nearest-neighbor thermody-namics</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1998</year>; <volume>95</volume>(<issue>4</issue>):<fpage>1460</fpage>–<lpage>1465</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="book"><string-name><surname>Solé</surname> <given-names>R</given-names></string-name>, <source>The major synthetic evolutionary transitions</source>. <publisher-name>The Royal Society</publisher-name>; <year>2016</year>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Thurner</surname> <given-names>S</given-names></string-name>, <string-name><surname>Hanel</surname> <given-names>R</given-names></string-name>, <string-name><surname>Klimek</surname> <given-names>P.</given-names></string-name> <article-title>Physics of evolution: Selection without fitness</article-title>. <source>Physica A: Statistical Mechanics and its Applications</source>. <year>2010</year>; <volume>389</volume>(<issue>4</issue>):<fpage>747</fpage>–<lpage>753</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Tizei</surname> <given-names>PAG</given-names></string-name>, <string-name><surname>Csibra</surname> <given-names>E</given-names></string-name>, <string-name><surname>Torres</surname> <given-names>L</given-names></string-name>, <string-name><surname>Pinheiro</surname> <given-names>VB</given-names></string-name>. <article-title>Selection platforms for directed evolution in synthetic biology</article-title>. <source>Biochemical Society Transactions</source>. <year>2016</year> <month>Aug</month>; <volume>44</volume>(<issue>4</issue>):<fpage>1165</fpage>–<lpage>1175</lpage>. <pub-id pub-id-type="doi">10.1042/bst20160076</pub-id>, doi: <pub-id pub-id-type="doi">10.1042/bst20160076</pub-id>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Tolle</surname> <given-names>F</given-names></string-name>, <string-name><surname>Wilke</surname> <given-names>J</given-names></string-name>, <string-name><surname>Wengel</surname> <given-names>J</given-names></string-name>, <string-name><surname>Mayer</surname> <given-names>G.</given-names></string-name> <article-title>By-product formation in repetitive PCR amplification of DNA libraries during SELEX</article-title>. <source>PloS one</source>. <year>2014</year>; <volume>9</volume>(<issue>12</issue>):<fpage>e114693</fpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Tuerk</surname> <given-names>C</given-names></string-name>, <string-name><surname>Gold</surname> <given-names>L.</given-names></string-name> <article-title>Systematic Evolution of Ligands by Exponential Enrichment: RNA Ligands to Bacteriophage T4 DNA Polymerase</article-title>. <source>Science</source>. <year>1990</year>; <volume>249</volume>(<issue>4968</issue>):<fpage>505</fpage>–<lpage>510</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.science.org/doi/abs/10.1126/science.2200121">https://www.science.org/doi/abs/10.1126/science.2200121</ext-link>, doi: <pub-id pub-id-type="doi">10.1126/science.2200121</pub-id>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Vetsigian</surname> <given-names>K.</given-names></string-name> <article-title>Diverse modes of eco-evolutionary dynamics in communities of antibiotic-producing microorganisms</article-title>. <source>Nature Ecology &amp; Evolution</source>. <year>2017</year>; <volume>1</volume>(<issue>7</issue>):<fpage>0189</fpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Wiser</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Lenski</surname> <given-names>RE</given-names></string-name>. <article-title>A comparison of methods to measure fitness in Escherichia coli</article-title>. <source>PloS one</source>. <year>2015</year>; <volume>10</volume>(<issue>5</issue>):<fpage>e0126210</fpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Woodside</surname> <given-names>MT</given-names></string-name>, <string-name><surname>Behnke-Parks</surname> <given-names>WM</given-names></string-name>, <string-name><surname>Larizadeh</surname> <given-names>K</given-names></string-name>, <string-name><surname>Travers</surname> <given-names>K</given-names></string-name>, <string-name><surname>Herschlag</surname> <given-names>D</given-names></string-name>, <string-name><surname>Block</surname> <given-names>SM</given-names></string-name>. <article-title>Nanomechanical measure-ments of the sequence-dependent folding landscapes of single nucleic acid hairpins</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2006</year>; <volume>103</volume>(<issue>16</issue>):<fpage>6190</fpage>–<lpage>6195</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Zadeh</surname> <given-names>JN</given-names></string-name>, <string-name><surname>Steenberg</surname> <given-names>CD</given-names></string-name>, <string-name><surname>Bois</surname> <given-names>JS</given-names></string-name>, <string-name><surname>Wolfe</surname> <given-names>BR</given-names></string-name>, <string-name><surname>Pierce</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Khan</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Dirks</surname> <given-names>RM</given-names></string-name>, <string-name><surname>Pierce</surname> <given-names>NA</given-names></string-name>. <article-title>NUPACK: Analysis and design of nucleic acid systems</article-title>. <source>J Comput Chem</source>. <year>2011</year> <month>Jan</month>; <volume>32</volume>(<issue>1</issue>):<fpage>170</fpage>–<lpage>173</lpage>.</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<label>Appendix 1</label>
<title>Data analysis protocol</title>
<p>Since we performed a paired-end sequencing, for each experimental cycle two FASTQ files were generated (R1 and R2).</p>
<p>The data shown in the paper all come from the cumulative analysis of R1 and R2 files. To analyze such files, we have developed an ad-hoc package (in Python and C++), currently maintained at <ext-link ext-link-type="uri" xlink:href="https://github.com/francescomambretti/stat_phys_synthetic_biodiversity">https://github.com/francescomambretti/stat_phys_synthetic_biodiversity</ext-link>. Here follows a scheme of the main steps of the analysis:</p>
<list list-type="order">
<list-item><p>Read FASTQ file, extracting the list of single-stranded DNA (ssDNA) sequences. Reverse sequences are reverted and complemented, so to have all the sequences oriented as 5<sup>′</sup> → 3<sup>′</sup>. Fixed sequences at the ends are removed in this way: if the full blocker is present, then the 50 bases after it are retained. If some of the last bases of the blocker are lost (it may happen), then just remove the primer and keep the subsequent 50 bases. Slightly different choices for this cut of the sequences turned out to be substantially irrelevant for all the results.</p></list-item>
<list-item><p>Each sequence can be either saved or discarded, according to some filtering procedure. Criteria include the minimum quality of the read (≥ 10, measured according to the <italic>Phred</italic> score), the minimum and maximum allowed length, the presence of invalid nucleotides (indicated by ‘N’ in the FASTQ file) and other checks (see below in particular for PCR by-products).</p></list-item>
<list-item><p>The ‘survived’ sequences are processed, computing the related observables. Unique sequences are identified and their degeneracy is computed. This allows to monitor the time evolution of the abundance of each species (where the equivalence: DNA sequence-species holds).</p></list-item>
<list-item><p>For each of these unique ssDNAs, we compute the indicators quantifying the ‘affinity’ with the target sequence: in particular, the maximum consecutive overlap (MCO) and eventually the binding free energy with the resource and/or other oligomers.</p></list-item>
<list-item><p>Several post-processing options are available, such as: generating histograms of the ssDNA population based on their affinity with the resource; tracking the time evolution of dominant strands; determining the fraction of the total population covered by the <italic>n</italic> most abundant strands. All these quantities can be plotted by suitable Python scripts, provided in the GitHub repository.</p></list-item>
</list>
<sec id="s9">
<title>By-Product Formation from PCR Amplification</title>
<p>During the amplification phase, described in our workflow, we observed the formation of PCR by-products. This phenomenon is known in SELEX systems, especially when an oligonucleotide library characterized by high heterogeneity is PCR-amplified <bold><italic><xref ref-type="bibr" rid="c43">Tolle et al. (2014)</xref></italic></bold>. The generation of these by-products is caused by unspecific hybridization of the primers and/or of oligonucleotides, leading to PCR products abnormal in terms of length and distribution of random/fixed sequences. To limit this phenomenon we adopted blocker oligos with a phosphate group at 3’, so that they do not act as primers, and a stringent PCR protocol, characterized by: i) a high annealing temperature, ii) fewer PCR cycles, iii) a high primer concentration, iv) a very short elongation step (1s). Moreover, during the data analysis step, we developed an algorithm to identify and remove these spurious sequences.</p>
<p>PCR by-products are identified among the sequenced oligomers according to the following criteria:</p>
<list list-type="bullet">
<list-item><p>if either the sequence (after the cut of the blocker as previously described) contains at least <italic>n</italic> consecutive bases identical to <italic>n</italic> of the 5<sup>′</sup> blocker (i.e. an <italic>n</italic>-long MCO with a subsequence of the Primer1-F)</p></list-item>
<list-item><p>or it has at least <italic>n</italic> consecutive bases identical to <italic>n</italic> of the 3<sup>′</sup> blocker then this sequence is considered as a by-product and excluded from the analysis.</p></list-item>
</list>
<p>Figure 2-figure supplement 1a shows how such unwanted sequences become ≈ 30% of the total sampled population at cycle 15 and then the striking majority (&gt; 95%) in the last cycle, setting <italic>de facto</italic> an upper limit to the number of feasible experimental cycles. On the other hand, as we can see from Figure 2-figure supplement 1b, the behaviour of ⟨<italic>ω</italic>⟩ for the by-products is very similar to the one observed considering only regular oligomers, therefore their presence does not affect the main outcome of the experiment.</p>
<p>In Figure 2-figure supplement 2 the <italic>P</italic> (<italic>ω</italic>) for the first and last cycle of only the by-products of Oligo 1 are displayed and compared with the null model prediction. The main evolutive trend is also present in these sequences, which have however been discarded from all the analyses.</p>
</sec>
</app>
<app id="app2">
<label>Appendix 2</label>
<title>Further analyses of the Eco-Evolutionary Model</title>
<p>We here show some further results and sensitivity analyses of the Eco-Evolutionary stochastic individual based model. In Figure 2-figure supplement 5 we show how the eco-evolutionary model can describe the emergent order and complexity, that is a loss of the initial huge diversity of the random strings towards few dominating species, during evolution. This behaviour can be quantified 1) by the ratio CR between the zipped file size <bold><italic><xref ref-type="bibr" rid="c5">Benedetto et al. (2002)</xref></italic></bold> and the original file size of all the sequences oligomers in the ecosystem or 2) by computing the Shannon entropy of the Relative Species Abundance <bold><italic><xref ref-type="bibr" rid="c21">Hill (1973)</xref></italic></bold>. We can see that that the model is able to reproduce, at least qualitatively, the marked decrease of diversity observed during evolution.</p>
<p>In Figure 2-figure supplement 6a we show the outcome of the model if we do not include the saturation at <italic>ω</italic><sub><italic>th</italic></sub> = 10. As we can see, the effect is evident as after a few cycles the experimental ⟨ <italic>ω</italic>⟩ lies significantly under the model (which promotes too much the strongest sequences). Similarly, Figure 2-figure supplement 6b shows the evolution for the average MCO in the case we use only <italic>γ</italic> = 1 in the simulation (here, <italic>ω</italic><sub><italic>sat</italic></sub> = 11). It is very apparent how in this case the simulated initial evolution is much slower with respect to the observed from the data, while the final trend is captured. These results indicate that both saturation and the non-linear fitness time dependent fitness function are fundamental ingredients to describe the empirical evolution of ⟨ <italic>ω</italic>⟩. Note that in both cases of the above picture, there is a 10% random sampling drift.</p>
<p>Finally, Figure 2-figure supplement 7a and Figure 2-figure supplement 7b show the simulations results for different total number of individuals (<italic>N</italic> = 10<sup>6</sup>, 10<sup>5</sup> and 10<sup>4</sup>) and resources (<italic>R</italic> = <italic>N</italic>/100, keeping this ratio fixed) and for different initial conditions (i.e., different sequences populations), respectively. We can see that the qualitative results concerning ⟨<italic>ω</italic>⟩ as a function of time are robust, beyond a given system’s size (the silver data in Figure 2-figure supplement 7a are already of a system’s size large enough, while the blue ones correspond to a too small system). Considering a different initial (random) population of sequences, keeping fixed all the other hyperparameters (in particular <italic>N</italic> = 10<sup>6</sup> and <italic>R</italic> = 1064), as shown by Figure 2-figure supplement 7b preserves the qualitative agreement with the experimental data, assessing the substantial independence on the initial conditions. Overall, these further analyses show the robustness of the qualitative behavior of results of the Eco-Evolutionary model, pointing out to two relevant phases of the evolution of the oligomers, as highlighted in the main text.</p>
<sec id="s10">
<title>Further results on the interactions between oligomers</title>
<p>In this section we highlight some further results on the interactions between species and resources and among oligemers, respectively.</p>
<p>Figure 4-figure supplement 1 shows the average pair-wise interactions between 10 random strings (as representative of the whole population) during the different evolutionary cycles (<italic>t</italic> = 0, 9, 18, 24), ⟨Δ<italic>G</italic><sub><italic>pp</italic></sub>⟩. Such averages have been computed by giving to NUPACK a pool of 1000 sequences, randomly subdivided in 100 groups of 10 sequences each. We can see that, during evolution, the selected oligomers increase their average interaction strength, a signature that the evolution favors not only strings that have higher overlap with the resource, but also that interact in some way with the other species.</p>
<p>Figure 4-figure supplement 2 is the 2D probability distribution <italic>p</italic>(<italic>ω, x</italic><sub><italic>R</italic></sub>), computed from experimental data, to simultaneously have a given MCO= <italic>ω</italic> and <italic>x</italic><sub><italic>R</italic></sub>, the rightmost basis of the of the resource involved in the formation of such an MCO. Noticeably, we start from a distribution peaked in <italic>ω</italic> = 4 and 10 ≤ <italic>x</italic><sub><italic>R</italic></sub> ≤ 12, essentially corresponding to purely random binding. Across cycles, the probability distribution is deeply modified, with a shift towards the bottom right corner. Along the horizontal axis this simply reflects the shift in the average ⟨ <italic>ω</italic>⟩ of the population, and also the fact that winners have large overlaps. Interestingly, we observe a significant shift of <italic>x</italic><sub><italic>R</italic></sub> towards high values, meaning the MCO are preferably formed far away from the bead surface, near the free end of target strands.</p>
</sec>
<sec id="s11">
<title>Results of the experimental replica</title>
<p>In Figure 2-figure supplement 3 and Figure 2-figure supplement 4 show the main outcomes of the replica experiment Oligo2. The evolution of the average MCO ⟨ <italic>ω</italic> ⟩over cycles is qualitatively the same of that one found in Oligo1: we have a initial steep grow ⟨ <italic>ω</italic> ⟩, compatible with a non linear fitness, and then we observe a slower increase for the last cycles, saturating for ⟨ <italic>ω</italic> ⟩ ≈ 7. The histogram shows the whole <italic>p</italic>(<italic>ω</italic>) at cycles <italic>t</italic> = 0 and <italic>t</italic> = 18. As for what we found in Oligo1, at <italic>t</italic> = 0 the behaviour of <italic>p</italic>(<italic>ω</italic>) is compatible with our null random model, while at <italic>t</italic> = 18 the oligomers with higher <italic>ω</italic> are selected, and the tail of <italic>p</italic>(<italic>ω</italic>) is fatter than the one expected by chance.</p>
<p>These results show that indeed the main outcome of Oligo1 are replicated by Oligo2.</p>
</sec>
</app>
<app id="app3">
<label>Appendix 3</label>
<title>A combinatorial null model with no evolution</title>
<p>As a first step to understand what happens in our experiments, we have built a null model, assuming purely random attachment sites, i.e. there is not any search for the relative positions of binding filaments so to maximize the MCO. In this way we have a null expectation for the typical MCO distribution in case of oligomers insensitive to the presence of target sequences.</p>
<p>Let us call <italic>a</italic> the number of consecutive bonded pairs between oligomers 1 (e.g. the species) and 2 (e.g. the resource), with <inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline3.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> and <italic>R</italic><sub>1,2</sub> being the relative position of the left ends of the two filaments, as also explained in <bold><italic>Mambretti et al. (2022b)</italic></bold> and in the main text. Consider the initial population being uniformly random selected (in the high 4<sup><italic>L</italic></sup> dimensional space of all possible DNA strands). The first quantity we are interested to calculate is <italic>π</italic>(<italic>a</italic>), the <italic>probability density of a</italic> at time <italic>t</italic> = 0, i.e. before the evolution starts. This distribution is also the distribution of the subsample (i.e, the ≈ 10<sup>6</sup> strands which we are able to sequence at each cycle), if we assume purely random attachment (no competition among the consumers, no optimization of the attachment site).</p>
<p>The relative position of the two strands is important since the target can be either “inside” (Figure 3-figure supplement 1, panel a)) or surpassing one of the borders (Figure 3-figure supplement 1, panel b) and C)) of the longer oligomer after the attachment. In the picture, <italic>R</italic><sub>1,2</sub> = 0 when the first nucleotide of the target overlaps with the first one of the consumer. From now on, we will refer to <italic>R</italic><sub>1,2</sub> simply as <italic>R</italic>.</p>
<p>Our goal consists in finding the MCO of <italic>L</italic>-long strand (the species) with a <italic>l</italic>-long target ssDNA (the resource), where <italic>l</italic> &lt; <italic>L</italic>. In the following calculations, we therefore assume that <italic>R</italic> is a random uniform variable (−<italic>l</italic> + 1 ≤ <italic>r</italic> ≤ <italic>L</italic> − 1) and we will calculate <italic>a</italic>| <sub><italic>R</italic></sub> (for this <italic>R</italic>).</p>
<p>Such a problem is sketched in Figure 3-figure supplement 2 (where <italic>R</italic> = 2, but the following holds for any <italic>R</italic> in the allowed range), where we indicate with <italic>d</italic> the number of mismatching bases between the target (red) and the consumer (blue), with <italic>u</italic> the number of matching ones, being <italic>d</italic> + <italic>u</italic> := <italic>l</italic>. Labeling as <italic>x</italic><sub><italic>i</italic></sub> the number of consecutive matching nucleotides comprised between two consecutive mismatching bases, as shown in the picture, the problem can be reformulated in terms of counting how many integer solutions can be found for the equation:
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="549992v1_eqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
that corresponds to determine the number of ways in which a set of <italic>x</italic><sub><italic>i</italic></sub> solving <xref ref-type="disp-formula" rid="eqn1">Eq. 1</xref> can be obtained. Note that <italic>x</italic><sub><italic>i</italic></sub> vanishes between two neighboring pairs of mismatching sites, as marked by the arrows in the picture. In the case reported in the picture, e.g., <italic>x</italic><sub><italic>i</italic></sub> = (1, 0, 1, 4, 0, 4, 0, 0, 2) and <inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline4.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>and <italic>d</italic> = 8.</p>
<p>Ref. <bold><italic><xref ref-type="bibr" rid="c9">Charalambides (2008)</xref></italic></bold> provides us with a formula to answer this question. We stress that finding the number of solutions <italic>A</italic><sub><italic>d,u</italic></sub> for the above equation is equivalent to obtaining the probability distribution <italic>π</italic>(<italic>a</italic>) for the relative occurrence of each <italic>a</italic> in a sample of DNA strands, with uniformly random extracted relative positions of the two sequences.</p>
<statement id="the1">
<label>Theorem 1.</label>
<p><italic>Let us have the equation</italic> <inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline5.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. <italic>Let us suppose that s</italic><sub><italic>i</italic></sub> ≤ <italic>x</italic><sub><italic>i</italic></sub> ≤ <italic>m</italic><sub><italic>i</italic></sub>, ∀<italic>i</italic> = 1, …, <italic>n for given integers s</italic><sub><italic>i</italic></sub>, <italic>m</italic><sub><italic>i</italic></sub>, <italic>i</italic> = 1, …, <italic>n with s</italic> ≤ <italic>u</italic> ≤ <italic>m, being</italic> <inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline6.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> <italic>and</italic> <inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline7.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. <italic>Let us define w</italic><sub><italic>i</italic></sub> = <italic>m</italic><sub><italic>i</italic></sub> − <italic>s</italic><sub><italic>i</italic></sub> ≥ 0 ∀<italic>i. The number of integer solutions, having the shape</italic> (<italic>r</italic><sub>1</sub>, …, <italic>r</italic><sub><italic>n</italic></sub>), <italic>of this equation, with the restrictions aforementioned, is given by:</italic>
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="549992v1_eqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where the inner sum is performed over all the <italic>r</italic>−combinations (having the shape {<italic>i</italic><sub>1</sub>, <italic>i</italic><sub>2</sub>, …, <italic>i</italic><sub><italic>r</italic></sub>}) of the <italic>n</italic> indices 1, …, <italic>n</italic>.</p></statement>
<p>In our case the target string may not go beyond the consumer species boundaries (as the latter is longer than the former). But we can modify the name of some variables to adapt the theorem to our problem and make some constraints explicit:</p>
<list list-type="bullet">
<list-item><p>from <italic>i</italic> = 1, …, <italic>n</italic> it follows that <italic>n</italic> = <italic>d</italic> + 1 because we have <italic>d</italic> + 1 terms (from 0 to <italic>d</italic>).</p></list-item>
<list-item><p><italic>s</italic><sub><italic>i</italic></sub> = 0 ∀<italic>i</italic>, because each <italic>x</italic><sub><italic>i</italic></sub> ≥ 0 by definition. Therefore, <italic>s</italic> = 0.</p></list-item>
<list-item><p>at least one of the <italic>x</italic><sub><italic>i</italic></sub> must be equal to <italic>a</italic></p></list-item>
<list-item><p>in principle, <italic>m</italic><sub><italic>i</italic></sub> is equal to <italic>a</italic> for each <italic>i</italic> (which means that there are no consecutive overlaps larger than <italic>a</italic>).</p></list-item>
<list-item><p>it must be that <italic>a</italic> ≤ <italic>u</italic> ≤ min((<italic>d</italic> + 1)<italic>a, l</italic>) (i.e. the total overlap <italic>u</italic> - which, at most is equal to <italic>d</italic> + 1 times <italic>a</italic> - must not be larger than <italic>l</italic>)</p></list-item>
</list>
<p>In fact, by using that <italic>s</italic> = 0 and <italic>d</italic> + <italic>u</italic> = <italic>l</italic>, the theorem <xref ref-type="disp-formula" rid="eqn2">Eq. 2</xref> can be rewritten as:
<disp-formula id="ueqn2">
<alternatives><graphic xlink:href="549992v1_ueqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where the inner sum can be replaced by<inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline8.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>(how many ways are there to dispose the <italic>d</italic> +1 integer indexes to form <italic>r</italic> groups):
<disp-formula id="ueqn3">
<alternatives><graphic xlink:href="549992v1_ueqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
First of all, <inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline9.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>can be placed inside the summation because it corresponds to the = 0 case. Now, we have to apply the constraint that at least one of the <italic>w</italic><sub><italic>j</italic></sub> = <italic>a</italic>, which means having the first term where the <italic>w</italic><sub><italic>j</italic></sub> are always equal to <italic>a</italic>, minus the second term which includes all the cases where all the <italic>w</italic><sub><italic>j</italic></sub> &lt; <italic>a</italic>:
<disp-formula id="ueqn4">
<alternatives><graphic xlink:href="549992v1_ueqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Note that the previous expressions concern only the cases where 0 ≤ <italic>R</italic> ≤ <italic>L</italic> − <italic>l</italic>. However, this should not matter for practical purposes because <italic>R</italic> does not appear in the above expressions.</p>
<p>Similar formulas can be found when the target surpasses the left/right border:</p>
<p>if − <italic>l</italic> + 1 ≤ <italic>R</italic> ≤ −1
<disp-formula id="ueqn5">
<alternatives><graphic xlink:href="549992v1_ueqn5.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
while if <italic>L</italic> − <italic>l</italic> ≤ <italic>R</italic> ≤ <italic>L</italic> – 1
<disp-formula id="ueqn6">
<alternatives><graphic xlink:href="549992v1_ueqn6.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Using all the previous results, the general equation for the number of ways which lead to a MCO <italic>a</italic> is given by:
<disp-formula id="eqn3">
<alternatives><graphic xlink:href="549992v1_eqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where the 3 options are originated by the 3 options for the relative position of the target and of the consumer sketched in Figure 3 - figure supplement 1.</p>
<p>Let us now derive <italic>n</italic><sub><italic>k</italic></sub>, ∀<italic>k</italic>. In particular, if the target “resource” is completely within the “consumer” species boundaries, then we have
<disp-formula id="eqn4">
<alternatives><graphic xlink:href="549992v1_eqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
with (<italic>L</italic>− <italic>l</italic> + 1) is the total number of possible positions <italic>R</italic> where the consumer can attach to the resource, 4<sup><italic>L</italic></sup> is the number of ways to build a <italic>L</italic>-long string (i.e. all possible species), 3<sup><italic>d</italic></sup> represents the number of arrangements for the non-matching bases (3 is because we exclude the only matching base) and <inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline10.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula></p>
<p>Analogously,
<disp-formula id="eqn5">
<alternatives><graphic xlink:href="549992v1_eqn5.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where the summations run over the admitted integer <italic>R</italic> values as well as over the allowed <italic>d</italic> values. In this case, 4<sup><italic>L</italic>−<italic>l</italic>−<italic>R</italic></sup> is the number of ways in which the nucleotides not involved in the attachment can be obtained. Here<inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline11.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>.A similar equation holds for <italic>n</italic><sub>3</sub>(<italic>a</italic>), where
<disp-formula id="ueqn7">
<alternatives><graphic xlink:href="549992v1_ueqn7.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
and <inline-formula><alternatives><inline-graphic xlink:href="549992v1_inline12.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>.</p>
<p>To get the distribution of the overlap measure <italic>π</italic>(<italic>a</italic>), it suffices to divide <italic>n</italic>(<italic>a, R</italic>) by the total number of ways in which we can build a string, i.e. 4<sup><italic>L</italic></sup> times the number of possible positions <italic>R</italic> where the attachment can happen, i.e. <italic>L</italic> + <italic>l</italic> − 1.
<disp-formula id="eqn6">
<alternatives><graphic xlink:href="549992v1_eqn6.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<italic>π</italic>(<italic>a</italic>) is exactly the probability density to find a given MCO= <italic>a</italic> between a <italic>l</italic>-long and a <italic>L</italic>-long sequence which found themselves attached in a random position <italic>R</italic>.</p>
<p>The underlying probability distribution <italic>π</italic>(<italic>a</italic>) is naturally discretized and can be represented as an histogram, with the occupancy probability for each bin <italic>a</italic> (the affinity to the resource). <italic>π</italic>(<italic>a</italic>) is represented in Figure 3-figure supplement 3a as orange bars; grey bars in the same panel represent the average of 50 independent simulations with <italic>K</italic> = 10<sup>6</sup> 50-mers uniformly generated, where their overlap with the target strand - once uniformly random extracted their relative position - is measured.</p>
<p>The analytical result for the null model and simulations yield almost exactly the same results, with the difference that for large MCO we have strong sampling effect in the simulations. In order to understand how possible biases in the initial frequency of each nucleotide in the starting population, we run <italic>N</italic> = 50 independent simulations with a non-uniform frequency for A,C,G,T in the sequences. For instance, the panel <bold>b)</bold> of Figure 3-figure supplement 3 compares the <italic>π</italic>(<italic>a</italic>) obtained with A,C,G,T having a probability of 25% (grey data) with the corresponding distribution obtained having: A=23%, C=19%, G=29%, T=29%. The average bin occupancy does not change significantly, but only the large <italic>a</italic> tails are slightly affected by the bias and the error-bars are much larger for the majority of the <italic>a</italic> values.</p>
<p>We furthermore set a threshold <italic>T</italic> to model the physical constraint that if <italic>a</italic> &lt; <italic>T</italic>, the two ssDNAs cannot bind. We thus obtain a <bold>null model physically constrained</bold> distribution <italic>π</italic><sup>′</sup>(<italic>a</italic>), where <italic>π</italic><sup>′</sup>(<italic>a</italic>) = 0 if <italic>a</italic> &lt; <italic>T</italic>, while is the same as before (after a proper normalization) for <italic>a</italic> ≥ <italic>T</italic>. The new analytical distribution <italic>π</italic><sup>′</sup>(<italic>a</italic>) reads as
<disp-formula id="eqn7">
<alternatives><graphic xlink:href="549992v1_eqn7.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where sgn(0) := 0. The corresponding pseudo-algorithm to generate random number from such distribution is</p>
<list list-type="bullet">
<list-item><p>sample a random number <italic>z</italic> from <italic>π</italic>(<italic>a</italic>)</p></list-item>
<list-item><p>if <italic>z</italic> &lt; <italic>T</italic>, sample another number from <italic>π</italic>(<italic>a</italic>)</p></list-item>
<list-item><p>else, save it in the new distribution <italic>π</italic><sup>′</sup>(<italic>a</italic>)</p></list-item>
</list>
<p>The comparison between analytical and numerical results are reported in Figure 3-figure supplement 4a and Figure 3-figure supplement 4b (linear and logarithmic scale on <italic>y</italic> axis, respectively). The cyan bars correspond to the analytical distribution for the null model with physical constraint (<italic>π</italic><sup>′</sup>(<italic>a</italic>)), whereas the purple bars represented the average over <italic>N</italic> = 200 independent simulations of <italic>π</italic><sup>′</sup>(<italic>a</italic>) performed via Metropolis Monte Carlo accept-reject technique <bold><italic><xref ref-type="bibr" rid="c30">Metropolis et al. (1953)</xref></italic></bold>. A custom Python script which simulates this process is available at the GitHub repository associated to this work. The null model that we present in the main text is the physical constraint one, i.e. <italic>π</italic><sup>′</sup>(<italic>a</italic>).</p>
</app>
</app-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90156.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Bitbol</surname>
<given-names>Anne-Florence</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution>
</institution-wrap>
<city>Lausanne</city>
<country>Switzerland</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>In this <bold>important</bold> study, the authors develop a promising experimental approach to a central question in ecology: What are the contributions of resource use and interactions in the shaping of an ecosystem? For this, they develop a synthetic ecosystem set-up, a variant of SELEX that allows very detailed control over ecological variables. The evidence is <bold>convincing</bold>, and the work should be of broad interest to the ecology community, leading to further quantitative studies.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90156.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This work describes a new and powerful approach to a central question in ecology: what are the relative contributions of resource utilisation vs interactions between individuals in the shaping of an ecosystem? This approach relies on a very original quantitative experimental set-up whose power lies in its simplicity, allowing an exceptional level of control over ecological parameters and of measurement accuracy.</p>
<p>In this experimental system, the shared resource corresponds to 10^12 copies of a fixed single-stranded target DNA molecule to which 10^15 random single-stranded DNA molecules (the individuals populating the ecosystem) can bind. The binding process is cycled, with a 1000x-PCR amplification step between successive binding steps. The composition of the population is monitored via high-throughput DNA sequencing. Sequence data analysis describes the change in population diversity over cycles. The results are interpreted using estimated binding interactions of individuals with the target resource, as well as estimated binding interactions between individuals and also self-interactions (that can all be directly predicted as they correspond to DNA-DNA interactions). A simple model provides a framework to account for ecosystem dynamics over cycles. Finally, the trajectory of some individuals with high frequency in late cycles is traced back to the earliest cycles at which they are detected by sequencing. Their propensities to bind the resource, to form hairpins, or to form homodimers suggest how different interaction modes shape the composition of the population over cycles.</p>
<p>The authors report a shift from selection for binding to the resource to interactions between individuals and self-interactions over the course of cycles as the main drivers of their ecosystem. The outcome of the experiment is far from trivial as the individual-resource binding energy initially determines the relative enrichment of individuals, and then seems to saturate. The richness of the population dynamics observed with this simple system is thus comparable to that found in some natural ecosystems. The findings obtained with this new approach will likely guide the exploration of natural ecosystems in which parameters and observables are much less accessible.</p>
<p>My review focuses mainly on the experimental aspects of this work given my own expertise. The introduction exposes very convincingly the scientific context of this work, justifying the need for such an approach to address questions pertaining to ecology. The manuscript describes very clearly and rigorously the experimental set-up. The main strengths of this work are (i) the outstanding originality of the experimental approach and (ii) its simplicity. With this setup, central questions in ecology can be addressed in a quantitative manner, including the possibility of running trajectories in parallel to generalize the findings, as reported here. Technical aspects have been carefully implemented, from the design of random individuals bearing flanking regions for PCR amplification, binding selection and (low error) amplification protocols, and sequencing read-out whose depth is sufficient to capture the relevant dynamics. One missing aspect in the data analysis is the quantification of the effect of PCR amplification steps in shaping the ecosystem (to be modeled if significant). In addition, as it stands the current work does not fully harness the power of the approach. For instance, with this setup, one can tune the relative contributions of binding selection vs amplification for instance (to disentangle forces that shape the ecosystem). One can also run cycles with new DNA individuals, designed with arbitrarily chosen resource binding vs self-binding, that are predicted to dominate depending on chosen ecological parameters.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90156.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
In this manuscript, the authors introduced ADSE, a SELEX-based protocol to explore the mechanism of emergency of species. They used DNA hybridization (to the bait pool, &quot;resources&quot;) as the driving force for selection and quantitatively investigated the factors that may contribute to the survival during generation evolution (progress of SELEX cycle), revealing that besides individual-resource binding, the inter- and intra-individual interactions were also important features along with mutualism and parasitism.</p>
<p>Strengths:</p>
<p>
The design of using pure biochemical affinity assay to study eco-evolution is interesting, providing an important viewpoint to partly explain the molecular mechanism of evolution.</p>
<p>Weaknesses:</p>
<p>
Though the evidence of the study is somewhat convincing, some aspects still need to be improved, mostly technical issues.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90156.1.sa0</article-id>
<title-group>
<article-title>Author Response</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Casiraghi</surname>
<given-names>Luca</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Mambretti</surname>
<given-names>Francesco</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3712-3595</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Tovo</surname>
<given-names>Anna</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Paraboschi</surname>
<given-names>Elvezia Maria</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Suweis</surname>
<given-names>Samir</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1603-8375</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Bellini</surname>
<given-names>Tommaso</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>We thank the reviewers for their work, their careful reading of our manuscript, their appreciative evaluation and their comments and suggestions, which we will consider to ameliorate the paper.</p>
<p>For now, we anticipate two short considerations.</p>
<p>We agree that the PCR step in the ADSE evolutive process might introduce a bias in the population and that such effect should be better examined. We have in fact started performing new experiments, among which ADSE evolution cycles without resources. From the elements we currently have, we see the PCR bias effect as minor, not making a significant difference in the emergence and interaction of species we have reported.</p>
<p>ADSE protocol is markedly simpler than any other evolution protocol based on even the most basic cellular processes. However, many are the experimental parameters which can be changed in ADSE: initial DNAi population (level of randomness vs. combination of designed sequences), resource structure (resource sequence and length, bead-resource linker length and type), capture condition (length and concentration of DNAi, pH, temperature, bead density), amplification step (choice of polymerase and rate of mutation, length of primers, thermal protocol). The availability of these parameters is a strength of ASDE, making possible exploring a large variety of evolution condition and to introduce kinetic drifts (e.g. in the resources). At the same time, the variety of parameters prompted us to make choices as discussed in the article and to stick to them in all our experiments. The exploration of the many variants that can be considered, some of them very interesting, and some of which proposed by the reviewers, would require an important experimental work that we are planning to conduct for a few among these possibilities, to be part of future publications.</p>
</body>
</sub-article>
</article>