<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">94961</article-id>
<article-id pub-id-type="doi">10.7554/eLife.94961</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.94961.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Effects of noise and metabolic cost on cortical task representations</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4263-5755</contrib-id>
<name>
<surname>Stroud</surname>
<given-names>Jake P.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">@</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3254-8519</contrib-id>
<name>
<surname>Wójcik</surname>
<given-names>Michał</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9242-5572</contrib-id>
<name>
<surname>Jensen</surname>
<given-names>Kristopher T.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kusunoki</surname>
<given-names>Makoto</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kadohisa</surname>
<given-names>Mikiko</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Buckley</surname>
<given-names>Mark J.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9695-2764</contrib-id>
<name>
<surname>Duncan</surname>
<given-names>John</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Stokes</surname>
<given-names>Mark G.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7266-0049</contrib-id>
<name>
<surname>Lengyel</surname>
<given-names>Máté</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Computational and Biological Learning Lab, Department of Engineering, University of Cambridge</institution>, Cambridge, <country>UK</country></aff>
<aff id="a2"><label>2</label><institution>Department of Experimental Psychology, University of Oxford</institution>, Oxford, <country>UK</country></aff>
<aff id="a3"><label>3</label><institution>MRC Cognition And Brain Sciences Unit, University of Cambridge</institution>, Cambridge, <country>UK</country></aff>
<aff id="a4"><label>4</label><institution>Oxford Centre for Human Brain Activity, Wellcome Centre for Integrative Neuroimaging, Department of Psychiatry, University of Oxford</institution>, Oxford, <country>UK</country></aff>
<aff id="a5"><label>5</label><institution>Center for Cognitive Computation, Department of Cognitive Science, Central European University</institution>, Budapest, <country>Hungary</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Salinas</surname>
<given-names>Emilio</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Wake Forest University School of Medicine</institution>
</institution-wrap>
<city>Winston-Salem</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Frank</surname>
<given-names>Michael J</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Brown University</institution>
</institution-wrap>
<city>Providence</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>@</label>corresponding author: <email>j.stroud@eng.cam.ac.uk</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-03-27">
<day>27</day>
<month>03</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP94961</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-12-13">
<day>13</day>
<month>12</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-12-08">
<day>08</day>
<month>12</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.07.11.548492"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Stroud et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Stroud et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-94961-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Cognitive flexibility requires both the encoding of task-relevant and the ignoring of task-irrelevant stimuli. While the neural coding of task-relevant stimuli is increasingly well understood, the mechanisms for ignoring task-irrelevant stimuli remain poorly understood. Here, we study how task performance and biological constraints jointly determine the coding of relevant and irrelevant stimuli in neural circuits. Using mathematical analyses and task-optimized recurrent neural networks, we show that neural circuits can exhibit a range of representational geometries depending on the strength of neural noise and metabolic cost. By comparing these results with recordings from primate prefrontal cortex (PFC) over the course of learning, we show that neural activity in PFC changes in line with a minimal representational strategy. Specifically, our analyses reveal that the suppression of dynamically irrelevant stimuli is achieved by activity-silent, sub-threshold dynamics. Our results provide a normative explanation as to why PFC implements an adaptive, minimal representational strategy.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>The main text and figures 1 to 4 were updated as well as the methods, all supplementary figures and a new supplementary figure 6. The supplementary appendix was also updated.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>How systems solve complex cognitive tasks is a fundamental question in neuroscience and artificial intelligence <sup><xref ref-type="bibr" rid="c2">2</xref>–<xref ref-type="bibr" rid="c6">6</xref></sup>. A key aspect of complex tasks is that they often involve multiple types of stimuli, some of which can even be <italic>irrelevant</italic> for performing the correct behavioural response <sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c9">9</xref></sup> or predicting reward <sup><xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c11">11</xref></sup>. Over the course of task exposure, subjects must typically identify which stimuli are relevant and which are irrelevant. Examples of irrelevant stimuli include those that are irrelevant at all times in a task <sup><xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c11">11</xref>–<xref ref-type="bibr" rid="c14">14</xref></sup> — which we refer to as <italic>static</italic> irrelevance — and stimuli that are relevant at some time points but are irrelevant at other times in a trial — which we refer to as <italic>dynamic</italic> irrelevance (e.g. as is often the case for context-dependent decision-making tasks <sup><xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c15">15</xref>–<xref ref-type="bibr" rid="c17">17</xref></sup>). Although tasks involving irrelevant stimuli have been widely used, it remains an open question as to how different types of irrelevant stimuli should be represented, in combination with relevant stimuli, to enable optimal task performance.</p>
<p>One may naively think that statically irrelevant stimuli should always be suppressed. However, stimuli that are currently irrelevant may be relevant in a future task. Furthermore, it is unclear whether dynamically irrelevant stimuli should be suppressed at all since the information is ultimately needed by the circuit. It may therefore be beneficial for a neural circuit to represent irrelevant information as long as no unnecessary costs are incurred and task performance remains high. Several factors could have a strong impact on whether irrelevant stimuli affect task performance. For example, levels of neural noise in the circuit as well as energy constraints and the metabolic costs of overall neural activity <sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c18">18</xref>–<xref ref-type="bibr" rid="c26">26</xref></sup> can affect how stimuli are represented in a neural circuit. Indeed, both noise and metabolic costs are factors that biological circuits must contend with <sup><xref ref-type="bibr" rid="c27">27</xref>–<xref ref-type="bibr" rid="c30">30</xref></sup>. Despite these considerations, models of neural population codes, including hand-crafted models and optimized artificial neural networks, typically use only a very limited range of the values of such factors <sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c19">19</xref>,<xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c31">31</xref>–<xref ref-type="bibr" rid="c35">35</xref></sup> (but also see <sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c20">20</xref></sup>). Therefore, despite the success of recent comparisons between neural network models and experimental recordings <sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c19">19</xref>,<xref ref-type="bibr" rid="c22">22</xref>,<xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c31">31</xref>,<xref ref-type="bibr" rid="c34">34</xref>–<xref ref-type="bibr" rid="c36">36</xref></sup>, we may only be recovering very few out of a potentially large range of different representational strategies that neural networks could exhibit <sup><xref ref-type="bibr" rid="c37">37</xref></sup>.</p>
<p>One challenge for distinguishing between different representational strategies, particularly when analysing experimental recordings, is that some stimuli may simply be represented more strongly than others. In particular, we might expect stimuli to be strongly represented in cortex <italic>a priori</italic> if they have previously been important to the animal. Indeed, being able to represent a given stimulus when learning a new task is likely a prerequisite for learning whether it is relevant or irrelevant in that particular context <sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c10">10</xref></sup>. Previously, it has been difficult to distinguish between whether a given representation existed <italic>a priori</italic> or emerged as a consequence of learning because neural activity is typically only recorded <italic>after</italic> a task has already been learned. A more relevant question is how the representation <italic>changes</italic> over learning <sup><xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c38">38</xref>–<xref ref-type="bibr" rid="c41">41</xref></sup>, which provides insights into how the specific task of interest affects the representational strategy used by an animal or artificial network <sup><xref ref-type="bibr" rid="c42">42</xref></sup>.</p>
<p>To resolve these questions, we optimized recurrent neural networks on a task that involved two types of irrelevant stimuli. One feature of the stimulus was statically irrelevant, and another feature of the stimulus was dynamically irrelevant. We found that, depending on the neural noise level and metabolic cost that was imposed on the networks during training, a range of representational strategies emerged in the optimized networks, from maximal (representing all stimuli) to minimal (representing only relevant stimuli). We then compared the strategies of our optimized networks with <italic>learning-resolved</italic> recordings from the prefrontal cortex (PFC) of monkeys exposed to the same task. We found that the representational geometry of the neural recordings changed in line with the minimal strategy. Using a simplified model, we derived mathematically how the strength of relevant and irrelevant coding depends on the noise level and metabolic cost. We then confirmed our theoretical predictions in both our task-optimized networks and neural recordings. By reverse-engineering our task-optimized networks, we also found that activity-silent, sub-threshold dynamics led to the suppression of dynamically irrelevant stimuli, and we confirmed predictions of this mechanism in our neural recordings.</p>
<p>In summary, we provide a mechanistic understanding of how different representational strategies can emerge in both biological and artificial neural circuits over the course of learning in response to salient biological factors such as noise and metabolic costs. These results in turn explain why PFC appears to employ a minimal representational strategy by filtering out task-irrelevant information.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>A task involving relevant and irrelevant stimuli</title>
<p>We study a task used in previous experimental work that uses a combination of multiple, relevant and irrelevant stimuli <sup><xref ref-type="bibr" rid="c1">1</xref></sup> (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>). The task consists of an initial ‘fixation’ period, followed by a ‘color’ period, in which one of two colors are presented. After this, in the ‘shape’ period, either a square or diamond shape is presented (while the color stimulus stays on), such that the width of the shape can be either thick or thin. After this, the stimuli disappear and reward is delivered according to an XOR structure between color and shape (<xref rid="fig1" ref-type="fig">Fig. 1b</xref>). Note that the width of the shape is not predictive of reward, and it is therefore an <italic>irrelevant</italic> stimulus dimension (<xref rid="fig1" ref-type="fig">Fig. 1b</xref>). As width information is always irrelevant when it is shown, its irrelevance is <italic>static</italic>. In contrast, color is relevant during the shape period but could be ignored during the color period without loss of performance. Hence its irrelevance is <italic>dynamic</italic>.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1.</label>
<caption><title>Task design and irrelevant stimulus representations.</title>
<p><bold>a</bold>, Illustration of the timeline of task events in a trial with the corresponding displays and names of task periods. Red dot shows fixation ring, blue (or green) circles appear during the color and shape periods, gray squares (or diamonds) appear during the shape period, and a juice reward is given during the reward period for rewarded combinations of color and shape stimuli (see panel b). No behavioural response was required for the monkeys as it was a passive object–association task <sup><xref ref-type="bibr" rid="c1">1</xref></sup>. <bold>b</bold>, Schematic showing that rewarded conditions of color and shape stimuli follows an XOR structure. In addition, the width of the shape was not predictive of reward and was thus an irrelevant stimulus dimension. <bold>c</bold>, Schematic of 4 possible representational strategies, as indicated by linear decoding of population activity, for the task shown in panels a and b. Turquoise lines with shading show early color decoding and black lines with shading show width decoding. Strategies are split according to whether early color decoding is low (left column) or high (right column), and whether width decoding is low (bottom row) or high (top row).</p></caption>
<graphic xlink:href="548492v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Due to the existence of multiple different forms of irrelevant stimuli, there exist multiple different representational strategies for a neural circuit solving the task in <xref rid="fig1" ref-type="fig">Fig. 1a</xref>. These representational strategies can be characterised by assessing the extent to which different stimuli are linearly decodable from neural population activity <sup><xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c14">14</xref>,<xref ref-type="bibr" rid="c43">43</xref>,<xref ref-type="bibr" rid="c44">44</xref></sup>. We use linear decodability because it only requires the computation of simple weighted sums of neural responses, and as such, it is a widely accepted criterion for the usefulness of a neural representation <sup><xref ref-type="bibr" rid="c45">45</xref></sup>. Moreover, while representational strategies can differ along several dimensions in this task (for example, the decodability of color or shape during the shape period — both of which are task-relevant <sup><xref ref-type="bibr" rid="c1">1</xref></sup>), our main focus here is on the two dimensions that specifically control the representation of irrelevant stimuli. Therefore, depending on whether each of the irrelevant stimuli are linearly decodable during their respective period of irrelevance, we distinguish four different (extreme) strategies, ranging from a ‘minimal strategy’, in which the irrelevant stimuli are only weakly represented (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>, bottom left; pink shading), to a ‘maximal strategy’, in which both irrelevant stimuli are strongly represented (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>, top right; blue shading).</p>
</sec>
<sec id="s2b">
<title>Stimulus representations in task-optimized recurrent neural networks</title>
<p>To understand the factors determining which representational strategy neural circuits employ to solve this task, we optimized recurrent neural networks to perform the task (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>; Methods 1.2). The neural activities in these stochastic recurrent networks evolved according to</p>
<p>
<disp-formula id="eqn1">
<graphic xlink:href="548492v2_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
With
<disp-formula id="eqn2">
<graphic xlink:href="548492v2_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <bold>x</bold>(<italic>t</italic>) = (<italic>x</italic><sub>1</sub>(<italic>t</italic>), …, <italic>x</italic><sub><italic>N</italic></sub> (<italic>t</italic>))<sup><italic>⊤</italic></sup> corresponds to the vector of ‘subthreshold’ activities of the <italic>N</italic> = 50 neurons in the network, <bold>r</bold>(<italic>t</italic>) is their momentary firing rates which is a rectified linear function (ReLU) of the subthreshold activity, <italic>τ</italic> = 50 ms is the effective time constant, and <bold>h</bold>(<italic>t</italic>) denotes the inputs to the network encoding the three stimulus features as they become available over the course of the trial (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>, bottom). The optimized parameters of the network were <bold>W</bold>, the recurrent weight matrix describing connection strengths between neurons in the network (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>, top; middle), <bold>W</bold><sub>in</sub>, the feedforward weight matrix describing connections from the stimulus inputs to the network (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>, top; left; see also Methods 1.2), and <bold>b</bold>, a stimulusindependent bias. Importantly, <italic>σ</italic> is the standard deviation of the neural noise process (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>, top; pale gray arrows; with <bold><italic>η</italic></bold>(<italic>t</italic>) being a sample from a Gaussian white noise process with mean 0 and variance 1), and as such represents a fundamental constraint on the operation of the network. The output of the network was given by
<disp-formula id="eqn3">
<graphic xlink:href="548492v2_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
with optimized parameters <bold>W</bold><sub>out</sub>, the readout weights (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>, top; right), and <bold>b</bold><sub>out</sub>, a readout bias.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig. 2.</label>
<caption><title>Stronger levels of noise and firing rate regularization lead to suppression of task-irrelevant stimuli in optimized recurrent networks.</title>
<p><bold>a</bold>, Top: illustration of a recurrent neural network model where each neuron receives independent white noise input with strength <italic>σ</italic> (middle). Color, shape, and width inputs are delivered to the network via 3 input channels (left). Firing rate activity is read out into two readout channels (either rewarded or not rewarded; right). All recurrent weights in the network, as well as weights associated with the input and readout channels, were optimized (Methods 1.2). Bottom: cost function used for training the recurrent neural networks (cf. <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref>) and timeline of task events within a trial for the recurrent neural networks (cf. <xref ref-type="fig" rid="fig1">Fig. 1a</xref>). Yellow shading on time axis shows the time period in which the task performance term enters the cost function (cf. <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref>). <bold>b</bold>, Top: neural firing rate trajectories in the top two PCs for an example network over the course of a trial (from color stimulus onset) for a particular noise (<italic>σ</italic>) and regularization (<italic>λ</italic>) regime. Open gray circles indicate color onset, filled gray squares indicate shape onset, filled gray circles indicate offset of both stimuli, and colored thick and thin squares and diamonds indicate the end of the trial at 1.5 s for all stimulus conditions. Pale and brightly colored trajectories indicate the two width conditions. We show results for networks exposed to low noise and low regularization (<italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub>; left, pale blue shading), high noise and low regularization (<italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub>; middle, purple shading), and medium noise and medium regularization (<italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub>; right, pink shading). Bottom: performance of a linear decoder (mean over 10 networks) trained at each time point within the trial to decode color (turquoise) or width (black) from neural firing rate activity for each noise and regularization regime. Dotted gray lines and shading show mean <italic>±</italic> 2 s.d. of chance level decoding based on shuffling trial labels. <bold>c</bold>, Left: performance of optimized networks determined as the mean performance over all trained networks during the reward period (<xref ref-type="fig" rid="fig2">Fig. 2a</xref>, bottom; yellow shading) for all noise (<italic>σ</italic>, horizontal axis) and regularization levels (<italic>λ</italic>, vertical axis) used during training. Pale blue, pink, and purple dots indicate parameter values that correspond to the dynamical regimes shown in panel b and <xref ref-type="fig" rid="fig1">Fig. 1c</xref> with the same background coloring. For parameter values above the white line, networks achieved a mean performance of less than 0.95. Middle: early color decoding determined as mean color decoding over all trained networks at the end of the color period (<xref ref-type="fig" rid="fig2">Fig. 2b</xref>, bottom left, turquoise arrow) using the same plotting scheme as the left panel. Right: width decoding determined as mean width decoding over all trained networks at the end of the shape period (<xref ref-type="fig" rid="fig2">Fig. 2b</xref>, bottom left, black arrow) using the same plotting scheme as the left panel. <bold>d</bold>, Width decoding plotted against early color decoding for all noise and regularization levels and colored according to performance. Pale blue, pink, and purple highlights indicate the parameter values shown with the same colors in panel c.</p></caption>
<graphic xlink:href="548492v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We optimized networks for a canonical cost function <sup><xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c32">32</xref>,<xref ref-type="bibr" rid="c33">33</xref>,<xref ref-type="bibr" rid="c35">35</xref>,<xref ref-type="bibr" rid="c46">46</xref></sup> (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>, bottom; Methods 1.2.1):
<disp-formula id="eqn4">
<graphic xlink:href="548492v2_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
The first term in <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> is a task performance term measuring the cross-entropy loss ℋ (<bold>c, z</bold>(<italic>t</italic>)) between the one-hot encoded target choice, <bold>c</bold>, and the network’s output probabilities, <bold>z</bold>(<italic>t</italic>), during the reward period, <italic>T</italic><sub>r</sub> (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>, bottom; yellow shading). The second term in <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> is a firing rate regularization term. This regularization term can be interpreted as a form of energy or metabolic cost <sup><xref ref-type="bibr" rid="c18">18</xref>,<xref ref-type="bibr" rid="c24">24</xref>,<xref ref-type="bibr" rid="c31">31</xref>,<xref ref-type="bibr" rid="c46">46</xref>,<xref ref-type="bibr" rid="c47">47</xref></sup> measured across the whole trial, <italic>T</italic>, because it penalizes large overall firing rates. Therefore, optimizing this cost function encourages networks to not only solve the task, but to do so using low overall firing rates. How important it is for the network to keep firing rates low is controlled by the ‘regularization’ parameter <italic>λ</italic>. Critically, we used different noise levels <italic>σ</italic> and regularization strengths <italic>λ</italic> (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>, highlighted in red) to examine how these two constraints affected the dynamical strategies employed by the optimized networks to solve the task and compared them to our four hypothesised representational strategies (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>). We focused on these two parameters because they are both critical factors for real neural circuits and <italic>a priori</italic> can be expected to have important effects on the resulting circuit dynamics. For example, metabolic costs will constrain the overall level of firing rates that can be used to solve the task while noise levels directly affect how reliably stimuli can be encoded in the network dynamics. For the remainder of this section, we analyse representational strategies utilized by networks after training. In subsequent sections, we analyse learning-related changes in both our optimized networks and neural recordings.</p>
<p>We found that networks trained in a low noise–low firing rate regularization setting (which we denote by <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub>) employed a maximal representational strategy (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, left column; pale blue shading). Trajectories in neural firing rate space diverged for the two different colors as soon as the color stimulus was presented (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, top left; blue and green trajectories from open gray circle to gray squares), which resulted in high color decoding during the color period (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, bottom left; turquoise line; Methods 1.3.1). During the shape period, the trajectories corresponding to each color diverged again (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, top left; trajectories from gray squares to filled gray circles), such that all stimuli were highly decodable, including width (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, bottom left; black line, <xref rid="figS1" ref-type="fig">Supplementary Fig. 1a</xref>). After removal of the stimuli during the reward period, trajectories converged to one of two parts of state space according to the XOR task rule — which is required for high performance (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, top left; trajectories from filled gray circles to colored squares and diamonds). Because early color and width were highly decodable in these networks trained with a low noise and low firing rate regularization, the dynamical strategy they employed corresponds to the maximal representational regime (cf. <xref rid="fig1" ref-type="fig">Fig. 1c</xref>, blue shading).</p>
<p>We next considered the setting of networks that solve this task while being exposed to a high level of neural noise (which we denote by <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub>; <xref rid="fig2" ref-type="fig">Fig. 2b</xref>, middle column; purple shading). In this setting, we also observed neural trajectories that diverged during the color period (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, top middle; gray squares are separated), which yielded high color decoding during the color period (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, bottom middle; turquoise line). However, in contrast to networks with a low level of neural noise (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, left), width was poorly decodable during the shape period (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, bottom middle; black line). Therefore, for networks challenged with higher levels of neural noise, the irrelevant stimulus dimension of width is represented more weakly (cf. <xref rid="fig1" ref-type="fig">Fig. 1c</xref>, purple shading). A similar representational strategy was also observed in networks that were exposed to a low level of noise but a high level of firing rate regularization (<xref rid="figS1" ref-type="fig">Supplementary Fig. 1c</xref>, black lines).</p>
<p>Finally, we considered the setting of networks that solve this task while being exposed to medium levels of both neural noise and firing rate regularization (which we denote by <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub>; <xref rid="fig2" ref-type="fig">Fig. 2b</xref>, right column; pink shading). In this setting, neural trajectories diverged only weakly during the color period (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, top middle; gray squares on-top of one another), which yielded relatively poor (non-ceiling) color decoding during the color period (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, bottom right; turquoise line). Nevertheless, color decoding was still above chance despite the neural trajectories strongly overlapping in the 2-dimensional state space plot in <xref rid="fig2" ref-type="fig">Fig. 2b</xref>, top right), because these trajectories became separable in the full-dimensional state space of these networks. Additionally, width decoding was also poor during the shape period (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, bottom right; black line). Therefore, networks that were challenged with increased levels of both neural noise and firing rate regularization employed dynamics in line with a minimal representational strategy by only weakly representing irrelevant stimuli (cf. <xref rid="fig1" ref-type="fig">Fig. 1c</xref>, pink shading).</p>
<p>To gain a more comprehensive picture of the full range of dynamical solutions that networks can exhibit, we performed a grid search over multiple different levels of noise and firing rate regularization. Nearly all parameter values allowed networks to achieve high performance (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>, left), except when both the noise and regularization levels were high (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>, left; parameter values above white line). Importantly, all of the dynamical regimes that we showed in <xref rid="fig2" ref-type="fig">Fig. 2b</xref> achieved similarly high performances (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>, left; pale blue, purple, and pink dots).</p>
<p>When looking at early color decoding (defined as color decoding at the end of the color period; <xref rid="fig2" ref-type="fig">Fig. 2b</xref>, bottom left, turquoise arrow) and width decoding (defined as width decoding at the end of the shape period; <xref rid="fig2" ref-type="fig">Fig. 2b</xref>, bottom left, black arrow), we saw a consistent pattern of results. Early color decoding was high only when either the lowest noise level was used (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>, middle; <italic>σ</italic> = 0.01 column) or when the lowest regularization level was used (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>, middle; <italic>λ</italic> = 0.0005 row). In contrast, width decoding was high only when both the level of noise and regularization were small (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>, right; bottom left corner). Otherwise, width decoding became progressively worse as either the noise or regularization level was increased and achieved values that were typically lower than the corresponding early color decoding (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>, compare right with middle). This pattern becomes clearer when we plot width decoding against early color decoding (<xref rid="fig2" ref-type="fig">Fig. 2d</xref>). No set of parameters yielded higher width decodability compared to early color decodability (<xref rid="fig2" ref-type="fig">Fig. 2d</xref>, no data point above the identity line). This means that we never observed the fourth dynamical regime we hypothesized <italic>a priori</italic>, in which width decoding would be high and early color decoding would be low (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>, top left). Therefore, information with static irrelevance (width) was more strongly suppressed compared to information whose irrelevance was dynamic (color). We also note that we never observed pure chance levels of decoding of color or width during stimulus presentation. This is likely because it is challenging for recurrent neural networks to strongly suppress their inputs and it may also be the case that other hyperparameter regimes more naturally lead to stronger suppression of inputs (we discuss this second possibility later; e.g. <xref rid="fig5" ref-type="fig">Fig. 5</xref>).</p>
</sec>
<sec id="s2c">
<title>Comparing learning-related changes in stimulus representations in neural networks and primate lateral PFC</title>
<p>To understand the dynamical regime employed by PFC, we analyzed a data set <sup><xref ref-type="bibr" rid="c1">1</xref></sup> of multi-channel recordings from lateral prefrontal cortex (lPFC) in two monkeys exposed to the task shown in <xref rid="fig1" ref-type="fig">Fig. 1a</xref>. These recordings yielded 376 neurons in total across all recording sessions and both animals (Methods 1.1). Importantly, for understanding the direction in which neural geometries changed over learning, recordings commenced in the first session in which the animals were exposed to the task — that is, the recordings spanned the entirety of the learning process. For our analyses, we distinguished between the first half of recording sessions (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, gray; ‘early learning’) and the second half of recording sessions (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, black; ‘late learning’). A previous analysis of this dataset showed that, over the course of learning, the XOR representation of the task comes to dominate the dynamics during the late shape period of the task <sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Here however, we focus on relevant and irrelevant task variable coding during the stimulus periods and compare the recordings to the dynamics of task-optimized recurrent neural networks. Also, in line with the previous study <sup><xref ref-type="bibr" rid="c1">1</xref></sup>, we do not examine the reward period of the task because the one-to-one relationship between XOR and reward in the data (which is not present in the models), will likely lead to trivial differences in XOR representations in the reward period between the data and models.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Fig. 3.</label>
<caption><title>Stimulus representations in primate lateral PFC correspond to a minimal representational strategy.</title>
<p><bold>a</bold>, Performance of a linear decoder trained at each time point to predict either XOR (far left), shape (middle left), color (middle right), or width (far right) from neural population activity in lPFC (Methods 1.1 and 1.3.1). We show decoding results separately from the first half of sessions (gray, ‘early learning’) and the second half of sessions (black, ‘late learning’). Dotted gray lines and shading show mean <italic>±</italic> 2 s.d. of chance level decoding based on shuffling trial labels. Horizontal black bars show significant differences between early and late decoding using a two-sided cluster-based permutation test (Methods 1.4). Open gray circles, filled gray squares, and filled gray circles on the horizontal indicate color onset, shape onset, and offset of both stimuli, respectively. <bold>b</bold>, Same as panel a but for decoders trained on neural activity from optimized recurrent neural networks in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime (cf. <xref ref-type="fig" rid="fig2">Fig. 2b</xref>–<xref ref-type="fig" rid="fig2">d</xref>, pink). <bold>c</bold>, Black horizontal lines show the mean change between early and late decoding during time periods when there were significant differences between early and late decoding in the data (horizontal black bars in panel a) for XOR (top row), color (middle row), and width (bottom row). (No significant differences in shape decoding were observed in the data; cf. panel a.) Violin plots show chance differences between early and late decoding based on shuffling trial labels. We show results for the data (far left column), <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> networks (middle left column, pale blue shading), <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> networks (middle right column, purple shading), and <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> networks (far right column, pink shading). <bold>d</bold>, Same as panel c but we show results using cross-generalized decoding <sup><xref ref-type="bibr" rid="c10">10</xref></sup> during the same time periods as those used in panel c (Methods 1.3.1).</p></caption>
<graphic xlink:href="548492v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Similar to our analyses of our recurrent network models (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, bottom), we performed population decoding of the key task variables in the experimental data (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, Methods 1.3.1). We found that the decodability of the XOR relationship between task-relevant stimuli that determined task performance (<xref rid="fig1" ref-type="fig">Fig. 1b</xref>) significantly increased during the shape period over the course of learning, consistent with the animals becoming more familiar with the task structure (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, far left; compare gray and black lines). We also found that shape decodability during the shape period decreased slightly over learning (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, middle left; compare gray and black lines from gray square to gray circle), while color decodability during the shape period increased slightly (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, middle right; compare gray and black lines from gray square to gray circle). Importantly, however, color decodability significantly <italic>decreased</italic> during the color period (when it is ‘irrelevant’; <xref rid="fig3" ref-type="fig">Fig. 3a</xref>, middle right; compare gray and black lines), and width decodability significantly decreased during the shape period (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, far right; compare gray and black lines). Neural activities in lPFC thus appear to change in line with the minimal representational strategy over the course of learning, consistent with recurrent networks trained in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime (cf. <xref rid="fig1" ref-type="fig">Fig. 1c</xref>, pink and <xref rid="fig2" ref-type="fig">Fig. 2b</xref>, bottom, pink).</p>
<p>We then directly compared these learning-related changes in stimulus decodability from lPFC with those that we observed in our task-optimized recurrent neural networks (cf. <xref rid="fig2" ref-type="fig">Fig. 2</xref>). We found that the temporal decoding dynamics of networks trained with medium noise and firing rate regularization (<italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub>; <xref rid="fig2" ref-type="fig">Fig. 2b</xref>– <xref ref-type="fig" rid="fig2">d</xref>, pink shading and pink dots) exhibited decoding dynamics most similar to those that we observed in lPFC. Specifically, XOR decodability significantly increased after shape onset, consistent with the networks learning the task (<xref rid="fig3" ref-type="fig">Fig. 3b</xref>, far left; compare gray and black lines). We also found that shape and color decodability did not significantly change during the shape period (<xref rid="fig3" ref-type="fig">Fig. 3b</xref>, middle left and middle right; compare gray and black lines from gray square to gray circle). Importantly, however, color decodability significantly <italic>decreased</italic> during the color period (when it is ‘irrelevant’; <xref rid="fig3" ref-type="fig">Fig. 3b</xref>, middle right; compare gray and black lines from open gray circle to gray square), and width decodability significantly decreased during the shape period (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, far right; compare gray and black lines). Other noise and regularization settings yielded temporal decoding that displayed a poorer resemblance to the data (<xref rid="figS1" ref-type="fig">Supplementary Fig. 1</xref>). For example, <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> and <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>h</sub> networks exhibited almost no changes in decodability during the color and shape periods (<xref rid="figS1" ref-type="fig">Supplementary Fig. 1a,c</xref>) and <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> networks exhibited increased XOR, shape, and color decodability at all times after stimulus onset while width decodability decreased during the shape period (<xref rid="figS1" ref-type="fig">Supplementary Fig. 1b</xref>). We also found that if regularization is driven to very high levels, color and shape decoding becomes weak during the shape period while XOR decoding remains high (<xref rid="figS1" ref-type="fig">Supplementary Fig. 1d</xref>). Therefore such networks effectively perform a pure XOR computation during the shape period.</p>
<p>We also note that the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> model does not perfectly match the decoding dynamics seen in the data. For example, although not significant, we observed a decrease in shape decoding and an increase in color decoding in the data during the shape period whereas the model only displayed a slight (non significant) increase in decodability of both shape and color during the same time period. These differences may be due to fundamentally different ways that brains encode sensory information upstream of PFC, compared to the more simplistic abstract sensory inputs used in models (see Discussion).</p>
<p>To systematically compare learning-related changes in the data and models, we analyzed time periods when there were significant changes in decoding in the data over the course of learning (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, horizontal black bars). This yielded a substantial increase in XOR decoding during the shape period, and substantial decreases in color and width decoding during the color and shape periods, respectively, in the data (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>, far left column). During the same time periods in the models, networks in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime exhibited no changes in decoding (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>, middle left column; blue shading). In contrast, networks in the <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> regime exhibited substantial increases in XOR and color decoding, and a substantial decrease in width decoding (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>, middle right column; purple shading). Finally, in line with the data, networks in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime exhibited a substantial increase in XOR decoding, and substantial decreases in both color and width decoding (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>, middle right column; pink shading).</p>
<p>In addition to studying changes in traditional decoding, we also studied learning-related changes in ‘cross-generalized decoding’ which provides a measure of how factorized the representational geometry is across stimulus conditions <sup><xref ref-type="bibr" rid="c10">10</xref></sup> (<xref rid="figS2" ref-type="fig">Supplementary Fig. 2</xref>). (For example, for evaluating cross-generalized decoding for color, a color decoder trained on square trials would be tested on diamond trials, and vice versa <sup><xref ref-type="bibr" rid="c10">10</xref></sup>; Methods 1.3.1.) Using this measure, we found that changes in decoding were generally more extreme over learning and that models and data bore a stronger resemblance to one another compared with traditional decoding. Specifically, all models and the data showed a strong increase in XOR decoding (<xref rid="fig3" ref-type="fig">Fig. 3d</xref>, top row, ‘XOR’) and a strong decrease in width decoding (<xref rid="fig3" ref-type="fig">Fig. 3d</xref>, bottom row, ‘width’). However, only the data and <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> networks showed a decrease in color decoding (<xref rid="fig3" ref-type="fig">Fig. 3d</xref>, compare middle far left and middle far right), whereas <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> networks showed no change in color decoding (<xref rid="fig3" ref-type="fig">Fig. 3d</xref>, middle left; blue shading) and <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> networks showed an increase in color decoding (<xref rid="fig3" ref-type="fig">Fig. 3d</xref>, middle right; purple shading).</p>
<p>Beside studying the effects of input noise and firing rate regularization, we also examined the effects of different strengths of the initial stimulus input connections prior to training <sup><xref ref-type="bibr" rid="c15">15</xref></sup>. In line with previous studies <sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c35">35</xref>,<xref ref-type="bibr" rid="c46">46</xref>,<xref ref-type="bibr" rid="c48">48</xref></sup>, for all of our previous results, the initial input weights were set to small random values prior to training (Methods 1.2.1). We found that changing these weights had similar effects to changing neural noise (with the opposite sign). Specifically, when input weights were set to 0 before training, initial decoding was at chance levels and only increased with learning for XOR, shape, and color (whereas width decoding hardly changed with learning and remained close to chance levels; <xref rid="figS3" ref-type="fig">Supplementary Fig. 3</xref>) — analogously to the <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> regime (<xref rid="figS1" ref-type="fig">Supplementary Fig. 1b</xref>). In contrast, when input weights were set to large random values prior to training, initial decoding was at ceiling levels and did not significantly change over learning during the color and shape periods for any of the task variables (<xref rid="figS4" ref-type="fig">Supplementary Fig. 4</xref>) — similar to what we found in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime (<xref rid="figS1" ref-type="fig">Supplementary Fig. 1a</xref>). Thus, neither extremely small nor extremely large initial input weights were consistent with the data that exhibited both increases and decreases in decodability of task variables over learning (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>).</p>
</sec>
<sec id="s2d">
<title>Theoretical predictions for strength of relevant and irrelevant stimulus coding</title>
<p>To gain a theoretical understanding of how irrelevant stimuli should be processed in a neural circuit, we performed a mathematical analysis of a minimal linear model that only included a single relevant stimulus and a single statically irrelevant stimulus (Supplement A1). Although this analysis applies to a simpler task compared with that faced by our neural networks and animals, crucially it still allows us to understand how relevant and irrelevant coding depend on noise and metabolic constraints. Our mathematical analysis suggested that the effects of noise and firing rate regularization on the performance and metabolic cost of a network can be understood via three key aspects of its representation: the strength of neural responses to the relevant stimulus (‘relevant coding’), the strength of responses to the irrelevant stimulus (‘irrelevant coding’), and the overlap between the population responses to relevant and irrelevant stimuli (‘overlap’; <xref rid="fig4" ref-type="fig">Fig. 4a</xref>). In particular, maximizing task performance (i.e. the decodability of the relevant stimulus) required relevant coding to be strong, irrelevant coding to be weak, and the overlap between the two to be small (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>, top; Supplement A1.3). This ensures that the irrelevant stimulus interferes minimally with the relevant stimulus. In contrast, to reduce a metabolic cost (such as we considered previously in our optimized recurrent networks, see <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> and <xref rid="fig2" ref-type="fig">Fig. 2</xref>), both relevant and irrelevant coding should be weak (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>, bottom; Supplement A1.4).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Fig. 4.</label>
<caption><title>Theoretical predictions for strength of relevant and irrelevant stimulus coding and comparison to lPFC recordings.</title>
<p><bold>a</bold>, Schematic of activity in neural state space for two neurons for a task involving two relevant (black drops vs. red crosses) and two irrelevant stimuli (thick vs. thin squares). Strengths of relevant and irrelevant stimulus coding are shown with red and black arrows, respectively, and the overlap between relevant and irrelevant coding is also shown (‘overlap’). <bold>b</bold>, Schematic of our theoretical predictions for the optimal setting of relevant (red arrows) and irrelevant (black arrows) coding strengths when either maximizing performance (top) or minimizing a metabolic cost with strength <italic>λ</italic> (bottom; see <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref>). <bold>c</bold>, Schematic of our theoretical predictions for the strength of relevant (Δ<bold>r</bold><sub>rel</sub>; black drops vs. red crosses; red arrows) and irrelevant (Δ<bold>r</bold><sub>irrel</sub>; thick vs. thin squares; black arrows) coding when jointly optimizing for both performance and a metabolic cost (cf. panel b). In the low noise regime (left), relevant conditions are highly distinguishable and irrelevant conditions are poorly distinguishable as well as strongly orthogonal to the relevant conditions. In the high noise regime (right), all conditions are poorly distinguishable. <bold>d</bold>, Our theoretical predictions (Eq. S34) for the strength of relevant coding (<inline-formula><inline-graphic xlink:href="548492v2_inline13.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, see panel c) as a function of the noise level <italic>σ</italic> (horizontal axis) and firing rate regularization strength <italic>λ</italic> (colorbar). <bold>e</bold>, Same as panel d but for our optimized recurrent neural networks ( <xref ref-type="fig" rid="fig2">Fig. 2</xref>) where we show the strength of relevant (XOR) coding (Methods 1.3.2). Pale blue, purple, and pink highlights correspond to the noise and regularization strengths shown in <xref ref-type="fig" rid="fig2">Fig. 2c,d</xref>. Gray dotted line and shading shows mean<italic>±</italic>2 s.d. (over 250 networks; 10 networks for each of the 25 different noise and regularization levels) of <inline-formula><inline-graphic xlink:href="548492v2_inline14.gif" mimetype="image" mime-subtype="gif"/></inline-formula> prior to training. <bold>f</bold>, Same as panel e but for the strength of irrelevant (width) coding <inline-formula><inline-graphic xlink:href="548492v2_inline15.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. The black arrow indicates the theoretical prediction of 0 irrelevant coding. <bold>g</bold>, The absolute value of the normalized dot product (overlap) between relevant and irrelevant representations <inline-formula><inline-graphic xlink:href="548492v2_inline16.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, i.e. 0 implies perfect orthogonality and 1 implies perfect overlap) for our optimized recurrent neural networks. The black arrow indicates the theoretical prediction of 0 overlap. <bold>h</bold>, Left: coding strength (length of arrows in panel a; Methods 1.3.2) for relevant (XOR; red) and irrelevant (width; black) stimuli during early and late learning for our lPFC recordings. Right: the absolute value of the overlap between relevant and irrelevant representations for our lPFC recordings (0 implies perfect orthogonality and 1 implies perfect overlap). Error bars show the mean <italic>±</italic> 2 s.d. over 10 non-overlapping splits of the data. <bold>i</bold>, Same as panel c but for the optimized recurrent neural networks in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime (see pink dots in <xref ref-type="fig" rid="fig2">Fig. 2</xref>). Error bars show the mean <italic>±</italic> 2 s.d. over 10 different networks. P-values resulted from a two-sided Mann–Whitney U test (*, <italic>p &lt;</italic> 0.05; **, <italic>p &lt;</italic> 0.01; n.s., not significant; see Methods 1.4).</p></caption>
<graphic xlink:href="548492v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In combination, when decoding performance and metabolic cost are <italic>jointly</italic> optimized, as in our taskoptimized recurrent networks (<xref rid="fig2" ref-type="fig">Fig. 2</xref>), our theoretical analyses suggested that performance should decrease with both the noise level <italic>σ</italic> and the strength of firing rate regularization <italic>λ</italic> in an approximately interchangeable way, and metabolic cost should increase with <italic>σ</italic> but decrease with <italic>λ</italic> (Supplement A1.5). We also found that the strength of relevant coding should decrease with <italic>λ</italic>, but its dependence on <italic>σ</italic> was more nuanced. For small <italic>σ</italic>, the performance term effectively dominates the metabolic cost (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>, top) and the strength of relevant coding should increase with <italic>σ</italic>. However, if <italic>σ</italic> is too high, the strength of relevant coding starts decreasing otherwise a disproportionately high metabolic cost must be incurred to achieve high performance (<xref rid="fig4" ref-type="fig">Fig. 4c,d</xref>). Our mathematical analysis also suggested that irrelevant coding and relevant– irrelevant overlap could in principle depend on the noise and metabolic cost strength — particularly if performing noisy optimization where the curvature of the cost function can be relatively shallow around the minimum (Supplement A1.5). Therefore, practically, we also expect that irrelevant coding should be mostly dependent (inversely) on <italic>λ</italic>, but relevant–irrelevant overlap should mostly depend on <italic>σ</italic> (Supplement A1.6). These theoretical predictions were confirmed by our recurrent neural network simulations (<xref rid="fig4" ref-type="fig">Fig. 4e</xref>–<xref ref-type="fig" rid="fig4">g</xref>).</p>
<p>We next measured, in both recorded and simulated population responses, the three aspects of population responses that our theory identified as being key in determining the performance and metabolic cost of a network (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>; Methods 1.3.2). We found a close correspondence in the learning-related changes of these measures between our lPFC recordings (<xref rid="fig4" ref-type="fig">Fig. 4h</xref>) and optimized recurrent networks (<xref rid="fig4" ref-type="fig">Fig. 4i</xref>). In particular, we found that the strength of relevant (XOR) coding increased significantly over the course of learning (<xref rid="fig4" ref-type="fig">Fig. 4h,i</xref>, left; red). The strength of irrelevant (width) coding decreased significantly over the course of learning (<xref rid="fig4" ref-type="fig">Fig. 4h,i</xref>, left; black), such that it became significantly smaller than the strength of relevant coding (<xref rid="fig4" ref-type="fig">Fig. 4h,i</xref>, left; compare red and black at ‘late learning’). Finally, relevant and irrelevant directions were always strongly orthogonal in neural state space, and the level of orthogonality did not significantly change with learning (<xref rid="fig4" ref-type="fig">Fig. 4h,i</xref>, right). Although we observed no learning-related changes in overlap, it may be that for stimuli that are more similar than the relevant and irrelevant features we studied here (XOR and width), the overlap between these features may decrease over learning rather than simply remaining small.</p>
</sec>
<sec id="s2e">
<title>Activity-silent, sub-threshold dynamics lead to the suppression of dynamically irrelevant stimuli</title>
<p>While the representation of statically irrelevant stimuli can be suppressed by simply weakening the input connections conveying information about it to the network, the suppression of dynamically irrelevant stimuli requires a mechanism that alters the dynamics of the network (since this information ultimately needs to be used by the network to achieve high performance). To gain some intuition about this mechanism, we first analyzed 2-neuron networks trained on the task. To demonstrate the basic mechanism of suppression of dynamically irrelevant stimuli (i.e. weak early color coding), we compared the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> (<xref rid="fig5" ref-type="fig">Fig. 5a</xref>) and <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> (<xref rid="fig5" ref-type="fig">Fig. 5b</xref>) regimes for these networks, as these corresponded to the minimal and maximal amount of suppression of dynamically irrelevant stimuli (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Fig. 5.</label>
<caption><title>Activity-silent, sub-threshold dynamics lead to the suppression of dynamically irrelevant stimuli.</title>
<p><bold>a</bold>, Sub-threshold neural activity (<bold>x</bold>(<italic>t</italic>) in <xref ref-type="disp-formula" rid="eqn1">Eq. 1</xref>) in the full state space of an example 2-neuron network over the course of a trial (from color onset) trained in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime. Pale blue arrows show flow field dynamics (direction and magnitude of movement in the state space as a function of the momentary state). Open gray circles indicate color onset, gray squares indicate shape onset, filled gray circles indicate offset of both stimuli, and colored squares and diamonds indicate the end of the trial at 1.5 s. We plot activity separately for the 3 periods of the task (color period, left; shape period, middle; reward period, right). We plot dynamics without noise for visual clarity. <bold>b</bold>, Same as panel a but for a network trained in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime. <bold>c</bold>, Momentary magnitude of firing rates <inline-formula><inline-graphic xlink:href="548492v2_inline17.gif" mimetype="image" mime-subtype="gif"/></inline-formula> i.e. momentary metabolic cost, see <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> ) for the 2-neuron networks from panels a (blue line) and b (pink line). <bold>d</bold>, Mean <italic>±</italic> 2 s.d. (over 10 2-neuron networks) proportion of color inputs that have a negative sign for the two noise and regularization regimes shown in panels a–c. Gray dotted line shows chance level proportion of negative color input. <bold>e</bold>, Mean (over 10 50-neuron networks) proportion of color inputs that have a negative sign for all noise (horizontal axis) and regularization (colorbar) strengths shown in <xref ref-type="fig" rid="fig2">Fig. 2c,d</xref>. Pale blue, purple, and pink highlights correspond to the noise and regularization strengths shown in <xref ref-type="fig" rid="fig2">Fig. 2c,d</xref>. Gray dotted line and shading shows mean 2 s.d. (over 250 networks; 10 networks for each of the 25 different noise and regularization levels) of the proportion of negative color input prior to training (i.e. the proportion of negative color input expected when inputs are drawn randomly from a Gaussian distribution; Methods 1.2.1). <bold>f</bold>, Momentary magnitude of firing rates <inline-formula><inline-graphic xlink:href="548492v2_inline18.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for our lPFC recordings (far left) and 50-neuron networks in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime (middle left, blue shading), <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> regime (middle right, purple shading), and <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime (far right, pink shading). Error bars show the mean <italic>±</italic> 2 s.d. over either 10 non-overlapping data splits for the data or over 10 different networks for the models. P-values resulted from a two-sided Mann–Whitney U test (*, <italic>p &lt;</italic> 0.05; **, <italic>p &lt;</italic> 0.01; ***, <italic>p &lt;</italic> 0.001; n.s., not significant; see Methods 1.4).</p></caption>
<graphic xlink:href="548492v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We examined trajectories of sub-threshold neural activity <bold>x</bold>(<italic>t</italic>) (cf. <xref ref-type="disp-formula" rid="eqn1">Eq. 1</xref>) in the full 2-neuron state space (<xref rid="fig5" ref-type="fig">Fig. 5a,b</xref>, blue and green curves). We distinguished between the negative quadrant of state space, which corresponds to the rectified part of the firing rate nonlinearity (<xref rid="fig5" ref-type="fig">Fig. 5a,b</xref>, bottom left gray quadrant; cf. <xref ref-type="disp-formula" rid="eqn2">Eq. 2</xref>), and the rest of state space. Importantly, if sub-threshold activity lies within the negative quadrant at some time point, both neurons in the network have zero firing rate and consequently a decoder cannot decode any information from the firing rate activity and the network exhibits no metabolic cost (cf. <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref>). Therefore, we reasoned that color inputs may drive sub-threshold activity so that it lies purely in the negative quadrant of state space so that no metabolic cost is incurred during the color period (akin to nonlinear gating <sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c49">49</xref></sup>). Later in the trial, when these color inputs are combined with the shape inputs, activity may then leave the negative quadrant of state space so that the network can perform the task.</p>
<p>We found that for the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime, there was typically at least one set of stimulus conditions for which subthreshold neural activity evolved outside the negative quadrant of state space during any task period (<xref rid="fig5" ref-type="fig">Fig. 5a</xref>). Consequently, color was decodable to a relatively high level during the color period (<xref rid="figS5" ref-type="fig">Supplementary Fig. 5a</xref>, middle right) and this network produced a relatively high metabolic cost throughout the task (<xref rid="fig5" ref-type="fig">Fig. 5c</xref>, blue line). In contrast, for networks in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime, the two color inputs typically drove neural activity into the negative quadrant of state space during the color period (<xref rid="fig5" ref-type="fig">Fig. 5b</xref>, left). Therefore, during the color period, the network produced zero firing rate activity (<xref rid="fig5" ref-type="fig">Fig. 5c</xref>, pink line from open gray circle to gray square). Consequently, color was poorly decodable (<xref rid="figS5" ref-type="fig">Supplementary Fig. 5b</xref>, middle right; black line) and the network incurred no metabolic cost during the color period. Thus, color information was represented in a sub-threshold, ‘activity-silent’ <sup><xref ref-type="bibr" rid="c50">50</xref></sup> state during the color period. However, during the shape and reward periods later in the trial, the color inputs, now in combination with the shape inputs, affected the firing rate dynamics and the neural trajectories explored the full state space in a similar manner to the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> network (<xref rid="fig5" ref-type="fig">Fig. 5b</xref>, middle and right panels). Indeed, we also found that color decodability increased substantially during the shape period in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> network (<xref rid="figS5" ref-type="fig">Supplementary Fig. 5b</xref>, middle right; black line). This demonstrates how color inputs can cause no change in firing rates during the color period when they are irrelevant, and yet these same inputs can be utilized later in the trial to enable high task performance (<xref rid="figS5" ref-type="fig">Supplementary Fig. 5a,b</xref>, far left). While we considered individual example networks in <xref rid="fig5" ref-type="fig">Fig. 5a</xref>–<xref ref-type="fig" rid="fig5">c</xref>, color inputs consistently drove neural activity into the negative quadrant of state space across repeated training of <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> networks but not for <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> networks (<xref rid="fig5" ref-type="fig">Fig. 5d</xref>).</p>
<p>Next, we performed the same analysis as <xref rid="fig5" ref-type="fig">Fig. 5d</xref> on the large (50-neuron) networks that we studied previously (<xref rid="fig2" ref-type="fig">Figs. 2</xref>–<xref ref-type="fig" rid="fig4">4</xref>). Similar to the 2-neuron networks, we found that large networks in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime did not exhibit more negative color inputs than would be expected by chance (<xref rid="fig5" ref-type="fig">Fig. 5e</xref>, pale blue highlighted point) — consistent with the high early color decoding we found previously in these networks (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>, middle, pale blue highlighted point). However, when increasing either the noise or regularization level, the proportion of negative color inputs increased above chance such that for the highest noise and regularization level, nearly all color inputs were negative (<xref rid="fig5" ref-type="fig">Fig. 5e</xref>). We also found a strong negative correlation between the proportion of negative color input and the level of early color decoding that we found previously in <xref rid="fig2" ref-type="fig">Fig. 2c</xref> (<xref rid="figS5" ref-type="fig">Supplementary Fig. 5c</xref>, <italic>r</italic> = − 0.9, <italic>p &lt;</italic> 10<sup>−9</sup>). This suggests that color inputs that drive neural activity into the rectified part of the firing rate nonlinearity, and thus generate purely sub-threshold activity-silent dynamics, is the mechanism that generates weak early color coding during the color period in these networks. We also examined whether these results generalized to networks that use a sigmoid (as opposed to a ReLU) nonlinearity. To do this, we trained networks with a tanh nonlinearity (shifted for a meaningful comparison with ReLU, so that the lower bound on firing rates was 0, rather than− 1) and found qualitatively similar results to the ReLU networks. In particular, color inputs drove neural activity towards 0 firing rate during the color period in <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> networks but not in <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> networks (<xref rid="figS6" ref-type="fig">Supplementary Fig. 6</xref>, compare a and b), which resulted in a lower metabolic cost during the color period for <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> networks compared to <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> networks (<xref rid="figS6" ref-type="fig">Supplementary Fig. 6c</xref>). This was reflected in color inputs being more strongly negative in <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> networks compared to <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> networks which only showed chance levels of negative color inputs (<xref rid="figS6" ref-type="fig">Supplementary Fig. 6d</xref>).</p>
<p>We next sought to test whether this mechanism could also explain the decrease in color decodability over learning that we observed in the lPFC data. To do this, we measured the magnitude of firing rates in the fixation, color, and shape periods for both early and late learning (note that the magnitude of firing rates coincides with our definition of the metabolic cost; cf. <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> and <xref rid="fig5" ref-type="fig">Fig. 5c</xref>). To decrease metabolic cost over learning, we would expect two changes: firing rates should decrease with learning and firing rates should not significantly increase from the fixation to the color period after learning (<xref rid="fig5" ref-type="fig">Fig. 5c</xref>, pink line). Indeed, we found that firing rates decreased significantly over the course of learning in all task periods (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, far left; compare gray and black lines), and this decrease was most substantial during the fixation and color periods (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, far left). We also found that after learning, firing rates during the color period were not significantly higher than during the fixation period (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, far left; compare black error bars during fixation and color periods). During the shape period however, firing rates increased significantly compared to those during the fixation period (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, far left; compare black error bars during fixation and shape periods). Therefore, the late learning dynamics of the data are in line with what we saw for the optimized 2-neuron <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> network (<xref rid="fig5" ref-type="fig">Fig. 5c</xref>, pink line).</p>
<p>We then compared these results from our neural recordings with the results from our large networks trained in different noise and regularization regimes. We found that for <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> networks, over the course of learning, firing rates decreased slightly during the fixation and color periods but actually increased during the shape period (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, middle left pale blue shading; compare gray and black lines). Additionally, after learning, firing rates increased between fixation and color periods and between color and shape periods (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, middle left pale blue shading; compare black error bars). For <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> networks, over the course of learning, we found that firing rates did not significantly change during the fixation and color periods but increased significantly during the shape period (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, middle right purple shading; compare gray and black lines). Furthermore, after learning, firing rates did not change significantly between fixation and color periods but did increase significantly between color and shape periods (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, middle right purple shading; compare black error bars). Finally, for the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> networks, we found a pattern of results that was most consistent with the data. Firing rates decreased over the course of learning in all task periods (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, far right pink shading; compare gray and black lines) and the decrease in firing rates was most substantial during the fixation and color periods. After learning, firing rates did not change significantly from fixation to color periods but did increase significantly during the shape period (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, far right; compare black error bars).</p>
<p>To investigate whether these findings depended on our random network initialization prior to training, we also compared late learning firing rates to firing rates that resulted from randomly shuffling the color, shape, and width inputs (which emulates alternative tasks where different combinations of color, shape, and width are relevant). For example, the relative strengths of the 3 inputs to the network prior to training on this task may affect how the firing rates change over learning. Under this control, we also found that <italic>σ</italic><sub><italic>m</italic></sub>, <italic>λ</italic><sub><italic>m</italic></sub> networks bore a close resemblance to the data (<xref rid="figS5" ref-type="fig">Supplementary Fig. 5d</xref>, compare black lines to blue lines).</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Comparing the neural representations of taskoptimized networks with those observed in experimental data has been particularly fruitful in recent years <sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c19">19</xref>,<xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c31">31</xref>,<xref ref-type="bibr" rid="c34">34</xref>–<xref ref-type="bibr" rid="c36">36</xref></sup>. However, networks are typically optimized using only a very limited range of hyperparameter values <sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c19">19</xref>,<xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c31">31</xref>–<xref ref-type="bibr" rid="c35">35</xref></sup>. Instead, here we showed that different settings of key, biologically relevant hyperparameters such as noise and metabolic costs, can yield a variety of qualitatively different dynamical regimes that bear varying degrees of similarity with experimental data. In general, we found that increasing levels of noise and firing rate regularization led to increasing amounts of irrelevant information being filtered out in the networks. Indeed, filtering out of task-irrelevant information is a well-known property of the PFC and has been observed in a variety of tasks <sup><xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c31">31</xref>,<xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c49">49</xref>,<xref ref-type="bibr" rid="c51">51</xref>–<xref ref-type="bibr" rid="c53">53</xref></sup>. We provide a mechanistic understanding of the specific conditions that lead to stronger filtering of task-irrelevant information. We predict that these results should also generalize to richer, more complex cognitive tasks that may, for example, require context switching <sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c52">52</xref></sup> or invoke working memory <sup><xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c52">52</xref></sup>. Indeed, filtering out of taskirrelevant information in the PFC has been observed in such tasks <sup><xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c52">52</xref>,<xref ref-type="bibr" rid="c54">54</xref></sup>.</p>
<p>Our results are also likely a more general finding of neural circuits that extend beyond the PFC. In line with this, it has previously been shown that strongly regularized neural network models trained to reproduce monkey muscle activities during reaching bore a stronger resemblance to neural recordings from primary motor cortex compared to unregularized models <sup><xref ref-type="bibr" rid="c19">19</xref></sup>. In related work on motor control, recurrent networks controlled by an optimal feedback controller recapitulated key aspects of experimental recordings from primary motor cortex (such as orthogonality between preparatory and movement neural activities) when the control input was regularized <sup><xref ref-type="bibr" rid="c24">24</xref></sup>. Additionally, regularization of neural firing rates, and its natural biological interpretation as a metabolic cost, has recently been shown to be a key ingredient for the formation of grid cell-like response profiles in artificial networks <sup><xref ref-type="bibr" rid="c18">18</xref>,<xref ref-type="bibr" rid="c22">22</xref></sup>.</p>
<p>By showing that PFC representations changed in line with a minimal representational strategy, our results are in line with various studies showing lowdimensional representations under a variety of tasks in the PFC and other brain regions <sup><xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c31">31</xref>,<xref ref-type="bibr" rid="c55">55</xref>,<xref ref-type="bibr" rid="c56">56</xref></sup>. This is in contrast to several previous observations of highdimensional neural activity in PFC <sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c10">10</xref></sup>. Both highand low-dimensional regimes confer distinct yet useful benefits: high-dimensional representations allow many behavioural readouts to be generated, thereby enabling highly flexible behaviour <sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c57">57</xref>–<xref ref-type="bibr" rid="c59">59</xref></sup>, whereas low-dimensional representations are more robust to noise and allow for generalization across different stimuli <sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c59">59</xref></sup>. These two different representational strategies have previously been studied in models by setting the initial network weights to either small values (to generate low-dimensional ‘rich’ representations) or large values <sup><xref ref-type="bibr" rid="c15">15</xref></sup> (to generate high-dimensional ‘lazy’ representations). However, in contrast to previous approaches, we studied the more biologically plausible effects of firing rate regularization (i.e. a metabolic cost; see also the supplement of Ref. 15) on the network activities over the course of learning and compared them to learning-related changes in PFC neural activities. Firing rate regularization will cause neural activities to wax and wane as networks are exposed to new tasks depending upon the stimuli that are currently relevant. In line with this, it is conceivable that prolonged exposure to a task that has a limited number of stimulus conditions, some of which can even be generalized over (as was the case for our task), encourages more low dimensional dynamics to form <sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c48">48</xref>,<xref ref-type="bibr" rid="c59">59</xref>–<xref ref-type="bibr" rid="c61">61</xref></sup>. In contrast, tasks that use a rich variety of stimuli (that may even dynamically change over the task <sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c62">62</xref></sup>), and which do not involve generalization across stimulus conditions, may more naturally lead to high-dimensional representations <sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c48">48</xref>,<xref ref-type="bibr" rid="c59">59</xref>,<xref ref-type="bibr" rid="c61">61</xref>,<xref ref-type="bibr" rid="c63">63</xref></sup>. It would therefore be an important future question to understand how our results also depend on the task being studied as some tasks may more naturally lead to the ‘maximal’ representational regime <sup><xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c48">48</xref>,<xref ref-type="bibr" rid="c61">61</xref></sup> (<xref rid="fig1" ref-type="fig">Figs. 1</xref>– <xref ref-type="fig" rid="fig3">3</xref> and <xref ref-type="fig" rid="fig5">5</xref>, blue shading).</p>
<p>A previous analysis of the same dataset that we studied here focused on the late parts of the trial <sup><xref ref-type="bibr" rid="c1">1</xref></sup>. In particular, they found that the final result of the computation needed for the task, the XOR operation between color and shape, emerges and eventually comes to dominate lPFC representations over the course of learning in the late shape period <sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Our analysis goes beyond this by studying mechanisms of suppression of both static and dynamically irrelevant stimuli across all task periods and how different levels of neural noise and metabolic cost can lead to qualitatively different representations of irrelevant stimuli in task-optimized recurrent networks. Other previous studies focused on characterizing the representation of several taskrelevant <sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup> (and, in some cases, -irrelevant <sup><xref ref-type="bibr" rid="c15">15</xref></sup>) variables over the course of individual trials. Characterizing how key aspects of neural representations change over the course of learning, as we did here, offers unique opportunities for studying the functional objectives shaping neural representations <sup><xref ref-type="bibr" rid="c42">42</xref></sup>.</p>
<p>There were several aspects of the data that were not well captured by our models. For example, during the shape period, decodability of shape decreased while decodability of color increased (although not significantly) in our neural recordings (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>). These differences in changes in decoding may be due to fundamentally different ways that brains encode sensory information upstream of PFC, compared to our models. For example, shape and width are both geometric features of the stimulus, whose encoding is differentiated from that of color already at early stages of visual processing <sup><xref ref-type="bibr" rid="c64">64</xref></sup>. Such a hierarchical representation of inputs may automatically lead to the (un)learning about the relevance of width (which the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> model reproduced) generalizing to shape, but not to color. In contrast, inputs in our model used a non-hierarchical one-hot encoding (<xref rid="fig2" ref-type="fig">Fig. 2</xref>), which did not allow for such generalization. Moreover, in the data, we may expect width to be <italic>a priori</italic> more strongly represented than color or shape because it is a much more potent sensory feature. In line with this, in our neural recordings, we found that width was very strongly represented in early learning compared to the other stimulus features (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, far right) and width always yielded high cross-generalized decoding — even after learning (<xref rid="figS2" ref-type="fig">Supplementary Fig. 2a</xref>, far right). Nevertheless, studying <italic>changes</italic> in decoding over learning, rather than absolute decoding levels, allowed us to focus on features of learning that do not depend on the details of upstream sensory representations of stimuli. Future studies could incorporate aspects of sensory representations that we ignored here by using stimulus inputs with which the model more faithfully reproduces the experimentally observed initial decodability of stimulus features.</p>
<p>In line with previous studies <sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c18">18</xref>–<xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c24">24</xref>,<xref ref-type="bibr" rid="c31">31</xref>–<xref ref-type="bibr" rid="c33">33</xref>,<xref ref-type="bibr" rid="c35">35</xref>,<xref ref-type="bibr" rid="c46">46</xref>,<xref ref-type="bibr" rid="c47">47</xref></sup>, we operationalized metabolic cost in our models through <italic>L</italic><sub>2</sub> firing rate regularization. This cost penalizes high overall firing rates. There are however alternative conceivable ways to operationalize a metabolic cost; for example <italic>L</italic><sub>1</sub> firing rate regularization has been used previously when optimizing neural networks and promotes more sparse neural firing <sup><xref ref-type="bibr" rid="c3">3</xref></sup>. Interestingly, although our <italic>L</italic><sub>2</sub> is generally conceived to be weaker than <italic>L</italic><sub>1</sub> regularization, we still found that it encouraged the network to use purely sub-threshold activity in our task. The regularization of synaptic weights may also be biologically relevant <sup><xref ref-type="bibr" rid="c3">3</xref></sup> because synaptic transmission uses the most energy in the brain compared to other processes <sup><xref ref-type="bibr" rid="c65">65</xref>,<xref ref-type="bibr" rid="c66">66</xref></sup>. Additionally, even subthreshold activity could be regularized as it also consumes energy (although orders of magnitude less than spiking <sup><xref ref-type="bibr" rid="c67">67</xref></sup>). Therefore, future work will be needed to examine how different metabolic costs affect the dynamics of task-optimized networks.</p>
<p>We build on several previous studies that have also analysed learning-related changes in PFC activity <sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c39">39</xref>,<xref ref-type="bibr" rid="c63">63</xref></sup> — although these studies typically used reversal-learning paradigms in which animals are already highly task proficient and the effects of learning and task switching are inseparable. For example, in a rule-based categorization task in which the categorization rule changed after learning an initial rule, neurons in mouse PFC adjusted their selectivity depending on the rule such that currently irrelevant information was not represented <sup><xref ref-type="bibr" rid="c38">38</xref></sup>. Similarly, neurons in rat PFC transition rapidly from representing a familiar rule to representing a completely novel rule through trial and error learning <sup><xref ref-type="bibr" rid="c39">39</xref></sup>. Additionally, the dimensionality of PFC representations was found to increase as monkeys learned the value of novel stimuli <sup><xref ref-type="bibr" rid="c63">63</xref></sup>. Importantly, however, PFC representations did not distinguish between novel stimuli when they were first chosen. It was only once the value of the stimuli were learned that their representations in PFC were distinguishable <sup><xref ref-type="bibr" rid="c63">63</xref></sup>. These results are consistent with our results where we found poor XOR decoding during the early stages of learning which then increased over learning as the monkeys learned the rewarded conditions (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, far left). However, we also observed high decoding of width during early learning which was not predictive of reward (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, far right). One key distinction between our study and that of Ref. 63, is that our recordings commenced from the first trial the monkeys were exposed to the task. In contrast, in Ref. 63, the monkeys were already highly proficient at the task and so the neural representation of their task was already likely strongly task specific by the time recordings were taken.</p>
<p>In line with our approach here, several recent studies have also examined the effects of different hyperparameter settings on the solution that optimized networks exhibit. One study found that decreasing regularization on network weights led to more sequential dynamics in networks optimized to perform working memory tasks <sup><xref ref-type="bibr" rid="c20">20</xref></sup>. Another study found that the number of functional clusters that a network exhibits does not depend strongly on the strength of (<italic>L</italic><sub>1</sub> rate or weight) regularization, but did depend upon whether the single neuron nonlinearity saturates at high firing rates <sup><xref ref-type="bibr" rid="c3">3</xref></sup>. It has also been shown that networks optimized to perform path integration can exhibit a range of different properties, from grid cell-like receptive fields to distinctly non grid cell-like receptive fields, depending upon biologically relevant hyperparameters — including noise and regularization <sup><xref ref-type="bibr" rid="c18">18</xref>,<xref ref-type="bibr" rid="c22">22</xref>,<xref ref-type="bibr" rid="c37">37</xref></sup>. Indeed, in addition to noise and regularization, various other hyperparameters have also been shown to affect the representational strategy used by a circuit, such as the firing rate nonlinearity <sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c18">18</xref>,<xref ref-type="bibr" rid="c37">37</xref></sup> and network weight initialization <sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c37">37</xref></sup>. It is therefore becoming increasingly clear that analysing the interplay between learning and biological constraints will be key for understanding the computations that various brain regions perform.</p>
</sec>
<sec id="d1e2367" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e2467">
<label>Supplementary appendix</label>
<media xlink:href="supplements/548492_file02.pdf"/>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="other"><string-name><surname>Wójcik</surname>, <given-names>M. J.</given-names></string-name> <etal>et al.</etal> <article-title>Learning shapes neural dimensionality in the prefrontal cortex</article-title>. <source>bioRxiv</source> 2023.04.24.538054 (<year>2023</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Rigotti</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>The importance of mixed selectivity in complex cognitive tasks</article-title>. <source>Nature</source> <volume>497</volume>, <fpage>585</fpage>–<lpage>590</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Yang</surname>, <given-names>G. R.</given-names></string-name>, <string-name><surname>Joglekar</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>Song</surname>, <given-names>H. F.</given-names></string-name>, <string-name><surname>Newsome</surname>, <given-names>W. T.</given-names></string-name> &amp; <string-name><surname>Wang</surname>, <given-names>X.-J.</given-names></string-name> <article-title>Task representations in neural networks trained to perform many cognitive tasks</article-title>. <source>Nat. Neurosci</source>. <volume>22</volume>, <fpage>297</fpage>–<lpage>306</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Wang</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Narain</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Hosseini</surname>, <given-names>E. A.</given-names></string-name> &amp; <string-name><surname>Jazayeri</surname>, <given-names>M.</given-names></string-name> <article-title>Flexible timing by temporal scaling of cortical responses</article-title>. <source>Nature Neuroscience</source> <volume>21</volume>, <fpage>102</fpage>–<lpage>110</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Silver</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>Mastering the game of Go with deep neural networks and tree search</article-title>. <source>Nature</source> <volume>529</volume>, <fpage>484</fpage>–<lpage>489</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="other"><string-name><surname>Jensen</surname>, <given-names>K. T.</given-names></string-name>, <string-name><surname>Hennequin</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Mattar</surname>, <given-names>M. G.</given-names></string-name> <article-title>A recurrent network model of planning explains hippocampal replay and human behavior</article-title>. <source>bioRxiv</source> 2023.01.16.523429 (<year>2023</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Freedman</surname>, <given-names>D. J.</given-names></string-name>, <string-name><surname>Riesenhuber</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Poggio</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Miller</surname>, <given-names>E. K.</given-names></string-name> <article-title>Categorical representation of visual stimuli in the primate prefrontal cortex</article-title>. <source>Science</source> <volume>291</volume>, <fpage>312</fpage>–<lpage>316</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Mante</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Sussillo</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Shenoy</surname>, <given-names>K. V.</given-names></string-name> &amp; <string-name><surname>Newsome</surname>, <given-names>W. T.</given-names></string-name> <article-title>Context-dependent computation by recurrent dynamics in prefrontal cortex</article-title>. <source>Nature</source> <volume>503</volume>, <fpage>78</fpage>–<lpage>84</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Parthasarathy</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Mixed selectivity morphs population codes in prefrontal cortex</article-title>. <source>Nature Neuroscience</source> <volume>20</volume>, <fpage>1770</fpage>–<lpage>1779</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Bernardi</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>The Geometry of Abstraction in the Hippocampus and Prefrontal Cortex</article-title>. <source>Cell</source> <volume>183</volume>, <fpage>954</fpage>–<lpage>967</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Chadwick</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Learning shapes cortical dynamics to enhance integration of relevant sensory input</article-title>. <source>Neuron</source> <volume>111</volume>, <fpage>106</fpage>–<lpage>120</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Duncan</surname>, <given-names>J.</given-names></string-name> <article-title>An adaptive coding model of neural function in the prefrontal cortex</article-title>. <source>Nature Reviews Neuroscience</source> <volume>2</volume>, <fpage>820</fpage>–<lpage>829</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Rainer</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Asaad</surname>, <given-names>W. F.</given-names></string-name> &amp; <string-name><surname>Miller</surname>, <given-names>E. K.</given-names></string-name> <article-title>Selective representation of relevant information by neurons in the primate prefrontal cortex</article-title>. <source>Nature</source> <volume>393</volume>, <fpage>577</fpage>–<lpage>579</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Stokes</surname>, <given-names>M. G.</given-names></string-name> <etal>et al.</etal> <article-title>Dynamic coding for cognitive control in prefrontal cortex</article-title>. <source>Neuron</source> <volume>78</volume>, <fpage>364</fpage>–<lpage>375</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Flesch</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Juechems</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Dumbalska</surname>, <given-names>T.</given-names></string-name>, Saxe, &amp; <string-name><surname>Summerfield</surname>, <given-names>C.</given-names></string-name> <article-title>Orthogonal representations for robust context-dependent task performance in brains and neural networks</article-title>. <source>Neuron</source> <volume>110</volume>, <fpage>1258</fpage>–<lpage>1270</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Monsell</surname>, <given-names>S.</given-names></string-name> <article-title>Task switching</article-title>. <source>Trends in Cognitive Sciences</source> <volume>7</volume>, <fpage>134</fpage>–<lpage>140</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Braver</surname>, <given-names>T. S.</given-names></string-name> <article-title>The variable nature of cognitive control: A dual mechanisms framework</article-title>. <source>Trends in Cognitive Sciences</source> <volume>16</volume>, <fpage>106</fpage>–<lpage>113</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="other"><string-name><surname>Whittington</surname>, <given-names>J. C. R.</given-names></string-name>, <string-name><surname>Dorrell</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Ganguli</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Behrens</surname>, <given-names>T. E. J.</given-names></string-name> <article-title>Disentangling with Biological Constraints: A Theory of Functional Cell Types</article-title>. <source>arXiv</source> 2210.01768 (<year>2022</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Sussillo</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Churchland</surname>, <given-names>M. M.</given-names></string-name>, <string-name><surname>Kaufman</surname>, <given-names>M. T.</given-names></string-name> &amp; <string-name><surname>Shenoy</surname>, <given-names>K. V.</given-names></string-name> <article-title>A neural network that finds a natu-ralistic solution for the production of muscle activity</article-title>. <source>Nature Neuroscience</source> <volume>18</volume>, <fpage>1025</fpage>–<lpage>1033</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Orhan</surname>, <given-names>A. E.</given-names></string-name> &amp; <string-name><surname>Ma</surname>, <given-names>W. J.</given-names></string-name> <article-title>A diverse range of factors affect the nature of neural representations underlying short-term memory</article-title>. <source>Nature Neuroscience</source> <volume>22</volume>, <fpage>275</fpage>–<lpage>283</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="other"><string-name><surname>Löwe</surname>, <given-names>A. T.</given-names></string-name> <etal>et al.</etal> <article-title>Regularised neural networks mimic human insight</article-title>. <source>arXiv</source> 2302.11351 (<year>2023</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="other"><string-name><surname>Cueva</surname>, <given-names>C. J.</given-names></string-name> &amp; <string-name><surname>Wei</surname>, <given-names>X. X.</given-names></string-name> <article-title>Emergence of grid-like representations by training recurrent neural networks to perform spatial localization</article-title>. <source>6th International Conference on Learning Representations, ICLR 2018 - Conference Track Proceedings</source> <fpage>1</fpage>–<lpage>19</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="other"><string-name><surname>Luo</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Mok</surname>, <given-names>R. M.</given-names></string-name>, <string-name><surname>Roads</surname>, <given-names>B. D.</given-names></string-name> &amp; <string-name><surname>Love</surname>, <given-names>B. C.</given-names></string-name> <article-title>A controller-peripheral architecture and costly energy principle for learning</article-title>. <source>bioRxiv</source> 2023.01.16.524194 (<year>2023</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Kao</surname>, <given-names>T. C.</given-names></string-name>, <string-name><surname>Sadabadi</surname>, <given-names>M. S.</given-names></string-name> &amp; <string-name><surname>Hennequin</surname>, <given-names>G.</given-names></string-name> <article-title>Optimal anticipatory control as a theory of motor preparation: A thalamo-cortical circuit model</article-title>. <source>Neuron</source> <volume>109</volume>, <fpage>1567</fpage>–<lpage>1581</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Deneve</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Latham</surname>, <given-names>P. E.</given-names></string-name> &amp; <string-name><surname>Pouget</surname>, <given-names>A.</given-names></string-name> <article-title>Efficient computation and cue integration with noisy population codes</article-title>. <source>Nature Neuroscience</source> <volume>4</volume>, <fpage>826</fpage>–<lpage>831</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Barak</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Sussillo</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Romo</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Tsodyks</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Abbott</surname>, <given-names>L. F.</given-names></string-name> <article-title>From fixed points to chaos: Three models of delayed discrimination</article-title>. <source>Progress in Neurobiology</source> <volume>103</volume>, <fpage>214</fpage>–<lpage>222</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Tomko</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Crapper</surname>, <given-names>D.</given-names></string-name> <article-title>Neuronal Variability: Non-stationary responses to identical visaul stimuli</article-title>. <source>Brain Research</source> <volume>79</volume>, <fpage>405</fpage>–<lpage>418</lpage> (<year>1974</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Laughlin</surname>, <given-names>S. B.</given-names></string-name> <article-title>Energy as a constraint on the coding and processing of sensory information</article-title>. <source>Current Opinion in Neurobiology</source> <volume>11</volume>, <fpage>475</fpage>–<lpage>480</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Churchland</surname>, <given-names>M. M.</given-names></string-name> <article-title>Neural Variability in Premotor Cortex Provides a Signature of Motor Preparation</article-title>. <source>Journal of Neuroscience</source> <volume>26</volume>, <fpage>3697</fpage>–<lpage>3712</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Hasenstaub</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Otte</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Callaway</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Sejnowski</surname>, <given-names>T. J.</given-names></string-name> <article-title>Metabolic cost as a unifying principle governing neuronal biophysics</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>107</volume>, <fpage>12329</fpage>–<lpage>12334</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Cueva</surname>, <given-names>C. J.</given-names></string-name> <etal>et al.</etal> <article-title>Low-dimensional dynamics for working memory and time encoding</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>117</volume>, <fpage>23021</fpage>–<lpage>23032</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="other"><string-name><surname>Driscoll</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Shenoy</surname>, <given-names>K. V.</given-names></string-name> &amp; <string-name><surname>Sussillo</surname>, <given-names>D.</given-names></string-name> <article-title>Flexible multitask computation in recurrent networks utilizes shared dynamical motifs</article-title>. <source>bioRxiv</source> 2022.08.15.503870 (<year>2022</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Song</surname>, <given-names>H. F.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>G. R.</given-names></string-name> &amp; <string-name><surname>Wang</surname>, <given-names>X. J.</given-names></string-name> <article-title>Training Excitatory-Inhibitory Recurrent Neural Networks for Cognitive Tasks: A Simple and Flexible Framework</article-title>. <source>PLoS Computational Biology</source> <volume>12</volume>, <fpage>1</fpage>–<lpage>30</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Echeveste</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Aitchison</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Hennequin</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Lengyel</surname>, <given-names>M.</given-names></string-name> <article-title>Cortical-like dynamics in recurrent circuits optimized for sampling-based probabilistic inference</article-title>. <source>Nature Neuroscience</source> <volume>23</volume>, <fpage>1138</fpage>–<lpage>1149</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Stroud</surname>, <given-names>J. P.</given-names></string-name>, <string-name><surname>Watanabe</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Suzuki</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Stokes</surname>, <given-names>M. G.</given-names></string-name> &amp; <string-name><surname>Lengyel</surname>, <given-names>M.</given-names></string-name> <article-title>Optimal information loading into working memory in prefrontal cortex explains dynamic coding</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>120</volume>, 2021.11.16.468360 (<year>2023</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Lindsay</surname>, <given-names>G. W.</given-names></string-name> <article-title>Convolutional neural networks as a model of the visual system: Past, present, and future</article-title>. <source>Journal of Cognitive Neuroscience</source> <volume>33</volume>, <fpage>2017</fpage>–<lpage>2031</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="other"><string-name><surname>Schaeffer</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Khona</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Fiete</surname>, <given-names>I. R.</given-names></string-name> <article-title>No Free Lunch from Deep Learning in Neuroscience: A Case Study through Models of the Entorhinal-Hippocampal Circuit</article-title>. <source>bioRxiv</source> 2022.08.07.503109 (<year>2022</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Reinert</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Hübener</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Bonhoeffer</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Goltstein</surname>, <given-names>P. M.</given-names></string-name> <article-title>Mouse prefrontal cortex represents learned rules for categorization</article-title>. <source>Nature</source> <volume>593</volume>, <fpage>411</fpage>–<lpage>417</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><surname>Durstewitz</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Vittoz</surname>, <given-names>N. M.</given-names></string-name>, <string-name><surname>Floresco</surname>, <given-names>S. B.</given-names></string-name> &amp; <string-name><surname>Seamans</surname>, <given-names>J. K.</given-names></string-name> <article-title>Abrupt transitions between prefrontal neural ensemble states accompany behavioral transitions during rule learning</article-title>. <source>Neuron</source> <volume>66</volume>, <fpage>438</fpage>–<lpage>448</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><surname>Schuessler</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Mastrogiuseppe</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Dubreuil</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Ostojic</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Barak</surname>, <given-names>O.</given-names></string-name> <article-title>The interplay between randomness and structure during learning in RNNs</article-title>. <source>Advances in Neural Information Processing Systems</source> <volume>33</volume>, <fpage>13352</fpage>–<lpage>13362</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><string-name><surname>Costa</surname>, <given-names>R. P.</given-names></string-name> <etal>et al.</etal> <article-title>Synaptic Transmission Optimization Predicts Expression Loci of Long-Term Plasticity</article-title>. <source>Neuron</source> <volume>96</volume>, <fpage>177</fpage>–<lpage>189</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><string-name><surname>Richards</surname>, <given-names>B. A.</given-names></string-name> <etal>et al.</etal> <article-title>A deep learning framework for neuroscience</article-title>. <source>Nature Neuroscience</source> <volume>22</volume>, <fpage>1761</fpage>–<lpage>1770</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><string-name><surname>Meyers</surname>, <given-names>E. M.</given-names></string-name>, <string-name><surname>Freedman</surname>, <given-names>D. J.</given-names></string-name>, <string-name><surname>Kreiman</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Miller</surname>, <given-names>E. K.</given-names></string-name> &amp; <string-name><surname>Poggio</surname>, <given-names>T.</given-names></string-name> <article-title>Dynamic population coding of category information in inferior temporal and prefrontal cortex</article-title>. <source>Journal of Neurophysiology</source> <volume>100</volume>, <fpage>1407</fpage>–<lpage>1419</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><string-name><surname>King</surname>, <given-names>J. R.</given-names></string-name> &amp; <string-name><surname>Dehaene</surname>, <given-names>S.</given-names></string-name> <article-title>Characterizing the dynamics of mental representations: The temporal generalization method</article-title>. <source>Trends in Cognitive Sciences</source> <volume>18</volume>, <fpage>203</fpage>–<lpage>210</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><string-name><surname>Dicarlo</surname>, <given-names>J. J.</given-names></string-name> &amp; <string-name><surname>Cox</surname>, <given-names>D. D.</given-names></string-name> <article-title>Untangling invariant object recognition</article-title>. <source>Trends in Cognitive Sciences</source> <volume>11</volume>, <fpage>333</fpage>–<lpage>341</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><string-name><surname>Masse</surname>, <given-names>N. Y.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>G. R.</given-names></string-name>, <string-name><surname>Song</surname>, <given-names>H. F.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>X. J.</given-names></string-name> &amp; <string-name><surname>Freedman</surname>, <given-names>D. J.</given-names></string-name> <article-title>Circuit mechanisms for the maintenance and manipulation of information in working memory</article-title>. <source>Nature Neuroscience</source> <volume>22</volume>, <fpage>1159</fpage>–<lpage>1167</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="other"><string-name><surname>Schimel</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Kao</surname>, <given-names>T.-c.</given-names></string-name> &amp; <string-name><surname>Hennequin</surname>, <given-names>G.</given-names></string-name> <article-title>When and why does motor preparation arise in recurrent neural network models of motor control?</article-title> <source>bioRxiv</source> 2023.04.03.535429 (<year>2023</year>).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><string-name><surname>Dubreuil</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Valente</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Beiran</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Mastrogiuseppe</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Ostojic</surname>, <given-names>S.</given-names></string-name> <article-title>The role of population structure in computations through neural dynamics</article-title>. <source>Nature Neuroscience</source> <volume>25</volume>, <fpage>783</fpage>–<lpage>794</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><string-name><surname>Miller</surname>, <given-names>E. K.</given-names></string-name> &amp; <string-name><surname>Cohen</surname>, <given-names>J. D.</given-names></string-name> <article-title>An integrative theory of prefrontal cortex function</article-title>. <source>Annual Review of Neuroscience</source> <volume>24</volume>, <fpage>167</fpage>–<lpage>202</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><string-name><surname>Epsztein</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Brecht</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Lee</surname>, <given-names>A. K.</given-names></string-name> <article-title>Intracellular Determinants of Hippocampal CA1 Place and Silent Cell Activity in a Novel Environment</article-title>. <source>Neuron</source> <volume>70</volume>, <fpage>109</fpage>–<lpage>120</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><string-name><surname>Rainer</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Miller</surname>, <given-names>E. K.</given-names></string-name> <article-title>Timecourse of object-related neural activity in the primate prefrontal cortex during a short-term memory task</article-title>. <source>European Journal of Neuroscience</source> <volume>15</volume>, <fpage>1244</fpage>–<lpage>1254</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><string-name><surname>Asaad</surname>, <given-names>W. F.</given-names></string-name>, <string-name><surname>Rainer</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Miller</surname>, <given-names>E. K.</given-names></string-name> <article-title>Task-specific neural activity in the primate prefrontal cortex</article-title>. <source>Journal of Neurophysiology</source> <volume>84</volume>, <fpage>451</fpage>–<lpage>459</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><string-name><surname>Everling</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Tinsley</surname>, <given-names>C. J.</given-names></string-name>, <string-name><surname>Gaffan</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Duncan</surname>, <given-names>J.</given-names></string-name> <article-title>Filtering of neural signals by focused attention in the monkey prefrontal cortex</article-title>. <source>Nature Neuroscience</source> <volume>5</volume>, <fpage>671</fpage>–<lpage>676</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><string-name><surname>Mack</surname>, <given-names>M. L.</given-names></string-name>, <string-name><surname>Preston</surname>, <given-names>A. R.</given-names></string-name> &amp; <string-name><surname>Love</surname>, <given-names>B. C.</given-names></string-name> <article-title>Ventro-medial prefrontal cortex compression during concept learning</article-title>. <source>Nature Communications</source> <volume>11</volume>, <fpage>1</fpage>–<lpage>11</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><string-name><surname>Ganguli</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>One-Dimensional Dynamics of Attention and Decision Making in LIP</article-title>. <source>Neuron</source> <volume>58</volume>, <fpage>15</fpage>–<lpage>25</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><string-name><surname>Sohn</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Narain</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Meirhaeghe</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Jazayeri</surname>, <given-names>M.</given-names></string-name> <article-title>Bayesian Computation through Cortical Latent Dynamics</article-title>. <source>Neuron</source> <volume>103</volume>, <fpage>934</fpage>–<lpage>947</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><string-name><surname>Enel</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Procyk</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Quilodran</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Dominey</surname>, <given-names>P. F.</given-names></string-name> <article-title>Reservoir Computing Properties of Neural Dynamics in Prefrontal Cortex</article-title>. <source>PLoS Computational Biology</source> <volume>12</volume>, <fpage>1</fpage>–<lpage>35</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><string-name><surname>Maass</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Natschläger</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Markram</surname>, <given-names>H.</given-names></string-name> <article-title>Realtime computing without stable states: A new framework for neural computation based on perturbations</article-title>. <source>Neural Computation</source> <volume>14</volume>, <fpage>2531</fpage>–<lpage>2560</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><string-name><surname>Fusi</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Miller</surname>, <given-names>E. K.</given-names></string-name> &amp; <string-name><surname>Rigotti</surname>, <given-names>M.</given-names></string-name> <article-title>Why neurons mix: High dimensionality for higher cognition</article-title>. <source>Current Opinion in Neurobiology</source> <volume>37</volume>, <fpage>66</fpage>–<lpage>74</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="other"><string-name><surname>Musslick</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Multitasking Capability Versus Learning Efficiency in Neural Network Architectures</article-title>. <source>CogSci 2017 - Proceedings of the 39th Annual Meeting of the Cognitive Science Society</source> <fpage>829</fpage>–<lpage>834</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="journal"><string-name><surname>Mastrogiuseppe</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Ostojic</surname>, <given-names>S.</given-names></string-name> <article-title>Linking Connectivity, Dynamics, and Computations in Low-Rank Recurrent Neural Networks</article-title>. <source>Neuron</source> <volume>99</volume>, <fpage>609</fpage>–<lpage>623</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="journal"><string-name><surname>Heald</surname>, <given-names>J. B.</given-names></string-name>, <string-name><surname>Lengyel</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Wolpert</surname>, <given-names>D. M.</given-names></string-name> <article-title>Contextual inference underlies the learning of senso-rimotor repertoires</article-title>. <source>Nature</source> <volume>600</volume>, <fpage>489</fpage>–<lpage>493</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="journal"><string-name><surname>Bartolo</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Saunders</surname>, <given-names>R. C.</given-names></string-name>, <string-name><surname>Mitz</surname>, <given-names>A. R.</given-names></string-name> &amp; <string-name><surname>Aver-beck</surname>, <given-names>B. B.</given-names></string-name> <article-title>Dimensionality, information and learning in prefrontal cortex</article-title>. <source>PLoS Computational Biology</source> <volume>16</volume>, <fpage>1</fpage>–<lpage>26</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="book"><string-name><surname>Kandel</surname>, <given-names>E. R.</given-names></string-name> <etal>et al.</etal> <source>Principles of neural science</source>, vol. <volume>4</volume> (<publisher-name>McGraw-hill</publisher-name> <publisher-loc>New York</publisher-loc>, <year>2000</year>).</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><string-name><surname>Faria-Pereira</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Morais</surname>, <given-names>V. A.</given-names></string-name> <article-title>Synapses: The Brain’s Energy-Demanding Sites</article-title>. <source>International Journal of Molecular Sciences</source> <volume>23</volume> (<year>2022</year>).</mixed-citation></ref>
<ref id="c66"><label>66.</label><mixed-citation publication-type="journal"><string-name><surname>Harris</surname>, <given-names>J. J.</given-names></string-name>, <string-name><surname>Jolivet</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Attwell</surname>, <given-names>D.</given-names></string-name> <article-title>Synaptic Energy Use and Supply</article-title>. <source>Neuron</source> <volume>75</volume>, <fpage>762</fpage>–<lpage>777</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c67"><label>67.</label><mixed-citation publication-type="journal"><string-name><surname>Zhu</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Pan</surname>, <given-names>X.</given-names></string-name> &amp; <string-name><surname>Zhu</surname>, <given-names>Z.</given-names></string-name> <article-title>Energy expenditure computation of a single bursting neuron</article-title>. <source>Cognitive Neurodynamics</source> <volume>13</volume>, <fpage>75</fpage>–<lpage>87</lpage> (<year>2019</year>).</mixed-citation></ref>
</ref-list>
<ack>
<title>Acknowledgements</title>
<p>This work was funded by the Wellcome Trust (Investigator Award in Science 212262/Z/18/Z to M.L., Sir Henry Wellcome Postdoctoral Fellowship 215909/Z/19/Z to J.S., and award 101092/Z/13/Z to M.K., M.K., and J.D.), the Human Frontier Science Programme (Research Grant RGP0044/2018 to M.L.), the Medical Research Council UK Program (MC_UU_00030/7 to M.K., M.K., and J.D.), the Biotechnology and Biological Sciences Research Council (award BB/M010732/1 to M.G.S.), a GatesCambridge scholarship (to K.T.J.), a Clarenden scholarship and Saven European scholarship (to M.W.), and the James S. McDonnell Foundation (award 220020405 to M.G.S.). For the purpose of open access, the authors have applied a CC-BY public copyright licence to any author accepted manuscript version arising from this submission. We thank Christopher Summerfield for useful feedback and detailed comments on the manuscript.</p>
</ack>
<sec id="s4">
<title>Author Contributions</title>
<p>J.P.S., M.W., J.D., and M.G.S. conceived the study. J.D. and M.J.B. led the experimental recordings and M.W., M.K., and M.K. performed the experimental recordings and data pre-processing. J.P.S., K.T.J, and M.L. developed the theoretical framework and performed analytical derivations. J.P.S. performed all numerical simulations, and produced the figures. J.P.S. and M.W. performed the data analysis. J.P.S., M.W., K.T.J., and M.L. interpreted the results. All authors revised the final manuscript.</p>
</sec>
<sec id="s5">
<title>Competing Interests statement</title>
<p>The authors declare no competing interests.</p>
</sec>
<sec id="s6">
<title>Code availability</title>
<p>All code was custom written in Python using NumPy, SciPy, Matplotlib, Scikit-learn, and Tensorflow libraries. Code is available in the following repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/jakepstroud">https://github.com/jakepstroud</ext-link>.</p>
</sec>
<sec id="s7">
<label>1</label>
<title>Methods</title>
<sec id="s7a">
<label>1.1</label>
<title>Experimental materials and methods</title>
<p>Experimental methods have been described previously <sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Briefly, two adult male rhesus macaques (monkey 1 and monkey 2) performed a passive object–association task (<xref rid="fig1" ref-type="fig">Fig. 1a,b</xref>; see the main text ‘A task involving relevant and irrelevant stimuli’ for a description of the task). Neural recordings commenced from the first session the animals were exposed to the task. All trials with fixation errors were excluded. The dataset contained on average 237.9 (s.d. = 23.9) and 104.8 (s.d. = 2.3) trials for each of the 8 conditions for monkeys 1 and 2, respectively. Data were recorded from the ventral and dorsal lateral PFC over a total of 27 daily sessions across both monkeys which yielded 146 and 230 neurons for monkey 1 and monkey 2, respectively. To compute neural firing rates, we convolved binary spike trains with a Gaussian kernel with a standard deviation of 50 ms. In order to characterize changes in neural dynamics over learning, analyses were performed separately on the first half of sessions (‘early learning’; 9 and 5 sessions from monkey 1 and monkey 2, respectively) and the second half of sessions (‘late learning’; 8 and 5 sessions from monkey 1 and monkey 2, respectively; <xref rid="fig3" ref-type="fig">Figs. 3</xref>–<xref ref-type="fig" rid="fig5">5</xref> and <xref rid="figS2" ref-type="fig">Supplementary Fig. 2a</xref>).</p>
</sec>
<sec id="s7b">
<label>1.2</label>
<title>Neural network models</title>
<p>The dynamics of our simulated networks evolved according to <xref ref-type="disp-formula" rid="eqn1">Eqs. 1</xref> and <xref ref-type="disp-formula" rid="eqn2">2</xref> and are repeated here:
<disp-formula id="eqn5">
<graphic xlink:href="548492v2_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn6">
<graphic xlink:href="548492v2_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn7">
<graphic xlink:href="548492v2_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <bold>x</bold>(<italic>t</italic>) = (<italic>x</italic><sub>1</sub>(<italic>t</italic>), …, <italic>x</italic><sub><italic>N</italic></sub> (<italic>t</italic>))<sup><italic>⊤</italic></sup> corresponds to the vector of ‘subthreshold’ activities of the <italic>N</italic> neurons in the network, <bold>r</bold>(<italic>t</italic>) is their momentary firing rates, obtained as a rectified linear function (ReLU) of their subthreshold activities (<xref ref-type="disp-formula" rid="eqn6">Eq. 6</xref>; except for the networks of <xref rid="figS6" ref-type="fig">Supplementary Fig. 6</xref> in which we used a tanh nonlinearity to examine the generalizability of our results), <italic>τ</italic> = 50 ms is the effective time constant, <bold>W</bold> is the recurrent weight matrix, <bold>h</bold>(<italic>t</italic>) denotes the total stimulus input, <bold>b</bold> is a stimulus-independent bias, <italic>σ</italic> is the standard deviation of the neural noise process, <bold><italic>η</italic></bold>(<italic>t</italic>) is a sample from a Gaussian white noise process with mean 0 and variance 1, <inline-formula><inline-graphic xlink:href="548492v2_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="548492v2_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula> are color, shape, and width input weights, respectively, and <bold>h</bold><sup>c</sup>(<italic>t</italic>), <bold>h</bold><sup>s</sup>(<italic>t</italic>), and <bold>h</bold><sup>w</sup>(<italic>t</italic>) are one-hot encodings of color, shape, and width inputs, respectively.</p>
<p>All simulations started at <italic>t</italic><sub>0</sub> = − 0.5 s and lasted until <italic>t</italic><sub>max</sub> = 1.5 s, and consisted of a fixation (− 0.5–0 s), color (0–0.5 s), shape (0.5–1 s), and reward (1–1.5 s) period (<xref rid="fig1" ref-type="fig">Fig. 1a</xref> and <xref rid="fig2" ref-type="fig">Fig. 2a</xref>). The initial condition of neural activity was set to <bold>x</bold>(<italic>t</italic><sub>0</sub>) = <bold>0</bold>. In line with the task, elements of <bold>h</bold><sup>c</sup>(<italic>t</italic>) were set to 0 outside the color and shape periods, and elements of both <bold>h</bold><sup>s</sup>(<italic>t</italic>) and <bold>h</bold><sup>w</sup>(<italic>t</italic>) were set to 0 outside the shape period. All networks used <italic>N</italic> = 50 neurons (except for <xref rid="fig5" ref-type="fig">Fig. 5a</xref>–<xref ref-type="fig" rid="fig5">d</xref> and <xref rid="figS5" ref-type="fig">Supplementary Fig. 5a,b</xref> which used <italic>N</italic> = 2 neurons). We solved the dynamics of <xref ref-type="disp-formula" rid="eqn5">Eqs. 5</xref>-<xref ref-type="disp-formula" rid="eqn7">7</xref> using a first-order Euler–Maruyama approximation with a discretization time step of 1 ms.</p>
<sec id="s7b1">
<label>1.2.1</label>
<title>Network optimization</title>
<p>Choice probabilities were computed through a linear readout of network activities:
<disp-formula id="eqn8">
<graphic xlink:href="548492v2_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <bold>W</bold><sub>out</sub> are the readout weights and <bold>b</bold><sub>out</sub> is a readout bias. To measure network performance, we used a canonical cost function <sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c32">32</xref>,<xref ref-type="bibr" rid="c33">33</xref>,<xref ref-type="bibr" rid="c35">35</xref>,<xref ref-type="bibr" rid="c46">46</xref></sup> (<xref ref-type="disp-formula" rid="eqn3">Eqs. 3</xref> and <xref ref-type="disp-formula" rid="eqn4">4</xref>). We repeat the cost function from the main text here:
<disp-formula id="eqn9">
<graphic xlink:href="548492v2_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where the first term is a task performance term which consists of the cross-entropy loss <inline-formula><inline-graphic xlink:href="548492v2_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula> between the one-hot encoded target choice, <bold>c</bold> (based on the stimuli of the given trial, as defined by the task rules, <xref rid="fig1" ref-type="fig">Fig. 1b</xref>), and the network’s readout probabilities, <bold>z</bold>(<italic>t</italic>) (<xref ref-type="disp-formula" rid="eqn8">Eq. 8</xref>). Note that we measure total classification performance (cross entropy loss) during the reward period (integral in the first term runs from <italic>t</italic> = 1.0 to <italic>t</italic> = 1.5; <xref rid="fig2" ref-type="fig">Fig. 2a</xref>, bottom; yellow shading), as appropriate for the task. The second term in <xref ref-type="disp-formula" rid="eqn9">Eq. 9</xref> is a widely-used <sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c18">18</xref>–<xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c24">24</xref>,<xref ref-type="bibr" rid="c32">32</xref>,<xref ref-type="bibr" rid="c33">33</xref>,<xref ref-type="bibr" rid="c35">35</xref>,<xref ref-type="bibr" rid="c46">46</xref></sup> <italic>L</italic><sub>2</sub> regularization term (with strength <italic>λ</italic>) applied to the neural firing rates throughout the trial (integral in the second term runs from <italic>t</italic> = −0.5 to <italic>t</italic> = 1.5).</p>
<p>We initialized the free parameters of the network (the elements of <inline-formula><inline-graphic xlink:href="548492v2_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="548492v2_inline5.gif" mimetype="image" mime-subtype="gif"/></inline-formula>) by sampling (independently) from a normal distribution of mean 0 and standard deviation <inline-formula><inline-graphic xlink:href="548492v2_inline6.gif" mimetype="image" mime-subtype="gif"/></inline-formula> . There were two exceptions to this: we also investigated the effects of initializing the elements of the input weights <inline-formula><inline-graphic xlink:href="548492v2_inline7.gif" mimetype="image" mime-subtype="gif"/></inline-formula> to either 0</p>
<p>(<xref rid="figS3" ref-type="fig">Supplementary Fig. 3</xref>) or sampling their elements from a normal distribution of mean 0 and standard deviation <inline-formula><inline-graphic xlink:href="548492v2_inline8.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (<xref rid="figS4" ref-type="fig">Supplementary Fig. 4</xref>). After initialization, we optimized these parameters using gradient descent with Adam <sup><xref ref-type="bibr" rid="c68">68</xref></sup>, where gradients were obtained from backpropagation through time. We used a learning rate of 0.001 and trained networks for 1000 iterations using a batch size of 10. For each noise <italic>σ</italic> and regularization level <italic>λ</italic> (see <xref rid="tbl1" ref-type="table">Table 1</xref>), we optimized 10 networks with different random initializations of the network parameters.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>Parameters used in the simulations of our models.</title></caption>
<graphic xlink:href="548492v2_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
</sec>
<sec id="s7c">
<label>1.3</label>
<title>Analysis methods</title>
<p>Here we describe methods that we used to analyse neural activities. Whenever applicable, the same processing and analysis steps were applied to both experimentally recorded and model simulated data. All neural firing rates were sub-sampled at a 10-ms resolution and, unless stated otherwise, we did not trial-average firing rates before performing analyses. Analyses were either performed at every time point in the trial (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>, <xref rid="fig3" ref-type="fig">Fig. 3a,b</xref>, <xref rid="fig5" ref-type="fig">Fig. 5a</xref>–<xref ref-type="fig" rid="fig5">c</xref>, <xref rid="figS1" ref-type="fig">Supplementary Figs. 1</xref>–<xref rid="figS4" ref-type="fig">4</xref>, and <xref rid="figS5" ref-type="fig">Supplementary Fig. 5a,b</xref>), at the end of either the color (<xref rid="fig2" ref-type="fig">Fig. 2c,d</xref>, and <xref rid="figS5" ref-type="fig">Supplementary Fig. 5c</xref>; ‘early color decoding’) or shape periods (<xref rid="fig2" ref-type="fig">Fig. 2c,d</xref>, ‘width decoding’), during time periods of significant changes in decoding over learning in the data (<xref rid="fig3" ref-type="fig">Fig. 3c,d</xref>), during the final 100 ms of the shape period (<xref rid="fig4" ref-type="fig">Fig. 4e</xref>–<xref ref-type="fig" rid="fig4">i</xref>), or during the final 100 ms of the fixation, color, and shape periods (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, and <xref rid="figS5" ref-type="fig">Supplementary Fig. 5d</xref>).</p>
<sec id="s7c1">
<label>1.3.1</label>
<title>Linear decoding</title>
<p>For decoding analyses (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>–<xref ref-type="fig" rid="fig2">d</xref>, <xref rid="fig3" ref-type="fig">Fig. 3</xref>, <xref rid="figS1" ref-type="fig">Supplementary Figs. 1</xref>–<xref ref-type="fig" rid="figS4">4</xref>, and <xref rid="figS5" ref-type="fig">Supplementary Fig. 5a</xref>–<xref ref-type="fig" rid="figS5">c</xref>), we fitted decoders using linear support vector machines to decode the main task variables: color, shape, width, and the XOR between color and shape. We measured decoding performance in a cross-validated way, using separate sets of trials to train and test the decoders, and we show results averaged over 10 random 1:1 train:test splits. For firing rates resulting from simulated neural networks, we used 10 trials for both the train and test splits. Chance level decoding was always 0.5 as all stimuli were binary.</p>
<p>For showing changes in decoding over learning (<xref rid="fig3" ref-type="fig">Fig. 3c,d</xref>), we identified time periods of significant changes in decoding during the color and shape periods in the data (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>, horizontal black bars; see Methods 1.4), and show the mean change in decoding during these time periods for both the data and models (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>, horizontal black lines). We used the same time periods when showing changes in cross-generalized decoding over learning (<xref rid="fig3" ref-type="fig">Fig. 3d</xref>, see below) For cross-generalized decoding <sup><xref ref-type="bibr" rid="c10">10</xref></sup> (<xref rid="fig3" ref-type="fig">Fig. 3d</xref> and <xref rid="figS2" ref-type="fig">Supplementary Fig. 2</xref>), we used the same decoding approach as described above, except that cross validation was performed across trials corresponding to different stimulus conditions. Specifically, following the approach outlined in Ref. 10, because there were 3 binary stimuli in our task (color, shape, and width), there were 8 different trial conditions (<xref rid="fig1" ref-type="fig">Fig. 1b</xref>). Therefore, for each task variable (we focused on color, shape, width, and the XOR between color and shape), there were 6 different ways of choosing 2 of the 4 conditions corresponding to each of the two possible stimuli for that task variable (e.g. color 1 vs. color 2). For example, when training a decoder to decode color, there were 6 different ways of choosing 2 conditions corresponding to color 1, and 6 different ways of choosing 2 conditions corresponding to color 2 (the remaining 4 conditions were then used for testing the decoder). Therefore, for each task variable, there were 6 <italic>×</italic> 6 = 36 different ways of creating training and testing sets that corresponded to different stimulus conditions. We then took the mean decoding accuracy we obtained across all 36 different training and testing sets.</p>
</sec>
<sec id="s7c2">
<label>1.3.2</label>
<title>Measuring stimulus coding strength</title>
<p>In line with our mathematical analysis (Supplement A1, and in particular Eq. S1) and in line with previous studies <sup><xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c48">48</xref>,<xref ref-type="bibr" rid="c69">69</xref></sup>, to measure the strength of stimulus coding for relevant and irrelevant stimuli, we fitted the following linear regression model
<disp-formula id="eqn10">
<graphic xlink:href="548492v2_eqn10.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <bold>r</bold> is size <italic>K × N</italic> (where <italic>K</italic> is the number of trials) and corresponds to the neural firing rates, <bold>X</bold> is size <italic>K×</italic> 3 where the first column is all 1 (thus encoding the mean firing rate of each neuron across all conditions) and elements of the final two columns are either − 0.5 or 0.5 depending upon whether trials correspond to XOR 1 or XOR 2 (relevant) conditions (column 2) or whether trials correspond to width 1 or width 2 (irrelevant) conditions (column 3). The coefficients to be fitted (<bold><italic>β</italic></bold>) is size 3 <italic>× N</italic> and has the following structure <bold><italic>β</italic></bold> = [<bold><italic>μ</italic></bold>, Δ<bold>r</bold><sub>rel</sub>, Δ<bold>r</bold><sub>irrel</sub>]<sup><italic>⊤</italic></sup> where <bold><italic>μ</italic></bold> is the mean across all conditions, Δ<bold>r</bold><sub>rel</sub> are the coefficients corresponding to relevant (XOR) conditions, and Δ<bold>r</bold><sub>irrel</sub> are the coefficients corresponding to irrelevant (width) conditions. Finally, <bold><italic>ϵ</italic></bold> is size <italic>K× N</italic> and contains the residuals. Note that calculating the mean difference in firing rate between the two relevant conditions and between the two irrelevant conditions would yield identical estimations of Δ<bold>r</bold><sub>rel</sub> and Δ<bold>r</bold><sub>irrel</sub> because our stimuli are binary. (We also fitted decoders to decode either relevant or irrelevant conditions and extracted their coefficients to instead obtain Δ<bold>r</bold><sub>rel</sub> and Δ<bold>r</bold><sub>irrel</sub> and obtained near-identical results.)</p>
<p>We then calculated the Euclidean norm of both Δ<bold>r</bold><sub>rel</sub> and Δ<bold>r</bold><sub>irrel</sub> normalized by the number of neurons <inline-formula><inline-graphic xlink:href="548492v2_inline9.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="548492v2_inline10.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and the absolute value of the normalized dot product (overlap) between them <inline-formula><inline-graphic xlink:href="548492v2_inline11.gif" mimetype="image" mime-subtype="gif"/></inline-formula> <xref rid="fig4" ref-type="fig">Fig. 4e</xref>–<xref ref-type="fig" rid="fig4">i</xref> ). For our neural recordings (<xref rid="fig4" ref-type="fig">Fig. 4h</xref>), we calculated these quantities separately for 10 non-overlapping splits of the data. For our neural networks (<xref rid="fig4" ref-type="fig">Fig. 4e</xref>–<xref ref-type="fig" rid="fig4">g,i</xref>, ), we calculated these quantities separately for 10 different networks.</p>
</sec>
<sec id="s7c3">
<label>1.3.3</label>
<title>Measuring the magnitude of neural firing rates</title>
<p>We first calculated the firing rate for each condition and time point and then calculated the mean (across conditions and time points) Euclidean norm of firing rates appropriately normalized by the number of neurons: <inline-formula><inline-graphic xlink:href="548492v2_inline12.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, and <xref rid="figS5" ref-type="fig">Supplementary Fig. 5d</xref>). For our neural recordings (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, far left), we calculated this separately for 10 non-overlapping splits of the data. For our neural networks (<xref rid="fig5" ref-type="fig">Fig. 5f</xref>, middle left, middle right, and far right, and <xref rid="figS5" ref-type="fig">Supplementary Fig. 5d</xref>), we calculated this separately for 10 different networks. For our optimized neural networks, to emulate alternative tasks where different combinations of color, shape, and width are relevant, we also performed the same analysis when shuffling all 6 input weights (after learning) in all 14 possible ways (<xref rid="figS5" ref-type="fig">Supplementary Fig. 5d</xref>, blue lines, ‘shuffle inputs’). These 14 possible shuffles excluded the original set up of input weights, any re-ordering of inputs within a single input channel (since any re-ordering within a single input channel would be identical up to a re-labelling), and any re-ordering between the shape and width input channels (since any re-ordering within the shape and width input channels would also be identical up to a re-labelling).</p>
</sec>
</sec>
<sec id="s7d">
<label>1.4</label>
<title>Statistics</title>
<p>For decoding analyses, we used non-parametric permutation tests to calculate statistical significance. We used 100 different random shuffles of condition labels across trials to generate a null distribution for decoding accuracy. We plotted chance level decoding (<xref rid="fig3" ref-type="fig">Fig. 3a,b</xref>, <xref rid="figS1" ref-type="fig">Supplementary Figs. 1</xref>–<xref ref-type="fig" rid="figS4">4</xref>, and <xref rid="figS5" ref-type="fig">Supplementary Fig. 5a,b</xref>) by combining both early and late learning null distributions.</p>
<p>To calculate significant differences in decoding accuracy over learning (<xref rid="fig3" ref-type="fig">Fig. 3a,b</xref>, <xref rid="figS1" ref-type="fig">Supplementary Figs. 1</xref>–<xref ref-type="fig" rid="figS4">4</xref>, and <xref rid="figS5" ref-type="fig">Supplementary Fig. 5a,b</xref>), our test statistic was the difference in decoding accuracy between early and late learning, and our null distribution was the difference in decoding accuracy between early and late learning for the 100 different shuffles of condition labels (see above). We calculated two-tailed p-values for all tests. Additionally, to control for time-related cluster-based errors, we also added a cluster-based permutation correction <sup><xref ref-type="bibr" rid="c70">70</xref></sup>.</p>
<p>For all other tests, we used a two-sided Mann–Whitney U test (<xref rid="fig4" ref-type="fig">Fig. 4h,i</xref>, <xref rid="fig5" ref-type="fig">Fig. 5f</xref>, and <xref rid="figS5" ref-type="fig">Supplementary Fig. 5d</xref>).</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c68"><label>68.</label><mixed-citation publication-type="other"><string-name><surname>Kingma</surname>, <given-names>D. P.</given-names></string-name> &amp; <string-name><surname>Ba</surname>, <given-names>J. L.</given-names></string-name> <article-title>Adam: A method for stochastic optimization</article-title>. <source>arXiv</source> 1412.6980 (<year>2014</year>).</mixed-citation></ref>
<ref id="c69"><label>69.</label><mixed-citation publication-type="journal"><string-name><surname>Raposo</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Kaufman</surname>, <given-names>M. T.</given-names></string-name> &amp; <string-name><surname>Churchland</surname>, <given-names>A. K.</given-names></string-name> <article-title>A category-free neural population supports evolving demands during decision-making</article-title>. <source>Nature Neuroscience</source> <volume>17</volume>, <fpage>1784</fpage>–<lpage>1792</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c70"><label>70.</label><mixed-citation publication-type="journal"><string-name><surname>Maris</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Oostenveld</surname>, <given-names>R.</given-names></string-name> <article-title>Nonparametric statistical testing of EEG- and MEG-data</article-title>. <source>Journal of Neuroscience Methods</source> <volume>164</volume>, <fpage>177</fpage>–<lpage>190</lpage> (<year>2007</year>).</mixed-citation></ref>
</ref-list>
<sec id="s8">
<title>Supplementary figurse</title>
<fig id="figS1" position="float" fig-type="figure">
<label>Supplementary Fig. 1.</label>
<caption><title>Temporal decoding for networks with different noise and regularization levels.</title>
<p><bold>a</bold>, Performance of a linear decoder trained at each time point to predict either XOR (far left), shape (middle left), color (middle right), or width (far right) from neural population activity from optimized recurrent neural networks trained in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime. We show decoding results separately from the first half of sessions (gray, ‘early learning’) and the second half of sessions (black, ‘late learning’). Dotted gray lines and shading show mean <italic>±</italic> 2 s.d. of chance level decoding based on shuffling trial labels. Horizontal black bars show significant differences between early and late decoding using a two-sided cluster-based permutation test (Methods 1.4). <bold>b</bold>, Same as panel a, but for networks optimized in the <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> regime. <bold>c</bold>, Same as panel a, but for networks optimized in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>h</sub> regime. <bold>d</bold>, Same as panel a, but for networks optimized in a very high regularization regime (<italic>σ</italic> = 0.01, <italic>λ</italic> = 0.5) while still being able to perform the task to a high accuracy.</p></caption>
<graphic xlink:href="548492v2_figS1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Supplementary Fig. 2.</label>
<caption><title>Cross-generalized temporal decoding for lPFC recordings and networks with different noise and regularization levels.</title>
<p><bold>a</bold>, Performance of a cross-generalized decoder (Methods 1.3.1) trained at each time point to predict either XOR (far left), shape (middle left), color (middle right), or width (far right) from neural population activity from our lPFC recordings. We show decoding results separately from the first half of sessions (gray, ‘early learning’) and the second half of sessions (black, ‘late learning’). Dotted gray lines and shading show mean <italic>±</italic> 2 s.d. of chance level decoding based on shuffling trial labels. Horizontal black bars show significant differences between early and late decoding using a two-sided cluster-based permutation test (Methods 1.4). <bold>b</bold>, Same as panel a, but for recurrent neural networks optimized in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime. <bold>c</bold>, Same as panel a, but for recurrent neural networks optimized in the <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> regime. <bold>d</bold>, Same as panel a, but for recurrent neural networks optimized in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime.</p></caption>
<graphic xlink:href="548492v2_figS2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Supplementary Fig. 3.</label>
<caption><title>Temporal decoding for networks with input weights initialized to 0 prior to optimization.</title>
<p><bold>a</bold>, Performance of a linear decoder trained at each time point to predict either XOR (far left), shape (middle left), color (middle right), or width (far right) from neural population activity from optimized recurrent neural networks trained in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime with input weights initialized to 0 prior to optimization (cf. <xref rid="fig3" ref-type="fig">Fig. 3a,b</xref>; Methods 1.2.1). We show decoding results separately from the first half of sessions (gray, ‘early learning’) and the second half of sessions (black, ‘late learning’). Dotted gray lines and shading show mean <italic>±</italic> 2 s.d. of chance level decoding based on shuffling trial labels. Horizontal black bars show significant differences between early and late decoding using a two-sided cluster-based permutation test (Methods 1.4). <bold>b</bold>, Same as panel a, but for networks optimized in the <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> regime. <bold>c</bold>, Same as panel a, but for networks optimized in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>h</sub> regime. <bold>d</bold>, Same as panel a, but for networks optimized in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime.</p></caption>
<graphic xlink:href="548492v2_figS3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Supplementary Fig. 4.</label>
<caption><title>Temporal decoding for networks with input weights initialized to large random values prior to optimization.</title>
<p><bold>a</bold>, Performance of a linear decoder trained at each time point to predict either XOR (far left), shape (middle left), color (middle right), or width (far right) from neural population activity from optimized recurrent neural networks trained in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime with input weights initialized to large random values prior to optimization (cf. <xref rid="fig3" ref-type="fig">Fig. 3a,b</xref>; Methods 1.2.1). We show decoding results separately from the first half of sessions (gray, ‘early learning’) and the second half of sessions (black, ‘late learning’). Dotted gray lines and shading show mean<italic>±</italic> 2 s.d. of chance level decoding based on shuffling trial labels. Horizontal black bars show significant differences between early and late decoding using a two-sided cluster-based permutation test (Methods 1.4). <bold>b</bold>, Same as panel a, but for networks optimized in the <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> regime. <bold>c</bold>, Same as panel a, but for networks optimized in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>h</sub> regime. <bold>d</bold>, Same as panel a, but for networks optimized in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime.</p></caption>
<graphic xlink:href="548492v2_figS4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Supplementary Fig. 5.</label>
<caption><title>Temporal decoding for 2-neuron networks and supplemental analysis of suppression of dynamically irrelevant stimuli.</title>
<p><bold>a</bold>, Performance of a linear decoder trained at each time point to predict either XOR (far left), shape (middle left), color (middle right), or width (far right) from neural population activity from optimized 2-neuron networks (<xref rid="fig5" ref-type="fig">Fig. 5a</xref>–<xref ref-type="fig" rid="fig5">d</xref>) trained in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime. Dotted gray lines and shading show mean <italic>±</italic> 2 s.d. of chance level decoding based on shuffling trial labels. Horizontal black bars show significant differences between early and late decoding using a two-sided cluster-based permutation test (Methods 1.4). <bold>b</bold>, Same as panel a but for 2-neuron networks trained in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime. <bold>c</bold>, Mean (over 10 50-neuron networks) proportion of color inputs that have a negative sign for all noise and regularization strengths (colorbar) plotted against early color decoding (see <xref rid="fig2" ref-type="fig">Fig. 2c</xref>, middle). Pale blue, purple, and pink highlights correspond to the noise and regularization strengths shown in <xref rid="fig2" ref-type="fig">Fig. 2c</xref>. Gray dotted line shows the negative identity line shifted to intercept the vertical axis at 1. <bold>d</bold>, Momentary magnitude of firing rates <inline-formula><inline-graphic xlink:href="548492v2_inline19.gif" mimetype="image" mime-subtype="gif"/></inline-formula>; i.e. momentary metabolic cost, see <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> ) for 50-neuron networks in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime (left, blue shading), <italic>σ</italic><sub>h</sub>, <italic>λ</italic><sub>l</sub> regime (purple shading), and <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime (right, pink shading). We show results after learning (black lines, ‘late learning’; repeated from <xref rid="fig5" ref-type="fig">Fig. 5f</xref>) and when shuffling color, shape, and width input weights (blue lines, ‘shuffle inputs’; Methods 1.3.3). Error bars show the mean<italic>±</italic> 2 s.d. over 10 different networks. P-values resulted from a two-sided Mann–Whitney U test (*, <italic>p &lt;</italic> 0.05; **, <italic>p &lt;</italic> 0.01; ***, <italic>p &lt;</italic> 0.001; n.s., not significant; see Methods 1.4).</p></caption>
<graphic xlink:href="548492v2_figS5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Supplementary Fig. 6.</label>
<caption><title>Activity-silent, sub-threshold dynamics lead to the suppression of dynamically irrelevant stimuli in networks with a sigmoid nonlinearity.</title>
<p><bold>a</bold>, Sub-threshold neural activity (<bold>x</bold>(<italic>t</italic>) in <xref ref-type="disp-formula" rid="eqn1">Eq. 1</xref>) in the full state space of an example 2-neuron network with a sigmoid (tanh) nonlinearity over the course of a trial (from color onset) trained in the <italic>σ</italic><sub>l</sub>, <italic>λ</italic><sub>l</sub> regime (Methods 1.2). Pale blue arrows show flow field dynamics (direction and magnitude of movement in the state space as a function of the momentary state). Open gray circles indicate color onset, gray squares indicate shape onset, filled gray circles indicate offset of both stimuli, and colored squares and diamonds indicate the end of the trial at 1.5 s. We plot activity separately for the 3 periods of the task (color period, left; shape period, middle; reward period, right). We plot dynamics without noise for visual clarity. <bold>b</bold>, Same as panel a but for a network trained in the <italic>σ</italic><sub>m</sub>, <italic>λ</italic><sub>m</sub> regime. <bold>c</bold>, Momentary magnitude of firing rates <inline-formula><inline-graphic xlink:href="548492v2_inline20.gif" mimetype="image" mime-subtype="gif"/></inline-formula> ; i.e. momentary metabolic cost, see <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> ) for the 2-neuron networks from panels a (blue line) and b (pink line). <bold>d</bold>, Mean<italic>±</italic> 2 s.d. (over 10 2-neuron tanh networks) proportion of color inputs that have a negative sign for the two noise and regularization regimes shown in panels a–c. Gray dotted line shows chance level proportion of negative color input.</p></caption>
<graphic xlink:href="548492v2_figS6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.94961.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Salinas</surname>
<given-names>Emilio</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Wake Forest University School of Medicine</institution>
</institution-wrap>
<city>Winston-Salem</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This work provides a <bold>valuable</bold> analysis of the effect of two commonly used hyperparameters, noise amplitude and firing rate regularization, on the representations of relevant and irrelevant stimuli in trained recurrent neural networks (RNNs). The results suggest an interesting interpretation of prefrontal cortex (PFC) dynamics, based on comparisons to previously published data from the same lab, in terms of decreasing metabolic cost during learning. The evidence indicating that the mechanisms identified in the RNNs are the same ones operating in PFC was considered <bold>incomplete</bold>, but could potentially be bolstered by additional analyses and appropriate revisions.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.94961.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This study compares experimental data recorded from the PFC of monkeys to the activity of recurrent neural networks trained to perform the same `task' as the monkeys, namely, to predict the delivery of reward following the presentation of visual stimuli. The visual information varied along 3 dimensions, color, shape, and width. Shape was always relevant for reward prediction, width was always irrelevant, and color was irrelevant at the beginning of the trial but became relevant later on, once it could be assessed together with shape. The neural data showed systematic changes in the representations of these features and of the expected reward as the learning progressed, and the objective of this study was to try to understand what principles could underlie these changes. The simulations and theoretical calculations indicated that the changes in PFC activity (throughout learning and throughout a trial) can be understood as an attempt by the circuitry to use an efficient representational strategy, i.e., one that uses as few spikes as possible, given that the resulting representation should be accurate enough for task performance.</p>
<p>Strengths:</p>
<p>- The paper is concise and clearly written.</p>
<p>- The paper shows that, in a neural circuit, the information that is decodable and the information that is task-relevant may relate in very different ways. Decodable information may be very relevant or very irrelevant. This fact is critical for interpreting the results of pure decoding studies, which often assume an equivalence. This take-home message is not emphasized by the authors, but I think is quite important.</p>
<p>- The results provide insight as to how neural representations may be transformed as a task is learned, which often results in subtle changes in selectivity and overall activity levels whose impact or reason is not entirely clear just by looking at the data.</p>
<p>Weaknesses:</p>
<p>The match between the real PFC and the model networks is highly qualitative, and as noted by the authors, comparisons only make sense in terms of *changes* between early and late learning. The time scales, activity levels, and decoding accuracies involved are all different between the model and recording data. This is not to disregard what the authors have done, but simply to point out an important limitation.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.94961.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The study investigates the representation of irrelevant stimuli in neural circuits using neural recordings from the primate prefrontal cortex during a passive object association task. They find a significant decrease in the linear decodability of irrelevant stimuli over the course of learning (in the time window in which the stimuli are irrelevant). They then compare these trends to RNNs trained with varying levels of noise and firing rate regularization and find agreement when these levels are at an intermediate value. In a complementary analysis, they found (in both RNNs and PFC) that the magnitude of relevant and irrelevant stimuli increased and decreased, respectively, during learning. These findings were interpreted in terms of a minimization of metabolic cost in the cortex.</p>
<p>To understand how stimuli can be dynamically suppressed at times when they are irrelevant, the authors constructed and analyzed a reduced two-neuron model of the task. They found a mechanism in which firing rate regularization increased the probability of negative weights in the input, pushing the neural activities below the threshold. A similar mechanism was observed in RNNs.</p>
<p>Strengths:</p>
<p>The article is well-written and the figures are easily understood. The analyses are well explained and motivated. The article provides a valuable analysis of the effect of two parameters on representations of irrelevant stimuli in trained RNNs.</p>
<p>Weaknesses:</p>
<p>(1) The mechanism for suppressing dynamically relevant stimuli appears to be incomplete and does not explain clearly enough how representations of 'color' which are suppressed through negative input weights become un-suppressed in the presence of the second variable 'shape'.</p>
<p>(2) Interpretation of results in terms of the effect of metabolic cost on cortical dynamics is not backed up by the presented data/analyses. The change in dynamics of 'color' representations in the prefrontal cortex only qualitatively matches RNN dynamics and may arise from other causes.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.94961.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In order to study the factors and neural dynamics that lead to the suppression of irrelevant information in the brain, the authors trained artificial neural networks in the execution of a task that involved the discrimination of complex stimuli with three main features: color, shape, and width. Specific combinations of color and shape led to a reward, but the temporal structure made color dynamically irrelevant at the beginning of the trial, and then it became relevant once the shape was presented. On the other hand, the width of the stimulus was always irrelevant. Importantly, non-human primates were also trained to execute this task (in a previous study by the authors) and the activity from neural populations from the dorsolateral Prefrontal Cortex (dlPFC) was recorded, allowing to compare the coding of information by the artificial neural network model with what happens in biological neural populations.</p>
<p>The authors changed systematically the amount of noise present in the neural network model, as well as limiting the firing rate of the artificial neurons to simulate the limitations imposed by high metabolic costs in biological neurons. They found that models with medium and low noise, as well as medium and low metabolic cost, developed information encoding patterns that resembled the patterns observed throughout learning in the dlPFC, as follows: early in the learning process, color information was strongly represented during the whole trial, as well as shape and width, whereas the color/shape combination significance (XOR operation) was weakly encoded. Late in learning, color information was initially suppressed (while it was deemed irrelevant) and became more prominent during the shape presentation. Width information coding decreased, and the XOR operation result became more strongly encoded.</p>
<p>Subthreshold activity dynamics were studied by training artificial networks consisting of 2 neurons, with the aim of understanding how dynamically irrelevant information is suppressed and then encoded more strongly at a different time during the trial. Under medium noise and medium metabolic cost, color information is suppressed by the divergence of the activity away from the level that triggers spikes. The authors claim that this subthreshold dynamic explains the suppression of irrelevant information in biological neural networks.</p>
<p>Strengths:</p>
<p>The study leverages the power of computational models to simulate biological networks and do manipulations that are difficult (if not impossible) to perform in vivo. The analyses of the activity of the network model are neat and thorough and provide a clear demonstration of how noise and metabolic costs may affect the information coding in the brain. The mathematical analyses are rigorous and nicely documented.</p>
<p>Weaknesses:</p>
<p>The study does not leverage the fact that they have access to the activity of individual neurons both on a neural network model and in neural recordings. The model/brain comparison results are limited to the decodability of different pieces of information during the execution of the task at different stages of learning. It would have been useful if the authors had shown response profiles of individual neurons, both biological and artificial, to strengthen the claim that the activity patterns are similar. Perhaps showing that the firing rates vary in a similar way in the large models (like they do for the 2-neuron model) would have been informative. For instance, it is possible that suppression is not occurring in the dlPFC, but that the PFC receives input with this information already suppressed. If suppression indeed happens in the PFC, response profiles associated with this process may be observed.</p>
<p>There is no way to say that the 2-neuron models are in any way informative of what happens in brain neurons, or even larger artificial networks since the sources of sensory input, noise, and inhibition will differ between biological and artificial networks. And because the firing patterns are not shown for large networks, it is not clear if some non-coding artificial neurons will become broadly inhibitory but maintain a relatively high firing rate (to mention only one possibility).</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.94961.1.sa4</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Stroud</surname>
<given-names>Jake P.</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4263-5755</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Wójcik</surname>
<given-names>Michał</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3254-8519</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Jensen</surname>
<given-names>Kristopher T.</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9242-5572</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Kusunoki</surname>
<given-names>Makoto</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kadohisa</surname>
<given-names>Mikiko</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Buckley</surname>
<given-names>Mark J.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Duncan</surname>
<given-names>John</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9695-2764</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Stokes</surname>
<given-names>Mark G.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lengyel</surname>
<given-names>Máté</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7266-0049</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p><bold>Reviewer 1:</bold></p>
<p>Many thanks for your positive review and clear overview of our paper. We also agree with your interpretation of our results that ‘the information that is decodable and the information that is task-relevant may relate in very different ways’ and we could have emphasised this point more in the paper.</p>
<p>With regards to the qualitative similarities between our models and our data, we agree that due to the fact that one can achieve any desired level of activity, decoding accuracy, performance, etc in a model, we focussed on <italic>changes</italic> over learning of key metrics that are commonly used in the field. Although this can appear qualitative at times because the raw values can differ between the data and our models, our main results are ultimately strongly quantitative (e.g., Fig. 3c,d, and Fig. 5f). We note that we could have fine tuned the models to have similar activity levels, decoding accuracies etc to our data, and on the face of it this may have made the results appear more convincing, but we felt that such trivial fine tuning does not change any of our key results in any fundamental way and is not the aim of computational modelling. The model one chooses to analyse will always be abstracted from biology in some way, by definition.</p>
<p><bold>Reviewer 2:</bold></p>
<p>Thank you very much for your kind comments and clear overview of our paper. We also hope that our paper ‘provides a valuable analysis of the effect of two parameters on representations of irrelevant stimuli in trained RNNs.’</p>
<p>With regards to our suggested mechanism of suppressing dynamically irrelevant stimuli, we are sorry that we did not provide a sufficient enough explanation of suppressing color representations when they are irrelevant. We hopefully provide a longer explanation here. Our mechanism of suppression of dynamically irrelevant stimuli does not suggest that it becomes un-suppressed later, only the behaviourally relevant variable should be decodable when it is needed (i.e., XOR). Although color decodability did increase slightly in the data and some of the models from the color period to the shape period, it was typically not significant and was therefore not a result that we emphasise in the paper (although this could be analysed further to see if additional mechanisms might explain it). We emphasise throughout that color decoding is typically similar between color and shape periods (either high or low) and either decreases or increases over time in both periods. We also focus on whether color decodability increases or decreases over learning during the color period when it is irrelevant (which we call ‘early color decoding’). Importantly, decoding of color or shape is not needed to perform the task, only decoding of XOR is needed to perform the task. For example, in our two-neuron networks, we observe perfect XOR decoding and only 75% decoding of color and shape, and decoding during the shape period is the same as the network at initialisation before any training. The mechanism we suggest of suppressing dynamically irrelevant stimuli does not predict that that stimulus should be un-suppressed later, only the behaviourally relevant variable should be decodable (i.e., XOR). Instead, what we try to explain is that color inputs can generate 0 firing rate during the color period, when that input does not need to be used and is therefore irrelevant (and color decoding decreases during the color period over learning), but these inputs can be combined with shape inputs later to create a perfectly decodable XOR response.</p>
<p>With regards to interpretation of our results based on metabolic cost constraints, we feel that this is an unnecessarily strong criticism to say that it ‘is not backed up by the presented data/analyses.’ All of our models were trained with only a metabolic cost constraint, a noise strength, and a task performance term. Therefore, the results of the models are directly attributable to the strength of metabolic cost that we use. Additionally, although one could in principle pick any of infinitely many different parameters to change and measure the response in an optimized network, varying metabolic cost and noise are two of the most fundamental phenomena that neural circuits must contend with, and many studies have analysed the impact they have on neural circuit dynamics. Furthermore, in line with previous studies (Yang et al., 2019, Whittington et al., 2022, Sussillo et al., 2015, Orhan et al., 2019, Kao et al., 2021, Cueva et al., 2020, Driscoll et al., 2022, Song et al., 2016, Masse et al., 2019, Schimel et al., 2023), we operationalized metabolic cost in our models through L2 firing rate regularization. This cost penalizes high overall firing rates. (Such an operationalization of metabolic cost also makes sense for our models because network performance is based on firing rates rather than subthreshold activities.) There are however alternative conceivable ways to operationalize a metabolic cost; for example L1 firing rate regularization has been used previously when optimizing neural networks and promotes more sparse neural firing. Interestingly, although our L2 is generally conceived to be weaker than L1 regularization, we still found that it encouraged the network to use purely sub-threshold activity in our task. The regularization of synaptic weights may also be biologically relevant because synaptic transmission uses the most energy in the brain compared to other processes (Faria-Pereira et al., 2022, Harris et al., 2012). Additionally, even subthreshold activity could be regularized as it also consumes energy (although orders of magnitude less than spiking (Zhu et al., 2019)). Therefore, future work will be needed to examine how different metabolic costs affect the dynamics of task-optimized networks.</p>
<p>With regards to color representations in PFC only qualitatively matching those in our models, in line with the comment from Reviewer 1, we agree that due to the fact that one can achieve any desired level of activity, decoding accuracy, performance, etc in a model, we focussed on changes over learning of key metrics that are commonly used in the field. Although this can appear qualitative at times because the raw values can differ between the data and our models, our main results are ultimately strongly quantitative (e.g., Fig. 3c,d, and Fig. 5f). We note that we could have fine tuned the models to have similar activity levels, decoding accuracies etc to our data, and on the face of it this may have made the results appear more convincing, but we felt that such trivial fine tuning does not change any of our key results in any fundamental way and is not the aim of computational modelling. The model one chooses to analyse will always be abstracted from biology in some way, by definition. Finally, of course we note that changes in color decoding could result from other causes, but we focussed on two key phenomena that neural circuits must contend with: noise and metabolic costs. Therefore, it is likely that these two variables play a strong role in stimulus representations in neural circuits</p>
<p><bold>Reviewer 3:</bold></p>
<p>Thank you very much for your thorough and clear overview of our paper and we agree that it is important to investigate phenomena and manipulations in computational models that are almost impossible to do in vivo and we are pleased you found our mathematical analyses rigorous and nicely documented.</p>
<p>Although we agree that it can be useful to study the responses of individual neurons, we focussed on population analyses of all available neurons without omitting or specifically selecting neurons based on their dynamics. We are also not suggesting that the activities of individual ‘neurons’ in the models and data should be similar since our models are highly abstract firing rate models. But rather, the overall computational strategy, which one can access through population decoding and cross-generalised decoding, was what we were interested in comparing between the models and the data and is arguably the correct level of analysis of such models (an data) given our key questions (Vyas et al., 2020, Churchland et al., 2012, Mante et al., 2013, Ebitz et al., 2021).</p>
<p>We also certainly agree and are more than open to the fact that suppression of irrelevant stimuli may already be happening on the inputs arriving in PFC. Indeed, we actually suggest this as the mechanism in Fig. 5 (together with recurrent circuit dynamics that make use of these inputs).</p>
<p>With regards to the dynamics of the two-neuron networks not being ‘informative of what happens in brain networks’, we agree that these models are very simplified and may only contain very fundamental similarities with biological neurons. However, we only used them to illustrate the fundamental mechanism of generating 0 firing rate during the color epoch so that it is more easily understandable for readers as they can see the entire 2-dimensional state space and the entire computational strategy can be seen (Fig. 5a-d). We also note that we did this for both rectified linear and tanh networks, thus showing that such a mechanism is preserved across fundamentally different firing rate nonlinearities. Additionally, after illustrating this fundamental mechanism of networks receiving color information but generating 0 firing rate, we show that the exact same mechanism is at play in the large networks we use throughout the paper (Fig. 5e). We also only compare the large networks to our neural recordings. We do agree though that it would be interesting to further compare fundamental similarities and differences between our models and our neural recordings (always at the right level of analysis that makes sense for our chosen models) to show that the mechanisms we uncover in our models are also strongly relevant for our data.</p>
</body>
</sub-article>
</article>