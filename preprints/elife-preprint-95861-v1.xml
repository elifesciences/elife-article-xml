<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">95861</article-id>
<article-id pub-id-type="doi">10.7554/eLife.95861</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.95861.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Immunology and Inflammation</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Deconstructing Complexity: A Computational Topology Approach to Trajectory Inference in the Human Thymus with <italic>tviblindi</italic></article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes">
<name>
<surname>Stuchly</surname>
<given-names>Jan</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">*</xref>
<xref ref-type="corresp" rid="cor1">#</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Novak</surname>
<given-names>David</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a6">6</xref>
<xref ref-type="author-notes" rid="n1">*</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Brdickova</surname>
<given-names>Nadezda</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">*</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hadlova</surname>
<given-names>Petra</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Iksi</surname>
<given-names>Ahmad</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kuzilkova</surname>
<given-names>Daniela</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Svaton</surname>
<given-names>Michael</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Saad</surname>
<given-names>George Alehandro</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Engel</surname>
<given-names>Pablo</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Luche</surname>
<given-names>Herve</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sousa</surname>
<given-names>Ana E.</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Almeida</surname>
<given-names>Afonso R. M.</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Kalina</surname>
<given-names>Tomas</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">#</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Childhood Leukaemia Investigation Prague (CLIP), Department of Paediatric Haematology and Oncology, Second Faculty of Medicine, Charles University and University Hospital Motol</institution>, Prague, <country>Czech Republic</country></aff>
<aff id="a2"><label>2</label><institution>Centre d’Immunophénomique - CIPHE (PHENOMIN), Aix Marseille Université (UMS3367)</institution>, Inserm (US012), CNRS (UAR3367), Marseille, <country>France</country></aff>
<aff id="a3"><label>3</label><institution>Department of Biomedical Sciences, Medical School, University of Barcelona</institution>, Barcelona, <country>Spain</country></aff>
<aff id="a4"><label>4</label><institution>Instituto de Medicina Molecular João Lobo Antunes, Faculdade de Medicina, Universidade de Lisboa</institution>, <country>Portugal</country></aff>
<aff id="a5"><label>5</label><institution>Data Mining and Modeling for Biomedicine, VIB Center for Inflammation Research</institution>, Ghent, <country>Belgium</country></aff>
<aff id="a6"><label>6</label><institution>Department of Applied Mathematics, Computer Science and Statistics, Ghent University</institution>, Ghent, <country>Belgium</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Graw</surname>
<given-names>Frederik</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Friedrich-Alexander-University Erlangen-Nürnberg</institution>
</institution-wrap>
<city>Erlangen</city>
<country>Germany</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Walczak</surname>
<given-names>Aleksandra M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>CNRS</institution>
</institution-wrap>
<city>Paris</city>
<country>France</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>*</label><p>Contributed equally</p></fn>
<corresp id="cor1"><label>#</label>Corresponding author, <email>jan.stuchly@lfmotol.cuni.cz</email> (J.S.); <email>tomas.kalina@lfmotol.cuni.cz</email> (T.K.)</corresp>
<fn id="n2" fn-type="con"><p>Author Contributions: Conceptualization, T.K., N.B., J.S.; Methodology, T.K., D.N., N.B., P.H., J.S., A.E.S., A.R.M.A; Software, D.N., A.I., G.A.S., J.S.; Formal Analysis, D.N., J.S.; Investigation, N.B., P.H., D.K., M.S., H.L.; Resources, P.E.; Writing – Original Draft, T.K., N.B., P.H., J.S.; Writing – Review &amp; Editing, D.N., D.K., A.E.S., A.R.M.A.; Supervision, T.K., J.S.</p></fn>
<fn id="n3" fn-type="others"><p><bold>Teaser</bold> <italic>tviblindi</italic> reveals αβ T-cell development checkpoints and places activated phenotype CD4<sup>+</sup>CD8<sup>dim</sup> Tregs at the end of Treg trajectory.</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-05-09">
<day>09</day>
<month>05</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP95861</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-02-11">
<day>11</day>
<month>02</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-01-04">
<day>04</day>
<month>01</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.07.13.547329"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Stuchly et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Stuchly et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-95861-v1.pdf"/>
<abstract>
<title>Abstract</title><p>Understanding complex, organ-level single-cell datasets represents a formidable interdisciplinary challenge. This study aims to describe developmental trajectories of thymocytes and mature T cells. We developed <italic>tviblindi</italic>, a trajectory inference algorithm that integrates several autonomous modules - pseudotime inference, random walk simulations, real-time topological classification using persistent homology, and autoencoder-based 2D visualization using the <italic>vaevictis</italic> algorithm. This integration facilitates interactive exploration of developmental trajectories, revealing not only the canonical CD4 and CD8 development but also offering insights into checkpoints such as TCRβ selection and positive/negative selection. Furthermore, it allows us to thoroughly characterize thymic regulatory T cells, tracing their development from the negative selection stage to mature thymic regulatory T cells with an extensive proliferation history and an immunophenotype of activated and recirculating cells. <italic>tviblindi</italic> is a versatile and generic approach suitable for any mass cytometry or single-cell RNA-seq dataset, equipping biologists with an effective tool for interpreting complex data.</p>
</abstract>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Table 1 in Supplementary note updated</p></fn>
</fn-group>
<fn-group content-type="external-links">
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://github.com/stuchly/tviblindi">https://github.com/stuchly/tviblindi</ext-link>
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Exploring the development of mature, fully functional cells from their progenitors has been the focus of researchers for many decades. While single-cell techniques such as flow cytometry were fundamental to the description of developmental stages, recent advances in single-cell methods measuring large sets of markers (mass cytometry, single-cell RNA-seq) have enabled truly comprehensive descriptions of entire tissues and organs. In parallel, computational methods that capture and describe possible dynamics in the data, as well as topological relationships among cell populations, were developed. After the seminal Wanderlust methodological study <italic>(<xref ref-type="bibr" rid="c1">1</xref>)</italic>, trajectory inference (TI) and pseudotime data analysis became an area of intensive research, producing gradually more and more sophisticated tools for a growing number of general topologies <italic>(<xref ref-type="bibr" rid="c2">2</xref>–<xref ref-type="bibr" rid="c7">7</xref>)</italic>.</p>
<p>However, certain limitations prevent widespread adoption of these tools in analytical workflows of real-world data. First, the computational complexity of existing TI methods is often prohibitive when analyzing large datasets from current single-cell RNA methods (especially when the data comprise cell atlases of entire organisms, embryos, and human organs) or from flow and mass cytometry with datasets of millions of cells <italic>(<xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c8">8</xref>–<xref ref-type="bibr" rid="c11">11</xref>)</italic>. Second, TI methods often use multiple steps of dimensionality reduction and/or clustering, inadvertently introducing bias. The choice of hyperparameters also fixes the a priori resolution in a way that is difficult to predict. Third, the current TI methods work well on artificial datasets but lack a straightforward approach to control the effect of noise (technical artifacts or unexpected events) in multiscale topologies of real-world data. The fourth, and perhaps the major obstacle is that existing TI tools do not offer the necessary interaction with the analytical process. We believe that such interaction, which helps the researcher understand the particularities of a sample, is crucial for exploratory analyses of unknown data.</p>
<p>Motivated to develop a generic TI solution useful to a biologist investigating a real-world dataset, we developed <italic>tviblindi. tviblindi</italic> is a modular TI method designed to tackle large datasets, significant noise, technical artifacts, and unequal distribution of cells along the time axis. As a proof of concept, we investigate αβ T-cell development in human thymus and the transition of mature T cells to peripheral blood.</p>
<p>Human T cells develop in the thymus, which is seeded by bone marrow derived CD45<sup>pos</sup> CD44<sup>pos</sup>CD34<sup>hi</sup>CD7<sup>neg</sup> and Notch primed CD45 <sup>pos</sup>CD44<sup>pos</sup>CD34<sup>hi</sup>CD7<sup>pos</sup> progenitors <italic>(<xref ref-type="bibr" rid="c12">12</xref>–<xref ref-type="bibr" rid="c15">15</xref>)</italic>. Large CD34<sup>hi</sup>CD1a<sup>neg</sup> immature thymocytes develop into small CD34<sup>dim</sup>CD1a<sup>pos</sup> immature thymocytes <italic>(<xref ref-type="bibr" rid="c13">13</xref>)</italic>, becoming gradually restricted to the T-cell lineage <italic>(<xref ref-type="bibr" rid="c16">16</xref>)</italic>. After losing CD44 expression, right before gaining CD1a, they become committed to a T-cell fate <italic>(<xref ref-type="bibr" rid="c17">17</xref>)</italic>.</p>
<p>These early human CD34<sup>pos</sup> thymocytes then progress through three stages <italic>(<xref ref-type="bibr" rid="c18">18</xref>)</italic> (1) CD34<sup>pos</sup>CD38<sup>neg</sup>CD1a<sup>neg</sup>, (2) CD34<sup>pos</sup>CD38<sup>pos</sup>CD1a<sup>neg</sup> and (3) CD34<sup>pos</sup>CD38<sup>pos</sup>CD1a<sup>pos</sup>. The first TCRβ D-J rearrangements are detected in the CD34<sup>pos</sup>CD38<sup>pos</sup>CD1a<sup>neg</sup> population. In-frame TCRβ are mostly selected at the transition from CD34<sup>pos</sup>CD38<sup>pos</sup>CD1a<sup>pos</sup> to the next stage: the CD4<sup>pos</sup> immature single positive (ISP) population. Concordantly, pre-TCRα (pTα) expression peaks in the CD34<sup>pos</sup>CD38<sup>pos</sup>CD1a<sup>pos</sup> and ISP stages, after which it declines. TCRα rearrangements are initiated when thymocytes progress from CD34<sup>pos</sup>CD38<sup>pos</sup>CD1a<sup>pos</sup> toward the ISP stage and continue until the CD3<sup>pos</sup>CD4 and CD8 double positive (DP) stage <italic>(<xref ref-type="bibr" rid="c18">18</xref>)</italic>.</p>
<p>The complete TCRαβ receptors are checked for their binding to MHC-self peptide complexes on thymic epithelial cells and dendritic cells. Failure to engage the MHC-self peptide leads to death by neglect <italic>(<xref ref-type="bibr" rid="c19">19</xref>)</italic>. Efficient TCR binding leads to positive selection and further development along the CD4/CD8 axis. Positively selected DP cells express CD69 on their surface and start to downregulate the CD8 co-receptor. If they are selected via the MHC-II peptide complex, the TCR signal persists. When the duration of this signal exceeds a certain time limit, the transcription factor ThPOK is induced, and the cells become CD4 cells <italic>(<xref ref-type="bibr" rid="c20">20</xref>)</italic>. If selected on the MHC-I peptide complex, the signal diminishes, the transcription factor RUNX3 is induced, expression of the CD8 co-receptor is reactivated and CD4 eliminated, leading to the CD8 cell fate <italic>(<xref ref-type="bibr" rid="c20">20</xref>)</italic>. On the other hand, strong TCR binding leads to negative selection and apoptosis or to the so-called agonist selection and development of regulatory T cells (Tregs) <italic>(<xref ref-type="bibr" rid="c21">21</xref>)</italic>. During these processes the cells acquire the chemokine receptor CCR7 and move from the thymic cortex to the medulla, where tissue-specific self-antigens are ectopically expressed on the surface of medullary epithelial cells <italic>(<xref ref-type="bibr" rid="c22">22</xref>,<xref ref-type="bibr" rid="c23">23</xref>)</italic>. The current models suggest that both the strength/duration of TCR signal <italic>(<xref ref-type="bibr" rid="c24">24</xref>–<xref ref-type="bibr" rid="c27">27</xref>)</italic> and the integration of TCR signals from consecutive T cell – antigen-presenting cell encounters <italic>(<xref ref-type="bibr" rid="c28">28</xref>,<xref ref-type="bibr" rid="c29">29</xref>)</italic> help to determine the autoreactive T-cell fate. Costimulatory signals <italic>(<xref ref-type="bibr" rid="c30">30</xref>–<xref ref-type="bibr" rid="c32">32</xref>)</italic> as well as cytokines <italic>(<xref ref-type="bibr" rid="c33">33</xref>–<xref ref-type="bibr" rid="c39">39</xref>)</italic> contribute to the process. The upregulation of the high-affinity IL-2 receptor CD25 and its signaling are known to stabilize FOXP3 expression <italic>(<xref ref-type="bibr" rid="c36">36</xref>,<xref ref-type="bibr" rid="c37">37</xref>)</italic>. Importantly, JAK/STAT signaling triggered by γ chain cytokines promote FOXP3<sup>pos</sup> Treg proliferation <italic>(<xref ref-type="bibr" rid="c38">38</xref>)</italic> and induction of BCL-2 and its anti-apoptotic effect <italic>(<xref ref-type="bibr" rid="c39">39</xref>)</italic>. While the TCR repertoire of conventional T cells and Tregs are largely distinct and non-overlapping <italic>(<xref ref-type="bibr" rid="c40">40</xref>)</italic>, the exact branching point of these two main lineages is still a matter of intensive research <italic>(<xref ref-type="bibr" rid="c41">41</xref>,<xref ref-type="bibr" rid="c42">42</xref>)</italic> also employing human data based on single-cell transcriptomics <italic>(<xref ref-type="bibr" rid="c43">43</xref>–<xref ref-type="bibr" rid="c45">45</xref>)</italic>.</p>
<p>When investigated using single-cell methods <italic>(<xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c43">43</xref>–<xref ref-type="bibr" rid="c48">48</xref>)</italic>, the process of T-cell development translates into high-dimensional single-cell data with complex topology which need to be interrogated computationally.</p>
<p>We developed <italic>tviblindi,</italic> a new tool which breaks new ground in several aspects:
<list list-type="order">
<list-item><p>It offers a highly scalable, linear complexity framework that works at a single-cell level.</p></list-item>
<list-item><p>Analysis is performed in the original high-dimensional space, avoiding artifacts of dimensionality reduction.</p></list-item>
<list-item><p>The framework is adapted to discover features taking into consideration their varying scales (along the time axis or in different cell types).</p></list-item>
<list-item><p>Crucially, our method allows the user to interact with the analytical process and to set the appropriate level of resolution in real time.</p></list-item>
</list>
In this paper, we first describe our new computational approach to exploration of developmental trajectories. Then we present an analysis of real-world datasets of T-cell development to illustrate the power of our analytical method and to describe the development of human T regulatory cells in detail. Last, we describe novel discrete stages in the development of Tregs and cell surface markers used in their study.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Computational method for the TI and interrogation - <italic>tviblindi</italic></title>
<p>The objective of <italic>tviblindi</italic> is to offer a flexible framework for TI and topological data analysis (TDA) interrogation of single-cell data. <italic>tviblindi</italic> facilitates efficient interpretation of data as well as sensitive discovery of minor trajectories. These two competing goals are resolved by interactive grouping of random walks, which are used as probes in the high-dimensional space, into trajectories, allowing for real-time adjustment of trajectory-specific resolution. This interactive approach provides an exhaustive description of the data, while allowing the researcher to introduce expert knowledge into the analytical process and to gradually gain insight into a particular dataset.</p>
<p><italic>tviblindi</italic> was designed as an integrated framework implementing several independent modules to facilitate the use of diverse approaches to pseudotime estimation and data visualization, without the need to rerun the analysis. <italic>tviblindi</italic> allows to compute pseudotime which is resilient to unequal distributions of cells (e.g., accumulation of double positive T cells during T-cell development or in case of the presence of a developmental block). It also keeps the resolution on the single-cell level, while processing data in a reasonable time frame. Random walks, directed by the pseudotime, are then simulated, thus creating a set of probes in the high-dimensional space. To assemble random walks into meaningful trajectories, <italic>tviblindi</italic> employs witness complex triangulation <italic>(<xref ref-type="bibr" rid="c49">49</xref>)</italic> to capture the topology of the original data without the need for dimensionality reduction. It implements a representation of homology classes, which accounts for incomplete coverage of the high-dimensional points by the triangulation, navigating around the potential pitfall of this computational approach.</p>
<p>Contrary to other approaches, <italic>tviblindi</italic> considers each random walk a separate entity, which allows for probing major as well as minor trajectories while keeping track of the feature dispersion along the time axis. This approach enables sensitive detection of irregularities, such as hubs and discontinuities, in the topology of the underlying graph. While pseudotime captures local geometry of the data, persistent homology <italic>(<xref ref-type="bibr" rid="c50">50</xref>)</italic> aims to capture significant non-local features such as sparse regions (holes), which persist over a range of scales. In simplified terms, the persistence of a sparse region may be understood as the difference between the density of points at its boundary and in its interior.</p>
<p>Most persistent features can be extracted and used to capture the differences between random walks, inducing a multiscale clustering <italic>(<xref ref-type="bibr" rid="c51">51</xref>)</italic>. We generalized and extended this idea to high-dimensional data. We took advantage of the natural hierarchical structure of persistent homology classes to achieve real-time, on-demand aggregation of random walks into trajectories respecting both local geometry and global topology of the point cloud.</p>
<sec id="s2a1">
<title>Introducing tviblindi on an artificial data set</title>
<p>We showcase our methodology using an artificial dataset created with the <italic>dyntoy</italic> package (for further details see Supplementary note, subsection 1.1 <italic>dyntoy</italic> dataset). <xref rid="fig1" ref-type="fig">Figure 1A</xref> shows a schematic representation of the data, capturing the basic topology with sparse regions labeled α and β.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Analytical process on the artificial <italic>dyntoy</italic> dataset</title><p>Dashed lines mark selections made by the user, panels A-C show a scheme of the whole dataset, panels D-I correspond to the interactive GUI for this dataset: (A) The scheme of a point cloud representing single-cell data, where sparse regions α and β are present. (B) The dataset is represented as a k-NNG and the cell of origin is selected. (C) Pseudotime is calculated as expected hitting distance and the edges of the k-NNG are oriented according to the pseudotime. Candidate endpoints are automatically suggested as vertices without outgoing edges (circled). (D) Estimated pseudotime is represented by a yellow-to-red color gradient, the origin is shown as the purple dot. Potential developmental fates (x, y, z) are shown as gray points on the <italic>vaevictis</italic> plot. Endpoints can be selected for further investigation (in this example, all endpoints are selected, dashed line). (E) Sparse regions are represented on a persistence diagram, which enables the selection of the significant sparse regions (dashed line). The sparse regions γ and δ correspond to essential classes created by the selection of disparate endpoints. This way, random walks are classified using the selected ends and sparse regions. (F) All random walks are shown on the <italic>vaevictis</italic> plot and their classification into trajectories is depicted in the hierarchical clustering dendrogram. (G) By selecting branch (a) leading to the endpoint (x) of this dendrogram, the given trajectory can be investigated in detail, including viewing the average expression of multiple markers along pseudotime. (H) By selecting two endpoints (x and y) but only a single relevant marker, its dispersion and possible branching points can be examined. Trajectories (a and e) from panel F are visualized and the branching region (p) is selected. (I) Multiple trajectories (trajectory i in red and a and e in blue) can be visualized on the 2D plot. Points in the selected branching region (p) are highlighted in green. (J) Connectome representing a basic structure of the data and the simulated random walks. The pie charts indicate the distributions of cell populations in each vertex (cluster). The arrows show the direction of pseudotime. Vertex containing the cell of origin (O) and vertices containing endpoints (T).</p></caption>
<graphic xlink:href="547329v3_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>First, the data are represented as an undirected k-nearest neighbor graph (k-NNG; <xref rid="fig1" ref-type="fig">Figure 1B</xref>). The cell of origin is defined by the user (either directly, or a population of origin is specified and the point closest to the centroid of this population is then taken) and used to estimate pseudotemporal ordering (pseudotime) directed away from the origin (<xref rid="fig1" ref-type="fig">Figure 1B</xref>). Edges of the k-NNG are oriented with respect to the pseudotime forming a directed acyclic graph (DAG).</p>
<p>Next, a large number (typically thousands) of random walks is simulated on the DAG. These walks are finite and their final vertices are candidates to become developmental endpoints (<xref rid="fig1" ref-type="fig">Figure 1C</xref>). The user can select one or more potential endpoints for further investigation (<xref rid="fig1" ref-type="fig">Figure 1D</xref> labeled x, y, z).</p>
<p>A persistence diagram, which captures the prominence of sparse regions within the point cloud, then allows the user to select significant sparse regions (<xref rid="fig1" ref-type="fig">Figure 1E</xref>), and random walks are organized into trajectories by means of hierarchical clustering. This clustering respects the global geometry and classifies trajectories based on how they navigate around the sparse regions (<xref rid="fig1" ref-type="fig">Figure 1F</xref>). In the presented artificial dataset, <italic>tviblindi</italic> correctly identified three putative endpoints (x, y, z) and organized simulated random walks into three distinct trajectories for each endpoint (a, b and c, for end x; d, e and f for end y and g, h and i for end z).</p>
<p>Our interactive framework allows the user to inspect the evolution of specific markers (<xref rid="fig1" ref-type="fig">Figure 1G</xref>), track key points in their development (e.g., branching point p) and focus on cells at such key points (<xref rid="fig1" ref-type="fig">Figure 1H, I</xref>). For a quick overview, a “connectome” summarizing the basic structure of the point cloud and of simulated random walks can be plotted (<xref rid="fig1" ref-type="fig">Figure 1J</xref>). We describe each <italic>tviblindi</italic> module below. Detailed algorithmic descriptions of particular modules can be found in the Supplementary note, sections 2-4.</p>
</sec>
<sec id="s2a2">
<title>Visualization</title>
<p>Visualization of high-dimensional data is essential for the initial overview and for the informed interactions with the data during downstream analysis. However, any dimensionality reduction introduces simplification, which can lead to misinterpretation. In <italic>tviblindi</italic> framework, the dimensionality reduction step is independent of all other modules (which work directly in the original high-dimensional space) and is used solely for a visual representation of the dataset.</p>
<p>While dimensionality reduction has been extensively and successfully used for single-cell data (e.g., UMAP <italic>(<xref ref-type="bibr" rid="c52">52</xref>,<xref ref-type="bibr" rid="c53">53</xref>)</italic> and viSNE <italic>(<xref ref-type="bibr" rid="c54">54</xref>,<xref ref-type="bibr" rid="c55">55</xref>)</italic>), interpreting developmental trajectories requires not only the local, but also the global relationships of cells to be captured (often distorted in the lower-dimensional embedding by current dimensionality reduction algorithms). For this purpose, we created <italic>vaevictis</italic>, a variational autoencoder model based on ideas in <italic>scvis (<xref ref-type="bibr" rid="c56">56</xref>)</italic> and <italic>ivis (<xref ref-type="bibr" rid="c57">57</xref>)</italic> fitted with naive importance sampling. This technique creates a continuous representation of the data rather than isolated islands of populations (Supplementary note, section 2 Dimensionality reduction, <xref rid="fig1" ref-type="fig">Figure 1B, C</xref>). Due to the naive importance sampling step, numerically large compact populations are not overrepresented. This way, we obtain a clearer picture of the developmental dynamics in the data (Supplementary note, section 2 Dimensionality reduction, <xref rid="fig1" ref-type="fig">Figure 1D, E</xref>). Moreover, once calculated, it can be applied to new datasets with the same measured parameters (protein markers or detected transcripts), facilitating integration of new results.</p>
</sec>
<sec id="s2a3">
<title>Pseudotime and random walks simulation</title>
<p>Correct pseudotemporal ordering is an essential and computationally intensive part of TI algorithms. Here we use a particular formulation (and modification) of the idea of <italic>expected hitting time (<xref ref-type="bibr" rid="c58">58</xref>)</italic>. We calculate the expected number of random steps necessary to reach any cell in a dataset from the cell of origin. To leverage the sparsity of the k-NNG and to calculate the hitting times on a single-cell level, we use the following formulation: given an undirected k-NNG <italic>G</italic> = (<italic>V</italic>, <italic>E</italic>, <italic>p</italic>), with vertices <italic>V</italic>, edges <italic>E</italic>, weights <italic>p</italic>: <italic>E</italic> → [0,1] representing the probability of transition of each edge respectively, and an origin <italic>v</italic><sub>0</sub>, the expected hitting time of a cell is a weighted average of hitting times of its neighbors increased by 1 <italic>τ</italic>(<italic>y</italic>) = ∑<sub><italic>x</italic>:{<italic>x</italic>,<italic>y</italic>}∈<italic>E</italic></sub> <italic>p</italic><sub><italic>xy</italic></sub> (<italic>τ</italic>(<italic>x</italic>) + 1), <italic>y</italic> ≠ <italic>v</italic><sub>0</sub> and <italic>τ</italic>(<italic>v</italic><sub><italic>o</italic></sub>) = 0. This formula translates into a sparse linear system, which can be solved efficiently by numerical methods (such as conjugate gradients) to any precision even for graphs with millions of vertices. Consequently, we are able to calculate the pseudotime directly in the original space at a single-cell level. Furthermore, we obtain a measure of success: the relative error reported by the numerical solver.</p>
<p>A key application of <italic>tviblindi</italic> is the comparison of trajectories between normally developing tissues and those with developmental abnormalities, manifesting a block and/or pathological proliferation resulting in an overabundant intermediate population. In such cases, the hitting time calculation would assign the highest pseudotime to this intermediate population, which would hamper the topology of simulated random walks (Supplementary note, section 3, Pseudotime estimation &amp; random walks simulation). To mitigate this effect, the formula above can be modified in the following way: suppose that apart from <italic>G</italic> = (<italic>V</italic>, <italic>E</italic>, <italic>p</italic>), we have a sparse matrix <italic>D</italic>, recording mutual distances for all vertices in the graph connected by an edge. Then the definition of the pseudotime as the <italic>expected hitting distance is τ</italic>(<italic>y</italic>) = ∑<sub><italic>x</italic>:{<italic>x</italic>,<italic>y</italic>}∈<italic>E</italic></sub> <italic>p</italic><sub><italic>xy</italic></sub> (<italic>τ</italic>(<italic>x</italic>) + <italic>D</italic><sub><italic>xy</italic></sub>), <italic>y</italic> ≠ <italic>v</italic><sub>0</sub> and <italic>τ</italic>(<italic>v</italic><sub><italic>o</italic></sub>) = 0.</p>
<p>In other words, the expected distance to travel before reaching vertex y. Both methods are also very robust with respect to the choice of the number of neighbors in the k-NNG (Supplementary note, section 8 Performance evaluation).</p>
<p>Once pseudotime is computed, the edges in the graph <italic>G</italic> = (<italic>V</italic>, <italic>E</italic>, <italic>p</italic>) get oriented (<xref rid="fig1" ref-type="fig">Figure 1B</xref>) and a large number of random walks is simulated on the DAG (<xref rid="fig1" ref-type="fig">Figure 1F</xref>). Importantly, all random walks on the graph are finite. The set of terminal vertices of these walks represents estimates of terminal biological fates (for further details see Supplementary note, section 3 Pseudotime estimation &amp; random walks stimulation).</p>
</sec>
<sec id="s2a4">
<title>Real-time interactive topological classification</title>
<p>The most distinctive feature of <italic>tviblindi</italic> is the interactive aggregation of simulated random walks into trajectories with respect to the global topology of the point cloud. This procedure is based on the idea of multi-scale topological classification using persistent homology <italic>(<xref ref-type="bibr" rid="c59">59</xref>)</italic>. Random walks are considered distinct entities, and they can be aggregated into trajectories respecting the structure of the point cloud.</p>
<p>Walks are clustered based on how they circumnavigate significant sparse regions identified using persistent homology. The appropriate level of significance can be adjusted by the user by the selection of significant sparse regions on a persistence diagram (<xref rid="fig1" ref-type="fig">Figure 1E</xref>). Classification by the means of persistent homology has a natural hierarchical structure induced by filtration <italic>(<xref ref-type="bibr" rid="c59">59</xref>,<xref ref-type="bibr" rid="c60">60</xref>)</italic> (see Supplementary note, section 4 Topological clustering of random walks for details), which translates into a dendrogram of random walks (<xref rid="fig1" ref-type="fig">Figure 1F</xref>).</p>
<p>Applying classification by persistent homology to a large high-dimensional dataset with considerable technical noise requires several improvements of previously published work <italic>(<xref ref-type="bibr" rid="c59">59</xref>)</italic>. First, as noted above, the selection of significant sparse regions is interactive, which allows the user to choose an appropriate level of detail for each dataset or trajectory. Second, we use witness complex triangulation <italic>(<xref ref-type="bibr" rid="c61">61</xref>)</italic> to adapt for high dimensionality of single-cell data (for which the original methodology was intractable). Third, since the witness complex triangulation does not guarantee filling the space completely, we introduce the detection and representation of sparse regions with infinite persistence. This last modification also allows us to classify random walks into trajectories based on their different endpoints and consequently to study developmental branching. (This is impossible with the original formulation.) See Supplementary Videos and Supplementary note for a presentation of the <italic>tviblindi</italic> graphical user interface (GUI).</p>
</sec>
<sec id="s2a5">
<title>Connectome – a fully automated pipeline</title>
<p>For a quick overview of a given dataset, we have implemented a “connectome” functionality inspired by PAGA <italic>(<xref ref-type="bibr" rid="c5">5</xref>)</italic> (<xref rid="fig1" ref-type="fig">Figure 1J</xref>). This is a fully automated pipeline to create a directed graph, in which the data is clustered (by default using Louvain community detection <italic>(<xref ref-type="bibr" rid="c62">62</xref>)</italic>). Random walks are contracted to the identified clusters, providing a lower-resolution estimation of developmental trajectories. The clusters are plotted as pie charts of the represented cell populations. The graph layout employs the same 2D representation(s) as <italic>tviblindi</italic> GUI to facilitate the interpretation. The clusters containing the cell of origin and endpoints are automatically detected and denoted O and T respectively. At the same time the orientations and widths of edges reflect the direction and number of underlying random walks.</p>
<p>While this fully automated pipeline performs very well under various conditions we tested (Supplementary note, section 5 Connectome, and below), it suffers from some of the limitations of other fully automated, end-to-end methods. The resolution is fixed at a cell-population level in advance by the choice of clustering. Also, there is no direct way to interactively choose a resolution at the level of random walks, nor to discover and exclude clear artifacts. Therefore, we only encourage using this functionality as a means to get an overview of any given single-cell dataset with suggested trajectories, before the full interactive <italic>tviblindi</italic> analysis.</p>
</sec>
<sec id="s2a6">
<title>tviblindi exhaustively dissects human T-cell development</title>
<p>We applied <italic>tviblindi</italic> to the 34-parameter mass cytometry data obtained in our human T-cell development study (Supplementary Table Mass panel 1). The data contained barcoded human thymocytes and human peripheral blood mononuclear cells (PBMC). Dead cells and cells not belonging to the αβ T cell developmental lineage were excluded, yielding a total of 1,182,802 stained cells for analysis (Supplementary Figure 1). When the cells were visualized using a CD4xCD8 dot plot, we observed the expected patterns of double negative (DN), double positive (DP), CD4 single positive (SP) and CD8 SP populations for a cryopreserved thymus (<xref rid="fig2" ref-type="fig">Figure 2A</xref>). We then used the default <italic>vaevictis</italic> dimensionality reduction to reveal the basic structure of the T-cell compartment. Thymic and peripheral blood T cells were projected into distinct areas of the <italic>vaevictis</italic> embedding with a minor overlap (<xref rid="fig2" ref-type="fig">Figure 2B</xref>). Localization of the CD8, CD4 and Annexin V positive cells can be viewed on the plot using a heatmap color scale for expression levels of these markers. This provides an interpretable image of the T-cell compartment (<xref rid="fig2" ref-type="fig">Figure 2C</xref>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Visualization of the basic structure of the T-cell compartment using <italic>vaevictis</italic></title><p>(A) Bivariate CD4 x CD8 dot plot of cells from human thymus (brown) and human peripheral blood (blue) acquired using mass cytometry. The cells were gated as DN, DP, CD4 SP and CD8 SP. (B) <italic>vaevictis</italic> plot of 37-parameter (including barcode) mass cytometry panel measurement showing the positions of human thymus (brown) and human peripheral blood (blue), with the CD34<sup>pos</sup> progenitors shown in green. (C) Expression of CD8, CD4 and Annexin V shown using a blue-green-yellow-red color gradient on the <italic>vaevictis</italic> plot. Blue color indicates the lowest expression and red color indicates the highest.</p></caption>
<graphic xlink:href="547329v3_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Next, we gated the population of origin as CD34<sup>hi</sup> CD1a<sup>neg</sup> DN cells and analyzed the data with <italic>tviblindi</italic>. We simulated 7500 random walks and discovered eleven groups of endpoints labeled #1 - #11 (<xref rid="fig3" ref-type="fig">Figure 3A</xref>). Five of them (#1 to #5) were located in the region of peripheral CD4 T cells (where #5 corresponded to mature naive CD4 T cells transiting to peripheral blood). Endpoint #6 found among the thymic CD4 SP T cells is further described in the section <italic>Non-conventional end interpretation.</italic> Three groups of endpoints were located in the peripheral CD8 T cell compartment (where #7 corresponded to cells of CD8 TEMRA phenotype, #8 to CD8 central memory T cells and #9 to mature naive CD8 T cells transiting to the periphery). Two remaining endpoints (#10 and #11) belonged to the apoptotic thymocytes (compare to <xref rid="fig2" ref-type="fig">Figure 2B</xref> and <xref rid="fig2" ref-type="fig">2C</xref>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><title>Developmental endpoints and detailed analysis of major trajectory leading to endpoint #1 by <italic>tviblindi</italic></title><p>(A) <italic>vaevictis</italic> plot of T-cell development in thymus and peripheral blood. Estimated pseudotime is represented by a yellow-to-red color gradient with CD34<sup>pos</sup> progenitors as the population of origin (purple dot). Gray dots indicate the discovered developmental endpoints. Endpoint #1 highlighted by a blue rectangle represents mature CD4<sup>pos</sup> effector memory T cells selected for further exploration. (B) Connectome shows low resolution structure of the data and of simulated random walks. (C) Persistence diagram representing sparse regions detected within the point cloud of measured cells. The orange rectangle marks a user-defined selection of sparse regions. (D) Dendrogram of clustered trajectories shows a subcluster of 452 walks (red rectangle, labeled I) within a larger group of random walks (blue rectangle, labeled II). The number to the left of each leaf indicates the number of random walks in the leaf. (E) <italic>vaevictis</italic> plot displaying the above selected trajectories in corresponding colors. (F) Pseudotime line plot showing the average expression of selected individual markers along the trajectory to endpoint #1 (top). The selected areas of interest corresponding to T-cell developmental stages (green rectangles) are shown in green (as indicated by the arrows) on the <italic>vaevictis</italic> plots (below).</p></caption>
<graphic xlink:href="547329v3_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The connectome shows a basic overview of dynamics in the data on a cluster level (<xref rid="fig3" ref-type="fig">Figure 3B</xref>). The subsequent interactive analysis of simulated random walks gives biological meaning to the observed connections and allows for the detailed interpretation of data on a single-cell level.</p>
<p>First, we chose endpoint #1 representing peripheral CD4 effector memory T cells for further analysis. We applied persistent homology to select the significant sparse regions in the data and used these to cluster individual simulated random walks (<xref rid="fig3" ref-type="fig">Figure 3C</xref>). The topology of the point cloud representing human T-cell development is more complex than that of the illustrative artificial dataset shown in <xref rid="fig1" ref-type="fig">Figure 1</xref> and does not offer a clear cutoff for the choice of significant sparse regions. Interactive selection allows the user to vary the resolution and to investigate specific sparse regions in the data iteratively.</p>
<p>Clustering the random walks resulted in a dendrogram, where leaves with abundant walks represent the dominant developmental trajectories. Nonetheless even the less abundant groups of walks can be selected for in-depth investigation (<xref rid="fig3" ref-type="fig">Figure 3D</xref>).</p>
<p>Leaf I. contains the largest number (452) of random walks (<xref rid="fig3" ref-type="fig">Figure 3D</xref> and <xref rid="fig3" ref-type="fig">3E</xref>). Of note, leaf I. faithfully represents a larger supercluster of random walks II. (<xref rid="fig3" ref-type="fig">Figure 3D</xref> and <xref rid="fig3" ref-type="fig">3E</xref>). For the leaf I. trajectory, we displayed the intensity of expression of key markers along the calculated pseudotime (<xref rid="fig3" ref-type="fig">Figure 3F</xref> top). We then mapped the key developmental stages onto the <italic>vaevictis</italic> plot (<xref rid="fig3" ref-type="fig">Figure 3F</xref> bottom).</p>
<p>The CD4 ISP stage was found where CD4 and CD1a expression begins, but prior to CD8, intracellular TCRβ and CD3 expression. This is followed by a CD3<sup>neg</sup> DP stage, where intracellular TCRβ increases. Eventually, the DP cells become CD3<sup>pos</sup>, reflecting the successful expression of the TCRαβ receptor. Next, they lose CD8 and later they lose the cortical thymocyte marker CD1a. Finally, the CD4 SP thymocytes gain CD45RA and are ready to egress from the thymus as naive CD4 SP cells. In the peripheral blood they lose the CD45RA during maturation only to gain it at their terminal stage (<xref rid="fig3" ref-type="fig">Figure 3F</xref>). Similarly, if endpoint #7 is chosen, the canonical trajectory leading to peripheral CD8 cells can be visualized and described (Supplementary Figure 2).</p>
<p>This knowledge of the topology of key points of canonical development helped us to interpret additional developmental endpoints and the trajectories leading to them.</p>
</sec>
<sec id="s2a7">
<title>Variants of trajectories including selection processes</title>
<p>We then focused on alternative trajectories leading to peripheral CD4 cells corresponding to endpoint #1. Leaf IV., comprising 103 walks (<xref rid="fig4" ref-type="fig">Figure 4A</xref>) exhibits a clear artifact connecting highly dividing progenitor cells with doublets, which could invalidate a fully automated analysis (Supplementary Figure 3).</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><title><italic>tviblindi</italic> analysis of trajectories leading to apoptosis</title><p>(A) Dendrogram identical to <xref rid="fig3" ref-type="fig">Figure 3D</xref> with additional trajectories selected for closer investigation (blue rectangles) labeled III (137 random walks) and V (159 random walks). (B) <italic>vaevictis</italic> plot showing the topology of trajectories in leaves III and V. Apoptotic cells are shown in green. (C) Pseudotime line plot, which shows the average expression of selected markers along calculated pseudotime. The green rectangle highlights the region with increased expression of apoptotic marker Annexin V and decreased expression of phosphotyrosine. Events in the selected region are displayed in panel 4B in green (see the arrow). (D) A detailed dendrogram of leaf V from panel 4A. Two distinct trajectories were selected for further analysis (blue rectangle, Va and red rectangle, Vb). (E) <italic>vaevictis</italic> plot showing the topology of trajectories in leaves Va and Vb. The green polygon marks the region of apoptosis, the gray polygon marks the region of more advanced stages of thymic and peripheral CD4 T-cell development. (F) Pseudotime line plot, which depicts the average expression of selected markers along the trajectories Va and Vb. The region of apoptosis and the region of more advanced stages of CD4 T-cell development are highlighted (green and gray rectangle respectively).</p></caption>
<graphic xlink:href="547329v3_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For further in-depth investigation we selected the two remaining larger groups of random walks represented in the dendrogram by leaves highlighted as III. and V. (<xref rid="fig4" ref-type="fig">Figure 4A</xref>). After the CD3<sup>neg</sup> DP stage, these trajectories diverted from the canonical course described above. The cells passed through a region with an overall decrease in phosphorylated tyrosine expression and an increase in Annexin V expression, indicating apoptosis (<xref rid="fig4" ref-type="fig">Figure 4B</xref> and <xref rid="fig4" ref-type="fig">4C</xref>). Endpoints #10 and #11 were situated in this apoptotic region (see <xref rid="fig3" ref-type="fig">Figure 3A</xref> for their precise location). We therefore interpreted the first part of these trajectories as leading to apoptosis upon failure of DP thymocytes to pass either positive or negative selection checkpoints in the thymic cortex (<xref rid="fig4" ref-type="fig">Figure 4B</xref> and <xref rid="fig4" ref-type="fig">4C</xref>).</p>
<p>Counterintuitively, after going through the apoptotic stage (indicated by a green hexagon in <xref rid="fig4" ref-type="fig">Figure 4E</xref>), the trajectories reconnected back to the canonical trajectory (indicated by a gray hexagon in <xref rid="fig4" ref-type="fig">Figure 4E</xref>). The reason for this was a (valid) connection between CD4 SP cells and apoptotic cells, reflecting negative selection in the thymic medulla. However, this connection went in the opposite direction from the biologically meaningful course of events. One reason for this was the similar immunophenotype of all late apoptotic cells regardless of the stage at which they entered the apoptotic pathway (with characteristic expression profile of the apoptotic cells being negative for most markers, and positive for Annexin V). At the same time, these apoptotic cells are positioned halfway between the cell of origin and CD4 SP cells. This leads to a reversal of the pseudotime gradient, making the false impression that cells may pass through an apoptotic phase into a later developmental stage.</p>
<p>One of the most important questions in exploratory data analysis is whether the chosen level of detail is sufficient to exploit the information present in the data, or whether resolution needs to be increased. The interactive design of <italic>tviblindi</italic> allowed us to change the level of resolution on the persistence diagram and to investigate the random walks heading to apoptosis in more detail. After increasing the resolution, we observed that leaf V random walks split into two clear trajectories (Va and Vb, <xref rid="fig4" ref-type="fig">Figure 4D</xref>). The Va trajectories corresponded to the aforementioned failure to pass the positive/negative selection checkpoint. The Vb trajectories diverted from the canonical trajectory even earlier (<xref rid="fig4" ref-type="fig">Figure 4E</xref>), before the DP stage, and headed directly toward apoptosis.</p>
<p>Contrary to Va where the cells expressed intracellular TCRβ prior to Annexin V, the Vb cells failed to express TCRβ before entering the apoptotic trajectory (<xref rid="fig4" ref-type="fig">Figure 4F</xref>). We interpret this as failure to pass the β selection checkpoint due to unsuccessful TCRβ chain rearrangement. The later appearance of TCR β, after expression of Annexin V (<xref rid="fig4" ref-type="fig">Figure 4F</xref>), is caused by mixing with cells entering apoptosis at later developmental stages.</p>
<p>Similarly, if we focus on CD8 T cells, the same checkpoints can be discovered and interrogated (Supplementary Figure 4).</p>
<p>In summary, we show that <italic>tviblindi</italic> organized individual cells expressing various levels of 34 markers into trajectories leading to the expected ends of αβ T-cell development and discovered the corresponding checkpoints. Biological interpretation was enabled by plotting the expression of key markers along the developmental pseudotime. We were able to describe the canonical development of conventional CD4 T cells and CD8 T cells from their progenitors in the thymus to effectors in peripheral blood. We also found trajectories leading to apoptosis, when thymocytes failed to pass TCRβ selection or positive selection or when they were negatively selected (See Supplementary Video 2).</p>
</sec>
<sec id="s2a8">
<title>Non-conventional end interpretation</title>
<p>The last analyzed trajectory remaining to be interpreted was the one leading to endpoint #6 (<xref rid="fig3" ref-type="fig">Figure 3A</xref>, <xref rid="fig5" ref-type="fig">Figure 5A</xref>). The corresponding population is hereafter referred to as End#6. End#6 was found in the thymic region (compare <xref rid="fig2" ref-type="fig">Figure 2B</xref> and <xref rid="fig3" ref-type="fig">Figure 3A</xref> for precise location in the <italic>vaevictis</italic> plot) and contained CD4 SP cells as well as a smaller fraction of cells which fall within the DP gate (Supplementary Figure 5A). The pseudotime line plot of CD8 expression shows that the End#6 cells gain dim expression of CD8 at the very end of the trajectory (Supplementary Figure 5B, <xref rid="fig5" ref-type="fig">Figure 5B</xref>). The possibility that CD4<sup>pos</sup>CD8<sup>dim</sup> cells from the End#6 population are doublets consisting of a developing DP cell and a more mature CD4 SP T cell, as previously suggested <italic>(<xref ref-type="bibr" rid="c63">63</xref>)</italic>, was ruled out by comparing the DNA content of End#6 SP and DP populations with the DNA content of dividing CD34<sup>pos</sup> precursor cells (Supplementary Figure 5C).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><title><italic>tviblindi</italic> analysis of the trajectory leading to End#6</title><p>(A) A trajectory leading to End#6 located in the thymic portion of the <italic>vaevictis</italic> plot (compare to <xref rid="fig2" ref-type="fig">Figure 2B</xref>). (B) Pseudotime line plot showing average expression of selected individual markers along developmental pseudotime. (C) <italic>vaevictis</italic> plot showing the trajectory to the conventional naive CD4 SP T cells (blue) and the trajectory to End#6 (orange). Conventional naive CD4 SP T cells are shown in purple, the immature Treg stage in brown and End#6 in orange. (D) Bivariate plot of CD25 and CD127 expression on gated conventional naive CD4 SP T cell (purple), immature Treg stage (brown) and End#6 (orange). (E) Bivariate plot of Helios and FOXP3 expression on conventional naive CD4 SP T cell (purple), immature Treg stage (brown) and End#6 (orange) in a validation experiment.</p></caption>
<graphic xlink:href="547329v3_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The trajectory leading to End#6 diverged from the conventional CD4 trajectory at the branching point of negative selection (<xref rid="fig5" ref-type="fig">Figure 5C</xref>, compare with <xref rid="fig4" ref-type="fig">Figure 4E</xref>) and continued through a distinct intermediate subset before reaching End#6. The End#6 cells have a CD25<sup>hi</sup>, CD127<sup>pos</sup> phenotype, which distinguishes them from the preceding stage reminiscent of T regulatory (Treg) cells (CD25<sup>pos</sup>CD127<sup>neg</sup>), which could represent the immature Treg stage (<xref rid="fig5" ref-type="fig">Figure 5B</xref> and <xref rid="fig5" ref-type="fig">5D</xref>). This observation led us to investigate the expression of Treg-specific markers in End#6 cells using a modified antibody panel (Supplementary Table Mass panel 2). After we gated the relevant populations and visualized them in the <italic>vaevictis</italic> plot (Supplementary Figure 6), we observed that FOXP3 (transcription factor of Treg cells) and Helios (transcription factor shown to be upregulated upon negative selection in mice <italic>(<xref ref-type="bibr" rid="c21">21</xref>,<xref ref-type="bibr" rid="c64">64</xref>,<xref ref-type="bibr" rid="c65">65</xref>)</italic>) is expressed by the CD25<sup>pos</sup>CD127<sup>neg</sup> immature Treg cells as well as by the CD25<sup>hi</sup>CD127<sup>pos</sup> End#6 cells (<xref rid="fig5" ref-type="fig">Figure 5E</xref>). Therefore, we hypothesized that End#6 cells constitute a specific Treg population (<xref rid="fig5" ref-type="fig">Figure 5D</xref> and <xref rid="fig5" ref-type="fig">5E</xref>).</p>
<p>Some published reports describe the divergence of Treg cell development at the DP stage, with FOXP3 expression already detectable at the DP stage <italic>(<xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c39">39</xref>,<xref ref-type="bibr" rid="c63">63</xref>,<xref ref-type="bibr" rid="c66">66</xref>–<xref ref-type="bibr" rid="c69">69</xref>)</italic>. Therefore, we wanted to ensure that positioning of the CD8<sup>dim</sup> cells at the end of the trajectory is not an artifact of the TI. We decided to sort the populations of interest by fluorescence-activated cell sorting (FACS) and estimate their developmental order based on the analysis of the presence of T-cell receptor excision circles (TRECs).</p>
<p>We used a specific panel (Supplementary Table Mass panel 3) to select surface markers distinguishing between End#6 cells, immature Tregs, CD4 SP and DP cells (Supplementary Figure 7) and to design a gating strategy for sorting these populations (Supplementary Figure 8). To confirm that the sorting strategy led to identification of the correct populations, we overlaid the conventionally gated populations over the <italic>vaevictis</italic> plot (Supplementary Figure 9). Based on this analysis, we designed an 11-color panel for FACS sorting (Supplementary Table FACS panel) and sorted the key populations from thymus and from pediatric and adult peripheral blood (Supplementary Figure 10). We measured the presence of TRECs and T cell receptor alpha constant gene region (TCRAC) in the sorted populations to estimate the number of cell divisions undergone since the recombination of the TCRα chain (<xref rid="fig6" ref-type="fig">Figure 6A</xref>). The number of cell divisions, as estimated by the calculated TREC/TCRAC, ratio was lower than two in immature CD3<sup>pos</sup> DP cells and immature Treg (DP as well as CD4 SP) cells. Thymic conventional mature naive CD4 SP did not feature a significant number of divisions. The TREC/TCRAC ratio in conventional naive CD4 SP cells in pediatric peripheral blood corresponded to 1-2 cell divisions, while in the adult peripheral blood it corresponded to 3-4 cell divisions. For CD45RA<sup>neg</sup> Treg cells sorted from pediatric as well as adult peripheral blood, this was more than 5 cell divisions. For the End#6 CD4<sup>pos</sup>CD8<sup>dim</sup> and End#6 CD4 SP cells, the TREC/TCRAC ratio corresponded to more than 5 divisions. These results confirm that CD4<sup>pos</sup>CD8<sup>dim</sup> cells at the End#6 of the trajectory leading through immature Treg CD4 SP cells are not the true thymic DP cells. In agreement with our TI algorithm, we confirmed that End#6 cells represent a more developmentally advanced stage.</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption><title>Detailed analysis of End#6</title><p>(A) Visualization of the TREC/TCRAC ratio, depicted as the calculated number of divisions for each population. Symbol code: cells from peripheral blood (blue), cells from thymus (brown), cells from adult donor (circle), cells from pediatric donor (triangle). (B) Pseudotime line plot depicting the expression of TIGIT, CD95, CD152, T-bet, CD69 and CD197 markers by cells from trajectory to End#6. (C) Overlaid histograms showing the expression of chemokine and cytokine receptors CD197, CD363, CD218 and CD196 in the respective populations. Symbol code: End#6 cells from thymus (orange), Tregs from peripheral blood (blue), immature Tregs from thymus (brown) and naive CD4 SP T cell from peripheral blood (purple).</p></caption>
<graphic xlink:href="547329v3_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Further investigation revealed an increase in the expression of several other markers at the end of the trajectory: apart from CD127 and CD8 the cells gained expression of T-bet, CD95, TIGIT and CD152 (CTLA-4) (<xref rid="fig6" ref-type="fig">Figure 6B</xref>). In fact, End#6 cells, irrespective of CD8 expression, phenotypically resembled the previously described long-lived thymic regulatory cells, which have been reported to recirculate from the periphery back to the thymus <italic>(<xref ref-type="bibr" rid="c44">44</xref>,<xref ref-type="bibr" rid="c70">70</xref>–<xref ref-type="bibr" rid="c74">74</xref>)</italic>.</p>
<p>To test the hypothesis that End#6 cells are recirculating Tregs homing into thymus, we measured the expression of key chemokine receptors <italic>(<xref ref-type="bibr" rid="c71">71</xref>,<xref ref-type="bibr" rid="c72">72</xref>,<xref ref-type="bibr" rid="c75">75</xref>–<xref ref-type="bibr" rid="c77">77</xref>)</italic> in the populations of interest (<xref rid="fig6" ref-type="fig">Figure 6C</xref>). In contrast with the thymic mature naive CD4 SP <italic>(<xref ref-type="bibr" rid="c75">75</xref>)</italic>, End#6 cells as well as immature Treg cells lack the S1PR1 (CD363) necessary to egress from the thymus. On the other hand, End#6 cells express IL-18R (CD218), which has been reported to cause upregulation of CCR6 (CD196) upon stimulation with IL-18 <italic>(<xref ref-type="bibr" rid="c72">72</xref>)</italic>. CCR6 can then mediate the entry of Treg cells into the thymus <italic>(<xref ref-type="bibr" rid="c72">72</xref>,<xref ref-type="bibr" rid="c76">76</xref>)</italic>. End#6 cells expressed more CCR6 compared to CD4 SP naive T cells and immature Treg cells. The last measured chemokine receptor, CCR7 (CD197) has been previously reported to distinguish the newly formed Treg cells, which do express CCR7, from the recirculating Treg cells which do not express CCR7<italic>(<xref ref-type="bibr" rid="c71">71</xref>)</italic>. Consistent with this, while our immature Treg cells express CCR7, the End#6 cells do not (<xref rid="fig6" ref-type="fig">Figure 6C</xref>).</p>
<p>Since the thymic Treg population identified in the study of Park et al. <italic>(<xref ref-type="bibr" rid="c45">45</xref>)</italic>, interpreted by the authors as long-residing in the thymus (here referred to as Treg-atlas), was placed in a terminal developmental position similar to End#6 (<xref rid="fig7" ref-type="fig">Figure 7A</xref>), we reanalyzed their single-cell RNA-seq data using <italic>tviblindi</italic> (See Supplementary note, section 9, Analysis of human thymus single-cell RNA-seq data). See <xref rid="fig7" ref-type="fig">Figure 7B</xref> for the localization of Treg-atlas on the <italic>vaevictis</italic> plot and <xref rid="fig7" ref-type="fig">Figure 7C</xref> for the trajectory leading to Treg-atlas. The RNA expression profile of Treg-atlas corresponds to the protein profile of End#6 suggesting that we are analyzing the same population (<xref rid="fig7" ref-type="fig">Figure 7D-F</xref>, compare to <xref rid="fig5" ref-type="fig">Figure 5B</xref> and <xref rid="fig6" ref-type="fig">Figure 6B, C</xref>). Apart from markers already presented in our mass cytometry panels, Treg-atlas show a sharp increase in <italic>IL-1R2</italic> RNA (<xref rid="fig7" ref-type="fig">Figure 7E</xref>) further reinforcing the hypothesis that these cells are recirculating from the periphery <italic>(<xref ref-type="bibr" rid="c74">74</xref>,<xref ref-type="bibr" rid="c78">78</xref>–<xref ref-type="bibr" rid="c82">82</xref>)</italic>. Furthermore, <xref rid="fig7" ref-type="fig">Figure 7G</xref> shows the expression of additional chemokine receptors known to play a role in guiding Treg cells to peripheral sites (tumors and other sites of inflammation). Thus, <italic>tviblindi</italic> detected the trajectory leading to developmentally advanced Treg cells in single-cell RNA-seq data as well as in mass cytometry protein data.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption><title><italic>tviblindi</italic> analysis of single-cell RNA data from the study of Park et al. <italic>(<xref ref-type="bibr" rid="c45">45</xref>)</italic> showing the trajectory to Treg population corresponding to End#6</title><p>For A and B, the origin (centroid of DN (early) population) is marked by a purple dot, the candidate endpoints with more than 1% of simulated random walks are indicated by black dots and the endpoints corresponding to the Treg-atlas are highlighted by a blue rectangle. (A) UMAP plot identical to the one shown in <xref rid="fig3" ref-type="fig">Figure 3A</xref> of published research by Park et al. <italic>(<xref ref-type="bibr" rid="c45">45</xref>)</italic> showing the populations using the annotations from the authors, legend at the bottom left. (B) <italic>vaevictis</italic> plot of the same data as in A with shown pseudotime represented by yellow-to-red color gradient. (C) <italic>vaevictis</italic> plot showing the trajectory leading to Treg-atlas. For (D-G), the individual markers are labeled in accordance with the original research by their gene names and the CD designated markers are shown in parentheses. (D) Pseudotime line plot of markers canonical to the Treg population. (E) Pseudotime line plot of markers associated with Treg activation overlapping with our mass cytometry data from End#6 cells shown in <xref rid="fig6" ref-type="fig">Figure 6B</xref>. (F) Pseudotime line plot of cytokine and chemokine receptors overlapping with our cytometry data from End#6 cells shown in <xref rid="fig6" ref-type="fig">Figure 6C</xref>. (G) Pseudotime line plot showing the expression of additional chemokine markers measured on Treg-atlas.</p></caption>
<graphic xlink:href="547329v3_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>We have developed <italic>tviblindi</italic>, a tool which allows a biologist working with real-world high-dimensional datasets to explore the development of cells from progenitors toward differentiated stages. By integrating several modules (random walks simulation, pseudotime inference, real-time interactive topological classification using persistent homology and two-dimensional visualization using the <italic>vaevictis</italic> algorithm) it presents a feasible algorithmic solution for TI, which significantly extends upon existing TI algorithms.</p>
<p><italic>tviblindi</italic> simulates possible random walks from a user-defined point of origin and highlights their endpoints in the dataset. It allows selection and grouping of similar random walks into trajectories based on visual interaction with the data. For each trajectory, marker intensity changes along trajectory pseudotime progression can be displayed. Also, the key points (e.g., branching) can be projected back onto a two-dimensional visual representation of the dataset. <italic>tviblindi</italic> does not anticipate a single endpoint nor a single branching point with two endpoints. Importantly, it can be used for both mass cytometry (millions of cells but only dozens of parameters) as well as single-cell RNA-seq (thousands of parameters) data.</p>
<p>The major contribution is, however, its versatility and the level of user interaction. By building a modular approach and an interactive interface, we offer a unique tool for a biologist to intuitively understand the dataset, visualize the data and to focus the analysis on meaningful TI endpoints. An efficient discovery of the underlying dynamics is made possible by using persistent homology to aggregate random walks into trajectories, project them immediately onto a low-dimensional embedding (created using a custom dimensionality reduction algorithm: <italic>vaevictis</italic>) and visualize marker-vs-pseudotime line plots. Importantly, the complete workflow has linear time complexity (See Supplementary note, subsection 8.3 Running times) and thus is manageable on a desktop computer in a reasonable computation time.</p>
<p>The dimensionality reduction is only used to visualize the data, and is not involved in any computation within the other modules. <italic>vaevictis</italic> reduction is designed to show gradual changes of single-cell phenotypes, suppressing the effect of abundant populations and showing local as well as global relationships of cells. This is in contrast to UMAP <italic>(<xref ref-type="bibr" rid="c52">52</xref>,<xref ref-type="bibr" rid="c53">53</xref>)</italic> and t-SNE <italic>(<xref ref-type="bibr" rid="c54">54</xref>,<xref ref-type="bibr" rid="c55">55</xref>)</italic>, which prioritize clustering of locally similar cells at the expense of global relationships.</p>
<p>The <italic>vaevictis</italic> plot of mass cytometry data from thymus and peripheral blood gave a faithful representation of the basic scheme of T-cell development.</p>
<p>When CD34<sup>pos</sup> progenitors were selected as the population of origin in our dataset (thymocytes and PBMC), the endpoints of trajectories were found within peripheral CD4 and CD8 cells, the apoptotic cells, and the population of CD4<sup>pos</sup>CD8<sup>dim</sup> thymic cells which we further explored in this paper and which we refer to as End#6 cells.</p>
<p>The endpoints at the thymus/peripheral blood transition (#5 for CD4 SP and #9 for CD8 SP) reflect the accumulation of cells at the stage of mature naive T cells. From this stage activated T cell may progress to become memory T cells. Of note, certain biological endpoints might be skipped if the final population is too small (the endpoint cells are not sufficiently represented) or if their phenotyping markers are missing (e.g., Th1-type, Th2-type markers are not included in any of our mass cytometry panels).</p>
<p>Furthermore, in the absence of markers resolving similar but developmentally unrelated cells, a random walk can create a connection between these unrelated cells and skip from one trajectory to another. When these immunophenotypically undistinguishable cells themselves represent developmental fate of two distinct trajectories, the two trajectories may combine into a single trajectory, skipping the endpoint in the middle. This phenomenon has been observed in the apoptotic region where some random walks leading to cells dying due to the failure of DP cells to pass the positive/negative selection checkpoint continued past the apoptotic stage in a reverse direction towards SP cells undergoing negative selection. Here the algorithm correctly found the trajectories, but expert input (understanding that apoptosis is a one-way process) was essential for the interpretation of the direction.</p>
<p>While the <italic>vaevictis</italic> embedding plots the cells on a 2D plot in an intuitive manner, some inherent limitations of 2D embeddings to comprehensively capture complex topologies were manifested. An example is the failure to visualize positive/negative selection of CD8 SP T cells, which is clearly detected by <italic>tviblindi.</italic> Note that when focusing on the trajectories of cells undergoing positive selection (V. Trajectories in <xref rid="fig4" ref-type="fig">Figure 4</xref>) in more detail, we have identified two groups of trajectories, one of them corresponding to positive selection (Va. trajectory) and one of them corresponding to an earlier β selection (cells entered the apoptotic pathway before expressing TCR β chain, Vb. trajectory). This highlights the benefit of expert-guided adjustment of the level of detail.</p>
<p>Investigation of the canonical CD4 and CD8 T-cell development reassured us that we can reconstruct the known sequence of maturation steps extensively described by CDMaps <italic>(<xref ref-type="bibr" rid="c83">83</xref>)</italic>, connecting the thymic and peripheral T-cell compartment. We were able to dismiss artifacts caused by cell doublets. Putting expression levels of markers on a pseudotime axis showed us the proper sequence and intensity of expression changes. Note that, for the trajectory leading to CD4 SP cells, both CD4 and CD8 reach an expression peak at the DP stage, both decrease their intensity afterwards and then CD4 steadily increases towards the CD4 SP stage. CD4 expression level in peripheral SP cells is twice as high as in thymic SP cells. Key points of marker intensity changes can be traced back to the <italic>vaevictis</italic> 2D plots and groups of trajectories can be selected for further investigation (expression levels and 2D plot location).</p>
<p>A good example of the power of the presented approach was found when interpreting thymic Treg populations. The trajectory leading towards thymic End#6 cells diverges from the conventional CD4 trajectory at the location of negative selection. It goes through a CD45RA<sup>neg</sup> immature Treg stage, characterized by the expression of CD25 in the absence of CD127 (conventional Treg immunophenotype), and continues towards the End#6 cells highly expressing CD25 and also expressing CD127. Both the immature Treg cells and the End#6 cells express Treg markers FOXP3 and Helios, confirming their Treg identity. The End#6 cells gain an expression of T-bet, CTLA-4, TIGIT, while they lose CD69, CD38 and CCR7. Surprisingly, they also gain a dim expression of CD8.</p>
<p>It has been shown that the ThPOK expression can be reduced in CD4 T cells, leading to reacquisition of CD8, and thus mimicking the DP immunophenotype. This was shown for CD8αα CD4 intraepithelial lymphocytes and CD8αβ CD4 cells in human blood as well as DP cells found in various tissues and under various disease settings. These have been reported to have enhanced cytotoxic functions or suppressive regulatory functions <italic>(<xref ref-type="bibr" rid="c84">84</xref>,<xref ref-type="bibr" rid="c85">85</xref>)</italic>.</p>
<p>Although some of End#6 cells can fall within the conventional DP gate, the CD8 expression level is lower than that of the “bona fide” DP thymocytes and <italic>tviblindi</italic> positioned these CD4<sup>pos</sup>CD8<sup>dim</sup> thymocytes at the end of the developmental trajectory. We wanted to make sure that their terminal end position is correct and that they are truly developmentally more advanced than the conventional immature DP cells and the immature CD4 SP Treg cells. Indeed, the proliferation history of End#6 cells (both CD8<sup>neg</sup> and CD8<sup>dim</sup>) showed many more cell divisions than any other thymic subset, more than naive T cells in the periphery (by a measured dilution of TREC DNA in the sorted subsets). Our End#6 CD8<sup>dim</sup> population may have been included in the FOXP3<sup>pos</sup> DP cells placed at the beginning of Treg development in previous studies <italic>(<xref ref-type="bibr" rid="c39">39</xref>,<xref ref-type="bibr" rid="c69">69</xref>)</italic>. Our approach provides a tool which can overcome the limitations of conventional gating and help to distinguish these cells.</p>
<p>However, we cannot claim that End#6 cells follow an uninterrupted developmental path from the precursors to End#6. In fact, the basic assumption of any TI method is that all developmental stages are present in the analyzed sample. If part of the development occurs in a peripheral organ which is not analyzed then an artificial shortcut can be mistaken for the whole path.</p>
<p>Indeed, the surface immunophenotype of End#6 cells agrees with the previously described population of peripheral Treg cells recirculating back to the thymus <italic>(<xref ref-type="bibr" rid="c42">42</xref>,<xref ref-type="bibr" rid="c73">73</xref>)</italic>. These cells were reported to have the ability to regulate the development of their precursors either negatively, by competing for the limiting amount of IL-2 <italic>(<xref ref-type="bibr" rid="c73">73</xref>)</italic> or positively by blocking potentially harmful effects of the inflammatory cytokine IL-1 via their IL-1R2 decoy receptor <italic>(<xref ref-type="bibr" rid="c74">74</xref>)</italic>. Furthermore, End#6 cells correspond to the Cluster 3 Tregs from the previously described thymus <italic>(<xref ref-type="bibr" rid="c44">44</xref>)</italic>, where scRNA and surface protein expression is suggestive of their recirculating mature effector Treg phenotype. This is in line with the low TREC DNA content in End#6 cells. Future experimental studies specifically designed to investigate this Treg population should address whether these cells result from recirculation or represent an additional path of intrathymic Treg effector maturation. The future studies could benefit from a <italic>tviblindi</italic> analysis of their immunophenotyping datasets.</p>
<p>In conclusion, we have built and validated a TI method that has generic use for mass cytometry, flow cytometry and single-cell RNA-seq. <italic>tviblindi</italic> is modular and interactive, thus combining the information strength of rich single-cell datasets with the power of expert knowledge for the interpretation of developmental trajectories.</p>
</sec>
<sec id="d1e1855" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e1972">
<label>Supplementary Figures</label>
<media xlink:href="supplements/547329_file02.pdf"/>
</supplementary-material>
<supplementary-material id="d1e1979">
<label>Supplementary Table</label>
<media xlink:href="supplements/547329_file03.pdf"/>
</supplementary-material>
<supplementary-material id="d1e1986">
<label>Supplementary Video 1</label>
<media xlink:href="supplements/547329_file04.mp4"/>
</supplementary-material>
<supplementary-material id="d1e1993">
<label>Supplementary Video 2</label>
<media xlink:href="supplements/547329_file05.mp4"/>
</supplementary-material>
<supplementary-material id="d1e2001">
<label>Supplementary note</label>
<media xlink:href="supplements/547329_file06.pdf"/>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<title>Acknowledgement</title>
<p>T.K. and J.S. were financially supported by project NU23-07-00170 of the Czech Republic Ministry of Health. Institutional support was provided by the project National Institute for Cancer Research (Project No. LX22NPO5102), funded by the European Union–Next Generation EU. D.N. is a fellow of FWO (Fonds Wetenschappelijk Onderzoek – Vlaanderen), supported by Strategic Basic research grant 1S40423N.</p>
</ack>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Sample preparation for mass cytometry</title>
<sec id="s4a1">
<title>Reagents</title>
<p>Unless otherwise stated, buffers and isotope labeled monoclonal antibodies (moAbs) were purchased from Standard BioTools Inc. (South San Francisco, USA). In-house antibody conjugations were performed using MaxPar labeling kits (Standard BioTools Inc.) according to the manufacturer’s instructions. Carrier-protein-free moAbs were purchased from Exbio (Prague, Czech Republic), BioLegend (San Diego, USA), R&amp;D Systems (Minneapolis, USA), eBioscience (San Diego, USA, part of Thermo Fisher Scientific Waltham, USA), Miltenyi Biotec (Bergisch Gladbach, Germany), Cell Signalling Technology (Danvers, USA) (for details see Supplementary Table Mass panels).</p>
</sec>
<sec id="s4a2">
<title>Antibody cocktails</title>
<p>The amount of labeled moAbs needed for one test was determined by titration. Two sets of antibody cocktails were prepared and frozen as described previously <italic>(<xref ref-type="bibr" rid="c86">86</xref>)</italic>: 1) the antibody cocktail containing moAbs against surface antigens, which was applied prior to fixation and permeabilization steps, and 2) antibody cocktail containing moAbs against intracellular antigens, which was applied after the permeabilization.</p>
</sec>
</sec>
<sec id="s4b">
<title>Human cells</title>
<p>Thymocytes were obtained from healthy donor thymi of pediatric patients undergoing heart surgery at the Motol University Hospital, after informed consent was given by the patient guardians, in accordance with the Declaration of Helsinki. Peripheral blood mononuclear cells (PBMC) were obtained by density gradient centrifugation from buffy coats of healthy adult donors, at Institute of Hematology and Blood Transfusion in Prague. The pediatric PBMC were obtained from healthy pediatric patients undergoing pre-surgical examination for non-malignant and otherwise unrelated medical issue after consent was given by patients’ guardians. Cells were stored in liquid nitrogen and thawed when needed for the experiment. After thawing, the cells were quickly transferred into 10 ml of pre-warmed RPMI supplemented with 10% FBS and 100µg of Pulmozyme (dornase alpha, Roche, Basel, Switzerland) for 30 min at 37°C. In order to remove dead cells and avoid clumping of the thymocytes, the cells were centrifuged at low speed 108g for 15 minutes. Subsequent steps were performed at 4°C.</p>
</sec>
<sec id="s4c">
<title>Staining</title>
<p>Cells were washed in Annexin binding buffer, ABB (Exbio), and counted, approximately 5 million thymocytes and 1 million PBMC were used for one experiment.</p>
<p>To minimize technical variability, the individual tissues were barcoded with CD45 Abs conjugated with different isotopes (30 min, 4 °C). Biotin labeled Annexin V was added together with the barcoding Abs, to distinguish apoptotic cells with exposed phosphatidylserine residues. After this incubation, the sample volume was risen to 1 ml and cisplatin 198Pt was added to distinguish dead cells (5 min, 4 °C). Cells were then washed twice in ABB (92 g, 15 min, 4 °C) and the samples were pooled together, spun (92 g, 15 min, 4 °C) and processed further as one sample.</p>
<p>The surface Ab cocktail, including the isotope labeled anti-biotin mAb to visualize the annexin, was added to the cell pellet (total volume of surface Abs was approx. 100 µl, 30 min, 4 °C).</p>
<p>Cells were washed twice in ABB (92 g, 15 min, 4 °C), prefixed with 1 ml freshly diluted 1,6% PFA (10 min, RT) and washed once more in Maxpar® Cell Staining Buffer, CSB (1050 g, 5 min, 4 °C). Then, the cells were fixed and permeabilized using Maxpar® Nuclear Antigen Staining buffer (30 min, 4 °C) followed by two washings in Maxpar® Nuclear Antigen Staining Perm (1050 g, 5 min, 4 °C).</p>
<p>In cases when the FOXP3 antibody was used, the cells stained with the surface Abs and washed in ABB were fixed and permeabilized in FOXP3 fixation/permeabilization buffer (30 min, 4 °C) followed by two washings in FOXP3 permeabilization buffer (600 g, 5 min, 4 °C).</p>
<p>The intracellular Ab cocktail was added to the cell pellet, together with anti-TCRb frame antibody labeled with APC (it was not possible for us to get this antibody in the unlabeled carrier-free form allowing in-house isotope conjugation) (the total volume of intracellular Abs was approx. 60 µl, 30 min, 4°C). The cells were washed twice in CSB (1050 g, 5 min, 4 °C). Finally, an APC directed isotope labeled mAb was added (30 min, 4 °C), cells were washed twice in CSB (1050 g, 5 min, 4 °C), fixed in 1 ml freshly diluted 1.6% formaldehyde (10 min, RT) and centrifuged (1050 g, 5 min, 4 °C).</p>
</sec>
<sec id="s4d">
<title>Mass cytometry samples acquisition</title>
<p>After incubation in 125nM 191/193Ir in Maxpar® Fix and Perm Buffer (at least 12 hours, up to 2 weeks), the cells were washed twice in CSB (1050 g, 5 min, RT) and once in Maxpar® Cell Acquisition Solution (CAS, 1050 g, 5 min, RT). Then they were diluted up to 1×10<sup>6</sup> cells/ml in 15 % EQ<sup>TM</sup> Four Element Calibration Beads (Standard BioTools Inc.) in CAS and filtered through a 35 μm nylon mesh cell-strainer cap (BD Biosciences, San Jose, CA). The samples were acquired using Helios (Standard BioTools Inc.), CyTOF software version 6.7.1014. The instrument was tuned for acquisition using Tuning Solution (Standard BioTools Inc.) according to the manufacturer’s instructions. The noise reduction (the cell length 7–150, lower convolution threshold 200) was applied during the acquisition. The signal was normalized using a Standard BioTools Inc. algorithm, which is based on the ‘Bead Passport’ concept.</p>
</sec>
<sec id="s4e">
<title>Analysis of mass cytometry data</title>
<p>After export to listmode data (FCS format), files were further processed using FlowJo (v10, BD Biosciences). First, nucleated cells were gated by metal-tagged DNA intercalator 191/193Ir, and thymus versus peripheral blood was debarcoded by manual gating (Supplementary Figure 1). Next, PBMC were gated on CD3<sup>pos</sup> lineage negative and TCR γδ negative T cells. The thymus cells were gated on lineage negative, viable (platinum negative) and TCR γδ negative thymocytes. Thus, only TCR αβ T cells and their progenitors in the thymus were used for further processing by the <italic>tviblindi</italic> algorithm described later. When manual gating was performed prior to <italic>tviblindi</italic>, the FlowJo workspace file was used to save manual gate positions, so that the gated cells could be displayed in the GUI, to help the interpret the <italic>vaevictis</italic> plot.</p>
<p>The <italic>tviblindi</italic> algorithm was programmed in R, C++ and Python. The source code is deposited on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/stuchly/tviblindi">https://github.com/stuchly/tviblindi</ext-link><underline>).</underline></p>
<p>The listmode data was transformed using <italic>arcsinh</italic> with cofactor 5 for subsequent analysis <italic>(<xref ref-type="bibr" rid="c87">87</xref>)</italic>. After data interrogation by <italic>tviblindi</italic>, an ‘enhanced’ FCS file was created, containing artificial channels with newly computed variables (2-dimensional embedding coordinates, pseudotime, pathway membership identifier, labels and selected points on trajectories) and a graphical output for figures was created using FlowJo layouts.</p>
</sec>
<sec id="s4f">
<title>FACS sorting</title>
<p>Human thymocytes and PBMC obtained as described above for mass cytometry experiments were stained with appropriate amount of fluorescently labeled monoclonal antibodies, at 1 million cells/50 µl for 30 minutes on ice in the dark (see Supplementary Table FACS panel). After incubation, cells were washed in ice-cold PBS and sorted using BD FACS Aria III cell sorter into tubes with 10 µl of ice-cold Platinum Direct cell lysis buffer with Proteinase K (ThermoFisher Scientific). The obtained subsets (see Supplementary Figure 10) were then directly processed according to the manufacturer’s instructions to minimize any loss of material.</p>
</sec>
<sec id="s4g">
<title>TREC analysis</title>
<p>Extracted DNA was used for the quantification of T-cell receptor excision circles (TREC) and T cell receptor alpha constant gene region (TCRAC) via previously established real-time PCR assay <italic>(<xref ref-type="bibr" rid="c88">88</xref>,<xref ref-type="bibr" rid="c89">89</xref>)</italic>. Estimated number of cell divisions was calculated based on the ratio between TREC and TCRAC copies in these populations.</p>
<p>All the background information on <italic>tviblindi</italic> design including used versions of R packages, dataset used for testing, dimensionality reduction, pseudotime estimation, topological clustering is available in the Supplementary note. Please, see the supplementary note also for detailed description and guide through the user interface and comparison with other state-of-the-art-methods <italic>(<xref ref-type="bibr" rid="c90">90</xref>–<xref ref-type="bibr" rid="c124">124</xref>)</italic>.</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Bendall</surname>, <given-names>S. C.</given-names></string-name> <etal>et al.</etal> <article-title>Single-Cell Trajectory Detection Uncovers Progression and Regulatory Coordination in Human B Cell Development</article-title>. <source>Cell</source> <volume>157</volume>, <fpage>714</fpage>–<lpage>725</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Saelens</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Cannoodt</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Todorov</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Saeys</surname>, <given-names>Y</given-names></string-name>. <article-title>A comparison of single-cell trajectory inference methods</article-title>. <source>Nature Biotechnology 2019 37:5</source> <volume>37</volume>, <fpage>547</fpage>–<lpage>554</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Cao</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>The single-cell transcriptional landscape of mammalian organogenesis</article-title>. <source>Nature 2019 566:7745</source> <volume>566</volume>, <fpage>496</fpage>–<lpage>502</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Chen</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title>Single-cell trajectories reconstruction, exploration and mapping of omics data with STREAM</article-title>. <source>Nature Communications 2019 10:1</source> <volume>10</volume>, <fpage>1</fpage>–<lpage>14</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Wolf</surname>, <given-names>F. A.</given-names></string-name> <etal>et al.</etal> <article-title>PAGA: graph abstraction reconciles clustering with trajectory inference through a topology preserving map of single cells</article-title>. <source>Genome Biol</source> <volume>20</volume>, <fpage>1</fpage>–<lpage>9</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Setty</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Characterization of cell fate probabilities in single-cell data with Palantir</article-title>. <source>Nature Biotechnology 2019 37:4</source> <volume>37</volume>, <fpage>451</fpage>–<lpage>460</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Stassen</surname>, <given-names>S. V.</given-names></string-name>, <string-name><surname>Yip</surname>, <given-names>G. G. K.</given-names></string-name>, <string-name><surname>Wong</surname>, <given-names>K. K. Y.</given-names></string-name>, <string-name><surname>Ho</surname>, <given-names>J. W. K.</given-names></string-name> &amp; <string-name><surname>Tsia</surname>, <given-names>K. K</given-names></string-name>. <article-title>Generalized and scalable trajectory inference in single-cell omics data with VIA</article-title>. <source>Nature Communications 2021 12:1</source> <volume>12</volume>, <fpage>1</fpage>–<lpage>18</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Packer</surname>, <given-names>J. S.</given-names></string-name> <etal>et al.</etal> <article-title>A lineage-resolved molecular atlas of C. Elegans embryogenesis at single-cell resolution</article-title>. <source>Science (1979)</source> <volume>365</volume>, (<year>2019</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Briggs</surname>, <given-names>J. A.</given-names></string-name> <etal>et al.</etal> <article-title>The dynamics of gene expression in vertebrate embryogenesis at single-cell resolution</article-title>. <source>Science (1979)</source> <volume>360</volume>, (<year>2018</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Cao</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>Comprehensive single-cell transcriptional profiling of a multicellular organism</article-title>. <source>Science (1979)</source> <volume>357</volume>, <fpage>661</fpage>–<lpage>667</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Litviňuková</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Cells of the adult human heart</article-title>. <source>Nature 2020 588:7838</source> <volume>588</volume>, <fpage>466</fpage>–<lpage>472</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Farley</surname>, <given-names>A. M.</given-names></string-name> <etal>et al.</etal> <article-title>Dynamics of thymus organogenesis and colonization in early human development</article-title>. <source>Development</source> <volume>140</volume>, <fpage>2015</fpage>–<lpage>2026</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Haddad</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title>Dynamics of Thymus-Colonizing Cells during Human Development</article-title>. <source>Immunity</source> <volume>24</volume>, <fpage>217</fpage>–<lpage>230</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Lavaert</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Integrated scRNA-Seq Identifies Human Postnatal Thymus Seeding Progenitors and Regulatory Dynamics of Differentiating Immature Thymocytes</article-title>. <source>Immunity</source> <volume>52</volume>, <fpage>1088</fpage>–<lpage>1104</lpage>.e6 (<year>2020</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Le</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>Single-Cell RNA-Seq Mapping of Human Thymopoiesis Reveals Lineage Specification Trajectories and a Commitment Spectrum in T Cell Development</article-title>. <source>Immunity</source> <volume>52</volume>, <fpage>1105</fpage>–<lpage>1118</lpage>.e9 (<year>2020</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Hosokawa</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Rothenberg</surname>, <given-names>E. V</given-names></string-name>. <article-title>How transcription factors drive choice of the T cell fate</article-title>. <source>Nature Reviews Immunology 2020 21:3</source> <volume>21</volume>, <fpage>162</fpage>–<lpage>176</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Canté-Barrett</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal> <article-title>Loss of CD44dim expression from early progenitor cells marks T-cell lineage commitment in the human thymus</article-title>. <source>Front Immunol</source> <volume>8</volume>, <fpage>32</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Dik</surname>, <given-names>W. A.</given-names></string-name> <etal>et al.</etal> <article-title>New insights on human T cell development by quantitative T cell receptor gene rearrangement studies and gene expression profiling</article-title>. <source>Journal of Experimental Medicine</source> <volume>201</volume>, <fpage>1715</fpage>–<lpage>1723</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Surh</surname>, <given-names>C. D.</given-names></string-name> &amp; <string-name><surname>Sprent</surname>, <given-names>J</given-names></string-name>. <article-title>T-cell apoptosis detected in situ during positive and negative selection in the thymus</article-title>. <source>Nature 1994 372:6501</source> <volume>372</volume>, <fpage>100</fpage>–<lpage>103</lpage> (<year>1994</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Kimura</surname>, <given-names>M. Y.</given-names></string-name> <etal>et al.</etal> <article-title>Timing and duration of MHC I positive selection signals are adjusted in the thymus to prevent lineage errors</article-title>. <source>Nature Immunology 2016 17:12</source> <volume>17</volume>, <fpage>1415</fpage>–<lpage>1423</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Klein</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Robey</surname>, <given-names>E. A.</given-names></string-name> &amp; <string-name><surname>Hsieh</surname>, <given-names>C. S</given-names></string-name>. <article-title>Central CD4+ T cell tolerance: deletion versus regulatory T cell differentiation</article-title>. <source>Nature Reviews Immunology 2018 19:1</source> <volume>19</volume>, <fpage>7</fpage>–<lpage>18</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Derbinski</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Schulte</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Kyewski</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Klein</surname>, <given-names>L</given-names></string-name>. <article-title>Promiscuous gene expression in medullary thymic epithelial cells mirrors the peripheral self</article-title>. <source>Nature Immunology 2001 2:11</source> <volume>2</volume>, <fpage>1032</fpage>–<lpage>1039</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Anderson</surname>, <given-names>M. S.</given-names></string-name> <etal>et al.</etal> <article-title>Projection of an immunological self shadow within the thymus by the aire protein</article-title>. <source>Science (1979)</source> <volume>298</volume>, <fpage>1395</fpage>–<lpage>1401</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Moran</surname>, <given-names>A. E.</given-names></string-name> <etal>et al.</etal> <article-title>T cell receptor signal strength in Treg and iNKT cell development demonstrated by a novel fluorescent reporter mouse</article-title>. <source>Journal of Experimental Medicine</source> <volume>208</volume>, <fpage>1279</fpage>–<lpage>1289</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Caton</surname>, <given-names>A. J.</given-names></string-name> <etal>et al.</etal> <article-title>Strength of TCR signal from self-peptide modulates autoreactive thymocyte deletion and Foxp3+ Treg-cell formation</article-title>. <source>Eur J Immunol</source> <volume>44</volume>, <fpage>785</fpage>–<lpage>793</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Lee</surname>, <given-names>H. M.</given-names></string-name>, <string-name><surname>Bautista</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Scott-Browne</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Mohan</surname>, <given-names>J. F.</given-names></string-name> &amp; <string-name><surname>Hsieh</surname>, <given-names>C. S</given-names></string-name>. <article-title>A Broad Range of Self-Reactivity Drives Thymic Regulatory T Cell Selection to Limit Responses to Self</article-title>. <source>Immunity</source> <volume>37</volume>, <fpage>475</fpage>–<lpage>486</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Tai</surname>, <given-names>X.</given-names></string-name> <etal>et al.</etal> <article-title>How autoreactive thymocytes differentiate into regulatory versus effector CD4+ T cells after avoiding clonal deletion</article-title>. <source>Nature Immunology 2023 24:4</source> <volume>24</volume>, <fpage>637</fpage>–<lpage>651</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Khailaie</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Robert</surname>, <given-names>P. A.</given-names></string-name>, <string-name><surname>Toker</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Huehn</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Meyer-Hermann</surname>, <given-names>M</given-names></string-name>. <article-title>A signal integration model of thymic selection and natural regulatory T cell commitment</article-title>. <source>J Immunol</source> <volume>193</volume>, <fpage>5983</fpage>–<lpage>5996</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Le Borgne</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>The impact of negative selection on thymocyte migration in the medulla</article-title>. <source>Nature Immunology 2009 10:8</source> <volume>10</volume>, <fpage>823</fpage>–<lpage>830</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Hsieh</surname>, <given-names>C. S.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>H. M.</given-names></string-name> &amp; <string-name><surname>Lio</surname>, <given-names>C. W. J</given-names></string-name>. <article-title>Selection of regulatory T cells in the thymus</article-title>. <source>Nature Reviews Immunology 2012 12:3</source> <volume>12</volume>, <fpage>157</fpage>–<lpage>167</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Coquet</surname>, <given-names>J. M.</given-names></string-name> <etal>et al.</etal> <article-title>Epithelial and dendritic cells in the thymic medulla promote CD4+Foxp3+ regulatory T cell development via the CD27– CD70 pathway</article-title>. <source>Journal of Experimental Medicine</source> <volume>210</volume>, <fpage>715</fpage>–<lpage>728</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Mahmud</surname>, <given-names>S. A.</given-names></string-name> <etal>et al.</etal> <article-title>Costimulation via the tumor-necrosis factor receptor superfamily couples TCR signal strength to the thymic differentiation of regulatory T cells</article-title>. <source>Nature Immunology 2014 15:5</source> <volume>15</volume>, <fpage>473</fpage>–<lpage>481</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Liu</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> <article-title>A critical function for TGF-β signaling in the development of natural CD4+CD25+Foxp3+ regulatory T cells</article-title>. <source>Nature Immunology 2008 9:6</source> <volume>9</volume>, <fpage>632</fpage>–<lpage>640</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>D’Cruz</surname>, <given-names>L. M.</given-names></string-name> &amp; <string-name><surname>Klein</surname>, <given-names>L</given-names></string-name>. <article-title>Development and function of agonist-induced CD25+Foxp3+ regulatory T cells in the absence of interleukin 2 signaling</article-title>. <source>Nature Immunology 2005 6:11</source> <volume>6</volume>, <fpage>1152</fpage>–<lpage>1159</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Owen</surname>, <given-names>D. L.</given-names></string-name>, <string-name><surname>Sjaastad</surname>, <given-names>L. E.</given-names></string-name> &amp; <string-name><surname>Farrar</surname>, <given-names>M. A</given-names></string-name>. <article-title>Regulatory T Cell Development in the Thymus</article-title>. <source>The Journal of Immunology</source> <volume>203</volume>, <fpage>2031</fpage>–<lpage>2041</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Burchill</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Vogtenhuber</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Blazar</surname>, <given-names>B. R.</given-names></string-name> &amp; <string-name><surname>Farrar</surname>, <given-names>M. A</given-names></string-name>. <article-title>IL-2 Receptor β-Dependent STAT5 Activation Is Required for the Development of Foxp3+ Regulatory T Cells</article-title>. <source>The Journal of Immunology</source> <volume>178</volume>, <fpage>280</fpage>–<lpage>290</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><surname>Lio</surname>, <given-names>C. W. J.</given-names></string-name> &amp; <string-name><surname>Hsieh</surname>, <given-names>C. S</given-names></string-name>. <article-title>A Two-Step Process for Thymic Regulatory T Cell Development</article-title>. <source>Immunity</source> <volume>28</volume>, <fpage>100</fpage>–<lpage>111</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Caramalho</surname>, <given-names>I.</given-names></string-name> <etal>et al.</etal> <article-title>Human regulatory T-cell development is dictated by Interleukin-2 and -15 expressed in a non-overlapping pattern in the thymus</article-title>. <source>J Autoimmun</source> <volume>56</volume>, <fpage>98</fpage>–<lpage>110</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><surname>Vanhanen</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Tuulasvaara</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Mattila</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Pätilä</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Arstila</surname>, <given-names>T. P</given-names></string-name>. <article-title>Common gamma chain cytokines promote regulatory T cell development and survival at the CD4+ CD8+ stage in the human thymus</article-title>. <source>Scand J Immunol</source> <volume>88</volume>, <fpage>e12681</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><surname>Golding</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Darko</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Wylie</surname>, <given-names>W. H.</given-names></string-name>, <string-name><surname>Douek</surname>, <given-names>D. C.</given-names></string-name> &amp; <string-name><surname>Shevach</surname>, <given-names>E. M</given-names></string-name>. <article-title>Deep sequencing of the TCR-β repertoire of human forkhead box protein 3 (FoxP3)+ and FoxP3–T cells suggests that they are completely distinct and non-overlapping</article-title>. <source>Clin Exp Immunol</source> <volume>188</volume>, <fpage>12</fpage>–<lpage>21</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><string-name><surname>Owen</surname>, <given-names>D. L.</given-names></string-name> <etal>et al.</etal> <article-title>Thymic regulatory T cells arise via two distinct developmental programs</article-title>. <source>Nature Immunology 2019 20:2</source> <volume>20</volume>, <fpage>195</fpage>–<lpage>205</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><string-name><surname>Santamaria</surname>, <given-names>J. C.</given-names></string-name>, <string-name><surname>Borelli</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Irla</surname>, <given-names>M</given-names></string-name>. <article-title>Regulatory T Cell Heterogeneity in the Thymus: Impact on Their Functional Activities</article-title>. <source>Front Immunol</source> <volume>12</volume>, <fpage>643153</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><string-name><surname>Heimli</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Multimodal human thymic profiling reveals trajectories and cellular milieu for T agonist selection</article-title>. <source>Front Immunol</source> <volume>13</volume>, <fpage>1092028</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><string-name><surname>Morgana</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal> <article-title>Single-Cell Transcriptomics Reveals Discrete Steps in Regulatory T Cell Development in the Human Thymus</article-title>. <source>The Journal of Immunology</source> <volume>208</volume>, <fpage>384</fpage>–<lpage>395</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><string-name><surname>Park</surname>, <given-names>J. E.</given-names></string-name> <etal>et al.</etal> <article-title>A cell atlas of human thymic development defines T cell repertoire formation</article-title>. <source>Science (1979)</source> <volume>367</volume>, (<year>2020</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><string-name><surname>Setty</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Wishbone identifies bifurcating developmental trajectories from single-cell data</article-title>. <source>Nature Biotechnology 2016 34:6</source> <volume>34</volume>, <fpage>637</fpage>–<lpage>645</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><string-name><surname>Wei</surname>, <given-names>S. C.</given-names></string-name> <etal>et al.</etal> <article-title>Negative Co-stimulation Constrains T Cell Differentiation by Imposing Boundaries on Possible Cell States</article-title>. <source>Immunity</source> <volume>50</volume>, <fpage>1084</fpage>–<lpage>1098</lpage>.e10 (<year>2019</year>).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><string-name><surname>Chopp</surname>, <given-names>L. B.</given-names></string-name> <etal>et al.</etal> <article-title>An Integrated Epigenomic and Transcriptomic Map of Mouse and Human αβ T Cell Development</article-title>. <source>Immunity</source> <volume>53</volume>, <fpage>1182</fpage>–<lpage>1201</lpage>.e8 (<year>2020</year>).</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="other"><string-name><surname>Silva</surname>, <given-names>V. de</given-names></string-name> &amp; <string-name><surname>Carlsson</surname>, <given-names>G.</given-names></string-name> <article-title>Topological estimation using witness complexes</article-title>. <pub-id pub-id-type="doi">10.2312/SPBG/SPBG04/157-166</pub-id> (<year>2004</year>) doi:DOI = <pub-id pub-id-type="doi">10.2312/SPBG/SPBG04/157-166</pub-id>.</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="book"><string-name><given-names>Herbert</given-names> <surname>Edelsbrunner</surname></string-name> &amp; <string-name><given-names>John L.</given-names> <surname>Harer</surname></string-name>. <source>Computational Topology: An Introduction</source>. (<publisher-name>American Mathematical Society</publisher-name>, <year>2010</year>).</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="other"><string-name><surname>Pokorny</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Hawasly</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Ramamoorthy</surname>, <given-names>S</given-names></string-name>. <article-title>Multiscale Topological Trajectory Classification with Persistent Homology</article-title>. (<year>2014</year>). doi:<pub-id pub-id-type="doi">10.15607/RSS.2014.X.054</pub-id>.</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><string-name><surname>Becht</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title>Dimensionality reduction for visualizing single-cell data using UMAP</article-title>. <source>Nature Biotechnology 2018 37:1</source> <volume>37</volume>, <fpage>38</fpage>–<lpage>44</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><string-name><surname>McInnes</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Healy</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Saul</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Großberger</surname>, <given-names>L</given-names></string-name>. <article-title>UMAP: Uniform Manifold Approximation and Projection</article-title>. <source>J Open Source Softw</source> <volume>3</volume>, <fpage>861</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><string-name><surname>Amir</surname>, <given-names>E. A. D.</given-names></string-name> <etal>et al.</etal> <article-title>viSNE enables visualization of high dimensional single-cell data and reveals phenotypic heterogeneity of leukemia</article-title>. <source>Nat Biotechnol</source> <volume>31</volume>, <fpage>545</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><string-name><surname>Maaten</surname>, <given-names>L. van der</given-names></string-name> &amp; <string-name><surname>Hinton</surname>, <given-names>G</given-names></string-name>. <article-title>Visualizing Data using t-SNE</article-title>. <source>Journal of Machine Learning Research</source> <volume>9</volume>, <fpage>2579</fpage>–<lpage>2605</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><string-name><surname>Ding</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Condon</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Shah</surname>, <given-names>S. P</given-names></string-name>. <article-title>Interpretable dimensionality reduction of single cell transcriptome data with deep generative models</article-title>. <source>Nat Commun</source> <volume>9</volume>, (<year>2018</year>).</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><string-name><surname>Szubert</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Cole</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>Monaco</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Drozdov</surname>, <given-names>I</given-names></string-name>. <article-title>Structure-preserving visualisation of high dimensional single-cell datasets</article-title>. <source>Sci Rep</source> <volume>9</volume>, (<year>2019</year>).</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><string-name><surname>Förster</surname>, <given-names>Y. P.</given-names></string-name>, <string-name><surname>Gamberi</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Tzanis</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Vivo</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Annibale</surname>, <given-names>A</given-names></string-name>. <article-title>Exact and approximate mean first passage times on trees and other necklace structures: a local equilibrium approach</article-title>. <source>J Phys A Math Theor</source> <volume>55</volume>, <fpage>115001</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="other"><string-name><given-names>T.</given-names> <surname>Pokorny</surname></string-name>, <string-name><given-names>F.</given-names>, <surname>Hawasly</surname></string-name>, <string-name><given-names>M.</given-names> &amp; <surname>Ramamoorthy</surname></string-name>, S. <article-title>Multiscale Topological Trajectory Classification with Persistent Homology</article-title>. (<year>2015</year>) doi:<pub-id pub-id-type="doi">10.15607/RSS.2014.X.054</pub-id>.</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="other"><string-name><surname>Edelsbrunner</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Harer</surname>, <given-names>J.</given-names></string-name> <source>Computational Topology: An Introduction. Computational Topology</source> vol. <volume>69</volume> (<publisher-name>Miscellaneous Books</publisher-name>, <year>2010</year>).</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="web"><source>Topological estimation using witness complexes</source>. <ext-link ext-link-type="uri" xlink:href="http://diglib.eg.org/handle/10.2312/SPBG.SPBG04.157-166">http://diglib.eg.org/handle/10.2312/SPBG.SPBG04.157-166</ext-link>.</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="journal"><string-name><surname>Blondel</surname>, <given-names>V. D.</given-names></string-name>, <string-name><surname>Guillaume</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Lambiotte</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Lefebvre</surname>, <given-names>E</given-names></string-name>. <article-title>Fast unfolding of communities in large networks</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source> <volume>2008</volume>, (<year>2008</year>).</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="journal"><string-name><surname>Lee</surname>, <given-names>H. M.</given-names></string-name> &amp; <string-name><surname>Hsieh</surname>, <given-names>C.-S</given-names></string-name>. <article-title>Rare Development of Foxp3+ Thymocytes in the CD4+CD8+ Subset</article-title>. <source>The Journal of Immunology</source> <volume>183</volume>, <fpage>2261</fpage>–<lpage>2266</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="journal"><string-name><surname>Mittelstadt</surname>, <given-names>P. R.</given-names></string-name>, <string-name><surname>Taves</surname>, <given-names>M. D.</given-names></string-name> &amp; <string-name><surname>Ashwell</surname>, <given-names>J. D</given-names></string-name>. <article-title>Glucocorticoids Oppose Thymocyte Negative Selection by Inhibiting Helios and Nur77</article-title>. <source>The Journal of Immunology</source> <volume>203</volume>, <fpage>2163</fpage>–<lpage>2170</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><string-name><surname>Daley</surname>, <given-names>S. R.</given-names></string-name>, <string-name><surname>Hu</surname>, <given-names>D. Y.</given-names></string-name> &amp; <string-name><surname>Goodnow</surname>, <given-names>C. C</given-names></string-name>. <article-title>Helios marks strongly autoreactive CD4+ T cells in two major waves of thymic deletion distinguished by induction of PD-1 or NF-κB</article-title>. <source>J Exp Med</source> <volume>210</volume>, <fpage>269</fpage>–<lpage>285</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c66"><label>66.</label><mixed-citation publication-type="journal"><string-name><surname>Tuovinen</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Pekkarinen</surname>, <given-names>P. T.</given-names></string-name>, <string-name><surname>Rossi</surname>, <given-names>L. H.</given-names></string-name>, <string-name><surname>Mattila</surname>, <given-names>I.</given-names></string-name> &amp; <string-name><surname>Arstila</surname>, <given-names>T. P</given-names></string-name>. <article-title>The FOXP3+ subset of human CD4+CD8+ thymocytes is immature and subject to intrathymic selection</article-title>. <source>Immunol Cell Biol</source> <volume>86</volume>, <fpage>523</fpage>–<lpage>529</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c67"><label>67.</label><mixed-citation publication-type="journal"><string-name><surname>Lehtoviita</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Rossi</surname>, <given-names>L. H.</given-names></string-name>, <string-name><surname>Kekäläinen</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Sairanen</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Arstila</surname>, <given-names>T. P</given-names></string-name>. <article-title>The CD4+CD8+ and CD4+ Subsets of FOXP3+ Thymocytes Differ in their Response to Growth Factor Deprivation or Stimulation</article-title>. <source>Scand J Immunol</source> <volume>70</volume>, <fpage>377</fpage>–<lpage>383</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c68"><label>68.</label><mixed-citation publication-type="journal"><string-name><surname>Vanhanen</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Leskinen</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Mattila</surname>, <given-names>I. P.</given-names></string-name>, <string-name><surname>Saavalainen</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Arstila</surname>, <given-names>T. P</given-names></string-name>. <article-title>Epigenetic and transcriptional analysis supports human regulatory T cell commitment at the CD4+CD8+ thymocyte stage</article-title>. <source>Cell Immunol</source> <volume>347</volume>, <fpage>104026</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c69"><label>69.</label><mixed-citation publication-type="journal"><string-name><surname>Nunes-Cabaço</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Caramalho</surname>, <given-names>Í.</given-names></string-name>, <string-name><surname>Sepúlveda</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Sousa</surname>, <given-names>A. E</given-names></string-name>. <article-title>Differentiation of human thymic regulatory T cells at the double positive stage</article-title>. <source>Eur J Immunol</source> <volume>41</volume>, <fpage>3604</fpage>–<lpage>3614</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c70"><label>70.</label><mixed-citation publication-type="journal"><string-name><surname>Yang</surname>, <given-names>E. J.</given-names></string-name>, <string-name><surname>Zou</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Leichner</surname>, <given-names>T. M.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>S. L.</given-names></string-name> &amp; <string-name><surname>Kambayashi</surname>, <given-names>T</given-names></string-name>. <article-title>Both retention and recirculation contribute to long-lived regulatory T-cell accumulation in the thymus</article-title>. <source>Eur J Immunol</source> <volume>44</volume>, <fpage>2712</fpage>–<lpage>2720</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c71"><label>71.</label><mixed-citation publication-type="journal"><string-name><surname>Cowan</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>McCarthy</surname>, <given-names>N. I.</given-names></string-name> &amp; <string-name><surname>Anderson</surname>, <given-names>G</given-names></string-name>. <article-title>CCR7 Controls Thymus Recirculation, but Not Production and Emigration, of Foxp3+ T Cells</article-title>. <source>Cell Rep</source> <volume>14</volume>, <fpage>1041</fpage>–<lpage>1048</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c72"><label>72.</label><mixed-citation publication-type="journal"><string-name><surname>Peligero-Cruz</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>IL-18 signaling promotes homing of mature tregs into the thymus</article-title>. <source>Elife</source> <volume>9</volume>, <fpage>1</fpage>–<lpage>23</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c73"><label>73.</label><mixed-citation publication-type="journal"><string-name><surname>Thiault</surname>, <given-names>N.</given-names></string-name> <etal>et al.</etal> <article-title>Peripheral regulatory T lymphocytes recirculating to the thymus suppress the development of their precursors</article-title>. <source>Nature Immunology 2015 16:6</source> <volume>16</volume>, <fpage>628</fpage>–<lpage>634</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c74"><label>74.</label><mixed-citation publication-type="journal"><string-name><surname>Nikolouli</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title>Recirculating IL-1R2+ Tregs fine-tune intrathymic Treg development under inflammatory conditions</article-title>. <source>Cellular &amp; Molecular Immunology 2020 18:1</source> <volume>18</volume>, <fpage>182</fpage>–<lpage>193</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c75"><label>75.</label><mixed-citation publication-type="journal"><string-name><surname>Allende</surname>, <given-names>M. L.</given-names></string-name>, <string-name><surname>Dreier</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Mandala</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Proia</surname>, <given-names>R. L</given-names></string-name>. <article-title>Expression of the Sphingosine 1-Phosphate Receptor, S1P1, on T-cells Controls Thymic Emigration</article-title>. <source>Journal of Biological Chemistry</source> <volume>279</volume>, <fpage>15396</fpage>–<lpage>15401</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c76"><label>76.</label><mixed-citation publication-type="journal"><string-name><surname>Cowan</surname>, <given-names>J. E.</given-names></string-name> <etal>et al.</etal> <article-title>Aire controls the recirculation of murine Foxp3+ regulatory T-cells back to the thymus</article-title>. <source>Eur J Immunol</source> <volume>48</volume>, <fpage>844</fpage>–<lpage>854</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c77"><label>77.</label><mixed-citation publication-type="journal"><string-name><surname>Matloubian</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Lymphocyte egress from thymus and peripheral lymphoid organs is dependent on S1P receptor 1</article-title>. <source>Nature 2004 427:6972</source> <volume>427</volume>, <fpage>355</fpage>–<lpage>360</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c78"><label>78.</label><mixed-citation publication-type="journal"><string-name><surname>Weaver</surname>, <given-names>J. D.</given-names></string-name> <etal>et al.</etal> <article-title>Differential expression of CCR8 in tumors versus normal tissue allows specific depletion of tumor-infiltrating T regulatory cells by GS-1811, a novel Fc-optimized anti-CCR8 antibody</article-title>. <source>Oncoimmunology</source> <volume>11</volume>, (<year>2022</year>).</mixed-citation></ref>
<ref id="c79"><label>79.</label><mixed-citation publication-type="journal"><string-name><surname>De Simone</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Transcriptional Landscape of Human Tissue Lymphocytes Unveils Uniqueness of Tumor-Infiltrating T Regulatory Cells</article-title>. <source>Immunity</source> <volume>45</volume>, <fpage>1135</fpage>–<lpage>1147</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c80"><label>80.</label><mixed-citation publication-type="journal"><string-name><surname>Vila-Caballer</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Disruption of the CCL1-CCR8 axis inhibits vascular Treg recruitment and function and promotes atherosclerosis in mice</article-title>. <source>J Mol Cell Cardiol</source> <volume>132</volume>, <fpage>154</fpage>–<lpage>163</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c81"><label>81.</label><mixed-citation publication-type="journal"><string-name><surname>Gao</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> <article-title>Intratumoral stem-like CCR4+ regulatory T cells orchestrate the immunosuppressive microenvironment in HCC associated with hepatitis B</article-title>. <source>J Hepatol</source> <volume>76</volume>, <fpage>148</fpage>–<lpage>159</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c82"><label>82.</label><mixed-citation publication-type="journal"><string-name><surname>Oldham</surname>, <given-names>K. A.</given-names></string-name> <etal>et al.</etal> <article-title>T Lymphocyte Recruitment into Renal Cell Carcinoma Tissue: A Role for Chemokine Receptors CXCR3, CXCR6, CCR5, and CCR6</article-title>. <source>Eur Urol</source> <volume>61</volume>, <fpage>385</fpage>–<lpage>394</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c83"><label>83.</label><mixed-citation publication-type="journal"><string-name><surname>Kalina</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal> <article-title>CD maps - dynamic profiling of CD1–CD100 surface expression on human leukocyte and lymphocyte subsets</article-title>. <source>Front Immunol</source> <volume>10</volume>, <fpage>476681</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c84"><label>84.</label><mixed-citation publication-type="journal"><string-name><surname>Overgaard</surname>, <given-names>N. H.</given-names></string-name>, <string-name><surname>Jung</surname>, <given-names>J.-W.</given-names></string-name>, <string-name><surname>Steptoe</surname>, <given-names>R. J.</given-names></string-name> &amp; <string-name><surname>Wells</surname>, <given-names>J. W</given-names></string-name>. <article-title>CD4+/CD8+ double-positive T cells: more than just a developmental stage?</article-title> <source>J Leukoc Biol</source> <volume>97</volume>, <fpage>31</fpage>–<lpage>38</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c85"><label>85.</label><mixed-citation publication-type="journal"><string-name><surname>Taniuchi</surname>, <given-names>I</given-names></string-name>. <article-title>CD4 Helper and CD8 Cytotoxic T Cell Differentiation</article-title>. <source>Annu Rev Immunol</source> <volume>36</volume>, <fpage>579</fpage>–<lpage>601</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c86"><label>86.</label><mixed-citation publication-type="journal"><string-name><surname>Schulz</surname>, <given-names>A. R.</given-names></string-name> <etal>et al.</etal> <article-title>Stabilizing Antibody Cocktails for Mass Cytometry</article-title>. <source>Cytometry A</source> <volume>95</volume>, <fpage>910</fpage>–<lpage>916</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c87"><label>87.</label><mixed-citation publication-type="journal"><string-name><surname>Nowicka</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>CyTOF workflow: differential discovery in high-throughput high-dimensional cytometry datasets</article-title>. <source>F1000Research 2019 6:748</source> <volume>6</volume>, <fpage>748</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c88"><label>88.</label><mixed-citation publication-type="journal"><string-name><surname>Froňková</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title>The TREC/KREC assay for the diagnosis and monitoring of patients with DiGeorge syndrome</article-title>. <source>PLoS One</source> <volume>9</volume>, (<year>2014</year>).</mixed-citation></ref>
<ref id="c89"><label>89.</label><mixed-citation publication-type="journal"><string-name><surname>Douek</surname>, <given-names>D. C.</given-names></string-name> <etal>et al.</etal> <article-title>Assessment of thymic output in adults after haematopoietic stemcell transplantation and prediction of T-cell reconstitution</article-title>. <source>The Lancet</source> <volume>355</volume>, <fpage>1875</fpage>–<lpage>1881</lpage> (<year>2000</year>).</mixed-citation></ref>
</ref-list>
<ref-list>
<title>References – Supplementary note</title>
<ref id="c90"><label>90.</label><mixed-citation publication-type="web"><string-name><surname>Bailey</surname>, <given-names>E.</given-names></string-name> <source>CRAN - Package shinyBS</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/shinyBS/index.html">https://cran.r-project.org/web/packages/shinyBS/index.html</ext-link> (<year>2022</year>).</mixed-citation></ref>
<ref id="c91"><label>91.</label><mixed-citation publication-type="journal"><string-name><surname>Bates</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Eddelbuettel</surname>, <given-names>D</given-names></string-name>. <article-title>Fast and Elegant Numerical Linear Algebra Using the RcppEigen Package</article-title>. <source>J Stat Softw</source> <volume>52</volume>, <fpage>1</fpage>–<lpage>24</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c92"><label>92.</label><mixed-citation publication-type="web"><string-name><surname>Bates</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Maechler</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Jagan</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Davis</surname>, <given-names>T. A.</given-names></string-name> <source>Matrix: Sparse and Dense Matrix Classes and Methods</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://CRAN.R-project.org/package=Matrix">https://CRAN.R-project.org/package=Matrix</ext-link> (<year>2023</year>).</mixed-citation></ref>
<ref id="c93"><label>93.</label><mixed-citation publication-type="journal"><string-name><surname>Bauer</surname>, <given-names>U.</given-names></string-name>, <string-name><surname>Kerber</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Reininghaus</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Wagner</surname>, <given-names>H</given-names></string-name>. <article-title>Phat - Persistent Homology Algorithms Toolbox</article-title>. <source>J. Symb. Comput</source>. <volume>78</volume>, <fpage>76</fpage>–<lpage>90</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c94"><label>94.</label><mixed-citation publication-type="web"><string-name><surname>Cannoodt</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Saelens</surname>, <given-names>W.</given-names></string-name> <article-title>dynverse/dyntoy: Generating simple toy data of cellular differentiation version 0.9.9 from GitHub</article-title>. <ext-link ext-link-type="uri" xlink:href="https://rdrr.io/github/dynverse/dyntoy/">https://rdrr.io/github/dynverse/dyntoy/</ext-link> (<year>2022</year>).</mixed-citation></ref>
<ref id="c95"><label>95.</label><mixed-citation publication-type="journal"><string-name><surname>Carlsson</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Ishkhanov</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>De Silva</surname>, <given-names>V.</given-names></string-name> &amp; <string-name><surname>Zomorodian</surname>, <given-names>A</given-names></string-name>. <article-title>On the local behavior of spaces of natural images</article-title>. <source>Int J Comput Vis</source> <volume>76</volume>, <fpage>1</fpage>–<lpage>12</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c96"><label>96.</label><mixed-citation publication-type="other"><string-name><surname>Csárdi</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Nepusz</surname>, <given-names>T.</given-names></string-name> <source>The igraph software package for complex network research</source>. (<year>2006</year>).</mixed-citation></ref>
<ref id="c97"><label>97.</label><mixed-citation publication-type="other"><string-name><surname>de Vries</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Ripley</surname>, <given-names>B. D.</given-names></string-name> <source>Create Dendrograms and Tree Diagrams Using ‘ggplot2’</source>. (<year>2022</year>).</mixed-citation></ref>
<ref id="c98"><label>98.</label><mixed-citation publication-type="journal"><string-name><surname>Ding</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Condon</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Shah</surname>, <given-names>S. P</given-names></string-name>. <article-title>Interpretable dimensionality reduction of single cell transcriptome data with deep generative models</article-title>. <source>Nature Communications 2018 9:1</source> <volume>9</volume>, <fpage>1</fpage>–<lpage>13</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c99"><label>99.</label><mixed-citation publication-type="web"><string-name><surname>Eddelbuettel</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Emerson</surname>, <given-names>J. W.</given-names></string-name> &amp; <string-name><surname>Kane</surname>, <given-names>M. J.</given-names></string-name> <source>CRAN - Package BH.</source> <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/BH/index.html">https://cran.r-project.org/web/packages/BH/index.html</ext-link> (<year>2023</year>).</mixed-citation></ref>
<ref id="c100"><label>100.</label><mixed-citation publication-type="journal"><string-name><surname>Eddelbuettel</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Sanderson</surname>, <given-names>C</given-names></string-name>. <article-title>RcppArmadillo: Accelerating R with high-performance C++ linear algebra</article-title>. <source>Comput Stat Data Anal</source> <volume>71</volume>, <fpage>1054</fpage>–<lpage>1063</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c101"><label>101.</label><mixed-citation publication-type="web"><string-name><surname>Eddelbuettel</surname>, <given-names>D.</given-names></string-name>, <etal>et al.</etal> <source>BH: Boost C++ Header Files</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/Rcpp/index.html">https://cran.r-project.org/web/packages/Rcpp/index.html</ext-link> (<year>2023</year>).</mixed-citation></ref>
<ref id="c102"><label>102.</label><mixed-citation publication-type="other"><string-name><surname>Ellis</surname>, <given-names>B.</given-names></string-name>, <etal>et al.</etal> <source>flowCore: flowCore: Basic structures for flow cytometry data</source>. Preprint at (<year>2023</year>).</mixed-citation></ref>
<ref id="c103"><label>103.</label><mixed-citation publication-type="journal"><string-name><surname>Galili</surname>, <given-names>T.</given-names></string-name> <article-title>dendextend: an R package for visualizing, adjusting and comparing trees of hierarchical clustering</article-title>. <source>Bioinformatics</source> <volume>31</volume>, <fpage>3718</fpage>–<lpage>3720</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c104"><label>104.</label><mixed-citation publication-type="journal"><string-name><surname>Hao</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> <article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source> <volume>184</volume>, <fpage>3573</fpage>–<lpage>3587</lpage>.e29 (<year>2021</year>).</mixed-citation></ref>
<ref id="c105"><label>105.</label><mixed-citation publication-type="other"><string-name><surname>Hatcher</surname>, <given-names>A</given-names></string-name>. <source>Algebraic topology</source>. (<publisher-name>Cambridge University Press</publisher-name>, <year>2000</year>).</mixed-citation></ref>
<ref id="c106"><label>106.</label><mixed-citation publication-type="journal"><string-name><surname>Huber</surname>, <given-names>W.</given-names></string-name> <etal>et al.</etal> <article-title>Orchestrating high-throughput genomic analysis with Bioconductor</article-title>. <source>Nature Methods 2015 12:2</source> <volume>12</volume>, <fpage>115</fpage>–<lpage>121</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c107"><label>107.</label><mixed-citation publication-type="other"><string-name><surname>Kachanovich</surname>, <given-names>S.</given-names></string-name> <source>Witness complex. GUDHI User and Reference Manual, GUDHI Editorial Board</source>. <ext-link ext-link-type="uri" xlink:href="http://gudhi.gforge.inria.fr/doc/latest/group_witness_complex.html">http://gudhi.gforge.inria.fr/doc/latest/group_witness_complex.html</ext-link> (<year>2015</year>).</mixed-citation></ref>
<ref id="c108"><label>108.</label><mixed-citation publication-type="other"><string-name><surname>Kulichova</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Kratochvil</surname>, <given-names>M.</given-names></string-name> <source>Scatterplots with More Points [R package scattermore version 1.2]</source>. (<year>2023</year>).</mixed-citation></ref>
<ref id="c109"><label>109.</label><mixed-citation publication-type="web"><string-name><surname>Maechler</surname>, <given-names>M.</given-names></string-name> <source>cluster: Cluster Analysis Basics and Extensions</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/Matrix/index.html">https://cran.r-project.org/web/packages/Matrix/index.html</ext-link> (<year>2022</year>).</mixed-citation></ref>
<ref id="c110"><label>110.</label><mixed-citation publication-type="web"><string-name><surname>Melville</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Lun</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Djekidel</surname>, <given-names>M. N.</given-names></string-name>, <string-name><surname>Hao</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Eddelbuettel</surname>, <given-names>D.</given-names></string-name> <source>uwot: The Uniform Manifold Approximation and Projection (UMAP) Method for Dimensionality Reduction, r package version 0.1.16</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/uwot/index.html">https://cran.r-project.org/web/packages/uwot/index.html</ext-link> (<year>2023</year>).</mixed-citation></ref>
<ref id="c111"><label>111.</label><mixed-citation publication-type="web"><string-name><surname>Meyer</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Perrier</surname>, <given-names>V.</given-names></string-name> <source>shinybusy: Busy Indicators and Notifications for ‘Shiny’ Applications</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/shinybusy/index.html">https://cran.r-project.org/web/packages/shinybusy/index.html</ext-link> (<year>2022</year>).</mixed-citation></ref>
<ref id="c112"><label>112.</label><mixed-citation publication-type="web"><string-name><surname>Pedersen</surname>, <given-names>T. L.</given-names></string-name>, <string-name><surname>Nijs</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Schaffner</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Nantz</surname>, <given-names>E.</given-names></string-name> <source>shinyFiles: A Server-Side File System Viewer for Shiny</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/shinyFiles/index.html">https://cran.r-project.org/web/packages/shinyFiles/index.html</ext-link> (<year>2022</year>).</mixed-citation></ref>
<ref id="c113"><label>113.</label><mixed-citation publication-type="web"><string-name><surname>Perrier</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Meyer</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Granjon</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Fellows</surname>, <given-names>I.</given-names></string-name> &amp; <string-name><surname>Matthews</surname>, <given-names>S.</given-names></string-name> <source>shinyWidgets: Custom Inputs Widgets for Shiny</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/shinyWidgets/index.html">https://cran.r-project.org/web/packages/shinyWidgets/index.html</ext-link> (<year>2023</year>).</mixed-citation></ref>
<ref id="c114"><label>114.</label><mixed-citation publication-type="other"><string-name><surname>Rouvreau</surname>, <given-names>V.</given-names></string-name> <source>Aplha complex. GUDHI User and Reference Manual, GUDHI Editorial Board</source>. (<year>2015</year>).</mixed-citation></ref>
<ref id="c115"><label>115.</label><mixed-citation publication-type="web"><string-name><surname>Sali</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hass</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Attalli</surname>, <given-names>D.</given-names></string-name> <source>shinycssloaders: Add Loading Animations to a ‘shiny’ Output While It’s Recalculating</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/shinycssloaders/index.html">https://cran.r-project.org/web/packages/shinycssloaders/index.html</ext-link> (<year>2020</year>).</mixed-citation></ref>
<ref id="c116"><label>116.</label><mixed-citation publication-type="web"><string-name><surname>Seel</surname>, <given-names>M.</given-names></string-name> <source>CGAL 5.6 - dD Geometry Kernel: User Manual</source>. <ext-link ext-link-type="uri" xlink:href="https://doc.cgal.org/latest/Kernel_d/index.html">https://doc.cgal.org/latest/Kernel_d/index.html</ext-link> (<year>2019</year>).</mixed-citation></ref>
<ref id="c117"><label>117.</label><mixed-citation publication-type="other"><collab>The CGAL Project</collab>. <source>CGAL User and Reference Manual</source>. (<year>2023</year>).</mixed-citation></ref>
<ref id="c118"><label>118.</label><mixed-citation publication-type="web"><string-name><surname>Urbanek</surname>, <given-names>S.</given-names></string-name> <source>jpeg: Read and write JPEG images</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/jpeg/index.html">https://cran.r-project.org/web/packages/jpeg/index.html</ext-link> (<year>2022</year>).</mixed-citation></ref>
<ref id="c119"><label>119.</label><mixed-citation publication-type="web"><string-name><surname>Ushey</surname>, <given-names>K.</given-names></string-name>, <etal>et al.</etal> <source>CRAN - Package reticulate</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cloud.r-project.org/web/packages/reticulate/index.html">https://cloud.r-project.org/web/packages/reticulate/index.html</ext-link> (<year>2023</year>).</mixed-citation></ref>
<ref id="c120"><label>120.</label><mixed-citation publication-type="journal"><string-name><surname>van Dijk</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>Recovering Gene Interactions from Single-Cell Data Using Data Diffusion</article-title>. <source>Cell</source> <volume>174</volume>, <fpage>716</fpage>–<lpage>729</lpage>.e27 (<year>2018</year>).</mixed-citation></ref>
<ref id="c121"><label>121.</label><mixed-citation publication-type="web"><string-name><surname>Warnes</surname>, <given-names>G. R.</given-names></string-name>, <etal>et al.</etal> <source>gplots: Various R Programming Tools for Plotting Data</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/gplots/index.html">https://cran.r-project.org/web/packages/gplots/index.html</ext-link> (<year>2022</year>).</mixed-citation></ref>
<ref id="c122"><label>122.</label><mixed-citation publication-type="web"><string-name><surname>Wickham</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Seidel</surname>, <given-names>D.</given-names></string-name> <source>scales: Scale Functions for Visualization</source>. Preprint at <ext-link ext-link-type="uri" xlink:href="https://cran.r-project.org/web/packages/scales/index.html">https://cran.r-project.org/web/packages/scales/index.html</ext-link> (<year>2022</year>).</mixed-citation></ref>
<ref id="c123"><label>123.</label><mixed-citation publication-type="journal"><string-name><surname>Wickham</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title>Welcome to the Tidyverse</article-title>. <source>J Open Source Softw</source> <volume>4</volume>, <fpage>1686</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c124"><label>124.</label><mixed-citation publication-type="other"><string-name><surname>Wilke</surname>, <given-names>C. O.</given-names></string-name> <source>Streamlined Plot Theme and Plot Annotations for ‘ggplot2’</source>. (<year>2020</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95861.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Graw</surname>
<given-names>Frederik</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Friedrich-Alexander-University Erlangen-Nürnberg</institution>
</institution-wrap>
<city>Erlangen</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Useful</kwd>
</kwd-group>
</front-stub>
<body>
<p>The authors present an algorithm and workflow for the inference of developmental trajectories from single-cell data, including a mathematical approach to increase computational efficiency. While such efforts are in principle <bold>useful</bold>, the absence of benchmarking against synthetic data and a wide range of different single-cell data sets make this study <bold>incomplete</bold>. Based on what is presented, one can neither ultimately judge if this will be an advance over previous work nor whether the approach will be of general applicability.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95861.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors present tviblindi, a computational workflow for trajectory inference from molecular data at single-cell resolution. The method is based on (i) pseudo-time inference via expecting hitting time, (ii) sampling of random walks in a directed acyclic k-NN where edges are oriented away from a cell of origin w.r.t. the involved nodes' expected hitting times, and (iii) clustering of the random walks via persistent homology. An extended use case on mass cytometry data shows that tviblindi can be used elucidate the biology of T cell development.</p>
<p>Strengths:</p>
<p>- Overall, the paper is very well written and most (but not all, see below) steps of the tviblindi algorithm are explained well.</p>
<p>- The T cell biology use case is convincing (at least to me: I'm not an immunologist, only a bioinformatician with a strong interest in immunology).</p>
<p>Weaknesses:</p>
<p>- The main weakness of the paper is that a systematic comparison of tviblindi against other tools for trajectory inference (there are many) is entirely missing. Even though I really like the algorithmic approach underlying tviblindi, I would therefore not recommend to our wet-lab collaborators that they should use tviblindi to analyze their data. The only validation in the manuscript is the T cell development use case. Although this use case is convincing, it does not suffice for showing that the algorithms's results are systematically trustworthy and more meaningful (at least in some dimension) than trajectories inferred with one of the many existing methods.</p>
<p>- The authors' explanation of the random walk clustering via persistent homology in the Results (subsection &quot;Real-time topological interactive clustering&quot;) is not detailed enough, essentially only concept dropping. What does &quot;sparse regions&quot; mean here and what does it mean that &quot;persistent homology&quot; is used? The authors should try to better describe this step such that the reader has a chance to get an intuition how the random walk clustering actually works. This is especially important because the selection of sparse regions is done interactively. Therefore, it's crucial that the users understand how this selection affects the results. For this, the authors must manage to provide a better intuition of the maths behind clustering of random walks via persistent homology.</p>
<p>- To motivate their work, the authors write in the introduction that &quot;TI methods often use multiple steps of dimensionality reduction and/or clustering, inadvertently introducing bias. The choice of hyperparameters also fixes the a priori resolution in a way that is difficult to predict.&quot; They claim that tviblindi is better than the original methods because &quot;analysis is performed in the original high-dimensional space, avoiding artifacts of dimensionality reduction.&quot; However, in the manuscript, tviblindi is tested only on mass cytometry data which has a much lower dimensionality than scRNA-seq data for which most existing trajectory inference methods are designed. Since tviblindi works on a k-NN graph representation of the input data, it is unclear if it could be run on scRNA-seq data without prior dimensionality reduction. For this, cell-cell distances would have to be computed in the original high-dimensional space, which is problematic due to the very high dimensionality of scRNA-seq data. Of course, the authors could explicitly reduce the scope of tviblindi to data of lower dimensionality, but this would have to be stated explicitly.</p>
<p>- Also tviblindi has at least one hyper-parameter, the number k used to construct the k-NN graphs (there are probably more hidden in the algorithm's subroutines). I did not find a systematic evaluation of the effect of this hyper-parameter.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95861.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary: In Deconstructing Complexity: A Computational Topology Approach to Trajectory Inference in the Human Thymus with tviblindi, Stuchly et al. propose a new trajectory inference algorithm called tviblindi and a visualization algorithm called vaevictis for single-cell data. The paper utilizes novel and exciting ideas from computational topology coupled with random walk simulations to align single cells onto a continuum. The authors validate the utility of their approach largely using simulated data and establish known protein expression dynamics along CD4/CD8 T cell development in thymus using mass cytometry data. The authors also apply their method to track Treg development in single-cell RNA-sequencing data of human thymus.</p>
<p>The technical crux of the method is as follows: The authors provide an interactive tool to align single cells along a continuum axis. The method uses expected hitting time (given a user input start cell) to obtain a pseudotime alignment of cells. The pseudotime gives an orientation/direction for each cell, which is then used to simulate random walks. The random walks are then arranged/clustered based on the sparse region in the data they navigate using persistent homology.</p>
<p>Strengths:</p>
<p>
The notion of using persistent homology to group random walks to identify trajectories in the data is novel.</p>
<p>
The strength of the method lies in the implementation details that make computationally demanding ideas such as persistent homology more tractable for large scale single-cell data. This enables the authors to make the method more user friendly and interactive allowing real-time user query with the data.</p>
<p>Weaknesses:</p>
<p>
The interactive nature of the tool is also a weakness, by allowing for user bias leading to possible overfitting for a specific data.</p>
<p>The main weakness of the method is lack of benchmarking the method on real data and comparison to other methods. Trajectory inference is a very crowded field with many highly successful and widely used algorithms, the two most relevant ones (closest to this manuscript) are not only not benchmarked against, but also not sited. Including those that specifically use persistent homology to discover trajectories (Rizvi et.al. published Nat Biotech 2017). Including those that specifically implement the idea of simulating random walks to identify stable states in single-cell data (e.g. CellRank published in Lange et.al Nat Meth 2022), as well as many trajectory algorithms that take alternative approaches. The paper has much less benchmarking, demonstration on real data and comparison to the very many other previous trajectory algorithms published before it. Generally speaking, in a crowded field of previously published trajectory methods, I do not think this one approach will compete well against prior work (especially due to its inability to handle the noise typical in real world data (as was even demonstrated in the little bit of application to real world data provided).</p>
<p>Beyond general lack of benchmarking there are two issues that give me particular concern. As previously mentioned, the algorithm is highly susceptible to user bias and overfitting. The paper gives the example (Figure 4) of a trajectory which mistakenly shows that cells may pass from an apoptotic phase to a different developmental stage. To circumvent this mistake, the authors propose the interactive version of tviblindi that allows users to zoom in (increase resolution) and identify that there are in fact two trajectories in one. In this case, the authors show how the author can fix a mistake when the answer is known. However, the point of trajectory inference is to discover the unknown. With so much interactive options for the user to guide the result, the method is more user/bias driven than data-driven. So a rigorous and quantitative discussion of robustness of the method, as well as how to ensure data-driven inference and avoid over-fitting would be useful.</p>
<p>Second, the paper discusses the benefit of tviblindi operating in the original high dimensions of the data. This is perhaps adequate for mass cytometry data where there is less of an issue of dropouts and the proteins may be chosen to be large independent. But in the context of single-cell RNA-sequencing data, the massive undersampling of mRNA, as well as high degree of noise (e.g. ambient RNA), introduces very large degree of noise so that modeling data in the original high dimensions leads to methods being fit to the noise. Therefore ALL other methods for trajectory inference work in a lower dimension, for very good reason, otherwise one is learning noise rather than signal. It would be great to have a discussion on the feasibility of the method as is for such noisy data and provide users with guidance. We note that the example scRNA-seq data included in the paper is denoised using imputation, which will likely result in the trajectory inference being oversmoothed as well.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95861.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
Stuchly et al. proposed a single-cell trajectory inference tool, tviblindi, which was built on a sequential implementation of the k-nearest neighbor graph, random walk, persistent homology and clustering, and interactive visualization. The paper was organized around the detailed illustration of the usage and interpretation of results through the human thymus system.</p>
<p>Strengths:</p>
<p>
Overall, I found the paper and method to be practical and needed in the field. Especially the in-depth, step-by-step demonstration of the application of tviblindi in numerous T cell development trajectories and how to interpret and validate the findings can be a template for many basic science and disease-related studies. The videos are also very helpful in showcasing how the tool works.</p>
<p>Weaknesses:</p>
<p>
I only have a few minor suggestions that hopefully can make the paper easier to follow and the advantage of the method to be more convincing.</p>
<p>
(1) The &quot;Computational method for the TI and interrogation - tviblindi&quot; subsection under the Results is a little hard to follow without having a thorough understanding of the tviblindi algorithm procedures. I would suggest that the authors discuss the uniqueness and advantages of the tool after the detailed introduction of the method (moving it after the &quot;Connectome - a fully automated pipeline&quot;.</p>
<p>
Also, considering it is a computational tool paper, inevitably, readers are curious about how it functions compared to other popular trajectory inference approaches. I did not find any formal discussion until almost the end of the supplementary note (even that is not cited anywhere in the main text). Authors may consider improving the summary of the advantages of tviblindi by incorporating concrete quantitative comparisons with other trajectory tools.</p>
<p>
(2) Regarding the discussion in Figure 4 the trajectory goes through the apoptotic stage and reconnects back to the canonical trajectory with counterintuitive directionality, it can be a checkpoint as authors interpret using their expert knowledge, or maybe a false discovery of the tool. Maybe authors can consider running other algorithms on those cells and see which tracks they identify and if the directionality matches with the tviblindi.</p>
<p>
(3) The paper mainly focused on mass cytometry data and had a brief discussion on scRNA-seq. Can the tool be applied to multimodality data such as CITE-seq data that have both protein markers and gene expression? Any suggestions if users want to adapt to scATAC-seq or other epigenomic data?</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95861.1.sa4</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Stuchly</surname>
<given-names>Jan</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Novak</surname>
<given-names>David</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Brdickova</surname>
<given-names>Nadezda</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hadlova</surname>
<given-names>Petra</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Iksi</surname>
<given-names>Ahmad</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kuzilkova</surname>
<given-names>Daniela</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Svaton</surname>
<given-names>Michael</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Saad</surname>
<given-names>George Alehandro</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Engel</surname>
<given-names>Pablo</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Luche</surname>
<given-names>Herve</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sousa</surname>
<given-names>Ana E.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Almeida</surname>
<given-names>Afonso R. M.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kalina</surname>
<given-names>Tomas</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p><bold>eLife assessment</bold></p>
<disp-quote content-type="editor-comment">
<p>The authors present an algorithm and workflow for the inference of developmental trajectories from single-cell data, including a mathematical approach to increase computational efficiency. While such efforts are in principle useful, the absence of benchmarking against synthetic data and a wide range of different single-cell data sets make this study incomplete. Based on what is presented, one can neither ultimately judge if this will be an advance over previous work nor whether the approach will be of general applicability.</p>
</disp-quote>
<p>We thank the eLife editor for the valuable feedback. We wish to emphasize that both, benchmarking against other methods and validation on a synthetic dataset (“dyntoy”) are indeed presented in Supplementary Note, although we failed to sufficiently emphasize it in the main text.</p>
<p>We will extend the benchmarking to more TI methods and we will improve the results and discussion sections to present those facts more clearly to the reader.</p>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>Summary:</p>
<p>The authors present tviblindi, a computational workflow for trajectory inference from molecular data at single-cell resolution. The method is based on (i) pseudo-time inference via expecting hitting time, (ii) sampling of random walks in a directed acyclic k-NN where edges are oriented away from a cell of origin w.r.t. the involved nodes' expected hitting times, and (iii) clustering of the random walks via persistent homology. An extended use case on mass cytometry data shows that tviblindi can be used elucidate the biology of T cell development.</p>
<p>Strengths:</p>
<p>- Overall, the paper is very well written and most (but not all, see below) steps of the tviblindi algorithm are explained well.</p>
<p>- The T cell biology use case is convincing (at least to me: I'm not an immunologist, only a bioinformatician with a strong interest in immunology).</p>
</disp-quote>
<p>We thank the reviewer for feedback and suggestions that we will accommodate, we respond point-by-point below</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses:</p>
<p>- The main weakness of the paper is that a systematic comparison of tviblindi against other tools for trajectory inference (there are many) is entirely missing. Even though I really like the algorithmic approach underlying tviblindi, I would therefore not recommend to our wet-lab collaborators that they should use tviblindi to analyze their data. The only validation in the manuscript is the T cell development use case. Although this use case is convincing, it does not suffice for showing that the algorithms's results are systematically trustworthy and more meaningful (at least in some dimension) than trajectories inferred with one of the many existing methods.</p>
</disp-quote>
<p>We have compared <italic>tviblindi</italic> to several trajectory inference methods (Supplementary note section 8.2: Comparison to state-of-the-art methods, namely Monocle3 (v1.3.1) Cao et al. (2019), Stream (v1.1) Chen et al. (2019), Palantir (v1.0.0) Setty et al. (2019), VIA (v0.1.89) Stassen et al. (2021) and PAGA (scanpy==1.9.3) Wolf et al. (2019).) We will add thorough and systematic comparisons to the other algorithms mentioned by reviewers. We will include extended evaluation on publically available datasets.</p>
<p>Also, we have successfully used <italic>tviblindi</italic> to investigate human B-cell development in primary immunodeficiency (manuscript in revisions), double negative T-cells development in ALPS (Autoimmune Lymphoproliferative Syndrome) by mass cytometry (project in progress).</p>
<disp-quote content-type="editor-comment">
<p>- The authors' explanation of the random walk clustering via persistent homology in the Results (subsection &quot;Real-time topological interactive clustering&quot;) is not detailed enough, essentially only concept dropping. What does &quot;sparse regions&quot; mean here and what does it mean that &quot;persistent homology&quot; is used? The authors should try to better describe this step such that the reader has a chance to get an intuition how the random walk clustering actually works. This is especially important because the selection of sparse regions is done interactively. Therefore, it's crucial that the users understand how this selection affects the results. For this, the authors must manage to provide a better intuition of the maths behind clustering of random walks via persistent homology.</p>
</disp-quote>
<p>In order to satisfy both reader types: the biologist and the mathematician, we explain the mathematics in detail in the Supplementary Note, section 4. We will improve the Results text to better point the reader to the mathematical foundations in the Supplementary Note.</p>
<disp-quote content-type="editor-comment">
<p>- To motivate their work, the authors write in the introduction that &quot;TI methods often use multiple steps of dimensionality reduction and/or clustering, inadvertently introducing bias. The choice of hyperparameters also fixes the a priori resolution in a way that is difficult to predict.&quot; They claim that tviblindi is better than the original methods because &quot;analysis is performed in the original high-dimensional space, avoiding artifacts of dimensionality reduction.&quot; However, in the manuscript, tviblindi is tested only on mass cytometry data which has a much lower dimensionality than scRNA-seq data for which most existing trajectory inference methods are designed. Since tviblindi works on a k-NN graph representation of the input data, it is unclear if it could be run on scRNA-seq data without prior dimensionality reduction. For this, cell-cell distances would have to be computed in the original high-dimensional space, which is problematic due to the very high dimensionality of scRNA-seq data. Of course, the authors could explicitly reduce the scope of tviblindi to data of lower dimensionality, but this would have to be stated explicitly.</p>
</disp-quote>
<p>In the manuscript we tested the framework on the scRNA-seq data from Park et al 2020 (DOI: 10.1126/science.aay3224). To illustrate that <italic>tviblindi</italic> can work directly in the high-dimensional space, we applied the framework successfully on imputed 2000 dimensional data.</p>
<p>The idea behind <italic>tviblindi</italic> is to be able to work without the necessity to use non-linear dimensionality reduction techniques, which reduce the dimensionality to a very low number of dimensions and whose effects on the data distribution are difficult to predict. On the other hand the use of (linear) dimensionality reduction techniques which effectively suppress noise in the data such as PCA is a good practice (see also response to reviewer 2). We will emphasize this in the revised version and add the results of the corresponding analysis.</p>
<disp-quote content-type="editor-comment">
<p>- Also tviblindi has at least one hyper-parameter, the number k used to construct the k-NN graphs (there are probably more hidden in the algorithm's subroutines). I did not find a systematic evaluation of the effect of this hyper-parameter.</p>
</disp-quote>
<p>Detailed discussion of the topic is presented in the Supplementary Note, section 8.1, where Spearman correlation coefficient between pseudotime estimated using k=10 and k=50 nearest neighbors was 0.997.   The number k however does affect the number of candidate endpoints. But even when larger k causes spurious connection between unrelated cell fates, the topological clustering of random walks allows for the separation of different trajectories. We will expand the “sensitivity to hyperparameters section” also in response to reviewer 2.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>Summary:</p>
<p>In Deconstructing Complexity: A Computational Topology Approach to Trajectory Inference in the Human Thymus with tviblindi, Stuchly et al. propose a new trajectory inference algorithm called tviblindi and a visualization algorithm called vaevictis for single-cell data. The paper utilizes novel and exciting ideas from computational topology coupled with random walk simulations to align single cells onto a continuum. The authors validate the utility of their approach largely using simulated data and establish known protein expression dynamics along CD4/CD8 T cell development in thymus using mass cytometry data. The authors also apply their method to track Treg development in single-cell RNA-sequencing data of human thymus.</p>
<p>The technical crux of the method is as follows: The authors provide an interactive tool to align single cells along a continuum axis. The method uses expected hitting time (given a user input start cell) to obtain a pseudotime alignment of cells. The pseudotime gives an orientation/direction for each cell, which is then used to simulate random walks. The random walks are then arranged/clustered based on the sparse region in the data they navigate using persistent homology.</p>
</disp-quote>
<p>We thank the reviewer for feedback and suggestions that we will accommodate, we respond point-by-point below.</p>
<disp-quote content-type="editor-comment">
<p>Strengths:</p>
<p>The notion of using persistent homology to group random walks to identify trajectories in the data is novel.</p>
<p>The strength of the method lies in the implementation details that make computationally demanding ideas such as persistent homology more tractable for large scale single-cell data.</p>
<p>This enables the authors to make the method more user friendly and interactive allowing real-time user query with the data.</p>
<p>Weaknesses:</p>
<p>The interactive nature of the tool is also a weakness, by allowing for user bias leading to possible overfitting for a specific data.</p>
</disp-quote>
<p>tviblindi is not designed as a fully automated TI tool (although it implements a fully automated module), but as a data driven framework for exploratory analysis of unknown data. There is always a risk of possible bias in this type of analysis - starting with experimental design, choice of hyperparameters in the downstream analysis, and an expert interpretation of the results. The successful analysis of new biological data involves a great deal of expert knowledge which is difficult to a priori include in the computational models.</p>
<p>tvilblindi tries to solve this challenge by intentionally overfitting the data and keeping the level of resolution on a single random walk. In this way we aim to capture all putative local relationships in the data. The on-demand aggregation of the walks using the global topology of the data allows researchers to use their expert knowledge to choose the right level of detail (as demonstrated in the Figure 4 of the manuscript) while relying on the topological structure of the high dimensional point cloud. At all times tviblindi allows to inspect the composition of the trajectory to assess the variance in the development, possible hubs on the KNN-graph etc.</p>
<disp-quote content-type="editor-comment">
<p>The main weakness of the method is lack of benchmarking the method on real data and comparison to other methods. Trajectory inference is a very crowded field with many highly successful and widely used algorithms, the two most relevant ones (closest to this manuscript) are not only not benchmarked against, but also not sited. Including those that specifically use persistent homology to discover trajectories (Rizvi et.al. published Nat Biotech 2017). Including those that specifically implement the idea of simulating random walks to identify stable states in single-cell data (e.g. CellRank published in Lange et.al Nat Meth 2022), as well as many trajectory algorithms that take alternative approaches. The paper has much less benchmarking, demonstration on real data and comparison to the very many other previous trajectory algorithms published before it. Generally speaking, in a crowded field of previously published trajectory methods, I do not think this one approach will compete well against prior work (especially due to its inability to handle the noise typical in real world data (as was even demonstrated in the little bit of application to real world data provided).</p>
</disp-quote>
<p>We provide comparisons of <italic>tviblindi</italic> and <italic>vaevictis</italic> in the Supplementary Note, section 8.2, where we compare it to Monocle3 (v1.3.1) Cao et al. (2019), Stream (v1.1) Chen et al. (2019), Palantir (v1.0.0) Setty et al. (2019), VIA (v0.1.89) Stassen et al. (2021) and PAGA (scanpy==1.9.3) Wolf et al. (2019). We use two datasets: artificial Dyntoy and real mass cytometry thymus+peripheral blood dataset. We thank the reviewer for suggesting specific methods.  CellRank was excluded from the benchmarking as it was originally designed for RNA-velocity data (not available in mass cytometry data), but will include recent upgrade CellRank2 (preprint at <ext-link ext-link-type="uri" xlink:href="http://doi.org/10.1101/2023.07.19.549685">doi.org/10.1101/2023.07.19.549685</ext-link>) which offers more flexibility.</p>
<p>We will add further benchmarking as suggested by the reviewer in the course of revisions.</p>
<disp-quote content-type="editor-comment">
<p>Beyond general lack of benchmarking there are two issues that give me particular concern. As previously mentioned, the algorithm is highly susceptible to user bias and overfitting. The paper gives the example (Figure 4) of a trajectory which mistakenly shows that cells may pass from an apoptotic phase to a different developmental stage. To circumvent this mistake, the authors propose the interactive version of tviblindi that allows users to zoom in (increase resolution) and identify that there are in fact two trajectories in one. In this case, the authors show how the author can fix a mistake when the answer is known. However, the point of trajectory inference is to discover the unknown. With so much interactive options for the user to guide the result, the method is more user/bias driven than data-driven. So a rigorous and quantitative discussion of robustness of the method, as well as how to ensure data-driven inference and avoid over-fitting would be useful.</p>
</disp-quote>
<p>Local directionality in expression data is a challenge which is not, to our knowledge, solved. And we are not sure it can be solved entirely, even theoretically. The random walks passing “through” the apoptotic phase are biologically infeasible, but it is an (unbiased) representation of what the data look like based on the diffusion model. It is a property of the data (or of the panel design), which has to be interpreted properly rather than a mistake. Of note, except for Monocle3 (which does not provide the directionality) other tested methods did not discover this trajectory at all.</p>
<p>The “zoom in” has in fact nothing to do with “passing through the apoptosis”. We show how the researcher can investigate the suggested trajectory to see if there is an additional structure of interest and/or relevance. This investigation is still data driven (although not fully automated). Anecdotally in this particular case this branching was discovered by an bioinformatician, who knew nothing about the presence of beta-selection in the data.</p>
<p>We show that the trajectory of apoptosis of cortical thymocytes consists of 2 trajectories corresponding to 2 different checkpoints (beta-selection and positive/negative selection). This type of structure, where 2 (or more) trajectories share the same path for most of the time, then diverge only to be connected at a later moment (immediately from the point of view of the beta-selection failure trajectory) is a challenge for TI algorithms and none of tested methods gave a correct result. More importantly there seems to be no clear way to focus on these kinds of structures (common origin and common fate) in TI methods.</p>
<p>Of note, the “zoom in” is a recommended and convenient method to look for an inner structure, but it does not necessarily mean addition of further homological classes. Indeed, in this case the reason that the structure is not visible directly is the limitation of the dendrogram complexity (only branches containing at least 10% of simulated random walks are shown by default).</p>
<p>In summary, tviblindi effectively handled all noise in the data that obscured biologically valid trajectories for other methods. We will improve the discussion of the robustness in the reviewed version.</p>
<disp-quote content-type="editor-comment">
<p>Second, the paper discusses the benefit of tviblindi operating in the original high dimensions of the data. This is perhaps adequate for mass cytometry data where there is less of an issue of dropouts and the proteins may be chosen to be large independent. But in the context of single-cell RNA-sequencing data, the massive undersampling of mRNA, as well as high degree of noise (e.g. ambient RNA), introduces very large degree of noise so that modeling data in the original high dimensions leads to methods being fit to the noise. Therefore ALL other methods for trajectory inference work in a lower dimension, for very good reason, otherwise one is learning noise rather than signal. It would be great to have a discussion on the feasibility of the method as is for such noisy data and provide users with guidance. We note that the example scRNA-seq data included in the paper is denoised using imputation, which will likely result in the trajectory inference being oversmoothed as well.</p>
</disp-quote>
<p>We agree with the reviewer. In our manuscript we wanted to showcase that <italic>tviblindi</italic> can directly operate in high-dimensional space (thousands of dimensions) and we used MAGIC imputation for this purpose. This was not ideal. More standard approach, which uses 30-50 PCs as input to the algorithm resulted in equivalent trajectories. We will add this analysis to the study.</p>
<p>In summary, the fact that <italic>tviblindi</italic> scales well with dimensionality of the data and is able to work in the original space does not mean that it is always the best option. We will emphasize in the revised paper that we aim to avoid the non-linear dimensional reduction techniques as a data preprocessing tool, as the effect of the reduction is difficult to predict. We will also discuss the preprocessing of scRNA-seq data in greater detail.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public Review):</bold></p>
<p>Summary:</p>
<p>Stuchly et al. proposed a single-cell trajectory inference tool, tviblindi, which was built on a sequential implementation of the k-nearest neighbor graph, random walk, persistent homology and clustering, and interactive visualization. The paper was organized around the detailed illustration of the usage and interpretation of results through the human thymus system.</p>
<p>Strengths:</p>
<p>Overall, I found the paper and method to be practical and needed in the field. Especially the in-depth, step-by-step demonstration of the application of tviblindi in numerous T cell development trajectories and how to interpret and validate the findings can be a template for many basic science and disease-related studies. The videos are also very helpful in showcasing how the tool works.</p>
<p>Weaknesses:</p>
<p>I only have a few minor suggestions that hopefully can make the paper easier to follow and the advantage of the method to be more convincing.</p>
<p>(1) The &quot;Computational method for the TI and interrogation - tviblindi&quot; subsection under the Results is a little hard to follow without having a thorough understanding of the tviblindi algorithm procedures. I would suggest that the authors discuss the uniqueness and advantages of the tool after the detailed introduction of the method (moving it after the &quot;Connectome - a fully automated pipeline&quot;.</p>
</disp-quote>
<p>We thank the reviewer for the suggestion and we will accommodate it to improve readability of the text.</p>
<disp-quote content-type="editor-comment">
<p>Also, considering it is a computational tool paper, inevitably, readers are curious about how it functions compared to other popular trajectory inference approaches. I did not find any formal discussion until almost the end of the supplementary note (even that is not cited anywhere in the main text). Authors may consider improving the summary of the advantages of tviblindi by incorporating concrete quantitative comparisons with other trajectory tools.</p>
</disp-quote>
<p>We provide comparisons of <italic>tviblindi</italic> and <italic>vaevictis</italic> in the Supplementary Note, section 8.2, where we compare it to Monocle3 (v1.3.1) Cao et al. (2019), Stream (v1.1) Chen et al. (2019), Palantir (v1.0.0) Setty et al. (2019), VIA (v0.1.89) Stassen et al. (2021) and PAGA (scanpy==1.9.3) Wolf et al. (2019). We use two datasets: artificial Dyntoy and real mass cytometry thymus+peripheral blood dataset. We will also add CellRank2 into comparisons and we will strengthen the message of the benchmarking results in the Discussion section.</p>
<disp-quote content-type="editor-comment">
<p>(2) Regarding the discussion in Figure 4 the trajectory goes through the apoptotic stage and reconnects back to the canonical trajectory with counterintuitive directionality, it can be a checkpoint as authors interpret using their expert knowledge, or maybe a false discovery of the tool. Maybe authors can consider running other algorithms on those cells and see which tracks they identify and if the directionality matches with the tviblindi.</p>
</disp-quote>
<p>We have indeed used the thymus dataset for comparison of all TI algorithms listed above. Except for Monocle 3 they failed to discover the negative selection branch (Monocle 3 does not offer directionality information). Therefore, a valid topological trajectory with incorrect (expert-corrected) directionality was partly or entirely missed by other algorithms.</p>
<disp-quote content-type="editor-comment">
<p>(3) The paper mainly focused on mass cytometry data and had a brief discussion on scRNA-seq. Can the tool be applied to multimodality data such as CITE-seq data that have both protein markers and gene expression? Any suggestions if users want to adapt to scATAC-seq or other epigenomic data?</p>
</disp-quote>
<p>The analysis of multimodal data is the logical next step and is the topic of our current research. At this moment <italic>tviblindi</italic> cannot be applied directly to multimodal data. It is possible to use the KNN-graph based on multimodal data (such as weighted nearest neighbor graph implemented in Seurat) for pseudotime calculation and random walk simulation. However, we do not have a fully developed triangulation for the multimodal case yet.</p>
</body>
</sub-article>
</article>