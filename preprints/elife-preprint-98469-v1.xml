<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">98469</article-id>
<article-id pub-id-type="doi">10.7554/eLife.98469</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.98469.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Pseudo-grading of tumor subpopulations from single-cell transcriptomic data using Phenotype Algebra</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5666-2551</contrib-id>
<name>
<surname>Bhattacharya</surname>
<given-names>Namrata</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a8">8</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2700-375X</contrib-id>
<name>
<surname>Rockstroh</surname>
<given-names>Anja</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a8">8</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Deshpande</surname>
<given-names>Sanket Suhas</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Thomas</surname>
<given-names>Sam Koshy</given-names>
</name>
<xref ref-type="aff" rid="a10">10</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Yadav</surname>
<given-names>Anunay</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Goswami</surname>
<given-names>Chitrita</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Chawla</surname>
<given-names>Smriti</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Solomon</surname>
<given-names>Pierre</given-names>
</name>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Fourgeux</surname>
<given-names>Cynthia</given-names>
</name>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2837-9361</contrib-id>
<name>
<surname>Ahuja</surname>
<given-names>Gaurav</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hollier</surname>
<given-names>Brett G</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a8">8</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kumar</surname>
<given-names>Himanshu</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Roquilly</surname>
<given-names>Antoine</given-names>
</name>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Poschmann</surname>
<given-names>Jeremie</given-names>
</name>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lehman</surname>
<given-names>Melanie</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a9">9</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Nelson</surname>
<given-names>Colleen C</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a8">8</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Sengupta</surname>
<given-names>Debarka</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a6">6</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Australian Prostate Cancer Research Centre-Queensland, Faculty of Health, School of Biomedical Sciences, Centre for Genomics and Personalised Health, Queensland University of Technology</institution>, Brisbane, Queensland-4000, <country>Australia</country></aff>
<aff id="a2"><label>2</label><institution>Center for Computational Biomedicine, Harvard Medical School</institution>, Boston, MA-02115, <country>USA</country></aff>
<aff id="a3"><label>3</label><institution>Laboratory of Immunology and Infectious Disease Biology, Department of Biological Sciences, Indian Institute of Science Education and Research (IISER)</institution>, Bhopal, <country>India</country></aff>
<aff id="a4"><label>4</label><institution>Department of Computational Biology, Indraprastha Institute of Information Technology-Delhi (IIIT-Delhi)</institution>, Okhla, Phase III, New Delhi-110020, <country>India</country></aff>
<aff id="a5"><label>5</label><institution>Department of Computer Science and Engineering, Indraprastha Institute of Information Technology-Delhi (IIIT-Delhi)</institution>, Okhla, Phase III, New Delhi-110020, <country>India</country></aff>
<aff id="a6"><label>6</label><institution>Centre for Artificial Intelligence, Indraprastha Institute of Information Technology-Delhi (IIIT-Delhi)</institution>, Okhla, Phase III, New Delhi-110020, <country>India</country></aff>
<aff id="a7"><label>7</label><institution>Nantes Université, CHU Nantes, INSERM, Center for Research in Transplantation and Translational Immunology</institution>, UMR, 1064, Nantes, <country>France</country></aff>
<aff id="a8"><label>8</label><institution>Translational Research Institute, Princess Alexandra Hospital</institution>, Woolloongabba, Queensland-4102, <country>Australia</country></aff>
<aff id="a9"><label>9</label><institution>Vancouver Prostate Centre, Department of Urologic Sciences, University of British Columbia</institution>, Vancouver, <country>Canada</country></aff>
<aff id="a10"><label>10</label><institution>School of Mathematical Sciences, The University of Adelaide</institution>, North Terrace, Adelaide, SA-5005, <country>Australia</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Hong</surname>
<given-names>Seunghee</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Yonsei University</institution>
</institution-wrap>
<city>Seoul</city>
<country>Republic of Korea</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Choi</surname>
<given-names>Murim</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Seoul National University</institution>
</institution-wrap>
<city>Seoul</city>
<country>Republic of Korea</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label><italic>Corresponding authors: {</italic><email>debarka@iiitd.ac.in</email>, <email>colleen.nelson@qut.edu.au</email><italic>}</italic>.</corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-08-20">
<day>20</day>
<month>08</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP98469</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-05-13">
<day>13</day>
<month>05</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-04-01">
<day>01</day>
<month>04</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.12.28.522060"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Bhattacharya et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Bhattacharya et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-98469-v1.pdf"/>
<abstract>
<title>Abstract</title><p>Single-cell RNA-sequencing (scRNA-seq) coupled with robust computational analysis facilitates the characterization of phenotypic heterogeneity within tumors. Current scRNA-seq analysis pipelines are capable of identifying a myriad of malignant and non-malignant cell subtypes from single-cell profiling of tumors. However, given the extent of intra-tumoral heterogeneity, it is challenging to assess the risk associated with individual malignant cell subpopulations, primarily due to the complexity of the cancer phenotype space and the lack of clinical annotations associated with tumor scRNA-seq studies. To this end, we introduce SCellBOW, a scRNA-seq analysis framework inspired by document embedding techniques from the domain of Natural Language Processing (NLP). SCellBOW is a novel computational approach that facilitates effective identification and high-quality visualization of single-cell subpopulations. We compared SCellBOW with existing best practice methods for its ability to precisely represent phenotypically divergent cell types across multiple scRNA-seq datasets, including our in-house generated human splenocyte and matched peripheral blood mononuclear cell (PBMC) dataset. For malignant cells, SCellBOW estimates the relative risk associated with each cluster and stratifies them based on their aggressiveness. This is achieved by simulating how the presence or absence of a specific malignant cell subpopulation influences disease prognosis. Using SCellBOW, we identified a hitherto unknown and pervasive AR−/NE<sub>low</sub> (androgen-receptor-negative, neuroendocrine-low) malignant subpopulation in metastatic prostate cancer with conspicuously high aggressiveness. Overall, the risk-stratification capabilities of SCellBOW hold promise for formulating tailored therapeutic interventions by identifying clinically relevant tumor subpopulations and their impact on prognosis.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>-Intra-tumor heterogeneity</kwd>
<kwd>single-cell RNA-seq</kwd>
<kwd>risk stratification</kwd>
<kwd>transfer learning</kwd>
<kwd>clustering</kwd>
<kwd>phenotype algebra</kwd>
<kwd>prostate cancer</kwd>
</kwd-group>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Supplemental files updated. Added interpretation and validation of the results.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Intra-and inter-tumoral heterogeneity are pervasive in cancer and manifest as a constellation of molecular alterations in tumor tissues. The late-stage clonal proliferation, partial selective sweeps, and spatial segregation within the tumor mass collectively orchestrate lineage plasticity and metastasis<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. In collaboration with non-malignant cell types in the tumor stroma, malignant cells with distinct genetic and phenotypic properties create complex and dynamic ecosystems, rendering the tumors recalcitrant to therapies<sup><xref ref-type="bibr" rid="c2">2</xref></sup>. Thus, the phenotypic characterization of malignant cell subpopulations (subclones) is critical to understanding the underlying mechanisms of resistive behavior. The widespread adoption of single-cell RNA-sequencing (scRNA-seq) has enabled the profiling of individual cells, thereby obtaining a high-resolution snapshot of their unique molecular landscapes<sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c4">4</xref></sup>. A precise understanding of cell-to-cell functional variability captured by scRNA-seq profiles is crucial in this context. These molecular profiles assist in robust deconvolution of the oncogenic processes instigated by various selection pressures exerted by anticancer agents. They also facilitate understanding the cross-talks between malignant and non-malignant cell types within the tumor microenvironment<sup><xref ref-type="bibr" rid="c5">5</xref></sup>. To effectively analyze tumor scRNA-seq data, various specialized techniques have been developed. These techniques assist in proactive investigation of complex and elusive cell populations<sup><xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c7">7</xref></sup>, regulatory gene interactions<sup><xref ref-type="bibr" rid="c8">8</xref></sup>, neoplastic cell lineage trajectories<sup><xref ref-type="bibr" rid="c9">9</xref></sup>, and expression-based inference of copy number variations<sup><xref ref-type="bibr" rid="c10">10</xref></sup>. While these computational techniques have been successful in gaining novel biological insights, their adoption in clinical settings is still elusive.</p>
<p>Over the past years, leading consortia such as The Cancer Genome Atlas (TCGA)<sup><xref ref-type="bibr" rid="c11">11</xref></sup> and other large-scale independent studies have established reproducible molecular subtypes of cancers with divergent prognoses. For instance, metastatic prostate cancer has typically been categorized based on the androgen receptor (AR) activity or neuroendocrine (NE) program: the less aggressive AR+/NE– (AR prostate cancer, ARPC) and the highly aggressive AR–/NE+ (NE prostate cancer, NEPC)<sup><xref ref-type="bibr" rid="c12">12</xref></sup>. More recent studies have identified additional phenotypes, such as the AR–/NE– (double-negative prostate cancer, DNPC) and AR+/NE+ (amphicrine prostate cancer, AMPC)<sup><xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>. These findings underscore the importance of considering tumor heterogeneity while dictating the differential treatment regimes to improve patient outcomes<sup><xref ref-type="bibr" rid="c15">15</xref></sup>. These studies are predominantly based on bulk omics assays, which precludes the detectability of fine-grained molecular subtypes of clinical relevance. To address this, there is an urgent need to develop novel analytical approaches that are capable of exploiting single-cell omics profiles for risk attribution to malignant cell subtypes.</p>
<p>A growing number of NLP-based methods have recently been gaining popularity for their ability to predict patients’ survival based on their clinical records and for facilitating efficient analyses of high-dimensional scRNA-seq data<sup><xref ref-type="bibr" rid="c16">16</xref>–<xref ref-type="bibr" rid="c19">19</xref></sup>. For instance, Nunez <italic>et al.</italic><sup><xref ref-type="bibr" rid="c16">16</xref></sup> employ language models to predict the survival outcomes of breast cancer patients based on their initial oncologist consultation documents. Similarly, in the domain of scRNA-seq analysis, scETM<sup><xref ref-type="bibr" rid="c18">18</xref></sup> uses topic models to infer biologically relevant cellular states from single-cell gene expression data. Recently, scBERT<sup><xref ref-type="bibr" rid="c19">19</xref></sup>, an adaptation of attention-based transformer architecture, has been developed for cell type annotation in single-cell. Motivated by the objective to efficiently associate survival risk directly with cellular subpopulations extracted from scRNA-seq data, we introduce SCellBOW (single-cell bag-of-words), a Doc2vec<sup><xref ref-type="bibr" rid="c20">20</xref></sup> inspired transfer learning framework for single-cell representation learning, clustering, visualization, and relative risk stratification of malignant cell types within a tumor. SCellBOW intuitively treats cells as documents and genes as words. SCellBOW learned latent representations capture the semantic meanings of cells based on their gene expression levels. Due to this, cell type or condition-specific expression patterns get adequately captured in cell embeddings. We demonstrate the utility of SCellBOW in clustering cells based on their semantic similarities across multiple scRNA-seq datasets, spanning from normal prostate to pancreas and peripheral blood mononuclear cells (PBMC). As an extended validation, we apply SCellBOW to an in-house scRNA-seq dataset comprising human PBMC and matched splenocytes. We observed that SCellBOW outperforms existing best-practice single-cell clustering methods in its ability to precisely represent phenotypically divergent cell types.</p>
<p>Beyond robust identification of cellular clusters, the latent representation of single-cells provided by SCellBOW captures the’semantics’ associated with cellular phenotypes. In line with <italic>word algebra</italic> supported by NLP models, which explores word analogies based on semantic closeness (e.g., adding a word vector associated <italic>royal</italic> to <italic>man</italic> brings it closer to <italic>king</italic>), we conjectured that cellular embeddings can reveal biologically intuitive outcomes through algebraic operations. Thus, we aimed to replicate this feature in the single-cell phenotype space to introduce <italic>phenotype algebra</italic> and apply the same in attributing prognostic value to cancer cell subpopulations identified from scRNA-seq studies. With the help of <italic>phenotype algebra,</italic> it is possible to simulate the exclusion of the phenotype associated with a specific malignant cell subpopulation and relate the same to the disease outcome. Selectively removing a specific subtype from the whole tumor allows us to categorize the aggressiveness of individual subtypes under negative selection pressure while preserving the impact of the residual tumor. This information can ultimately aid therapeutic decision-making and improve patient outcomes. As a proof of concept, we validate the phenotype <italic>algebra</italic> component of SCellBOW for pseudo-grading malignant cell subtypes across three independent cancer types: glioblastoma multiforme, breast cancer, and metastatic prostate cancer.</p>
<p>Finally, we demonstrate the utility of SCellBOW to uncover and define novel subpopulations in a cancer type based on biological features relating to disease aggressiveness and survival probability. Metastatic prostate cancer encompasses a range of malignant cell subpopulations, and characterizing novel or more fine-grained subtypes with clinical implications on patient prognosis is an active field of research<sup><xref ref-type="bibr" rid="c21">21</xref>,<xref ref-type="bibr" rid="c22">22</xref></sup>. To explore this, we applied our <italic>phenotype algebra</italic> on the SCellBOW clusters as opposed to predefined subtypes. Through our analysis using SCellBOW, we identify a dedifferentiated metastatic prostate cancer subpopulation. This subpopulation is nearly ubiquitous across numerous metastatic prostate cancer samples and demonstrates greater aggressiveness compared to any known molecular subtypes. To the best of our knowledge, SCellBOW pioneered the application of a NLP-based model to attribute survival risk to malignant cell subpopulations from patient tumors. SCellBOW holds promise for tailored therapeutic interventions by identifying clinically relevant subpopulations and their impact on prognosis.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Overview of SCellBOW</title>
<p>Correlating genomic readouts of tumors with clinical parameters has helped us associate molecular signatures with disease prognosis<sup><xref ref-type="bibr" rid="c23">23</xref></sup>. Given the prominence of phenotypic heterogeneity in tumors, it is important to understand the connection between molecular signatures of clonal populations and disease aggressiveness. Existing methods map tumor samples to a handful of well-characterized molecular subtypes with known survival patterns primarily obtained from bulk RNA-seq studies. However, bulk RNA-seq measures the average level of gene expression distributed across millions of cells in a tissue sample, thereby obscuring the intra-tumoral heterogeneity<sup><xref ref-type="bibr" rid="c24">24</xref></sup>. This limitation prompted us to turn to tumor scRNA-seq. Tumor scRNA-seq studies have successfully revealed the extent of gene expression variance across individual malignant cells, contributing to an in-depth understanding of the mechanisms driving cancer progression<sup><xref ref-type="bibr" rid="c25">25</xref></sup>. However, to date, most studies use marker genes identified from bulk RNA-seq studies to characterize malignant cell clusters identified from scRNA-seq data. This approach is inadequate since every tumor is unique when looked through the lenses of single-cell expression profiles<sup><xref ref-type="bibr" rid="c26">26</xref></sup>. Bulk markers alone cannot adequately capture the intricate heterogeneity present within tumors, as different tumors may exhibit distinct phenotypes with varying degrees of aggressiveness at the single-cell level. While existing methods effectively reveal the subpopulations, they are insufficient in associating malignant risk with specific cellular subpopulations identified from scRNA-seq data. The proposed approach, SCellBOW, can effectively capture the heterogeneity and risk associated with each phenotype, enabling the identification and assessment of malignant cell subtypes in tumors directly from scRNA-seq gene expression profiles, thereby eliminating the need for marker genes (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). Below, we highlight key constructions and benefits of this new approach.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 1.</label>
<caption><title>SCellBOW workflow.</title>
<p>a, Schematic overview of SCellBOW workflow for identifying subclones and assessing subclonal tumor aggressiveness. For SCellBOW clustering, firstly, a corpus was created from the gene expression matrix, where cells were analogous to documents and genes to words. Next, the pre-trained model was retrained with the vocabulary of the target dataset. Then, clustering was performed on embeddings generated from the neural network. For SCellBOW <italic>phenotype algebra</italic>, vectors were created for reference (<italic>total tumor</italic>) and queries. Then, the query vector was subtracted from the reference vector to calculate the predicted risk score using a bootstrapped random survival forest. Finally, survival probability was evaluated and phenotypes were stratified by the median predicted risk score.</p></caption>
<graphic xlink:href="522060v3_fig1.tif" mime-subtype="tiff" mimetype="image"/>
    <permissions>
        <copyright-statement>© 2024, BioRender Inc</copyright-statement>
        <copyright-year>2024</copyright-year>
        <copyright-holder>BioRender Inc</copyright-holder>
        <license><license-p>Any parts of this image created with <ext-link ext-link-type="uri" xlink:href="https://www.biorender.com/">BioRender</ext-link> are not made available under the same license as the Reviewed Preprint, and are © 2024, BioRender Inc.</license-p></license>
    </permissions>
</fig>
<p>SCellBOW adapts the popular document-embedding model Doc2vec for single-cell latent representation learning, which can be used for downstream analysis. SCellBOW represents cells as documents and gene names as words. Gene expression levels are encoded by’word frequencies’, i.e., variation in gene expression values is captured by introducing gene names in proportion to their intensities in cells. SCellBOW encodes each cell into low-dimensional embeddings. SCellBOW extracts the gene expression patterns of individual cells from a relatively large unlabelled source scRNA-seq dataset by pre-training a shallow source network. The neuronal weights estimated during pre-training are transferred to a relatively smaller unlabelled scRNA-seq dataset, where they are refined based on the gene expression patterns in the target dataset. SCellBOW leverages the variability in gene expression values to subsequently cluster cells according to their semantic similarity.</p>
<p>Building upon SCellBOW’s capacity to preserve the semantic meaning of individual cells, we attempted to establish meaningful associations among cellular phenotypes. SCellBOW offers a remarkable feature for executing algebraic operations such as’+’ and’–’ on single-cells in the latent space while preserving the biological meanings. This feature catalyzes the simulation of the residual phenotype of tumors, following positive and negative selection of specific malignant cell subtypes in a tumor. This could potentially be used to identify the contribution of that phenotype to patient survival. For example, the’–’ operation can be used to predict the likelihood of survival by eliminating the impact of a specific aggressive cellular phenotype from the whole tumor. We empirically show the retention of such semantic relationships in the context of cellular phenotypes of cancer cells using <italic>phenotype algebra</italic>. SCellBOW uses algebraic operations to compare and analyze the importance of cellular phenotypes working independently or in combination toward the aggressiveness of the tumor in a way that is not possible using traditional methods. <italic>Phenotype algebra</italic> can be performed either on the pre-defined cancer subtypes or SCellBOW clusters. Drawing from the overall performance of SCellBOW in accurately clustering and ranking cellular phenotypes by aggressiveness, we further analyzed multi-patient scRNA-seq data of metastatic prostate cancer and characterized an unknown, de-differentiated AR−/NE<sub>low</sub>subpopulation of malignant cells.</p>
</sec>
<sec id="s2b">
<title>SCellBOW robustly dissects tissue heterogeneity</title>
<p>Malignant cells are far more heterogeneous compared to associated normal cells. Clustering is often the first step toward recognizing subclonal lineages in a tumor sample. Clustering single-cells based on their molecular profiles can potentially identify rare cell populations with distinct phenotypes and clinical outcomes. To evaluate the strength of the clustering ability of SCellBOW, we benchmarked our method against five existing scRNA-seq clustering tools<sup><xref ref-type="bibr" rid="c27">27</xref>–<xref ref-type="bibr" rid="c31">31</xref></sup> (<bold>Supplementary Table 1</bold>). Among these packages, Seurat<sup><xref ref-type="bibr" rid="c27">27</xref></sup> and Scanpy<sup><xref ref-type="bibr" rid="c28">28</xref></sup> are the most popular, and both employ graph-based clustering techniques. DESC<sup><xref ref-type="bibr" rid="c29">29</xref></sup> is a deep neural network-based scRNA-seq clustering package, whereas ItClust<sup><xref ref-type="bibr" rid="c30">30</xref></sup> and scETM<sup><xref ref-type="bibr" rid="c31">31</xref></sup> are transfer learning methods. All the packages are resolution-dependent except for ItClust. ItClust automatically selects the resolution with the highest silhouette score. We used a number of scRNA-seq datasets to evaluate the tools cited above (<bold>Supplementary Table 2</bold>). For the objective evaluation of performance, we used an adjusted Rand index (ARI) and normalized mutual information (NMI) to compare clusters with known cell annotations (<bold>Supplementary Table 3)</bold>. For all methods, except for ItClust, we computed overall ARI and NMI for different values of resolution ranging between 0.2 to 2.0. We computed the cell type silhouette index (SI) based on known annotations to measure the signal-to-noise ratio of low-dimensional single-cell embeddings.</p>
<p>We constructed three use cases leveraging publicly available scRNA-seq datasets. Each instance constitutes a pair of single-cell expression datasets, of which the source data is used for self-supervised model training and the target data for model fine-tuning and analysis of the clustering outcomes. In all cases, the target data has associated cell type annotations derived from fluorescence-activated cell sorting (FACS) enriched pure cell subpopulations. The first use case consists of non-cancerous cells from prostate cancer patients<sup><xref ref-type="bibr" rid="c32">32</xref></sup> (120,300 cells) as the source data and cells from healthy prostate tissues<sup><xref ref-type="bibr" rid="c33">33</xref></sup> (28,606 cells) as the target data. This use case was designed to assess the resiliency of SCellBOW to the presence of disease covariates in a large scRNA-seq dataset. The second use case comprises a large PBMC dataset<sup><xref ref-type="bibr" rid="c34">34</xref></sup> (68,579 cells) as the source data, whereas the target data was sourced from a relatively small FACS-annotated PBMC dataset (2,700 cells) from the same study. The third use case, as source data, comprises pancreatic cells from three independent studies processed with different single-cell profiling technologies (inDrop<sup><xref ref-type="bibr" rid="c35">35</xref></sup>, CEL-Seq2<sup><xref ref-type="bibr" rid="c36">36</xref></sup>, SMARTer<sup><xref ref-type="bibr" rid="c37">37</xref></sup>). The target data used in this case was from an independent study processed with a different technology, Smart-Seq2<sup><xref ref-type="bibr" rid="c38">38</xref></sup> (<xref rid="fig2" ref-type="fig">Fig. 2</xref><bold>, Supplementary Fig. 2</bold>). For the normal prostate, PBMC, and pancreas datasets, SCellBOW produced the highest ARI scores across most notches of the resolution spectrum (0.2 to 2.0) (<xref rid="fig2" ref-type="fig">Fig. 2g-i</xref>). We observed a similar trend in the case of NMI (<xref rid="fig2" ref-type="fig">Fig. 2j</xref>). SCellBOW exhibited the highest NMI compared to other tools for the normal prostate, PBMC, and pancreas datasets. For further deterministic evaluation of the different methods across the datasets, we set 1.0 as the default resolution for calculating cell type SI (<xref rid="fig2" ref-type="fig">Fig 2k</xref>). In the PBMC and pancreas datasets, SCellBOW yielded the highest cell type SI for both datasets. SCellBOW and Seurat were comparable in performance for the pancreas dataset, outperforming other tools. We observed poor performance by DESC and ItClust across all the datasets in terms of cell type SI. In terms of cell type SI, Seurat and scETM showed improved results in the normal prostate dataset. However, SCellBOW outperformed both Seurat and scETM in terms of overall ARI and NMI for the same dataset, indicating higher clustering accuracy. To further evaluate the cluster quality in the normal prostate dataset, we compared the known cell types to the predicted clusters. Known cell types such as basal epithelial, luminal epithelial, and smooth muscle cells were grouped into homogeneous clusters by SCellBOW (<bold>Supplementary Fig. 2</bold>). We observed that the majority of fibroblasts and endothelial cells were mapped by SCellBOW to single clusters, unlike Seurat and scETM. SCellBOW retained hillock cells in close proximity to both basal epithelial and club cells, in contrast to Seurat, which only includes basal epithelial cells. We compared SCellBOW with two additional methods published recently – scBERT<sup><xref ref-type="bibr" rid="c19">19</xref></sup> and scPhere<sup><xref ref-type="bibr" rid="c39">39</xref></sup>. Among these, scBERT is a transfer learning-based method built upon BERT<sup><xref ref-type="bibr" rid="c40">40</xref></sup>. scPhere is a deep generative model designed for embedding single cells into low-dimensional hyperspherical or hyperbolic spaces. While scBERT offers competitive performance, scPhere consistently falls behind the other methods (<bold>Supplementary Fig. 3 and Supplementary Note 1</bold>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 2.</label>
<caption><title>Evaluation of single-cell representations using SCellBOW.</title>
<p>a-c, UMAP plots for the normal prostate (a), PBMC (b), and pancreas (c) datasets. The coordinates are colored by cell types.</p>
<p>d-f, UMAP plots for normal prostate (d), PBMC (e), and pancreas (f) datasets, where the coordinates are colored by SCellBOW clusters. CL is used as an abbreviation for cluster.</p>
<p>g-i, Radial plot for the percentage of contribution of different methods towards ARI for various resolutions ranging from 0.2 to 2.0. ItClust is a resolution-independent method; thus, the ARI is kept constant across all the resolutions.</p>
<p>j, Box plot for the NMI of different methods across different resolutions ranging from 0.2 to 2.0 in steps of 0.2.</p>
<p>k, Bar plot for the cell type silhouette index (SI) for different methods. The default resolution was set to 1.0.</p></caption>
<graphic xlink:href="522060v3_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Our analyses on the public datasets confirm the robustness of SCellBOW compared to the prominent single-cell analysis tools, including the prominent transfer learning methods. To this end, we applied SCellBOW to investigate a more challenging task of analyzing an in-house scRNA-seq data comprising splenocytes and matched PBMCs from two healthy and two brain-dead donors. Given multiple covariates, such as the origin of the cells and the physiological states of the donors, analysis of this scRNA-seq data presents a challenging use case. We used the established high-throughput scRNA-seq platform CITE-seq<sup><xref ref-type="bibr" rid="c41">41</xref></sup> to pool eight samples into a single experiment. After post-sequencing quality control, we were left with 4,819 cells. We annotated the cells using Azimuth<sup><xref ref-type="bibr" rid="c42">42</xref></sup>, with occasional manual interventions (<bold>Supplementary Note 2, Supplementary</bold> Fig. 4d-f). We quantitatively evaluated SCellBOW and the rest of the benchmarking methods by measuring ARI, NMI, and cell type SI (<xref rid="fig3" ref-type="fig">Fig. 3e</xref>, <bold>Supplementary</bold> Fig. 3d-f<bold>)</bold>. While most methods did reasonably well, SCellBOW offered an edge. We observed the best results in SCellBOW in terms of ARI, NMI, and cell type SI compared to other tools (<bold>Supplementary Table 3</bold>). SCellBOW yielded clusters largely coherent with the independently done cell type annotation using Azimuth (<xref rid="fig3" ref-type="fig">Fig 3</xref>, <bold>Supplementary</bold> Fig. 5). Further, most clusters harbor cells from all the donors, indicating that the sample pooling strategy was effective in reducing batch effects. B cells, T cells, and NK cells map to SCellBOW clusters where the respective cell types are the majority. Most CD4+ T cells map to CL0 and CL9 (here, CL is used as an abbreviation for cluster) (<xref rid="fig3" ref-type="fig">Fig 3f</xref>). CL0 is shared between CD8+ T cells, CD4+ T cells, and Treg cells, which originate from the same lineage. CL4 majorly consists of NK cells with a small fraction of CD8+ T cells, which is not unduly deviant from the PBMC lineage tree. As a control, we performed similar analyses of the Scanpy clusters (<xref rid="fig3" ref-type="fig">Fig 3g</xref>). While Scanpy performed reasonably well, misalignments could be spotted. For example, CD4+ and CD8+ T cells were split across many clusters with mixed cell type mappings. SCellBOW maps CD14 monocytes to a single cluster, whereas Scanpy distributes CD14 monocytes across two clusters (CL1 and CL8), wherein CL8 is equally shared with conventional Dendritic Cells (cDC).’Eryth’ annotated cells are indignantly mapped to different clusters by both SCellBOW and Scanpy. This could be due to the Azimuth’s reliance on high mitochondrial gene expression levels for annotating erythroid cells<sup><xref ref-type="bibr" rid="c42">42</xref></sup> <bold>(Supplementary Note 3)</bold>. However, SCellBOW CL6 is dominated by Erythroid cells with marginal interference from other cell types. In the case of Scanpy, no such cluster could be detected. Discerning phenotypic heterogeneity from the expression profiles of seemingly similar cells is a challenging task. The performance of SCellBOW, with near-ground-truth cell type annotation, in such a scenario confirmed its ability to adequately decipher the underlying cellular heterogeneity and provide robust cell type clustering.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 3.</label>
<caption><title>Evaluation of in-house splenocytes and matched PBMCs.</title>
<p>a, An experiment schematic diagram highlighting the sites of the organs for tissue collection and sample processing. In this matched PBMC-splenocyte CITE-seq experiment, PBMCs and splenocytes were collected, followed by high-throughput sequencing and downstream analyses.</p>
<p>b, The UMAP plots for the embedding of SCellBOW compared to different benchmarking methods. The coordinates of all the plots are colored by cell type annotation results using Azimuth. c-d, UMAP plots for SCellBOW embedding colored by donors (c) and cell types (d).</p>
<p>e-f, Alluvial plots for Azimuth cell types mapped to SCellBOW clusters (e) and Scanpy clusters</p>
<p>(f). The resolution of SCellBOW was set to 1.0. CL is used as an abbreviation for cluster. g, Bar plot for ARI, NMI, cell type SI at resolution 1.0.</p></caption>
<graphic xlink:href="522060v3_fig3.tif" mime-subtype="tiff" mimetype="image"/>
    <permissions>
        <copyright-statement>© 2024, BioRender Inc</copyright-statement>
        <copyright-year>2024</copyright-year>
        <copyright-holder>BioRender Inc</copyright-holder>
        <license><license-p>Any parts of this image created with <ext-link ext-link-type="uri" xlink:href="https://www.biorender.com/">BioRender</ext-link> are not made available under the same license as the Reviewed Preprint, and are © 2024, BioRender Inc.</license-p></license>
    </permissions>
</fig>
</sec>
<sec id="s2c">
<title>SCellBOW facilitates survival-risk attribution of tumor subpopulations</title>
<p>Every cancer features unique genotypic as well as phenotypic diversity, impeding the personalized management of the disease. Patient survival is arguably the most important clinical parameter to assess the utility of clinical interventions. The widespread adoption of genomics in cancer care has allowed correlating molecular portraits of tumors with patient survival in all major cancers. This, in turn, has broadened our understanding of the aggressiveness and impact of diverse molecular subtypes associated with a particular cancer type. Single-cell expression profiling of cancers allows the detection and characterization of tumor-specific malignant cell subtypes. This presents an opportunity to gauge the aggressiveness of each cancer cell subtype in a tumor. A few studies suggested that there is an association between the tumorigenicity of stromal cells in tumor microenvironments and patient survival<sup><xref ref-type="bibr" rid="c43">43</xref></sup>. This has sparked debate about the utility of gene expression in profiling single tumor cells. SCellBOW estimates the relative aggressiveness of different malignant cell subtypes using survival information as a surrogate. SCellBOW helps achieve this by enabling algebraic operations (subtraction or addition between two expression vectors or phenotypes) in the embedding space. We refer to this as <italic>phenotype algebra</italic>. We utilized this ability to find an association between the embedding vectors, representing <italic>total tumor</italic> – <italic>a specific malignant cell cluster</italic> with tumor aggressiveness. This immediately opens up a way to infer the level of aggressiveness of a particular cluster of cancer cells obtained through single-cell clustering. Subtracting an aggressive phenotype from the whole tumor (average of SCellBOW embeddings across all malignant cells in a tumor) would better the odds of survival relative to dropping a subtype under negative selection pressure.</p>
<p>As proof of concept, we first validated our approach on glioblastoma multiforme (GBM), which has been studied widely employing single-cell technologies. GBM has three well-characterized malignant subtypes: proneural (PRO), classical (CLA), and mesenchymal (MES)<sup><xref ref-type="bibr" rid="c44">44</xref>,<xref ref-type="bibr" rid="c45">45</xref></sup>. We obtained known markers of PRO, CLA, and MES to annotate 4,508 malignant GBM cells obtained from a single patient reported by Couturier and colleagues<sup><xref ref-type="bibr" rid="c46">46</xref></sup> and used it as our target data (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>, <bold>Supplementary Methods 2.1</bold>). As the source data, we used the GBM scRNA-seq data from Neftel <italic>et al.</italic><sup><xref ref-type="bibr" rid="c47">47</xref></sup>. The survival data consisted of 613 bulk GBM samples with paired survival information from the TCGA consortium. We constructed the following query vectors for the survival prediction task: <italic>total tumor</italic>, i.e., average of embeddings of all malignant cells, <italic>total tumor</italic> – (MES+CLA), <italic>total tumor</italic> – MES/CLA/PRO (individually). We conjectured that for the most aggressive malignant cell subtype, <italic>total tumor – subtype specific pseudo-bulk</italic>, would yield the biggest drop in survival risk relative to the <italic>total tumor</italic>. Survival risk predictions associated with <italic>total tumor</italic> – MES/CLA/PRO thus obtained reaffirmed the clinically known aggressiveness order, i.e., CLA &gt;-MES &gt;-PRO, where CLA succeeds the rest of the subtypes in aggressiveness<sup><xref ref-type="bibr" rid="c48">48</xref></sup> (<xref rid="fig4" ref-type="fig">Fig. 4c, d</xref>). More complex queries can be formulated, such as <italic>total tumor</italic> – (MES+CLA), which indicates that the tumor does not comprise the two most aggressive phenotypes, CLA and MES, and instead consists only of PRO cells. Hypothetically, this represents the most favorable scenario, as testified by the <italic>phenotype algebra</italic><sup><xref ref-type="bibr" rid="c45">45</xref>,<xref ref-type="bibr" rid="c49">49</xref></sup>.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 4.</label>
<caption><title>Subclonal survival risk inference.</title>
<p>a, UMAP plot for the embedding of BRCA target dataset colored by PAM50 molecular subtype.</p>
<p>b, Heatmap for GSVA score for three molecular subtypes of GBM: CLA, MES, and PRO, grouped by SCellBOW clusters at resolution 1.0.</p>
<p>c, Survival plot for BRCA molecular subtypes based on <italic>phenotype algebra</italic>. The <italic>total tumor</italic> is denoted by <italic>T</italic>.</p>
<p>d, Violin plot for predicted risk scores for BRCA molecular subtypes.</p>
<p>e, Survival plot for GBM molecular subtypes based on <italic>phenotype algebra</italic>. f, Violin plot for predicted risk scores for GBM molecular subtypes.</p></caption>
<graphic xlink:href="522060v3_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>We performed a similar benchmarking on well-established PAM50-based<sup><xref ref-type="bibr" rid="c50">50</xref></sup> breast cancer (BRCA) subtypes: luminal A (LUMA), luminal B (LUMB), HER2-enriched (HER2), basal-like (BASAL), and normal-like (NORMAL) (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>). We used 24,271 cancer cells from Wu <italic>et al.</italic><sup><xref ref-type="bibr" rid="c51">51</xref></sup> as the source data, 545 single-cell samples from Zhou <italic>et al.</italic><sup><xref ref-type="bibr" rid="c52">52</xref>,<xref ref-type="bibr" rid="c53">53</xref></sup> as the target data. We used 1,079 bulk BRCA samples with paired survival information from TCGA as the survival data. SCellBOW-predicted survival risks for the different subtypes were generally in agreement with the clinical grading of the PAM50 subtypes<sup><xref ref-type="bibr" rid="c54">54</xref>,<xref ref-type="bibr" rid="c55">55</xref></sup>. Exclusion of LUMA from <italic>total tumor</italic> yielded the highest risk score, indicating that LUMA has the best prognosis, followed by HER2 and LUMB, whereas BASAL and NORMAL were assigned worse prognosis<sup><xref ref-type="bibr" rid="c56">56</xref>–<xref ref-type="bibr" rid="c58">58</xref></sup> (<xref rid="fig4" ref-type="fig">Fig. 4e, f</xref>). We observed an interesting misalignment from the general perception about the relative aggressiveness of the NORMAL subtype-removal of this subtype from <italic>total tumor</italic> indicated the highest improvement in prognosis. The NORMAL subtype is a poorly characterized and rather heterogeneous category. Recent evidence suggests that these tumors potentially represent an aggressive molecular subtype and are often associated with highly aggressive claudin-low tumors<sup><xref ref-type="bibr" rid="c54">54</xref>,<xref ref-type="bibr" rid="c59">59</xref></sup>. These benchmarking studies on the well-characterized cancer subtypes of GBM and BRCA affirm SCellBOW’s capability to preserve the desirable characteristics in the resulting phenotypes obtained as outputs of algebraic expressions involving other independent phenotypes and operators such as +/–. To further validate the efficiency of SCellBOW in learning single-cell latent representation, we have illustrated the effectiveness of fixed-length embeddings obtained from SCellBOW for <italic>phenotype algebra</italic> compared to other methods-scETM, scBERT, and scPhere (<bold>Supplementary Fig. 6 and Supplementary Note 4</bold>). Our results showed that SCellBOW learned latent representation of single-cells accurately captures the’semantics’ associated with cellular phenotypes and allows algebraic operations such as’+’ and’–’. Whereas scETM, scBERT, and scPhere fail to stratify cancer clones in terms of their aggressiveness and contribution to disease prognosis.</p>
</sec>
<sec id="s2d">
<title>SCellBOW enables pseudo-grading of metastatic prostate cancer cells</title>
<p>In prostate cancer, the processes of transdifferentiation and dedifferentiation are vital in metastasis and treatment resistance<sup><xref ref-type="bibr" rid="c60">60</xref></sup> (<xref rid="fig5" ref-type="fig">Fig. 5</xref><bold>)</bold>. Prostate cancer originates from secretory prostate epithelial cells, where AR, a transcription factor regulated by androgen, plays a key role in driving the differentiation<sup><xref ref-type="bibr" rid="c61">61</xref>,<xref ref-type="bibr" rid="c62">62</xref></sup>. Androgen-targeted therapies (ATTs) constitute the primary treatment options for metastatic prostate cancer, and they are most effective in well-differentiated prostate cancer cells with high AR activity<sup><xref ref-type="bibr" rid="c63">63</xref></sup>. After prolonged treatment with ATTs, the cancers eventually progress towards metastatic castration-resistant prostate cancer (mCRPC), which is highly recalcitrant to therapy<sup><xref ref-type="bibr" rid="c64">64</xref></sup>. In response to more potent ATTs, the prostate cancer cells adapt to escape reliance on AR with low AR activity<sup><xref ref-type="bibr" rid="c65">65</xref></sup>. The loss of differentiation pressure results in altered states of lineage plasticity in prostate tumors<sup><xref ref-type="bibr" rid="c66">66</xref>,<xref ref-type="bibr" rid="c67">67</xref></sup>. The most well-defined form of treatment-induced plasticity is neuroendocrine transformation. NEPC is highly aggressive that often manifests with visceral metastases, and currently lacks effective therapeutic options<sup><xref ref-type="bibr" rid="c66">66</xref>,<xref ref-type="bibr" rid="c68">68</xref></sup>. Recent studies have pointed toward the existence of additional prostate cancer phenotypes that emerge through lineage plasticity and metastasis of malignant cells<sup><xref ref-type="bibr" rid="c14">14</xref></sup>. This includes malignant phenotypes such as low AR signaling and DNPC, which lack AR activity and NE features. These additional phenotypes, resulting from the mechanisms of resistance to AR inhibition, can likewise be characterized by distinct gene expression patterns. Presumably, these phenotypes represent an intermediate or transitory state of the progression trajectory from high AR activity to neuroendocrine transdifferentiation<sup><xref ref-type="bibr" rid="c69">69</xref></sup>.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 5.</label>
<caption><title>Phenotype algebra of metastatic prostate cancer data based on AR-and NE-activity.</title>
<p>a, Schematic of the transdifferentiation states underlying lineage plasticity that occurs during mCRPC progression from an ARPC to NEPC.</p>
<p>b, Scatter plot of GSVA scores of ARPC and NEPC gene sets, K-means clustering was used to allocate cells into the three high-level ARAH, ARAL, and NEPC categories.</p>
<p>c, UMAP plot for projection of SCellBOW embedding colored by ARAH, ARAL, and NEPC.</p>
<p>d, Heatmap showing the top differentially expressed genes (y-axis) between each high-level category (x-axis) and all other cells, tested with a Wilcoxon rank-sum test.</p>
<p>e, Survival plot for mCRPC phenotypes based on <italic>phenotype algebra</italic>. The t<italic>otal tumor</italic> is denoted by <italic>T</italic>.</p>
<p>f, Violin plot for predicted risk scores for mCRPC phenotypes-ARAH, ARAL, and NEPC.</p>
</caption>
<graphic xlink:href="522060v3_fig5.tif" mime-subtype="tiff" mimetype="image"/>
    <permissions>
        <copyright-statement>© 2024, BioRender Inc</copyright-statement>
        <copyright-year>2024</copyright-year>
        <copyright-holder>BioRender Inc</copyright-holder>
        <license><license-p>Any parts of this image created with <ext-link ext-link-type="uri" xlink:href="https://www.biorender.com/">BioRender</ext-link> are not made available under the same license as the Reviewed Preprint, and are © 2024, BioRender Inc.</license-p></license>
    </permissions>
</fig>
<p>Here, we performed a pooled analysis of scRNA-seq target data consisting of 836 malignant cells derived from tumors collected from 11 tumors (mCRPC)<sup><xref ref-type="bibr" rid="c70">70</xref></sup>. We initially classified cells into three categories-AR activity high (AR+/NE–, ARAH), AR activity low (AR<sub>low</sub>/NE–, ARAL), and neuroendocrine (AR–/NE+, NE). The classification was based on the known molecular signatures associated with ARPC and NEPC genes<sup><xref ref-type="bibr" rid="c69">69</xref></sup> (<xref rid="fig5" ref-type="fig">Fig. 5b</xref>, <bold>Supplementary Methods 2.2</bold>). We used the pre-trained model built on the Karthaus <italic>et al.</italic><sup><xref ref-type="bibr" rid="c32">32</xref></sup> dataset for transfer learning. We used 81 advanced metastatic prostate cancer patient samples with paired survival information from Abida <italic>et al.</italic><sup><xref ref-type="bibr" rid="c23">23</xref></sup> as the survival data. We subsequently assessed the relative aggressiveness of these high-level categories using <italic>phenotype algebra</italic> (<xref rid="fig5" ref-type="fig">Fig. 5e, f</xref>). We observed that subtracting the latent signature associated with the NE subtype from the tumor led to the largest drop in the predicted risk score, aligning with the anticipated order of survival<sup><xref ref-type="bibr" rid="c71">71</xref></sup>. In contrast, removing the ARAH subtype from the <italic>total tumor</italic> had a minimal impact on the predicted risk score. Furthermore, subtracting the ARAL subtype resulted in a predicted risk score between ARAH and NE, which supports the hypothesis that ARAL represents an intermediate state between ARAH and NE<sup><xref ref-type="bibr" rid="c69">69</xref></sup>. Upon further examination of the tumor prognosis by removing the subtypes in a combined state (ARAH+ARAL+NE), the <italic>total tumor</italic> had the highest positive improvement. The survival probability graph also followed the same order.</p>
<p>Grouping prostate cancer cells into three high-level categories is an oversimplified view of the actual heterogeneity of advanced prostate cancer biology. Herein, SCellBOW clusters could be utilized to discover novel subpopulations based on the single-cell expression profiles that result from therapy-induced lineage plasticity. Subsequently, <italic>phenotype algebra</italic> can assign a relative rank to these clusters under a negative selection pressure based on their aggressiveness. We utilized this concept to cluster the malignant cells from He <italic>et al.</italic> using SCellBOW, resulting in eight clusters, and then we predicted the relative risk for each cluster (<xref rid="fig6" ref-type="fig">Fig. 6a, b</xref>). This approach enables a novel and more refined understanding of lineage plasticity states and characteristics that determine aggressiveness during prostate cancer progression. This goes beyond the conventional categorization into ARAH, ARAL, and NE.</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 6.</label>
<caption><title>Phenotype algebra of metastatic prostate cancer data based on SCellBOW clusters.</title>
<p>a, UMAP plot for projection of embeddings with coloring based on the SCellBOW clusters at resolution 0.8. CL is used as an abbreviation for cluster.</p>
<p>b, Violin plot of <italic>phenotype algebra</italic>-based cluster-wise risk scores for SCellBOW clusters based on <italic>phenotype algebra</italic>-based predictions.</p>
<p>c, Illustration of the distribution of cells from the three high-level groups-ARAH, ARAL, and NEPC across the SCellBOW clusters.</p>
<p>d, Patient and organ site distribution across the SCellBOW clusters.</p>
<p>e, Bubble plot of row-scaled GSVA scores for custom curated gene sets containing activated and repressed AR-and NE-signatures.</p>
<p>f, Correlation plot of six phenotypic categories based on DSP gene expression correlated with the SCellBOW clusters based on scRNA-seq gene expression. The six phenotypic categories are defined by Brady <italic>et al.</italic> based on the activity of AR and NE programs.</p>
<p>g, Top gene sets correlated with SCellBOW clusters. Signatures were collected from the C2 ‘‘curated’’, C5 ‘‘Gene Ontology’’, and H ‘‘hallmark’’ gene sets from mSigDB<sup><xref ref-type="bibr" rid="c94">94</xref></sup>. Ranking by row scaled GSVA scores of one cluster against all others.</p></caption>
<graphic xlink:href="522060v3_fig6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To further elucidate these altered cellular programs, we performed a gene set variation analysis (GSVA)<sup><xref ref-type="bibr" rid="c72">72</xref></sup> based on the AR-and NE-activity (<xref rid="fig6" ref-type="fig">Fig. 6e</xref>, <bold>Supplementary Methods 3, and Supplementary Data 1</bold>). Our result showed that CL4 is characterized by the highest expression of NE-associated genes and the absence of AR-regulated genes, indicating the conventional NEPC subtype. Despite CL4 having the strongest NEPC signatures, eliminating CL2 from the tumor conferred an even higher aggressiveness level. Overall, we observed that, unlike other clusters, CL2 is composed of cells from the majority of drug-treated patients and multiple metastatic sites (<xref rid="fig6" ref-type="fig">Fig. 6d</xref>). This highlights that the clustering is not confounded by the individuals or the tissue origin, as often observed during integrative analysis of tumor scRNA-seq data. CL2 instead features a unique gene expression profile common to these cells. Moreover, CL2 has a mixed signature entailing ARAH, ARAL, and NE, indicating the emergence of a more transdifferentiated subtype as a consequence of therapy-induced lineage plasticity (<xref rid="fig6" ref-type="fig">Fig. 6c</xref>). Even though CL2 shows NE signature, it is distinguished by the gene expression signature induced by the inactivation of the androgen signaling pathway due to ATTs. As a consequence, cells manifesting this novel signature are grouped into a single cluster. Among all clusters, CL1 and CL3 resemble the traditional ARAH subtype. According to our <italic>phenotype algebra</italic> model, excluding CL6 and CL7 from the <italic>total tumor</italic> yielded the highest risk score. Brady <italic>et al.</italic><sup><xref ref-type="bibr" rid="c13">13</xref></sup> have broadly partitioned metastatic prostate cancer into six phenotypic categories using digital spatial profiling (DSP) transcript and protein abundance data in spatially defined metastasis regions. To categorize the SCellBOW clusters into these broad phenotypes, we performed Pearson’s correlation test between averaged DSP expression measurements of the six phenotypes and averaged scRNA-seq expression of the SCellBOW clusters (<xref rid="fig6" ref-type="fig">Fig. 6f</xref>). The results revealed that CL2 has the highest correlation with the phenotype defined by lack of expression of AR signature genes and low or heterogeneous expression of NE-associated genes (AR–/NE<sub>low</sub>). Similarly, as expected, CL4 showed the highest correlation with the NEPC phenotype defined by positive expression of NE-associated genes without AR activity (AR–/NE+). Meanwhile, CL6 exhibits a closer resemblance to a DNPC phenotype (AR–/NE–).</p>
<p>To gain a deeper understanding of these modified cellular processes in CL2 compared to other clusters, we conducted cluster-wise functional GSVA based on the hallmarks of cancer (<xref rid="fig6" ref-type="fig">Fig 6g</xref>). We observed that CL2 exhibited the least prostate cancer signature, indicating that this cluster has deviated from prototypical prostate cancer behavior. It has rather dedifferentiated into a more aggressive phenotype as a consequence of therapy-induced lineage plasticity<sup><xref ref-type="bibr" rid="c73">73</xref></sup>. CL2 exhibited the highest enrichment of genes related to cancer stemness compared to other clusters. CL2 showed pronounced repression of epithelial genes that are downregulated during the epithelial-to-mesenchymal transition (EMT). Furthermore, there is a lack of expression of genes that are upregulated during the reversion of mesenchymal to epithelial phenotype (MET). Thus, the cells in CL2 are undergoing a process of dedifferentiation from being epithelial cells and activating the mesenchymal gene networks. Existing studies have reported that adaptive resistance is positively correlated with the acquisition of mesenchymal traits in cancer<sup><xref ref-type="bibr" rid="c74">74</xref>,<xref ref-type="bibr" rid="c75">75</xref></sup>. CL2 was enriched with signatures associated with metastasis and drug resistance. Specifically, CL2 showed downregulation of the genes involved in drug metabolism and cellular response while upregulation of the genes associated with drug resistance. In cancer cells, the acquisition of stemness-like as well as cell dedifferentiation (mesenchymal) traits can facilitate the formation of metastases and lead to the development of drug resistance<sup><xref ref-type="bibr" rid="c76">76</xref></sup>. Further analysis of the metastatic potential of CL2 indicated that the cluster is enriched with genes associated with vasculature and angiogenesis. Tumors induce angiogenesis in the veins and capillaries of the host tissue to become vascularized, which is crucial for their growth and metastasis<sup><xref ref-type="bibr" rid="c77">77</xref></sup>. Thus, based on our findings, we anticipate that CL2 corresponds to a highly aggressive and dedifferentiated subclone of mCRPC within the lineage plasticity continuum, correlating to poor patient survival and positive metastatic status. Our cluster-wise <italic>phenotype algebra</italic> results imply that the traits of the androgen and neuroendocrine signaling axes are not the exclusive defining features of the predicted risk ranking and that other yet under-explored biological programs play additional important roles.</p>
</sec>
</sec>
<sec id="s3">
<title>Overall discussion</title>
<p>In this work, we introduce SCellBOW, a scRNA-seq analysis framework inspired by NLP-based transfer learning approach that can be utilized to decipher molecular heterogeneity from scRNA-seq profiles and infer survival risks associated with the individual malignant subpopulations in tumors. In this novel approach, cells are treated as a bag-of-molecules, similar to representing a document as a “bag” of words (BOW), representing molecules in proportion to their abundance within each cell. SCellBOW uses a document embedding architecture to preserve the cellular similarities observed in the gene expression space. SCellBOW-learned neuronal weights are transferable. The model can use the knowledge acquired from a source dataset to warm start the learning process on a target dataset. Although Doc2vec is not commonly used for transfer learning, our experiments, which involve repurposing a pre-trained, modified Doc2vec model for scRNA-seq analysis, establish promising use cases for transfer learning (<bold>Supplementary Fig. 7 and Supplementary Note 5</bold>).</p>
<p>SCellBOW accomplishes two major tasks: a. single-cell representation learning under a transfer learning framework facilitating high-quality cell clustering and visualization of scRNA-seq profiles. b. <italic>phenotype algebra</italic>, enabling the attribution of survival risk to malignant cell clusters obtained from tumor scRNA-seq data. For both tasks, we compared SCellBOW with several state-of-the-art single-cell analysis tools, including ones based on complex language modeling architectures (e.g., scETM uses a topic model, scBERT uses a transformer-inspired model). SCellBOW exhibited consistency in characterizing cellular heterogeneity through clustering and survival risk (aggressiveness) stratification of malignant cell subtypes.</p>
<p>With the SCellBOW, we observe considerable improvement in the quality of clustering and <italic>phenotype algebra</italic> results obtained from scRNA-seq target datasets. The existing single-cell transfer learning tools, such as scETM, ItClust, and scBERT, are pre-trained on large amounts of pre-annotated single-cell data to achieve good performance. However, using source data annotations as a reference limits the identification of new cell types in the target data. Moreover, the degree of imbalance in the cell type distribution substantially influences the performance of these tools<sup><xref ref-type="bibr" rid="c78">78</xref></sup>. It is important to realize that exploratory studies involving single-cell expression profiling require unsupervised data analysis. SCellBOW addresses these challenges by allowing self-supervised pre-training on gene expression datasets, learning the general syntax and semantic patterns from the unlabelled scRNA-seq dataset. Additionally, it is less susceptible to overfitting<sup><xref ref-type="bibr" rid="c79">79</xref></sup>, especially with small training datasets, owing to the shallow neural network used in SCellBOW, which enables faster convergence compared to other studied transfer learning methods (<bold>Supplementary Table 5</bold>). Notably, SCellBOW, unlike ItClust and scETM, does not limit model training to genes intersecting between the source and the target datasets and is independent of the source data cell type annotation. Moreover, while methods such as scETM, ItClust, and scBERT utilize numerical gene expression values directly as an input to their network architectures, SCellBOW, for the first time, encodes gene expression profiles into documents in their native format.</p>
<p>We compared the clustering capability of SCellBOW to popular single-cell analysis techniques as well as some recently proposed transfer learning approaches. An array of scRNA-seq datasets was used for the same, representing different sizes, cell types, batches, and diseases. As evident from the comparative analyses, SCellBOW exhibits robustness and consistency across all data and metrics. We also reported tangible benefits of transfer learning from apt source data. For example, transfer learning with a large number of tumor-adjacent normal cells from the prostate as the source and healthy prostate cells as the target adequately portrayed the cell type diversity therein. SCellBOW reliably clustered pancreatic islet-specific cells that were processed using varied single-cell technologies. The prevalence of single-cell expression profiling and the heterogeneity of PBMCs make it one of the best-studied tissue systems in humans<sup><xref ref-type="bibr" rid="c80">80</xref></sup>. We isolated matched PBMCs and splenocytes from two healthy donors and two brain-dead donors (the cause of death is subarachnoid hemorrhage on aneurysm rupture). The utilization of this data presents a more intricate problem, where the cells originate from diverse biological and technical replicates, conditions, individuals, and organs. SCellBOW-based analysis of PBMCs with near-ground-truth cell type annotation confirmed its ability to adequately decipher underlying cellular heterogeneity. Our results allude to a visible improvement in scRNA-seq analysis outcomes, even with small sample sizes and multiple covariates, when contrasted with other best-practice single-cell clustering methods.</p>
<p>Beyond robust identification of cell type clusters, SCellBOW uses algebraic operations to analyze the cellular phenotypes that could potentially identify their contribution to patient survival outcomes. We have leveraged the power of word algebra through document embeddings to perform pseudo-grading of cancer subtypes based on their aggressiveness. This involves comparing the likelihood of a subtype being eliminated from the entire tumor under negative selection pressure. In addition to overall survival probability, SCellBOW assigns a risk score to discern the differences between equally aggressive subclones that may be hard to decipher from their survivability profiles. The <italic>phenotype algebra</italic> module exhibits resilience in describing the risk associated with malignant cell subpopulations arising from various types of cancer, which otherwise cannot be accomplished using gene expression data (<bold>Supplementary Fig. 8</bold>h-j). We demonstrated a potential use case in estimating subclonal survival risk in three cancer types: GBM, BRCA, and mCRPC. Several examples were shown where simple algebraic operators such as’+’ and’–’ could derive clinically intuitive outcomes. For example, subtracting the CLA phenotype from the whole tumor resulted in an improvement in the survival risk in a GBM patient compared to MES and PRO subtypes. Upon further probing of the tumor prognosis by removal of the subtypes in combinations from the tumor, specifically CLA and MES subtypes, which are known to be the most aggressive, we observed the highest improvement. To summarize, SCellBOW allows simulations involving multiple phenotypes. Our subsequent investigation focused on a BRCA dataset that harbors a more complex subtype structure. We observed a deviance in our results from the general perception about the relative aggressiveness of the NORMAL subtype in breast cancer. Notably, removing the NORMAL subtype from the <italic>total tumor</italic> was associated with the highest improvement in prognosis. This contradicts the common assumption that a NORMAL subtype is an artifact resulting from a high proportion of normal cells in the tumor specimen<sup><xref ref-type="bibr" rid="c81">81</xref></sup>. Despite indications that these tumors often do not respond to neoadjuvant chemotherapy<sup><xref ref-type="bibr" rid="c58">58</xref></sup>, the clinical significance of the NORMAL subtype remains uncertain due to a limited number of studies. The NORMAL breast cancer cells are poorly characterized and heterogeneous in nature. As per the recent classification of the breast cancer subtypes, the NORMAL subtype has been identified to be a potentially aggressive molecular subtype, referred to as claudin-low tumors<sup><xref ref-type="bibr" rid="c59">59</xref></sup>. This evidence suggests that the NORMAL subtype of breast cancer is potentially an aggressive molecular subtype, which is consistent with the prediction made by SCellBOW.</p>
<p>In advanced metastatic prostate cancer, molecular subtypes are still poorly defined, and characterizing novel or more fine-grained subtypes with clinical implications on patient prognosis is an active field of research. As a proof-of-concept, we executed SCellBOW on the three mCRPC subtypes, namely ARAH, ARAH, and NE. We observed that eliminating the subtypes individually and in combinations (ARAH+ARAL+NE) exhibited a clinically intuitive change in prognosis using SCellBOW. To date, mCPRC classification has largely been confined to the gradients of AR and NE activities. There is considerable scope for embracing more fine-grained subtypes to better explain clonal selection and epithelial plasticity in drug resistance in wider use cases. Convinced by the overall performance of SCellBOW, we applied <italic>phenotype algebra</italic> on the SCellBOW clusters obtained from the He et al. mCRPC dataset<sup><xref ref-type="bibr" rid="c70">70</xref></sup>. We observed a misalignment from the general perception that the neuroendocrine subtype features the worst prognosis. Our results pointed towards the existence of a more aggressive and dedifferentiated subclone in the lineage plasticity continuum. This subpopulation of de-differentiated cells in mCRPC, AR−/NE<sub>low</sub>, exhibit greater aggressiveness and have distinct gene expression patterns that do not match those of any previously identified molecular subtypes. This novel subclone shares gene expression signatures with both androgen-repressed and neuroendocrine-activated genes. GSVA analysis of this hitherto unknown phenotype offered insights into its putative functional characteristics, which can be broadly defined by stemness, EMT, MET, and drug resistance. To summarize, SCellBOW clustering combined with <italic>phenotype algebra</italic> can provide novel insights into factettes of cancer biology. This can be used to delineate features of lineage plasticity and aid in better classification of molecular phenotypes with clinical significance. Once the subpopulations are identified, delving into the intricate mechanisms governing their resistant behavior can provide invaluable insights into for designing new drugs. Further, such a tool can empower medical oncologists and oncology researchers to develop more personalized and systemic treatment regimes for cancer patients.</p>
</sec>
<sec id="s4">
<title>Conclusion</title>
<p>SCellBOW is a scRNA-seq analysis tool that can be utilized to decipher molecular heterogeneity from scRNA-seq profiles and infer survival risks associated with the individual malignant subpopulations in tumors. Our main contributions are as follows: a. We proposed SCellBOW that learns a distributed representation (fixed-length embedding per cell) of single-cells. Despite being a computationally inexpensive and simple architecture, SCellBOW outperforms transformer-based approaches such as scBERT on both single-cell clustering and cancer cell risk stratification tasks. b. We also introduced the malignant cell “pseudo-grading” task as a computationally tractable problem. The pseudo-grading module of SCellBOW performs joint representation learning of externally sourced tumor bulk RNA sequencing data (e.g., TCGA) and tumor scRNA-seq data of interest. Finally, a survival prediction model trained on bulk expression profiles is used for survival risk stratification for each of the malignant cell clusters derived from the tumor scRNA-seq data. We compared SCellBOW with existing best practice methods for its ability to precisely represent phenotypically divergent cell types across multiple scRNA-seq datasets, including an in-house generated human splenocyte and matched PBMC dataset. SCellBOW has proven effective in characterizing poorly defined metastatic prostate cancer. We identified a subpopulation of dedifferentiated cells in mCRPC, AR−/NElow, that exhibit greater aggressiveness and have distinct gene expression patterns that do not match those of any previously identified molecular subtypes. We could trace this back in a large-scale spatial omics atlas of 141 well-characterized metastatic prostate cancer samples at the spot resolution. In the case of breast cancer, our results indicated that the normal-like subtype, which was previously considered an artifact of high normal cell content in the tumor sample, may be among the most aggressive ones, which is concordant with recent reports. In conclusion, the robust clustering and risk-stratification capabilities of SCellBOW hold promise for tailored therapeutic interventions by identifying clinically relevant subpopulations and their impact on prognosis.</p>
</sec>
<sec id="s5">
<title>Material and methods</title>
<sec id="s5a">
<title>Overview of SCellBOW components and functionalities</title>
<p>SCellBOW has two main applications: <bold>a. <italic>Cell embedding and clustering.</italic></bold> In this work, we demonstrat single-cell representation learning using a source and target scRNA-seq data. The source data is typically any large scRNA-seq data capable of priming a neural architecture for improved representation learning on the target data of interest. Note that in this case, cells in the source or the target data need not be annotated. This transfer learning capability is meant to obtain improved fixed-length embeddings for cells in the target data by leveraging the transcriptomic patterns from existing datasets. <bold>b. <italic>Malignant cluster specific survival risk attribution.</italic></bold> This feature is only applicable to malignant cell clusters. SCellBOW’s <italic>phenotype algebra module</italic> predicts the aggressiveness associated with each malignant cell cluster. SCellBOW computes fixed-length embeddings jointly for scRNA-seq target dataset (from the tumor under study) and tumor bulk RNA-seq profiles with patient-survival data (e.g., TCGA). Notably, embeddings of transcriptomes from scRNA-seq target data and bulk RNA-seq survival data have been determined concurrently by recalibrating the pre-trained model. A survival prediction model trained on the bulk RNA-seq embeddings and patient-survival data is then tested on the embeddings of the target data to make predictions about the degree of aggressiveness exhibited by the tumor variants.</p>
<p>The steps involved in the above two tasks are depicted in <xref rid="fig1" ref-type="fig">Figure 1</xref> (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). The granular details involved in each of these steps can be found in the below subsections.</p>
</sec>
<sec id="s5b">
<title>Data preparation for clustering</title>
<p>SCellBOW follows the same preprocessing procedure for the source and target data. SCellBOW first filters the cells with less than 200 genes expressed and genes that are expressed in less than 20 cells. The thresholds may vary depending on the dimension of the dataset (<bold>Supplementary Table 2</bold>). After eliminating low-quality cells and genes, SCellBOW log-normalizes the gene expression data matrix. In the first step, CPM normalization is performed, where the expression of each gene in each cell is divided by the total gene expression of the cell, multiplied by 10,000. In the second step, the normalized expression matrix is natural-log transformed after adding one as a pseudo count. Highly variable genes are selected using the highly_variable_genes() function from the Scanpy package. SCellBOW performs a z-score scaling on the log-normalized expression matrix with the selected highly variable genes. SCellBOW can handle data in different formats, including UMI count, FPKM, and TPM. The UMI count data follow the same preprocessing procedure as above. SCellBOW skips the normalization step for TPM and FPKM since their lengths have been normalized.</p>
</sec>
<sec id="s5c">
<title>Creating a corpus from source and target data</title>
<p>The gene expression data matrix is analogous to the term-frequency matrix, which represents the frequency of different words in a set of documents. In the context of genomic data, a similar concept can be used to represent the expression level of a gene (words) in a set of cells (documents). Let <italic>E</italic> ∊ <italic>R</italic><sup><italic>G×C</italic></sup> be the gene expression matrix obtained from a scRNA-seq experiment, where each value <italic>E<sub>g,c</sub></italic> of the matrix indicates the expression value of a gene <italic>g</italic> ∊ <italic>G</italic> in a cell <italic>c</italic> ∊ <italic>C</italic> obtained after Scanpy preprocessing. SCellBOW generates embeddings by taking two input datasets: a source and a target data matrix. The source dataset contains the initial weights of the neural network model, while the target data contains the cells that require clustering or malignancy potential ranking. Before generating the embeddings, SCellBOW performs feature scaling on the data matrix, rescaling each feature to a range of [0, 10] as follows.
<disp-formula id="eqn1">
<graphic xlink:href="522060v3_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where scaling is applied to each entry with <italic>max</italic> = 10 and <italic>min</italic> = 0. This establishes the equivalence between term-frequency and gene expression matrix. Here, we consider that a specific gene is a word, and the expression of the gene in a cell corresponds to the number of copies of the word in a document. To scale the data matrix, we have used the MinMaxScaler() function from the scikit-learn package<sup><xref ref-type="bibr" rid="c82">82</xref></sup>. To create the corpus, SCellBOW duplicates the name of the expressed gene in a cell as many times as the gene is expressed. SCellBOW shuffles the genes in each cell to ensures a uniform distribution of genes across the cell, removing any positional bias within the dataset<sup><xref ref-type="bibr" rid="c19">19</xref></sup>. We verified that this randomization does not change the outcomes dramatically (<bold>Supplementary Fig. 9</bold>). The resulting gene names are treated as the words in the document. To build the vocabulary from a sequence of cells, a tag number is associated with each cell using the TaggedDocument() function in the Gensim package<sup><xref ref-type="bibr" rid="c83">83</xref></sup>. For each gene in the documents, a token is assigned using a module called tokenize with a word_tokenize() function in NLTK package<sup><xref ref-type="bibr" rid="c84">84</xref></sup> that splits gene names into tokens.</p>
</sec>
<sec id="s5d">
<title>The SCellBOW network</title>
<p>SCellBOW produces a low-dimensional fixed-length embedding of the single-cell transcriptome using transfer learning. The data matrix is transformed from <italic>E</italic>’ ∊ <italic>Z</italic><sup><italic>G×C</italic></sup> feature space to <italic>E</italic>&quot; ∊ <italic>R</italic><italic><sup>d×C</sup></italic> latent feature space of d dimensions, with <italic>d</italic> « <italic>G</italic>. To generate the embeddings, SCellBOW trains a Doc2vec distributed memory model of paragraph vectors (PV-DM) model. The PV-DM model is similar to bag-of-words models in Word2vec<sup><xref ref-type="bibr" rid="c85">85</xref></sup>. The training corpus in Doc2vec contains a set of documents, each containing a sequence of words <italic>W</italic> = {<italic>w</italic><sub>l</sub>, <italic>w</italic><sub>2</sub>,.., <italic>w<sub>T</sub></italic>} that forms a vocabulary <italic>V</italic>. The words within each document are treated as shared among all documents. The training objective of the model is to maximize the probability of predicting the target word <italic>w<sub>t</sub></italic>, given the context words that occur within a fixed-size window of size <italic>n</italic> around <italic>w<sub>t</sub></italic> in the whole corpus as follows.
<disp-formula id="eqn2">
<graphic xlink:href="522060v3_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The probability can be modeled using the hierarchical softmax function as follows.
<disp-formula id="eqn3">
<graphic xlink:href="522060v3_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where each of <italic>y<sub>i</sub></italic> computes the log probability of the word <italic>w<sub>t</sub></italic> normalized by the sum of the log probabilities of all words in V. This is achieved by adjusting the weights of the hidden layer of a neural network. To build the Doc2vec model, we used the doc2vec() function in the Gensim library. The initial learning rate was set to 0.025, and the window size to 5. We chose the PV-DM training algorithm and set the embedding vector size to 300 as the default parameter. The choice of embedding vector size may be adjusted according to the size and dimensionality of the dataset.</p>
</sec>
<sec id="s5e">
<title>Fine-tuning using transfer learning</title>
<p>At first, SCellBOW is pre-trained with a source data matrix <italic>E’<sub>src</sub></italic> ∊ <italic>Z<sup>G<sub>src</sub>XC<sub>src</sub></sup></italic> with <italic>G<sub>src</sub></italic> genes and <italic>C<sub>src</sub></italic> cells. The source data matrix sets the initial weights of the neural network model. During transfer learning, SCellBOW fine-tunes the weights learned by the pre-trained model from <italic>E’<sub>src</sub></italic> using a target dataset <italic>E’<sub>trg</sub></italic> ∊ <italic>Z<sup>G<sub>trg</sub>XC<sub>trg</sub></sup></italic> with <italic>G<sub>trg</sub></italic> genes and <italic>C<sub>trg</sub></italic> cells. This facilitates faster convergence of the neural network compared to starting from randomly initialized weights. The output layer of the network is a fixed-length low-dimension embedding (a vector representation) for each cell <italic>c</italic> ∊ <italic>C<sub>trg</sub></italic>. To infer the latent structure of <italic>E<sub>trg</sub></italic> single-cell corpus, we used the infer_vector() function in the Gensim package to produce the dimension-reduced vectors for each cell in <italic>C<sub>trg</sub></italic>. This step ensures the network can map the target data into a low dimensional embedding space <italic>R<sup>d</sup></italic>; i.e., <italic>E’</italic> ➔<italic>E&quot;</italic>,where <italic>E&quot;</italic> ∊ <italic>R<sup>d×C</sup></italic>. The resulting embeddings can be used for various downstream analyses of the single-cell data, such as clustering, visualization of cell types, and <italic>phenotype algebra</italic>.</p>
</sec>
<sec id="s5f">
<title>Visualization of SCellBOW clusters</title>
<p>SCellBOW maps the cells to low-dimensional vectors in such a way that two cells with similar gene expression patterns will have the least cosine distance between their inferred vectors.
<disp-formula id="eqn6">
<graphic xlink:href="522060v3_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
After generating low-dimensional embeddings for the cells, SCellBOW identifies the groups of cells with similar gene expression patterns. To determine the clusters, SCellBOW uses the Leiden algorithm<sup><xref ref-type="bibr" rid="c86">86</xref></sup> on the embedding matrix of the target dataset. We used the leiden() function in the Scanpy package with a default resolution of 1.0. The resolution might vary in the reported results depending on the dimension of the target dataset. To visualize the clusters within a two-dimensional space, SCellBOW uses the umap() function from the Scanpy library.</p>
</sec>
<sec id="s5g">
<title>Data preparation for phenotype algebra</title>
<p>To perform phenotype algebra, three independent datasets are required. Two of the three datasets are scRNA-seq datasets used for transfer learning (source and target data). SCellBOW preprocesses the source data matrix using the standard preprocessing steps. SCellBOW uses an additional bulk RNA-seq gene expression matrix (referred to as survival data). The samples are paired with survival information (e.g., vital status, days to follow-up, days to death). In the survival data, samples without follow-up time or survival status and samples with clinical information but no corresponding RNA-seq data were excluded. SCellBOW accounts for unequal cell distribution across different classes in the target data matrix. SCellBOW up samples the imbalanced target dataset by generating synthetic samples from the minority class. The value of the synthetic minority class sample is determined by interpolating between its neighboring cells from the same class. We used SMOTE<sup><xref ref-type="bibr" rid="c87">87</xref></sup> from the imblearn python library<sup><xref ref-type="bibr" rid="c88">88</xref></sup>. This confirms that the cell type proportions do not confound the output of phenotype algebra.</p>
</sec>
<sec id="s5h">
<title>Generating vectors for phenotype algebra</title>
<p>SCellBOW constructs different pseudo-bulk vectors from the target dataset. The vectors are constructed either based on the user-defined subtypes or SCellBOW clusters. These vectors are created by calculating the mean gene expression of cells belonging to each phenotype. SCellBOW first constructs a reference pseudo-bulk vector by taking the average of all malignant cells (<italic>total tumor</italic>). This accounts for the tumor in its entirety and acts as the reference for the relative ranking of the different groups. Similarly, for each group in the dataset, SCellBOW then constructs a query pseudo-bulk vector by taking the average gene expression of the cells in that individual group. SCellBOW can also perform addition or subtraction operations on the query vectors of two or more cellular phenotypes to evaluate their risk in a combined state such as <italic>T</italic>-(<italic>a</italic> + <italic>b</italic>), where <italic>T</italic> is the embedding for <italic>total tumor,</italic> a and b are the embeddings for query vectors of two distinct cellular phenotypes. Following this, SCellBOW concatenates the bulk RNA-seq data matrix and the reference and query vectors based on common genes. We used the concatenate() function in the AnnData python package<sup><xref ref-type="bibr" rid="c89">89</xref></sup>. The resulting combined dataset is then passed to the pre-trained model, which maps it to a lower-dimensional embedding space.</p>
</sec>
<sec id="s5i">
<title>Survival risk attribution</title>
<p>SCellBOW infers the survival probability and predicted risk score for the user-defined tumor subtypes and SCellBOW clusters. The survival risk of the different groups is predicted by fitting a random survival forest (RSF)<sup><xref ref-type="bibr" rid="c90">90</xref></sup> machine learning model with SCellBOW embeddings. At first, the RSF is trained with the survival information combined with bulk RNA-seq embeddings obtained from transfer learning. SCellBOW subtracts each query vector from the reference vector and fits the difference of these vectors as input to the RSF model to infer the survival probability <italic>S</italic>(<italic>t</italic>). The survival probability computes the probability of occurrence of an event beyond a given time point t as follows.
<disp-formula id="eqn4">
<graphic xlink:href="522060v3_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn5">
<graphic xlink:href="522060v3_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where T denotes the waiting time until the event occurs and f(x) is the probability density function for the occurrence of an event. SCellBOW computes the survival probability using the predict_survival_function() from the scikit-survival RandomSurvivalForest python package<sup><xref ref-type="bibr" rid="c91">91</xref></sup> with n_estimators = 1000.</p>
<p>In addition to survival probability, SCellBOW can estimate the relative aggressiveness of different malignant phenotypes by assigning a risk score for distinct groups. To infer the predicted risk score, SCellBOW first trains 50 bootstrapped RSF models using 80% of the training set for each iteration. The training data is sub-sampled using different seeds for every iteration. We used the predict() function from the scikit-survival package to compute the risk score of each of the input vectors. SCellBOW derives the median of the predicted risk score for each group from the 50 bootstrapped models. The <italic>phenotype algebra</italic> model assigns groups with shorter survival times a lower rank by considering all possible pairs of groups in the data. The groups with a lower predicted risk score after removal from the reference pseudo-bulk are considered more aggressive, as they are associated with shorter survival times.</p>
</sec>
<sec id="s5j">
<title>Description of datasets for model evaluation</title>
<p>To evaluate the performance of SCellBOW, we used fifteen publicly available scRNA-seq datasets and an in-house scRNA-seq dataset spanning different cell types, sizes, and diseases (<bold>Supplementary Table 2)</bold>. Four use cases were constructed to benchmark the clustering efficiency, each involving a pair of single-cell expression datasets. In the first use case, we used ∼120,300 non-cancerous human prostate cells from Karthaus <italic>et al.</italic><sup><xref ref-type="bibr" rid="c32">32</xref></sup> and ∼28,600 healthy prostate cells from Henry <italic>et al.</italic><sup><xref ref-type="bibr" rid="c33">33</xref></sup>. The second use case consisted of two PBMC datasets from Zheng <italic>et al.</italic><sup><xref ref-type="bibr" rid="c34">34</xref></sup> containing approximately 68,000 cells and 2,700 cells. For the third use case, we combined three independent batches of pancreatic islet cells from Baron <italic>et al.</italic><sup><xref ref-type="bibr" rid="c35">35</xref></sup>, Muraro <italic>et al.</italic><sup><xref ref-type="bibr" rid="c36">36</xref></sup>, and Wang <italic>et al.</italic><sup><xref ref-type="bibr" rid="c37">37</xref></sup>, with a total of 11,181 cells as the source data and 2,068 cells from Segerstolpe <italic>et al.</italic><sup><xref ref-type="bibr" rid="c38">38</xref></sup> as the target data. In the fourth use case, we used the Zheng <italic>et al.</italic> data containing approximately 68,000 cells as the source data and the in-house dataset isolated from matched spleen and PBMC samples from multiple patients as the target data.</p>
<p>To validate the accuracy of <italic>phenotype algebra</italic>, we constructed three use cases from publicly available tumor datasets comprising malignant cells from GBM, BRCA, and mCRPC patient tumors. Each instance involved a pair of single-cell expression datasets and a bulk RNA-seq dataset paired with clinical information. For ease of reference, we stick to the following nomenclature – a) the source data comprises the scRNA-seq dataset used for model pre-training, b) the target data comprises malignant cells under investigation, and c) the survival data comprises tumor bulk RNA-seq samples. In the case of GBM, we used two scRNA-seq datasets comprising approximately 12,074 cells and 4,508 cells obtained from Neftel <italic>et al.</italic><sup><xref ref-type="bibr" rid="c47">47</xref></sup> and Couturier <italic>et al.</italic><sup><xref ref-type="bibr" rid="c46">46</xref></sup>, respectively. In the case of BRCA, we retrieved triple-negative breast cancer scRNA-seq datasets from Wu <italic>et al.</italic><sup><xref ref-type="bibr" rid="c51">51</xref></sup> and Zhou <italic>et al.</italic><sup><xref ref-type="bibr" rid="c53">53</xref></sup> with approximately 24,271 cells and 545 malignant cells, respectively. In both the use cases, the bulk RNA-seq was obtained from TCGA (<ext-link ext-link-type="uri" xlink:href="https://portal.gdc.cancer.gov">https://portal.gdc.cancer.gov</ext-link>). In the third use case, we acquired author-annotated malignant cells from He <italic>et al.</italic><sup><xref ref-type="bibr" rid="c70">70</xref></sup>. A total of 836 malignant cells were derived from 11 patients and three metastasis sites: bone, lymph node, and liver. We retrieved 81 mCRPC bulk RNA-seq samples with paired survival from Abida <italic>et al.</italic><sup><xref ref-type="bibr" rid="c23">23</xref></sup>. We obtained the gene expression of 141 regions of interest determined by digital spatial gene expression profiling of mCRPC from Brady <italic>et al.</italic><sup><xref ref-type="bibr" rid="c13">13</xref></sup>. We used this data to correlate the He <italic>et al.</italic> scRNA-seq gene expression with the DSP gene expression of the six phenotypic categories based on the AR-and NE-activity: AR+/NE−, AR<sub>low</sub>/NE−, AR−/NE−, AR−/NE<sub>low</sub>, AR+/NE+, and AR−/NE+. Details of the datasets are described in <bold>Supplementary Methods (Supplementary Methods 1)</bold>.</p>
</sec>
<sec id="s5k">
<title>Isolation of matched PBMC and splenocyte samples</title>
<p>In this study, we isolated PBMC and splenocyte from four patients (two healthy donors, HD1 18 years old male and HD2 61 years old female; two brain-dead donors, BD1 57 years old female and BD2 58 years old female). PBMCs were isolated from blood after Ficoll gradient selection. Spleen tissue was mechanically dissociated and then digested with Collagenase and DNAseq. Splenocytes were finally isolated after Ficoll gradient selection. Splenocytes and PBMCs were stored in DMSO with 10% FBS in liquid nitrogen at the Biological Resource Centre for Biobanking (CHU Nantes, Hotel Dieu, Centre de Ressources Biologiques). This biocollection was authorized in May 2013 by the French Agence de la Biomedecine (PFS13-009).</p>
</sec>
<sec id="s5l">
<title>Library preparation</title>
<p>For the in-house dataset, we performed CITE-seq using Hashtag Oligos (HTO) to pool samples into a single 10X Genomics channel for scRNA-seq<sup><xref ref-type="bibr" rid="c92">92</xref></sup>. The HTO binding was performed following the specified protocol (Total-seq B). After thawing and cell washing, 1M cells were centrifuged and resuspended in 100uL PSE buffer (PBS/FBS/EDTA). Cells were incubated with 10ul human FcR blocking reagent for 10 min at 4°C. 1 uL of a Hashtag oligonucleotide (HTO) antibody (Biolegend) was then added to each sample and incubated at 4°C for 30 min. Cells were then washed in 1mL PSE, centrifuged at 500g for 5 min, and resuspended in 200uL PSE. Cells were stained with 2uL DAPI, 60uM filtered, and viable cells were sorted (ARIA). Cells were checked for counting and viability, then pooled and counted again. Cell viability was set to &lt; 95%. Cells of HD1 spleen were lost during the washing step and thus not used during further downstream processing. Cells were then loaded on one channel of Chromium Next Controller with a 3’ single-cell Next v3 kit. We followed protocol CG000185, Rev C, until the library generation stage. For the HTO library, we followed the protocol of the 10X genomics 3’ feature barcode kit (PN-1000079) to generate HTO libraries.</p>
</sec>
<sec id="s5m">
<title>Next-generation sequencing and post-sequencing quality control</title>
<p>We sequenced 310pM of pooled libraries on a NOVAseq6000 instrument with an S1(v1) flow-cell. The program was run as follows: Read1 29 cycles / 8 cycles (i7) /0 (i5)/Read2 93 cycles (Standard module, paired-end, two lanes). The FASTQ files were demultiplexed with CellRanger v3.0.1 (10X Genomics) and aligned on the GRCh38 human reference genome. We recovered a total of 6,296 cells with CellRanger, and their gene expression matrices were loaded on R.</p>
<p>We performed the downstream analysis of the in-house matched PBMC-splenocyte dataset in R using Seurat 4.0. For RNA and HTO quantification, we selected cell barcodes detected by both RNA and HTO. We demultiplexed the cells based on their HTO enrichment using the HTODemux() function in the Seurat R package with default parameters<sup><xref ref-type="bibr" rid="c27">27</xref>,<xref ref-type="bibr" rid="c93">93</xref></sup>. We subsequently eliminated doublet HTOs (maximum HTO countlJ&gt;lJ1) and negative HTOs. Singlets were used for further analysis, leaving 4,819 cells and 33,538 genes. We annotated each of the cell barcodes using HTO classification as PBMC and Spleen based on the origin of cells and HD1, HD2, BD1, and BD2 based on the patients (<bold>Supplementary Fig. 4</bold>). We performed automatic cell annotation using the Seurat-based Azimuth using human PBMC as the reference atlas<sup><xref ref-type="bibr" rid="c42">42</xref></sup> (<bold>Supplementary Note. 2)</bold>. We defined six major cell populations: B cells, CD4 T cells, CD8 T cells, natural killer (NK) cells, monocytes, and dendritic cells. We then manually verified the annotation based on the RNA expression of known marker genes (<bold>Supplementary Fig. 4</bold>d <bold>and Supplementary Table 4</bold>).</p>
</sec>
</sec>
<sec id="s6">
<title>Availability of data and materials</title>
<p>The in-house matched PBMC-splenocyte scRNA-seq expression data generated in this study is available in the GEO with accession number GSE221007. Details of the public datasets analyzed in this paper are described in <bold>Supplementary Table 2</bold>.</p>
<p>All source codes are available at GitHub <ext-link ext-link-type="uri" xlink:href="https://github.com/cellsemantics/SCellBOW">https://github.com/cellsemantics/SCellBOW</ext-link>.</p>
</sec>
<sec id="d1e1849" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e1999">
<label>Supplemental Data 1</label>
<media xlink:href="supplements/522060_file02.docx"/>
</supplementary-material>
<supplementary-material id="d1e2006">
<label>Result of differential expression analysis for the He et al. metastatic prostate cancer dataset. This file also includes information on custom genese</label>
<media xlink:href="supplements/522060_file03.xlsx"/>
</supplementary-material>
<supplementary-material id="d1e2013">
<label>Result of differential expression analysis for the in-house CITE-seq PBMC-spleen dataset.</label>
<media xlink:href="supplements/522060_file04.xlsx"/>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>DS acknowledges the support of the ihub-Anubhuti-iiitd Foundation set up under the NM-ICPS scheme of the DST. JP, AR, PS, and SF thank the biological resource centre for biobanking (CHU Nantes, Hôtel Dieu, Centre de Ressources Biologiques (CRB), Nantes, F-44093, France (BRIF: BB-0033-00040)) and the Genomics Core Facility GenoA, member of Biogenouest and France Genomique, and to the Bioinformatics Core Facility BiRD, member of Biogenouest and Institut Français de Bioinformatique (IFB) (ANR-11-INBS-0013) for the use of their resources and their technical support. Parts of the schematics were created with BioRender.com.</p>
</ack>
<sec id="s7">
<title>Author contributions</title>
<p>DS conceived the study with CCN. JP, Antoine Roquilly, PS, and CF contributed to the experimental design of the matched PBMC-splenocyte CITE-seq study. NB developed the SCellBOW python package and conducted data analyses with assistance from Anja Rockstroh and SSD. SSD and SKT assisted NB in model training. DS supervised the algorithm development. CCN supervised cancer-related analyses and interpretation. Anja Rockstroh supervised and performed specific data analysis and data interpretation tasks. Anja Rockstroh, HK, JP, GA, ML, and BGH assisted in the biological interpretation of results. DS, CCN, and ML supervised the entire study. All authors substantially contributed to manuscript writing and reviewing.</p>
</sec>
<sec id="s8">
<title>Conflict of interest</title>
<p>DS and GA are stockholders at CareOnco BioTech. Pvt. Ltd. The remaining authors declare no competing interests.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dentro</surname>, <given-names>S. C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Characterizing genetic intra-tumor heterogeneity across 2,658 human cancer genomes</article-title>. <source>Cell</source> <volume>184</volume>, <fpage>2239</fpage>–<lpage>2254.e39</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lawson</surname>, <given-names>D. A.</given-names></string-name>, <string-name><surname>Kessenbrock</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Davis</surname>, <given-names>R. T.</given-names></string-name>, <string-name><surname>Pervolarakis</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Werb</surname>, <given-names>Z</given-names></string-name></person-group>. <article-title>Tumour heterogeneity and metastasis at single-cell resolution</article-title>. <source>Nat. Cell Biol</source>. <volume>20</volume>, <fpage>1349</fpage>–<lpage>1360</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bhattacharya</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Nelson</surname>, <given-names>C. C.</given-names></string-name>, <string-name><surname>Ahuja</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Sengupta</surname>, <given-names>D</given-names></string-name></person-group>. <article-title>Big data analytics in singlelJcell transcriptomics: Five grand opportunities</article-title>. <source>Wiley Interdiscip. Rev. Data Min. Knowl. Discov</source>. <volume>11</volume>, (<year>2021</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kanev</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Tailoring the resolution of single-cell RNA sequencing for primary cytotoxic T cells</article-title>. <source>Nat. Commun</source>. <volume>12</volume>, <issue>569</issue> (<year>2021</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dagogo-Jack</surname>, <given-names>I.</given-names></string-name> &amp; <string-name><surname>Shaw</surname>, <given-names>A. T</given-names></string-name></person-group>. <article-title>Tumour heterogeneity and resistance to cancer therapies</article-title>. <source>Nat. Rev. Clin. Oncol</source>. <volume>15</volume>, <fpage>81</fpage>–<lpage>94</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pang</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Discovering Rare Genes Contributing to Cancer Stemness and Invasive Potential by GBM Single-Cell Transcriptional Analysis</article-title>. <source>Cancers</source> <volume>11</volume>, (<year>2019</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poonia</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Marker-free characterization of full-length transcriptomes of single live circulating tumor cells</article-title>. <source>Genome Res</source>. <volume>33</volume>, <fpage>80</fpage>–<lpage>95</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chapman</surname>, <given-names>A. R.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Correlated gene modules uncovered by high-precision single-cell transcriptomics</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>119</volume>, <fpage>e2206938119</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Simeonov</surname>, <given-names>K. P.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Single-cell lineage tracing of metastatic cancer reveals selection of hybrid EMT states</article-title>. <source>Cancer Cell</source> <volume>39</volume>, <fpage>1150</fpage>–<lpage>1162.e9</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Tickle</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Tirosh</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Georgescu</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Brown</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Haas</surname>, <given-names>B.</given-names></string-name></person-group> <source>inferCNV of the Trinity CTAT Project. Klarman Cell Observatory, Broad Institute of MIT and Harvard</source>, <publisher-loc>Cambridge, MA, USA</publisher-loc>. Preprint at (<year>2019</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weinstein</surname>, <given-names>J. N.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The Cancer Genome Atlas Pan-Cancer analysis project</article-title>. <source>Nat. Genet</source>. <volume>45</volume>, <fpage>1113</fpage>– <lpage>1120</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beltran</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Divergent clonal evolution of castration-resistant neuroendocrine prostate cancer</article-title>. <source>Nat. Med</source>. <volume>22</volume>, <fpage>298</fpage>–<lpage>305</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brady</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Inter-and intra-tumor heterogeneity of metastatic prostate cancer determined by digital spatial gene expression profiling</article-title>. <source>Nat. Commun</source>. <volume>12</volume>, <fpage>1426</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Mesenchymal and stem-like prostate cancer linked to therapy-induced lineage plasticity and metastasis</article-title>. <source>Cell Rep</source>. <volume>39</volume>, <issue>110595</issue> (<year>2022</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chawla</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Gene expression based inference of cancer drug sensitivity</article-title>. <source>Nat. Commun</source>. <volume>13</volume>, <fpage>5680</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nunez</surname>, <given-names>J.-J.</given-names></string-name>, <string-name><surname>Leung</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Ho</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Bates</surname>, <given-names>A. T.</given-names></string-name> &amp; <string-name><surname>Ng</surname>, <given-names>R. T</given-names></string-name></person-group>. <article-title>Predicting the Survival of Patients With Cancer From Their Initial Oncology Consultation Document Using Natural Language Processing</article-title>. <source>JAMA Netw Open</source> <volume>6</volume>, <fpage>e230813</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Deep-Learning-Based Natural Language Processing of Serial Free-Text Radiological Reports for Predicting Rectal Cancer Patient Survival</article-title>. <source>Front. Oncol</source>. <volume>11</volume>, <issue>747250</issue> (<year>2021</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Cai</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Tang</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Li</surname>, <given-names>Y</given-names></string-name></person-group>. <article-title>Learning interpretable cellular and gene signature embeddings from single-cell transcriptomic data</article-title>. <source>Nat. Commun</source>. <volume>12</volume>, <fpage>5261</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>scBERT as a large-scale pretrained deep language model for cell type annotation of single-cell RNA-seq data</article-title>. <source>Nature Machine Intelligence</source> <volume>4</volume>, <fpage>852</fpage>–<lpage>866</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Le</surname>, <given-names>Q. V.</given-names></string-name> &amp; <string-name><surname>Mikolov</surname>, <given-names>T</given-names></string-name></person-group>. <article-title>Distributed Representations of Sentences and Documents</article-title>. <source>arXiv [cs.CL</source><italic>]</italic> (<year>2014</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kfoury</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Human prostate cancer bone metastases have an actionable immunosuppressive microenvironment</article-title>. <source>Cancer Cell</source> <volume>39</volume>, <fpage>1464</fpage>–<lpage>1478.e8</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Feng</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Intrinsic Molecular Subtypes of Metastatic Castration-Resistant Prostate Cancer</article-title>. <source>Clin. Cancer Res</source>. <volume>28</volume>, <fpage>5396</fpage>–<lpage>5404</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abida</surname>, <given-names>W.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Genomic correlates of clinical outcome in advanced prostate cancer</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>116</volume>, <fpage>11428</fpage>–<lpage>11436</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Qing</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Zheng</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Jin</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Shi</surname>, <given-names>L</given-names></string-name></person-group>. <article-title>Advances in single-cell RNA sequencing and its applications in cancer research</article-title>. <source>Oncotarget</source> <volume>8</volume>, <fpage>53763</fpage>–<lpage>53779</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baslan</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Hicks</surname>, <given-names>J</given-names></string-name></person-group>. <article-title>Unravelling biology and shifting paradigms in cancer with single-cell sequencing</article-title>. <source>Nat. Rev. Cancer</source> <volume>17</volume>, <fpage>557</fpage>–<lpage>569</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Precision treatment exploration of breast cancer based on heterogeneity analysis of lncRNAs at the single-cell level</article-title>. <source>BMC Cancer</source> <volume>21</volume>, <issue>918</issue> (<year>2021</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hoffman</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Smibert</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Papalexi</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Satija</surname>, <given-names>R</given-names></string-name></person-group>. <article-title>Integrating single-cell transcriptomic data across different conditions, technologies, and species</article-title>. <source>Nat. Biotechnol</source>. <volume>36</volume>, <fpage>411</fpage>–<lpage>420</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname>, <given-names>F. A.</given-names></string-name>, <string-name><surname>Angerer</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Theis</surname>, <given-names>F. J</given-names></string-name></person-group>. <article-title>SCANPY: large-scale single-cell gene expression data analysis</article-title>. <source>Genome Biol</source>. <volume>19</volume>, <issue>15</issue> (<year>2018</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>, <given-names>X.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Deep learning enables accurate clustering with batch effect removal in single-cell RNA-seq analysis</article-title>. <source>Nat. Commun</source>. <volume>11</volume>, <fpage>2338</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Iterative transfer learning with neural network for clustering and cell type classification in single-cell RNA-seq analysis</article-title>. <source>Nat Mach Intell</source> <volume>2</volume>, <fpage>607</fpage>–<lpage>618</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stein-O’Brien</surname>, <given-names>G. L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Decomposing Cell Identity for Transfer Learning across Cellular Measurements, Platforms, Tissues, and Species</article-title>. <source>Cell Syst</source> <volume>12</volume>, <issue>203</issue> (<year>2021</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karthaus</surname>, <given-names>W. R.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Regenerative potential of prostate luminal cells revealed by single-cell analysis</article-title>. <source>Science</source> <volume>368</volume>, <fpage>497</fpage>–<lpage>505</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henry</surname>, <given-names>G. H.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>A Cellular Anatomy of the Normal Adult Human Prostate and Prostatic Urethra</article-title>. <source>Cell Rep</source>. <volume>25</volume>, <fpage>3530</fpage>–<lpage>3542.e5</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname>, <given-names>G. X. Y.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Massively parallel digital transcriptional profiling of single cells</article-title>. <source>Nat. Commun</source>. <volume>8</volume>, <fpage>1</fpage>–<lpage>12</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Baron</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>A Single-Cell Transcriptomic Map of the Human and Mouse Pancreas Reveals Inter-and Intra-cell Population Structure</article-title>. <source>Cell systems</source> <volume>3</volume>, (<year>2016</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Muraro</surname>, <given-names>M. J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>A Single-Cell Transcriptome Atlas of the Human Pancreas</article-title>. <source>Cell Syst</source> <volume>3</volume>, <fpage>385</fpage>–<lpage>394.e3</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>, <given-names>Y. J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Single-Cell Transcriptomics of the Human Endocrine Pancreas</article-title>. <source>Diabetes</source> <volume>65</volume>, <fpage>3028</fpage>–<lpage>3038</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Segerstolpe</surname>, <given-names>Å.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Single-Cell Transcriptome Profiling of Human Pancreatic Islets in Health and Type 2 Diabetes</article-title>. <source>Cell Metab</source>. <volume>24</volume>, (<year>2016</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Regev</surname>, <given-names>A</given-names></string-name></person-group>. <article-title>Deep generative model embedding of single-cell RNA-Seq profiles on hyperspheres and hyperbolic spaces</article-title>. <source>Nat. Commun</source>. <volume>12</volume>, <fpage>2554</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Devlin</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Chang</surname>, <given-names>M.-W.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Toutanova</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>BERT: Pre-training of Deep Bidirectional Transformers for Language Understanding</article-title>. <source>arXiv [cs.CL</source><italic>]</italic> (<year>2018</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stoeckius</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Simultaneous epitope and transcriptome measurement in single cells</article-title>. <source>Nat. Methods</source> <volume>14</volume>, <fpage>865</fpage>–<lpage>868</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hao</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Integrated analysis of multimodal single-cell data</article-title>. <source>Cell</source> <volume>184</volume>, <fpage>3573</fpage>–<lpage>3587.e29</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dwivedi</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Bhasin</surname>, <given-names>M</given-names></string-name></person-group>. <article-title>Survival Genie: A Web Portal for Single-Cell Data, Gene-Ratio, and Cell Composition-Based Survival Analyses</article-title>. <source>Blood</source> <volume>138</volume>, <issue>276</issue> (<year>2021</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tang</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Identification of five important genes to predict glioblastoma subtypes</article-title>. <source>Neurooncol Adv</source> <volume>3</volume>, (<year>2021</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Behnan</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Finocchiaro</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Hanna</surname>, <given-names>G</given-names></string-name></person-group>. <article-title>The landscape of the mesenchymal signature in brain tumours</article-title>. <source>Brain</source> <volume>142</volume>, <fpage>847</fpage>–<lpage>866</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Couturier</surname>, <given-names>C. P.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Single-cell RNA-seq reveals that glioblastoma recapitulates a normal neurodevelopmental hierarchy</article-title>. <source>Nat. Commun</source>. <volume>11</volume>, <fpage>3406</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Neftel</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>An Integrative Model of Cellular States, Plasticity, and Genetics for Glioblastoma</article-title>. <source>Cell</source> <volume>178</volume>, <fpage>835</fpage>–<lpage>849.e21</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname>, <given-names>N.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Prevalence and clinicopathologic characteristics of the molecular subtypes in malignant glioma: a multi-institutional analysis of 941 cases</article-title>. <source>PLoS One</source> <volume>9</volume>, <fpage>e94871</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patel</surname>, <given-names>A. P.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Single-cell RNA-seq highlights intratumoral heterogeneity in primary glioblastoma</article-title>. <source>Science</source> <volume>344</volume>, <fpage>1396</fpage>–<lpage>1401</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parker</surname>, <given-names>J. S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Supervised risk predictor of breast cancer based on intrinsic subtypes</article-title>. <source>J. Clin. Oncol</source>. <volume>27</volume>, <fpage>1160</fpage>–<lpage>1167</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname>, <given-names>S. Z.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Stromal cell diversity associated with immune evasion in human triplel negative breast cancer</article-title>. <source>The EMBO Journal</source> vol. <volume>39</volume> Preprint at <pub-id pub-id-type="doi">10.15252/embj.2019104063</pub-id> (<year>2020</year>).</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karaayvaz</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Unravelling subclonal heterogeneity and aggressive disease states in TNBC through single-cell RNA-seq</article-title>. <source>Nat. Commun</source>. <volume>9</volume>, <fpage>3588</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Single-cell RNA-seq dissects the intratumoral heterogeneity of triple-negative breast cancer based on gene regulatory networks</article-title>. <source>Mol. Ther. Nucleic Acids</source> <volume>23</volume>, <fpage>682</fpage>–<lpage>690</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathews</surname>, <given-names>J. C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Robust and interpretable PAM50 reclassification exhibits survival advantage for myoepithelial and immune phenotypes</article-title>. <source>NPJ Breast Cancer</source> <volume>5</volume>, <issue>30</issue> (<year>2019</year>).</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weigelt</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Breast cancer molecular profiling with single sample predictors: a retrospective analysis</article-title>. <source>Lancet Oncol</source>. <volume>11</volume>, <fpage>339</fpage>–<lpage>349</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hennigs</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Prognosis of breast cancer molecular subtypes in routine clinical care: A large prospective cohort study</article-title>. <source>BMC Cancer</source> <volume>16</volume>, <fpage>1</fpage>–<lpage>9</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ahn</surname>, <given-names>H. J.</given-names></string-name>, <string-name><surname>Jung</surname>, <given-names>S. J.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>T. H.</given-names></string-name>, <string-name><surname>Oh</surname>, <given-names>M. K.</given-names></string-name> &amp; <string-name><surname>Yoon</surname>, <given-names>H.-K</given-names></string-name></person-group>. <article-title>Differences in Clinical Outcomes between Luminal A and B Type Breast Cancers according to the St. Gallen Consensus 2013</article-title>. <source>Journal of Breast Cancer</source> vol. <volume>18</volume> <fpage>149</fpage> Preprint at <pub-id pub-id-type="doi">10.4048/jbc.2015.18.2.149</pub-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yersal</surname>, <given-names>O.</given-names></string-name></person-group> <article-title>Biological subtypes of breast cancer: Prognostic and therapeutic implications</article-title>. <source>World Journal of Clinical Oncology</source> vol. <volume>5</volume> <fpage>412</fpage> <pub-id pub-id-type="doi">10.5306/wjco.v5.i3.412</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>X.-S.</given-names></string-name> &amp; <string-name><surname>Zhang</surname>, <given-names>S</given-names></string-name></person-group>. <article-title>Breast tumor subgroups reveal diverse clinical prognostic power</article-title>. <source>Sci. Rep</source>. <volume>4</volume>, <fpage>4002</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gupta</surname>, <given-names>P. B.</given-names></string-name>, <string-name><surname>Pastushenko</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Skibinski</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Blanpain</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Kuperwasser</surname>, <given-names>C</given-names></string-name></person-group>. <article-title>Phenotypic Plasticity: Driver of Cancer Initiation, Progression, and Therapy Resistance</article-title>. <source>Cell Stem Cell</source> <volume>24</volume>, <fpage>65</fpage>–<lpage>78</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Formaggio</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Rubin</surname>, <given-names>M. A.</given-names></string-name> &amp; <string-name><surname>Theurillat</surname>, <given-names>J.-P</given-names></string-name></person-group>. <article-title>Loss and revival of androgen receptor signaling in advanced prostate cancer</article-title>. <source>Oncogene</source> <volume>40</volume>, <fpage>1205</fpage>–<lpage>1216</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stelloo</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Androgen receptor profiling predicts prostate cancer outcome</article-title>. <source>EMBO Mol. Med</source>. <volume>7</volume>, <fpage>1450</fpage>–<lpage>1464</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lonergan</surname>, <given-names>P. E.</given-names></string-name> &amp; <string-name><surname>Tindall</surname>, <given-names>D. J</given-names></string-name></person-group>. <article-title>Androgen receptor signaling in prostate cancer development and progression</article-title>. <source>J. Carcinog</source>. <volume>10</volume>, <issue>20</issue> (<year>2011</year>).</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Einstein</surname>, <given-names>D. J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Metastatic Castration-Resistant Prostate Cancer Remains Dependent on Oncogenic Drivers Found in Primary Tumors</article-title>. <source>JCO Precis Oncol</source> <volume>5</volume>, (<year>2021</year>).</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Augello</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Den</surname>, <given-names>R. B.</given-names></string-name> &amp; <string-name><surname>Knudsen</surname>, <given-names>K. E.</given-names></string-name></person-group> <article-title>AR function in promoting metastatic prostate cancer</article-title>. <source>Cancer and Metastasis Reviews</source> vol. <volume>33</volume> <fpage>399</fpage>–<lpage>411</lpage> Preprint at <pub-id pub-id-type="doi">10.1007/s10555-013-9471-3</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c66"><label>66.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Antonarakis</surname>, <given-names>E. S</given-names></string-name></person-group>. <article-title>Targeting lineage plasticity in prostate cancer</article-title>. <source>The Lancet Oncology</source> vol. <volume>20</volume> <fpage>1338</fpage>–<lpage>1340</lpage> Preprint at <pub-id pub-id-type="doi">10.1016/s1470-2045(19)30497-8</pub-id> (<year>2019</year>).</mixed-citation></ref>
<ref id="c67"><label>67.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beltran</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The Role of Lineage Plasticity in Prostate Cancer Therapy Resistance</article-title>. <source>Clin. Cancer Res</source>. <volume>25</volume>, <fpage>6916</fpage>–<lpage>6924</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c68"><label>68.</label><mixed-citation publication-type="report"><person-group person-group-type="author"><string-name><surname>Yamada</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Beltran</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Clinical and Biological Features of Neuroendocrine Prostate Cancer</article-title>. <source>Current Oncology Reports</source> vol. <volume>23</volume> Preprint at <pub-id pub-id-type="doi">10.1007/s11912-020-01003-9</pub-id> (<year>2021</year>).</mixed-citation></ref>
<ref id="c69"><label>69.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Labrecque</surname>, <given-names>M. P.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Molecular profiling stratifies diverse phenotypes of treatment-refractory metastatic castration-resistant prostate cancer</article-title>. <source>J. Clin. Invest</source>. <volume>129</volume>, <fpage>4492</fpage>–<lpage>4505</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c70"><label>70.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>He</surname>, <given-names>M. X.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Transcriptional mediators of treatment resistance in lethal prostate cancer</article-title>. <source>Nat. Med</source>. <volume>27</volume>, <fpage>426</fpage>–<lpage>433</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c71"><label>71.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>, <given-names>H. T.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Neuroendocrine Prostate Cancer (NEPC) Progressing From Conventional Prostatic Adenocarcinoma: Factors Associated With Time to Development of NEPC and Survival From NEPC Diagnosis—A Systematic Review and Pooled Analysis</article-title>. <source>Journal of Clinical Oncology</source> vol. <volume>32</volume> <fpage>3383</fpage>–<lpage>3390</lpage> Preprint at <pub-id pub-id-type="doi">10.1200/jco.2013.54.3553</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c72"><label>72.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hänzelmann</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Castelo</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Guinney</surname>, <given-names>J</given-names></string-name></person-group>. <article-title>GSVA: gene set variation analysis for microarray and RNA-seq data</article-title>. <source>BMC Bioinformatics</source> <volume>14</volume>, <issue>7</issue> (<year>2013</year>).</mixed-citation></ref>
<ref id="c73"><label>73.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Merkens</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Aggressive variants of prostate cancer: underlying mechanisms of neuroendocrine transdifferentiation</article-title>. <source>J. Exp. Clin. Cancer Res</source>. <volume>41</volume>, <issue>46</issue> (<year>2022</year>).</mixed-citation></ref>
<ref id="c74"><label>74.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hangauer</surname>, <given-names>M. J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Drug-tolerant persister cancer cells are vulnerable to GPX4 inhibition</article-title>. <source>Nature</source> <volume>551</volume>, <fpage>247</fpage>–<lpage>250</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c75"><label>75.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Catapano</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Acquired drug resistance interferes with the susceptibility of prostate cancer cells to metabolic stress</article-title>. <source>Cell. Mol. Biol. Lett</source>. <volume>27</volume>, <issue>100</issue> (<year>2022</year>).</mixed-citation></ref>
<ref id="c76"><label>76.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Castellón</surname>, <given-names>E. A.</given-names></string-name>, <string-name><surname>Indo</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Contreras</surname>, <given-names>H. R.</given-names></string-name></person-group> <article-title>Cancer Stemness/Epithelial–Mesenchymal Transition Axis Influences Metastasis and Castration Resistance in Prostate Cancer: Potential Therapeutic Target</article-title>. <source>Int. J. Mol. Sci</source>. <volume>23</volume>, <fpage>14917</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c77"><label>77.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lugano</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Ramachandran</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Dimberg</surname>, <given-names>A</given-names></string-name></person-group>. <article-title>Tumor angiogenesis: causes, consequences, challenges and opportunities</article-title>. <source>Cell. Mol. Life Sci</source>. <volume>77</volume>, <fpage>1745</fpage>–<lpage>1770</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c78"><label>78.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khan</surname>, <given-names>S. A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Reusability report: Learning the transcriptional grammar in single-cell RNA-sequencing data using transformers</article-title>. <source>Nature Machine Intelligence</source> <volume>5</volume>, <fpage>1437</fpage>–<lpage>1446</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c79"><label>79.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Zhou</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Lin</surname>, <given-names>X.</given-names></string-name></person-group> <article-title>Rethinking the Impacts of Overfitting and Feature Quality on Small-scale Video Classification</article-title>. in <source>Proceedings of the 29th ACM International Conference on Multimedia</source> <fpage>4760</fpage>–<lpage>4764</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c80"><label>80.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Phongpreecha</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Single-cell peripheral immunoprofiling of Alzheimer’s and Parkinson’s diseases</article-title>. <source>Sci Adv</source> <volume>6</volume>, (<year>2020</year>).</mixed-citation></ref>
<ref id="c81"><label>81.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strehl</surname>, <given-names>J. D.</given-names></string-name>, <string-name><surname>Wachter</surname>, <given-names>D. L.</given-names></string-name>, <string-name><surname>Fasching</surname>, <given-names>P. A.</given-names></string-name>, <string-name><surname>Beckmann</surname>, <given-names>M. W.</given-names></string-name> &amp; <string-name><surname>Hartmann</surname>, <given-names>A</given-names></string-name></person-group>. <article-title>Invasive Breast Cancer: Recognition of Molecular Subtypes</article-title>. <source>Breast Care</source> <volume>6</volume>, <fpage>258</fpage>–<lpage>264</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c82"><label>82.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Scikit-learn: Machine learning in Python</article-title>. <source>Journal of machine Learning research</source> <volume>12</volume>, <fpage>2825</fpage>–<lpage>2830</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c83"><label>83.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Rehurek</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Sojka</surname>, <given-names>P.</given-names></string-name></person-group> <source>Gensim--python framework for vector space modelling</source>. <publisher-name>NLP Centre, Faculty of Informatics, Masaryk University</publisher-name>, <publisher-loc>Brno, Czech Republic</publisher-loc> <volume>3</volume>, (<year>2011</year>).</mixed-citation></ref>
<ref id="c84"><label>84.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Bird</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Klein</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Loper</surname>, <given-names>E</given-names></string-name></person-group>. <source>Natural Language Processing with Python: Analyzing Text with the Natural Language Toolkit</source>. (<publisher-name>‘O’Reilly Media, Inc</publisher-name>.’, <year>2009</year>).</mixed-citation></ref>
<ref id="c85"><label>85.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mikolov</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Corrado</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Dean</surname>, <given-names>J</given-names></string-name></person-group>. <article-title>Efficient Estimation of Word Representations in Vector Space</article-title>. <source>arXiv [cs.CL]</source> (<year>2013</year>).</mixed-citation></ref>
<ref id="c86"><label>86.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Traag</surname>, <given-names>V. A.</given-names></string-name>, <string-name><surname>Waltman</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>van Eck</surname>, <given-names>N. J</given-names></string-name></person-group>. <article-title>From Louvain to Leiden: guaranteeing well-connected communities</article-title>. <source>Sci. Rep</source>. <volume>9</volume>, <fpage>5233</fpage> (<year>2019</year>).</mixed-citation></ref>
    <ref id="c87"><label>87.</label><mixed-citation publication-type="thesis"><person-group person-group-type="author"><string-name><surname>Huang</surname>, <given-names>P. J.</given-names></string-name></person-group> <article-title>Classification of Imbalanced Data Using Synthetic Over-sampling Techniques</article-title>. <publisher-name>University of California</publisher-name>. <publisher-loc>California, USA</publisher-loc>. <ext-link ext-link-type="uri" xlink:href="https://escholarship.org/content/qt72w743h7/qt72w743h7_noSplash_bd589490abd5ac433d09090e910cb967.pdf?t=nrzo4h">https://escholarship.org/content/qt72w743h7/qt72w743h7_noSplash_bd589490abd5ac433d09090e910cb967.pdf?t=nrzo4h</ext-link>. (<year>2015</year>).</mixed-citation></ref>
<ref id="c88"><label>88.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemaitre</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Nogueira</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Aridas</surname>, <given-names>C. K</given-names></string-name></person-group>. <article-title>Imbalanced-learn: A python toolbox to tackle the curse of imbalanced datasets in machine learning</article-title>. <source>arXiv [cs.LG</source><italic>]</italic> (<year>2016</year>).</mixed-citation></ref>
<ref id="c89"><label>89.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Virshup</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Rybakov</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Theis</surname>, <given-names>F. J.</given-names></string-name>, <string-name><surname>Angerer</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Alexander Wolf</surname>, <given-names>F.</given-names></string-name></person-group> <article-title>anndata: Annotated data</article-title>. <source>bioRxiv</source> 2021.12.16.473007 (<year>2021</year>) doi:<pub-id pub-id-type="doi">10.1101/2021.12.16.473007</pub-id>.</mixed-citation></ref>
<ref id="c90"><label>90.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ishwaran</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Kogalur</surname>, <given-names>U. B.</given-names></string-name>, <string-name><surname>Blackstone</surname>, <given-names>E. H.</given-names></string-name> &amp; <string-name><surname>Lauer</surname>, <given-names>M. S.</given-names></string-name></person-group> <article-title>Random survival forests</article-title>. <source>The Annals of Applied Statistics</source> vol. <volume>2</volume> Preprint at <pub-id pub-id-type="doi">10.1214/08-aoas169</pub-id> (<year>2008</year>).</mixed-citation></ref>
<ref id="c91"><label>91.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pölsterl</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>scikit-survival: A Library for Time-to-Event Analysis Built on Top of scikit-learn</article-title>. <source>J. Mach. Learn. Res</source>. <volume>21</volume>, <fpage>1</fpage>–<lpage>6</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c92"><label>92.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abidi</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Characterization of Rat ILCs Reveals ILC2 as the Dominant Intestinal Subset</article-title>. <source>Front. Immunol</source>. <volume>11</volume>, <issue>255</issue> (<year>2020</year>).</mixed-citation></ref>
<ref id="c93"><label>93.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stoeckius</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Cell Hashing with barcoded antibodies enables multiplexing and doublet detection for single cell genomics</article-title>. <source>Genome Biol</source>. <volume>19</volume>, <issue>224</issue> (<year>2018</year>).</mixed-citation></ref>
<ref id="c94"><label>94.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liberzon</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The Molecular Signatures Database (MSigDB) hallmark gene set collection</article-title>. <source>Cell Syst</source> <volume>1</volume>, <fpage>417</fpage>–<lpage>425</lpage> (<year>2015</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98469.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Hong</surname>
<given-names>Seunghee</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Yonsei University</institution>
</institution-wrap>
<city>Seoul</city>
<country>Republic of Korea</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>valuable</bold> study introduces SCellBOW, a novel tool leveraging natural language processing techniques to enhance cell clustering and infer survival risks from single-cell RNA sequencing data. The methodology and results are <bold>convincing</bold>, demonstrating superior clustering performance and the ability to assign risk scores to cancer cell clusters across multiple datasets. SCellBOW's unique approach promises significant advancements in understanding cancer cell heterogeneity and identifying aggressive cancer cell subgroups.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98469.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This review evaluates the SCellBOW framework, which applies phenotype algebra to obtain vectors from cancer subclusters or user-defined subclusters.</p>
<p>Strengths:</p>
<p>SCellBOW employs an innovative application of NLP-inspired techniques to analyze scRNA-seq data, facilitating the identification and visualization of phenotypically divergent cell subpopulations.</p>
<p>The framework demonstrates robustness in accurately representing various cell types across multiple datasets, highlighting its versatility and utility in different biological contexts.</p>
<p>By simulating the impact of specific malignant subpopulations on disease prognosis, SCellBOW provides valuable insights into the relative risk and aggressiveness of cancer subpopulations, which is crucial for personalized therapeutic strategies.</p>
<p>The identification of a previously unknown and aggressive AR−/NElow subpopulation in metastatic prostate cancer underscores the potential of SCellBOW in uncovering clinically significant findings.</p>
<p>Weaknesses:</p>
<p>The reliance on bulk RNA-seq data as a reference raises concerns about potentially misleading results due to the presence of RNA expression from immune cells in the TME. It is unclear if SCellBOW adequately addresses this issue, which could affect the accuracy of the cancer subcluster vectors.</p>
<p>The method of extracting vectors in phenotype algebra appears to be a straightforward subtraction operation. This simplicity might limit its efficiency in excluding associations with phenotypes from specific subpopulations, potentially leading to inaccurate interpretations of the data.</p>
<p>The review would benefit from additional validation studies to assess the effectiveness of SCellBOW in distinguishing between cancerous and non-cancerous signals, particularly in heterogeneous tumor environments.</p>
<p>Further clarification on how SCellBOW handles mixed-cell populations within bulk RNA-seq data would strengthen the evaluation of its applicability and reliability in diverse research settings.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98469.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors developed a novel tool, SCellBOW, to perform cell clustering and infer survival risks on individual cancer cell clusters from the single-cell RNA seq dataset. The key ideas/techniques used in the tool include transfer learning, bag of words (BOW), and phenotype algebra which is similar to word algebra from natural language processing (NLP). Comparisons with existing methods demonstrated that SCellBOW provides superior clustering results and exhibits robust performance across a wide range of datasets. Importantly, a distinguishing feature of SCellBOW compared to other tools is its ability to assign risk scores to specific cancer cell clusters. Using SCellBOW, the authors identified a new group of prostate cancer cells characterized by a highly aggressive and dedifferentiated phenotype.</p>
<p>Strengths:</p>
<p>The application of natural language processing (NLP) to single-cell RNA sequencing (scRNA-seq) datasets is both smart and insightful. Encoding gene expression levels as word frequencies is a creative way to apply text analysis techniques to biological data. When combined with transfer learning, this approach enhances our ability to describe the heterogeneity of different cells, offering a novel method for understanding the biological behavior of individual cells and surpassing the capabilities of existing cell clustering methods. Moreover, the ability of the package to predict risk, particularly within cancer datasets, significantly expands the potential applications.</p>
<p>Weaknesses:</p>
<p>Given the promising nature of this tool, it would be beneficial for the authors to test the risk-stratification functionality on other types of tumors with high heterogeneity, such as liver and pancreatic cancers, which currently lack clinically relevant and well-recognized stratification methods. Additionally, it would be worthwhile to investigate how the tool could be applied to spatial transcriptomics by analyzing cell embeddings from different layers within these tissues.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98469.1.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Bhattacharya</surname>
<given-names>Namrata</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5666-2551</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Rockstroh</surname>
<given-names>Anja</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2700-375X</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Deshpande</surname>
<given-names>Sanket Suhas</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Thomas</surname>
<given-names>Sam Koshy</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Yadav</surname>
<given-names>Anunay</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Goswami</surname>
<given-names>Chitrita</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Chawla</surname>
<given-names>Smriti</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Solomon</surname>
<given-names>Pierre</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Fourgeux</surname>
<given-names>Cynthia</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ahuja</surname>
<given-names>Gaurav</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2837-9361</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Hollier</surname>
<given-names>Brett G</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kumar</surname>
<given-names>Himanshu</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Roquilly</surname>
<given-names>Antoine</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Poschmann</surname>
<given-names>Jeremie</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lehman</surname>
<given-names>Melanie</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Nelson</surname>
<given-names>Colleen C</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sengupta</surname>
<given-names>Debarka</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1:</bold></p>
<p>This review evaluates the SCellBOW framework, which applies phenotype algebra to obtain vectors from cancer subclusters or user-defined subclusters.</p>
<p>Strengths:</p>
<p>SCellBOW employs an innovative application of NLP-inspired techniques to analyze scRNA-seq data, facilitating the identification and visualization of phenotypically divergent cell subpopulations. The framework demonstrates robustness in accurately representing various cell types across multiple datasets, highlighting its versatility and utility in different biological contexts. By simulating the impact of specific malignant subpopulations on disease prognosis, SCellBOW provides valuable insights into the relative risk and aggressiveness of cancer subpopulations, which is crucial for personalized therapeutic strategies. The identification of a previously unknown and aggressive AR−/NElow subpopulation in metastatic prostate cancer underscores the potential of SCellBOW in uncovering clinically significant findings.</p>
<p>Major concerns:</p>
<p>The reliance on bulk RNA-seq data as a reference raises concerns about potentially misleading results due to the presence of RNA expression from immune cells in the TME. It is unclear if SCellBOW adequately addresses this issue, which could affect the accuracy of the cancer subcluster vectors.</p>
</disp-quote>
<p>To address the concern about potentially misleading results due to the TME when using bulk RNA-seq data as a reference:</p>
<p>a. We account for systematic biases between the single-cell and bulk transcriptomics readouts by creating pseudo-bulk profiles for single-cell clusters, enabling more accurate comparisons.</p>
<p>b. We encode expressions into word vectors and co-embed them together. By doing this, we mitigate any possibility of systematic differences in the embedding.</p>
<p>c. It is imperative that we subject both single-cell and bulk data through the same treatments because otherwise, it will be difficult to perform algebraic operations on them.</p>
<p>d. We rely on tumor bulk transcriptomics data from TCGA due to its high sample size and patient meta-data such as information pertaining to patient survival.</p>
<p>We will discuss this in the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p>The method of extracting vectors in phenotype algebra appears to be a straightforward subtraction operation. This simplicity might limit its efficiency in excluding associations with phenotypes from specific subpopulations, potentially leading to inaccurate interpretations of the data.</p>
</disp-quote>
<p>Vector algebra operations are not done in the gene expression space (i.e., gene expression vectors associated with tumor samples), rather we process the single cell and bulk expression profiles through multiple steps (pseudo-bulk vector generation for single cell clusters, mapping gene expression values to word frequencies as better understood by the Doc2vec neural networks etc.) to ensure their embeddings are consistent and capture intricate phenotypic information. We have demonstrated this through rigorous validation of the clusters yielded on various types of healthy and diseased samples. Furthermore, we have demonstrated the consistency of the vector algebra operations on known cancer subtypes in breast cancer, glioblastoma, and prostate cancer.</p>
<p>We will discuss this in the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p>The review would benefit from additional validation studies to assess the effectiveness of SCellBOW in distinguishing between cancerous and non-cancerous signals, particularly in heterogeneous tumor environments.</p>
</disp-quote>
<p>In our study, we are primarily interested in signals from malignant cells. However, we may consider scRNA-seq data with stromal cells and test whether SCellBOW can identify the influence of different stromal cell types on cancer aggressiveness.</p>
<disp-quote content-type="editor-comment">
<p>Further clarification on how SCellBOW handles mixed-cell populations within bulk RNA-seq data would strengthen the evaluation of its applicability and reliability in diverse research settings.</p>
</disp-quote>
<p>We will elaborate on our discussion in the Result as well as Discussion sections.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2:</bold></p>
<p>The authors developed a novel tool, SCellBOW, to perform cell clustering and infer survival risks on individual cancer cell clusters from the single-cell RNA seq dataset. The key ideas/techniques used in the tool include transfer learning, bag of words (BOW), and phenotype algebra which is similar to word algebra from natural language processing (NLP). Comparisons with existing methods demonstrated that SCellBOW provides superior clustering results and exhibits robust performance across a wide range of datasets. Importantly, a distinguishing feature of SCellBOW compared to other tools is its ability to assign risk scores to specific cancer cell clusters. Using SCellBOW, the authors identified a new group of prostate cancer cells characterized by a highly aggressive and dedifferentiated phenotype.</p>
<p>Strengths:</p>
<p>The application of natural language processing (NLP) to single-cell RNA sequencing (scRNA-seq) datasets is both smart and insightful. Encoding gene expression levels as word frequencies is a creative way to apply text analysis techniques to biological data. When combined with transfer learning, this approach enhances our ability to describe the heterogeneity of different cells, offering a novel method for understanding the biological behavior of individual cells and surpassing the capabilities of existing cell clustering methods. Moreover, the ability of the package to predict risk, particularly within cancer datasets, significantly expands the potential applications.</p>
<p>Major concerns:</p>
<p>Given the promising nature of this tool, it would be beneficial for the authors to test the risk-stratification functionality on other types of tumors with high heterogeneity, such as liver and pancreatic cancers, which currently lack clinically relevant and well-recognized stratification methods. Additionally, it would be worthwhile to investigate how the tool could be applied to spatial transcriptomics by analyzing cell embeddings from different layers within these tissue</p>
</disp-quote>
<p>(1) Our selection of glioblastoma and breast cancer for this study was primarily driven by the focus on extensively studied and well-defined cancer types. To demonstrate the effectiveness of our model, we tested it on advanced prostate cancer, which currently lacks clinically relevant and well-recognized stratification methods. This application to metastatic prostate cancer serves as a proof of concept, illustrating our model's potential to provide valuable insights into cancer types where established stratification approaches are limited or absent. However, as suggested by the Reviewer, we will try to incorporate results for liver cancer, subject to the availability of adequate data for model building.</p>
<p>(2) Regarding the application of our tool to spatial transcriptomics, we have already analyzed data from Digital Spatial Profiling (DSP). The article is already quite complex and involved, and we are afraid the inclusion of spatial transcriptomics may amount to a significant extension of the method. To this end, although we will discuss the future possibilities, we will skip the method validity check on spatial transcriptomics data.</p>
</body>
</sub-article>
</article>