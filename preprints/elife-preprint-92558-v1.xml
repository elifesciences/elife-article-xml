<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">92558</article-id>
<article-id pub-id-type="doi">10.7554/eLife.92558</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.92558.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Chromosomes and Gene Expression</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Genome-wide Functional Characterization of Escherichia coli Promoters and Sequence Elements Encoding Their Regulation</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Urtecho</surname>
<given-names>Guillaume</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Insigne</surname>
<given-names>Kimberly D.</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tripp</surname>
<given-names>Arielle D.</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Brinck</surname>
<given-names>Marcia S.</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lubock</surname>
<given-names>Nathan B.</given-names>
</name>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Acree</surname>
<given-names>Christopher</given-names>
</name>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kim</surname>
<given-names>Hwangbeom</given-names>
</name>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Chan</surname>
<given-names>Tracey</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4661-0600</contrib-id>
<name>
<surname>Kosuri</surname>
<given-names>Sriram</given-names>
</name>
<xref ref-type="aff" rid="a6">6</xref>
<xref ref-type="aff" rid="a8">8</xref>
<xref ref-type="aff" rid="a9">9</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Molecular Biology Interdepartmental Doctoral Program, University of California</institution>, Los Angeles, CA, 90095, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>Department of Systems Biology, Columbia University</institution>, New York, NY, 10032, <country>USA</country></aff>
<aff id="a3"><label>3</label><institution>Bioinformatics Interdepartmental Graduate Program, University of California</institution>, Los Angeles, CA 90095, <country>USA</country></aff>
<aff id="a4"><label>4</label><institution>Department of Molecular, Cell, and Developmental Biology, University of California</institution>, Los Angeles, CA, 90095, <country>USA</country></aff>
<aff id="a5"><label>5</label><institution>Department of Microbiology, Immunology, and Molecular Genetics, University of California</institution>, Los Angeles, Los Angeles, California, <country>USA</country></aff>
<aff id="a6"><label>6</label><institution>Department of Chemistry and Biochemistry, University of California</institution>, Los Angeles, CA 90095, <country>USA</country></aff>
<aff id="a7"><label>7</label><institution>Department of Molecular Physiology and Biophysics, Vanderbilt University</institution>, Nashville, TN, 37232 <country>USA</country></aff>
<aff id="a8"><label>8</label><institution>Molecular Biology Institute, University of California</institution>, Los Angeles, CA 90095, <country>USA</country></aff>
<aff id="a9"><label>9</label><institution>UCLA-DOE Institute for Genomics and Proteomics, Quantitative and Computational Biology Institute, Eli and Edythe Broad Center of Regenerative Medicine and Stem Cell Research, Jonsson Comprehensive Cancer Center, University of California</institution>, Los Angeles, CA 90095, <country>USA</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Wade</surname>
<given-names>Joseph T</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Wadsworth Center, New York State Department of Health</institution>
</institution-wrap>
<city>Albany</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Walczak</surname>
<given-names>Aleksandra M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>CNRS</institution>
</institution-wrap>
<city>Paris</city>
<country>France</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>To whom correspondence should be addressed. Email: <email>gu2144@cumc.columbia.edu</email></corresp>
<fn id="n1" fn-type="others"><label>†</label><p>The authors wish it to be known that, in their opinion, the first two authors should be regarded as joint First Authors.</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-12-12">
<day>12</day>
<month>12</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP92558</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-09-19">
<day>19</day>
<month>09</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-10-12">
<day>12</day>
<month>10</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2020.01.04.894907"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Urtecho et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Urtecho et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-92558-v1.pdf"/>
<abstract>
<title>Summary</title><p>Despite decades of intense genetic, biochemical, and evolutionary characterizations of bacterial promoters, we lack the ability to identify or predict transcriptional activities of promoters using primary sequence. Even in simple, well-characterized organisms such as <italic>E. coli</italic> there is little agreement on the number, location, and strength of promoters. We use a genomically-encoded massively parallel reporter assay to perform the first full characterization of autonomous promoter activity across the <italic>E. coli</italic> genome. We measure promoter activity of &gt;300,000 sequences spanning the entire genome and map 2,228 promoters active in rich media. Surprisingly, 944 of these promoters were found within intragenic sequences and are associated with conciliatory sequence adaptations by both the protein-coding regions and overlapping RNAP binding sites. Furthermore, we perform a scanning mutagenesis of 2,057 promoters to uncover sequence elements regulating promoter activity, revealing 3,317 novel regulatory elements. Finally, we show that despite these large datasets and modern machine learning algorithms, predicting endogenous promoter activity from primary sequence is still challenging.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>links to scripts on github; links to raw &amp; processed datasets on NCBI GEO; a website for viewing promoter data generated in this study; Figure 4 has been expanded to show how screening promoter activity across genomic fragments can be used to identify transcription factors remodeling expression under varying conditions; revised or generated new figures for S5B S5C S6 S10B
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>In 1961, François Jacob and Jacques Monod outlined the concept of the bacterial promoter derived from an accumulation of genetic and biochemical studies of metabolic regulation in <italic>Escherichia coli</italic><sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Bacterial promoters have since become a foundation for understanding molecular biology and gene regulation, with countless studies probing their genetic, evolutionary, structural, thermodynamic and kinetic properties<sup><xref ref-type="bibr" rid="c2">2</xref>–<xref ref-type="bibr" rid="c5">5</xref></sup>. Several model promoters such as the <italic>lac</italic>, <italic>trp</italic>, and phage promoters have been the subject of in-depth mechanistic studies for how RNA polymerase (RNAP) recognizes promoter sequences, as well as the stepwise process to initiate transcription<sup><xref ref-type="bibr" rid="c6">6</xref>–<xref ref-type="bibr" rid="c8">8</xref></sup>. In addition, many transcription factors have been described in similar detail, revealing the processes through which these proteins modulate the behavior of RNAP and activity of the promoter<sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c9">9</xref>–<xref ref-type="bibr" rid="c11">11</xref></sup>. The majority of the binding motifs for these transcription factors have been studied at high resolution using modern methods<sup><xref ref-type="bibr" rid="c12">12</xref>–<xref ref-type="bibr" rid="c15">15</xref></sup>. In short, the myriad components that define <italic>E. coli</italic> promoter function have been extensively cataloged and characterized, establishing them as one of the most well-understood systems in molecular biology.</p>
<p>Despite this extensive knowledge, we still cannot answer many simple and fundamental questions about <italic>E. coli</italic> promoters. For example, how many active promoters exist in <italic>E. coli</italic> at a given growth condition? To what extent is promoter regulation responsible for protein level remodeling during environmental changes? Given a sequence, can we predict whether a promoter is encoded within it as well as its strength and/or regulation? Answers to these questions remain difficult for many reasons. Although the consensus sequences for RNAP recognition motifs have been known for decades, a simple search of the genome based on these motifs yields many false positives. In fact, within a region, there are often sequences closer to the RNAP recognition motifs than the actual functional promoter<sup><xref ref-type="bibr" rid="c16">16</xref>,<xref ref-type="bibr" rid="c17">17</xref></sup>. Experimental efforts to identify promoters using 5’ RNA-Seq have found tens of thousands of putative transcription start sites (TSSs) that presumably mark sites with functional promoter activity, however, there is little overlap between studies<sup><xref ref-type="bibr" rid="c18">18</xref>,<xref ref-type="bibr" rid="c19">19</xref></sup>. Furthermore, although many <italic>E. coli</italic> promoters have been verified with strong biochemical evidence<sup><xref ref-type="bibr" rid="c20">20</xref></sup>, identifying the cis-regulatory elements responsible for their activity is challenging. As a consequence, roughly two-thirds of the 2,565 reported <italic>E. coli</italic> operons do not contain any transcription factor binding site annotations<sup><xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c21">21</xref></sup>. Finally, aside from a handful of thoroughly-studied promoter sequences, we are still unable to quantitatively predict the activity or behavior of promoters in the context of sequence perturbations such as moving, mutating, or removing transcription factor binding sites.</p>
<p>There are several confounding factors which make it difficult to accurately gauge if a sequence can confer promoter activity. First, recent work has shown that promoter activity varies depending on location in the genome due to factors such as variance in chromosomal copy number<sup><xref ref-type="bibr" rid="c22">22</xref>–<xref ref-type="bibr" rid="c24">24</xref></sup>, the distribution of transcription factors within a cell<sup><xref ref-type="bibr" rid="c25">25</xref>,<xref ref-type="bibr" rid="c26">26</xref></sup>, and chromatin accessibility<sup><xref ref-type="bibr" rid="c27">27</xref>–<xref ref-type="bibr" rid="c29">29</xref></sup> masking the effects of cis-regulatory elements. Efforts to normalize these effects have utilized reporters on high copy number plasmids that can saturate endogenous transcriptional machinery<sup><xref ref-type="bibr" rid="c30">30</xref></sup>. Second, inferring promoter strength from endogenous transcript production is problematic because these transcripts often contain sequences that alter their processing and stability independent of the promoter sequence<sup><xref ref-type="bibr" rid="c31">31</xref>,<xref ref-type="bibr" rid="c32">32</xref></sup>. Third, multiple promoters within close proximity, whether co-directional or opposing, can affect each other’s strength and resulting transcription through mechanisms such as RNAP collisions and antisense RNA<sup><xref ref-type="bibr" rid="c33">33</xref>–<xref ref-type="bibr" rid="c36">36</xref></sup>. Finally, not all sequences that initiate RNA transcription are capable of producing mature and translatable RNA<sup><xref ref-type="bibr" rid="c37">37</xref></sup>.</p>
<p>Here we investigated promoter regulation in <italic>E. coli</italic> using a massively-parallel reporter assay (MPRA) designed to isolate promoter activity from other confounding factors influencing genetic regulation<sup><xref ref-type="bibr" rid="c38">38</xref></sup>. We measured promoter activity at 17,189 reported TSSs and found that a majority are not autonomous promoter sequences capable of gene transcription. We then measured promoter activity of 321,123 sheared genomic fragments spanning both strands of the <italic>E. coli</italic> genome (8.5x coverage) to elucidate the promoter landscape in rich and minimal media. We then systematically tiled these regions to precisely map promoter boundaries, revealing many regions with multiple promoters in close proximity, as well as many antisense promoters within genes that shape both codon usage and transcription levels. To characterize sequence motifs encoding promoter activity, we performed systematic mutagenesis of 2,057 active promoters and identified cis-regulatory elements affecting promoter activity. With this approach, we characterized the regulatory effects of 568 transcription factor binding sites reported by RegulonDB as well as 2,583 novel sites, thereby providing functionally annotated profiles for promoters driving expression in rich LB media for 1,158 of the 2,565 operons in <italic>E. coli</italic>. Lastly, we trained several machine learning models on these datasets to better understand the features that may be used to classify <italic>E. coli</italic> promoter sequences and quantitatively predict promoter function from sequence.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Functional characterization of 17,635 previously reported <italic>E. coli</italic> promoters reveals many are transcriptionally inactive</title>
<p>We first sought to validate promoters and TSSs identified by several genome-wide studies. We assembled previously reported TSSs from three sources: the RegulonDB <italic>E. coli</italic> database<sup><xref ref-type="bibr" rid="c20">20</xref></sup> (8,486 TSSs), a directional RNA-Seq study by Wanner et. al<sup><xref ref-type="bibr" rid="c18">18</xref></sup> (2,123 TSSs), and a RNA-Seq study by Thomason et. al<sup><xref ref-type="bibr" rid="c19">19</xref></sup> (14,868 TSSs). These three sources identify 23,798 unique TSSs active during log-phase growth in rich media with little agreement regarding the location of TSSs between studies and only 93 exact matches shared between all three (<bold><xref rid="fig1" ref-type="fig">Figure 1A</xref></bold>). Even when we collapsed clusters of TSSs within 20 bp of each other to the most upstream TSS to minimize redundancy, 17,635 unique TSSs remained. These TSSs are likely some combination of true promoters and false positives due to RNA processing, transcriptional noise, or experimental and computational artifacts.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1</label>
<caption><title>Functional characterization of 17,635 previously reported <italic>E. coli</italic> promoters.</title>
<p><bold>A)</bold> Three sources of genome-wide promoter predictions show little agreement in the reported TSSs at the single-nucleotide level. <bold>B)</bold> We synthesized oligos overlapping the −120 to +30 bp context of 17,635 reported TSSs and integrated construct into a fixed genomic landing pad. Measuring barcode expression using RNA-Seq captures quantitative measurements of transcriptional activity for individual TSSs. <bold>C)</bold> MPRA results are highly replicable across technical replicates (<italic>r</italic> = 0.965, <italic>p</italic> &lt; 2.2 x 10<sup>-16</sup>). <bold>D)</bold> The TSS library measurements span over 100-fold with negative controls exhibiting low levels of expression and positive controls spanning the entire dynamic range. <bold>E)</bold> A majority of tested TSSs are inactive in LB. <bold>F)</bold> Active and inactive TSSs have significantly different mean PWM scores for −10 and −35 σ70 motifs (Wilcoxon rank-sum test, “***” =&lt; 0.001).</p></caption>
<graphic xlink:href="894907v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To see if these TSS regions could drive gene expression of a transcriptional reporter, we used a genomic MPRA we developed<sup><xref ref-type="bibr" rid="c38">38</xref></sup> to quantitatively measure the autonomous promoter activity of 17,635 TSSs (<bold><xref rid="fig1" ref-type="fig">Figure 1B</xref></bold>). This system allows for single integration of large reporter libraries into a defined locus. The promoter activity reporter is insulated by multiple transcriptional terminators and the reporter transcript contains a RiboJ ribozyme sequence upstream of the RBS that standardizes the transcript produced. For each TSS, we synthesized oligonucleotides spanning 120 bp upstream to 30 bp downstream of the TSS, which encodes the majority of promoter activity driving expression at a given TSS<sup><xref ref-type="bibr" rid="c39">39</xref></sup>. We included 96 well-characterized promoters from the BioBricks registry <sup><xref ref-type="bibr" rid="c40">40</xref></sup> designed to span a wide range of expression levels to serve as positive controls. We also included 500 negative controls that were selected 150 bp sequences from the <italic>E. coli</italic> genome. Our criteria for selecting these sequences was that they are more than 200 bp from any TSS reported in the aforementioned studies. We engineered these 18,222 unique sequences to express a uniquely barcoded sfGFP transcript and subsequently integrated this pooled library of reporter constructs into the <italic>nth-ydgR</italic> intergenic locus within the <italic>E. coli</italic> chromosomal terminus using a recombination-mediated cassette exchange system<sup><xref ref-type="bibr" rid="c41">41</xref></sup>. We determined promoter activity levels by performing targeted amplicon sequencing of the barcoded sfGFP transcripts to quantify RNA-seq levels of each barcode normalized to their DNA-seq abundances, and precisely measured expression for 97.5% (17,767/18,222) of TSSs in this library (<bold><xref rid="fig1" ref-type="fig">Figure 1C</xref></bold>) with an average of 69.5 barcodes measured per library member (<bold>Figure S1A</bold>). Expression measurements were consistent between replicates which were separately barcoded, cloned, and quantified (R<sup>2</sup> = 0.919, <italic>p</italic> &lt; 2.2 x 10<sup>-16</sup>) (<bold>Figure S1B</bold>). To call a TSS active we set a threshold of at least greater than two standard deviations above the median of the negative control distribution and normalized the data such that the threshold value was set to 1 (<bold><xref rid="fig1" ref-type="fig">Figure 1D</xref></bold>). Among the 17,635 original TSSs, we confidently quantified 17,189 (97.4%) and identified 2,670 exhibiting expression levels above our experimentally determined threshold (<bold><xref rid="fig1" ref-type="fig">Figure 1E</xref></bold>). Notably, this number of active promoters is more consistent with the number of operons identified using long-read sequencing to characterize full-length <italic>E. coli</italic> transcripts<sup><xref ref-type="bibr" rid="c42">42</xref>,<xref ref-type="bibr" rid="c43">43</xref></sup>. Amongst these 2,670 confirmed promoters, we recovered expression data for many well-known promoters and three of the strongest corresponded to the 16S and 23S polycistronic operon, the most highly expressed operon in the <italic>E. coli</italic> genome<sup><xref ref-type="bibr" rid="c44">44</xref></sup>.</p>
<p>To confirm whether our set of negative controls were truly depleted of promoter activity, we tested a set of 936 completely random 150 bp nucleotide sequences and compared the expression levels to our negative controls (<bold>Figure S2</bold>). Despite overall low mean levels of expression (Random sequences: 0.115, Negative controls: 0.036), 2.35% of random promoters drove expression higher than our negative threshold whereas only 0.851% of negative controls exceeded this threshold. A recent study found that 4/40 (10%) random 103 bp sequences exhibited promoter activity<sup><xref ref-type="bibr" rid="c45">45</xref></sup> and suggests the frequency of promoter-like activity in overall sequence space is seemingly very high. These results demonstrate that the negative controls used in our assay are depleted in promoter activity, even compared to completely random sequences, and implies that there is negative selection for spurious promoter activity across certain regions of the <italic>E. coli</italic> genome.</p>
</sec>
<sec id="s2b">
<title>Chromosomal-position specific effects are consistent across diverse promoter sequences</title>
<p>Several recent studies have shown that promoter expression levels can be highly variable between genomic locations<sup><xref ref-type="bibr" rid="c25">25</xref>,<xref ref-type="bibr" rid="c27">27</xref>,<xref ref-type="bibr" rid="c28">28</xref></sup>. However, these studies have primarily focused on individual promoters in multiple locations, leaving uncertainty regarding whether these effects are promoter-specific or represent a more widespread phenomenon impacting any promoter at a given position. To study these chromosomal position effects across a wide range of promoters, we integrated the entire TSS promoter library in both left and right chromosomal midreplichores and compared expression measurements between these positions and the <italic>E. coli</italic> chromosomal terminus (<bold>Figure S1C</bold>). Promoter measurements remained highly consistent between locations, although the two midreplichore positions exhibited slightly higher concordance with each other (<italic>r</italic> = 0.97, <italic>p</italic> &lt; 2.2 x 10<sup>-16</sup>), than either midreplichore to the terminus (<italic>r</italic> = 0.95, <italic>p</italic> &lt; 2.2 x 10<sup>-16</sup>). Positive control sequences, which do not contain regulatory elements in addition to the RNAP binding sites, were highly correlated between all locations. We conclude that overall, diverse promoters exhibit similar relative expression levels across genome-positions, although the absolute expression may vary.</p>
</sec>
<sec id="s2c">
<title>Inactive TSS-associated promoters are enriched for −10 but not −35 σ70 binding motifs</title>
<p>A majority of <italic>E. coli</italic> promoters are regulated by the housekeeping sigma factor σ70<sup><xref ref-type="bibr" rid="c46">46</xref></sup>, and thus we expected that active promoters would be enriched for the canonical σ70 motifs. Promoters of the σ70 family are well known for containing two hexamer motifs, the −10 and −35 motifs, which recruit RNAP and are named after their position relative to the TSS. We used a σ70 position-weight matrix (PWM)<sup><xref ref-type="bibr" rid="c16">16</xref></sup> to analyze whether active TSS promoters were enriched for these motifs. Although both active and inactive TSS-associated promoters were enriched for the canonical −10 motif compared to our negative controls (active: <italic>p</italic> &lt; 2.2 x 10<sup>-16</sup>, inactive: <italic>p</italic> = 6.2 x 10<sup>-8</sup>), we found the −35 scores of inactive promoters were generally no greater than negative controls (<italic>p</italic> = 0.33) (<bold><xref rid="fig1" ref-type="fig">Figure 1F</xref></bold>). Conversely, active TSS-associated promoters contained significantly higher −35 scores than negative controls (<italic>p</italic> = 1.4 x 10<sup>-8</sup>) or inactive TSS-associated promoters (<italic>p</italic> &lt; 2.2 x 10<sup>-16</sup>). We conclude that inactive TSS-associated promoters lack −35 elements but may become active in growth conditions where additional transcription factors mobilize and facilitate RNAP positioning in the absence of a −35 motif.</p>
</sec>
<sec id="s2d">
<title>Genome-wide Identification of <italic>E. coli</italic> promoters</title>
<p>Despite functionally screening 17,635 previously implicated TSS regions, we encountered instances where essential operon promoters remained unidentified, suggesting that there were still undiscovered promoters within the genome. For instance, despite screening several reported TSS regions upstream of the essential <italic>yrbA-murA</italic> operon, none exhibited expression greater than our activity threshold. To comprehensively detect all promoters, we cloned, barcoded, and measured the transcriptional activity in LB of 321,123 sheared genomic fragments ranging between 200 and 300 bp (median = 244 bp), providing ∼8.5x coverage per strand of the <italic>E. coli</italic> genome (<bold><xref rid="fig2" ref-type="fig">Figure 2A</xref>, Figure S3A, Figure S3B</bold>). We averaged the expression of fragments overlapping each nucleotide position to achieve highly replicable values of strand-specific promoter activity at single-nucleotide resolution (<bold>Figure S3C</bold>). This data may be viewed using our online tool (<ext-link ext-link-type="uri" xlink:href="https://ecolipromoterdb.com">https://ecolipromoterdb.com</ext-link>), revealing defined regions of promoter activity across the entire <italic>E. coli</italic> genome (<bold><xref rid="fig2" ref-type="fig">Figure 2B</xref></bold>). We classify candidate promoter regions as contiguous regions of at least 60 bp with promoter activity measurements higher than an empirically derived threshold. This threshold was established to maximize recall of previously identified active TSSs while minimizing the inclusion of inactive TSSs.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2</label>
<caption><title>Genome-wide Identification of <italic>E. coli</italic> promoters.</title>
<p><bold>A)</bold> 321,123 sheared genomic fragments were screened using the same MPRA platform. The fragments were 200 to 300 bp in size giving an average 8.5x coverage across each strand of the <italic>E. coli</italic> genome. Promoter activity of each fragment was measured and averaged at each position to recover nucleotide-specific expression. <bold>B)</bold> We created a website to showcase the <italic>E. coli</italic> promoter landscape (<ext-link ext-link-type="uri" xlink:href="https://ecolipromoterdb.com/">https://ecolipromoterdb.com/</ext-link>). This section of the genome displayed in this figure contains five candidate promoter regions that appear within intergenic regions. <bold>C)</bold> Meta-analysis of mean promoter activity at experimentally validated active TSSs, inactive TSSs, and negative controls. <bold>D)</bold> Oligo tiling library identifies promoters within candidate promoter regions. We synthesized 150 bp oligos tiling all promoter regions identified in rich media at 10 bp intervals. We then determine minimal promoter boundaries by identifying the overlap of transcriptionally active tiles. <bold>E)</bold> Oligo tile expression across the <italic>mraZ</italic> promoter shows two distinct promoters. Positions are defined according to the right-most genomic position of each 150 bp oligo. Dashed line indicates the threshold for active oligo tiles <bold>F)</bold> Distribution of the number of promoters per promoter region shows many regions contain multiple promoters. <bold>G)</bold> Left: Distribution of the lengths of the minimal promoter boundaries shows enrichment for σ70-promoter sized regions (40 bp). Right: 40 bp minimal promoters (red) span a wide range of expression whereas 150 bp promoters are typically weak (blue).</p></caption>
<graphic xlink:href="894907v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>With the chosen threshold, we found 3,477 candidate promoter regions in LB that overlapped 2,293/2,670 (85.8%) active TSSs identified in LB, 3,193/14,493 (22.0%) inactive TSSs, and 47/482 (9.75%) negative controls. Active TSSs not overlapping a candidate promoter region generally exhibited weak activity, which may indicate that greater sensitivity is achieved through testing of oligo-array synthesized regions (<bold>Figure S3D</bold>). In many cases, candidate promoter regions overlapped multiple TSS-associated promoters, both active and inactive, indicating the potential for multiple promoters within individual regions (<bold><xref rid="fig2" ref-type="fig">Figure 2B</xref>)</bold>. Overall, we detected strong promoter activity at active TSSs with little promoter activity at inactive TSS promoters, demonstrating agreement between these independent methods for capturing genome-wide promoter activity (<bold><xref rid="fig2" ref-type="fig">Figure 2C</xref></bold>).</p>
</sec>
<sec id="s2e">
<title>Fine mapping of <italic>E. coli</italic> promoters within transcriptionally active regions</title>
<p>Our survey of genomic fragments identified candidate regions of promoter activity that were well above the expected size of typical promoters (<bold>Figure S3E</bold>)<sup><xref ref-type="bibr" rid="c39">39</xref></sup>. To determine if these candidate regions contained multiple promoters, we constructed a library of 48,379 150 bp oligos that tiled the entire lengths of the 3,477 promoter regions identified in LB at 10 bp intervals (<bold><xref rid="fig2" ref-type="fig">Figure 2D</xref></bold>). For candidate promoter regions under 150 bp, we synthesized a single oligo encoding the region without including additional surrounding sequence context. We recovered highly replicable data for 45,201(93.4%) of these variants with an average of 8 barcodes per variant (<bold>Figure S3F, S3G</bold>). Using this approach, we could precisely pinpoint the boundaries of promoters by observing the specific locations along the promoter region where tiled oligos exhibited changes in expression levels. (<bold><xref rid="fig2" ref-type="fig">Figure 2E</xref></bold>). This analysis revealed that 1,889 of the previously identified promoter regions contained one or more discrete promoters, including 278 regions containing multiple promoters (<bold><xref rid="fig2" ref-type="fig">Figure 2F</xref>)</bold>. Notably, the number of promoters within a given region correlated with the size of the candidate region (<bold>Figure S3H</bold>) but not necessarily the overall promoter activity of the region (<bold>Figure S3I</bold>). In 1,465 candidate regions, no promoters were detected. These regions typically measured under 150 bp in length, raising the possibility of being false positives or potentially requiring additional transcription factors beyond the scope of the 150 bp regions assessed. Altogether, this approach identified 2,228 distinct promoters active in LB. Furthermore, by determining the overlap of all active oligos tiling a promoter, we were able to infer the minimal sequence necessary for each promoter. When comparing the sizes of the minimal sequence necessary for promoter activity, we observed an enrichment for sequences of approximately 40 bp, which is a typical size for σ70 promoters<sup><xref ref-type="bibr" rid="c47">47</xref>–<xref ref-type="bibr" rid="c49">49</xref></sup> (<bold><xref rid="fig2" ref-type="fig">Figure 2G</xref></bold>). We also observed an enrichment for 150 bp minimal promoter regions, although these were generally weak indicating that our resolution is limited when tiling weaker promoters. Overall, we were able to precisely map boundaries for 2,228 promoters active in LB. Considering non-overlapping active promoters identified during our TSS screen, we find 2,859 distinct promoters. Amongst these promoters, we have identified promoters regulating 99 out of 100 randomly sampled essential genes including the promoter for the essential <italic>yrbA-murA</italic> operon which was missed in the TSS screen (<bold>Supplementary Table 1</bold>). The missing promoter was for the <italic>yjeE</italic> gene, which exhibits an atypical operon structure, wherein the first gene in the operon overlaps a gene encoded in the opposite direction. Furthermore, we detected promoter activity in regions 100 bp upstream of 24 of 38 recently described small open reading frames (smORFs) identified by ribosome profiling <sup><xref ref-type="bibr" rid="c50">50</xref></sup>, indicating that these proteins may be transcriptionally-regulated independently of larger neighboring genes (<bold>Figure S4</bold>).</p>
</sec>
<sec id="s2f">
<title>Intragenic promoters are widespread, often found in the antisense orientation, and alter transcript levels and codon usage of the genes they are within</title>
<p>While promoters are commonly thought of as gene regulatory sequences upstream of transcribed genes, they can also be found within genes and oriented to transcribe genes in the antisense direction. We thus sought to explore these atypical promoters and their consequences on the <italic>E. coli</italic> genome and transcriptome. Many studies have found pervasive antisense transcription in prokaryotes <sup><xref ref-type="bibr" rid="c51">51</xref>–<xref ref-type="bibr" rid="c54">54</xref></sup>, though there is controversy over the functional relevance and whether they are just due to a noisy transcriptional apparatus<sup><xref ref-type="bibr" rid="c55">55</xref></sup>. At the same time, it has been functionally shown that antisense promoters can alter a sense gene’s transcription, translation, and steady-state message levels<sup><xref ref-type="bibr" rid="c35">35</xref>,<xref ref-type="bibr" rid="c56">56</xref></sup>. Amongst the 2,228 promoters we precisely mapped, 1,131 were primarily encoded within intergenic regions while 944 were found to fully or mostly overlap intragenic regions (<bold><xref rid="fig3" ref-type="fig">Figure 3A</xref>, Figure S5A</bold>). Notably, intragenic promoters exhibited a higher prevalence within single-gene operons compared to individual genes within polycistronic operons (p = 1.05 x 10<sup>-9</sup>, df = 1, Chi-squared Test). Although intergenic promoters were predominantly positioned in the sense orientation relative to the nearest downstream gene, 300 of the 944 intragenic promoters were positioned antisense relative to the genes they overlapped. Interestingly, intragenic promoter activity had greater correlation when comparing activity between growth mediums, indicating that these regions may be primarily composed of constitutive promoter elements (LB: <italic>r</italic> = 0.648, M9 minimal: <italic>r</italic> = 0.787, <italic>p</italic> &gt; 1 x 10<sup>-16</sup>, Wilcoxon rank-sum test, <bold>Figures S5B-C</bold>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3</label>
<caption><title>Intragenic promoters are widespread, often found in the antisense orientation, and alter transcript levels and codon usage of the genes they are within.</title>
<p><bold>A)</bold> Orientation and positioning of identified promoters reveals many promoters are intragenic and antisense. <bold>B)</bold> Antisense promoters suppress gene expression genome-wide. Left: Meta-gene analysis of the median RNA-Seq coverage across all sense, antisense, and dual-regulated genes. Right: Meta-gene analysis of sense promoter activity at sense, antisense, and dual regulated genes. <bold>C)</bold> Intragenic promoters are enriched for specific amino acids relative to whole genome amino acid frequencies (Chi-squared test, “*” = <italic>p</italic> &lt; 0.05). Amino acids are arranged by mean AT-content of all corresponding codons. <bold>D)</bold> Specific, often rare, codons are enriched in intragenic promoters. Codon bias within intragenic promoters relative to whole genome. Bars are colored by the relative genome-wide usage compared to other synonymous codons (Chi-squared test, “*” = <italic>p</italic> &lt; 0.05).</p></caption>
<graphic xlink:href="894907v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Given that we have determined the locations of the antisense promoters driving transcription, we evaluated the genome-wide consequences of antisense promoters on the transcriptome. We performed RNA-Seq on <italic>E. coli</italic> MG1655 grown in LB and compared the transcript coverage of all genes with sense promoters, antisense promoters, and both sense and antisense promoters. We found that overall, genes regulated by both sense and antisense promoters exhibited a two-fold decrease in expression compared to strictly sense-regulated genes (<bold><xref rid="fig3" ref-type="fig">Figure 3B</xref></bold>). Notably, sense-regulated genes exhibited similar promoter activity on average when compared to genes with both sense and antisense promoters, indicating that the result cannot be attributed solely to stronger promoters in sense-regulated genes. Genes with only antisense promoter activity generally did not exhibit detectable sense transcription.</p>
<p>The significant overlap observed between protein-coding and promoter sequences is interesting given the sequence specificity necessary to encode these distinct functions. Therefore we sought to investigate how sequences navigate this constraint to accommodate diverse activities. After comparing the amino acid composition within intragenic promoters, we observed a significant enrichment of stop codons and a preference for amino acids encoded by codons with higher AT nucleotide content (<bold><xref rid="fig3" ref-type="fig">Figure 3C</xref></bold>). Further inspection revealed specific codons that were preferentially utilized within intragenic promoter regions (<bold><xref rid="fig3" ref-type="fig">Figure 3D</xref></bold>), with a notable bias observed among arginine codons, showing a strong preference for AGA and AGG codons. The most enriched codons within intragenic promoters were typically rare in the genome, which may indicate a role of preferential codon usage in controlling promoter activity within genes. The connection between rare codons and regulatory roles has been previously observed in the context of N-terminal codon bias, where rare codons influenced expression levels through secondary structure interactions<sup><xref ref-type="bibr" rid="c57">57</xref></sup>. Moreover, the observed higher percentage of AT-content<sup><xref ref-type="bibr" rid="c58">58</xref>,<xref ref-type="bibr" rid="c59">59</xref></sup> and rare codons<sup><xref ref-type="bibr" rid="c60">60</xref></sup> may further support the notion that intragenic promoters are linked to horizontally-acquired genes.</p>
<p>Next, we investigated how intragenic promoter sequences had adapted to conform to the constraints of protein-coding sequence space. A peculiar feature of promoter sequences in <italic>E. coli</italic>, is the presence of trinucleotides matching stop codons within the canonical −10 and −35 σ70 motifs (−35: 5’-T<bold>TGA</bold>CA, −10: 5’-TA<bold>TAA</bold>T). Therefore, we hypothesized that the reuse of these nucleotide patterns offers another mechanism by which the <italic>E. coli</italic> genome counteracts the spurious evolution of intragenic promoters, thereby explaining their scarcity relative to the ease by which they can evolve<sup><xref ref-type="bibr" rid="c45">45</xref></sup>. We used a σ70 PWM<sup><xref ref-type="bibr" rid="c16">16</xref></sup> to identify the highest-scoring σ70 motifs within intragenic promoters and determined their relative coding frames. Interestingly, we observed a lower frequency of −35 elements in +2 coding frames and the −35 motifs detected at +2 positions exhibited significantly reduced resemblance to the canonical motif (<bold>Figure S6A</bold>). Similarly, −10 motifs were least frequently found in the +1 positions, although −10 motifs at this position did not show lower overall scores (<bold>Figure S6B</bold>). The observed depletion of −35 motifs positioned in the +2 reading frame and −10 motifs in the +1 reading frame is likely due to the fact that the canonical sequences for these motifs would create stop codons within the protein if placed at these positions. This suggests a simple, but effective preventative mechanism against the spurious evolution of intragenic promoters that is inherent to their sequence motifs.</p>
</sec>
<sec id="s2g">
<title>The <italic>E. coli</italic> promoter landscape is dynamic in response to environmental conditions</title>
<p>It is well understood that bacterial cells respond to environmental conditions through changes in their transcriptional profiles<sup><xref ref-type="bibr" rid="c61">61</xref></sup>, however, it has not been shown how the global promoter landscape changes to facilitate these cellular transitions. To explore this, we measured promoter activity of our genomic fragment library in exponentially growing cells under glucose minimal media conditions. Compared to LB, cells grown in glucose minimal media do not have access to environmental amino acids and must synthesize these and other essential compounds on their own<sup><xref ref-type="bibr" rid="c62">62</xref></sup>. We recovered replicable promoter activity measurements for 318,457 genomic fragments in glucose minimal media, spanning the genome with 8.38x coverage (<bold>Figure S7A, Figure S7B</bold>). We identify 3,321 candidate promoter regions in glucose minimal media with an average length of 293 bp (<bold>Figure S7C</bold>). Although 2,466 of these regions overlapped with regions found in LB, we found 960 only found in LB and 1,029 exclusive to M9 <bold>(<xref rid="fig4" ref-type="fig">Figure 4A</xref>)</bold>. Many of these condition-dependent promoter regions were weak compared to those identified in both conditions <bold>(Figure S7D)</bold>, nonetheless, each condition revealed distinct strongly activated regions unique to it. The observed low activity of condition-unique promoters is similar to what has been observed in synthetic inducible promoter systems, where tightly-regulated promoters often exhibit reduced expression in induced conditions<sup><xref ref-type="bibr" rid="c63">63</xref></sup>. To identify the most differentially-expressed promoters in each condition, we extracted regions larger than 60 bp that exhibited greater than two-fold difference in activity between conditions. With this criterion, we found 278 regions upregulated in LB and 644 regions upregulated in glucose minimal media. In glucose minimal media, the greatest increase in promoter activity occurred at <italic>ryhB</italic>, a Fur-regulated gene encoding a small RNA that regulates iron-binding and iron-storing proteins when available iron is limited<sup><xref ref-type="bibr" rid="c64">64</xref>,<xref ref-type="bibr" rid="c65">65</xref></sup> <bold>(Figure S7E).</bold> In LB, the strongest activated region is positioned to drive expression of the <italic>rbsDACBKR</italic> operon, which is essential for uptake and utilization of extracellular ribose<sup><xref ref-type="bibr" rid="c66">66</xref></sup> <bold>(Figure S7E)</bold>.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4</label>
<caption><title>The <italic>E. coli</italic> promoter landscape dynamically responds to environmental conditions.</title>
<p><bold>A)</bold> Shared and unique promoter regions are found between LB and glucose minimal media. <bold>B)</bold> Genes activated by promoters in glucose minimal media are enriched for amino acid-related genes according to RAST subsystem annotations. <bold>C)</bold> Occurrence of reported transcription factor binding sites in promoter regions activated in LB compared to glucose minimal media (M9). Black lines indicate 2-fold enrichment threshold. <bold>D)</bold> Number of binding sites per transcription factor within activated promoter regions. A median of four sites per transcription factors were activated in LB and a median of five sites in M9.</p></caption>
<graphic xlink:href="894907v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For each condition, we matched activated intergenic and sense promoter regions with the nearest downstream gene and found 159 genes poised for activation in LB and 392 genes poised for activation in glucose minimal media. To see if promoter activation resulted in an increase in expression of these genes, we compared RNA-Seq coverage of the genes with the top 100 strongest promoter activation in each condition (<bold>Figure S8</bold>). In each condition, promoter activation resulted in a concomitant increase in RNA-Seq coverage (LB: <italic>p</italic> = 1.1 x 10<sup>-5</sup>, M9: <italic>p</italic> = 1.9 x 10<sup>-5</sup>, Wilcoxon rank-sum test). To see which cellular responses were being mobilized by remodeling the promoter landscape, we used the RAST annotation engine<sup><xref ref-type="bibr" rid="c67">67</xref>,<xref ref-type="bibr" rid="c68">68</xref></sup> to assign functional categories to activated genes and identify enriched cellular processes. Genes downstream of promoter regions activated in LB are predominantly associated with carbohydrate utilization whereas genes downstream of promoters activated in glucose minimal media were associated with amino acid utilization (<bold><xref rid="fig4" ref-type="fig">Figure 4B</xref></bold>). Overall, we find distinct condition-dependent activation of promoter regions leading to changes in gene expression associated with carbohydrate utilization in LB and amino acid utilization in glucose minimal media.</p>
<p>Next, we explored how these changes in the promoter landscape are mediated by transcriptional machinery and evaluated the transcription factor binding site (TFBS) composition of promoter regions activated in each condition. As opposed to traditional transcriptomebased measurements which measure changes in downstream gene expression, this assay identifies upstream regulatory regions that contribute to promoter activity in response to changing conditions. By cross-referencing these activated promoter regions to TFBSs reported by RegulonDB, we identified transcription factors facilitating these changes to the promoter landscape (<bold><xref rid="fig4" ref-type="fig">Figure 4C</xref></bold>). Upon comparing TFBS content of these regions we found that binding sites for several global transcriptional regulators<sup><xref ref-type="bibr" rid="c69">69</xref></sup>, including IHF, Lrp, and Fis occurred at similar frequencies between these conditions. Conversely, binding sites for Fur, another global transcription factor, were enriched by roughly 20-fold within regions activated in glucose minimal media compared to regions activated in LB. This transcription factor is essential for maintaining iron homeostasis<sup><xref ref-type="bibr" rid="c70">70</xref>,<xref ref-type="bibr" rid="c71">71</xref></sup>, and is a known regulator of <italic>ryhB,</italic> the most upregulated gene we found in glucose minimal media. Binding sites for CRP were enriched by more than two-fold in regions activated in LB compared to glucose minimal media. This transcription factor is activated in glucose-limited conditions and so would likely not induce promoter activity in glucose minimal media. Overall, we found 455 TFBSs within regions activated in LB and 637 annotations in regions activated in glucose minimal media (<bold><xref rid="fig4" ref-type="fig">Figure 4D</xref></bold>). In addition to global regulators, we found many TFBSs that appear exclusive to each condition targeting relatively few regulatory targets. Interestingly, the combined contribution of non-global transcription factors activating 10 or fewer sites were responsible for over a third of all activated promoter regions, underscoring the significant involvement of local transcriptional regulators in driving the overall changes to the transcriptome. Transcription factors MetJ, GadX, and GadW were exclusively found in regions activated in glucose minimal media whereas FlhDC, GlpR, and CytR were the most enriched amongst regions activated in LB.</p>
</sec>
<sec id="s2h">
<title>Mutational scanning of 2,057 <italic>E. coli</italic> promoters identifies regulatory elements controlling transcription</title>
<p>After globally identifying promoter regions in the bacterial genome, we sought to develop an approach to identify sequence motifs regulating these promoters. Recent work has demonstrated a high-resolution saturation mutagenesis approach to identify regulatory motifs within individual uncharacterized promoters<sup><xref ref-type="bibr" rid="c21">21</xref>,<xref ref-type="bibr" rid="c72">72</xref></sup>. Inspired by this work, we implemented a scanning mutagenesis strategy to explore the sequence features that regulate active promoters. For 2,057 active TSS- associated promoters identified in LB, we systematically scrambled individual 10 bp sequences spanning the −120 to +30 positions at five bp intervals (<bold><xref rid="fig5" ref-type="fig">Figure 5A</xref></bold>). Using this approach, we would expect that disrupting a repressor site would increase expression, whereas disrupting a RNAP or activator site would decrease expression. These scrambled sequences were designed to maximize distance from the original sequence while maintaining nucleotide content, ensuring perturbation of any motifs at each position contributing to transcriptional regulation. In total, we designed a library of 59,653 sequences consisting of 2,057 active TSS-associated promoters, their scrambled variants, and the previously described set of negative and positive controls. We measured promoter activity of this library as before and recovered replicable expression measurements for 52,900/59,653 (89%) of this library in LB, with an average of seven barcodes per variant (<bold>Figure S9A, S9B</bold>). Using this approach, we identify regions that either increased or reduced expression across thousands of promoters in a single assay (<bold><xref rid="fig5" ref-type="fig">Figure 5B</xref></bold>). These sequences were enriched at the −35 and −10 positions for regions that increased expression, which is expected considering the majority of promoters are σ70 dependent. However, many sequences outside of these −10 and −35 regions were also found to contribute to regulation.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5</label>
<caption><title>Scanning mutagenesis of 2,057 TSS-associated promoters identifies known and novel regulatory motifs.</title>
<p><bold>A)</bold> Scanning mutagenesis of 2,057 <italic>E. coli</italic> promoters to identify regulatory elements. For each promoter, 10 bp regions were mutated across the full length of the promoter at 5 bp intervals. <bold>B)</bold> Mutating each position across <italic>E. coli</italic> promoters identifies sequences that activate and repress promoter activity. Rows are rearranged using hierarchical clustering and the intensities are normalized within each row. <bold>C)</bold> Scanning mutagenesis of the well-characterized (Left) <italic>lacZYA</italic> and (Right) <italic>relBE</italic> promoters captures known regulatory elements. <bold>D)</bold> Scanning mutagenesis of the newly characterized (Left) <italic>cfa</italic> and (Right) <italic>rpsL</italic> promoters identifies regions encoding regulation within these promoters.</p></caption>
<graphic xlink:href="894907v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To validate our approach, we first examined the <italic>lacZYA</italic> promoter, a classic gene regulation model whose sequence motifs are well characterized. This promoter is known to contain a variety of regulatory motifs, including twin LacI repressor sites centered at +11 and −82<sup><xref ref-type="bibr" rid="c73">73</xref></sup>, a CRP activator site centered at −61<sup><xref ref-type="bibr" rid="c74">74</xref></sup>, and a σ70 RNAP binding site. Our analysis revealed distinct signals corresponding to each of these sites, as well as quantitative measurements for their contribution to expression (<bold><xref rid="fig5" ref-type="fig">Figure 5C</xref></bold>). Additionally, scanning mutagenesis of the previously characterized <italic>relBE</italic> promoter achieved similar results, identifying a reported RelBE repressor site at the +1 position<sup><xref ref-type="bibr" rid="c75">75</xref></sup> as well as −10 and −35 σ70 recognition motifs<sup><xref ref-type="bibr" rid="c75">75</xref></sup>.</p>
<p>Considering that our approach effectively captures the effects of known binding sites, we proceeded to investigate whether it could also identify regulatory sites within uncharacterized promoters. Although we performed this scanning mutagenesis for 2,057 TSS-associated promoters, here we highlight a few examples to demonstrate the utility of this method (<bold><xref rid="fig5" ref-type="fig">Figure 5D</xref></bold>). The cyclopropane fatty acyl phospholipid synthase gene, <italic>cfa,</italic> exhibits dynamic expression<sup><xref ref-type="bibr" rid="c76">76</xref></sup> and plays a crucial role in cell membrane integrity under acidic conditions <sup><xref ref-type="bibr" rid="c77">77</xref></sup>. While there have been several transcription factors implicated in regulation of <italic>cfa</italic>, the motifs responsible for its direct regulation are still unknown. Our approach identified a candidate σ70 promoter regulating this gene with a −10 motif centered 34 nucleotides upstream of the reportedly associated TSS as well as a −35 motif 57 bp upstream, implying that the reported TSS is likely not the primary site for transcription initiation. Additionally, we identified two repressor sites—one located in the spacer region and another upstream of the −35 motif. We also identified novel regulatory regions for an uncharacterized promoter regulating <italic>rpsL</italic>, an essential gene and component of the 30S ribosomal subunit. In this case, we identified a candidate σ70 RNAP binding site with predictably positioned −10 and −35 motifs, as well as an unknown repressor located over the transcription start site. Notably, mutating the repressor site resulted in a threefold increase in promoter expression. Although further experiments<sup><xref ref-type="bibr" rid="c21">21</xref></sup> are necessary to identify the transcription factors acting on these promoters, our results provide valuable insights by pinpointing the sequence elements responsible for the regulation of these genes.</p>
</sec>
<sec id="s2i">
<title>Global identification of 7,293 <italic>E. coli</italic> promoter regulatory motifs</title>
<p>We expanded the scope of our analysis to systematically explore the regulatory motifs amongst all 2,057 promoters tested. We used individual barcode measurements, across four replicates, to find significant differences between the mean expression of the WT and mutated sequences (Student’s t-test with 1% FDR). Among the mutations that significantly altered expression, 1,885 increased expression whereas 5,408 decreased expression (<bold><xref rid="fig6" ref-type="fig">Figure 6A</xref></bold>). Mutated sites were located throughout promoters and resulted in dramatic changes in expression, some over 100-fold (<bold>Figure S10A</bold>). We observed markedly different distributions for the positions of sequences that increased expression compared to those causing decreased expression (<bold><xref rid="fig6" ref-type="fig">Figure 6B</xref></bold>). Regions that increased expression were enriched at the −10, −35, and −70 positions, which is consistent with the σ70 RNAP binding motif as well as the typical position of transcriptional activators among class I bacterial promoters<sup><xref ref-type="bibr" rid="c78">78</xref>–<xref ref-type="bibr" rid="c80">80</xref></sup>. Regions that decrease expression were found to localize to the TSS, spacer, and −35, which is consistent with known mechanisms of RNAP occlusion by steric hindrance<sup><xref ref-type="bibr" rid="c80">80</xref>,<xref ref-type="bibr" rid="c81">81</xref></sup>. Alternatively, repressive sites within the spacer could be negatively influencing transcriptional initiation through transcription factor-independent mechanisms <sup><xref ref-type="bibr" rid="c82">82</xref></sup>. Furthermore, we found that intergenic promoters contained more regions that altered promoter activity when scrambled compared to intragenic promoters, implying that intragenic promoter sequences contain more compact or fewer regulatory elements (<bold>Figure S10B</bold>).</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6</label>
<caption><title>Global identification of 3,317 <italic>E. coli</italic> regulatory motifs by scanning mutagenesis.</title>
<p><bold>A)</bold> We identified scrambled regulatory regions that significantly increase (N = 1,885) or decrease (N=5,408) expression when scrambled relative to the unscrambled promoter. Data are colored by whether the regulatory region activates or represses activity of the promoter. <bold>B)</bold> Activating promoter sequences are enriched at the −10, −35, and −80 positions whereas repressing sequences are enriched at +1, −20, and −50 positions. <bold>C)</bold> Identified regulatory regions overlapping reported TFBS annotations shows mixed concordance with reported effects; 77.8% (2,583/3,317) of identified regulatory regions are unreported by RegulonDB. <bold>D)</bold> Scanning mutagenesis of the <italic>FadR</italic> promoter (bottom) identifies a repressing sequence near the −30 that has been reported to be activating (top).</p></caption>
<graphic xlink:href="894907v2_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Next, we cross-referenced these regulatory regions with the extensive collection of putative and experimentally determined regulatory sites reported by RegulonDB<sup><xref ref-type="bibr" rid="c83">83</xref></sup>. First, for all promoter mutagenesis profiles, we merged adjacent regions found to influence promoter activity, resulting in the identification of 1,414 regions that increase expression and 1,903 regions that decrease expression. Sites were 20 bp on average (indicating they exhibited regulatory impacts across four consecutive 10 bp scramble mutations spaced 5 bp apart) (<bold>Figure S10C</bold>) with effect sizes largely independent of their lengths (<bold>Figure S10D</bold>). Of the 2,453 unique TFBSs reported by RegulonDB, 1,156 overlap with regulatory regions identified by our analysis and 49% (567/1,156) resulted in a significant change in activity of the promoter. The effect we observed after disrupting these reported TFBSs often did not agree with the annotated effect. Our scrambling results agreed with the reported effect for 65% (185/253) of activators and 43% (196/450) of repressors (<bold><xref rid="fig6" ref-type="fig">Figure 6C</xref></bold>). We presumed the lower concordance with repressors could be due to scrambling mutations disrupting both a repressor and −35 or −10 element, resulting in a decrease in expression which would appear to contradict a reported repressor site. Looking at the distribution of concordance for merged scrambles by position relative to the TSS, we observed a higher proportion of disagreement near the −35 and −10 elements, suggesting overlapping scrambles may be disrupting crucial promoter elements in addition to reported repressor sites (<bold>Figure S10E, S10F</bold>). This may be expected considering that many repressors operate by binding regions proximal to the RNAP binding site. Regardless, we found several examples where the regulatory effects predicted by RegulonDB were contradicted with strong evidence, which may indicate that the effect of the reported annotation is incorrect or that these sites may support multiple transcription factors (<bold><xref rid="fig6" ref-type="fig">Figure 6D</xref></bold>). Overall, we characterized regulatory sequences in promoters driving expression of 1,158 of the 2,565<sup><xref ref-type="bibr" rid="c83">83</xref></sup> operons in <italic>E. coli</italic> as well as many other confirmed promoters. Thus, we conclude that this approach is an efficient and effective method to rapidly characterize regulatory motifs within thousands of experimentally verified promoter regions.</p>
</sec>
<sec id="s2j">
<title>Predicting promoter activity from sequence remains a challenge</title>
<p>In this study we generated a powerful dataset linking 117,556 unique 150 bp sequences to a quantitative measurement of <italic>in vivo</italic> promoter activity. Using this unique dataset, we evaluated our ability to determine whether a promoter was active or inactive (classification) and the precise level of activity (regression). We trained several machine learning models of varying complexity for both classification and regression. As many sequences are highly similar due to library design and close proximity of previously reported TSSs, we split the data into 75% for training (n = 87,164) and 25% (n = 30,392) for testing according to genomic location, ensuring the two sets contain sequences equidistant to the origin (see Methods). For classification, we determined a threshold independently for each library based on the negative controls. Sequences are considered active if their expression is greater than two standard deviations above the negative median value and inactive if expression falls below this threshold.</p>
<p>We trained several different classifiers to predict whether a given sequence was active or inactive (<bold><xref rid="fig7" ref-type="fig">Figure 7A</xref></bold>). All classifiers output the predicted probability for each class, rather than directly predicting the class, allowing them to be compared using precision-recall curves. Further details for all models are included in the methods. We trained a simple logistic regression based on four biophysical features known to be associated with promoter strength: max −10 σ70 motif position weight matrix (PWM) score, max σ70 −35 motif PWM score, paired −10 and −35 PWM score (PWMs scanned jointly allowing for, 16, 17, or 18 gap between the −10 and −35), and percent GC content. We trained this model only using variants from the TSS library, which contained the greatest diversity, as the model was unable to converge when trained on the full dataset. For comparison, we trained a gapped k-mer SVM (gkm-SVM) model with word-length 10 and 8 informative columns (L = 10, K = 8) on the same training set, as this model is best suited for sample sizes under 20,000 and observed decreased performance relative to the logistic regression (AUPRC = 0.43, AUPRC = 0.53, respectively). Furthermore, we created a feature set of all 3 to 6-mer frequencies and trained a logistic regression, partial least squares discriminant analysis (PLS-DA), and multi-layer perceptron (MLP). To observe the effects of reducing dimensionality, we additionally trained on only 6-mer frequencies for the MLP and random forest. For the simpler logistic regression and PLS-DA we performed an additional feature selection step based on the performance of a random k-mer. All models performed similarly, with AUPRC ranging from 0.26 to 0.33.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7</label>
<caption><title>Various machine learning models for promoter activity classification and regression.</title>
<p><bold>A)</bold> Performance of various models to classify promoter sequences. Convolutional neural networks performed best in the lower recall range, while logistic regression based on simple hand-crafted features performs better in the higher recall range. Dashed line represents the expected performance from random prediction using full library. <bold>B)</bold> Performance of regression models to predict a quantitative level of promoter activity. We evaluated performance using both root mean squared error (RMSE) and coefficient of determination (<italic>R</italic><sup>2</sup>) on the held-out test set. Similar to classification, convolutional neural networks performed the best with the lowest RMSE and highest <italic>R</italic><sup>2</sup>.</p></caption>
<graphic xlink:href="894907v2_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>There has been recent work predicting transcriptional regulatory activity from MPRA data using convolutional neural networks (CNNs), which capture intricate sequence features without <italic>a priori</italic> knowledge<sup><xref ref-type="bibr" rid="c84">84</xref></sup>. Inspired by this work, we trained a CNN using the DragoNN toolkit which is built on top of the keras python package<sup><xref ref-type="bibr" rid="c85">85</xref></sup>. We performed hyperparameter tuning for a three-layer CNN and achieved an AUPRC = 0.44. Next, we compared the CNN to other machine learning models that require less hyperparameter tuning and are more interpretable. For comparison, we trained a random forest on one-hot encoded DNA, which is not well suited to categorical features, and achieved an AUPRC = 0.27. Furthermore, we trained this model using frequencies of 6-mers and observed a slight increase in performance (AUPRC = 0.31). Overall, the CNN achieved the highest AUPRC, but the logistic regression fit with biophysical features more accurately at higher levels of recall. However, these two models may not be directly comparable, as the logistic regression was trained on only the TSS library rather than the full dataset.</p>
<p>We separately trained all of the models described above, with the exception of gkm-SVM, for the more difficult task of regression (<bold><xref rid="fig7" ref-type="fig">Figure 7B</xref></bold>). Additionally, we included a linear regression model that fit to the four “mechanistic” features to predict log-transformed expression. We evaluated each model using root mean squared error (RMSE) and <italic>R</italic><sup>2</sup> between predicted and observed values for promoter activity. Many models perform similarly to each other, with the CNN achieving the highest R-squared and lowest RMSE (RMSE = 3.12, <italic>R</italic><sup>2</sup> = 0.31, <italic>p</italic> &lt; 2.2 x 10<sup>-16</sup>). We observe improvement in the linear regression on log-transformed data compared to linear regression without transformation, suggesting there are non-linear relationships that are presumably captured by more complex models. Random forest on one-hot encoded DNA performs worse than random forest on 6-mer frequencies, in line with the heuristic that random forests are not well suited to categorical features. Overall, the CNN performs best in both classification and regression, although simpler models have some predictive power and have the benefit of faster training times.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>More than fifty years have passed since the first conceptions of what bacterial promoters were. Today, <italic>E. coli</italic> promoters are arguably the most well-studied gene regulatory element and yet we cannot seem to agree on basic questions of how many promoters exist, what elements define their function, how constrained they are in sequence space, and how far are we from predicting promoter activity from sequence. Systematic identification and characterization based on transcriptional profiling is confounded by genomic location, RNA processing, stability, and detection differences due to differences in sequences expressed.</p>
<p>Here we attempted to separate promoter activity from other mechanisms of gene regulation to systematically identify promoter locations, strength, and internal structure genome-wide in rich media conditions. We systematically probed previous predictions and combined them with more unbiased approaches to better understand promoter architecture in <italic>E. coli.</italic> Overall, we found 2,859 ≤150bp promoters during log-phase growth in LB, which is consistent with recent estimations by RNA profiling using long-read sequencing technologies<sup><xref ref-type="bibr" rid="c42">42</xref>,<xref ref-type="bibr" rid="c43">43</xref></sup> and in vitro transcriptional assays<sup><xref ref-type="bibr" rid="c86">86</xref></sup>. This included many promoters contained within genes, often in the antisense direction, that had large effects on mRNA levels and constrained codon choice within these genes. Despite the ability of our approach to interrogate promoter activity across the entire genome, there are certainly many more condition-specific promoters that remain undiscovered. Moreover, it is likely that we have not identified all active promoters even under the conditions investigated in this study. It is essential to acknowledge that our approach to classifying sequences as promoters is based on an empirically derived threshold. However, this is a simplification as promoters that fall below the threshold could become active due to the influence of other factors, such as message stability<sup><xref ref-type="bibr" rid="c31">31</xref></sup> and genomic context<sup><xref ref-type="bibr" rid="c25">25</xref>,<xref ref-type="bibr" rid="c27">27</xref>,<xref ref-type="bibr" rid="c28">28</xref></sup>. Taken together, these measurements provide one of the richest datasets on autonomous promoter activity. Our data suggests that all sequences have some propensity to be a promoter, and this propensity is further modulated by other factors such as stability of the message produced or integration locus to ultimately determine mRNA levels. Moreover, the frequency of promoter-like activity in overall sequence space is seemingly very high. This view is consistent with the surprising ease by which promoters evolve from random sequences<sup><xref ref-type="bibr" rid="c45">45</xref>,<xref ref-type="bibr" rid="c87">87</xref>,<xref ref-type="bibr" rid="c88">88</xref></sup>.</p>
<p>Our scanning mutagenesis of active TSS-associated promoters identified 3,317 regions with no corresponding TFBS annotation in RegulonDB, revealing that there is a great deal more we can learn about how regulation is encoded in the <italic>E. coli</italic> genome. For regions that overlapped known sites, an appreciable proportion disagreed with the reported effect. There could be several explanations for this disagreement and the discovery of these missing annotations. First, it could be that the predictions of TFBSs in RegulonDB are actually false positives due to promiscuous or nonproductive binding events. This seems plausible considering a recent study of the global transcription factor PhoB, which supports the notion that transcription factors engage in many genomic binding events with apparent non regulatory functions<sup><xref ref-type="bibr" rid="c89">89</xref></sup>. Second, some transcription factors may possess condition-dependent behavior and the conditions tested in our study do not capture the full scope of their regulatory program. Finally, it is plausible that a portion of the sites we identify represent true functional sites that are missing from current annotation and should be interesting targets for further dissection, such as identifying which transcription factors operate at these motifs. Further studies using high resolution mutagenesis strategies<sup><xref ref-type="bibr" rid="c21">21</xref></sup> will be an effective approach to determining which sequences within promoters contribute to regulation and further efforts to predict promoter sequence-function relationships.</p>
<p>To better understand how promoter activity is modulated by sequence, we trained a suite of machine learning models to identify promoter sequences (classification) and predict the precise level of activity (regression). These models varied in complexity, from simple linear regression models based on a handful of known biological features to CNNs trained on raw sequence. Even with the large training set and a wealth of mechanistic information, the performance of these predictive models is limited. There are several possible explanations for why it remains a challenge to classify or predict the activity of <italic>E. coli</italic> promoters. First, it is likely challenging to develop a single generalizable model for all promoters as there are several families of sigma factors with distinct motifs. Therefore, models that are sigma-factor specific may be more tractable. Indeed, recent studies by us and others have leveraged large MPRA datasets characterizing σ70 promoters to develop a variety of statistical and biophysical models that predict expression with surprisingly high accuracy<sup><xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c90">90</xref>–<xref ref-type="bibr" rid="c92">92</xref></sup>. These findings suggest that overcoming the challenges associated with promoter activity prediction is plausible with the appropriate training sets and a reasonable scope of study. Second, although the range of our MPRA is quite dynamic, accurate predictive models may require techniques with even greater quantitative resolution, especially in the noise regime of the assay where most observations fall. Finally, we might simply lack the basic models for how sequences define biological functions, such as promoter activity, and thus we are looking in the wrong places for information. Recent efforts to use much larger libraries of random DNA sequences to identify strong promoters may serve as a better starting point to constrain computational models for how sequences affect function<sup><xref ref-type="bibr" rid="c93">93</xref>,<xref ref-type="bibr" rid="c94">94</xref></sup>.</p>
<p>The experimental workflows demonstrated here enable the rapid and iterative exploration of how sequence affects bacterial promoter function. The convergence of DNA synthesis technologies with multiplexed assays for genetic function now allow an individual to routinely design, build and test 10<sup>4</sup>-10<sup>5</sup> designs on a monthly basis. Such empirical power has no equivalent in other physical systems and has now reached the limits of human experimental design and planning. Thus, understanding bacterial promoters might be one of the best problems to develop and test large-scale design-of-experiment and active learning methodologies to build better predictors and discriminate between different mechanistic models of function.</p>
</sec>
<sec id="d1e1480" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e1585">
<label>Supplementary Figures</label>
<media xlink:href="supplements/894907_file02.pdf"/>
</supplementary-material>
<supplementary-material id="d1e1592">
<label>Supplementary Table 1</label>
<media xlink:href="supplements/894907_file03.xlsx"/>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>This work was supported by the National Science Foundation Graduate Research Fellowship 2015210106 and the HHMI Hanna H. Gray Postdoctoral Fellowship (GT15182) to G.U., National Institutes of Health New Innovator Award DP2GM114829 to S.K., Searle Scholars Program (to S.K.), U.S. Department of Energy (DE-FC02-02ER63421 to S.K.), UCLA, and Linda and Fred Wudl. We thank the UCLA BSCRC high throughput sequencing core and Technology Center for Genomics and Bioinformatics for technical assistance; Robert B. Phillips, Reid C. Johnson, and Jeffery H. Miller for thoughtful feedback throughout this project; Matteo Pellegrini for computational advice; Christina P. Burghard for advice on bioinformatics analysis; and all past and present members of the Kosuri lab for technical feedback. Furthermore, we would also like to thank David Gray and Lisa M. Golden for manuscript feedback. We would also like to thank the invaluable resources of RegulonDB and EcoCyc as well as all contributors to these collections. Lastly, we thank the UCLA Molecular Biology Interdepartmental Graduate Program and UCLA Bioinformatics Interdepartmental Graduate Program.</p>
</ack>
<sec id="s4">
<title>Author Contributions</title>
<p>G.U., K.D.I., H.K., and S.K. designed the study. G.U., A.D.T., and M.B. developed and performed experimental methods. N.B.L. developed the genomic fragmentation isolation method. G.U., K.D.I., and A.D.T. analyzed, and interpreted data. T.C. developed k-mer based multilayer perceptron for promoter prediction. K.D.I. developed and implemented machine learning approaches for promoter prediction. C.A. and G.U. created the interactive website for data sharing. G.U., K.D.I, and S.K. wrote the manuscript.</p>
</sec>
<sec id="s5">
<title>Declaration of Interests</title>
<p>S.K. is cofounder and CEO and holds equity in Octant Inc. N.L. is an employee and holds equity in Octant Inc. All other authors declare no competing interests.</p>
</sec>
<sec id="s6">
<title>Declaration of Generative AI and AI-assisted technologies in the writing process</title>
<p>During the preparation of this work the author(s) used Chat GPT (GPT-3.5) in order to improve language and clarity. After using this tool/service, the author(s) reviewed and edited the content as needed and take(s) full responsibility for the content of the publication.</p>
</sec>
<sec id="s7">
<title>Inclusion and Diversity</title>
<p>One or more of the authors of this paper self-identifies as an underrepresented ethnic minority in their field of research or within their geographical location. One or more of the authors of this paper self-identifies as a gender minority in their field of research. One or more of the authors of this paper received support from a program designed to increase minority representation in their field of research.</p>
</sec>
<sec id="s8">
<title>Methods</title>
<sec id="s8a">
<title>Strains</title>
<p>All experiments were performed in the <italic>E. coli</italic> MG1655 background<sup><xref ref-type="bibr" rid="c95">95</xref></sup> which carries the following genotype: F-, <italic>λ<sup>-</sup></italic>, <italic>rph-1</italic> (Yale Coli Genetic Stock Center no. 6300). For the genomically-integrated MPRA, previously reported strains<sup><xref ref-type="bibr" rid="c38">38</xref></sup> with engineered landing pads in the right midreplichore (<italic>essQ-cspB</italic> intergenic locus, Addgene no. 110244), chromosomal terminus (<italic>nth-ydgR</italic> intergenic locus, Addgene no. 110245), and left midreplichore (<italic>ybbD-ylbG</italic> intergenic locus, Addgene no. 110243) were used. Briefly, these landing pads encode a fluorescent mCherry reporter as well as chloramphenicol resistance, both of which are flanked by <italic>loxP</italic> sites for recombination-mediated cassette exchange.</p>
</sec>
<sec id="s8b">
<title>TSS library design</title>
<p>The TSS library incorporates all TSSs from the RegulonDB database<sup><xref ref-type="bibr" rid="c83">83</xref></sup> (Version 8.0, genome version U00096.2) and those identified in two recent genome-wide TSS mapping studies<sup><xref ref-type="bibr" rid="c18">18</xref>,<xref ref-type="bibr" rid="c19">19</xref></sup>. Recent work provides evidence that most regulatory motifs fall within 100 bp upstream of the TSS<sup><xref ref-type="bibr" rid="c39">39</xref></sup> and the initial transcribed region (+1 to +20) can also influence gene expression. Thus, each TSS was synthesized embedded in its local sequence context −120 to +30 relative to the TSS, capturing a majority of the <italic>cis</italic>-regulatory elements. There were 23,798 unique TSSs across all three sources, many of which were a few base pairs away from each other. We minimized redundancy and collapsed together TSSs within 20 bp and selected the most upstream TSS for our library, yielding 17,635 TSSs for the final synthesized library. Additionally, we included 500 negative controls from the <italic>E. coli</italic> genome that are assumed to have minimal regulatory activity. These were selected from 150 bp regions that are more than 200 bp from a TSS (on either strand), and many fall within coding regions. We included a set of 112 short synthetic positive controls that were previously characterized<sup><xref ref-type="bibr" rid="c40">40</xref>,<xref ref-type="bibr" rid="c96">96</xref></sup> and span a wide range of expression.</p>
</sec>
<sec id="s8c">
<title>TSS library barcoding and cloning</title>
<p>The TSS library was synthesized by Twist Biosciences and delivered lyophilized as a 26 pmol pool. The library was resuspended in 100 uL of TE pH 8.0 and 1 uL was amplified for 12 cycles using GU72 and GU116 with NEB Q5 High-Fidelity 2x Master Mix (#M0492L). Unless otherwise stated, all amplifications were performed using this polymerase mixture. This product was then ran on a 2% TAE agarose gel and approximately 200 bp amplicons were extracted using a Zymoclean Gel DNA Recovery Kit (#D4008). For barcoding, 1 ng of this eluate was amplified for 9 cycles using primers GU72 and GU73. Following cleaning using a Zymo Clean and Concentrator Kit (#D40140), the library was digested using NEB’s SbfI-HF and XhoI.</p>
<p>The plasmid backbone, pLibacceptorV2 (Addgene #106250) was digested using SbfI-HF and SalI-HF with the addition of rSAP (NEB #M0371S). The digested library was ligated into pLibacceptorV2 using T7 DNA Ligase (NEB #M0318S), cloned into 5-alpha Electrocompetent <italic>E. coli</italic> (NEB #C2989K), and plated on LB + kanamycin (25 ug/mL) yielding approximately 2.3 million colonies estimated by counting simultaneously plated dilutions. After allowing for 24 hours of growth on plates, the library was scraped and resuspended in LB, and then 800 million cells (based on OD<sub>600</sub>) were inoculated in 450 mL LB + kanamycin (25 ug/mL) overnight. Unless stated otherwise, all plasmids were isolated using a Qiagen Plasmid Plus Maxiprep Kit (#12963) and concentrated using a Promega Wizard SV Gel and PCR Clean-up System (#A9281).</p>
<p>In order to clone the RiboJ::sfGFP reporter construct, the library was digested using NEB’s BsaI-HF and NheI-HF with the addition of rSAP. The reporter construct was digested using NEB’s BsaI-HF and NcoI-HF. Similarly to the previous cloning step, the reporter was cloned into the library using T7 DNA Ligase, cloned into 5-alpha electrocompetent <italic>E. coli</italic>, and plated on LB + kanamycin (25 ug/mL), yielding 6.8 million colonies. The completed plasmid library was isolated as stated above.</p>
</sec>
<sec id="s8d">
<title>Isolation of genomic fragment library</title>
<p>To isolate genomic fragments, 10 ug of <italic>E. coli</italic> MG1655 gDNA was sheared using a Covaris focused ultra-sonicator. The settings used were as follows: Duty factor was set to 10%, Intensity was set to 4, cycles/burst was set to 200, and time was 60 seconds. The sheared gDNA was ran on a 3% TAE agarose gel and fragments between 200 and 300 bp were extracted using a Zymoclean Gel DNA Recovery Kit and eluted in 18 uL water. All 18 uL of the extracted fragments were end repaired using Enzymatics End Repair Mix (Part # Y9140-LC-L) following manufacturers protocols, cleaned using 45 uL (1.8x volume) of Agencourt AMPure XP Beads (#A63880), and eluted in 20 uL of water. The 20 uL eluate was A-tailed following the New England Biolabs protocol:</p>
<p>Reaction:</p>
<list list-type="simple">
<list-item><p>uL End-repaired DNA</p></list-item>
<list-item><p>uL NEB Buffer 2 (10x)</p></list-item>
<list-item><p>uL dATP (10mM)</p></list-item>
<list-item><p>uL Klenow Fragment (3’ −&gt; 5’ exo-) (Enzymatics #P7010-HC-L)</p></list-item>
<list-item><p>uL Nuclease-free water</p></list-item>
</list>
<p>The reaction was Incubated for 30 minutes at 37°C, then heat inactivated for 20 minutes at 75°C before cleaning using 90 uL Agencourt AMPure XP beads and eluting in 20 uL water. Y-adapters to facilitate fragment amplification and barcoding were ligated to the A-tailed fragments using the following reaction mix:</p>
<p>Reaction:</p>
<list list-type="simple">
<list-item><p>uL A-tailed DNA</p></list-item>
<list-item><p>uL NEB T4 DNA Ligase Buffer (10x) (NEB #B0202S)</p></list-item>
<list-item><p>uL Y-adapter GU Y-Frag (25 uM)</p></list-item>
<list-item><p>uL NEB T4 DNA Ligase (NEB #M0202T)</p></list-item>
<list-item><p>uL Nuclease-free water</p></list-item>
</list>
<p>This reaction was incubated for 20 minutes at 25°C, heat inactivated for 20 minutes at 65°C, and subsequently cleaned using 90 uL Agencourt AMPure XP beads and eluting in 12 uL nuclease-free water.</p>
</sec>
<sec id="s8e">
<title>Barcoding and cloning of genomic fragment library</title>
<p>To barcode the genomic fragments, 1 uL of the processed fragments was amplified for 13 cycles using GU72 and GU116. This product was then cleaned using a Zymo Clean and Concentrator Kit and eluted in 12 uL nuclease-free water. For barcoding, 1 ng of this eluate was amplified for 10 cycles using primers GU72 and GU73. Following cleaning using a Zymo Clean and Concentrator Kit (#D40140), the library was digested using NEB’s SbfI-HF and XhoI.</p>
<p>This library was cloned following the same protocols as the TSS library. The transformation of the barcoded library yielded approximately 3.3 million colonies and the transformation after addition of the RiboJ::sfGFP yielded approximately 1.25 million colonies.</p>
</sec>
<sec id="s8f">
<title>Genomic promoter tiling library design</title>
<p>We used a custom peak caller on the single-nucleotide resolution strand-specific expression pileup generated from our genomic fragment library to define “peaks” of promoter activity. Our peak calling method is simple and conservative, as we wanted to tile the most active regions and keep the library size reasonable. We defined a peak as a continuous region with expression above an empirically determined threshold. We considered a continuous range of thresholds and for each evaluated the percentage of active TSSs, from our previous library, contained in a peak and determined an expression level of 1.1 was sufficient and captured 90% of active TSSs (data not shown). We required that each peak be at least 60 bp, and merged adjacent peaks that were within 40 bp, yielding 1753 and 1724 peaks for the minus and plus strands, respectively. We tiled each peak by synthesizing 150 bp windows across the region, with no overlap between adjacent tiles, yielding 48,491 peak tiles. Additionally, we included 1000 randomly generated 150 bp sequences to test what fraction of random sequence can drive expression. We included the same set of positive and negative controls as described in the TSS library design.</p>
</sec>
<sec id="s8g">
<title>Genomic promoter tiling library barcoding and cloning</title>
<p>The active TSS mutagenesis library was synthesized by Agilent and delivered lyophilized as a 10 pmol pool. The library was resuspended in 100 uL of TE pH 8.0 and 1 uL was amplified for 10 cycles using GU120 and GU121. This product was then cleaned using a Zymo Clean and Concentrator Kit and eluted in 12 uL nuclease-free water. For barcoding, 1 ng of this eluate was amplified for 8 cycles using primers GU120 and GU122. Following cleaning using a Zymo Clean and Concentrator Kit (#D40140), the library was digested using NEB’s SbfI-HF and XhoI.</p>
<p>This library was cloned following the same protocols as the TSS library. The transformation of the barcoded library yielded approximately 1.5 million colonies and the transformation after addition of the RiboJ::sfGFP yielded approximately 5.2 million colonies.</p>
</sec>
<sec id="s8h">
<title>Active TSS mutagenesis design</title>
<p>We systematically mutagenized all active TSSs from our initial TSS library to design a follow-up library. We used 500 negative controls to classify the TSS library into active and inactive TSSs. We set the active threshold at two standard deviations above the median expression for the negative controls, resulting in 2,670 active TSSs. We mutagenized the active sequence by scrambling 10 bp windows, sliding across the 150 bp at 5 bp intervals, resulting in 5 bp of overlap between adjacent scrambles. We scrambled the sequence using the existing 10 bp to preserve nucleotide content and selected the scramble that was most dissimilar to the original sequence out of 100 scrambling attempts. Our final library included 59,653 scrambled sequences and 2,057 unscrambled sequences. We also included the same set of negative and positive controls as described above for the TSS library, for a total library size of 62,322.</p>
</sec>
<sec id="s8i">
<title>Active TSS mutagenesis library barcoding</title>
<p>The active TSS mutagenesis library was synthesized by Agilent and delivered lyophilized as a 10 pmol pool. The library was resuspended in 100 uL of TE pH 8.0 and 1 uL was amplified for 12 cycles using GU123 and GU124. This product was then cleaned using a Zymo Clean and Concentrator Kit and eluted in 12 uL nuclease-free water. For barcoding, 1 ng of this eluate was amplified for 10 cycles using primers GU123 and GU125. Following cleaning using a Zymo Clean and Concentrator Kit (#D40140), the library was digested using NEB’s SbfI-HF and XhoI.</p>
<p>This library was cloned following the same protocols as the TSS library. The transformation of the barcoded library yielded approximately 3.7 million colonies and the transformation after addition of the RiboJ::sfGFP yielded approximately 5.2 million colonies.</p>
</sec>
<sec id="s8j">
<title>Library Barcode mapping</title>
<p>We used PCR to individually barcode each library sequence to quantitatively measure expression in our MPRA. Prior to genome integration, DNA-sequencing was performed to computationally map barcodes to sequences. A custom barcode mapper developed by Nathan Lubock <sup><xref ref-type="bibr" rid="c97">97</xref></sup> was used to collapse reads into a barcode-sequence map. We used two filtering steps for barcode quality. First, we required a minimum number of reads for every barcode, assuming reads that appear once or twice correspond to sequencing errors. Second, BBMap <sup><xref ref-type="bibr" rid="c98">98</xref></sup> was used to align the reads associated with a given barcode, and discarded barcodes that map to sequences that are too dissimilar to one another. A Levenshtein distance of 30 was used to discard barcodes that map to two very distinct sequences, while still allowing for a small number of sequence errors.</p>
</sec>
<sec id="s8k">
<title>Library integration into specific genomic loci</title>
<p>Library integration was performed as previously described <sup><xref ref-type="bibr" rid="c38">38</xref></sup>.</p>
<p>The isolated plasmid library was digested with SalI-HF and NheI-HF to eliminate incompletely cloned plasmid before transformation into electrocompetent MG1655 with a landing pad engineered in the nth-ydgR locus and plating on LB + kanamycin (25 ug/mL). Colonies were resuspended in LB and 800 million cells were inoculated into 250 mL LB + kanamycin (25 ug/mL) and grown overnight. Several 2 mL frozen aliquots were made of this overnight culture.</p>
<p>The library was integrated into the <italic>nth-ydgR</italic> locus as follows. A frozen aliquot of MG1655 with a landing pad engineered in the reverse orientation at the <italic>nth-ydgR</italic> intergenic locus was transformed with the library and grown overnight in 200 mL LB + kanamycin (25 ug/mL). Following overnight growth, 400 million cells of this culture were seeded into 250 mL LB + kanamycin (25 ug/mL) + 0.2% arabinose (g/mL) and grown for 24 hours. After integration of the library, the plasmid backbone was removed through heat-curing. From the 24 hour induced culture, 800 million cells were inoculated into 80 mL of LB + kanamycin (25 ug/mL) and grown at 42 °C for approximately 1.5 hours before reaching an OD 600 = 0.3. Upon reaching exponential growth, 200 million cells from this culture library were plated and grown for 16 hours at 42 °C. Heat-cured plates were scraped and resuspended in LB and 400 million cells were inoculated into 200 mL LB + kanamycin (25 ug/mL). This culture, consisting of our integrated and heat-cured library, was grown overnight at 37 °C and several frozen 2 mL aliquots were made.</p>
<p>To test the TSS library in the <italic>essQ-cspB</italic> and <italic>ybbD-ylbG</italic> midreplichore regions, the same protocol was followed using strains engineered with landing pads in these intergenic regions.</p>
</sec>
<sec id="s8l">
<title>Library growth and harvest for expression measurements</title>
<p>To measure expression of all promoter libraries, libraries were grown and harvested as previously described <sup><xref ref-type="bibr" rid="c38">38</xref></sup> with minor changes to culture conditions.</p>
<p>For each library and biological replicates, a 2 mL frozen aliquot of the library was inoculated in 200 mL LB (BD#244620) with 25 ug/mL of kanamycin and grown at 30 °C overnight. The overnight cultures were used to seed new cultures at OD<sub>600</sub> = .0005 and grown for approximately 5.5 hours at 30 °C until reaching an OD<sub>600</sub> between = 0.5 and 0.55. The genomic fragment library was also grown in Minimal Media (Fisher Scientific #DF0485-17) with 0.2% glucose (g/mL) and 25 ug/mL of kanamycin for 10 hours at 30 °C until reaching an OD<sub>600</sub> between = 0.5 and 0.55. Cultures were rapidly cooled to 0 °C in an ice slurry for two minutes. Three 50 mL aliquots were pelleted at 4 °C by centrifugation at 13,000xg for two minutes and the supernatants were poured out before snap-freezing the pellets in liquid nitrogen. Three 5 mL aliquots of each library were harvested using the same approach to be processed for genomic DNA extractions.</p>
</sec>
<sec id="s8m">
<title>RNA and DNA sequencing library preparation</title>
<p>RNA was extracted from 50 mL library pellets using a Qiagen RNEasy Midi kit (#75142) and 45 ug of each extract was concentrated using a Qiagen Minelute Cleanup Kit (#74204). Barcoded cDNA was generated from 25 ug of each concentrated RNA extract using Thermo Fisher SuperScript IV (#18090010) primed with GU101. The manufacturer’s protocol was followed aside from extending the reaction time to 1 hour at 52 °C. The cDNA reaction was cleaned using a Zymo Research DNA Clean and Concentrator kit (#D40140) before amplification. Barcoded cDNA was amplified via PCR for 13 cycles using primers GU59 and GU102. This reaction was cleaned using a Zymo Research DNA Clean and Concentrator Kit and 1 uL of this reaction was used in a second PCR for indexing and addition of flow cell adapters. The second PCR was for 8 cycles and utilized primers GU102 with either GU61, GU62, GU63, or GU64 (which add separate 6 bp indices).</p>
<p>gDNA was extracted from 5 mL cell library pellets using a Qiagen Gentra Puregene kit (#158567). Barcoded DNA was amplified from 1 ug of gDNA via PCR for 12-15 cycles using primers GU59 and GU60. The reaction was subsequently cleaned using a Zymo Research DNA Clean and Concentrator kit. To add sequencing adapters and indices to the library, 1 ng of this reaction was subject to a second PCR for 8 cycles using primers GU70 with either GU63, GU64, GU65, or GU66 (which add separate 6 bp indices). RNA and DNA sequencing libraries were cleaned using a Zymo Research Clean and Concentrator Kit (#D40140) before quantification using an Agilent Tapestation.</p>
<p>For each library, eight separate sequencing libraries were prepared: Four sequencing libraries for each RNA/DNA with two biological replicates and two technical replicates of each biological replicate. Biological replicates originated from separately grown and harvested glycerol stocks of each library. For each biological replicate, two RNA/gDNA extractions and sequencing library preparations (technical replicates) were performed in parallel. Libraries were submitted to the Broad Stem Cell Research Center at UCLA for sequencing on a HiSeq2500 or to the UCLA Translational Pathology Core Laboratory for sequencing on a NextSeq500. Raw sequencing data and promoter expression measurements are available on NCBI’s Gene Expression Omnibus (Accession no. GSE144621).</p>
</sec>
<sec id="s8n">
<title>RNA-Seq of MG1655 in M9 minimal Media and Rich LB media</title>
<p>To compare the promoter landscape to local transcriptional levels, RNA-Seq was performed on MG1655 grown in M9 minimal media (BD Difco #248510) supplemented with 0.2% glucose, 2 mM magnesium sulfate, and 0.1 mM calcium chloride. Similarly, RNA-Seq was performed for MG1655 grown in LB (BD#244620). Cells growth and RNA preps were prepared as previously described (see methods section titled: library growth and harvest for expression measurements). Samples were prepared using an Illumina TruSeq® Stranded mRNA Library Prep (#20020594) following manufacturers protocols to achieve strand-specific coverage. We note that no rRNA depletion was performed to preserve the fully intact transcriptional landscape. Samples were submitted to the UCLA TCGB sequencing core and sequenced on a Hiseq 4000.</p>
</sec>
<sec id="s8o">
<title>Standardizing Promoter Expression Quantification and Activity Thresholding</title>
<p>We processed the TSS, scramble, and peak tiling libraries using the same computational pipeline to facilitate comparisons between libraries. First, we use a set of 96 short synthetic positive controls, designed to span a range of activity<sup><xref ref-type="bibr" rid="c40">40</xref>,<xref ref-type="bibr" rid="c96">96</xref></sup>, to fit a robust linear regression (rlm function from MASS package) with the TSS library as the reference. Each library is standardized independently to the TSS library using the set of positive controls present in both libraries. Next, for each library we independently determined the level of background noise based on the median of 500 negative controls and subtracted this background from the newly fitted measurements. These steps standardize our data so we can train jointly across all datasets.</p>
</sec>
<sec id="s8p">
<title>-10 Motif and −35 Motif characterization</title>
<p>A position weight matrix from bTSSfinder was used to identify and score the best match to the −10 and −35 motifs within active tss-associated promoters, inactive tss-associated promoters, and a set of 500 negative controls. Best scores were reported regardless of position within the sequence. For all pairwise comparisons of active tss-associated promoters, inactive tss-associated promoters, and the negative controls, the distributions of motif scores were compared and a student’s t-test was performed to determine significance.</p>
</sec>
<sec id="s8q">
<title>Genomic fragment processing, alignment and promoter landscape quantification</title>
<p>To calculate fragment expression, we used measurements from DNA-seq and RNA-seq and excluded fragments with low expression (&lt; 0.1) or high variance (5-fold difference in relative expression between biological replicates). To identify the coordinates of genomic fragments assayed using the MPRA, fragment sequences were aligned using bowtie2<sup><xref ref-type="bibr" rid="c99">99</xref></sup> (version 2.3.4.3). To determine nucleotide-resolution calculations for promoter activity, we utilize the script, frag_expression_pileup.py. This script outputs WIG files in a strand-specific manner detailing the median expression of fragments overlapping each nucleotide position.</p>
</sec>
<sec id="s8r">
<title>Identification of minimal promoter regions</title>
<p>To identify minimal sequences necessary for promoter activity, contiguous stretches of candidate promoter region peak tiles were grouped and the minimal shared overlapping region was identified. Peak tiles above the expression threshold were identified and grouped together if they shared an overlap of at least 110 bp of their 150 bp total length. The minimal region necessary for promoter activity was found by determining the overlap of the outermost sequences within a contiguous stretch of tiles.</p>
</sec>
<sec id="s8s">
<title>Determining promoter-gene associations</title>
<p>To assign genomic promoter peaks to their regulated genes, peaks were first assigned specific nucleotide positions by identifying the maximum activity score within a peak. Promoter peaks were considered intragenic if their maximum scoring nucleotide overlapped with a gene coordinate. For peaks whose maximum scoring nucleotides were within intergenic regions, regulated genes were assigned by identifying the first downstream gene within 500 bp. Once gene associations were identified, promoter peaks were labeled sense or antisense depending on whether the regulated gene shared strand orientation with the promoter peak</p>
</sec>
<sec id="s8t">
<title>RNA-Seq alignment and genome transcript coverage</title>
<p>RNA-Seq analysis was performed using the script <italic>RNAseq_LB_processing.sh</italic> or <italic>RNAseq_M9_processing.sh</italic>. This script trims reads using the trimmomatic software (ver. 0.36+dfsg-3) and aligned to the MG1655 reference genome (U00096.2) using Hisat2 <sup><xref ref-type="bibr" rid="c100">100</xref></sup> (ver. 2.1.0-1). Genome nucleotide-resolution coverage was determined using Samtools depth (ver. 1.7-1). Meta-analysis across gene groups (as in <xref rid="fig3" ref-type="fig">figure 3B</xref>), was performed using Deeptools<sup><xref ref-type="bibr" rid="c101">101</xref></sup> (ver. 2.5.6). Gene expression coverage (as in <xref rid="fig4" ref-type="fig">figure 4B</xref>) was calculated using custom script <italic>wig_over_bed.py</italic>, which calculates the total (.wig) coverage across reported <italic>E. coli</italic> genes. In all cases, default parameters were used with the exception of allowing for strand-specific quantifications.</p>
</sec>
<sec id="s8u">
<title>Amino acid and codon bias within intragenic promoters</title>
<p>Amino and codon usage was characterized within intragenic promoters and compared to all <italic>E. coli</italic> coding regions. To identify intragenic promoters, minimal regions necessary for promoter activity were identified by cross referencing genomic coordinates to reported genes. Reported gene coordinates were acquired from RegulonDB Version 8.0<sup><xref ref-type="bibr" rid="c83">83</xref></sup>. Once intragenic promoters were identified, nucleotide triplets were extracted while conserving the reading frame of the overlapping gene. Similarly, nucleotide triplets were extracted from all reported <italic>E. coli</italic> coding regions after filtering out sequences which did not have nucleotide lengths of a multiple of three. For these extracted sequences, codon frequencies were normalized to their relative abundance compared to other codons encoding the same amino acid. Amino acid frequencies were normalized to the total number of amino acids within each group. Significantly enriched or depleted codons were identified by performing a chi-squared test within each amino acid group and adjusting the p-value using FDR. Significantly enriched or depleted amino acids were identified by performing a chi-squared test for each amino acid relative to the total pool of amino acids and adjusting the p-value using FDR.</p>
</sec>
<sec id="s8v">
<title>Comparison of condition-dependent promoter and gene activation between rich and minimal media</title>
<p>To identify condition specific promoters, coordinates of candidate promoter regions identified in both M9 and LB conditions were compared to identify overlaps. Coordinates of promoter peaks were cross compared between conditions using the bedtools intersect tool (bedtools v2.27.1) and considered unique to a particular condition if they had no overlap between conditions. To identify regions that were activated between conditions, we compared the relative promoter activity between conditions at all positions in the genome and identified stretches greater than 60 bp that exhibited over 2-fold difference in activity. Regions were called using custom script run_differential_wig.sh available on the Github repository. To identify genes being expressed by differentially active regions, intergenic differentially active regions and matched these to the nearest downstream gene within 500 bp.</p>
</sec>
<sec id="s8w">
<title>Identification of SEED subsystem annotations enriched in differentially activated genes</title>
<p>To identify genetic functions associated with condition-dependent genes, the <italic>E. coli</italic> MG1655 K-12 genome (Genbank: U00096.2) was annotated using the SEED and RAST webserver <sup><xref ref-type="bibr" rid="c67">67</xref>,<xref ref-type="bibr" rid="c68">68</xref></sup>. Genes within 500 bp downstream of promoter regions activated by condition were identified and associated with activation in LB or minimal media. For each media condition, genes were grouped by functional categories and the number of genes for each category was tallied.</p>
</sec>
<sec id="s8x">
<title>Identification of condition dependent TFBSs</title>
<p>The TFBS content of promoter peaks unique to each condition was evaluated by cross-referencing with TFBSs reported by RegulonDB <sup><xref ref-type="bibr" rid="c83">83</xref></sup> (Release 8.8). Genomic regions activated in each condition were assigned TFBSs based on overlapping genomic coordinates using the bedtools intersect tool (bedtools v2.27.1) with default parameters and ignoring strand assignments. Incidents of each TFBS overlap were quantified between conditions and normalized to incidents per 100,000 bp of promoter peak sequence.</p>
</sec>
<sec id="s8y">
<title>Identification of statistically significant scrambling promoter variants</title>
<p>We identified scrambling promoter variants that significantly altered expression compared to the wild-type (WT) variant in the script scramble_ttest.Rmd. We considered each scramble and barcode combination as an independent observation, rather than summarizing expression as an average across all barcodes. A two-sample two-sided Student’s t-test (t.test) was performed to test for a significant difference in mean expression levels between barcodes for a scrambled variant and barcodes for the corresponding WT variant. We performed multiple testing correction and identified 1,885 scrambles that increase expression and 5,408 that decrease expression relative to the WT variant, at a false discovery rate of 1%.</p>
<p>Next, bedtools merge was used to merge overlapping adjacent scramble variants to produce “merged” scrambles. These merged sites correspond to a continuous scrambled region that induced significant changes in expression. We identified 1,414 merged scrambles that increased expression and 1,903 merged scrambles that decreased expression, and scrambles were merged separately based on effect.</p>
</sec>
<sec id="s8z">
<title>Comparison of identified regulatory regions to RegulonDB annotations</title>
<p>We compared our identified merged scramble sites to existing RegulonDB annotations. We used bedtools intersect and required that 10% of the TFBS overlapped with a merged scramble site to count as an overlap. Next, we assessed whether the expression effect seen in our MPRA agreed with the direction of effect of the TFBS as indicated in RegulonDB. A merged scramble site was marked as “concordant” if any of the component scrambles agreed with existing annotation, and not concordant otherwise.</p>
</sec>
<sec id="s8aa">
<title>Machine learning models</title>
<p>We implemented several machine learning models, independently trained for both classification and regression. All reproducible code is provided in the Github (<ext-link ext-link-type="uri" xlink:href="https://github.com/KosuriLab/ecoli_promoter_mpra.git">https://github.com/KosuriLab/ecoli_promoter_mpra.git</ext-link>) and we will briefly describe each model and the appropriate parameters or implementation details.</p>
<sec id="s8aa1">
<title>Data processing</title>
<p>We standardized all datasets as detailed above in “Universal Promoter Expression Quantification and Activity Thresholding”. Next, we split our data, using custom scripts, into 75%/25% for training/testing based on genomic location, ensuring the splits are equidistant from the origin, to avoid overfitting (define_genome_splits.py). Briefly, we split the genome into eight chunks, with the first and last chunk adjacent to the origin of replication. We designated the second and seventh chunk as the test set and remaining chunks as training set. This splitting maintains roughly the same distance from the origin between the training and test sets to avoid any potential effects of genome location. Many of our library designs include high overlap between adjacent positions in the genome. Splitting by genome location mitigates inflated performance due to highly similar sequences present in both train and test sets. Across the three libraries (TSS, peak tiling, scramble) there are 87,164 training samples and 30,392 test samples.</p>
<p>We trained models for both regression and classification. Our data was skewed toward negative examples, with many samples near our determined threshold. For classification, we created a buffer around the threshold and only include sequences with expression &lt;= 0.75 as negatives and &gt;= 1.25 as positives and labeled sequences as active or inactive. Our training set was reduced to 53,326 samples and testing set to 18,567 samples.</p>
<p>We used the classification models to predict probabilities, instead of the class, to derive precision-recall curves.</p>
</sec>
<sec id="s8aa2">
<title>Simple model with promoter features</title>
<p>For the models in this section we created features only for the TSS library because it is closest to endogenous sequence and is a smaller dataset. The training and test sets were split by genomic location, as described above, with 13,118 training samples and 4549 testing samples.</p>
<p>We created a simple model which incorporates four features related to promoter function. We calculated the maximum position weight matrix (PWM) score using motifs from bTSSfinder<sup><xref ref-type="bibr" rid="c102">102</xref></sup> for both the −10 and −35 core promoter motifs. We scanned the −10 and −35 PWM individually and took the max score at any position using scoring functions from the Bioconductor package Biostrings<sup><xref ref-type="bibr" rid="c103">103</xref></sup>. Next, we scanned the sequence with −10 and −35 PWM jointly, allowing either 16, 17, or 18bp spacing in between the PWMs, reflecting common spacer lengths between core motifs. We assigned the “paired” max score as the max score at any position in the sequence across the three length options. Finally, we calculated the GC content (percentage) as this has been shown to be negatively correlated with promoter strength<sup><xref ref-type="bibr" rid="c104">104</xref></sup>. We constructed models in R with these four features and fit 1) a linear regression (lm), 2) a linear regression on the log-transformed expression values (lm), and 3) a logistic regression (glm, family = ‘binomial’, type = ‘response’).</p>
<p>We trained the gapped k-mer SVM (gkm-SVM<sup><xref ref-type="bibr" rid="c105">105</xref></sup>) model on only the TSS dataset because the model is suited for training sets &lt; 20,000. The training and test sets were split by genome position as described above. We specified a word length = 10 with 8 informative columns (L = 10, K = 8).</p>
</sec>
<sec id="s8aa3">
<title>K-mer frequencies and simple models (linear regression, logistic regression, partial least squares regression, partial least squares discriminant analysis)</title>
<p>All of the models described in the remaining sections were trained using all three combined datasets, as described above.</p>
<p>We created a feature set based on k-mer frequencies, with k-mers ranging in length from 3 to 6-mers. We generated feature sets and trained models in python. For simpler models we performed an additional feature selection step using custom scripts (kmer_feature_generator.py).</p>
<p>We trained four models:</p>
<list list-type="simple">
<list-item><p>● linear regression (statsmodel.api.OLS)</p></list-item>
<list-item><p>● logistic regression (sklearn.linear_model.LogisticRegression())</p></list-item>
<list-item><p>● partial least squares regression (sklearn.cross_decomposition.PLSRegression())</p></list-item>
<list-item><p>● partial least squares discriminant analysis (sklearn.cross_decomposition.PLSRegression() on binary dependent variable)</p></list-item>
</list>
<p>For each k-mer, we computed the frequency in a set of random genomic sequences, the same length and size of the training set. We include a k-mer if the absolute correlation with expression is greater than the “random” k-mer frequency, resulting in 4800/5440 filtered k-mers. We chose partial least squares regression because it projects the input features onto a new space and is better equipped to handle a large number of features with high collinearity.</p>
</sec>
<sec id="s8aa4">
<title>Random forest regression and classification</title>
<p>Next, we trained a random forest, for both regression (sklearn.ensemble.RandomForestRegressor()) and classification (sklearn.ensemble.RandomForestClassifier()). We train on one-hot encoded DNA as a comparison to the neural network model, although random forest is not well suited to categorical input features. To compensate for this, we trained the random forest using frequencies of all 6-mers and observed improved performance.</p>
</sec>
<sec id="s8aa5">
<title>Multi-layer perceptron and neural networks</title>
<p>We trained a multi-layer perceptron for both regression (sklearn.neural_network.MLPRegressor()) and classification (sklearn.neural_network.MLPClassifier()). MLPs are a class of feedforward artificial networks and are “vanilla” neural networks consisting of an input layer, hidden layer, and output layer. We used two different feature sets: frequency of all 3-to 6-mers and frequency of only 6-mers. Feature sets were standardized with sklearn.preprocessing.StandardScaler() to remove mean and scale to unit variance. We trained all four models with the following parameters: alpha = 0.005, hidden_layer_sizes=(800, 30), solver = ‘lbfgs’, random_state=1, max_iter=10000, early_stopping=True, learning_rate=’adaptive’, tol=1e-8.</p>
<p>We trained a convolutional neural network (CNN) on one-hot encoded DNA sequence for both regression and classification. We performed hyperparameter tuning and training using <sup><xref ref-type="bibr" rid="c84">84</xref></sup>, a toolkit for working with CNNs built on keras. We performed a random hyperparameter search for a three-layer CNN for 100 combinations and the optimal parameters are listed below.</p>
<p>Regression:</p>
<list list-type="simple">
<list-item><p>● Dropout: 0.1340735187802852</p></list-item>
<list-item><p>● Pooling width: 16</p></list-item>
<list-item><p>● Convolutional filter width (for each layer): 16, 17, 18</p></list-item>
<list-item><p>● Number of filters (for each layer): 19, 39, 54</p></list-item>
</list>
<p>Classification:</p>
<list list-type="simple">
<list-item><p>● Dropout: 0.45541334972592196</p></list-item>
<list-item><p>● Pooling width: 7</p></list-item>
<list-item><p>● Convolutional filter width (for each layer): 8, 29, 29</p></list-item>
<list-item><p>● Number of filters (for each layer): 99, 87, 60</p></list-item>
</list>
</sec>
</sec>
</sec>
<ref-list>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Jacob</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Monod</surname>, <given-names>J</given-names></string-name>. <article-title>Genetic regulatory mechanisms in the synthesis of proteins</article-title>. <source>J. Mol. Biol</source>. <volume>3</volume>, <fpage>318</fpage>–<lpage>356</lpage> (<year>1961</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Feklístov</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Sharon</surname>, <given-names>B. D.</given-names></string-name>, <string-name><surname>Darst</surname>, <given-names>S. A.</given-names></string-name> &amp; <string-name><surname>Gross</surname>, <given-names>C. A</given-names></string-name>. <article-title>Bacterial sigma factors: a historical, structural, and genomic perspective</article-title>. <source>Annu. Rev. Microbiol</source>. <volume>68</volume>, <fpage>357</fpage>–<lpage>376</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Haugen</surname>, <given-names>S. P.</given-names></string-name>, <string-name><surname>Ross</surname>, <given-names>W.</given-names></string-name> &amp; <string-name><surname>Gourse</surname>, <given-names>R. L</given-names></string-name>. <article-title>Advances in bacterial promoter recognition and its control by factors that do not bind DNA</article-title>. <source>Nat. Rev. Microbiol</source>. <volume>6</volume>, <fpage>507</fpage>–<lpage>519</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Lee</surname>, <given-names>D. J.</given-names></string-name>, <string-name><surname>Minchin</surname>, <given-names>S. D.</given-names></string-name> &amp; <string-name><surname>Busby</surname>, <given-names>S. J. W</given-names></string-name>. <article-title>Activating transcription in bacteria</article-title>. <source>Annu. Rev. Microbiol</source>. <volume>66</volume>, <fpage>125</fpage>–<lpage>152</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Browning</surname>, <given-names>D. F.</given-names></string-name> &amp; <string-name><surname>Busby</surname>, <given-names>S. J. W</given-names></string-name>. <article-title>Local and global regulation of transcription initiation in bacteria</article-title>. <source>Nat. Rev. Microbiol</source>. <volume>14</volume>, <fpage>638</fpage>–<lpage>650</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Johnson</surname>, <given-names>X. B.</given-names></string-name> &amp; <string-name><surname>Hinton</surname>, <given-names>D. M</given-names></string-name>. <article-title>Escherichia coli RNA polymerase recognition of a σ70-dependent promoter requiring a-35 DNA element and an extended-10 TGn motif</article-title>. <source>J. Bacteriol</source>. <volume>188</volume>, <fpage>8352</fpage>–<lpage>8359</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Hook-Barnard</surname>, <given-names>I. G.</given-names></string-name> &amp; <string-name><surname>Hinton</surname>, <given-names>D. M</given-names></string-name>. <article-title>Transcription initiation by mix and match elements: flexibility for polymerase binding to bacterial promoters</article-title>. <source>Gene Regul. Syst. Bio</source>. <volume>1</volume>, <fpage>275</fpage>–<lpage>293</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Murakami</surname>, <given-names>K. S.</given-names></string-name>, <string-name><surname>Masuda</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Campbell</surname>, <given-names>E. A.</given-names></string-name>, <string-name><surname>Muzzin</surname>, <given-names>O.</given-names></string-name> &amp; <string-name><surname>Darst</surname>, <given-names>S. A</given-names></string-name>. <article-title>Structural basis of transcription initiation: an RNA polymerase holoenzyme-DNA complex</article-title>. <source>Science</source> <volume>296</volume>, <fpage>1285</fpage>– <lpage>1290</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Liu</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Hong</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>R. K.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>Z.</given-names></string-name> &amp; <string-name><surname>Steitz</surname>, <given-names>T. A</given-names></string-name>. <article-title>Structural basis of bacterial transcription activation</article-title>. <source>Science</source> <volume>358</volume>, <fpage>947</fpage>–<lpage>951</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Newberry</surname>, <given-names>K. J.</given-names></string-name> &amp; <string-name><surname>Brennan</surname>, <given-names>R. G</given-names></string-name>. <article-title>The structural mechanism for transcription activation by MerR family member multidrug transporter activation, N terminus</article-title>. <source>J. Biol. Chem</source>. <volume>279</volume>, <fpage>20356</fpage>–<lpage>20362</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Lawson</surname>, <given-names>C. L.</given-names></string-name> <etal>et al.</etal> <article-title>Catabolite activator protein: DNA binding and transcription activation</article-title>. <source>Curr. Opin. Struct. Biol</source>. <volume>14</volume>, <fpage>10</fpage>–<lpage>20</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Kinney</surname>, <given-names>J. B.</given-names></string-name>, <string-name><surname>Murugan</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Callan</surname>, <given-names>C. G.</given-names></string-name> &amp; <string-name><surname>Cox</surname>, <given-names>E. C</given-names></string-name>. <article-title>Using deep sequencing to characterize the biophysical mechanism of a transcriptional regulatory sequence</article-title>. <source>Proceedings of the National Academy of Sciences</source> vol. <volume>107</volume> <fpage>9158</fpage>–<lpage>9163</lpage> Preprint at <pub-id pub-id-type="doi">10.1073/pnas.1004290107</pub-id> (<year>2010</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Ishihama</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Shimada</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Yamazaki</surname>, <given-names>Y</given-names></string-name>. <article-title>Transcription profile of Escherichia coli: genomic SELEX search for regulatory targets of transcription factors</article-title>. <source>Nucleic Acids Res</source>. <volume>44</volume>, <fpage>2058</fpage>– <lpage>2074</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Peano</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>Characterization of the Escherichia coli σ(S) core regulon by Chromatin Immunoprecipitation-sequencing (ChIP-seq) analysis</article-title>. <source>Sci. Rep</source>. <volume>5</volume>, <issue>10469</issue> (<year>2015</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Bonocora</surname>, <given-names>R. P.</given-names></string-name>, <string-name><surname>Smith</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Lapierre</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Wade</surname>, <given-names>J. T</given-names></string-name>. <article-title>Genome-Scale Mapping of Escherichia coli σ54 Reveals Widespread, Conserved Intragenic Binding</article-title>. <source>PLoS Genet</source>. <volume>11</volume>, <fpage>e1005552</fpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Huerta</surname>, <given-names>A. M.</given-names></string-name> &amp; <string-name><surname>Collado-Vides</surname>, <given-names>J</given-names></string-name>. <article-title>Sigma70 promoters in Escherichia coli: specific transcription in dense regions of overlapping promoter-like signals</article-title>. <source>J. Mol. Biol</source>. <volume>333</volume>, <fpage>261</fpage>– <lpage>278</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Rhodius</surname>, <given-names>V. A.</given-names></string-name>, <string-name><surname>Mutalik</surname>, <given-names>V. K.</given-names></string-name> &amp; <string-name><surname>Gross</surname>, <given-names>C. A</given-names></string-name>. <article-title>Predicting the strength of UP-elements and full-length E. coli σE promoters</article-title>. <source>Nucleic Acids Res</source>. <volume>40</volume>, <fpage>2907</fpage>–<lpage>2924</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="web"><string-name><surname>Conway</surname>, <given-names>T.</given-names></string-name>, <etal>et al.</etal> <article-title>Unprecedented High-Resolution View of Bacterial Operon Architecture Revealed by RNA Sequencing</article-title>. <source>mBio</source> vol. <volume>5</volume> Preprint at <pub-id pub-id-type="doi">10.1128/mbio.01442-14</pub-id> (<year>2014</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Thomason</surname>, <given-names>M. K.</given-names></string-name> <etal>et al.</etal> <article-title>Global transcriptional start site mapping using differential RNA sequencing reveals novel antisense RNAs in Escherichia coli</article-title>. <source>J. Bacteriol</source>. <volume>197</volume>, <fpage>18</fpage>–<lpage>28</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Gama-Castro</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>RegulonDB (version 6.0): gene regulation model of Escherichia coli K-12 beyond transcription, active (experimental) annotated promoters and Textpresso navigation</article-title>. <source>Nucleic Acids Res</source>. <volume>36</volume>, <fpage>D120</fpage>–<lpage>D124</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Belliveau</surname>, <given-names>N. M.</given-names></string-name> <etal>et al.</etal> <article-title>Systematic approach for dissecting the molecular mechanisms of transcriptional regulation in bacteria</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>115</volume>, <fpage>E4796</fpage>–<lpage>E4805</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Block</surname>, <given-names>D. H. S.</given-names></string-name>, <string-name><surname>Hussein</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Liang</surname>, <given-names>L. W.</given-names></string-name> &amp; <string-name><surname>Lim</surname>, <given-names>H. N</given-names></string-name>. <article-title>Regulatory consequences of gene translocation in bacteria</article-title>. <source>Nucleic Acids Res</source>. <volume>40</volume>, <fpage>8979</fpage>–<lpage>8992</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Sousa</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>de Lorenzo</surname>, <given-names>V.</given-names></string-name> &amp; <string-name><surname>Cebolla</surname>, <given-names>A</given-names></string-name>. <article-title>Modulation of gene expression through chromosomal positioning in Escherichia coli</article-title>. <source>Microbiology</source> <volume>143</volume> (<issue>Pt 6</issue>), <fpage>2071</fpage>–<lpage>2078</lpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Yin</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>Effects of chromosomal gene copy number and locations on polyhydroxyalkanoate synthesis by Escherichia coli and Halomonas sp</article-title>. <source>Appl. Microbiol. Biotechnol</source>. <volume>99</volume>, <fpage>5523</fpage>–<lpage>5534</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Kuhlman</surname>, <given-names>T. E.</given-names></string-name> &amp; <string-name><surname>Cox</surname>, <given-names>E. C</given-names></string-name>. <article-title>Gene location and DNA density determine transcription factor distributions in Escherichia coli</article-title>. <source>Mol. Syst. Biol</source>. <volume>8</volume>, <issue>610</issue> (<year>2012</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Sendy</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>D. J.</given-names></string-name>, <string-name><surname>Busby</surname>, <given-names>S. J. W.</given-names></string-name> &amp; <string-name><surname>Bryant</surname>, <given-names>J. A</given-names></string-name>. <article-title>RNA polymerase supply and flux through the lac operon in Escherichia coli</article-title>. <source>Philos. Trans. R. Soc. Lond. B Biol. Sci</source>. <volume>371</volume>, (<year>2016</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Scholz</surname>, <given-names>S. A.</given-names></string-name> <etal>et al.</etal> <article-title>High-Resolution Mapping of the Escherichia coli Chromosome Reveals Positions of High and Low Transcription</article-title>. <source>Cell Syst</source> <volume>8</volume>, <fpage>212</fpage>–<lpage>225</lpage>.e9 (<year>2019</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Bryant</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Sellars</surname>, <given-names>L. E.</given-names></string-name>, <string-name><surname>Busby</surname>, <given-names>S. J. W.</given-names></string-name> &amp; <string-name><surname>Lee</surname>, <given-names>D. J</given-names></string-name>. <article-title>Chromosome position effects on gene expression in Escherichia coli K-12</article-title>. <source>Nucleic Acids Res</source>. <volume>42</volume>, <fpage>11383</fpage>–<lpage>11392</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Brambilla</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Sclavi</surname>, <given-names>B</given-names></string-name>. <article-title>Gene regulation by H-NS as a function of growth conditions depends on chromosomal position in Escherichia coli</article-title>. <source>G3</source> <volume>5</volume>, <fpage>605</fpage>–<lpage>614</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Brewster</surname>, <given-names>R. C.</given-names></string-name> <etal>et al.</etal> <article-title>The transcription factor titration effect dictates level of gene expression</article-title>. <source>Cell</source> <volume>156</volume>, <fpage>1312</fpage>–<lpage>1323</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="web"><string-name><surname>Chen</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Shiroguchi</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Ge</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Xie</surname>, <given-names>X. S.</given-names></string-name> <article-title>Genome-wide study of mRNA degradation and transcript elongation in Escherichia coli</article-title>. <source>Molecular Systems Biology</source> vol. <volume>11</volume> <fpage>808</fpage>–<lpage>808</lpage> Preprint at <pub-id pub-id-type="doi">10.15252/msb.20159000</pub-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Esquerre</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal> <article-title>Dual role of transcription and transcript stability in the regulation of gene expression in Escherichia coli cells cultured on glucose at different growth rates</article-title>. <source>Nucleic Acids Res</source>. <volume>42</volume>, <fpage>2460</fpage>–<lpage>2472</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="web"><string-name><surname>Shearwin</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Callen</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Egan</surname>, <given-names>J.</given-names></string-name> <article-title>Transcriptional interference – a crash course</article-title>. <source>Trends in Genetics</source> vol. <volume>21</volume> <fpage>339</fpage>–<lpage>345</lpage> Preprint at <pub-id pub-id-type="doi">10.1016/j.tig.2005.04.009</pub-id> (<year>2005</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Callen</surname>, <given-names>B. P.</given-names></string-name>, <string-name><surname>Shearwin</surname>, <given-names>K. E.</given-names></string-name> &amp; <string-name><surname>Egan</surname>, <given-names>J. B</given-names></string-name>. <article-title>Transcriptional interference between convergent promoters caused by elongation over the promoter</article-title>. <source>Mol. Cell</source> <volume>14</volume>, <fpage>647</fpage>–<lpage>656</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Brophy</surname>, <given-names>J. A. N.</given-names></string-name> &amp; <string-name><surname>Voigt</surname>, <given-names>C. A</given-names></string-name>. <article-title>Antisense transcription as a tool to tune gene expression</article-title>. <source>Mol. Syst. Biol</source>. <volume>12</volume>, <fpage>854</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Warman</surname>, <given-names>E. A.</given-names></string-name> <etal>et al.</etal> <article-title>Widespread divergent transcription from bacterial and archaeal promoters is a consequence of DNA-sequence symmetry</article-title>. <source>Nat Microbiol</source> <volume>6</volume>, <fpage>746</fpage>–<lpage>756</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><surname>Yus</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal> <article-title>Transcription start site associated RNAs in bacteria</article-title>. <source>Mol. Syst. Biol</source>. <volume>8</volume>, <fpage>585</fpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Urtecho</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Tripp</surname>, <given-names>A. D.</given-names></string-name>, <string-name><surname>Insigne</surname>, <given-names>K. D.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Kosuri</surname>, <given-names>S</given-names></string-name>. <article-title>Systematic Dissection of Sequence Elements Controlling σ70 Promoters Using a Genomically Encoded Multiplexed Reporter Assay in Escherichia coli</article-title>. <source>Biochemistry</source> <volume>58</volume>, <fpage>1539</fpage>–<lpage>1551</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><surname>Garcia</surname>, <given-names>H. G.</given-names></string-name> <etal>et al.</etal> <article-title>Operator sequence alters gene expression independently of transcription factor occupancy in bacteria</article-title>. <source>Cell Rep</source>. <volume>2</volume>, <fpage>150</fpage>–<lpage>161</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><surname>Mutalik</surname>, <given-names>V. K.</given-names></string-name> <etal>et al.</etal> <article-title>Precise and reliable gene expression via standard transcription and translation initiation elements</article-title>. <source>Nat. Methods</source> <volume>10</volume>, <fpage>354</fpage>–<lpage>360</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><string-name><surname>Enyeart</surname>, <given-names>P. J.</given-names></string-name> <etal>et al.</etal> <article-title>Generalized bacterial genome editing using mobile group II introns and Cre-lox</article-title>. <source>Mol. Syst. Biol</source>. <volume>9</volume>, <fpage>685</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><string-name><surname>Yan</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Boitano</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Clark</surname>, <given-names>T. A.</given-names></string-name> &amp; <string-name><surname>Ettwiller</surname>, <given-names>L</given-names></string-name>. <article-title>SMRT-Cappable-seq reveals complex operon variants in bacteria</article-title>. <source>Nat. Commun</source>. <volume>9</volume>, <fpage>3676</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><string-name><surname>Grünberger</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Ferreira-Cerca</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Grohmann</surname>, <given-names>D</given-names></string-name>. <article-title>Nanopore sequencing of RNA and cDNA molecules in</article-title>. <source>RNA</source> <volume>28</volume>, <fpage>400</fpage>–<lpage>417</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><string-name><surname>Schneider</surname>, <given-names>D. A.</given-names></string-name>, <string-name><surname>Ross</surname>, <given-names>W.</given-names></string-name> &amp; <string-name><surname>Gourse</surname>, <given-names>R. L</given-names></string-name>. <article-title>Control of rRNA expression in Escherichia coli</article-title>. <source>Curr. Opin. Microbiol</source>. <volume>6</volume>, <fpage>151</fpage>–<lpage>156</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><string-name><surname>Yona</surname>, <given-names>A. H.</given-names></string-name>, <string-name><surname>Alm</surname>, <given-names>E. J.</given-names></string-name> &amp; <string-name><surname>Gore</surname>, <given-names>J</given-names></string-name>. <article-title>Random sequences rapidly evolve into de novo promoters</article-title>. <source>Nat. Commun</source>. <volume>9</volume>, <fpage>1530</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><string-name><surname>Cho</surname>, <given-names>B.-K.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Knight</surname>, <given-names>E. M.</given-names></string-name>, <string-name><surname>Zengler</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Palsson</surname>, <given-names>B. O</given-names></string-name>. <article-title>Genome-scale reconstruction of the sigma factor network in Escherichia coli: topology and functional states</article-title>. <source>BMC Biol</source>. <volume>12</volume>, <issue>4</issue> (<year>2014</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><string-name><surname>Krummel</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Chamberlin</surname>, <given-names>M. J</given-names></string-name>. <article-title>RNA chain initiation by Escherichia coli RNA polymerase. Structural transitions of the enzyme in early ternary complexes</article-title>. <source>Biochemistry</source> <volume>28</volume>, <fpage>7829</fpage>– <lpage>7842</lpage> (<year>1989</year>).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><string-name><surname>Hawley</surname>, <given-names>D. K.</given-names></string-name> &amp; <string-name><surname>McClure</surname>, <given-names>W. R</given-names></string-name>. <article-title>Compilation and analysis of Escherichia coli promoter DNA sequences</article-title>. <source>Nucleic Acids Res</source>. <volume>11</volume>, <fpage>2237</fpage>–<lpage>2255</lpage> (<year>1983</year>).</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><string-name><surname>He</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Jia</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Duan</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Zou</surname>, <given-names>Q</given-names></string-name>. <article-title>70ProPred: a predictor for discovering sigma70 promoters based on combining multiple features</article-title>. <source>BMC Syst. Biol</source>. <volume>12</volume>, <fpage>44</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><string-name><surname>Weaver</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Mohammad</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Buskirk</surname>, <given-names>A. R.</given-names></string-name> &amp; <string-name><surname>Storz</surname>, <given-names>G</given-names></string-name>. <article-title>Identifying Small Proteins by Ribosome Profiling with Stalled Initiation Complexes</article-title>. <source>MBio</source> <volume>10</volume>, (<year>2019</year>).</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><string-name><surname>Dornenburg</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>Devita</surname>, <given-names>A. M.</given-names></string-name>, <string-name><surname>Palumbo</surname>, <given-names>M. J.</given-names></string-name> &amp; <string-name><surname>Wade</surname>, <given-names>J. T</given-names></string-name>. <article-title>Widespread antisense transcription in Escherichia coli</article-title>. <source>MBio</source> <volume>1</volume>, (<year>2010</year>).</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><string-name><surname>Georg</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Hess</surname>, <given-names>W</given-names></string-name>. <article-title>R. cis-antisense RNA, another level of gene regulation in bacteria</article-title>. <source>Microbiol. Mol. Biol. Rev</source>. <volume>75</volume>, <fpage>286</fpage>–<lpage>300</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><string-name><surname>Güell</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Transcriptome complexity in a genome-reduced bacterium</article-title>. <source>Science</source> <volume>326</volume>, <fpage>1268</fpage>–<lpage>1271</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><string-name><surname>Ju</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Liu</surname>, <given-names>S</given-names></string-name>. <article-title>Full-length RNA profiling reveals pervasive bidirectional transcription terminators in bacteria</article-title>. <source>Nat Microbiol</source> <volume>4</volume>, <fpage>1907</fpage>–<lpage>1918</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><string-name><surname>Lloréns-Rico</surname>, <given-names>V.</given-names></string-name> <etal>et al.</etal> <article-title>Bacterial antisense RNAs are mainly the product of transcriptional noise</article-title>. <source>Sci Adv</source> <volume>2</volume>, <fpage>e1501363</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><string-name><surname>Brantl</surname>, <given-names>S</given-names></string-name>. <article-title>Regulatory mechanisms employed by cis-encoded antisense RNAs</article-title>. <source>Curr. Opin. Microbiol</source>. <volume>10</volume>, <fpage>102</fpage>–<lpage>109</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><string-name><surname>Goodman</surname>, <given-names>D. B.</given-names></string-name>, <string-name><surname>Church</surname>, <given-names>G. M.</given-names></string-name> &amp; <string-name><surname>Kosuri</surname>, <given-names>S</given-names></string-name>. <article-title>Causes and effects of N-terminal codon bias in bacterial genes</article-title>. <source>Science</source> <volume>342</volume>, <fpage>475</fpage>–<lpage>479</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><string-name><surname>Lamberte</surname>, <given-names>L. E.</given-names></string-name> <etal>et al.</etal> <article-title>Horizontally acquired AT-rich genes in Escherichia coli cause toxicity by sequestering RNA polymerase</article-title>. <source>Nat Microbiol</source> <volume>2</volume>, <fpage>16249</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><string-name><surname>Singh</surname>, <given-names>S. S.</given-names></string-name> <etal>et al.</etal> <article-title>Widespread suppression of intragenic transcription initiation by H-NS</article-title>. <source>Genes Dev</source>. <volume>28</volume>, <fpage>214</fpage>–<lpage>219</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="journal"><string-name><surname>Bolotin</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Hershberg</surname>, <given-names>R</given-names></string-name>. <article-title>Horizontally Acquired Genes Are Often Shared between Closely Related Bacterial Species</article-title>. <source>Front. Microbiol</source>. <volume>8</volume>, <fpage>1536</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="journal"><string-name><surname>Constantinidou</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>A reassessment of the FNR regulon and transcriptomic analysis of the effects of nitrate, nitrite, NarXL, and NarQP as Escherichia coli K12 adapts from aerobic to anaerobic growth</article-title>. <source>J. Biol. Chem.</source> <volume>281</volume>, <fpage>4802</fpage>–<lpage>4815</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="journal"><string-name><surname>Tao</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Bausch</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Richmond</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Blattner</surname>, <given-names>F. R.</given-names></string-name> &amp; <string-name><surname>Conway</surname>, <given-names>T</given-names></string-name>. <article-title>Functional Genomics: Expression Analysis ofEscherichia coli Growing on Minimal and Rich Media</article-title>. <source>J. Bacteriol</source>. <volume>181</volume>, <fpage>6425</fpage>–<lpage>6440</lpage> (<year>1999</year>).</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="journal"><string-name><surname>Yu</surname>, <given-names>T. C.</given-names></string-name> <etal>et al.</etal> <article-title>Multiplexed characterization of rationally designed promoter architectures deconstructs combinatorial logic for IPTG-inducible systems</article-title>. <source>Nat. Commun</source>. <volume>12</volume>, <fpage>325</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="journal"><string-name><surname>Massé</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Gottesman</surname>, <given-names>S</given-names></string-name>. <article-title>A small RNA regulates the expression of genes involved in iron metabolism in Escherichia coli</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>99</volume>, <fpage>4620</fpage>–<lpage>4625</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><string-name><surname>Massé</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Vanderpool</surname>, <given-names>C. K.</given-names></string-name> &amp; <string-name><surname>Gottesman</surname>, <given-names>S</given-names></string-name>. <article-title>Effect of RyhB small RNA on global iron use in Escherichia coli</article-title>. <source>J. Bacteriol</source>. <volume>187</volume>, <fpage>6962</fpage>–<lpage>6971</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c66"><label>66.</label><mixed-citation publication-type="journal"><string-name><surname>Barroga</surname>, <given-names>C. F.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Wajih</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Bouyer</surname>, <given-names>J. H.</given-names></string-name> &amp; <string-name><surname>Hermodson</surname>, <given-names>M. A</given-names></string-name>. <article-title>The proteins encoded by the rbs operon of escherichia coli: I. Overproduction, purification, characterization, and functional analysis of RbsA</article-title>. <source>Protein Science</source> vol. <volume>5</volume> <fpage>1093</fpage>–<lpage>1099</lpage> Preprint at <pub-id pub-id-type="doi">10.1002/pro.5560050611</pub-id> (<year>2008</year>).</mixed-citation></ref>
<ref id="c67"><label>67.</label><mixed-citation publication-type="journal"><string-name><surname>Aziz</surname>, <given-names>R. K.</given-names></string-name> <etal>et al.</etal> <article-title>The RAST Server: rapid annotations using subsystems technology</article-title>. <source>BMC Genomics</source> <volume>9</volume>, <issue>75</issue> (<year>2008</year>).</mixed-citation></ref>
<ref id="c68"><label>68.</label><mixed-citation publication-type="journal"><string-name><surname>Overbeek</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title>The SEED and the Rapid Annotation of microbial genomes using Subsystems Technology (RAST)</article-title>. <source>Nucleic Acids Res</source>. <volume>42</volume>, <fpage>D206</fpage>–<lpage>14</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c69"><label>69.</label><mixed-citation publication-type="journal"><string-name><surname>Fang</surname>, <given-names>X.</given-names></string-name> <etal>et al.</etal> <article-title>Global transcriptional regulatory network for Escherichia coli robustly connects gene expression to transcription factor activities</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>114</volume>, <fpage>10286</fpage>–<lpage>10291</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c70"><label>70.</label><mixed-citation publication-type="journal"><string-name><surname>Braun</surname>, <given-names>V</given-names></string-name>. <article-title>Iron uptake by Escherichia coli</article-title>. <source>Front. Biosci</source>. <volume>8</volume>, <fpage>s1409</fpage>–<lpage>21</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c71"><label>71.</label><mixed-citation publication-type="journal"><string-name><surname>Lee</surname>, <given-names>J.-W.</given-names></string-name> &amp; <string-name><surname>Helmann</surname>, <given-names>J. D</given-names></string-name>. <article-title>Functional specialization within the Fur family of metalloregulators</article-title>. <source>Biometals</source> <volume>20</volume>, <fpage>485</fpage>–<lpage>499</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c72"><label>72.</label><mixed-citation publication-type="other"><string-name><surname>Ireland</surname>, <given-names>W. T.</given-names></string-name> <etal>et al.</etal> <article-title>Deciphering the regulatory genome of Escherichia coli, one hundred promoters at a time</article-title>. (<year>2020</year>) doi:<pub-id pub-id-type="doi">10.7554/eLife.55308</pub-id>.</mixed-citation></ref>
<ref id="c73"><label>73.</label><mixed-citation publication-type="journal"><string-name><surname>Flashner</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Gralla</surname>, <given-names>J. D</given-names></string-name>. <article-title>Dual mechanism of repression at a distance in the lac operon</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>85</volume>, <fpage>8968</fpage>–<lpage>8972</lpage> (<year>1988</year>).</mixed-citation></ref>
<ref id="c74"><label>74.</label><mixed-citation publication-type="journal"><string-name><surname>Czarniecki</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Noel</surname>, <given-names>R. J.</given-names>, <suffix>Jr</suffix></string-name> &amp; <string-name><surname>Reznikoff</surname>, <given-names>W. S</given-names></string-name>. <article-title>The −45 region of the Escherichia coli lac promoter: CAP-dependent and CAP-independent transcription</article-title>. <source>J. Bacteriol</source>. <volume>179</volume>, <fpage>423</fpage>–<lpage>429</lpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c75"><label>75.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>G.-Y.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Inouye</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Ikura</surname>, <given-names>M</given-names></string-name>. <article-title>Structural mechanism of transcriptional autorepression of the Escherichia coli RelB/RelE antitoxin/toxin module</article-title>. <source>J. Mol. Biol</source>. <volume>380</volume>, <fpage>107</fpage>–<lpage>119</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c76"><label>76.</label><mixed-citation publication-type="journal"><string-name><surname>Grogan</surname>, <given-names>D. W.</given-names></string-name> &amp; <string-name><surname>Cronan</surname>, <given-names>J. E.</given-names>, <suffix>Jr</suffix></string-name>. <article-title>Cloning and manipulation of the Escherichia coli cyclopropane fatty acid synthase gene: physiological aspects of enzyme overproduction</article-title>. <source>J. Bacteriol</source>. <volume>158</volume>, <fpage>286</fpage>–<lpage>295</lpage> (<year>1984</year>).</mixed-citation></ref>
<ref id="c77"><label>77.</label><mixed-citation publication-type="journal"><string-name><surname>Chang</surname>, <given-names>Y. Y.</given-names></string-name> &amp; <string-name><surname>Cronan</surname>, <given-names>J. E.</given-names>, <suffix>Jr</suffix></string-name>. <article-title>Membrane cyclopropane fatty acid content is a major factor in acid resistance of Escherichia coli</article-title>. <source>Mol. Microbiol</source>. <volume>33</volume>, <fpage>249</fpage>–<lpage>259</lpage> (<year>1999</year>).</mixed-citation></ref>
<ref id="c78"><label>78.</label><mixed-citation publication-type="journal"><string-name><surname>Ebright</surname>, <given-names>R. H</given-names></string-name>. <article-title>Transcription activation at Class I CAP-dependent promoters</article-title>. <source>Mol. Microbiol</source>. <volume>8</volume>, <fpage>797</fpage>–<lpage>802</lpage> (<year>1993</year>).</mixed-citation></ref>
<ref id="c79"><label>79.</label><mixed-citation publication-type="journal"><string-name><surname>Williams</surname>, <given-names>S. M.</given-names></string-name>, <string-name><surname>Savery</surname>, <given-names>N. J.</given-names></string-name>, <string-name><surname>Busby</surname>, <given-names>S. J.</given-names></string-name> &amp; <string-name><surname>Wing</surname>, <given-names>H. J</given-names></string-name>. <article-title>Transcription activation at class I FNR-dependent promoters: identification of the activating surface of FNR and the corresponding contact site in the C-terminal domain of the RNA polymerase alpha subunit</article-title>. <source>Nucleic Acids Res</source>. <volume>25</volume>, <fpage>4028</fpage>–<lpage>4034</lpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c80"><label>80.</label><mixed-citation publication-type="journal"><string-name><surname>Browning</surname>, <given-names>D. F.</given-names></string-name> &amp; <string-name><surname>Busby</surname>, <given-names>S. J</given-names></string-name>. <article-title>The regulation of bacterial transcription initiation</article-title>. <source>Nat. Rev. Microbiol</source>. <volume>2</volume>, <fpage>57</fpage>–<lpage>65</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c81"><label>81.</label><mixed-citation publication-type="journal"><string-name><surname>Rojo</surname>, <given-names>F</given-names></string-name>. <article-title>Repression of transcription initiation in bacteria</article-title>. <source>J. Bacteriol</source>. <volume>181</volume>, <fpage>2987</fpage>–<lpage>2991</lpage> (<year>1999</year>).</mixed-citation></ref>
<ref id="c82"><label>82.</label><mixed-citation publication-type="journal"><string-name><surname>Liu</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Tolstorukov</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Zhurkin</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Garges</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Adhya</surname>, <given-names>S</given-names></string-name>. <article-title>A mutant spacer sequence between −35 and −10 elements makes the Plac promoter hyperactive and cAMP receptor protein-independent</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>101</volume>, <fpage>6911</fpage>–<lpage>6916</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c83"><label>83.</label><mixed-citation publication-type="journal"><string-name><surname>Salgado</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title>RegulonDB v8.0: omics data sets, evolutionary conservation, regulatory phrases, cross-validated gold standards and more</article-title>. <source>Nucleic Acids Research</source> vol. <volume>41</volume> <fpage>D203</fpage>– <lpage>D213</lpage> Preprint at <pub-id pub-id-type="doi">10.1093/nar/gks1201</pub-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c84"><label>84.</label><mixed-citation publication-type="other"><string-name><surname>Paggi</surname>, <given-names>J</given-names></string-name>., <etal>et al.</etal> <article-title>Predicting Transcriptional Regulatory Activities with Deep Convolutional Networks</article-title>. <source>bioRxiv</source> 099879 (<year>2017</year>) doi:<pub-id pub-id-type="doi">10.1101/099879</pub-id>.</mixed-citation></ref>
<ref id="c85"><label>85.</label><mixed-citation publication-type="journal"><string-name><surname>Movva</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title>Deciphering regulatory DNA sequences and noncoding genetic variants using neural network models of massively parallel reporter assays</article-title>. <source>PLoS One</source> <volume>14</volume>, <fpage>e0218073</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c86"><label>86.</label><mixed-citation publication-type="journal"><string-name><surname>Schmidt</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Brandt</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Busche</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Kalinowski</surname>, <given-names>J</given-names></string-name>. <article-title>Characterization of Bacterial Transcriptional Regulatory Networks in through Genome-Wide In Vitro Run-Off Transcription/RNA-seq (ROSE)</article-title>. <source>Microorganisms</source> <volume>11</volume>, (<year>2023</year>).</mixed-citation></ref>
<ref id="c87"><label>87.</label><mixed-citation publication-type="journal"><string-name><surname>Horwitz</surname>, <given-names>M. S.</given-names></string-name> &amp; <string-name><surname>Loeb</surname>, <given-names>L. A</given-names></string-name>. <article-title>Promoters selected from random DNA sequences</article-title>. <source>Proceedings of the National Academy of Sciences</source> vol. <volume>83</volume> <fpage>7405</fpage>–<lpage>7409</lpage> Preprint at <pub-id pub-id-type="doi">10.1073/pnas.83.19.7405</pub-id> (<year>1986</year>).</mixed-citation></ref>
<ref id="c88"><label>88.</label><mixed-citation publication-type="journal"><string-name><surname>Wolf</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Silander</surname>, <given-names>O. K.</given-names></string-name> &amp; <string-name><surname>van Nimwegen</surname>, <given-names>E</given-names></string-name>. <article-title>Expression noise facilitates the evolution of gene regulation</article-title>. <source>Elife</source> <volume>4</volume>, (<year>2015</year>).</mixed-citation></ref>
<ref id="c89"><label>89.</label><mixed-citation publication-type="journal"><string-name><surname>Fitzgerald</surname>, <given-names>D. M.</given-names></string-name>, <string-name><surname>Stringer</surname>, <given-names>A. M.</given-names></string-name>, <string-name><surname>Smith</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Lapierre</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Wade</surname>, <given-names>J. T</given-names></string-name>. <article-title>Genome-Wide Mapping of the Escherichia coli PhoB Regulon Reveals Many Transcriptionally Inert, Intragenic Binding Sites</article-title>. <source>MBio</source> <volume>14</volume>, <fpage>e0253522</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c90"><label>90.</label><mixed-citation publication-type="journal"><string-name><surname>LaFleur</surname>, <given-names>T. L.</given-names></string-name>, <string-name><surname>Hossain</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Salis</surname>, <given-names>H. M</given-names></string-name>. <article-title>Automated model-predictive design of synthetic promoters to control transcriptional profiles in bacteria</article-title>. <source>Nat. Commun</source>. <volume>13</volume>, <fpage>5159</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c91"><label>91.</label><mixed-citation publication-type="journal"><string-name><surname>Einav</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Phillips</surname>, <given-names>R</given-names></string-name>. <article-title>How the avidity of polymerase binding to the--35/--10 promoter sites affects gene expression</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>201905615</volume> (<year>2019</year>).</mixed-citation></ref>
<ref id="c92"><label>92.</label><mixed-citation publication-type="other"><string-name><surname>Selvarajoo</surname>, <given-names>K.</given-names></string-name> <source>Computational Biology and Machine Learning for Metabolic Engineering and Synthetic Biology.</source> (<publisher-name>Springer Nature,</publisher-name> <year>2022</year>).</mixed-citation></ref>
<ref id="c93"><label>93.</label><mixed-citation publication-type="journal"><string-name><surname>de Boer</surname>, <given-names>C. G.</given-names></string-name> <etal>et al.</etal> <article-title>Deciphering eukaryotic gene-regulatory logic with 100 million random promoters</article-title>. <source>Nat. Biotechnol</source>. (<year>2019</year>) doi:<pub-id pub-id-type="doi">10.1038/s41587-019-0315-8</pub-id>.</mixed-citation></ref>
<ref id="c94"><label>94.</label><mixed-citation publication-type="journal"><string-name><surname>Vaishnav</surname>, <given-names>E. D.</given-names></string-name> <etal>et al.</etal> <article-title>The evolution, evolvability and engineering of gene regulatory DNA</article-title>. <source>Nature</source> <volume>603</volume>, <fpage>455</fpage>–<lpage>463</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c95"><label>95.</label><mixed-citation publication-type="journal"><string-name><surname>Blattner</surname>, <given-names>F. R.</given-names></string-name> <etal>et al.</etal> <article-title>The complete genome sequence of Escherichia coli K-12</article-title>. <source>Science</source> <volume>277</volume>, <fpage>1453</fpage>–<lpage>1462</lpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c96"><label>96.</label><mixed-citation publication-type="journal"><string-name><surname>Kosuri</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Composability of regulatory sequences controlling transcription and translation in Escherichia coli</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>110</volume>, <fpage>14024</fpage>–<lpage>14029</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c97"><label>97.</label><mixed-citation publication-type="other"><string-name><surname>Jones</surname>, <given-names>E. M.</given-names></string-name>, <etal>et al.</etal> <article-title>Structural and Functional Characterization of G Protein-Coupled Receptors with Deep Mutational Scanning</article-title>. <source>bioRxiv</source> <fpage>623108</fpage> (<year>2019</year>) doi:<pub-id pub-id-type="doi">10.1101/623108</pub-id>.</mixed-citation></ref>
<ref id="c98"><label>98.</label><mixed-citation publication-type="other"><string-name><surname>Bushnell</surname>, <given-names>B</given-names></string-name>. <article-title>BBMap short read aligner</article-title>. (<year>2016</year>).</mixed-citation></ref>
<ref id="c99"><label>99.</label><mixed-citation publication-type="journal"><string-name><surname>Langmead</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Salzberg</surname>, <given-names>S. L</given-names></string-name>. <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nat. Methods</source> <volume>9</volume>, <fpage>357</fpage>–<lpage>359</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c100"><label>100.</label><mixed-citation publication-type="journal"><string-name><surname>Kim</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Langmead</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Salzberg</surname>, <given-names>S. L</given-names></string-name>. <article-title>HISAT: a fast spliced aligner with low memory requirements</article-title>. <source>Nat. Methods</source> <volume>12</volume>, <fpage>357</fpage>–<lpage>360</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c101"><label>101.</label><mixed-citation publication-type="journal"><string-name><surname>Ramírez</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal> <article-title>deepTools2: a next generation web server for deep-sequencing data analysis</article-title>. <source>Nucleic Acids Res</source>. <volume>44</volume>, <fpage>W160</fpage>–<lpage>5</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c102"><label>102.</label><mixed-citation publication-type="journal"><string-name><surname>Shahmuradov</surname>, <given-names>I. A.</given-names></string-name>, <string-name><surname>Mohamad Razali</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Bougouffa</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Radovanovic</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Bajic</surname>, <given-names>V. B</given-names></string-name>. <article-title>bTSSfinder: a novel tool for the prediction of promoters in cyanobacteria and Escherichia coli</article-title>. <source>Bioinformatics</source> <volume>33</volume>, <fpage>334</fpage>–<lpage>340</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c103"><label>103.</label><mixed-citation publication-type="journal"><string-name><surname>Pagès</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Aboyoun</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Gentleman</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>DebRoy</surname>, <given-names>S</given-names></string-name>. <article-title>Biostrings: Efficient manipulation of biological strings</article-title>. <source>R package version</source> <volume>2</volume>, (<year>2017</year>).</mixed-citation></ref>
<ref id="c104"><label>104.</label><mixed-citation publication-type="journal"><string-name><surname>Johns</surname>, <given-names>N. I.</given-names></string-name> <etal>et al.</etal> <article-title>Metagenomic mining of regulatory elements enables programmable species-selective gene expression</article-title>. <source>Nat. Methods</source> <volume>15</volume>, <fpage>323</fpage>–<lpage>329</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c105"><label>105.</label><mixed-citation publication-type="journal"><string-name><surname>Ghandi</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>gkmSVM: an R package for gapped-kmer SVM</article-title>. <source>Bioinformatics</source> <volume>32</volume>, <fpage>2205</fpage>– <lpage>2207</lpage> (<year>2016</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.92558.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Wade</surname>
<given-names>Joseph T</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Wadsworth Center, New York State Department of Health</institution>
</institution-wrap>
<city>Albany</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Compelling</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>Urtecho et al. use genome-integrated massively parallel reporter assays to catalog and characterize promoters throughout the Escherichia coli genome. The result is a state-of-the-art atlas of promoters, coupled with information on their regulation, that is readily accessible through the website <ext-link ext-link-type="uri" xlink:href="http://ecolipromoterdb.com">http://ecolipromoterdb.com</ext-link>. This <bold>compelling</bold> work provides an <bold>important</bold> resource for researchers studying bacterial transcriptional regulation.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.92558.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
This paper uses a high-throughput assay of transcription levels to (i) assess the potential of large numbers of Escherichia coli genomic sequences to function as promoters, and (ii) identify regulatory sequences in some of those promoters. This is a substantial undertaking, and while much of the work supports principles of transcription and transcription regulation described by many prior studies, there is considerable value in assessing promoters on such a large scale. The identification of putative regulatory sequences in larger numbers of promoters will likely be valuable to other groups studying transcription regulation in E. coli. And the analysis of antisense promoters provides some interesting new insight that goes beyond previous anecdotal studies.</p>
<p>Strengths:</p>
<p>
- The presentation of the work is very clear, and the conclusions are mostly well supported by the data.</p>
<p>
- The assays are rigorously controlled and analyzed.</p>
<p>
- Conclusions regarding the impact of antisense transcription on sense transcript levels provide new insight. While these data are consistent with previous anecdotal studies, to my knowledge this is the first large-scale analysis supporting a negative regulatory role for antisense transcription.</p>
<p>
- The putative regulatory elements mapped in the high-throughput mutagenesis experiments will be a valuable resource for the scientific community.</p>
<p>Weaknesses:</p>
<p>
(all minor)</p>
<p>
- There are some parts where the authors could clarify their arguments.</p>
<p>
- I'm not convinced that intragenic promoters impact codon usage rather than the other way around.</p>
<p>
- The authors should present a more nuanced discussion of promoters that avoids making yes/no calls (i.e., characterize sequences by promoter strength rather than a binary yes/no call of being a promoter).</p>
<p>
- Data relating to intragenic promoters should be presented and discussed for sense and antisense promoters separately.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.92558.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>In this work, Urtecho et al. use genome-integrated massively parallel reporter assays (MPRAs) to catalog the locations of promoters throughout the E. coli genome. Their study uses four different MPRA libraries. First, they assayed a library containing 17,635 promoter regions having transcription start sites (TSSs) previously reported by three different sources. They found that 2,760 of these regions exhibited transcription above an experimentally determined threshold. Second, they assayed a library using sheared E. coli genome fragments. This library allowed the authors to systematically identify candidate promoter regions throughout the genome, some of which had not been identified before. Additionally, by performing experiments with this library under different growth conditions, the authors were able to identify promoters with condition-dependent activity. Third, to improve the resolution at which they were able to identify transcription start sites, the authors assayed a library that tiled all candidate promoter regions identified using the genomic fragments library. Data from the tiled library allowed the authors to identify minimal promoter regions. Fourth, the authors assayed a scanning mutagenesis library in which they systematically scrambled individual 10 bp windows within 2,057 previously identified active promoters at 5 bp intervals. After validation with known promoters, this approach allowed the authors to identify novel functional elements within regulatory regions. Finally, the authors fit multiple machine learning models to their data with the goal of predicting promoter activity from DNA sequences.</p>
<p>The work by Urtecho et al. provides an important resource for researchers studying bacterial transcriptional regulation. Despite decades of study, a comprehensive catalogue of E. coli promoters is still lacking. The results of Urtecho et al. provide a state-of-the-art atlas of promoters in the E. coli genome that is readily accessible through the website, <ext-link ext-link-type="uri" xlink:href="http://ecolipromoterdb.com">http://ecolipromoterdb.com</ext-link>. The authors' work also provides an important demonstration of the power of genome-integrated MPRAs. Unlike many MPRA-based studies, the authors use the results of their initial MPRAs to design follow-up MPRAs, which they then carry out. Finally, the scanning mutagenesis MPRAs the authors perform provide valuable data that could lead to the discovery of novel transcription factor binding sites and other functional regulatory sequence elements.</p>
<p>Below I provide two major critiques and some minor critiques of the paper. The purpose of these critiques is simply to help the authors improve the quality of the manuscript.</p>
<p>Major points:</p>
<p>
1. Ultimately, a comprehensive atlas of E. coli promoters should include nucleotide resolution TSS data, which is not present in the MPRA datasets reported by Urtecho et al.. The authors do use some methods to narrow down the positions of TSSs, but these methods do not provide the resolution one would ideally like to see in a TSS atlas. I understand that acquiring single-nucleotide-resolution data is beyond the scope of this manuscript, but it still might make sense for the authors to discuss this limitation in the Discussion section.</p>
<p>2. The authors should clarify which points in the Results section are novel conclusions or observations, and which points are simply statements that prior conclusions or observations were confirmed. This distinction can be unclear at times.</p>
<p>Minor points:</p>
<p>
1. Line 200-203: &quot;We conclude that inactive TSS-associated promoters lack -35 elements but may become active in growth conditions where additional transcription factors mobilize and facilitate RNAP positioning in the absence of a -35 motif.&quot; Making this type of mechanistic observations from the slight difference observed in the enrichment analysis seems too speculative to me. Also, I do not understand how the discrepancies can be explained in terms of transcription factor differences. If the previous studies from which the annotated TSS were extracted were also performed during the log phase in rich media, why would the transcription factors present be different?</p>
<p>2. Line 224-226: &quot;Active TSSs not overlapping a candidate promoter region generally exhibited weak activity, which may indicate that greater sensitivity is achieved through testing of oligo-array synthesized regions (Figure S3).&quot; The authors should clarify this statement. In particular, it is mechanistically unclear why one library would be more sensitive than another if they contain similar sequences.</p>
<p>3. Figure 2B. The authors should clarify that the heights of the arrows correspond to TSS activity as assayed by one library and that the pile-up plots represent promoter activity as assayed by a different library.</p>
<p>4. Line 255-257: &quot;We also observed an enrichment for 150 bp minimal promoter regions, although these were generally weak indicating that our resolution is limited when tiling weaker promoters.&quot; The authors should clarify whether the peak at 150 bp is an artifact of using oligos containing 150 bp tiles to construct the library. Also, the authors should clarify why there are some minimal promoters with lengths &gt; 150 bp when the length of the tiles was 150 bp.</p>
<p>5. Line 262 refers to &quot;Supplementary Table 1&quot;, but I was not able to find this table in the supplement.</p>
<p>6. Line 324-325: &quot;We used a σ70 PWM to identify the highest-scoring σ70 motifs within intragenic promoters and determined their relative coding frames&quot;. I find the term &quot;relative coding frame&quot; here to be unclear; the authors should clarify what they mean.</p>
<p>7. Figure 3 C , D: The authors should use the same terminology in the plots and the methods section describing them. They should also clarify how the values plotted in C and D were computed.</p>
<p>8. Line 329-332: &quot;The observed depletion of -35 motifs positioned in the +2 reading frame and -10 motifs in the +1 reading frame is likely due to the fact that the canonical sequences for these motifs would create stop codons within the protein if placed at these positions.&quot; The definition of the reading frame here is unclear. Do the authors mean that the 0 frame is defined as occurring when the hexamer exactly overlaps 2 codons, the +1 frame is when the hexamer is shifted 1 nt downstream of that position, and the +2 frame is when the hexamer is shifted 2 nt downstream of that position?</p>
<p>9. Line 538-539: &quot;We performed hyperparameter tuning for a three-layer CNN and achieved an AUPRC =0.44.&quot; The authors should explicitly describe the architecture used for the CNN, and perhaps include a diagram of this architecture. In addition, the authors should clarify the mathematical forms of the other methods tested.</p>
<p>10. Line 1204-1205: &quot;We standardized all datasets as detailed above in 'Universal Promoter Expression Quantification and Activity Thresholding'&quot;. That title does not appear before in the text. I believe the appropriate subsection is called &quot;Standardizing Promoter Expression Quantification and Activity Thresholding&quot;.</p>
<p>11. Line 1265-1266: &quot;We include a k-mer if the absolute correlation with expression is greater than the 'random' k-mer frequency, resulting in 4800/5440 filtered k-mers.&quot; It is unclear to me which two correlations are being compared. Please clarify. For example, would this be accurate: &quot;We include a k-mer if the absolute correlation of its frequency with expression is greater than the absolute correlation of its 'random' frequency with expression&quot;?</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.92558.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>In this revised manuscript, Urtecho et al., present an updated version of their earlier submission. They characterized thousands of promoter sequences in E. coli using a massively-parallel reporter assay and built a number of computational models to classify active from inactive promoters or associate the sequence to promoter expression/strength. As eluded in the earlier review cycle, the amount of experimental, bioinformatics, and analytical work presented here is astounding.</p>
<p>Identifying promoters and associating genomic (or promoter) sequences to promoter strength is nontrivial. Authors report challenges in achieving this grand goal even with the state-of-the-art characterization technology used here. Nevertheless, the experimental work, analytic workflow, and data resource presented here will serve as a milestone for future researchers.</p>
</body>
</sub-article>
</article>