<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">88794</article-id>
<article-id pub-id-type="doi">10.7554/eLife.88794</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.88794.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Barcode-free multiplex plasmid sequencing using Bayesian analysis and nanopore sequencing</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0197-8401</contrib-id>
<name>
<surname>Uematsu</surname>
<given-names>Masaaki</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>mu84@cornell.edu</email>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2939-3138</contrib-id>
<name>
<surname>Baskin</surname>
<given-names>Jeremy M</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<email>jeremy.baskin@cornell.edu</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05bnh6r87</institution-id><institution>Weill Institute for Cell and Molecular Biology, Cornell University</institution></institution-wrap>, <city>Ithaca</city>, <country country="US">United States</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05bnh6r87</institution-id><institution>Department of Chemistry and Chemical Biology, Cornell University</institution></institution-wrap>, <city>Ithaca</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Zambrano</surname>
<given-names>María Mercedes</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>CorpoGen</institution>
</institution-wrap>
<city>Bogotá</city>
<country>Colombia</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Weigel</surname>
<given-names>Detlef</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Biology Tübingen</institution>
</institution-wrap>
<city>Tübingen</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-08-15">
<day>15</day>
<month>08</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-04-07">
<day>07</day>
<month>04</month>
<year>2025</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP88794</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-05-07">
<day>07</day>
<month>05</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-04-21">
<day>21</day>
<month>04</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.04.12.536413"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-08-15">
<day>15</day>
<month>08</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.88794.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.88794.1.sa2">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.88794.1.sa1">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.88794.1.sa0">Reviewer #2 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Uematsu &amp; Baskin</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Uematsu &amp; Baskin</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-88794-v2.pdf"/>
<abstract>
<title>Abstract</title><p>Plasmid construction is central to life science research, and sequence verification is arguably its costliest step. Long-read sequencing has emerged as a competitor to Sanger sequencing, with the principal benefit that whole plasmids can be sequenced in a single run. Nevertheless, the current cost of nanopore sequencing is still prohibitive for routine sequencing during plasmid construction. We develop a computational approach termed Simple Algorithm for Very Efficient Multiplexing of Oxford Nanopore Experiments for You (SAVEMONEY) that guides researchers to mix multiple plasmids and subsequently computationally de-mixes the resultant sequences. SAVEMONEY defines optimal mixtures in a pre-survey step, and following sequencing, executes a post-analysis workflow involving sequence classification, alignment, and consensus determination. By using Bayesian analysis with prior probability of expected plasmid construction error rate, high-confidence sequences can be obtained for each plasmid in the mixture. Plasmids differing by as little as two bases can be mixed for submission as a single sample for nanopore sequencing, and routine multiplexing of even six plasmids per 180 reads can still maintain high accuracy of consensus sequencing. SAVEMONEY should further democratize whole-plasmid sequencing by nanopore and related technologies, driving down the effective cost of whole-plasmid sequencing to lower than that of a single Sanger sequencing run.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>- Made packaged script available on PyPI
- Added more direct comparisons to other computational tools and sequencing methods
- Added capability to analyze linear amplicons
- Modified code to significantly improve computation time, especially for classification step, and also enable multiprocessing</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Plasmid construction is a core technique in life science research. Conventionally, it is performed by ligation or assembly of DNA fragments typically generated by PCR amplification or solid-phase oligonucleotide synthesis into a linearized vector<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Because errors can be introduced at the PCR amplification, chemical synthesis, ligation, or assembly steps, the final products must be confirmed by a sequencing method. Classically, Sanger sequencing is used, and it involves synthesis of a complementary DNA strand in a polymerase-catalyzed reaction doped with chain-terminating, dideoxynucleotides bearing one of four different fluorescent dyes<sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c3">3</xref></sup>. Stochastic chain termination produces a series of fluorescent products whose lengths and fluorescence properties are measured by capillary electrophoresis, allowing the base calling at each position. Sanger sequencing is highly accurate. The quality of its base calling is typically accessed by using the Phred score, <italic>Q,</italic> calculated using the following equation<sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c5">5</xref></sup>:
<disp-formula>
<graphic xlink:href="536413v3_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>E</italic> represents the probability of the base calling error. Phred scores are used to characterize the quality of DNA sequences and filter out low-quality data to ensure the reliability of sequencing results.</p>
<p>Recently, long-read sequencing has emerged as an alternative method to Sanger sequencing for verifying plasmid sequences. Notable among these methods is nanopore sequencing, which uses nanometer-sized holes in polymer membranes<sup><xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c7">7</xref></sup>. When an electric current is applied across the pore, the passage of DNA molecules through the pore decreases the flux of ions to produce an electrical signal. These changes can be used to determine the sequence of the DNA molecule. Nanopore sequencing offers several advantages over other sequencing technologies, including the ability to sequence long reads, the ability to detect modifications to the DNA molecule, and the potential for real-time sequencing. Another advantage of nanopore sequencing is that it can reduce costs through barcode introduction during library preparation, enabling multiplexing<sup><xref ref-type="bibr" rid="c8">8</xref>–<xref ref-type="bibr" rid="c10">10</xref></sup>. Barcoding can be introduced into sheared DNA either by PCR or PCR-free methods such as blunt/TA ligation or barcoded transposase complexes. The barcoded libraries are pooled, and the DNA is delivered to the nanopores on the flow cell by attaching sequencing adaptors containing motor proteins.</p>
<p>A disadvantage of nanopore sequencing is its relatively high error rate, which arises because the signal is sensitive to factors including sample quality and the speed of DNA movement through the pore<sup><xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c12">12</xref></sup>. In addition, changes in current are elicited not by movement of single bases through the pore but rather five-nucleotide “words” known as <italic>k</italic>-mers<sup><xref ref-type="bibr" rid="c13">13</xref></sup>. Therefore, changes in current do not correspond directly with bases, making the base calling and error correction difficult. To compensate for its high error rate, consensus sequencing is typically employed, wherein multiple reads from different pores are aligned to generate a high-quality sequence.</p>
<p>In the Sanger sequencing era, and even still today with the advent of nanopore sequencing, it is common practice to not sequence entire plasmids but rather only the insert regions. This shortcut persists because insert regions are more prone to mutation than plasmid backbones due to the nature of their generation. Nevertheless, the probability of mutagenesis in the vector backbone is non-zero, and some plasmids can form dimers or multimers<sup><xref ref-type="bibr" rid="c14">14</xref></sup>. In addition, as plasmid construction efforts have become increasingly complex in recent years, nanopore sequencing is desirable when inserts are long or contain repetitive sequences. Thus, it is most rigorous to sequence entire plasmids, which is impractical using Sanger sequencing but feasible using nanopore sequencing, rather than simply sequencing inserts. However, in most cases Sanger sequencing is still chosen due to its lower cost. For example, Sanger sequencing currently costs ∼$4-5 (USD) per reaction, which produces ∼900-1000 bases of high-quality data. In contrast, nanopore sequencing currently costs ∼$15 (USD) per plasmid through commercial services like Plasmidsaurus, which uses V14 chemistry on PromethION with a R10.4.1 flow cell, typically returning ∼100-1000 reads. Therefore, although nanopore sequencing is a powerful and cutting-edge technology, it has not yet advanced to the point of replacing Sanger sequencing.</p>
<p>Theoretically, mixing samples and submitting them in one tube would greatly reduce costs, but such mixing also reduces the quality of the analysis because of two reasons: (1) it is unknown from which sample each nanopore read is derived, and (2) the number of reads per sample will diminish. Typically, in large-scale sequencing such as whole genome sequencing performed by laboratories that own sequencers, barcoding is used to determine the origin of each read. In addition, each read is aligned against a reference sequence to increase the quality of the analysis. In contrast, in the context of plasmid construction, most users outsource sequencing to core facilities or companies. In this case, it is the third party that performs library preparation for nanopore sequencing; therefore, users typically cannot include barcodes. Finally, whereas reference sequences are not updated frequently in genome sequencing, a new reference plasmid sequence must be used for each analysis in plasmid construction, making it difficult to take advantage of existing platforms for pooling and multiplexing samples.</p>
<p>Here, we have developed a barcode-free, easy-to-use computational approach termed Simple Algorithm for Very Efficient Multiplexing of Oxford Nanopore Experiments for You (SAVEMONEY) that guides users to pool samples for nanopore sequencing and effectively reduces sequencing costs to as low as $2.50 (USD) per plasmid, which is about twice less expensive than one reaction of Sanger sequencing. Our approach involves submitting samples with multiple different plasmids mix in a single tube and deconvolving the obtained sequencing results while maintaining the quality of the analysis. Instead of using additional barcodes, SAVEMONEY leverages plasmid blueprints (maps), which are in most cases already made by researchers prior to plasmid construction. We found that reads from plasmids that differ by as little as two bases in their sequences can be accurately deconvolved without any additional barcoding. Further, we used Bayesian analysis to increase the quality of analysis from a lower number of reads per sample, adopting strategies commonly used in the analysis of single nucleotide polymorphisms (SNPs)<sup><xref ref-type="bibr" rid="c15">15</xref></sup>. To make our method widely available, we implemented SAVEMONEY on Google Colab and have made code available on GitHub and PyPI. Thus, SAVEMONEY is a straightforward and robust approach for experimental multiplexing and computational de-multiplexing of nanopore plasmid sequencing to accelerate democratization of this powerful technology.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Overview of the algorithm</title>
<p>In most cases of plasmid construction, the correct (i.e., expected) sequence is known because the process starts with making blueprint or map of the plasmid. In addition, typically only plasmids confirmed to have been largely constructed correctly by rapid and inexpensive restriction enzyme digestion or similar laboratory assays are submitted to sequencing analysis. These pieces of a priori information — “knowledge of correct, expected sequence of the plasmid” and “certainty that construction largely proceeded correctly” — can be used to classify the mixed sequence reads and to improve the quality of base calling. Therefore, it should be possible to attain comparable accuracy using a smaller number of reads than that provided in a typical commercial nanopore sequencing sample, enabling barcode-free multiplexing.</p>
<p>The outline of our procedure is as follows: (1) pre-survey, (2) sample submission, and (3) post-analysis (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). The pre-survey step determines the optimal combination of plasmids suitable for mixing prior to submitting to nanopore sequencing. If the sequences of two plasmids are similar, it becomes more difficult to classify reads from each plasmid a posteriori even with the presence of prior information. Therefore, these kinds of plasmids should be submitted in separate samples. For example, multiple colonies from the same plasmid construction effort cannot be submitted together, because they are expected to have the same sequence (i.e., they share an identical blueprint/map). Therefore, our pre-survey algorithm examines the blueprints of the plasmids and generates recommended groupings as outputs, so that similar ones do not fall into the same group.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 1</label>
<caption><title>Workflow for Simple Algorithm for Very Efficient Multiplexing of Oxford Nanopore Experiments for You (SAVEMONEY).</title>
<p>The algorithm consists of three steps: pre­survey, sample submission, and post-analysis. The pre-survey step identifies the optimal combination of plasmids that will permit suitable accuracy for the classification step of the post­analysis. Plasmids with divergent sequences are grouped together, and those with very similar sequences are classified into different groups. After sample submission and sequencing, the post­analysis component, which consists of three different steps, is performed to deconvolve the obtained results. Reads (query sequences) are first classified based on its similarity to the plasmid blueprint/map (reference sequence). Reads are then aligned against reference sequences. Finally, consensus sequences and quality scores are calculated based on base calling, quality score from each read, and reference sequence, using Bayesian analysis.</p></caption>
<graphic xlink:href="536413v3_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>One key variable that our pre-survey does not explicitly determine is the maximum number of plasmids that may be safely grouped together. Because read quality, assessed by examining quality score distributions, is typically stable, the main variable affecting multiplexing ability is the overall coverage per plasmid. Having too many plasmids in one group will result in too few reads per plasmid and lower quality scores for the final consensus sequence, but this shortcoming can be compensated if the nanopore flow cell produces higher coverage. However, the coverage provided by commercial sequencing services such as Plasmidsaurus varies from the order of 10<sup>2</sup> to 10<sup>3</sup> and is difficult to predict because each nanopore flow cell has different properties. Therefore, it is not possible to determine the maximum number of plasmids that can be mixed in the pre-survey process. Instead, we project that the theoretical minimum number of reads that is required for the reliable consensus calculation is 30 reads per plasmid (discussed in detail later in “Maximum number of plasmids that can be mixed” section). In practice, we typically obtain high-quality results by mixing up to six plasmids when submitting samples for sequencing at the Plasmidsaurus service certified by Oxford Nanopore Technologies, which currently typically provides ∼200 or more reads per sample, with read length and quality score distribution properties shown in <xref rid="fig2" ref-type="fig">Fig. 2</xref>.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 2</label>
<caption><title>Examples of the pre-survey outputs.</title>
<p>Sequences of 14 different plasmids were analyzed with the indicated <italic>distance_threshold</italic> and <italic>number _of _groups</italic> values. Levenshtein distance between each plasmid pair is displayed in heatmaps, which were subsequently used to generate the dendrograms displayed on the right side of the heatmap. The dotted red lines in the dendrogram represent the <italic>distance_threshold</italic> values, enabling visualization of the results of clustering, i.e., plasmids with distances less than the red lines were classified in the same cluster. Based on this clustering results of similar plasmids, plasmids were classified into groups for sequencing submission, with groups are displayed in red and blue (a), red, blue, and magenta (b), or red, blue, magenta, and cyan (c). Levenshtein distance between each plasmid are also emphasized by the colored frames within each group, and plasmids classified into the same cluster are grouped in different groups. Note that P1-P14 here are different from example plasmids used in <xref rid="fig3" ref-type="fig">Fig. 3</xref> and <xref rid="fig4" ref-type="fig">Fig. 4</xref>.</p></caption>
<graphic xlink:href="536413v3_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Based on the grouping determined in the pre-survey step, the plasmids classified into the same group are then mixed at equal concentrations. If plasmid concentrations are not equal, the coverage of the plasmids with lower concentrations is lower, affecting the reliability of the results. Following mixing of plasmids according to the grouping, samples are submitted for nanopore sequencing according to specific vendor instructions.</p>
<p>After obtaining results from each nanopore sequencing run, deconvolution is then performed as a post-analysis to obtain consensus sequences for each plasmid. The post-analysis uses the following files as inputs: blueprints of the mixed plasmids (reference sequences) and an output FASTQ file of nanopore sequencing results containing base calling and quality scores of each read (query sequences). The algorithm is divided into three steps: (1) classification of reads, (2) alignment of the classified reads, and (3) calculation of the consensus sequence and quality score (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). In each step, reference sequences are used as prior information to increase accuracy and quality. The outputs of the post-analysis are FASTQ files containing consensus sequences and quality scores. Two types of FASTQ files are produced: FASTQ files that use arbitrarily set prior probability of error during the plasmid construction at the last step of the post-analysis and those that did not. Results without prior probability are calculated based on an unbiased analysis, whereas results with prior probability are statistically biased toward the blueprint of the plasmid map based on the prior probability (i.e., an arbitrarily set error rate during PCR, ligation, or assembly). The latter option can be considered as analogous to the case where the peak shape of a base within a Sanger sequencing chromatogram is not clear enough for the automatic base calling and is subsequently (and typically manually) compared to the blueprint of the plasmid to determine the identity of the base. Apart from two FASTQ files, a summary GIF file is also provided, showing the composition of reads matched, mismatched, or determined to be deletions or insertions at each position of the plasmid. Because post-analysis is designed assuming that there are no significant differences (insertions or deletions) between blueprints and the actual samples, it is recommended to always check this summary GIF file to confirm that if sample meets that assumption.</p>
<p>The pre-survey and the post-analysis algorithms are available via a ready-to-execute Jupyter Notebook on Google Colab (<ext-link ext-link-type="uri" xlink:href="https://colab.research.google.com/github/MasaakiU/MultiplexNanopore/blob/master/colab/MultiplexNanopore.ipynb">https://colab.research.google.com/github/MasaakiU/MultiplexNanopore/blob/master/colab/MultiplexNanopore.ipynb</ext-link>) or locally executable scripts on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/MasaakiU/MultiplexNanopore">https://github.com/MasaakiU/MultiplexNanopore</ext-link>). We have also packaged the script and released it on PyPI <underline>(</underline><ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/savemoney/">https://pypi.org/project/savemoney/</ext-link>) to facilitate easy installation and integration by other developers. In the Google Colab version, a function is also included to visualize the classified query sequence along with the reference sequence and the consensus sequence. In addition to analysis of plasmids, SAVEMONEY can also be used for linear DNA such as PCR amplicons and long synthetic DNAs by specifying the “topology_of_dna” option, though we mainly discuss its use for plasmid sequencing in this paper.</p>
</sec>
<sec id="s2b">
<title>The pre-survey algorithm</title>
<p>The pre-survey algorithm determines the combination of plasmids that are appropriate to mix. Its initial step is a series of pairwise alignments of each plasmid. Although in principle any alignment algorithm can be used, we first chose to detect chunks of sequences that are sufficiently long and identical to save computational resources, and we then performed an alignment against sequences between chunks by the classical Smith-Waterman algorithm to ensure the accuracy by dynamic programming<sup><xref ref-type="bibr" rid="c16">16</xref></sup>. The following parameters were used:
<disp-formula>
<graphic xlink:href="536413v3_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Next, the distance between each plasmid pair was calculated as Levenshtein distance, the minimum number of bases that have to be substituted, deleted, or inserted to change one sequence into the other. Using this framework, the alignment of a plasmid to itself will yield a distance of 0. Calculation of the distances between all plasmid pairs afforded a distance matrix of plasmids. Plasmids with smaller distances were then classified into the same cluster, which we note is different from the final output of the grouping. Hierarchical clustering was adopted using the distance matrix obtained in the previous step, with the Nearest Point Algorithm chosen as the method for calculating the distance between newly formed clusters (<xref rid="fig2" ref-type="fig">Fig. 2</xref>). Clusters were defined according to a user-defined parameter, <italic>distance threshold,</italic> which represents the minimum number of bases that has to be differ between plasmids in the same group. Therefore, all plasmid pairs with distances lower than <italic>distance_threshold</italic> are classified into the same cluster. In practice, lower <italic>distance_threshold</italic> values result in allowing plasmids that are more similar to one another to be classified into different clusters, producing fewer total groups of plasmids for sample submission and thus lowering sequencing costs at the expense of a higher risk of errors during the classification step of the post-analysis algorithm.</p>
<p>Finally, plasmids were classified into groups for sample submission such that plasmids from the same cluster do not fall into the same group and that the minimum distance between plasmids within each group is maximized. To obtain optimal results, we reduced this classification problem to a Zero-One Integer Linear Programming Problem. First, a rank-3 binary tensor <italic>T</italic> ∈ {0,1}<sup><italic>g×c×p</italic></sup> was prepared, where the sizes of its dimensions correspond to the number of groups, clusters, and plasmids, and each element takes a value of either 0 or 1. The following constraints were applied to this tensor:
<disp-formula>
<graphic xlink:href="536413v3_ueqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where P<sub>p</sub> and C<sub>c</sub> indicate plasmid and cluster with the index of <italic>p</italic> and c, respectively, and <italic>G<sub>a</sub></italic> represents the number of plasmids in the group with the index of <italic>g,</italic> which will be described in more detail below. The constraints represent the following: each plasmid exists only once and belongs to a designated cluster (first constraint), each group contains a designated number of plasmids (second constraint), and plasmids from the same cluster cannot belong to the same group (third constraint). Regarding the first constraint, the cluster to which a plasmid belongs is determined by the results of hierarchical clustering and the values of <italic>distance_threshold</italic> and <italic>number_of_groups.</italic> For the second constraint, the number of plasmids in each group can be set arbitrarily, as long as Σ<sub><italic>g</italic></sub> <italic>G</italic><sub><italic>g</italic></sub> matches the total number of plasmids. However, in the implementation of this algorithm, the number of plasmids in each group was automatically determined to be as equal as possible. In addition to these three constraints, constraints of plasmid pairs that belong to different clusters but should not be distributed into the same group, as expressed by <inline-formula><inline-graphic xlink:href="536413v3_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, are sequentially added to a “forbidden list,” where <italic>c<sub>1</sub></italic> and <italic>c<sub>2</sub></italic> represents the cluster indices to which <inline-formula><inline-graphic xlink:href="536413v3_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="536413v3_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> belong, respectively. In the algorithm implementation, in addition to the “forbidden list,” an “exclusion list” was also used to prevent plasmid pairs from being added to the “forbidden list.” Until all plasmid pairs that belong to different clusters were included in one of the two lists, the following steps were repeated:
<list list-type="order">
<list-item><p>Among the plasmid pairs belonging to different clusters, the pair with the shortest distance that is not included in either the “forbidden list” or the “exclusion list” is added to the “forbidden list.”</p></list-item>
<list-item><p>Find a feasible solution for <italic>T</italic> ∈ {0,1}<sup><italic>g×c×p</italic></sup> under the given constraints. If a solution is found, go back to step 1 and repeat the process. If no solution is found, remove the last plasmid pairs from the “forbidden list,” and instead add it to the “exclusion list.”</p></list-item>
</list>
This process ultimately leads to the final grouping result.</p>
<p>Examples of the pre-survey results against 14 plasmids are displayed in <xref rid="fig2" ref-type="fig">Fig. 2</xref>, together with the dendrogram used during the step of hierarchical clustering. When a <italic>distance_threshold</italic> value of 5 is applied without specifying <italic>number_of_groups,</italic> plasmids were classified into groups of two, because there are two clusters (cluster 3 and 12 in <xref rid="fig2" ref-type="fig">Fig. 2a</xref>) containing two plasmids, and plasmids within each clusters have to be distributed into different groups. The minimum distance within each group was 6 (P8 and P10 in Group 2 in <xref rid="fig2" ref-type="fig">Fig. 2a</xref>) under this condition, but the value increased to 10 (P1 and P4 in Group 1 in <xref rid="fig2" ref-type="fig">Fig. 2b</xref>) by specifying <italic>number_of_groups</italic> as 3, indicating that grouping is more quality oriented. By contrast, users can determine the grouping by only specifying <italic>number_of_groups</italic> (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>). When the value was set to 4, the algorithm automatically determines the minimum distance_threshold, which in this case was 14, to satisfy the provided <italic>number_of _groups.</italic> The minimum distance within each group was 20 (P10 and P11 in Group 1 in <xref rid="fig2" ref-type="fig">Fig. 2c</xref>), indicating the grouping was of the highest quality among the three per-surveys. These results show that lower <italic>distance_threshold</italic> or <italic>number_of _groups</italic> values lead to reduced sequencing costs. Conversely, plasmids with higher degrees of similarity will be incorporated into the same group under such settings, which may slightly reduce the reliability of the post-analysis. However, we found that <italic>distance_threshold</italic> values can be set down to 2 based on the assessment of the limitation of post-analysis, which will be discussed later (see “Maximum similarity allowed for mixing” section for details).</p>
</sec>
<sec id="s2c">
<title>The post-analysis algorithm</title>
<p>To classify reads from each pore, the alignment was first performed against reference plasmid <italic>p<sub>i</sub></italic> and the query sequence <italic>q<sub>k</sub></italic> from each pore using the same parameters as described in the pre-survey algorithm. Then, the normalized alignment score, <inline-formula><inline-graphic xlink:href="536413v3_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, was calculated by dividing the alignment score by the length of <italic>p<sub>i</sub></italic>. The plasmid to which the query is assigned, <inline-formula><inline-graphic xlink:href="536413v3_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, was determined as follows:
<disp-formula>
<graphic xlink:href="536413v3_ueqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>P</italic> indicates the set of reference plasmids that were mixed. However, if <inline-formula><inline-graphic xlink:href="536413v3_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula> was lower than <italic>score_threshold,</italic> a user-defined value that represents a cutoff for short reads (see below), the read <italic>q<sub>k</sub></italic> was excluded to increase the quality of subsequent post-analysis. Furthermore, the read <italic>q<sub>k</sub></italic> showing the same normalized alignment score against more than one plasmid was also omitted, because such a read does not contain enough information to determine the plasmid from which they originated. Lastly, the read <italic>q<sub>k</sub></italic> more than two times longer than the length of the assigned reference plasmid <inline-formula><inline-graphic xlink:href="536413v3_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and that showed a higher normalized alignment score than 1 was excluded to omit the read from plasmid multimer.</p>
<p>Four examples of the results from four different groups of plasmids are displayed in <xref rid="fig3" ref-type="fig">Fig. 3</xref> (Group I) and <xref rid="fig4" ref-type="fig">Fig. 4</xref> (Groups II, III, and IV). Group I involves multiplex sequencing of six plasmids of only modest similarity, and Groups II-IV contain two plasmids each with high similarity. (Note that for <xref rid="fig2" ref-type="fig">Figs. 2</xref>-<xref rid="fig4" ref-type="fig">4</xref>, we have elected to name the plasmids similarly (e.g., P1, P2, etc.) for simplicity; however, they are all distinct, i.e., P1 from <xref rid="fig2" ref-type="fig">Fig. 2</xref> is different from P1 in <xref rid="fig3" ref-type="fig">Fig. 3</xref>.) The pre-survey results for Group I are shown in <xref rid="fig3" ref-type="fig">Fig. 3a</xref>, indicating two clusters of four (P1-P4) and two (P5-P6) similar plasmids. In reality, each cluster contains plasmids that share a common vector, illustrating how plasmids sharing common vector backbones but different inserts are moderately similar but still suitable for multiplexing, as their distances are far greater than 20, which is a very safe, quality-oriented cutoff value shown in <xref rid="fig2" ref-type="fig">Fig. 2c</xref>. These six plasmids were mixed and analyzed as a single sample by nanopore sequencing. <xref rid="fig3" ref-type="fig">Fig. 3b</xref> represents the general quality check of the results for each plasmid: distributions of read length and quality scores.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 3</label>
<caption><title>Example results after the classification step for a set of six moderately related plasmids.</title>
<p><bold>(a)</bold> Results of the pre-survey against plasmid sets used in (b-c). <bold>(b)</bold> Read length and the quality score distributions. <bold>(c)</bold> Scatter plots of normalized alignment scores. Normalized alignment scores were calculated for each read over all reference plasmids and displayed as scatter plots. Density plots of the normalized alignment scores are also displayed for each reference plasmid in the diagonal panel, which is the projection of each scatter plots against horizontal axes. The y-axis ranges of these diagonal panels are shared. The vertical and the horizontal positions of dashed lines correspond to <italic>score_threshold</italic> values. These data depict results of classification performed with a <italic>score_threshold</italic> value of 0.5. Note that P1-P6 here are different from example plasmids used in <xref rid="fig2" ref-type="fig">Fig. 2</xref> and <xref rid="fig4" ref-type="fig">Fig. 4</xref>.</p></caption>
<graphic xlink:href="536413v3_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 4</label>
<caption><title>Example results after the classification step for closely related plasmids.</title>
<p><bold>(a-c)</bold> Results of the pre-survey against plasmid sets. <bold>(d-1)</bold> Scatter plots of normalized alignment scores against the plasmid pairs. The vertical and the horizontal positions of dashed lines correspond to <italic>score_threshold</italic> values. These data depict results of classification performed with a <italic>score_threshold</italic> value of 0.5. <bold>(g-i)</bold> Breakdowns of reads covering the regions where the plasmids differ in sequence. In the rotated heatmap at the bottom of (g), the axis labeled as “P1 match” represents the number of bases matching the P1 sequence in the regions where the sequences of P1 and P2 differ, whereas the axis labeled as “P2 match” represents the equivalent for P2. The values in each cell represent the number of observed reads matching the values of the two axes at that position. The subtraction of “P1 match” from “P2 match” is represented by the horizontal axis, which is also shared with the x-axis of the histogram on top, where the sum projection of the heatmap is displayed. In the histogram, the breakdown of classification is represented by color: blue for reads classified to P1, orange for reads classified to P2, gray for unclassified reads with a score above <italic>score_threshold,</italic> and light gray for unclassified reads with a score below <italic>score_threshold.</italic> Because the normalized alignment scores for the two plasmids are the same where the value on the horizontal axis is 0, reads are not classified to either plasmid; therefore, the middle bar of the histogram is colored with either gray or light gray. The same interpretation applies to (h) and (i). <bold>(j-l)</bold> Summary of the fitting results. Based on the estimated parameters displayed in <xref rid="tbl1" ref-type="table">Table 1</xref>, the rotated heatmaps representing the breakdowns of reads originating from P1, P3, and P5 (upper panels) and P2, P4, and P6 (lower panels) were generated. Note that P1-P6 here are different from example plasmids used in <xref rid="fig2" ref-type="fig">Fig. 2</xref> and <xref rid="fig3" ref-type="fig">Fig. 3</xref>.</p></caption>
<graphic xlink:href="536413v3_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Reads assigned to each reference plasmid showed sharp read length distributions, indicating the accurate classification of the reads. In addition, the quality score distributions of reads assigned to each reference plasmid are very similar, indicating that each plasmid was sequenced with almost the same quality. Note, however, that the number of reads was not identical for each plasmid, which is reflected by the total histogram area of each colored portion in the read length distribution graphs. Scatter plots of normalized alignment score, <inline-formula><inline-graphic xlink:href="536413v3_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, for each reference plasmid pair are shown in <xref rid="fig3" ref-type="fig">Fig. 3c</xref>, which is useful to adjusted <italic>score_threshold.</italic> From the graphs, it is apparent that if <italic>score_threshold</italic> is set higher, the classification accuracy would increase, at the expense of lowering the number of reads assigned to each reference plasmid. For typical experiments, we have found 0.5 to be a reasonable value for <italic>score_threshold,</italic> but users can fine tune this parameter to make the most out of the acquired data. For example, if the total number of reads was small but each plasmid was sufficiently different, the threshold can be lowered to increase the number of reads that are passed on to the next step of analysis. Conversely, if the total number of reads is large and the plasmids are highly similar with each other, the quality of subsequent analysis can be improved by raising the threshold. <xref rid="fig3" ref-type="fig">Fig. 3c</xref> shows the well separated scatter plots of each read against each reference plasmid, indicating successful classification of reads. In this experiment, a sufficient number of reads (90, 154, 57, 165, 73, 107, and 50 each for P1, P2, P3, P4, P5, P6, and unassigned, respectively) were obtained for each plasmid, which ensures reliability in the subsequent calculation of the consensus sequence.</p>
<p>The results of different combinations of plasmids with high sequence similarity are displayed in <xref rid="fig4" ref-type="fig">Fig. 4</xref>. The biggest concern in this case is whether each read is accurately classified to each reference plasmid. Assuming the case where two plasmids are mixed, theoretically, the classification of a read to either plasmid is determined solely by the regions where the plasmids differ in sequence. This result occurs because errors in regions where the plasmids have identical sequences have the same effects on the normalized alignment score for both plasmids, i.e., errors in such regions decrease the normalized alignment score in the same manner for both plasmids. Hence, the accurate classification can be achieved for plasmids that differ by even a single base, considering the high accuracy of recent nanopore sequencing. To demonstrate this outcome, we mixed and submitted three sets of two plasmids (set 1: P1-P2, set 2: P3-P4, and set 3: P5-P6) with Levenshtein distance of only 1, 2, and 3 as a single sample (<xref rid="fig4" ref-type="fig">Fig. 4a-c</xref>). The corresponding results after the classification step of the post-analysis are displayed in <xref rid="fig4" ref-type="fig">Fig. 4d-f</xref>. Because the plasmids are almost identical, most of the data points are nearly overlapping the y=x line in the scatter plot of the normalized alignment score (<xref rid="fig4" ref-type="fig">Fig. 4d-f</xref>, top). However, a magnified view clearly shows the deviation of data points from y=x line, indicating that reliable separation of many reads can be achieved (<xref rid="fig4" ref-type="fig">Fig. 4d-f</xref>, bottom).</p>
<p>Further, we performed a quantitative analysis to estimate the rate of incorrect classification. First, the reads covering the regions where the plasmids differ in sequence were extracted. The numbers of such reads were 239 out of 303, 262 out of 297, and 2212 out of 2359 reads for Sets 1, 2, and 3, respectively, and the breakdowns of classification results are shown in <xref rid="fig4" ref-type="fig">Fig. 4g-i</xref>. The histograms on top also show the number of reads with a normalized alignment score below <italic>score_threshold</italic> (0.5 in this case) in light gray, but the numbers are all very small, suggesting high sequencing quality. The rotated heatmaps below provide more detailed breakdowns of the reads represented in the histograms above. Using these structured data in the rotated histogram, we performed a simple fitting using the least squares method, with the number of reads originating from each plasmid and the nanopore error rate as variables. For simplicity, we approximate that the probability of a nanopore-based base-calling error is the same independent of the identity of the base (e.g., when errors occur for true base A, the probability of base calling being T, G, or C is one over 3 for each) and that there are no deletion or insertion errors in base calling. The summary of the fitting results is shown in <xref rid="fig4" ref-type="fig">Fig. 4j-l</xref>. The upper and lower rotated heatmaps in <xref rid="fig4" ref-type="fig">Fig. 4j-l</xref> represent the breakdown of reads originating from the plasmid with the lower and higher numbering, respectively. These fitting results allowed us to calculate the ratio of reads classified under a reference plasmid that differs from their actual origin, which was represented as “incorrect assignment rate” in <xref rid="tbl1" ref-type="table">Table 1</xref>. The values indicate that plasmids that differ even by a single base (set 1) could be classified to a sufficient confidence level with around 0.03-1.4% incorrect classification. The ratio further goes down when Levenshtein distance was increased to 2 (set 2) or 3 (set 3), transforming the base calling error ratio of 1.55% and 2.13% into the incorrect classification ratio of 0.0074%-0.0089% and 0.0143-0.0158%, respectively. These results indicate that the nanopore base calling error negligibly affects the classification step, especially for plasmid pairs differing by two or more bases. The results also suggests that the error should not affect the subsequent analysis to obtain consensus base calling. However, we recommend mixing plasmids that differ by at least two bases, i.e., the <italic>distance_threshold</italic> value should be at least 2, due to the following reasons. First, although this low percentage of incorrect assignment is unlikely to affect the consensus base calling even with plasmids with 1 base difference, it does affect the consensus quality score, and our algorithm does not make any correction for it. Second, although the average error rate of current nanopore technology is low, it can be increased to up to ∼40% for a few specific sequences, such as Dam methylation, and this number could result in incorrect consensus base calling. Third, if only one base differs, that base is the only piece of information that can correctly classify reads, indicating that an unexpected mutation in that position during the plasmid construction would ruin the classification. Therefore, we set the minimum <italic>distance_threshold</italic> value to 2 in the pre-survey, and we recommend setting it a higher score when possible.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>The fitting results summarized in <xref rid="fig4" ref-type="fig">Fig. 4j-l</xref>.</title><p>The values for the fitted parameters are displayed in “Error rate” and “Total reads” columns. The rotated heatmaps in <xref rid="fig4" ref-type="fig">Fig. 4j-l</xref> were generated based on these estimated parameters. For P1, P3, and P5, the sum of values in heatmap cells whose location on the horizontal axis are above 0, below 0, and 0 are shown as “Correctly classified reads”, “Wrongly classified reads”, and “Reads not classified” columns, respectively. For P2, P4, and P6, below 0, above 0, and 0 are shown as “Correctly classified reads”, “Wrongly classified reads”, and “Reads not classified” columns, respectively. Finally, the values in “Rate of incorrect classification” columns for each plasmid were calculated by dividing the values of “Wrongly classified reads” for the other plasmids in the same set by the total number of reads estimated to be classified to the focusing plasmid, which is different from values displayed in the “Total reads” column. Specific equations are provided at the bottom of the table.</p></caption>
<graphic xlink:href="536413v3_tbl1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>After the classification step, each read is aligned against the corresponding reference sequence, and then a final post-analysis step is executed to obtain the consensus sequence and quality score. Here, the aligned query sequences, quality score of each read, and prior information are combined using Bayesian analysis, similar to previously reported methods to detect SNPs<sup><xref ref-type="bibr" rid="c15">15</xref></sup>. When generating consensus sequences in SAVEMONEY, two types of prior information are used: (1) the error rate during plasmid construction (i.e., an arbitrarily set error rate during PCR, ligation, or assembly), and (2) the characteristics of the nanopore reads, i.e., error rate and distribution of quality score for each base. For example, assume that the correct base at a specific position in the blueprint of the plasmid is A, and that 10 reads were obtained for the corresponding part, of which base-calling of eight reads were A and the other two reads were G. In this case, the following cases can be considered:
<list list-type="order">
<list-item><p>True base is A, and error happened for 2 reads returning G.</p></list-item>
<list-item><p>True base is T, and error happened for all 10 reads.</p></list-item>
<list-item><p>True base is C, and error happened for all 10 reads.</p></list-item>
<list-item><p>True base is G, and error happened for 8 reads returning A.</p></list-item>
</list>
By using prior information, each of the above probabilities can be calculated. It is reasonable to adopt the case with the highest probability among them and use it as the consensus base calling. Note that the possibility of deletion and insertion is not considered in the above example to make the example simple, but they are implemented in the actual script.</p>
<p>Although quality scores of each read from Oxford Nanopore Technologies do not exactly follow Phred scores, they are approaching Phred scores in recent years<sup><xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c17">17</xref></sup>. Therefore, for practical purposes, we elected to consider the quality scores as Phred scores, while accepting some small error in the calculation of consensus quality score to some extent. Based on this assumption, the error rate, <italic>E<sub>basecall=B</sub>,</italic> when the consensus base calling is <italic>B</italic> at a specific location, can be calculated as follows using Bayes’ theorem:
<disp-formula>
<graphic xlink:href="536413v3_ueqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>P</italic>(B) represents the probability that the true base is <italic>B</italic> at the specific location of the plasmid, and <italic>D<sub>k</sub></italic> represents the data obtained from pore <italic>k.</italic> The prior probability <italic>P(B)</italic> can be arbitrarily set from the error ratio during plasmid construction, which corresponds to the first piece of prior information. Here, the likelihood <italic>P(D<sub>i</sub>, D<sub>2</sub>, … |B)</italic> and the probability of obtaining the data <italic>P(D<sub>i</sub>, D<sub>2</sub>, …</italic>) can be calculated as follows:
<disp-formula>
<graphic xlink:href="536413v3_ueqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
This conversion is guaranteed under the condition that the data obtained by each pore is independent if the true base is known. Further, the likelihood <italic>P (D<sub>k</sub></italic> |B) can be converted as follows:
<disp-formula>
<graphic xlink:href="536413v3_ueqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>b<sub>k</sub></italic> and <italic>Q<sub>k</sub></italic> represents the base calling and the quality score obtained from pore <italic>k.</italic> Here, <italic>P(Q<sub>k</sub></italic>|b<sub>k</sub>, <italic>B)</italic> and <italic>P(b<sub>k</sub>IB)</italic> can be calculated based on the quality score distribution and the error ratio of the nanopore sequencing, respectively, which corresponds to a second piece of prior information. These characteristics can be obtained from nanopore sequencing data of plasmids with known sequences, or, in practice, with unknown sequences by considering the consensus sequence as a known sequence. Although these characteristics change depending on the types of flow cell and library preparation chemistry, in this paper we proceed based on the characteristics of R10.4.1 flow cells with V14 library preparation chemistry by Oxford Nanopore Technologies that are currently used for sequencing via the Plasmidsaurus service, but the principle should be the same with other long-read sequencers. The representative quality score distribution and the error ratio we obtained by analyzing one plasmid by nanopore sequencing is displayed in <xref rid="fig5" ref-type="fig">Fig. 5</xref>. Thus, the final consensus base calling, <italic>B<sub>consensus</sub></italic>, and the consensus Phred score, <italic>Q<sub>consensus</sub></italic>, can be calculated as
<disp-formula>
<graphic xlink:href="536413v3_ueqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 5</label>
<caption><title>Characteristics of base calling used for prior information.</title>
<p><bold>(a)</bold> Grid showing error ratios for each base calling event. Based on the results obtained from samples analyzed by R10.4.1 flow cells with V14 library preparation chemistry by Oxford Nanopore Technologies via the Plasmidsaurus service, the frequency was analyzed for base calling of each pore (column labels) and the results of the consensus sequence (row labels) at each position. In the context of base-calling, “-” represents bases that were base-called in the consensus sequence but skipped in the reads from each pore. In the context of consensus sequencing, “-” represents bases that do not appear in the consensus sequence but were base-called from pores. Color of the diagonal panels is saturated because of the contrast range focusing on subtle differences of the non­diagonal panels. Of note, the sum of the rows is 1, but the sum of the displayed numbers may be slightly different from 1 because the fourth decimal place is rounded in the grid. <bold>(b)</bold> Quality score distributions for each base calling event. The base calling of each pore (column labels) and the results of the consensus sequence (row labels) at each position were classified, and probability density plots and quality scores were calculated and displayed. The y-axis is shared by all panels and is scaled to focus on panels in which the true base and base calling are not the same (incorrect base calling, blue). Therefore, the density of maximum quality score is out of the range of the display area in the diagonal panels (correct base calling, orange), and full-size plots are provided at right. Note that there are no density plots when base calling was skipped in the reads from each pore (column corresponding to the label “-” in (a)).</p></caption>
<graphic xlink:href="536413v3_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2d">
<title>Maximum similarity allowed for mixing</title>
<p>The extent to which similar plasmids can be mixed (i.e., how low the <italic>distance_threshold</italic> value can be in the pre-survey step) is greatly affected by the resolution of the “classification” in the post-analysis. In this step, the use of prior information is important. Assuming that two plasmids, <italic>p<sub>1</sub></italic> and <italic>p<sub>2</sub></italic>, with different sequences, are mixed and analyzed by nanopore sequencing. If the data from one read from one pore returns a sequence similar to <italic>p<sub>1</sub></italic>, the following two cases are possible:
<list list-type="order">
<list-item><p>The DNA that passed through the pore was derived from <italic>p<sub>1</sub></italic> and returned a sequence similar to <italic>p<sub>1</sub></italic>.</p></list-item>
<list-item><p>The DNA that passed through the pore was derived from plasmid <italic>p<sub>2</sub></italic>, but the pore was inaccurate and base calling error occurred frequently. By chance, it returned a sequence that is similar to <italic>p<sub>1</sub></italic>.</p></list-item>
</list>
Intuitively, case 1 is the correct answer, but a more precise expression is that the probability of case 2 is extremely low if plasmid <italic>p<sub>1</sub></italic> and p<sub>2</sub> or more plasmids are “sufficiently different”, so it is safe to consider only the possibility of case 1 in practice. This example implies that the prior information of known plasmid sequences in samples improves the accuracy of the classification of the reads from each pore. It is difficult to perform such a classification process with versatility and high accuracy in the absence of prior information.</p>
<p>To specifically determine what kinds of plasmid pairs are “sufficiently different”, detailed analysis was performed. First, the percentage of reads with correct base calling was calculated for each position of plasmids and the distribution was obtained (<xref rid="fig6" ref-type="fig">Fig. 6a</xref>). More than 98% of positions exhibited a correct base calling rate over 0.9, but a small number (0.1%) of them showed low correct rates below 0.7. Averaged quality score distribution of high (&gt;0.9) and low (&lt;0.7) correct rate are displayed in <xref rid="fig6" ref-type="fig">Fig. 6b</xref>. In the former case, most reads showed the maximum quality score, whereas in the latter case, the percentage is lower. The rate of correct base calling, incorrect base calling, and base calling of deletion was 67.1%, 19.0%, and 13.9%, respectively. <xref rid="fig6" ref-type="fig">Fig. 6c</xref> shows the bases that were enriched around 5-mers of positions that showed correct rates lower than 0.7 in the “worst-case scenario” indicated in <xref rid="fig6" ref-type="fig">Fig. 6a</xref>. Using this “worst­case scenario”, the probability of incorrect classification when data from one read is classified to <italic>p<sub>1</sub></italic> was calculated as follows:
<disp-formula>
<graphic xlink:href="536413v3_ueqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula></p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 6</label>
<caption><title>Analysis for the maximum similarity between plasmids that can be mixed and the minimum number of required reads.</title>
<p><bold>(a)</bold> Density plot of the rate of reads with correct base calling. The rate was calculated at each position of plasmids and displayed using representative nanopore sequencing results. <bold>(b)</bold> Averaged quality score distribution of reads with correct rate of less than 0.7 (upper panel) and more than 0.9 (bottom panel). The corresponding regions are displayed with dashed red frames in (a). Of note, “omitted” represents reads that did not cover the focused position. <bold>(c)</bold> Probability logo plot. Statistical significance (-log<sub>10</sub>[P value]) was calculated for a 5-mer around the positions that showed correct rate lower than 0.7 in (a) using those that showed more than 0.9 as a background. Enriched residues are stacked on the top, whereas depleted residues are stacked on the bottom. <bold>(d)</bold> Estimated probability of incorrect classification. Based on the match/mismatch/deletion ratio of reads obtained in the “worst-case scenario”, i.e., top panel in (b), the probability of incorrect classification of read was calculated assuming that two plasmids that differ by indicated base(s) were mixed. <bold>(e)</bold> Estimated probability of correct/incorrect consensus base calling. Based on the quality score distribution obtained in the “worst-case scenario”, i.e., top panel in (b), the indicated number of reads were generated in silico, and the consensus base calling was calculated using SAVEMONEY. The simulation was performed 10,000 times for each condition to calculate the probability of correct/incorrect consensus base calling.</p></caption>
<graphic xlink:href="536413v3_fig6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>where <italic>P (D</italic> = <italic>p<sub>1</sub></italic>) represents the probability that one read was classified as <italic>p<sub>1</sub></italic>, i.e., normalized alignment score of the read was higher for <italic>p<sub>1</sub></italic> than p<sub>2</sub>. The denominator <italic>P(D</italic> = <italic>p<sub>1</sub>)</italic> can be transformed as follows:
<disp-formula>
<graphic xlink:href="536413v3_ueqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Therefore, the plot of <italic>P</italic>(p<sub>2</sub> | <italic>D</italic> = <italic>p<sub>1</sub>)</italic> can be calculated and the results are displayed in <xref rid="fig6" ref-type="fig">Fig. 6d</xref>, which varies the number of bases that are different between the plasmids.</p>
<p>When <italic>p<sub>1</sub></italic> and p<sub>2</sub> differ by only one base, the percentage of incorrect classification was estimated to be 39% in this rarely occurring (0.1% frequency) “worst-case scenario”. When the sequence differs by two bases, this percentage drops to 22%. This value is sufficiently smaller than 50% and can be considered to have no effect on the consensus sequence. Also, this percentage is calculated assuming that the two bases are both the “worst-case scenario”, i.e., the 0.1% case shown in <xref rid="fig6" ref-type="fig">Fig. 6a</xref>. That means the chance of this happening for two bases that differ in <italic>p<sub>1</sub></italic> and <italic>p<sub>2</sub></italic> is 10<sub>-6</sub>, which we consider to be small enough to not be a cause for concern. Thus, in most cases, the percentage of incorrect classification will be much lower even if there are only two base differences between <italic>p<sub>1</sub></italic> and <italic>p<sub>2</sub></italic>. In fact, the percentage of misclassified plasmids was estimated as less than 0.3% at the highest for two nucleotide difference from experimental data in <xref rid="fig4" ref-type="fig">Fig. 4e-h</xref>. Therefore, we ascertain that a <italic>distance_threshold</italic> value of 2 or more during the pre-survey is sufficient for reliable post-analysis.</p>
</sec>
<sec id="s2e">
<title>Maximum number of plasmids that can be mixed</title>
<p>The question of how many plasmids can be safely mixed together can be partially replaced by the question of how many reads are required at minimum to obtain a reliable consensus sequence. To answer this question, detailed analysis was performed again using the “worst-case scenario”. We simulated nanopore base calling according to quality score distribution when the correct rate was less than 0.7 (<xref rid="fig6" ref-type="fig">Fig. 6b</xref>, top panel). For a simulation with 20 reads, as an example, 20 sets of quality scores and read types (match, mismatch, deletion, omitted) were generated according to the distribution, and the consensus base calling and quality scores were calculated using SAVEMONEY. Sampling of 10000 events were performed in each condition over 1 to 40 reads to calculate the probability of correct/incorrect consensus base calling (<xref rid="fig6" ref-type="fig">Fig. 6e</xref>). The consensus was calculated in three ways: (1) without prior probability for the unbiased base calling (blue), (2) with prior probability to incorporate an arbitrarily set plasmid construction error rate (orange), and (3) with wrong prior probability for testing error detection (green). The first two conditions correspond to the two outputs from SAVEMONEY, and the last condition indicates the sensitivity of “with prior probability” analysis to detect errors when the reference sequence differs from the actual plasmid.</p>
<p>The results show that ratio of incorrect base calling decreases exponentially (i.e., linearly on the logarithmic plot), and all three lines reach an error rate of less than 0.01 after more than 30 reads. This analysis shows that, even in the “worst-case scenario”, which occurs with a frequency of ∼0.1% (<xref rid="fig6" ref-type="fig">Fig. 6a</xref>), the probability of incorrect base calling is less than 0.1%, indicating that the net probability is ∼10<sup>-6</sup>. This value is small enough to be negligible even considering the size of usual plasmids (on the order of 10<sup>4</sup> bases). Therefore, when samples are submitted to a nanopore sequencing service such as Plasmidsaurus, which typically provides a minimum number of ∼200 reads per sample, we have found that mixing of up to six plasmids is routinely possible. These conditions bring down the current sequencing cost per plasmid for users to lower than a single Sanger sequencing run. Further savings and efficiency come from the costs associated with multiple Sanger sequencing runs for inserts longer than 1 kb and re­analysis of occasional failed Sanger sequencing runs. For operators of long-read sequencing, such analysis may enable conservation of expensive reagents. Overall, we expect that the principles underlying our computational approach will accelerate widespread adoption of whole­plasmid sequencing.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>In this study, we developed a versatile pipeline that allows end users to easily prepare optimal pooling of plasmids and perform computational de-multiplexing of long-read sequencing results of multiplexed samples. During plasmid construction, a restriction enzyme digestion test can typically be used to confirm that the plasmid construction was largely successful, but such verification by test digestion is not 100% accurate, necessitating sequencing for ultimate verification of the plasmid sequence. Using Sanger sequencing, Phred scores drop as the read lengths approach ∼1000 bases, and accurate base calling becomes difficult without any information. However, in many cases, higher confidence can be obtained by comparing raw data of peak patterns with the sequences in the plasmid blueprint/map. In other words, the use of prior probability (i.e., the low error rate during the plasmid construction in this case) can improve the posterior probability of correct base calling. Thus, high-quality sequencing data is not actually needed for the first ∼700 bases, but researchers have had no choice but to obtain data with higher purity than necessary, because Sanger sequencing cannot balance data quality and cost (or read length). However, with nanopore sequencing, it is possible to accept a lower quality of data by reducing the number of reads per sample, with the benefit of lower cost. Here we reduce this idea to practice, showing that the use of prior probability can prevent the quality of sequencing from falling too low, ensuring both low cost and high confidence of sequencing results. Using our approach, sufficient multiplexing is possible that the cost of whole-plasmid sequencing can drop to below that of a single Sanger sequencing run.</p>
<p>The outputs of SAVEMONEY are two FASTQ files: one that uses prior probability of the error during the plasmid construction at the last step of the post-analysis and one that does not. If a high number of reads is obtained, it does not matter which output file to use because they will return the same consensus. The problem occurs when the number of reads is low and these two consensus sequences do not match. Simulations in <xref rid="fig6" ref-type="fig">Fig. 6e</xref> shows that “with prior” has lower error rate than “without prior”, whereas “with wrong prior” has higher error rate. This trend indicates that the use of prior probability increased the specificity at the expense of sensitivity in the context of detecting errors (i.e., bases that differ between the blueprint and the actual plasmid). There is no clear standard for the extent to which “with prior” results should be trusted, just as there is no clear standard for the manual inspection of an ambiguous position in a chromatogram of Sanger sequencing. However, even if an error is detected in “without prior”, there is a high probability that there is no error if indicated by the “with prior” result. Therefore, in this instance, it would be advisable to re-sequence the plasmid without discarding it, as it is not fully rigorous to claim the absolute correctness of either the “with prior” results indicating that there is an error or the “without prior” results indicating that there is no error. This process is similar to what is typically done in Sanger sequencing, where the decision of whether to accept the sample, discard it, or sequence it again can be made when manually examining ambiguous regions of Sanger sequencing chromatograms. The two outputs of SAVEMONEY allow for flexible data interpretation, which has been difficult to achieve with conventional analysis of nanopore sequence outputs.</p>
<p>SAVEMONEY can also be beneficial for those who own nanopore sequencers and perform library preparation, because SAVEMONEY can be executed to further de-multiplex the data after performing standard barcode-based sequencing. More plasmid variants than the number of available barcodes can in principle be sequenced simultaneously. Alternatively, in some cases, SAVEMONEY may even allow skipping the barcode introduction step entirely. One concern with using SAVEMONEY for those who own their own sequencers is the computational speed. A much higher number of reads can be obtained from in-house sequencers compared to outsourcing plasmid sequencing services, where the number of reads per sample typically ranges from 200 to several hundred. The prior information of known mixtures of plasmids used in SAVEMONEY speeds up the classification of raw reads from each pore and the generation of a multiple sequence alignment, which are otherwise be inherently difficult tasks. Because of this feature of our algorithm, computational cost is low, and the process can be executed even on a consumer-grade laptop computer. For example, in a case where five plasmids with sizes of 9999, 7958, 8627, 9325, and 10107 bases were mixed and 653 reads were obtained from nanopore sequencing, it took 3.1 minutes to process deconvolution using MacBook Air (2020, Apple M1 processor: 8-core [4P + 4E], 8-thread, 16 GB RAM). The same process was completed in 1.8 minutes using a mini gaming PC, Reatan Alloy 9 (2023, AMD Ryzen 9 7940HS: 8-core, 16-thread, 64 GB RAM). Nevertheless, to accommodate potentially heavier demands, we have implemented multiprocessing features to SAVEMONEY. The processing time is expected to decrease approximately inversely proportionally to the number of CPU cores used.</p>
<p>Other methods/algorithms for multiplexing plasmids have been proposed to reduce costs. For example, by using barcoded primers, pooled amplicons can be sequenced even if the original sequences are exactly the same<sup><xref ref-type="bibr" rid="c14">14</xref></sup>. However, this approach requires additional primers, increases the number of procedures, and makes it impossible to sequence the entire plasmid. There is also an algorithm to mix plasmids in a barcode-free manner and unmix them <italic>in silico</italic><sup><xref ref-type="bibr" rid="c18">18</xref></sup>. This algorithm is useful proceeds at a similar speed to SAVEMONEY, processing the same dataset described above in 5.0 minutes, although it should be noted that the CPU and other specifications used in the web app server were not available. However, that approach is geared mainly toward users with medium-throughput sequencing capability, such as those who own sequencers and prepare libraries by themselves, and it is not clear whether it is suitable for end users who outsource sequencing to commercial services. In fact, as this approach does not use Bayesian analysis when obtaining consensus sequences to consider prior information, hundreds of reads per plasmid are needed for reliable sequencing. With a number this high, it is difficult to mix plasmids as extensively with SAVEMONEY when outsourcing to services such as Plasmidsaurus, which sometimes returns fewer than 200 reads per sample. In addition, the pipeline did not contain a pre-survey step, and making it unclear for researchers to determine suitable combinations of plasmids to be mixed for outsourcing<sup><xref ref-type="bibr" rid="c19">19</xref></sup>. In contrast, we have shown that plasmids with differences of as little as two bases can be pooled and reliably de-mixed by SAVEMONEY with reliable consensus calculation using Bayesian analysis. We have also implemented a pre-survey step as part of the pipeline to guide researchers to find optimal combinations of plasmids to be mixed. This step greatly reduces the work involved in mixing plasmids and will help to spread nanopore sequencing as an attractive alternative to Sanger sequencing.</p>
<p>A limitation of our approach is that not all plasmids can be mixed. As described in the pre-survey algorithm section, plasmids from multiple colonies in the same plasmid construction procedure cannot be mixed because their expected sequences are identical. Nevertheless, SAVEMONEY can still save money if multiple plasmids are constructed simultaneously. For example, when sequencing two colonies from each of three different constructs (i.e., six plasmids in total), the standard approach would incur sequencing costs for six samples. However, with SAVEMONEY, up to three plasmids can be mixed per sample in this case, allowing all six plasmids to be sequenced as just two samples. As a result, the sequencing cost per plasmid is reduced by two thirds. The strength of SAVEMONEY in this context is that plasmids that differ by as few as two bases can be mixed together. This number should be small enough to require minimal effort in finding mixable plasmids. Even among plasmids that are generally recognized as having high similarity, such as those used for single amino acid mutations, conferring resistance to RNAi, introducing different peptide epitope tags, and constructing CRISPR guide RNAs, most of them should meet this criterion.</p>
<p>Another limitation of SAVEMONEY is that it calculates consensus base calling and quality scores independently for each nucleotide. However, the quality scores of neighboring bases are not in principle independent, because the number of bases producing current changes by moving through the pore is 5-mers<sup><xref ref-type="bibr" rid="c13">13</xref></sup>. Going forward, incorporation of a model that can take base calling of neighboring nucleotides into account, such as a Hidden Markov Model, might further improve the quality of base calling<sup><xref ref-type="bibr" rid="c20">20</xref></sup>.</p>
<p>There is still room for improvement in the maximum number of plasmids that can be mixed. Currently, the number of reads returned from the Plasmidsaurus service varies widely from hundreds to thousands, depending on the quality of the sample and/or variance of nanopore flow cells. If these unstable factors decrease and, for example, results with at least 1000 reads can be obtained every time, it will be possible to mix more than 30 plasmids, because we have calculated that the minimum required number of reads is 30 per plasmid. The number of plasmids that can be mixed together is expected to increase further with improvements to the base-level accuracy of nanopore sequencing technology. On the other hand, it is also challenging to prepare so many different plasmids. In practice, taking fully advantage of our algorithm might involve coordination between multiple colleagues in a lab who are constructing plasmids with different expected sequences. By enabling the mixing together of even a handful of plasmids, SAVEMONEY should dramatically drive down the costs for nanopore and other long-read sequencing technologies, further democratizing these powerful techniques for whole-plasmid and other long sequencing applications.</p>
</sec>
</body>
<back>
<sec id="s7">
<title>Materials and methods</title>
<sec id="s7a">
<title>Plasmid preparation and sequencing</title>
<p>All plasmids were either purchased or constructed by Gibson Assembly<sup><xref ref-type="bibr" rid="c21">21</xref></sup> or cut and paste cloning techniques. Restriction enzyme digestion tests were performed for those constructed before submitting to sequencing. All sequencing was performed by the Plasmidsaurus service certified by Oxford Nanopore Sequencing Technology. Sequencing data were obtained using V14 chemistry on PromethION with a R10.4.1 flow cell, followed by base calling using a High accuracy (HAC) model.</p>
</sec>
<sec id="s7b">
<title>Software packages used in SAVEMONEY scripts</title>
<p>All analyses were performed by using Google Colab or local environment (Python 3.10.0). The following packages were used: BioPython<sup><xref ref-type="bibr" rid="c22">22</xref></sup>, kpLogo<sup><xref ref-type="bibr" rid="c23">23</xref></sup>, Numpy<sup><xref ref-type="bibr" rid="c24">24</xref></sup>, Pandas<sup><xref ref-type="bibr" rid="c25">25</xref></sup>, parasail<sup><xref ref-type="bibr" rid="c26">26</xref></sup>, Pillow<sup><xref ref-type="bibr" rid="c27">27</xref></sup>, PuLP<sup><xref ref-type="bibr" rid="c28">28</xref></sup>, Spoa<sup><xref ref-type="bibr" rid="c29">29</xref></sup>, tqdm<sup><xref ref-type="bibr" rid="c30">30</xref></sup>, Scipy<sup><xref ref-type="bibr" rid="c31">31</xref></sup>, and SnapGene Reader<sup><xref ref-type="bibr" rid="c32">32</xref></sup>.</p>
</sec>
</sec>
<sec id="s6" sec-type="data-availability">
<title>Data Availability</title>
<p>SAVEMONEY is available through Google Colab (<ext-link ext-link-type="uri" xlink:href="https://colab.research.google.com/github/MasaakiU/MultiplexNanopore/blob/master/colab/MultiplexNanopore.ipynb">https://colab.research.google.com/github/MasaakiU/MultiplexNanopore/blob/master/colab/MultiplexNanopore.ipynb</ext-link>). Locally executable scripts are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/MasaakiU/MultiplexNanopore">https://github.com/MasaakiU/MultiplexNanopore</ext-link>) and on PyPI (<ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/savemoney/">https://pypi.org/project/savemoney/</ext-link>).</p>
</sec>
<ack>
<title>Acknowledgments</title>
<p>This work was supported by the National Institutes of Health (R01GM143367 to J.M.B.). M.U. was supported by an Overseas Research Fellowship from the Japan Society for the Promotion of Science and a Long-Term Fellowship from the Human Frontiers Science Program. We thank Xiaofu Cao, Shiying Huang, Po-Hsun Brian Chen, and Julia Li for providing their plasmids and sequencing data, as well as Saori Uematsu for providing benchmark data. We also thank Haiyuan Yu for helpful discussions.</p>
</ack>
<sec id="d1e1271" sec-type="additional-information">
<title>Additional information</title>
<sec id="s4">
<title>Author Contributions</title>
<p>M.U. conceived of the idea, designed experiments, wrote all the code, and performed all experiments. M.U. and J.M.B. analyzed results and wrote the manuscript.</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chao</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Yuan</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Zhao</surname>, <given-names>H</given-names></string-name></person-group>. <article-title>Recent advances in DNA assembly technologies</article-title>. <source>FEMS Yeast Res</source>. <volume>15</volume>, <fpage>1</fpage>–<lpage>9</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sanger</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Nicklen</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Coulson</surname>, <given-names>A. R</given-names></string-name></person-group>. <article-title>DNA sequencing with chain-terminating inhibitors</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>74</volume>, <fpage>5463</fpage>–<lpage>7</lpage> (<year>1977</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smith</surname>, <given-names>L. M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Fluorescence detection in automated DNA sequence analysis</article-title>. <source>Nature</source> <volume>321</volume>, <fpage>674</fpage>–<lpage>9</lpage> (<year>1986</year>).</mixed-citation></ref>
    <ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ewing</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Hillier</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Wendl</surname>, <given-names>M. C.</given-names></string-name> &amp; <string-name><surname>Green</surname>, <given-names>P</given-names></string-name></person-group>. <article-title>Base-calling of automated sequencer traces using phred. I. Accuracy assessment</article-title>. <source>Genome Res</source>. <volume>8</volume>, <fpage>175</fpage>–<lpage>85</lpage> (<year>1998</year>).</mixed-citation></ref>
    <ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ewing</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Green</surname>, <given-names>P</given-names></string-name></person-group>. <article-title>Base-calling of automated sequencer traces using phred. II. Error probabilities</article-title>. <source>Genome Res</source>. <volume>8</volume>, <fpage>186</fpage>–<lpage>94</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Zhao</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Bollas</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Au</surname>, <given-names>K. F</given-names></string-name></person-group>. <article-title>Nanopore sequencing technology, bioinformatics and applications</article-title>. <source>Nat. Biotechnol</source>. <volume>39</volume>, <fpage>1348</fpage>–<lpage>1365</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Agah</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Zheng</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Pasquali</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Kolomeisky</surname>, <given-names>A. B</given-names></string-name></person-group>. <article-title>DNA sequencing by nanopores: advances and challenges</article-title>. <source>J. Phys. D. Appl. Phys</source>. <volume>49</volume>, <fpage>413001</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Philpott</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Nanopore sequencing of single-cell transcriptomes with scCOLOR-seq</article-title>. <source>Nat. Biotechnol</source>. <volume>39</volume>, <fpage>1517</fpage>–<lpage>1520</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bayliss</surname>, <given-names>S. C.</given-names></string-name>, <string-name><surname>Hunt</surname>, <given-names>V. L.</given-names></string-name>, <string-name><surname>Yokoyama</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Thorpe</surname>, <given-names>H. A.</given-names></string-name> &amp; <string-name><surname>Feil</surname>, <given-names>E. J</given-names></string-name></person-group>. <article-title>The use of Oxford Nanopore native barcoding for complete genome assembly</article-title>. <source>Gigascience</source> <volume>6</volume>, <fpage>1</fpage>–<lpage>6</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whitford</surname>, <given-names>W.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Proof of concept for multiplex amplicon sequencing for mutation identification using the MinION nanopore sequencer</article-title>. <source>Sci. Rep</source>. <volume>12</volume>, <fpage>8572</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Delahaye</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Nicolas</surname>, <given-names>J</given-names></string-name></person-group>. <article-title>Sequencing DNA with nanopores: Troubles and biases</article-title>. <source>PLoS One</source> <volume>16</volume>, <fpage>e0257521</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sahlin</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>Error correction enables use of Oxford Nanopore analysis</article-title>. <source>Nat. Commun</source>. <fpage>1</fpage>–<lpage>13</lpage> doi:<pub-id pub-id-type="doi">10.1038/s41467-020-20340-8</pub-id>. <year>2021</year></mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jain</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Improved data analysis for the MinION nanopore sequencer</article-title>. <source>Nat. Methods</source> <volume>12</volume>, <fpage>351</fpage>–<lpage>6</lpage> (<year>2015</year>).</mixed-citation></ref>
    <ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Currin</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Highly multiplexed, fast and accurate nanopore sequencing for verification of synthetic DNA constructs and sequence libraries</article-title>, <source>Synth. Biol</source> <volume>4</volume>, <fpage>1</fpage>–<lpage>8</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>SNP detection for massively parallel whole-genome resequencing</article-title>. <source>Genome Res</source>. <volume>19</volume>, <fpage>1124</fpage>–<lpage>1132</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smith</surname>, <given-names>T. F.</given-names></string-name> &amp; <string-name><surname>Waterman</surname>, <given-names>M. S</given-names></string-name></person-group>. <article-title>Identification of common molecular subsequences</article-title>. <source>J. Mol. Biol</source>. <volume>147</volume>, <fpage>195</fpage>–<lpage>7</lpage> (<year>1981</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laver</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Assessing the performance of the Oxford Nanopore Technologies MinION</article-title>. <source>Biomol. Detect. Quantif</source>. <volume>3</volume>, <fpage>1</fpage>–<lpage>8</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mumm</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Multiplexed long-read plasmid validation and analysis using OnRamp</article-title>. <source>Genome Res</source>. <volume>33</volume>, <fpage>741</fpage>–<lpage>749</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Mumm</surname>, <given-names>C.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>On-Ramp : a tool for rapid, multiplexed validation of plasmids using nanopore sequencing</article-title>. <source>bioRxiv</source> (<year>2022</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Loman</surname>, <given-names>N. J.</given-names></string-name>, <string-name><surname>Quick</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Simpson</surname>, <given-names>J. T</given-names></string-name></person-group>. <article-title>A complete bacterial genome assembled de novo using only nanopore sequencing data</article-title>. <source>Nat. Methods</source> <volume>12</volume>, <fpage>733</fpage>–<lpage>735</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gibson</surname>, <given-names>D. G.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Enzymatic assembly of DNA molecules up to several hundred kilobases</article-title>. <source>Nat. Methods</source> <volume>6</volume>, <fpage>343</fpage>–<lpage>5</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chapman</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Chang</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Biopython</article-title>. <source>ACM SIGBIO Newsl</source>. <volume>20</volume>, <fpage>15</fpage>–<lpage>19</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname>, <given-names>X.</given-names></string-name> &amp; <string-name><surname>Bartel</surname>, <given-names>D. P</given-names></string-name></person-group>. <article-title>kpLogo: positional k-mer analysis reveals hidden specificity in biological sequences</article-title>. <source>Nucleic Acids Res</source>. <volume>45</volume>, <fpage>W534</fpage>–<lpage>W538</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname>, <given-names>C. R.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Array programming with NumPy</article-title>. <source>Nature</source> <volume>585</volume>, <fpage>357</fpage>–<lpage>362</lpage> (<year>2020</year>).</mixed-citation></ref>
    <ref id="c25"><label>25.</label><mixed-citation publication-type="software"><person-group person-group-type="author"><collab>pandas-dev</collab></person-group>. <pub-id pub-id-type="doi">10.5281/zenodo.3509134</pub-id>. <article-title>Pandas</article-title> <source>Zenodo</source> <year>2024</year></mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Daily</surname>, <given-names>J</given-names></string-name></person-group>. <article-title>Parasail: SIMD C library for global, semi-global, and local pairwise sequence alignments</article-title>. <source>BMC Bioinformatics</source> <volume>17</volume>, <fpage>1</fpage>–<lpage>11</lpage> (<year>2016</year>).</mixed-citation></ref>
    <ref id="c27"><label>27.</label><mixed-citation publication-type="software"><person-group person-group-type="author"><string-name><surname>Murray</surname><given-names>A.</given-names></string-name><etal>et al.</etal></person-group>. <pub-id pub-id-type="doi">10.5281/zenodo.596518</pub-id>. <article-title>Pillow</article-title> <source>Zenodo</source> <year>2025</year></mixed-citation></ref>
    <ref id="c28"><label>28.</label><mixed-citation publication-type="software"><person-group person-group-type="author"><string-name><surname>Peschiera</surname><given-names>F.</given-names></string-name> <etal>et al.</etal></person-group>. <pub-id pub-id-type="doi">10.5281/zenodo.2805394</pub-id>. <article-title>PuLP</article-title> <source>Zenodo</source> <year>2024</year></mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaser</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Sovic</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Nagarajan</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Sikic</surname>, <given-names>M</given-names></string-name></person-group>. <article-title>Fast and accurate de novo genome assembly from long uncorrected reads</article-title>. <source>Genome Res</source>. <volume>27</volume>, <fpage>737</fpage>–<lpage>746</lpage> (<year>2017</year>).</mixed-citation></ref>
    <ref id="c30"><label>30.</label><mixed-citation publication-type="software"><person-group person-group-type="author"><string-name><surname>da Costa-Luis</surname><given-names>C.</given-names></string-name> <etal>et al.</etal></person-group>. <pub-id pub-id-type="doi">10.5281/zenodo.595120</pub-id>. <article-title>tqdm</article-title> <source>Zenodo</source> <year>2024</year></mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virtanen</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nat. Methods</source> <volume>17</volume>, <fpage>261</fpage>–<lpage>272</lpage> (<year>2020</year>).</mixed-citation></ref>
    <ref id="c32"><label>32.</label><mixed-citation publication-type="software"><person-group person-group-type="author"><string-name><surname>Luo</surname><given-names>I.</given-names></string-name></person-group>. <ext-link ext-link-type="uri" xlink:href="https://github.com/IsaacLuo/SnapGeneFileReader">https://github.com/IsaacLuo/SnapGeneFileReader</ext-link>. <article-title>SnapGene Reader</article-title> <source>GitHub</source> <year>2018</year></mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88794.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Zambrano</surname>
<given-names>María Mercedes</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>CorpoGen</institution>
</institution-wrap>
<city>Bogotá</city>
<country>Colombia</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study provides an <bold>important</bold> computational tool for analyzing and deconvoluting a pool of plasmids sequenced without barcoding using nanopore long-read sequencing. The tool, which has been <bold>convincingly</bold> validated, is readily available to scientists interested in rapid and cost-effective verification of plasmid sequences as well as in scaling up analysis by pooling samples within barcodes.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88794.2.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This manuscript presents SAVEMONEY, a computational tool designed to enhance the utilization of Oxford Nanopore Technologies (ONT) long-read sequencing for the design and analysis of plasmid sequencing experiments. In the past few years, with the improvement in both sequencing length and accuracy, ONT sequencing is being rapidly extended to almost all omics analyses which are dominated by short-read sequencing (e.g., Illumina). However, relatively higher sequencing errors of long-read sequencing techniques including PacBio and ONT is still a major obstacle for plasmid/clone-based sequencing service that aims to achieve single base/nucleotide accuracy. This work provides a guideline for sequencing multiple plasmids together using the same ONT run without molecular barcoding, followed by data deconvolution. The whole algorithm framework is well-designed, and some real data and simulation data are utilized to support the conclusions. The tool SAVEMONEY is proposed to target users who have their own ONT sequencers and perform library preparation and sequencing by themselves, rather than relying on commercial services. As we know and discussed by the authors, in the real world, to ensure accuracy, the researchers will routinely pick up multiple colonies in the same plasmid construction and submit for Sanger sequencing. However, SAVEMONEY is not able to support the simultaneous analysis of multiple colonies in the same run, as compared to the barcoding-based approaches. This is a major limitation in the significance of this work. Encouraging computational efforts in ONT data debarcoding for mixed-plasmid or even single-cell sequencing would be more valuable in the field.</p>
<p>Comments on revisions:</p>
<p>My previous concerns have been addressed, and the revised manuscript has been significantly approved.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88794.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The authors developed an algorithm that allows to deconvolute plasmid sequences from a mixture of plasmids that have been sequenced by nanopore long read technology. As library preparations and barcoding of individual samples increases sequencing costs, the algorithm bypasses this need and thus decreases time on sample prep and sequencing costs. In a first step, the tool assesses which of the plasmid constructions can be mixed in a single library preparation by calculating a distance matrix between the reference plasmid and the constructions producing sequence clusters. The user is given groups of plasmids, from different clusters, to be pooled together for sequencing. After sequencing, the algorithm deconvolutes the reads by classifying them based on alignments to the reference sequence. A Bayesian analysis approach is used to obtain a consensus sequence and quality scores.</p>
<p>Strengths</p>
<p>The authors exploit one of the main advantages of long read sequencing that is to accurately resolve regions of high complexity, as regularly found in plasmids, and developed a tool that can validate plasmid constructions by reducing sequencing costs. Multiple plasmids (up to six) can be analyzed simultaneously in a single library without the need of sample barcoding, also reducing sample preparation time. Although inserts must be different, just 2 bases difference would be enough for correct assignation. Maximizes cost-efficiency for projects that require large amounts of plasmid constructions and high-throughput validation. The algorithm also allows for linear DNA analysis offering extra flexibility.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88794.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Uematsu</surname>
<given-names>Masaaki</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0197-8401</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Baskin</surname>
<given-names>Jeremy M</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2939-3138</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews</p>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #1 (public review):</bold></p>
<p>This manuscript presents SAVEMONEY, a computational tool designed to enhance the utilization of Oxford Nanopore Technologies (ONT) long-read sequencing for the design and analysis of plasmid sequencing experiments. In the past few years, with the improvement in both sequencing length and accuracy, ONT sequencing is being rapidly extended to almost all omics analyses which are dominated by short-read sequencing (e.g., Illumina). However, relatively higher sequencing errors of long-read sequencing techniques including PacBio and ONT is still a major obstacle for plasmid/clone-based sequencing service that aims to achieve single base/nucleotide accuracy. This work provides a guideline for sequencing multiple plasmids together using the same ONT run without molecular barcoding, followed by data deconvolution. The whole algorithm framework is well-designed, and some real data and simulation data are utilized to support the conclusions. The tool SAVEMONEY is proposed to target users who have their own ONT sequencers and perform library preparation and sequencing by themselves, rather than relying on commercial services. As we know and discussed by the authors, in the real world, to ensure accuracy, the researchers will routinely pick up multiple colonies in the same plasmid construction and submit for Sanger sequencing. However, SAVEMONEY is not able to support the simultaneous analysis of multiple colonies in the same run, as compared to the barcoding-based approaches. This is a major limitation in the significance of this work. Encouraging computational ePorts in ONT data debarcoding for mixed-plasmid or even single-cell sequencing would be more valuable in the field.</p>
</disp-quote>
<p>We thank the reviewer for the positive response to our manuscript and the helpful comments.</p>
<disp-quote content-type="editor-comment">
<p>The tool SAVEMONEY is proposed to target users who have their own ONT sequencers and perform library preparation and sequencing by themselves, rather than relying on commercial services.</p>
</disp-quote>
<p>We apologize that we were not clear enough in the manuscript. Our tool is designed for users who rely on commercial services (i.e., those who cannot include a barcode by themselves). However, it can also benefit those performing library preparation, as SAVEMONEY can be applied after standard barcode-based sequencing and de-multiplexing. The combination of standard barcodes with SAVEMONEY would significantly expands the scope of sequencing applications. For example, it would enable sequencing of more plasmid types than the number of available barcodes and, in some cases, it may even eliminate the need for barcode introduction. Because we do not own ONT equipment and because the primary target audience for the SAVEMONEY algorithm are users without ONT equipment, we were not able to conduct experiments using ONT. However, to clarify these possibilities, we added a dedicated paragraph describing these issues (3rd paragraph in the discussion section).</p>
<disp-quote content-type="editor-comment">
<p>However, SAVEMONEY is not able to support the simultaneous analysis of multiple colonies in the same run, as compared to the barcoding-based approaches.</p>
</disp-quote>
<p>We agree with the reviewer about this limitation of SAVEMONEY, as it does not allow mixing of plasmids from multiple colonies in the same cloning run. However, that does not necessarily mean that SAVEMONEY cannot reduce sequencing costs in cloning. For example, when sequencing two colonies from each of three diPerent constructs (six plasmids in total), the standard approach would require sequencing costs for six samples. However, with SAVEMONEY, up to three plasmids can be mixed per sample, allowing them to be sequenced as just two samples. As a result, the sequencing cost per plasmid is reduced to one-third. The greatest benefits can be realized when SAVEMONEY is used at the laboratory level or by multiple researchers. To make this point clearer, we have added sentences in the 5th paragraph of the discussion section.</p>
<disp-quote content-type="editor-comment">
<p>(1) To provide more comprehensive information for users who care about the cost, the Introduction section should include a cost comparison between Sanger and ONT, with more details, such as diPerent ONT platforms (MinION, PromethION, FlongIe), chemistries (flow cells) and kits. This additional information will be more helpful and informative for the users who have their own sequencers and are the target audience for SAVEMONEY.</p>
</disp-quote>
<p>We thank the reviewer for pointing this out. Since we do not own ONT equipment, we are unable to provide a total cost for using the ONT platform. However, we have included the price per sample (~$15 per plasmid) for the commercial service we have used, as well as the equipment that they employ (V14 chemistry on a PromethION with an R10.4.1 flow cell) and the number of reads obtained per plasmid (~100–1000) in the 4th paragraph of the introduction section.     Though these costs will inevitably change over time, this information should still be helpful for those who own ONT sequencers in estimating the costs.</p>
<p>(2) In &quot;Overview of the algorithm&quot; (Pages 3-4) under the Results section, instead of stating &quot;However, coverage varies from ~100-1000 and is diPicult to predict because each nanopore flow cell has diPerent properties.&quot;, it will be beneficial to provide more detailed information, such as sequencing length, yield/read count per flow cell of diPerent platforms. This information will assist users in designing their own experiments ePectively.</p>
<p>We thank the reviewer for the comment. As mentioned in the previous response, we are unable to provide sequencing length, yield/read count per flow cell because we do not own ONT equipment. However, we apologize if it was not clear in &quot;Overview of the algorithm&quot; section that we are discussing the use of results obtained from commercial services, and therefore we need to provide more detailed information about the results from the commercial service. We have now clarified in the sentence pointed out by the reviewr that the numbers are derived from the information provided by commercial sequencing services. In addition, we have also added that typical examples of the result properties, i.e., read length and quality score distribution, can be found in Fig. 2 at the end of the same paragraph.</p>
<disp-quote content-type="editor-comment">
<p>(3) While this study optimized and evaluated the tool using a total of 14 plasmids, it may not provide suPicient power to represent the diversity of the plasmid world. Consideration should be given to expanding the dataset to include a broader range of plasmids in future studies to enhance the robustness and generalizability of the tool.</p>
</disp-quote>
<p>We are grateful to the reviewer for their valuable input. It is very reasonable that we had to expect that a larger number of plasmids should be used, even though the main target of SAVEMONEY is those who utilize commercial services. In the previous version of SAVEMONEY, it was not possible to process in a reasonable amount of time if too many plasmids were provided, though the algorithm itself does not have no restrictions based on the number of plasmids. Therefore, we have changed the underlying code to improve the algorithm, making it more than 20 times faster than the previous version (the benchmark time mentioned in the 3rd paragraph of the discussion section was improved to 3.1 minutes from the previous 65 minutes, using the same dataset and the same computer). Additionally, SAVEMONEY is now compatible with multiprocessing. The processing time is expected to decrease approximately inversely proportional to the number of CPU cores used. We have added these updates at the end of the 3rd paragraph in the discussion section.</p>
<disp-quote content-type="editor-comment">
<p>(4) If applicable and feasible, including a comparison or benchmark of SAVEMONEY against other similar tools would further strengthen the manuscript. This comparison would allow users to evaluate the advantages and disadvantages of diPerent tools for their specific needs.</p>
</disp-quote>
<p>We thank the reviewer for the suggestion. We have added the benchmark using the similar tool, On-Ramp, with the exact same set of plasmids and FASTQ data used for our benchmark (4th paragraph in the discussion section). Because the machine specifications used in the On-Ramp web server are unknown, a direct comparison is not possible. However, using only laptop-level computational resources, SAVEMONEY was able to process the data 38% faster than On-Ramp. When using mini-PC level computational resources, the processing time was 64% faster than on-RAMP.</p>
<disp-quote content-type="editor-comment">
<p>(5) The importance of pre-filtering raw sequencing reads should be emphasized as noisy reads can significantly impact the overall performance of the tool. It is essential to clarify whether any pre-filtering steps were performed in this study, such as filtering based on quality scores, read length, or other relevant factors.</p>
</disp-quote>
<p>We apologize for not being clear. Unfortunately, the commercial sequencing service we used did not provide the information regarding pre-filtering. However, the impact of the quality of pre-filtering based on quality score and read length on the quality of the final results is theoretically minimal in SAVEMONEY. First, during the initial step of the post-analysis, the classification step, short reads compared to the full plasmid length can be excluded based on the user-defined “score_threshold”. Simultaneously, low-quality reads with poor alignment to the plasmid can also be excluded, because “score_threshold” is related to the normalized alignment score. Even if there are low-quality reads that are not excluded at this stage, the ePect can be minimized during the final step of the post-analysis that generates consensus sequences. This is because our Bayesian analysis considers not only the base calling but also the q-scores to determine the consensus. Therefore, we believe the overall impact of pre-filtering on the final results is negligible.</p>
<disp-quote content-type="editor-comment">
<p>(6) The statement regarding the number of required reads per plasmid (20-30) and the maximum number of plasmids (up to six) that can be mixed in a single run may become outdated due to the rapid advancements in ONT technology. In the Discussion section, instead of assuming specific numbers, it would be more beneficial to provide information based on the current state of ONT sequencing, such as the number of reads per MinION flow cell that can be produced.</p>
</disp-quote>
<p>We thank the reviewer for pointing this out. Because the number of required reads per plasmid depends on the accuracy of each read (i.e., the number of required reads can be reduced if the accuracy increases), we have added the description of these points to the last paragraph of the discussion section.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (public review):</bold></p>
<p>The authors developed an algorithm that allows for deconvoluting of plasmid sequences from a mixture of plasmids that have been sequenced by nanopore long read technology. As library preparations and barcoding of individual samples increase sequencing costs, the algorithm bypasses this need and thus decreases time on sample prep and sequencing costs. In the first step, the tool assesses which of the plasmid constructions can be mixed in a single library preparation by calculating a distance matrix between the reference plasmid and the constructions producing sequence clusters. The user is given groups of plasmids, from diPerent clusters, to be pooled together for sequencing. After sequencing, the algorithm deconvolutes the reads by classifying them based on alignments to the reference sequence. A Bayesian analysis approach is used to obtain a consensus sequence and quality scores.</p>
<p>Strengths</p>
<p>The authors exploit one of the main advantages of long-read sequencing which is to accurately resolve regions of high complexity, as regularly found in plasmids, and developed a tool that can validate plasmid constructions by reducing sequencing costs. Multiple plasmids (up to six) can be analyzed simultaneously in a single library without the need for sample barcoding, also reducing sample preparation time. Although inserts must be diPerent, just 2 bases diPerence would be enough for a correct assignation. It maximizes cost-ePiciency for projects that require large amounts of plasmid constructions and highthroughput validation.</p>
</disp-quote>
<p>We thank the reviewer for the positive response to our manuscript and the helpful comments.</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses</p>
<p>The method proposed by the authors requires prior knowledge of plasmid sequences (i.e., blueprints or plasmid reference) and is not suitable for small experiments. The plasmid inserts or backbones must be diPerent e.g., multiple colonies from the same plasmid construction ePort cannot be submitted together.</p>
</disp-quote>
<p>As also discussed in the response to reviewer 1, we agree with the reviewer that SAVEMONEY does not allow you the analysis of plasmids from multiple colonies in the same cloning experiment. However, that does not necessarily mean that SAVEMONEY cannot reduce the sequencing cost. For example, when sequencing two colonies from each of three diPerent constructs (six plasmids in total), the standard approach would require sequencing costs for six samples. However, with SAVEMONEY, up to three plasmids can be mixed per sample, allowing them to be sequenced as just two samples. As a result, the sequencing cost per plasmid is reduced to one-third. The greatest benefits can be realized when SAVEMONEY is used at the laboratory level or by multiple researchers. To make this point clearer, we have added sentences in the 5th paragraph of the discussion section.</p>
<p>The reviewer also expressed concern that SAVEMONEY is not suitable for experiments at a small scale. To put it more precisely, SAVEMONEY cannot be used when the experiment size is minimal, such as in a lab that consistently constructs only a single plasmid at a time. That said, the strength of SAVEMONEY lies in its scalability. Even in labs where plasmid construction is typically limited to one at a time, there may be occasional instances where two or more plasmids are created simultaneously. In such cases, SAVEMONEY can be used to reduce sequencing costs. Moreover, in a typical molecular biology lab where multiple plasmids are constructed every week, SAVEMONEY can be particularly ePective. Given its adaptability and cost-saving potential and widespread use since its initial publication on <italic>bioRxiv</italic> and on Google Colab, we are confident that SAVEMONEY will continue to be a valuable tool for a wide range of researchers.</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations For The Authors:</bold></p>
<p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p>
<p>The manucript assumes all samples are sent out for sequencing at a specific company. This could be generalized for a much broader use since many labs now own nanopore sequencers. In turn, the advantage of reducing hands-on sample prep becomes more evident.</p>
</disp-quote>
<p>We thank the reviewer for pointing this out. We agree that SAVEMONEY can also benefit those performing library preparation. Combination of standard barcodes with SAVEMONEY significantly expands the scope of sequencing applications. For example, it enables sequencing of more plasmid types than the number of available barcodes and, in some cases, may even eliminate the need for the sample prep step to introduce barcode. Because we do not own ONT equipment, we could not conduct experiments using ONT. However, to clarify these possibilities, we added a dedicated paragraph (3rd paragraph in the discussion section).</p>
<disp-quote content-type="editor-comment">
<p>The base calling model (high accuracy, super accuracy) used by Plasmidsaurus and tested here should be mentioned.</p>
</disp-quote>
<p>We thank the reviewer for the suggestion. The description about the base calling model (HAC) was added in Materials and Methods section.</p>
<p>Other modifications to the revised manuscript</p>
<p>Beyond changes made in response to reviewer comments above, we have also through our continued use and improvement of SAVEMONEY, made additional changes to the algorithm and therefore to the manuscript. Those changes are outlined below. Improvements in the pre-survey step</p>
<p>(1) The pre-survey algorithm was reduced to a Zero-One Integer Linear Programming Problem to guarantee the optimal combinations, as previous versions did not ensure an optimal solution. Relatedly, the explanation of the algorithm in the main manuscript was updated.</p>
<p>(2) The algorithm was modified to ensure that the number of plasmids distributed to each group is balanced. A new feature was also added to allow users to specify the number of groups, which is beneficial when balancing between cost and quality.</p>
<p>(3) An error was corrected in Fig. 2, where the distance calculation method for the hierarchical clustering step for group formation was Farthest Point Algorithm, which calculates distance between two clusters based on the farthest pair of plasmids. The correct method is the Nearest Point Algorithm. This error was present only in Fig. 2, while other implementations, including source code of SAVEMONEY and Google Colab page, were correct from the beginning. We have corrected the error in Fig. 2.</p>
<p>Modifications in figures, manuscripts, and other aspects</p>
<p>(1) Fig. 3 was updated to reflect the update of SAVEMONEY, although it did not show any important diPerences.</p>
<p>(2) Parameter names were updated as follows:</p>
<p>“threshold (pre)” -&gt; “distance_threshold”</p>
<p>“threshold (post)” -&gt; “score_threshold” Added “number_of_groups”</p>
<p>(3) The order of elements was rearranged in Fig. 4.</p>
<p>(4) Incorrect calculations were fixed in Fig. 4g, h, and i (old Fig. 4d, h, and l). Related to that, Fig. 4j, k, and l and Table 1 were added, in addition to the explanation in the main manuscript.</p>
<p>(5) SAVEMONEY was packaged and was released on PyPI to facilitate easy installation and integration by other developers.</p>
<p>(6) SAVEMONEY was updated and expanded to accommodate linear DNA fragments, such as PCR amplicons and long synthetic DNA. Users can select the topology of DNA by specifying that as an option. A description of this new capability was added at the end of “Overview of the algorithm” section.</p>
</body>
</sub-article>
</article>