<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">90793</article-id>
<article-id pub-id-type="doi">10.7554/eLife.90793</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.90793.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Theory of systems memory consolidation via recall-gated plasticity</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0930-7327</contrib-id>
<name>
<surname>Lindsey</surname>
<given-names>Jack</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2422-6576</contrib-id>
<name>
<surname>Litwin-Kumar</surname>
<given-names>Ashok</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Zuckerman Mind Brain Behavior Institute, Columbia University</institution>, New York, NY 10027, <country>USA</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Gjorgjieva</surname>
<given-names>Julijana</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Technical University of Munich</institution>
</institution-wrap>
<city>Freising</city>
<country>Germany</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Frank</surname>
<given-names>Michael J</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Brown University</institution>
</institution-wrap>
<city>Providence</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>Correspondence: <email>jackwlindsey@gmail.com</email>, <email>a.litwin-kumar@columbia.edu</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-11-24">
<day>24</day>
<month>11</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP90793</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-07-14">
<day>14</day>
<month>07</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-07-06">
<day>06</day>
<month>07</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.12.08.519638"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Lindsey &amp; Litwin-Kumar</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Lindsey &amp; Litwin-Kumar</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-90793-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>In a variety of species and behavioral contexts, learning and memory formation recruits two neural systems, with initial plasticity in one system being consolidated into the other over time. Moreover, consolidation is known to be selective; that is, some experiences are more likely to be consolidated into long-term memory than others. Here, we propose and analyze a model that captures common computational principles underlying such phenomena. The key component of this model is a mechanism by which a long-term learning and memory system prioritizes the storage of synaptic changes that are consistent with prior updates to the short-term system. This mechanism, which we refer to as recall-gated consolidation, has the effect of shielding long-term memory from spurious synaptic changes, enabling it to focus on reliable signals in the environment. We describe neural circuit implementations of this model for different types of learning problems, including supervised learning, reinforcement learning, and autoassociative memory storage. These implementations involve learning rules modulated by factors such as prediction accuracy, decision confidence, or familiarity. We then develop an analytical theory of the learning and memory performance of the model, in comparison to alternatives relying only on synapse-local consolidation mechanisms. We find that recall-gated consolidation provides significant advantages, substantially amplifying the signal-to-noise ratio with which memories can be stored in noisy environments. We show that recall-gated consolidation gives rise to a number of phenomena that are present in behavioral learning paradigms, including spaced learning effects, task-dependent rates of consolidation, and differing neural representations in short- and long-term pathways.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Updated introductory figure.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Systems that learn and remember confront a tradeoff between memory acquisition and retention. Plasticity enables learning but can corrupt previously stored information. Consolidation mechanisms, which stabilize or render more resilient certain plasticity events associated with memory formation, are key to navigating this tradeoff (<xref ref-type="bibr" rid="c29">Kandel et al., 2014</xref>).</p>
<p>Consolidation may be mediated both by molecular dynamics at the synapse level (synaptic consolidation) and dynamics at the neural population level (systems consolidation).</p>
<p>Theoretical studies have described how synaptic consolidation affects the strength and lifetime of memories (<xref ref-type="bibr" rid="c18">Fusi et al., 2005</xref>; <xref ref-type="bibr" rid="c31">Lahiri and Ganguli, 2013</xref>; <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>). In these studies, synapses are modeled with multiple internal variables, operating at distinct timescales, which enable individual synapses to exist in more labile or more rigid (“consolidated”) states. Such models can prolong memory lifetime and recapitulate certain memory-related phenomena, notably power-law forgetting curves. Moreover, this line of work has established theoretical limits on the memory retention capabilities of any such synaptic model, and shown that biologically realistic models can approximately achieve these limits (<xref ref-type="bibr" rid="c31">Lahiri and Ganguli, 2013</xref>; <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>). These theoretical frameworks leave open the question of what computational benefit is provided by <italic>systems</italic> consolidation mechanisms that take place in a coordinated fashion across populations of neurons.</p>
<p>The term systems consolidation most often refers to the process by which memories stored in the hippocampus are transferred to the neocortex (<xref rid="fig1" ref-type="fig">Fig. 1A</xref>; <xref ref-type="bibr" rid="c43">Squire and Alvarez, 1995</xref>; <xref ref-type="bibr" rid="c17">Frankland and Bontempi, 2005</xref>; <xref ref-type="bibr" rid="c34">McClelland et al., 1995</xref>; <xref ref-type="bibr" rid="c33">McClelland and Goddard, 1996</xref>). Prior work has described the hippocampus and the neocortex as “complementary learning systems,” emphasizing their distinct roles: the hippocampus stores information about individual experiences, and the neocortex extracts structure from many experiences (<xref ref-type="bibr" rid="c34">McClelland et al., 1995</xref>; <xref ref-type="bibr" rid="c33">McClelland and Goddard, 1996</xref>). Related phenomena also occur in other brain systems. In rodents, distinct pathways underlie the acquisition and later execution of some motor skills, with motor cortex apparently passing off responsibility to basal ganglia structures as learning progresses (<xref ref-type="bibr" rid="c30">Kawai et al., 2015</xref>; <xref ref-type="bibr" rid="c15">Dhawale et al., 2021</xref>). A similar consolidation process is observed during vocal learning in songbirds, where song learning is dependent on the region LMAN but song execution can, after multiple days of practice, become LMAN-independent and rely instead on the song motor pathway (<xref rid="fig1" ref-type="fig">Fig. 1B</xref>; <xref ref-type="bibr" rid="c50">Warren et al., 2011</xref>). Some insects also display a form of systems consolidation. Olfactory learning experiments in fruit flies reveal that short and long-term memory retrieval recruit distinct neurons within the fly mushroom body, and the short-term pathway is necessary for long-term memory formation (<xref rid="fig1" ref-type="fig">Fig. 1C</xref>; <xref ref-type="bibr" rid="c12">Cervantes-Sandoval et al., 2013</xref>; <xref ref-type="bibr" rid="c16">Dubnau and Chiang, 2013</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Schematic of short- and long-term memory systems across species and brain areas. A. In mice and other mammals, hippocampal memories are consolidated into cerebral cortex. B. Zebrafinch song learning initially depends on LMAN but later requires only HVC-to-RA synapses in the song motor pathway. C. In the <italic>Drosophila</italic> mushroom body (inset), short- and long-term memories depend on dopamine-dependent plasticity in the <italic>γ</italic> and <italic>α</italic> lobes, respectively.</p></caption>
<graphic xlink:href="519638v3_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The examples above are all characterized by two essential features: the presence of two systems involved in learning similar information and an asymmetric relationship between them, such that learning in one system (the “long-term memory”) is facilitated by the other (the “short-term memory”). Moreover, mounting evidence indicates that across all these systems, there exist mechanisms that selectively modulate or gate consolidation into long-term storage. In flies, for instance, recent work has shown that short-term olfactory memory recall gates long-term memory storage via a disinhibitory circuit, such that repeated stimulusoutcome pairings are consolidated into long-term memory but once-presented pairings are not (<xref ref-type="bibr" rid="c4">Awata et al., 2019</xref>). A recent study in songbirds indicates that the rate at which song learning is consolidated into the song motor pathway is modulated by performance quality (<xref ref-type="bibr" rid="c45">Tachibana et al., 2022</xref>). Finally, a large body of work has shown that propensity of hippocampal memories to be cortically consolidated is modulated by a variety of factors including repetition, reliability, and novelty (<xref ref-type="bibr" rid="c46">Terada et al., 2021</xref>; <xref ref-type="bibr" rid="c23">Gorriz et al., 2023</xref>; <xref ref-type="bibr" rid="c28">Jackson et al., 2006</xref>; <xref ref-type="bibr" rid="c8">Brodt et al., 2016</xref>).</p>
<p>The ubiquity of the systems consolidation motif across species, neural circuits, and behaviors suggests that it offers broadly useful computational advantages that are complementary to those offered by synaptic mechanisms. In this work, we propose that the ability to selectively consolidate memories is the key computational feature that distinguishes systems from synaptic memory consolidation. To formalize this idea, we generalize prior theoretical studies studies by considering environments in which some memories should be prioritized more than others for long-term retention. We then introduce a model of systems consolidation and show that can provide substantial performance advantages in such environments. In the model, synaptic updates are consolidated into long-term memory depending on their consistency with knowledge already stored in short-term memory. We term this mechanism “recall-gated consolidation.” This model is well-suited to prioritize storage of reliable patterns of synaptic updates which are consistently reinforced over time. We derive neural circuit implementations of this model for several tasks of interest. These involve plasticity rules modulated by globally broadcast factors such as prediction accuracy, confidence, and familiarity. We develop an analytical theory that describes the limits on learning performance achievable by synaptic consolidation mechanisms and shows that recall-gated systems consolidation exhibits qualitatively different and complementary benefits. Our theory depends on a quantitative treatment of environmental statistics, in particular the statistics with which similar events recur over time. Different model parameter choices suit different environmental statistics, and give rise to different learning behavior, including spaced training effects. The model makes predictions about the dependence of consolidation rate on the consistency of features in an environment, and the amount of time spent in it. It also predicts that short-term memory benefits from employing sparser representations compared to long-term memory. A variety of experimental data support predictions of the model, which we review in the Discussion.</p>
</sec>
<sec id="s2">
<title>Results</title>
<p>Following prior work (<xref ref-type="bibr" rid="c18">Fusi et al., 2005</xref>; <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>), we consider a network of neurons connected by an ensemble <italic>N</italic> synapses whose weights are described by a vector <bold>w ∈</bold>ℝ<sup><italic>N</italic></sup>. For now, we are agnostic as to the structure of the network and its synaptic connections. The network’s synapses are subject to a stream of patterns of candidate synaptic potentiation and depression events. We refer to such a pattern as a <italic>memory</italic>, defined by a vector Δ<bold>w ∈</bold>ℝ<sup><italic>N</italic></sup>. Learning proceeds according to a specified synaptic update rule that translates candidate potentiation and depression events (memories) into synaptic changes. One simple example of a synaptic update rule is a “binary switch” model, in which synapses can exist in two states (active or inactive), and candidate synaptic updates are binary (potentiation or depression). In this model inactive synapses activate (resp. active synapses inactivate) in response to potentiation (resp. depression) events with some probability <italic>p</italic>. However, our systems consolidation model can be used with any underlying synaptic mechanisms, and we will consider a variety of synaptic plasticity rules as underlying substrates.</p>
<p>In our framework, the same memory can be reinforced repeatedly over time. We distinguish memories by the reliability with which they are reinforced. The notion of reliability in our framework is meant to capture the idea that the structure of events in the world which drive synaptic plasticity is in some cases consistent over time, and in other cases inconsistent. For now, we focus on a simple environment model which captures this essential distinction, in which there are two kinds of memories: “reliable” and “unreliable.” Reliable memories are consistent patterns of synaptic updates that are reinforced regularly over time, whereas unreliable memories are spurious, randomly sampled patterns of synaptic updates. Concretely, in simulations, we assume that a given reliable memory is reinforced with independent probability <italic>λ</italic> at each timestep, and otherwise a randomly sampled unreliable memory is encountered.</p>
<p>A useful measure of system performance is memory <italic>recall</italic>, defined as the overlap <italic>r</italic> = Δ<bold>w ·w</bold> between a memory and the current synaptic state. Specifically, we are interested in the signal-to-noise ratio (SNR) of the recall of reliable memories, (<xref ref-type="bibr" rid="c18">Fusi et al., 2005</xref>; <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>), which normalizes the recall strength relative to the scale of fluctuations in recall of random memory vectors Δ<bold>w</bold><sup><italic>′</italic></sup>:
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="519638v3_eqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
</p>
<sec id="s2a">
<title>Recall-gated systems consolidation</title>
<p>In our model (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>), we propose that the population of <italic>N</italic> synapses is split into two subpopulations which we call the “short-term memory” (STM) and “long-term memory” (LTM). Upon every presentation of a memory Δ<bold>w</bold>, the STM recall <italic>r</italic><sub>STM</sub> = Δ<bold>w</bold> <italic>·</italic> <bold>w</bold><sub>STM</sub> is computed. Learning in the LTM is modulated by a factor <italic>g</italic>(<italic>r</italic><sub>STM</sub>). We refer to <italic>g</italic> as the “gating function.” For now we assume <italic>g</italic> to be a simple threshold function, equal to 0 for <italic>r</italic><sub>STM</sub> <italic>&lt; θ</italic> and 1 for <italic>r</italic><sub>STM</sub> ≥<italic>θ</italic>, for some suitable threshold <italic>θ</italic>. This means that consolidation occurs only when a memory is reinforced at a time when it can be recalled sufficiently strongly by the STM. Later we will consider different choices of the gating function <italic>g</italic>, which may be more appropriate depending on the statistics of memory recurrence in the environment.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><p>A. Schematic of systems consolidation model. Memories correspond to patterns of candidate potentiation and depression events (dashed arrows) applied to a synaptic population (solid arrows). The synaptic population is divided into an STM and LTM. Memories that provoke strong recall in the STM – that is, overlap strongly with the present synaptic state – enable plasticity (consolidation) in the LTM. B. Schematic of the environmental statistics. A reliable memory (green) arrives repeatedly with probability <italic>λ</italic> at each time step, with randomly sampled “unreliable” memories (gray) interspersed. The LTM is exposed to a filtered subset of consolidated memory traces with a higher proportion of reliable memories. C. Simulation of recall performance of a single reliable memory with time as it is presented with probability <italic>λ</italic> = 0.25 at each time step, <italic>N</italic> = 2000 synapses (1000 each in the STM and LTM). The STM and LTM learning rates (binary switching probabilities) are <italic>p</italic> = 0.25 and <italic>p</italic> = 0.05, respectively, and the synaptic state is initialized randomly, each synapse initially active with probability 0.5. In the recall-gated model, the gating threshold is set at <italic>θ</italic> = 2<sup><italic>−</italic>3</sup>. Shaded regions indicate standard deviation across 1000 simulations.</p></caption>
<graphic xlink:href="519638v3_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We refer to this mechanism as <italic>recall-gated consolidation</italic>. Its function is to filter out unreliable memories, preventing them from affecting LTM synaptic weights. With an appropriately chosen gating function, reliable memories will pass through the gate at a higher rate than unreliable memories. Consequently, events that trigger plasticity the LTM will consist of a higher proportion of reliable memories (<xref rid="fig2" ref-type="fig">Fig. 2B</xref>), and hence attain a higher SNR than the STM. The cost of this gating is to incur some false negatives—reliable memory presentations that fail to update the LTM. However, some false negatives can be tolerated given that we expect reliable memories to recur multiple times, and information about these events is still present in the STM. As a proof of concept of the efficacy of recall-gated consolidation, we conducted a simulation in which memories correspond to random binary synaptic update patterns and plasticity follows a binary switch rule (<xref rid="fig2" ref-type="fig">Fig. 2C</xref>). Notably, recall-dependent consolidation results in reliable memory recall with a much higher SNR than an alternative model in which LTM weight updates proceed independently of STM recall.</p>
</sec>
<sec id="s2b">
<title>Neural circuit implementations of recall-gated consolidation</title>
<p>Our model requires a computation of recall strength, which we defined as the overlap between the candidate synaptic weight changes associated with memory storage and the current state of the synaptic population. From this definition, it is not clear how recall strength can be computed biologically. The mechanisms underlying computation of recall strength will depend on the task, network architecture, and plasticity rule giving rise to candidate synaptic changes. A simple example is the case of a population of input neurons connected to a single downstream output neuron, subject to a learning rule that potentiates synapses corresponding to active inputs. In this case, the recall strength quantity corresponds exactly to the total input received by the output neuron, which acts as a familiarity detector. Below, we give the corresponding recall strength factors for other learning and memory tasks: supervised learning, reinforcement learning, and unsupervised auto-associative memory, summarized in <xref rid="fig3" ref-type="fig">Fig. 3A</xref> and derived in the Supplementary Information. We emphasize that our use of the term “recall” refers the familiarity of <italic>synaptic update patterns</italic>, and does not necessarily correspond to familiarity of stimuli or other task variables.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><p>A. Description of learning rules corresponding to different types of learning problems and corresponding expressions for the recall factor <bold>W ·</bold>Δ<bold>W</bold> used in the recall-gated consolidation model.</p>
<p>B. Schematic indicating a possible implementation of the model in a supervised learning problem, where LTM plasticity is modulated by the consistency between STM predictions and ground-truth labels.</p>
<p>C. Simulation of a binary classification problem, <italic>N</italic> = 4000, <italic>λ</italic> = 0.2, <italic>θ</italic> = 0.125, <italic>p</italic> = 0.1. There are twenty total stimuli each associated with a random binary (±1) label. Plot shows the classification accuracy over time, given by the outputs of the STM and LTM of the consolidation model. Shaded region indicates standard deviation over 1000 simulations.</p>
<p>D. Like B, but for a reinforcement learning problem. LTM plasticity is gated by both STM action confidence and the presence of reward.</p>
<p>E. Simulation of a reinforcement learning problem, <italic>N</italic> = 4000, <italic>λ</italic> = 0.25, <italic>θ</italic> = 0.75, <italic>p</italic> = 1.0. There are five total stimuli and two possible actions. Each stimulus has a corresponding action that yields reward. The plot shows average reward per step over time, using the actions given by the STM or LTM.</p>
<p>F. Like B and D, but for an autoassociative unsupervised learning problem. LTM plasticity is gated by familiarity detection in the STM module, learned using a separate set of weights.</p>
<p>G. Simulation of an autoassociative learning problem. <italic>N</italic> = 4000, <italic>λ</italic> = 0.1, <italic>θ</italic> = 0.25, <italic>p</italic> = 1.0. Recall performance is evaluated by exposing the system to a noisy version of the reliable patterns seen during training, allowing the recurrent dynamics of the network to run for 5 timesteps, and measuring the correlation of the final state of the network with the ground-truth pattern.</p></caption>
<graphic xlink:href="519638v3_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s2b1">
<title>Supervised learning</title>
<p>Suppose a population of neurons with activity <bold>x</bold> representing stimuli is connected via feedforward weights to a readout population with activity <bold>ŷ</bold> = <bold>Wx</bold>. The goal of the system is to predict ground-truth outputs <bold>y</bold>. A simple plasticity rule which will train the system appropriately is a Hebbian rule, Δ<italic>W</italic><sub><italic>ij</italic></sub> = <italic>y</italic><sub><italic>i</italic></sub><italic>x</italic><sub><italic>j</italic></sub>. The corresponding recall factor is <bold>y</bold> <italic>·</italic> <bold>ŷ</bold>, corresponding to prediction accuracy (<xref rid="fig3" ref-type="fig">Fig. 3B</xref>).</p>
</sec>
<sec id="s2b2">
<title>Reinforcement learning</title>
<p>Suppose a population of neurons with activity <italic>x</italic> representing an animal’s state is connected to a population with activity <bold><italic>π</italic></bold> = <bold>Wx</bold> representing probabilities of selecting different actions, with <italic>π</italic><sub><italic>i</italic></sub> equal to the probability of selecting action <italic>a</italic><sub><italic>i</italic></sub>. Following action selection, the animal receives a reward <italic>r</italic>, depending on its decision. A simple approach to reinforcement learning is to use a three-factor rule Δ<italic>W</italic><sub><italic>ij</italic></sub> = <italic>r · a</italic><sub><italic>i</italic></sub> <italic>· x</italic><sub><italic>j</italic></sub>, which reinforces actions that lead to reward. For this model, the corresponding recall factor is <italic>r ·p</italic>(<italic>a</italic><sub><italic>i</italic></sub>), a multiplicative combination of reward and the animal’s confidence in its selected action. Intuitively, the recall factor will be high when a confidently chosen action leads to reward (<xref rid="fig3" ref-type="fig">Fig. 3D</xref>).</p>
</sec>
<sec id="s2b3">
<title>Unsupervised autoassociative memory</title>
<p>Suppose a population of neurons with activity <bold>x</bold> and recurrent weights <bold>W</bold> stores memories as attractors according to an autoassociative Hebbian rule Δ<italic>W</italic><sub><italic>ij</italic></sub> = <italic>x</italic><sub><italic>i</italic></sub><italic>x</italic><sub><italic>j</italic></sub>. In this case, the recall strength <bold>W ·</bold>Δ<bold>W</bold> can be expressed as <bold>x ·</bold> (<bold>Wx</bold>), a comparison between stimulus input <bold>x</bold> and recurrent input <bold>Wx</bold>. Intuitively, the recall factor measures the familiarity of the stimulus, as highly familiar stimuli will exhibit attractor behavior, making <bold>x</bold> and <bold>Wx</bold> highly correlated. Such a quantity could be computed directly by using separate dendritic compartments for the two input sources, or indirectly by comparing the network state at successive timesteps. Familiarity also be approximated using a separate novelty readout trained alongside the recurrent weights (<xref rid="fig3" ref-type="fig">Fig. 3F</xref>), which is the implementation we use in our simulation. In this approach, a set of readout weight <bold>u</bold> receive the neural population activity as input, and follow the learning rule Δ<bold>u</bold> = <bold>x</bold>. The readout <bold>u</bold> <italic>·</italic> <bold>x</bold>, an estimate of familiarity, is used as the recall factor.</p>
<p>To verify that the advantages of recall-gated consolidation illustrated in <xref rid="fig2" ref-type="fig">Fig. 2</xref> apply in these tasks, we simulated the three architectures and learning rules described above (see Methods for simulation details). In each case, learning takes place online, with reliable task-relevant stimuli appearing a fraction <italic>λ</italic> of the time, interspersed among randomly sampled unreliable stimuli. In the case of supervised and reinforcement learning tasks, unreliable stimuli are paired with random labels and random rewards, respectively. Reliable stimuli are associated with consistent labels, or action-reward contingencies. We find that recall-gated consolidation provides significant benefits in each case, illustrating that the theoretical benefits of increased SNR in memory storage translate to improved performance on meaningful tasks (<xref rid="fig3" ref-type="fig">Fig. 3C,E,G</xref>).</p>
</sec>
</sec>
<sec id="s2c">
<title>An analytical theory of the recall of repeatedly reinforced memories</title>
<p>We now turn to analyzing the behavior of the recall-gated systems consolidation model more systematically, to understand the source of its computational benefits and characterize other predictions it makes. To do so, we developed an analytic theory of memory system performance, with and without recall-gated consolidation. Importantly, our framework differs from prior work (<xref ref-type="bibr" rid="c18">Fusi et al., 2005</xref>; <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>) in considering environments with intermittent repeated presentations of the same memory. We adopt several assumptions for analytical tractability. First, as in previous studies, we assume that inputs have been preprocessed so that the representations of different memories are random and uncorrelated with one another (<xref ref-type="bibr" rid="c21">Gluck and Myers, 1993</xref>; <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>). We also assume, for now, that each memory consists of an equal number of candidate potentiation and depression events, though later we will relax this assumption. We are interested in tracking the SNR of recall for a given reliable memory. We emphasize that this quantity is an abstract measure of system performance reflecting the degree to which a specific set of synaptic changes (a memory trace) is retained in the system, and its interpretation varies according to the task in question (<xref rid="fig3" ref-type="fig">Fig. 3</xref>).</p>
<p>The dynamics of memory storage depend strongly on the underlying synapse model and plasticity rule. Given a synaptic model, an important quantity to consider is its associated “forgetting curve” <italic>m</italic>(<italic>t</italic>), defined as the average SNR of recall for a memory Δ<bold>w</bold> at <italic>t</italic> timesteps following its first presentation, assuming a new randomly sampled memory has been presented at each timestep since. For example, the bin<underline>ar</underline>y switch model with transition probability <italic>p</italic> has an associated forgetting curve <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline1.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> (<xref ref-type="bibr" rid="c18">Fusi et al., 2005</xref>). More sophisticated synapse models, such as the cascade model of <xref ref-type="bibr" rid="c18">Fusi et al. (2005)</xref> and multivariable model of <xref ref-type="bibr" rid="c7">Benna and Fusi (2016)</xref> achieve power-law forgetting curves (see Methods). In the limit of large system size <italic>N</italic> and under the assumption that memories are random, uncorrelated patterns, the forgetting curve is an exact description of the decay of recall strength.</p>
<p>Forgetting curves capture the behavior of a system in response to a single presentation of a memory, but we are concerned with the behavior of memory systems in response to multiple reinforcements of the same memory trace. Thus, another key quantity in our theory is the interarrival distribution <italic>p</italic>(<italic>I</italic>), which describes the distribution of intervals between repeated presentations of the same memory, and its expected value <italic>τ</italic> = 𝔼 [<italic>I</italic>], the average interval length. Our simplest case of interest is the case in which a given memory recurs according to a Poisson process; that is, it is reinforced with probability <italic>λ</italic> at each timestep, independent of the history of recent reinforcements (as in the simulation in <xref rid="fig2" ref-type="fig">Fig. 2C</xref>). This case corresponds to an exponential interarrival distribution <italic>p</italic>(<italic>I</italic>) = <italic>λe</italic><sup><italic>−λx</italic></sup>, with mean interarrival time <italic>τ</italic> = 1<italic>/λ</italic>.</p>
<p>We now quantify the recall strength for a memory that has been reinforced <italic>R</italic> times. For the synapse models we consider, this quantity can be approximated accurately (see Supplemental Information) by summing the strengths of preceding memory traces, that is:
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="519638v3_eqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>t</italic><sub><italic>i</italic></sub> is the time elapsed since the <italic>i</italic>th reinforcement of the memory. This quantity is a random variable whose value depends on the history of interarrival intervals of the memory, and the specific unreliable memories that have been stored in intervening timesteps. To more concisely characterize a system’s memory performance, we introduce a new summary metric, the <italic>learnable timescale</italic> of the system. For a given target SNR value and allowable probability of error <italic>ϵ</italic>, the learnable timescale <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline2.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is defined as the maximum interarrival timescale <italic>τ</italic> for which the SNR of recall will exceed <italic>β</italic> with probability 1 −<italic>ϵ</italic>. We fix <italic>ϵ</italic> = 0.1 throughout this work; this choice has no qualitative effect on our results. Learnable timescale captures the system’s ability to reliably recall memories that are presented intermittently. We note that there exists a close relationship between learnable timescale and the memory capacity of the system (the number of memories it can store), with the two quantities becoming linearly related in environments with a high frequency of unreliable memory presentations (see Supplementary Information and <xref rid="figS3" ref-type="fig">Fig. S3</xref>).</p>
<p>The quantifications of recall SNR and learnable timescale we present in figures are computed numerically, as deriving exact analytical expressions for learnable timescale is difficult due to the randomness of the interarrival distribution. However, to gain theoretical intuition, we find it useful to consider the following approximation, corresponding to an environment in which memories are reinforced at deterministic intervals of length <italic>τ</italic> :
<disp-formula id="eqn3">
<alternatives><graphic xlink:href="519638v3_eqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
This approximation is an upper bound on the true SNR in the limit of small <italic>ϵ</italic>, and empirically provides a close match to the true dependence of SNR on <italic>R</italic> (Supplementary Information, <xref rid="figS9" ref-type="fig">Fig. S9</xref>). Using this approximation allows us to provide closed-form analytical estimates of the behavior of SNR and learnable timescale as a function of system and environment parameters.</p>
</sec>
<sec id="s2d">
<title>Theory of recall-gated consolidation</title>
<p>In the recall-gated consolidation model, the behavior of the STM is identical to that of a model without systems consolidation. The LTM, on the other hand, behaves differently, updating only in response to the subset of memory presentations that exceed a threshold level of recall in the STM. From the perspective of the LTM, this phenomenon has the effect of changing the distribution of interval lengths between repeated reinforcements of a reliable memory. For exponentially distributed interarrival times, the induced effective interarrival distribution in the LTM is also exponential with new time constant <italic>τ</italic><sub>LTM</sub> given by
<disp-formula id="eqn4">
<alternatives><graphic xlink:href="519638v3_eqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>I</italic> is the distribution of the lengths of intervals between presentations of the same reliable memory, <italic>θ</italic> is the consolidation threshold, and Φ is the cumulative distribution function of the Gaussian distribution. This approximation is valid in the limit of large system sizes <italic>N</italic>, where responses to unreliable memories are nearly Gaussian. For general (non-exponential) interarrival distributions, the shape of the effective LTM interarrival distribution may change, but the above expression for <italic>τ</italic><sub>LTM</sub> remains valid.</p>
<p>We note that although the consolidation threshold <italic>θ</italic> can be chosen arbitrarily, setting it to too high a value has the effect of reducing the probability with which reliable memories are consolidated, by a factor of <italic>P</italic> (<italic>I &lt; m</italic><sup><italic>−</italic>1</sup>(<italic>θ</italic>)). For large values of <italic>θ</italic> this reduction can become unacceptably small. For a given number of memory repetitions <italic>R</italic>, we restrict ourselves to values of <italic>θ</italic> for which the probability that no consolidation takes place after <italic>R</italic> repetitions is smaller than the allowable probability of error <italic>ϵ</italic>.</p>
</sec>
<sec id="s2e">
<title>Recall-gated consolidation increases SNR and learnable timescale of memories</title>
<p>For fixed statistics of memory presentations, as the SNR of the STM increases (say, due to increasing <italic>N</italic>), stricter thresholds can be chosen for consolidation which filter out an increasing proportion of unreliable memory presentations, without reducing the consolidation rate of reliable memories (<xref rid="fig4" ref-type="fig">Fig. 4A</xref>, <xref rid="figS1" ref-type="fig">Fig. S1A</xref>). Consequently, the SNR of the LTM can grow much larger than that of the STM, and the amplification of SNR increases with the SNR of the STM. Notably, the SNR of the LTM in the recall-gated consolidation model also exceeds that of a control model in which STM and LTM modules are both present but do not interact (<xref rid="fig4" ref-type="fig">Fig. 4B</xref>, <xref rid="figS1" ref-type="fig">Fig. S1B</xref>).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><p>A. Distribution (probability density function) of reliable and unreliable memory overlaps (on a log scale), varying the number of synapses <italic>N</italic>. Shaded regions indicate consolidation thresholds that preserve 10% of reliable memory presentations. Units are standard deviations of the distribution of recall for randomly sampled memories.</p>
<p>B. LTM SNR induced by consolidation (with threshold set as in D) as <italic>N</italic> varies. The parallel model uses 10% slower learning rate (value of <italic>p</italic> in the binary switching synapse model) in the LTM than the STM.</p>
<p>C. Learnable timescale as a fu<underline>n</underline>ction of target SNR, for several values of N, using the binary switching synapse model with <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline44.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula></p>
<p>D. Distribution of reliable and unreliable memory overlaps, with various potential gating thresholds indicated.</p>
<p>E. Fraction of memory presentations consolidated (log scale) vs recall threshold for consolidation.</p>
<p>F. LTM SNR induced by consolidation vs. the expected number of repetitions before consolidation occurs. Increasing the expected number of repetitions corresponds to setting a more stringent consolidation threshold which filters a higher proportion of reliable memory presentations.</p>
<p>G. Learnable timescale at a target SNR of 10 as a function of number of reliable memory repetitions for several underlying synapse models, <italic>N</italic> = 10<sup>7</sup>.</p>
<p>H. Same as G, considering only the multivariable model as the underlying synapse model, and varying the interarrival interval regularity factor <italic>k</italic>.</p></caption>
<graphic xlink:href="519638v3_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We may also view the benefits of consolidation in terms of the learnable timescale of the system. Recall-gated consolidation enables longer learnable timescales, particularly at high target SNRs (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>, <xref rid="figS2" ref-type="fig">Fig. S2</xref>). We note that our definition of SNR considers only noise arising from random memory sampling and presentation order. High SNR values may be essential for adequate task performance in the face of additional sources of noise, or when the system is asked to generalize by recalling partially overlapping memory traces (<xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>).</p>
</sec>
<sec id="s2f">
<title>Recall-gated consolidation enables better scaling of memory retention with repeated reinforcement</title>
<p>As mentioned previously, higher consolidation thresholds reduce the rate at which reliable memories are consolidated. However, the consolidation rate of <italic>unreliable</italic> memories decreases even more quickly as a function of the threshold (<xref rid="fig4" ref-type="fig">Fig. 4D,E</xref>). Hence, higher thresholds increase the fraction of consolidated memories which are reliable, at the expense of reducing the rate of consolidation into LTM. This tradeoff may be acceptable if reliable memories are reinforced a large number of times, as in this case they can still be consolidated despite infrequent LTM plasticity. In other words, as the number of anticipated repetitions <italic>R</italic> of a single reliable memory increases, higher thresholds can be used in the gating function, without preventing the eventual consolidation of that memory. Doing so allows more unreliable memory presentations to be filtered out and consequently increases the SNR in the LTM (<xref rid="fig4" ref-type="fig">Fig. 4F</xref>).</p>
<p>Assuming, as we have so far, that reliable memories are reinforced at independently sampled times at a constant rate, we show (calculations in Supplementary Information) that the dependence of learnable timescale on <italic>R</italic> is linear, regardless of the underlying synaptic model (<xref rid="fig4" ref-type="fig">Fig. 4G</xref>, <xref rid="figS4" ref-type="fig">Fig. S4</xref>). Synaptic models with a small number of states, such as binary switch or cascade models, are unable to achieve this scaling without systems consolidation (<xref rid="fig4" ref-type="fig">Fig. 4G</xref>). In particular, the learnable timescale is roughly invariant to <italic>R</italic> for the binary switch model, and scales approximately logarithmically with <italic>R</italic> for the cascade model (see Supplementary Information for derivation). Synaptic models employing a large number of internal states (growing exponentially with the intended timescale of memory retention), like the multivariable model of <xref ref-type="bibr" rid="c7">Benna and Fusi (2016)</xref>, can also achieve linear scaling of learnable timescale on <italic>R</italic>. However, these models still suffer a large constant factor reduction in learnable timescale compared to models employing recall-gated consolidation (<xref rid="fig4" ref-type="fig">Fig. 4G</xref>).</p>
</sec>
<sec id="s2g">
<title>Consolidation dynamics depend on the statistics of memory recurrence</title>
<p>The benefit of recall-gated consolidation is even more notable when the reinforcement of reliable memories does not occur at independently sampled times, but rather in clusters. Such irregular interarrival times might naturally arise in real-world environments. For instance, exposure to one environmental context might induce a burst of high-frequency reinforcement of the same pattern of synaptic updates, followed by a long drought when the context changes. Intentional bouts of study or practice could also produce such effects. The systems consolidation model can capitalize on such bursts of reinforcement to consolidate memories while they can still be recalled.</p>
<p>To formalize this intuition, we extend our theoretical framework to allow for more general patterns of memory recurrence. In particular, we let <italic>p</italic>(<italic>I</italic>) indicate the probability distribution of interarrival intervals <italic>I</italic> between reliable memory presentations. So far, we have considered the case of reliable memories whose occurence times follow Poisson statistics, corresponding to an exponentially distributed interval distribution. To consider more general occurrence statistics, we consider a family of interrarival distributions known as Weibull distributions. This class allows control over an additional parameter <italic>k</italic> which modulates “burstiness” of reinforcement, and contains the exponential distribution as a special case (<italic>k</italic> = 1). For <italic>k &lt;</italic> 1, reliable memory presentations occur with probability that decays with time since the last presentation. In this regime, the same memory is liable to recur in bursts separated by long gaps (details in Methods).</p>
<p>Without systems consolidation, the most sophisticated synapse model we consider, multivariable model of <xref ref-type="bibr" rid="c7">Benna and Fusi (2016)</xref>, achieves a scaling of learnable timescale that is linear with <italic>R</italic> regardless of the regularity factor <italic>k</italic>. In fact, we show (see Supplementary Information) that the best possible learnable timescale that can achieved by any synaptic consolidation mechanism scales approximately linearly in <italic>R</italic>, up to logarithmic factors. However, for the recall-gated consolidation model, the learnable timescale scales as <italic>R</italic><sup>1<italic>/k</italic></sup> when <italic>k ≤</italic>1 (<xref rid="fig4" ref-type="fig">Fig. 4H</xref>, <xref rid="figS5" ref-type="fig">Fig. S5</xref>). In this sense, recall-gated consolidation outperforms any form of synaptic consolidation at learning from irregularly spaced memory reinforcement.</p>
</sec>
<sec id="s2h">
<title>Alternative gating functions suit different environmental statistics and predict spaced training effects</title>
<p>Thus far we have considered a threshold gating function, which is well-suited to environments in which unreliable memories are each only encountered once. We may also imagine an environment in which unreliable memories tend to recur multiple times, but over a short timescale (<xref rid="fig5" ref-type="fig">Fig. 5A</xref>, top). In such an environment, the strongest evidence for a memory’s reliability is if it overlaps to an <italic>intermediate</italic> degree with the synaptic state (<xref rid="fig5" ref-type="fig">Fig. 5A</xref>, bottom). The appropriate gating function in this case is no longer a threshold, but rather a nonmonotonic function of STM memory overlap, meaning that memories are most likely to be consolidated if reinforced at intermediate-length intervals (<xref rid="fig5" ref-type="fig">Fig. 5B</xref>). Such a mechanism is straightforward to implement using neurons tuned to particular ranges of recall strengths. This model behavior is consistent with spaced learning effects reported in flies (<xref ref-type="bibr" rid="c6">Beck et al., 2000</xref>), rodents (<xref ref-type="bibr" rid="c20">Glas et al., 2021</xref>), and humans (<xref ref-type="bibr" rid="c40">Rovee-Collier et al., 1995</xref>; <xref ref-type="bibr" rid="c49">Verkoeijen et al., 2005</xref>), which all show a characteristic inverted U-shaped dependence of memory performance on spacing interval.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><p>A. Top: Example sequence of memory presentations where unreliable memories (gray) can repeat multiple times, but only within within a short timescale (note gradient of light to dark). Bottom: Distribution of reliable and unreliable memory overlaps induced by such memory presentation statistics (log scale on x axis). Shaded region indicates overlap values that are at least ten times as likely for reliable memories as for unreliable memories.</p>
<p>B. Probability of consolidation, with the gating function chosen such that only overlaps within the shaded region of panel A are consolidated, as a function of interarrival interval.</p>
<p>C. SNR at 8 timesteps following 5 spaced repetitions of a memory, with spacing interval indicated on the x axis, for the multivariable synapse model of <xref ref-type="bibr" rid="c7">Benna and Fusi (2016)</xref> with no systems consolidation. Spaced training effects are present at short timescales, but not if other memories are presented during the interpresentation intervals.</p>
<p>D. Distribution of recall strengths corresponding to different kinds of memories, in an environment with many reliable memories. In the environment model, reliable memories are reinforced with different interarrival interval distributions, and the timescales of these distributions for different memories are distributed loguniformly. The environment also has as a background rate of unreliable memory presentations appearing at fraction 0.9 of timesteps.</p>
<p>E. Depiction of a generalization of the model in which memories can be consolidated into different LTM sub-modules, according to gating functions tuned to different recall strengths (intended to target reliable memories with different timescales of recurrence).</p>
<p>F. A consequence of the model outlined in panel E is a smooth positive dependence of memory lifetime on the spacing of repetitions, up to some threshold spacing.</p>
<p>G. Learnable timescale calculations for this extended model still show a graceful scaling of learnable timescale with number of memory repetitions that depends on the regularity (Weibull distribution parameter <italic>k</italic>) of interarrival intervals.</p></caption>
<graphic xlink:href="519638v3_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>While some synapse-level models (such as the multivariable synapse model of <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>) can also give rise to spaced training effects, these effects require that a synapse undergoes few additional potentiation or depression events between the spaced reinforcements (<xref rid="fig5" ref-type="fig">Fig. 5C</xref>, <xref rid="figS6" ref-type="fig">Fig. S6</xref>). This is because spacing effects in such models arise when synapselocal variables are saturated, and saturation effects are disrupted when other events are interspersed between repeated presentations of the same memory. Hence, the spacing effects arising from such models are unlikely to be robust over long timescales. Recall-gated systems consolidation, on the other hand, can yield spaced training effects robustly in the presence of many intervening plasticity events.</p>
</sec>
<sec id="s2i">
<title>Heterogeneous gating functions suit complex environments with multiple memories reinforced at different timescales</title>
<p>Thus far we has assumed a dichotomy between unreliable, one-off memories and reliable memories which recur according to particular statistics. In more realistic scenarios, there will exist many repeatedly reinforced memories, which may be reinforced at distinct timescales. We may be interested in ensuring good recall performance over a distribution of memories with varying recurrence statistics. For concreteness, we consider the specific case of an environment with a large number of distinct reliably reinforced memories, whose characteristic interarrival timescales are log-uniformly distributed. As before, unreliable memories are also presented with a constant probability per timestep.</p>
<p>The recall-gated plasticity model already described, using a threshold function for consolidation, still provides the benefit of filtering unreliable memory traces from the LTM. However, further improved memory recall performance is achieved with a simple extension to the model. The LTM can be subdivided into a set of subpopulations, each with distinct gating functions that specialize for different memory timescales by selecting for different recall strengths (<xref rid="fig5" ref-type="fig">Fig. 5D, E</xref>). That is, one subpopulation consolidates strongly recalled memories, another consolidates weakly recalled memories, and others lie on a spectrum between these extremes. The effect of this arrangement is to assign infrequently reinforced memory traces to subpopulations which experience less plasticity, allowing these traces to persist until their next reinforcement. This heterogeneity of timescales is consistent with observations in a variety of species of intermediate timescale memory traces (<xref ref-type="bibr" rid="c39">Rosenzweig et al., 1993</xref>; <xref ref-type="bibr" rid="c11">Cepeda et al., 2008</xref>; <xref ref-type="bibr" rid="c13">Davis, 2011</xref>).</p>
<p>Studies of spaced training effects have found that the optimal spacing interval during training depends on the interval between training and evaluation (<xref ref-type="bibr" rid="c10">Cepeda et al., 2006</xref>, <xref ref-type="bibr" rid="c11">2008</xref>). In particular, the timescale of memory retention is observed to increase smoothly with the spacing interval used during training. Our extended model naturally gives rise to this behavior (<xref rid="fig5" ref-type="fig">Fig. 5F</xref>, <xref rid="figS7" ref-type="fig">Fig. S7</xref>, <xref rid="figS8" ref-type="fig">Fig. S8</xref>), due to the fact that the lifetime of a consolidated memory scales inversely with the frequency with which memories are consolidated into its corresponding LTM subpopulation.</p>
</sec>
<sec id="s2j">
<title>Predicted features of memory representations and consolidation dynamics</title>
<p>The recall-gated consolidation model makes a number of key predictions. The most basic consequence of the model is that responsibility for recalling a memory will gradually shift from the STM to the LTM as consolidation progresses, rendering the recall performance of the system increasingly robust to the inactivation of the STM (<xref rid="fig6" ref-type="fig">Fig. 6A</xref>). A more specific prediction of the model is the <italic>rate</italic> of updates to the LTM increases with time, as STM recall grows stronger (<xref rid="fig6" ref-type="fig">Fig. 6B</xref>). The rate of LTM updates also increases with reliability of the environment (operationalized as the proportion of synaptic update events which correspond to reliable memories) (<xref rid="fig6" ref-type="fig">Fig. 6B</xref>).</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><p>A. Top: Recall performance for a single reliable memory (true positive rate, with a decision threshold set to yield a 10% false positive rate) as learning progresses. Simulation environment is the same as in <xref rid="fig2" ref-type="fig">Fig. 2C</xref>. <italic>N</italic> = 10<sup>3</sup>, <italic>λ</italic> = 0.25. Bottom: difference between combined recall performance and LTM-only performance. The STM makes diminishing contributions to recall over time.</p>
<p>B. Probability of consolidation into LTM increases with experience and with the reliability of the environment (parameterized here by the recurrence frequency <italic>λ</italic> of reliable memories). Simulation environment is the same as in panel A.</p>
<p>C. For a single population of binary synapses (no consolidation) and Poisson memory recurrence, mean SNR as a function of reliable memory recurrence frequency <italic>λ</italic> and memory sparsity <italic>f</italic>. Dots indicate simulation results and solid lines indicate analytical approximation. <italic>N</italic> = 1024.</p>
<p>D. For the systems consolidation model using binary synapses, total system SNR (<italic>N</italic> = 256) as a function of memory sparsity in the STM and LTM.</p></caption>
<graphic xlink:href="519638v3_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The recall-gated consolidation model also makes predictions regarding neural representations in the STM and LTM. Until now we have assumed that memories consist of balanced potentiation and depression events distributed across the population. However, memories may involve only a sparse subset of synapses, for instance if synaptic plasticity arises from neural activity which is itself sparse. To formalize this notion, we consider memories that potentiate a fraction <italic>f</italic> of synapses, and a correspondingly modified binary switch plasticity rule such that potentiation activates synapses with probability <italic>p</italic> and depression inactivates synapses with probability <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline3.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> We show analytically (see Supplementary Information) that in the limit of low <italic>f</italic>, the SNR-optimizing choice of <italic>f</italic> is proportional to the rate <italic>λ</italic> of reliable memory reinforcement (<xref rid="fig6" ref-type="fig">Fig. 6C</xref>). Other factors, such as energetic constraints and noise-robustness, may also affect the optimal coding level. In general, however, our analysis shows that environments with infrequent reinforcement of a given reliable memory incentivize sparser representations. As the effective value of <italic>λ</italic> is amplified in the LTM module, it follows that the LTM benefits from a denser representation than the STM. Interestingly, we also find that the optimal sparsity in the STM decreases when optimizing for the overall SNR of the system—that is, the the optimal STM representation is even more sparse in the context of supporting LTM consolidation than it would be in isolation. Taken together, these two effects result in much denser representations being optimal in the LTM than in the STM (<xref rid="fig6" ref-type="fig">Fig. 6D</xref>). One consequence of denser representations is greater generalization in the face of input noise (<xref ref-type="bibr" rid="c5">Babadi and Sompolinsky, 2014</xref>), implying that an optimal STM/LTM system should employ more robust and generalizable representations in the LTM.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>We have presented a theory of systems memory consolidation via recall-gated long-term plasticity, which provides complementary benefits to synaptic consolidation mechanisms in terms of memory lifetime and retrieval accuracy. Its advantage arises from the ability to integrate over the information present in an entire neuronal population, rather than individual synapses, in order to decide which memory traces are consolidated. This capability is important in environments that induce a mixture of reliable and unreliable synaptic updates, in which a system must prioritize which updates to store long-term.</p>
<sec id="s3a">
<title>Experimental evidence for recall-gated consolidation</title>
<p>The recall-gated consolidation model is by design agnostic to the underlying neural circuit and hence potentially applicable to a wide variety of species and brain regions. Here we summarize evidence consistent with recall-gated consolidation in several model organisms. As our proposal is new, the experiments we describe were not designed to directly test our model predictions, and thus provide incomplete evidence for them. We hope that future work will more directly clarify the relevance of our model to these systems as well as others, the mechanisms by which it is implemented, and the shortcomings it may have in accounting for experimental results.</p>
<sec id="s3a1">
<title>Associative learning in insects</title>
<p>In the <italic>Drosophila</italic> mushroom body, plasticity is driven by activity of dopamine neurons innervating a collection of anatomically defined compartments, some of which are associated with short or long-term memory (<xref ref-type="bibr" rid="c3">Aso et al., 2014</xref>). These neurons receive a wide variety of inputs, including from mushroom body output neurons themselves (<xref ref-type="bibr" rid="c32">Li et al., 2020</xref>). Such inputs provide a substrate by which long-term learning can be modulated by the outputs of short-term pathways. To implement recall-gated consolidation, the activity of dopamine neurons mediating long-term memory should be gated by learning in corresponding shortterm pathways. A recent study found an instance of this motif, in which short-term aversive learning decreases the activity of the <italic>γ</italic>1 output neuron, disinhibiting a dopamine neuron in the <italic>α</italic>2 compartment associated with long-term aversive learning (<xref ref-type="bibr" rid="c4">Awata et al., 2019</xref>). More work is needed to determine if other examples of this motif can be found in <italic>Drosophila</italic> or other insects.</p>
</sec>
<sec id="s3a2">
<title>Motor learning</title>
<p>Several lines of work have indicated that the neural substrate of motor skills can shift with practice. In songbirds, learned changes to song performance are initially driven by a cortico-basal ganglia circuit called the anterior forebrain pathway (AFB) but eventually are consolidated into the song motor pathway (SMP) and become AFB-independent (<xref ref-type="bibr" rid="c2">Andalman and Fee, 2009</xref>; <xref ref-type="bibr" rid="c50">Warren et al., 2011</xref>). Using transient inactivations of LMAN, a region forming part of the AFB, a recent study quantified the degree of AFB-to-SMP consolidation over time and found that it strongly correlated with the bird’s motor performance at the time (<xref ref-type="bibr" rid="c45">Tachibana et al., 2022</xref>). This finding is consistent with our model’s prediction that the <italic>rate</italic> of consolidation should increase as learning progresses in the short-term pathway.</p>
<p>A related motor consolidation process has been observed during motor learning in rats. Experiments have shown that motor cortex disengages from heavily practiced skills (<xref ref-type="bibr" rid="c30">Kawai et al., 2015</xref>; <xref ref-type="bibr" rid="c26">Hwang et al., 2019</xref>), transferring control at least in part to the basal ganglia (<xref ref-type="bibr" rid="c14">Dhawale et al., 2019</xref>, <xref ref-type="bibr" rid="c15">2021</xref>), and that the degree of cortical disengagement tracks motor performance, as measured by the variability of learned trajectories (<xref ref-type="bibr" rid="c27">Hwang et al., 2021</xref>). This finding is broadly consistent with recall-consolidation, with short-term learning being mediated by motor cortex and long-term learning being mediated by basal ganglia. However, we note that unlike in the song learning study referenced above, it neither confirms nor rejects our stronger prediction that the <italic>rate</italic> (rather than overall extent) of motor consolidation increases with learning.</p>
</sec>
<sec id="s3a3">
<title>Spatial learning and hippocampal replay</title>
<p>Hippocampal replay is thought to be crucial to the consolidation of episodic memories to cortex (<xref ref-type="bibr" rid="c9">Carr et al., 2011</xref>; Ólafsdóttir et al., 2018). Replay has many proposed computational functions, such as enabling continual learning (<xref ref-type="bibr" rid="c48">van de Ven et al., 2020</xref>), or optimizing generalization performance (<xref ref-type="bibr" rid="c44">Sun et al., 2021</xref>), which are outside the scope of our model. However, under the assumption that replay enables long-term memory storage in cortex, the recall-gated consolidation model makes predictions about which memories should be replayed—namely, replay should disproportionately emphasize memories that are familiar to the hippocampus. That is, we would predict more frequent replay of events or associations that are frequently encountered than of those that were experienced only once, or unreliably.</p>
<p>Recent experimental work supports this hypothesis. A recent study found that CA3 axonal projections to CA1, those that respond visual cues associated with a fixed spatial location are recruited more readily in sharp-wave ripple events than those that respond to the randomly presented cues (<xref ref-type="bibr" rid="c46">Terada et al., 2021</xref>). Earlier work found that sharp-wave ripple events occur more frequently during maze navigation sessions with regular trajectories, and increase in frequency over the course of session, similar to the behavior of our model in <xref rid="fig4" ref-type="fig">Fig. 4B</xref> (<xref ref-type="bibr" rid="c28">Jackson et al., 2006</xref>). Thus, existing evidence suggests that hippocampal replay is biased toward familiar patterns of activity, consistent with a form recall-gated consolidation. Other experiments provide preliminary evidence for signatures of such a bias in cortical plasticity. For instance, fMRI study of activity in hippocampus and posterior parietal cortex (PPC) during a human virtual navigation experiment found that that the recruitment of PPC during the task, which was linked with memory performance, tended to strengthened with experience in a static environment, but did not strengthen when subjects were exposed to an constantly changing environment, consistent with consolidation of only reliable memories (<xref ref-type="bibr" rid="c8">Brodt et al., 2016</xref>).</p>
</sec>
</sec>
<sec id="s3b">
<title>Comparison with synaptic consolidation mechanisms</title>
<p>Recall-gated consolidation improves memory performance regardless of the underlying synapse model (<xref rid="fig4" ref-type="fig">Fig. 4</xref>), indicating that its benefits are complementary to those of synaptic consolidation. Our theory quantifies these benefits in terms of the scaling behavior of the model’s maximum learnable timescale with respect to other parameters. First, for any underlying synapse model, recall-gated consolidation allows learnable timescale to decay much more slowly as a function of the desired SNR of memory storage. Second, recall-gated consolidation achieves (at worst) linear scaling of learnable timescale as a function of the number of memory reinforcements <italic>R</italic>. For models with a fixed, finite number of internal states per synapse, this scaling is at best logarithmic. Our results therefore illustrate that systems-level consolidation mechanisms allow relatively simple synaptic machinery (Emes et al., 2008) to support long-term memory storage. We note that more sophisticated synaptic models, which involve a large number of internal states that scales with the memory timescale of interest (<xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>), can also achieve linear scaling of learnable timescale with <italic>R</italic> (though recall-gated consolidation still improves their performance by a large constant factor). However, for environmental statistics characterized by concentrated bursts of repeated events separated by long gaps, recall-gated consolidation achieves superlinear power-law scaling, which we showed is not achievable by any synapse-local consolidation mechanism.</p>
<p>Our model provides an explanation for spaced training effects (<xref rid="fig5" ref-type="fig">Fig. 5</xref>) based on optimal gating of long-term memory consolidation depending on the recurrence statistics of reliable stimuli. It is important to note that, depending on the specific form of internal dynamics present in individual synapses, synaptic consolidation models can also reproduce spacing effects. For example, the initial improvement of memory strength with increased spacing arises in the model of <xref ref-type="bibr" rid="c7">Benna and Fusi (2016)</xref> due to saturation of fast synaptic variables, meaning that the timescale of these internal variables determines optimal spacing, and that intervening stimuli can block the effect by preventing saturation (<xref rid="fig5" ref-type="fig">Fig. 5</xref>). In contrast, in our model this timescale is set by population-level forgetting curves, rendering spacing effects robust over long timescales and in the presence of intervening events. It is likely that mechanisms at both the synaptic and systems level contribute to spacing effects; our results suggest that effects observed at longer timescales are likely to arise from memory recall mechanisms at the systems level.</p>
</sec>
<sec id="s3c">
<title>Other models of systems consolidation</title>
<p>Unlike previous theories, our study emphasizes the role of repeated memory reinforcement in consolidation and explicitly quantifies the consequences of such reinforcement. However, there are important connections between our work other computational models of systems consolidation that have been proposed. Much of this work focuses on consolidation via hippocampal replay. Prior work has proposed that replay (or similar mechanisms) can prolong memory lifetimes (<xref ref-type="bibr" rid="c42">Shaham et al., 2021</xref>; <xref ref-type="bibr" rid="c38">Remme et al., 2021</xref>), alleviate the problem of catastrophic forgetting of previously learned information (<xref ref-type="bibr" rid="c48">van de Ven et al., 2020</xref>; <xref ref-type="bibr" rid="c22">González et al., 2020</xref>; <xref ref-type="bibr" rid="c42">Shaham et al., 2021</xref>), and facilitate generalization of learned information (<xref ref-type="bibr" rid="c34">McClelland et al., 1995</xref>; <xref ref-type="bibr" rid="c44">Sun et al., 2021</xref>). One prior theoretical study (<xref ref-type="bibr" rid="c41">Roxin and Fusi, 2013</xref>), which uses replayed activity to consolidate synaptic changes from short to long-term modules, explored how systems consolidation extends forgetting curves. Unlike our work, this model does not involve gating of memory consolidation, and consequently provides no additional benefit in consolidating repeatedly reinforced memories. Our model is thus distinct from, but also complementary to, these prior studies. In particular, recall-gated consolidation can be implemented in real-time, without replay of old memories. However, as discussed above, selective replay of familiar memories is one possible implementation of recall-gated consolidation. Selective replay is a feature of some of the work cited above (<xref ref-type="bibr" rid="c42">Shaham et al., 2021</xref>; <xref ref-type="bibr" rid="c44">Sun et al., 2021</xref>), which suggests it can provide advantages for retention and generalization (<xref ref-type="bibr" rid="c42">Shaham et al., 2021</xref>; <xref ref-type="bibr" rid="c44">Sun et al., 2021</xref>).</p>
<p>Other work has proposed models of consolidation, particularly in the context of motor learning, in which one module “tutors” another to perform learned behaviors by providing it with target outputs (Murray et al., 2017; <xref ref-type="bibr" rid="c47">Teşileanu et al., 2017</xref>). <xref ref-type="bibr" rid="c35">Murray and Escola (2020)</xref> proposes a fast-learning pathway (which learns using reward or supervision) which tutors the slow-learning long-term module via a Hebbian learning rule. In machine learning, a similar concept has become popular (typically referred to “knowledge distillation”), in which the outputs of a trained neural network are used to supervise the learning of a second neural network on the same task (<xref ref-type="bibr" rid="c25">Hinton et al., 2015</xref>; <xref ref-type="bibr" rid="c24">Gou et al., 2021</xref>). Empirically, this procedure is found to improve generalization performance and enable the use of smaller networks. Our model can be interpreted as a form of partial tutoring of the LTM by the STM, as learning in the LTM is partially dictated by outputs of the STM. In this sense, our work provides a theoretical justification for the use of tutoring signals between two neural populations.</p>
</sec>
<sec id="s3d">
<title>Limitations and future work</title>
<p>In addition to motivating new experiments to test the predictions of a recall-gated consolidation model, our work leaves open a number of theoretical questions that future modeling could address. Our theory assumes fixed and random representations of memory traces. Subject to this assumption, we showed that short-term memory benefits from sparser representations than long-term memory. In realistic scenarios, synaptic updates are likely to be highly structured, and the optimal representations in each module could differ in more sophisticated ways. Moreover, adapting representations online—for instance, in order to decorrelate consolidated memory traces—may improve learning performance further. Addressing these questions requires extending our theory to handle memory statistics with nontrivial correlations. Another possibility we left unaddressed is that of more complex interactions between memory modules—for instance, reciprocal rather than unidirectional interactions—or the use of more than two interacting systems.</p>
<p>Finally, in this work we considered only a limited family of ways in which long-term consolidation may be modulated—namely, according to threshold-like functions of recall in the short-term pathway. Considering richer relationships between recall and consolidation rate may enable improved memory performance and/or better fits to experimental data. Moreover, in real neural circuits, additional factors besides recall, such as reward or salience, are likely to influence consolidation as well. Unlike our notion of recall, which can be modeled in task-agnostic fashion, the impact of such additional factors on learning likely depends strongly depend on the behavior in question. Our work provides a theoretical framework that will facilitate more detailed models of the rich dynamics of consolidation in specific neural systems of interest.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>We would like to thank Stefano Fusi and Samuel Muscinelli for helpful discussions and comments on the manuscript. A. L.-K. and J. L. were supported by the Gatsby Charitable Foundation, NSF award DBI-1707398. J. L. was also supported by the DOE CSGF (DE–SC0020347). A. L.-K. was also supported by the Burroughs Wellcome Foundation, the McKnight Endowment Fund, the Mathers Foundation, and NIH award R01EB029858.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Amit</surname>, <given-names>D. J.</given-names></string-name> and <string-name><surname>Fusi</surname>, <given-names>S.</given-names></string-name> (<year>1994</year>). <article-title>Learning in neural networks with material synapses</article-title>. <source>Neural Computation</source>, <volume>6</volume>(<issue>5</issue>):<fpage>957</fpage>–<lpage>982</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Andalman</surname>, <given-names>A. S.</given-names></string-name> and <string-name><surname>Fee</surname>, <given-names>M. S.</given-names></string-name> (<year>2009</year>). <article-title>A basal ganglia-forebrain circuit in the songbird biases motor output to avoid vocal errors</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>106</volume>(<issue>30</issue>):<fpage>12518</fpage>–<lpage>12523</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Aso</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Hattori</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Johnston</surname>, <given-names>R. M.</given-names></string-name>, <string-name><surname>Iyer</surname>, <given-names>N. A.</given-names></string-name>, <string-name><surname>Ngo</surname>, <given-names>T.-T.</given-names></string-name>, <string-name><surname>Dionne</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Abbott</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Axel</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Tanimoto</surname>, <given-names>H.</given-names></string-name>, <etal>et al.</etal> (<year>2014</year>). <article-title>The neuronal architecture of the mushroom body provides a logic for associative learning</article-title>. <source>elife</source>, <volume>3</volume>:<fpage>e04577</fpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Awata</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Takakura</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Kimura</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Iwata</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Masuda</surname>, <given-names>T.</given-names></string-name>, and <string-name><surname>Hirano</surname>, <given-names>Y.</given-names></string-name> (<year>2019</year>). <article-title>The neural circuit linking mushroom body parallel circuits induces memory consolidation in drosophila</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>116</volume>(<issue>32</issue>):<fpage>16080</fpage>–<lpage>16085</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Babadi</surname>, <given-names>B.</given-names></string-name> and <string-name><surname>Sompolinsky</surname>, <given-names>H.</given-names></string-name> (<year>2014</year>). <article-title>Sparseness and expansion in sensory representations</article-title>. <source>Neuron</source>, <volume>83</volume>(<issue>5</issue>):<fpage>1213</fpage>–<lpage>1226</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Beck</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Schroeder</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Davis</surname>, <given-names>R. L.</given-names></string-name> (<year>2000</year>). <article-title>Learning performance of normal and mutantdrosophila after repeated conditioning trials with discrete stimuli</article-title>. <source>Journal of Neuroscience</source>, <volume>20</volume>(<issue>8</issue>):<fpage>2944</fpage>–<lpage>2953</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Benna</surname>, <given-names>M. K.</given-names></string-name> and <string-name><surname>Fusi</surname>, <given-names>S.</given-names></string-name> (<year>2016</year>). <article-title>Computational principles of synaptic memory consolidation</article-title>. <source>Nature neuroscience</source>, <volume>19</volume>(<issue>12</issue>):<fpage>1697</fpage>–<lpage>1706</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Brodt</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Pöhlchen</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Flanagin</surname>, <given-names>V. L.</given-names></string-name>, <string-name><surname>Glasauer</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Gais</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Schönauer</surname>, <given-names>M.</given-names></string-name> (<year>2016</year>). <article-title>Rapid and independent memory formation in the parietal cortex</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>113</volume>(<issue>46</issue>):<fpage>13251</fpage>–<lpage>13256</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Carr</surname>, <given-names>M. F.</given-names></string-name>, <string-name><surname>Jadhav</surname>, <given-names>S. P.</given-names></string-name>, and <string-name><surname>Frank</surname>, <given-names>L. M.</given-names></string-name> (<year>2011</year>). <article-title>Hippocampal replay in the awake state: a potential substrate for memory consolidation and retrieval</article-title>. <source>Nature neuroscience</source>, <volume>14</volume>(<issue>2</issue>):<fpage>147</fpage>–<lpage>153</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Cepeda</surname>, <given-names>N. J.</given-names></string-name>, <string-name><surname>Pashler</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Vul</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Wixted</surname>, <given-names>J. T.</given-names></string-name>, and <string-name><surname>Rohrer</surname>, <given-names>D.</given-names></string-name> (<year>2006</year>). <article-title>Distributed practice in verbal recall tasks: A review and quantitative synthesis</article-title>. <source>Psychological bulletin</source>, <volume>132</volume>(<issue>3</issue>):<fpage>354</fpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Cepeda</surname>, <given-names>N. J.</given-names></string-name>, <string-name><surname>Vul</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Rohrer</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Wixted</surname>, <given-names>J. T.</given-names></string-name>, and <string-name><surname>Pashler</surname>, <given-names>H.</given-names></string-name> (<year>2008</year>). <article-title>Spacing effects in learning: A temporal ridgeline of optimal retention</article-title>. <source>Psychological science</source>, <volume>19</volume>(<issue>11</issue>):<fpage>1095</fpage>–<lpage>1102</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Cervantes-Sandoval</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Martin-Penña</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Berry</surname>, <given-names>J. A.</given-names></string-name>, and <string-name><surname>Davis</surname>, <given-names>R. L.</given-names></string-name> (<year>2013</year>). <article-title>System-like consolidation of olfactory memories in drosophila</article-title>. <source>Journal of Neuroscience</source>, <volume>33</volume>(<issue>23</issue>):<fpage>9846</fpage>–<lpage>9854</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Davis</surname>, <given-names>R. L.</given-names></string-name> (<year>2011</year>). <article-title>Traces of drosophila memory</article-title>. <source>Neuron</source>, <volume>70</volume>(<issue>1</issue>):<fpage>8</fpage>–<lpage>19</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="other"><string-name><surname>Dhawale</surname>, <given-names>A. K.</given-names></string-name>, <string-name><surname>Wolff</surname>, <given-names>S. B.</given-names></string-name>, <string-name><surname>Ko</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>OÖlveczky</surname>, <given-names>B. P.</given-names></string-name> (<year>2019</year>). <article-title>The basal ganglia can control learned motor sequences independently of motor cortex</article-title>. <source>BioRxiv</source>, page <fpage>827261</fpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Dhawale</surname>, <given-names>A. K.</given-names></string-name>, <string-name><surname>Wolff</surname>, <given-names>S. B.</given-names></string-name>, <string-name><surname>Ko</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>OÖlveczky</surname>, <given-names>B. P.</given-names></string-name> (<year>2021</year>). <article-title>The basal ganglia control the detailed kinematics of learned motor skills</article-title>. <source>Nature Neuroscience</source>, <volume>24</volume>(<issue>9</issue>):<fpage>1256</fpage>–<lpage>1269</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Dubnau</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Chiang</surname>, <given-names>A.-S.</given-names></string-name> (<year>2013</year>). <article-title>Systems memory consolidation in drosophila</article-title>. <source>Current opinion in neurobiology</source>, <volume>23</volume>(<issue>1</issue>):<fpage>84</fpage>–<lpage>91</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Frankland</surname>, <given-names>P. W.</given-names></string-name> and <string-name><surname>Bontempi</surname>, <given-names>B.</given-names></string-name> (<year>2005</year>). <article-title>The organization of recent and remote memories</article-title>. <source>Nature reviews neuroscience</source>, <volume>6</volume>(<issue>2</issue>):<fpage>119</fpage>–<lpage>130</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Fusi</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Drew</surname>, <given-names>P. J.</given-names></string-name>, and <string-name><surname>Abbott</surname>, <given-names>L. F.</given-names></string-name> (<year>2005</year>). <article-title>Cascade models of synaptically stored memories</article-title>. <source>Neuron</source>, <volume>45</volume>(<issue>4</issue>):<fpage>599</fpage>–<lpage>611</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Gardner</surname>, <given-names>E.</given-names></string-name> (<year>1988</year>). <article-title>The space of interactions in neural network models</article-title>. <source>Journal of physics A: Mathematical and general</source>, <volume>21</volume>(<issue>1</issue>):<fpage>257</fpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Glas</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hübener</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Bonhoeffer</surname>, <given-names>T.</given-names></string-name>, and <string-name><surname>Goltstein</surname>, <given-names>P. M.</given-names></string-name> (<year>2021</year>). <article-title>Spaced training enhances memory and prefrontal ensemble stability in mice</article-title>. <source>Current Biology</source>, <volume>31</volume>(<issue>18</issue>):<fpage>4052</fpage>–<lpage>4061</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Gluck</surname>, <given-names>M. A.</given-names></string-name> and <string-name><surname>Myers</surname>, <given-names>C. E.</given-names></string-name> (<year>1993</year>). <article-title>Hippocampal mediation of stimulus representation: A computational theory</article-title>. <source>Hippocampus</source>, <volume>3</volume>(<issue>4</issue>):<fpage>491</fpage>–<lpage>516</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>González</surname>, <given-names>O. C.</given-names></string-name>, <string-name><surname>Sokolov</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Krishnan</surname>, <given-names>G. P.</given-names></string-name>, <string-name><surname>Delanois</surname>, <given-names>J. E.</given-names></string-name>, and <string-name><surname>Bazhenov</surname>, <given-names>M.</given-names></string-name> (<year>2020</year>). <article-title>Can sleep protect memories from catastrophic forgetting?</article-title> <source>Elife</source>, <volume>9</volume>:<fpage>e51005</fpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="other"><string-name><surname>Gorriz</surname>, <given-names>M. H.</given-names></string-name>, <string-name><surname>Takigawa</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Bendor</surname>, <given-names>D.</given-names></string-name> (<year>2023</year>). <article-title>The role of experience in prioritizing hippocampal replay</article-title>. <source>bioRxiv</source>, pages <fpage>2023</fpage>–<lpage>03</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Gou</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Maybank</surname>, <given-names>S. J.</given-names></string-name>, and <string-name><surname>Tao</surname>, <given-names>D.</given-names></string-name> (<year>2021</year>). <article-title>Knowledge distillation: A survey</article-title>. <source>International Journal of Computer Vision</source>, <volume>129</volume>(<issue>6</issue>):<fpage>1789</fpage>–<lpage>1819</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="other"><string-name><surname>Hinton</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Vinyals</surname>, <given-names>O.</given-names></string-name>, and <string-name><surname>Dean</surname>, <given-names>J.</given-names></string-name> (<year>2015</year>). <source>Distilling the knowledge in a neural network</source>. arXiv preprint arXiv:1503.02531.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Hwang</surname>, <given-names>E. J.</given-names></string-name>, <string-name><surname>Dahlen</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>Hu</surname>, <given-names>Y. Y.</given-names></string-name>, <string-name><surname>Aguilar</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Mukundan</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Mitani</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Komiyama</surname>, <given-names>T.</given-names></string-name> (<year>2019</year>). <article-title>Disengagement of motor cortex from movement control during long-term learning</article-title>. <source>Science advances</source>, <volume>5</volume>(<issue>10</issue>):<fpage>eaay0001</fpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Hwang</surname>, <given-names>E. J.</given-names></string-name>, <string-name><surname>Dahlen</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>Mukundan</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Komiyama</surname>, <given-names>T.</given-names></string-name> (<year>2021</year>). <article-title>Disengagement of motor cortex during long-term learning tracks the performance level of learned movements</article-title>. <source>Journal of Neuroscience</source>, <volume>41</volume>(<issue>33</issue>):<fpage>7029</fpage>–<lpage>7047</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Jackson</surname>, <given-names>J. C.</given-names></string-name>, <string-name><surname>Johnson</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Redish</surname>, <given-names>A. D.</given-names></string-name> (<year>2006</year>). <article-title>Hippocampal sharp waves and reactivation during awake states depend on repeated sequential experience</article-title>. <source>Journal of Neuroscience</source>, <volume>26</volume>(<issue>48</issue>):<fpage>12415</fpage>–<lpage>12426</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Kandel</surname>, <given-names>E. R.</given-names></string-name>, <string-name><surname>Dudai</surname>, <given-names>Y.</given-names></string-name>, and <string-name><surname>Mayford</surname>, <given-names>M. R.</given-names></string-name> (<year>2014</year>). <article-title>The molecular and systems biology of memory</article-title>. <source>Cell</source>, <volume>157</volume>(<issue>1</issue>):<fpage>163</fpage>–<lpage>186</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Kawai</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Markman</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Poddar</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Ko</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Fantana</surname>, <given-names>A. L.</given-names></string-name>, <string-name><surname>Dhawale</surname>, <given-names>A. K.</given-names></string-name>, <string-name><surname>Kampff</surname>, <given-names>A. R.</given-names></string-name>, and <string-name><surname>OÖlveczky</surname>, <given-names>B. P.</given-names></string-name> (<year>2015</year>). <article-title>Motor cortex is required for learning but not for executing a motor skill</article-title>. <source>Neuron</source>, <volume>86</volume>(<issue>3</issue>):<fpage>800</fpage>–<lpage>812</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Lahiri</surname>, <given-names>S.</given-names></string-name> and <string-name><surname>Ganguli</surname>, <given-names>S.</given-names></string-name> (<year>2013</year>). <article-title>A memory frontier for complex synapses</article-title>. <source>Advances in neural information processing systems</source>, <volume>26</volume>:<fpage>1034</fpage>–<lpage>1042</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Lindsey</surname>, <given-names>J. W.</given-names></string-name>, <string-name><surname>Marin</surname>, <given-names>E. C.</given-names></string-name>, <string-name><surname>Otto</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Dreher</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Dempsey</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Stark</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Bates</surname>, <given-names>A. S.</given-names></string-name>, <string-name><surname>Pleijzier</surname>, <given-names>M. W.</given-names></string-name>, <string-name><surname>Schlegel</surname>, <given-names>P.</given-names></string-name>, <etal>et al.</etal> (<year>2020</year>). <article-title>The connectome of the adult drosophila mushroom body provides insights into function</article-title>. <source>Elife</source>, <volume>9</volume>:<fpage>e62576</fpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>McClelland</surname>, <given-names>J. L.</given-names></string-name> and <string-name><surname>Goddard</surname>, <given-names>N. H.</given-names></string-name> (<year>1996</year>). <article-title>Considerations arising from a complementary learning systems perspective on hippocampus and neocortex</article-title>. <source>Hippocampus</source>, <volume>6</volume>(<issue>6</issue>):<fpage>654</fpage>–<lpage>665</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>McClelland</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>McNaughton</surname>, <given-names>B. L.</given-names></string-name>, and <string-name><surname>O’Reilly</surname>, <given-names>R. C.</given-names></string-name> (<year>1995</year>). <article-title>Why there are complementary learning systems in the hippocampus and neocortex: insights from the successes and failures of connectionist models of learning and memory</article-title>. <source>Psychological review</source>, <volume>102</volume>(<issue>3</issue>):<fpage>419</fpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Murray</surname>, <given-names>J. M.</given-names></string-name> and <string-name><surname>Escola</surname>, <given-names>G. S.</given-names></string-name> (<year>2020</year>). <article-title>Remembrance of things practiced with fast and slow learning in cortical and subcortical pathways</article-title>. <source>Nature Communications</source>, <volume>11</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Murray</surname>, <given-names>J. M.</given-names></string-name> <etal>et al.</etal> (<year>2017</year>). <article-title>Learning multiple variable-speed sequences in striatum via cortical tutoring</article-title>. <source>Elife</source>, <volume>6</volume>:<fpage>e26084</fpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Ólafsdóttir</surname>, <given-names>H. F.</given-names></string-name>, <string-name><surname>Bush</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name> (<year>2018</year>). <article-title>The role of hippocampal replay in memory and planning</article-title>. <source>Current Biology</source>, <volume>28</volume>(<issue>1</issue>):<fpage>R37</fpage>–<lpage>R50</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Remme</surname>, <given-names>M. W.</given-names></string-name>, <string-name><surname>Bergmann</surname>, <given-names>U.</given-names></string-name>, <string-name><surname>Alevi</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Schreiber</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Sprekeler</surname>, <given-names>H.</given-names></string-name>, and <string-name><surname>Kempter</surname>, <given-names>R.</given-names></string-name> (<year>2021</year>). <article-title>Hebbian plasticity in parallel synaptic pathways: A circuit mechanism for systems memory consolidation</article-title>. <source>PLOS Computational Biology</source>, <volume>17</volume>(<issue>12</issue>):<fpage>e1009681</fpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Rosenzweig</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>Bennett</surname>, <given-names>E. L.</given-names></string-name>, <string-name><surname>Colombo</surname>, <given-names>P. J.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>D. W.</given-names></string-name>, and <string-name><surname>Serrano</surname>, <given-names>P. A.</given-names></string-name> (<year>1993</year>). <article-title>Short-term, intermediate-term, and long-term memories</article-title>. <source>Behavioural brain research</source>, <volume>57</volume>(<issue>2</issue>):<fpage>193</fpage>–<lpage>198</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Rovee-Collier</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Evancio</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Earley</surname>, <given-names>L. A.</given-names></string-name> (<year>1995</year>). <article-title>The time window hypothesis: Spacing effects</article-title>. <source>Infant Behavior and Development</source>, <volume>18</volume>(<issue>1</issue>):<fpage>69</fpage>–<lpage>78</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Roxin</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>Fusi</surname>, <given-names>S.</given-names></string-name> (<year>2013</year>). <article-title>Efficient partitioning of memory systems and its importance for memory consolidation</article-title>. <source>PLoS computational biology</source>, <volume>9</volume>(<issue>7</issue>):<fpage>e1003146</fpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="other"><string-name><surname>Shaham</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Chandra</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Kreiman</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Sompolinsky</surname>, <given-names>H.</given-names></string-name> (<year>2021</year>). <article-title>Stochastic consolidation of lifelong memory</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Squire</surname>, <given-names>L. R.</given-names></string-name> and <string-name><surname>Alvarez</surname>, <given-names>P.</given-names></string-name> (<year>1995</year>). <article-title>Retrograde amnesia and memory consolidation: a neurobiological perspective</article-title>. <source>Current opinion in neurobiology</source>, <volume>5</volume>(<issue>2</issue>):<fpage>169</fpage>–<lpage>177</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="other"><string-name><surname>Sun</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Advani</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Spruston</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Saxe</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Fitzgerald</surname>, <given-names>J. E.</given-names></string-name> (<year>2021</year>). <article-title>Organizing memories for generalization in complementary learning systems</article-title>. <source>BioRxiv</source>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="other"><string-name><surname>Tachibana</surname>, <given-names>R. O.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Kai</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Kojima</surname>, <given-names>S.</given-names></string-name> (<year>2022</year>). <article-title>Performance-dependent consolidation of learned vocal changes in adult songbirds</article-title>. <source>The Journal of Neuroscience: the Official Journal of the Society for Neuroscience</source>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="other"><string-name><surname>Terada</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Geiller</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Liao</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>O’Hare</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Vancura</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Losonczy</surname>, <given-names>A.</given-names></string-name> (<year>2021</year>). <article-title>Adaptive stimulus selection for consolidation in the hippocampus</article-title>. <source>Nature</source>, pages <fpage>1</fpage>–<lpage>5</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Teşileanu</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>OÖlveczky</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Balasubramanian</surname>, <given-names>V.</given-names></string-name> (<year>2017</year>). <article-title>Rules and mechanisms for efficient two-stage learning in neural circuits</article-title>. <source>Elife</source>, <volume>6</volume>:<fpage>e20944</fpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>van de Ven</surname>, <given-names>G. M.</given-names></string-name>, <string-name><surname>Siegelmann</surname>, <given-names>H. T.</given-names></string-name>, and <string-name><surname>Tolias</surname>, <given-names>A. S.</given-names></string-name> (<year>2020</year>). <article-title>Brain-inspired replay for continual learning with artificial neural networks</article-title>. <source>Nature communications</source>, <volume>11</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Verkoeijen</surname>, <given-names>P. P.</given-names></string-name>, <string-name><surname>Rikers</surname>, <given-names>R. M.</given-names></string-name>, and <string-name><surname>Schmidt</surname>, <given-names>H. G.</given-names></string-name> (<year>2005</year>). <article-title>Limitations to the spacing effect: Demonstration of an inverted u-shaped relationship between interrepetition spacing and free recall</article-title>. <source>Experimental Psychology</source>, <volume>52</volume>(<issue>4</issue>):<fpage>257</fpage>–<lpage>263</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Warren</surname>, <given-names>T. L.</given-names></string-name>, <string-name><surname>Tumer</surname>, <given-names>E. C.</given-names></string-name>, <string-name><surname>Charlesworth</surname>, <given-names>J. D.</given-names></string-name>, and <string-name><surname>Brainard</surname>, <given-names>M. S.</given-names></string-name> (<year>2011</year>). <article-title>Mechanisms and time course of vocal learning and consolidation in the adult songbird</article-title>. <source>Journal of neurophysiology</source>, <volume>106</volume>(<issue>4</issue>):<fpage>1806</fpage>–<lpage>1821</lpage>.</mixed-citation></ref>
</ref-list>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Theoretical Framework</title>
<p>We consider a population of <italic>N</italic> synapses, indexed by <italic>i ∈ {</italic>1, 2, …, <italic>N}</italic> each with a synaptic weight <italic>w</italic><sub><italic>i</italic></sub> <italic>∈</italic> ℝ. The set of synaptic weights across the population can be denoted by the vector <bold>w ∈ ℝ</bold><sup><italic>N</italic></sup>. The synapses may retain additional information besides strength as well; if each synapse carries <italic>d</italic>-dimensional state information in addition to its strength, the synaptic state can be written as <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline4.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, with the scalar synaptic strengths <italic>w</italic><sub><italic>i</italic></sub> <italic>∈</italic> <bold>ℝ</bold> defined as a function of the high-dimensional state <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline5.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. We define memories as patterns of candidate synaptic modifications, following prior work (<xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>; <xref ref-type="bibr" rid="c18">Fusi et al., 2005</xref>). More specifically, we model each memory as a vector <bold>Δw ℝ</bold><sup><italic>N</italic></sup> of candidate potentiation and depression events. By defining memories in this fashion, our analysis can remain agnostic to the network architecture and learning rule that give rise to synaptic modifications. We will typically model memories as binary potentiation/depression events for simplicity, but in principle, memories can be continuous valued. Synaptic are updated by memories according to a learning rule <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline6.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, which maps the synaptic state at the time of a memory event to the subsequent synaptic state.</p>
<p>For theoretical calculations, we assume as in prior work (<xref ref-type="bibr" rid="c18">Fusi et al., 2005</xref>; <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>), that the components of each memory <bold>Δw</bold> are independent and uncorrelated with those of other memories (though this assumption is violated in our task learning simulations). We also assume for simplicity that memories are mean-centered so that 𝔼 [<bold>w ·Δw</bold> <sup><italic>′</italic></sup>] = 0 over randomly sampled memories <bold>Δw</bold> <sup><italic>′</italic></sup>.</p>
<p>We define the <italic>recall strength</italic> associated with memory as the overlap <italic>r</italic> = <bold>w ·Δw</bold>. This definition reflects an “ideal observer” perspective, as it requires direct and complete access to the state of the synaptic population. The ideal observer perspective provides an upper bound on the recall performance of a real system, and should be a fairly good approximation assuming that memory readout mechanisms are sophisticated enough. We are particularly interested in the normalized recall strength
<disp-formula id="eqn5">
<alternatives><graphic xlink:href="519638v3_eqn5.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where the expectation is taken over randomly sampled memories <bold>Δw</bold> <sup><italic>′</italic></sup>. We refer to this quantity as the signal-to-noise ratio (SNR) of memory recall.</p>
</sec>
<sec id="s4b">
<title>Synaptic models and plasticity rules</title>
<p>In this paper we primarily consider three synaptic models and corresponding learning rules, taken from prior work.</p>
<p>The first and simplest is is a “binary switch” model in which synapses take on binary (±1) values and stochastically activate (resp. inactivate) in response to candidate potentiation (resp. depression) events with probability <italic>p</italic> (<xref ref-type="bibr" rid="c1">Amit and Fusi, 1994</xref>). No auxiliary state variables are used in this model.</p>
<p>The second is the “cascade” model of <xref ref-type="bibr" rid="c18">Fusi et al. (2005)</xref>, in which synapses are modeled as a Markov chain with a finite number 2<italic>k</italic> of discrete states with transition probabilities dependent on the kind of memory event (potentiation or depression). Half the states (states <italic>a</italic><sub>1</sub>, …, <italic>a</italic><sub><italic>k</italic></sub>) are considered potentiated (strength +1) and half (states <italic>b</italic><sub>1</sub>, …, <italic>b</italic><sub><italic>k</italic></sub>) are depressed (strength −1). Intuitively, states of the same potentiation level correspond to different propensities for plasticity in the synapse, enabling a form of synaptic consolidation. Formally, for <italic>i &lt; k</italic>, the potentiated state <italic>a</italic><sub><italic>i</italic></sub> (resp. depressed state <italic>b</italic><sub><italic>i</italic></sub>) transitions to state <italic>a</italic><sub><italic>i</italic>+1</sub> (resp. <italic>b</italic><sup><italic>i</italic>+1</sup>) with probability <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline7.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> following a potentiation (resp. depression) event. And for <italic>i &lt; k</italic>, the potentiated state <italic>α</italic><sub><italic>i</italic></sub> (resp. depressed state <italic>b</italic><sub><italic>i</italic></sub>) transitions to state <italic>b</italic><sub>1</sub> (resp. <italic>a</italic><sub>1</sub>) with probability <italic>α</italic><sup><italic>i−</italic>1</sup> following a depression (resp. potentiation) event. For <italic>i</italic> = <italic>k</italic> this latter transition occurs with probability <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline8.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> (as described in <xref ref-type="bibr" rid="c18">Fusi et al. (2005)</xref>, this choice is made for convenience to ensure equal occupancy of the different synaptic states). We assume <italic>α</italic> = 0.5 throughout.</p>
<p>The third synaptic model is the model of Benna and Fusi (<xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>), which we refer to as the “multivariable” model. In this model, synapses are described by a chain of <italic>m</italic> interacting continuous-valued variables <italic>u</italic><sub>1</sub>, …, <italic>u</italic><sub><italic>m</italic></sub>, the first of which corresponds to synaptic strength. Potentiation and depression events increment or decrement the value of the first synaptic variable, and a set of difference equations governs the evolution of the multidimensional state at each time step:
<disp-formula id="eqn6">
<alternatives><graphic xlink:href="519638v3_eqn6.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>n</italic> and <italic>α</italic> a parameter of the model (we assume <italic>n</italic> = 2, <italic>α</italic> = 0.5 throughout). This model also provides the ability for synapses to store information at different timescales, due to the information retained in auxiliary variables.</p>
</sec>
<sec id="s4c">
<title>Model implementation for example tasks</title>
<p><italic>Supervised Hebbian learning</italic> We simulated a single-layer feedforward network with a population of <italic>N</italic> input units (activity denoted by <bold>x</bold>) and a single output unit, (activity denoted by <italic>ŷ</italic>), connected with a 1 <italic>×</italic> N binary weight matrix <bold>W</bold>, such that <italic>ŷ</italic> = <bold>Wx</bold>. In each simulation, a set of <italic>P</italic> = 20 reliable stimuli were randomly generated, which corresponded to binary <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline9.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> random <italic>N</italic> - dimensional activity patterns in the input units. Note that due to the scaling of the inputs and use of binary synaptic weights, the activity <italic>ŷ</italic> is constrained to lie in the interval [−1, 1]. Each reliable stimulus was associated with a randomly chosen (but consistent across the simulation) label <italic>y</italic>, 1 or <italic>−</italic>1. At each time step one of the reliable stimuli (along with its label) was presented to the network with probability <italic>λ</italic><sub><italic>i</italic></sub> = 0.01 for all <italic>i</italic> = 1, …, <italic>P</italic>. Otherwise (with probability 1 – ∑<sub><italic>i</italic></sub> <italic>λ</italic><sub><italic>i</italic></sub>), a randomly sampled unreliable stimulus was presented with a randomly chosen label. Weights experienced candidate potentiation or depression events given by a Hebbian learning rule Δ<italic>W</italic> = <italic>y</italic><bold>x</bold><sup><italic>T</italic></sup>, corresponding to the product of the binary input neuron activity and the corresponding label. Learning followed the binary switch rule with <italic>p</italic> = 0.1; that is, candidate potentiation events resulted in potentiation with probability <italic>p</italic>, and likewise for depression events. At each timestep the product of the STM output and the ±1 label was computed, and if it exceeded the consolidation threshold <italic>θ</italic> = 0.125, plasticity was permitted in the LTM network.</p>
<sec id="s4c1">
<title>Reinforcement learning</title>
<p>We used the same setup as in the supervised learning task, with the following modifications. The activity of the output unit (denoted by <italic>π</italic> in this problem) represented the probabiliy of taking one of two possible actions: <italic>p</italic>(<italic>a</italic><sub>1</sub>) = <italic>π</italic> and <italic>p</italic>(<italic>a</italic><sub>2</sub>) = 1 −<italic>π</italic>. Each reliable stimulus was associated with a correct action. Taking the correct action yielded a reward of <italic>r</italic> = 1, while taking the other action yielded a reward of <italic>r</italic> = −1. Plasticity events followed the following three-factor learning rule: Δ<italic>W</italic> = (<italic>r ·a</italic>)<bold>x</bold><sup><italic>T</italic></sup>. At each timestep the product of the STM action probability and the reward was computed, and if it exceeded the consolidation threshold <italic>θ</italic> = 0.75, plasticity was permitted in the LTM network. For all plasticity we used the binary switch rule with <italic>p</italic> = 1.0.</p>
</sec>
<sec id="s4c2">
<title>Unsupervised Hebbian learning</title>
<p>We simulated two recurrent neural networks with <italic>N</italic> = 1000 binary units each and with binary recurrent weight matrices <bold>W</bold><sub>STM</sub> and <bold>W</bold><sub>LTM</sub>, respectively. Memories consisted of binary (entries equal to <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline10.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>) random <italic>N</italic> -dimensional vectors that provided direct input <bold>x</bold> to the network units at each timestep. The network state <bold>h</bold> evolved for <italic>T</italic> = 5 timesteps according to the following dynamics equation
<disp-formula id="eqn7">
<alternatives><graphic xlink:href="519638v3_eqn7.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>ϕ</italic> is a binary threshold nonlinearity with threshold set so that 50 percent of units were active at each time step (corresponding to a mechanism that normalizes activity across the network). The weights <bold>W</bold> of the network were binary and initialized as binary random variables with equal on/off probability. The network weights <italic>W</italic><sub><italic>ij</italic></sub> were subjected to potentiation events when <italic>x</italic><sub><italic>i</italic></sub> and <italic>x</italic><sub><italic>j</italic></sub> were both active at <italic>t</italic> = 0, and otherwise subjected to depression events. Synaptic updates followed the binary switch rule with probability <italic>p</italic> = 1.0.</p>
<p>Additionally, a set of <italic>N</italic> weights <bold>u</bold> connected the STM units to a single readout unit that measured familiarity. These weights were also binary and experienced candidate potentiation/depression events when their corresponding unit was active/inactive, respectively. These weights followed the binary switch rule with probability <italic>p</italic> = 1.0.</p>
<p>Plasticity in the LTM proceeded according to the same rule as in the STM but was gated by recall strength <italic>r</italic> = <bold>u</bold> <italic>·</italic> <bold>x</bold><sub>STM</sub>, according to a threshold function with threshold equal to 0.25.</p>
<p>The performance of the network was determined by presenting noise-corrupted versions of the reliable memory and measuring the correlation between the network state and the uncorrupted memory after <italic>T</italic> = 5 time steps. The corrupted patterns were obtained by adding Gaussian noise of variance <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline11.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> to the ground-truth pattern, and binarizing the result by choosing the fraction 0.5 of units with the highest values to be active.</p>
</sec>
</sec>
<sec id="s4d">
<title>Forgetting curves for different synaptic learning rules</title>
<p>Prior work (<xref ref-type="bibr" rid="c18">Fusi et al., 2005</xref>; <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>) has considered environments in which a given memory is presented to the system only once. In this case, the performance of a single population of synapses with a given learning rule depends crucially on the memory trace function <italic>m</italic>(<italic>t</italic>). This is defined as
<disp-formula id="eqn8">
<alternatives><graphic xlink:href="519638v3_eqn8.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
the recall SNR at time <italic>t</italic> for a memory <bold>Δw</bold> presented at <italic>t</italic> = 0, assuming randomly sampled memories <underline>ha</underline>ve been presented in the intervening timesteps. For the binary switch model, <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline12.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> More sophisticated synaptic models, like the cascade and multivariable models, can achieve power-law scalings (<xref ref-type="bibr" rid="c18">Fusi et al., 2005</xref>; <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>). The key feature of these models that enables power-law forgetting is that their synapses maintain additional information besides their weight, which encodes their propensity to change state. In this fashion, memories can be consolidated at the synaptic level into more stable, slowly decaying traces. The cascade model of Fusi et al. achieves
<disp-formula id="eqn9">
<alternatives><graphic xlink:href="519638v3_eqn9.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
for some characteristic timescale <italic>T</italic> which can be chosen as a model parameter. Hence, its performance is upper bounded by
<disp-formula id="eqn10">
<alternatives><graphic xlink:href="519638v3_eqn10.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
The model of Benna and Fusi can achieve
<disp-formula id="eqn11">
<alternatives><graphic xlink:href="519638v3_eqn11.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
which is upper bounded by
<disp-formula id="eqn12">
<alternatives><graphic xlink:href="519638v3_eqn12.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Benna and Fusi also show that <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline13.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> scaling is an upper bound on the performance of any synapse model with finite dynamic range.</p>
</sec>
<sec id="s4e">
<title>Implementation of SNR and learnable timescale computations</title>
<p>To compute recall strengths associated with single synaptic populations, we first sampled interarrival intervals <italic>I</italic> from the environmental statistics <italic>p</italic>(<italic>I</italic>). Given a number of repetitions <italic>R</italic>, we computed then computed recall strength samples <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline14.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, where <italic>m</italic> is the forgetting curve associated with the underlying synaptic learning rule, and <italic>I</italic><sub><italic>i</italic></sub> are independent samples from <italic>p</italic>(<italic>I</italic>). We scaled recall strengths by a factor of <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline15.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> to compute the recall SNR(an approximation that is exact in the large-<italic>N</italic> limit).</p>
<p>To compute recall strengths associated with the recall-gated consolidation model, we repeated the above procedure using a new interarrival distribution <italic>p</italic>(<italic>I</italic><sub><italic>LTM</italic></sub>) induced by the gating model. The induced distribution <italic>I</italic><sub><italic>LTM</italic></sub> is obtained by drawing as samples the lengths of intervals between consecutive interarrival interval samples for which the corresponding recall SNR in the STM exceeds the gating threshold <italic>θ</italic> (corresponding to the interval between consolidated reliable memory presentations), and rescaling it by the fraction of unreliable memories that are consolidated. Strictly speaking, in the general case this distribution is nonstationary, as the probability of STM recall exceeding the threshold can change as synaptic updates accumulate across repetitions for sophisticated synapse models like that of <xref ref-type="bibr" rid="c7">Benna and Fusi (2016)</xref>. We adopt a conservative approximation that ignores such effects and thus slightly underestimates the rate of consolidation when such synaptic models are used (and consequently underestimates the SNR and learnable timescale of the recall-gated consolidation model). With this approximation, the random variable <italic>I</italic><sub><italic>LTM</italic></sub> is defined as as the following mixture distribution
<disp-formula id="eqn13">
<alternatives><graphic xlink:href="519638v3_eqn13.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where each <italic>I</italic><sub><italic>i</italic></sub> <italic>∼p</italic>(<italic>I</italic>), <italic>ζ</italic><sub><italic>t</italic></sub> <italic>∼N</italic> (0, 1), and <italic>q</italic> indicates the probability of a reliable memory presentation inducing consolidation. The value of <italic>j</italic> corresponds to the number of reinforcements that go by between instances of consolidation. For sufficiently large <italic>τ</italic> this distribution can be approximated by
<disp-formula id="eqn14">
<alternatives><graphic xlink:href="519638v3_eqn14.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where Φ is the CDF of the standard normal distribution. For large <italic>N</italic>, the probability of consolidation <italic>q</italic> = <italic>P</italic> (<italic>I &lt; m</italic><sup><italic>−</italic>1</sup>(<italic>θ</italic>)).</p>
<p>We note that for an exponential interarrival distribution with mean <italic>τ</italic>, the induced distribu-tion of <italic>I</italic> <sub><italic>LTM</italic></sub> is also exponential, with mean <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline16.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> This is because the sums 1<italic>−</italic>Φ(<italic>θ</italic>) of <italic>j</italic> independent samples <italic>I</italic><sub><italic>i</italic></sub> are distributed according to a Gamma distribution with shape parameter <italic>j</italic>, and the mixture of such Gamma distributions with geometrically distributed mixture weights <italic>p</italic>(<italic>j</italic>) = <italic>q</italic>(1 <italic>− q</italic>)<sup><italic>j−</italic>1</sup> is itself an exponential distribution with mean <italic>τ/q</italic>.</p>
<p>For a given number of expected memory repetitions <italic>R</italic>, the gating threshold <italic>θ</italic> was set such that at least one of the <italic>R</italic> repetitions would be consolidated with probability 1 −<italic>ϵ, ϵ</italic> = 0.1. Where <italic>R</italic> is not reported, we assume it equal to 2, the minimum number of repetitions for the notion of consolidation to be meaningful in our model.</p>
<p>To compute learnable timescales, we repeated the above SNR computations over a range of mean interarrival times <italic>τ</italic> = 𝔼 [<italic>I</italic>], keeping the interarrival distribution family (Weibull distributions with a fixed value of <italic>k</italic>, see below) constant. We report the maximum value of <italic>τ</italic> for which the SNR exceeds the designated target threshold with probability 1 <italic>− ϵ, ϵ</italic> = 0.1.</p>
<p>Throughout, for our interarrival distributions we use Weibull distributions with regularity parameter <italic>k</italic>. The corresponding cumulative distribution function is
<disp-formula id="eqn15">
<alternatives><graphic xlink:href="519638v3_eqn15.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Where <italic>τ</italic> = 𝔼 [<italic>I</italic>], and Γ is the Gamma function. In the case <italic>k</italic> = 1, this reduces to an 35 exponential distribution of interarrival intervals, which corresponds to memory reinforcements that occur according to a Poisson process with rate <italic>λ</italic> = 1<italic>/τ</italic>. In the limit <italic>k → ∞</italic>, it corresponds to interarrival intervals of deterministic length <italic>τ</italic>. For <italic>k &lt;</italic> 1, the interarrival distribution is “bursty,” with periods of dense reinforcement separated by long gaps.</p>
</sec>
<sec id="s4f">
<title>Spacing effect simulations</title>
<p>We simulated the multivariable synapse model of Benna and Fusi (<xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>), in which each synapse is described by <italic>m</italic> continuous-valued dynamical variables <italic>u</italic><sub>1</sub>, …, <italic>u</italic><sub><italic>m</italic></sub> which evolve as follows:
<disp-formula id="eqn16">
<alternatives><graphic xlink:href="519638v3_eqn16.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
For the first variable <italic>u</italic><sub>1</sub>, in place of <italic>u</italic><sub><italic>i−</italic>1</sub> we substitute components Δ<italic>w</italic><sub><italic>j</italic></sub> of the memory traces. For the last variable <italic>u</italic><sub><italic>m</italic></sub>, in place of <italic>u</italic><sub><italic>i</italic>+1</sub> we substitute 0. The strength of each synapse corresponds to the value of its first dynamical variable. For our simulations we chose <italic>m</italic> = 10 dynamical variables, <italic>n</italic> = 2, <italic>α</italic> = 0.5, and <italic>N</italic> = 400 synapses. The value of <italic>α</italic> is also varied in <xref rid="figS6" ref-type="fig">Fig. S6</xref>. A spacing interval Δ was selected and a randomly drawn reliable memory was presented at Δ-length intervals (the same pattern at each presentation). In the case without intervening memories, the dynamics of each synapse ran unimpeded between these presentations. In the case with intervening memories, new randomly drawn patterns were presented to the system at each timestep between the reliable memory presentations. Each pattern was drawn with values equal to <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline17.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, with equal probability.</p>
</sec>
<sec id="s4g">
<title>Generalized model with multiple memory timescales</title>
<p>In our generalized environment model, the environment contains a variety of distinct reliable memories <italic>x</italic><sub><italic>i</italic></sub> which recur with Poisson statistics at a variety of rates <italic>λ</italic><sub><italic>i</italic></sub>. Timescales <italic>τ</italic><sub><italic>i</italic></sub> = 1<italic>/λ</italic><sub><italic>i</italic></sub> are distributed as <italic>p</italic>(log <italic>τ</italic>) ∼ [0, <italic>A</italic>] where <italic>A</italic> is a large constant. This corresponds to the value of log <italic>λ</italic> being uniformly distributed in [−<italic>A</italic>, 0], or equivalently to <italic>p</italic>(<italic>λ</italic>) ∼1<italic>/λ</italic> and bounded between <italic>e</italic><sup><italic>−A</italic></sup> and 1. The environment also contains an additional fraction of unreliable memories as before, sampled randomly and presented with a fixed probability at each timestep. The natural generalization of learnable timescale to this setting is the maximum interarrival interval timescale for which the lifetime of a corresponding memory (the time following last reinforcement its recall strength decays to an SNR below the target SNR) exceeds that timescale.</p>
<p>The distribution of interarrival intervals for memory <italic>i</italic> is
<disp-formula id="eqn17">
<alternatives><graphic xlink:href="519638v3_eqn17.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Integrating across the distribution of <italic>λ</italic>, we get the distribution of interarrival intervals for reliable memories observed by the system:
<disp-formula id="eqn18">
<alternatives><graphic xlink:href="519638v3_eqn18.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
for large <italic>I</italic>.</p>
<p>The full distribution of interval strengths (including unreliable memories) is a mixture of <italic>p</italic><sub>reliable</sub> and a delta function at <italic>I</italic> = ∞, with the latter’s weight corresponding to the probability with which an unreliable memory is sampled at a given timestep (in our simulations we chose 0.9).</p>
<p>From here we can compute a distribution of STM recall strengths <italic>r</italic>
<disp-formula id="eqn19">
<alternatives><graphic xlink:href="519638v3_eqn19.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
We simulated a model in which an ensemble of LTM subpopulations are assigned gating functions <italic>g</italic><sub><italic>i</italic></sub>(<italic>r</italic>) equal 1 for log <italic>r ∈</italic> [<italic>A</italic><sub><italic>i</italic></sub>, <italic>A</italic><sub><italic>i</italic>+1</sub>] and 0 elsewhere, with the <italic>A</italic><sub><italic>i</italic></sub> spaced evenly over <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline18.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. The expected lifetime of a memory reinforced with a given interval <italic>I</italic> <sup><italic>′</italic></sup> is given approximately by the STM lifetime divided by the fraction of memory presentations for which the recall strength lies in the same interval as <italic>m</italic>(<italic>I</italic> <sup><italic>′</italic></sup>). This quantity reflects the proportion of memories presentations that are consolidated into the same LTM subpopulation as the memory in question.</p>
</sec>
</sec>
<sec id="s5">
<title>Supplemental Figures</title>
<fig id="figS1" position="float" fig-type="figure">
<label>Supplemental Figure S1:</label>
<caption><p>A. Same as <xref rid="fig4" ref-type="fig">Fig. 4A</xref>, also varying the presentation rate <italic>λ</italic> of reliable memories. B. Same as <xref rid="fig4" ref-type="fig">Fig. 4B</xref>, also varying the presentation rate <italic>λ</italic> of reliable memories.</p></caption>
<graphic xlink:href="519638v3_figS1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Supplemental Figure S2:</label>
<caption><p>A. Same as <xref rid="fig4" ref-type="fig">Fig. 4C</xref>, also varying the underlying synaptic learning rule. B. Same learnable timescale information as panel <italic>A</italic>, presented as a function of the synaptic population size <italic>N</italic>.</p></caption>
<graphic xlink:href="519638v3_figS2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Supplemental Figure S3:</label>
<caption><p>Same as <xref rid="fig2" ref-type="fig">Fig. 2C</xref>, but with multiple reliable memories simultaneously learned, each recurring equally often at a rate <italic>λ</italic><sub><italic>i</italic></sub> = 0.01 for all reliable memories <italic>i</italic>. Here <italic>N</italic> = 10<sup>5</sup> synapses, and the STM and LTM learning rates are 0.05 and 0.01, respectively. In the recall-gated model, the gating threshold is set at <italic>θ</italic> = 2<sup><italic>−</italic>7</sup>. Each plot corresponds to a different number <italic>P</italic> of reliable memories being stored (the SNR shown is averaged across the reliable memories). The behavior of the SNR of an individual reliable memory is approximately the same as in the single-memory case for small values of <italic>λ</italic><sub><italic>tot</italic></sub> but diverges from it when <italic>λ</italic><sub><italic>tot</italic></sub> grows large.</p></caption>
<graphic xlink:href="519638v3_figS3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Supplemental Figure S4:</label>
<caption><p>Same information as <xref rid="fig4" ref-type="fig">Fig. 4G</xref>, varying the population size <italic>N</italic> and the desired <italic>SNR</italic>.</p></caption>
<graphic xlink:href="519638v3_figS4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Supplemental Figure S5:</label>
<caption><p>Same information as <xref rid="fig4" ref-type="fig">Fig. 4H</xref>, varying the population size <italic>N</italic> and the desired <italic>SNR</italic></p></caption>
<graphic xlink:href="519638v3_figS5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Supplemental Figure S6:</label>
<caption><p>Same information as <xref rid="fig5" ref-type="fig">Fig. 5C</xref>, varying the learning rate (scale of potentiation/depression impulses, relative to the maximum/minimum threshold values in the model of <xref ref-type="bibr" rid="c7">Benna and Fusi (2016)</xref>), and the length of time following spaced training at which the system’s recall SNR is evaluated.</p></caption>
<graphic xlink:href="519638v3_figS6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS7" position="float" fig-type="figure">
<label>Supplemental Figure S7:</label>
<caption><p>Same as <xref rid="fig5" ref-type="fig">Fig. 5D</xref> (top row) and <xref rid="fig5" ref-type="fig">Fig. 5F</xref> (bottom row), for different population sizes <italic>N</italic>.</p></caption>
<graphic xlink:href="519638v3_figS7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS8" position="float" fig-type="figure">
<label>Supplemental Figure S8:</label>
<caption><p>Same as <xref rid="fig5" ref-type="fig">Fig. 5D</xref> (top row) and <xref rid="fig5" ref-type="fig">Fig. 5F</xref> (bottom row), for different memory recurrence regularity factors (Weibull distribution parameter <italic>k</italic>).</p></caption>
<graphic xlink:href="519638v3_figS8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS9" position="float" fig-type="figure">
<label>Supplemental Figure S9:</label>
<caption><p>SNR as a function of repetitions for single populations without consolidation, varying the parameter <italic>k</italic> of the Weibull distribution governing interarrival times (and defining the learnable timescale in terms of the expected interarrival time). The behavior of the systems scales similarly for diverse values of <italic>k→ ∞</italic>, justifying the use of the deterministic approximation <italic>k</italic> for theoretical calculations. The learning rate for the binary model here is set at 0.1.</p></caption>
<graphic xlink:href="519638v3_figS9.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s5a">
<title>Supplementary Information</title>
<sec id="s5a1">
<title>Derivation of recall strength quantity for specific plasticity rules</title>
<p>In the following derivations, we make heavy use of the fact that the elementwise dot product <bold>W</bold><sub>1</sub> <italic>·</italic> <bold>W</bold><sub>2</sub> between two matrices is equal to <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline19.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>.</p>
</sec>
<sec id="s5a2">
<title>Supervised Hebbian learning</title>
<p>Let <bold>x</bold> be the input population activity, <bold>W</bold> be the prediction weights, <bold>ŷ</bold> = <bold>Wx</bold> the output population activity (predicted probabilities), and <bold>y</bold> indicate ground-truth target values. For a plasticity rule Δ<bold>W</bold> = <bold>yx</bold><sup><italic>T</italic></sup>, the recall strength <italic>r</italic> = <bold>W</bold> <italic>·</italic> Δ<bold>W</bold> can be written as
<disp-formula id="eqn20">
<alternatives><graphic xlink:href="519638v3_eqn20.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
corresponding to the accuracy of the prediction <bold>ŷ</bold>.</p>
<p>If instead plasticity is driven by the delta rule, Δ<italic>W</italic><sub><italic>ij</italic></sub> = (<italic>y</italic><sub><italic>i</italic></sub> <italic>−ŷ</italic><sub><italic>i</italic></sub>)<italic>x</italic><sub><italic>j</italic></sub>, the recall factor becomes (<bold>y ·ŷ</bold>) −||<bold>ŷ</bold>|| <sup>2</sup>, which assuming normalized activity is simply an offset measure of prediction accuracy. In either case, the computation of the recall factor requires an explicit comparison of predictions to ground truth labels.</p>
</sec>
<sec id="s5a3">
<title>Reinforcement learning</title>
<p>Let <bold>x</bold> be the input population activity representing state information, <bold>W</bold> be the output weights, <bold><italic>π</italic></bold> = <bold>Wx</bold> be the output population activity representing log probabilities of taking a given action, <bold>a</bold> be a vector indicating the sampled action, and <italic>r</italic> = 1 be the scalar reward that results. For a plasticity rule Δ<bold>W</bold> = <italic>r ·</italic> (<bold>ax</bold><sup><bold>T</bold></sup>), the recall strength <italic>r</italic> = <bold>W ·</bold>Δ<bold>W</bold> can be written as
<disp-formula id="eqn21">
<alternatives><graphic xlink:href="519638v3_eqn21.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Following the same steps as the derivation for the supervised learning case, with <bold>a</bold> in place of <bold>y</bold>, gives
<disp-formula id="eqn22">
<alternatives><graphic xlink:href="519638v3_eqn22.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
corresponding to the confidence with which the action <bold>a</bold> was selected, modulated by reward.</p>
<p>Computing this factor requires preserving the network’s action probability distribution, extracting from it the probability of the sampled action, and multiplicatively scaling the result by the obtained reward.</p>
</sec>
<sec id="s5a4">
<title>Autoassociative memory</title>
<p>Let <bold>x</bold> be the population activity and <bold>W</bold> be the recurrent weight matrix. If Δ<bold>W</bold> = <bold>xx</bold><sup><italic>T</italic></sup>, and the weight matrix <bold>W</bold> can be written as a sum <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline20.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> over prior plasticity-driven updates, then the recall strength <italic>r</italic> = <bold>W</bold> <italic>·</italic> Δ<bold>W</bold> can be written as
<disp-formula id="eqn23">
<alternatives><graphic xlink:href="519638v3_eqn23.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
corresponding the familiarity of the current pattern <bold>x</bold> relative to all previously seen patterns <bold>x</bold><sub><italic>i</italic></sub>.</p>
<p>Familiarity also be computed with a separate familiarity readout trained alongside the recurrent weights. If the familiarity readout employs a Hebbian rule, the resulting estimate of familiarity will be equal to
<disp-formula id="eqn24">
<alternatives><graphic xlink:href="519638v3_eqn24.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
For uncorrelated patterns in a network below capacity, this strategy corresponds exactly to the true recall factor in the limit of large network size.</p>
</sec>
</sec>
<sec id="s5b">
<title>Relationship between learnable timescale and capacity</title>
<p>We note that theoretical work on memory systems often focuses on memory <italic>capacity</italic>, the number of memories that can be reliably stored in the system (<xref ref-type="bibr" rid="c19">Gardner, 1988</xref>; <xref ref-type="bibr" rid="c18">Fusi et al., 2005</xref>; <xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>). Our learnable timescale metric is distinct from capacity. However, the two are closely linked in a particular regime. Suppose <italic>P</italic> distinct reliable memories are reinforced independently at rates <italic>λ</italic><sub>1</sub>, …, <italic>λ</italic><sub><italic>P</italic></sub>. In the regime in which the overall rate of reliable memory presentation <italic>λ</italic><sub>tot</sub> = Σ<sub><italic>i</italic></sub> <italic>λ</italic><sub><italic>i</italic></sub> is small, the SNR of memory recall for memory <italic>i</italic> will be the same as in the case of a single reliable memory with <italic>λ</italic> = <italic>λ</italic><sub><italic>i</italic></sub> (<xref rid="figS3" ref-type="fig">Fig. S3</xref>). Hence, for a fixed <italic>λ</italic><sub>tot</sub>, and for simplicity assuming that distinct reliable memories are presented at equal rates <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline21.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> for all <italic>i</italic>, the learnable timescale <italic>τ</italic> <sup><italic>∗</italic></sup> of the system dictates its capacity, equal to <italic>τ</italic> <sup><italic>∗</italic></sup><italic>λ</italic><sub>tot</sub>. We note that this correspondence does not hold in the case where most observed memories are reliable. In this work, however, we are interested primarily in the regime of scarce reliability, where recall-gated consolidation provides the most benefit. In this regime, we regard the learnable timescale as the most natural measure of system performance, as the primary obstacle to memory storage is the presence of long gaps between reinforcements of reliable memories.</p>
</sec>
<sec id="s5c">
<title>The effect of repeated reinforcement on memory dynamics without recall-gated consolidation</title>
<p>When memories can recur multiple times, the memory trace function <italic>m</italic>(<italic>t</italic>) is no longer an adequate description of system behavior, as the synaptic updates from multiple presentations can combine. For the synaptic learning rules we consider here – the binary switch, the cascade model of Fusi et al., and the multivariable model of Benna &amp; Fusi, this combination is approximately additive (<xref ref-type="bibr" rid="c7">Benna and Fusi, 2016</xref>). This is because for each of these learning rules, the change in distribution of synaptic states following the presentation of a memory is approximately independent of the existing synaptic state. The only dependencies are saturation effects – synapses which have reached the edge of their dynamic range – which can only lead to sub-additive behavior. Saturation effects can be avoided by making the dynamic range of synapses sufficiently large. Thus for these learning rules of interest we may consider additive memory trace combination to represent a close approximation (and a tight upper bound) on the combined memory trace strength.</p>
<p>For a reliable memory presented at times <italic>t</italic><sub>1</sub>, …, <italic>t</italic><sub><italic>R</italic></sub>, and a population of synapses using additive learning rules, the current SNR at time <italic>t</italic> can therefore be approximated as
<disp-formula id="eqn25">
<alternatives><graphic xlink:href="519638v3_eqn25.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
If memory presentations occur separated by regular intervals of length <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline22.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, we have
<disp-formula id="eqn26">
<alternatives><graphic xlink:href="519638v3_eqn26.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
For the binary switch model, <italic>m</italic>(<italic>t</italic>) decays exponentially with time constant 1<italic>/p</italic>, and so the second term is negligible compared to the first. Hence the learnable timescale of the system is the same as the memory lifetime, approximately 1<italic>/p</italic>. For target SNR threshold <italic>δ</italic>, we require <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline23.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, so the best possible learnable timescale, optimizing over <italic>p</italic>, is <italic>O (</italic><inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline24.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula><italic>)</italic>.</p>
<p>For the cascade model, <italic>m</italic>(<italic>t</italic>) decays as <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline25.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. For <italic>t » T</italic> the exponential factor dominates, resulting in the same behavior as the binary switch model. For <italic>t «T</italic>, the exponential term approximately vanishes, so the following expression for SNR(<italic>t</italic>) is a close approximation and tight upper bound:
<disp-formula id="eqn27">
<alternatives><graphic xlink:href="519638v3_eqn27.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Again, for computing learnable timescale we are interested in when <italic>t −t</italic><sub><italic>R</italic></sub> <italic>≈τ</italic>, in which case:
<disp-formula id="eqn28">
<alternatives><graphic xlink:href="519638v3_eqn28.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
For the multivariable model, <italic>m</italic>(<italic>t</italic>) decays as <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline26.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. Again we are primarily interested in the <italic>t « T</italic> regime, in which the expression for SNR(<italic>t</italic>) is approximately
<disp-formula id="eqn29">
<alternatives><graphic xlink:href="519638v3_eqn29.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
This SNR is maximized for <italic>T ≈ R · τ</italic>. And for computing learnable timescale we are interested in when <italic>t − t</italic><sub><italic>R</italic></sub> <italic>≈ τ</italic>. So we have
<disp-formula id="eqn30">
<alternatives><graphic xlink:href="519638v3_eqn30.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
To compute the learnable timescale at target SNR <italic>δ</italic> for 1 <italic>« R « τ</italic>, we have 4<italic>NR ≥τ</italic> log(<italic>Rτ</italic>)<italic>δ</italic><sup>2</sup>, the solution of which is within logarithmic factors of <italic>O</italic>(<italic>RN</italic>).</p>
<p>The above calculations assume deterministic interarrival intervals of length <italic>τ</italic>. In general, we are interested in an interarrival distribution <italic>p</italic>(<italic>I</italic>) with mean <italic>τ</italic>. However, we show numerically that for Weibull distributions with reasonable values of <italic>k</italic> (not too close to zero), the true learnable timescale figures are very bounded very closely to our results above (<xref rid="figS9" ref-type="fig">Fig. S9</xref>). Moreover, for the purpose of computing learnable timescale <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline27.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> with error probability tolerance <italic>∈</italic>, for sufficiently small <italic>E</italic> the deterministic approximation represents an upper bound on the SNR for distributions with mean <italic>τ</italic>. This is because to ensure high SNR with very high probability, deterministic intervals are a best case scenario, as stochastic interval lengths will with some nonzero probability deviate far above the mean.</p>
</sec>
<sec id="s5d">
<title>Bounds on an ideal synaptic consolidation model</title>
<p>In this section we show that no realistic synapse-local mechanism can achieve significantly better learnable timescale than (<italic>RN</italic>), and hence that the ability of recall-gated systems consolidation to achieve learnable timescale scaling superlinearly with <italic>R</italic> in some environments (see previous section) represents a qualitative advantage.</p>
<p>We consider a very general class of synaptic learning rules. In particular, we suppose a synapse can main tain a history of sequences of potentiation and depression events for arbitrarily long time windows and track the number of windows for which Δ, the difference in number of potentiation and depression events, exceeds a threshold <italic>δ</italic>. Let <italic>p</italic><sub><italic>reliable</italic></sub>(Δ; <italic>τ</italic>) refer to the probability distribution of values of Δ after <italic>τ</italic> timesteps, given that a synapse is potentiated by the reliable memory of interest – and <italic>p</italic><sub><italic>unreliable</italic></sub> refers to the analogous distribution for synapses subject only to potentiation by unreliable memories. After <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline27a.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> intervals of length <italic>τ</italic>, for a synapse potentiated by the reliable memory, we have that
<disp-formula id="eqn31">
<alternatives><graphic xlink:href="519638v3_eqn31.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
The memory can be considered retrievable with SNR of order 𝒪 (1) once the expression above exceeds <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline28.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> (since evidence can be accumulated across the <italic>N</italic> synapses) for any choice of <italic>τ</italic> (since we are interested in the best achievable performance).</p>
<p>Now, for large enough <italic>τ, p</italic><sub>unreliable</sub>(Δ; <italic>τ</italic>) is approximately Gaussian with mean 0 and standard deviation.<inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline29.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> Conditioned on the reliable memory being presented <italic>r</italic> times in <italic>τ</italic> timesteps, <italic>p</italic><sub>reliable</sub>(Δ) is approximately Gaussian with mean <italic>r</italic> and standard deviation <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline30.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. The KL divergence between these two distributions is <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline31.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. Now consider the distribution <italic>p</italic> (<italic>r</italic>) of number of repetitions <italic>r</italic> that occur in a time window <italic>τ</italic>. We want to find a value <italic>r</italic><sup>max</sup> such that.<inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline32.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> From there we can assume that <italic>r &lt; r</italic><sup>max</sup> in any of the <italic>τ</italic> -length intervals, since after <italic>T</italic> timesteps we cannot reliably count on <italic>r</italic> exceeding <italic>r</italic><sup>max</sup> in any of the intervals.</p>
<p>For <italic>τ ≤ M</italic> [<italic>I</italic>], the median of the distribution <italic>p</italic>(<italic>I</italic>), note that <italic>r</italic><sup>max</sup> <italic>≤</italic> log(<italic>T/τ</italic>) <italic>≤</italic> log <italic>T</italic>. For <italic>τ ≤ c·M</italic> [<italic>I</italic>], if <italic>R &gt; c</italic> log <italic>T</italic> then at least one interval of less than length <italic>M</italic> [<italic>I</italic>] contains at least log <italic>T</italic> repetetions. Hence <italic>r</italic><sup>max</sup> <italic>≤ c</italic> log <italic>T</italic>. So conservatively we can take <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline33.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>.</p>
<p>Thus, our log probability expression above is bounded as follows
<disp-formula id="ueqn1">
<alternatives><graphic xlink:href="519638v3_ueqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Hence the KL divergence criterion becomes
<disp-formula id="eqn32">
<alternatives><graphic xlink:href="519638v3_eqn32.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
or equivalently,
<disp-formula id="eqn33">
<alternatives><graphic xlink:href="519638v3_eqn33.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
The number of repetitions is <italic>R ≈ T/</italic>𝔼 [<italic>I</italic>], giving
<disp-formula id="eqn34">
<alternatives><graphic xlink:href="519638v3_eqn34.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn35">
<alternatives><graphic xlink:href="519638v3_eqn35.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
assuming <italic>M</italic> [<italic>I</italic>] ∼<italic>O</italic>(𝔼 [<italic>I</italic>]). For the interarrival distributions we consider (of the Weibull family), <italic>M</italic> [<italic>I</italic>] <italic>&lt;</italic> 𝔼 [<italic>I</italic>] so this is a conservative assumption. Hence the learnable timescale of any population using only synapse-local learning rules is no greater than the solution for 𝔼 [<italic>I</italic>] of the equation above. We have
<disp-formula id="eqn36">
<alternatives><graphic xlink:href="519638v3_eqn36.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
the solution of which is within logarithmic factors of <italic>𝒪</italic>(<italic>RN</italic>).</p>
</sec>
<sec id="s5e">
<title>Scaling behavior of the STM/LTM model</title>
<p>In the recall-gated consolidation model, the overlap <italic>r</italic> = <bold>w</bold><sub>STM</sub> ·<bold>Δw</bold><sub>STM</sub> indicates the recall strength of memory <italic>x</italic> given the current synaptic state of the STM. LTM plasticity is modulated by a factor <italic>g</italic>(<italic>r</italic>) – we refer to <italic>g</italic> as the “gating function” and <italic>r</italic> as the STM recall strength. We assume for now that the gating function <italic>g</italic>(<italic>r</italic>) is chosen to be a threshold function, <italic>g</italic>(<italic>r</italic>) = <italic>H</italic>(<italic>r −θ</italic>), where <italic>r</italic> is the SNR of the memory overlap, <italic>H</italic> is the Heaviside step function, and <italic>θ</italic> is referred to as the “consolidation threshold.” With this choice, unreliable memories will be consolidated at a rate of 1 −Φ(<italic>θ</italic>), where Φ is the CDF of the normal distribution, in the limit of large system size <italic>N</italic>.</p>
<p>Suppose a memory <bold>Δw</bold> is presented twice with interval <italic>I</italic>. Then the SNR at the second presentation will be lower-bounded by <italic>m</italic>(<italic>I</italic>), in expectation. It follows that the rate at which reliable memories will be consolidated at for the gating function above is lower bounded by <italic>P</italic> (<italic>I &lt; m</italic><sup><italic>−</italic>1</sup>(<italic>θ</italic>)). After <italic>R</italic> repetitions of the reliable memory, the probability that consolidation has occurred will be at least
<disp-formula id="eqn37">
<alternatives><graphic xlink:href="519638v3_eqn37.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
We are interested in the maximum <italic>θ</italic> for which this expression exceeds 1 −<italic>ϵ</italic> – this is the most stringest consolidation threshold we can set while still ensuring consolidation of the reliable memory with high probability. This value of <italic>θ</italic> is given by
<disp-formula id="eqn38">
<alternatives><graphic xlink:href="519638v3_eqn38.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
If <italic>R</italic> is large then the solution will be such that <italic>P</italic> (<italic>I &lt; m</italic><sup><italic>−</italic>1</sup>(<italic>θ</italic>) is small, enabling the approximation:
<disp-formula id="eqn39">
<alternatives><graphic xlink:href="519638v3_eqn39.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
For tractability we consider, as our family of interarrival distributions, Weibull distributions with regularity parameter <italic>k</italic>. The cumulative distribution function is
<disp-formula id="eqn40">
<alternatives><graphic xlink:href="519638v3_eqn40.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
For <italic>t &lt;&lt; τ</italic>, this is approximated as
<disp-formula id="eqn41">
<alternatives><graphic xlink:href="519638v3_eqn41.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Importantly, <italic>P</italic> (<italic>I ≤t</italic>) decays as <italic>t</italic><sup><italic>k</italic></sup>. Thus, increasing the number of repetitions <italic>R</italic> has the effect of scaling the <italic>τ</italic> that satisfies <xref ref-type="disp-formula" rid="eqn39">Equation 39</xref> by <italic>R</italic><sup>1<italic>/k</italic></sup>. That is, for a fixed <italic>θ</italic>, and hence a fixed degree of amplification <italic>τ</italic><sub><italic>LTM</italic></sub> <italic>/τ</italic> of the effective rate of reliable memories in the LTM, the maximum <italic>τ</italic> achieving that SNR with probability 1 <italic>− ϵ</italic> (i.e. the learnable timescale <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline34.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>) scales as <italic>𝒪</italic>(<italic>R</italic><sup>1<italic>/k</italic></sup>).</p>
<p>For a gating function threshold <italic>θ</italic>, the corresponding SNR in the LTM will be the SNR induced by an interarrival distribution <italic>I</italic><sub>LTM</sub> with mean value
<disp-formula id="eqn42">
<alternatives><graphic xlink:href="519638v3_eqn42.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Since 1 <italic>−</italic> Φ(<italic>θ</italic>) decays much more rapidly than any power of <italic>m</italic><sup><italic>−</italic>1</sup>(<italic>θ</italic>), <underline>it</underline> follows that E [<italic>I</italic><sub><italic>LTM</italic></sub>] can be made <italic>O</italic>(1), and thus the SNR of the LTM can become <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline35.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, for relatively small values of <italic>θ</italic> (and hence a small number of required repetitions). In other words, for a fixed number of expected memory repetitions, the learnable<underline>t</underline>imescale of the LTM decreases only slightly as the target SNR is raised from <italic>O</italic>(1) to <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline36.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>.</p>
<p>Note that if <italic>P</italic> different reliable memories are present, then 𝔼 [<italic>I</italic><sub><italic>LTM</italic></sub>] for any given reliable memory will be lower-bounded by <italic>𝒪</italic>(<italic>P</italic>) instead of <italic>𝒪</italic>(1). The induced SNR for<underline>a</underline>ny given reliable memory in the LTM will in this case be of order <italic>m</italic>(<italic>P</italic>), rather than <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline37.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>.</p>
</sec>
<sec id="s5f">
<title>Optimal sparsity calculations</title>
<p>We now consider the case of sparse memories – those which potentiate a fraction <italic>f</italic> of synapses. Consider the behavior of a single population of binary synapses employing the binary switch plasticity rule. We modify the plasticity rule slightly so that potentiation flips the state of a synapse with probability <italic>p</italic> and depression with probability <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline38.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, to ensure that the fractions of potentiated and depressed synapses remain balanced.</p>
<p>We consider an environment with a single reliable memory that is presented with probability <italic>λ</italic> at each time step (otherwise, a randomly sampled unreliable memory is presented). We can compute the behavior analytically by tracking how the distributions of <italic>u</italic> (the output neuron response to true stimuli) and <italic>v</italic> (the output neuron response to noise) evolve over time. We assume that the coding level <italic>f</italic> is sufficiently small that terms of order <italic>O</italic>(<italic>f</italic> <sup>2</sup>) may be ignored.</p>
<p>Due to the balanced plasticity rule, <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline39.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> of synapses are strong at any given time, so the mean response <italic>v</italic><sup><italic>∗</italic></sup> to a randomly sampled noise pattern is <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline40.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. The variance of <italic>v</italic> is also constant and equal to <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline41.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>.</p>
<p>The evolution of <italic>u</italic> is a stochastic process that, in the limit of large <italic>Nf</italic> (i.e. a large number of active neurons for each stimulus), can be described as an Ornstein-Uhlenbeck (OU) process:
<disp-formula id="eqn43">
<alternatives><graphic xlink:href="519638v3_eqn43.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>ϵ ∼ N</italic> (0, <italic>σ</italic><sup>2</sup>)</p>
<p>In the limit of small <italic>f</italic> we have:
<disp-formula id="eqn44">
<alternatives><graphic xlink:href="519638v3_eqn44.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn45">
<alternatives><graphic xlink:href="519638v3_eqn45.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
The quantity <italic>u</italic><sup><italic>∗</italic></sup> determines the asymptotic mean of <italic>u</italic> and the quantity <italic>θ</italic> determines the rate at which <italic>u</italic> converges to this mean. Immediately we see that <italic>u</italic><sup><italic>∗</italic></sup> scales with the frequency <italic>λ</italic> with which the true stimulus is presented, and that the rate of convergence (speed of learning) is proportional to <italic>p</italic>.</p>
<p>By well-known properties of OU processes, the asymptotic variance of <italic>u</italic> is equal to <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline42.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. In the small-p limit, this quantity comes out to
<disp-formula id="eqn46">
<alternatives><graphic xlink:href="519638v3_eqn46.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Note that in the low-p limit (slow learning rate) this is the same as the variance of <italic>v</italic>. Thus in the limit of slow learning, we have that
<disp-formula id="eqn47">
<alternatives><graphic xlink:href="519638v3_eqn47.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn48">
<alternatives><graphic xlink:href="519638v3_eqn48.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
And thus
<disp-formula id="eqn49">
<alternatives><graphic xlink:href="519638v3_eqn49.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
From this expression we can see that for a given <italic>f</italic>, the asymptotic SNR always increases with <italic>λ</italic> and <italic>N</italic>. For a given <italic>λ</italic>, we would like to maximize this expression with respect to <italic>f</italic> .
<disp-formula id="eqn50">
<alternatives><graphic xlink:href="519638v3_eqn50.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
This expression equals zero when
<disp-formula id="eqn51">
<alternatives><graphic xlink:href="519638v3_eqn51.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn52">
<alternatives><graphic xlink:href="519638v3_eqn52.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<disp-formula id="eqn53">
<alternatives><graphic xlink:href="519638v3_eqn53.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
so the asymptotic SNR is maximized for <inline-formula><alternatives><inline-graphic xlink:href="519638v3_inline43.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. That is, the optimal coding level is proportional to the frequency with which reliable (as opposed to unreliable) stimuli are observed in the environment.</p>
</sec>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90793.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Gjorgjieva</surname>
<given-names>Julijana</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Technical University of Munich</institution>
</institution-wrap>
<city>Freising</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Fundamental</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>fundamental</bold> work proposes a novel mechanism for memory consolidation where short-term memory provides a gating signal for memories to be consolidated into long-term storage. The work combines extensive analytical and numerical work applied to three different scenarios and provides a <bold>convincing</bold> analysis of the benefits of the proposed model, although some of the analyses are limited to the type of memory consolidation the authors consider (and don't consider), which limits the impact. The work could be revised to include a more thorough comparison to existing models of memory consolidation and a discussion of its limitations, and the revision could also streamline the technical terminology. The work will be of interest to neuroscientists and many other researchers interested in the mechanistic underpinnings of memory.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90793.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors develop a memory consolidation theory utilizing the recall quality in the short-term memory system to decide what to consolidate in the long-term memory (LTM). The theory is based on a set of previously proposed models identifying memories and synaptic weights (without neuronal activity) with an addition of the second set of weights responsible for long-term storage. The rigorous analysis and numerical experiments show that under some assumptions, the long-term system achieves a high signal-to-noise ratio, particularly much higher than concurrently learning or localized in the same synapses LTM.</p>
<p>Strengths:</p>
<p>The authors take on an important problem of designing robust memory consolidation that fits the numerous experimental observations and, to a large extent, they succeed. The proposed solution is general and generalized to multiple contexts. The mathematical treatment is solid and convincing.</p>
<p>Weaknesses:</p>
<p>The presented model seems to be tuned for learning repetitive events. However, single-shot learning, for example, under fear conditioning or if a presented stimulus is astonishing, seems to contradict the proposed framework. I would assume that part of the load could be taken by a reply system that could vigorously replay more surprising events, but it seems to still not exactly match the proposed scheme.</p>
<p>For context, I would like to see the comparison/discussion of the wide range of models on synaptic tagging for consolidation by various types of signals. Notably, studies from Wulfram Gerstner's group (e.g., Brea, J., Clayton, N. S., &amp; Gerstner, W. (2023). Computational models of episodic-like memory in food-caching birds. Nature Communications, 14(1); and studies on surprise).</p>
<p>The models that are taken for comparison with the slow but otherwise identical to STM LTM could be incapable per design. Reducing the probability of switching independently of the previous presentation does not make the system &quot;slow&quot;; instead, it should integrate previous signals (and thus slowly remove independent noise).</p>
<p>The usage of terms and streamlining of writing could be improved for better understanding.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90793.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In the manuscript &quot;Recall-Gated Consolidation: A Model for Learning and Memory in Neural Systems,&quot; the authors suggest a computational mechanism called recall-gated consolidation, which prioritizes the storage of previously experienced synaptic updates in memory. The authors investigate the mechanism with different types of learning problems including supervised learning, reinforcement learning, and unsupervised auto-associative memory. They rigorously analyse the general mechanism and provide valuable insights into its benefits.</p>
<p>Strengths:</p>
<p>The authors establish a general theoretical framework, which they translate into three concrete learning problems. For each, they define an individual mathematical formulation. Finally, they extensively analyse the suggested mechanism in terms of memory recall, consolidation dynamics, and learnable timescales.</p>
<p>The presented model of recall-gated consolidation covers various aspects of synaptic plasticity, memory recall, and the influence of gating functions on memory storage and retrieval. The model's predictions align with observed spaced learning effects.</p>
<p>The authors conduct simulations to validate the recall-gated consolidation model's predictions, and their simulated results align with theoretical predictions. These simulations demonstrate the model's advantages over consolidating any memory and showcase its potential application to various learning tasks.</p>
<p>The suggestion of a novel consolidation mechanism provides a good starting point to investigate memory consolidation in diverse neural systems and may inspire artificial learning algorithms.</p>
<p>Weaknesses:</p>
<p>I appreciate that the authors devoted a specific section to the model's predictions, and point out how the model connects to experimental findings in various model organisms. However, the connection is rather weak and the model needs to make more specific predictions to be distinguishable from other theories of memory consolidation (e.g. those that the authors discuss) and verifiable by experimental data.</p>
<p>While the article extensively discusses the strengths and advantages of the recall-gated consolidation model, it provides a limited discussion of potential limitations or shortcomings of the model, such as the missing feature of generalization, which is part of previous consolidation models. The model is not compared to other consolidation models in terms of performance and how much it increases the signal-to-noise ratio. It is only compared to a simple STM or a parallel LTM, which I understand to be essentially the same as the STM but with a different timescale (so not really an alternative consolidation model). It would be nice to compare the model to an actual or more sophisticated existing consolidation model to allow for a fairer comparison.</p>
<p>The article is lengthy and dense and it could be clearer. Some sections are highly technical and may be challenging to follow. It could benefit from more concise summaries and visual aids to help convey key points.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90793.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In their article &quot;Theory of systems memory consolidation via recall-gated plasticity &quot;, Jack Lindsey and Ashok Litwin-Kumar describe a new model for systems memory consolidation. Their idea is that a short-term memory acts not as a teacher for a long-term memory - as is common in most complementary learning systems - but as a selection module that determines which memories are eligible for long-term storage. The criterion for the consolidation of a given memory is a sufficient strength of recall in the short-term memory.</p>
<p>The authors provide an in-depth analysis of the suggested mechanism. They demonstrate that it allows substantially higher SNRs than previous synaptic consolidation models, provide an extensive mathematical treatment of the suggested mechanism, show that the required recall strength can be computed in a biologically plausible way for three different learning paradigms, and illustrate how the mechanism can explain spaced training effects.</p>
<p>Strengths:</p>
<p>The suggested consolidation mechanism is novel and provides a very interesting alternative to the classical view of complementary learning systems. The analysis is thorough and convincing.</p>
<p>Weaknesses:</p>
<p>The main weakness of the paper is the equation of recall strength with the synaptic changes brought about by the presentation of a stimulus. In most models of learning, synaptic changes are driven by an error signal and hence cease once the task has been learned. The suggested consolidation mechanism would stop at that point, although recall is still fine. The authors should discuss other notions of recall strength that would allow memory consolidation to continue after the initial learning phase. Aside from that, I have only a few technical comments that I'm sure the authors can address with a reasonable amount of work.</p>
</body>
</sub-article>
</article>