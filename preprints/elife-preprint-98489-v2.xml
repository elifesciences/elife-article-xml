<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">98489</article-id>
<article-id pub-id-type="doi">10.7554/eLife.98489</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.98489.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>The Recurrent Temporal Restricted Boltzmann Machine Captures Neural Assembly Dynamics in Whole-Brain Activity</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Quiroz Monnens</surname>
<given-names>Sebastian</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
<xref ref-type="author-notes" rid="n3">¶</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Peters</surname>
<given-names>Casper</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Hesselink</surname>
<given-names>Luuk Willem</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0008-0621-3118</contrib-id>
<name>
<surname>Smeets</surname>
<given-names>Kasper</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
<xref ref-type="author-notes" rid="n2">§</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9106-0356</contrib-id>
<name>
<surname>Englitz</surname>
<given-names>Bernhard</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>bernhard.englitz@donders.ru.nl</email>
</contrib>
<aff id="a1"><label>1</label><institution>Computational Neuroscience Lab, Donders Center for Neuroscience, Radboud University</institution>, <country>Netherlands</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Latham</surname>
<given-names>Peter</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University College London</institution>
</institution-wrap>
<city>London</city>
<country>United Kingdom</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Colgin</surname>
<given-names>Laura L</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Texas at Austin</institution>
</institution-wrap>
<city>Austin</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>†</label><p>These authors contributed equally to this work</p></fn>
<fn id="n2" fn-type="present-address"><label>§</label><p>École Polytechnique Fédérale de Lausanne, Switzerland;</p></fn>
<fn id="n3" fn-type="present-address"><label>¶</label><p>Center for Neurogenomics and Cognitive Research, Vrije Universiteit Amsterdam, Netherlands</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-06-28">
<day>28</day>
<month>06</month>
<year>2024</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2024-10-01">
<day>01</day>
<month>10</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP98489</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-04-18">
<day>18</day>
<month>04</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-02-04">
<day>04</day>
<month>02</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.02.02.578570"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-06-28">
<day>28</day>
<month>06</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.98489.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.98489.1.sa3">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.98489.1.sa2">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.98489.1.sa1">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.98489.1.sa0">Reviewer #3 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Quiroz Monnens et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Quiroz Monnens et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-98489-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>Animal behaviour alternates between stochastic exploration and goal-directed actions, which are generated by the underlying neural dynamics. Previously, we demonstrated that the compositional Restricted Boltzmann Machine (cRBM) can decompose whole-brain activity of larval zebrafish data at the neural level into a small number (∼100-200) of assemblies that can account for the stochasticity of the neural activity (<xref rid="c32" ref-type="bibr">van der Plas et al., eLife, 2023</xref>). Here we advance this representation by extending to a combined stochastic-dynamical representation to account for both aspects using the Recurrent Temporal RBM (RTRBM) and transfer-learning based on the cRBM estimate. We demonstrate that the functional advantage of the RTRBM is captured in the temporal weights on the hidden units, representing neural assemblies, for both simulated and experimental data. Our results show that the temporal expansion outperforms the stochastic-only cRBM in terms of generalisation error and achieves a more accurate representation of the moments in time. Lastly, we demonstrate that we can identify the original time-scale of assembly dynamics by estimating multiple RTRBMs at different temporal resolutions. Together, we propose that RTRBMs are a valuable tool for capturing the combined stochastic and time-predictive dynamics of large-scale data sets.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Updates throughout the manuscript on the basis of reviewer suggestions at eLife</p></fn>
</fn-group>
<fn-group content-type="external-links">
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://gin.g-node.org/vdplasthijs/cRBM_zebrafish_spontaneous_data">https://gin.g-node.org/vdplasthijs/cRBM_zebrafish_spontaneous_data</ext-link>
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>When large groups of neurons exhibit joint activity, they are often assumed to form a functional unit, referred to as a neural assembly (<xref ref-type="bibr" rid="c18">Harris, 2005</xref>). Neural assemblies are thought to form elementary computational units that are essential for cognitive functions such as short-term memory, sensorimotor computation, and decision-making (<xref ref-type="bibr" rid="c18">Harris, 2005</xref>; <xref ref-type="bibr" rid="c19">Hebb, 1949</xref>; <xref ref-type="bibr" rid="c15">Gerstein et al., 1989</xref>). Recent advancements in neuroimaging methods now enable us to study the role of these neural assemblies in more detail. For example, a large breakthrough is the introduction of light-sheet microscopy which enables functional recordings of whole-brain volumes, thereby allowing the study of how complex computation emerges in the brain (<xref ref-type="bibr" rid="c2">Ahrens et al., 2013</xref>). It, however, remains a computational challenge to extract neural activation patterns from such datasets comprising ∼100.000 neurons or more.</p>
<p>Recent work leveraged the compositional Restricted Boltzmann Machine (cRBM) to identify such neural assemblies in large-scale neural data (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>). The cRBM is an extension of the Restricted Boltzmann Machine (RBM) (<xref ref-type="bibr" rid="c36">Smolensky, 1986</xref>), an undirected graphical model that consists of two layers of random variables, representing the data itself (through a set of visible units) and a lower-dimensional latent representation (through a set of hidden units). The model learns in an unsupervised manner by matching its model distribution to the empirical distribution of the data through maximum likelihood optimization (<xref rid="c32" ref-type="bibr">Tubiana et al., 2019a</xref>; <xref ref-type="bibr" rid="c35">Salakhutdinov et al., 2007</xref>). The cRBM extends the classical RBM by adhering to a set of structural conditions (see Methods and Materials), pushing it to operate in a state referred to as the compositional phase (<xref ref-type="bibr" rid="c42">Tubiana and Monasson, 2017</xref>; <xref rid="c32" ref-type="bibr">Tubiana et al., 2019a,b</xref>). In the compositional phase, the visible-to-hidden connections in the RBM are sparse, and in our previous work (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>) this Research Advance is based on, we show that the associated neural assemblies of the hidden units are localized and span the entire space of the visible units. Furthermore, only a small fraction of the hidden units are active at any point in time, improving model interpretability.</p>
<p>Although the cRBM can accurately reproduce neural statistics and produce a low-dimensional representation of the high-dimensional neural data, this model is limited in capturing only static dependencies and is unable to specifically account for temporal dependencies. Neural activity driving animal behavior is expressed in both stochastic and deterministic states, thus requiring dynamics to be explicitly included to capture most of the variance in the data. To tackle this problem, we here include temporal dependencies directly into the model by applying the recurrent temporal RBM (RTRBM) (<xref ref-type="bibr" rid="c38">Sutskever et al., 2008</xref>). We utilize a type of transfer learning to retain the sparsity advantages of the cRBM, while the model can additionally account for the deterministic dynamics underlying the neural activity its trained on.</p>
<p>In short, the RTRBM is a recurrent neural network constructed by chaining multiple RBMs in time (<xref ref-type="bibr" rid="c26">Mittelman et al., 2014</xref>). Each RBM has a hidden state that is conditioned on the expected hidden state of the RBM at the preceding time-step. While temporal connections are constrained to single time-steps, the recurrency in the model indirectly accounts for multi-time-step dependencies. Previous studies using RTRBMs in other domains have highlighted the value of including such temporal dependencies in extracting spatiotemporal features from high-dimensional data (<xref ref-type="bibr" rid="c9">Boulanger-Lewandowski et al., 2012</xref>; <xref ref-type="bibr" rid="c24">Li et al., 2018</xref>; <xref ref-type="bibr" rid="c48">Zhang et al., 2018</xref>). A more detailed discussion on the RTRBM and its implementation can be found in The Recurrent Temporal Restricted Boltzmann Machine (RTRBM).</p>
<p>In this work, we apply the RTRBM to both simulated and real data. First, we show that the model is capable of retrieving the artificial neural assemblies and their temporal connections in a fully simulated network with only a few hidden populations. We compare the resulting RTRBM with an RBM that is trained on the same data, and show that it outperforms in terms of generalization error, pairwise moments, and time-shifted pairwise moments. We then use a combined approach of the RTRBM and the cRBM to model the temporal connections of different neural assemblies in wholebrain neuronal zebrafish data through transfer learning by initializing RTRBM weights with their cRBM counterparts. The resulting RTRBM model extends upon the neural assemblies identified by the cRBM models by additionally capturing their temporal dependencies. We demonstrate that this extension improves the reconstructive power in terms of the estimated moments and provides additional temporal information regarding the underlying structure of the brain.</p>
</sec>
<sec id="s2">
<title>Results</title>
<p>In this work, we investigated whether the inclusion of temporal dependencies between neural assemblies improves the representation of neuronal activity in the context of simulated data and whole-brain light-sheet recordings from zebrafish larvae (<italic>n</italic> = 8, 40709±13854 neurons, (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>)). For this purpose, we first introduce and compare the recurrent temporal restricted Boltzmann machine (RTRBM) to the compositional RBM (<xref rid="c32" ref-type="bibr">Tubiana et al., 2019a</xref>) and then use two-step transfer learning to arrive at an estimate of the RTRBM that stays in the compositional phase and maintains the locally restricted assemblies identified by the cRBM.</p>
<sec id="s2a">
<title>The RTRBM extends the RBM by temporal dynamics on the assembly level</title>
<p>The principal structural difference between the RBM and the RTRBM is the addition of recurrent connections through a set of weights <italic>U</italic> in the RTRBM that connect the hidden unit states at time-steps <italic>t</italic> − 1 and <italic>t</italic>. These connections allow the RTRBM to incorporate temporal dynamics from the data, while the (c)RBM is only able to represent time-independent, statistical relationships. This difference is illustrated in a small example of neural assemblies in <xref rid="fig1" ref-type="fig">Figure 1</xref>.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><p>The RTRBM extends the RBM by additionally accounting for temporal interactions of the neural assemblies. (<bold>A</bold>) A schematic depiction of an RBM with visible units (neurons) on the left, and hidden units (neural assemblies) on the right. The visible and hidden units are connected through a set of weights <italic>W</italic>. (<bold>B</bold>) An example <italic>W</italic> matrix where a subset of visible units is connected to one hidden unit. Details of the equations panel B and E are given in Methods and Materials. (<bold>C</bold>) Hidden and visible activity traces generated by sampling from the RBM. Due to its static nature, the RBM samples do not exhibit any sequential activation pattern, but merely show a stochastic exploration of the population activity patterns. (<bold>D</bold>) Schematic depiction of an RTRBM. The RTRBM formulation matches the static connectivity of the RBM, but extends it with the weight matrix <italic>U</italic> to model temporal dependencies between the hidden units. (<bold>E</bold>) In the present example, assembly 1 excites assembly 2, assembly 2 excites assembly 3, and assembly 3 excites assembly 1, while the remaining connections were set to 0. (<bold>F</bold>) Hidden and visible activity traces generated by sampling from the RTRBM. In contrast to the RBM samples, the RTRBM generates samples featuring a sequential firing pattern. It is able to do so due to the temporal weight matrix <italic>U</italic> which enables modeling temporal dependencies.</p></caption>
<graphic xlink:href="578570v2_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>When applying the RBM to neural data, the neurons are represented by the <italic>visible units</italic>, while the underlying neural assemblies are represented by the <italic>hidden units</italic> (see <xref rid="fig1" ref-type="fig">Figure 1</xref> for a visualization). In this basic example, we connect each assembly to an exclusive set of neurons for simplicity (<xref rid="fig1" ref-type="fig">Figure 1A</xref>). In the case of the RTRBM, there are additional, direct connections between the assemblies (<xref rid="fig1" ref-type="fig">Figure 1D</xref>, red arrows, defined by the weights <italic>U</italic>). To emphasize the resulting difference in temporal dynamics, we initialize an RBM and an RTRBM model with matching hidden to visible connections <italic>W</italic> (<xref rid="fig1" ref-type="fig">Figure 1B,E</xref>). We set these connections up so that each neural assembly is connected to a single hidden unit. In this manner, the hidden unit dynamics act as assembly dynamics, where each hidden unit represents a distinct assembly. In addition, the RTRBM has a weight matrix <italic>U</italic> that models the inter-assembly temporal dynamics. The activation function applied to the sum of the inputs is a sigmoid function, which enforces the output to be in the range [0, 1]. The weights that connect the visible to the hidden units outside their assigned assembly must therefore be negative to prevent their participation in other assemblies.</p>
<p>To demonstrate the resulting difference in temporal dynamics, we sample from the RBM and RTRBM and compare the resulting activity traces. In the RBM, as expected from the model definition, the stochastic sampling between the hidden and visible units does not lead to systematic sequential activations of the assemblies occur, aside from some persistence due to the reactivation of similar ensembles through the weights <italic>W</italic>.</p>
<p>Conversely for the RTRBM, a combination of temporal sequences and stochastic exploration can be realised: In this simple example of an RTRBM, assembly 1 excites assembly 2, assembly 2 excites assembly 3 and assembly 3 again excites assembly 1 (see <xref rid="fig1" ref-type="fig">Figure 1E</xref>). As a result, the hidden activity traces of data sampled from the RTRBM show matching sequential activation of hidden units (<xref rid="fig1" ref-type="fig">Figure 1F</xref>). Because each hidden unit is connected to a subset of visible units, this results in a sequential activation of the assemblies, where typically only one assembly is strongly active at each time-step. As the representation of the RTRBM is still probabilistic, the dynamics display a mixture between dynamic, and stochastic properties, which we consider a hallmark of neural activity.</p>
<p>In summary, the RTRBM maintains the features of the RBM to provide an interpretable and probabilistic representation of neural data, but extends it to include temporal dependencies between neural assemblies.</p>
</sec>
<sec id="s2b">
<title>RTRBMs learn assembly dynamics from simulated neural data</title>
<p>In the above example, the neural assembly connectivity was predefined. Next, we demonstrate that the RTRBM can be trained on simulated neural data to learn a set of weights <italic>W</italic> and <italic>U</italic> that correctly capture the underlying temporal dynamics on the assembly level. Initially, we aimed to compare the performance of the cRBM with the cRTRBM. However, we did not manage to get the RTRBM to reach the compositional phase. To ensure a fair and robust comparison, we opted to compare the RBM with the RTRBM. In this test case, we indeed find the RTRBM to outperform the RBM in the representation of the underlying moments.</p>
<p>We devised a method for generating artificial data sets mimicking neural population activity using a simplified neural network model. Here, neural activity is driven by the population activity of underlying neural assemblies. These activities of assemblies were determined by two factors: endogenous, assembly specific activations, and recurrent activations through the connections between assemblies <xref rid="fig2" ref-type="fig">Figure 2A</xref>, left). The activity of the neurons was then generated from a Poisson process whose time-dependent rate was given by the activations of a single assembly population.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><p><xref rid="fig2_S1" ref-type="fig">Figure 2—figure supplement 1</xref>. Alignment of weight matrices after learning.</p>
<p>The RTRBM outperforms the RBM on sequential statistics on simulated data. (<bold>A</bold>) Simulated data generation: Hidden Units (<italic>N</italic><sub><italic>h</italic></sub>) interact over time to generate firing rate traces which are used to sample a Poisson train. For example, assembly 1 drives assembly 2 and inhibits assembly 10, both at a single time-step delay. (<bold>B</bold>) Schematic depiction of the RBM and RTRBM trained on the simulated data. (<bold>C</bold>) For the RBM, the aligned estimated weight matrix <italic>Ŵ</italic> contains spurious off-diagonal weights, while the RTRBM identifies the correct diagonal structure (top). For the assembly weights <italic>U</italic> (left), the RTRBM also converges to similar aligned estimated temporal weights <italic>Û</italic> (right). (<bold>D</bold>) The RTRBM attributes only a single strong weight to each visible unit ((<italic>w</italic><sub><italic>i,j</italic></sub> &gt; 0.5<italic>σ</italic>, where <italic>σ</italic> is the standard deviation of <italic>W</italic>)), consistent with the specification in <italic>W</italic>, while in the RBM multiple significant weights get assigned per visible units. (<bold>E</bold>) The RBM and RTRBM perform similarly for concurrent (⟨<italic>v</italic><sub><italic>i</italic></sub>⟩, ⟨<italic>v</italic><sub><italic>i</italic></sub><italic>v</italic><sub><italic>j</italic></sub> ⟩) statistics, but the RTRBM provides more accurate estimates for sequential <inline-formula><inline-graphic xlink:href="578570v2_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula> statistics. In all panels, the abscissa refers to the data statistics in the test set, while the ordinate shows data sampled from the two models respectively. (<bold>F</bold>) The trained RTRBM and the RBM yield similar concurrent moments, but the RTRBM significantly outperformed the RBM on time-shifted moments (see text for details on statistics). (<bold>G</bold>) The RTRBM achieved significantly lower nMSE when predicting ahead in time from the current state in comparison to RBMs for up to 4 time-steps.</p></caption>
<graphic xlink:href="578570v2_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>For clarity of the presentation, we here again implement a direct match between assemblies and neurons, and thus expect the estimated weight matrix to be a ‘diagonal’ matrix between assemblies and neurons.</p>
<p>An RBM (<xref rid="fig2" ref-type="fig">Figure 2B</xref>) trained on the simulated data recovers a non-diagonal weight matrix (<xref rid="fig2" ref-type="fig">Figure 2C</xref>), which is composed of both the true assembly-to-neuron weights on the diagonal, but in addition has multiple off-diagonal weights, which partially account for the dependencies between the assemblies.</p>
<p>In contrast, the RTRBM correctly segments all ten assemblies, recovering a clean ‘diagonal’ estimated connectivity matrix <italic>Ŵ</italic> (<xref rid="fig2" ref-type="fig">Figure 2C</xref>, right), in addition to providing a close estimate (<italic>Û</italic>) to the true assembly connectivity matrix <italic>U</italic>, i.e. it recovers the underlying hidden connections from the activation patterns of neurons alone. Consistently, each visible neuron has only a single dominant weight (|<italic>Ŵ</italic><sub><italic>ij</italic></sub> |) in the RTRBM and thus produces a diagonal weight matrix, while the RBM assigns multiple strong weights to an RBM to address the time-dependencies (<xref rid="fig2" ref-type="fig">Figure 2D</xref>).</p>
<p>As expected, the RBM performs very well in capturing the average activations of the visible units (⟨<italic>v</italic><sub><italic>i</italic></sub>⟩) and their correlations (⟨<italic>v</italic><sub><italic>i</italic></sub> <italic>v</italic><sub><italic>j</italic></sub>⟩), referred to as first and second order moments, respectively (<xref rid="fig2" ref-type="fig">Figure 2E</xref>, top). However, it cannot accurately capture the time-shifted moments of the visible or hidden units (<xref rid="fig2" ref-type="fig">Figure 2E</xref>, bottom). The RTRBM performs similarly for the simultaneous moments (<xref rid="fig2" ref-type="fig">Figure 2E</xref>, top), but provides a more accurate account of the time-shifted moments (<xref rid="fig2" ref-type="fig">Figure 2E</xref>, bottom). This behavior is consistent for the different moments across multiple runs on independent simulated data sets and model estimates (<italic>N</italic> = 10, <xref rid="fig2" ref-type="fig">Figure 2F</xref>), with significant improvements of the RTRBM observed for the time-shifted moments (<italic>p</italic>-values 0.993 for <italic>v</italic><sub><italic>i</italic></sub>, 0.312 for <italic>h</italic><sub><italic>i</italic></sub>, 9.13 ⋅ 10<sup>−5</sup> for <inline-formula><inline-graphic xlink:href="578570v2_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and 4.55 ⋅ 10<sup>−3</sup> for <inline-formula><inline-graphic xlink:href="578570v2_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, one-sided Mann-Whitney U test).</p>
<p>Lastly, the RTRBM also exhibited a significantly lower normalised mean squared error (nMSE, see Methods and Materials) (<italic>p</italic> = 4.1 ⋅ 10<sup>−8</sup>, 2-way ANOVA with time-steps and model type as factors, <italic>N</italic> = 10, <xref rid="fig2" ref-type="fig">Figure 2G</xref>) when predicting ahead in time inside the simulated data (not used in training).</p>
<p>The RTRBM’s advantage in prediction stayed significant up to 4 time-steps (<italic>p</italic> &lt; 0.001, two group t-test per time-step with Bonferroni correction for the number of time-steps). This decay of differences between the models is expected, as the probabilistic basis of the RBM/RTRBM as well as the simulated data by design lead to non-deterministic trajectories, similar to the divergence of trajectories in non-linear dynamic systems where small noise eventually leads to large differences (<xref rid="c37" ref-type="bibr">Strogatz, 2000</xref>) (see Discussion for a relation to animal behavior).</p>
<p>These results indicate that the RTRBM provides a more accurate account of the model structure and data statistics in particular for sequential activations. The RBM can partially account for the temporal structure, but only by conflating it with its non-temporal weights in <italic>W</italic>.</p>
</sec>
<sec id="s2c">
<title>The RTRBM outperforms the cRBM on whole-brain zebrafish data</title>
<p>Next, we trained the RTRBM on whole-brain data recorded in zebrafish larvae (<italic>n</italic> = 8, same data as in <xref rid="c32" ref-type="bibr">van der Plas et al. (2023)</xref>). To obtain binarized spike traces that can be used by the RTRBM, the individual fluorescence traces were deconvolved by means of blind sparse deconvolution (<xref rid="fig3" ref-type="fig">Figure 3A</xref>). Model training was performed using a trained cRBM as the basis for the assembly-to-neuron weights <italic>W</italic>, and then training the temporal assembly-to-assembly weights <italic>U</italic>, while allowing <italic>W</italic> to only change slightly (the learning rate for these weights is reduced by two orders of magnitude, see Methods and Materials for more details on model training). For each animal, model training was successful and the weight changes converged to small values. This approach of using pre-learned weights can be seen as a variant of transfer learning (<xref ref-type="bibr" rid="c39">Tan et al., 2018</xref>). We chose for this training procedure as the weight matrix <italic>W</italic> inferred by the RTRBM is rarely able to identify localized receptive fields for a large portion of hidden units within its present, non-compositional, formulation.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><p>RTRBM often outperforms the cRBM on zebrafish data (<bold>A</bold>) Whole-brain neural activity of larval zebrafish was imaged via Calcium-indicators using light-sheet microscopy at single neuron resolution (left). Calcium activity (middle, blue) is deconvolved by blind, sparse deconvolution to obtain a binarized spike train (middle, black). The binarized neural activity of 1000 randomly chosen neurons (right). (<bold>B</bold>) Left: Distribution of all visible-to-hidden weights. Here, a strong weight is determined by proportional thresholding, <italic>w</italic><sub><italic>i,j</italic></sub> &gt; <italic>w</italic><sub><italic>thr</italic></sub>. Here <italic>w</italic><sub><italic>thr</italic></sub> is set such that 5000 neurons have a strong connection towards the hidden layer. Right: log-weight distribution of the visible to hidden connectivity. (<bold>C</bold>) The RTRBM extracts sample assemblies (color indicates assembly) by selecting neurons based on the previously mentioned threshold. Visible units with stronger connections than this threshold for a given hidden unit are included. Temporal connections (inhibitory: blue, excitatory: red) between assemblies are depicted across time-steps. (<bold>D</bold>) Temporal connections between the assemblies are sorted by agglomerative clustering (dashed lines separate clusters, colormap is clamped to [−1, 1]). Details on the clustering method can be found in Methods and Materials. (<bold>E</bold>) Corresponding receptive fields of the clusters identified in (D), where the visible units with strong weights are selected similarly to (B). The receptive field of cluster 5 has been left out as it contains only a very small number of neurons with strong weights based on the proportional threshold. (<bold>F</bold>) Comparative analysis between the cRBM (bottom row) and RTRBM (top row) on inferred model statistics and data statistics (test dataset). Compared in terms of Spearman correlations and sum square difference. From left to right: the RTRBM significantly outperformed the cRBM on the mean activations ⟨<italic>v</italic><sub><italic>i</italic></sub>⟩ (<italic>p</italic> &lt; <italic>ϵ</italic>), pairwise neuron-neuron interactions ⟨<italic>v</italic><sub><italic>i</italic></sub><italic>v</italic><sub><italic>j</italic></sub> ⟩ (<italic>p</italic> &lt; <italic>ϵ</italic>), time-shifted pairwise neuron-neuron interactions <inline-formula><inline-graphic xlink:href="578570v2_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and time-shifted pairwise hidden-hidden interactions <inline-formula><inline-graphic xlink:href="578570v2_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for example fish 4. (<bold>G</bold>) The methodology in panel F is extended to analyze datasets from eight individual fish, each color representing one individual fish. Spearman correlation and the assessment of significant differences between both models are determined using a bootstrap method (see Methods and Materials for details).</p></caption>
<graphic xlink:href="578570v2_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>The mean square reconstruction error <inline-formula><inline-graphic xlink:href="578570v2_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in the initial phase of model training was ∼ 0.40, the RTRBM was able to reduce this to ∼ 0.072, which it achieves predominantly by adjusting the temporal weights. The trained RTRBM model maintained the localised neural assemblies inherited from the cRBM (<xref rid="fig3" ref-type="fig">Figure 3C</xref>) as quantified by a sparse weight distribution (<xref rid="fig3" ref-type="fig">Figure 3B</xref>, left) and a comparable, lower number of typically 1-3 strong weights per neuron as in the cRBM (<xref rid="fig3" ref-type="fig">Figure 3B</xref>, right).</p>
<p>Most hidden units showed self-excitation, i.e. indicated as a positive value on the diagonal of <italic>Û</italic>. The overall pattern of temporal connections between the assemblies in <italic>Û</italic> could be divided into several groups. To this end, agglomerative clustering (for details see Methods and Materials) can be applied to the incoming (row) or outgoing (columns) connections of the matrix <italic>Û</italic> to identify assemblies with similar temporal structures. We here focus on the incoming connections/receptive fields, as their grouping was more clear (<xref rid="fig3" ref-type="fig">Figure 3D</xref>, dashed lines indicate boundaries between clusters). The clustering for outgoing connections was similar, however, not identical as <italic>Û</italic> are generally not symmetric, due to the directedness of the temporal connections. The identified clusters showed characteristic patterns of connectivity, e.g. clusters 1 and 5 show a diverse connectivity pattern with relatively strong intra-cluster connections (<xref rid="fig3" ref-type="fig">Figure 3D</xref>). Clusters 2 and 3 exhibit a diverse connectivity pattern as well, but do not show the same strong intra-cluster connectivity. Cluster 4 has very strong recurrent intra-cluster connectivity, but also excites all other clusters. Cluster 5 is dominated by strong inhibitory connectivity to itself and all other clusters. We thus see a range of different connectivity patterns appearing, identified by the clustering method. By using a lower clustering threshold, an even further refined clustering structure appears (data not shown here). The sets of strongly connected visible units corresponding to the hidden unit clusters furthermore formed spatially localized sets of neurons (<xref rid="fig3" ref-type="fig">Figure 3E</xref>).</p>
<p>To compare the performance between the inferred RTRBM and cRBM models, we analysed the reconstruction quality. To this end, we sampled data from both models and again compared the model statistics to the data statistics, using an unseen test set (matched to the test set in (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>), see Methods and Materials for Details).</p>
<p>For the example fish in <xref rid="fig3" ref-type="fig">Figure 3B-F</xref>, the first order moments between neurons ⟨<italic>v</italic><sub><italic>i</italic></sub>⟩ are strongly correlated for the RTRBM (<italic>r</italic><sub><italic>s</italic></sub> = 0.92, <italic>p</italic> &lt; <italic>ϵ</italic>, where &lt; <italic>ϵ</italic> denotes machine precision), that is an improvement compared to to the performance of the cRBM (<italic>r</italic><sub><italic>s</italic></sub> = 0.75, <italic>p</italic> &lt; <italic>ϵ</italic>). The second order moments between neurons ⟨<italic>v</italic><sub><italic>i</italic></sub><italic>v</italic><sub><italic>j</italic></sub> ⟩ of the RTRBM (<italic>r</italic><sub><italic>s</italic></sub> = 0.58, <italic>p</italic> &lt; <italic>ϵ</italic>) also correlates better compared to the cRBM (<italic>r</italic><sub><italic>s</italic></sub> = 0.27, <italic>p</italic> &lt; <italic>ϵ</italic>). To establish how well both models can capture the temporal dynamics of the data, we compared the time shifted moments of the visible <inline-formula><inline-graphic xlink:href="578570v2_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and hidden <inline-formula><inline-graphic xlink:href="578570v2_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula> units. The time shifted moments of the visible units of the RTRBM (<italic>r</italic><sub><italic>s</italic></sub> = 0.56, <italic>p</italic> &lt; <italic>ϵ</italic>) correlates better than the cRBM (<italic>r</italic><sub><italic>s</italic></sub> 218 = 0.27, <italic>p</italic> &lt; <italic>ϵ</italic>). While a direct comparison of the hidden unit activations between the cRBM and the RTRBM is hindered by the inherent discrepancy in their activation functions (unbounded and bounded, respectively), the analysis of time-shifted moments reveals a stronger correlation for the RTRBM hidden units (<italic>r</italic><sub><italic>s</italic></sub> = 0.92, <italic>p</italic> &lt; <italic>ϵ</italic>) compared to the cRBM (<italic>r</italic><sub><italic>s</italic></sub> 222 = 0.88, <italic>p</italic> &lt; <italic>ϵ</italic>).</p>
<p>The Spearman correlation is scale-free, i.e. even if one variable is doubled, the correlation can stay the same. However, in many cases, the sampled RTRBM was much closer to the test data in absolute terms (indicated by densities in <xref rid="fig3" ref-type="fig">Figure 3F</xref> that are closer to the diagonal). To quantify this difference, we also compared the Sum Square Difference (SSD) between the sampled statistics of the RTRBM and cRBM with the statistics of the test set, to determine how well both models accounted for the real data on a quantitative, absolute level. The RTRBM had a lower SSD for all first-, second- and time-shifted moments compared to the cRBM. This suggests that the statistics of the RTRBM better matched in an absolute sense, and can be considered as better behaved than the statistics of the cRBM when compared to the test set.</p>
<p>Over the whole dataset, the RTRBM outperforms the cRBM on 5 out of 8 fish for ⟨<italic>v</italic>⟩, and on 4 out of 8 fish for ⟨<italic>v</italic><sub><italic>i</italic></sub><italic>v</italic><sub><italic>j</italic></sub> ⟩, while the performance was similar on the remaining fish, except for the green fish (<xref rid="fig3" ref-type="fig">Figure 3G</xref>). To establish how well both models can capture the temporal dynamics of the data, we compared the <inline-formula><inline-graphic xlink:href="578570v2_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="578570v2_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Here, the RTRBM outperformed the cRBM on 4 out of 8 fish for the visible units and on 6 out of 8 fish for the hidden units. Specifically, the performance of the RTRBM are consistently improved compared to the cRBM for the same fish across the different moments (<xref rid="fig3" ref-type="fig">Figure 3G</xref>). Note, that the second order statistics are statistics the algorithms are not explicitly trained on to replicate (see also Methods and Materials).</p>
<p>In summary, the transfer learning approach was able to successfully expand the cRBM model to include the temporal connections, while maintaining a high level of sparsity in the hidden-to-visible layer connections. It is beyond the scope of this study to evaluate the detailed differences between the two models, but this transfer learning approach appears a promising avenue to enable the RTRBM to be estimated on large scale data sets.</p>
</sec>
<sec id="s2d">
<title>Identification of the underlying time-scale of assembly interactions</title>
<p>The sampling rate in an experiment will generally not match the effective interaction time between neural assemblies. If the mismatch is too large, it may prevent the RTRBM from making a correct estimate of the temporal connections. It is therefore important to be able to estimate the interaction time of assemblies in relation to the sampling rate.</p>
<p>To investigate this issue, simulated data was generated where the interaction time between assemblies was set to Δ<italic>t</italic><sub><italic>A</italic></sub> = 4 time-steps (relative to the sampling rate of the simulated data, <xref rid="fig4" ref-type="fig">Figure 4A</xref>, left). This simulated data was then down-sampled to different rates using integer steps on the range [1, 10] (<xref rid="fig4" ref-type="fig">Figure 4A</xref>, middle). Down-sampling was performed by selecting the value of the data at the sampling interval, rather than averaging or interpolating over all points in the interval.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Neural interaction timescale can be identified via RTRBM estimates over multiple timescales. (<bold>A</bold>) Training paradigm. Simulated data generated as in <xref rid="fig2" ref-type="fig">Figure 2</xref>, but with temporal interactions between populations at a delay of Δ<italic>t</italic><sub><italic>A</italic></sub> = 4 time-steps. This data is downsampled according to a downsampling rate Δ<italic>t</italic><sub><italic>D</italic></sub> by taking every Δ<italic>t</italic><sub><italic>D</italic></sub>-th time-step (shown here is Δ<italic>t</italic><sub><italic>D</italic></sub> = 4), and used for training different RTRBMs. (<bold>B</bold>) Performance of the RTRBM for various down-sampling rates measured as the normalised MSE in predicting the visible units one time-step ahead (<italic>N</italic> = 10 models per Δ<italic>t</italic><sub><italic>D</italic></sub>). Dotted line shows the mean estimate of the lower bound ± SEM (<italic>N</italic> = 10, 000) due to inherent variance in the way the data is generated (see Methods and Materials). Dashed gray line indicates the theoretical performance of an uninformed, unbiased estimator <inline-formula><inline-graphic xlink:href="578570v2_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. (<bold>C</bold>) Cosine similarity between the interaction matrix <italic>U</italic> and the aligned learned matrices <italic>Û</italic>, both z-scored. Bars and errorbars show mean and standard deviation respectively across the <italic>N</italic> = 10 models per Δ<italic>t</italic><sub><italic>D</italic></sub>. Dark lines show absolute values of the mean cosine similarity. Shown above are the <italic>Û</italic> matrices with the largest absolute cosine similarity per down-sampling rate. (<bold>D</bold>) The same procedure as in (A) is performed on neural data in order to find the effect of down-sampling here. (<bold>E</bold>) Spearman correlation of three important model statistics across different down-sampling rates for neural data from example fish 4, similar to <xref rid="fig3" ref-type="fig">Figure 3F</xref>. Dots and shaded area indicate mean and two times standard deviation, determined using a bootstrap method (see Methods and Materials for details).</p></caption>
<graphic xlink:href="578570v2_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>This choice was motivated by the fact that light-sheet imaging only has access to the neural activity at particular time-points and cannot average the entire duration between these time-points (as it is imaging at different planes in depth in between). As the size of the system should not make a qualitative difference for this analysis, we generated simulated data with only <italic>N</italic><sub><italic>h</italic></sub> = 10 hidden assemblies and <italic>N</italic><sub><italic>v</italic></sub> = 20 visible units per assembly. Different runs (<italic>N</italic> = 10) were inferred on independently drawn assembly dynamics and subsequently drawn spike-times, but with identical temporal and static weight matrices <italic>W</italic> and <italic>U</italic>.</p>
<p>To evaluate the reconstruction performance of the trained RTRBMs, the reconstruction nMSE one time-step ahead is calculated on a single test data set and compared for different down-sampling rates (<xref rid="fig4" ref-type="fig">Figure 4B</xref>, see Methods and Materials for details). The trained RTRBM performs significantly better than an unbiased random estimator, i.e.<inline-formula><inline-graphic xlink:href="578570v2_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, when the down-sampling rate is a multiple of the simulated interaction time (<italic>p</italic> = 0.0098 for Δ<italic>t</italic><sub><italic>D</italic></sub> <italic>∈</italic> {4, 8}, one-sided Wilcoxon signed rank test, <italic>N</italic> = 10 with Bonferroni correction for the number of down-sampling rates, effect size ≥ 8.93). The performance is best when the down-sampling factor matches this interaction time at Δ<italic>t</italic><sub><italic>D</italic></sub> = 4 (<italic>p</italic> = 0.00082, one-sided Wilcoxon rank-sum test, <italic>N</italic> = 10 with Bonferroni correction for the number of comparisons, effect size ≥ 7.05). The optimal estimator at nMSE = 0 is obtained from knowing the underlying model precisely, only limited by the unpredictable variance from the random factors of Poisson sampling and intrinsic assembly dynamics (see Methods and Materials for details). Visual inspection of the inferred data for shows that only the sampled data from Δ<italic>t</italic><sub><italic>D</italic></sub> = 4 contains the characteristic temporal sequences generated by the connections in <italic>U</italic>.</p>
<p>To verify that the correct temporal connections between the hidden units are identified, the estimated temporal weights <italic>Û</italic> after alignment of assemblies (see Methods and Materials) are compared with the true temporal connections <italic>U</italic> of the simulated data using cosine similarity (<xref rid="fig4" ref-type="fig">Figure 4C</xref>). Correspondingly, the similarity peaks when the down-sampling rate matches the interaction time. While neighboring values around the simulation step size have similar absolute correlations, the correct step size still outperforms them. Conversely, this indicates that it may be sufficient to be close to the true step size in order to correctly estimate the temporal dependence in <italic>U</italic>.</p>
<p>We applied this analysis as a refinement to the training of the RTRBM on zebrafish data, and found that the Spearman correlation of important moments between neural activity and model activity was highest at the natural sampling rate (<xref rid="fig4" ref-type="fig">Figure 4E</xref>). Therefore, the analysis in <xref rid="fig3" ref-type="fig">Figure 3</xref> was conducted without down-sampling. Each RTRBM was trained with the same number of gradient updates to ensure a fair comparison. However, due to the down-sampling procedure the amount of training data available is drastically decreased for large down-sampling rates. We did not retrain the cRBM on the downsampled data because the cRBM model does not account for time dependencies.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Here, we introduced the RTRBM as a powerful dynamical statistical model for the analysis of largescale neural data, demonstrating that it can uncover temporal dependencies between neural assemblies. We achieve this through transfer learning on the basis of the static assembly structure estimated by a cRBM trained on the same data (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>). The estimated RTRBM models are structurally more fitting and provide more accurate accounts of the activity dynamics than those of the cRBM, as we demonstrate on simulated and experimentally acquired, whole-brain zebrafish data. The resulting temporal connectivity structure on the assembly level provides a compact description of the neural dynamics, which decomposes into dynamical networks of assemblies. Training of an RTRBM/cRBM model can be completed in a few hours on current hardware, and could thus lend itself for within experiment, interventional studies. The RTRBM therefore provides an effective and practically feasible model formalism for accounting for temporal dynamics as well as stochastic properties of whole-brain zebrafish activity.</p>
<sec id="s3a">
<title>Relation with previous studies on large-scale assemblies</title>
<p>Estimating functional divisions and connectivity from large-scale activity data can be considered one of the key objectives of computational neuroscience, as it would allow to automatically extract interpretable structure from datasets of (human-level) uninterpretable complexity. While it is generally recognized that this poses a difficult analytical challenge, in particular in highly connected systems (<xref ref-type="bibr" rid="c13">Das and Fiete, 2020</xref>), whole-brain recordings have brought a critical advance to this endeavor. However, due to the relatively recent introduction of whole-brain measurements in zebrafish larvae (<xref ref-type="bibr" rid="c2">Ahrens et al., 2013</xref>), surprisingly few studies exist in this system that have attempted the investigation of neural activity in this type of data at the whole-brain scale (<xref ref-type="bibr" rid="c27">Nguyen et al., 2018</xref>; <xref ref-type="bibr" rid="c11">Chen et al., 2018</xref>; <xref ref-type="bibr" rid="c5">Betzel, 2020</xref>; <xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>).</p>
    <p>These studies have all focused on extracting functional groupings from the neural activity, without directly attempting to perform temporal predictions of neural activity. In <xref ref-type="bibr" rid="c11">Chen et al. 2018</xref>, a clustering approach was introduced that identified a set of clusters of neurons, which showed responses to specific visual stimuli or motor behaviors. <xref ref-type="bibr" rid="c5">Betzel (2020)</xref> estimates instantaneous functional connectivity from spontaneous activity and identifies groups of local nodes that form a hierarchical, modular structure, however, without the possibility of using this model in a generative way. In our previous study (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>) we identified neural assemblies from spontaneous activity using a generative, probabilistic approach, i.e. the cRBM, but without explicitly modeling any time-dependencies. Lastly, <xref rid="c27" ref-type="bibr">Nguyen et al. (2018)</xref> uses Gaussian mixture modelling to cluster on the activity level, but again, this method does not yield any insight into the timedependencies between the identified clusters.</p>
<p>Many other studies have focused on the analysis of subsystems, but also without directly modelling the temporal dependence, e.g. sensorimotor transformations in the visual (<xref ref-type="bibr" rid="c6">Bianco and Engert, 2015</xref>) and the auditory system (<xref ref-type="bibr" rid="c33">Privat et al., 2019</xref>), the representation and maintenance of spatial location (<xref ref-type="bibr" rid="c46">Yang et al., 2022</xref>), decision making (<xref ref-type="bibr" rid="c3">Bahl and Engert, 2020</xref>), or the neural circuit underlying heading direction (<xref ref-type="bibr" rid="c31">Petrucco et al., 2023</xref>).</p>
<p>Since the current temporal resolution of light-sheet imaging is rather low, i.e. limited of a few volumes per second (but alternative scanning approaches might change this soon, see e.g. <xref rid="c8" ref-type="bibr">Bouchard et al. (2015)</xref>), estimating the temporal dynamics on the level of individual neurons is still difficult. Therefore, our present approach focused on the dynamics between assemblies, which are expected to develop on slower timescales. Temporal connections are generally more insightful than instantaneous function connections, as they are directed and therefore provide a better basis for separating correlation from causation.</p>
<p>We demonstrate that the RTRBM was able to capture functional temporal connections between neural assemblies while maintaining localized receptive fields of the hidden units. Additionally, as the RTRBM yields insight into the temporal dynamics of these identified neural assemblies, it provides a way of identifying which assemblies are similar in their dynamics and thereby can suggest distinct large-scale dynamical networks spanning one or multiple brain areas (see <xref rid="fig3" ref-type="fig">Figure 3</xref>). Moreover, the RTRBM outperforms the classical RBM on the artificial data in terms of reconstruction statistics, and also outperforms cRBM in accounting for temporal dynamics.</p>
<p>To our knowledge, only two earlier studies have attempted to predict dynamics or estimate dynamical relations between neural assemblies on the whole brain level (<xref ref-type="bibr" rid="c45">Watanakeesuntorn et al., 2020</xref>; <xref ref-type="bibr" rid="c28">Pao et al., 2021</xref>). In both studies Empirical Dynamical Modelling/Convergent Cross Mapping is used to estimate neural dynamics, however, the zebrafish data is mostly utilized as a usage case for demonstrating that the methods scale to large datasets, without providing insight into the resulting ensembles or prediction quality. Another approach used is to apply dynamical modeling of the behavioral level and then use concurrently acquired whole-brain activity to identify corresponding structures in the zebrafish brain (<xref ref-type="bibr" rid="c14">Dunn et al., 2016</xref>).</p>
</sec>
<sec id="s3b">
<title>Limitations and future improvements</title>
<p>The RTRBM introduces temporal dependencies in a constrained way that effectively limit the number of additional parameters. This feature is important to avoid overfitting on the limited amount of data generally available in each experiment. However, the increased complexity involved with the addition of these temporal dependencies limits the analytical tractability of the model. This added complexity had a number of consequences on the estimation procedure, which should ideally be resolved in future work.</p>
<p>Specifically, the RTRBM in its current form is not intrinsically driven towards the compositional phase, which is an important property that pushes the model to identify localized neural assemblies. Specifically, the use of dReLU hidden unit potentials within the RTRBM framework was not analytically tractable in our hands. We therefore opted for a transfer learning approach, where the cRBM first estimates the assemblies, and then we initialize the model with these identified assemblies. The RTRBM then infers the temporal connectivity between the identified localized assemblies, while only slightly modifying their assembly structure. This approach could be limiting in multiple ways. For example, the cRBM-estimated assembly structure could contain an amalgam of static and dynamic connectivities (see <xref rid="fig2" ref-type="fig">Figure 2</xref> for simulated data). Furthermore, it might be necessary to estimate the assembly structure jointly with the temporal connectivities between them for optimal decomposition. Extending the current work, we aim to refine the RTRBM by introducing other sparsity constraints on the hidden-hidden connections (similar to <xref rid="c26" ref-type="bibr">Mittelman et al. (2014)</xref>), or by realizing the compositional properties in the RTRBM to allow single-step, direct estimation.</p>
<p>Another limitation of the current RTRBM framework is that all assemblies are interacting on a single time-scale. While we have demonstrated (<xref rid="fig4" ref-type="fig">Figure 4</xref>) that a single time-scale can be identified through the estimation of and subsequent selection from multiple RTRBMs on different timescales, the more general case of multiple interaction time-scales between different assembles remains unaddressed. Partly, this issue is alleviated by the compounding effect of temporal interactions over multiple time-steps, which therefore suggests to err on the side of shorter time-steps in estimation. In preliminary explorations we noticed that the estimated RTRBM generates alternating dynamics between clusters of assemblies (see <xref rid="fig3" ref-type="fig">Figure 3</xref>) on time-scales that are much longer than the single interaction step. In subsequent work, the RTRBM could be generalized to include multiple timescales of interaction for different assemblies.</p>
<p>Related to the time-scale issue, light-sheet imaging is currently limited to ∼100 Hz, which means that the ∼30-40 imaging planes are sampled at only 2-4 Hz, depending on the specific system. At these low imaging rates it is likely that some assembly dynamics are missed or appear simultaneous. Improvements in the speed of stepping between imaging planes will increase the sampling rate per cell. Together with brighter fluorescent indicators (<xref ref-type="bibr" rid="c47">Zhang et al., 2023</xref>), this will provide a more reliable basis for estimating models that incorporate temporal dependencies.</p>
</sec>
<sec id="s3c">
<title>Conclusions</title>
<p>The RTRBM formalism is the logical next steps in the analysis of whole-brain recordings, as it accounts for the static and dynamic aspects using a probabilistic formalism, which captures both the stochastic and deterministic aspects that are hallmarks of neural activity. Followup studies need to attempt to extend the RTRBM into the compositional phase directly, thus speeding up learning and ensuring matched assemblies and temporal connectivities (<xref rid="c4" ref-type="bibr">Bargmann and Marder, 2013</xref>). Recordings at higher temporal resolutions and for longer durations will be instrumental in allowing convergence of the <italic>cRTRBM</italic> (<xref rid="c20" ref-type="bibr">Helmstaedter, 2015</xref>). Together with advancements of computing hardware this should allow for interventional studies based on the estimated dynamics to directly verify the estimated temporal connectivity through modulation techniques such as optogenetic control or laser ablation.</p>
</sec>
</sec>
<sec id="s4">
<title>Methods and Materials</title>
<sec id="s4a">
<title>The Restricted Boltzmann Machine (RBM)</title>
<p>The Restricted Boltzmann Machine (RBM) (<xref ref-type="bibr" rid="c35">Salakhutdinov et al., 2007</xref>) is an undirected graphical model that defines a probability distribution over a set of binary visible units carrying the data configurations <inline-formula><inline-graphic xlink:href="578570v2_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and real-valued latent representations given by a set of hidden units <inline-formula><inline-graphic xlink:href="578570v2_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. In contrast to the definition of the classical Boltzmann Machine, the RBM has no direct couplings between pairs of units within the same layer, making it a bipartite graph that allows for more efficient model training. The joint probability distribution of the model is defined as:
<disp-formula id="eqn1">
<graphic xlink:href="578570v2_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>W</italic><sub><italic>ij</italic></sub> are visible-to-hidden unit weights, <italic>E</italic> is the global energy of the RBM, <italic>Z</italic> = Σ<sub>v</sub> ∫<italic>d</italic>h<italic>e</italic> <sup>−<italic>E</italic>(v,h)</sup> the partition sum, and 𝒰<sub><italic>j</italic></sub> (<italic>h</italic><sub><italic>j</italic></sub>) the hidden unit potential. The choice of the hidden unit potential shapes the energy landscape of the model and thus the states the hidden units in the the model can take, making it an important model choice. For a more detailed discussion on the choice of the shape of the hidden unit potential, we refer to our previous paper (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>). In this work, we use the Bernoulli hidden unit potential, which is defined as <inline-formula><inline-graphic xlink:href="578570v2_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where <bold>b</bold><sub><italic>h</italic></sub> is the hidden bias and <inline-formula><inline-graphic xlink:href="578570v2_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Here, <italic>i</italic> is used to index the visible units and <italic>j</italic> to index the hidden units. The full set of model parameters is given by the visible bias <inline-formula><inline-graphic xlink:href="578570v2_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, the hidden bias <inline-formula><inline-graphic xlink:href="578570v2_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and weights<inline-formula><inline-graphic xlink:href="578570v2_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Note that, while the visible units v are observed variables, the hidden units h are unobserved (latent) variables and must therefore be sampled, conditioned on the state of the visible units v.</p>
<p>The posterior distributions over the hidden and visible units allow sequential sampling of the hidden and visible unit states. As both layers contain no within-layer dependencies, the posterior distributions over v and h are conditioned only on the other variable and factorize as:
<disp-formula id="eqn2">
<graphic xlink:href="578570v2_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The choice of the Bernoulli hidden unit potential reduces these equations to:
<disp-formula id="eqn3">
<graphic xlink:href="578570v2_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>σ</italic> denotes the logistic function, defined as <inline-formula><inline-graphic xlink:href="578570v2_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For a detailed derivation, we refer to <xref rid="c16" ref-type="bibr">Goodfellow et al. (2016)</xref>.</p>
<sec id="s4a1">
<title>Training the RBM</title>
<p>The RBM model parameters are learned by maximizing the log-likelihood of the target data, denoted as ℒ = ⟨log(<italic>P</italic> (v)) ⟩<sub>data</sub> (<xref ref-type="bibr" rid="c1">Ackley et al., 1985</xref>). This learning procedure ensures an accurate representation of the underlying distribution of the target dataset through the Boltzmann-Gibbs energy distribution (<xref rid="c7" ref-type="bibr">Boltzmann, 1868</xref>). Stochastic gradient-based methods are employed to minimize the Kullback–Leibler divergence (<xref rid="c23" ref-type="bibr">Kullback and Leibler, 1951</xref>) between the model and data distributions. These steps write:
<disp-formula id="eqn4">
<graphic xlink:href="578570v2_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>E</italic> is the energy of the RBM, as given in <xref ref-type="disp-formula" rid="eqn1">Equation 1</xref>. We here let ⟨…⟩ denote the expectation value over the data and the model distributions respectively. As the visible states of the data are given, ⟨<italic>E</italic>(v, h) ⟩<sub>data</sub> is straightforward to compute. In contrast, the computation ⟨<italic>E</italic>(v, h) ⟩<sub>model</sub> is intractable for sufficiently large systems due to the exponentially large state space over the visible unit states in the partition sum. To address this problem of intractability, a common solution is the use of a <italic>K</italic>-step Markov Chain Monte Carlo sampling scheme (Gibbs sampling) (<xref rid="c21" ref-type="bibr">Hinton, 2002</xref>). This approach starts from an initial configuration and aims to approximate the expectation values of the model distribution. This is also known as Contrastive Divergence (CD). In this learning scheme, samples are sequentially drawn from the visible and hidden posterior distributions respectively (Eq. <xref ref-type="disp-formula" rid="eqn4">Equation 4</xref>), up to <italic>K</italic> time. For sufficiently large values of <italic>K</italic>, this procedure yields unbiased samples of the underlying model distribution (<xref rid="c21" ref-type="bibr">Hinton, 2002</xref>). In practice, a value of <italic>K</italic> = 1 during training is generally sufficient to obtain reasonable expectation values (<xref rid="c10" ref-type="bibr">Carreira-Perpinan and Hinton, 2005</xref>). Increasing the number of samples will result in better approximations, and thus generally in improved model estimation.</p>
</sec>
<sec id="s4a2">
<title>The compositional phase</title>
<p>In the classical definition of the RBM training scheme, there is no regularization on the hidden-unit activation sparsity. This means that a visible unit can have a proportionally strong connection to a large set of hidden units. Such a non-localized visible-hidden unit connectivity can hinder the interpretation of the model’s learned latent representation. Previous work (<xref rid="c42" ref-type="bibr">Tubiana and Monasson, 2017</xref>; <xref rid="c40" ref-type="bibr">Tubiana et al., 2019a</xref>) introduced a method to regularize the RBM in such that it is pushed towards a sparse visible-hidden unit connectivity, termed the compositional phase. The resulting compositional RBM (cRBM) was employed to discover compact neural assemblies in our previous study (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>). This sparsity in connections allows for a direct and interpretable relationship between the weights in the cRBM and the generated data configurations. The compositional phase is observed when RBMs are constrained to a specified set of structural conditions (<xref rid="c42" ref-type="bibr">Tubiana and Monasson, 2017</xref>):</p>
<list list-type="order">
<list-item><p>The hidden units are unbound and real-valued with ReLU like activation function.</p></list-item>
<list-item><p>The weight matrix <italic>W</italic> is sparse.</p></list-item>
<list-item><p>The columns of the <italic>W</italic> have similar norm.</p></list-item>
</list>
<p>A key implementation detail of this cRBM model is the use of the double-Rectified Linear Unit (dReLU) defining the hidden-unit potential (<xref rid="c42" ref-type="bibr">Tubiana and Monasson, 2017</xref>; <xref rid="c32" ref-type="bibr">Tubiana et al., 2019a,b</xref>). Detailed analyses of RBMs operating in the compositional phase have exemplified the dynamical consequences and the advantages of this regime for learning complex data manifolds. In-depth discussions on the cRBM and the compositional phase can be found in related literature (<xref rid="c42" ref-type="bibr">Tubiana and Monasson, 2017</xref>; <xref rid="c32" ref-type="bibr">Tubiana et al., 2019a,b</xref>). In this work, we use the implementation from <xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref> for our cRBM model. A detailed description of the implementation and accompanying code can be found there.</p>
</sec>
</sec>
<sec id="s4b">
<title>The Recurrent Temporal Restricted Boltzmann Machine (RTRBM)</title>
<p>The RTRBM can be conceptualized as a series of RBMs unfolded across the temporal dimension, i.e. a recurrent network. The model state of the RTRBM at each time-step <italic>t</italic> is in essentially an RBM, where the hidden state is conditioned on the contextual hidden state of the RBM at timestep <italic>t</italic> − 1. Mathematically, this involves augmenting the hidden bias of the RBM at time <italic>t</italic> with an additional term dependent on the previous expected hidden states <bold>r</bold><sup>[<bold>t−1</bold>]</sup> = ⟨<bold>h</bold><sup>[<bold>t−1</bold>]</sup>⟩. Furthermore, the weights <inline-formula><inline-graphic xlink:href="578570v2_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are introduced which directly connect the previous to the current hidden unit states. This setup allow the model to directly capture latent-state temporal dependencies that cross multiple time-steps. The statistical distribution of the RTRBM at time-step <italic>t</italic> is given by:
<disp-formula id="eqn5">
<graphic xlink:href="578570v2_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>where we dropped the indexing subscripts <italic>ij</italic> for conciseness. At <italic>t</italic> = 1, the term <italic>U</italic> <bold>r</bold><sub>[<italic>t</italic>−1]</sub> is replaced by <inline-formula><inline-graphic xlink:href="578570v2_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, which denotes the learnable initial bias for the hidden units. The joint probability distribution of an RTRBM model with length <italic>T</italic> is found by factoring over the RBM stack over all time-steps <italic>t</italic>, … <italic>T</italic>. This procedure is written as:
<disp-formula id="eqn6">
<graphic xlink:href="578570v2_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where
<disp-formula id="eqn7">
<graphic xlink:href="578570v2_eqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Importantly, instead of using binary hidden unit states h<sub>[<italic>t</italic>−1]</sub>, sampled from the expected realvalued hidden states <bold>r</bold><sub>[<italic>t</italic>−1]</sub>, the RTRBM propagates these real-valued hidden unit states directly. This approach constitutes the mean-field approximation of the hidden states of the temporally preceding RBMs, resulting in an efficient and easily computible approximation of the temporal state at each time-step <italic>t</italic> (<xref rid="c21" ref-type="bibr">Hinton, 2002</xref>; <xref ref-type="bibr" rid="c38">Sutskever et al., 2008</xref>). The inputs <bold>r</bold><sub>[<italic>t</italic>]</sub> of the RTRBM at time-step <italic>t</italic>, given the visible unit state <italic>v</italic>, are then calculated as:
<disp-formula id="eqn8">
<graphic xlink:href="578570v2_eqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<sec id="s4b1">
<title>Training the RTRBM</title>
<p>The model parameters <italic>θ ∈</italic> {<bold><italic>W</italic></bold>, <bold><italic>U</italic></bold>, <bold>b</bold><sub>v</sub>, <bold>b</bold><sub>init</sub>, <bold>b</bold><sub>h</sub>} are learned by maximization of the log-likelihood using (stochastic) gradient ascent:
<disp-formula id="eqn9">
<graphic xlink:href="578570v2_eqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>η</italic> denotes the learning rate and where
<disp-formula id="eqn10">
<graphic xlink:href="578570v2_eqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>are the partial derivatives of the log-likelihood with respect to the model parameters. The energy function of the RTRBM can be split up into two components: a static component ℋ and a temporal component 𝒬. The gradients of the static component ℋ with respect to <italic>θ</italic> are calculated by summing over the gradients of the RBM at each time-step. The calculation of the gradients of 𝒬 with respect to <italic>θ</italic> is more complex. First, observe that 𝒬 can be computed recursively as:
<disp-formula id="eqn11">
<graphic xlink:href="578570v2_eqn11.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Hence, the backpropagation-through-time algorithm (<xref ref-type="bibr" rid="c34">Rumelhart et al., 1986</xref>) can be employed to recursively compute of gradients for 𝒬 with respect to <bold>r</bold><sub>[<italic>t</italic>]</sub>:
<disp-formula id="eqn12">
<graphic xlink:href="578570v2_eqn12.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where ⊙ denotes the element-wise product. The final step to obtain the derivative with respect to <italic>θ</italic> involves applying the chain rule:
<disp-formula id="eqn13">
<graphic xlink:href="578570v2_eqn13.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
For a more detailed derivation of these equations, we refer to <xref rid="c26" ref-type="bibr">Mittelman et al. (2014)</xref>.</p>
</sec>
<sec id="s4b2">
<title>Inference in the RTRBM</title>
<p>The RTRBM’s sequential sampling scheme, using preceding hidden- and visible states to predict subsequent time-steps, enables generating data from its learned model distribution. Initially, <bold>r</bold><sub>[<italic>t</italic>]</sub> is calculated using the previous expected hidden states and current visible states. The contrastive divergence sampling scheme is then used to sample <bold>v</bold><sub>[<italic>t</italic>+1]</sub>. Consequently, <bold>v</bold><sub>[<italic>t</italic>+1]</sub> is utilized to get the following expected hidden unit states <bold>r</bold><sub>[<italic>t</italic>+1]</sub>, and so forth. This sequential process enables the RTRBM to statistically predict events in future time-steps.</p>
<p>During model training, all time-steps <italic>T</italic> are available and it is not required to infer longer sequences. At the start of each training epoch <bold>r</bold><sub>[<italic>t</italic>]</sub> can be computed recursively up to time point <italic>T</italic>, followed by contrastive divergence performed for all time-steps in parallel. At model inference, we initialize <bold>r</bold><sub>[<italic>t</italic>]</sub> on the first time-step of each test batch and sample multiple time-steps into the future using the Gibbs sampling scheme (see <xref rid="fig2" ref-type="fig">Figure 2G</xref>). By comparing the inferred data with the remainder of the test data batch, we quantify the extent to which the RTRBM accurately captures the statistics of neural data across time (see also Performance metrics).</p>
</sec>
</sec>
<sec id="s4c">
<title>Model-generated simulated data</title>
<p>The simulated data is generated according to the following principles: <italic>N</italic><sub><italic>h</italic></sub> hidden units represent population activities that are temporally connected through a set of weights <italic>U</italic>. The activity of a single hidden unit is represented as a time-varying firing rate. Each hidden unit activity is the combination of two sources: (1) An intrinsic, time-varying firing rate, generated by two instances of randomly timed peaks (where the inter-peak interval is randomly drawn as ISI ∼ Uniform (<italic>t</italic><sub>1</sub>, <italic>t</italic><sub>2</sub>)) convolved with normalized Gaussian-shaped signals (<italic>ϕ</italic>(<italic>x</italic>; <italic>t, σ</italic>), where <italic>σ</italic> ∼ Uniform(<italic>σ</italic><sub>1</sub>, <italic>σ</italic><sub>2</sub>) and where <italic>ϕ</italic>(<italic>x</italic>) signifies the standard Gaussian cumulative distribution function). Both of the resulting instances are subsequently renormalized to be in the intervals [0, <italic>f</italic><sub>max</sub>/10] and [0, <italic>f</italic><sub>max</sub>] respectively, and are summed together. The final signal is denoted <inline-formula><inline-graphic xlink:href="578570v2_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and represents the firing rates of hidden unit <italic>i</italic>. (2) Recurrent interactions of firing rates between the hidden units at a delay of Δ<italic>t</italic><sub><italic>A</italic></sub>, according to
<disp-formula id="eqn14">
<graphic xlink:href="578570v2_eqn14.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>ϕ</italic> limits the output to the interval [0,3<italic>f</italic><sub>max</sub>]. The strength of the temporal interactions between hidden units is given by the entries in <italic>U</italic>, with positive and negative entries representing excitatory and inhibitory interactions respectively.</p>
<p>Each hidden unit connects to a distinct set of <italic>N</italic><sub><italic>v</italic> per unit</sub> visible units, yielding a total of <italic>N</italic><sub><italic>v</italic></sub> = <italic>N</italic><sub><italic>h</italic></sub> ⋅ <italic>N</italic><sub><italic>v</italic> per unit</sub> visible units, and their activity <italic>v</italic><sub><italic>i</italic></sub> is independently drawn from a Poisson distribution whose rate over time is given by the rate <italic>λ</italic><sub><italic>h</italic></sub> of the corresponding hidden unit, scaled by a different constant for each visible unit taken from the range (<italic>c</italic><sub>1</sub>, <italic>c</italic><sub>2</sub>). The first <italic>t</italic><sub>settle</sub> time points are removed from the simulated data as the initial activity is different from the long term interacting dynamics. The parameters for the data generating model were set to <italic>N</italic><sub><italic>h</italic></sub> = 10, <italic>N</italic><sub><italic>v</italic> per unit</sub> = 20, <italic>t</italic><sub>1</sub> = 5, <italic>t</italic><sub>2</sub> = 10, <italic>σ</italic><sub>1</sub> = 0.1, <italic>σ</italic><sub>2</sub> = 0.5, <italic>c</italic><sub>1</sub> = 0.6, <italic>c</italic><sub>2</sub> = 1.4, <italic>t</italic><sub>settle</sub> = 25 and <italic>f</italic><sub>max</sub> = 0.8. The temporal connectivity matrix <italic>U</italic> was configured such that each population is both excited and inhibited by one of the other populations, and scaled in such a way that the resulting activity is mainly determined by the interactions (<xref rid="fig2" ref-type="fig">Figure 2A</xref> shows a graphical representation of the data generation pipeline).</p>
<p>For model training and evaluation, the generated simulated data was divided into a train- and test-set. Model inference is used for generating samples from trained RBM/RTRBM models to evaluate their performance. At model inference, the models are initialized on the first time-step of the test batch, and the subsequent time-steps are inferred through Gibbs sampling. The inferred data is then compared to the ground-truth test data through several statistics: (1) The MSE between inferred and test data, which measures how well the models can reproduce unseen activity of visible units. (2) The mean activation of the visible units ⟨<italic>v</italic><sub><italic>i</italic></sub>⟩, also referred to as the first order moments. (3) Pairwise moments between the visible units ⟨ <italic>v</italic><sub><italic>i</italic></sub> <italic>v</italic><sub><italic>j</italic></sub> ⟩, also denoted as second-order statistics. These pairwise moments assess the model’s ability to capture data statistics it is not explicitly trained on. (4) Time-shifted pairwise moments of the visible and hidden units, i.e. <inline-formula><inline-graphic xlink:href="578570v2_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="578570v2_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, respectively. More details on how these statistics are calculated can be found in Performance metrics.</p>
</sec>
<sec id="s4d">
<title>Zebrafish data</title>
<p>Whole-brain single-cell functional recordings for 15 zebrafish larvae were recorded by means of light-sheet microscopy in the lab of G. Debregeas, 8 of which are used in this study (see <xref rid="c32" ref-type="bibr">van der Plas et al., 2023</xref> for a more detailed description of both the data acquisition process and subsequent data processing). These datasets are publicly available and can be found at <ext-link ext-link-type="uri" xlink:href="https://gin.g-node.org/vdplasthijs/cRBM_zebrafish_spontaneous_data">https://gin.g-node.org/vdplasthijs/cRBM_zebrafish_spontaneous_data</ext-link>. In summary, the datasets consist on average of 40, 709 ± 13, 854 neurons, recorded for 5836 ± 1183 time-steps, at a frequency of 3.9 ± 0.8 Hz. The zebrafish larvae are 5-7 days post-fertilization and expressed GCaMP6s or GCaMP6f calcium reporters for imaging. The experimental procedure is described in more detail in <xref rid="c32" ref-type="bibr">van der Plas et al. (2023)</xref>. The process from data segregation to analysis is displayed in <xref rid="fig3" ref-type="fig">Figure 3</xref>. To obtain binarized spike traces that can be used by the RTRBM the individual fluorescence traces are deconvolved by blind sparse deconvolution (<xref rid="fig3" ref-type="fig">Figure 3A</xref>) (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>).</p>
<sec id="s4d1">
<title>RTRBM initialization through transfer learning</title>
<p>Through empirical evaluation, we found de novo learning of the RTRBM to not converge to a solution that satisfies the compositional-phase criteria (see The compositional phase). This is to be expected as the formulation of the RTRBM as used in this work does not feature the required elements necessary to push the model solution towards such a solution. To overcome this issue, we make use of a transfer learning strategy (<xref ref-type="bibr" rid="c39">Tan et al., 2018</xref>). More specifically, the visible-to-hidden weights <italic>W</italic> of the RTRBM models are initialized by their estimated counterparts from trained cRBM models (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>). During subsequent training of the RTRBM, we let the model to update the values of these weights with a reduced learning rate (see below). This initialization strategy is able to bias the resulting weight matrix <italic>W</italic> inferred by the RTRBM to contain a strong prior towards the localized receptive fields of the hidden units of the cRBM.</p>
<p>The hyperparameters, including the total number of hidden units for the cRBM model, were optimized by evaluating the model’s performance over a grid of hyperparameter values using one dataset. This process identified the optimal hyperparameter values, which were subsequently applied to all recordings. In our study, the number of hidden units is fixed in the RTRBM model due to the use of transfer learning. Further details on the cross-validation process can be found in (<xref ref-type="bibr" rid="c32">van der Plas et al., 2023</xref>).</p>
<p>For model training and evaluation, the functional data for each animal was divided into a train- and test-set. To this end, the functional recordings of each animal were subdivided into 10 segments of consecutive time-steps. In all cases, temporal segments 2, 6, and 7 are labeled as test sets, the remaining temporal segments are labeled as training sets. This data division strategy mirrors that of <xref rid="c32" ref-type="bibr">van der Plas et al. 2023</xref>. In practice, each segment was further subdivided into smaller batches of size 16 ± 4, enabling their computation on an Nvidia GeForce RTX 3090 24GB GPU. This resulted on average in 243 ± 67 train batches and 104 ± 29 test batches. Using transfer learning, we trained each RTRBM for 10, 000 epochs with a learning rate of 10<sup>−3</sup>. For each epoch we calculated the gradients for 20 batches in parallel before updating the model parameters. This strategy reduced the training time to a relatively short duration of 3 hours for 10, 000 epochs calculated on an <italic>NVIDIA RTX3090</italic> GPU. To maintain neural assemblies we enforced an L1-norm sparsity regulator with its constant set to <italic>λ</italic> = 10<sup>−6</sup> (with <italic>λ</italic> = 10<sup>−7</sup> for two of the animals), and a reduced learning rate for the matrix <italic>W</italic> by two orders of magnitude (i.e. 10<sup>−5</sup>).</p>
</sec>
<sec id="s4d2">
<title>Performance evaluation and significance testing</title>
<p>The performance of both the cRBM and RTRBM models after training was evaluated through inspection of the learning moments, similar to that of the simulated data (see Performance metrics for more details). Furthermore, to test the significance of the difference in performance between the RTRBM and the cRBM, we made use of a bootstrap method. To this end, we randomly selected 1000 neurons (∼ 2% of the total population) and calculated the neural statistics for each model. This process was repeated <italic>n</italic> times with non-overlapping subsets such that each neuron only gets sampled once. For each repetition, the Spearman correlation between data and model sampled moments was calculated for each ⟨<italic>f</italic><sub><italic>k</italic></sub>⟩<sub><italic>model</italic></sub> (see <xref rid="fig2" ref-type="fig">Figure 2</xref>). We then calculated a confidence interval given by 2 standard deviations from the mean for the Spearman correlation. If the confidence intervals for the RTRBM and the cRBM did not overlap, the difference in performance was considered significant.</p>
</sec>
<sec id="s4d3">
<title>Clustering of hidden-hidden unit weights</title>
<p>To identify neural assemblies with similar temporal connectivity, agglomerative clustering is employed on the matrix <italic>Û</italic> after model training. To this end, we utilize the function <italic>AgglomerativeClustering</italic> from <italic>scikit-learn</italic> and use Ward’s method to evaluate the distance dendrogram (<xref ref-type="bibr" rid="c30">Pedregosa et al., 2011</xref>). Clustering can be applied to the incoming (row) or outgoing (column) connections of the matrix <italic>Û</italic>, in this work we apply it to the outgoing connections only. For fish 4, as shown in figure (<xref rid="fig3" ref-type="fig">Figure 3D, E</xref>), a distance threshold of 20 was used to threshold the resulting distance dendrogram, which identified 6 functional clusters. Receptive fields were determined by assigning neurons to the identified clusters based on the strength of their weight (<xref rid="fig3" ref-type="fig">Figure 3E</xref>). Here, a strong weight is determined by proportional thresholding, <italic>w</italic><sub><italic>i,j</italic></sub> &gt; <italic>w</italic><sub><italic>thr</italic></sub>. Here <italic>w</italic><sub><italic>thr</italic></sub> is set so that at least 5000 neurons have a strong connection towards the hidden layer. This mirrors the thresholding strategy used in figure <xref rid="fig3" ref-type="fig">Figure 3B</xref>.</p>
</sec>
</sec>
<sec id="s4e">
<title>Alignment of the estimated temporal weight matrix</title>
<p>In the context of the simulated data, the activity of the visible units are systematically generated in assemblies of size <inline-formula><inline-graphic xlink:href="578570v2_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Nevertheless, during the training process of the RTRBM, which solely relies on the state of the visible units, the link between each assembly and a particular hidden unit becomes arbitrary. This is, of course, under the assumption that all assemblies are retrieved correctly during the training process. Consequently, the estimated temporal weights <italic>Û</italic> can have any arbitrary ordering and is often not matched with that of the original matrix <italic>U</italic> used to generate the data, generally resulting in an invalid match between both matrices. To enable a valid comparison, the ordering of the hidden units in the estimated matrix <italic>Û</italic> is matched to those in the original matrix <italic>U</italic> by leveraging the learned visible-to-hidden unit weight matrix <italic>Ŵ</italic>. Here, as the assemblies of the visible units are known, assemblies are matched with hidden units under the assumption that an assembly of visible units is most linked to the hidden unit with the largest mean absolute visible-to-hidden weights between them (<xref rid="fig2_S1" ref-type="fig">Figure 2—figure Supplement 1A</xref>, left), calculated using the row-wise correlations with the ideal (‘diagonal’) weight matrix <italic>W</italic>. The ordering of the hidden units can then be set such that it is aligned with the ordering of the assemblies of visible units. Cases where two assemblies have the same initially matched hidden unit are resolved by sequentially assigning assemblies by order of their correlation strength to the hidden unit. These cases however generally indicate that the assemblies of visible units were not correctly captured by the model.</p>
<p>In addition to any arbitrary ordering of hidden units in the estimated matrix <italic>Û</italic>, it is possible for assemblies to form an inverse but correct match with a hidden unit. This means that the corresponding hidden unit is inactive when the corresponding assembly is active and vice versa. This phenomenon is enabled through the anti-symmetry of the activation function, and generally occurs when the weights between the assembly and the hidden unit are negative. An inverse match is identified based on the sign of the mean weight between the hidden unit and the matched assembly of visible units. In the case of an inverse match with a hidden unit, the temporal weights between this hidden unit and all the other units are inverted, resulting in sign switches in the estimated matrix <italic>Û</italic> (<xref rid="fig2_S1" ref-type="fig">Figure 2—figure Supplement 1</xref>, right). In the case of two inverted hidden units, the two temporal weights between them are unaffected as the sign switches cancel each other out.</p>
<p>Together, these corrections yield an aligned estimated temporal weight matrix <italic>Û</italic> that is more similar to the original matrix <italic>U</italic>, allowing element-wise comparisons (<xref rid="fig2_S1" ref-type="fig">Figure 2—figure Supplement 1B</xref>). All presented <italic>Û</italic> matrices for simulated data are aligned according to this procedure.</p>
</sec>
<sec id="s4f">
<title>Performance metrics</title>
<p>We evaluated model performance using multiple metrics throughout this study. More specifically, we compared between first and second order model and data statistics for both the visible and hidden units and we used the MSE on the inferred states of the visible units.</p>
<sec id="s4f1">
<title>Comparison of model and data statistics</title>
<p>The cRBM and RTRBM models are trained to optimize multiple statics. These include the mean activity of the visible units (neurons) ⟨<italic>v</italic><sub><italic>i</italic></sub>⟩, the mean activity of the hidden units ⟨<italic>h</italic><sub><italic>μ</italic></sub> ⟩ and their paired interaction ⟨<italic>v</italic><sub><italic>i</italic></sub><italic>h</italic><sub><italic>μ</italic></sub>⟩. Furthermore, one can evaluate the second-order statistics ⟨<italic>v</italic><sub><italic>i</italic></sub><italic>v</italic><sub><italic>j</italic></sub>⟩, and ⟨<italic>h</italic><sub><italic>μ</italic></sub><italic>h</italic><sub><italic>v</italic></sub> ⟩ that are not directly optimized by the models.</p>
<p>To evaluate model performance, we take these statistics and compare then between those of the empirical data ⟨<italic>f</italic><sub><italic>k</italic></sub>⟩<sub><italic>data</italic></sub> and the model ⟨<italic>f</italic><sub><italic>k</italic></sub>⟩<sub><italic>model</italic></sub>. Data statistics are calculated based on a withheld test-data set consisting of ∼30% of the data. To evaluate hidden-unit statistics for the empirical data, we use the expected value of <italic>h</italic><sub><italic>t</italic></sub> conditioned on the visible unit state <italic>v</italic><sub><italic>t</italic></sub> at time point <italic>t</italic> for the model under evaluation. Model statistics are not explicitly available and must be sampled from the model under study. To this end, model statistics ⟨<italic>f</italic><sub><italic>k</italic></sub>⟩<sub><italic>model</italic></sub> are approximated through Gibbs sampling of the visible and hidden unit states. For the simulated data, 15 steps of Gibbs sampling are used with a burn-in period of 4000 steps. This is done for 100 time points of data with a chain length of 20 time-steps. For the zebrafish data, again 15 steps of Gibbs sampling are used with a burn-in period of 4000 time-steps. Here 68-150 random time points in the test set were chosen each with a sampling chain of 14-16 time-steps. The number of time points and chain length depended on the length of the functional recording of a single data-batch, and was empirically chosen by comparing resulting performance.</p>
<p>In all cases, we subsequently measure correspondence between pairs of data and model statistics ⟨<italic>f</italic><sub><italic>k</italic></sub>⟩<sub><italic>data</italic></sub> and ⟨<italic>f</italic><sub><italic>k</italic></sub>⟩<sub><italic>model</italic></sub> by evaluating their Spearman correlation.</p>
</sec>
<sec id="s4f2">
<title>Predictive quality</title>
<p>The performance of the model in predicting the activity of visible units ahead in time is assessed through a measure of the mean squared error (MSE) between reconstructed data and a test data set. The MSE is defined as
<disp-formula id="eqn15">
<graphic xlink:href="578570v2_eqn15.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>N</italic><sub><italic>v</italic></sub> denotes the number of visible units, and <inline-formula><inline-graphic xlink:href="578570v2_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the estimated state of visible unit <italic>i</italic> at time-step <italic>t</italic>. When predicting <italic>T</italic> time-steps ahead, <inline-formula><inline-graphic xlink:href="578570v2_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula> implicitly depends on <italic>v</italic><sub><italic>i</italic></sub>(<italic>t</italic> − <italic>T</italic>) as discussed above. As the visible units only take on binary states, the MSE is equal to the mean absolute error (MAE) and is also equal to 1 minus the accuracy.</p>
<p>For interpretability, the MSE is normalised (nMSE) such that nMSE = 1 corresponds to a naive unbiased estimator and 0 to an optimal estimator when considering the MSE arising from inherent stochasticity.
<disp-formula id="eqn16">
<graphic xlink:href="578570v2_eqn16.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
With MSE<sub>naive</sub> and MSE<sub>var</sub> explained below.</p>
</sec>
</sec>
<sec id="s4g">
<title>Determining error bounds for simulated data</title>
<p>For the simulated data, the model predictive performance would be directly interpretable if the model generating the data was completely deterministic. However, the model used in this work features multiple stochastic components. To gain insight into model performance for simulated data, it is thus necessary to infer statistically meaningful bounds on performance with respect to the generating model. To this end, we here describe methods used for estimating both a lower- and an upper-bound for the generating model used in this work.</p>
<sec id="s4g1">
<title>Lower-bound estimation</title>
<p>As described in the methods above, the state of the visible units is sampled through a Poisson distribution from the assembly activity consisting of (1) an intrinsic, time-varying firing rate, generated by randomly timed, Gaussian-shaped variations of firing rate, and (2) recurrent, delayed interactions of firing rates between the hidden populations with interaction time Δ<italic>t</italic><sub><italic>A</italic></sub>. It is straightforward to estimate the variance in a Poisson sampling process under a known distribution of assembly traces. However, the intrinsic firing rates of the artificial neural assemblies are complicated to describe with theoretical distributions. The exact calculation of this theoretical bound is thus rather complex. Furthermore, one must make a distinction between an estimator with perfect knowledge of the assembly state at the previous time-step, an <italic>ideal estimator</italic>, and a <italic>real estimator</italic> that must approximate this assembly state, such as the RTRBM. A representative lower-bound thus includes this source of stochasticity.</p>
<p>To obtain a lower-bound that includes these notions, we turn to empirical methods. To this end, the assembly activity in a previous time-step is initialized to a fixed, known state. Then, the temporal interactions are calculated to obtain the deterministic assembly activity after an interval Δ<italic>t</italic><sub><italic>A</italic></sub> time-steps, which are added to different samples from the intrinsic assembly activity to obtain the full assembly state. Poisson sampling is performed on two such states and the MSE is calculated between them. This corresponds to the performance of an ideal model in predicting the state of the visible units ahead by a time equivalent to the interaction delay, with perfect knowledge of the underlying dynamics, and yields sets of MSE samples incorporating all aforementioned sources of stochasticity.</p>
<p>For a representative distribution of the possible states, 10, 000 known assembly activity states are randomly sampled from the original test data, which form the fixed previous time-step. Next, 2×200 random instances of the intrinsic assembly activities are added as described above per initial state, and samples are taken twice from each of the 200 pairs of states. As in our case MSE = MAE is a linear metric, the mean MSE is taken over all initial states and all random intrinsic states, which is our estimate MSE<sub>var</sub> The uncertainty in this estimate is quantified as the standard error of the mean, and is calculated by seeing each average MSE per initial state as an estimate of the mean.</p>
</sec>
<sec id="s4g2">
<title>Upper-bound estimation</title>
<p>An upper-bound is determined through a representative naive estimator. Here, we define this naive estimator with the expected firing rate of each visible unit <inline-formula><inline-graphic xlink:href="578570v2_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, such that the estimator is unbiased by definition. The MSE reached by this estimator can be precisely calculated as MSE<sub>naive</sub> = ⟨2 ⟨<italic>v</italic><sub><italic>i</italic></sub>⟩ (1 − ⟨<italic>v</italic><sub><italic>i</italic></sub> ⟩)⟩. The choice of this unbiased estimator is especially important in the case of sparse activity traces as dealt with here. It is easy to see that a lower MSE is reached by the (biased) estimator <inline-formula><inline-graphic xlink:href="578570v2_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with MSE = ⟨<italic>v</italic><sub>i</sub>⟩. It is worth noting that in the context of down-sampling experiments, even though all models are assessed using the same test dataset, the act of downsampling yields a similar but different mean activity ⟨ <italic>v</italic><sub><italic>i</italic></sub>⟩, resulting in a slightly different theoretical estimate of the MSE of the naive unbiased estimator.</p>
</sec>
</sec>
</sec>
</body>
<back>
<sec id="s5">
<title>Code and data availability</title>
<p>The RTRBM models described in this study have been implemented in Python 3.7. Packages used for model implementation, analysis and data visualization include Numpy (<xref ref-type="bibr" rid="c17">Harris et al., 2020</xref>), Scipy (<xref ref-type="bibr" rid="c43">Virtanen et al., 2020</xref>), Pytorch (<xref rid="c29" ref-type="bibr">Paszke et al., 2019</xref>), Scikit-learn (<xref ref-type="bibr" rid="c30">Pedregosa et al., 2011</xref>), matplotlib (<xref ref-type="bibr" rid="c22">Hunter, 2007</xref>), Pandas (<xref ref-type="bibr" rid="c25">Wes McKinney, 2010</xref>), Seaborn (<xref ref-type="bibr" rid="c44">Waskom et al., 2017</xref>), h5py (<xref ref-type="bibr" rid="c12">Collette, 2013</xref>). Separate notebooks are available allowing for recreation of each individual figure presented in this paper. All code accompanying this paper is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/benglitz/Zebrafish_RTRBM">https://github.com/benglitz/Zebrafish_RTRBM</ext-link>. All accompanying data is hosted at <ext-link ext-link-type="uri" xlink:href="https://osf.io/tx2vz/?view_only=94cbae609ad64fb58340728ede721f89">https://osf.io/tx2vz/?view_only=94cbae609ad64fb58340728ede721f89</ext-link>. The model-generated simulated data is seeded and can easily be generated through the accompanying notebooks. All functional whole-brain datasets were obtained in the lab of G. Debregeas and are publicly available at <ext-link ext-link-type="uri" xlink:href="https://gin.g-node.org/vdplasthijs/cRBM_zebrafish_spontaneous_data">https://gin.g-node.org/vdplasthijs/cRBM_zebrafish_spontaneous_data</ext-link>. Copies of the zebrafish datasets used in this project can additionally be found at the data share accompanying this project.</p>
</sec>
<sec id="s6">
<title>Author Contributions</title>
<p>SQM: Software, Visualization, Methodology, Formal analysis, Writing - Original Draft, Data Curation; CP: Software, Visualization, Formal analysis, Methodology, Writing - Original Draft; LWH: Software, Visualization, Methodology, Writing - Original Draft, Writing - Review &amp; Editing, Supervision, Data Curation; KS: Software, Visualization, Writing - Original Draft; BE: Writing - Review &amp; Editing, Software, Supervision, Resources, Funding acquisition, Project administration</p>
</sec>
<sec id="s7">
<title>Declaration of interests</title>
<p>The authors declare no competing interests.</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>We would like to thank T. van de Plas and G. Tubiana for technical discussions. BE acknowledges funding from an NWO VIDI grant (016.Vidi.189.052).</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ackley</surname> <given-names>DH</given-names></string-name>, <string-name><surname>Hinton</surname> <given-names>GE</given-names></string-name>, <string-name><surname>Sejnowski</surname> <given-names>TJ</given-names></string-name></person-group>. <article-title>A learning algorithm for Boltzmann machines</article-title>. <source>Cognitive science</source>. <year>1985</year>; <volume>9</volume>(<issue>1</issue>):<fpage>147</fpage>–<lpage>169</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ahrens</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Orger</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Robson</surname> <given-names>DN</given-names></string-name>, <string-name><surname>Li</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Keller</surname> <given-names>PJ</given-names></string-name></person-group>. <article-title>Whole-brain functional imaging at cellular resolution using light-sheet microscopy</article-title>. <source>Nature methods</source>. <year>2013</year>; <volume>10</volume>(<issue>5</issue>):<fpage>413</fpage>–<lpage>420</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bahl</surname> <given-names>A</given-names></string-name>, <string-name><surname>Engert</surname> <given-names>F.</given-names></string-name></person-group> <article-title>Neural circuits for evidence accumulation and decision making in larval zebrafish</article-title>. <source>Nat Neurosci</source>. <year>2020</year> <month>Jan</month>; <volume>23</volume>(<issue>1</issue>):<fpage>94</fpage>–<lpage>102</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bargmann</surname> <given-names>CI</given-names></string-name>, <string-name><surname>Marder</surname> <given-names>E.</given-names></string-name></person-group> <article-title>From the connectome to brain function</article-title>. <source>Nature methods</source>. <year>2013</year>; <volume>10</volume>(<issue>6</issue>):<fpage>483</fpage>–<lpage>490</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Betzel</surname> <given-names>RF</given-names></string-name></person-group>. <article-title>Organizing principles of whole-brain functional connectivity in zebrafish larvae</article-title>. <source>Network Neuroscience</source>. <year>2020</year> 03; <volume>4</volume>(<issue>1</issue>):<fpage>234</fpage>–<lpage>256</lpage>. doi: <pub-id pub-id-type="doi">10.1162/netn_a_00121</pub-id>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bianco</surname> <given-names>IH</given-names></string-name>, <string-name><surname>Engert</surname> <given-names>F.</given-names></string-name></person-group> <article-title>Visuomotor Transformations Underlying Hunting Behavior in Zebrafish</article-title>. <source>Current Biology</source>. <year>2015</year>; <volume>25</volume>(<issue>7</issue>):<fpage>831</fpage>–<lpage>846</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0960982215000743">https://www.sciencedirect.com/science/article/pii/S0960982215000743</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.cub.2015.01.042</pub-id>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boltzmann</surname> <given-names>L.</given-names></string-name></person-group> <article-title>Studien uber das Gleichgewicht der lebenden Kraft</article-title>. <source>Wissenschafiliche Abhandlungen</source>. <year>1868</year>; <volume>1</volume>:<fpage>49</fpage>–<lpage>96</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bouchard</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Voleti</surname> <given-names>V</given-names></string-name>, <string-name><surname>Mendes</surname> <given-names>CS</given-names></string-name>, <string-name><surname>Lacefield</surname> <given-names>C</given-names></string-name>, <string-name><surname>Grueber</surname> <given-names>WB</given-names></string-name>, <string-name><surname>Mann</surname> <given-names>RS</given-names></string-name>, <string-name><surname>Bruno</surname> <given-names>RM</given-names></string-name>, <string-name><surname>Hillman</surname> <given-names>EMC</given-names></string-name></person-group>. <article-title>Swept confocally-aligned planar excitation (SCAPE) microscopy for high-speed volumetric imaging of behaving organisms</article-title>. <source>Nature Photonics</source>. <year>2015</year> <month>Feb</month>; <volume>9</volume>(<issue>2</issue>):<fpage>113</fpage>–<lpage>119</lpage>. doi: <pub-id pub-id-type="doi">10.1038/nphoton.2014.323</pub-id>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Boulanger-Lewandowski</surname> <given-names>N</given-names></string-name>, <string-name><surname>Bengio</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Vincent</surname> <given-names>P.</given-names></string-name></person-group> <article-title>Modeling temporal dependencies in high-dimensional sequences: Application to polyphonic music generation and transcription</article-title>. <source>arXiv</source>. <year>2012</year>;.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Carreira-Perpinan</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Hinton</surname> <given-names>G.</given-names></string-name></person-group> <article-title>On contrastive divergence learning</article-title>. <source>International workshop on artificial intelligence and statistics</source> <publisher-name>PMLR</publisher-name>; <year>2005</year>. p. <fpage>33</fpage>–<lpage>40</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname> <given-names>X</given-names></string-name>, <string-name><surname>Mu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Hu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Kuan</surname> <given-names>AT</given-names></string-name>, <string-name><surname>Nikitchenko</surname> <given-names>M</given-names></string-name>, <string-name><surname>Randlett</surname> <given-names>O</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>AB</given-names></string-name>, <string-name><surname>Gavornik</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Sompolinsky</surname> <given-names>H</given-names></string-name>, <string-name><surname>Engert</surname> <given-names>F</given-names></string-name>, <string-name><surname>Ahrens</surname> <given-names>MB</given-names></string-name></person-group>. <article-title>Brain-wide Organization of Neuronal Activity and Convergent Sensorimotor Transformations in Larval Zebrafish</article-title>. <source>Neuron</source>. <year>2018</year>; <volume>100</volume>(<issue>4</issue>):<fpage>876</fpage>–<lpage>890.e5.</lpage> <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0896627318308444">https://www.sciencedirect.com/science/article/pii/S0896627318308444</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2018.09.042</pub-id>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Collette</surname> <given-names>A.</given-names></string-name></person-group> <source>Python and HDF5</source>. <publisher-name>O’Reilly</publisher-name>; <year>2013</year>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Das</surname> <given-names>A</given-names></string-name>, <string-name><surname>Fiete</surname> <given-names>IR</given-names></string-name></person-group>. <article-title>Systematic errors in connectivity inferred from activity in strongly recurrent networks</article-title>. <source>Nature Neuroscience</source>. <year>2020</year>; <volume>23</volume>(<issue>10</issue>):<fpage>1286</fpage>–<lpage>1296</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dunn</surname> <given-names>TW</given-names></string-name>, <string-name><surname>Mu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Narayan</surname> <given-names>S</given-names></string-name>, <string-name><surname>Randlett</surname> <given-names>O</given-names></string-name>, <string-name><surname>Naumann</surname> <given-names>EA</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>CT</given-names></string-name>, <string-name><surname>Schier</surname> <given-names>AF</given-names></string-name>, <string-name><surname>Freeman</surname> <given-names>J</given-names></string-name>, <string-name><surname>Engert</surname> <given-names>F</given-names></string-name>, <string-name><surname>Ahrens</surname> <given-names>MB</given-names></string-name></person-group>. <article-title>Brainwide mapping of neural activity controlling zebrafish exploratory locomotion</article-title>. <source>eLife</source>. <year>2016</year> <month>mar</month>; <volume>5</volume>:<fpage>e12741</fpage>. doi: <pub-id pub-id-type="doi">10.7554/eLife.12741</pub-id>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gerstein</surname> <given-names>GL</given-names></string-name>, <string-name><surname>Bedenbaugh</surname> <given-names>P</given-names></string-name>, <string-name><surname>Aertsen</surname> <given-names>AM</given-names></string-name></person-group>. <article-title>Neuronal assemblies</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>. <year>1989</year>; <volume>36</volume>(<issue>1</issue>):<fpage>4</fpage>–<lpage>14</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Goodfellow</surname> <given-names>I</given-names></string-name>, <string-name><surname>Bengio</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Courville</surname> <given-names>A.</given-names></string-name></person-group> <source>Deep Learning</source>. <publisher-name>MIT Press</publisher-name>; <year>2016</year>. <ext-link ext-link-type="uri" xlink:href="http://www.deeplearningbook.org">http://www.deeplearningbook.org</ext-link>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname> <given-names>CR</given-names></string-name>, <string-name><surname>Millman</surname> <given-names>KJ</given-names></string-name>, <string-name><surname>van der Walt</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Gommers</surname> <given-names>R</given-names></string-name>, <string-name><surname>Virtanen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Cournapeau</surname> <given-names>D</given-names></string-name>, <string-name><surname>Wieser</surname> <given-names>E</given-names></string-name>, <string-name><surname>Taylor</surname> <given-names>J</given-names></string-name>, <string-name><surname>Berg</surname> <given-names>S</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Kern</surname> <given-names>R</given-names></string-name>, <string-name><surname>Picus</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hoyer</surname> <given-names>S</given-names></string-name>, <string-name><surname>van Kerkwijk</surname> <given-names>MH</given-names></string-name>, <string-name><surname>Brett</surname> <given-names>M</given-names></string-name>, <string-name><surname>Haldane</surname> <given-names>A</given-names></string-name>, <string-name><surname>del Río</surname> <given-names>JF</given-names></string-name>, <string-name><surname>Wiebe</surname> <given-names>M</given-names></string-name>, <string-name><surname>Peterson</surname> <given-names>P</given-names></string-name>, <string-name><surname>Gérard-Marchant</surname> <given-names>P</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Array programming with NumPy</article-title>. <source>Nature</source>. <year>2020</year> <month>Sep</month>; <volume>585</volume>(<issue>7825</issue>):<fpage>357</fpage>–<lpage>362</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41586-020-2649-2</pub-id>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Harris</surname> <given-names>KD</given-names></string-name></person-group>. <article-title>Neural signatures of cell assembly organization</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2005</year>; <volume>6</volume>(<issue>5</issue>):<fpage>399</fpage>–<lpage>407</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hebb</surname> <given-names>DO</given-names></string-name></person-group>. <article-title>The first stage of perception: growth of the assembly</article-title>. <source>The Organization of Behavior</source>. <year>1949</year>; <volume>4</volume>:<fpage>60</fpage>–<lpage>78</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Helmstaedter</surname> <given-names>M.</given-names></string-name></person-group> <article-title>The mutual inspirations of machine learning and neuroscience</article-title>. <source>Neuron</source>. <year>2015</year>; <volume>86</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>28</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hinton</surname> <given-names>GE</given-names></string-name></person-group>. <article-title>Training products of experts by minimizing contrastive divergence</article-title>. <source>Neural computation</source>. <year>2002</year>; <volume>14</volume>(<issue>8</issue>):<fpage>1771</fpage>–<lpage>1800</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hunter</surname> <given-names>JD</given-names></string-name></person-group>. <article-title>Matplotlib: A 2D graphics environment</article-title>. <source>Computing in Science &amp; Engineering</source>. <year>2007</year>; <volume>9</volume>(<issue>3</issue>):<fpage>90</fpage>–<lpage>95</lpage>. doi: <pub-id pub-id-type="doi">10.1109/MCSE.2007.55</pub-id>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kullback</surname> <given-names>S</given-names></string-name>, <string-name><surname>Leibler</surname> <given-names>RA</given-names></string-name></person-group>. <article-title>On information and sufficiency</article-title>. <source>The annals of mathematical statistics</source>. <year>1951</year>; <volume>22</volume>(<issue>1</issue>):<fpage>79</fpage>– <lpage>86</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname> <given-names>J</given-names></string-name>, <string-name><surname>Yu</surname> <given-names>ZL</given-names></string-name>, <string-name><surname>Gu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>W</given-names></string-name>, <string-name><surname>Li</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Jin</surname> <given-names>L.</given-names></string-name></person-group> <article-title>A hybrid network for ERP detection and analysis based on restricted Boltzmann machine</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source>. <year>2018</year>; <volume>26</volume>(<issue>3</issue>):<fpage>563</fpage>–<lpage>572</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><given-names>Wes</given-names> <surname>McKinney</surname></string-name></person-group>. <article-title>Data Structures for Statistical Computing in Python</article-title>. <source>Proceedings of the 9th Python in Science Conference</source>; <year>2010</year>. p. <fpage>56</fpage>–<lpage>61</lpage>. doi: <pub-id pub-id-type="doi">10.25080/Majora-92bf1922-00a</pub-id>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Mittelman</surname> <given-names>R</given-names></string-name>, <string-name><surname>Kuipers</surname> <given-names>B</given-names></string-name>, <string-name><surname>Savarese</surname> <given-names>S</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>H.</given-names></string-name></person-group> <article-title>Structured recurrent temporal restricted boltzmann machines</article-title>. <source>International Conference on Machine Learning</source> <publisher-name>PMLR</publisher-name>; <year>2014</year>. p. <fpage>1647</fpage>–<lpage>1655</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname> <given-names>HD</given-names></string-name>, <string-name><surname>Ullmann</surname> <given-names>JFP</given-names></string-name>, <string-name><surname>McLachlan</surname> <given-names>GJ</given-names></string-name>, <string-name><surname>Voleti</surname> <given-names>V</given-names></string-name>, <string-name><surname>Li</surname> <given-names>W</given-names></string-name>, <string-name><surname>Hillman</surname> <given-names>EMC</given-names></string-name>, <string-name><surname>Reutens</surname> <given-names>DC</given-names></string-name>, <string-name><surname>Janke</surname> <given-names>AL</given-names></string-name></person-group>. <article-title>Whole-volume clustering of time series data from zebrafish brain calcium images via mixture modeling</article-title>. <source>Stat Anal Data Min</source>. <year>2018</year> <month>Feb</month>; <volume>11</volume>(<issue>1</issue>):<fpage>5</fpage>–<lpage>16</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Pao</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>C</given-names></string-name>, <string-name><surname>Park</surname> <given-names>J</given-names></string-name>, <string-name><surname>Takahashi</surname> <given-names>K</given-names></string-name>, <string-name><surname>Watanakeesuntorn</surname> <given-names>W</given-names></string-name>, <string-name><surname>Natsukawa</surname> <given-names>H</given-names></string-name>, <string-name><surname>Chalasani</surname> <given-names>SH</given-names></string-name>, <string-name><surname>Lorimer</surname> <given-names>T</given-names></string-name>, <string-name><surname>Takano</surname> <given-names>R</given-names></string-name>, <string-name><surname>Rungratsameetaweemana</surname> <given-names>N</given-names></string-name>, <string-name><surname>Sugihara</surname> <given-names>G</given-names></string-name></person-group>, <article-title>Experimentally testable whole brain manifolds that recapitulate behavior</article-title>; <source>arXiv</source> <year>2021</year>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Paszke</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gross</surname> <given-names>S</given-names></string-name>, <string-name><surname>Massa</surname> <given-names>F</given-names></string-name>, <string-name><surname>Lerer</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bradbury</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chanan</surname> <given-names>G</given-names></string-name>, <string-name><surname>Killeen</surname> <given-names>T</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Gimelshein</surname> <given-names>N</given-names></string-name>, <string-name><surname>Antiga</surname> <given-names>L</given-names></string-name>, <string-name><surname>Desmaison</surname> <given-names>A</given-names></string-name>, <string-name><surname>Kopf</surname> <given-names>A</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>E</given-names></string-name>, <string-name><surname>DeVito</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Raison</surname> <given-names>M</given-names></string-name>, <string-name><surname>Tejani</surname> <given-names>A</given-names></string-name>, <string-name><surname>Chilamkurthy</surname> <given-names>S</given-names></string-name>, <string-name><surname>Steiner</surname> <given-names>B</given-names></string-name>, <string-name><surname>Fang</surname> <given-names>L</given-names></string-name>, <string-name><surname>Bai</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>PyTorch: An Imperative Style, High-Performance Deep Learning Library</article-title>. <source>Advances in Neural Information Processing Systems</source> <volume>32</volume> <publisher-name>Curran Associates, Inc</publisher-name>.; <year>2019</year>. <fpage>8024</fpage>–<lpage>8035</lpage>. <ext-link ext-link-type="uri" xlink:href="http://papers.neurips.cc/paper/9015-pytorch-an-imperative-style-high-performance-deep-learning-library.pdf">http://papers.neurips.cc/paper/9015-pytorch-an-imperative-style-high-performance-deep-learning-library.pdf</ext-link>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pedregosa</surname> <given-names>F</given-names></string-name>, <string-name><surname>Varoquaux</surname> <given-names>G</given-names></string-name>, <string-name><surname>Gramfort</surname> <given-names>A</given-names></string-name>, <string-name><surname>Michel</surname> <given-names>V</given-names></string-name>, <string-name><surname>Thirion</surname> <given-names>B</given-names></string-name>, <string-name><surname>Grisel</surname> <given-names>O</given-names></string-name>, <string-name><surname>Blondel</surname> <given-names>M</given-names></string-name>, <string-name><surname>Prettenhofer</surname> <given-names>P</given-names></string-name>, <string-name><surname>Weiss</surname> <given-names>R</given-names></string-name>, <string-name><surname>Dubourg</surname> <given-names>V</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Scikit-learn: Machine learning in Python</article-title>. <source>Journal of machine learning research</source>. <year>2011</year>; <volume>12</volume>(<issue>Oct</issue>):<fpage>2825</fpage>–<lpage>2830</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Petrucco</surname> <given-names>L</given-names></string-name>, <string-name><surname>Lavian</surname> <given-names>H</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>YK</given-names></string-name>, <string-name><surname>Svara</surname> <given-names>F</given-names></string-name>, Š<string-name><surname>tih</surname> <given-names>V</given-names></string-name>, <string-name><surname>Portugues</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Neural dynamics and architecture of the heading direction circuit in zebrafish</article-title>. <source>Nat Neurosci</source>. <year>2023</year> <month>May</month>; <volume>26</volume>(<issue>5</issue>):<fpage>765</fpage>–<lpage>773</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van der Plas</surname> <given-names>TL</given-names></string-name>, <string-name><surname>Tubiana</surname> <given-names>J</given-names></string-name>, <string-name><surname>Le Goc</surname> <given-names>G</given-names></string-name>, <string-name><surname>Migault</surname> <given-names>G</given-names></string-name>, <string-name><surname>Kunst</surname> <given-names>M</given-names></string-name>, <string-name><surname>Baier</surname> <given-names>H</given-names></string-name>, <string-name><surname>Bormuth</surname> <given-names>V</given-names></string-name>, <string-name><surname>Englitz</surname> <given-names>B</given-names></string-name>, <string-name><surname>Debrégeas</surname> <given-names>G.</given-names></string-name></person-group> <article-title>Neural assemblies uncovered by generative modeling explain whole-brain activity statistics and re?ect structural connectivity</article-title>. <source>eLife</source>. <year>2023</year> <month>jan</month>; <volume>12</volume>:<fpage>e83139</fpage>. doi: <pub-id pub-id-type="doi">10.7554/eLife.83139</pub-id>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Privat</surname> <given-names>M</given-names></string-name>, <string-name><surname>Romano</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Pietri</surname> <given-names>T</given-names></string-name>, <string-name><surname>Jouary</surname> <given-names>A</given-names></string-name>, <string-name><surname>Boulanger-Weill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Elbaz</surname> <given-names>N</given-names></string-name>, <string-name><surname>Duchemin</surname> <given-names>A</given-names></string-name>, <string-name><surname>Soares</surname> <given-names>D</given-names></string-name>, <string-name><surname>Sumbre</surname> <given-names>G.</given-names></string-name></person-group> <article-title>Sensorimotor Transformations in the Zebrafish Auditory System</article-title>. <source>Current Biology</source>. <year>2019</year>; <volume>29</volume>(<issue>23</issue>):<fpage>4010</fpage>–<lpage>4023.e4.</lpage> <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0960982219313600">https://www.sciencedirect.com/science/article/pii/S0960982219313600</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.cub.2019.10.020</pub-id>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rumelhart</surname> <given-names>DE</given-names></string-name>, <string-name><surname>Hinton</surname> <given-names>GE</given-names></string-name>, <string-name><surname>Williams</surname> <given-names>RJ</given-names></string-name></person-group>. <article-title>Learning representations by back-propagating errors</article-title>. <source>Nature</source>. <year>1986</year>; <volume>323</volume>(<issue>6088</issue>):<fpage>533</fpage>–<lpage>536</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Salakhutdinov</surname> <given-names>R</given-names></string-name>, <string-name><surname>Mnih</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hinton</surname> <given-names>G.</given-names></string-name></person-group> <article-title>Restricted Boltzmann machines for collaborative filtering</article-title>. <source>Proceedings of the 24th international conference on Machine learning</source>; <year>2007</year>. p. <fpage>791</fpage>–<lpage>798</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Smolensky</surname> <given-names>P.</given-names></string-name></person-group> <chapter-title>Information processing in dynamical systems: Foundations of harmony theory</chapter-title>. <source>Parallel Distributed Processing: Explorations in the Microstructure of Cognition, vol 1: Foundations</source>. <year>1986</year>; p. <fpage>194</fpage>–<lpage>281</lpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Strogatz</surname> <given-names>SH</given-names></string-name></person-group>. <source>Nonlinear Dynamics and Chaos: With Applications to Physics, Biology, Chemistry and Engineering</source>. <publisher-name>Westview Press</publisher-name>; <year>2000</year>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sutskever</surname> <given-names>I</given-names></string-name>, <string-name><surname>Hinton</surname> <given-names>GE</given-names></string-name>, <string-name><surname>Taylor</surname> <given-names>GW</given-names></string-name></person-group>. <article-title>The recurrent temporal restricted boltzmann machine</article-title>. <source>Advances in neural information processing systems</source>. <year>2008</year>; <volume>21</volume>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Tan</surname> <given-names>C</given-names></string-name>, <string-name><surname>Sun</surname> <given-names>F</given-names></string-name>, <string-name><surname>Kong</surname> <given-names>T</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>W</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>C</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>C.</given-names></string-name></person-group> <article-title>A survey on deep transfer learning</article-title>. <source>International conference on artificial neural networks</source> <publisher-name>Springer</publisher-name>; <year>2018</year>. p. <fpage>270</fpage>–<lpage>279</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tubiana</surname> <given-names>J</given-names></string-name>, <string-name><surname>Cocco</surname> <given-names>S</given-names></string-name>, <string-name><surname>Monasson</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Learning compositional representations of interacting systems with restricted boltzmann machines: Comparative study of lattice proteins</article-title>. <source>Neural computation</source>. <year>2019</year>; <volume>31</volume>(<issue>8</issue>):<fpage>1671</fpage>–<lpage>1717</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tubiana</surname> <given-names>J</given-names></string-name>, <string-name><surname>Cocco</surname> <given-names>S</given-names></string-name>, <string-name><surname>Monasson</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Learning protein constitutive motifs from sequence data</article-title>. <source>Elife</source>. <year>2019</year>; <volume>8</volume>:<fpage>e39397</fpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tubiana</surname> <given-names>J</given-names></string-name>, <string-name><surname>Monasson</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Emergence of compositional representations in restricted Boltzmann machines</article-title>. <source>Physical review letters</source>. <year>2017</year>; <volume>118</volume>(<issue>13</issue>):<fpage>138301</fpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virtanen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Gommers</surname> <given-names>R</given-names></string-name>, <string-name><surname>Oliphant</surname> <given-names>TE</given-names></string-name>, <string-name><surname>Haberland</surname> <given-names>M</given-names></string-name>, <string-name><surname>Reddy</surname> <given-names>T</given-names></string-name>, <string-name><surname>Cournapeau</surname> <given-names>D</given-names></string-name>, <string-name><surname>Burovski</surname> <given-names>E</given-names></string-name>, <string-name><surname>Peterson</surname> <given-names>P</given-names></string-name>, <string-name><surname>Weckesser</surname> <given-names>W</given-names></string-name>, <string-name><surname>Bright</surname> <given-names>J</given-names></string-name>, <string-name><surname>van der Walt</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Brett</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>J</given-names></string-name>, <string-name><surname>Millman</surname> <given-names>KJ</given-names></string-name>, <string-name><surname>Mayorov</surname> <given-names>N</given-names></string-name>, <string-name><surname>Nelson</surname> <given-names>ARJ</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>E</given-names></string-name>, <string-name><surname>Kern</surname> <given-names>R</given-names></string-name>, <string-name><surname>Larson</surname> <given-names>E</given-names></string-name>, <string-name><surname>Carey</surname> <given-names>CJ</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python</article-title>. <source>Nature Methods</source>. <year>2020</year>; <volume>17</volume>:<fpage>261</fpage>–<lpage>272</lpage>. doi: <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="software"><person-group person-group-type="author"><string-name><surname>Waskom</surname> <given-names>M</given-names></string-name>, <string-name><surname>Botvinnik</surname> <given-names>O</given-names></string-name>, <string-name><surname>O’Kane</surname> <given-names>D</given-names></string-name>, <string-name><surname>Hobson</surname> <given-names>P</given-names></string-name>, <string-name><surname>Lukauskas</surname> <given-names>S</given-names></string-name>, <string-name><surname>Gemperline</surname> <given-names>DC</given-names></string-name>, <string-name><surname>Augspurger</surname> <given-names>T</given-names></string-name>, <string-name><surname>Halchenko</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Cole</surname> <given-names>JB</given-names></string-name>, <string-name><surname>Warmenhoven</surname> <given-names>J</given-names></string-name>, <string-name><surname>de Ruiter</surname> <given-names>J</given-names></string-name>, <string-name><surname>Pye</surname> <given-names>C</given-names></string-name>, <string-name><surname>Hoyer</surname> <given-names>S</given-names></string-name>, <string-name><surname>Vanderplas</surname> <given-names>J</given-names></string-name>, <string-name><surname>Villalba</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kunter</surname> <given-names>G</given-names></string-name>, <string-name><surname>Quintero</surname> <given-names>E</given-names></string-name>, <string-name><surname>Bachant</surname> <given-names>P</given-names></string-name>, <string-name><surname>Martin</surname> <given-names>M</given-names></string-name>, <string-name><surname>Meyer</surname> <given-names>K</given-names></string-name>, <etal>et al.</etal></person-group>, <article-title>mwaskom/seaborn: v0.8.1 (September 2017)</article-title>; <year>2017</year>. <pub-id pub-id-type="doi">10.5281/zenodo.883859</pub-id>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Watanakeesuntorn</surname> <given-names>W</given-names></string-name>, <string-name><surname>Takahashi</surname> <given-names>K</given-names></string-name>, <string-name><surname>Ichikawa</surname> <given-names>K</given-names></string-name>, <string-name><surname>Park</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sugihara</surname> <given-names>G</given-names></string-name>, <string-name><surname>Takano</surname> <given-names>R</given-names></string-name>, <string-name><surname>Haga</surname> <given-names>J</given-names></string-name>, <string-name><surname>Pao</surname> <given-names>GM</given-names></string-name></person-group>. <article-title>Massively Parallel Causal Inference of Whole Brain Dynamics at Single Neuron Resolution</article-title>. <source>2020 IEEE 26th International Conference on Parallel and Distributed Systems (ICPADS)</source>; <year>2020</year>. p. <fpage>196</fpage>–<lpage>205</lpage>. doi: <pub-id pub-id-type="doi">10.1109/ICPADS51040.2020.00035</pub-id>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname> <given-names>E</given-names></string-name>, <string-name><surname>Zwart</surname> <given-names>MF</given-names></string-name>, <string-name><surname>James</surname> <given-names>B</given-names></string-name>, <string-name><surname>Rubinov</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wei</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Narayan</surname> <given-names>S</given-names></string-name>, <string-name><surname>Vladimirov</surname> <given-names>N</given-names></string-name>, <string-name><surname>Mensh</surname> <given-names>BD</given-names></string-name>, <string-name><surname>Fitzgerald</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Ahrens</surname> <given-names>MB</given-names></string-name></person-group>. <article-title>A brainstem integrator for self-location memory and positional homeostasis in zebrafish</article-title>. <source>Cell</source>. <year>2022</year>; <volume>185</volume>(<issue>26</issue>):<fpage>5011</fpage>–<lpage>5027.e20.</lpage> <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0092867422014660">https://www.sciencedirect.com/science/article/pii/S0092867422014660</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.cell.2022.11.022</pub-id>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Rózsa</surname> <given-names>M</given-names></string-name>, <string-name><surname>Liang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Bushey</surname> <given-names>D</given-names></string-name>, <string-name><surname>Wei</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Zheng</surname> <given-names>J</given-names></string-name>, <string-name><surname>Reep</surname> <given-names>D</given-names></string-name>, <string-name><surname>Broussard</surname> <given-names>GJ</given-names></string-name>, <string-name><surname>Tsang</surname> <given-names>A</given-names></string-name>, <string-name><surname>Tsegaye</surname> <given-names>G</given-names></string-name>, <string-name><surname>Narayan</surname> <given-names>S</given-names></string-name>, <string-name><surname>Obara</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Lim</surname> <given-names>JX</given-names></string-name>, <string-name><surname>Patel</surname> <given-names>R</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>R</given-names></string-name>, <string-name><surname>Ahrens</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Turner</surname> <given-names>GC</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>SSH</given-names></string-name>, <string-name><surname>Korff</surname> <given-names>WL</given-names></string-name>, <string-name><surname>Schreiter</surname> <given-names>ER</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Fast and sensitive GCaMP calcium indicators for imaging neural populations</article-title>. <source>Nature</source>. <year>2023</year> <month>Mar</month>; <volume>615</volume>(<issue>7954</issue>):<fpage>884</fpage>–<lpage>891</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Gao</surname> <given-names>X</given-names></string-name>, <string-name><surname>Peng</surname> <given-names>X</given-names></string-name>, <string-name><surname>Ye</surname> <given-names>J</given-names></string-name>, <string-name><surname>Li</surname> <given-names>X.</given-names></string-name></person-group> <article-title>Attention-based recurrent temporal restricted Boltzmann machine for radar high resolution range profile sequence recognition</article-title>. <source>Sensors</source>. <year>2018</year>; <volume>18</volume>(<issue>5</issue>):<fpage>1585</fpage>.</mixed-citation></ref>
</ref-list>
<sec>
<fig id="fig2_S1" position="float" fig-type="figure">
<label>Figure 2—figure supplement 1.</label>
<caption><p>An alignment procedure is used to be able to enable comparison between the estimated temporal weight matrix <italic>Û</italic> and the original temporal matrix used to generate the data. Details on the alignment procedure can be found in Alignment of the estimated temporal weight matrix. (A) The link between hidden units and assemblies of visible units can often be clearly identified within the weight matrix, making it possible to define an ordering of the hidden units such that it is in line with the ordering of the assemblies. This leads to a shu?ing of the rows in the <italic>Ŵ</italic> matrix. The sign of the mean weight between an assembly and its matched hidden unit is used to identify inverse relations. (B) The reordering of the hidden units leads to a reshu?ing of both the rows and the columns of the <italic>Û</italic> matrix. The sign of an entry is switched when the two hidden units have an opposing sign to their matched assembly of visible units.</p></caption>
<graphic xlink:href="578570v2_fig2_S1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98489.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Latham</surname>
<given-names>Peter</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University College London</institution>
</institution-wrap>
<city>London</city>
<country>United Kingdom</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Useful</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study introduces a <bold>useful</bold> extension to a recently proposed model of neural assembly activity. The extension was to add recurrent connections to the hidden units of the Restricted Boltzmann Machine. The authors show <bold>solid</bold> evidence that the new model outperforms their earlier model on both a simulated dataset and on whole-brain neural activity from zebrafish.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98489.2.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>Understanding large-scale neural activity remains a formidable challenge in neuroscience. While several methods have been proposed to discover the assemblies from such large-scale recordings, most of previous studies do not explicit modeling the temporal dynamics. This study is an attempt to uncover the temporal dynamics of assemblies using a tool that have been establish in other domains.</p>
<p>The authors previously introduced the compositional Restricted Boltzmann Machine (cRBM) to identify neuron assemblies in zebrafish brain activity. Building upon this, they now employ the Recurrent Temporal Restricted Boltzmann Machine (RTRBM) to elucidate the temporal dynamics within these assemblies. By introducing recurrent connections between hidden units, RTRBM could retrieve neural assemblies and their temporal dynamics from simulated and zebrafish brain data.</p>
<p>Strengths:</p>
<p>The RTRBM has been previously used in other domains. Training the model has been already established. This study is an application of such model to neuroscience. Overall, the paper is well-structured and the methodology is robust, the analysis is solid to support the authors claim.</p>
<p>Weaknesses:</p>
<p>The overall degree of advance is very limited. The performance improvement by RTRBM compared to their cRBM is marginal, and insights into assembly dynamics are limited.</p>
<p>(1) The biological insights from this method are constrained. Though the aim is to unravel neural ensemble dynamics, the paper lacks in-depth discussion on how this method enhances our understanding of zebrafish neural dynamics. For example, the dynamics of assemblies can be analyzed using various tools such as dimensionality reduction methods once we have identified them using cRBM. What information can we gain by knowing the effective recurrent connection between them? It would be more convincing to show this in real data.</p>
<p>(2) Including predicted and measured neural activity traces could aid readers in evaluating model efficacy. The current version only contains comparison of the statistics, such as mean and covariance.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98489.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this work, the authors propose an extension to some of the last author's previous work, where a compositional restricted Boltzmann machine was considered as a generative model of neuron-assembly interaction. They augment this model by recurrent connections between the Boltzmann machine's hidden units, which allow them to explicitly account for temporal dynamics of the assembly activity. Since their model formulation does not allow the training towards a compositional phase (as in the previous model), they employ a transfer learning approach according to which they initialise their model with a weight matrix that was pre-trained using the earlier model so as to essentially start the actually training in a compositional phase. Finally, they test this model on synthetic and actual data of whole-brain light-sheet-microscopy recordings of spontaneous activity from the brain of larval zebrafish.</p>
<p>Strengths:</p>
<p>This work introduces a new model for neural assembly activity. Importantly, being able to capture temporal assembly dynamics is an interesting feature that goes beyond many existing models. While this work clearly focuses on the method (or the model) itself, it opens up an avenue for experimental research where it will be interesting to see if one can obtain any biologically meaningful insights considering these temporal dynamics when one is able to, for instance, relate them to development or behaviour.</p>
<p>Weaknesses:</p>
<p>For most of the work, the authors present their RTRBM model as an improvement over the earlier cRBM model. Yet, when considering synthetic data, they actually seem to compare with a &quot;standard&quot; RBM model. This seems odd considering the overall narrative and that when considering whole-brain zebrafish data, the comparisons were made between RTRBM and cRBM models. For that, the RTRBM model was initialised with the cRBM weight matrix to overcome the fact that RTRBM alone does not seem to converge to a compositional phase, so to cite the latter as reason does not really make sense.</p>
<p>Furthermore, whether the clusters shown in Figure 3E can indeed be described as &quot;spatially localized&quot; is debatable. Especially in view of clusters 3 and 4, this seems a stretch. If receptive fields are described as &quot;spatially localized&quot;, arguably, one would expect that they are contained in some small (compared to the overall size of the brain) or specific anatomical brain region. However, this is clearly not the case here.</p>
<p>In addition, the performance comparison for the temporal dynamics of the hidden units actually suggests that the RTRBM (significantly) underperforms where the text says (Line 235f) it outperforms the cRBM model.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98489.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Quiroz Monnens</surname>
<given-names>Sebastian</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Peters</surname>
<given-names>Casper</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hesselink</surname>
<given-names>Luuk Willem</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Smeets</surname>
<given-names>Kasper</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0008-0621-3118</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Englitz</surname>
<given-names>Bernhard</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9106-0356</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>Summary:</p>
<p>Understanding large-scale neural activity remains a formidable challenge in neuroscience. While several methods have been proposed to discover the assemblies from such large-scale recordings, most previous studies do not explicitly model the temporal dynamics. This study is an attempt to uncover the temporal dynamics of assemblies using a tool that has been established in other domains.</p>
<p>The authors previously introduced the compositional Restricted Boltzmann Machine (cRBM) to identify neuron assemblies in zebrafish brain activity. Building upon this, they now employ the Recurrent Temporal Restricted Boltzmann Machine (RTRBM) to elucidate the temporal dynamics within these assemblies. By introducing recurrent connections between hidden units, RTRBM could retrieve neural assemblies and their temporal dynamics from simulated and zebrafish brain data.</p>
<p>Strengths:</p>
<p>The RTRBM has been previously used in other domains. Training in the model has been already established. This study is an application of such a model to neuroscience. Overall, the paper is well-structured and the methodology is robust, the analysis is solid to support the authors' claim.</p>
<p>Weaknesses:</p>
<p>The overall degree of advance is very limited. The performance improvement by RTRBM compared to their cRBM is marginal, and insights into assembly dynamics are limited.</p>
<p>(1) The biological insights from this method are constrained. Though the aim is to unravel neural ensemble dynamics, the paper lacks in-depth discussion on how this method enhances our understanding of zebrafish neural dynamics. For example, the dynamics of assemblies can be analyzed using various tools such as dimensionality reduction methods once we have identified them using cRBM. What information can we gain by knowing the effective recurrent connection between them? It would be more convincing to show this in real data.</p>
</disp-quote>
<p>See below in the recommendations section.</p>
<disp-quote content-type="editor-comment">
<p>(2) Despite the increased complexity of RTRBM over cRBM, performance improvement is minimal. Accuracy enhancements, less than 1% in synthetic and zebrafish data, are underwhelming (Figure 2G and Figure 4B). Predictive performance evaluation on real neural activity would enhance model assessment. Including predicted and measured neural activity traces could aid readers in evaluating model efficacy.</p>
</disp-quote>
<p>See below in the recommendations section.</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations:</bold></p>
<p>(1) The biological insights from this method are constrained. Though the aim is to unravel neural ensemble dynamics, the paper lacks in-depth discussion on how this method enhances our understanding of zebrafish neural dynamics. For example, the dynamics of assemblies can be analyzed using various tools such as dimensionality reduction methods once we have identified them using cRBM. What information can we gain by knowing the effective recurrent connection between them? It would be more convincing to show this in real data.</p>
</disp-quote>
<p>We agree with the reviewer that our analysis does not explore the data far enough to reach the level of new biological insights. For practical reasons unrelated to the science, we cannot further explore the data in this direction at this point, however, funding permitting, we will pick up this question at a later stage. The only change we have made to the corresponding figure at the current stage was to adapt the thresholds, which better emphasizes the locality of the resulting clusters.</p>
<disp-quote content-type="editor-comment">
<p>(2) Despite the increased complexity of RTRBM over cRBM, performance improvement is minimal. Accuracy enhancements, less than 1% in synthetic and zebrafish data, are underwhelming (Figure 2G and Figure 4B). Predictive performance evaluation on real neural activity would enhance model assessment. Including predicted and measured neural activity traces could aid readers in evaluating model efficacy.</p>
</disp-quote>
<p>We thank the reviewer kindly for the comments on the performance comparison between the two models. We would like to highlight that the small range of accuracy values for the predictive performance is due to both the sparsity and stochasticity of the simulated data, and is not reflective of the actual percentage in performance improvement. To this end, we have opted to use a rescaled metric that we call the normalised Mean Squared Error (nMSE), where the MSE is equal to 1 minus the accuracy, as the visible units take on binary values. This metric is also more in line with the normalised Log-Likelihood (nLLH) metric used in the cRBM paper in terms of interpretability. The figure shows that the RTRBM can significantly predict the state of the visible units in subsequent time-steps, whereas the cRBM captures the correct time-independent statistics but has no predictive power over time.</p>
<p>We also thank the reviewer for pointing out that there is no predictive performance evaluation on the neural data. This has been chosen to be omitted for two reasons. First, it is clear from Fig. 2 that the (c)RBM has no temporal dependencies, meaning that the predictive performance is determined mostly by the average activity of the visible units. If this corresponds well with the actual mean activity per neuron, the nMSE will be around 0. This correspondence is already evaluated in the first panel of 3F. Second, as this is real data, we can not make an estimate of a lower bound on the MSE that is due to neural noise. Because of this, the scale of the predictive performance score will be arbitrary, making it difficult to quantitatively assess the difference in performance between both models.</p>
<disp-quote content-type="editor-comment">
<p>(3) The interpretation of the hidden real variable $r_t$ lacks clarity. Initially interpreted as the expectation of $\mathbf{h}_t$, its interpretation in Eq (8) appears different. Clarification on this link is warranted.</p>
</disp-quote>
<p>We thank the reviewer kindly for the suggested clarification. However, we think the link between both values should already be sufficiently clear from the text in lines 469-470:</p>
<p>“Importantly, instead of using binary hidden unit states 𝐡[𝑡−1], sampled from the expected real valued hidden states 𝐫[𝑡−1], the RTRBM propagates these real-valued hidden unit states directly.”</p>
<p>In other words, both indeed are the same, one could sample a binary-valued 𝐡[𝑡-1] from the real-valued 𝐫[𝑡-1] through e.g. a Bernoulli distribution, where 𝐫[𝑡-1] would thus indeed act as an expectation over 𝐡[𝑡−1]. However, the RTRBM formulation keeps the real-valued 𝐫[𝑡-1] to propagate the hidden-unit states to the next time-step. The motivation for this choice is further discussed in the original RTRBM paper (Sutskever et al. 2008).</p>
<disp-quote content-type="editor-comment">
<p>(4) In Figure 3 panel F, the discrepancy in x-axis scales between upper and lower panels requires clarification. Explanation regarding the difference and interpretation guidelines would enhance understanding.</p>
</disp-quote>
<p>Thank you for pointing out the discrepancy in x-axis scales between the upper and lower panels of Figure 3F. The reason why these scales are different is that the activation functions in the two models differ in their range, and showing them on the same scale would not do justice to this difference. But we agree that this could be unclear for readers. Therefore we added an additional clarification for this discrepancy in line 215:</p>
<p>“While a direct comparison of the hidden unit activations between the cRBM and the RTRBM is hindered by the inherent discrepancy in their activation functions (unbounded and bounded, respectively), the analysis of time-shifted moments reveals a stronger correlation for the RTRBM hidden units ($r_s = 0.92$, $p&lt;\epsilon$) compared to the cRBM ($r_s = 0.88$, $p&lt;\epsilon$)”</p>
<disp-quote content-type="editor-comment">
<p>(5) Assessing model performance at various down-sampling rates in zebrafish data analysis would provide insights into model robustness.</p>
</disp-quote>
<p>We agree that we would have liked to assess this point in real data, to verify that this holds as well in the case of the zebrafish whole-brain data. The main reason why we did not choose to do this in this case is that we would only be able to further downsample the data. Current whole brain data sets are collected at a few Hz (here 4 Hz, only 2 Hz in other datasets), which we consider to be likely slower than the actual interaction speed in neural systems, which is on the order of milliseconds between neurons, and on the order of ~100 ms (~10 Hz) between assemblies. Therefore reducing the rate further, we expect to only see a reduction in quality, which we considered less interesting than finding an optimum. Higher rates of imaging in light-sheet imaging are only achievable currently by imaging only single planes (which defies the goal of whole brain recordings), but may be possible in the future when the limiting factors (focal plane stepping and imaging) are addressed. For completeness, we have now performed the downstepping for the experimental data, which showed the expected decrease in performance. The results have been integrated into Figure 4.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>Summary:</p>
<p>In this work, the authors propose an extension to some of the last author's previous work, where a compositional restricted Boltzmann machine was considered as a generative model of neuron-assembly interaction. They augment this model by recurrent connections between the Boltzmann machine's hidden units, which allow them to explicitly account for temporal dynamics of the assembly activity. Since their model formulation does not allow the training towards a compositional phase (as in the previous model), they employ a transfer learning approach according to which they initialise their model with a weight matrix that was pre-trained using the earlier model so as to essentially start the actually training in a compositional phase. Finally, they test this model on synthetic and actual data of whole-brain light-sheet-microscopy recordings of spontaneous activity from the brain of larval zebrafish.</p>
<p>Strengths:</p>
<p>This work introduces a new model for neural assembly activity. Importantly, being able to capture temporal assembly dynamics is an interesting feature that goes beyond many existing models. While this work clearly focuses on the method (or the model) itself, it opens up an avenue for experimental research where it will be interesting to see if one can obtain any biologically meaningful insights considering these temporal dynamics when one is able to, for instance, relate them to development or behaviour.</p>
<p>Weaknesses:</p>
<p>For most of the work, the authors present their RTRBM model as an improvement over the earlier cRBM model. Yet, when considering synthetic data, they actually seem to compare with a &quot;standard&quot; RBM model. This seems odd considering the overall narrative, and it is not clear why they chose to do that. Also, in that case, was the RTRBM model initialised with the cRBM weight matrix?</p>
</disp-quote>
<p>Thank you for raising the important point regarding the RTRBM comparison in the synthetic data section. Initially, we aimed to compare the performance of the cRBM with the cRTRBM. However, we encountered significant challenges in getting the RTRBM to reach the compositional phase. To ensure a fair and robust comparison, we opted to compare the RBM with the RTRBM.</p>
<disp-quote content-type="editor-comment">
<p>A few claims made throughout the work are slightly too enthusiastic and not really supported by the data shown. For instance, when the authors refer to the clusters shown in Figure 3D as &quot;spatially localized&quot;, this seems like a stretch, specifically in view of clusters 1, 3, and 4.</p>
</disp-quote>
<p>Thanks for pointing out this inaccuracy. When going back to the data/analyses to address the question about locality, we stumbled upon a minor bug in the implementation of the proportional thresholding, causing the threshold to be too low and therefore too many neurons to be considered.</p>
<p>Fixing this bug reduces the number of neurons, thereby better showing the local structure of the clusters. Furthermore, if one would lower the threshold within the hierarchical clustering, smaller, and more localized, clusters would appear. We deliberately chose to keep this threshold high to not overwhelm the reader with the number of identified clusters. We hope the reviewer agrees with these changes and that the spatial structure in the clusters presented are indeed rather localized.</p>
<disp-quote content-type="editor-comment">
<p>Moreover, when they describe the predictive performance of their model as &quot;close to optimal&quot; when the down-sampling factor coincided with the interaction time scale, it seems a bit exaggerated given that it was more or less as close to the upper bound as it was to the lower bound.</p>
</disp-quote>
<p>We thank the reviewer for catching this error. Indeed, the best performing model does not lay very close to the estimated performance of an optimal model. The text has been updated to reflect this.</p>
<disp-quote content-type="editor-comment">
<p>When discussing the data statistics, the authors quote correlation values in the main text. However, these do not match the correlation values in the figure to which they seem to belong. Now, it seems that in the main text, they consider the Pearson correlation, whereas in the corresponding figure, it is the Spearman correlation. This is very confusing, and it is not really clear as to why the authors chose to do so.</p>
</disp-quote>
<p>Thank you for identifying the discrepancy between the correlation values mentioned in the text and those presented in the figure. We updated the manuscript to match the correlation coefficient values in the figure with the correct values denoted in the text.</p>
<disp-quote content-type="editor-comment">
<p>Finally, when discussing the fact that the RTRBM model outperforms the cRBM model, the authors state it does so for different moments and in different numbers of cases (fish). It would be very interesting to know whether these are the same fish or always different fish.</p>
</disp-quote>
<p>Thank you for pointing this out. Keeping track of the same fish across the different metrics makes sense. We updated the figure to include a color code for each individual fish. As it turns out each time the same fish are significantly better performing.</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations:</bold></p>
<p>Figure 1: While the schematic in A and D only shows 11 visible units (&quot;neurons&quot;), the weight matrices and the activity rasters in B and C and E and F suggest that there should be, in fact, 12 visible units. While not essential, I think it would be nice if these numbers would match up.</p>
</disp-quote>
<p>Thank you for pointing out the inconsistency in the number of visible units depicted in Figure 1. We agree that this could have been confusing for readers. The figure has been updated accordingly. As you suggested, the schematic representation now accurately reflects the presence of 12 visible units in both the RBM and RTRBM models.</p>
<disp-quote content-type="editor-comment">
<p>Figure 3: Panel G is not referenced in the main text. Yet, I believe it should be somewhere in lines 225ff.</p>
</disp-quote>
<p>Thank you for mentioning this. We added in line 233 a reference to figure 3 panel G to refer to the performance of the cRBM and RTRBM on the different fish.</p>
<disp-quote content-type="editor-comment">
<p>Line 637ff: The authors consider moments &lt;v_i h_μ&gt; and &lt;v_i h_j&gt;, and from the context, it seems they are not the same. However, it is not clear as to why because, judging from the notation, they should be the same.</p>
</disp-quote>
<p>The second-order statistic &lt;v_i h_j&gt; on line 639 was indeed already mentioned and denoted as &lt;v_i h_μ&gt; on line 638. It has now been removed accordingly in the updated manuscript.</p>
<disp-quote content-type="editor-comment">
<p>I found the usage of U^ and U throughout the manuscript a bit confusing. As far as I understand, U^ is a learned representation of U. However, maybe the authors could make the distinction clearer.</p>
</disp-quote>
<p>We understand the usage of Û and U throughout the text may be confusing for the reader. However, we would like to notify the reviewer that the distinction between these two variables is explained in line 142: “in addition to providing a close estimate (̂Û) to the true assembly connectivity matrix U”. However, for added clarification to the reader, we added additional mentions of the estimated nature of Û throughout the text in the updated manuscript.</p>
<disp-quote content-type="editor-comment">
<p>Equation 3: It would be great if the authors could provide some more explanation of how they arrived at the identities.</p>
</disp-quote>
<p>These identities have previously been widely described in literature. For this reason, we decided not to include their derivation in our manuscript. However, for completeness, we kindly refer to:</p>
<p>Goodfellow, I., Bengio, Y., &amp; Courville, A. (2016). Chapter 20: Deep generative models [In <italic>Deep Learning</italic>]. MIT Press. <ext-link ext-link-type="uri" xlink:href="https://www.deeplearningbook.org/contents/generative_models.html">https://www.deeplearningbook.org/contents/generative_models.html</ext-link></p>
<disp-quote content-type="editor-comment">
<p>Typos:</p>
<p>-  L. 196: &quot;connectiivty&quot; -&gt; &quot;connectivity&quot;</p>
<p>-  L. 197: Does it mean to say &quot;very strong stronger&quot;?</p>
<p>-  L. 339: The reference to Dunn et al. (2016) should appear in parentheses.</p>
<p>-  L. 504f: The colon should probably be followed by a full sentence.</p>
<p>-  Eq. 2: In the first line, the potential V still appears, which should probably be changed to show the concrete form (-b * h) as in the second line.</p>
<p>-  L. 351: Is there maybe a comma missing after &quot;cRBM&quot;?</p>
<p>-  L. 271: Instead of &quot;correlation&quot;, shouldn't it rather be &quot;similarity&quot;? - L. 218: &quot;Figure 3D&quot; -&gt; &quot;Figure 3F&quot;</p>
</disp-quote>
<p>We thank the reviewer for pointing out these typos, which have all (except one) been fixed in the text. We do emphasize the potential V to show that there are alternative hidden unit potentials that can be chosen. For instance, the cRBM utilizes dReLu hidden unit potentials.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public Review):</bold></p>
<p>With ever-growing datasets, it becomes more challenging to extract useful information from such a large amount of data. For that, developing better dimensionality reduction/clustering methods can be very important to make sense of analyzed data. This is especially true for neuroscience where new experimental advances allow the recording of an unprecedented number of neurons. Here the authors make a step to help with neuronal analyses by proposing a new method to identify groups of neurons with similar activity dynamics. I did not notice any obvious problems with data analyses here, however, the presented manuscript has a few weaknesses:</p>
<p>(1) Because this manuscript is written as an extension of previous work by the same authors (van der Plas et al., eLife, 2023), thus to fully understand this paper it is required to read first the previous paper, as authors often refer to their previous work for details. Similarly, to understand the functional significance of identified here neuronal assemblies, it is needed to go to look at the previous paper.</p>
</disp-quote>
<p>We agree that the present Research Advance has been written in a way that builds on our previous publication. It was our impression that this was the intention of the Research Advance format, as spelled out in its announcement &quot;eLife has introduced an innovative new type of article – the Research Advance – that invites the authors of any eLife paper to present significant additions to their original research&quot;. In the previous formatting guidelines from eLife this was more evident with a strong limitation on the number of figures and words, however, also for the present, more liberal guidelines, place an emphasis on the relation to the previous article. We have nonetheless tried in several places to fill in details that might simplify the reading experience.</p>
<disp-quote content-type="editor-comment">
<p>(2) The problem of discovering clusters in data with temporal dynamics is not unique to neuroscience. Therefore, the authors should also discuss other previously proposed methods and how they compare to the presented here RTRBM method. Similarly, there are other methods using neural networks for discovering clusters (assemblies) (e.g. t-SNE: van der Maaten &amp; Hinton 2008, Hippocluster: Chalmers et al. 2023, etc), which should be discussed to give better background information for the readers.</p>
</disp-quote>
<p>The clustering methods suggested by the reviewer do not include modeling any time dependence, which is the crucial advance presented here by the introduction of the RTRBM, in extending the (c)RBM. In our previous publication on the cRBM (an der Plas et al., eLife, 2023), this comparison was part of the discussion, although it focussed on a different set of methods. While clustering methods like t-SNE, UMAP and others certainly have their value in scientific analysis, we think it might be misleading the reader to think that they achieve the same task as an RTRBM, which adds the crucial dimension of temporal dependence.</p>
<disp-quote content-type="editor-comment">
<p>(3) The above point to better describe other methods is especially important because the performance of the presented here method is not that much better than previous work. For example, RTRBM outperforms the cRBM only on ~4 out of 8 fish datasets. Moreover, as the authors nicely described in the Limitations section this method currently can only work on a single time scale and clusters have to be estimated first with the previous cRBM method. Thus, having an overview of other methods which could be used for similar analyses would be helpful.</p>
</disp-quote>
<p>We think that the perception that the RTRBM performs only slightly better is based on a misinterpretation of the performance measure, which we have tried to address (see comments above) in this rebuttal and the manuscript. In addition we would like to emphasize that the structural estimation (which is still modified by the RTRBM, only seeded by the cRBMs output), as shown in the simulated data, makes improved structural estimates, which is important, even in cases where the performance is comparable (which can be the case if the RBM absorbs temporal dependencies of assemblies into modified structure of assemblies). We have clarified this now in the discussion.</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations:</bold></p>
<p>(1) Line 181: it is not explained how a reconstruction error is defined.</p>
</disp-quote>
<p>Dear reviewer, thanks for pointing this out. A definition of the (mean square) reconstruction error is added in this line.</p>
<disp-quote content-type="editor-comment">
<p>(2) How was the number of hidden neurons chosen and how does it affect performance?</p>
</disp-quote>
<p>Thank you for pointing this out. Due to the fact that we use transfer learning, the number of hidden units used for the RTRBM is given by the number of hidden units used for training the cRBM. In further research, when the RTRBM operates in the compositional phase, we can exploit a grid search over a set of hyper parameters to determine the optimal set of hidden units and other parameters.</p>
</body>
</sub-article>
</article>