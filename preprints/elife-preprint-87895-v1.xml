<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">87895</article-id>
<article-id pub-id-type="doi">10.7554/eLife.87895</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.87895.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Physics of Living Systems</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>How microscopic epistasis and clonal interference shape the fitness trajectory in a spin glass model of microbial long-term evolution</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1336-7568</contrib-id>
<name>
<surname>Boffi</surname>
<given-names>Nicholas M.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Guo</surname>
<given-names>Yipei</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rycroft</surname>
<given-names>Chris H.</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Amir</surname>
<given-names>Ariel</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Courant Institute of Mathematical Sciences, New York University</institution></aff>
<aff id="a2"><label>2</label><institution>Janelia Research Campus</institution></aff>
<aff id="a3"><label>3</label><institution>Department of Mathematics, University of Wisconsin–Madison</institution></aff>
<aff id="a4"><label>4</label><institution>Mathematics Group, Lawrence Berkeley National Laboratory</institution></aff>
<aff id="a5"><label>5</label><institution>John A. Paulson School of Engineering and Applied Sciences, Harvard University</institution></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Ogbunugafor</surname>
<given-names>C Brandon</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Yale University</institution>
</institution-wrap>
<city>New Haven</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Landry</surname>
<given-names>Christian R</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Université Laval</institution>
</institution-wrap>
<city>Québec</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>Corresponding author; email: <email>boffi@cims.nyu.edu</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-06-15">
<day>15</day>
<month>06</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP87895</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-03-29">
<day>29</day>
<month>03</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-01-20">
<day>20</day>
<month>01</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.01.16.524306"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Boffi et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Boffi et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-87895-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>The adaptive dynamics of evolving microbial populations takes place on a complex fitness landscape generated by epistatic interactions. The population generically consists of multiple competing strains, a phenomenon known as clonal interference. Microscopic epistasis and clonal interference are central aspects of evolution in microbes, but their combined effects on the functional form of the population’s mean fitness are poorly understood. Here, we develop a computational method that resolves the full microscopic complexity of an evolving population subject to a standard serial dilution protocol. We find that stronger microscopic epistasis gives rise to fitness trajectories with slower growth independent of the number of competing strains, which we quantify with power-law fits and understand mechanistically via a random walk model that neglects dynamical correlations between genes. We show that clonal interference leads to fitness trajectories with faster growth (in functional form) without microscopic epistasis, but has a negligible effect when epistasis is sufficiently strong, indicating that the role of clonal interference depends intimately on the underlying fitness landscape.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
</notes>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>Laboratory evolution experiments have demonstrated the widespread prevalence of microscopic epistasis, the tendency for the phenotype associated with a mutation to depend on the background genotype in which it emerged (<xref ref-type="bibr" rid="c35">Khan et al., 2011</xref>; <xref ref-type="bibr" rid="c8">Chou et al., 2011</xref>; <xref ref-type="bibr" rid="c66">Wang et al., 2013</xref>; <xref ref-type="bibr" rid="c24">Good and Desai, 2015</xref>; <xref ref-type="bibr" rid="c5">Bakerlee et al., 2022</xref>; <xref ref-type="bibr" rid="c39">Kryazhimskiy et al., 2014</xref>; <xref ref-type="bibr" rid="c13">Diaz-Colunga et al., 2022</xref>). Basic evolutionary theory indicates that for moderate mutation rates the overall population will consist of many competing strains, because additional mutations can emerge before an existing mutation has time to fix in the culture (<xref ref-type="bibr" rid="c18">Gerrish and Lenski, 1998</xref>; <xref ref-type="bibr" rid="c11">Desai and Fisher, 2007</xref>; de Visser and Rozen, 2006; <xref ref-type="bibr" rid="c55">Park and Krug, 2007</xref>). This “clonal interference” is consistently observed in laboratory experiments such as Lenski’s long-term evolution experiment (LTEE) (<xref ref-type="bibr" rid="c16">Fogle et al., 2008</xref>; <xref ref-type="bibr" rid="c45">Lenski et al., 1991</xref>; <xref ref-type="bibr" rid="c44">Lenski and Travisano, 1994</xref>; <xref ref-type="bibr" rid="c43">Lenski, 2017</xref>; <xref ref-type="bibr" rid="c69">Wiser et al., 2013</xref>). Yet, despite the agreed-upon ubiquity of both aspects of evolution, there are few quantitative predictions for how they affect some of the most common experimental outputs, such as the mean fitness of the population. The central difficulty arises from the need to treat both the population and the genome at the microscopic level, which requires sophisticated analytical tools or high-resolution experiments.</p>
<p>The traditional approach in evolutionary theory is to make use of assumptions and statistical model classes that sidestep these complexities. Most theoretical studies of long-term adaptation take place in the “strong selection weak mutation” (SSWM) limit (<xref ref-type="bibr" rid="c20">Gillespie, 1983</xref>, <xref ref-type="bibr" rid="c21">1984</xref>, <xref ref-type="bibr" rid="c22">1991</xref>; <xref ref-type="bibr" rid="c53">Orr, 2002</xref>; <xref ref-type="bibr" rid="c25">Good et al., 2012</xref>), where the time for a beneficial mutation event to occur is large in comparison to the time for a typical beneficial mutation to fix in the population. While convenient due to analytical simplifications, this limit neglects clonal interference by ensuring that the culture consists of a single dominant strain at almost all times, and is hence known to be invalid for populations under standard laboratory conditions (de Visser and Rozen, 2006). As an unfortunate by-product, even if the predictions of a model are found to match experimental data, it is not clear how the addition of clonal interference will change the results.</p>
<p>To avoid the analytical and computational challenges associated with modeling the genome at microscopic granularity, significant theoretical effort has been spent studying macroscopic “rugged” or “uncorrelated” models (<xref ref-type="bibr" rid="c33">Kauffman and Levin, 1987</xref>; <xref ref-type="bibr" rid="c34">Kauffman and Weinberger, 1989</xref>; <xref ref-type="bibr" rid="c68">Wilke, 2004</xref>; <xref ref-type="bibr" rid="c48">Macken and Perelson, 1989</xref>; <xref ref-type="bibr" rid="c15">Flyvbjerg and Lautrup, 1992</xref>; <xref ref-type="bibr" rid="c36">Kingman, 1978</xref>), which posit the fitness of a mutant to be drawn at random from a fixed distribution (<xref ref-type="bibr" rid="c56">Park and Krug, 2008</xref>). More recently, macroscopic “fitness-parameterized” models – which assume the distribution of fitness effects (DFE) depends only on the fitness of the parent – have garnered interest as a way to model correlations in the fitness landscape (<xref ref-type="bibr" rid="c37">Kryazhimskiy et al., 2009</xref>). Although macroscopic models have provided significant insight into evolutionary dynamics, both classes exhibit serious disadvantages. Rugged landscapes make predictions that are known to violate experimental measurements, such as the typical length of an adaptive walk (<xref ref-type="bibr" rid="c54">Orr, 2006</xref>). Fitness-parameterized models can help correct some of these issues, but to do so they require an assumption about how the DFE depends on fitness, which is typically unknown because of its experimental intractability.</p>
<p>One approach that corrects the deficiencies of macroscopic models is the use of microscopic models, which treat the genome as a sequence of loci each with a binary label indicating the presence or absence of a mutation. Perhaps the most well-studied microscopic model in evolutionary theory is Kauffman’s NK model (<xref ref-type="bibr" rid="c33">Kauffman and Levin, 1987</xref>), but similar microscopic models can be obtained systematically via Fourier expansion (<xref ref-type="bibr" rid="c52">Neher and Shraiman, 2011</xref>). This approach leads to the class of spin glass models well-studied in the statistical physics (<xref ref-type="bibr" rid="c60">Sherrington and Kirkpatrick, 1975</xref>; <xref ref-type="bibr" rid="c64">Sompolinsky and Zippelius, 1982</xref>; <xref ref-type="bibr" rid="c4">Arous et al., 2001</xref>), theoretical neuroscience (<xref ref-type="bibr" rid="c2">Amit et al., 1985a</xref>,<xref ref-type="bibr" rid="c3">b</xref>; <xref ref-type="bibr" rid="c30">Hopfield, 1982</xref>), ecology (<xref ref-type="bibr" rid="c59">Roy et al., 2020</xref>), machine learning (<xref ref-type="bibr" rid="c7">Choromanska et al., 2015</xref>), and combinatorial optimization literatures (<xref ref-type="bibr" rid="c49">Mezard and Montanari, 2009</xref>; <xref ref-type="bibr" rid="c50">Mezard et al., 1987</xref>). Recently, spin glass models have been used to study the role of epistasis in adaptive dynamics, leading to insight into the generation of slow, logarithmic fitness trajectories (<xref ref-type="bibr" rid="c27">Guo et al., 2019</xref>) and how macroscopic epistasis emerges from widespread microscopic interactions (<xref ref-type="bibr" rid="c58">Reddy and Desai, 2021</xref>). But due to the computational expense of full-scale microscopic simulations, these prior works make the SSWM assumption, which greatly simplifies the resulting adaptive dynamics to a process that is analytically tractable.</p>
<p>In order to understand the role played by microscopic epistasis and clonal interference in real-world evolving populations, we present a systematic numerical study of the evolutionary dynamics of a microbial culture under serial dilution on a microscopic fitness landscape far from the SSWM regime. To do so, we consider a spin-glass type model that enables us to independently tune the magnitude of epistasis and the level of clonal interference in the culture. The model contains both additive and epistatic terms. The relative magnitude of the two terms can be adjusted, and the epistatic interaction takes place pairwise between two loci on the genome.</p>
<p>To resolve the adaptive dynamics, we develop a high-performance, <monospace>OpenMP</monospace>-based multi-threaded implementation of the resulting stochastic process in <monospace>C++</monospace>, which we use to study an adaptive walk to a fitness peak comprising a few hundred fixation events. The implementation leverages several algorithmic advances to capture the complete microscopic details of the process over long timescales: an efficient algorithm for computation of the fitness that leverages the structure of the epistatic interaction, a hashing-based method for storage of strains by genotype for fast splitting and joining, and an efficient approach for diluting the culture. These algorithmic advances render tractable the computation of the entire distribution of fitness effects, the complete sequence of fixed mutations along with their individual effects, and the number of remaining beneficial mutations for any strain at any time with realistic population sizes (one hundred million bacteria) over realistic timescales (tens of thousands of generations). In the strong clonal interference regime, tracking all microscopic details generates hundreds of gigabytes of data; the resulting datasets are processed by custom-built Python code that produces standard, experimentally-measurable observables.</p>
<p>Our framework brings insight into both real-world experimental systems and modern approaches in evolutionary theory. To this end, we show that hill-climbing dynamics on a random and sparse fitness landscape with two-point interactions cannot give rise to the slow, low-exponent power law trajectories observed in Lenski’s LTEE even with clonal interference, suggesting that other factors such as structured interactions might be at play. Moreover, we show that any macroscopic fitness-parameterized model used to describe a microscopic process must depend intrinsically on the level of clonal interference in the population, implying that the DFE in a macroscopic model for an experimental system must be tuned to the mutation rate of the culture.</p>
<p>The paper is organized as follows. In <xref ref-type="sec" rid="s2">Section 2</xref>, we describe details of the fitness landscape and the simulation. In <xref ref-type="sec" rid="s3a">Section 3.1</xref>, we describe how microscopic epistasis slows fitness trajectories independent of the level of clonal interference. In <xref ref-type="sec" rid="s3b">Sections 3.2</xref> and <xref ref-type="sec" rid="s3c">3.3</xref>, we consider the use of macrosopic models to interpret and explain mechanistically the effect of microscopic epistasis. In <xref ref-type="sec" rid="s3d">Section 3.4</xref>, we show how the effect of clonal interference depends on the strength of microscopic epistasis, and that fitness parameterized models must be tuned to the level of clonal interference in the population. We conclude with a discussion and suggest some extensions in <xref ref-type="sec" rid="s4">Section 4</xref>.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Model details</title>
<sec id="s2a">
<label>2.1</label>
<title>Basic setup</title>
<p>To study the effect of microscopic epistasis on the average fitness trajectory, it is useful to model the genome as a sequence of sites and to consider fitness landscapes that specify the fitness as a function of the state of the genome. We study a generic finite-sites microscopic model (<xref ref-type="fig" rid="fig1">Figure 1</xref>) inspired by the Sherrington–Kirkpatrick spin glass in statistical physics (<xref ref-type="bibr" rid="c60">Sherrington and Kirkpatrick, 1975</xref>). In the next subsection, we elaborate on the generality of a model of this form.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><title>The microscopic epistasis model</title>
<p>(A) The fitness of a given strain is defined by its genotype <bold><italic>α</italic></bold> ∈ {±1}<sup><italic>L</italic></sup>. Each gene <italic>i</italic> contributes <italic>α<sub>i</sub>h<sub>i</sub></italic> independent of the background genotype and an epistatic contribution <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline1.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> due to its interaction with all other genes. The <italic>h<sub>i</sub></italic> and <italic>J<sub>ij</sub></italic> values are drawn randomly, and the relative magnitudes of the two contributions can be tuned by adjusting a parameter <italic>β</italic> ∈ [0,1]. Each gene interacts, on average, with a fraction <italic>ρ</italic> of other genes. The fitness landscape is thus described by a disordered network, here shown for <italic>L</italic> = 250 and <italic>ρ</italic> = 0.05, with color indicating magnitude and connectivity demonstrating the sparsity pattern of the <italic>J<sub>ij</sub></italic>. (B) A typical hill-climbing trajectory with both clonal interference (<italic>μ</italic> = 2 × 10<sup>−4</sup>) and microscopic epistasis (<italic>β</italic> = 0.5). Replicate trajectories are displayed in low opacity, while the mean over all replicates is shown in open circles with error bars depicting the standard error of the mean. The mean fitness is consistent with a power-law relaxation with exponent <italic>c</italic> ≈ 0.575 (solid). The inset displays the trajectory (dashed) and the best-fit power law (solid, shifted for visual clarity) on a log-log scale. (C) As <italic>β</italic> is increased, the epistatic contribution becomes more significant, and the landscape smoothly becomes more rugged. (D) As the mutation rate increases, the magnitude of clonal interference can be smoothly tuned.</p></caption>
<graphic xlink:href="524306v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s2a1">
<title>The fitness model</title>
<p>With <italic>L</italic> denoting the length of the genome, the fitness of a strain with genotype <bold><italic>α</italic></bold> ∈ {±1}<sup><italic>L</italic></sup> is given by the expression
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="524306v1_eqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>Here, <italic>F</italic><sub>off</sub> is an arbitrary offset value that can be used to fix the initial fitness independent of the initial genotype. Inspired by experimental competition assays in typical laboratory microbial evolution settings, we compare the fitness of a given strain to the fitness of the ancestral strain. To do so, we choose <italic>F</italic><sub>off</sub> so that the fitness of the ancestral strain is equal to one; this arbitrary shift has no effect on the dynamics or our conclusions.</p>
<p>In (1), each <italic>h<sub>i</sub></italic> represents the instantaneous contribution of a mutation at gene <italic>i</italic> to the fitness of the strain in the absence of epistasis. Each <italic>J<sub>ij</sub></italic> = <italic>J<sub>ji</sub></italic> describes the microscopic epistasis between mutations at genes <italic>i</italic> and <italic>j</italic>. Realistic biological fitness landscapes are thought to be rugged, containing many local extrema. By taking the values of <italic>h<sub>i</sub></italic> and <italic>J<sub>ij</sub></italic> to be random, (1) gives rise to such a complex fitness landscape.</p>
</sec>
<sec id="s2a2">
<title>Disorder statistics</title>
<p>Because biological networks are typically sparse (<xref ref-type="bibr" rid="c65">Tong et al., 2004</xref>; <xref ref-type="bibr" rid="c9">Costanzo et al., 2016</xref>), our model is such that each gene only interacts on average with a fraction 0 &lt; <italic>ρ</italic> ≤ 1 of the other genes. <italic>ρ</italic> is typically on the order of a few percent in realistic networks, and we set <italic>ρ</italic> accordingly. These considerations lead to the choice of distributions
<disp-formula>
<alternatives><graphic xlink:href="524306v1_ueqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
with <italic>J<sub>ii</sub></italic> = 0 for all <italic>i</italic>. Above, N(<italic>μ</italic>, <italic>σ</italic><sup>2</sup>) denotes a normal distribution with mean <italic>μ</italic> and variance <italic>σ</italic><sup>2</sup>, and Ber(<italic>ρ</italic>) denotes a Bernoulli distribution with parameter <italic>ρ</italic>. The variances are set to <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline2.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline3.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> where 0 ≤ <italic>β</italic> ≤ 1 sets the magnitude of microscopic epistasis and Δ &gt; 0 sets the magnitude of generic fitness increments. This scaling with <italic>β</italic> ensures that the fitness increase at initialization <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline4.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is approximately independent of <italic>β</italic>. This choice provides a useful setting to qualitatively compare the speed of fitness trajectories in addition to quantitative measures such as fitting parametric functional forms (<xref ref-type="bibr" rid="c26">Guo and Amir, 2022</xref>). Typical fitness increments in laboratory experiments are on the order of a few percent of the ancestral strain’s fitness (<xref ref-type="bibr" rid="c6">Barrick et al., 2009</xref>), and we choose Δ to match this observation. Our conclusions about the roles of epistasis and clonal interference (and their mechanisms) do not depend on the specific choice.</p>
</sec>
<sec id="s2a3">
<title>Fitness trajectories</title>
<p>The fitness landscape is defined by a sparse and random genetic interaction network (<xref ref-type="fig" rid="fig1">Figure 1A</xref>). Adaptation dynamics produce fitness trajectories (<xref ref-type="fig" rid="fig1">Figure 1B</xref>) qualitatively consistent with experimental observations of long-term evolution in microbial populations (<xref ref-type="bibr" rid="c43">Lenski, 2017</xref>), leading to power-law trajectories with exponents between 0.45 and 3.1. For details on how these trajectories and exponents are produced, see Appendices A &amp; B.</p>
</sec>
<sec id="s2a4">
<title>Landscape structure</title>
<p>The parameter <italic>β</italic> can be used to continuously tune the ruggedness of the landscape (<xref ref-type="fig" rid="fig1">Figure 1C</xref>). For <italic>β</italic> = 0, there is no microscopic epistasis, and the evolutionary dynamics corresponds to a hill-climbing event towards the single fitness maximum with value ∑<sub><italic>i</italic></sub>|<italic>h<sub>i</sub></italic>|. In the opposite extreme for β = 1, mutations do not have any effect independent of the genetic background, and the landscape is rife with local fitness maxima. By systematically varying this parameter and observing its effect on the average fitness trajectory throughout the approach to a fitness maximum, we quantify the role of microscopic epistasis in <italic>slowing</italic> the functional form (i.e., reducing the power-law exponent) of the fitness trajectory both with and without clonal interference.</p>
</sec>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Choice of model</title>
<p>There are several compelling reasons to study the fitness model in <xref ref-type="disp-formula" rid="eqn1">Equation (1)</xref> that we now highlight.</p>
<sec id="s2b1">
<title>Generality</title>
<p><xref ref-type="disp-formula" rid="eqn1">Equation (1)</xref> represents the two lowest-order terms in a Fourier expansion of an arbitrary function defined on the Boolean hypercube (<xref ref-type="bibr" rid="c52">Neher and Shraiman, 2011</xref>). As such, our model represents a rigorously quantifiable approximation of <italic>any</italic> choice of fitness model defined on the hypercube.</p>
</sec>
<sec id="s2b2">
<title>Tunable epistasis</title>
<p>The presence of the continuous parameter <italic>β</italic> allows us to systematically vary the relative contribution of the epistatic interaction, enabling a detailed study of the effect of microscopic epistasis on the dynamics of adaptation. The well-known NK model (<xref ref-type="bibr" rid="c33">Kauffman and Levin, 1987</xref>) similarly contains a parameter (<italic>K</italic>, the number of genes in an epistatic interaction) that can be used to tune the ruggedness of the landscape. However, this parameter is discrete and changing it leads to a more drastic shift in the structure of the fitness landscape.</p>
</sec>
<sec id="s2b3">
<title>Tunable clonal interference</title>
<p>For low mutation rate, the population is in the SSWM regime and the evolutionary dynamics correspond to sequential sweeps of beneficial mutations throughout the population, which consists of a single dominant strain (<xref ref-type="fig" rid="fig1">Figure 1D</xref>). As the mutation rate increases, the adaptation dynamics become richer, enabling higher-order effects such as multiple mutations (<xref ref-type="bibr" rid="c67">Weissman et al., 2009</xref>), stochastic tunneling (<xref ref-type="bibr" rid="c32">Iwasa et al., 2004</xref>; <xref ref-type="bibr" rid="c27">Guo et al., 2019</xref>), and competing populations, all of which emerge naturally in our simulations.</p>
</sec>
<sec id="s2b4">
<title>Efficiency</title>
<p><xref ref-type="disp-formula" rid="eqn1">Equation (1)</xref> has significant computational advantages—summarized by Lemma C.1— that enable us to develop a large-scale simulation. Leveraging algebraic simplifications intrinsic to the model’s mathematical structure, the fitness of a given strain may be computed as a correction to the fitness of a reference strain that is updated adaptively to track the state of the population. The resulting “adaptive fast fitness computation” is several orders of magnitude faster than a naive calculation, and our ability to simulate to long times in the strong clonal interference regime hinges upon it.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Results</title>
<sec id="s3a">
<label>3.1</label>
<title>Landscape ruggedness slows the fitness trajectory</title>
<p>We first study the effect of microscopic epistasis on the functional form of the fitness trajectory in both the SSWM (<italic>μ</italic> = 10<sup>−8</sup>) and clonal interference (<italic>μ</italic> = 2 × 10<sup>−4</sup>) mutation regimes (<xref ref-type="fig" rid="fig2">Figure 2</xref>). Intuitively, by complicating the fitness landscape and increasing the difficulty of the corresponding optimization problem, we expect that greater levels of microscopic epistasis may lead to a slower fitness trajectory with a longer duration required to reach a peak. We find that the value of the fitness peak increases slightly with increasing <italic>β</italic>. To eliminate this variability, each mean fitness trajectory is normalized to lie between the values 1 and 2 for visualization. The fitness trajectory takes more time to approach its asymptotic value as <italic>β</italic> increases, indicating a slower approach to equilibrium (<xref ref-type="fig" rid="fig2">Figure 2A/B</xref>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Increasing landscape ruggedness slows the fitness trajectory. Left: SSWM. Right: Clonal interference.</title>
<p>Error bars for the first four panes (shown as shaded regions, for this and other figures) indicate standard error of the mean over replicates. (A) Normalized fitness trajectories as a function of <italic>β</italic> in the SSWM limit (<italic>μ</italic> = 10<sup>−8</sup>). Higher values of <italic>β</italic> exhibit a slower approach towards the fitness peak. (B) Normalized fitness trajectories in the clonal interference regime (<italic>μ</italic> = 2 × 10<sup>−4</sup>). (C) Substitution trajectories in the SSWM limit (<italic>μ</italic> = 10<sup>−8</sup>). Higher values of β lead to a greater number of fixed mutations. (D) Substitution trajectories in the clonal interference regime (<italic>μ</italic> = 2 × 10<sup>−4</sup>). (E) Fitness relaxation exponents as a function of <italic>β</italic> in the SSWM limit and clonal interference regimes. As <italic>β</italic> increases, the fitness relaxation slows. Dashed lines indicate analytically-computable exponents <italic>c</italic> = 2.0 for <italic>β</italic> = 0 and <italic>c</italic> = 0.5 for <italic>β</italic> = 1.0 in the SSWM regime. Error bars indicate 95% quantiles computed from the bootstrap distribution (for details, see Appendix B).</p></caption>
<graphic xlink:href="524306v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Insight into the mechanism by which epistasis slows the fitness trajectory can be obtained by visualizing the substitution trajectories (<xref ref-type="fig" rid="fig2">Figure 2C/D</xref>), which describe the number of mutations that have fixed in the population at time <italic>t</italic>. The substitution trajectories demonstrate that increasing the amount of microscopic epistasis smoothly leads to an accumulation of more fixed mutations at each time. Because the initial rank (the number of available beneficial mutations) is identical for each value of <italic>β</italic>, the substitution trajectories suggest a simple picture: as <italic>β</italic> increases, a greater number of new available beneficial mutations are generated per each typical fixation event. Moreover, because more mutations are needed to cease adaptation, each typical fixation event must provide less progress towards the fitness peak. Mathematically, this corresponds to a greater prevalence of “flat regions” in the fitness landscape, which have been identified as a source of slow dynamics in previous studies of spin-glass physics (<xref ref-type="bibr" rid="c40">Kurchan and Laloux, 1996</xref>).</p>
<p>These observations highlight the role of microscopic epistasis in slowing down long-term evolutionary dynamics, but they do not make a quantitative claim about the functional form of the fitness trajectory. To make such a claim, we can fit the data to a predictive model and study how the model parameters depend on <italic>β</italic>. The functional form of the fitness trajectory can be computed analytically in the SSWM regime in a fitness-parameterized context approximately met by our fitness model with <italic>β</italic> = 0 (<xref ref-type="bibr" rid="c24">Good and Desai, 2015</xref>); the resulting trajectory is given by the power-law relaxation
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="524306v1_eqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
with <italic>F</italic><sub>∞</sub> = ∑<sub><italic>i</italic></sub>|<italic>h<sub>i</sub></italic>|, <italic>c</italic> = 2, and <italic>F</italic><sub>0</sub> = 1 by our choice of <italic>F</italic><sub>off</sub>. We find empirically that in both the SSWM and clonal interference regimes, the power-law in (2) provides a good fit to the mean fitness trajectory for <italic>β</italic> &gt; 0.</p>
<p>We fit (2) to the mean fitness trajectory (see Appendix B details) over a range of values of <italic>β</italic> (<xref ref-type="fig" rid="fig2">Figure 2E</xref>). In both regimes, the relaxation exponent c decreases monotonically with increasing <italic>β</italic>, indicating a quantitative slowdown of the fitness trajectory with increasing levels of microscopic epistasis. In the next section, we will show that we can estimate the exponent <italic>c</italic> = 0.5 for <italic>β</italic> = 1.0 in the SSWM regime.</p>
</sec>
<sec id="s3b">
<label>3.2</label>
<title>A fitness-parameterized mapping</title>
<p>The mechanism suggested by the substitution trajectories can be confirmed by mapping the microscopic model to a fitness-parameterized landscape with two effective parameters: a single beneficial fitness increment given by the expected beneficial fitness increment 〈Δ<italic>F<sub>b</sub></italic>〉<xref ref-type="fn" rid="fn1"><sup>1</sup></xref>, and a beneficial mutation rate set by the rank <italic>R</italic> (<xref ref-type="fig" rid="fig3">Figure 3</xref>). The reduction to a few-parameter fitness-parameterized model has been justified both theoretically (<xref ref-type="bibr" rid="c25">Good et al., 2012</xref>) and experimentally (<xref ref-type="bibr" rid="c29">Hegreness et al., 2006</xref>) in the clonal interference regime, and we find that it similarly provides useful insight in the SSWM regime.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><title>A mapping to a fitness-parameterized landscape as a function of <italic>β</italic>. Top: SSWM. Bottom: Clonal interference.</title>
<p>Error bars in the first four panes indicate standard error of the mean over replicates. (A) Rank as a function of fitness in the SSWM regime. The functional form of <italic>R</italic>(<italic>F</italic>) changes significantly as <italic>β</italic> varies, progressing from a concave decreasing function for <italic>β</italic> = 0.25 towards a linear form for <italic>β</italic> =1. For all <italic>β</italic> ≠ 0, the rank decreases monotonically with <italic>β</italic>. (B) Expected normalized beneficial fitness increment 〈Δ<italic>F<sub>b</sub></italic>〉 as a function of normalized fitness in the SSWM regime. Global epistasis emerges naturally in our model, leading to a linear decrease in 〈Δ<italic>F<sub>b</sub></italic>〉 with <italic>F</italic> for all nonzero values of <italic>β</italic>. For all values of <italic>β</italic>, the increment decreases monotonically with <italic>β</italic>. (C/D) Rank/expected increment as a function of fitness with clonal interference; similar observations hold as for SSWM.</p></caption>
<graphic xlink:href="524306v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In both mutation regimes, for all nonzero values of <italic>β</italic>, the expected beneficial increment behaves linearly as a function of fitness (<xref ref-type="fig" rid="fig3">Figure 3B/D</xref>). This phenomenon is known as “macroscopic” or “global” epistasis, and has been shown to be an emergent property of a class of finite-sites models similar to the one considered here (<xref ref-type="bibr" rid="c58">Reddy and Desai, 2021</xref>). Consistent with the observations of the previous section, the expected beneficial increment (scaled relative to the fitness peak) decreases with <italic>β</italic> at fixed fitness, which highlights that microscopic epistasis tends to reduce the progress towards the peak provided by each typical fixation event.</p>
<p>Unlike the beneficial fitness increment, the rank <italic>R</italic>(<italic>F</italic>) exhibits more variation in functional form as <italic>β</italic> is varied, which progresses towards linearity as <italic>β</italic> tends to one (<xref ref-type="fig" rid="fig3">Figure 3A/C</xref>). Considering only <italic>β</italic> &gt; 0, <italic>R</italic>(<italic>F</italic>) decreases with increasing <italic>β</italic> at each <italic>F</italic>; including <italic>β</italic> = 0, this is also true for sufficiently large <italic>F</italic>. This indicates that at any fixed distance from the fitness peak, it is less likely to achieve a beneficial mutation.</p>
<p>Taken together, these observations demonstrate that microscopic epistasis leads to a slower fitness trajectory through two complementary effects. At each fixed value of fitness, beneficial mutations are less likely to be found by random mutation; moreover, more of them are required to reach the peak due to a lower typical (normalized) increment. These additional beneficial mutations are generated by the epistatic interaction as each fixation event occurs.</p>
<sec id="s3b1">
<title>Quantitative model</title>
<p>These arguments can also be justified mathematically, leading to a quantitative prediction of <italic>c</italic> = 0.5 for <italic>β</italic> = 1, consistent with the result in <xref ref-type="fig" rid="fig2">Figure 2E</xref>. In such a two-parameter macroscopic model, the fitness evolves according to the dynamics
<disp-formula id="eqn3">
<alternatives><graphic xlink:href="524306v1_eqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where each quantity on the right-hand side is evaluated at <italic>F</italic>(<italic>t</italic>). In the SSWM regime, <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline5.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> according to Haldane’s formula (<xref ref-type="bibr" rid="c28">Haldane, 1927</xref>). The preceding paragraphs demonstrate that <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline6.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> decreases as a function of <italic>β</italic> for each fixed <italic>F</italic>, giving rise to a slower trajectory. From <xref ref-type="fig" rid="fig3">Figure 3A/B</xref>, both <italic>R</italic>(<italic>F</italic>) and 〈Δ<italic>F<sub>b</sub></italic>〉(<italic>F</italic>) are approximately linear and reach zero at <italic>F</italic> = 2. Hence <italic>R</italic> ≈ <italic>k</italic>〈Δ<italic>F<sub>b</sub></italic>〉 for a fixed <italic>k</italic> &gt; 0. <xref ref-type="disp-formula" rid="eqn3">Equation 3</xref> then reads
<disp-formula>
<alternatives><graphic xlink:href="524306v1_ueqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
which predicts that asymptotically
<disp-formula>
<alternatives><graphic xlink:href="524306v1_ueqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
for a fixed <italic>B</italic> &gt; 0. This prediction provides a complement to the analytical result of <italic>c</italic> = 2 in the SSWM regime with <italic>β</italic> = 0.</p>
</sec>
</sec>
<sec id="s3c">
<label>3.3</label>
<title>A random walk model</title>
<p>The previous sections provided an explanation for the effect of microscopic epistasis on long-term adaptation dynamics: as the level of microscopic epistasis increases, the typical number of available beneficial mutations at fixed fitness decreases while the number of fixed mutations required to reach the peak increases, leading to a slower trajectory. In this section, we formulate a mechanistic model that provides a qualitative explanation for why microscopic epistasis generates new beneficial mutations and slows the trajectory.</p>
<sec id="s3c1">
<title>Distribution of increments</title>
<p>The previous section highlighted that the mechanism is common to both the SSWM and clonal interference regimes, for which reason we resort to the SSWM limit in the subsequent analysis. In the SSWM limit, a single empirical distribution of fitness effects is induced by the fitness landscape
<disp-formula id="eqn4">
<alternatives><graphic xlink:href="524306v1_eqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where Δ<italic>F<sub>i</sub></italic>(<italic>t</italic>) = −2<italic>α<sub>i</sub></italic>(<italic>t</italic>) (<italic>h<sub>i</sub></italic> + ∑<sub><italic>j</italic></sub><italic>J<sub>ij</sub>α<sub>j</sub></italic>(<italic>t</italic>) is the fitness effect of a mutation at gene <italic>i</italic> at time <italic>t</italic>. Because there is only a single strain, the dynamics of adaptation can be characterized entirely by the evolution of <italic>ρ<sub>t</sub></italic> in time. When a mutation at site <italic>i</italic> fixes (which can only occur if Δ<italic>F<sub>i</sub></italic>(<italic>t</italic>) &gt; 0), the corresponding increment is updated:
<disp-formula id="eqn5">
<alternatives><graphic xlink:href="524306v1_eqn5.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>In the absence of microscopic epistasis, each such fixation event would decrease the rank by one until all available beneficial mutations have fixed. However, due to microscopic epistasis, the fixation of a mutation at gene <italic>i</italic> causes a change in all other fitness increments:
<disp-formula id="eqn6">
<alternatives><graphic xlink:href="524306v1_eqn6.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>The update to the fitness increment in (6) is complex due to the presence of correlations between <italic>α<sub>i</sub></italic> and <italic>α<sub>j</sub></italic> induced by the coupling <italic>J<sub>ij</sub></italic>. Moreover, the distribution of <italic>α<sub>i</sub>α<sub>j</sub>J<sub>ij</sub></italic> must be conditioned on the event that Δ<italic>F<sub>i</sub></italic> &gt; 0. Previous studies in spin glass (<xref ref-type="bibr" rid="c31">Horner, 2007</xref>; <xref ref-type="bibr" rid="c14">Eastham et al., 2006</xref>) and electron glass (<xref ref-type="bibr" rid="c51">Mogilyanskii and Raikh, 1989</xref>; <xref ref-type="bibr" rid="c1">Amir et al., 2008</xref>) physics have obtained significant physical insight by neglecting dynamical correlations, and here we take a similar approach.</p>
</sec>
<sec id="s3c2">
<title>Update statistics</title>
<p>The neglect of dynamical correlations implies that the effect of each fixation event is to add a random Gaussian noise term with probability <italic>ρ</italic> (the network sparsity parameter) to all other increments,
<disp-formula id="eqn7">
<alternatives><graphic xlink:href="524306v1_eqn7.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>Above, <italic>μ<sub>β</sub></italic> and <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline7.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> are mean and variance parameters of the noise distribution; these can be estimated numerically from data to account for initialization from a state with <italic>R</italic> = 100 and to condition on beneficial mutation events (Appendix B). This process corresponds to a biased random walk (<xref ref-type="disp-formula" rid="eqn7">Equation (7)</xref>) with nonlocal transport (<xref ref-type="disp-formula" rid="eqn5">Equation (5)</xref>) on the fitness increments.</p>
</sec>
<sec id="s3c3">
<title>Coarse-grained simulation</title>
<p>To test this mechanistic model, we developed a coarse-grained simulation methodology based on Gillespie’s stochastic simulation algorithm (<xref ref-type="bibr" rid="c19">Gillespie, 1976</xref>) (Appendix B). Fitting the power law in (2) to the mean fitness trajectories shows that the random walk model predicts a monotonically decreasing exponent and an increased number of fixed mutations to reach a local fitness maximum as a function of <italic>β</italic> (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). This is qualitatively consistent with the results of applying the same coarse-grained simulation approach in the SSWM approximation to the full fitness model (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). Due to the neglect of correlations, the random walk model predicts a lower number of generated beneficial mutations and a correspondingly higher fitness exponent.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><title>A simple random walk model captures the generation of beneficial mutations and a decreasing exponent with increasing microscopic epistasis.</title>
<p>(A) Fitness relaxation exponent and number of fixed mutations to reach a local fitness maximum (zero rank) as a function of <italic>β</italic>, computed within the random walk model (which neglects correlations). The model predicts a monotonically decreasing exponent and a monotonically increasing number of fixations as a function of <italic>β</italic>. Error bars around exponents indicate 95% quantiles from the bootstrap distribution (100 samples) while central line depicts the median. Error bars around number of fixations indicate standard deviation over 200 replicates and central line the mean. (B) Analogous figure to (A), but within the SSWM approximation using a coarse-grained Gillespie simulation framework (where correlations develop over time). The behavior is qualitatively similar to the random walk model, though the exponent decreases further and the number of fixation events is larger. (C) Illustration of the diffusive generation of mutations. As beneficial mutations fix, the beneficial half of the distribution of fitness increments <italic>ρ<sub>t</sub></italic>(Δ<italic>F</italic>) is depleted and transported to the deleterious half. Each fixation event causes the distribution to broaden due to the epistatic interaction, which combines with a buildup of deleterious mutations to create a diffusive flux from the deleterious half to the beneficial half of the distribution.</p></caption>
<graphic xlink:href="524306v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s3c4">
<title>Why are beneficial mutations generated?</title>
<p>Because only beneficial mutations can fix in the SSWM limit, the transport in (5) is asymmetric, and beneficial mutations will be rapidly converted to deleterious mutations with equal magnitude but opposite sign. The noise in (7) broadens the distribution of fitness increments, which converts deleterious mutations with small magnitude into beneficial mutations with small magnitude and vice-versa. The buildup of deleterious mutations results in a diffusive flux from the deleterious half to the beneficial half, providing a simple mechanism for the formation of new beneficial mutations (<xref ref-type="fig" rid="fig4">Figure 4C</xref>). Empirically, we find that <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline8.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> increases with <italic>β</italic>, driving the generation of a greater number of mutations with increasing <italic>β</italic> and correspondingly slower trajectory.</p>
</sec>
</sec>
<sec id="s3d">
<label>3.4</label>
<title>The effect of clonal interference</title>
<p>Clonal interference is known to reduce fixation probabilities (<xref ref-type="bibr" rid="c18">Gerrish and Lenski, 1998</xref>; <xref ref-type="bibr" rid="c47">Lin et al., 2020b</xref>), and hence to slow down the rate of adaptation when compared to an SSWM model with the same parameters. Given its prevalence in realistic evolving laboratory populations, models incorporating both clonal interference and macroscopic epistasis have been developed to predict the slow power law fitness trajectory observed in Lenski’s long-term evolution experiment (<xref ref-type="bibr" rid="c69">Wiser et al., 2013</xref>). Despite this interest, the effect of clonal interference on the shape of the fitness trajectory is still poorly understood.</p>
<p>In fitness-parameterized models, for sufficiently weak clonal interference, the way clonal interference affects the shape of the fitness trajectory depends on how the beneficial mutation rate changes with fitness (<xref ref-type="bibr" rid="c26">Guo and Amir, 2022</xref>). In particular, for typical models where beneficial mutations become less prevalent as the population climbs up the hill, clonal interference <italic>accelerates</italic> the fitness trajectory. While this result provides insight into the role of clonal interference in laboratory populations, it is not clear if it holds more generally in a microscopic framework, or when the magnitude of clonal interference becomes large. Here, we demonstrate that the effect of clonal interference on the fitness trajectory depends on the strength of microscopic epistasis. In its absence, clonal interference is seen to accelerate the trajectory, while for a sufficiently strong epistatic interaction, clonal interference does not quantitatively affect the speed of the trajectory.</p>
<p>In simulation, the magnitude of clonal interference is tuned by adjusting the mutation rate <italic>μ</italic>. Increasing the mutation rate increases clonal interference, but also accelerates adaptation by allowing for more mutations each day. This effect can be eliminated by normalizing time by the mutation rate, so as to isolate the role of clonal interference itself. Viewed in these units, clonal interference decelerates the fitness trajectory due to the suppression of fixation probabilities (<xref ref-type="fig" rid="fig7">Figure 7</xref>)).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><title>The effect of clonal interference on the fitness trajectory depends on the strength of microscopic epistasis.</title>
<p>Results of fitting the power law in (2) as a function of <italic>μ</italic>. The relaxation exponent c increases monotonically with <italic>μ</italic> for the non-epistatic model (<italic>β</italic> = 0), while the exponent remains essentially constant in the epistatic model (<italic>β</italic> = 0.25).</p></caption>
<graphic xlink:href="524306v1_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption><title>A mapping to a fitness-parameterized landscape as a function of <italic>μ</italic>. Left: non-epistatic (<italic>β</italic> = 0). Right: epistatic (<italic>β</italic> = 0.25).</title>
<p>(A/B) Unlike in classical fitness-parameterized models, the level of clonal interference cannot be tuned independently from the landscape. Because clonal interference modifies fixation probabilities, the conditional distribution of fitness effects <italic>ρ<sub>μ</sub></italic>(Δ<italic>F</italic>|<italic>F</italic>) depends on <italic>μ</italic> both with and without epistasis (epistatic: <italic>F</italic> ≈ 1.85; non-epistatic: <italic>F</italic> ≈ 1.65. Distributions were approximated via kernel density estimation with a bandwidth parameter <italic>σ</italic> = 1.0). (C/D) Expected beneficial increment as a function of fitness. Both with and without epistasis, the expected increment tends to decrease with increasing <italic>μ</italic> at fixed fitness, capturing the fact that higher <italic>μ</italic> favors the fixation of mutations with higher effect. (E/F) Average rank as a function of fitness. Without epistasis, the rank decreases with increasing <italic>μ</italic> at fixed fitness. With epistasis, the rank curves behave non-monotonically in <italic>μ</italic> at fixed fitness, and become comparable at high fitness. Inset in (F) shows rank as a function of <italic>μ</italic> for fixed <italic>F</italic> ≈ 1.9, highlighting the non-monotonic behavior.</p></caption>
<graphic xlink:href="524306v1_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption><title>The effect of clonal interference on the fitness trajectory: re-scaling by <italic>μ</italic>. Left: epistatic. Right: non-epistatic.</title>
<p>(A/B) When measuring time in units of the mutation rate, clonal interference slows the fitness trajectory due to a suppresion of fixation probabilities. All trajectories are initialized at one, consistent with previous result: logarithmic time axis hides the very early time dynamics.</p></caption>
<graphic xlink:href="524306v1_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>When measuring the speed of a fitness trajectory, it is more rigorous to assign a quantitative measure by fitting a functional form such as the power law in (2), which will directly estimate the timescale parameter <italic>a</italic> independently for each <italic>μ</italic>. Fitting this power law reveals exponents that hover around <italic>c</italic> ≈ 0.8 in the epistatic setting (here, <italic>β</italic> = 0.25), but increase from <italic>c</italic> ≈ 1.85 for <italic>μ</italic> = 10<sup>−8</sup> to <italic>c</italic> ≈ 2.6 for <italic>μ</italic> = 10<sup>−4</sup> in the non-epistatic setting (<xref ref-type="fig" rid="fig5">Figure 5</xref>). These results can also be visualized qualitatively by normalizing time in units such that the initial rate of fitness increase is constant for different values of <italic>μ</italic>, as was done for the results in <xref ref-type="fig" rid="fig2">Figure 2</xref> via the definition of <italic>β</italic> (<xref ref-type="fig" rid="fig8">Figure 8</xref>).</p>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure">
<label>Figure 8:</label>
<caption><title>The effect of clonal interference on the fitness trajectory: rescaling by <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline19.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. Left: epistatic. Right: non-epistatic.</title>
<p>(A/B) Geometrically, rescaling time by the initial rate of fitness increase ensures that “slower” trajectories reach the fitness peak at a later time, in qualitative agreement with the results of power-law fitting. Assuming a power law functional form as in the main text, at long times −log(<italic>F</italic><sub>∞</sub> − <italic>F</italic>(<italic>t</italic>)) = <italic>c</italic> log(1 + <italic>at</italic>) − log(<italic>F</italic><sub>∞</sub> − <italic>F</italic><sub>0</sub>) becomes linear with slope given by the exponent <italic>c</italic>. The asymptotic slope increases with <italic>μ</italic> without microscopic epistasis (A, <italic>β</italic> = 0), but does not clearly depend on the mutation rate with microscopic epistasis (B, <italic>β</italic> = 0.25).</p></caption>
<graphic xlink:href="524306v1_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s3d1">
<title>A change in the effective landscape</title>
<p>To understand this result – and why it differs from the predictions of the fitness-parameterized setting – we can map the microscopic model to an effective fitness-parameterized landscape (<xref ref-type="fig" rid="fig6">Figure 6</xref>). This mapping reveals a striking observation: the effective macroscopic model depends on the mutation rate, which is typically treated as an independent parameter in the standard fitness-parameterized framework. Intuitively, there are many states in the landscape with the same value of <italic>F</italic> but which differ in their conditional distribution of increments <italic>ρ</italic>(Δ<italic>F</italic>|<italic>F</italic>); these states are dynamically selected in a way that depends on the level of clonal interference. In both the epistatic and non-epistatic landscapes, we find that the distribution becomes more sharply peaked for higher levels of clonal interference, while it has a heavier tail for lower levels (<xref ref-type="fig" rid="fig6">Figure 6A/B</xref>). This occurs because clonal interference suppresses the fixation of low-effect mutations. The result is that systems with high clonal interference typically reach a given <italic>F</italic> through fewer, more valuable mutations, while systems with low clonal interference typically reach <italic>F</italic> through the accumulation of more low-value mutations.</p>
<p>This effect can be visualized over the trajectory by making use of the summary statistics 〈Δ<italic>F<sub>b</sub></italic>〉 (expected increment) and <italic>R</italic> (rank) viewed as a function of the fitness. In both landscapes, the expected increment decreases with increasing <italic>μ</italic> (<xref ref-type="fig" rid="fig6">Figure 6C/D</xref>). By contrast, the behavior of the rank depends on the strength of microscopic epistasis. Without epistasis, the rank increases with <italic>μ</italic> (<xref ref-type="fig" rid="fig6">Figure 6E</xref>), while with epistasis, the rank becomes non-monotonic in <italic>μ</italic>, and becomes comparable at high fitness (<xref ref-type="fig" rid="fig6">Figure 6F</xref>). This observation suggests the importance of the rank in setting the speed of the fitness trajectory, analogous to the results of <xref ref-type="sec" rid="s3b">Section 3.2</xref>. Both with and without microscopic epistasis, the behavior of the rank with <italic>μ</italic> parallels that of the exponent <italic>c</italic>.</p>
</sec>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Discussion and conclusions</title>
<p>In this paper, motivated by laboratory serial dilution experiments, we developed a high-performance simulation approach to study the dynamics of long-term adaptation. We focused on a generic microscopic model that considers the microbial genome as a collection of sites with a binary value indicating the presence of a mutation. Our model contains a non-dimensional parameter 0 ≤ <italic>β</italic> ≤ 1 that enables us to smoothly tune the relative contribution of microscopic epistasis to the fitness effect Δ<italic>F<sub>i</sub></italic> of a mutation at gene <italic>i</italic>. In addition, we can tune an overall mutation rate <italic>μ</italic> to adjust the magnitude of clonal interference in the culture. By independently varying the parameters <italic>β</italic> and <italic>μ</italic>, we mapped out a phase diagram that describes the effects of microscopic epistasis and clonal interference on the functional form of the mean fitness trajectory.</p>
<p>Our simulation approach gives us the ability to probe microscopic details that are challenging to obtain experimentally, such as statistics of the distribution of fitness effects and the rank over time. The approach also allows us to study regimes such as strong microscopic epistasis and strong clonal interference that have eluded previous theoretical study. In addition to its generality, our model has computational advantages that enable us to probe the long-time dynamics required to reach a local fitness maximum.</p>
<sec id="s4a">
<title>The role of microscopic epistasis</title>
<p>By mapping the model to a simplified fitness-parameterized landscape, we showed that as the strength of microscopic epistasis increases, more mutations are needed to reach a local fitness maximum. In addition, beneficial mutations become less likely; these two properties together lead to a slower trajectory. We isolated a mechanism for this phenomenon – the generation of new, low-effect beneficial mutations mediated by the epistatic interaction when the culture is at high fitness – and we showed through a random walk model that this generation is sufficient to slow the fitness trajectory.</p>
<p>A by-product of our analysis is an observation that, as microscopic epistasis increases in strength, the beneficial mutation rate becomes an increasingly linear function of fitness, similar to the phenomenon of “global epistasis” observed for the expected beneficial fitness increment (<xref ref-type="bibr" rid="c58">Reddy and Desai, 2021</xref>). This suggests that the strength of epistasis in realistic microbial populations could be inferred by measuring the beneficial mutation rate as a function of fitness experimentally.</p>
</sec>
<sec id="s4b">
<title>The role of clonal interference</title>
<p>Through a similar analysis, we observed that in the microscopic context considered here, any equivalent fitness-parameterized model must depend on the mutation rate <italic>μ</italic>, a parameter that is typically tuned independently. In effect, the change in fixation probabilities induced by clonal interference filters the accessible genotypes with a given fitness <italic>F</italic>, giving rise to a conditional distribution of fitness increments <italic>ρ<sub>μ</sub></italic>(Δ<italic>F</italic>|<italic>F</italic>) that depends on <italic>μ</italic>.</p>
<p>Based on this observation, we showed that the effect of clonal interference on the fitness trajectory differs from prior predictions in the fitness-parameterized setting and depends on the strength of epistasis. In a non-epistatic model, increasing clonal interference accelerates the fitness trajectory. For sufficiently strong microscopic epistasis, clonal interference has no effect on the speed of the fitness trajectory. We leave the development of a mechanistic model capturing this phenomenon to future work.</p>
</sec>
<sec id="s4c">
<title>The beneficial mutation rate</title>
<p>A surprising observation is that the trends of the rank with <italic>β</italic> in <xref ref-type="fig" rid="fig3">Figure 3A/B</xref> and with <italic>μ</italic> in <xref ref-type="fig" rid="fig6">Figure 6E/F</xref> are both consistent with the behavior of the exponent with <italic>β</italic> and <italic>μ</italic>. This is also similar to predictions in the fitness-parameterized framework, where it was found that the effect of clonal interference depends on how the beneficial mutation rate changes with fitness (<xref ref-type="bibr" rid="c26">Guo and Amir, 2022</xref>). Taken together, these results suggest that the behavior of the beneficial mutation rate as a function of fitness plays a central role in setting the speed of the fitness trajectory.</p>
</sec>
<sec id="s4d">
<label>4.1</label>
<title>Future directions</title>
<p>Our model and simulation can be extended in many exciting directions. One possibility is to allow for horizontal gene transfer between bacterial strains. By allowing large jumps across the fitness landscape, horizontal gene transfer may have a similar effect to microscopic epistasis, and could slow the fitness trajectory by generating groups of new beneficial mutations (<xref ref-type="bibr" rid="c61">Slomka et al., 2020</xref>); on the other hand, it could also accelerate the fitness trajectory by allowing for larger steps towards a fitness maximum. Another possibility is to bias the model, so that the <italic>h<sub>i</sub></italic> and <italic>J<sub>ij</sub></italic> have non-zero means, and to study the effect of these mean values on the long-term dynamics. A third possibility is to allow for further structure in the interaction matrix <italic>J</italic>, rather than the i.i.d. random entries considered here. For example, by allowing for low-rank structure in <italic>J</italic>, one could in principle quantify the role of connected modules of mutations on the functional form of the fitness trajectory (<xref ref-type="bibr" rid="c57">Parter et al., 2008</xref>; <xref ref-type="bibr" rid="c41">Landau and Sompolinsky, 2016</xref>, <xref ref-type="bibr" rid="c42">2021</xref>). A final direction would be to form a mechanistic model for the effect of clonal interference both with and without epistasis, similar to the random walk model developed to understand the effect of microscopic epistasis.</p>
<p>In addition to the extensions considered above, our simulation environment forms a fertile testing ground for theoretical predictions. The relaxation exponents as a function of <italic>β</italic> considered in <xref ref-type="fig" rid="fig2">Figure 2E</xref> could in principle be predicted within the random walk approximation using the techniques developed by <xref ref-type="bibr" rid="c31">Horner (2007)</xref>, or within a dynamical mean-field theory that studies the evolution of the average value of the mutation variables 〈<italic>α<sub>i</sub></italic>(<italic>t</italic>)〉 ∈ [−1, 1] over time (<xref ref-type="bibr" rid="c23">Ginzburg and Sompolinsky, 1994</xref>; <xref ref-type="bibr" rid="c63">Sompolinsky and Zippelius, 1981</xref>; <xref ref-type="bibr" rid="c62">Sommers, 1987</xref>). Solving such a model, in addition to analytically quantifying the slowing of the fitness trajectory with <italic>β</italic>, would provide a prediction for a functional form that could be tested against experimental fitness trajectories.</p>
</sec>
</sec>
</body>
<back>
<fn-group>
<fn id="fn1"><label>1</label><p>Here, 〈·〉 denotes an average over the distribution of fitness effects at time <italic>t</italic>. Moreover, this quantity is normalized via the same change of scale to ensure <italic>F</italic>(<italic>t</italic>) ∈ [1, 2].</p></fn>
</fn-group>
<ack>
<label>4.2</label>
<title>Acknowledgments</title>
<p>We thank Haim Sompolinsky, Guy Bunin, and Yoav Ram for many useful discussions, and we thank Jimmy Almgren-Bell for contributions to an initial version of the simulation software. N. M. B. was partially supported by the Research Training Group in Modeling and Simulation funded by the National Science Foundation via grant RTG/DMS – 1646339. C. H. R. was partially supported by the Applied Mathematics Program of the U.S. DOE Office of Science Advanced Scientific Computing Research under Contract No. DE-AC02-05CH11231.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name>, <string-name><given-names>Yuval</given-names> <surname>Oreg</surname></string-name>, and <string-name><given-names>Yoseph</given-names> <surname>Imry</surname></string-name>. <article-title>Mean-field model for electron-glass dynamics</article-title>. <source>Phys. Rev. B</source>, <volume>77</volume>, <year>2008</year>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><given-names>Daniel J.</given-names> <surname>Amit</surname></string-name>, <string-name><given-names>Hanoch</given-names> <surname>Gutfreund</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Spin-glass models of neural networks</article-title>. <source>Phys. Rev. A</source>, <volume>32</volume>, <year>1985a</year>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><given-names>Daniel J.</given-names> <surname>Amit</surname></string-name>, <string-name><given-names>Hanoch</given-names> <surname>Gutfreund</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Storing infinite numbers of patterns in a spin-glass model of neural networks</article-title>. <source>Phys. Rev. Lett</source>., <volume>55</volume>, <year>1985b</year>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><given-names>G. Ben</given-names> <surname>Arous</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Dembo</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Guionnet</surname></string-name>. <article-title>Aging of spherical spin glasses</article-title>. <source>Probability Theory and Related Fields</source>, <volume>120</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>67</lpage>, <month>May</month> <year>2001</year>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><given-names>Christopher W.</given-names> <surname>Bakerlee</surname></string-name>, <string-name><given-names>Alex N.</given-names> <surname>Nguyen Ba</surname></string-name>, <string-name><given-names>Yekaterina</given-names> <surname>Shulgina</surname></string-name>, <string-name><given-names>Jose I.</given-names> <surname>Rojas Echenique</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>Idiosyncratic epistasis leads to global fitness–correlated trends</article-title>. <source>Science</source>, <volume>376</volume> (<issue>6593</issue>):<fpage>630</fpage>–<lpage>635</lpage>, <month>May</month> <year>2022</year>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><given-names>Jeffrey E.</given-names> <surname>Barrick</surname></string-name> <etal>et al.</etal> <article-title>Genome evolution and adaptation in a long-term experiment with Escherichia coli</article-title>. <source>Nature</source>, <volume>461</volume>(<issue>7268</issue>), <year>2009</year>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="other"><string-name><given-names>Anna</given-names> <surname>Choromanska</surname></string-name>, <string-name><given-names>Yann</given-names> <surname>LeCun</surname></string-name>, and <string-name><given-names>Gérard</given-names> <surname>Ben Arous</surname></string-name>. <article-title>Open problem: The landscape of the loss surfaces of multilayer networks</article-title>. In <person-group person-group-type="editor"><string-name><given-names>Peter</given-names> <surname>Grünwald</surname></string-name>, <string-name><given-names>Elad</given-names> <surname>Hazan</surname></string-name>, and <string-name><given-names>Satyen</given-names> <surname>Kale</surname></string-name></person-group>, editors, <source>Proceedings of The 28th Conference on Learning Theory, volume 40 of Proceedings of Machine Learning Research</source>, <year>2015</year>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><given-names>Hsin-Hung</given-names> <surname>Chou</surname></string-name>, <string-name><given-names>Hsuan-Chao</given-names> <surname>Chiu</surname></string-name>, <string-name><given-names>Nigel F</given-names> <surname>Delaney</surname></string-name>, <string-name><given-names>Daniel</given-names> <surname>Segrè</surname></string-name>, and <string-name><given-names>Christopher J</given-names> <surname>Marx</surname></string-name>. <article-title>Diminishing returns epistasis among beneficial mutations decelerates adaptation</article-title>. <source>Science</source>, <volume>332</volume>(<issue>6034</issue>):<fpage>1190</fpage>–<lpage>1192</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><given-names>Michael</given-names> <surname>Costanzo</surname></string-name> <etal>et al.</etal> <article-title>A global genetic interaction network maps a wiring diagram of cellular function</article-title>. <source>Science</source>, <volume>353</volume>(<issue>6306</issue>), <year>2016</year>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><given-names>J</given-names> <surname>Arjan</surname></string-name> <string-name><given-names>G M</given-names> <surname>de Visser</surname></string-name> and <string-name><given-names>Daniel E</given-names> <surname>Rozen</surname></string-name>. <article-title>Clonal Interference and the Periodic Selection of New Beneficial Mutations in Escherichia coli</article-title>. <source>Genetics</source>, <volume>172</volume>(<issue>4</issue>):<fpage>2093</fpage>–<lpage>2100</lpage>, <month>April</month> <year>2006</year>. ISSN <issn>1943-2631</issn>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><given-names>M. M.</given-names> <surname>Desai</surname></string-name> and <string-name><given-names>D. S.</given-names> <surname>Fisher</surname></string-name>. <article-title>Beneficial mutation selection balance and the effect of linkage on positive selection</article-title>. <source>Genetics</source>, <volume>176</volume>(<issue>3</issue>), <year>2007</year>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>, <string-name><given-names>Daniel S.</given-names> <surname>Fisher</surname></string-name>, and <string-name><given-names>Andrew W.</given-names> <surname>Murray</surname></string-name>. <article-title>The speed of evolution and maintenance of variation in asexual populations</article-title>. <source>Current Biology</source>, <volume>17</volume>(<issue>5</issue>):<fpage>385</fpage>–<lpage>394</lpage>, <year>2007</year>. ISSN <issn>0960-9822</issn>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><given-names>Juan</given-names> <surname>Diaz-Colunga</surname></string-name>, <string-name><given-names>Abigail</given-names> <surname>Skwara</surname></string-name>, <string-name><given-names>Karna</given-names> <surname>Gowda</surname></string-name>, <string-name><given-names>Ramon</given-names> <surname>Diaz-Uriarte</surname></string-name>, <string-name><given-names>Mikhail</given-names> <surname>Tikhonov</surname></string-name>, <string-name><given-names>Djordje</given-names> <surname>Bajic</surname></string-name>, and <string-name><given-names>Alvaro</given-names> <surname>Sanchez</surname></string-name>. <article-title>Global epistasis on fitness landscapes</article-title>. <source>arXiv:2210.03677</source>, <year>2022</year>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><given-names>P. R.</given-names> <surname>Eastham</surname></string-name>, <string-name><given-names>R. A.</given-names> <surname>Blythe</surname></string-name>, <string-name><given-names>A. J.</given-names> <surname>Bray</surname></string-name>, and <string-name><given-names>M. A.</given-names> <surname>Moore</surname></string-name>. <article-title>Mechanism for the failure of the edwards hypothesis in the sherrington-kirkpatrick spin glass</article-title>. <source>Phys. Rev. B</source>, <volume>74</volume>, <year>2006</year>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><given-names>Henrik</given-names> <surname>Flyvbjerg</surname></string-name> and <string-name><given-names>Benny</given-names> <surname>Lautrup</surname></string-name>. <article-title>Evolution in a rugged fitness landscape</article-title>. <source>Physical Review A</source>, <volume>46</volume>(<issue>10</issue>):<fpage>6714</fpage>–<lpage>6723</lpage>, <year>1992</year>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><given-names>Craig A.</given-names> <surname>Fogle</surname></string-name>, <string-name><given-names>James L.</given-names> <surname>Nagle</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>Clonal interference, multiple mutations and adaptation in large asexual populations</article-title>. <source>Genetics</source>, <volume>180</volume>(<issue>4</issue>), <year>2008</year>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="book"><string-name><given-names>James E.</given-names> <surname>Gentle</surname></string-name>. <source>Random Number Generation and Monte Carlo Methods</source>. <publisher-name>Springer</publisher-name>, <year>1998</year>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><given-names>Philip J</given-names> <surname>Gerrish</surname></string-name> and <string-name><given-names>Richard E</given-names> <surname>Lenski</surname></string-name>. <article-title>The fate of competing beneficial mutations in an asexual population</article-title>. <source>Genetics</source>, <volume>102</volume>:<fpage>127</fpage>, <year>1998</year>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><given-names>Daniel T</given-names> <surname>Gillespie</surname></string-name>. <article-title>A general method for numerically simulating the stochastic time evolution of coupled chemical reactions</article-title>. <source>Journal of Computational Physics</source>, <volume>22</volume>(<issue>4</issue>), <year>1976</year>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><given-names>John H.</given-names> <surname>Gillespie</surname></string-name>. <article-title>A simple stochastic gene substitution model</article-title>. <source>Theoretical Population Biology</source>, <volume>23</volume> (<issue>2</issue>):<fpage>202</fpage>–<lpage>215</lpage>, <year>1983</year>. ISSN <issn>0040-5809</issn>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><given-names>John H.</given-names> <surname>Gillespie</surname></string-name>. <article-title>Molecular Evolution Over the Mutational Landscape</article-title>. <source>Evolution</source>, <volume>38</volume>(<issue>5</issue>):<fpage>1116</fpage>–<lpage>1129</lpage>, <year>1984</year>. ISSN <issn>0014-3820</issn>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="book"><string-name><given-names>John H</given-names> <surname>Gillespie</surname></string-name>. <source>The causes of molecular evolution</source>, volume <volume>2</volume>. <publisher-name>Oxford University Press</publisher-name> On Demand, <year>1991</year>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><given-names>Iris</given-names> <surname>Ginzburg</surname></string-name> and <string-name><given-names>Haim</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Theory of correlations in stochastic neural networks</article-title>. <source>Phys. Rev. E</source>, <volume>50</volume>, <year>1994</year>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><given-names>Benjamin H.</given-names> <surname>Good</surname></string-name> and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>The impact of macroscopic epistasis on long-term evolutionary dynamics</article-title>. <source>Genetics</source>, <volume>199</volume>(<issue>1</issue>), <year>2015</year>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><given-names>Benjamin H.</given-names> <surname>Good</surname></string-name>, <string-name><given-names>Igor M.</given-names> <surname>Rouzine</surname></string-name>, <string-name><given-names>Daniel J.</given-names> <surname>Balick</surname></string-name>, <string-name><given-names>Oskar</given-names> <surname>Hallatschek</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>Distribution of fixed beneficial mutations and the rate of adaptation in asexual populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>109</volume>(<issue>13</issue>), <year>2012</year>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><given-names>Yipei</given-names> <surname>Guo</surname></string-name> and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name>. <article-title>The effect of weak clonal interference on average fitness trajectories in the presence of macroscopic epistasis</article-title>. <source>Genetics</source>, <volume>220</volume>(<issue>4</issue>), <month>April</month> <year>2022</year>. ISSN <issn>1943-2631</issn>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><given-names>Yipei</given-names> <surname>Guo</surname></string-name>, <string-name><given-names>Marija</given-names> <surname>Vucelja</surname></string-name>, and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name>. <article-title>Stochastic tunneling across fitness valleys can give rise to a logarithmic long-term fitness trajectory</article-title>. <source>Science Advances</source>, <volume>5</volume>(<issue>7</issue>), <year>2019</year>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><given-names>J. B. S.</given-names> <surname>Haldane</surname></string-name>. <article-title>A mathematical theory of natural and artificial selection, part v: Selection and mutation</article-title>. <source>Mathematical Proceedings of the Cambridge Philosophical Society</source>, <volume>23</volume>(<issue>7</issue>), <year>1927</year>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><given-names>Matthew</given-names> <surname>Hegreness</surname></string-name>, <string-name><given-names>Noam</given-names> <surname>Shoresh</surname></string-name>, <string-name><given-names>Daniel</given-names> <surname>Hartl</surname></string-name>, and <string-name><given-names>Roy</given-names> <surname>Kishony</surname></string-name>. <article-title>An equivalence principle for the incorporation of favorable mutations in asexual populations</article-title>. <source>Science</source>, <volume>311</volume>(<issue>5767</issue>), <year>2006</year>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><given-names>J J</given-names> <surname>Hopfield</surname></string-name>. <article-title>Neural networks and physical systems with emergent collective computational abilities</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>79</volume>(<issue>8</issue>), <year>1982</year>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><given-names>H.</given-names> <surname>Horner</surname></string-name>. <article-title>Time dependent local field distribution and metastable states in the sk-spin-glass</article-title>. <source>The European Physical Journal B</source>, <volume>60</volume>(<issue>4</issue>), <year>2007</year>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><given-names>Yoh</given-names> <surname>Iwasa</surname></string-name>, <string-name><given-names>Franziska</given-names> <surname>Michor</surname></string-name>, and <string-name><given-names>Martin A.</given-names> <surname>Nowak</surname></string-name>. <article-title>Stochastic tunnels in evolutionary dynamics</article-title>. <source>Genetics</source>, <volume>166</volume>(<issue>3</issue>), <year>2004</year>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><given-names>Stuart</given-names> <surname>Kauffman</surname></string-name> and <string-name><given-names>Simon</given-names> <surname>Levin</surname></string-name>. <article-title>Towards a general theory of adaptive walks on rugged landscapes</article-title>. <source>Journal of Theoretical Biology</source>, <volume>128</volume>(<issue>1</issue>), <year>1987</year>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><given-names>Stuart A</given-names> <surname>Kauffman</surname></string-name> and <string-name><given-names>Edward D</given-names> <surname>Weinberger</surname></string-name>. <article-title>The NK model of rugged fitness landscapes and its application to maturation of the immune response</article-title>. <source>Journal of theoretical biology</source>, <volume>141</volume>(<issue>2</issue>):<fpage>211</fpage>–<lpage>245</lpage>, <year>1989</year>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><given-names>Aisha I</given-names> <surname>Khan</surname></string-name>, <string-name><given-names>Duy M</given-names> <surname>Dinh</surname></string-name>, <string-name><given-names>Dominique</given-names> <surname>Schneider</surname></string-name>, <string-name><given-names>Richard E</given-names> <surname>Lenski</surname></string-name>, and <string-name><given-names>Tim F</given-names> <surname>Cooper</surname></string-name>. <article-title>Negative epistasis between beneficial mutations in an evolving bacterial population</article-title>. <source>Science</source>, <volume>332</volume>(<issue>6034</issue>): <fpage>1193</fpage>–<lpage>1196</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><given-names>J. F. C.</given-names> <surname>Kingman</surname></string-name>. <article-title>A simple model for the balance between selection and mutation</article-title>. <source>Journal of Applied Probability</source>, <volume>15</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>, <year>1978</year>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><given-names>Sergey</given-names> <surname>Kryazhimskiy</surname></string-name>, <string-name><given-names>Gašper</given-names> <surname>Tkačik</surname></string-name>, and <string-name><given-names>Joshua B.</given-names> <surname>Plotkin</surname></string-name>. <article-title>The dynamics of adaptation on correlated fitness landscapes</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>106</volume>(<issue>44</issue>), <year>2009</year>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><given-names>Sergey</given-names> <surname>Kryazhimskiy</surname></string-name>, <string-name><given-names>Daniel P.</given-names> <surname>Rice</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>Population subdivision and adaptation in asexual populations of saccharomyces cerevisiae</article-title>. <source>Evolution</source>, <volume>66</volume>(<issue>6</issue>):<fpage>1931</fpage>–<lpage>1941</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><given-names>Sergey</given-names> <surname>Kryazhimskiy</surname></string-name>, <string-name><given-names>Daniel P.</given-names> <surname>Rice</surname></string-name>, <string-name><given-names>Elizabeth R.</given-names> <surname>Jerison</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>Global epistasis makes adaptation predictable despite sequence-level stochasticity</article-title>. <source>Science</source>, <volume>344</volume>(<issue>6191</issue>):<fpage>1519</fpage>–<lpage>1522</lpage>, <month>June</month> <year>2014</year>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><given-names>Jorge</given-names> <surname>Kurchan</surname></string-name> and <string-name><given-names>Laurent</given-names> <surname>Laloux</surname></string-name>. <article-title>Phase space geometry and slow dynamics</article-title>. <source>Journal of Physics A: Mathematical and General</source>, <volume>29</volume>(<issue>9</issue>):<fpage>1929</fpage>–<lpage>1948</lpage>, <year>1996</year>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><given-names>Itamar D.</given-names> <surname>Landau</surname></string-name> and <string-name><given-names>Haim</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>The impact of structural heterogeneity on excitation-inhibition balance in cortical networks</article-title>. <source>Neuron</source>, <volume>92</volume>(<issue>5</issue>), <year>2016</year>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><given-names>Itamar D.</given-names> <surname>Landau</surname></string-name> and <string-name><given-names>Haim</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Macroscopic fluctuations emerge in balanced networks with incomplete recurrent alignment</article-title>. <source>Phys. Rev. Research</source>, <volume>3</volume>, <year>2021</year>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><given-names>Richard E.</given-names> <surname>Lenski</surname></string-name>. <article-title>Experimental evolution and the dynamics of adaptation and genome evolution in microbial populations</article-title>. <source>The ISME Journal</source>, <volume>11</volume>(<issue>10</issue>), <year>2017</year>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><given-names>Richard E</given-names> <surname>Lenski</surname></string-name> and <string-name><given-names>Michael</given-names> <surname>Travisano</surname></string-name>. <article-title>Dynamics of adaptation and diversification: a 10,000-generation experiment with bacterial populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>91</volume>(<issue>15</issue>):<fpage>6808</fpage>–<lpage>6814</lpage>, <year>1994</year>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><given-names>Richard E</given-names> <surname>Lenski</surname></string-name>, <string-name><given-names>Michael R</given-names> <surname>Rose</surname></string-name>, <string-name><given-names>Suzanne C</given-names> <surname>Simpson</surname></string-name>, and <string-name><given-names>Scott C</given-names> <surname>Tadler</surname></string-name>. <article-title>Long-term experimental evolution in Escherichia coli. I. Adaptation and divergence during 2,000 generations</article-title>. <source>The American Naturalist</source>, <volume>138</volume>(<issue>6</issue>):<fpage>1315</fpage>–<lpage>1341</lpage>, <year>1991</year>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><given-names>Jie</given-names> <surname>Lin</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Manhart</surname></string-name>, and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name>. <article-title>Evolution of microbial growth traits under serial dilution</article-title>. <source>Genetics</source>, <volume>215</volume>(<issue>3</issue>):<fpage>767</fpage>–<lpage>777</lpage>, <day>07</day> <year>2020a</year>. ISSN <issn>1943-2631</issn>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><given-names>Jie</given-names> <surname>Lin</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Manhart</surname></string-name>, and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name>. <article-title>Evolution of microbial growth traits under serial dilution</article-title>. <source>Genetics</source>, <volume>215</volume>(<issue>3</issue>):<fpage>767</fpage>–<lpage>777</lpage>, <year>2020b</year>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><given-names>C. A.</given-names> <surname>Macken</surname></string-name> and <string-name><given-names>A. S.</given-names> <surname>Perelson</surname></string-name>. <article-title>Protein evolution on rugged landscapes</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>, <volume>86</volume>(<issue>16</issue>):<fpage>6191</fpage>–<lpage>6195</lpage>, <year>1989</year>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="book"><string-name><given-names>Marc</given-names> <surname>Mezard</surname></string-name> and <string-name><given-names>Andrea</given-names> <surname>Montanari</surname></string-name>. <source>Information, Physics, and Computation</source>. <publisher-name>Oxford University Press, Inc</publisher-name>., <year>2009</year>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="other"><string-name><given-names>Marc</given-names> <surname>Mezard</surname></string-name>, <string-name><given-names>Giorgio</given-names> <surname>Parisi</surname></string-name>, and <string-name><given-names>Miguel Angel</given-names> <surname>Virasoro</surname></string-name>. <article-title>Spin glass theory and beyond</article-title>. <source>World Scientific</source>, <year>1987</year>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><given-names>A. A.</given-names> <surname>Mogilyanskii</surname></string-name> and <string-name><given-names>M. E.</given-names> <surname>Raikh</surname></string-name>. <article-title>Self-consistent description of coulomb gap at finite temperatures</article-title>. <source>Soviet Physics - JETP (English Translation)</source>, <volume>68</volume>(<issue>5</issue>), <year>1989</year>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><given-names>Richard A.</given-names> <surname>Neher</surname></string-name> and <string-name><given-names>Boris I.</given-names> <surname>Shraiman</surname></string-name>. <article-title>Statistical genetics and evolution of quantitative traits</article-title>. <source>Rev. Mod. Phys</source>., <volume>83</volume>, <year>2011</year>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><given-names>H. Allen</given-names> <surname>Orr</surname></string-name>. <article-title>The Population Genetics of Adaptation: The Adaptation of Dna Sequences</article-title>. <source>Evolution</source>, <volume>56</volume>(<issue>7</issue>):<fpage>1317</fpage>–<lpage>1330</lpage>, <year>2002</year>. ISSN <issn>1558-5646</issn>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><given-names>H. Allen</given-names> <surname>Orr</surname></string-name>. <article-title>The Population Genetics of Adaptation on Correlated Fitness Landscapes: The Block Model</article-title>. <source>Evolution</source>, <volume>60</volume>(<issue>6</issue>):<fpage>1113</fpage>–<lpage>1124</lpage>, <year>2006</year>. ISSN <issn>1558-5646</issn>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><given-names>Su-Chan</given-names> <surname>Park</surname></string-name> and <string-name><given-names>Joachim</given-names> <surname>Krug</surname></string-name>. <article-title>Clonal interference in large populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>104</volume>(<issue>46</issue>):<fpage>18135</fpage>–<lpage>18140</lpage>, <month>November</month> <year>2007</year>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><given-names>Su-Chan</given-names> <surname>Park</surname></string-name> and <string-name><given-names>Joachim</given-names> <surname>Krug</surname></string-name>. <article-title>Evolution in random fitness landscapes: the infinite sites model</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source>, <volume>2008</volume>(<issue>04</issue>), <year>2008</year>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><given-names>Merav</given-names> <surname>Parter</surname></string-name>, <string-name><given-names>Nadav</given-names> <surname>Kashtan</surname></string-name>, and <string-name><given-names>Uri</given-names> <surname>Alon</surname></string-name>. <article-title>Facilitated variation: How evolution learns from past environments to generalize to new environments</article-title>. <source>PLOS Computational Biology</source>, <volume>4</volume>(<issue>11</issue>), <year>2008</year>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><given-names>Gautam</given-names> <surname>Reddy</surname></string-name> and <string-name><given-names>Michael M</given-names> <surname>Desai</surname></string-name>. <article-title>Global epistasis emerges from a generic model of a complex trait</article-title>. <source>eLife</source>, <volume>10</volume>:<fpage>e64740</fpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><given-names>Felix</given-names> <surname>Roy</surname></string-name>, <string-name><given-names>Matthieu</given-names> <surname>Barbier</surname></string-name>, <string-name><given-names>Giulio</given-names> <surname>Biroli</surname></string-name>, and <string-name><given-names>Guy</given-names> <surname>Bunin</surname></string-name>. <article-title>Complex interactions can create persistent fluctuations in high-diversity ecosystems</article-title>. <source>PLOS Computational Biology</source>, <volume>16</volume>(<issue>5</issue>):<fpage>1</fpage>–<lpage>14</lpage>, <day>05</day> <year>2020</year>. doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1007827</pub-id>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><given-names>David</given-names> <surname>Sherrington</surname></string-name> and <string-name><given-names>Scott</given-names> <surname>Kirkpatrick</surname></string-name>. <article-title>Solvable model of a spin-glass</article-title>. <source>Phys. Rev. Lett</source>., <volume>35</volume>, <year>1975</year>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><given-names>Shai</given-names> <surname>Slomka</surname></string-name>, <string-name><given-names>Itamar</given-names> <surname>Françoise</surname></string-name>, <string-name><given-names>Gil</given-names> <surname>Hornung</surname></string-name>, <string-name><given-names>Omer</given-names> <surname>Asraf</surname></string-name>, <string-name><given-names>Tammy</given-names> <surname>Biniashvili</surname></string-name>, <string-name><given-names>Yitzhak</given-names> <surname>Pilpel</surname></string-name>, and <string-name><given-names>Orna</given-names> <surname>Dahan</surname></string-name>. <article-title>Experimental evolution of Bacillus subtilis reveals the evolutionary dynamics of horizontal gene transfer and suggests adaptive and neutral effects</article-title>. <source>Genetics</source>, <volume>216</volume>(<issue>2</issue>), <year>2020</year>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><given-names>Hans-Jürgen</given-names> <surname>Sommers</surname></string-name>. <article-title>Path-integral approach to ising spin-glass dynamics</article-title>. <source>Phys. Rev. Lett</source>., <volume>58</volume>, <year>1987</year>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><string-name><given-names>H.</given-names> <surname>Sompolinsky</surname></string-name> and <string-name><given-names>Annette</given-names> <surname>Zippelius</surname></string-name>. <article-title>Dynamic theory of the spin-glass phase</article-title>. <source>Physical Review Letters</source>, <volume>47</volume>(<issue>5</issue>):<fpage>359</fpage>–<lpage>362</lpage>, <month>August</month> <year>1981</year>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="book"><string-name><given-names>H.</given-names> <surname>Sompolinsky</surname></string-name> and <string-name><given-names>Annette</given-names> <surname>Zippelius</surname></string-name>. <chapter-title>Relaxational dynamics of the Edwards-Anderson model and the mean-field theory of spin-glasses</chapter-title>. <source>Physical Review B</source>, <volume>25</volume>(<issue>11</issue>):<fpage>6860</fpage>–<lpage>6875</lpage>, <month>June</month> <year>1982</year>. Publisher: <publisher-name>American Physical Society</publisher-name>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><string-name><given-names>Amy</given-names> <surname>Tong</surname></string-name>, <string-name><given-names>Yan</given-names> <surname>Hin</surname></string-name>, <etal>et al.</etal> <article-title>Global mapping of the yeast genetic interaction network</article-title>. <source>Science</source>, <volume>303</volume> (<issue>5659</issue>), <year>2004</year>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><string-name><given-names>Yinhua</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>Carolina Diaz</given-names> <surname>Arenas</surname></string-name>, <string-name><given-names>Daniel M</given-names> <surname>Stoebel</surname></string-name>, and <string-name><given-names>Tim F</given-names> <surname>Cooper</surname></string-name>. <article-title>Genetic background affects epistatic interactions between two beneficial mutations</article-title>. <source>Biology letters</source>, <volume>9</volume>(<issue>1</issue>):<fpage>20120328</fpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><string-name><given-names>D. B.</given-names> <surname>Weissman</surname></string-name>, <string-name><given-names>M. M.</given-names> <surname>Desai</surname></string-name>, <string-name><given-names>D. S.</given-names> <surname>Fisher</surname></string-name>, and <string-name><given-names>M. W.</given-names> <surname>Feldman</surname></string-name>. <article-title>The rate at which asexual populations cross fitness valleys</article-title>. <source>Theor Popul Biol</source>, <volume>75</volume>(<issue>4</issue>), <year>2009</year>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><string-name><given-names>Claus O</given-names> <surname>Wilke</surname></string-name>. <article-title>The speed of adaptation in large asexual populations</article-title>. <source>Genetics</source>, <volume>167</volume>(<issue>4</issue>):<fpage>2045</fpage>–<lpage>2053</lpage>, <month>August</month> <year>2004</year>.</mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><string-name><given-names>Michael J.</given-names> <surname>Wiser</surname></string-name>, <string-name><given-names>Noah</given-names> <surname>Ribeck</surname></string-name>, and <string-name><given-names>Richard E.</given-names> <surname>Lenski</surname></string-name>. <article-title>Long-term dynamics of adaptation in asexual populations</article-title>. <source>Science</source>, <volume>342</volume>(<issue>6164</issue>), <year>2013</year>.</mixed-citation></ref>
</ref-list>
<sec id="s5">
<label>A</label>
<title>Materials and methods</title>
<p>Here, we provide an overview of the simulation methodology, as well as some necessary definitions for the results to follow. Further information on the simulation approach is available in Appendix B.</p>
<sec id="s5a">
<title>Strains</title>
<p>We begin with a population of size <italic>N</italic><sub>0</sub> and with an initial ancestral genotype <bold><italic>α</italic></bold><sup>(0)</sup> drawn randomly as <italic>L</italic> i.i.d. random variables taking the values ±1 with equal probability. We define mutations with respect to this initial sequence and define a strain by the path taken on the hypercube from the initial genotype to its current genotype. Due to microscopic epistasis, the fitness effect of a mutation can only be defined in the context of its genetic background. Defining strains by their path ensures that mutations at the same site with different fitness effects are correctly tracked throughout the simulation. Each path is stored in a hash table, and the hashes are compared when new strains are generated to see if the new strain already exists.</p>
</sec>
<sec id="s5b">
<title>Growth</title>
<p>We assume that each strain grows exponentially with rate given by its fitness. The primary quantity we study is the population mean fitness <italic>F</italic>(<italic>t</italic>), which is defined as the average fitness over all cells in the population. To obtain <italic>F</italic>(<italic>t</italic>), we average its value over replicate trajectories initialized from different ancestral genotypes within the same fitness landscape.</p>
</sec>
<sec id="s5c">
<title>Mutations</title>
<p>As the strains grow, mutants are generated with a fixed mutation rate <italic>μ</italic> &gt; 0, which describes the probability of a cell gaining a mutation when it divides. The genotype of a mutant is obtained from the genotype of the parent by flipping a site uniformly at random. A mutation is said to have <italic>fixed</italic> if it is present in all strains. For a mutant with genotype <bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup> produced from a parent with genotype <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>, the fitness increment is Δ<italic>F</italic>(<bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup>, <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>) = <italic>F</italic> (<bold><italic>α</italic></bold> <sup>(<italic>c</italic>)</sup>) − <italic>F</italic> (<bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>), while the selection coefficient is <italic>s</italic>(<bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup>, <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>) = Δ<italic>F</italic>(<bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup>, <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>)/<italic>F</italic>(<bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>).</p>
</sec>
<sec id="s5d">
<title>Dilution protocol</title>
<p>We study a batch culture subject to a standard serial dilution protocol (<xref ref-type="bibr" rid="c45">Lenski et al., 1991</xref>; <xref ref-type="bibr" rid="c46">Lin et al., 2020a</xref>; <xref ref-type="bibr" rid="c12">Desai et al., 2007</xref>; <xref ref-type="bibr" rid="c38">Kryazhimskiy et al., 2012</xref>). The population is allowed to grow until the total number of bacteria in the simulation reaches <italic>N<sub>f</sub></italic> = <italic>D</italic> × <italic>N</italic><sub>0</sub> where <italic>D</italic> is the dilution factor. When the total population size reaches <italic>N<sub>f</sub></italic>, we say that a day has been completed. At the end of each day, the population is diluted back to size <italic>N</italic><sub>0</sub> by sampling from a multivariate hypergeometric distribution. Repeated sampling from this distribution is computationally intensive, and we developed an efficient approximate scheme to do so in the strong clonal interference regime (Appendix B).</p>
</sec>
<sec id="s5e">
<title>Simulation parameters</title>
<p>Motivated by Lenski’s long-term evolution experiment (<xref ref-type="bibr" rid="c45">Lenski et al., 1991</xref>; <xref ref-type="bibr" rid="c44">Lenski and Travisano, 1994</xref>), we set <italic>D</italic> = 100, <italic>N</italic><sub>0</sub> = 10<sup>6</sup>, and <italic>N<sub>f</sub></italic> = 10<sup>8</sup> in all simulations. We fix <italic>ρ</italic> = 0.05 and Δ = 0.005, respectively motivated by sparsity of biological networks and the overall magnitude of typical fitness increments in laboratory experiments, as stated earlier. We set <italic>L</italic> = 1000, which corresponds to considering mutations at the level of each gene in <italic>E. coli</italic>. Because typically only a fraction of possible mutations are beneficial, we fix the initial rank to 100. The mutation rate <italic>μ</italic> and epistatic parameter <italic>β</italic> are varied and will be specified along with the results.</p>
</sec>
</sec>
<sec id="s6">
<label>B</label>
<title>Further simulation details</title>
<p>Recall that the fitness of a strain with genotype <italic><bold>α</bold></italic> ∈ {±1}<sup><italic>L</italic></sup> is given by
<disp-formula id="eqn8">
<alternatives><graphic xlink:href="524306v1_eqn8.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<sec id="s6a">
<title>Strain growth</title>
<p>Because each strain grows with rate proportional to its fitness, we may write
<disp-formula id="eqn9">
<alternatives><graphic xlink:href="524306v1_eqn9.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>In (9), <italic>N<sub>i</sub></italic>(<italic>t</italic>) represents the size of strain <italic>i</italic> at time <italic>t</italic>, <bold><italic>α</italic></bold><sup>(<italic>i</italic>)</sup> is the genotype for strain <italic>i</italic>, and Δ<italic>t</italic> &gt; 0 is a timestep (set to Δ<italic>t</italic> = 0.01 in all simulations). To avoid biasing the growth for strains with low bacteria count, we allow <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline9.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> throughout the simulation.</p>
</sec>
<sec id="s6b">
<title>Mutations</title>
<p>After a step of size Δ<italic>t</italic>, following (9), the number of new bacteria produced by a given strain is equal to
<disp-formula>
<alternatives><graphic xlink:href="524306v1_ueqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>To ensure that the number of mutants generated by strain <italic>i</italic> does not exceed the number of bacteria Δ<italic>N<sub>i</sub></italic>(<italic>t</italic>) generated by strain <italic>i</italic>, we draw a Poisson random variable
<disp-formula>
<alternatives><graphic xlink:href="524306v1_ueqn5.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
and then set the number of mutants to be
<disp-formula>
<alternatives><graphic xlink:href="524306v1_ueqn6.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>Let <bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup> denote a child strain produced by parent strain with genotype <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>. To obtain <bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup>, we draw an index <italic>j</italic> ∈ {1,…, <italic>L</italic>} uniformly at random and flip the sign of <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline10.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. The path through genome space for the child strain is obtained by appending the index <italic>j</italic> to the path through genome space for the parent strain.</p>
<p>As new strains are generated through mutation events, we must check if they already exist in the population. If the strain already exists, the mutant joins the existing strain rather than defining a new one. Checking for the existence of a newly generated strain in the overall population can be performed efficiently by hashing the list of integers defining the path through genome space. All current paths can be stored in a set defining the active strains: the time complexity of checking set membership scales as <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline11.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> with the number of strains, which is a significant reduction compared to checking all new mutant strains against all existing strains.</p>
</sec>
<sec id="s6c">
<title>Dilution protocol</title>
<p>The number of bacteria in each strain that make it through dilution to the following day follows a multivariate hypergeometric distribution. To efficiently sample from this distribution, we sequentially draw from the hypergeometric marginal distributions (<xref ref-type="bibr" rid="c17">Gentle, 1998</xref>). We first sort the population by number of bacteria in descending order. We then sample <italic>k</italic><sub>1</sub> ~ <monospace>Hyper</monospace> (<italic>N<sub>f</sub></italic>, <italic>N</italic><sub>1</sub>, <italic>N</italic><sub>0</sub>) where <italic>N</italic><sub>1</sub> is the size of the largest strain. We then recursively apply this procedure, choosing <italic>k<sub>j</sub></italic> ~ <monospace>Hyper</monospace>(<italic>N<sub>f</sub></italic> − ∑<sub><italic>l</italic>&lt;<italic>j</italic></sub> <italic>k<sub>l</sub></italic>, <italic>N<sub>j</sub></italic>, <italic>N</italic><sub>0</sub> − ∑<sub><italic>l</italic>&lt;<italic>j</italic></sub> <italic>k<sub>l</sub></italic>) until we have drawn N<sub>o</sub> bacteria or we have gone through the entire population. For greater efficiency, each hypergeometric marginal distribution can be replaced with a draw from a binomial distribution. We verified that our results are independent to this approximation.</p>
</sec>
<sec id="s6d">
<title>Replicates</title>
<p>Each simulation is performed with a number of replicate populations. Each replicate is instantiated with the same quenched disorder as specified by the <italic>h<sub>i</sub></italic> and <italic>J<sub>ij</sub></italic>. The dynamics for each replicate differ through the random initialization of the ancestral genotype <bold><italic>α</italic></bold><sup>(0)</sup> and through the sequence of random mutations. In the experiments studying the role of clonal interference, the same <italic>h</italic> and <italic>J</italic> are used as <italic>μ</italic> is varied.</p>
</sec>
<sec id="s6e">
<title>Power-law fitting methodology</title>
<p>To obtain fitness exponents, the mean (computed over replicates) trajectory is fit via nonlinear least-squares using the <monospace>scipy</monospace> function <monospace>curve_fit</monospace>. The standard error of the mean is used to weight the residuals in the loss function. Error bars are computed via the bootstrap method, by randomly sampling subsets of trajectories and fitting models to the mean over each subset. The corresponding estimates define an empirical distribution over parameters, from which we compute quantiles and use the median as the estimate of the parameters.</p>
</sec>
<sec id="s6f">
<title>Random walk statistics</title>
<p>We perform the following procedure to obtain an estimate of <italic>μ<sub>β</sub></italic> and <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline12.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. We average over initial landscapes and <monospace>n_inits</monospace> initializations with rank <italic>R</italic> for each value of <italic>β</italic>. For each initialization, we select a single beneficial mutation at random and compute the changes to all other <italic>R</italic> − 1 beneficial fitness increments. We compute the empirical mean and variance of these changes and average the resulting estimates over all landscapes and initializations. In the numerical experiments reported here, we set <italic>R</italic> = 100, <monospace>n_inits</monospace> = 10, and <monospace>n_landscapes</monospace> = 10, though we found that our results were insensitive to the choice of number of landscapes and initializations.</p>
</sec>
<sec id="s6g">
<title>Coarse-grained simulation methodology</title>
<p>To simulate the discrete random walk model, we compute an initial empirical distribution of fitness increments according to (8) and save the sparsity pattern defined by the randomly drawn <italic>J<sub>ij</sub></italic>. At each fixation event, we flip Δ<italic>F<sub>i</sub></italic> ↦ −Δ<italic>F<sub>i</sub></italic> and adjust each Δ<italic>F<sub>j</sub></italic> ↦ Δ<italic>F<sub>j</sub></italic> + <italic>η<sub>j</sub></italic> for <italic>j</italic> ≠ <italic>i</italic> as discussed in the main text. If <italic>J<sub>ij</sub></italic> = 0 in the originally drawn genetic network, we set <italic>η<sub>j</sub></italic> = 0. For comparison, the full SSWM dynamics can be simulated using (8) directly.</p>
<p>Fixation probabilities are determined by Haldane’s formula <italic>p</italic><sub>fix</sub>(Δ<italic>F</italic>) ~ Δ<italic>F</italic>/<italic>F</italic>. To fit our discrete random walk model into the framework of Gillespie’s stochastic simulation algorithm, we define “chemical reactions” corresponding to each possible fixation event. The reaction propensity for a mutation at site <italic>i</italic> is taken to be equal to <italic>p</italic><sub>fix</sub>(Δ<italic>F<sub>i</sub></italic>). We choose a mutation site at random with probability proportional to its fixation probability. We randomly draw the time that occurred before the next fixation event according to an exponential distribution with mean <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline13.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> (up to an overall mutation rate fixing the units of time).</p>
</sec>
</sec>
<sec id="s7">
<label>C</label>
<title>Fast fitness computation</title>
<p>The following lemma gives a fast algorithm for computing the fitness of a given bacterial strain. The proof proceeds by noting that rather than computing (1) directly, we can compute the fitness of a strain <bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup> with respect to its parent strain <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>. It concludes by observing that the fitness of <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup> can be related to the fitness of an arbitrary reference strain <bold><italic>α</italic></bold><sup>(<italic>r</italic>)</sup>. This reference strain can be adjusted on-the-fly to track the state of the population.</p>
<sec id="s7a">
<title>Lemma C.1</title>
<p><italic>Let <bold>α</bold></italic><sup>(<italic>r</italic>)</sup> ∈ {±1}<sup><italic>L</italic></sup> <italic>denote the genotype of a reference strain, <bold>α</bold></italic><sup>(<italic>p</italic>)</sup> ∈ {±1}<sup><italic>L</italic></sup> <italic>denote the genotype of the parent strain, and <bold>α</bold></italic><sup>(<italic>c</italic>)</sup> ∈ {±1}<sup><italic>L</italic></sup> <italic>denote the genotype of the child strain obtained from <bold>α</bold></italic><sup>(<italic>p</italic>)</sup> <italic>via a mutation at gene k. Then</italic>,
<disp-formula id="eqn10">
<alternatives><graphic xlink:href="524306v1_eqn10.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<italic>where M<sub>r</sub> denotes the set of mutations of the parent with respect to the reference strain</italic>.</p>
<p><xref ref-type="disp-formula" rid="eqn10">Equation (10)</xref> states that if we store the elements of the vector <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline14.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, we can compute the fitness of a child strain in terms of the fitness of the parent strain in time complexity <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline15.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. This is a massive improvement over the <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline16.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> complexity corresponding to a naive calculation of the quadratic form, and a large improvement over the <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline17.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> complexity corresponding to computing the fitness of the child with respect to the fitness of the parent, particularly if the reference strain is updated to keep |<italic>M<sub>r</sub></italic>| small. We found empirically that setting the reference strain to be equal to the dominant strain every time the dominant strain accumulates 15 new fixed mutations was a good heuristic.</p>
<sec id="s7a1">
<title>Proof</title>
<p>Observe that we may write
<disp-formula>
<alternatives><graphic xlink:href="524306v1_ueqn7.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>Now, write that <inline-formula><alternatives><inline-graphic xlink:href="524306v1_inline18.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> with
<disp-formula id="eqn11">
<alternatives><graphic xlink:href="524306v1_eqn11.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>Plugging this in completes the proof.</p>
</sec>
</sec>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87895.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ogbunugafor</surname>
<given-names>C Brandon</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Yale University</institution>
</institution-wrap>
<city>New Haven</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study offers a model that is used to interrogate how microscopic epistasis and factors like clonal interference affect evolutionary dynamics. The study offers several <bold>important</bold> insights that can aid in our understanding of the forces that operate in adaptation. The evidence provided is <bold>solid</bold>, in the form of models and analytical descriptions that describe how these forces manifest themselves.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87895.1.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This paper presents extensive numerical simulations using a model that incorporates up to second-order epistasis to study the joint effects of microscopic epistasis and clonal interference on the evolutionary dynamics of a microbial population. Previous works that explicitly modeled microscopic epistasis typically assumed strong selection &amp; weak mutation (SSWM), a condition that is generally not met in real-life evolutionary processes. Alternatively, another class of models coarse-grained the effects of microscopic epistasis into a generic distribution of fitness effects. The framework introduced in this paper represents an important advance with respect to these previous approaches, allowing for the explicit modeling of microscopic epistasis in non-SSWM scenarios. The modeling framework presented promises to be a valuable tool to study microbial evolution in silico.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87895.1.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This paper presents an extensive numerical study of microbial evolution using a model of fitness inspired by spin glass physics. It places special emphasis on elucidating the combined effects of microscopic epistasis, which dictates how the fitness effect of a mutation depends on the genetic background on which it occurs, and clonal interference, which describes the proliferation of and competition between multiple strains. Both microscopic epistasis and clonal interference have been observed in microbial evolution experiments, and are chief contributors to the complexity of evolutionary dynamics. Correlations between random mutations and nonlinearities associated with interactions between sub-populations consisting of competing strains make it extremely challenging to make quantitative theoretical predictions for evolutionary dynamics and associated observables such as the mean fitness. While the body of theoretical and computational research on modeling evolutionary dynamics is extensive, most theoretical efforts rely on making simplifications such as the strong selection weak mutation (SSWM) limit, which neglects clonal interference, or assumptions about the distribution of fitness effects that are not experimentally verifiable.</p>
<p>The authors have addressed this challenge by running a numerical microbial evolution experiment over realistic population sizes (~ 100 million cells) and timescales (~ 10,000 generations) using a spin glass model of fitness that considers pairwise interactions between mutations on distinct genetic loci. By independently tuning mutation rate as well as the strength of epistasis, the authors have shown that epistasis generically slows down the growth of fitness trajectories regardless of the amount of clonal interference. On the other hand, in the absence of epistasis, clonal interference speeds up the growth of fitness trajectories, but leaves the growth unchanged in the presence of epistasis. The authors quantitatively characterize these observations using asymptotic power law fits to the mean fitness trajectories. Further, the authors employ more simplified macroscopic models that are informed by their empirical findings, to reveal the mechanistic origins of the epistasis mediated slowing down of fitness growth. Specifically, they show that epistasis leads to a broadening of the distribution of fitness increments, leading to the fixation of a large number of mutations that confer small benefits. Effectively, this leads to an increase in the number of fixed mutations required to climb the fitness peak. This increased number of required beneficial mutations together with the decreasing availability of beneficial mutations at high fitness lead to the slowdown of fitness growth. The authors' data analysis is quite solid and their conclusions are well supported by quantitative macroscopic models. The paper can be strengthened further by conducting a deeper analysis of correlations between mutations, using tools for analyzing dynamical correlations developed in the spin glass literature.</p>
<p>One of the highlights of this paper is the author's astute choice of model, which strikes an impressive balance between complexity, flexibility, and numerical accessibility. In particular, the authors were able to achieve results over realistic population sizes and timescales largely because of the amenability of the model to the implementation of an efficient simulation algorithm. At the same time, the strength of epistasis and clonal interference can be tuned in a facile manner, enabling the authors to map out a phase diagram spanning these two axes. One could argue that the numerical scheme employed here would only work for a specific class of models, and is therefore not generalizable to all models of evolutionary dynamics. While this is likely true, the model is capable of recapitulating several complex aspects of microbial evolution, and is therefore not unduly restrictive.</p>
<p>Spin glass physics has already provided significant insights into a wide range of topics in the life sciences including protein folding, neuroscience, ecology and evolution. The present work carries this approach forward, with immediate implications for microbial evolution, and potential implications in related areas of research such as microbial ecology. In addition to the theoretical value of spin glass physics, the high performance algorithm developed in this work lays the foundation for formulating data driven approaches aimed at understanding evolutionary dynamics. In the future, there is considerable scope for utilizing data generated by such models to train machine learning algorithms for quantifying parameters associated with epistasis, clonal interference, and the distribution of fitness effects in laboratory experiments.</p>
</body>
</sub-article>
</article>