<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">99347</article-id>
<article-id pub-id-type="doi">10.7554/eLife.99347</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.99347.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Structural Biology and Molecular Biophysics</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Physics of Living Systems</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Detecting directed motion and confinement in single-particle trajectories using hidden variables</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0737-2312</contrib-id>
<name>
<surname>Simon</surname>
<given-names>François</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>simon.francois@protonmail.com</email>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5175-1643</contrib-id>
<name>
<surname>Ramadier</surname>
<given-names>Guillaume</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0005-2872-7011</contrib-id>
<name>
<surname>Fonquernie</surname>
<given-names>Inès</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zsok</surname>
<given-names>Janka</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7175-481X</contrib-id>
<name>
<surname>Patskovsky</surname>
<given-names>Sergiy</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2398-5602</contrib-id>
<name>
<surname>Meunier</surname>
<given-names>Michel</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2145-9086</contrib-id>
<name>
<surname>Boudoux</surname>
<given-names>Caroline</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1114-5523</contrib-id>
<name>
<surname>Dultz</surname>
<given-names>Elisa</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0971-7329</contrib-id>
<name>
<surname>Weiss</surname>
<given-names>Lucien E</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>lucien.weiss@polymtl.ca</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05f8d4e86</institution-id><institution>Department of Engineering Physics, Polytechnique Montréal</institution></institution-wrap>, <city>Montreal</city>, <country country="CA">Canada</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05hy3tk52</institution-id><institution>École Polytechnique</institution></institution-wrap>, <city>Palaiseau</city>, <country country="FR">France</country></aff>
<aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01rd8n845</institution-id><institution>Institute of Biochemistry, ETH Zürich</institution></institution-wrap>, <city>Zurich</city>, <country country="CH">Switzerland</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Cui</surname>
<given-names>Qiang</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Boston University</institution>
</institution-wrap>
<city>Boston</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Cui</surname>
<given-names>Qiang</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Boston University</institution>
</institution-wrap>
<city>Boston</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-07-30">
<day>30</day>
<month>07</month>
<year>2024</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-09-04">
<day>04</day>
<month>09</month>
<year>2025</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP99347</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-05-11">
<day>11</day>
<month>05</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-04-21">
<day>21</day>
<month>04</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.04.18.589798"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-07-30">
<day>30</day>
<month>07</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.99347.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.99347.1.sa3">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99347.1.sa2">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99347.1.sa1">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99347.1.sa0">Reviewer #3 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Simon et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Simon et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-99347-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>Single-particle tracking is a powerful tool for understanding protein dynamics and characterizing microenvironments. As the motion of unconstrained nanoscale particles is governed by Brownian diffusion, deviations from this behavior are biophysically insightful. However, the stochastic nature of particle movement and the presence of localization error pose a challenge for the robust classification of non-Brownian motion. Here, we present <italic>aTrack</italic>, a versatile tool for classifying track behaviors and extracting key parameters for particles undergoing Brownian, confined, or directed motion. Our tool quickly and accurately estimates motion parameters from individual tracks. Further, our tool can analyze populations of tracks and determine the most likely number of motion states. We show the working range of our approach on simulated tracks and demonstrate its application for characterizing particle motion in cells and for biosensing applications. aTrack is implemented as a stand-alone software, making it simple to analyze track data.</p>
</abstract>
<funding-group>
<award-group id="funding-1">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/01h531d29</institution-id>
<institution>Natural Sciences and Engineering Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>RGPIN-06404-2016</award-id>
</award-group>
<award-group id="funding-1a">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/01h531d29</institution-id>
<institution>Natural Sciences and Engineering Research Council</institution>
</institution-wrap>
</funding-source>
<award-id>RGPIN-2022-05142</award-id>
</award-group>
<award-group id="funding-2">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/00yjd3n13</institution-id>
<institution>Swiss National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>320030-236124</award-id>
</award-group>
</funding-group>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>This version has been revised to update the introduction as well as a revised experimental demonstration section, and more information on the details of the method.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Main</title>
<p>Single-particle tracking (SPT) is a valuable tool for characterizing protein activity (<xref ref-type="bibr" rid="c1">1</xref>–<xref ref-type="bibr" rid="c3">3</xref>). While Brownian diffusion is commonly observed inside of cells, deviations from this behavior are of major interest and can provide key biophysical insight (<xref ref-type="bibr" rid="c4">4</xref>–<xref ref-type="bibr" rid="c6">6</xref>). Classically, non-Brownian behaviors have been identified by fitting a power law to the mean-squared displacements (MSD) as a function of the time lag <italic>τ</italic>, (MSD = Γ·<italic>τ</italic><sup><italic>α</italic></sup>) (<xref ref-type="bibr" rid="c6">6</xref>), where subdiffusive motion has an <italic>α</italic> exponent &lt; 1 and superdiffusion has an exponent &gt; 1. While fitting the MSD curve can therefore be used for categorizing motion, the anomalous exponent and the generalized diffusion coefficient provide little insight into the combination of underlying biological forces, e.g., diffusion, directed motion, and confinement.</p>
<p>To accurately model the motion encountered in cellular contexts, physics-based models have been developed to explicitly describe interactions that give rise to nonlinear MSDs. For example, superdiffusion can arise from the linear movement powered by molecular motors (<xref ref-type="bibr" rid="c7">7</xref>), and subdiffusive motion can arise from confinement (<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>). In such models, the observed track positions result from a stochastic process described by hidden (unobserved) variables that evolve with time.</p>
<p>In the context of random processes, Maximum Likelihood Estimation (MLE) is used to determine the underlying parameters of the model. MLE consists in computing the probability of observing a track given the model and its parameters. The main challenge in models with hidden variables is that they require computing the integral of a joint probability density over all possible hidden variables. This integration step is currently realized with coarse-grained approximations or sampling methods that are either slow or inaccurate. Thus, designing a hidden-variable method that benefits from accurate and efficient integration is an important challenge for improving the reliably and ease-of-use of the physics-based models. Further, when the underlying physical model is undecided, statistical tests can be applied to identify the most appropriate model (<xref ref-type="bibr" rid="c10">10</xref>–<xref ref-type="bibr" rid="c12">12</xref>).</p>
<p>Current hidden-variable models applied to non-Brownian diffusion have three disadvantages: 1) They perform the integration step using either coarse-grained approximations (<xref ref-type="bibr" rid="c7">7</xref>) or sampling method making them either inaccurate or slow; 2) they are specialized in either confinement or directed motion but do not treat both types of motion; 3) they typically do not allow variations of the potential well position or the speed of the directed motion, properties that are frequently encountered in biological systems.</p>
<p>Here, we present aTrack, an analysis tool that alleviates the limitations mentioned above. Our approach uses a versatile motion model that considers the relationships between the observed track, the real particle positions (localization error and Brownian motion), as well as the influence of a non-Brownian variable that can either be the potential well for confined diffusion or the velocity vector for directed motion. The main innovations of this model are: 1) it uses analytical recurrence formulas to perform the integration step for complex motion, improving speed and accuracy; 2) it handles both confined and directed motion; 3) anomalous parameters, such as the center of the potential well and the velocity vector are allowed to change through time to better represent tracks with changing directed motion or confinement area; and lastly 4) for a given track or set of tracks, aTrack can determine whether tracks can be statistically categorized as confined or directed, and the parameters that best describe their behavior, for example, diffusion coefficient, radius of confinement, and speed of directed motion.</p>
<p>We validate the approach on simulated data and demonstrate its versatility for analyzing a variety of experimental SPT data, including particle diffusion in an optical trap, detection of motile bacteria with gold nanoparticles, and motion characterization of spindle pole bodies in budding yeast.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Accounting for hidden variables that characterize confined and persistent motion</title>
<sec id="s2a1">
<title>Modeling non-Brownian motion</title>
<p>We model noisy tracks undergoing confined, Brownian, and directed motion by considering four relations at each time step: (<xref ref-type="bibr" rid="c1">1</xref>) there is a Brownian diffusion step followed by (<xref ref-type="bibr" rid="c2">2</xref>) an anomalous step (<xref rid="fig1" ref-type="fig">Fig. 1a-b</xref>); (<xref ref-type="bibr" rid="c3">3</xref>) the hidden anomalous variable, <italic>h</italic>, can evolve according to a Gaussian distribution; and (<xref ref-type="bibr" rid="c4">4</xref>) localization error is incorporated as a Gaussian-distributed noise term added to the underlying real position to produce the observed positions. This model encompasses a variety of motion types depending on the model parameters, as illustrated in <xref rid="fig1" ref-type="fig">Fig. 1c</xref>. For example, particles can be immobile, where the observed displacements are only due to localization error; tracks can undergo Brownian motion, as well as anomalous super- and subdiffusion; or multiple motion mechanisms can also occur simultaneously, (e.g. diffusion and drift, or changes in directed motion direction and speed). The model can also account for confinement in an area of variable radius (<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c13">13</xref>) as well as a diffusing potential well. In our model, the velocity is the characteristic parameter of directed motion and the confinement factor represents the force within a potential well. More precisely, the confinement factor <italic>l</italic> is defined such that at each time step the particle position is updated by <italic>l</italic> times the distance particle/potential well center (see the Methods section for more details).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Principle of <italic>aTrack</italic>.</title>
<p><bold>a</bold>: The track-generation steps with our motion model shown here for directed motion. Each time step is decomposed into sub-steps, namely diffusion and anomalous motion (either directed or confining) with <italic>r</italic><sub><italic>i</italic></sub> the real positions, <italic>z</italic><sub><italic>i</italic></sub> an intermediate position, <italic>h</italic><sub><italic>i</italic></sub> the anomalous variable, and the generation of observed (measured) positions, <italic>c</italic><sub><italic>i</italic></sub>. The variables <italic>c</italic><sub><italic>i</italic></sub> −<italic>r</italic><sub><italic>i</italic></sub> and <italic>r</italic><sub><italic>i</italic>+1</sub> −<italic>r</italic><sub><italic>i</italic></sub> follow Gaussian distributions with mean 0 and standard deviations σ and <italic>d</italic>, respectively. The sub-step from <italic>z</italic><sub><italic>i</italic></sub> to <italic>r</italic><sub><italic>i</italic>+1</sub> is deterministic and the anomalous variable <italic>h</italic><sub><italic>i</italic></sub> can also evolve with a standard deviation <italic>q</italic>. <bold>b</bold>: Graph representation of aTrack showing the motion model (<italic>left</italic>), analytical integration (<italic>middle</italic>), and outputs (<italic>right</italic>). To compute the track probability, we integrate over the hidden variables. This results in an analytical recurrence formula that is used to determine the type of motion and to estimate the parameters of the motion. <bold>c</bold>: Examples of tracks that can be produced with our motion model.</p></caption>
<graphic xlink:href="589798v2_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2a2">
<title>Determining the type of motion</title>
<p>To categorize the type of motion from a measured trajectory, we first calculate the likelihood that a track belongs to each considered motion class (diffusion, directed, or confinement) and then perform a statistical comparison between the likelihoods. To do the former, we must integrate the joint probability density function of a track for all the modeled hidden variables, e.g. all the real positions and the potential well positions or the velocity vectors. Since our model is a multivariate Gaussian process expressed as the product of univariate Gaussian functions, we can perform the integration step using analytical recurrence formulas (see Supplementary information) (<xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c15">15</xref>). The recurrence formula enables our model computation time to scale linearly with the number of time points.</p>
<p>We can apply these formulas to determine the best sets of parameters and the maximum likelihoods, then use the ratio between the maximum likelihood assuming Brownian diffusion (null hypothesis) and the maximum likelihood assuming confinement or directed motion as the alternative hypothesis to build a likelihood ratio test (<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c17">17</xref>). <xref ref-type="fig" rid="figS2">Fig. S2</xref> shows that these likelihood ratios, <italic>ρ</italic> = <italic>l</italic><sub>Brownian</sub>/<italic>l</italic><sub>confined</sub> or <italic>ρ</italic> = <italic>l</italic><sub>Brownian</sub>/<italic>l</italic><sub>directed</sub> are systematically skewed towards 1 when particles follow Brownian diffusion. Conversely, <italic>ρ</italic> is skewed toward zero when applying the directed-diffusion test to directed tracks or the confined-diffusion test to confined tracks. These properties enable the likelihood ratio to serve as a robust proxy for the p-value as it overestimates it. As a consequence, if <italic>ρ</italic> &lt; <italic>X</italic> with X the type I error rate (e.g. 0.05), we can reject the null hypothesis with a confidence of 1 − <italic>X</italic>. Relying on the skewness of the likelihood ratio to obtain an upper bound of the p-value is a simple way to categorize the type of motion, but sometimes a more sensitive test is needed. In such cases, one can use simulations to better estimate the p-value (See Supplemental Information: Statistical test for more details).</p>
<p>To estimate the impact of the track length on the classification, we simulated tracks either in confined diffusion or in linear motion (without diffusion) of varying lengths (5-400 steps for confined, 4-100 steps for directed) and computed the likelihood ratios. As expected, the classification certainty increases with the track length; where the inverse of log <italic>ρ</italic> increases with the number of steps (<xref rid="fig2" ref-type="fig">Fig 2a</xref>). Of course, the statistical certainty depends on the track parameters (<xref rid="fig2" ref-type="fig">Fig 2b</xref>). In the range of evaluated anomalous parameters, the significance of the test increased with the confinement factor and the directed motion velocity. To determine the useful range more systematically, we varied the track length and either the confinement factor for confined motion or the velocity for directed motion, and computed the average likelihood ratios (<xref rid="fig2" ref-type="fig">Fig 2c</xref>). A low average ratio indicates significantly low p-values for most tracks as this ratio is an overestimate of the p-value. We see that the test is significant as long as the anomalous parameter is high enough or the track length is high enough. Note that increasing the confinement factor so much that the confinement radius becomes similar or smaller than the localization error will impair the capacity of the test.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Determining the motion type using a likelihood-ratio test.</title>
<p><bold>a-b</bold>: Probability distributions of the difference between the log of the maximum likelihood of the alternative hypothesis (either confinement <italic>L</italic><sub><italic>c</italic></sub> or directed <italic>L</italic><sub><italic>d</italic></sub>) and the null hypothesis (Brownian diffusion <italic>L</italic><sub><italic>b</italic></sub>) for single tracks (10,000 tracks). Confinement factor <italic>l</italic> = 0.25 and velocity <italic>v</italic> = 0.02 µm·Δt<sup>−1</sup>. <bold>a</bold>: Effect of the number of time points in a track on its log difference (<italic>L</italic><sub><italic>c</italic></sub> − <italic>L</italic><sub><italic>b</italic></sub> for confined tracks) and (<italic>L</italic><sub><italic>d</italic></sub> − <italic>L</italic><sub><italic>b</italic></sub> for directed tracks). <bold>b</bold>: The ability to distinguish confinement and directed motion from diffusion as a function of the confinement factor and particle velocity, respectively. <bold>c</bold>: heatmaps of the likelihood ratios <italic>l</italic><sub><italic>b</italic></sub>/<italic>l</italic><sub><italic>c</italic></sub> (confined) or <italic>l</italic><sub><italic>b</italic></sub>/<italic>l</italic><sub><italic>d</italic></sub> (diffusive) varying both the anomalous diffusion parameter and the track length. Mean of 10,000 tracks. <bold>a-c</bold>: When not stated otherwise, the track parameters were as following. Localization error σ = 0.02 µm. Confined tracks: diffusion length <italic>d</italic> = 0.1 µm. Directed tracks: <italic>d</italic> = 0.0 µm (no diffusion), constant speed and orientation.</p></caption>
<graphic xlink:href="589798v2_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2a3">
<title>Characterizing confinement</title>
<p>To characterize confined trajectories, aTrack estimates several parameters, namely the diffusion coefficient <italic>D</italic> and the diffusion length <inline-formula><inline-graphic xlink:href="589798v2_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> where Δ<italic>t</italic> is the single-frame time step; the confinement factor <italic>l</italic>, which is proportional to the spring constant of the potential well; the diffusion coefficient of the confinement area <italic>D</italic><sub><italic>c</italic></sub>; and the localization error σ; and The confinement radius, which is proportional to <inline-formula><inline-graphic xlink:href="589798v2_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, can also be calculated (See the methods section for more details).</p>
<p>To measure the precision of parameter estimation, we simulated tracks with different confinement factors, <italic>l</italic>, (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>). We then used aTrack to estimate the parameters for each track of 200 time steps (<xref rid="fig3" ref-type="fig">Fig. 3b</xref>). The average diffusion coefficient, confinement factor, and confinement radius were accurate over the range of confinement factors, 0 to 1 per time step. Panel <xref rid="fig3" ref-type="fig">Fig. 3c</xref> shows the working range for calculating the confinement factor as a function of track length and confinement factor. Longer tracks result in better parameter estimation. Similarly, our method correctly estimates the confinement radius (<xref ref-type="fig" rid="figS3">Fig. S3d</xref>). In a second set of simulations, we tested the reliability of our predictions when the confinement area is moving (<xref rid="fig3" ref-type="fig">Fig. 3d</xref>, <xref ref-type="fig" rid="figS3">Fig. S3e</xref>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Characterizing confinement with <italic>aTrack</italic>.</title>
<p><bold>a-d</bold>: Confinement of tracks with a fixed potential well. <bold>a</bold>: Examples of simulated tracks with different confinement factors. <bold>b</bold>: Histograms of the estimated parameters for individual tracks of 200 time points varying the number of time points in tracks. <bold>c-d</bold>: Heatmaps of the mean estimated confinement factor and confinement radius depending on the track length and the confinement factor (per time step) or radius respectively. <bold>e</bold>: Confinement of tracks with a moving potential well (Brownian motion). Left: simulated tracks with different diffusion length of the potential well. Right: histograms of the estimated diffusion length of the the potential well and confinement <inline-formula><inline-graphic xlink:href="589798v2_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula> varying the actual diffusion length of the potential well. Confinement factor = 0.1 per time step. <bold>a-d</bold>: 10,000 tracks per condition. <italic>d</italic> = 0.1 µm, Localization error σ = 0.02 µm. See <xref ref-type="fig" rid="figS3">Fig. S3</xref> for complementary results.</p></caption>
<graphic xlink:href="589798v2_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2a4">
<title>Characterizing directed motion</title>
<p>Superdiffusive behavior, in particular directed motion, occurs in a variety of circumstances, such as molecular motormediated active transport (<xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c18">18</xref>) and polymerase processivity (<xref ref-type="bibr" rid="c19">19</xref>). Localization error complicates velocity estimation, especially when the localization error is relatively large. We simulated noisy tracks undergoing linear motion at various speeds (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>) with a localization error of 20 nm·Δ<italic>t</italic><sup>−1</sup> and estimated the velocity per tracks. <xref rid="fig4" ref-type="fig">Fig. 4b</xref> shows the velocity estimates for tracks with 30 time points. By varying both the track length and the velocity, we found our method to be reliable for a wide range of velocities as long as tracks were long enough (<xref rid="fig4" ref-type="fig">Fig. 4c</xref>).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Characterizing directed motion with <italic>aTrack</italic>.</title>
<p><bold>a-c</bold>: Tracks with linear motion (constant speed and orientation). <bold>a</bold>: Examples of simulated tracks in directed motion. <bold>b</bold>: Histograms of the estimated velocity of individual tracks of 30 time points. 10,000 tracks per histogram. True parameters <italic>d</italic> = 0. µm, Localization error σ = 0.02 µm (fixed). The next panels use the same parameters unless specified otherwise. <bold>c</bold>: Heatmap of the relative biases on the estimated velocity <inline-formula><inline-graphic xlink:href="589798v2_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. <bold>d-f</bold>: Tracks with constant speed but changing orientation. <bold>d</bold>: Simulated directed tracks with rotational diffusion. Here, the rotational diffusion angle coefficient is defined as the standard deviation of the change of orientation at each time step (analogous to the diffusion length). <italic>v</italic> = 0.02 µm·Δt<sup>−1</sup>. <bold>e</bold>: Heatmap of the error on the rotational diffusion angle for a range of velocities and rotational diffusion angles. Tracks of 200 time points. <bold>f</bold>: Distributions of the estimated rotational diffusion angle for a range of rotational diffusion angles. Tracks of 200 time points with <italic>v</italic> = 0.1 µm·Δt<sup>−1</sup>. <bold>g</bold>: Tracks simultaneously undergoing both linear motion and diffusion with varying levels of diffusion. Heatmaps of the likelihood ratio, bias on the diffusion length in µm, and estimated velocity depending on the number of time points per track and on the diffusion length <italic>d</italic>. <bold>a-g</bold>: Where not stated otherwise, the track parameters were as following. Localization error σ = 0.02 µm, <italic>d</italic> = 0.0 µm, velocity <italic>v</italic> = 0.1 µm·Δt<sup>−1</sup>, constant speed and orientation.</p></caption>
<graphic xlink:href="589798v2_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>In real experiments, persistent motion is rarely perfectly linear, that is, changes in direction and speed are very common (<xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c18">18</xref>–<xref ref-type="bibr" rid="c20">20</xref>). Naturally, characterizing directed motion with direction (orientation) changes is more difficult when localization error is non-negligible (<xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c22">22</xref>). To verify our method’s capacity to accurately quantify tracks with such behaviors, we simulated tracks with constant speed and random changes of orientation (rotational diffusion). We previously observed similar behavior when analyzing the directed motion of the Rod complex in bacteria (<xref ref-type="bibr" rid="c23">23</xref>), motor-driven directed motion in mammalian cells (<xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c24">24</xref>), and cell motility (<xref ref-type="bibr" rid="c25">25</xref>). We varied the rate of orientation changes and the track velocity to determine the working range of aTrack for this type of directed motion (<xref rid="fig4" ref-type="fig">Fig. 4d,e,f</xref>). In <xref rid="fig4" ref-type="fig">Fig. 4e,f</xref>, we find accurate estimates of the velocity and the rotational diffusion for a wide range of parameters. As the velocity increases, we can distinguish directed motion from Brownian motion for an increasing range of rotational diffusion (<xref rid="fig4" ref-type="fig">Fig. 4e</xref>). However, we also see that fast changes in orientation (high rotational diffusion) make estimating the velocity and rotational diffusion more difficult. This tradeoff is expected, as rapid changes in direction make the track appear more diffusive as shown in the likelihood ratio heatmap <xref ref-type="fig" rid="figS5">Fig. S5a</xref>. The diffusion length heatmap (<xref ref-type="fig" rid="figS5">Fig. S5a</xref>) explains why the rotational diffusion coefficient is poorly estimated when high: the model interprets the high rotational diffusion as simple diffusion since the two types of motion are very difficult to distinguish in this regime.</p>
<p>Sometimes, particles undergo diffusion and directed motion simultaneously, for example, particles diffusing in a flowing medium (<xref ref-type="bibr" rid="c26">26</xref>). Sample drift can also introduce a combination of diffusion and directed motion in single-molecule tracking. Indeed, the thermal expansion of instrument components like microscope stages can induce steady motion that masks the biologically relevant diffusive motion (<xref ref-type="bibr" rid="c27">27</xref>). We first tested that our method could correctly differentiate directed motion from diffusion (<xref rid="fig4" ref-type="fig">Fig. 4g</xref>) for a range of diffusion coefficients and track lengths at a fixed velocity of 0.1 µm.Δ<italic>t</italic><sup>−1</sup>. For mixed motion, our method accurately estimates the diffusion length and velocities even for short tracks, provided the diffusion length was low compared to the velocity. When the diffusion length is large compared to the velocity, parameters can still be predicted, but longer tracks are needed for reliable estimates.</p>
</sec>
<sec id="s2a5">
<title>Characterizing populations of tracks</title>
<p>The amount of information in an individual track is limited by its length making it difficult to extract the parameters precisely. One way to overcome this limitation is to consider a population of tracks that have the same state. The likelihood of the population can be easily computed by multiplying the probabilities of the individual tracks. To test our population approach, we simulated two populations: confined tracks and directed tracks. <xref ref-type="fig" rid="figS6">Fig. S6</xref> shows that the expected linear increase in the log likelihood with the number of tracks and that using more tracks results in more precise parameter estimates.</p>
<p>Populations of tracks can often contain multiple states (e.g., free diffusion and directed motion). By taking into account the fraction of the particle in each state, we built a multi-state population model. We tested the capacity of our multistate-population model on groups of simulated tracks with 300 time points, where each track follows one of the 5 states shown in <xref rid="fig5" ref-type="fig">Fig. 5a</xref>.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Characterizing populations of multiple states.</title>
<p>Analysis of tracks with 5 sub-populations of set diffusion length <italic>d</italic>, confinement factor <italic>l</italic>, velocity <italic>v</italic> for directed tracks, and anomalous change parameter <italic>q</italic> (diffusion length of the potential well for confined tracks and changes of speed for directed tracks). Tracks are 300 time point long. <bold>a</bold>: Track examples from each of the 5 states with the corresponding state parameters. <bold>b</bold>: Log likelihood of the model depending on the number of states assumed by the model. The log likelihood was normalized by the number of tracks, offset by the log likelihood assuming 10 states. <bold>c</bold>: Estimated parameters for the 5 states (using a 5-state model).</p></caption>
<graphic xlink:href="589798v2_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>The first step is to determine the number of states. To this end, we compute the likelihood of the model depending on the number of states. As expected, the likelihood increases with the number of states, until the correct number of states is reached and the function plateaus, in this case 5 states (<xref rid="fig5" ref-type="fig">Fig. 5b</xref>). This plateau in likelihood is a good indicator that the appropriate number of states is reached; however, increasing the number of states further usually results in higher likelihood, albeit marginally.</p>
<p>Quantitative criteria such as the Akaike Information Criterion (AIC) (<xref ref-type="bibr" rid="c28">28</xref>) and the Bayesian Information Criterion are often used to determine the number of parameters of a model by placing a trade-off between increasing the likelihood and increasing the number of parameters. When increasing the number of tracks, from 50 to 12,800, we found these criteria to be unreliable (<xref ref-type="fig" rid="figS7">Fig. S7</xref>). In theory, these criteria only work if the true underlying model is included in the alternative models, which is never the case for real tracks. As an alternative, we found that adding a small penalization term proportional to the number of parameters and the log likelihood provides a reliable criterion for identifying the number of states for any dataset size, even with mismatches between the data and the model assumptions.</p>
<p>Once we have identified the number of states, the parameters of each state are estimated at the population level (<xref rid="fig5" ref-type="fig">Fig. 5b</xref>), even when individual tracks remain difficult to classify. For instance, classifying whether a track is in the diffusive state (orange) or diffusive plus directed state (green) is difficult.</p>
</sec>
<sec id="s2a6">
<title>Robustness to model mismatches</title>
<p>One of the most important features of a method is its robustness to deviations from its assumptions. Indeed, experimental tracking data will inevitably not match the model assumptions to some degree, and models need to be resilient to these small deviations. To test the generalizability of our approach to other types of motion, we simulated tracks using a different motion model, namely fractional Brownian motion (<xref ref-type="bibr" rid="c29">29</xref>). This was performed with three anomalous diffusion exponents, 0.5, 1.0, and 1.5, corresponding to sub-diffusion, Brownian diffusion, and super-diffusion, respectively <xref rid="fig6" ref-type="fig">Fig. 6a</xref>. The performance of aTrack was then measured by computing the difference between the likelihood of the directed-motion model and the confined-motion model. This metric is closely related to the likelihood ratio mentioned earlier, and has the advantage of showing all three motion behaviors. We expect the likelihood difference to be &lt;0 for sub-diffusive motion, near 0 for Brownian diffusion, and &gt;0 for super-diffusion. We verified this by plotting a histogram of the log-likelihood differences for each type of motion and estimated the classification accuracy in detecting anomalous diffusion from Brownian diffusion. aTrack was 88% accurate when differentiating subdiffusive fractional Brownian motion (anomalous diffusion exponent of <italic>α</italic> = 0.5) from Brownian motion (<italic>α</italic> = 1), and 95% accurate for differentiating superdiffusive fractional Brownian motion (<italic>α</italic> = 1.5) from Brownian motion.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><title>Model robustness with other motion types.</title>
<p><bold>a-b</bold>: Example tracks and corresponding distributions used to determine the type of motion for aTrack and Randi (<xref ref-type="bibr" rid="c30">30</xref>). aTrack uses the difference between the likelihood assuming super-diffusion and the likelihood assuming sub-diffusion (bottom-left). To classify tracks using Randi, we used the estimated anomalous exponent. The accuracy is the fraction of correctly labeled tracks in a data set composed of 5,000 sub-diffusive or superdiffusive tracks and 5,000 Brownian tracks. Classifications were done using the thresholds that best divide the distributions. <bold>a</bold>: Analysis of tracks with 200 time steps following fractional Brownian motion with anomalous exponent of 0.5 (subdiffusive), 1 (diffusive), and 1.5 (superdiffusive). <bold>b</bold>: Analysis of tracks with 200 time steps following our motion model. Confined tracks: diffusion length <italic>d</italic> = 0.1 µm, localization error σ = 0.02 µm, confinement force <italic>l</italic> = 0.2, fixed potential well. Brownian tracks: <italic>d</italic> = 0.1 µm, σ = 0.02 µm. tracks in both directed and diffusive motion: <italic>d</italic> = 0.1 µm, σ = 0.02 µm, directional velocity <italic>v</italic> = 0.1 µm·Δt<sup>−1</sup>. Directed tracks: <italic>d</italic> = 0. µm, σ = 0.02 µm, <italic>v</italic> = 0.1 µm·Δt<sup>−1</sup>, angular diffusion coefficient 0.1 Rad<sup>2</sup>·s<sup>−1</sup>. <bold>c</bold>: Analyzing tacks confined by hard boundaries using aTrack. A simulated track with 200 time points diffusing on disks of different sizes. Top panel: Log likelihood difference <italic>L</italic><sub><italic>c</italic></sub> − <italic>L</italic><sub><italic>B</italic></sub> and fraction of significantly confined tracks (likelihood ratio <italic>l</italic><sub><italic>B</italic></sub>/<italic>l</italic><sub><italic>c</italic></sub> &lt; 0.05) depending on the confinement radius. Middle panel: Estimated confinement<inline-formula><inline-graphic xlink:href="589798v2_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula> depending on the true confinement radius. Bottom: estimated confinement radius depending on the track length. Blue areas: standard deviations of the estimates.</p></caption>
<graphic xlink:href="589798v2_fig6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To compare our approach to one of the leading methods specifically designed to characterize fractional Brownian motion, we performed the same test with Randi (<xref ref-type="bibr" rid="c30">30</xref>), the best-performing machine learning method in a head-to-head comparison of available techniques (<xref ref-type="bibr" rid="c31">31</xref>). On the same fractional Brownian motion dataset, Randi and aTrack achieved similar accuracies.</p>
<p>We then used the same approach to compare aTrack and Randi on tracks generated with our motion model, which differs from Randi’s anomalous motion models (<xref rid="fig6" ref-type="fig">Fig. 6b</xref>). Here, we created a dataset of anomalous diffusion with parameters that result in tracks with qualitatively similar properties and MSD curves to those observed with fractional Brownian motion (see tracks in <xref rid="fig6" ref-type="fig">Fig. 6a&amp;b</xref>). For these data, our model performs with high accuracy, at least 99%. In contrast, Randi shows a lower classification accuracy. In particular, Randi has difficulty differentiating diffusive tracks from tracks with both diffusion and directed motion, 61% accuracy (only 11% better than random labeling). Curiously, directed versus Brownian tracks were also surprisingly inaccurate (83%), considering the striking difference in track behaviors (see <xref rid="fig6" ref-type="fig">Fig. 6b</xref>, diffusive versus directed examples).</p>
<p>To test another type of mismatch between our hidden variable model assumptions, we simulated diffusive tracks confined within rigid boundaries. This differs from our model, which uses a potential well to model confinement. We varied the radius of the rigid boundary for simulated tracks and measured the effect on the estimated confinement radius (<xref rid="fig6" ref-type="fig">Fig. 6c</xref>). aTrack accurately determines the confinement radius for a wide range of confinement radii, where the calculated confinement radius is estimated as 3-times the standard deviation of the potential well. The lower radius bound of the operating range relates to the diffusion length per step, while the upper bound is limited by the extent of the particle’s exploration of the confinement area. Note that the exploration distance is determined by the track length and by the diffusion length). This calculation was relatively independent of track length (<xref rid="fig6" ref-type="fig">Fig. 6d</xref>).</p>
<p>Motion blur is another experimental effect in single-particle tracking that can bias parameter estimation. While our model does not explicitly account for it, the estimated diffusion coefficient can be easily corrected to adjust for that effect (<xref ref-type="fig" rid="figS8">Fig.S 8</xref>). As described by Berglund, static and dynamic localization errors have antagonistic effects on the offset term of the MSD. Our model, which explicitly models static localization error but not dynamic error, yields good estimates of the diffusion length if <inline-formula><inline-graphic xlink:href="589798v2_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (MSD curve with a positive offset), but it underestimates <italic>d</italic> by a factor <inline-formula><inline-graphic xlink:href="589798v2_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula> if <inline-formula><inline-graphic xlink:href="589798v2_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. To explicitly adapt our tool to motion blur, one can include motion blur using our new framework for model design (<xref ref-type="bibr" rid="c33">33</xref>).</p>
</sec>
<sec id="s2a7">
<title>Implementation on experimental data</title>
<p>To test the usefulness of aTrack on experimental data, we performed classification, population characterization, and parameter-estimation experiments.</p>
<p>First, we applied aTrack to analyze the movement of the spindle pole body (SPB) in Saccharomyces cerevisiae (<xref rid="fig7" ref-type="fig">Fig. 7a</xref>). The SPB is the microtubule-organizing center in yeast and is embedded in the nuclear envelope. Directed motion of the SPB occurs during S phase, where actin is required to establish spindle orientation by directing the spindle pole body towards the bud neck as well as during mitosis when the spindle elongates to separate the chromosome masses of mother and daughter cell (<xref ref-type="bibr" rid="c34">34</xref>). To visualize SPB dynamics, we imaged unsynchronized cells expressing Spc42-mCherry at a time resolution of 100 ms and used treatment with Latrunculin A (Lat A) to disrupt actin polymerization. Computing the MSD of the population of tracks showed that in average tracks appear diffusive (<xref ref-type="fig" rid="figS9">Fig S9a</xref>). To go beyond this ensemble metric, we used aTrack to compute the likelihood ratio (<italic>l</italic><sub><italic>b</italic></sub>/<italic>l</italic><sub><italic>d</italic></sub>) of each track of 99 time points and to infer the associated p-value from the ratio and the distribution of the likelihood ratio under the null hypothesis (<xref rid="fig7" ref-type="fig">Fig. 7b</xref>). Then, we computed the fractions of significantly directed tracks (type I error rate of 5%) (<xref rid="fig7" ref-type="fig">Fig. 7c</xref>). In untreated cells, 17 % of the tracks exhibited significant directed motion. In contrast, cells treated with LatA showed significantly lower fractions of directed tracks (10%, p-value = 0.0108). This drop in the fraction of directed tracks was not observed in a LatA-resistant strain. Thus, aTrack can reliably detect directed actin-dependent motion at timescales of 10 s.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7.</label>
<caption><title>Experimental demonstrations.</title>
<p><bold>a</bold>: Illustration showing the interaction of the budding yeast spindle pole body (SPB) with actin via microtubules (MT). Actin-dependent motors are responsible for moving the nucleus toward the bud neck during S-phase. <bold>b-c</bold>: Analysis of spindle pole body (SPB) tracks. The analysis was carried out on tracks of 99 time points. <bold>b</bold>: Examples of tracks classified by aTrack to be either significantly directed or non-significantly directed. A random selections of tracks colored by their associated likelihood ratios with and without LatA treatment can be found in <xref ref-type="fig" rid="figS9">Fig S9b</xref>. <bold>c</bold>: Mean fraction of directed tracks from 3 biological replicates for the WT and 2 biological replicates for the latrunculin resistant mutant. Each replicate contains at least 682 tracks. Error bars: standard deviation. *: significant difference with a type I error of 5% according to a two-sided t-test. <bold>d-e</bold>: Analysis of gold nanoparticle (NP) tracks in the presence of motile bacteria (50 time points per track), where some NPs adhere to cells. <bold>d</bold>: NP tracks colored according to their state of motion classification using aTrack’s single-track statistical test and the log likelihood difference (<italic>L</italic><sub><italic>d</italic></sub> − <italic>L</italic><sub><italic>b</italic></sub>) of all tracks. Tracks are considered significantly directed if the likelihood ratio (which is an overestimate of the p-value) is lower than 0.05 (type I error) divided by the number of tracks (85) according to the Bonferroni correction (= log likelihood difference &gt; 7.44). <bold>e</bold>: Maximum likelihood (per track) of the population of tracks depending on the number of states (minus the likelihood assuming 10 states). <bold>f-g</bold>: Analysis of tracks for 1 µm beads trapped using optical tweezers with different laser powers. <bold>f</bold>: Illustration of the optical trap and example tracks of 100 time points for different laser powers. <bold>g</bold>: Fitting a single-state confined diffusion model on a population of 300 tracks with 20 time points.</p></caption>
<graphic xlink:href="589798v2_fig7.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To test the applicability of aTrack to the field of biosensing, we performed a tracking experiment with highly visible gold nanoparticles (AuNP) and <italic>E. coli</italic>. Specifically engineered gold nanoparticles (AuNPs) can attach to cells, and many species are motile. Zapata-Farfan et al.. Thus, detecting a directed fraction of AuNPs could be used for sensitive and fast biodetection in complex environments. AuNPs were added to a diluted <italic>E. coli</italic> culture and imaged. While free AuNPs diffuse rapidly, our method identified directed tracks in a 5.9% population with very high certainty (likelihood ratio &lt; 0.001, <xref rid="fig7" ref-type="fig">Fig. 7d</xref>). This directed fraction is readily apparent by manual data inspection (see supplemental video). Notably, while the directed fraction also exhibited lateral oscillations, consistent with cell rotation (<xref ref-type="bibr" rid="c36">36</xref>), our model was robust to this deviation from the model assumptions. Next, we analyzed the tracks at the population level and computed the number of states as a function of likelihood (<xref rid="fig7" ref-type="fig">Fig. 7e</xref>). The likelihood function shows a noticeable difference between 4 and 5 states. In the 5-state model, there are 2 directed states and 3 diffusive states. The diffusive states likely represent free AuNPs as well as NPs conjugated to diffusing debris of different sizes. The 2 directed populations are likely caused by the abrupt tumbling motion present in some tracks. These directed states comprised 6.2% of tracks, similar to the analysis of individual tracks.</p>
<p>Notably, in this dataset, the likelihood plot shows an ambiguous number of states, where the likelihood increases marginally after 5 states. Such ambiguities are expected when the dataset and the model assumptions do not perfectly match. To ensure that the directed fraction is well estimated independently of the number of states, we varied the number of states to see how the parameter estimates changed, as in (<xref ref-type="bibr" rid="c37">37</xref>). We found that using 3-7 states, resulted in the same fraction of clearly directed tracks with similar parameters.</p>
<p>Finally, we tested our method’s capability to detect confinement. To do so, we confined 1-micron beads in an optical trap (<xref ref-type="bibr" rid="c38">38</xref>), and varied the laser power to control the trap stiffness. Based on populations of 300 tracks of 20 time points, we measured the confinement factor <italic>l</italic> and confirmed that it increases with the laser power of the optical trap, while the calculated confinement diameter <italic>u</italic> decreases, where <inline-formula><inline-graphic xlink:href="589798v2_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref rid="fig7" ref-type="fig">Fig. 7g</xref>).</p>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>aTrack is a new tool for classifying and characterizing noisy tracks, which performs well in a diverse range of conditions. Specifically, the framework’s flexibility is relevant for a wide variety of diffusive, confined, and directed motion types. Our tool classifies the motion type as Brownian or not and quantifies biologically relevant motion parameters, such as the diffusion coefficient, confinement diameter, and velocities. Importantly, this approach calculates how statistically robust a classification is regarding the likelihood difference from a Brownian diffusion model. The flexibility of our approach in capturing a variety of motion-type behaviors contains the usefulness of the catch-all approach of using an anomalous exponent; however, unlike the anomalous exponent that fits multiple underlying motion models (<xref ref-type="bibr" rid="c6">6</xref>), our framework has the advantage of outputting interpretable parameters that describe the motion, e.g. velocity or confinement radii.</p>
<p>aTrack has several features that make it advantageous for analyzing directed and confined motion. For example, allowing the anomalous variable to change over time enables more flexibility. For directed tracks in cells, motion is rarely exactly straight over long distances. Allowing changes in velocity makes it possible to classify and characterize these curved trajectories robustly. Analogously for confined motion, a confined particle may leave its local environment or hop between environments (<xref ref-type="bibr" rid="c39">39</xref>–<xref ref-type="bibr" rid="c41">41</xref>). Our model accounts for this by allowing the center of the confinement well to diffuse as well. Interestingly, we found that directed motion can be readily identified from very short tracks due to the deterministic nature of this type of motion. Longer tracks are needed to classify confined motion with the same statistical certainty. This is to be expected, as a confined particle should reach the boundary of the confinement area several times to be distinguishable from a freely diffusive particle.</p>
<p>As with all classification tools, a source of ambiguity arises when motion types resemble one another. For example, this confusion occurs between immobile particles and very tightly confined particles, which can sometimes be indistin-guishable and not necessarily insightful. Indeed, immobilized fluorophores can be modeled as confined to an area around a substrate to which they are bound. To better distinguish these ambiguous behaviors, experimental modifications are needed, such as adapting the experimental framerate or improving the localization precision using with brighter fluo-rophores (<xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c43">43</xref>).</p>
<p>While machine-learning tools have proven to be effective for subdiffusion characterization (<xref ref-type="bibr" rid="c31">31</xref>), our approach shows it is possible to achieve similarly high performance with many fewer parameters. For our tool, these parameters map onto the stochastic physical behaviors of particle motion, making interpretation more straightforward. Compared to the machine-learning tool we tested, we found that aTrack is more robust to small model mismatches. This finding is consistent with the well-documented issues of machine-learning models generalizing poorly to new data. Of course, in the context of tracking, the generalizability of a model to new data is a key factor, as experimentally-obtained data never perfectly match the model assumptions or the training data set. One solution to make a machine learning model that generalizes better is to use a physics-informed neural network (<xref ref-type="bibr" rid="c44">44</xref>). Such a network would use probabilistic relationships to efficiently learn the physical properties of unlabeled tracks and would contain far fewer parameters than classical networks.</p>
<p>It is often useful to assume a finite number of states with fixed parameters to model the various molecular states in a sample (<xref ref-type="bibr" rid="c43">43</xref>). Selecting the right number of states is difficult, but can be automated by different methods. The criterion, e.g., AIC and BIC, used to determine the number of states is reliable when the model and the data are in perfect agreement. However, experimental data never match the model assumptions perfectly, and even discrepancies between models and simulated data can affect reliability, such as continuous-time simulations and discrete models. This usually results in overestimating the number of states for large data sets (<xref ref-type="bibr" rid="c45">45</xref>). To avoid this flaw of classical criteria, we showed that a penalization term proportional to the number of states and to the log likelihood of the data can prevent the spurious increase of the number of states when increasing the number of tracks. The drawback of this approach is the addition of a tunable parameter that influences the number of estimated parameters of the model, and it may still be necessary to limit the number of states to the biologically relevant system, or consider groups of states, e.g. all significantly directed states.</p>
<p>An important limitation of our approach is that it presumes that a given track follows a unique underlying model with fixed parameters. In biological systems, particles often transition from one motion type to another; for example, a diffusive particle can bind to a static substrate or molecular motor (<xref ref-type="bibr" rid="c46">46</xref>). In such cases, or in cases of significant mislinkings, our model is not suitable. However, this limitation can be alleviated by implicitly allowing state transitions with a hidden Markov Model (<xref ref-type="bibr" rid="c15">15</xref>) or alternatives such as change-point approaches (<xref ref-type="bibr" rid="c30">30</xref>, <xref ref-type="bibr" rid="c47">47</xref>, <xref ref-type="bibr" rid="c48">48</xref>), and spatial approaches (<xref ref-type="bibr" rid="c49">49</xref>).</p>
<p>In conclusion, we have shown that aTrack can identify anomalous diffusion and parameterize the motion over a broad range of motion types using a robust probabilistic framework. As the motion-model parameters estimated by the method represent physical phenomena, these variables are readily interpretable, for example the diffusion coefficient, confinement radius, and velocities. Finally, the employed motion models were selected to permit analytical integration, which makes calculating the model parameters fast and accurate; of course, this integration strategy can be implemented for a variety of motion models with hidden states, further expanding the applicability of this approach to other motion types.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Modeling particle motion with observed and hidden variables</title>
<sec id="s4a1">
<title>Probabilistic model for confined motion</title>
<p>At each time step <italic>i</italic>, our confined-motion model consists of (<xref ref-type="bibr" rid="c1">1</xref>) a Brownian motion step, (<xref ref-type="bibr" rid="c2">2</xref>) a confinement step, (<xref ref-type="bibr" rid="c3">3</xref>) an update to parameters, and (<xref ref-type="bibr" rid="c4">4</xref>) a localization error step. The Brownian motion step updates the particle’s position <italic>r</italic><sub><italic>i</italic></sub> to an intermediate position <italic>z</italic><sub><italic>i</italic></sub>. The variable <italic>z</italic><sub><italic>i</italic></sub> −<italic>r</italic><sub><italic>i</italic></sub> follows a Gaussian distribution centered at 0 with standard deviation <italic>d</italic>, where <italic>d</italic> is the diffusion length, <inline-formula><inline-graphic xlink:href="589798v2_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the diffusion coefficient, and Δ<italic>t</italic> is the time step. Next, the confinement step is modeled by an attractive force between the particle with a potential well centered at <italic>h</italic><sub><italic>i</italic></sub>. More precisely, the particle moves toward the center of the potential well proportionally to a confinement factor <italic>l</italic> and to the distance <italic>r</italic><sub><italic>i</italic></sub> −<italic>h</italic><sub><italic>i</italic></sub>. The next real position <italic>r</italic><sub><italic>i</italic>+1</sub> is thus determined by the following relationship <italic>r</italic><sub><italic>i</italic>+1</sub> = (1 −<italic>l</italic>) · <italic>z</italic><sub><italic>i</italic></sub> +<italic>l</italic> ·<italic>h</italic><sub><italic>i</italic></sub>. To allow the potential well to move, <italic>h</italic> is updated at each step such that <italic>h</italic><sub><italic>i</italic>+1</sub> − <italic>h</italic><sub><italic>i</italic></sub> follows a Gaussian distribution of mean 0 and standard deviation <italic>q</italic>. Finally, to model localization error, the observed positions <italic>c</italic><sub><italic>i</italic></sub> and the real positions <italic>r</italic><sub><italic>i</italic></sub> are related by the localization precision, σ, where <italic>c</italic><sub><italic>i</italic></sub> − <italic>r</italic><sub><italic>i</italic></sub> follows a Gaussian distribution of mean 0 and standard deviation σ.</p>
<p>The distribution of positions for a diffusive particle in a fixed potential well is a Gaussian distribution with standard Deviation <inline-formula><inline-graphic xlink:href="589798v2_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. As we have no prior information about the initial center of the potential well, we assume it is positioned according to a Gaussian probability density function centered on the initial observed position. While it would be even better to consider a Gaussian <inline-formula><inline-graphic xlink:href="589798v2_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula> centered around <italic>r</italic><sub>0</sub>, we simplify it by approximating it to be centered around <italic>c</italic><sub>0</sub> and of standard deviation <inline-formula><inline-graphic xlink:href="589798v2_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The joint probability density function corresponding to this model is the product of Gaussian functions shown in <xref ref-type="disp-formula" rid="eqn1">equation 1</xref>, which is integrated over all hidden parameters to calculate the likelihood, <italic>l</italic><sub><italic>conf ined</italic></sub>.
<disp-formula id="eqn1">
<graphic xlink:href="589798v2_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Where the real positions of the particle <italic>r</italic><sub><italic>i</italic></sub>, potential well <italic>h</italic><sub><italic>i</italic></sub>, and intermediate position <italic>z</italic><sub><italic>i</italic></sub> are hidden variables, and <italic>l</italic> is the confinement factor. By integrating this joint probability over the hidden variables, we can retrieve the probability of the track (the observed positions) given the model and its parameters.</p>
<p>While this integration step can be computed with a Monte Carlo approach (<xref ref-type="bibr" rid="c9">9</xref>), this is computationally expensive. Instead, we integrate using an analytical recurrence formula. This formula is allowed by the fact that the joint probability density function is a product of Gaussians and by the property that for two Gaussians, <italic>f</italic> and <italic>g</italic>, with means <italic>μ</italic><sub><italic>f</italic></sub>, <italic>μ</italic><sub><italic>g</italic></sub> and standard deviations σ<sub><italic>f</italic></sub>, σ<sub><italic>g</italic></sub>, the product is also Gaussian, <italic>f</italic> (<italic>x</italic>) · <italic>g</italic>(<italic>x</italic>) = <italic>ϕ</italic> · <italic>η</italic>(<italic>x</italic>) where <italic>ϕ</italic> and <italic>η</italic> are Gaussian distributions described by <xref ref-type="disp-formula" rid="eqn2">Equation 2</xref>.
<disp-formula id="eqn2">
<graphic xlink:href="589798v2_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
See Supplementary information for more details.</p>
</sec>
<sec id="s4a2">
<title>Probabilistic model for directed motion</title>
<p>To consider directed motion, we use the same general framework as confinement. At each time step <italic>i</italic>, the real particle position <italic>r</italic><sub><italic>i</italic></sub> is first updated to an intermediate position <italic>z</italic><sub><italic>i</italic></sub>, where the variable <italic>z</italic><sub><italic>i</italic></sub> −<italic>r</italic><sub><italic>i</italic></sub> follows a Gaussian distribution centered at 0 with standard deviation <italic>d</italic>. Next, we add the directed-motion component with a vector <italic>w</italic><sub><italic>i</italic></sub>, such that the next real position is the sum of the two steps, <italic>r</italic><sub><italic>i</italic>+1</sub> = <italic>z</italic><sub><italic>i</italic></sub> + <italic>w</italic><sub><italic>i</italic></sub>. Combining these two substeps, we get <italic>z</italic><sub><italic>i</italic></sub> − <italic>r</italic><sub><italic>i</italic></sub> = <italic>r</italic><sub><italic>i</italic>+1</sub> − <italic>r</italic><sub><italic>i</italic></sub> − <italic>w</italic><sub><italic>i</italic></sub>, simplifying the integration process of the probability density function expressed in <xref ref-type="disp-formula" rid="eqn3">equation 3</xref>. Analogous to our confinement model, the velocity vector, <italic>w</italic><sub><italic>i</italic></sub>, is allowed to change over time, where the <italic>w</italic><sub><italic>i</italic>+1</sub> −<italic>w</italic><sub><italic>i</italic></sub> follows a Gaussian distribution with mean 0 and standard deviation <italic>q</italic>. Finally, we include the effect of localization error, where the observed position <italic>c</italic><sub><italic>i</italic></sub> is related to the real position <italic>r</italic><sub><italic>i</italic></sub> following a Gaussian distribution, where <italic>c</italic><sub><italic>i</italic></sub> −<italic>r</italic><sub><italic>i</italic></sub> is Gaussian distributed with mean 0 and standard deviation σ.</p>
<p>During the first time step, the orientation and length of the directed motion vector (speed) need to be initialized. To do so, we assume <italic>w</italic><sub>0</sub> follows a Gaussian distribution function with mean 0 and standard deviation <italic>v</italic>. The resulting joint probability density function is shown in <xref ref-type="disp-formula" rid="eqn3">Equation 3</xref>.
<disp-formula id="eqn3">
<graphic xlink:href="589798v2_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
As with confinement, the probability of a directed track given the model parameters can be calculated using an analytical recurrence formula to integrate over the hidden positions, <italic>r</italic><sub>0→<italic>n</italic></sub>, and velocities <italic>w</italic><sub>0→<italic>n</italic>−1</sub>. The parameter <italic>v</italic> can, in principle, be used to estimate the velocity of a particle with a constant speed but changing orientation in the imaging plane; however, to estimate the average speed of a particle, we use another metric, <italic>k</italic>, that appears in our integration process (see Supplementary information).</p>
</sec>
<sec id="s4a3">
<title>Modeling time-varying velocities and changes in direction</title>
<p>In our model, each axis, x and y, is treated separately, and the velocities can evolve according to a Gaussian distribution. This allows a particle’s direction to change over time. To quantify how direction changes affect the analysis for particles with a constant speed, we simulated tracks with a fixed speed and time-dependent direction for a range of angular diffusion coefficients, <italic>D</italic><sub><italic>θ</italic></sub>. The model parameter, <italic>q</italic>, represents the standard deviation of the change in speed, which can be converted to an angular diffusion length using the following trigonometric relation and the estimated speed of the motion.</p>
<p>In the case of pure directed motion with direction changes, let us consider a single time step, <italic>i</italic>. We have A, the previous particle position <italic>r</italic><sub><italic>i</italic>−1</sub>; B, the particle position assuming no changes of orientation or diffusion, <italic>r</italic><sub><italic>i</italic>−1</sub> + <italic>v</italic><sub><italic>i</italic>−1</sub>; and C, the actual particle position after a change of orientation, <italic>r</italic><sub><italic>i</italic></sub>. ABC forms an isosceles triangle, which can be split into 2 right triangles. We find the following relationship between the scalar distances BC, AB, and <inline-formula><inline-graphic xlink:href="589798v2_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where <italic>θ</italic> is the orientation angle change.</p>
</sec>
<sec id="s4a4">
<title>Fitting method</title>
<p>For the pure Brownian model, the parameters are the diffusion coefficient and the localization error. For the confinement model, the parameters are the diffusion coefficient, the localization error, confinement factor, and the diffusion coefficient of the potential well. For the directed model, the parameters are the diffusion coefficient, the localization error, the initial velocity and the acceleration variance.</p>
<p>These parameters are estimated using the maximum likelihood approach which consists in finding the parameters that maximize the likelihood. We realize this fitting step using gradient descent via a TensorFlow model. All the estimates presented in this article are obtained from a single set of initial parameters to demonstrate that the convergence capacity of aTrack is robust to the initial parameter values.</p>
</sec>
<sec id="s4a5">
<title>Multi-state population model</title>
<p>We designed a specific algorithm to retrieve the number of states in a data set and estimate the parameters of each state as described in the code of the script <italic>atrack</italic>.<italic>py</italic> available on our Github page <ext-link ext-link-type="uri" xlink:href="https://github.com/FrancoisSimon/aTrack">https://github.com/FrancoisSimon/aTrack</ext-link>. This multi-state population algorithm starts by performing individual fittings of tracks to get a type of motion and a set of parameters for each track. Then, we use a Gaussian mixture model on the parameters of the individual tracks to provide an overestimate of the number of states (e.g. 20 if we expect 5 states) and fit the model so that every actual state underlying the data is well represented by at least one of the the model state. Next, we iteratively remove the least useful model state and refit the model until we obtain a single-state model. At each iteration, the least useful state is determined as the state with the smallest negative impact on the likelihood.</p>
</sec>
<sec id="s4a6">
<title>Track simulations</title>
<p>We subdivided each time step into 20 substeps to simulate approximately continuous tracks. We applied the Brownian diffusion and anomalous movements to each of these substeps. For confined motion, the latter step moves the particle toward the center of the potential well center proportionally to the distance multiplied by a scaled confinement factor, <italic>l</italic>/20. In simulations with a moving potential well, the center moves according to the well’s diffusion coefficient, <italic>q</italic>. For directed motion, we applied a shift of constant velocity at each time step after the diffusion step. The orientation of the directed motion could vary according to a rotational diffusion coefficient. The particle’s position after the 20 substeps was set to the particle’s real position, <italic>r</italic><sub><italic>i</italic></sub>, and the localization error was added to create the observed position <italic>c</italic><sub><italic>i</italic></sub>. This process is equivalent for undivided frames for directed motion, as the diffusion and the directed motion steps are independent. However, for the confined model, where the diffusion of the particle influences the anomalous step, thus there is a dependence between the diffusion and confinement steps.</p>
<p>Fractional Brownian motion was simulated using the Python package ‘fbm’ (<ext-link ext-link-type="uri" xlink:href="https://pypi.org/project/fbm/">https://pypi.org/project/fbm/</ext-link>) with the Davies and Harte method (<xref ref-type="bibr" rid="c50">50</xref>).</p>
</sec>
</sec>
<sec id="s4b">
<title>Experimental methods</title>
<sec id="s4b1">
<title>Spindle-pole body</title>
<p>Yeast cells expressing Spc42-mCherry with or without allelic mutation in actin act1-113 (<xref ref-type="bibr" rid="c51">51</xref>), (strains KWY10722 and KWY10328 described in (<xref ref-type="bibr" rid="c52">52</xref>)) were grown to exponential growth phase in synthetic complete medium with glucose (SCD). Cells were treated with 0.2 mM Latrunculin A (Enzo Life Sciences, BML-T119-0500) and DMSO as solvent control for 10 min prior to imaging. Matrical 384-well glass bottom plates coated with Concanavalin A were used to image treated cells on a temperature-controlled inverted Nipkow spinning disk microscope equipped with the Yokogawa Confocal Scanner Unit CSU-W1-T2 controlled by the VisiVIEW Software (Visitron). It was used in spinning disk mode with a pinhole diameter of 50 µm combined with a 1.45 NA, 100x objective. Images were acquired on an EMCCD Andor iXon Ultra camera (1024×1024 pixel, 13×13um pixel size); for one of three biological replicates, the data was acquired with dual camera settings. Imaging was performed at 30 °C with 80 % laser intensity of a Diode 561 nm, 200 mW laser. Timelapse data were acquired with 100 ms exposure time in stream mode for 300 frames. For all movies, tracks were obtained using the ImageJ (<xref ref-type="bibr" rid="c53">53</xref>) plugin TrackMate (<xref ref-type="bibr" rid="c54">54</xref>). Peak detection: LoG with radius = 0.45 µm and threshold = 20, linkage: simple lap tracker with a linking maxiumum distance of 0.5 µm and allowing gaps of one frame. The fractions of directed tracks were inferred by computing the likelihood ratio for each track of 99 time points. Then, we simulated Brownian tracks of diffusion length 0.1 µm which corresponds to the diffusion length of the most diffusive tracks (99 percentile) to estimate the distribution of the likelihood ratio of tracks following the null hypothesis. This is a conservative estimate as we found that higher diffusion lengths (compared to the localization error) produce likelihood ratio distributions that are less skewed toward 1. Based on these simulations, we found that tracks with a likelihood ratio lower than 0.295 are significantly directed with an error rate of 5%.</p>
</sec>
<sec id="s4b2">
<title>Bacteria detection and tracking</title>
<p>Bacteria detection with nanoparticles was performed following the protocol described in Zapata-Farfan et al. (2023). In brief, <italic>E. coli</italic> (strain 25922, ATCC) were cultured for 24 h in Trypticase soy broth (TSB) at 37°C and then incubated for 30 min with 100 nm spherical gold nanoparticles at 50 µg/mL (A11-100-CIT, Nanopartz) in 1x PBS. Samples were placed in a small chamber consisting of double-sided tape (5 µm thickness, Nitto) between a coverslip and glass slide. Trackings was performed using Trackmate 7.0 (<xref ref-type="bibr" rid="c54">54</xref>) with the LoG detection method with a diameter of 0.70 µm (6 pixels) and quality threshold of 24.</p>
</sec>
<sec id="s4b3">
<title>Optical tweezers</title>
<p>The tracking of microspheres captured in an optical trap was achieved using a custom instrument constructed on a modular inverted microscope (MIM/RAMM, ASI Imaging), incorporating optical trapping and imaging paths. The trapping diode laser (SNP-06E-100, Teem) emitting at 1064nm (TEM<sub>00</sub>) had an average output power of 60 milliwatts. The laser beam is expanded using a 1:3 telescope (Achromatic doublets, Thorlabs) to overfill the objective’s back focal plane. This expanded beam was focused through a 100X, 1.45 NA objective (UPlanXApo 100X, Olympus) to trap dielectric particles. The same objective was used to collect bright-field illumination, which was imaged using a CMOS camera (ORCA - Flash4.0 LT3, Hamamatsu). A 3-axis piezo-driven stage (MicroScan SCXYZ100, Thorlabs) with a precision of 25 nm facilitated sample movement to capture particles in the trap. One µm polystyrene microbeads (Monodisperse fluorescent microspheres, Cromtech Research Center) were suspended in water. The solution was squeezed between two coverslips (No. 1.5, Thermo), and a single bead was brought into the laser trap by translating the sample. Data acquisition was performed at 315 frames per second for 2 minutes, these movies were then analyzed in shorter, 100-frame segments. Beads positions were tracked using TrackMate (<xref ref-type="bibr" rid="c54">54</xref>). aTrack analysis was performed on 300 tracks of 20 time points, inputting a fixed localization error and diffusion coefficient, which were determined from the lowest laser intensity (15mW) σ = 0.0116µm, <italic>d</italic> = 0.0259µm, respectively. Confinement <inline-formula><inline-graphic xlink:href="589798v2_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
</sec>
</sec>
</sec>
</body>
<back>
<sec id="s8">
<title>Supplementary information</title>
<sec id="s8a">
<title>Statistical test</title>
<p>Statistical tests are important as they allow one model to be chosen over another. In the case of independent and identically distributed variables, the log likelihood ratio of a dataset drawn from the null hypothesis follows a chi-squared distribution that can be used to determine the p-value. The p-value can then be used to reject or not the null hypothesis.</p>
<p>In this article, we use the likelihood ratio as our testing metrics. However, the observed variables of our sequential models are not independent. Therefore, the log likelihood ratio is not expected to have a chi-squared form with a fixed degree of freedom. Nevertheless, several methods can still be used to estimate the p-value. Intuitively, the likelihood ratio tells how much more likely one model is compared to another, where the model with the highest likelihood should be preferred. However, this metric alone can be subject to over-fitting. In our framework, the Brownian diffusion model is a specific subset of both the directed and confined motion models. As a consequence, the likelihood of the directed or confined motion model is equal or higher than the likelihood ratio of our Brownian motion model, confining the ratio Brownian/Anomalous between 0 and 1. In <xref ref-type="fig" rid="figS2">Fig. S2</xref>, we tested our metrics on several data sets and we found that the likelihood ratio is indeed skewed towards 0 when the directed (resp. confined) test is applied to significantly directed (resp. confined) tracks. On the contrary, when the directed (resp. confined) test is applied to Brownian or confined (resp. directed) tracks, the distribution is consistently skewed toward 1. In comparison, a p-value is by definition uniformly distributed when the data are drawn from the null hypothesis. Therefore, our metrics can be effectively used as an overestimate of the underlying p-value. This means that for a given user-defined threshold representing the rate of false positives, the user can reject the null hypothesis for a given type I error rate. In heatmaps of the likelihood ratio like in <xref rid="fig2" ref-type="fig">Fig. 2c</xref>, we show the average likelihood ratio for a range of parameters. In these graphs, a low average ratio indicates a high test sensitivity.</p>
<p>While the likelihood ratio provides a reliable upper bound for the p-value, it is possible to create a more sensitive test by computing a better estimate of the p-value. Considering a track of <italic>n</italic> time points, running the likelihood ratio test results in a Brownian null hypothesis model of estimated parameters <inline-formula><inline-graphic xlink:href="589798v2_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, an alternative hypothesis model of estimated parameters <italic>θ</italic><sup>*</sup> and a likelihood ratio <italic>ρ</italic>. By simulating Brownian tracks of length <italic>n</italic> and parameters <inline-formula><inline-graphic xlink:href="589798v2_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, we can compute the empirical distribution of the likelihood ratio under the null hypothesis <italic>ρ</italic><sub>0</sub>. The p-value associated with a track of likelihood ratio <italic>ρ</italic> can then be estimated as the quantile <italic>ρ</italic> of the distribution of <italic>ρ</italic><sub><italic>H</italic>0</sub>.</p>
<p>This statistical framework can be extended to other types of test: We can for example perform a conformity test by computing the ratio of likelihoods assuming a model with some fixed parameters over the likelihood of the model with fitted parameters. If the ratio is close from 0, we can reject the null hypothesis with fixed parameters.</p>
</sec>
<sec id="s8b">
<title>Derivations</title>
<sec id="s8b1">
<title>Likelihood calculation for confined motion</title>
    <p>To simplify the integration of the product of Gaussians described in the Method section, <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>, <italic>f</italic><sub>σ</sub>((1−<italic>l</italic>)<italic>z</italic><sub><italic>i</italic></sub> +<italic>lh</italic><sub><italic>i</italic></sub> −<italic>c</italic><sub><italic>i</italic>+1</sub>) <italic>f</italic><sub><italic>d</italic></sub> ((1− <italic>l</italic>)<italic>z</italic><sub><italic>i</italic></sub> + <italic>lh</italic><sub><italic>i</italic></sub> − <italic>zi</italic><sub>+1</sub>) can be refactored to <inline-formula><inline-graphic xlink:href="589798v2_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula> of variances <italic>k</italic><sup>2</sup> = σ<sup>2</sup> + <italic>d</italic><sup>2</sup> and <italic>g</italic><sup>′2</sup> = σ<sup>2</sup><italic>d</italic><sup>2</sup>/(σ<sup>2</sup> + <italic>d</italic><sup>2</sup>). This can be further simplified into <inline-formula><inline-graphic xlink:href="589798v2_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with <inline-formula><inline-graphic xlink:href="589798v2_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>G</italic> represent Gaussian distributions of mean 0 with variances <italic>k</italic><sup>2</sup> = σ<sup>2</sup> + <italic>d</italic><sup>2</sup> and <inline-formula><inline-graphic xlink:href="589798v2_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>,respectively. Then, we use the annotation <italic>N</italic>(<italic>x, V</italic>) to refer to other Gaussian probability density functions of mean 0 and of variance <italic>V</italic>.</p>
    <p><xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> is equivalent to:
<disp-formula id="eqn4">
<graphic xlink:href="589798v2_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
During the integration process, we obtain the following set of recurrence formulas:</p>
<p>- Initialization:
<disp-formula id="eqn5">
<graphic xlink:href="589798v2_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
- Recurrence:
<disp-formula id="eqn6">
<graphic xlink:href="589798v2_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
-Final step:
<disp-formula id="eqn7">
<graphic xlink:href="589798v2_eqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s8b2">
<title>Likelihood calculation for directed motion</title>
<p>Similarly to the confined motion formula, the track probability can be expressed using a recurrence formula that depends on the parameters of the directed motion model, the localization error σ, the diffusion length <italic>d</italic>, the initial velocity <italic>v</italic> and the speed of the velocity change <italic>q</italic>.</p>
<p>- Initialization:
<disp-formula id="eqn8">
<graphic xlink:href="589798v2_eqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
- Recurrence:
<disp-formula id="eqn9">
<graphic xlink:href="589798v2_eqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
-Final steps (steps <italic>i</italic> = <italic>n</italic> − 2 and <italic>i</italic> = <italic>n</italic> − 1):
<disp-formula id="eqn10">
<graphic xlink:href="589798v2_eqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<fig id="figS1" position="float" fig-type="figure">
<label>Supplementary Figure 1.</label>
<caption><title>Log-likelihood differences as a function of the track length.</title>
<p>Distributions of the log likelihood differences (<italic>L</italic><sub><italic>c</italic></sub> − <italic>L</italic><sub><italic>b</italic></sub> and <italic>L</italic><sub><italic>d</italic></sub> − <italic>L</italic><sub><italic>b</italic></sub>) for tracks in Brownian motion (column 1), confined motion (column 1), or linear motion (column 3) using the confinement motion test (row 1) or the directed motion test (row 2) for tracks with different number of time points. 10,000 tracks per distribution. The simulated track parameters were as following: localization error σ = 0.02 µm; confined tracks: diffusion length per step <italic>d</italic> = 0.1 µm, confinement factor <italic>l</italic> = 0.25; linear tracks: <italic>d</italic> = 0.0 µm, velocity <italic>v</italic> = 0.02 µm·Δt<sup>−1</sup>, constant speed and orientation.</p></caption>
<graphic xlink:href="589798v2_figS1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Supplementary Figure 2.</label>
<caption><title>Likelihood ratios as a function of the track length.</title>
<p>Distributions of the likelihood ratios <italic>l</italic><sub><italic>b</italic></sub>/<italic>l</italic><sub><italic>c</italic></sub> and <italic>l</italic><sub><italic>b</italic></sub>/<italic>l</italic><sub><italic>d</italic></sub> corresponding to <xref ref-type="fig" rid="figS1">Fig. S1</xref>. As expected, the distributions are skewed toward 0 only when the proper test is applied.</p></caption>
<graphic xlink:href="589798v2_figS2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Supplementary Figure 3.</label>
<caption><title>Parameter estimates for confined motion model.</title>
<p><bold>a</bold>: Histograms of the estimated diffusion length per step of the potential well depending the confinement factor corresponding to <xref rid="fig3" ref-type="fig">Fig 3b</xref>. <bold>b-c</bold>: Heatmaps of the estimated diffusion lengths per step of the potential well (b) and of the estimated diffusion lengths or the particle depending on the track length and on the confinement factor corresponding to <xref rid="fig3" ref-type="fig">Fig 3c</xref>. <bold>d</bold>: Distributions of the estimated confinement factor depending on the track length (same conditions than <xref rid="fig3" ref-type="fig">Fig 3c</xref> with a confinement factor of 0.25). <bold>e</bold>: Heatmap of the relative biases on the estimated confinement factors depending on the confinement radius and track length corresponding to <xref rid="fig3" ref-type="fig">Fig 3d</xref>. <bold>f</bold>: Distributions of the estimated confinement radius depending on the true confinement radius (same conditions as in <xref rid="fig3" ref-type="fig">Fig 3d</xref> with tracks of 150 time points). <bold>g</bold>: Distributions of the log likelihood difference (<italic>L</italic><sub><italic>c</italic></sub> − <italic>L</italic><sub><italic>b</italic></sub>), estimated confinement factor and estimated diffusion length of the particle depending on the diffusion length of the potential well corresponding to <xref rid="fig3" ref-type="fig">Fig 3d</xref>.</p></caption>
<graphic xlink:href="589798v2_figS3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Supplementary Figure 4.</label>
<caption><title>Linear motion model estimations.</title>
<p><bold>a</bold>: (Complement of <xref rid="fig4" ref-type="fig">Fig 4b</xref>) Rainbow plots of the log likelihood difference, estimated diffusion length, and estimated change of velocity for tracks in perfect linear motion (with localization error) for different linear motion velocities. 10,000 tracks per condition. localization error: σ = 0.02 µm, tracks of 30 time points. <bold>b</bold>: (Complement of <xref rid="fig4" ref-type="fig">Fig 4c</xref>) Heatmaps of the likelihood ratio, estimated diffusion length and change of velocity (average) for tracks in perfect linear motion varying the track length and the directed motion velocity. σ = 0.02 µm.</p></caption>
<graphic xlink:href="589798v2_figS4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Supplementary Figure 5.</label>
<caption><title>Impact of directional changes in directed motion models.</title>
<p><bold>a</bold>: (Complement of <xref rid="fig4" ref-type="fig">Fig 4e</xref>) Study of the impact of the rotational diffusion of tracks in directed motion with changing orientation. Heatmaps of the likelihood ratio, of the absolute error on the rotational diffusion angle, and of the estimated diffusion length when varying the directed motion velocity and the rotational diffusion angle. <italic>d</italic> = 0.0 µm, σ = 0.02 µm. <bold>b</bold>: (Complement of <xref rid="fig4" ref-type="fig">Fig 4g</xref>) Characterization of the motion parameters of particles with both diffusive and directed motion. Mean absolute error on the diffusion length and on the velocity of the linear motion varying the number of time points in each track. Directed motion velocity: <italic>v</italic> = 0.1 µm·Δt<sup>−1</sup>, σ = 0.02 µm. <bold>a-b</bold>: mean values from 10,000 tracks.</p></caption>
<graphic xlink:href="589798v2_figS5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Supplementary Figure 6.</label>
<caption><title>Dataset size and parameter estimate error.</title>
<p>Effect of the number of tracks on the different parameters of the tracks: the likelihood, the root mean squared error, the standard deviation and the bias on the estimates of the diffusion length and anomalous parameter (velocity or confinement factor) for both directed motion and confined motion. All tracks were composed of 50 time points and 50 replicates were performed to estimate the error for each number of tracks. Directed tracks: persistent motion velocity <italic>v</italic> = 0.02 µm·Δt<sup>−1</sup>, angular diffusion coefficient : 0.1 Rad<sup>2</sup>·Δt<sup>−1</sup>, <italic>d</italic> = 0.0 µm, σ = 0.02 µm. Confined tracks: confinement factor 0.2, <italic>d</italic> = 0.1 µm, σ = 0.02 µm.</p></caption>
<graphic xlink:href="589798v2_figS6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS7" position="float" fig-type="figure">
<label>Supplementary Figure 7.</label>
<caption><title>Estimating the number of states.</title>
<p>AIC, BIC, and corrected BIC corresponding to the log likelihood shown in <xref rid="fig5" ref-type="fig">Fig 5c</xref> depending on the number of states assumed by the model and on the number of tracks per data set. The corrected BIC corresponds to the BIC with an additional penalization term of 0.02<italic>kL</italic> with and <italic>k</italic> the number of parameters and <italic>L</italic> the log likelihood. Under the AIC, BIC, and corrected BIC curves, we plotted the optimal number of states (the one that minimizes the criterion) for each data set.</p></caption>
<graphic xlink:href="589798v2_figS7.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS8" position="float" fig-type="figure">
<label>Supplementary Figure 8.</label>
<caption><title>Effect of dynamic and static localization error on estimated motion parameters.</title>
<p>Simulated populations of Brownian tracks with continuous exposure and estimated the (population-wise) diffusion length per step and localization error. At each step, the position is estimated as the average position of 200 sub-steps with a static localization error of 0.02µm (per time-step). <bold>a-c</bold>: Simulations of 5000 tracks of 100 time points with varying diffusion lengths. <bold>a</bold>: Estimated diffusion length as a function of the true diffusion length. <bold>b</bold>: Estimated diffusion length as a function of the true diffusion length (log-log plot). <bold>c</bold>: Estimated localization error as a function of the true diffusion length. <bold>d</bold>: Estimated diffusion lengths for 5000 tracks with varying number of time steps and fixed diffusion length per time step of 1 µm.</p></caption>
<graphic xlink:href="589798v2_figS8.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS9" position="float" fig-type="figure">
<label>Supplementary Figure 9.</label>
<caption><title>Confinement characterization in <italic>Saccharomyces cerevisiae</italic>.</title>
<p><bold>a</bold>: Mean squared displacements (MSD) as a function of the number of time steps in the WT strain without treatment (DMSO). <bold>b</bold>: Random selections of tracks of 99 time points from the WT strain without and with LatA treatment (resp. − LatA and + LatA) colored according to their likelihood ratio (<italic>l</italic><sub><italic>b</italic></sub>/<italic>l</italic><sub><italic>d</italic></sub>).</p></caption>
<graphic xlink:href="589798v2_figS9.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
</sec>
</sec>
<sec id="s5" sec-type="data-availability">
<title>Data and code availability</title>
<p>Tracking data and the aTrack software is available online. aTrack is available as a stand-alone software for Windows and as a python package. Installation instructions are provided on the Github page <ext-link ext-link-type="uri" xlink:href="https://github.com/FrancoisSimon/aTrack">https://github.com/FrancoisSimon/aTrack</ext-link>.</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>The authors thank Sven van Teeffelen for helpful discussions. This work was supported by the Natural Sciences and Engineering Research Council of Canada [NSERC Discovery grant to MM, (RGPIN-06404-2016) to CB, (RGPIN-2022-05142) to LEW], the Canada First Research Excellence Fund (TransMedTech Institute), the ETH research grant ETH-33 19-1 and the Swiss National Science Foundation (project number 320030-236124) to ED.</p>
</ack>
<sec id="d1e1971" sec-type="additional-information">
<title>Additional information</title>
<sec id="s6">
<title>Author contributions</title>
<p>Conceptualization: FS, LEW; Methodology: FS, LEW; Software: FS, IF; Validation: FS; Formal analysis: FS; Investigation: FS, GR, JZ, SP; Resources: MM, CB, ED, LEW; Data curation: FS, LEW; Writing - original draft: FS, LEW; Writing - review and editing: FS, GR, SP, ED, LEW; Visualization: FS, JZ, GR, ED; Supervision: LEW; Project administration: LEW; Funding acquisition: MM, CB, ED, LEW.</p>
</sec>
</sec>
<ref-list>
<title>Bibliography</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Hao</given-names> <surname>Shen</surname></string-name>, <string-name><given-names>Lawrence J</given-names> <surname>Tauzin</surname></string-name>, <string-name><given-names>Rashad</given-names> <surname>Baiyasi</surname></string-name>, <string-name><given-names>Wenxiao</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>Nicholas</given-names> <surname>Moringo</surname></string-name>, <string-name><given-names>Bo</given-names> <surname>Shuang</surname></string-name>, and <string-name><given-names>Christy F</given-names> <surname>Landes</surname></string-name></person-group>. <article-title>Single particle tracking: from theory to biophysical applications</article-title>. <source>Chemical reviews</source>, <volume>117</volume>(<issue>11</issue>):<fpage>7331</fpage>–<lpage>7376</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Achillefs N</given-names> <surname>Kapanidis</surname></string-name>, <string-name><given-names>Stephan</given-names> <surname>Uphoff</surname></string-name>, and <string-name><given-names>Mathew</given-names> <surname>Stracy</surname></string-name></person-group>. <article-title>Understanding protein mobility in bacteria by tracking single molecules</article-title>. <source>Journal of molecular biology</source>, <volume>430</volume>(<issue>22</issue>):<fpage>4443</fpage>–<lpage>4455</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Zhao</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>Xuejing</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>Ying</given-names> <surname>Zhang</surname></string-name>, <string-name><given-names>Weili</given-names> <surname>Xu</surname></string-name>, and <string-name><given-names>Xiaojun</given-names> <surname>Han</surname></string-name></person-group>. <article-title>Principles and applications of single particle tracking in cell research</article-title>. <source>Small</source>, <volume>17</volume>(<issue>11</issue>):<fpage>2005133</fpage>. <year>2021</year></mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Michael J</given-names> <surname>Saxton</surname></string-name></person-group>. <article-title>A biological interpretation of transient anomalous subdiffusion. i. qualitative model</article-title>. <source>Biophysical journal</source>, <volume>92</volume>(<issue>4</issue>): <fpage>1178</fpage>–<lpage>1191</lpage>, <year>2007</year>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Felix</given-names> <surname>Höfling</surname></string-name> and <string-name><given-names>Thomas</given-names> <surname>Franosch</surname></string-name></person-group>. <article-title>Anomalous transport in the crowded world of biological cells</article-title>. <source>Reports on Progress in Physics</source>, <volume>76</volume>(<issue>4</issue>): <fpage>046602</fpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ralf</given-names> <surname>Metzler</surname></string-name>, <string-name><given-names>Jae-Hyung</given-names> <surname>Jeon</surname></string-name>, <string-name><given-names>Andrey G</given-names> <surname>Cherstvy</surname></string-name>, and <string-name><given-names>Eli</given-names> <surname>Barkai</surname></string-name></person-group>. <article-title>Anomalous diffusion models and their properties: non-stationarity, non-ergodicity, and ageing at the centenary of single particle tracking</article-title>. <source>Physical Chemistry Chemical Physics</source>, <volume>16</volume>(<issue>44</issue>):<fpage>24128</fpage>–<lpage>24164</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Nilah</given-names> <surname>Monnier</surname></string-name>, <string-name><given-names>Zachary</given-names> <surname>Barry</surname></string-name>, <string-name><given-names>Hye Yoon</given-names> <surname>Park</surname></string-name>, <string-name><given-names>Kuan-Chung</given-names> <surname>Su</surname></string-name>, <string-name><given-names>Zachary</given-names> <surname>Katz</surname></string-name>, <string-name><given-names>Brian P</given-names> <surname>English</surname></string-name>, <string-name><given-names>Arkajit</given-names> <surname>Dey</surname></string-name>, <string-name><given-names>Keyao</given-names> <surname>Pan</surname></string-name>, <string-name><given-names>Iain M</given-names> <surname>Cheeseman</surname></string-name>, <string-name><given-names>Robert H</given-names> <surname>Singer</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Inferring transient particle transport dynamics in live cells</article-title>. <source>Nature Methods</source>, <volume>12</volume>(<issue>9</issue>):<fpage>838</fpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jason</given-names> <surname>Bernstein</surname></string-name> and <string-name><given-names>John</given-names> <surname>Fricks</surname></string-name></person-group>. <article-title>Analysis of single particle diffusion with transient binding using particle filtering</article-title>. <source>Journal of theoretical biology</source>, <volume>401</volume>:<fpage>109</fpage>–<lpage>121</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Paddy J</given-names> <surname>Slator</surname></string-name> and <string-name><given-names>Nigel J</given-names> <surname>Burroughs</surname></string-name></person-group>. <article-title>A hidden markov model for detecting confinement in single-particle tracking trajectories</article-title>. <source>Biophysical journal</source>, <volume>115</volume>(<issue>9</issue>):<fpage>1741</fpage>–<lpage>1754</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Krzysztof</given-names> <surname>Burnecki</surname></string-name>, <string-name><given-names>Eldad</given-names> <surname>Kepten</surname></string-name>, <string-name><given-names>Joanna</given-names> <surname>Janczura</surname></string-name>, <string-name><given-names>Irena</given-names> <surname>Bronshtein</surname></string-name>, <string-name><given-names>Yuval</given-names> <surname>Garini</surname></string-name>, and <string-name><given-names>Aleksander</given-names> <surname>Weron</surname></string-name></person-group>. <article-title>Universal algorithm for identification of fractional brownian motion. a case of telomere subdiffusion</article-title>. <source>Biophysical journal</source>, <volume>103</volume>(<issue>9</issue>):<fpage>1839</fpage>–<lpage>1847</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Vincent</given-names> <surname>Briane</surname></string-name>, <string-name><given-names>Charles</given-names> <surname>Kervrann</surname></string-name>, and <string-name><given-names>Myriam</given-names> <surname>Vimond</surname></string-name></person-group>. <article-title>Statistical analysis of particle trajectories in living cells</article-title>. <source>Physical Review E</source>, <volume>97</volume>(<issue>6</issue>): <fpage>062121</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Maxime</given-names> <surname>Woringer</surname></string-name>, <string-name><given-names>Ignacio</given-names> <surname>Izeddin</surname></string-name>, <string-name><given-names>Cyril</given-names> <surname>Favard</surname></string-name>, and <string-name><given-names>Hugues</given-names> <surname>Berry</surname></string-name></person-group>. <article-title>Anomalous subdiffusion in living cells: bridging the gap between experiments and realistic models through collaborative challenges</article-title>. <source>Frontiers in Physics</source>, <volume>8</volume>:<fpage>134</fpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Felix</given-names> <surname>Oswald</surname></string-name>, <string-name><given-names>Aravindan</given-names> <surname>Varadarajan</surname></string-name>, <string-name><given-names>Holger</given-names> <surname>Lill</surname></string-name>, <string-name><given-names>Erwin JG</given-names> <surname>Peterman</surname></string-name>, and <string-name><given-names>Yves JM</given-names> <surname>Bollen</surname></string-name></person-group>. <article-title>Mreb-dependent organization of the e. coli cytoplasmic membrane controls membrane protein diffusion</article-title>. <source>Biophysical journal</source>, <volume>110</volume>(<issue>5</issue>):<fpage>1139</fpage>–<lpage>1149</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Peter K</given-names> <surname>Relich</surname></string-name>, <string-name><given-names>Mark J</given-names> <surname>Olah</surname></string-name>, <string-name><given-names>Patrick J</given-names> <surname>Cutler</surname></string-name>, and <string-name><given-names>Keith A</given-names> <surname>Lidke</surname></string-name></person-group>. <article-title>Estimation of the diffusion constant from intermittent trajectories with variable position uncertainties</article-title>. <source>Physical Review E</source>, <volume>93</volume>(<issue>4</issue>):<fpage>042401</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>François</given-names> <surname>Simon</surname></string-name>, <string-name><given-names>Jean-Yves</given-names> <surname>Tinevez</surname></string-name>, and <string-name><given-names>Sven</given-names> <surname>van Teeffelen</surname></string-name></person-group>. <article-title>Extrack characterizes transition kinetics and diffusion in noisy single-particle tracks</article-title>. <source>Journal of Cell Biology</source>, <volume>222</volume>(<issue>5</issue>):<fpage>e202208059</fpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Samuel S</given-names> <surname>Wilks</surname></string-name></person-group>. <article-title>The large-sample distribution of the likelihood ratio for testing composite hypotheses</article-title>. <source>The annals of mathematical statistics</source>, <volume>9</volume>(<issue>1</issue>):<fpage>60</fpage>–<lpage>62</lpage>, <year>1938</year>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Aad W</given-names> <surname>Van der Vaart</surname></string-name></person-group>. <source>Asymptotic statistics</source>, volume <volume>3</volume>. <publisher-name>Cambridge university press</publisher-name>, <year>2000</year>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Paolo</given-names> <surname>Pierobon</surname></string-name>, <string-name><given-names>Sarra</given-names> <surname>Achouri</surname></string-name>, <string-name><given-names>Sébastien</given-names> <surname>Courty</surname></string-name>, <string-name><given-names>Alexander R</given-names> <surname>Dunn</surname></string-name>, <string-name><given-names>James A</given-names> <surname>Spudich</surname></string-name>, <string-name><given-names>Maxime</given-names> <surname>Dahan</surname></string-name>, and <string-name><given-names>Giovanni</given-names> <surname>Cappello</surname></string-name></person-group>. <article-title>Velocity, processivity, and individual steps of single myosin v molecules in live cells</article-title>. <source>Biophysical journal</source>, <volume>96</volume>(<issue>10</issue>):<fpage>4268</fpage>–<lpage>4275</lpage>, <year>2009</year>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sven</given-names> <surname>Van Teeffelen</surname></string-name>, <string-name><given-names>Siyuan</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>Leon</given-names> <surname>Furchtgott</surname></string-name>, <string-name><given-names>Kerwyn Casey</given-names> <surname>Huang</surname></string-name>, <string-name><given-names>Ned S</given-names> <surname>Wingreen</surname></string-name>, <string-name><given-names>Joshua W</given-names> <surname>Shaevitz</surname></string-name>, and <string-name><given-names>Zemer</given-names> <surname>Gitai</surname></string-name></person-group>. <article-title>The bacterial actin mreb rotates, and rotation depends on cell-wall assembly</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>108</volume>(<issue>38</issue>): <fpage>15822</fpage>–<lpage>15827</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Aaron D</given-names> <surname>Pilling</surname></string-name>, <string-name><given-names>Dai</given-names> <surname>Horiuchi</surname></string-name>, <string-name><given-names>Curtis M</given-names> <surname>Lively</surname></string-name>, and <string-name><given-names>William M</given-names> <surname>Saxton</surname></string-name></person-group>. <article-title>Kinesin-1 and dynein are the primary motors for fast transport of mitochondria in drosophila motor axons</article-title>. <source>Molecular biology of the cell</source>, <volume>17</volume>(<issue>4</issue>):<fpage>2057</fpage>–<lpage>2068</lpage>, <year>2006</year>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Christopher P</given-names> <surname>Calderon</surname></string-name>, <string-name><given-names>Lucien E</given-names> <surname>Weiss</surname></string-name>, and <string-name><given-names>WE</given-names> <surname>Moerner</surname></string-name></person-group>. <article-title>Robust hypothesis tests for detecting statistical evidence of two-dimensional and three-dimensional interactions in single-molecule measurements</article-title>. <source>Physical Review E</source>, <volume>89</volume>(<issue>5</issue>):<fpage>052705</fpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Cédric</given-names> <surname>Bouzigues</surname></string-name> and <string-name><given-names>Maxime</given-names> <surname>Dahan</surname></string-name></person-group>. <article-title>Transient directed motions of gabaa receptors in growth cones detected by a speed correlation index</article-title>. <source>Biophysical journal</source>, <volume>92</volume>(<issue>2</issue>):<fpage>654</fpage>–<lpage>660</lpage>, <year>2007</year>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Gizem</given-names> <surname>Özbaykal</surname></string-name>, <string-name><given-names>Eva</given-names> <surname>Wollrab</surname></string-name>, <string-name><given-names>Francois</given-names> <surname>Simon</surname></string-name>, <string-name><given-names>Antoine</given-names> <surname>Vigouroux</surname></string-name>, <string-name><given-names>Baptiste</given-names> <surname>Cordier</surname></string-name>, <string-name><given-names>Andrey</given-names> <surname>Aristov</surname></string-name>, <string-name><given-names>Thibault</given-names> <surname>Chaze</surname></string-name>, <string-name><given-names>Mariette</given-names> <surname>Matondo</surname></string-name>, and <string-name><given-names>Sven</given-names> <surname>van Teeffelen</surname></string-name></person-group>. <article-title>The transpeptidase pbp2 governs initial localization and activity of the major cell-wall synthesis machinery in e. coli</article-title>. <source>eLife</source>, <volume>9</volume>:<elocation-id>e50629</elocation-id>, <year>2020</year>. <pub-id pub-id-type="doi">10.7554/eLife.50629</pub-id></mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Stanislav</given-names> <surname>Tsitkov</surname></string-name>, <string-name><given-names>Yuchen</given-names> <surname>Song</surname></string-name>, <string-name><given-names>Juan B</given-names> <surname>Rodriguez</surname> <suffix>III</suffix></string-name>, <string-name><given-names>Yifei</given-names> <surname>Zhang</surname></string-name>, and <string-name><given-names>Henry</given-names> <surname>Hess</surname></string-name></person-group>. <article-title>Kinesin-recruiting microtubules exhibit collective gliding motion while forming motor trails</article-title>. <source>ACS nano</source>, <volume>14</volume>(<issue>12</issue>):<fpage>16547</fpage>–<lpage>16557</lpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>LiYan</given-names> <surname>Ping</surname></string-name></person-group>. <article-title>Cell orientation of swimming bacteria: from theoretical simulation to experimental evaluation</article-title>. <source>Science China Life Sciences</source>, <volume>55</volume>:<fpage>202</fpage>–<lpage>209</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Hong</given-names> <surname>Qian</surname></string-name>, <string-name><given-names>Michael P</given-names> <surname>Sheetz</surname></string-name>, and <string-name><given-names>Elliot L</given-names> <surname>Elson</surname></string-name></person-group>. <article-title>Single particle tracking. analysis of diffusion and flow in two-dimensional systems</article-title>. <source>Biophysical journal</source>, <volume>60</volume>(<issue>4</issue>):<fpage>910</fpage>–<lpage>921</lpage>, <year>1991</year>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Frank J.</given-names> <surname>Fazekas</surname></string-name>, <string-name><given-names>Thomas R.</given-names> <surname>Shaw</surname></string-name>, <string-name><given-names>Sumin</given-names> <surname>Kim</surname></string-name>, <string-name><given-names>Ryan A.</given-names> <surname>Bogucki</surname></string-name>, and <string-name><given-names>Sarah L.</given-names> <surname>Veatch</surname></string-name></person-group>. <article-title>A mean shift algorithm for drift correction in localization microscopy</article-title>. <source>Biophysical Reports</source>, <volume>1</volume>(<issue>1</issue>):<fpage>100008</fpage>, <year>2021</year>. ISSN <issn>2667-0747</issn>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Hirotugu</given-names> <surname>Akaike</surname></string-name></person-group>. <article-title>A new look at the statistical model identification</article-title>. <source>IEEE transactions on automatic control</source>, <volume>19</volume>(<issue>6</issue>):<fpage>716</fpage>–<lpage>723</lpage>, <year>1974</year>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Benoit B</given-names> <surname>Mandelbrot</surname></string-name> and <string-name><given-names>John W</given-names> <surname>Van Ness</surname></string-name></person-group>. <article-title>Fractional brownian motions, fractional noises and applications</article-title>. <source>SIAM review</source>, <volume>10</volume>(<issue>4</issue>):<fpage>422</fpage>–<lpage>437</lpage>, <year>1968</year>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Aykut</given-names> <surname>Argun</surname></string-name>, <string-name><given-names>Giovanni</given-names> <surname>Volpe</surname></string-name>, and <string-name><given-names>Stefano</given-names> <surname>Bo</surname></string-name></person-group>. <article-title>Classification, inference and segmentation of anomalous diffusion with recurrent neural networks</article-title>. <source>Journal of Physics A: Mathematical and Theoretical</source>, <volume>54</volume>(<issue>29</issue>):<fpage>294003</fpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Gorka</given-names> <surname>Muñoz-Gil</surname></string-name>, <string-name><given-names>Giovanni</given-names> <surname>Volpe</surname></string-name>, <string-name><given-names>Miguel Angel</given-names> <surname>Garcia-March</surname></string-name>, <string-name><given-names>Erez</given-names> <surname>Aghion</surname></string-name>, <string-name><given-names>Aykut</given-names> <surname>Argun</surname></string-name>, <string-name><given-names>Chang Beom</given-names> <surname>Hong</surname></string-name>, <string-name><given-names>Tom</given-names> <surname>Bland</surname></string-name>, <string-name><given-names>Stefano</given-names> <surname>Bo</surname></string-name>, <string-name><given-names>J Alberto</given-names> <surname>Conejero</surname></string-name>, <string-name><given-names>Nicolás</given-names> <surname>Firbas</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Objective comparison of methods to decode anomalous diffusion</article-title>. <source>Nature communications</source>, <volume>12</volume>(<issue>1</issue>): <fpage>6253</fpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Andrew J</given-names> <surname>Berglund</surname></string-name></person-group>. <article-title>Statistics of camera-based single-particle tracking</article-title>. <source>Physical Review E</source>, <volume>82</volume>(<issue>1</issue>):<fpage>011917</fpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Francois C</given-names> <surname>Simon</surname></string-name> and <string-name><given-names>Justin</given-names> <surname>Cardona</surname></string-name></person-group>. <article-title>Fast analytical method to integrate multivariate gaussians over hidden variables</article-title>. <source>HAL</source> <year>2024</year>.</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Chandra L</given-names> <surname>Theesfeld</surname></string-name>, <string-name><given-names>Javier E</given-names> <surname>Irazoqui</surname></string-name>, <string-name><given-names>Kerry</given-names> <surname>Bloom</surname></string-name>, and <string-name><given-names>Daniel J</given-names> <surname>Lew</surname></string-name></person-group>. <article-title>The role of actin in spindle orientation changes during the saccharomyces cerevisiae cell cycle</article-title>. <source>Journal of Cell Biology</source>, <volume>146</volume>(<issue>5</issue>):<fpage>1019</fpage>–<lpage>1032</lpage>, <year>1999</year>.</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jennyfer</given-names> <surname>Zapata-Farfan</surname></string-name>, <string-name><given-names>Morteza Hasanzadeh</given-names> <surname>Kafshgari</surname></string-name>, <string-name><given-names>Sergiy</given-names> <surname>Patskovsky</surname></string-name>, and <string-name><given-names>Michel</given-names> <surname>Meunier</surname></string-name></person-group>. <article-title>Dynamic multispectral detection of bacteria with nanoplasmonic markers</article-title>. <source>Nanoscale</source>, <volume>15</volume>(<issue>7</issue>):<fpage>3309</fpage>–<lpage>3317</lpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Thomas R.</given-names> <surname>Powers</surname></string-name></person-group>. <article-title>Role of body rotation in bacterial flagellar bundling</article-title>. <source>Phys. Rev. E</source>, <volume>65</volume>:<fpage>040903</fpage>, <month>Apr</month> <year>2002</year>.</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Joshua R</given-names> <surname>Prindle</surname></string-name>, <string-name><given-names>Yibo</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>Julian M</given-names> <surname>Rocha</surname></string-name>, <string-name><given-names>Andreas</given-names> <surname>Diepold</surname></string-name>, and <string-name><given-names>Andreas</given-names> <surname>Gahlmann</surname></string-name></person-group>. <article-title>Distinct cytosolic complexes containing the type iii secretion system atpase resolved by three-dimensional single-molecule tracking in live yersinia enterocolitica</article-title>. <source>Microbiology Spectrum</source>, <volume>10</volume> (<issue>6</issue>):<fpage>e01744</fpage>–<lpage>22</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Ashkin</surname></string-name> and <string-name><given-names>J. M.</given-names> <surname>Dziedzic</surname></string-name></person-group>. <article-title>Optical trapping and manipulation of viruses and bacteria</article-title>. <source>Science</source>, <volume>235</volume>(<issue>4795</issue>):<fpage>1517</fpage>–<lpage>1520</lpage>, <year>1987</year>. doi: <pub-id pub-id-type="doi">10.1126/science.3547653</pub-id>.</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ido</given-names> <surname>Golding</surname></string-name> and <string-name><given-names>Edward C</given-names> <surname>Cox</surname></string-name></person-group>. <article-title>Physical nature of bacterial cytoplasm</article-title>. <source>Physical review letters</source>, <volume>96</volume>(<issue>9</issue>):<fpage>098102</fpage>, <year>2006</year>.</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Aubrey V</given-names> <surname>Weigel</surname></string-name>, <string-name><given-names>Blair</given-names> <surname>Simon</surname></string-name>, <string-name><given-names>Michael M</given-names> <surname>Tamkun</surname></string-name>, and <string-name><given-names>Diego</given-names> <surname>Krapf</surname></string-name></person-group>. <article-title>Ergodic and nonergodic processes coexist in the plasma membrane as observed by single-molecule tracking</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>108</volume>(<issue>16</issue>):<fpage>6438</fpage>–<lpage>6443</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jens</given-names> <surname>Ehrig</surname></string-name>, <string-name><given-names>Eugene P</given-names> <surname>Petrov</surname></string-name>, and <string-name><given-names>Petra</given-names> <surname>Schwille</surname></string-name></person-group>. <article-title>Near-critical fluctuations and cytoskeleton-assisted phase separation lead to subdiffusion in cell membranes</article-title>. <source>Biophysical journal</source>, <volume>100</volume>(<issue>1</issue>):<fpage>80</fpage>–<lpage>89</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Keith J</given-names> <surname>Mickolajczyk</surname></string-name> and <string-name><given-names>William O</given-names> <surname>Hancock</surname></string-name></person-group>. <article-title>Kinesin processivity is determined by a kinetic race from a vulnerable one-head-bound state</article-title>. <source>Biophysical journal</source>, <volume>112</volume>(<issue>12</issue>):<fpage>2615</fpage>–<lpage>2623</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>François</given-names> <surname>Simon</surname></string-name>, <string-name><given-names>Lucien E</given-names> <surname>Weiss</surname></string-name>, and <string-name><given-names>Sven</given-names> <surname>van Teeffelen</surname></string-name></person-group>. <article-title>A guide to single-particle tracking</article-title>. <source>Nature Reviews Methods Primers</source>, <volume>4</volume>(<issue>1</issue>):<fpage>66</fpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Maziar</given-names> <surname>Raissi</surname></string-name>, <string-name><given-names>Paris</given-names> <surname>Perdikaris</surname></string-name>, and <string-name><given-names>George E</given-names> <surname>Karniadakis</surname></string-name></person-group>. <article-title>Physics-informed neural networks: A deep learning framework for solving forward and inverse problems involving nonlinear partial differential equations</article-title>. <source>Journal of Computational physics</source>, <volume>378</volume>:<fpage>686</fpage>–<lpage>707</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Martin</given-names> <surname>Lindén</surname></string-name> and <string-name><given-names>Johan</given-names> <surname>Elf</surname></string-name></person-group>. <article-title>Variational algorithms for analyzing noisy multistate diffusion trajectories</article-title>. <source>Biophysical journal</source>, <volume>115</volume>(<issue>2</issue>): <fpage>276</fpage>–<lpage>282</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Lucien E</given-names> <surname>Weiss</surname></string-name>, <string-name><given-names>Julia F</given-names> <surname>Love</surname></string-name>, <string-name><given-names>Joshua</given-names> <surname>Yoon</surname></string-name>, <string-name><given-names>Colin J</given-names> <surname>Comerci</surname></string-name>, <string-name><given-names>Ljiljana</given-names> <surname>Milenkovic</surname></string-name>, <string-name><given-names>Tomoharu</given-names> <surname>Kanie</surname></string-name>, <string-name><given-names>Peter K</given-names> <surname>Jackson</surname></string-name>, <string-name><given-names>Tim</given-names> <surname>Stearns</surname></string-name>, and <string-name><given-names>Anna-Karin</given-names> <surname>Gustavsson</surname></string-name></person-group>. <chapter-title>Single-molecule imaging in the primary cilium</chapter-title>. In <source>Methods in Cell Biology</source> <person-group person-group-type="editor"><string-name><surname>Bravo-San Pedro</surname><given-names>JM</given-names></string-name>, <string-name><surname>Galluzzi</surname><given-names>L</given-names></string-name></person-group>, volume <volume>176</volume>, pages <fpage>59</fpage>–<lpage>83</lpage>. <publisher-name>Academic Press</publisher-name>, <year>2023</year>.</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Vincent</given-names> <surname>Briane</surname></string-name>, <string-name><given-names>Myriam</given-names> <surname>Vimond</surname></string-name>, <string-name><given-names>Cesar Augusto</given-names> <surname>Valades-Cruz</surname></string-name>, <string-name><given-names>Antoine</given-names> <surname>Salomon</surname></string-name>, <string-name><given-names>Christian</given-names> <surname>Wunder</surname></string-name>, and <string-name><given-names>Charles</given-names> <surname>Kervrann</surname></string-name></person-group>. <article-title>A sequential algorithm to detect diffusion switching along intracellular particle trajectories</article-title>. <source>Bioinformatics</source>, <volume>36</volume>(<issue>1</issue>):<fpage>317</fpage>–<lpage>329</lpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Carlo</given-names> <surname>Manzo</surname></string-name></person-group>. <article-title>Extreme learning machine for the characterization of anomalous diffusion from single trajectories (andi-elm)</article-title>. <source>Journal of Physics A: Mathematical and Theoretical</source>, <volume>54</volume>(<issue>33</issue>):<fpage>334002</fpage>, <month>jul</month> <year>2021</year>.</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Silvan</given-names> <surname>Türkcan</surname></string-name> and <string-name><given-names>Jean-Baptiste</given-names> <surname>Masson</surname></string-name></person-group>. <article-title>Bayesian decision tree for the classification of the mode of motion in single-molecule trajectories</article-title>. <source>PloS one</source>, <volume>8</volume>(<issue>12</issue>):<fpage>e82799</fpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Robert B</given-names> <surname>Davies</surname></string-name> and <string-name><given-names>David S</given-names> <surname>Harte</surname></string-name></person-group>. <article-title>Tests for hurst effect</article-title>. <source>Biometrika</source>, <volume>74</volume>(<issue>1</issue>):<fpage>95</fpage>–<lpage>101</lpage>, <year>1987</year>.</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Kathryn R</given-names> <surname>Ayscough</surname></string-name>, <string-name><given-names>Joel</given-names> <surname>Stryker</surname></string-name>, <string-name><given-names>Navin</given-names> <surname>Pokala</surname></string-name>, <string-name><given-names>Miranda</given-names> <surname>Sanders</surname></string-name>, <string-name><given-names>Phil</given-names> <surname>Crews</surname></string-name>, and <string-name><given-names>David G</given-names> <surname>Drubin</surname></string-name></person-group>. <article-title>High rates of actin filament turnover in budding yeast and roles for actin in establishment and maintenance of cell polarity revealed using the actin inhibitor latrunculin-a</article-title>. <source>Journal of Cell biology</source>, <volume>137</volume>(<issue>2</issue>):<fpage>399</fpage>–<lpage>416</lpage>, <year>1997</year>.</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Janka</given-names> <surname>Zsok</surname></string-name>, <string-name><given-names>Francois</given-names> <surname>Simon</surname></string-name>, <string-name><given-names>Göksu</given-names> <surname>Bayrak</surname></string-name>, <string-name><given-names>Luljeta</given-names> <surname>Isaki</surname></string-name>, <string-name><given-names>Nina</given-names> <surname>Kerff</surname></string-name>, <string-name><given-names>Amy</given-names> <surname>Wolstenholme</surname></string-name>, <string-name><given-names>Lucien E</given-names> <surname>Weiss</surname></string-name>, and <string-name><given-names>Elisa</given-names> <surname>Dultz</surname></string-name></person-group>. <article-title>The nuclear basket regulates the distribution and mobility of nuclear pore complexes in budding yeast</article-title>. <source>bioRxiv</source>, <year>2023</year>.</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Caroline A</given-names> <surname>Schneider</surname></string-name>, <string-name><given-names>Wayne S</given-names> <surname>Rasband</surname></string-name>, and <string-name><given-names>Kevin W</given-names> <surname>Eliceiri</surname></string-name></person-group>. <article-title>Nih image to imagej: 25 years of image analysis</article-title>. <source>Nature methods</source>, <volume>9</volume>(<issue>7</issue>): <fpage>671</fpage>–<lpage>675</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jean-Yves</given-names> <surname>Tinevez</surname></string-name>, <string-name><given-names>Nick</given-names> <surname>Perry</surname></string-name>, <string-name><given-names>Johannes</given-names> <surname>Schindelin</surname></string-name>, <string-name><given-names>Genevieve M</given-names> <surname>Hoopes</surname></string-name>, <string-name><given-names>Gregory D</given-names> <surname>Reynolds</surname></string-name>, <string-name><given-names>Emmanuel</given-names> <surname>Laplantine</surname></string-name>, <string-name><given-names>Sebastian Y</given-names> <surname>Bednarek</surname></string-name>, <string-name><given-names>Spencer L</given-names> <surname>Shorte</surname></string-name>, and <string-name><given-names>Kevin W</given-names> <surname>Eliceiri</surname></string-name></person-group>. <article-title>Trackmate: An open and extensible platform for single-particle tracking</article-title>. <source>Methods</source>, <volume>115</volume>:<fpage>80</fpage>–<lpage>90</lpage>, <year>2017</year>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99347.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Cui</surname>
<given-names>Qiang</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Boston University</institution>
</institution-wrap>
<city>Boston</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>In this <bold>valuable</bold> contribution, the authors present a novel and versatile probabilistic tool for classifying tracking behaviors and understanding parameters for different types of single-particle motion. The software package will be broadly applicable to single-particle tracking studies. The methodology has been <bold>convincingly</bold> tested by computational comparisons and experimental data, although the mathematical foundation for the hypothesis testing method can be further strengthened.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99347.2.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>Weiss and co-authors presented a versatile probabilistic tool. aTrack helps in classifying tracking behaviors and understanding important parameters for different types of single particle motion types: Brwonian, Confined, or Directed motion. The tool can be used further to analyze populations of tracks and the number of motion states. This is a stand-alone software package, making it user-friendly for a broad group of researchers.</p>
<p>Strengths:</p>
<p>This manuscript presents a novel method for trajectory analysis.</p>
<p>Comments on revisions:</p>
<p>The authors have strengthened and improved the manuscript</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99347.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors present a software package &quot;aTrack&quot; for identification of motion types and parameter estimation in single-particle tracking data. The software is based on maximum likelihood estimation of the time-series data given an assumed motion model and likelihood ratio tests for model selection. They characterized the performance of the software mostly on simulated data and showed that it is applicable to experimental data.</p>
<p>Strengths:</p>
<p>Although many tools exist in the single-particle tracking (SPT) field, this particular software package is developed using an innovative mathematical model and a probabilistic approach. It also provide inference of motion types, which are critical to answer biological questions in SPT experiments.</p>
<p>(1) The authors adopt a novel mathematical framework, which is unique in the SPT field.</p>
<p>(2) The authors have validated their method extensively using simulated tracks and compared to existing methods when appropriate.</p>
<p>(3) The code is freely available</p>
<p>Weaknesses:</p>
<p>The authors did a good job during the revision to address most of the weaknesses in my (as well as other reviewer's) first round of review. Nevertheless, the following issue is still not fully addressed.</p>
<p>
The hypothesis testing method presented here lacks rigorous statistical foundation. The authors improved on this point after the revision, but in their newly added SI section &quot;Statistical Test&quot;, only justified their choices using &quot;hand-waving&quot; arguments (i.e. there is not a single reference to proper statistical textbooks or earlier works in this important section). I understand that sometimes mathematical rigor comes later after some intuition-guided choices of critical parameters seems to work, but nevertheless need to point it out as a remaining weakness.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99347.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Simon</surname>
<given-names>François</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0737-2312</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Ramadier</surname>
<given-names>Guillaume</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5175-1643</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Fonquernie</surname>
<given-names>Inès</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0005-2872-7011</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Zsok</surname>
<given-names>Janka</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Patskovsky</surname>
<given-names>Sergiy</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7175-481X</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Meunier</surname>
<given-names>Michel</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2398-5602</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Boudoux</surname>
<given-names>Caroline</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2145-9086</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Dultz</surname>
<given-names>Elisa</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1114-5523</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Weiss</surname>
<given-names>Lucien E</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0971-7329</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>Summary:</p>
<p>Weiss and co-authors presented a versatile probabilistic tool. aTrack helps in classifying tracking behaviors and understanding important parameters for different types of single particle motion types: Brownian, Confined, or Directed motion. The tool can be used further to analyze populations of tracks and the number of motion states. This is a stand-alone software package, making it user-friendly for a broad group of researchers.</p>
<p>Strengths:</p>
<p>This manuscript presents a novel method for trajectory analysis.</p>
<p>Weaknesses:</p>
<p>(1) In the results section, is there any reason to choose the specific range of track length for determining the type of motion? The starting value is fine, and would be short enough, but do the authors have anything to report about how much is too long for the model?</p>
</disp-quote>
<p>We chose to test the range of track lengths (five-to-hundreds of steps) to cover the broad range of scenarios arising from single proteins or fluorophores to brighter objects with more labels.  While there is no upper-limit per se, the computation time of our method scales linearly with track length, 100 time-points takes ~2 minutes to run on a standard consumer-level desktop CPU. We have added the following sentence to note the time-cost with trajectory length:</p>
<p>“The recurrent formula enables our model computation time to scale linearly with the number of time points.”</p>
<disp-quote content-type="editor-comment">
<p>(2) Robustness to model mismatches is a very important section that the authors have uplifted diligently. Understanding where and how the model is limited is important. For example, the authors mentioned the limitation of trajectory length, do the authors have any information on the trajectory length range at which this method works accurately? This would be of interest to readers who would like to apply this method to their own data.</p>
</disp-quote>
<p>We agree that limitations are important to estimate, and trajectory length is an important consideration when choosing how to analyze a dataset. We report the categorization certainty, i.e. the likelihood differences, for a range of track lengths (Fig. 2 a,c, Fig. 3c-d, and Fig. 4 c,g.).</p>
<p>For example, here are the key plots from Fig. 2 quantifying the relative likelihoods, where being within the light region is necessary. The light areas represent a useful likelihood ratio.</p>
<p>We only performed analysis up to track lengths of 600 time steps but parameter estimations and significance can only improve when increasing the track length as long as the model assumptions are verified. The broader limitations and future opportunities for new methods are now expanded upon in the discussion, for example switching between states and model and state and model ambiguities (bound vs very slow diffusion vs very slow motion).</p>
<disp-quote content-type="editor-comment">
<p>(3) aTrack extracts certain parameters from the trajectories to determine the motion types. However, it is not very clear how certain parameters are calculated. For example, is the diffusion coefficient D calculated from fitting, and how is the confinement factor defined and estimated, with equations? This information will help the readers to understand the principles of this algorithm.</p>
</disp-quote>
<p>We apologize for the confusion. All the model parameters are fit using the maximum likelihood approach. To make this point clearer in the manuscript, we have made three changes:</p>
<p>(1) We modified the following sentence to replace “determined” with &quot;fit”:</p>
<p>“Finally, Maximum Likelihood Estimation (MLE) is used to fit the underlying parameter value”</p>
<p>(2) We added the following sentence in the main text :</p>
<p>“In our model, the velocity is the characteristic parameter of directed motion and the confinement factor represents the force within a potential well. More precisely, the confinement factor $l$ is defined such that at each time step the particle position is updated by $l$ times the distance particle/potential well center (see the Methods section for more details).”.</p>
<p>(3) We have added a new section in the methods, called Fitting Method, where we have added the explanation below:</p>
<p>“For the pure Brownian model, the parameters are the diffusion coefficient and the localization error. For the confinement model, the parameters are the diffusion coefficient, the localization error, confinement factor, and the diffusion coefficientof the potential well. For the directed model, the parameters are the diffusion coefficient, the localization error, the initial velocity and the acceleration variance.</p>
<p>These parameters are estimated using the maximum likelihood approach which consists in finding the parameters that maximize the likelihood. We realize this fitting step using gradient descent via a TensorFlow model. All the estimates presented in this article are obtained from a single set of initial parameters to demonstrate that the convergence capacity of aTrack is robust to the initial parameter values.”</p>
<disp-quote content-type="editor-comment">
<p>(4) The authors mentioned the scenario where a particle may experience several types of motion simultaneously. How do these motions simulated and what do they mean in terms of motion types? Are they mixed motion (a particle switches motion types in the same trajectory) or do they simply present features of several motion types? It is not intuitive to the readers that a particle can be diffusive (Brownian) and direct at the same time.</p>
</disp-quote>
<p>In the text, we present an example where one can observe this type of motion to help the reader understand when this type of motion can be met: “Sometimes, particles undergo diffusion and directed motion simultaneously, for example, particles diffusing in a flowing medium (Qian 1991).”</p>
<p>This is simulated by the addition of two terms affecting the hidden position variable before adding a localization term to create the observed variable. In the analysis, this manifests as non-zero values for the diffusion coefficient and the linear velocity. For example, Figure 4g and the associated text, where a single particle moves with a directed component and a Brownian diffusion component at each step.</p>
<p>We did not simulate transitions between types of motion. Switching is not treated by this current model; however, this limitation is described in the discussion and our team and others are currently working on addressing this challenge.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>Summary:</p>
<p>The authors present a software package &quot;aTrack&quot; for identification of motion types and parameter estimation in single-particle tracking data. The software is based on maximum likelihood estimation of the time-series data given an assumed motion model and likelihood ratio tests for model selection. They characterized the performance of the software mostly on simulated data and showed that it is applicable to experimental data.</p>
<p>Strengths:</p>
<p>A potential advantage of the presented method is its wide applicability to different motion types.</p>
<p>Weaknesses:</p>
<p>(1) There has been a lot of similar work in this field. Even though the authors included many relevant citations in the introduction, it is still not clear what this work uniquely offers. Is it the first time that direct MLE of the time-series data was developed? Suggestions to improve would include (a) better wording in the introduction section, (b) comparing to other popular methods (based on MSD, step-size statistics (Spot-On, eLife 2018;7:e33125), for example) using the simulated dataset generated by the authors, (c) comparing to other methods using data set in challenges/competitions (Nat. Comm (2021) 12:6253).</p>
</disp-quote>
<p>We thank the reviewer for this suggestion and agree that the explanation of the innovative aspects of our method in the introduction was not clear enough. We have now modified the introduction to better explain what is improved here compared to previous approaches.</p>
<p>“The main innovations of this model are: 1) it uses analytical recurrence formulas to perform the integration step for complex motion, improving speed and accuracy; 2) it handles both confined and directed motion; 3) anomalous parameters, such as the center of the potential well and the velocity vector are allowed to change through time to better represent tracks with changing directed motion or confinement area; and lastly 4) for a given track or set of tracks, aTrack can determine whether tracks can be statistically categorized as confined or directed, and the parameters that best describe their behavior, for example, diffusion coefficient, radius of confinement, and speed of directed motion.”</p>
<p>Regarding alternatives, we compare our method in the text to the best-performing algorithm of the</p>
<p>2021 Anomalous Diffusion (AnDi) Challenge challenge mentioned by the reviewer in Figure 6 (RANDI, Argun et al, arXiv, 2021, Muñoz-Gil et al, Nat Com. 2021). Notably, both methods performed similarly on fBm, but ours was more robust in cases where there were small differences between the process underlying the data and the model assumptions, a likely scenario in real datasets. Regarding Spot-On, this was not mentioned as it only deals with multiple populations of Brownian diffusers, preventing a quantitative comparison.</p>
<disp-quote content-type="editor-comment">
<p>(2) The Hypothesis testing method presented here has a number of issues: first, there is no definition of testing statistics. Usually, the testing statistics are defined given a specific (Type I and/or Type II) error rate. There is also no discussion of the specificity and sensitivity of the testing results (i.e. what's the probability of misidentification of a Brownian trajectory as directed? etc).</p>
</disp-quote>
<p>We now explain our statistical approach and how to perform hypothesis testing with our metric in a new supplementary section, Statistical test.</p>
<p>We use the likelihood ratio as a more conservative alternative to the p-value. In Fig S2, we show that our metric is an upper bound of the p-value and can be used to perform hypothesis testing with a chosen type I error rate.</p>
<p>Related, it is not clear what Figure 2e (and other similar plots) means, as the likelihood ratio is small throughout the parameter space. Also, for likelihood ratio tests, the authors need to discuss how model complexity affects the testing outcome (as more complex models tend to be more &quot;likely&quot; for the data) and also how the likelihood function is normalized (normalization is not an issue for MLE but critical for ratio tests).</p>
<p>We present the likelihood ratio as an upper bound of the p-value. Therefore, we can reject the null hypothesis if it is smaller than a given threshold, e.g. 0.05, but this number should be decreased if multiple tests are performed. The colorscale we show in the figure is meant to highlight the working range (light), and ambiguous range (dark) of the method.</p>
<p>As the reviewer mentions, we expect the alternative hypothesis to result in higher likelihoods than the simpler null hypothesis for null hypothesis tracks, but, as seen in the Fig S2, the likelihood ratio of a dataset corresponding to the null hypothesis is strongly skewed toward its upper limit 1. This means that for most of the tracks, the likelihood is not (or little) affected by the model complexity. The likelihoods of all the models are normalized so their integrals over the data equals 1/A with A the area of the field of view which is independent of the model complexity.</p>
<disp-quote content-type="editor-comment">
<p>(3) Relating to the mathematical foundation (Figure 1b). The measured positions are drawn as direct arrows from the real position states: this infers instantaneous localization. In reality, there is motion blur which introduces a correlation of the measured locations. Motion blur is known to introduce bias in SPT analysis, how does it affect the method here?</p>
</disp-quote>
<p>The reviewer raises an important point as our model does not explicitly consider motion blur. We have now added a paragraph that presents how our model performs in case of motion blur in the section called Robustness to model mismatches. This section and the corresponding new Supplemental Fig. S7 demonstrate that the estimated diffusion length is accurate so long as the static localization error is higher than the dynamic localization error. If the dynamic localization error is higher, our model systematically underestimates the diffusion length by a factor 0.81 = (2/3)<sup>0.5</sup> which can be corrected for with an added post-processing step.</p>
<disp-quote content-type="editor-comment">
<p>(4) The authors did not go through the interpretation of the figure. This may be a matter of style, but I find the figures ambiguous to interpret at times.</p>
</disp-quote>
<p>We thank the reviewer for their feedback on improving the readability. To avoid overly repetitive and lengthy sections of text, we have opted for a concise approach. This allows us to present closely related panels at the same point in the text, while not ignoring important variations and tests. Considering this feedback and the reviewers, we have added more information and interpretation throughout our manuscript to improve interpretability.</p>
<disp-quote content-type="editor-comment">
<p>(5) It is not clear to me how the classification of the 5 motion types was accomplished.</p>
</disp-quote>
<p>We have modified the specific text related to this figure to describe an illustrative example to show how one could use aTrack on a dataset where not that much is known: First, we present the method to determine the number of states; second, we verify the parameter estimates correspond to the different states.</p>
<p>Classifying individual tracks is possible. While not done in the section corresponding to Fig. 5, this is done in Fig. 7 and a new supplementary plot, Fig. S9b (shown below). In brief, this is accomplished with our method by computing the likelihood of each track given each state. The probability that a given track is in state k equals the likelihood of the track given the state divided by the sum of the likelihoods given the different states.</p>
<disp-quote content-type="editor-comment">
<p>(6) Figure 3. Caption: what is ((d_{est}-0.1)/0.1)? Also panel labeled as &quot;d&quot; should be &quot;e&quot;.</p>
</disp-quote>
<p>Thank you for bringing these errors to our attention, the panel and caption have been corrected.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public Review):</bold></p>
<p>Summary:</p>
<p>In this work, Simon et al present a new computational tool to assess non-Brownian single-particle dynamics (aTrack). The authors provide a solid groundwork to determine the motion type of single trajectories via an analytical integration of multiple hidden variables, specifically accounting for localization uncertainty, directed/confined motion parameters, and, very novel, allowing for the evolution of the directed/confined motion parameters over time. This last step is, to the best of my knowledge, conceptually new and could prove very useful for the field in the future. The authors then use this groundwork to determine the motion type and its corresponding parameter values via a series of likelihood tests. This accounts for obtaining the motion type which is statistically most likely to be occurring (with Brownian motion as null hypothesis). Throughout the manuscript, aTrack is rigorously tested, and the limits of the methods are fully explored and clearly visualised. The authors conclude with allowing the characterization of multiple states in a single experiment with good accuracy and explore this in various experimental settings. Overall, the method is fundamentally strong, wellcharacterised, and tested, and will be of general interest to the single-particle-tracking field.</p>
<p>Strengths:</p>
<p>(1) The use of likelihood ratios gives a strong statistical relevance to the methodology. There is a sharp decrease in likelihood ratio between e.g. confinement of 0.00 and 0.05 and velocity of 0.0 and 0.002 (figure 2c), which clearly shows the strength of the method - being able to determine 2nm/timepoint directed movement with 20 nm loc. error and 100 nm/timepoint diffusion is very impressive.</p>
</disp-quote>
<p>We apologize for the confusion, the directed tracks in Fig 2 have no Brownian-motion component, i.e. D=0. We have made this clearer in the main text. Specifically, this section of the text refers to a track in linear motion with 2 nm displacements per step. With 70 time points (69 steps), a single particle which moved from 138 nm with a localization error of 20 nm (95% uncertainty range of 80 nm) can be statistically distinguished from slow diffusive motion.</p>
<p>In Fig. 4g, we explore the capabilities of our method to detect if a diffusive particle also has a directed motion component.</p>
<disp-quote content-type="editor-comment">
<p>(2) Allowing the hidden variables of confinement and directed motion to change during a trajectory (i.e. the q factor) is very interesting and allows for new interpretations of data. The quantifications of these variables are, to me, surprisingly accurate, but well-determined.</p>
<p>(3) The software is well-documented, easy to install, and easy to use.</p>
<p>Weaknesses:</p>
<p>(1) The aTrack principle is limited to the motions incorporated by the authors, with, as far as I can see, no way to add new analytical non-Brownian motion. For instance, being able to add a dynamical stateswitching model (i.e. quick on/off switching between mobile and non-mobile, for instance, repeatable DNA binding of a protein), could be of interest. I don't believe this necessarily has to be incorporated by the authors, but it might be of interest to provide instructions on how to expand aTrack.</p>
</disp-quote>
<p>We agree that handling dynamic state switching is very useful and highlight this potential future direction in the discussion. The revised text reads:</p>
<p>“An important limitation of our approach is that it presumes that a given track follows a unique underlying model with fixed parameters. In biological systems, particles often transition from one motion type to another; for example, a diffusive particle can bind to a static substrate or molecular motor (46). In such cases, or in cases of significant mislinkings, our model is not suitable. However, this limitation can be alleviated by implicitly allowing state transitions with a hidden Markov Model (15) or alternatives such as change-point approaches (30, 47, 48), and spatial approaches (49).”</p>
<disp-quote content-type="editor-comment">
<p>(2) The experimental data does not very convincingly show the usefulness of aTrack. The authors mention that SPBs are directed in mitosis and not in interphase. This can be quantified and studied by microscopy analysis of individual cells and confirming the aTrack direction model based on this, but this is not performed. Similarly, the size of a confinement spot in optical tweezers can be changed by changing the power of the optical tweezer, and this would far more strongly show the quantitative power of aTrack.</p>
</disp-quote>
<p>We agree with the reviewer and have revised the biological experiment section significantly to better illustrate the potential of aTrack in various use cases.</p>
<p>Now, we show an experiment to quantify the effect of LatA, an actin inhibitor, on the fraction of directed tracks obtained with aTrack. We find that LatA significantly decreases directed motion while a LatA-resistant mutant is not affected (Fig7a-c).</p>
<p>As suggested by the reviewer, we have expanded the optical tweezer experiment by varying the laser power. As expected, increasing the laser power decreases the confinement radius.</p>
<disp-quote content-type="editor-comment">
<p>(3) The software has a very strict limit on the number of data points per trajectory, which is a user input. Shorter trajectories are discarded, while longer trajectories are cut off to the set length. It is not explained why this is necessary, and I feel it deletes a lot of useful data without clear benefit (in experimental conditions).</p>
</disp-quote>
<p>We thank the reviewer for this recommendation; we have now modified the architecture of our model to enable users to consider tracks of multiple lengths. Note that the computation time is proportional to the longest track length times the number of tracks.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p>
<p>Develop a better mathematical foundation for the likelihood ratio tests.</p>
</disp-quote>
<p>We added more explanation of the likelihood ratio tests and their interpretation a new section entitled Statistical test in the supplementary information to address this recommendation.</p>
<disp-quote content-type="editor-comment">
<p>Place this work in clearer contexts.</p>
</disp-quote>
<p>We have now revised the introduction to better contextualize this work.</p>
<disp-quote content-type="editor-comment">
<p>Improve manuscript clarity.</p>
</disp-quote>
<p>Based on reviewer feedback and input from others, we have addressed this point throughout the article to improve readability.</p>
<disp-quote content-type="editor-comment">
<p>Make the code available.</p>
</disp-quote>
<p>The code is available on <ext-link ext-link-type="uri" xlink:href="https://github.com/FrancoisSimon/aTrack">https://github.com/FrancoisSimon/aTrack</ext-link>, now including code for track generation.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p>
<p>(1) I believe the underlying model presented in Figure 1 is of substantial impact, especially when considering it as a simulation tool. I would suggest the authors make their method also available as a simulator (as far as I can tell, this is not explicitly done in their code repository, although logically the code required for the simulator should already be in the codebase somewhere).</p>
</disp-quote>
<p>Thank you for this suggestion, the simulation scripts are now on the Github repository together with the rest of the analysis method. <ext-link ext-link-type="uri" xlink:href="https://github.com/FrancoisSimon/aTrack">https://github.com/FrancoisSimon/aTrack</ext-link></p>
<disp-quote content-type="editor-comment">
<p>(2) The authors should explore and/or discuss the effects of wrong trajectory linking to their method. Throughout the text, fully correct trajectory linking is assumed and assessed, while in real experiments, it is often the case that trajectory linking is wrong, e.g. due to blinking emitters, imaging artefacts, high-density localizations, etc etc. This would have a major impact on the accuracy of trajectories, and it is extremely relevant to explore how this is translated to the output of aTrack.</p>
</disp-quote>
<p>As the reviewer notes, our current model does not account for track mislinking. This limits the method to data with lower fluorophore-densities, which is the typical use-case for SPT. We have added a brief description of the issue into the discussion of limitations.</p>
<disp-quote content-type="editor-comment">
<p>(3) aTrack only supports 2D-tracking, but I don't believe there is a conceptual reason not to have this expanded to three dimensions.</p>
</disp-quote>
<p>The stand-alone software is currently limited to 2D tracks, however, the aTrack Python package works for any number of dimensions (i.e. 1-3). Note that since the current implementation assumes a single localization error for all axes, more modifications may be required for some types of 3D tracking. See <ext-link ext-link-type="uri" xlink:href="https://github.com/FrancoisSimon/aTrack">https://github.com/FrancoisSimon/aTrack</ext-link> for more details about aTrack implementations.</p>
<disp-quote content-type="editor-comment">
<p>(4) Crucial information is missing in the experimental demonstrations. Especially in the NP-bacteria dataset, I miss scalebars, and information on the number of tracks. It is not explained why 5 different states are obtained - especially because I would naively expect three states: immobile NPs (e.g. stuck to glass), diffusing NPs, and NPs attached to bacteria, and thus directed. Figure 7e shows three diffusive states (why more than one?), no immobile states (why?), and two directed states (why?).</p>
</disp-quote>
<p>We thank the reviewer for pointing out these issues. We have now added scalebars and more experimental details to the figure and text as well as modifying the plot to more clearly emphasize the directed nanoparticles that are attached to cells from the diffusive nanoparticles.</p>
<p>Likely, our focal plane was too high to see the particles stuck on glass. The multiple diffusive states may be caused by different sizes of nanoparticle complexes, the multiple directed states can be caused by the fact that directed motion of the cell-attached-nanoparticles occasionally shows drastic changes of orientations. We have also clarified in the text how multiple states can help handle a heterogeneous population as was shown by Prindle et al. 2022, Microbiol Spectr. The characterization and phenotyping of microbial populations by nanoparticle tracking was published in Zapata et al. 2022, Nanoscale.</p>
<disp-quote content-type="editor-comment">
<p>(5) I don't think I agree that 'robustness to model mismatches' is a good thing. Very crudely, the fact that aTrack finds fractional Brownian motion to be normal Brownian motion is technically a downside - and this should be especially carefully positioned if (in the future) a fractional Brownian motion model would be added to aTrack. I think that the author's point can be better tested by e.g. widely varying simulated vs fitted loc precision/diffusion coefficient (which are somewhat interchangeable).</p>
</disp-quote>
<p>In this context, our intention in describing the robustness to “model mismatches” refers to classifying subdiffusion as subdiffusive irrespective of the exact subdiffusion motion physics (as well as superdiffusion), that is, to use aTrack how MSD analysis is often deployed. This is important in the context of real-world applications where simple mathematical models cannot perfectly represent real tracks with greater complexity.</p>
<p>Inevitably, some fraction of tracks with a pure Brownian motion may appear to match with a fractional Brownian motion, and thus statistical tests are needed to determine if this is significant. In general, aTrack finds fBm to be normal Brownian motion only when the anomalous coefficient is near 1, i.e. when the two models are indeed the same. When analysing fBm tracks with anomalous coefficients of 0.5 or 1.5, aTrack find that these tracks are better explained by our confined diffusion model or directed motion model, respectively (Please see Fig. 6a, copied below).</p>
<p>To better clarify our objective, the section now has a brief introduction that reads:</p>
<p>“One of the most important features of a method is its robustness to deviations from its assumptions. Indeed, experimental tracking data will inevitably not match the model assumptions to some degree, and models need to be resilient to these small deviations.”</p>
<disp-quote content-type="editor-comment">
<p>Smaller points:</p>
<p>(1) It is not clear what a biological example is of rotational diffusion.</p>
</disp-quote>
<p>We modified the text to better explain the use of rotational diffusion.</p>
<disp-quote content-type="editor-comment">
<p>(2) The text in the section on experimental data should be expanded and clarified, there currently are multiple 'floating sentences' that stop halfway, and it does not clearly describe the biological relevance and observed findings.</p>
</disp-quote>
<p>We thank the reviewer for pointing out this issue. We have reworked the experimental section to better and more clearly explain the biological relevance of the findings.</p>
<disp-quote content-type="editor-comment">
<p>(3) Caption of figure 3: 'd' should be 'e'.</p>
<p>(4) Caption of Figure 7: log-likelihood should be Lconfined - Lbrownian, I believe.</p>
<p>(5) Equation number missing in SI first sentence.</p>
<p>(6) Supplementary Figure 1 top part access should be Lc-Lb instead of Ld-Lb.</p>
</disp-quote>
<p>We have made these corrections, thank you for bringing them to our attention.</p>
</body>
</sub-article>
</article>