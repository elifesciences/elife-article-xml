<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">90624</article-id>
<article-id pub-id-type="doi">10.7554/eLife.90624</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.90624.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Supercomputer framework for reverse engineering firing patterns of neuron populations to identify their synaptic inputs</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5723-3217</contrib-id>
<name>
<surname>Chardon</surname>
<given-names>Matthieu K.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a10">10</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0211-9286</contrib-id>
<name>
<surname>Wang</surname>
<given-names>Y. Curtis</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Garcia</surname>
<given-names>Marta</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9274-2500</contrib-id>
<name>
<surname>Besler</surname>
<given-names>Emre</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2288-8672</contrib-id>
<name>
<surname>Beauchamp</surname>
<given-names>J. Andrew</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>D’Mello</surname>
<given-names>Michael</given-names>
</name>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Powers</surname>
<given-names>Randall K.</given-names>
</name>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1324-7278</contrib-id>
<name>
<surname>Heckman</surname>
<given-names>Charles J.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a8">8</xref>
<xref ref-type="aff" rid="a9">9</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Neuroscience, Northwestern University</institution>, Chicago, IL, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>Department of Electrical and Computer Engineering, California State University</institution>, Los Angeles, Los Angeles, CA, <country>USA</country></aff>
<aff id="a3"><label>3</label><institution>Argonne Leadership Computing Facility, Argonne National Laboratory</institution>, Lemont, IL, <country>USA</country></aff>
<aff id="a4"><label>4</label><institution>Department of Electrical Engineering, Northwestern University</institution>, Evanston, IL, <country>USA</country></aff>
<aff id="a5"><label>5</label><institution>Department of Biomedical Engineering, Northwestern University</institution>, Chicago, IL, <country>USA</country></aff>
<aff id="a6"><label>6</label><institution>Intel Corporation</institution>, Santa Clara, CA, <country>USA</country></aff>
<aff id="a7"><label>7</label><institution>Department of Physiology and Biophysics, University of Washington</institution>, Seattle, WA, <country>USA</country></aff>
<aff id="a8"><label>8</label><institution>Physical Medicine and Rehabilitation, Shirley Ryan Ability Lab</institution>, Chicago, IL, <country>USA</country></aff>
<aff id="a9"><label>9</label><institution>Physical Therapy and Human Movement Sciences, Northwestern University</institution>, Chicago, IL, <country>USA</country></aff>
<aff id="a10"><label>10</label><institution>Northwestern-Argonne Institute of Science and Engineering (NAISE)</institution>, Evanston, IL, <country>USA</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Elias</surname>
<given-names>Leonardo Abdala</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>State University of Campinas</institution>
</institution-wrap>
<city>Campinas</city>
<country>Brazil</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Poirazi</surname>
<given-names>Panayiota</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>FORTH Institute of Molecular Biology and Biotechnology</institution>
</institution-wrap>
<city>Heraklion</city>
<country>Greece</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>For correspondence: <email>m-chardon@northwestern.edu</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-09-28">
<day>28</day>
<month>09</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2023-12-20">
<day>20</day>
<month>12</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP90624</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-07-20">
<day>20</day>
<month>07</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-07-25">
<day>25</day>
<month>07</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.12.09.519818"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-09-28">
<day>28</day>
<month>09</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.90624.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.90624.1.sa2">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.90624.1.sa1">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.90624.1.sa0">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="author-comment" xlink:href="https://doi.org/10.7554/eLife.90624.1.sa3">Author Response:</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Chardon et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Chardon et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-90624-v2.pdf"/>
<abstract>
<title>Abstract</title><p>In this study, we develop new reverse engineering (RE) techniques to identify the organization of the synaptic inputs generating firing patterns of populations of neurons. We tested these techniques <italic>in silico</italic> to allow rigorous evaluation of their effectiveness, using remarkably extensive parameter searches enabled by massively-parallel computation on supercomputers. We chose spinal motoneurons as our target neural system, since motoneurons process all motor commands and have well established input-output properties. One set of simulated motoneurons was driven by 300,000+ simulated combinations of excitatory, inhibitory, and neuromodulatory inputs. Our goal was to determine if these firing patterns had sufficient information to allow RE identification of the input combinations. Like other neural systems, the motoneuron input-output system is likely non-unique. This non-uniqueness could potentially limit this RE approach, as many input combinations can produce similar outputs. However, our simulations revealed that firing patterns contained sufficient information to sharply restrict the solution space. Thus, our RE approach successfully generated estimates of the actual simulated patterns of excitation, inhibition, and neuromodulation, with variances accounted for ranging from 75% to 90%. It was striking that nonlinearities induced in firing patterns by the neuromodulation inputs did not impede RE, but instead generated distinctive features in firing patterns that aided RE. These simulations demonstrate the potential of this form of RE analysis. It is likely that the ever-increasing capacity of supercomputers will allow increasingly accurate RE of neuron inputs from their firing patterns from many neural systems.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>This is the latest revision of our article with eLife. We are currently in the post revision phase right before &quot;version of record&quot;.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Array electrodes that allow simultaneous recording of firing patterns of populations of neurons in mammals have transformed understanding of the computations implemented by neural networks during natural behaviors and the utilization of these computations for brain machine interfaces (<xref ref-type="bibr" rid="c8">Buonomano and Maass, 2009</xref>; <xref ref-type="bibr" rid="c9">Chandrasekaran et al., 2021</xref>; <xref ref-type="bibr" rid="c61">Stevenson et al., 2012</xref>; Steven-son and Kording, 2011; <xref ref-type="bibr" rid="c65">Vyas et al., 2020</xref>). However, to understand how a given neural network generates the firing patterns that implement these computations, it is necessary to understand the transformation of inputs to outputs by the constituent neurons. The net effect of ionotropic excitatory inputs in activating a neural circuit is likely to be strongly impacted by the pattern of inhibitory inputs arising from local interneurons and the effects of neuromodulatory inputs acting on G-protein coupled receptors (<xref ref-type="bibr" rid="c7">Binder et al., 2020</xref>; <xref ref-type="bibr" rid="c17">Goaillard and Marder, 2021</xref>; <xref ref-type="bibr" rid="c47">McCormick and Nusbaum, 2014</xref>). In-depth analyses of the resulting complex interactions require intracellular electrode techniques, but these are not yet feasible simultaneously in many neurons during a natural behavior. An alternative is reverse engineering (RE) the firing patterns recorded by arrays to identify the neurons’ inputs and properties.</p>
<p>Thus far, RE has been used to achieve several different goals, including estimation of circuit structures within simulations with simple neuron models (<xref ref-type="bibr" rid="c43">Lim et al., 2011</xref>; <xref ref-type="bibr" rid="c51">Pisokas, 2021</xref>; <xref ref-type="bibr" rid="c59">Rostro-Gonzalez et al., 2012</xref>) and estimation local field potentials from measurements of spiking patterns (<xref ref-type="bibr" rid="c62">Telenczuk et al., 2020</xref>; <xref ref-type="bibr" rid="c67">Yochum et al., 2019</xref>). In this study, our goal was to harness the computational power provided by implementation of realistic neuron models on a supercomputer to investigate the feasibility of reverse engineering these model firing patterns to identify the underlying organization of their simulated excitatory, inhibitory and neuromodulatory inputs. Successful RE of firing patterns into input organization would greatly advance the effectiveness of array recordings in identifying how neural circuits implement their computations.</p>
<p>RE of neural outputs into inputs faces a formidable barrier. Multiple neural systems have been shown to exhibit non-uniqueness, which is manifest as closely similar outputs being produced by many combinations of parameters specifying neuron properties and inputs (<xref ref-type="bibr" rid="c13">Edelman and Gally, 2001</xref>; <xref ref-type="bibr" rid="c46">Marder, 2012</xref>; <xref ref-type="bibr" rid="c57">Prinz et al., 2004</xref>). This set of parameters forms the “solution space” for that neural system (<xref ref-type="bibr" rid="c56">Prinz, 2010</xref>). Although likely advantageous for stability and resilience of neurons and circuits (<xref ref-type="bibr" rid="c17">Goaillard and Marder, 2021</xref>), a large solution space that contain many combinations of excitation, inhibition and neuromodulation may limit the effectiveness of RE. In addition, the parameters within the solution space may interact in complex, nonlinear ways (<xref ref-type="bibr" rid="c49">Mukunda and Narayanan, 2017</xref>). Neuromodulatory inputs, for example, may have highly nonlinear effects on how neurons process their ionotropic inputs (<xref ref-type="bibr" rid="c7">Binder et al., 2020</xref>; <xref ref-type="bibr" rid="c46">Marder, 2012</xref>; <xref ref-type="bibr" rid="c47">McCormick and Nusbaum, 2014</xref>). On the other hand, when neuronal output behaviors are complex, non-uniqueness may be reduced by the constraints of matching multiple outputs (<xref ref-type="bibr" rid="c49">Mukunda and Narayanan, 2017</xref>; <xref ref-type="bibr" rid="c66">Yang et al., 2022</xref>).</p>
<p>To reduce the impact of non-uniqueness, we chose a well-understood neural system for evaluation of RE, the motoneurons that transform all motor commands into signals for control of muscles (<xref ref-type="bibr" rid="c21">Heckman and Enoka, 2012</xref>). Motoneuron properties and inputs have been extensively studied using in situ voltage clamp methods in animal preparations, with a focus on neuromodulatory actions (<xref ref-type="bibr" rid="c21">Heckman and Enoka, 2012</xref>; <xref ref-type="bibr" rid="c23">Henneman and Mendell, 1981</xref>). This data set has enabled us to generate highly realistic motoneuron models (<xref ref-type="bibr" rid="c53">Powers et al., 2012</xref>; <xref ref-type="bibr" rid="c54">Powers and Heckman, 2017</xref>), which we have successfully implemented on a supercomputer for the present study. Furthermore, recent advances in flexible array electrode methods now allow measurement of firing patterns of populations of motoneurons in humans, due to the one-to-one relation between motoneuron action potentials and those of its innervated muscle fibers (<xref ref-type="bibr" rid="c25">Holobar et al., 2010</xref>; <xref ref-type="bibr" rid="c29">Hug et al., 2021</xref>; <xref ref-type="bibr" rid="c50">Negro et al., 2016</xref>). Consequently, RE of these population firing patterns may generate deep insights into the synaptic organization of motor commands in humans as well as other animals.</p>
<p>We used an ensemble modeling approach (<xref ref-type="bibr" rid="c56">Prinz, 2010</xref>) to determine how non-uniqueness and nonlinearity affected RE identification of the pattern of excitatory, inhibitory and neuromodulatory inputs that produces motor output. All studies were carried out <italic>in silico</italic>, so that both inputs and outputs were known and thus the effectiveness of RE could be accurately quantified. The supercomputer implementation of motoneuron models allowed us to thoroughly explore this input solution space, via more than 300,000 simulations of the effects of many input combinations on firing patterns. Our previous intracellular studies of motoneuron input-output functions suggest that motoneuron firing patterns contain substantial information about their inputs (<xref ref-type="bibr" rid="c30">Hyngstrom et al., 2008</xref>; <xref ref-type="bibr" rid="c37">Kuo et al., 2003</xref>; <xref ref-type="bibr" rid="c41">Lee and Heckman, 1999</xref>, <xref ref-type="bibr" rid="c40">1998a,b</xref>). We therefore hypothesized that RE of motoneuron firing patterns would effectively deal with the problems of non-uniqueness and would therefore identify a reasonably small solution space of input combinations. To assess the importance of information contained within neuron firing patterns for achieving a small solution space, we compared RE of motoneuron firing patterns to RE of the cumulative spike train (CST), an overall measure of motor output generated by summing all neuron firing patterns together, which has been shown to closely replicate the muscle electromyogram (EMG), which is directly related to muscle force. Our simulation results supported the hypothesis and demonstrated a much smaller solution space for RE of firing of neuron populations than for the CST.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Performance of the motoneuron models for integration of inputs</title>
<p>All simulations are run using a set of 20 model motoneurons designed to closely recreate behaviors documented in our extensive database of current and voltage clamp studies in motoneurons within animal preparations. These models were first developed in NEURON (<xref ref-type="bibr" rid="c24">Hines and Carnevale, 1997</xref>) for a previous study (<xref ref-type="bibr" rid="c54">Powers and Heckman, 2017</xref>) and have been implemented on a supercomputer for the present work (see Methods). Our goal of investigating the feasibility of RE of motoneuron firing patterns depends on accuracy of these motoneuron models. <italic><xref rid="fig1" ref-type="fig">Figure 1</xref></italic> illustrates the performance of our motoneuron models in realistically capturing the integration of excitatory (<xref rid="fig1" ref-type="fig">Figure 1A</xref>), neuromodulatory (<xref rid="fig1" ref-type="fig">Figure 1B</xref>) and inhibitory (<xref rid="fig1" ref-type="fig">Figure 1C</xref>) inputs. Each of these simulated behaviors are considered in the following subsections.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Summary plots showing the performance of the motoneuron pool model with respect to integration of inputs.</title><p><italic>A1</italic> - Shows a subset of 6 of the 20 MN in the pool given the same excitatory triangular input, the black trace above. The MN pool follows an orderly activation known as the Henneman’s size principle, showing that this MN model can transform a “common drive” into different MN activities (see section Common input structure, differences in motoneuron properties). <italic>A2</italic> - Shows the models ability to favor S-type vs F-type motoneuron within the pool. The orange [ω<sub>start</sub>, ω<sub>end</sub>] = [1, 2] Distribution favors the fast (F-type) motoneuron. The recruitment of theses F-type motoneurons (e.g. MN 11, MN 15 and MN 19) happens sooner and their maximum firing rates are higher with respect to their [ω<sub>start</sub>, ω<sub>end</sub>] = [1, 1] counterparts. For the slow (S-type) motoneurons the recruitment is the same but their max firing rates decrease with respect to their [ω<sub>start</sub>, ω<sub>end</sub>] = [1, 1] counterparts (see section Distribution of excitatory input to S vs F motoneurons). <italic>B</italic> - Shows our models ability to trigger PIC type behavior. For a neuromodulation level of 1.2 (max of range tested) and no inhibition, the motoneurons firing rates show a fast rise time, then attenuation, followed by sustained firing (see section Neuromodulation and excitatory input). <italic>C1 and C2</italic> - Shows the model’s ability to modulate the effects of neuromodulation with inhibition. C1 shows a inhibition in the “Push-Pull” or reciprocal configuration. C2 shows inhibition in the balanced configurations (see section Neuromodulation and inhibition).</p></caption>
<graphic xlink:href="519818v3_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2b">
<title>Common input structure, differences in motoneuron properties</title>
<p>A fundamental point in achieving accurate modeling of the outputs of a pool of motoneurons innervating a muscle is that they are subject to “common drive” (<xref ref-type="bibr" rid="c11">De Luca and Erim, 1994</xref>; <xref ref-type="bibr" rid="c15">Farina and Negro, 2015</xref>; <xref ref-type="bibr" rid="c21">Heckman and Enoka, 2012</xref>). As a result, motoneuron firing patterns for a specific task exhibit an overall similarity, which is likely essential for efficient force control (<xref ref-type="bibr" rid="c15">Farina and Negro, 2015</xref>). This point is important for RE, as common drive precludes independent inputs to each motoneuron. Firing patterns, however, are not identical. As in any biological system, noise is present, though this is relatively low in motoneurons (coefficient of variation during steady firing at about 10-20% (<xref ref-type="bibr" rid="c21">Heckman and Enoka, 2012</xref>)). We add noise to our excitatory synaptic conductances to match this level, as illustrated in <italic><xref rid="fig1" ref-type="fig">Figure 1A</xref></italic>1, which illustrates firing patterns of 5 of the 20 motoneuron models in response to a linearly rising and falling excitatory conductance. This figure also shows systematic differences in activation (i.e. recruitment) thresholds. These differences are due to systematic differences in intrinsic electrical thresholds for spiking of motoneurons, which generates an orderly activation (i.e. recruitment) sequence known as Henneman’s size principle (<xref ref-type="bibr" rid="c23">Henneman and Mendell, 1981</xref>). The size principle is essential for effective utilization of the slow (S) vs fast (F) muscle fibers, with motoneurons innervating slow fibers having the lowest thresholds. S units tend to reach higher firing rates than F units, which require more input to reach their higher thresholds so less is available for rate modulation (<xref ref-type="bibr" rid="c4">Beauchamp et al., 2022</xref>; <xref ref-type="bibr" rid="c10">De Luca and Contessa, 2012</xref>; <xref ref-type="bibr" rid="c28">Hu et al., 2013</xref>).</p>
</sec>
<sec id="s2c">
<title>Distribution of excitatory input to S vs F motoneurons</title>
<p>In addition to the pattern and amplitude of excitatory input, there is another important aspect of excitatory motor commands, which is that all excitatory inputs studied thus far project differentially to S vs. F motoneurons (<xref ref-type="bibr" rid="c52">Powers and Binder, 2001</xref>) (in contrast, inhibition tends to be uniform ((<xref ref-type="bibr" rid="c52">Powers and Binder, 2001</xref>; <xref ref-type="bibr" rid="c44">Lindsay and Binder, 1991</xref>) as does neuromodulation (<xref ref-type="bibr" rid="c40">Lee and Heckman, 1998</xref>a, <xref ref-type="bibr" rid="c41">1999</xref>). Descending inputs tend to generate larger synaptic currents in the F’s, especially the corticospinal input (<xref ref-type="bibr" rid="c52">Powers and Binder, 2001</xref>) (see Discussion). As yet only one input favors S motoneurons, but it is an essential one, monosynaptic Ia excitation from muscles spindles (<xref ref-type="bibr" rid="c19">Heckman and Binder, 1988</xref>). These differences, though, do not provide independent control of F motoneurons, much less of individual motoneurons, as common drive still dominates and recruitment still follows the size principle (<xref ref-type="bibr" rid="c20">Heckman and Binder, 1993</xref>). <italic><xref rid="fig1" ref-type="fig">Figure 1A</xref></italic>2 however shows that greater relative excitatory synaptic current in high threshold F motoneurons does tend to compress the range of recruitment thresholds and increase the steepness of rate modulation as input levels rise. This compression/steepening may thus provide RE sufficient information to identify the distribution of excitatory input to S vs F motoneurons and provide information on the relative roles of descending versus sensory input.</p>
</sec>
<sec id="s2d">
<title>Neuromodulation and excitatory input</title>
<p>We chose to focus on just one type of neuromodulation (see Methods), the monoaminergic input originating in the brainstem, because this system has proved to have particularly powerful effects on motoneuron excitability (<xref ref-type="bibr" rid="c22">Heckman et al., 2005</xref>; <xref ref-type="bibr" rid="c21">Heckman and Enoka, 2012</xref>). These monoaminergic axons form a dense and monosynaptic projection onto motoneurons throughout the spinal cord, with the synapses releasing either 5HT (axons originating in the caudal raphe nuclei) or NE (axons from the locus coeruleus) (<xref ref-type="bibr" rid="c3">Alvarez et al., 1998</xref>; <xref ref-type="bibr" rid="c26">Holstege and Kuypers, 1987</xref>; <xref ref-type="bibr" rid="c45">Maratta et al., 2015</xref>). Both 5HT and NE have multiple effects on motoneuron ion channels, but their strongest action is via facilitation of persistent inward currents (PICs) mediated by dendritic Ca channels (likely CaV 1.3) (<xref ref-type="bibr" rid="c7">Binder et al., 2020</xref>). Our motoneuron models have been fine tuned to accurately replicate the highly nonlinear interactions between PICs and excitatory inputs (<xref ref-type="bibr" rid="c54">Powers and Heckman, 2017</xref>). <italic><xref rid="fig1" ref-type="fig">Figure 1B</xref></italic> shows that, when brainstem neuromodulatory are moderately high and dendritic PICs become strong, three marked nonlinearities become apparent: an initial acceleration (due to PIC activation and consequent amplification of input), followed by attenuation (due to PIC depolarization of dendritic regions, which reduces excitatory driving force) and then hysteresis (offset at a lower level than onset, due to the prolongation of input). In this example, where a pure excitatory drive is applied with no background of inhibition, low threshold motoneurons continue firing long after the input returns to baseline (this is known as self-sustained firing). These nonlinearities are striking in comparison to the nearly linear behavior in the low neuromodulatory state (<xref rid="fig1" ref-type="fig">Figure 1A</xref>1).</p>
</sec>
<sec id="s2e">
<title>Neuromodulation and inhibition</title>
<p>Our models also accurately capture the very strong interaction of the PIC with inhibition. Even a small background of inhibition reduces PIC amplitudes (<xref ref-type="bibr" rid="c31">Hyngstrom et al., 2007</xref>; <xref ref-type="bibr" rid="c37">Kuo et al., 2003</xref>). <xref rid="fig1" ref-type="fig">Figure 1C</xref> shows that modulation of inhibitory input that is either reciprocally or proportionally organized with respect to excitation also dramatically alters the pattern of rate modulation. Reciprocal inhibition (<xref rid="fig1" ref-type="fig">Figure 1C</xref>1) tends to allow strong PIC expression with acceleration, attenuation and hysteresis, whereas proportional inhibition (<xref rid="fig1" ref-type="fig">Figure 1C</xref>2) tends to flatten rate modulation and reduce hysteresis (in fact, of all the patterns shown in <xref rid="fig1" ref-type="fig">Figure 1</xref>, C1 is closest to that seen in many human muscles (<xref ref-type="bibr" rid="c4">Beauchamp et al., 2022</xref>; <xref ref-type="bibr" rid="c21">Heckman and Enoka, 2012</xref>). Thus the nonlinearities in firing patterns are not a straightforward reflection of neuromodulatory input but instead result from a complex interaction between neuromodulation and inhibition.</p>
<p>Given the above effects of the organization of excitation, inhibition and neuromodulation on firing patterns, our RE effort targeted identification of the following aspects of excitation, inhibition and neuromodulation: amplitude and time course of excitation, distribution of excitation to S versus F motoneurons, amplitude and time course of inhibition (including the baseline level and then whether inhibition was proportional, constant or balanced) and level of neuromodulation from low to high.</p>
</sec>
<sec id="s2f">
<title>Ensemble modeling for Reverse Engineering</title>
<p>The concept for the RE approach we used is illustrated in <xref rid="fig2" ref-type="fig">Figure 2</xref>. The left portion shows the flow of motor commands from the brain, brainstem and spinal cord to motoneurons, which then activates a muscle. The muscle produces an output force. This force is due to the summed actions of recruited motor units, whose spike trains sum to produce an overall electrical signal (EMG). Our focus is on the spike trains themselves, which can be measured in both animals and humans. The pattern of average firing rate is obtained by summing the rates of all active units (see Methods) and is thus referred to as the cumulative spike train (CST) (righthand side, bottom). We then apply RE methods to both the CST and to individual motor unit firing patterns (right, middle), which, if successful, will allow us to estimate the temporal patterns and amplitudes of the three components of motor commands. Two hypothetical outcomes are illustrated. In both, a triangular form of excitation is applied. The push-pull scheme is a reciprocal organization in which a tonic level of inhibition decreases as excitation increases. The balanced scheme has the opposite organization, inhibition increasing in proportion to excitation. Neuromodulation is assumed to be constant but can varied widely in its level. Although the balanced scheme often is used to drive cortical neurons (<xref ref-type="bibr" rid="c6">Berg et al., 2007</xref>), it is unknown how these three components interact in motor commands to motoneurons.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Reverse Engineering Paradigm.</title><p>The left side shows a schematic of the input pathway to the MN pool and its subsequent connection to a muscle. The right side shows a schematic of our goal. Can we predict the 3 inputs of the MN pool given the firing pattern of the MN pool used to generate the muscle output? In the push-pull scheme at upper right, inhibition (red) decrease as excitation (green) increases. In contrast, inhibition increases with excitation in the balanced scheme. In this work we show that using the “MN Pool Firing Pattern” one is able to reverse engineer back to the MN pool inputs.</p></caption>
<graphic xlink:href="519818v3_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The ensemble modeling approach we utilize for RE begins with estimation of the trajectory of the excitatory motor command. The procedure is illustrated in <xref rid="fig3" ref-type="fig">Figure 3</xref>. We required all simulations to achieve the same overall output, a triangular waveform for CST (upper left; Methods for the match criterion). For each simulation, we specified the following properties of the input organization:
<list list-type="order">
<list-item><p>Distribution of excitatory input on to S vs F motoneurons (range of 0.5 to 2.5; at 0.5 the highest threshold type F motoneuron received half the average input of lowest threshold type S; at 2.5 the F received 2.5 times the input of the S).</p></list-item>
<list-item><p>Level of neuromodulation: range 0.8 to 1.2, specified in terms of the maximum conductance of the PIC.</p></list-item>
<list-item><p>Baseline level of inhibition: This was set to the lowest level that prevented the PIC from generating self-sustained firing (<xref rid="fig1" ref-type="fig">Figure 1B</xref> shows an example of motoneurons with strong selfsustained firing due to lack of sufficient inhibitory baseline)</p></list-item>
<list-item><p>Pattern of inhibition relative to excitation: This pattern was set to be linearly proportional to excitation via multipliers ranging from +0.7 to −0.7. <xref rid="fig1" ref-type="fig">Figure 1C</xref>1 and <xref rid="fig1" ref-type="fig">Figure 1C</xref>2 illustrate firing patterns resulting from maximum proportional inhibition (multiplier of +0.7) to maximal push-pull (−0.7). At 0.0, the baseline of inhibition remained constant.</p></list-item>
<list-item><p>A physiological level of synaptic noise (see Methods). The RMS value for this noise was the same in all simulations, but was regenerated 30 times to allow estimates of variance for each combination of the above 4 input properties.</p></list-item>
</list>
</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption><p>Schematic of the algorithm used to approximate the excitatory input needed to produce the triangular output from the motoneuron pool. The schematic resembles a classic controller schematic. The algorithm starts at the “Input to MN Pool” box where the light pink triangular input is used as the initial guess to the “Plant System” box. Using this initial input guess, the MN pool model calculates it first output, seen in the “System Output” box (light pink trace). This initial output is compared the “Reference” Box and the resulting error <italic>e</italic>(t) is fed into the “Controller” box. Based on this error the controller calculates a new guess for an input and the cycle is repeated until a satisfactory error is achieved (MSE &lt; 1 Hz<sup>2</sup>). The iterations are shown within the “Input to MN Pool” and “System Output” boxes along a left to right diagonal scheme to show the evolution of the traces produced by the algorithm. From iteration 0 to iteration <italic>n</italic> the input to the MN pool morphs to a highly non linear form to produce a linear output. Finally, this algorithm is repeated over a range of neuromodulation, inhibitory bias, inhibitory gain and exciatatory synaptic weights as shown in the “MN parameters” box. Taking all the iterations and combinations, the model was run at total of 6,300,000 times. See subsection Simulation protocol for details.</p></caption>
<graphic xlink:href="519818v3_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Then, for each simulation, we set the input and noise properties as above and then applied a triangular pattern of excitation to the motoneuron models, starting with a purely triangular form and modifying it in an iterative process until the CST of the motoneurons reproduced the linear target CST (<xref rid="fig3" ref-type="fig">Figure 3</xref>, flow diagram). We repeated these simulations with different sets of input parameters 315,000 times to form the ensemble model of the motor pool (see section Data preparation for parameter combination details). We used the resulting large data set for successful matches to the target CST to assess the feasibility of RE for both the CST and individual motoneuron firing patterns.</p>
</sec>
<sec id="s2g">
<title>Solution space for overall output</title>
<p>We hypothesized that the CST, which contains information only about the overall output trajectory, would have a large solution space. It was nonetheless surprising that our process for modifying the shape of the excitatory input command generated good matches to the target CST for every motor command combination we tried (all 315,000 of them (see section Data preparation)). However, as illustrated in by the progression of input forms in <xref rid="fig2" ref-type="fig">Figure 2</xref> and further elaborated in <xref rid="fig4" ref-type="fig">Figure 4</xref>, the potent amplification and large nonlinearities in firing patterns induced by PICs usually resulted in highly nonlinear excitatory commands being required to generate the linear CST. The excitatory conductance input that leads to a good match to the target firing rate typically shows a rapid increase to get recruitment started, followed by a drop off during the acceleration phase due to wide-spread PIC activation across the active motor units, followed by a more rapid increase to keep the average firing rate rising in the face of PIC rate saturation. The falling phase of the command was roughly the mirror image of the rising phase. This general trend is evident in all the examples in <xref rid="fig4" ref-type="fig">Figure 4</xref>.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4.</label>
<caption><p><italic>Top Row</italic> – shows the average and std excitatory input to the MN pool to produce the reference command (<xref rid="fig3" ref-type="fig">Figure 3</xref> – reference input). Each column has a different neuromodulation value from lowest (0.8) to highest (1.2). For this example, the inhibitory gain is set to zero and the excitatory weight distribution is equal across the pool (111 configuration - see section Excitatory distribution or MN weights). In short, the lower the neuromodulation the more linear the input command becomes however, the higher the excitatory values becomes. <italic>Bottom Row</italic> - shows the average and std excitation (solid) and inhibition (dotted) for the two extremes of inhibitory schemes (Push-Pull in green and Balanced in orange). Neuromodulation is set to 1.0 (middle of range tried) and the excitatory weight distribution is equal across the pool (111 configuration - see section Excitatory distribution or MN weights). The “Push-Pull” inhibitory scheme requires less overall drive to achieve the same output.</p></caption>
<graphic xlink:href="519818v3_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>As expected, as the level of neuromodulation increased, these nonlinear trends increased, but less excitation is required to achieve the same global output. The examples in upper half of <italic>Fig-ure 4</italic> assumed inhibition was constant. The lower left example in <xref rid="fig4" ref-type="fig">Figure 4</xref> shows examples of the effects of different organizations of inhibition. Much higher levels of excitation are needed to counteract inhibition when it varies in proportion to the excitatory command (balanced inhibition, red traces), then when it varies inversely (push-pull inhibition, green traces). To quantify the effects of neuromodulation and inhibition on the overall amplitude of excitation, we calculated the area under the curve for the excitation patterns as neuromodulation and inhibition varied. <xref rid="fig5" ref-type="fig">Figure 5</xref> shows that the amount of excitation required to generate the standard CST target decreased as neuromodulation increased or as inhibition progressively changed from proportional to push-pull. Thus, although the solution space for reproducing the target CST is very wide, encompassing the full range of neuromodulation and inhibition investigated, achieving this wide range required large changes in the pattern and amplitude of the excitatory drive.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5.</label>
<caption><p>Area under the curve for the excitatory inputs calculated by the algorithm (<xref rid="fig3" ref-type="fig">Figure 3</xref> and Methods). <italic>Left</italic> - Shows the area under the curve of the excitatory input with respect to neuromodulation and inhibitory levels (color scheme). There inhibitory levels are clearly segregated across the neurmodulation range. The most efficient inhibitory scheme is “Push-Pull” (−0.7) and the least is “Balanced” (0.7). <italic>Right</italic> - shows the area under the curve of the excitatory input with respect to inhibiton for three neurmodulation level. The curves for each neuromodulation level do not intersect across the range of inhibition. The overall trend resembles the results on the left where the most efficent scheme is for high neurmodulation (1.2) and a “Push-Pull” inhibition (−0.7). These curves were calculated using an equally weighted excitatory input.</p></caption>
<graphic xlink:href="519818v3_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2h">
<title>The solution space for firing patterns of motor units</title>
<p>If each of patterns of excitation, neuromodulation and inhibition that generated the the standard triangular CST generated highly similar motoneuron firing patterns, then the solution spaces for each set of firing patterns would each be large. This firing pattern similarity however did not occur. The heat map in <xref rid="fig6" ref-type="fig">Figure 6</xref> provides a quantitative analysis of one of the main differences in motor unit firing patterns, onset-offset hysteresis (this hysteresis was quantified by the Δ<italic>F</italic> method developed for studies of real motor unit firing patterns in humans (<xref ref-type="bibr" rid="c18">Gorassini et al., 2002</xref>) (see Methods and <xref rid="fig7" ref-type="fig">Figure 7</xref>)). The differences in neuromodulation and inhibition produced a huge range of hysteretic firing behaviors, ranging from &lt; 1.0 at low neuromodulation levels coupled to strong proportional inhibition (lower left in <xref rid="fig6" ref-type="fig">Figure 6</xref>) to &gt; 7.0 for high neuromodulation and strong reciprocal inhibition. <xref rid="fig6" ref-type="fig">Fig. 6</xref> also shows the simulated firing patterns generated by a subset of these combinations (arrows link these patterns to the hysteresis values). As neuromodulation increases, PIC effects (acceleration, attenuation, hysteresis) increase, with push-pull inhibition emphasizing these effects and balanced inhibition suppressing them. These differences for each combination of neuromodulation and inhibition shown in <xref rid="fig6" ref-type="fig">Figure 6</xref> demonstrate that the solution space for matching a particular set of motor unit firing is much more restricted than for matching the overall CST (see <xref rid="fig4" ref-type="fig">Figure 4</xref> and <xref rid="fig5" ref-type="fig">Figure 5</xref>).</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6.</label>
<caption><p>This figure links the firing rate shapes of the MN pool model to the inhibitory and neuromodulatory search space. <italic>Heat Map</italic> - The central figure is a heat map of the mean Δ<italic>F</italic> values of the MN pool model calculated using the firing rate patterns of the motoneurons in the MN pool model (see section Feature Extraction). These Δ<italic>F</italic> values are organized along the neuromodulation (x-axis) and inhibitory values (y-axis) used in the simulations. <italic>Firing Rate Plots</italic> - Emanating from the central figure are a subset of the firing rate plots of the MN pool model given a specific Inhibitory and Neuromodulation set (e.g. (0.2, 0.9)). These plots are linked to a Δ<italic>F</italic> value with an arrow. For clarity, only a subset of motoneuron firing rates are shown. From visual inspection, the shape of the firing rates differ given the Inhibition and Neuromodulation pair, from more non-linear (e.g. (−0.7, 1.2)) to more linear (e.g. (0.2, 0.9))</p></caption>
<graphic xlink:href="519818v3_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7.</label>
<caption><p>Features extracted from the firing rate patterns of each of the motoneurons in the pool. We extracted the following 7 features: Recruitment Time (<italic>t</italic><sub><italic>rec</italic></sub>), De-Recruitment Time (<italic>t</italic><sub><italic>drec</italic></sub>), Activation Duration (<italic>t</italic><sub><italic>dur</italic></sub>), Recruitment Range (<italic>t</italic><sub><italic>range</italic></sub>), Firing Rate Saturation (α<sub><italic>sat</italic></sub>), Firing Rate Hysteresis (Δ<italic>F</italic>) and brace–height (brace–height). These features are then used to estimate the neuromodulation, inhibition and excitatory weights of the motor pool (see section Machine learning inference of motor pool characteristics and Regression using motoneuron outputs to predict input organization). See subsection Feature Extraction for details on how to extract features.</p></caption>
<graphic xlink:href="519818v3_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Note however there is some degree of trade-off for effects of inhibition and neuromodulation on hysteresis along the diagonals in <xref rid="fig6" ref-type="fig">Figure 6</xref>. Fortunately, hysteresis is not the only index of motoneuron firing behaviors. <xref rid="fig7" ref-type="fig">Figure 7</xref> illustrates additional features of motoneuron firing patterns that are easily measured and likely to reflect other effects of excitation, inhibition and neuromodulation. These features include firing rate acceleration and attenuation (which are also driven by actions of neuromodulation and inhibition on PICs – see <xref rid="fig1" ref-type="fig">Figure 1C</xref>1 and <xref rid="fig1" ref-type="fig">Figure 1C</xref>2) as well as recruitment and de-recruitment behaviors (sensitive to the distribution of excitation and S vs F motoneurons – see <xref rid="fig1" ref-type="fig">Figure 1A</xref>2). Each of these other characteristics had patterns of variation with respect to inhibition and neuromodulation that varied in comparison to each other and to hysteresis. Therefore, to quantify the effectiveness of RE of motor unit firing patterns to predict the organization of synaptic inputs, we next used multiple regression methods to determine how well combinations of these characteristics of simulated firing properties predicted the level of neuromodulation, the patterns of inhibition and the distribution of excitation to low verse high threshold motoneurons.</p>
</sec>
<sec id="s2i">
<title>Regression using motoneuron outputs to predict input organization</title>
<p>We utilized several different types of linear regression techniques (see Methods) and one nonlinear technique (Support Vector Regression using a radial basis function kernel (RBF)). In each case, the regression parameters were calculated from a subset of the data (∼70% of the total) and then used to predict the remaining subset (∼30%). For neuromodulation, all regression methods were similar in their effectiveness.</p>
<p><xref rid="fig8" ref-type="fig">Figure 8A</xref> shows the results for standard linear regression (the dashed red line has slope = 1.0 to indicate perfect predictive performance). For each level of neuromodulation (0.8 to 1.2), the vertical scatter is due to various combinations of the pattern of inhibition (which ranged from 0.7 to −0.7, as is in <xref rid="fig6" ref-type="fig">Figure 6</xref>) and of the distribution of excitation to low versus high threshold motoneurons (which ranged 0.5 to 2.5). The scatter is considerable, but there is also a tendency for points to cluster near the line. As a result, the regression relation accounts for 76% of the variance (i.e. <italic>R</italic><sup>2</sup> = 0.76; <bold><xref rid="tbl1" ref-type="table">Table 1</xref></bold> shows the <italic>R</italic><sup>2</sup> values for all regression methods for prediction of neuromodulation, inhibition and the distribution of excitation). Thus, prediction of the level of neuromodulation is good and indicates that this regression approach can identify the level of neuromodulation with a resolution of about 0.1 units of neuromodulation within the range 0.8 to 1.2.</p>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure">
<label>Figure 8.</label>
<caption><p>Residual plots showing the goodness of fit of the different predicted values: (A) Inhibition, (B) Neuromodulation and (C) excitatory Weight Ratio. The summary plots are for the models showing highest <italic>R</italic><sup>2</sup> results in <bold><xref rid="tbl1" ref-type="table">Table 1</xref></bold>. The predicted values are calculated using the features extracted from the firing rates (see <xref rid="fig7" ref-type="fig">Figure 7</xref>, section Machine learning inference of motor pool characteristics and Regression using motoneuron outputs to predict input organization). Diagram (D) shows the multidimensionality of the RE models (see Model fits) which have 7 feature inputs (see Feature Extraction) predicting 3 outputs (Inhibition, Neuromodulation and Weight Ratio).</p></caption>
<graphic xlink:href="519818v3_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title><italic>R</italic><sup>2</sup> values. Rows are the predicted values.</title><p>Columns are the models. The <italic>R</italic><sup>2</sup> values in bold represents the best model fit: Inhibition is best predicted using the RBF SVM model, Neuromodulation is best predicted by the Ridge model, Excitation Weight Ratio is best predicted by the RBF SVM model.</p></caption>
<graphic xlink:href="519818v3_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>For inhibition, the nonlinear regression was most effective, giving the results shown in <xref rid="fig8" ref-type="fig">Figure 8B</xref>. Variance accounted for is 0.85, implying a prediction resolution of about 0.23 units of a range of 1.4 units of inhibition. Finally, <xref rid="fig8" ref-type="fig">Figure 8C</xref> shows the regression results for prediction of the relative weighting ratio for the motoneuron pool, implying that characteristics of motor unit firing patterns can predict input structure with variances accounted for ranging from 76-91%.</p>
<p>As a final step, we analyzed which motor unit firing characteristics had the most predictive power in identifying each of the three input organizations. <xref rid="fig9" ref-type="fig">Figure 9</xref> provides two perspectives on this question. The left column shows results of step-wise regression, starting with the characteristic with the strongest predictive power and then progressively adding the others. For neuromodulation, all regression methods behaved similarly, in that the first two characteristics (brace-height and Δ<italic>F</italic> see <xref rid="fig7" ref-type="fig">Figure 7</xref>) was highly effective in reducing error in the regression prediction, with little addition benefit from adding the others. For inhibition prediction via the linear regression models, Δ<italic>F</italic> was most effective, followed by α<sub><italic>sat</italic></sub>, with all others being ineffective. This is shown in the mutual information ranking (right side) in <xref rid="fig9" ref-type="fig">Figure 9</xref>, which ranks the characteristics (features) by contribution of new information to the regression model. The left side of <xref rid="fig9" ref-type="fig">Figure 9</xref> ranks the features by the F-statistic, which does not necessarily imply that new information is introduced into the regression model. This is shown by the very subtle improvements in the error (mean squared error) as features are cumulatively added to the regression model, until <italic>t</italic><sub><italic>drec</italic></sub> and α<sub><italic>sat</italic></sub> are added to the model.</p>
<fig id="fig9" position="float" orientation="portrait" fig-type="figure">
<label>Figure 9.</label>
<caption><p>Shows the impact of the features on the models at predicting Inhibition, Neuromodulation and the excitatory Weight Ratios. The plots are split along two columns showing two types of complementary analysis: F-Statistic (left) and Mutual Information (right). <italic>Left</italic> - The left column shows the impact of the features on the MSE as ranked by their <italic>F</italic> value. The effect of the features are cumulative along the x-axis such that the value of the MSE at a given position in the x-axis is calculated using the features up to that point. Each of the colored traces represent one of the models used to predict the 3 outcomes and follows the trends found in <bold><xref rid="tbl1" ref-type="table">Table 1</xref></bold>. <italic>Right</italic> - The right column shows the mutual information of each feature with respect to the outcome: Inhibition, Neuromodulation and exciatory Weight Ratio (Top to Bottom). The features are ranked from best to worst along the x-axis. The ranking matches the MSE ranking in the right column. See section Ranking features to see details on how these techniques were implemented.</p></caption>
<graphic xlink:href="519818v3_fig9.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>However, the nonlinear regression method (RBF SVR) was more effective than any of the linear methods. For this method, each of the firing characteristics had a notable effect in reducing error. For linear regression for prediction of excitation, <italic>t</italic><sub><italic>drec</italic></sub> (the average time when units were derecruited) was the most impactful and adding the other characteristics brought little improvement.</p>
<p>The right column in <xref rid="fig9" ref-type="fig">Figure 9</xref> shows mutual information for each characteristic, which reflects how well each one predicts the input behaviors on its own. As expected, the order of effectiveness of prediction in these plots is identical to that for the step-wise regression.</p>
<p>Overall, neuromodulation is best predicted by brace-height and Δ<italic>F</italic>. Inhibition is also predicted by Δ<italic>F</italic> while <italic>brace–height</italic> is ineffective. Excitation (excitatory weight ratio) is best predicted by parameters that assess recruitment and derecruitment timings and less informed in prediction by Δ<italic>F</italic> and <italic>brace–height</italic>. These different roles for RE prediction of input make sense in terms of the physiological effects of the three types of inputs on motoneuron firing patterns (see Discussion).</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Our simulation shows that the solution space for a motor output variable that reflects the net action of all active motoneurons is indeed very broad. The variable investigated here, the cumulative spike train (CST), has been shown to be closely proportional to muscle EMG and muscle force (<xref ref-type="bibr" rid="c63">Thompson et al., 2018</xref>), which are widely assessed in experimental paradigms in both animals and humans. Our simulations however indicate that RE analyses of CSTs, EMGs and forces are likely to fail due to the problem of non-uniqueness. In contrast, motoneuron firing patterns provide a much greater level of information about motoneuron inputs. Our simulations showed that the solution space for a set of motoneuron firing patterns is reasonably small, allowing predictions that account for 75-90% of the variance in the level of neuromodulation, the pattern of inhibition and the distribution of excitation to S vs F motoneurons.</p>
<sec id="s3a">
<title>Generalization</title>
<p>Array electrodes are extensively used in many parts of the CNS to record firing patterns of populations of neurons in awake behaving animals (see Introduction). Moreover, highly realistic models of neurons and their interconnections in many systems are already available and undergoing rapid development, including supercomputer implementation (<xref ref-type="bibr" rid="c14">Einevoll et al., 2019</xref>). Since models and firing patterns are the fundamental elements for success of RE in the simulations presented here, this same type of approach may be effective in many other neural systems. In each neural system, however, success of RE of firing patterns into input structures as simulated here is likely to depend on the particular interactions between neuromodulation, inhibition and excitation. For motoneurons the nonlinearities induced by PICs in motoneuron firing patterns have proven to be a major advantage for RE. These nonlinearities impart distinctive characteristics to firing patterns (acceleration, attenuation, hysteresis – see <xref rid="fig1" ref-type="fig">Figure 1C</xref>1, the firing pattern at the upper right in <italic>Figure 6</italic>), which are easy to quantify (see <xref rid="fig7" ref-type="fig">Figure 7</xref>). Moreover, because the PIC is highly sensitive to inhibition, these same firing characteristics provided effective indices of the temporal pattern of inhibition. Furthermore, because these relations between neuromodulation and inhibition were different for each firing characteristic (see Supporting Information Figure S1), multiple regression using these characteristics was effective. It seems likely that if motoneurons were nearly linear input output processors, non-uniqueness would be a much greater problem for RE.</p>
</sec>
<sec id="s3b">
<title>Push-Pull vs Balance Motor Command</title>
<p>As we defined earlier (see section Ensemble modeling for Reverse Engineering) our model explores range of possible combinations of excitatory and inhibitory motor commands from push-pull to balanced, for a motoneuron pool to produce a triangular ramp output (<xref rid="fig2" ref-type="fig">Figure 2</xref>). The push-pull scheme is a reciprocal organization in which a tonic level of inhibition decreases as excitation in-creases. The balanced scheme has the opposite organization, inhibition increasing in proportion to excitation (see <italic>Powers and Heckman</italic> (2017), <xref ref-type="bibr" rid="c32">Johnson et al. (2017)</xref> for full reviews detailing both types of schemes). The question remains, which of these schemes is being used in normal human motor behavior? Based on our results we would speculate that the most likely scheme would be push-pull, as the upper right motoneuron pool discharge pattern shown in <xref rid="fig6" ref-type="fig">Figure 6</xref> seem the most realistic when compared to human data from the lower limb (see for example <xref ref-type="bibr" rid="c4">Beauchamp et al. (2022)</xref>, <xref ref-type="bibr" rid="c2">Afsharipour et al. (2020)</xref>). We have however emphasized that different muscles might require different types of motor commands schemes (<xref ref-type="bibr" rid="c32">Johnson et al., 2017</xref>) and herein lies the power of this RE technique as the experimenter can use the RE approach detailed here to identify the scheme that best fits their human data.</p>
</sec>
<sec id="s3c">
<title>Muscle EMG versus single motor unit firing patterns</title>
<p>Muscle EMG is the electrical signal generated by the summed action potentials of the muscle fibers of all active motor units. EMG is easy to measure in many types of motor behaviors in humans and other animals and provides an effective measurement of the timing and overall pattern of the neural output from the spinal cord to muscle. However, the simulations here and in our previous work (<xref ref-type="bibr" rid="c53">Powers et al., 2012</xref>; <xref ref-type="bibr" rid="c54">Powers and Heckman, 2017</xref>) show that EMG does not provide information about the organization of motor commands that produce spinal motor output. On the other hand, because motoneurons action potentials are one-to-one with those of their muscle fibers in healthy humans and other animals, motor unit firing patterns are equivalent to motoneuron firing patterns. While motor unit firing patterns are more technically difficult to measure than whole muscle EMG, the accessibility of muscle makes these measurements highly feasible. In fact, motor unit firing patterns in humans were recorded at the very onset of single neuron studies, over 90 years ago (<xref ref-type="bibr" rid="c1">Adrian and Bronk, 1929</xref>). The likelihood that this single neuron information provide deep insights into the structure of motor commands has thus long been appreciated (<xref ref-type="bibr" rid="c12">Duchateau and Enoka, 2011</xref>). Many such studies were essential for establishing the prevalence of Henneman’s size principle of recruitment (reviewed in <italic>Heckman and Enoka</italic> (2012)). Many studies also focused on inferring the time course of EPSPs and IPSPs driving motoneuron responses to transient ionotropic inputs during steady contractions (reviewed in <italic>Türker and Powers</italic> (2005)). The distinctive effects of PICs on firing have also been a focus, with the Δ<italic>F</italic> method developed by Gorassini and colleagues for quantifying PIC-induced hysteresis having become a standard in the field <italic>Gorassini et al.</italic> (2002). However, intracellular current and voltage clamp studies have demonstrated that the PIC is highly sensitive both to neuromodulatory input (<xref ref-type="bibr" rid="c27">Hounsgaard et al., 1988</xref>; <xref ref-type="bibr" rid="c42">Lee and Heckman, 2000</xref>, <xref ref-type="bibr" rid="c41">1999</xref>) and inhibition (<xref ref-type="bibr" rid="c30">Hyngstrom et al., 2008</xref>; <xref ref-type="bibr" rid="c37">Kuo et al., 2003</xref>). Consistent with this, Δ<italic>F</italic> does not provide good discrimination of neuromodulation versus inhibition in our simulations (<xref rid="fig9" ref-type="fig">Figure 9</xref>). In contrast, and consistent with our previous study (<xref ref-type="bibr" rid="c5">Beauchamp et al. (2023)</xref>), the brace–height parameter was sensitive to neuromodulation but insensitive to inhibition, likely because it is normalized for peak firing. In general, our simulations show that no one motor unit firing characteristic is sufficient for estimation of input structure and thus a form of RE is necessary.</p>
</sec>
<sec id="s3d">
<title>Limitations</title>
<p>Ensemble model approaches for RE are obviously reliant on the biological accuracy of the constituent models. Our models have been carefully tuned to replicate experimental data from years of current and voltage clamp studies of the integration of neuromodulatory, inhibitory and excitatory inputs motoneurons in feline preparations. We made a few adjustments to these models to more closely replicate the slow firing rates in human motor units but will likely need to further adjust parameters like the spike AHP and the PIC voltage threshold. Our RE was not applied for identification of the amplitude or time course of the excitation. The peak excitatory conductance for each simulation strongly depends on the level of neuromodulation and the pattern of inhibition (<xref rid="fig4" ref-type="fig">Figure 4</xref>). This correlation was built into our simulations to match the CST for each combination of neurmodulation/inhibition and so excitation was not an independent parameter. Further simulations in which we relax this constraint or allow inhibition and/or neuromodulation to vary for a given pattern of excitation may prove interesting. It will also be interesting to expand our range of neuromodulation. At the high end, this expansion will have to be limited, as controlling such large PICs is difficult. But exploring whether RE works as at lower neuromodulation levels where input-output processing is nearly linear would reveal whether this simpler behavior limits RE effectiveness.</p>
</sec>
<sec id="s3e">
<title>Summary &amp; Future Application</title>
<p>Although our models likely need modification before we begin RE of human motor unit firing patterns, they were well situated to the goal of this study, which was to investigate the feasibility of RE of neuron firing patterns despite the strong tendency for neural systems to be non-unique. In addition, it would seem that the success of our RE approach suggests that this technique can be used to gain insight into the motor commands underlying different motor unit firing patterns associated with different motor tasks with or without disease states (e.g., <italic>Mottram et al.</italic> (2014)).</p>
</sec>
</sec>
<sec id="s4">
<title>Methods and Materials</title>
<sec id="s4a">
<title>Motoneuron pool model</title>
<p>The motoneuron pool consists of 20 model motoneurons with a range of intrinsic properties. This motonouron pool size was chosen to reflect the typical sample size of motor units discriminated based on surface EMG array recordings. Each model motoneuron consisted of a soma compartment and four dendritic compartments, each coupled to the soma. The passive properties of the compartments, such as, size, capacitance and passive conductance were derived from works by described by Kim and colleagues (<xref ref-type="bibr" rid="c34">Kim et al. (2009)</xref>; <xref ref-type="bibr" rid="c33">Kim and Jones (2012)</xref>). Spike conductances (<italic>g</italic><sub><italic>Na</italic></sub> and <italic>g</italic><sub><italic>K</italic></sub>) and conductances mediating the medium AHP were inserted into the soma compartment and a calcium conductance mediating the slowly-activating persistent inward current (PIC) was inserted into each of the dendritic compartments. In addition, a hyperpolarization-activated mixedcation (HCN) conductance was inserted into all compartments. Conductance densities, kinetics and steady-state activation curves were originally tuned to recreate the range of input-output behavior recorded in medial gastrocnemius (MG) motoneurons in decerebrate cats, as described in <italic>Powers and Heckman</italic> (2017). We made four modifications to model parameters for the cat MG pool in order to produce the lower firing rates and less than full recruitment typically observed during moderate voluntary contractions in human subjects. First, the range of values governing excitability were restricted to the first 75% of the original recruitment range (i.e., the parameters of motoneuron 20 in the new model corresponded to motoneuron 15 in the original parameter set). Second, AHP durations and amplitudes were increased by increasing the values of the time constant of calcium removal for the calcium-activated potassium conductance (from 60 to 10 ms in the original model to 90 to 57 ms). The larger and longer AHPs acted to oppose early PIC activation during increasing excitatory synaptic drive, so we hyperpolarized the PIC half-activation threshold (from −40 to −37 mV in the original model to −42 to −40.4 mV). Finally, in the original model the slow decay of PICs observed in high threshold MG motoneurons (<xref ref-type="bibr" rid="c38">Lee and Heckman, 1996</xref>) was replicated by including a voltage-dependent inactivation process. We found that this process limited the firing rate hysteresis to values below those typically seen in human motor unit recordings, so we eliminated PIC inactivation in the present model pool. All simulations were run using the Python interface to the NEURON simulator (<xref ref-type="bibr" rid="c24">Hines and Carnevale, 1997</xref>). NEURON files specifying motoneuron pool parameters, conductance mechanisms, and protocols on ModelDB with accession number 239582.</p>
</sec>
<sec id="s4b">
<title>Simulation protocol</title>
<sec id="s4b1">
<title>Inputs to the motoneuron pool</title>
<p>The target motoneuron pool output, representing the average firing rate across the entire pool of 20 motoneurons was 22 seconds in length and consisted of 1 sec delay followed by a linear rise to a peak value of 16 imp/s over the next 10 sec, and a linear decline back to zero in 10 sec (<xref rid="fig3" ref-type="fig">Figure 3</xref>, Reference <italic>Ref). A scaled version of this command,<italic>I</italic><sub><italic>ex</italic></sub> = 0.6<italic>Ref</italic>, (<xref rid="fig3" ref-type="fig">Figure 3</xref>, light salmon colored with the value 0 to its bottom left) was used as the first guess of the time course of the excitatory input needed to produce the target output. For each iteration an inhibitory conductance input (I</italic><sub><italic>in</italic></sub>) was also applied according to the following equation:
<disp-formula id="eqn1">
<graphic xlink:href="519818v3_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where the excitatory input<italic>I</italic><sub><italic>ex</italic></sub> is multiplied by a gain <italic>G</italic><sub><italic>in</italic></sub> and biased by <italic>b</italic><sub><italic>in</italic></sub> as defined by:
<disp-formula id="eqn2">
<graphic xlink:href="519818v3_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>R</italic><sub><italic>mod</italic></sub> is the neuromodulation value, set in this work, from 0.8 to 1.2 at increments of 0.1 (i.e. [0.8:0.1:1.2]). The inhibition is therefore coupled to the neuromodulation through its bias, <italic>b</italic><sub><italic>in</italic></sub>, and was set to value just sufficient to ensure PIC deactivation at the end of the command. The inhibitory gain, <italic>G</italic><sub><italic>in</italic></sub>, is varied from −0.7 to 0.7 in increments of 0.1 thus traversing the possible control schemes push-pull inhibition to balanced inhibition. Example of both control schemes can be seen in <xref rid="fig2" ref-type="fig">Figure 2</xref> (green for excitatory and red for inhibitory).</p>
<p>Changes in neuromodulation were simulated by changing the density of dendritic PIC channels: from 80% to 120% of the standard density in 10% increments. Mathematically, the MN model was altered by changing the current<italic>I</italic><sub><italic>Ca</italic></sub> of the L-type calcium channel according to these equations:
<disp-formula id="eqn3">
<graphic xlink:href="519818v3_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn4">
<graphic xlink:href="519818v3_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where<italic>I</italic><sub><italic>Ca</italic></sub> is the current for L-type calcium channel, <italic>g</italic><sub><italic>Ca</italic></sub> is the conductance of the L-type calcium channel, <italic>m</italic><sub><italic>Ca</italic></sub> is the activation gate, <italic>V</italic> is the compartment voltage, and <italic>E</italic><sub><italic>Ca</italic></sub> is the reversal potential for the L-type calcium channel. <italic>R</italic><sub><italic>mod</italic></sub> is the gain factor that changes the maximum conductance – <italic>g</italic>-<sub><italic>CaL</italic></sub> – of the L-type Calcium channel with the following values [0.8, 0.9, 1.0, 1.1, 1.2].</p>
<p>Finally, filtered Gaussian noise was added to both the excitatory and inhibitory commands with a standard deviation that varied in proportion to the square root of the mean level and a decay time constant of 20 ms to reflect the fact that most of the power in the synaptic input to motoneurons is thought to be in the low frequency (&lt; 10 Hz) range (<xref ref-type="bibr" rid="c16">Farina et al., 2014</xref>).</p>
</sec>
</sec>
<sec id="s4c">
<title>Feedback and optimization</title>
<p>We used an iterative optimization procedure to find the motoneuron pool input needed to produce the “Reference” output as shown in <xref rid="fig3" ref-type="fig">Figure 3</xref>. We opted for a feedback type of optimization method to converge onto the solution.</p>
<p>For the feedback to work, an error term is calculated between the output of the MN pool and the “Reference” (see the “Controller” <xref rid="fig3" ref-type="fig">Figure 3</xref>). The output of the MN pool is the average of the 20 MN pool calculated by convolving each model spike train with a 2-s Hanning window with unit area, adding up the result across all 20 spike trains and dividing by 20:
<disp-formula id="eqn5">
<graphic xlink:href="519818v3_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where<italic>I</italic><sub><italic>ex</italic></sub> is the new excitatory input, <italic>n</italic> is the iteration in the feedback loop, <italic>F</italic> (t)<sub><italic>i</italic></sub> is the firing rate of a MN <italic>i</italic> = [0 ∶ 20] in the 20 MN pool, <italic>H</italic>(t) is the 2-s Hanning window, <italic>e</italic>(t) is the error and <italic>K</italic> is the proportional gain (usually 20%). The resulting<italic>I</italic><sub><italic>ex</italic></sub> (the average firing rate response) plus the error <italic>e</italic>(t) is then used as the new excitatory command to the MN Pool. This is shown by the series of traces leaving the “Plant System - Motoneuron (MN) pool” in <xref rid="fig3" ref-type="fig">Figure 3</xref>. Using<italic>I</italic><sub><italic>ex</italic></sub>, a new inhibitory command is also calculated using equation 1 and is subsequently used in the new computational iteration <italic>n</italic>.</p>
<p>This process was repeated until the mean squared error between the output and the target was less than 1 Hz<sup>2</sup> (generally less than 0.5 Hz<sup>2</sup>). In the case shown in <xref rid="fig3" ref-type="fig">Figure 3</xref>, good convergence was reached by the fifth iteration.</p>
<p>This iterative matching procedure was repeated for 225 different input combinations: five levels of neuromodulation, three different distributions of excitatory input, and fifteen different levels of inhibition.</p>
</sec>
<sec id="s4d">
<title>Excitatory distribution or MN weights</title>
<p>The density of the excitatory synaptic conductance was either uniform across all cells, weighted toward low threshold units (synaptic weight onto lowest threshold unit 2 X that of highest threshold unit), or weighted toward high threshold units (high weight 2X low). The parameters governing cell excitability were skewed to produce a greater proportion of low threshold units, so synaptic weighting showed a similar skew according to the following equation:
<disp-formula id="eqn6">
<graphic xlink:href="519818v3_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where ω<sub><italic>MN</italic>#</sub> is the weight of the given motoneuron, #<italic>MN</italic> is the number of the MN in the pool (e.g. 20), ω<sub>end</sub> and ω<sub>start</sub> are the weight range. For weights favoring low threshold units, ω<sub>start</sub> = 2.5 and ω<sub>end</sub> = 1.0 and for the opposite ω<sub>start</sub> = 1.0 and ω<sub>end</sub> = 2.5. In total we used 7 different types of weight configurations: [ω<sub>start</sub>, ω<sub>end</sub>] ⟺ [1, 1], [1.5, 1], [2, 1], [2.5, 1], [1, 1.5], [1, 2], [2.5, 1].</p>
</sec>
<sec id="s4e">
<title>Noise Seed</title>
<p>We chose to calculate the model using 30 different noise seeds. We assumed that each seed would represent a “unique” individual and allow for the use of averages and variance in our interpretation of the results. <italic>Note</italic>: The noise seed was not reset for each of motoneurons in the pool. The synaptic noise is thus coupled for each of the motoneurons which fits with the “common drive” argument (see section Common input structure, differences in motoneuron properties).</p>
</sec>
<sec id="s4f">
<title>Massively-parallel Data Generation Methods</title>
<p>Since the majority of the simulation is able to operate independently as the simulations for each of the parameter sets (noise seeds, inhibitory gains, and neuromodulation) did not need to feed into each other, we were able to run this simulation in a perfectly parallel way. Each unique parameter set was simulated using one node (computer) in a supercomputing cluster, which produced a dataset file of the simulation results (see Algorithm 1 in Supporting Information). Each node simulated one motor pool, with the computation of each motoneuron run on each processor on the compute node (see Algorithm 2 in Supporting Information). To implement this setup, we utilized the MPI interface in NEURON 7.7 <italic>Hines and Carnevale</italic> (1997) and Python 3.6.7 running on the Bebop supercomputer (Intel Broadwell nodes) at Argonne National Laboratory, (Supplementary Figure 2). Each combination tuple tuple_comb contains a particular ginmult, nmmult, ginadd, and random_seed (if noise is used).</p>
</sec>
<sec id="s4g">
<title>Feature Extraction</title>
<p>For each simulation input combination, we analyzed the individual motoneuron discharge patterns to extract 7 features: Recruitment Time (<italic>t</italic><sub><italic>rec</italic></sub>), De-Recruitment Time (<italic>t</italic><sub><italic>drec</italic></sub>), Activation Duration (<italic>t</italic><sub><italic>dur</italic></sub>), Recruitment Range (<italic>t</italic><sub><italic>range</italic></sub>), Firing Rate Saturation (α<sub><italic>sat</italic></sub>), Firing Rate Hysteresis (Δ<italic>F</italic>) and brace–height (brace–height). The calculation of these quantitative measures is illustrated in <xref rid="fig7" ref-type="fig">Figure 7</xref>, which shows the instantaneous discharge rates (dots) of a higher (upper panel) and lower threshold (lower threshold) motoneuron, along with the smoothed firing rates calculated by convolving the spike times with a 2-s Hanning window (continuous lines).</p>
<p><italic>Recruitment Time</italic> (<italic>t</italic><sub><italic>rec</italic></sub>): Recruitment time is the time of the first instantaneous discharge rate of a given motorneuron.</p>
<p><italic>De-Recruitment Time</italic> (<italic>t</italic><sub><italic>drec</italic></sub>): De-Recruitment time is the time of the last instantaneous discharge of a given motoneuron.</p>
<p><italic>Activation Duration</italic> (<italic>t</italic><sub><italic>dur</italic></sub>): Activation duration is the difference between de-recruitment time and recruitment time:
<disp-formula id="eqn7">
<graphic xlink:href="519818v3_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<p><italic>Recruitment Range</italic> (<italic>t</italic><sub><italic>range</italic></sub>): The recruitment range is the difference between the recruitment time of the last and the first motorneuron in the motorpool.</p>
<p><italic>Firing Rate Saturation</italic> (α<sub><italic>sat</italic></sub>): The motorneuron firing rate is characterized by an initial acceleration phase that lasts about 1s followed by partial saturation of firing rate. The degree of this saturation is quantified by calculating the rate of firing rate increase from 1 sec after recruitment to the target peak (11 s):
<disp-formula id="eqn8">
<graphic xlink:href="519818v3_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>f</italic><sub>3</sub> is the firing rate at 11 s, <italic>f</italic><sub>2</sub> is the firing rate 1 s post recruitment (<italic>t</italic><sub><italic>rec</italic></sub>), <italic>t</italic><sub>3</sub> is time at target peak 11 s and <italic>t</italic><sub>2</sub> is 1 s post recruitment.</p>
<p><italic>Firing Rate Hysteresis</italic> (Δ<italic>F</italic>): A motorneuron rate hysteresis can be quantified using the Δ<italic>F</italic> measure introduced by Gorassini and colleagues (<xref ref-type="bibr" rid="c18">Gorassini et al., 2002</xref>). Δ<italic>F</italic> is defined as the difference in the smoothed firing rate of a lower threshold reporter motorneuron (<xref rid="fig7" ref-type="fig">Figure 7</xref> - bottom) at the onset (<italic>t</italic><sub><italic>rec</italic></sub>, <italic>f</italic><sub>0</sub>) and offset (<italic>t</italic><sub><italic>drec</italic></sub>, <italic>f</italic><sub>1</sub>) of the higher threshold motorneuron (<xref rid="fig7" ref-type="fig">Figure 7</xref> - top):
<disp-formula id="eqn9">
<graphic xlink:href="519818v3_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<p><italic>brace–height</italic> (<italic>brace</italic> − ℎ<italic>eig</italic>ℎ<italic>t</italic>): Brace height is a measure of the non-linear portion of the rising phase of the firing rate of the motoneuron (see <xref rid="fig7" ref-type="fig">Figure 7</xref> - top trace). It is the maximum perpendicular distance from the line linking the firing rates at recruitment time (<italic>t</italic><sub><italic>rec</italic></sub>) to <italic>t</italic><sub>3</sub>, the time at which the triangular “Reference” reaches its maximum (11 s). This distance is calculate by solving the geometric problem of finding the “Distance from a point to a line”. This analysis is further detailed by <xref ref-type="bibr" rid="c5">Beauchamp et al. (2023)</xref>.</p>
<p>We restricted the calculation to motorneuron pairs for which the recruitment time difference between the two was more than 1 s. This restriction was imposed to ensure that PIC activation in the reporter unit had reached near steady state, so that further changes in reporter discharge rate primarily reflected changes in synaptic drive (cf. <italic>Powers et al.</italic> (2008)).</p>
</sec>
<sec id="s4h">
<title>Machine learning inference of motor pool characteristics</title>
<sec id="s4h1">
<title>Data preparation</title>
<p>We ran the model for a range of neuromodulation (5), inhibition (15), excitatory weights (7) and noise seeds (30) for a total of 15,750 combinations. Given 20 motoneuron per pool and 20 optimization iterations (see <xref rid="fig3" ref-type="fig">Figure 3</xref> or section Feedback and optimization we ran a grand total of 6,300,000 simulations.</p>
<p>Post simulations, we extracted the features from the firing rates of each motoneuron (see section Feature Extraction and organized them according to the neuromodulation, inhibition, excitatory weight and noise seed. We then first calculated the average of these features accordingly and then took an average of these averages with respect to the noise seed. In final, the was an average of the features grouped by neurmodulation, inhibition and excitatory weight. Supplementary Figure 1 shows the average of each feature in a heat map configuration for the excitatory weight distribution [ω<sub>start</sub>, ω<sub>end</sub>] = [1, 1]. This data was the used subsequently (see section Model fits and Ranking features).</p>
</sec>
</sec>
<sec id="s4i">
<title>Model fits</title>
<p>One of the goals of our RE approach is to infer the characteristics of the input to the motoneuron pool based on our measures of motor unit output. The numeric features extracted from the discharge patterns are used to create five-dimensional input data for the models. The dimensions were the mean Δ<italic>F</italic> value, times of recruitment (<italic>t</italic><sub><italic>rec</italic></sub>) and derecruitment (<italic>t</italic><sub><italic>drec</italic></sub>), the firing rate saturation degree (α<sub><italic>sat</italic></sub>), the recruitment range (<italic>t</italic><sub><italic>range</italic></sub>) and brace–height (<italic>brace</italic> − ℎ<italic>eig</italic>ℎ<italic>t</italic>). The target values to predict were the simulation input values, namely level of neuromodulation, inhibition, and excitatory weight. Since all target values to be predicted in this study were continuous numeric values, the RE process was posed as a regression task.</p>
<p>Since the dataset is relatively small (&lt;1000 instances) and has only 5 dimensions, linear methods and kernel methods were chosen for predictive analysis. More complex models, such as tree-based methods and neural networks, were omitted due to inadequate training data instances and interpretability. Linear regression models using standard least-squares, Lasso, Ridge, and ElasticNet methods, and support vector models using linear and radial basis function kernels were created for each simulation input value to be predicted using the mean squared error as the minimization cost function.</p>
</sec>
<sec id="s4j">
<title>Ranking features</title>
<p>To measure the performance of linear regression against the firing features (see section Feature Extraction), we use a greedy approach towards incorporating more and more features into the linear regression model. For this approach, the F-statistic (linear regression test) is used as the scoring function to order-rank the features for incorporation into a linear regression model.</p>
<p>We used mutual information (MI) (<xref ref-type="bibr" rid="c58">Ross, 2014</xref>; <xref ref-type="bibr" rid="c36">Kraskov et al., 2004</xref>; <xref ref-type="bibr" rid="c35">Kozachenko and Leonenko, 1987</xref>) to rank the dependence of the firing rate features (see section Feature Extraction) to the inhibition, neuromodulation and excitatory weight ratio levels of the motoneurons in the pool model.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>This research used resources of the Argonne Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC02-06CH11357. We gratefully acknowledge the computing resources provided on Bebop, a high-performance computing cluster operated by the Laboratory Computing Resource Center at Argonne National Laboratory. This research was supported by the National Institute of Neurological Disorders and Stroke of the National Institutes of Health under awards R01NS062200 and R01NS125863. We also gratefully acknowledge Rochelle O. Bright for proofreading this work.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Adrian</surname> <given-names>ED</given-names></string-name>, <string-name><surname>Bronk</surname> <given-names>DW</given-names></string-name>. <article-title>The discharge of impulses in motor nerve fibres: Part II. The frequency of discharge in reflex and voluntary contractions</article-title>. <source>The Journal of physiology</source>. <year>1929</year>; <volume>67</volume>(<issue>2</issue>):<fpage>i3</fpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Afsharipour</surname> <given-names>B</given-names></string-name>, <string-name><surname>Manzur</surname> <given-names>N</given-names></string-name>, <string-name><surname>Duchcherer</surname> <given-names>J</given-names></string-name>, <string-name><surname>Fenrich</surname> <given-names>KF</given-names></string-name>, <string-name><surname>Thompson</surname> <given-names>CK</given-names></string-name>, <string-name><surname>Negro</surname> <given-names>F</given-names></string-name>, <string-name><surname>Quinlan</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Bennett</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Gorassini</surname> <given-names>MA</given-names></string-name>. <article-title>Estimation of self-sustained activity produced by persistent inward currents using firing rate profiles of multiple motor units in humans</article-title>. <source>Journal of Neurophysiology</source>. <year>2020</year>; <volume>124</volume>(<issue>1</issue>):<fpage>63</fpage>–<lpage>85</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Alvarez</surname> <given-names>FJ</given-names></string-name>, <string-name><surname>Pearson</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Harrington</surname> <given-names>D</given-names></string-name>, <string-name><surname>Dewey</surname> <given-names>D</given-names></string-name>, <string-name><surname>Torbeck</surname> <given-names>L</given-names></string-name>, <string-name><surname>Fyffe</surname> <given-names>RE</given-names></string-name>. <article-title>Distribution of 5-hydroxytryptamine-immunoreactive boutons on α-motoneurons in the lumbar spinal cord of adult cats</article-title>. <source>Journal of Comparative Neurology</source>. <year>1998</year>; <volume>393</volume>(<issue>1</issue>):<fpage>69</fpage>–<lpage>83</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Beauchamp</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Khurram</surname> <given-names>OU</given-names></string-name>, <string-name><surname>Dewald</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>, <string-name><surname>Pearcey</surname> <given-names>GE</given-names></string-name>. <article-title>A computational approach for generating continuous estimates of motor unit discharge rates and visualizing population discharge characteristics</article-title>. <source>Journal of Neural Engineering</source>. <year>2022</year>; <volume>19</volume>(<issue>1</issue>):<fpage>016007</fpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Beauchamp</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Pearcey</surname> <given-names>GE</given-names></string-name>, <string-name><surname>Khurram</surname> <given-names>OU</given-names></string-name>, <string-name><surname>Chardon</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>YC</given-names></string-name>, <string-name><surname>Powers</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Dewald</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>. <article-title>A geometric approach to quantifying the neuromodulatory effects of persistent inward currents on individual motor unit discharge patterns</article-title>. <source>Journal of Neural Engineering</source>. <year>2023</year>;.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Berg</surname> <given-names>RW</given-names></string-name>, <string-name><surname>Alaburda</surname> <given-names>A</given-names></string-name>, <string-name><surname>Hounsgaard</surname> <given-names>J</given-names></string-name>. <article-title>Balanced inhibition and excitation drive spike activity in spinal half-centers</article-title>. <source>Science</source>. <year>2007</year>; <volume>315</volume>(<issue>5810</issue>):<fpage>390</fpage>–<lpage>393</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Binder</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Powers</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>. <article-title>Nonlinear input-output functions of motoneurons</article-title>. <source>Physiology</source>. <year>2020</year>; <volume>35</volume>(<issue>1</issue>):<fpage>31</fpage>–<lpage>39</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Buonomano</surname> <given-names>DV</given-names></string-name>, <string-name><surname>Maass</surname> <given-names>W</given-names></string-name>. <article-title>State-dependent computations: spatiotemporal processing in cortical networks</article-title>. <source>Nature Reviews Neuroscience</source>. <year>2009</year>; <volume>10</volume>(<issue>2</issue>):<fpage>113</fpage>–<lpage>125</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Chandrasekaran</surname> <given-names>S</given-names></string-name>, <string-name><surname>Fifer</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bickel</surname> <given-names>S</given-names></string-name>, <string-name><surname>Osborn</surname> <given-names>L</given-names></string-name>, <string-name><surname>Herrero</surname> <given-names>J</given-names></string-name>, <string-name><surname>Christie</surname> <given-names>B</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Murphy</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Singh</surname> <given-names>S</given-names></string-name>, <string-name><surname>Glasser</surname> <given-names>MF</given-names></string-name>, <etal>et al.</etal> <article-title>Historical perspectives, challenges, and future directions of implantable brain-computer interfaces for sensorimotor applications</article-title>. <source>Bioelectronic medicine</source>. <year>2021</year>; <volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>De Luca</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Contessa</surname> <given-names>P</given-names></string-name>. <article-title>Hierarchical control of motor units in voluntary contractions</article-title>. <source>Journal of neurophysiology</source>. <year>2012</year>; <volume>107</volume>(<issue>1</issue>):<fpage>178</fpage>–<lpage>195</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>De Luca</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Erim</surname> <given-names>Z</given-names></string-name>. <article-title>Common drive of motor units in regulation of muscle force</article-title>. <source>Trends in neurosciences</source>. <year>1994</year>; <volume>17</volume>(<issue>7</issue>):<fpage>299</fpage>–<lpage>305</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Duchateau</surname> <given-names>J</given-names></string-name>, <string-name><surname>Enoka</surname> <given-names>RM</given-names></string-name>. <article-title>Human motor unit recordings: origins and insight into the integrated motor system</article-title>. <source>Brain research</source>. <year>2011</year>; <volume>1409</volume>:<fpage>42</fpage>–<lpage>61</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Edelman</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Gally</surname> <given-names>JA</given-names></string-name>. <article-title>Degeneracy and complexity in biological systems</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2001</year>; <volume>98</volume>(<issue>24</issue>):<fpage>13763</fpage>–<lpage>13768</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Einevoll</surname> <given-names>GT</given-names></string-name>, <string-name><surname>Destexhe</surname> <given-names>A</given-names></string-name>, <string-name><surname>Diesmann</surname> <given-names>M</given-names></string-name>, <string-name><surname>Grün</surname> <given-names>S</given-names></string-name>, <string-name><surname>Jirsa</surname> <given-names>V</given-names></string-name>, <string-name><surname>de Kamps</surname> <given-names>M</given-names></string-name>, <string-name><surname>Migliore</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ness</surname> <given-names>TV</given-names></string-name>, <string-name><surname>Plesser</surname> <given-names>HE</given-names></string-name>, <string-name><surname>Schürmann</surname> <given-names>F</given-names></string-name>. <article-title>The scientific case for brain simulations</article-title>. <source>Neuron</source>. <year>2019</year>; <volume>102</volume>(<issue>4</issue>):<fpage>735</fpage>–<lpage>744</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Farina</surname> <given-names>D</given-names></string-name>, <string-name><surname>Negro</surname> <given-names>F</given-names></string-name>. <article-title>Common synaptic input to motor neurons, motor unit synchronization, and force control</article-title>. <source>Exercise and sport sciences reviews</source>. <year>2015</year>; <volume>43</volume>(<issue>1</issue>):<fpage>23</fpage>–<lpage>33</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Farina</surname> <given-names>D</given-names></string-name>, <string-name><surname>Rehbaum</surname> <given-names>H</given-names></string-name>, <string-name><surname>Holobar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Vujaklija</surname> <given-names>I</given-names></string-name>, <string-name><surname>Jiang</surname> <given-names>N</given-names></string-name>, <string-name><surname>Hofer</surname> <given-names>C</given-names></string-name>, <string-name><surname>Salminger</surname> <given-names>S</given-names></string-name>, <string-name><surname>van Vliet</surname> <given-names>HW</given-names></string-name>, <string-name><surname>Aszmann</surname> <given-names>OC</given-names></string-name>. <article-title>Noninvasive, accurate assessment of the behavior of representative populations of motor units in targeted reinnervated muscles</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source>. <year>2014</year>; <volume>22</volume>(<issue>4</issue>):<fpage>810</fpage>–<lpage>819</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Goaillard</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Marder</surname> <given-names>E</given-names></string-name>. <article-title>Ion channel degeneracy, variability, and covariation in neuron and circuit resilience</article-title>. <source>Annual review of neuroscience</source>. <year>2021</year>; <volume>44</volume>(<issue>1</issue>):<fpage>335</fpage>–<lpage>357</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Gorassini</surname> <given-names>M</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>JF</given-names></string-name>, <string-name><surname>Siu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bennett</surname> <given-names>DJ</given-names></string-name>. <article-title>Intrinsic activation of human motoneurons: reduction of motor unit recruitment thresholds by repeated contractions</article-title>. <source>Journal of Neurophysiology</source>. <year>2002</year>; <volume>87</volume>(<issue>4</issue>):<fpage>1859</fpage>–<lpage>1866</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>, <string-name><surname>Binder</surname> <given-names>MD</given-names></string-name>. <article-title>Analysis of effective synaptic currents generated by homonymous Ia afferent fibers in motoneurons of the cat</article-title>. <source>Journal of Neurophysiology</source>. <year>1988</year>; <volume>60</volume>(<issue>6</issue>):<fpage>1946</fpage>–<lpage>1966</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>, <string-name><surname>Binder</surname> <given-names>MD</given-names></string-name>. <article-title>Computer simulations of the effects of different synaptic input systems on motor unit recruitment</article-title>. <source>Journal of Neurophysiology</source>. <year>1993</year>; <volume>70</volume>(<issue>5</issue>):<fpage>1827</fpage>–<lpage>1840</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>, <string-name><surname>Enoka</surname> <given-names>RM</given-names></string-name>. <article-title>Motor unit</article-title>. <source>Comprehensive physiology</source>. <year>2012</year>; <volume>2</volume>(<issue>4</issue>):<fpage>2629</fpage>–<lpage>2682</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>, <string-name><surname>Gorassini</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Bennett</surname> <given-names>DJ</given-names></string-name>. <article-title>Persistent inward currents in motoneuron dendrites: implications for motor output</article-title>. <source>Muscle &amp; Nerve: Official Journal of the American Association of Electrodiagnostic Medicine</source>. <year>2005</year>; <volume>31</volume>(<issue>2</issue>):<fpage>135</fpage>–<lpage>156</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="other"><string-name><surname>Henneman</surname> <given-names>E</given-names></string-name>, <string-name><surname>Mendell</surname> <given-names>L.</given-names></string-name> <article-title>Handbook of Physiology. The Nervous System</article-title>. <source>Motor Control. Bethesda, MD: American Physiological Society</source>. <year>1981</year>; p. <fpage>423</fpage>–<lpage>507</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Hines</surname> <given-names>ML</given-names></string-name>, <string-name><surname>Carnevale</surname> <given-names>NT</given-names></string-name>. <article-title>The NEURON simulation environment</article-title>. <source>Neural computation</source>. <year>1997</year>; <volume>9</volume>(<issue>6</issue>):<fpage>1179</fpage>–<lpage>1209</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Holobar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Minetto</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Botter</surname> <given-names>A</given-names></string-name>, <string-name><surname>Negro</surname> <given-names>F</given-names></string-name>, <string-name><surname>Farina</surname> <given-names>D</given-names></string-name>. <article-title>Experimental analysis of accuracy in the identification of motor unit spike trains from high-density surface EMG</article-title>. <source>IEEE Transactions on Neural Systems and Rehabilitation Engineering</source>. <year>2010</year>; <volume>18</volume>(<issue>3</issue>):<fpage>221</fpage>–<lpage>229</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Holstege</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kuypers</surname> <given-names>H</given-names></string-name>. <article-title>Brainstem projections to spinal motoneurons: an update</article-title>. <source>Neuroscience</source>. <year>1987</year>; <volume>23</volume>(<issue>3</issue>):<fpage>809</fpage>–<lpage>821</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Hounsgaard</surname> <given-names>J</given-names></string-name>, <string-name><surname>Hultborn</surname> <given-names>H</given-names></string-name>, <string-name><surname>Jespersen</surname> <given-names>B</given-names></string-name>, <string-name><surname>Kiehn</surname> <given-names>O</given-names></string-name>. <article-title>Bistability of alpha-motoneurones in the decerebrate cat and in the acute spinal cat after intravenous 5-hydroxytryptophan</article-title>. <source>The Journal of physiology</source>. <year>1988</year>; <volume>405</volume>(<issue>1</issue>):<fpage>345</fpage>– <lpage>367</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Hu</surname> <given-names>X</given-names></string-name>, <string-name><surname>Rymer</surname> <given-names>WZ</given-names></string-name>, <string-name><surname>Suresh</surname> <given-names>NL</given-names></string-name>. <article-title>Motor unit pool organization examined via spike-triggered averaging of the surface electromyogram</article-title>. <source>Journal of neurophysiology</source>. <year>2013</year>; <volume>110</volume>(<issue>5</issue>):<fpage>1205</fpage>–<lpage>1220</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Hug</surname> <given-names>F</given-names></string-name>, <string-name><surname>Avrillon</surname> <given-names>S</given-names></string-name>, <string-name><surname>Del Vecchio</surname> <given-names>A</given-names></string-name>, <string-name><surname>Casolo</surname> <given-names>A</given-names></string-name>, <string-name><surname>Ibanez</surname> <given-names>J</given-names></string-name>, <string-name><surname>Nuccio</surname> <given-names>S</given-names></string-name>, <string-name><surname>Rossato</surname> <given-names>J</given-names></string-name>, <string-name><surname>Holobar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Farina</surname> <given-names>D</given-names></string-name>. <article-title>Analysis of motor unit spike trains estimated from high-density surface electromyography is highly reliable across operators</article-title>. <source>Journal of Electromyography and Kinesiology</source>. <year>2021</year>; <volume>58</volume>:<issue>102548</issue>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Hyngstrom</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>CJ</given-names></string-name>. <article-title>Summation of excitatory and inhibitory synaptic inputs by motoneurons with highly active dendrites</article-title>. <source>Journal of neurophysiology</source>. <year>2008</year>; <volume>99</volume>(<issue>4</issue>):<fpage>1643</fpage>–<lpage>1652</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Hyngstrom</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>JF</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>. <article-title>Intrinsic electrical properties of spinal motoneurons vary with joint angle</article-title>. <source>Nature neuroscience</source>. <year>2007</year>; <volume>10</volume>(<issue>3</issue>):<fpage>363</fpage>–<lpage>369</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Johnson</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Thompson</surname> <given-names>CK</given-names></string-name>, <string-name><surname>Tysseling</surname> <given-names>VM</given-names></string-name>, <string-name><surname>Powers</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>CJ</given-names></string-name>. <article-title>The potential for understanding the synaptic organization of human motor commands via the firing patterns of motoneurons</article-title>. <source>Journal of neurophysiology</source>. <year>2017</year>; <volume>118</volume>(<issue>1</issue>):<fpage>520</fpage>–<lpage>531</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Kim</surname> <given-names>H</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>KE</given-names></string-name>. <article-title>The retrograde frequency response of passive dendritic trees constrains the nonlinear firing behaviour of a reduced neuron model</article-title>. <source>PLoS One</source>. <year>2012</year>;.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Kim</surname> <given-names>H</given-names></string-name>, <string-name><surname>Major</surname> <given-names>LA</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>KE</given-names></string-name>. <article-title>Derivation of cable parameters for a reduced model that retains asymmetric voltage attenuation of reconstructed spinal motor neuron dendrites</article-title>. <source>Journal of computational neuroscience</source>. <year>2009</year>; <volume>27</volume>(<issue>3</issue>):<fpage>321</fpage>–<lpage>336</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Kozachenko</surname> <given-names>LF</given-names></string-name>, <string-name><surname>Leonenko</surname> <given-names>NN</given-names></string-name>. <article-title>Sample estimate of the entropy of a random vector</article-title>. <source>Problemy Peredachi Informatsii</source>. <year>1987</year>; <volume>23</volume>(<issue>2</issue>):<fpage>9</fpage>–<lpage>16</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Kraskov</surname> <given-names>A</given-names></string-name>, <string-name><surname>Stögbauer</surname> <given-names>H</given-names></string-name>, <string-name><surname>Grassberger</surname> <given-names>P</given-names></string-name>. <article-title>Estimating mutual information</article-title>. <source>Physical review E</source>. <year>2004</year>; <volume>69</volume>(<issue>6</issue>):<fpage>066138</fpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Kuo</surname> <given-names>JJ</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>RH</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>HM</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>. <article-title>Active dendritic integration of inhibitory synaptic inputs in vivo</article-title>. <source>Journal of neurophysiology</source>. <year>2003</year>; <volume>90</volume>(<issue>6</issue>):<fpage>3617</fpage>–<lpage>3624</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Lee</surname> <given-names>R</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>. <article-title>Influence of voltage-sensitive dendritic conductances on bistable firing and effective synaptic current in cat spinal motoneurons in vivo</article-title>. <source>Journal of neurophysiology</source>. <year>1996</year>; <volume>76</volume>(<issue>3</issue>):<fpage>2107</fpage>–<lpage>2110</lpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Lee</surname> <given-names>R</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>. <article-title>Bistability in spinal motoneurons in vivo: systematic variations in persistent inward currents</article-title>. <source>Journal of neurophysiology</source>. <year>1998</year>; <volume>80</volume>(<issue>2</issue>):<fpage>583</fpage>–<lpage>593</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Lee</surname> <given-names>R</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>. <article-title>Bistability in spinal motoneurons in vivo: systematic variations in rhythmic firing patterns</article-title>. <source>Journal of neurophysiology</source>. <year>1998</year>; <volume>80</volume>(<issue>2</issue>):<fpage>572</fpage>–<lpage>582</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Lee</surname> <given-names>R</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>C</given-names></string-name>. <article-title>Enhancement of bistability in spinal motoneurons in vivo by the noradrenergic α1 agonist methoxamine</article-title>. <source>Journal of neurophysiology</source>. <year>1999</year>; <volume>81</volume>(<issue>5</issue>):<fpage>2164</fpage>–<lpage>2174</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Lee</surname> <given-names>RH</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>CJ</given-names></string-name>. <article-title>Adjustable amplification of synaptic input in the dendrites of spinal motoneurons in vivo</article-title>. <source>Journal of Neuroscience</source>. <year>2000</year>; <volume>20</volume>(<issue>17</issue>):<fpage>6734</fpage>–<lpage>6740</lpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Lim</surname> <given-names>HK</given-names></string-name>, <string-name><surname>Keniston</surname> <given-names>LP</given-names></string-name>, <string-name><surname>Cios</surname> <given-names>KJ</given-names></string-name>. <article-title>Modeling of multisensory convergence with a network of spiking neurons: a reverse engineering approach</article-title>. <source>IEEE transactions on biomedical engineering</source>. <year>2011</year>; <volume>58</volume>(<issue>7</issue>):<fpage>1940</fpage>–<lpage>1949</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Lindsay</surname> <given-names>A</given-names></string-name>, <string-name><surname>Binder</surname> <given-names>MD</given-names></string-name>. <article-title>Distribution of effective synaptic currents underlying recurrent inhibition in cat triceps surae motoneurons</article-title>. <source>Journal of neurophysiology</source>. <year>1991</year>; <volume>65</volume>(<issue>2</issue>):<fpage>168</fpage>–<lpage>177</lpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Maratta</surname> <given-names>R</given-names></string-name>, <string-name><surname>Fenrich</surname> <given-names>KK</given-names></string-name>, <string-name><surname>Zhao</surname> <given-names>E</given-names></string-name>, <string-name><surname>Neuber-Hess</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Rose</surname> <given-names>PK</given-names></string-name>. <article-title>Distribution and density of contacts from noradrenergic and serotonergic boutons on the dendrites of neck flexor motoneurons in the adult cat</article-title>. <source>Journal of Comparative Neurology</source>. <year>2015</year>; <volume>523</volume>(<issue>11</issue>):<fpage>1701</fpage>–<lpage>1716</lpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Marder</surname> <given-names>E</given-names></string-name>. <article-title>Neuromodulation of neuronal circuits: back to the future</article-title>. <source>Neuron</source>. <year>2012</year>; <volume>76</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="other"><string-name><surname>McCormick</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Nusbaum</surname> <given-names>MP.</given-names></string-name> <source>Editorial overview: neuromodulation: tuning the properties of neurons, networks and behavior. Current opinion in neurobiology</source>. <year>2014</year>; 29:iv.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Mottram</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Powers</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Rymer</surname> <given-names>WZ</given-names></string-name>, <string-name><surname>Suresh</surname> <given-names>NL</given-names></string-name>. <article-title>Disturbances of motor unit rate modulation are prevalent in muscles of spastic-paretic stroke survivors</article-title>. <source>Journal of neurophysiology</source>. <year>2014</year>; <volume>111</volume>(<issue>10</issue>):<fpage>2017</fpage>– <lpage>2028</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Mukunda</surname> <given-names>CL</given-names></string-name>, <string-name><surname>Narayanan</surname> <given-names>R</given-names></string-name>. <article-title>Degeneracy in the regulation of short-term plasticity and synaptic filtering by presynaptic mechanisms</article-title>. <source>The Journal of Physiology</source>. <year>2017</year>; <volume>595</volume>(<issue>8</issue>):<fpage>2611</fpage>–<lpage>2637</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Negro</surname> <given-names>F</given-names></string-name>, <string-name><surname>Muceli</surname> <given-names>S</given-names></string-name>, <string-name><surname>Castronovo</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Holobar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Farina</surname> <given-names>D</given-names></string-name>. <article-title>Multi-channel intramuscular and surface EMG decomposition by convolutive blind source separation</article-title>. <source>Journal of neural engineering</source>. <year>2016</year>; <volume>13</volume>(<issue>2</issue>):<fpage>026027</fpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Pisokas</surname> <given-names>I</given-names></string-name>. <article-title>Reverse Engineering and Robotics as Tools for Analyzing Neural Circuits</article-title>. <source>Frontiers in Neurorobotics</source>. <year>2021</year>; <volume>14</volume>:<issue>578803</issue>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Powers</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Binder</surname> <given-names>MD</given-names></string-name>. <article-title>Input-output functions of mammalian motoneurons</article-title>. <source>Reviews of physiology, biochemistry and pharmacology</source>. <year>2001</year>; p. <fpage>137</fpage>–<lpage>263</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><surname>Powers</surname> <given-names>RK</given-names></string-name>, <string-name><surname>ElBasiouny</surname> <given-names>SM</given-names></string-name>, <string-name><surname>Rymer</surname> <given-names>WZ</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>CJ</given-names></string-name>. <article-title>Contribution of intrinsic properties and synaptic inputs to motoneuron discharge patterns: a simulation study</article-title>. <source>Journal of neurophysiology</source>. <year>2012</year>; <volume>107</volume>(<issue>3</issue>):<fpage>808</fpage>–<lpage>823</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>Powers</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>CJ</given-names></string-name>. <article-title>Synaptic control of the shape of the motoneuron pool input-output function</article-title>. <source>Journal of neurophysiology</source>. <year>2017</year>; <volume>117</volume>(<issue>3</issue>):<fpage>1171</fpage>–<lpage>1184</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><surname>Powers</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Nardelli</surname> <given-names>P</given-names></string-name>, <string-name><surname>Cope</surname> <given-names>TC</given-names></string-name>. <article-title>Estimation of the contribution of intrinsic currents to motoneuron firing based on paired motoneuron discharge records in the decerebrate cat</article-title>. <source>Journal of neurophysiology</source>. <year>2008</year>; <volume>100</volume>(<issue>1</issue>):<fpage>292</fpage>–<lpage>303</lpage>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Prinz</surname> <given-names>AA</given-names></string-name>. <article-title>Computational approaches to neuronal network analysis</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>. <year>2010</year>; <volume>365</volume>(<issue>1551</issue>):<fpage>2397</fpage>–<lpage>2405</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Prinz</surname> <given-names>AA</given-names></string-name>, <string-name><surname>Bucher</surname> <given-names>D</given-names></string-name>, <string-name><surname>Marder</surname> <given-names>E</given-names></string-name>. <article-title>Similar network activity from disparate circuit parameters</article-title>. <source>Nature neuroscience</source>. <year>2004</year>; <volume>7</volume>(<issue>12</issue>):<fpage>1345</fpage>–<lpage>1352</lpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><surname>Ross</surname> <given-names>BC</given-names></string-name>. <article-title>Mutual information between discrete and continuous data sets</article-title>. <source>PloS one</source>. <year>2014</year>; <volume>9</volume>(<issue>2</issue>):<fpage>e87357</fpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><surname>Rostro-Gonzalez</surname> <given-names>H</given-names></string-name>, <string-name><surname>Cessac</surname> <given-names>B</given-names></string-name>, <string-name><surname>Viéville</surname> <given-names>T</given-names></string-name>. <article-title>Parameter estimation in spiking neural networks: a reverseengineering approach</article-title>. <source>Journal of Neural Engineering</source>. <year>2012</year>; <volume>9</volume>(<issue>2</issue>):<fpage>026024</fpage>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><surname>Stevenson</surname> <given-names>IH</given-names></string-name>, <string-name><surname>Kording</surname> <given-names>KP</given-names></string-name>. <article-title>How advances in neural recording affect data analysis</article-title>. <source>Nature neuroscience</source>. <year>2011</year>; <volume>14</volume>(<issue>2</issue>):<fpage>139</fpage>–<lpage>142</lpage>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><surname>Stevenson</surname> <given-names>IH</given-names></string-name>, <string-name><surname>London</surname> <given-names>BM</given-names></string-name>, <string-name><surname>Oby</surname> <given-names>ER</given-names></string-name>, <string-name><surname>Sachs</surname> <given-names>NA</given-names></string-name>, <string-name><surname>Reimer</surname> <given-names>J</given-names></string-name>, <string-name><surname>Englitz</surname> <given-names>B</given-names></string-name>, <string-name><surname>David</surname> <given-names>SV</given-names></string-name>, <string-name><surname>Shamma</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Blanche</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Mizuseki</surname> <given-names>K</given-names></string-name>, <etal>et al.</etal> <article-title>Functional connectivity and tuning curves in populations of simultaneously recorded neurons</article-title>. <source>PLoS computational biology</source>. <year>2012</year>; <volume>8</volume>(<issue>11</issue>):<fpage>e1002775</fpage>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><surname>Telenczuk</surname> <given-names>B</given-names></string-name>, <string-name><surname>Telenczuk</surname> <given-names>M</given-names></string-name>, <string-name><surname>Destexhe</surname> <given-names>A</given-names></string-name>. <article-title>A kernel-based method to calculate local field potentials from networks of spiking neurons</article-title>. <source>Journal of Neuroscience Methods</source>. <year>2020</year>; <volume>344</volume>:<issue>108871</issue>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><string-name><surname>Thompson</surname> <given-names>CK</given-names></string-name>, <string-name><surname>Negro</surname> <given-names>F</given-names></string-name>, <string-name><surname>Johnson</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Holmes</surname> <given-names>MR</given-names></string-name>, <string-name><surname>McPherson</surname> <given-names>LM</given-names></string-name>, <string-name><surname>Powers</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Farina</surname> <given-names>D</given-names></string-name>, <string-name><surname>Heckman</surname> <given-names>CJ</given-names></string-name>. <article-title>Robust and accurate decoding of motoneuron behaviour and prediction of the resulting force output</article-title>. <source>The Journal of physiology</source>. <year>2018</year>; <volume>596</volume>(<issue>14</issue>):<fpage>2643</fpage>–<lpage>2659</lpage>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><string-name><surname>Türker</surname> <given-names>K</given-names></string-name>, <string-name><surname>Powers</surname> <given-names>R</given-names></string-name>. <article-title>Black box revisited: a technique for estimating postsynaptic potentials in neurons</article-title>. <source>Trends in neurosciences</source>. <year>2005</year>; <volume>28</volume>(<issue>7</issue>):<fpage>379</fpage>–<lpage>386</lpage>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><string-name><surname>Vyas</surname> <given-names>S</given-names></string-name>, <string-name><surname>Golub</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Sussillo</surname> <given-names>D</given-names></string-name>, <string-name><surname>Shenoy</surname> <given-names>KV</given-names></string-name>. <article-title>Computation through neural population dynamics</article-title>. <source>Annual Review of Neuroscience</source>. <year>2020</year>; <volume>43</volume>:<issue>249</issue>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><string-name><surname>Yang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Shakil</surname> <given-names>H</given-names></string-name>, <string-name><surname>Ratté</surname> <given-names>S</given-names></string-name>, <string-name><surname>Prescott</surname> <given-names>SA</given-names></string-name>. <article-title>Minimal requirements for a neuron to coregulate many properties and the implications for ion channel correlations and robustness</article-title>. <source>Elife</source>. <year>2022</year>; <volume>11</volume>:<fpage>e72875</fpage>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><string-name><surname>Yochum</surname> <given-names>M</given-names></string-name>, <string-name><surname>Modolo</surname> <given-names>J</given-names></string-name>, <string-name><surname>Mogul</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Benquet</surname> <given-names>P</given-names></string-name>, <string-name><surname>Wendling</surname> <given-names>F</given-names></string-name>. <article-title>Reconstruction of post-synaptic potentials by reverse modeling of local field potentials</article-title>. <source>Journal of Neural Engineering</source>. <year>2019</year>; <volume>16</volume>(<issue>2</issue>):<fpage>026023</fpage>.</mixed-citation></ref>
</ref-list>
<sec id="s5">
<title>Appendix 1</title>
<sec id="s5a">
<label>Algorithm 1</label>
<title>Python pseudocode for reverse engineering proportional controller on each compute node</title>
<fig id="ufig1" position="float" orientation="portrait" fig-type="figure">
<graphic xlink:href="519818v3_ufig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s5b">
<label>Algorithm 2</label>
<title>Python pseudocode for simulating each motoneuron independently</title>
<fig id="ufig2" position="float" orientation="portrait" fig-type="figure">
<graphic xlink:href="519818v3_ufig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s6">
<title>Appendix 2</title>
<sec id="s6a">
<title>Supplementary Figures</title>
<fig id="fig1A2" position="float" orientation="portrait" fig-type="figure">
<label>Appendix 2—figure 1.</label>
<caption><p>Heat maps for the different features extracted from the firing rates of the monotoneurons in the pool model. These heat maps are for the equally distributed excitatory weights [ω<sub>start</sub>, ω<sub>end</sub>] = [1, 1]. Each heat map is organized along the Neuromodulation and Inhibitory ranges tried in this work. The values within these heat maps show structure with respect to Neuromodulation and Inhibition and show that this structure can be used to reverse engineer the Neuromodulation and Inhibition themselves.</p></caption>
<graphic xlink:href="519818v3_fig1A2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2A2" position="float" orientation="portrait" fig-type="figure">
<label>Appendix 2—figure 2.</label>
<caption><p>Schematic of the parallel architecture used to solve the MN pool model and to find the solution for the input to that pool. Each neuromodulation, inhibition, excitatory input weight and noise seed combination was assigned a node on the computer via the slurm batch scheduler. These “hyper-parameters” were passed to each motoneuron which had a dedicated CPU core using the message passing interface (MPI). This work was done on the Bebop supercomputer at Argonne National Laboratory, Lemont, IL.</p></caption>
<graphic xlink:href="519818v3_fig2A2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90624.2.sa1</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Elias</surname>
<given-names>Leonardo Abdala</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>State University of Campinas</institution>
</institution-wrap>
<city>Campinas</city>
<country>Brazil</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Compelling</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Fundamental</kwd>
</kwd-group>
</front-stub>
<body>
<p>The study by Chardon et al. is <bold>fundamental</bold> to advancing our understanding of presynaptic control of motor neuron output. Large-scale computer simulations were performed using well-established single motor neuron models to provide <bold>compelling</bold> evidence regarding the time-varying patterns of inputs that control motor neuron ensembles. The work will interest the community of motor control, motor unit physiology, neural engineering, and computational neuroscience.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90624.2.sa0</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The study presents an extensive computational approach to identify the motor neuron input from the characteristics of single motor neuron discharge patterns during a ramp up/down contraction. This reverse engineering approach is relevant due to limitations in our ability to estimate this input experimentally. Using well-established models of single motor neurons, a (very) large number of simulations were performed that allowed identification of this relation. In this way, the results enable researchers to measure motor neuron behavior and from those results determine the underlying neural input scheme. Overall, the results are very convincing and represent an important step forward in understanding the neural strategies for controlling movement.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90624.2.sa2</article-id>
<title-group>
<article-title>Author Response</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Chardon</surname>
<given-names>Matthieu K.</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5723-3217</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Wang</surname>
<given-names>Y. Curtis</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0211-9286</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Garcia</surname>
<given-names>Marta</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Besler</surname>
<given-names>Emre</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-9274-2500</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Beauchamp</surname>
<given-names>J. Andrew</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2288-8672</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>D’Mello</surname>
<given-names>Michael</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Powers</surname>
<given-names>Randall K.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Heckman</surname>
<given-names>Charles J.</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1324-7278</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer 1</p>
<p>“The exact levels of inhibition, excitation, and neuromodulatory inputs to neural networks are unknown.
Therefore, the work is based on fine-tuned measures that are indirectly based on experimental results. However, obtaining such physiological information is challenging and currently impossible. From a computational perspective it is a challenge that in theory can be solved. Thus, although we have no ground-truth evidence, this framework can provide compelling evidence for all hypothesis testing research and potentially solve this physiological problem with the use of computers.”</p>
</disp-quote>
<p>Response: We agree with the reviewer.  This work was intended to determine the feasibility of reverse engineering motor unit firing patterns, using neuron models with a high degree realism.  Given the results support this feasibility, our model and technique will therefore serve to construct new hypotheses as well as testing them.</p>
<disp-quote content-type="editor-comment">
<list list-type="bullet">
<list-item><p>Common input structure lines 115</p>
</list-item></list>
<p>I agree with the following concepts, but I would specify that there is not only one dominant common input. It has been shown that there are multiple common inputs to the same motor nuclei (e.g., the two inputs are orthogonal and are shared with a subset of the active motoneurons) particularly for agonist motoneuron pools of synergistic muscles. On the hand muscles the authors are correct that there is only one dominant common input. Moreover, there is also some animal work suggesting that common inputs is just an epiphenomenon. This is completely in contradiction to what we observe in-vivo in the firing patterns of motor units, but perhaps worth mentioning and discussing.</p>
</disp-quote>
<p>Response: Thanks for emphasizing this point.  We have cited a recent reference discussing the important issue of common drive and the possibility of more than one source.  Our simulations assume the net form of the excitatory input to all motoneurons in the pool is the same, except for noise.  This net form (which produces the linear CST output in each case) essentially represents the sum of all inputs, both descending and sensory.  Our results show the same over pattern as human data, i.e. that all motor unit firing patterns have similar trajectories (again allowing for the impact of noise).  Future studies will consider separating excitatory inputs into different sources.</p>
<disp-quote content-type="editor-comment">
<p>It is interesting that the authors mention suprathreshold rate modulation. Could the authors just discuss more on how the model would respond to a simulated suprathreshold current for all simulated motoneurons (i.e., like the ones generated during a suprathreshold-injected current or voluntary maximal feedforward movement?)</p>
</disp-quote>
<p>Response: Thank you for this point.  Our use of the term “suprathreshold” was not applied correctly.  We meant “suprathreshold” to refer to amount of input above the recruitment threshold. We have decided to remove this term so now the sentence “…so less is available for rate modulation…”.</p>
<disp-quote content-type="editor-comment">
<p>194 a full point is missing.</p>
</disp-quote>
<p>Response: We addressed the error.</p>
<disp-quote content-type="editor-comment">
<p>204-231 and 232-259, these two paragraphs have been copied twice.</p>
</disp-quote>
<p>Response: We addressed the error.</p>
<disp-quote content-type="editor-comment">
<p>Line 475 typo</p>
</disp-quote>
<p>Response: We addressed the error.</p>
<disp-quote content-type="editor-comment">
<p>591 It would be interesting to add the me it takes a standard computer with known specs and a super computer to run over one batch of simulation (i.e., how long one of the 6,300,000 simulation takes).</p>
</disp-quote>
<p>Response: Each simulation took about 20 minutes of real me.  Assuming a standard computer with 16 processor cores using a similar microarchitecture as Bebop (Intel Broadwell architecture), the standard computer could run 16 simulations at a me (one simulation assigned per core).  This would take the standard computer about 15 years to complete all 6.3M simulations.</p>
<disp-quote content-type="editor-comment">
<p>594 I don't understand why there are 6M simulations, could the authors provide more info on the combinations and why there are 6M simulations.</p>
</disp-quote>
<p>Response: The 6M simulations are the total number of simulations that were performed for this work.  A detailed explanation can be found in section: “Machine learning inference of motor pool characteristics” at line 591. Briefly, there were 315,000 simulations of a pool of 20 motoneurons (20 x 315,000 = 6.3 million).  The 315,000 simulations was required to run all possible combinations of 15 patens of inhibition, 5 of neuromodulation, 7 of distribution of excitatory inputs and 30 different repeats of synaptic noise with different seeds.  In addition, there were 20 iterations for each of these combinations to generate a linear CST output (as illustrated in Fig. 3).  15 x5 x 7 x 30 x 20=315,000.</p>
<disp-quote content-type="editor-comment">
<p>In several simulations it seems that there was a lot of fine-tuning of inputs to match the measured motor unit firing pattern. Have the authors ever considered a fully black-box AI approach? If they think is interesting maybe it could spice up the discussion.</p>
</disp-quote>
<p>Response: We agree that AI has potential for reverse engineering the whole system and we are looking into adding it to future version of this algorithm as an alternative. We started with a simple but powerful grid search to enhance our understanding of the interaction between inputs, neuron properties and outputs.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 2</bold></p>
<p>Comment 1:</p>
<p>“First, I believe that the relation between individual motor neuron behavioral characteristics (delta F, brace height etc.) and the motor neuron input properties can be illustrated more clearly. Although this is explained in the text, I believe that this is not optimally supported by figures. Figure 6 to some extent shows this, but figures 8 and 9 as well as Table 1 shows primarily the goodness of fit rather than the actual fit.”</p>
</disp-quote>
<p>Response: We agree with the reviewer that showing the relationship between the motor neuron behavioral characteristics (delta F, brace height etc.) and the motor neuron input properties would be a great addition to the manuscript.  Because the regression models have multiple dimensions (7 inputs and 3 outputs) it is difficult to show the relationship in a static image.  We thought it best to show the goodness of fit even though it is more abstract and less intuitive. We added a supplemental diagram to Figure 8 to show the structure of the reverse engineered model that was fit (see Figure 8D).</p>
<fig id="sa2fig1">
<label>Author response image 1.</label>
<caption>
<title>Figure 8.</title>
<p>Residual plots showing the goodness of fit of the different predicted values: (A) Inhibition, (B) Neuromodulation and (C) excitatory Weight Rao. The summary plots are for the models showing highest 𝑅𝑅2 results in Table 1. The predicted values are calculated using the features extracted from the firing rates (see Figure 7, section Machine learning inference of motor pool characteristics and Regression using motoneuron outputs to predict input organization). Diagram (D) shows the multidimensionality of the RE models (see Model fits) which have 7 feature inputs (see Feature Extraction) predicting 3 outputs (Inhibition, Neuromodulation and Weight Rao).</p>
</caption>
<graphic mime-subtype="jpg" xlink:href="elife-90624-sa2-fig1.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>Comment 2:</p>
<p>“Second, I would have expected the discussion to have addressed specifically the question of which of the two primary schemes (pushpull, balanced) is the most prevalent. This is the main research question of the study, but it is to some degree le unanswered. Now that the authors have identified the relation between the characteristics of motor neuron behaviors (which has been reported in many previous studies), why not exploit this finding by summarizing the results of previous studies (at least a few representative ones) and discuss the most likely underlying input scheme? Is there a consistent trend towards one of the schemes, or are both strategies commonly used?”</p>
</disp-quote>
<p>Response: We agree with the reviewer that our discussion should have addressed which of the two primary schemes – push-pull or balanced – is the most prevalent. At first glance, the upper right of Figure 6 looks the most realistic when compared to real data.  We thus would expect that the push-pull scheme to dominate for the given task.</p>
<p>We added a brief section (Push-Pull vs Balance Motor Command) in the discussion to address the reviewer’s comments.  This section is not exhaustive but frames the debate using relevant literature. We are also now preparing to deploy these techniques on real data.</p>
<disp-quote content-type="editor-comment">
<p>Comment 3:</p>
<p>In addition, it seems striking to me that highly non-linear excitation profiles are necessary to obtain a linear CST ramp in many model configurations. Although somewhat speculative, one may expect that an approximately linear relation is desired for robust and intuitive motor control. It seems to me that humans generally have a good ability to accurately grade the magnitude of the motor output, which implies that either a non-linear relation has been learnt (complex task), or that the central nervous system can generally rely on a somewhat linear relation between the neural drive to the muscle and the output (simpler task).</p>
</disp-quote>
<p>Response: We agree with the reviewer, and we were surprised by these results.  Our motoneuron pool is equipped with persistent inward currents (PICs) which are nonlinear.  Therefore, for the motoneuron to produce a linear output the central nervous system would have to incorporate these nonlinearities into its commands.</p>
<disp-quote content-type="editor-comment">
<p>Following this reasoning, it could be interesting to report also for which input scheme, the excitation profile is most linear. I understand that this is not the primary aim of the study, but it may be an interesting way to elaborate on the finding that in many cases non-linear excitation profiles were needed to produce the linear ramp.</p>
</disp-quote>
<p>This is a very interesting point. The most realistic firing patterns – with respect to human data – are found in the parameter regions in the upper right in Figure 6, which in fact produce the most nonlinear input (see push-pull pattern in Figure 4C).  However, in future studies we hope to separate the total motor command illustrated here into descending and feedback commands.  This may result in a more linear descending drive.</p>
</body>
</sub-article>
</article>