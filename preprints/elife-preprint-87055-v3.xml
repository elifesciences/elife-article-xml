<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">87055</article-id>
<article-id pub-id-type="doi">10.7554/eLife.87055</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.87055.3</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.4</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Firing rate adaptation affords place cell theta sweeps, phase precession and procession</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Chu</surname>
<given-names>Tianhao</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Ji</surname>
<given-names>Zilong</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zuo</surname>
<given-names>Junfeng</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Mi</surname>
<given-names>Yuanyuan</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhang</surname>
<given-names>Wen-hao</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Huang</surname>
<given-names>Tiejun</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bush</surname>
<given-names>Daniel</given-names>
</name>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Burgess</surname>
<given-names>Neil</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Wu</surname>
<given-names>Si</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>School of Psychological and Cognitive Sciences, IDG/McGovern Institute for Brain Research, Center of Quantitative Biology, Peking-Tsinghua Center for Life Sciences, Academy for Advanced Interdisciplinary Studies, Peking University</institution>, <country>China</country></aff>
<aff id="a2"><label>2</label><institution>Institute of Cognitive Neuroscience, University College London</institution>, <country>UK</country></aff>
<aff id="a3"><label>3</label><institution>Department of Psychology Tsinghua University</institution>, <country>China</country></aff>
<aff id="a4"><label>4</label><institution>Lyda Hill Department of Bioinformatics, O’Donnell Brain Institute, UT Southwestern Medical Center</institution>, <country>USA</country></aff>
<aff id="a5"><label>5</label><institution>School of Computer Science, Peking University</institution>, <country>China</country></aff>
<aff id="a6"><label>6</label><institution>Department of Neuroscience, Physiology and Pharmacology, University of College London</institution>, <country>UK</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Giocomo</surname>
<given-names>Lisa M</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Stanford School of Medicine</institution>
</institution-wrap>
<city>Stanford</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Colgin</surname>
<given-names>Laura L</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Texas at Austin</institution>
</institution-wrap>
<city>Austin</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label><bold>For correspondence:</bold> <email>siwu@pku.edu.cn</email></corresp>
<fn id="n1" fn-type="equal"><label>†</label><p>These authors contributed equally to this work</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-05-17">
<day>17</day>
<month>05</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2024-06-05">
<day>05</day>
<month>06</month>
<year>2024</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP87055</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-03-17">
<day>17</day>
<month>03</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-02-16">
<day>16</day>
<month>02</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.11.14.516400"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-05-17">
<day>17</day>
<month>05</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.87055.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.87055.1.sa3">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.87055.1.sa2">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.87055.1.sa1">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.87055.1.sa0">Reviewer #3 (Public Review):</self-uri>
</event>
<event>
<event-desc>Reviewed preprint v2</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-01-11">
<day>11</day>
<month>01</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.87055.2"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.87055.2.sa2">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.87055.2.sa1">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.87055.2.sa0">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="author-comment" xlink:href="https://doi.org/10.7554/eLife.87055.2.sa3">Author Response</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Chu et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Chu et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-87055-v3.pdf"/>
<abstract>
<title>Abstract</title>
<p>Hippocampal place cells in freely moving rodents display both theta phase precession and procession, which is thought to play important roles in cognition, but the neural mechanism for producing theta phase shift remains largely unknown. Here we show that firing rate adaptation within a continuous attractor neural network causes the neural activity bump to oscillate around the external input, resembling theta sweeps of decoded position during locomotion. These forward and backward sweeps naturally account for theta phase precession and procession of individual neurons, respectively. By tuning the adaptation strength, our model explains the difference between “bimodal cells” showing interleaved phase precession and procession, and “unimodal cells” in which phase precession predominates. Our model also explains the constant cycling of theta sweeps along different arms in a T-maze environment, the speed modulation of place cells’ firing frequency, and the continued phase shift after transient silencing of the hippocampus. We hope that this study will aid an understanding of the neural mechanism supporting theta phase coding in the brain.</p>
</abstract>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>We add some paragraphs in discussion session to discuss the relationship between our model and CANN with STD</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>One of the strongest candidates for temporal coding of a cognitive variable by neural firing is the ‘theta phase precession’ shown by hippocampal place cells. As an animal runs through the firing field of a place cell, the cell fires at progressively earlier phases in successive cycles of the ongoing LFP theta oscillation, so that firing phase correlates with distance traveled (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>) (see also (<bold><italic><xref ref-type="bibr" rid="c54">Schmidt et al., 2009</xref></italic></bold>)) (<xref rid="fig1" ref-type="fig">Fig. 1a&amp;b</xref>). At the population level, phase precession of individual cells gives rise to forward theta sequences once starting phases are aligned across the population (<bold><italic><xref ref-type="bibr" rid="c17">Feng et al., 2015</xref></italic></bold>), where neurons representing successive locations along the trajectory of the animal display predictable firing sequences within individual theta cycles (<bold><italic><xref ref-type="bibr" rid="c36">Johnson and Redish, 2007</xref></italic></bold>). These prospective sequential experiences (looking into the future) are potentially useful for a range of cognitive faculties, e.g., planning, imagination, and decision-making (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c31">Hassabis et al., 2007</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c65">Wikenheiser and Redish, 2015</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c40">Kay et al., 2020</xref></italic></bold>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><p>Theta sequence and theta phase shift of place cell firing. <bold>a</bold>, An illustration of an animal running on a linear track. A group of place cells each represented by a different color are aligned according to their firing fields on the linear track. <bold>b</bold>, An illustration of the forward theta sequences of the neuron population (upper panel), and the theta phase precession of the 4th place cell (represented by the green color, lower panel). <bold>c</bold>, An illustration of both forward and reverse theta sequences (upper panel), and the corresponding theta phase precession and procession of the 4th place cell (lower panel). The sinusoidal trace illustrates the theta rhythm of local field potential (LFP), with individual theta cycles separated by vertical dashed lines.</p></caption>
<graphic xlink:href="516400v4_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Besides prospective representation, flexible behaviors also require retrospective representation of sequential experiences (looking into the past). For instance, in goal-directed behaviors, it is important to relate the reward information that might only occur at the end of a sequence of events to preceding events in the sequence (<bold><italic><xref ref-type="bibr" rid="c21">Foster et al., 2000</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c22">Foster and Wilson, 2006</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c13">Diba and Buzsáki, 2007</xref></italic></bold>). A recent experimental study (<bold><italic><xref ref-type="bibr" rid="c63">Wang et al., 2020</xref></italic></bold>) described retrospective sequences during online behaviors (also indicated by (<bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c69">Yamaguchi et al., 2002</xref></italic></bold>)), namely, reverse theta sequences, interleaved with forward theta sequences in individual theta cycles (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>). Such retrospective sequences, together with the prospective sequences, may cooperate to establish higher-order associations in episodic memory (<bold><italic><xref ref-type="bibr" rid="c13">Diba and Buzsáki, 2007</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c34">Jaramillo and Kempter, 2017</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c51">Pfeiffer, 2020</xref></italic></bold>).</p>
<p>While a large number of computational models of phase precession and the associated forward theta sequences have been proposed, e.g., the single cell oscillatory models (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c37">Kamondi et al., 1998</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c30">Harris et al., 2002</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c42">Lengyel et al., 2003</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c43">Losonczy et al., 2010</xref></italic></bold>) and recurrent activity spreading models (<bold><italic><xref ref-type="bibr" rid="c60">Tsodyks et al., 1996</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c52">Romani and Tsodyks, 2015</xref></italic></bold>), the underlying neural mechanism for interleaved forward- and reverse-ordered sequences remains largely unclear. Do reverse theta sequences share the same underlying neural mechanism as forward sequences, or do they reflect different mechanisms? If they do, what kind of neural architecture can support the emergence of both kinds of theta phase shift? Furthermore, since forward theta sequences are commonly seen, but reverse theta sequences are only seen in some circumstances (<bold><italic><xref ref-type="bibr" rid="c63">Wang et al., 2020</xref></italic></bold>), are they commensurate with forward theta sequences? If not, to what degree are forward theta sequences more significant than the reverse ones?</p>
<p>To address these questions, we built a continuous attractor neural network (CANN) of the hippocampal place cell population (<bold><italic><xref ref-type="bibr" rid="c2">Amari, 1977</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c59">Tsodyks and Sejnowski, 1995</xref></italic></bold>; <bold><italic><xref rid="c53" ref-type="bibr">Samsonovich and Mc-Naughton, 1997</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c58">Tsodyks, 1999</xref></italic></bold>). The CANN conveys a map of the environment in its recurrent connections that affords a single bump of activity on a topographically organized sheet of cells which can move smoothly so as to represent the location of the animal as it moves in the environment. Each neuron exhibits firing rate adaptation which destabilizes the bump attractor state. When the adaptation is strong enough, the network bump can travel spontaneously in the attractor space, which we term as the intrinsic mobility. Intriguingly, we show that, under competition between the intrinsic mobility and the extrinsic mobility caused by location-dependent sensory inputs, the network displays an oscillatory tracking state, in which the network bump sweeps back and forth around the external sensory input. This phenomenon naturally explains the theta sweeps found in the hippocampus (<bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c10">Burgess et al., 1994</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c23">Foster and Wilson, 2007</xref></italic></bold>), where the decoded position sweeps around the animal’s physical position at theta frequency. More specifically, phase precession occurs when the bump propagates forward while phase procession occurs when the network bump propagates backward. Moreover, we find that neurons can exhibit either only predominant phase precession (unimodal cells) when adaptation is relatively strong, or interleaved phase precession and procession (bimodal cells) when adaptation is relatively weak.</p>
<p>In addition to theta phase shift, our model also successfully explains the constant cycling of theta sweeps along different upcoming arms in a T-maze environment (<bold><italic><xref ref-type="bibr" rid="c40">Kay et al., 2020</xref></italic></bold>), and other phenomena related to phase precession of place cells (<bold><italic><xref ref-type="bibr" rid="c26">Geisler et al., 2007</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c70">Zugaro et al., 2005</xref></italic></bold>). We hope that this study facilitates our understanding of the neural mechanism underlying the rich dynamics of hippocampal neurons and lays the foundation for unveiling their computational functions.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>A network model of hippocampal place cells</title>
<p>To study the phase shift of hippocampal place cells, we focus on a one-dimensional (1D) continuous attractor neural network (CANN) (mimicking the animal moving on a linear track, see <xref rid="fig2" ref-type="fig">Fig. 2a</xref>), but generalization to the 2D case (mimicking the animal moving in a 2D arena) is straightforward (see Discussion for more details). Neurons in the 1D CANN can be viewed as place cells rearranged according to the locations of their firing fields on the linear track (measured during free exploration). The dynamics of the 1D CANN is written as
<disp-formula id="eqn1">
<graphic xlink:href="516400v4_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn2">
<graphic xlink:href="516400v4_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><p>The network architecture and tracking dynamics. <bold>a</bold>, A 1D continuous attractor neural network formed by place cells. Neurons are aligned according to the locations of their firing fields on the linear track. The recurrent connection strength <italic>J</italic> (<italic>x, x</italic><sup>′</sup>) (blue arrows) between two neurons decays with their distance on the linear track. Each neuron receives an adaptation current <italic>−V (x, t</italic>) (red dashed arrows). The external input <italic>I</italic><sup><italic>ext</italic></sup><italic>(x, t</italic>), represented by a Gaussian-shaped bump, conveys location-dependent sensory inputs to the network. <bold>b</bold>, An illustration of the state space of the CANN. The CANN holds a family of bump attractors which form a continuous valley in the energy space. <bold>c</bold>, The smooth tracking state. The network bump (hot colors) smoothly tracks the external moving input (the white line). The red (blue) color represents high (low) firing rate. <bold>d</bold>, The travelling wave state when the CANN has strong firing rate adaptation. The network bump moves spontaneously with a speed much faster than the external moving input. <bold>e</bold>, The intrinsic speed of the travelling wave versus the adaptation strength. <bold>f</bold>, The oscillatory tracking state. The bump position sweeps around the external input (black line) with an offset <italic>d</italic><sub>0</sub>. <bold>g</bold>, The phase diagram of the tracking dynamics with respect to the adaptation strength <italic>m</italic> and the external input strength <italic>α</italic>. The colored area shows the parameter regime for the oscillatory tracking state. Yellow (blue) color represents fast (slow) oscillation frequency. <bold>h-i</bold>, Simulated (red points) and theoretical (blue line) oscillation frequency as a function of the adaptation strength (<bold>h</bold>) or the external input strength (<bold>i</bold>).</p></caption>
<graphic xlink:href="516400v4_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Here <italic>U (x, t</italic>) represents the presynaptic input to the neuron located at position <italic>x on</italic>the linear track, and <italic>r</italic>(<italic>x, t)</italic> represents the corresponding firing rate constrained by global inhibition (<bold><italic><xref ref-type="bibr" rid="c29">Hao et al., 2009</xref></italic></bold>). <italic>τ</italic> is the time constant, <italic>ρ</italic> the neuron density, <italic>k</italic> the global inhibition strength, and <italic>g</italic> is the gain factor. The dynamics of <italic>U (x, t</italic>) is determined by the leaky term <italic>−U(x, t</italic>), the recurrent input from other neurons, the firing rate adaptation <italic>−V (x, t</italic>), and the external input <italic>I</italic><sup><italic>ext</italic></sup><italic>(x, t</italic>). The recurrent connection strength <italic>J</italic> (<italic>x, x</italic><sup>′</sup>) between two neurons decays with their distance. For simplicity, we set <italic>J</italic> (<italic>x, x</italic><sup>′</sup>) to be the Gaussian form, i.e., <inline-formula><inline-graphic xlink:href="516400v4_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, with <italic>J</italic><sub>0</sub> controlling the connection strength and <italic>a</italic> the range of neuronal interaction. Such connectivity gives rise to a synaptic weight matrix with the property of translation invariance. Together with the global inhibition, the translation invariant weight matrix ensures that the network can hold a continuous family of stationary states (attractors) when no external input and adaptation exist (<bold><italic><xref ref-type="bibr" rid="c59">Tsodyks and Sejnowski, 1995</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c53">Samsonovich and McNaughton, 1997</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c44">McNaughton et al., 2006</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c66">Wu et al., 2008</xref></italic></bold>), where each attractor is a localized firing bump representing a single spatial location (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>). These bump states are expressed as (see Methods. for the parameter settings and SI.2 for the detailed mathematical derivation):
<disp-formula id="eqn3">
<graphic xlink:href="516400v4_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>A</italic><sub><italic>r</italic></sub>(<italic>t</italic>) denotes the bump height and <italic>z</italic>(<italic>t</italic>) the bump center, i.e., the spatial location represented by the network. For convenience, we set the external input to be of the Gaussian form, which is written as <italic>I</italic><sup><italic>ext</italic></sup><italic>(x, t</italic>) = <italic>α</italic> exp [<italic>−(x − v</italic><sub><italic>ext</italic></sub><italic>t</italic>)<sup>2</sup><italic>/</italic>(4<italic>a</italic><sup>2</sup>) ], with <italic>v</italic><sub><italic>ext</italic></sub> representing the moving speed and <italic>α</italic> controlling the external input strength. Such external moving input represents location-dependent sensory inputs (i.e., corresponding to the animal’s physical location) which might be conveyed via the entorhinal-hippocampal or subcortical pathways (<bold><italic><xref ref-type="bibr" rid="c62">Van Strien et al., 2009</xref></italic></bold>). The term <italic>−V (x, t</italic>) represents the firing rate adaptation (<bold><italic><xref ref-type="bibr" rid="c1">Alonso and Klink, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c24">Fuhrmann et al., 2002</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c5">Benda and Herz, 2003</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c57">Treves, 2004</xref></italic></bold>), whose dynamics is written as
<disp-formula id="eqn4">
<graphic xlink:href="516400v4_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>m</italic> controls the adaptation strength, and <italic>τ</italic><sub><italic>v</italic></sub> is the time constant. The condition <italic>τ</italic><sub><italic>v</italic></sub> ≫ <italic>τ</italic> holds, implying that the firing rate adaptation is a much slower process compared to neuronal firing. In effect, the firing rate adaptation increases with the neuronal activity and contributes to destabilizing the active bump state, which induce rich dynamics of the network (see below).</p>
</sec>
<sec id="s2b">
<title>Oscillatory tracking of the network</title>
<p>Overall, the bump motion in the network is determined by two competing factors, i.e., the external input and the adaptation. The interplay between these two factors leads to the network exhibiting oscillatory tracking in an appropriate parameter regime. To elucidate the underlying mechanism clearly, we explore the effects of the external input and the adaptation on bump motion separately. First, when firing rate adaptation does not exist in the network (<italic>m</italic> = 0), the bump tracks the external moving input smoothly (see <xref rid="fig2" ref-type="fig">Fig. 2c</xref>). We refer to this as the “<bold>smooth tracking state</bold>”, where the internal location represented in the hippocampus (the bump position) is continuously tracking the animal’s physical location (the external input location). This smooth tracking property of CANNs has been widely used to model spatial navigation in the hippocampus (<bold><italic><xref ref-type="bibr" rid="c59">Tsodyks and Sejnowski, 1995</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c53">Samsonovich and McNaughton, 1997</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c44">McNaughton et al., 2006</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c4">Battaglia and Treves, 1998</xref></italic></bold>). Second, when the external drive does not exist in the network (<italic>α</italic> = 0) and the adaptation strength <italic>m</italic> exceeds a threshold (<italic>m</italic> &gt; <italic>τ/τ</italic><sub><italic>v</italic></sub>), the bump moves spontaneously with a speed calculated as <inline-formula><inline-graphic xlink:href="516400v4_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (see <xref rid="fig2" ref-type="fig">Fig. 2d&amp;e</xref> and Methods. for more details). We refer to this as the “<bold>travelling wave state</bold>”, where the internal representation of location in the hippocampus is sequentially reactivated without external drive, resembling replay-like dynamics during a quiescent state (see Discussion for more details). This intrinsic mobility of the bump dynamics can be intuitively understood as follows. Neurons around the bump center have the highest firing rates and hence receive the strongest adaptation. Such strong adaptation destabilizes the bump stability at the current location, and hence pushes the bump away. After moving to a new location, the bump will be continuously pushed away by the firing rate adaptation at the new location. As a result, the bump keeps moving on the linear track. Similar mechanisms have been applied to explain mental exploration (<bold><italic><xref ref-type="bibr" rid="c32">Hopfield, 2010</xref></italic></bold>), preplay during sharp wave-ripple events in the hippocampus (<bold><italic><xref ref-type="bibr" rid="c3">Azizi et al., 2013</xref></italic></bold>), and the free memory recall phenomenon in the brain (<bold><italic><xref ref-type="bibr" rid="c14">Dong et al., 2021</xref></italic></bold>).</p>
<p>When both the external input and adaptation are applied to the CANN, the interplay between the extrinsic mobility (caused by the external input) and the intrinsic mobility (caused by the adaptation) will induce three different dynamical behaviors of the network (see <bold>video 1</bold> for demonstration), i.e., 1) when <italic>m</italic> is small and <italic>α</italic> is large, the network displays the smooth tracking state; 2) when <italic>m</italic> is large and <italic>α</italic> is small, the network displays the travelling wave state; 3) when both <italic>m</italic> and <italic>α</italic> have moderate values, the network bump displays an interesting state, called the “<bold>oscillatory tracking state</bold>”, where the bump tracks the external moving input in an oscillatory fashion (<xref rid="fig2" ref-type="fig">Fig. 2f&amp;g</xref>). Intuitively, the mechanism for oscillatory tracking can be understood as follows. Due to the intrinsic mobility of the network, the bump tends to move at its own intrinsic speed (which is faster than the external moving input, see <xref rid="fig2" ref-type="fig">Fig. 2d</xref>), i.e., the bump tries to escape from the external input. However, due to the strong locking effect of the external input, the bump can not run too far away from the location input, but instead, is attracted back to the location input. Once the bump returns, it will keep moving in the opposite direction of the external input until it is pulled back by the external input again. Over time, the bump will sweep back and forth around the external moving input, displaying the oscillatory tracking behavior. It is noteworthy that the activity bump does not live within a window circumscribed by the external input bump (bouncing off the interior walls of the input during the oscillatory tracking state), but instead is continuously pulled back and forth by the external input (see Fig. S1).</p>
<p>Our study shows that during oscillatory tracking, the bump shape is roughly unchanged (see previous sections for the condition of shape variability), and the bump oscillation can be well represented as the bump center sweeping around the external input location. The dynamics of the bump center can be approximated as a propagating sinusoidal wave (<xref rid="fig2" ref-type="fig">Fig. 2f</xref>), i.e.,
<disp-formula id="eqn5">
<graphic xlink:href="516400v4_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>z</italic>(<italic>t</italic>) is the bump center at time <italic>t</italic> (see <xref ref-type="disp-formula" rid="eqn3">Eq. 3</xref>). <italic>s(t)</italic> denotes the displacement between the bump center and the external input, which oscillates at the frequency <italic>ω</italic> with the amplitude <italic>c</italic><sub>0</sub> &gt; 0 and a constant offset <italic>d</italic><sub>0</sub> &gt; 0 (see Methods. for the values of these parameters and SI.3 for the detailed derivation). When the firing rate adaptation is relatively small, the bump oscillation frequency can be analytically solved to be (see also Fig. S2):
<disp-formula id="eqn6">
<graphic xlink:href="516400v4_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
We see that the bump oscillation frequency <italic>ω</italic>increases sublinearly with the external input strength <italic>α</italic> and the adaptation strength <italic>m</italic> (<xref rid="fig2" ref-type="fig">Fig. 2h&amp;i</xref>). By setting the parameters appropriately, the bump can oscillate in the theta band (6-10 Hz), thus approximating the experimentally observed theta sweeps (see below). Notably, LFP theta is not explicitly modelled in the network. However, since theta sweeps are bounded by individual LFP theta cycles in experiments, they share the same oscillation frequency as LFP theta. For convenience, we will frequently use the term LFP theta below and study firing phase shift in individual oscillation cycles.</p>
</sec>
<sec id="s2c">
<title>Oscillatory tracking accounts for both theta phase precession and procession of hippocampal place cells</title>
<p>In our model, the bump center and external input represent the decoded and physical positions of the animal, respectively, thus the oscillatory tracking of the bump around the external input naturally gives rise to the forward and backward theta sweeps observed empirically (<xref rid="fig3" ref-type="fig">Fig. 3a&amp;b</xref>) (<bold><italic><xref ref-type="bibr" rid="c63">Wang et al., 2020</xref></italic></bold>). Here we show that oscillatory tracking of the bump accounts for the theta phase precession and procession of place cell firing.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><p>Oscillatory tracking accounts for theta sweeps and theta phase shift. <bold>a</bold>, Snapshots of the bump oscillation along the linear track in one theta cycle (0 ms - 140 ms). Red triangles indicate the location of the external moving input. <bold>b</bold>, Decoded relative positions based on place cell population activities. Upper panel: experimental data, adapted from <bold><italic><xref ref-type="bibr" rid="c63">Wang et al. (2020</xref></italic></bold>). Lower panel: the relative locations of the bump center (shown by the 10 most active neurons at each timestamp) with respect to the location of the external input (horizontal line) in five theta cycles. <bold>c</bold>, Upper panel: the process of the animal running through the firing field of the probe neuron (large black dot) is divided into three stages: the entry stage (green), the phase shift stage (red) and the departure stage (blue). Lower panel: the displacement between the bump center and the probe neuron as the animal runs through the firing field. The horizontal line represents the location of the probe neuron, which is <italic>x</italic> = 0. <bold>d</bold>, The firing rates of the probe neuron as the animal runs through the firing field. Colored points indicate firing peaks. The trace of the firing rate in the phase shift stage (the dashed box) is enlarged in the sub-figure on the right hand-side, which exhibits both phase precession (red points) and procession (blue points) in successive theta cycles. <bold>e</bold>, The firing phase shift of the probe neuron in successive theta cycles. Red points progress to earlier phases from <italic>π</italic>/2 to −<italic>π</italic>/2 and blues points progress to later phases from <italic>π</italic>/2 to 3<italic>π</italic>/2. The color of the dots represent the peak firing rates, which is also shown in d.</p></caption>
<graphic xlink:href="516400v4_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Without loss of generality, we select the neuron at location <italic>x</italic> = 0 as the probe neuron and examine how its firing phase changes as the external input traverses its firing field (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>). In the absence of explicitly simulated spike times, the firing phase of a neuron in each theta cycle is measured by the moment when the neuron reaches the peak firing rate (see Methods. for modeling spike times in the CANN). Based on <xref ref-type="disp-formula" rid="eqn3">Eqs. 3</xref> &amp; <xref ref-type="fig" rid="fig5">5</xref>, the firing rate of the probe neuron, denoted as <italic>r</italic><sub>0</sub>(<italic>t</italic>), is expressed as
<disp-formula id="eqn7">
<graphic xlink:href="516400v4_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>A</italic><sub><italic>r</italic></sub> <italic>(t)</italic> is the bump height, and <italic>h</italic>(<italic>t</italic>) is an oscillatory moving term denoting the displacement between the bump center and the location of the probe neuron. It is composed of a moving signal <italic>v</italic><sub><italic>ext</italic></sub><italic>t</italic>and an oscillatory signal <italic>c</italic><sub>0</sub> sin <italic>ωt</italic>+ <italic>d</italic><sub>0</sub>, with <italic>c</italic><sub>0</sub> the oscillation amplitude, <italic>ω</italic>the frequency and <italic>d</italic><sub>0</sub> an oscillation offset constant. It can be seen that the firing rate of the probe neuron is determined by two factors, <italic>A</italic><sub><italic>r</italic></sub>(<italic>t</italic>) and <italic>h(t)</italic>. To simplify the analysis below, we assume that the bump height <italic>A</italic><sub><italic>r</italic></sub>(<italic>t</italic>) remains unchanged during bump oscillations (for the case of time-varying bump height, see previous sections). Thus, the firing rate only depends on <italic>h(t)</italic>, which is further determined by two time-varying terms, the oscillation term <italic>c</italic><sub>0</sub> sin <italic>ωt</italic> and the location of the external input <italic>v</italic><sub><italic>ext</italic></sub><italic>t</italic>. The first term contributes to firing rate oscillations of the probe neuron, and the second term contributes to the envelope of neuronal oscillations exhibiting a waxing-and-waning profile over time, as the external input traverses the firing field (the absolute value |<italic>v</italic><sub><italic>ext</italic></sub><italic>t</italic>| first decreases and then increases; see <xref rid="fig3" ref-type="fig">Fig. 3d</xref>, also <bold>video 2</bold>). Such a waxing-and-waning profile agrees well with the experimental data (<bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>). In each LFP theta cycle, the peak firing rate of the probe neuron is achieved when |<italic>h(t)</italic>| reaches a local minima (<xref rid="fig3" ref-type="fig">Fig. 3c&amp;d</xref>). We differentiate three stages as the external input passes through the probe neuron (i.e., the animal travels through the place field of the probe neuron), i.e.,</p>
<list list-type="bullet">
<list-item><p><bold>the entry stage.</bold> As the external input enters the firing field of the probe neuron (moving from left to right), <italic>h(t)</italic> &lt; 0 always holds (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>). In this case, the peak firing rate of the probe neuron in each oscillatory cycle is achieved when <italic>h(t)</italic> reaches the maximum (i.e., |<italic>h(t)</italic>| reaches the minimum). This corresponds to <italic>c</italic><sub>0</sub> sin <italic>ωt = c</italic><sub>0</sub>, i.e., <italic>ωt = π/</italic>2 (<xref rid="fig3" ref-type="fig">Fig. 3e</xref>). This means that the firing phase of the probe neuron at the entry stage is constant, which agrees with experimental observations (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>).</p></list-item>
<list-item><p><bold>the phase shift stage.</bold> As the external input moves into the centre of the firing field, <italic>h(t) =</italic> 0 can be achieved in each oscillatory cycle (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>). Notably, it is achieved twice in each cycle, once as the bump sweeps over the probe neuron in the forward direction and the other as the bump sweeps over the probe neuron in the backward direction. Therefore, there are two firing peaks in each bump oscillation cycle (<xref rid="fig3" ref-type="fig">Fig. 3d</xref>), which are expressed as (by solving <italic>v</italic><sub><italic>ext</italic></sub><italic>t</italic> + <italic>c</italic><sub>0</sub> sin<italic>ωt</italic>+ <italic>d</italic><sub>0</sub> = 0):
<disp-formula id="eqn8">
<graphic xlink:href="516400v4_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>t</italic><sub><italic>f</italic></sub> and <italic>t</italic><sub><italic>b</italic></sub> denote the moments of peak firing in the forward and backward sweeps, respectively, and <italic>ϕ</italic><sub><italic>f</italic></sub> and <italic>ϕ</italic><sub><italic>b</italic></sub> the corresponding firing phases of the probe neuron. As the external input travels from (<italic>−c</italic><sub>0</sub> <italic>− d</italic><sub>0</sub><italic>)</italic> to (<italic>c</italic><sub>0</sub> <italic>− d</italic><sub>0</sub><italic>)</italic>, the firing phase <italic>ϕ</italic><sub><italic>f</italic></sub> in the forward sweep decreases from <italic>π/</italic>2 to −<italic>π</italic>/2, while the firing phase <italic>ϕ</italic><sub><italic>r</italic></sub> <italic>in</italic> the backward sweep increases from <italic>π/</italic>2 to 3<italic>π</italic>/2 (<xref ref-type="fig" rid="fig3">Fig. 3e</xref>). These give rise to the phase precession and procession phenomena, respectively, agreeing well with experimental observations (<bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c63">Wang et al., 2020</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c69">Yamaguchi et al., 2002</xref></italic></bold>).</p></list-item>
<list-item><p><bold>the departure stage.</bold> As the external input leaves the firing field, <italic>h(t)</italic> &gt; 0 always holds (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>), and the peak firing rate of the probe neuron is achieved when <italic>h(t)</italic> reaches its minimum in each oscillatory cycle, i.e., <italic>c</italic><sub>0</sub> sin(<italic>ωt) = −c</italic><sub>0</sub> with <italic>ωt = π/</italic>2 (<xref ref-type="fig" rid="fig3">Fig.3e</xref>). Therefore, the firing phase of the probe neuron is also constant during the departure stage</p></list-item>
</list>
<p>In summary, oscillatory tracking of the CANN well explains the firing phase shift of place cells when the animal traverses their firing fields. Specifically, when the animal enters the place field, the firing phase of the neuron remains constant, i.e., no phase shift occurs, which agrees with experimental observations (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>). As the animal approaches the centre of the place field, the firing phase of the neuron starts to shift in two streams, one to earlier phases during the forward sweeps and the other to later phases during the backward sweeps. Finally, when the animal leaves the place field, the firing phase of the neuron stops shifting and remains constant. Over the whole process, the firing phase of a place cell is shifted by 180 degrees, which agrees with experimental observations (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>).</p>
</sec>
<sec id="s2d">
<title>Different adaptation strengths account for bimodal and unimodal cells</title>
<p>The results above show that during oscillatory tracking, a place cell exhibits both significant phase precession and procession, which are associated with two firing peaks in a theta cycle. These neurons have been described as bimodal cells (<bold><italic><xref ref-type="bibr" rid="c63">Wang et al., 2020</xref></italic></bold>) (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>). Conversely, previous experiments have primarily focused on the phase precession of place cell firing, while tending to ignore phase procession, which is a relatively weaker phenomenon (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>). Place cells with negligible phase procession have been described as unimodal cells (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Different adaptation strengths account for the emergence of bimodal and unimodal cells. <bold>a</bold>, The firing rate trace of a typical bimodal cell in our model (upper panel) and the experiment data (lower panel, adapted from (<bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>)). Blue boxes mark the phase shift stage. Note that there are two peaks in each theta cycle. <bold>b</bold>, The firing rate trace of a typical unimodal cell. Note that there is only one firing peak in each theta cycle. <bold>c</bold>, The averaged bump heights in the forward (blue curve) and backward windows (red curve) as a function of the adaptation strength <italic>m</italic>. <bold>d</bold>, Variation of the bump height when the adaptation strength is relatively small (blue line) or large (red line). <bold>e-f,</bold> Relative location of the bump center in a theta cycle when adaptation strength is relatively small (<bold>e</bold>) or large (<bold>f</bold>). Dashed line separate the forward and backward windows. <bold>g-h</bold>, Theta phase as a function of the normalized position of the animal in place field, averaged over all bimodal cells (<bold>g</bold>) or over all unimodal cells (<bold>h</bold>). <italic>−</italic>1 indicates that the animal just enters the place field, and 1 represents that the animal is about to leave the place field. Dashed lines separate the forward and backward windows. The lower panels in both <bold>g</bold> and <bold>h</bold> present the rescaled colormaps only in the backward window.</p></caption>
<graphic xlink:href="516400v4_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Here, we show that by adjusting a single parameter in the model, i.e., the adaptation strength <italic>m</italic>, neurons in the CANN can exhibit either interleaved phase precession and procession (bimodal cells) or predominant phase precession (unimodal cells). To understand this, we first recall that the firing rate adaptation is a much slower process compared to neural firing and its timescale is in the same order as the LFP theta (i.e., <italic>τ</italic><sub><italic>v</italic></sub> = 100 ms while <italic>τ</italic> = 5 ms). This implies that when the bump sweeps over a neuron, the delayed adaptation it generates will suppress the bump height as it sweeps back to the same location. Furthermore, since the oscillatory tracking always begins with a forward sweep (as the initial sweep is triggered by the external input moving in the same direction), the suppression effects are asymmetric, that is, forward sweeps always strongly suppress backward sweeps. On the contrary, the opposite effect is much smaller, since neuronal activities in backward sweeps have already been suppressed, and they can only generate weak adaptation. Because of this asymmetric suppression, the bump height in the forward sweep is always higher than that in the backward sweep (see <xref rid="fig4" ref-type="fig">Fig. 4c</xref> and Fig. S3a ). When the adaptation strength <italic>m</italic> is small, the suppression effect is not significant, and the attenuation of the bump height during the backward sweep is small (<xref rid="fig4" ref-type="fig">Fig. 4d</xref>). In such case, the firing behavior of a place cell is similar to the situation as the bump height remains unchanged as analyzed in previous sections, i.e., the neuron can generate two firing peaks in a theta cycle at the phase shift stage, manifesting the property of a bimodal cell of having both significant phase precession and procession (<xref rid="fig4" ref-type="fig">Fig. 4e&amp;g</xref> and <bold>video 2</bold> ). When the adaptation strength <italic>m</italic> is large, the bump height in the backward sweep attenuates dramatically (see <xref rid="fig4" ref-type="fig">Fig. 4c&amp;d</xref> and the video demonstration). As a result, the firing peak of a place cell in the backward sweep becomes nearly invisible at the phase shift stage, and the neuron exhibits only predominant phase precession, manifesting the property of a unimodal cell (<xref rid="fig4" ref-type="fig">Fig. 4f&amp;h</xref> and <bold>video 3</bold>).</p>
<p>In summary, different adaptation strengths explain the emergence of bimodal and unimodal cells. In fact, there is no sharp separation between bimodal and unimodal cells. As the firing rate adaptation gets stronger, the network bump is more attenuated during the backwards sweep, and cells with the bimodal firing property will gradually behave more like those with the unimodal firing property (see Fig. S3b). Moreover, our model confirms that even though phase procession is weak, it still exist in unimodal cells (<xref rid="fig4" ref-type="fig">Fig. 4h</xref> lower panel), which has been reported in previous studies (<bold><italic><xref ref-type="bibr" rid="c63">Wang et al., 2020</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c69">Yamaguchi et al., 2002</xref></italic></bold>). This implies that phase procession is not a characteristic feature of bimodal cells, but instead, is likely a common feature of hippocampal activity, with a strength controlled by adaptation. Furthermore, the experimental data (<bold><italic><xref ref-type="bibr" rid="c19">Fernández-Ruiz et al., 2017</xref></italic></bold>) has indicated that there is a laminar difference between unimodal cells and bimodal cells, with bimodal cells correlating more with the firing patterns of deep CA1 neurons and unimodal cells with the firing patterns of superficial CA1 neurons. Our model suggests that this difference may come from the different adaptation strengths in the two layers.</p>
</sec>
<sec id="s2e">
<title>Constant cycling of multiple future scenarios in a T-maze environment</title>
<p>We have shown that our model can reproduce the forward and backward theta sweeps of decoded position when the animal runs on a linear track. It is noteworthy that there is only a single hypothetical future scenario in the linear track environment, i.e, ahead of the animal’s position, and hence place cells firing phase can only encode future positions in one direction. However, flexible behaviors requires the animal encoding multiple hypothetical future scenarios in a quick and constant manner, e.g., during decision-making and planning in complex environments (<bold><italic><xref ref-type="bibr" rid="c36">Johnson and Redish, 2007</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c65">Wikenheiser and Redish, 2015</xref></italic></bold>). One recent study (<bold><italic><xref ref-type="bibr" rid="c40">Kay et al., 2020</xref></italic></bold>) showed constant cycling of theta sweeps in a T-maze environment (<xref rid="fig5" ref-type="fig">Fig. 5a</xref>), that is, as the animal approaches the choice point, the decoded position from hippocampal activity propagates down one of the two arms alternatively in successive LFP theta cycles. To reproduce this phenomenon, we change the structure of the CANN from a linear track shape to a T-maze shape where the neurons are aligned according to the location of their firing fields in the T-maze environment. Neurons are connected with a strength proportional to the Euclidean distance between their firing fields on the T-maze and the parameters are set such that the network is in the oscillatory tracking state (see details in Methods. ). Mimicking the experimental protocol, we let the external input (the artificial animal) move from the end of the center arm to the choice point. At the beginning, when the external input is far away from the choice point, the network bump sweeps back and forth along the center arm, similar to the situation on the linear track. As the external input approaches the choice point, the network bump starts to sweep onto left and right arms alternatively in successive theta cycles (<xref rid="fig5" ref-type="fig">Fig. 5b</xref> and <bold>video 4</bold>; see also <bold><italic><xref ref-type="bibr" rid="c52">Romani and Tsodyks (2015</xref></italic></bold>) for a similar model of cyclical sweeps spanning several theta cycles). The underlying mechanism is straightforward. Suppose that the bump first sweeps to the left arm from the current location, it will sweep back to the current location first due to the attraction of the external input. Then in the next round, the bump will sweep to the right arm, since the neurons on the left arm are suppressed due to adaptation. This cycling process repeats constantly between the two upcoming arms before the external input enters one of the two arms (i.e, before the decision is made). At the single cell level, this bump cycling phenomenon gives rise to the “cycle skipping” effect (<bold><italic><xref ref-type="bibr" rid="c40">Kay et al., 2020</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c12">Deshmukh et al., 2010</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c7">Brandon et al., 2013</xref></italic></bold>), where a neuron whose place field is on one of the two arms fires on every other LFP theta cycle before the decision is made (<xref rid="fig5" ref-type="fig">Fig. 5c</xref> left panel and <xref rid="fig5" ref-type="fig">Fig. 5d</xref> upper panel). For example, a pair of cells with firing fields on each of the two arms will fire in regular alternation on every other theta cycle (<xref rid="fig5" ref-type="fig">Fig. 5c</xref> right panel and <xref rid="fig5" ref-type="fig">Fig. 5d</xref> lower panel). These cell-level firing patterns agree well with the experimental observations (<bold><italic><xref ref-type="bibr" rid="c40">Kay et al., 2020</xref></italic></bold>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><p>Constant cycling of future positions in a T-maze environment. <bold>a</bold>, An illustration of an animal navigating a T-maze environment with two possible upcoming choices (the left and right arms). <bold>b</bold>, Upper panel: Snapshots of constant cycling of theta sweeps on two arms when the animal is approaching the choice point. Red triangle marks the location of the external input. Note that the red triangle moves slightly towards the choice point in the 200 ms duration. Lower panel: Constant cycling of two possible future locations. The black, red and blue traces represent the bump location on the center, left and right arms, respectively. The green line marks the location of the external moving input. <bold>c</bold>, Left panel: the firing rate trace of a neuron A on the left arm when the animal approaches the choice point. Right panel: the firing rate traces of a pair of neurons when the animal approaches the choice point, with neuron A (red) on the left arm and neuron B (blue) on the right arm. Dashed lines separate theta cycles. <bold>d</bold>, Upper panel: the auto-correlogram of the firing rate trace of probe neuron A. Lower panel: the cross-correlogram between the firing rate trace of neuron A and the firing rate trace of neuron B.</p></caption>
<graphic xlink:href="516400v4_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In summary, our model, extended to a T-maze structure, explains the constant cycling of two possible future scenarios in a T-maze environment. The underlying mechanism relies on delayed adaptation, which alternately causes neurons on one arm to be more suppressed than those on the other arm. Such high-speed cycling may contribute to the quick and continuous sampling among multiple future scenarios in real-world decision-making and planning. We also note that there is a cyclical effect in the sweep lengths across oscillation cycles before the animal enters the left or right arm (see <xref rid="fig5" ref-type="fig">Fig. 5b</xref> lower panel), which may be interesting to check in the experimental data in future work (see Discussion for more details).</p>
</sec>
<sec id="s2f">
<title>Robust phase coding of position with place cells</title>
<p>As the firing rate shows large variability when the animal runs through the firing field (<bold><italic><xref ref-type="bibr" rid="c18">Fenton and Muller, 1998</xref></italic></bold>), it has been suggested that the theta phase shift provides an additional mechanism to improve the localization of animals (<bold><italic><xref ref-type="bibr" rid="c49">O’keefe and Burgess, 2005</xref></italic></bold>). Indeed, <bold><italic><xref ref-type="bibr" rid="c35">Jensen and Lisman (2000</xref></italic></bold>) showed that taking phase into account leads to a significant improvement in the accuracy of localizing the animal. To demonstrate the robustness of phase coding, previous experiments showed two intriguing findings: a linear relationship between the firing frequency of place cells and the animal’s moving speed (<bold><italic><xref ref-type="bibr" rid="c26">Geisler et al., 2007</xref></italic></bold>) (<xref rid="fig6" ref-type="fig">Fig. 6a</xref>), and the continued phase shift after interruption of hippocampal activity (<bold><italic><xref ref-type="bibr" rid="c70">Zugaro et al., 2005</xref></italic></bold>) (<xref rid="fig6" ref-type="fig">Fig. 6b</xref>). We show that our model can also reproduce these two phenomena.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><p>Robust phase coding of position. <bold>a</bold>, speed modulation of place cell firing frequency, adapted from <bold><italic><xref ref-type="bibr" rid="c26">Geisler et al. (2007</xref></italic></bold>). Oscillation frequency of the place cell is higher in the faster run trial (blue) then that in the slower run trail (green). The frequency difference is linearly increased with the running speed. <bold>b</bold>, Phase precession is preserved after stimulation-induced perturbation (grey shaded area of the yellow part), adapted from <bold><italic><xref ref-type="bibr" rid="c70">Zugaro et al. (2005</xref></italic></bold>). <bold>c</bold>, left: normalized spectrum of bump oscillation (black curve) and the oscillation of a unimodal cell (blue curve). Right: linear relationship between the frequency difference and the running speed. <bold>d</bold>, same as <bold>c</bold> but for a bimodal cell. <bold>e</bold>, silencing the network activity for 100 ms (grey shaded area) when the external moving input passes through the center part of the place field of a unimodal cell. Theta phase shifts of the unimodal cell are shown with (black points) or without (blue curve) silencing the network.</p></caption>
<graphic xlink:href="516400v4_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To investigate the relationship between the single cell’s oscillation frequency and the moving speed as the animal runs through the firing field, we consider a unimodal cell with predominant phase precession as studied in <bold><italic><xref ref-type="bibr" rid="c26">Geisler et al. (2007</xref></italic></bold>). As we see from <xref rid="fig3" ref-type="fig">Fig. 3d</xref> and <xref rid="fig4" ref-type="fig">Fig. 4a&amp;b</xref>, when the animal runs through the firing field of a place cell, the firing rate oscillates because the activity bump sweeps around the firing field center. Therefore, the firing frequency of a place cell has a baseline theta frequency, which is the same as the bump oscillation frequency. Furthermore, due to phase precession, there will be half a cycle more than the baseline theta cycles as the animal runs over the firing field, and hence single cell oscillatory frequency will be higher than the baseline theta frequency (<xref rid="fig6" ref-type="fig">Fig. 6c</xref>). The faster the animal runs, the faster the extra half cycle can be accomplished. Consequently, the firing frequency will increase more (a steeper slope in <xref rid="fig6" ref-type="fig">Fig. 6c</xref> red dots) than the baseline frequency. This linear relationship ensures that the firing phase of a unimodal cell in each theta cycle is locked with the relative location of the animal in the firing field of that cell, which supports a robust phase-position code. Notably, in our model, the speed modulation of the place cells’ firing frequency is not the cause of theta phase shift, but rather a result of oscillatory tracking. This is different from the dual oscillator model (<bold><italic><xref ref-type="bibr" rid="c42">Lengyel et al., 2003</xref></italic></bold>), which assumes that phase precession is caused by a speed-dependent increase in the dendritic oscillation frequency (see Discussion for more details).</p>
<p>In a different experiment, (<bold><italic><xref ref-type="bibr" rid="c70">Zugaro et al., 2005</xref></italic></bold>) found that the firing phase of a place cell continues to precess even after hippocampal activity was transiently silenced for up to 250 ms (around 2 theta cycles) (<xref rid="fig6" ref-type="fig">Fig. 6b</xref>). To reproduce this phenomenon, we also study a unimodal cell by manually turning off the network activity for a few hundred milliseconds (by setting <italic>r</italic>(<italic>x, t)</italic> = 0 for all neurons) and then letting the network dynamics evolves again with all parameters unchanged. Based on the theoretical analysis (<xref ref-type="disp-formula" rid="eqn8">Eq. 8</xref>), we see that the firing phase is determined by the location of the animal in the place field, i.e., <italic>v</italic><sub><italic>ext</italic></sub><italic>t</italic>. This means that the firing phase keeps tracking the animal’s physical location. No matter how long the network is inactivated, the new firing phase will only be determined by the new location of the animal in the place field. Therefore, the firing phase in the first bump oscillation cycle after the network perturbation is more advanced than the firing phase in the last bump oscillation cycle right before the perturbation, and the amount of precession is similar to that in the case without perturbation (<xref rid="fig6" ref-type="fig">Fig. 6e</xref>). This agrees well with the experimental observation (<xref rid="fig6" ref-type="fig">Fig. 6b</xref>), and indicates that the phase-position code is robust to the perturbation of the hippocampal dynamics.</p>
<p>Overall, our model reproduces these two experimental findings, and suggests that there exists a one-to-one correspondence between the firing phase of a place cell and the travelled distance in the neuron’s place field, which is independent of the animal’s running speed or the perturbation duration (Fig. S4). This agrees well with experimental observations (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>) that theta phase correlates better with the animal’s location than with time (<xref rid="fig6" ref-type="fig">Fig. 6f&amp;g</xref>). In addition to the results for unimodal cells as introduced above, our model predicts new results for bimodal cells. First, in contrast to a unimodal cell, a bimodal cell will have two peaks in its firing frequency, with one slightly higher than the LFP theta baseline (due to phase precession) and the other slightly lower than the LFP theta baseline (due to phase procession). The precession-associated frequency positively correlates with the running speed of the animal, while the procession-associated frequency negatively correlates with the running speed (<xref rid="fig6" ref-type="fig">Fig. 6d</xref>). Second, similar to the preserved phase shift in unimodal cells, both the phase precession and procession of a bimodal cell after transient intrahippocampal perturbation continue from the new location of the animal (see Fig. S5), no matter how long the silencing period lasts. The two predictions could be tested by experiments.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<sec id="s3a">
<title>Model contributions</title>
<p>In this paper, we have proposed a CANN with firing rate adaptation to unveil the underlying mechanism of place cell phase shift during locomotion. We show that the interplay between intrinsic mobility (owing to firing rate adaptation) and extrinsic mobility (owing to the location-dependent sensory inputs) leads to an oscillatory tracking state, which naturally accounts for theta sweeps where the decoded position oscillates around the animal’s physical location at the theta rhythm. At the single neuron level, we show that the forward and backward bump sweeps account for, respectively, phase precession and phase procession. Furthermore, we show that the varied adaptation strength explains the emergence of bimodal and unimodal cells, that is, as the adaptation strength increases, forward sweeps of the bump gradually suppress backward sweeps, and as a result, neurons initially exhibiting both significant phase precession and procession (due to a low level adaptation) will gradually exhibit only predominant phase precession (due to a high level adaptation).</p>
</sec>
<sec id="s3b">
<title>Computational models for theta phase shift and theta sweeps</title>
<p>As a subject of network dynamics, oscillatory tracking has been studied previously in an excitatory-inhibitory neural network (<bold><italic><xref ref-type="bibr" rid="c20">Folias and Bressloff, 2004</xref></italic></bold>), where it was found that decreasing the external input strength can lead to periodic emission of traveling waves in the network (Hopf instability), which is analogous to the oscillatory tracking state in our model. However, their focus was on the mathematical analysis of such dynamical behavior, while our focus is on the biological implications of oscillatory tracking, i.e., how can it be linked to phase precession and procession of hippocampal place cells.</p>
<p>Due to their potential contributions to the temporal sequence learning involved in spatial navigation and episodic memory (<bold><italic><xref ref-type="bibr" rid="c46">Mehta et al., 1997</xref>, <xref ref-type="bibr" rid="c45">2002</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c68">Yamaguchi, 2003</xref></italic></bold>), theta phase precession and forward theta sweeps have been modelled in the field for decades. These models can be divided into two main categories, with one relying on the mechanism of single cell oscillation (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c37">Kamondi et al., 1998</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c42">Lengyel et al., 2003</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c49">O’keefe and Burgess, 2005</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c45">Mehta et al., 2002</xref></italic></bold>), and the other relying on the mechanism of recurrent interactions between neurons (<bold><italic><xref ref-type="bibr" rid="c60">Tsodyks et al., 1996</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c52">Romani and Tsodyks, 2015</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c38">Kang and DeWeese, 2019</xref></italic></bold>). A representative example of the former is the oscillatory interference model (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c42">Lengyel et al., 2003</xref></italic></bold>), which produces phase precession via the superposition of two oscillatory signals, with one from the baseline somatic oscillation at the LFP theta frequency (reflecting the inputs from the medial septal pacemaker (<bold><italic><xref ref-type="bibr" rid="c56">Stewart and Fox, 1990</xref></italic></bold>)), and the other from the dendritic oscillation whose frequency is slightly higher. While these models can explain a large variety of experimental phenomena, it remain unclear how oscillation of individual neurons has a frequency higher than the baseline theta frequency. Here, our model provides a network mechanism for how such higher-frequency oscillation emerges.</p>
<p>A representative model relying on neuronal recurrent interactions is the activation spreading model (<bold><italic><xref ref-type="bibr" rid="c60">Tsodyks et al., 1996</xref></italic></bold>). This model produces phase precession via the propagation of neural activity along the movement direction, which relies on asymmetric synaptic connections. A later version of this model considers short-term synaptic plasticity (short-term depression) to implicitly implement asymmetric connections between place cells (<bold><italic><xref ref-type="bibr" rid="c52">Romani and Tsodyks, 2015</xref></italic></bold>), and reproduces many other interesting phenomena, such as phase precession in different environments. Different from these two models, our model considers firing rate adaptation to implement symmetry breaking and hence generates activity propagation. To prevent the activity bump from spreading away, their model considers an external theta input to reset the bump location at the end of each theta cycle, whereas our model generates an internal oscillatory state, where the activity bump travels back due to the attraction of external location input once it spreads too far away. Moreover, theoretical analysis of our model reveals how the adaptation strength affect the direction of theta sweeps, as well as offers a more detailed understanding of theta cycling in complex environments.</p>
<p>Based on our simulation, both STD and SFA show the ability to produce bi-directional sweeps within a CANN model, with the SFA uniquely enabling uni-directional sweeps in the absence of external theta inputs. This difference might be due to the lack of exhaustively exploration of the entire parameter space. However, it might also attribute to the subtle yet important theoretical distinctions between STD and SFA. Specifically, STD attenuates the neural activity through a reduction in recurrent connection strength, whereas SFA provides inhibitory input directly to the neurons, potentially impacting all excitatory inputs. These differences might explain the diverse dynamical behaviors observed in our simulations. Future experiments could clarify these distinctions by monitoring changes in synaptic strength and inhibitory channel activation during theta sweeps.</p>
</sec>
<sec id="s3c">
<title>Beyond the linear track environment</title>
<p>Besides the linear track environment, the mechanism of generating theta sweeps proposed in our model can also be generalized to more complex environments. For instance, in a T-maze environment, our model explains the constant cycling of theta sweeps between left and right arms. Such cycling behavior may be important for high-speed actions such as predating and escaping which require animals to make decision among several future scenarios at the sub-second level. Similar alternative activity sweeps in the T-maze environment has been studied in a previous paper (<bold><italic><xref ref-type="bibr" rid="c52">Romani and Tsodyks, 2015</xref></italic></bold>), which showed that the frequency of alternation correlates with overtly deliberative behaviors such as head scans (frequency at 1 Hz or less) (<bold><italic><xref ref-type="bibr" rid="c36">Johnson and Redish, 2007</xref></italic></bold>). In contrast to our model, the network activity in their model propagates continuously from the current location on the center arm till the end of the outer arm, which takes a few theta cycles (i.e., 1 second or more). In our model, the network bump alternately sweeps to one of the two outer arms at a much higher frequency (∼ 8 Hz), which may be related to fast decision-making or planing in natural environments (<bold><italic><xref ref-type="bibr" rid="c40">Kay et al., 2020</xref></italic></bold>). Furthermore, our model can also be easily extended to the multiple-arms (&gt; 2) environment (<bold><italic><xref ref-type="bibr" rid="c27">Gillespie et al., 2021</xref></italic></bold>) or the cascade-T environment (<bold><italic><xref ref-type="bibr" rid="c36">Johnson and Redish, 2007</xref></italic></bold>) with the underlying mechanism of generating theta cycling remaining unchanged. In addition to the linear and T-maze environments, phase shift has also been reported when an animal navigates in an open field environment. However, due to the lack of recorded neurons, decoding theta sweeps in the 2D environment is not as straightforward as in the 1D case. While theta sweeps in the 1D case have been associated with goal-directed behaviors and spatial planning (<bold><italic><xref ref-type="bibr" rid="c65">Wikenheiser and Redish, 2015</xref></italic></bold>), it remains unclear whether such conclusion is applicable to the 2D case. Our preliminary result shows that in the 2D CANN where neurons are arranged homogeneously according to their relative firing locations, the activity bump will sweep along the tangent direction of the movement trajectory, similar to the 1D case (see SI.4 and Fig. S6 for details). It will be interesting to explore theta sweeps in the open field environment in detail when more experimental data is available.</p>
</sec>
<sec id="s3d">
<title>Model predictions and future works</title>
<p>Our model has several predictions which can be tested in future experiments. For instance, the height of the activity bump in the forward sweep window is higher than that in the backward sweep window (<xref rid="fig4" ref-type="fig">Fig. 4c</xref>) due to the asymmetric suppression effect from the adaptation. For bimodal cells, they will have two peaks in their firing frequency as the animal runs across the firing fields, with one corresponding to phase precession and the other corresponding to phase procession. Similar to unimodal cells, both the phase precession and procession of a bimodal cell after transient intrahippocampal perturbation will continue from the new location of the animal (Fig. S5). Interestingly, our model of the T-maze environment showed an expected phenomenon that as the animal runs towards the decision point, the theta sweep length also shows cyclical patterns (<xref rid="fig5" ref-type="fig">Fig. 5b</xref> lower panel). An intuitive explanation is that, due to the slow dynamics in firing rate adaptation (with a large time constant compared to neural firing), a long sweep leads to an adaptation effect on the neurons at the end of the sweep path. Consequently, the activity bump cannot travel as far due to the adaptation effect on those neurons, resulting in a shorter sweep length compared to the previous one. In the next round, the activity bump exhibits a longer sweep again because those neurons have recovered from the previous adaptation effect. We plan to test this phenomenon in future experiments.</p>
<p>In the current study, we have modeled the place-cell population in the hippocampus with a CANN and adopted firing rate adaptation to generate theta phase shift. In fact, this model can be easily extended to the grid cell population without changing the underlying mechanism. For instance, we can induce the torus-like connection profile (periodic boundary in the 2D space) (<bold><italic><xref ref-type="bibr" rid="c53">Samsonovich and McNaughton, 1997</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c44">McNaughton et al., 2006</xref></italic></bold>) or the locally inhibitory connection profile (<bold><italic><xref ref-type="bibr" rid="c9">Burak and Fiete, 2009</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c11">Couey et al., 2013</xref></italic></bold>) in the CANN structure to construct a grid cell model, and by imposing firing rate adaptation, neurons in the grid cell network will also exhibit phase shift as the animal moves through the grid field, as reported in previous experimental studies (<bold><italic><xref ref-type="bibr" rid="c28">Hafting et al., 2008</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c61">Van Der Meer and Redish, 2011</xref></italic></bold>). Notably, although for both grid cells and place cells, CANNs can generate theta phase shift, it does not mean that they are independent from each other. Instead, they might be coordinated by the same external input from the environment, as well as by the medial septum which is known to be a pacemaker that synchronises theta oscillations across different brain regions (<bold><italic><xref ref-type="bibr" rid="c41">King et al., 1998</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c64">Wang, 2002</xref></italic></bold>). We will investigate this issue in future work.</p>
<p>Our model also suggests that the “online” theta sweep and the “offline” replay may share some common features in their underlying mechanisms (<bold><italic><xref ref-type="bibr" rid="c52">Romani and Tsodyks, 2015</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c32">Hopfield, 2010</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c38">Kang and DeWeese, 2019</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c33">Jahnke et al., 2015</xref></italic></bold>). We have shown that the activity bump with strong adaptation can move spontaneously when the external input becomes weak enough (see previous sections). Such non-local spreading of neural activity has a speed much faster than the conventional speed of animals (the external input speed in our model, see <xref rid="fig2" ref-type="fig">Fig. 2d</xref>), which resembles the fast spreading of the decoded position during sharp-wave ripple events (<bold><italic><xref ref-type="bibr" rid="c13">Diba and Buzsáki, 2007</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c22">Foster and Wilson, 2006</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c39">Karlsson and Frank, 2009</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c15">Dragoi and Tonegawa, 2011</xref></italic></bold>). This indicates that these two phenomena may be generated by the same neural mechanism of firing rate adaptation, with theta sweeps originating from the interplay between the adaptation and the external input, while replay originating from only the adaptation, since the external input is relatively weak during the “offline” state. This hypothesis seems to be supported by the coordinated emergence of theta sequences and replays during the post-natal development period (<bold><italic><xref ref-type="bibr" rid="c48">Muessig et al., 2019</xref></italic></bold>), as well as their simultaneous degradation when the animal travelled passively on a model train (<bold><italic><xref ref-type="bibr" rid="c16">Drieu et al., 2018</xref></italic></bold>).</p>
<p>Nevertheless, it is important to note that the CANN we adopt in the current study is an idealized model for the place cell population, where many biological details are missed (<bold><italic><xref ref-type="bibr" rid="c2">Amari, 1977</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c59">Tsodyks and Sejnowski, 1995</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c53">Samsonovich and McNaughton, 1997</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c58">Tsodyks, 1999</xref></italic></bold>). For instance, we have assumed that neuronal synaptic connections are translation-invariant in the space. In practice, such a connection pattern may be learned by a synaptic plasticity rule at the behavioral time scale when the animal navigates actively in the environment (<bold><italic><xref ref-type="bibr" rid="c6">Bittner et al., 2017</xref></italic></bold>). In future work, we will explore the detailed implementation of this connection pattern, as well as other biological correspondences of our idealized model, to establish a comprehensive picture of how theta phase shift is generated in the brain.</p>
</sec>
</sec>
<sec id="s4">
<title>Materials and Methods</title>
<sec id="s4a">
<title>General summary of the model</title>
<p>We consider a one-dimensional continuous attractor neural network (1D CANN), in which neurons are uniformly aligned according to their firing fields on a linear track (for the T-maze case, see Methods. below; for the case of the open field (2D CANN), see SI.4). Denote <italic>U (x, t</italic>) the synaptic input received by the place cell at location <italic>x</italic>, and <italic>r</italic>(<italic>x, t)</italic> the corresponding firing rate. The dynamics of the network is written as
<disp-formula id="eqn9">
<graphic xlink:href="516400v4_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>τ</italic> is the time constant of <italic>U (x, t</italic>) and <italic>ρ</italic> the neuron density. The firing rate <italic>r</italic>(<italic>x, t)</italic> is given by
<disp-formula id="eqn10">
<graphic xlink:href="516400v4_eqn10.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>k</italic> controls the strength of the global inhibition (divisive normalization), <italic>g</italic>denotes a gain factor. <italic>J</italic> (<italic>x, x</italic><sup>′</sup>) denotes the connection weight between place cells at location <italic>x</italic> and <italic>x</italic><sup>′</sup>, which is written as:
<disp-formula id="eqn11">
<graphic xlink:href="516400v4_eqn11.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>J</italic><sub>0</sub> controls the strength of the recurrent connection and <italic>a</italic> the range of neuronal interaction. Notably, <italic>J</italic> (<italic>x, x</italic><sup>′</sup>) depends on the relative distance between two neurons, rather than the absolute locations of neurons. Such translation-invariant connection form is crucial for the neutral stability of the attractor states of CANNs (<bold><italic><xref ref-type="bibr" rid="c67">Wu et al., 2016</xref></italic></bold>). <italic>I</italic><sup><italic>ext</italic></sup><italic>(x, t</italic>) represents the external input which conveys the animal location information to the hippocampal network, which is written as:
<disp-formula id="eqn12">
<graphic xlink:href="516400v4_eqn12.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
with <italic>v</italic><sub><italic>ext</italic></sub> denoting the animal’s running speed and <italic>α</italic> controlling the input strength to the hippocampus. <italic>σ</italic> denotes the width of the external input <italic>I</italic><sup><italic>ext</italic></sup>, which is set to be equal to the recurrent connection width <italic>a</italic> in the main text and the following derivation. <italic>V (x, t</italic>) denotes the adaptation effect of the place cell at location <italic>x</italic>, which increases with the synaptic input (and hence the place cell’s firing rate), i.e.,
<disp-formula id="eqn13">
<graphic xlink:href="516400v4_eqn13.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
with <italic>τ</italic><sub><italic>v</italic></sub> denoting the time constant of <italic>V (x, t</italic>) and <italic>m</italic> the adaptation strength. Note that <italic>τ</italic><sub><italic>v</italic></sub> ≫ <italic>τ</italic>, meaning that adaptation is a much slower process compared to the neural firing.</p>
</sec>
<sec id="s4b">
<title>Stability analysis of the bump state</title>
<p>We derive the condition under which the bump activity is the stable state of the CANN. For simplicity, we consider the simplest case that there is no external input and adaptation in the network, i.e., <italic>m</italic> = <italic>α</italic> = 0. In this case, the network state is determined by the strength of the recurrent excitation and global inhibition. When the global inhibition is strong (<italic>k</italic> is large), the network is silent, i.e., no bump activity emerges in the CANN. When the global inhibition is small, an activity bump with the Gaussian-shaped profile emerges, which is written as:
<disp-formula id="eqn14">
<graphic xlink:href="516400v4_eqn14.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn15">
<graphic xlink:href="516400v4_eqn15.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
with <italic>A</italic><sub><italic>u</italic></sub> and <italic>A</italic><sub><italic>r</italic></sub> representing the amplitudes of the synaptic input bump and the firing rate bump, respectively. <italic>z</italic>(<italic>t</italic>) represents the bump center, and <italic>a</italic> is the range of neuronal interaction (defined in Methods. ). To solve the network dynamics, we substitute <xref ref-type="disp-formula" rid="eqn14">Eqs. 14</xref>&amp;<xref ref-type="disp-formula" rid="eqn15">15</xref> into <xref ref-type="disp-formula" rid="eqn9">Eqs. 9</xref>&amp;<xref ref-type="disp-formula" rid="eqn10">10</xref>, which gives (see SI.2 for more details of the derivation):
<disp-formula id="eqn16">
<graphic xlink:href="516400v4_eqn16.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn17">
<graphic xlink:href="516400v4_eqn17.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
These two equations describes how the bump amplitudes change with time. For instance, if neurons are weakly connected (small <italic>J</italic><sub>0</sub>) or they are connected sparsely (small <italic>ρ</italic>), the second term on the right-hand side of <xref ref-type="disp-formula" rid="eqn16">Eq. 16</xref> is small, and <italic>A</italic><sub><italic>u</italic></sub> will decay to zero, implying that the CANN cannot sustain a bump activity. By setting <italic>dA</italic><sub><italic>u</italic></sub><italic>/dt</italic> = 0, we obtain:
<disp-formula id="eqn18">
<graphic xlink:href="516400v4_eqn18.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn19">
<graphic xlink:href="516400v4_eqn19.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
It is straightforward to check that only when:
<disp-formula id="eqn20">
<graphic xlink:href="516400v4_eqn20.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<italic>A</italic><sub><italic>u</italic></sub> have two real solutions (indicated by the ± sign in <xref ref-type="disp-formula" rid="eqn18">Eq. 18</xref>), i.e., the dynamic system (<xref ref-type="disp-formula" rid="eqn16">Eqs. 16</xref>&amp;<xref ref-type="disp-formula" rid="eqn17">17</xref>) has two fixed points. It can be checked that only <inline-formula><inline-graphic xlink:href="516400v4_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the stable solution.</p>
</sec>
<sec id="s4c">
<title>Analysis of the intrinsic mobility of the bump state</title>
<p>We derive the condition under which the bump of the CANN moves spontaneously in the attractor space without relying on external inputs. As the adaptation strength increases, the bump activity becomes unstable and has tendency to move away from its location spontaneously. Such intrinsic mobility of the CANN has been shown in previous studies (<bold><italic><xref ref-type="bibr" rid="c8">Bressloff, 2011</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c67">Wu et al., 2016</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c47">Mi et al., 2014</xref></italic></bold>). We set <italic>α</italic> = 0 (no external input), and investigate the effect of adaptation strength <italic>m</italic> on the bump dynamics. Our simulation result shows that during the spontaneous movement, <italic>V (x, t</italic>) can also be represented by a Gaussian-shaped bump, which is written as
<disp-formula id="eqn21">
<graphic xlink:href="516400v4_eqn21.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>A</italic><sub><italic>v</italic></sub> denotes the amplitude of the adaptation bump, and <italic>d</italic>(<italic>t</italic>) the displacement between the bump centers of <italic>U (x, t</italic>) and <italic>V (x, t</italic>). This displacement originates from the slow dynamics of adaptation, which leads to the adaptation bump always lags behind the neural activity bump. Similar to Methods., we substitute the bump profiles <xref ref-type="disp-formula" rid="eqn14">Eqs. (14</xref>, <xref ref-type="disp-formula" rid="eqn15">15</xref>, <xref ref-type="disp-formula" rid="eqn21">21</xref>) into the network dynamics <xref ref-type="disp-formula" rid="eqn9">Eqs. (9</xref>, <xref ref-type="disp-formula" rid="eqn10">10</xref>, <xref ref-type="disp-formula" rid="eqn13">13</xref>), and obtain:
<disp-formula id="eqn22">
<graphic xlink:href="516400v4_eqn22.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn23">
<graphic xlink:href="516400v4_eqn23.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn24">
<graphic xlink:href="516400v4_eqn24.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where 𝒩 (<italic>x, z</italic>, 2<italic>a</italic>) = exp{− [<italic>x − z</italic>]<sup>2</sup>/4<italic>a</italic><sup>2</sup>}.</p>
<p>At first glance, the resulting equations given by <xref ref-type="disp-formula" rid="eqn22">Eqs. (22)</xref> and <xref ref-type="disp-formula" rid="eqn24">(24)</xref> may seem intractable due to the high dimensionality (i.e., 2<italic>N</italic>, where <italic>N</italic> is the number of neurons in the network). However, a key property of CANNs is that their dynamics are dominated by a few motion modes, which correspond to distortions of the bump shape in terms of height, position, width, etc. <bold><italic><xref ref-type="bibr" rid="c25">Fung et al. (2010</xref></italic></bold>). By projecting the network dynamics onto its dominant motion modes <bold><italic><xref ref-type="bibr" rid="c25">Fung et al. (2010</xref></italic></bold>) (which involves computing the inner product of a function <italic>f(x)</italic> with a mode <italic>u</italic><sub><italic>n</italic></sub><italic>(x))</italic>, we can significantly simplify the network dynamics. Typically, projecting onto the first two motion modes is sufficient to capture the main features of the dynamics, which are given by,
<disp-formula id="eqn25">
<graphic xlink:href="516400v4_eqn25.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn26">
<graphic xlink:href="516400v4_eqn26.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
By projecting the network dynamics onto these two motion modes, we obtain:
<disp-formula id="eqn27">
<graphic xlink:href="516400v4_eqn27.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn28">
<graphic xlink:href="516400v4_eqn28.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn29">
<graphic xlink:href="516400v4_eqn29.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn30">
<graphic xlink:href="516400v4_eqn30.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Note that we assume that the bump height keep as constant over time, i.e., <italic>dA</italic><sub><italic>u</italic></sub><italic>/dt</italic> = <italic>dA</italic><sub><italic>v</italic></sub><italic>/dt</italic> = 0 is assumed. <xref ref-type="disp-formula" rid="eqn27">Eqs. 27</xref>-<xref ref-type="disp-formula" rid="eqn30">30</xref> describes the relationships between bump features <italic>A</italic><sub><italic>u</italic></sub>, <italic>A</italic><sub><italic>r</italic></sub>, <italic>A</italic><sub><italic>v</italic></sub>, <italic>v</italic><sub><italic>int</italic></sub> and <italic>d</italic>, where <italic>v</italic><sub><italic>int</italic></sub> <italic>= dz/dt</italic> representing the intrinsic moving speed of the bump center. By solving these equations together with <xref ref-type="disp-formula" rid="eqn23">eqn. 23</xref>, we obtain,
<disp-formula id="eqn31">
<graphic xlink:href="516400v4_eqn31.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn32">
<graphic xlink:href="516400v4_eqn32.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn33">
<graphic xlink:href="516400v4_eqn33.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn34">
<graphic xlink:href="516400v4_eqn34.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn35">
<graphic xlink:href="516400v4_eqn35.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<xref ref-type="disp-formula" rid="eqn31">Eqs. 31</xref>-<xref ref-type="disp-formula" rid="eqn33">33</xref> describe the amplitudes of the bumps of synaptic input, firing rate, and adaptation in the CANN, respectively, and <xref ref-type="disp-formula" rid="eqn34">Eq. 34</xref> describes the displacement between the neural activity and adaptation bumps. From <xref ref-type="disp-formula" rid="eqn35">Eq. 35</xref>, we see that for the bump to travel spontaneously, it requires <italic>m</italic> &gt; <italic>τ/τ</italic><sub><italic>v</italic></sub>, i.e., the adaptation strength is larger than a threshold given by the ratio between two time constants <italic>τ</italic> and <italic>τ</italic><sub><italic>v</italic></sub>. As the adaptation strength increases (larger <italic>m</italic>), the travelling speed of the bump increases (larger <italic>v</italic><sub><italic>int</italic></sub><italic>)</italic>.</p>
</sec>
<sec id="s4d">
<title>Analysis of the oscillatory tracking behaviour of the bump state</title>
<p>When both the external input and the adaptation are applied to the CANN, the bump activity can oscillate around the external input if the strengths of the external input and the adaptation are appropriated. The simulation shows that during the oscillatory tracking, the bump shape is roughly unchanged, and the oscillation of the bump center can be approximated as a sinusoidal wave expressed as:
<disp-formula id="eqn36">
<graphic xlink:href="516400v4_eqn36.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>c</italic><sub>0</sub> and <italic>ω</italic>denote, respectively, the oscillation amplitude and frequency, and <italic>d</italic><sub>0</sub> denotes a constant offset between the oscillation center and the external input.</p>
<p>Similar to the analysis in Methods., we substitute the expression of <italic>z</italic>(<italic>t</italic>) (<xref ref-type="disp-formula" rid="eqn36">Eq. 36</xref>) into <xref ref-type="disp-formula" rid="eqn14">Eqs. (14</xref>, <xref ref-type="disp-formula" rid="eqn15">15</xref>, <xref ref-type="disp-formula" rid="eqn21">21</xref>), and then simplify the network dynamics by applying the projection method (see SI.3 for more detailed derivation). We obtain,
<disp-formula id="eqn37">
<graphic xlink:href="516400v4_eqn37.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn38">
<graphic xlink:href="516400v4_eqn38.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn39">
<graphic xlink:href="516400v4_eqn39.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn40">
<graphic xlink:href="516400v4_eqn40.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn41">
<graphic xlink:href="516400v4_eqn41.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<xref ref-type="disp-formula" rid="eqn37">Eqs. 37</xref>-<xref ref-type="disp-formula" rid="eqn41">41</xref> describe the relationships among 6 oscillation features <italic>A</italic><sub><italic>u</italic></sub>, <italic>A</italic><sub><italic>r</italic></sub>, <italic>A</italic><sub><italic>v</italic></sub>, <italic>c</italic><sub>0</sub>, <italic>d</italic><sub>0</sub> and <italic>ω</italic>. By solving these equations, we obtain:
<disp-formula id="eqn42">
<graphic xlink:href="516400v4_eqn42.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn43">
<graphic xlink:href="516400v4_eqn43.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn44">
<graphic xlink:href="516400v4_eqn44.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn45">
<graphic xlink:href="516400v4_eqn45.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn46">
<graphic xlink:href="516400v4_eqn46.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn47">
<graphic xlink:href="516400v4_eqn47.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
It can be seen from <xref ref-type="disp-formula" rid="eqn45">Eq. 45</xref> that for the bump activity to oscillate around the external input (i.e., the oscillation amplitude <italic>c</italic><sub>0</sub> &gt; 0), it requires that 8<italic>a</italic><sup>2</sup> ln <inline-formula><inline-graphic xlink:href="516400v4_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula> . This condition gives the boundary (on the parameter values of the input strength <italic>α</italic> and the adaptation strength <italic>m</italic>) that separate two tracking states, i.e., smooth tracking and oscillatory tracking (see <xref rid="fig2" ref-type="fig">Fig. 2g</xref> and Fig. S2 for the comparison between the simulation results and theoretical results).</p>
<p>Note that to get the results in <xref ref-type="disp-formula" rid="eqn37">Eqs. 37</xref>-<xref ref-type="disp-formula" rid="eqn41">41</xref>, we have assumed that the amplitudes of neural activity bumps and the adaptation bump remain unchanged during the oscillation (i.e., <italic>A</italic><sub><italic>u</italic></sub>, <italic>A</italic><sub><italic>v</italic></sub>, <italic>A</italic><sub><italic>r</italic></sub> are constants). However, this assumption is not satisfied when the SFA strength <italic>m</italic> is large (see previous sections and <xref rid="fig4" ref-type="fig">Fig. 4</xref>). In such a case, we carry out simulation to analyze the network dynamics.</p>
</sec>
<sec id="s4e">
<title>Implementation details of the linear track environment</title>
<p>For the linear track environment, we simulate an 1D CANN with 512 place cells topographically organized on the one-dimensional neuronal track. Since we are interested in how the neuronal firing phase shifts as the animal moves through the firing field of a place cell, we investigate the place cell at location <italic>x</italic> = 0 and ignore the boundary effect, that is, we treat the linear track with the infinite length. The neural firing time constant is set to be 3 ms, while the time constant of spike frequency adaptation is much longer, which is set to be 144 ms. The density of place cells on the linear track is set to be 256<italic>/π.</italic>The excitatory interaction range of place cells is set to be 0.4<italic>m</italic>, while the maximum excitatory connection strength <italic>J</italic><sub>0</sub> is set to be 0.2. The gain factor is set to be 5. The global inhibition strength <italic>k</italic> is set to be 5. The moving speed of the virtual animal <italic>v</italic><sub><italic>ext</italic></sub> is set to be 1.5 m/s. For the simulation details, we use the first-order Euler method with the time step <italic>δt</italic> set to be 0.3 the duration of simulation <italic>T</italic> set to be 10 s. These parameters are commonly used in all plots related to the linear track environment (see <xref ref-type="table" rid="tbl1">Table.1</xref> for a summary).</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>Commonly used parameter values in the simulation of the linear track environment.</title></caption>
<graphic xlink:href="516400v4_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>For the two key parameters, i.e., the external input strength <italic>α</italic> and the adaptation strength <italic>m</italic>, we vary their values in different plots. Specifically, for illustrating the smooth tracking state in <xref rid="fig2" ref-type="fig">Fig. 2c</xref>, we set <italic>α</italic> = 0.19 and <italic>m</italic> = 0. For illustrating the travelling wave state (intrinsic mobility of the bump state) in <xref rid="fig2" ref-type="fig">Fig. 2d</xref>, we set <italic>α</italic> = 0 and <italic>m</italic> = 0.31. For plotting the relationship between the intrinsic speed <italic>v</italic><sub><italic>int</italic></sub> and the adaptation strength <italic>m</italic> shown in <xref rid="fig2" ref-type="fig">Fig. 2e</xref>, we keep <italic>α</italic> = 0, but vary <italic>m</italic> in the range between 0 and 0.1 with a step of 0.05. For plotting the overall phase diagram including all three moving states as shown in <xref rid="fig2" ref-type="fig">Fig. 2g</xref>, we vary <italic>α</italic> in the range between 0.05 and 0.16 with a step of 0.001, and <italic>m</italic> in the range between 0.9 and 1.8 with a step of 0.01. To generate bimodal cell firing patterns in <xref rid="fig3" ref-type="fig">Fig. 3a</xref> and <xref rid="fig4" ref-type="fig">Fig. 4a,e&amp;g</xref>, we choose <italic>α</italic> = 0.19 and <italic>m</italic> = 3.02. To generate unimodal firing patterns in <xref rid="fig4" ref-type="fig">Fig. 4b,f&amp;h</xref>, we choose <italic>α</italic> = 0.19 but a relatively larger adaptation strength with <italic>m</italic> = 3.125. The values of these two parameters in different plots are summarized in <xref ref-type="table" rid="tbl2">Table. 2</xref>.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><title>Figure specific parameter values for input strength <italic>α</italic> and adaptation strength <italic>m</italic>.</title></caption>
<graphic xlink:href="516400v4_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s4f">
<title>Implementation details of the T-maze environment</title>
<sec id="s4f1">
<title>Parameter configurations during simulation</title>
<p>To simulate the T-maze environment, we consider a CANN in which place cells are topographically organized in a T-shaped area which consists of a vertical central arm and two horizontal left and right arms (<xref rid="fig5" ref-type="fig">Fig. 5a</xref>). The width of the central arm is set to be 0.84 m and the length is set to be 3.14 m. The widths of the two horizontal arms are also set to be 0.84 m, while the lengths of both arms are set to be 2.36 m. The connection strength between two neurons is determined by the distance between them, which is written as:
<disp-formula id="eqn48">
<graphic xlink:href="516400v4_eqn48.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Here (<italic>x, y)</italic> and (<italic>x</italic><sup>′</sup>, <italic>y</italic><sup>′</sup>) represent the coordinates of two neurons in the T-maze environment, <italic>a</italic> is the recurrent connection range which is set to be 0.3, and <italic>J</italic><sub>0</sub> controls the connection strength which is set to be 0.0125. Since we are interested in investigating theta sweeps when the animal is running on the central arm towards the junction point, the external input is restricted on the central arm which is modelled by a Gaussian-like moving bump written as:
<disp-formula id="eqn49">
<graphic xlink:href="516400v4_eqn49.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>x</italic><sub>0</sub> = 0 and <italic>y</italic><sub>0</sub> <italic>= v</italic><sub><italic>ext</italic></sub><italic>t</italic>represent the center location of the external input with a moving speed <italic>v</italic><sub><italic>ext</italic></sub> = 1.5 m/s. In the simulation, we used the first-order Euler method with the time step <italic>δt</italic> = 0.3 s and the duration of simulation <italic>T</italic> = 4.2<italic>s</italic>. The parameters used are summarized in <xref ref-type="table" rid="tbl3">Table.3</xref>.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3.</label>
<caption><title>Parameters values in the simulation of the T-maze environment</title></caption>
<graphic xlink:href="516400v4_tbl3.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap></sec>
<sec id="s4f2">
<title>Calculating auto-correlogram and cross-correlogram</title>
<p>To show the “cycle skipping” effect of a single place cell in the T-maze environment, we calculate the auto-correlogram of the firing rate trace of a place cell whose firing field encodes a location on the left arm (the upper panel in <xref rid="fig5" ref-type="fig">Fig. 5d</xref>). Assume the firing trace of the place cell is <italic>f (t)</italic> (showed in left panel in <xref rid="fig5" ref-type="fig">Fig. 5c</xref>), the auto-correlogram is calculated as:
<disp-formula id="eqn50">
<graphic xlink:href="516400v4_eqn50.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>τ</italic> represents the time offset.</p>
<p>To show the “alternative cycling” effect of a pair of place cells with each of them encoding a location on each of the two outward arms, we calculate the cross-correlogram between their firing traces (the lower panel in <xref rid="fig5" ref-type="fig">Fig. 5d</xref>). It measures the similarity of the two firing traces as a function of the temporal offset of one relative to the other. Assume the firing traces of the two place cells are <italic>f (t)</italic> and <italic>g(t)</italic>, respectively, the cross-correlogram is calculated as:
<disp-formula id="eqn51">
<graphic xlink:href="516400v4_eqn51.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>τ</italic> represents the time offset.</p>
</sec></sec>
<sec id="s4g">
<title>Details of generating the probability heatmap of theta phase shift</title>
<p>In <xref rid="fig4" ref-type="fig">Fig. 4g&amp;h</xref> we described the smoothed probability heatmaps of theta phase versus normalized position in the place field of both bimodal and unimodal cells. Generally, these two plots are similar to the traditional spike plot of phase and position traveled in the place field (<bold><italic><xref ref-type="bibr" rid="c50">O’Keefe and Recce, 1993</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c55">Skaggs et al., 1996</xref></italic></bold>). However, in our rate-based model, the phase of neuronal spike is not directly modelled, rather we use the phase of firing rate peak to represent the phase shift in neuronal firing. Here we describe the implementation details of generating the heatmaps.</p>
<p>The x-axis denotes the normalized position in the place field, with -1 representing the position where the animal just enters the place field, and 1 representing the position where the animal just leaves the place field. In our simulation, the firing field of a place cell with preferred location at <italic>x</italic><sub>0</sub> is defined as <italic>x ∈ (x</italic><sub>0</sub> − 2.5 <italic>* a, x</italic><sub>0</sub> + 2.5<italic>a</italic>), with <italic>a</italic> roughly the half size of the firing field. Consider the animal is at <italic>x</italic><sub><italic>t</italic></sub> <italic>at</italic> time <italic>t</italic> (note that <italic>x</italic><sub><italic>t</italic></sub> <italic>= v</italic><sub><italic>ext</italic></sub><italic>t)</italic>, then its normalized position <inline-formula><inline-graphic xlink:href="516400v4_inline5a.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is calculated as <inline-formula><inline-graphic xlink:href="516400v4_inline5.gif" mimetype="image" mime-subtype="gif"/></inline-formula> . The y-axis represents the phase of neuronal activity, which is in the range of (0°, 720°). To calculate the phase at every time step, we divide the duration of the animal traversing the linear track into multiple theta cycles according to the bump’s oscillation. We can calculate the phase by <italic>θ</italic><sub><italic>t</italic></sub> <italic>= (t − t</italic><sub>0</sub><italic>)/T</italic>, with <italic>t</italic><sub>0</sub> referring to the beginning of the present theta cycle and T referring to the theta period. Denote the firing rate of the <italic>i</italic>-th neuron at time t as <inline-formula><inline-graphic xlink:href="516400v4_inline6.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, the probability heatmap is calculated by,
<disp-formula id="eqn52">
<graphic xlink:href="516400v4_eqn52.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="516400v4_inline7.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the normalization factor.</p>
</sec>
<sec id="s4h">
<title>Spike generation from the firing rate</title>
<p>To understand phase shift based on spiking time rather than the peak firing rate, we convert the firing rate into spike trains according to the Poisson statistics (note that our analysis is rate-based, but converting to spike-based does not change the underlying mechanism). For the ith place cell which encodes position <italic>x</italic><sub><italic>i</italic></sub> on the linear track, the number of spikes <italic>n</italic><sub><italic>i</italic></sub> it generates within a time interval Δ<italic>t</italic> satisfies a Poisson distribution, which is expressed as,
<disp-formula id="eqn53">
<graphic xlink:href="516400v4_eqn53.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>z</italic> is the animal’s location, and <italic>f</italic><sub><italic>i</italic></sub><italic>(z)</italic> is the tuning function of cell <italic>i,</italic>which is given by
<disp-formula id="eqn54">
<graphic xlink:href="516400v4_eqn54.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>A</italic><sub><italic>r</italic></sub> denotes the amplitude of the neural activity bump and <italic>a</italic> the range of recurrent interaction.</p>
</sec>
</sec>
<sec id="d1e2981" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e3144">
<label>Supplemental information text</label>
<media xlink:href="supplements/516400_file02.pdf"/>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Alonso</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>Klink</surname>, <given-names>R.</given-names></string-name> (<year>1993</year>). <article-title>Differential electroresponsiveness of stellate and pyramidal-like cells of medial entorhinal cortex layer ii</article-title>. <source>Journal of neurophysiology</source>, <volume>70</volume>(<issue>1</issue>):<fpage>128</fpage>–<lpage>143</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Amari</surname>, <given-names>S.-i.</given-names></string-name> (<year>1977</year>). <article-title>Dynamics of pattern formation in lateral-inhibition type neural fields</article-title>. <source>Biological cybernetics</source>, <volume>27</volume>(<issue>2</issue>):<fpage>77</fpage>–<lpage>87</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Azizi</surname>, <given-names>A. H.</given-names></string-name>, <string-name><surname>Wiskott</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Cheng</surname>, <given-names>S.</given-names></string-name> (<year>2013</year>). <article-title>A computational model for preplay in the hippocampus</article-title>. <source>Frontiers in computational neuroscience</source>, <volume>7</volume>:<fpage>161</fpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Battaglia</surname>, <given-names>F. P.</given-names></string-name> and <string-name><surname>Treves</surname>, <given-names>A.</given-names></string-name> (<year>1998</year>). <article-title>Attractor neural networks storing multiple space representations: a model for hippocampal place fields</article-title>. <source>Physical Review E</source>, <volume>58</volume>(<issue>6</issue>):<fpage>7738</fpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Benda</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Herz</surname>, <given-names>A. V.</given-names></string-name> (<year>2003</year>). <article-title>A universal model for spike-frequency adaptation</article-title>. <source>Neural computation</source>, <volume>15</volume>(<issue>11</issue>):<fpage>2523</fpage>–<lpage>2564</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Bittner</surname>, <given-names>K. C.</given-names></string-name>, <string-name><surname>Milstein</surname>, <given-names>A. D.</given-names></string-name>, <string-name><surname>Grienberger</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Romani</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Magee</surname>, <given-names>J. C.</given-names></string-name> (<year>2017</year>). <article-title>Behavioral time scale synaptic plasticity underlies ca1 place fields</article-title>. <source>Science</source>, <volume>357</volume>(<issue>6355</issue>):<fpage>1033</fpage>–<lpage>1036</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Brandon</surname>, <given-names>M. P.</given-names></string-name>, <string-name><surname>Bogaard</surname>, <given-names>A. R.</given-names></string-name>, <string-name><surname>Schultheiss</surname>, <given-names>N. W.</given-names></string-name>, and <string-name><surname>Hasselmo</surname>, <given-names>M. E.</given-names></string-name> (<year>2013</year>). <article-title>Segregation of cortical head direction cell assemblies on alternating theta cycles</article-title>. <source>Nature neuroscience</source>, <volume>16</volume>(<issue>6</issue>):<fpage>739</fpage>–<lpage>748</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Bressloff</surname>, <given-names>P. C.</given-names></string-name> (<year>2011</year>). <article-title>Spatiotemporal dynamics of continuum neural fields</article-title>. <source>Journal of Physics A: Mathematical and Theoretical</source>, <volume>45</volume>(<issue>3</issue>):<fpage>033001</fpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Burak</surname>, <given-names>Y.</given-names></string-name> and <string-name><surname>Fiete</surname>, <given-names>I. R.</given-names></string-name> (<year>2009</year>). <article-title>Accurate path integration in continuous attractor network models of grid cells</article-title>. <source>PLoS computational biology</source>, <volume>5</volume>(<issue>2</issue>):<fpage>e1000291</fpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Burgess</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Recce</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>O’Keefe</surname>, <given-names>J.</given-names></string-name> (<year>1994</year>). <article-title>A model of hippocampal function</article-title>. <source>Neural networks</source>, <volume>7</volume>(<issue>6-7</issue>):<fpage>1065</fpage>–<lpage>1081</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Couey</surname>, <given-names>J. J.</given-names></string-name>, <string-name><surname>Witoelar</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>S.-J.</given-names></string-name>, <string-name><surname>Zheng</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Ye</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Dunn</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Czajkowski</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name>, <string-name><surname>Roudi</surname>, <given-names>Y.</given-names></string-name>, <etal>et al.</etal> (<year>2013</year>). <article-title>Recurrent inhibitory circuitry as a mechanism for grid formation</article-title>. <source>Nature neuroscience</source>, <volume>16</volume>(<issue>3</issue>):<fpage>318</fpage>–<lpage>324</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Deshmukh</surname>, <given-names>S. S.</given-names></string-name>, <string-name><surname>Yoganarasimha</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Voicu</surname>, <given-names>H.</given-names></string-name>, and <string-name><surname>Knierim</surname>, <given-names>J. J.</given-names></string-name> (<year>2010</year>). <article-title>Theta modulation in the medial and the lateral entorhinal cortices</article-title>. <source>Journal of neurophysiology</source>, <volume>104</volume>(<issue>2</issue>):<fpage>994</fpage>–<lpage>1006</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Diba</surname>, <given-names>K.</given-names></string-name> and <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name> (<year>2007</year>). <article-title>Forward and reverse hippocampal place-cell sequences during ripples</article-title>. <source>Nature neuroscience</source>, <volume>10</volume>(<issue>10</issue>):<fpage>1241</fpage>–<lpage>1242</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Dong</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Chu</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Ji</surname>, <given-names>Z.</given-names></string-name>, and <string-name><surname>Wu</surname>, <given-names>S.</given-names></string-name> (<year>2021</year>). <article-title>Noisy adaptation generates lévy flights in attractor neural networks</article-title>. <source>Advances in Neural Information Processing Systems</source>, <volume>34</volume>:<fpage>16791</fpage>–<lpage>16804</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Dragoi</surname>, <given-names>G.</given-names></string-name> and <string-name><surname>Tonegawa</surname>, <given-names>S.</given-names></string-name> (<year>2011</year>). <article-title>Preplay of future place cell sequences by hippocampal cellular assemblies</article-title>. <source>Nature</source>, <volume>469</volume>(<issue>7330</issue>):<fpage>397</fpage>–<lpage>401</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Drieu</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Todorova</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Zugaro</surname>, <given-names>M.</given-names></string-name> (<year>2018</year>). <article-title>Nested sequences of hippocampal assemblies during behavior support subsequent sleep replay</article-title>. <source>Science</source>, <volume>362</volume>(<issue>6415</issue>):<fpage>675</fpage>–<lpage>679</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Feng</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Silva</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Foster</surname>, <given-names>D. J.</given-names></string-name> (<year>2015</year>). <article-title>Dissociation between the experience-dependent development of hippocampal theta sequences and single-trial phase precession</article-title>. <source>Journal of Neuroscience</source>, <volume>35</volume>(<issue>12</issue>):<fpage>4890</fpage>–<lpage>4902</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Fenton</surname>, <given-names>A. A.</given-names></string-name> and <string-name><surname>Muller</surname>, <given-names>R. U.</given-names></string-name> (<year>1998</year>). <article-title>Place cell discharge is extremely variable during individual passes of the rat through the firing field</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>95</volume>(<issue>6</issue>):<fpage>3182</fpage>–<lpage>3187</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Fernández-Ruiz</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Oliva</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Nagy</surname>, <given-names>G. A.</given-names></string-name>, <string-name><surname>Maurer</surname>, <given-names>A. P.</given-names></string-name>, <string-name><surname>Berényi</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name> (<year>2017</year>). <article-title>Entorhinal-ca3 dual-input control of spike timing in the hippocampus by theta-gamma coupling</article-title>. <source>Neuron</source>, <volume>93</volume>(<issue>5</issue>):<fpage>1213</fpage>–<lpage>1226</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Folias</surname>, <given-names>S. E.</given-names></string-name> and <string-name><surname>Bressloff</surname>, <given-names>P. C.</given-names></string-name> (<year>2004</year>). <article-title>Breathing pulses in an excitatory neural network</article-title>. <source>SIAM Journal on Applied Dynamical Systems</source>, <volume>3</volume>(<issue>3</issue>):<fpage>378</fpage>–<lpage>407</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Foster</surname>, <given-names>D. J.</given-names></string-name>, <string-name><surname>Morris</surname>, <given-names>R. G.</given-names></string-name>, and <string-name><surname>Dayan</surname>, <given-names>P.</given-names></string-name> (<year>2000</year>). <article-title>A model of hippocampally dependent navigation, using the temporal difference learning rule</article-title>. <source>Hippocampus</source>, <volume>10</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>16</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Foster</surname>, <given-names>D. J.</given-names></string-name> and <string-name><surname>Wilson</surname>, <given-names>M. A.</given-names></string-name> (<year>2006</year>). <article-title>Reverse replay of behavioural sequences in hippocampal place cells during the awake state</article-title>. <source>Nature</source>, <volume>440</volume>(<issue>7084</issue>):<fpage>680</fpage>–<lpage>683</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Foster</surname>, <given-names>D. J.</given-names></string-name> and <string-name><surname>Wilson</surname>, <given-names>M. A.</given-names></string-name> (<year>2007</year>). <article-title>Hippocampal theta sequences</article-title>. <source>Hippocampus</source>, <volume>17</volume>(<issue>11</issue>):<fpage>1093</fpage>–<lpage>1099</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Fuhrmann</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Markram</surname>, <given-names>H.</given-names></string-name>, and <string-name><surname>Tsodyks</surname>, <given-names>M.</given-names></string-name> (<year>2002</year>). <article-title>Spike frequency adaptation and neocortical rhythms</article-title>. <source>Journal of neurophysiology</source>, <volume>88</volume>(<issue>2</issue>):<fpage>761</fpage>–<lpage>770</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Fung</surname>, <given-names>C. A.</given-names></string-name>, <string-name><surname>Wong</surname>, <given-names>K. M.</given-names></string-name>, and <string-name><surname>Wu</surname>, <given-names>S.</given-names></string-name> (<year>2010</year>). <article-title>A moving bump in a continuous manifold: a comprehensive study of the tracking dynamics of continuous attractor neural networks</article-title>. <source>Neural Computation</source>, <volume>22</volume>(<issue>3</issue>):<fpage>752</fpage>–<lpage>792</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Geisler</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Robbe</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Zugaro</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Sirota</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name> (<year>2007</year>). <article-title>Hippocampal place cell assemblies are speed-controlled oscillators</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>104</volume>(<issue>19</issue>):<fpage>8149</fpage>–<lpage>8154</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Gillespie</surname>, <given-names>A. K.</given-names></string-name>, <string-name><surname>Maya</surname>, <given-names>D. A. A.</given-names></string-name>, <string-name><surname>Denovellis</surname>, <given-names>E. L.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>D. F.</given-names></string-name>, <string-name><surname>Kastner</surname>, <given-names>D. B.</given-names></string-name>, <string-name><surname>Coulter</surname>, <given-names>M. E.</given-names></string-name>, <string-name><surname>Roumis</surname>, <given-names>D. K.</given-names></string-name>, <string-name><surname>Eden</surname>, <given-names>U. T.</given-names></string-name>, and <string-name><surname>Frank</surname>, <given-names>L. M.</given-names></string-name> (<year>2021</year>). <article-title>Hippocampal replay reflects specific past experiences rather than a plan for subsequent choice</article-title>. <source>Neuron</source>, <volume>109</volume>(<issue>19</issue>):<fpage>3149</fpage>–<lpage>3163</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Hafting</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Bonnevie</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name> (<year>2008</year>). <article-title>Hippocampus-independent phase precession in entorhinal grid cells</article-title>. <source>Nature</source>, <volume>453</volume>(<issue>7199</issue>):<fpage>1248</fpage>–<lpage>1252</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Hao</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>X.-d.</given-names></string-name>, <string-name><surname>Dan</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Poo</surname>, <given-names>M.-m.</given-names></string-name>, and <string-name><surname>Zhang</surname>, <given-names>X.-h.</given-names></string-name> (<year>2009</year>). <article-title>An arithmetic rule for spatial summation of excitatory and inhibitory inputs in pyramidal neurons</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>106</volume>(<issue>51</issue>):<fpage>21906</fpage>–<lpage>21911</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Harris</surname>, <given-names>K. D.</given-names></string-name>, <string-name><surname>Henze</surname>, <given-names>D. A.</given-names></string-name>, <string-name><surname>Hirase</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Leinekugel</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Dragoi</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Czurkó</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name> (<year>2002</year>). <article-title>Spike train dynamics predicts theta-related phase precession in hippocampal pyramidal cells</article-title>. <source>Nature</source>, <volume>417</volume>(<issue>6890</issue>):<fpage>738</fpage>– <lpage>741</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Hassabis</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Kumaran</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Vann</surname>, <given-names>S. D.</given-names></string-name>, and <string-name><surname>Maguire</surname>, <given-names>E. A.</given-names></string-name> (<year>2007</year>). <article-title>Patients with hippocampal amnesia cannot imagine new experiences</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>104</volume>(<issue>5</issue>):<fpage>1726</fpage>–<lpage>1731</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Hopfield</surname>, <given-names>J. J.</given-names></string-name> (<year>2010</year>). <article-title>Neurodynamics of mental exploration</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>107</volume>(<issue>4</issue>):<fpage>1648</fpage>–<lpage>1653</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Jahnke</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Timme</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Memmesheimer</surname>, <given-names>R.-M.</given-names></string-name> (<year>2015</year>). <article-title>A unified dynamic model for learning, replay, and sharp-wave/ripples</article-title>. <source>Journal of Neuroscience</source>, <volume>35</volume>(<issue>49</issue>):<fpage>16236</fpage>–<lpage>16258</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Jaramillo</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Kempter</surname>, <given-names>R.</given-names></string-name> (<year>2017</year>). <article-title>Phase precession: a neural code underlying episodic memory?</article-title> <source>Current opinion in neurobiology</source>, <volume>43</volume>:<fpage>130</fpage>–<lpage>138</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Jensen</surname>, <given-names>O.</given-names></string-name> and <string-name><surname>Lisman</surname>, <given-names>J. E.</given-names></string-name> (<year>2000</year>). <article-title>Position reconstruction from an ensemble of hippocampal place cells: contribution of theta phase coding</article-title>. <source>Journal of neurophysiology</source>, <volume>83</volume>(<issue>5</issue>):<fpage>2602</fpage>–<lpage>2609</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Johnson</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>Redish</surname>, <given-names>A. D.</given-names></string-name> (<year>2007</year>). <article-title>Neural ensembles in ca3 transiently encode paths forward of the animal at a decision point</article-title>. <source>Journal of Neuroscience</source>, <volume>27</volume>(<issue>45</issue>):<fpage>12176</fpage>–<lpage>12189</lpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Kamondi</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Acsády</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>X.-J.</given-names></string-name>, and <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name> (<year>1998</year>). <article-title>Theta oscillations in somata and dendrites of hippocampal pyramidal cells in vivo: Activity-dependent phase-precession of action potentials</article-title>. <source>Hippocampus</source>, <volume>8</volume>(<issue>3</issue>):<fpage>244</fpage>–<lpage>261</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Kang</surname>, <given-names>L.</given-names></string-name> and <string-name><surname>DeWeese</surname>, <given-names>M. R.</given-names></string-name> (<year>2019</year>). <article-title>Replay as wavefronts and theta sequences as bump oscillations in a grid cell attractor network</article-title>. <source>Elife</source>, <volume>8</volume>:<fpage>e46351</fpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Karlsson</surname>, <given-names>M. P.</given-names></string-name> and <string-name><surname>Frank</surname>, <given-names>L. M.</given-names></string-name> (<year>2009</year>). <article-title>Awake replay of remote experiences in the hippocampus</article-title>. <source>Nature neuroscience</source>, <volume>12</volume>(<issue>7</issue>):<fpage>913</fpage>–<lpage>918</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Kay</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Chung</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>Sosa</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Schor</surname>, <given-names>J. S.</given-names></string-name>, <string-name><surname>Karlsson</surname>, <given-names>M. P.</given-names></string-name>, <string-name><surname>Larkin</surname>, <given-names>M. C.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>D. F.</given-names></string-name>, and <string-name><surname>Frank</surname>, <given-names>L. M.</given-names></string-name> (<year>2020</year>). <article-title>Constant sub-second cycling between representations of possible futures in the hippocampus</article-title>. <source>Cell</source>, <volume>180</volume>(<issue>3</issue>):<fpage>552</fpage>–<lpage>567</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>King</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Recce</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>O’keefe</surname>, <given-names>J.</given-names></string-name> (<year>1998</year>). <article-title>The rhythmicity of cells of the medial septum/diagonal band of broca in the awake freely moving rat: relationships with behaviour and hippocampal theta</article-title>. <source>European Journal of Neuroscience</source>, <volume>10</volume>(<issue>2</issue>):<fpage>464</fpage>–<lpage>477</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Lengyel</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Szatmáry</surname>, <given-names>Z.</given-names></string-name>, and <string-name><surname>Érdi</surname>, <given-names>P.</given-names></string-name> (<year>2003</year>). <article-title>Dynamically detuned oscillations account for the coupled rate and temporal code of place cell firing</article-title>. <source>Hippocampus</source>, <volume>13</volume>(<issue>6</issue>):<fpage>700</fpage>–<lpage>714</lpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Losonczy</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Zemelman</surname>, <given-names>B. V.</given-names></string-name>, <string-name><surname>Vaziri</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Magee</surname>, <given-names>J. C.</given-names></string-name> (<year>2010</year>). <article-title>Network mechanisms of theta related neuronal activity in hippocampal ca1 pyramidal neurons</article-title>. <source>Nature neuroscience</source>, <volume>13</volume>(<issue>8</issue>):<fpage>967</fpage>–<lpage>972</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>McNaughton</surname>, <given-names>B. L.</given-names></string-name>, <string-name><surname>Battaglia</surname>, <given-names>F. P.</given-names></string-name>, <string-name><surname>Jensen</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name> (<year>2006</year>). <article-title>Path integration and the neural basis of the’cognitive map’</article-title>. <source>Nature Reviews Neuroscience</source>, <volume>7</volume>(<issue>8</issue>):<fpage>663</fpage>–<lpage>678</lpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Mehta</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Wilson</surname>, <given-names>M.</given-names></string-name> (<year>2002</year>). <article-title>Role of experience and oscillations in transforming a rate code into a temporal code</article-title>. <source>Nature</source>, <volume>417</volume>(<issue>6890</issue>):<fpage>741</fpage>–<lpage>746</lpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Mehta</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>Barnes</surname>, <given-names>C. A.</given-names></string-name>, and <string-name><surname>McNaughton</surname>, <given-names>B. L.</given-names></string-name> (<year>1997</year>). <article-title>Experience-dependent, asymmetric expansion of hippocampal place fields</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>94</volume>(<issue>16</issue>):<fpage>8918</fpage>–<lpage>8921</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Mi</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Fung</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Wong</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Wu</surname>, <given-names>S.</given-names></string-name> (<year>2014</year>). <article-title>Spike frequency adaptation implements anticipative tracking in continuous attractor neural networks</article-title>. <source>Advances in neural information processing systems</source>, <volume>27</volume>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Muessig</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lasek</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Varsavsky</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Cacucci</surname>, <given-names>F.</given-names></string-name>, and <string-name><surname>Wills</surname>, <given-names>T. J.</given-names></string-name> (<year>2019</year>). <article-title>Coordinated emergence of hippocampal replay and theta sequences during post-natal development</article-title>. <source>Current Biology</source>, <volume>29</volume>(<issue>5</issue>):<fpage>834</fpage>–<lpage>840</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>O’keefe</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Burgess</surname>, <given-names>N.</given-names></string-name> (<year>2005</year>). <article-title>Dual phase and rate coding in hippocampal place cells: theoretical significance and relationship to entorhinal grid cells</article-title>. <source>Hippocampus</source>, <volume>15</volume>(<issue>7</issue>):<fpage>853</fpage>–<lpage>866</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>O’Keefe</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Recce</surname>, <given-names>M. L.</given-names></string-name> (<year>1993</year>). <article-title>Phase relationship between hippocampal place units and the eeg theta rhythm</article-title>. <source>Hippocampus</source>, <volume>3</volume>(<issue>3</issue>):<fpage>317</fpage>–<lpage>330</lpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Pfeiffer</surname>, <given-names>B. E.</given-names></string-name> (<year>2020</year>). <article-title>The content of hippocampal “replay”</article-title>. <source>Hippocampus</source>, <volume>30</volume>(<issue>1</issue>):<fpage>6</fpage>–<lpage>18</lpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Romani</surname>, <given-names>S.</given-names></string-name> and <string-name><surname>Tsodyks</surname>, <given-names>M.</given-names></string-name> (<year>2015</year>). <article-title>Short-term plasticity based network model of place cells dynamics</article-title>. <source>Hippocampus</source>, <volume>25</volume>(<issue>1</issue>):<fpage>94</fpage>–<lpage>105</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><surname>Samsonovich</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>McNaughton</surname>, <given-names>B. L.</given-names></string-name> (<year>1997</year>). <article-title>Path integration and cognitive mapping in a continuous attractor neural network model</article-title>. <source>Journal of Neuroscience</source>, <volume>17</volume>(<issue>15</issue>):<fpage>5900</fpage>–<lpage>5920</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>Schmidt</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Diba</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Leibold</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Schmitz</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Kempter</surname>, <given-names>R.</given-names></string-name> (<year>2009</year>). <article-title>Single-trial phase precession in the hippocampus</article-title>. <source>Journal of Neuroscience</source>, <volume>29</volume>(<issue>42</issue>):<fpage>13232</fpage>–<lpage>13241</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><surname>Skaggs</surname>, <given-names>W. E.</given-names></string-name>, <string-name><surname>McNaughton</surname>, <given-names>B. L.</given-names></string-name>, <string-name><surname>Wilson</surname>, <given-names>M. A.</given-names></string-name>, and <string-name><surname>Barnes</surname>, <given-names>C. A.</given-names></string-name> (<year>1996</year>). <article-title>Theta phase precession in hippocampal neuronal populations and the compression of temporal sequences</article-title>. <source>Hippocampus</source>, <volume>6</volume>(<issue>2</issue>):<fpage>149</fpage>–<lpage>172</lpage>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Stewart</surname>, <given-names>M.</given-names></string-name> and <string-name><surname>Fox</surname>, <given-names>S. E.</given-names></string-name> (<year>1990</year>). <article-title>Do septal neurons pace the hippocampal theta rhythm?</article-title> <source>Trends in neurosciences</source>, <volume>13</volume>(<issue>5</issue>):<fpage>163</fpage>–<lpage>169</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Treves</surname>, <given-names>A.</given-names></string-name> (<year>2004</year>). <article-title>Computational constraints between retrieving the past and predicting the future, and the ca3-ca1 differentiation</article-title>. <source>Hippocampus</source>, <volume>14</volume>(<issue>5</issue>):<fpage>539</fpage>–<lpage>556</lpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><surname>Tsodyks</surname>, <given-names>M.</given-names></string-name> (<year>1999</year>). <article-title>Attractor neural network models of spatial maps in hippocampus</article-title>. <source>Hippocampus</source>, <volume>9</volume>(<issue>4</issue>):<fpage>481</fpage>– <lpage>489</lpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><surname>Tsodyks</surname>, <given-names>M.</given-names></string-name> and <string-name><surname>Sejnowski</surname>, <given-names>T.</given-names></string-name> (<year>1995</year>). <article-title>Associative memory and hippocampal place cells</article-title>. <source>International journal of neural systems</source>, <volume>6</volume>:<fpage>81</fpage>–<lpage>86</lpage>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><surname>Tsodyks</surname>, <given-names>M. V.</given-names></string-name>, <string-name><surname>Skaggs</surname>, <given-names>W. E.</given-names></string-name>, <string-name><surname>Sejnowski</surname>, <given-names>T. J.</given-names></string-name>, and <string-name><surname>McNaughton</surname>, <given-names>B. L.</given-names></string-name> (<year>1996</year>). <article-title>Population dynamics and theta rhythm phase precession of hippocampal place cell firing: a spiking neuron model</article-title>. <source>Hippocampus</source>, <volume>6</volume>(<issue>3</issue>):<fpage>271</fpage>– <lpage>280</lpage>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><surname>Van Der Meer</surname>, <given-names>M. A.</given-names></string-name> and <string-name><surname>Redish</surname>, <given-names>A. D.</given-names></string-name> (<year>2011</year>). <article-title>Theta phase precession in rat ventral striatum links place and reward information</article-title>. <source>Journal of neuroscience</source>, <volume>31</volume>(<issue>8</issue>):<fpage>2843</fpage>–<lpage>2854</lpage>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><surname>Van Strien</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Cappaert</surname>, <given-names>N.</given-names></string-name>, and <string-name><surname>Witter</surname>, <given-names>M.</given-names></string-name> (<year>2009</year>). <article-title>The anatomy of memory: an interactive overview of the parahippocampal–hippocampal network</article-title>. <source>Nature reviews neuroscience</source>, <volume>10</volume>(<issue>4</issue>):<fpage>272</fpage>–<lpage>282</lpage>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><string-name><surname>Wang</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Foster</surname>, <given-names>D. J.</given-names></string-name>, and <string-name><surname>Pfeiffer</surname>, <given-names>B. E.</given-names></string-name> (<year>2020</year>). <article-title>Alternating sequences of future and past behavior encoded within hippocampal theta oscillations</article-title>. <source>Science</source>, <volume>370</volume>(<issue>6513</issue>):<fpage>247</fpage>–<lpage>250</lpage>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><string-name><surname>Wang</surname>, <given-names>X.-J.</given-names></string-name> (<year>2002</year>). <article-title>Pacemaker neurons for the theta rhythm and their synchronization in the septohippocampal reciprocal loop</article-title>. <source>Journal of neurophysiology</source>, <volume>87</volume>(<issue>2</issue>):<fpage>889</fpage>–<lpage>900</lpage>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><string-name><surname>Wikenheiser</surname>, <given-names>A. M.</given-names></string-name> and <string-name><surname>Redish</surname>, <given-names>A. D.</given-names></string-name> (<year>2015</year>). <article-title>Hippocampal theta sequences reflect current goals</article-title>. <source>Nature neuroscience</source>, <volume>18</volume>(<issue>2</issue>):<fpage>289</fpage>–<lpage>294</lpage>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Hamaguchi</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Amari</surname>, <given-names>S.-i.</given-names></string-name> (<year>2008</year>). <article-title>Dynamics and computation of continuous attractors</article-title>. <source>Neural computation</source>, <volume>20</volume>(<issue>4</issue>):<fpage>994</fpage>–<lpage>1025</lpage>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Wong</surname>, <given-names>K. M.</given-names></string-name>, <string-name><surname>Fung</surname>, <given-names>C. A.</given-names></string-name>, <string-name><surname>Mi</surname>, <given-names>Y.</given-names></string-name>, and <string-name><surname>Zhang</surname>, <given-names>W.</given-names></string-name> (<year>2016</year>). <article-title>Continuous attractor neural networks: candidate of a canonical model for neural information representation</article-title>. <source>F1000Research</source>, <volume>5</volume>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><string-name><surname>Yamaguchi</surname>, <given-names>Y.</given-names></string-name> (<year>2003</year>). <article-title>A theory of hippocampal memory based on theta phase precession</article-title>. <source>Biological cybernetics</source>, <volume>89</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><string-name><surname>Yamaguchi</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Aota</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>McNaughton</surname>, <given-names>B. L.</given-names></string-name>, and <string-name><surname>Lipa</surname>, <given-names>P.</given-names></string-name> (<year>2002</year>). <article-title>Bimodality of theta phase precession in hippocampal place cells in freely running rats</article-title>. <source>Journal of neurophysiology</source>, <volume>87</volume>(<issue>6</issue>):<fpage>2629</fpage>–<lpage>2642</lpage>.</mixed-citation></ref>
<ref id="c70"><mixed-citation publication-type="journal"><string-name><surname>Zugaro</surname>, <given-names>M. B.</given-names></string-name>, <string-name><surname>Monconduit</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name> (<year>2005</year>). <article-title>Spike phase precession persists after transient intrahippocampal perturbation</article-title>. <source>Nature neuroscience</source>, <volume>8</volume>(<issue>1</issue>):<fpage>67</fpage>–<lpage>71</lpage>.</mixed-citation></ref>
</ref-list>
<ack>
<title>Acknowledgements</title>
<p>We thank Brad Pfeiffer for sharing the data. We also thank Brad Pheiffer, Cheng Wang, Li Yao for valuable discussions.</p>
</ack>
<sec id="s5">
<title>Funding</title>
<p>This work was support by: Science and Technology Innovation 2030-Brain Science and Brain-inspired Intelligence Project (No. 2021ZD0200204, SW; No. 2021ZD0200204 / 2021ZD0203700 / 2021ZD0203705, YM), the UKRI Frontier Research Grant (EP/X023060/1, DB), the Wellcome Principal Research Fellowship (NB), the National Natural Science Foundation of China (No. 62088102/ 62136001/ T2122016, YM), and an International Postdoctoral Exchange Fellowship Program (No. PC2021005, ZJ).</p>
</sec>
<sec id="s6">
<title>Author Contributions</title>
<p>TC, ZJ and SW conceptualized and designed the research. TC, ZJ, JZ, and YM analyzed the model and performed the simulations. ZJ, WZ, TH, NB and SW interpreted the results. ZJ, TC, DB, NB and SW wrote the manuscript.</p>
</sec>
<sec id="s7">
<title>Competing interests</title>
<p>Authors declare that they have no competing interests.</p>
</sec>
<sec id="s8">
<title>Data and materials availability</title>
<p>All code for reproducing the figures in the main text are available in the supplementary materials.</p>
</sec>
<sec id="s9">
<title>List of material contained in the Supplementary Material</title>
<list list-type="bullet">
<list-item><p>Supplementary text (pdf file)</p></list-item>
<list-item><p>Figures S1-S4</p></list-item>
<list-item><p>Video 1-4</p></list-item>
<list-item><p>Code for reproducing all the figures in the main text</p></list-item>
</list>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87055.3.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Giocomo</surname>
<given-names>Lisa M</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Stanford School of Medicine</institution>
</institution-wrap>
<city>Stanford</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study provides <bold>valuable</bold> new insights on how a prevailing model of hippocampal sequence formation can account for recent data, including forward and backward sweeps, as well as constant cycling of sweeps across different arms of a T-maze. The <bold>convincing</bold> evidence presented in support of this work relies on classical analytical and computational techniques about continuous attractor networks.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87055.3.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Continuous attractor networks endowed with some sort of adaptation in the dynamics, whether that be through synaptic depression or firing rate adaptation, are fast becoming the leading candidate models to explain many aspects of hippocampal place cell dynamics, from hippocampal replay during immobility to theta sequences during run. Here, the authors show that a continuous attractor network endowed with spike frequency adaptation and subject to feedforward external inputs is able to account for several previously unaccounted aspects of theta sequences, including (1) sequences that move both forwards and backwards, (2) sequences that alternate between two arms of a T-maze, (3) speed modulation of place cell firing frequency, and (4) the persistence of phase information across hippocampal inactivations.</p>
<p>I think the main result of the paper (findings (1) and (2)) are likely to be of interest to the hippocampal community, as well as to the wider community interested in mechanisms of neural sequences. In addition, the manuscript is generally well written and the analytics are impressive. However, several issues should be addressed, which I outline below.</p>
<p>Major comments:</p>
<p>In real data, population firing rate is strongly modulated by theta (i.e., cells collectively prefer a certain phase of theta - see review paper Buzsaki, 2002) and largely oscillates at theta frequency during run. With respect to this cyclical firing rate, theta sweeps resemble &quot;Nike&quot; check marks, with the sweep backwards preceding the sweep forwards within each cycle before the activity is quenched at the end of the cycle. I am concerned that (1) the summed population firing rate of the model does not oscillate at theta frequency, and (2) as the authors state, the oscillatory tracking state must begin with a forward sweep. With regards to (1), can the authors show theta phase spike preference plots for the population to see if they match data? With regards to (2), can the authors show what happens if the bump is made to sweep backwards first, as it appears to do within each cycle?</p>
<p>I could not find the width of the external input mentioned anywhere in the text or in the table of parameters. The implication is that it is unclear to me whether, during the oscillatory tracking state, the external input is large compared to the size of the bump, so that the bump lives within a window circumscribed by the external input and so bounces off the interior walls of the input during the oscillatory tracking phase, or whether the bump is continuously pulled back and forth by the external input, in which case it could be comparable to the size of the bump. My guess based on Fig 2c is that it is the latter. Please clarify and comment.</p>
<p>I would argue that the &quot;constant cycling&quot; of theta sweeps down the arms of a T-maze was roughly predicted by Romani &amp; Tsodyks, 2015, Figure 7. While their cycling spans several theta cycles, it nonetheless alternates by a similar mechanism, in that adaptation (in this case synaptic depression) prevents the subsequent sweep of activity from taking the same arm as the previous sweep. I believe the authors should cite this model in this context and consider the fact that both synaptic depression and spike frequency adaptation are both possible mechanisms for this phenomenon. But I certainly give the authors credit for showing how this constant cycling can occur across individual theta cycles.</p>
<p>The authors make an unsubstantiated claim in the paragraph beginning with line 413 that the Tsodyks and Romani (2015) model could not account for forwards and backwards sweeps. Both the firing rate adaptation and synaptic depression are symmetry breaking models that should in theory be able to push sweeps of activity in both directions, so it is far from obvious to me that both forward and backward sweeps are not possible in the Tsodyks and Romani model. The authors should either prove that this is the case (with theory or simulation) or excise this statement from the manuscript.</p>
<p>The section on the speed dependence of theta (starting with line 327) was very hard to understand. Can the authors show a more graphical explanation of the phenomenon? Perhaps a version of Fig 2f for slow and fast speeds, and point out that cells in the latter case fire with higher frequency than in the former?</p>
<p>I had a hard time understanding how the Zugaro et al., (2005) hippocampal inactivation experiment was accounted for by the model. My intuition is that while the bump position is determined partially by the location of the external input, it is also determined by the immediate history of the bump dynamics as computed via the local dynamics within the hippocampus (recurrent dynamics and spike rate adaptation). So that if the hippocampus is inactivated for an arbitrary length of time, there is nothing to keep track of where the bump should be when the activity comes back on line. Can the authors please explain more how the model accounts for this?</p>
<p>Can the authors comment on why the sweep lengths oscillate in the bottom panel of Fig 5b during starting at time 0.5 seconds before crossing the choice point of the T-maze? Is this oscillation in sweep length another prediction of the model? If so, it should definitely be remarked upon and included in the discussion section.</p>
<p>Perhaps I missed this, but I'm curious whether the authors have considered what factors might modulate the adaptation strength. In particular, might rat speed modulate adaptation strength? If so, would have interesting predictions for theta sequences at low vs high speeds.</p>
<p>I think the paper has a number of predictions that would be especially interesting to experimentalists but are sort of scattered throughout the manuscript. It would be beneficial to have them listed more prominently in a separate section in the discussion. This should include (1) a prediction that the bump height in the forward direction should be higher than in the backward direction, (2) predictions about bimodal and unimodal cells starting with line 366, (3) prediction of another possible kind of theta cycling, this time in the form of sweep length (see comment above), etc.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87055.3.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>In this work, the authors elaborate on an analytically tractable, continuous-attractor model to study an idealized neural network with realistic spiking phase precession/procession. The key ingredient of this analysis is the inclusion of a mechanism for slow firing-rate adaptation in addition to the otherwise fast continuous-attractor dynamics. The latter continuous-attractor dynamics classically arises from a combination of translation invariance and nonlinear rate normalization.</p>
<p>For strong adaptation/weak external input, the network naturally exhibits an internally generated, travelling-wave dynamics along the attractor with some characteristic speed. For small adaptation/strong external stimulus, the network recovers the classical externally driven continuous-attractor dynamics. Crucially, when both adaptation and external input are moderate, there is a competition with the internally generated and externally generated mechanisms leading to an oscillatory tracking regime. In this tracking regime, the population firing profile oscillates around the neural field tracking the position of the stimulus. The authors demonstrate by a combination of analytical and computational arguments that oscillatory tracking corresponds to realistic phase precession/procession. In particular the authors can account for the emergence of unimodal and bimodal cells, as well as some other experimental observations with respect the dependence of phase precession/procession on the animal's locomotion.</p>
<p>The strengths of this work are at least three-fold: 1) Given its simplicity, the proposed model has a surprisingly large explanatory power of the various experimental observations. 2) The mechanism responsible for the emergence of precession/procession can be understood as a simple yet rather illuminating competition between internally driven and externally driven dynamical trends. 3) Amazingly, and under some adequate simplifying assumptions, a great deal of analysis can be treated exactly, which allows for a detailed understanding of all parametric dependencies. This exact treatment culminates with a full characterization of the phase space of the network dynamics, as well as the computation of various quantities of interest, including characteristic speeds and oscillating frequencies.</p>
<p>As mentioned by the authors themselves, the main limitation of this work is that it deals with a very idealized model and it remains to see how the proposed dynamical behaviors would persists in more realistic models. For example, the model is based on a continuous attractor model that assumes perfect translation-invariance of the network connectivity pattern. Would the oscillating tracking behavior persist in the presence of connection heterogeneities? Another limitation is that the system needs to be tuned to exhibit oscillation within the theta range and that this tuning involves a priori variable parameters such as the external input strength. Is the oscillating-tracking behavior overtly sensitive to input strength variations? The author mentioned that an external pacemaker can serve to drive oscillation within the desired theta band but there is no evidence presented supporting this. A final and perhaps secondary limitation has to do with the choice of parameter, namely the time constant of neural firing which is chosen around 3ms. This seems rather short given that the fast time scale of rate models (excluding synaptic processes) is usually given by the membrane time constant, which is typically about 15ms. I suspect this latter point can easily be addressed.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87055.3.sa3</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Chu</surname>
<given-names>Tianhao</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ji</surname>
<given-names>Zilong</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zuo</surname>
<given-names>Junfeng</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Mi</surname>
<given-names>Yuanyuan</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhang</surname>
<given-names>Wen-hao</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Huang</surname>
<given-names>Tiejun</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bush</surname>
<given-names>Daniel</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Burgess</surname>
<given-names>Neil</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wu</surname>
<given-names>Si</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the previous reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Response to reviewer #1:</bold></p>
</disp-quote>
<p>We thank the reviewer for the further recommendations for improving our presentation. We would like to carefully address the remaining concerns of the reviewer.</p>
<disp-quote content-type="editor-comment">
<p>(1) I realize now that I didn't make my point clear enough, which was that as far as I know there is no reason to believe that an oscillatory state cannot be induced with synaptic depression as with spike frequency adaptation when used in the context of the author's model. I'm fine with how the authors have distinguished their model from R&amp;T 2015, but I think the more interesting question is whether there is any reason to believe that STD is not equally capable of doing all the things mentioned in this paper as SFA, and if not why not. I would like the authors to go out on a limb and address this, if only with a few sentences in the discussion.</p>
</disp-quote>
<p>Thank you for pointing this out again. In response to your query regarding the comparison between STD and SFA in generating bump sweeps, we have done simulations based on STD. The results showed that both STD and SFA are capable of inducing bi-directional sweeps. However, (based on our simulations) only SFA can produce uni-directional sweeps. The absence of uni-directional sweeps based on STD may be due to the subtle yet important differences between the two mechanisms. Specifically, STD modulates the neural activity by weakening the recurrent connections, which theoretically can only inhibit recurrent inputs, while SFA can attenuate all forms of excitatory inputs, including external inputs. However, since we did not exhaustively explore the entire parameter space, we cannot conclude that STD is incapable of producing uni-directional sweeps. Future simulations are required.</p>
<p>According to the Reviewer’s suggestion, we added few sentences to discuss the distinctions between STD and SFA in generating theta sweeps in the CANN in line 432 to 440 in the Discussion session:</p>
<p>“Based on our simulation, both STD and SFA show the ability to produce bi-directional sweeps within a CANN model, with the SFA uniquely enabling uni-directional sweeps in the absence of external theta inputs. This difference might be due to the lack of exhaustively exploration of the entire parameter space. However, it might also attribute to the subtle yet important theoretical distinctions between STD and SFA. Specifically, STD attenuates the neural activity through a reduction in recurrent connection strength, whereas SFA provides inhibitory input directly to the neurons, potentially impacting all excitatory inputs. These differences might explain the diverse dynamical behaviors observed in our simulations. Future experiments could clarify these distinctions by monitoring changes in synaptic strength and inhibitory channel activation during theta sweeps.”</p>
<disp-quote content-type="editor-comment">
<p>(2) I appreciate the inclusion of the experimental data in Fig 6a (though I don't find the left-most panel very useful). I also understand what the authors are trying to convey with plots in 6c and 6c. However, I don't find the text that was added above very helpful at all. I was hoping for a simpler demonstration of the effect, by plotting a series of sequential sweeps (cell index vs time, with color indicating firing rate, as in Fig 2d) in the case of both the slow speed and fast speed regimes. Here, vertical lines could mark the individual theta cycles and the firing of individual cells, showing the constancy of the former but change of the latter.</p>
</disp-quote>
<p>Thank you for your constructive feedback. It seems there might be a misunderstanding in our previous explanation, for which we apologize. The phenomenon we want to elucidate is not an increase in the theta frequency as detected in LFPs, but rather the slope of phase precession with respect to the animal's movement speed. Due to phase precession, the oscillations of place cells as the animal traverses the field is higher than the theta frequency. A plot as Fig 2.d will not make this point clearer, since it shows the baseline theta frequency (i.e., theta sweeps as we claimed previously). A straightforward way of thinking this point is as we added previously: “…The faster the animal runs, the faster the extra half cycle can be accomplished. Consequently, the firing frequency will increase more (a steeper slope in Fig. 6c red dots) than the baseline frequency”. We hope this clarification addresses the concerns raised.</p>
<disp-quote content-type="editor-comment">
<p>(3) This is still confusing to me. I just don't understand how the *phase* of the oscillating activity bump has anything to do with the movement of the animal. I would like to see a plot of the sweeps (again, cell index vs time, with color indicating the firing rate) before and after inactivation for short and long duration inactivation. Perhaps I am not understanding or appreciating how the bump recovers after inactivation and how this is related to the motion of the animal.</p>
</disp-quote>
<p>Thank you for pointing this out again. The activity bump will naturally pop out at the input location (which moves forward than before) after we remove the inactivation and then starts to sweep again as before the inactivation. Single cell phase precession and populational theta sweeps are actually the two sides of the same coin (if all cells start at roughly the same phase in theta cycles). If the reviewer accept this, then at the new location, the activity bump sweeps again (around the new location), and therefore phase precession starts again at a further phase, since phase codes the position as the animal traverses the place field.</p>
<disp-quote content-type="editor-comment">
<p>(4) I am glad the authors are spending more time discussing this phenomenon, but I am unsure of their explanation: for a sweep moving at constant speed, neurons all along the path will be equally affected (inhibited), so where does the bias for suppressing the &quot;end&quot; neurons come from?</p>
</disp-quote>
<p>While it may appear that neurons along the path are equally inhibited as the bump sweeps over them, our model incorporates external inputs with Gaussian profiles. These inputs bias neurons closer to the input location, resulting in fewer activations in neurons further away from the input position.</p>
<disp-quote content-type="editor-comment">
<p>(5) Here I was hoping that the authors might comment on what they suspect happens when the animal starts (or stops) moving, and how the network shifts from tracking regime to oscillatory regime (or vice versa), as is typically seen in experimental data (see for example, Kay et al., 2020, fig 4b,c). My apologies for not making this point clearer.</p>
</disp-quote>
<p>Thank you for pointing this out. In our model, we observed that when the animal stops, the network continues to generate theta oscillations near the input location, albeit with reduced amplitude (so the network dynamics looks like in the tracking regime). However, we hypothesize that when the animal pauses its movement for enough time (immobile but awake states), sensory input into the hippocampus also decreases, which is similar to removing external inputs in our model. In this case, the activity bump spontaneously moves away, resembling the phenomenon of replay (see also Romani &amp; Tsodyks 2015).</p>
<p>Regarding the experimental data (Kay et al.), it indeed appears that theta sweeps decoded from neural activity become less pronounced when the mouse moves at slower speeds. This observation could potentially correspond to a decrease in the amplitude of bump oscillations when external inputs associated with movement are halted but not entirely removed in our model. However, in experiments, when the mouse's movement slows down, hippocampal activity no longer oscillates at theta frequency, making it challenging to decode theta sweeps.</p>
<p>We appreciate your clarification on this point and recognize the importance of further investigating how our model can accurately replicate the transition between tracking and oscillatory regimes observed in experimental data.</p>
</body>
</sub-article>
</article>