<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">97350</article-id>
<article-id pub-id-type="doi">10.7554/eLife.97350</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.97350.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Eco-evolutionary dynamics of adapting pathogens and host immunity</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Barrat-Charlaix</surname>
<given-names>Pierre</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
<xref ref-type="aff" rid="A3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Neher</surname>
<given-names>Richard A.</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
<xref ref-type="corresp" rid="CR1">*</xref>
<email xlink:href="mailto:richard.neher@unibas.ch">richard.neher@unibas.ch</email>
</contrib>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Nourmohammad</surname>
<given-names>Armita</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Washington</institution>
</institution-wrap>
<city>Seattle</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Walczak</surname>
<given-names>Aleksandra M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>CNRS</institution>
</institution-wrap>
<city>Paris</city>
<country>France</country>
</aff>
</contrib>
</contrib-group>
<aff id="A1"><label>1</label><institution>Biozentrum, Universität Basel</institution>, <country>Switzerland</country></aff>
<aff id="A2"><label>2</label><institution>Swiss Institute of Bioinformatics</institution>, <country>Switzerland</country></aff>
<aff id="A3"><label>3</label><institution>DISAT, Politecnico di Torino</institution>, <country>Italy</country></aff>
<author-notes>
<corresp id="CR1"><label>*</label>Correspondence to: Richard Neher, Biozentrum, Spitalstrasse 41, 4056, Basel, Switzerland. <email xlink:href="mailto:richard.neher@unibas.ch">richard.neher@unibas.ch</email></corresp>
</author-notes>
<pub-date pub-type="epub">
<day>11</day>
<month>2</month>
<year>2024</year>
</pub-date>
<pub-date date-type="original-publication" iso-8601-date="2024-07-03">
<day>03</day>
<month>07</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP97350</elocation-id>
<history><date date-type="sent-for-review" iso-8601-date="2024-03-22">
<day>22</day>
<month>03</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-03-25">
<day>25</day>
<month>03</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.48550/arXiv.2402.07252"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Barrat-Charlaix &amp; Neher</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Barrat-Charlaix &amp; Neher</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-97350-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>As pathogens spread in a population of hosts, immunity is built up and the pool of susceptible individuals is depleted. This generates selective pressure, to which many human RNA viruses, such as influenza virus or SARS-CoV-2, respond with rapid antigenic evolution and frequent emergence of immune evasive variants. However, the host’s immune systems adapt and older immune responses wane, such that escape variants only enjoy a growth advantage for a limited time. If variant growth dynamics and reshaping of host-immunity operate on comparable time scales, viral adaptation is determined by eco-evolutionary interactions that are not captured by models of rapid evolution in a fixed environment. Here, we use a Susceptible/Infected model to describe the interaction between an evolving viral population in a dynamic but immunologically diverse host population. We show that depending on strain cross-immunity, heterogeneity of the host population, and durability of immune responses, escape variants initially grow exponentially, but lose their growth advantage before reaching high frequencies. Their subsequent dynamics follows an anomalous random walk determined by future escape variants and results in variant trajectories that are unpredictable. This model can explain the apparent contradiction between the clearly adaptive nature of antigenic evolution and the quasi-neutral dynamics of high frequency variants observed for influenza viruses.</p>
</abstract>
</article-meta>
</front>
<body>
<sec id="s1" sec-type="intro">
<title>A. Introduction</title>
<p>Many human RNA viruses adapt rapidly to evade pre-existing immunity and re-infect humans multiple times over their lifetime. The most prominent examples of this evolution are influenza virus and SARS-CoV-2 [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>], for which the changing virus population is surveilled in great detail and vaccines are updated regularly. To improve the match between the virus population and the vaccine, several groups are working on predictive models to anticipate the variants that dominate future viral populations [<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c4">4</xref>].</p>
<p>A common framework to model the rapid evolutionary dynamics of RNA viruses is to consider a population located away from the fitness optimum and with many accessible beneficial mutations [<xref ref-type="bibr" rid="c5">5</xref>]. In this setting, clones compete to accumulate beneficial mutations as quickly as possible. In a process called selective sweep, successful variants expand and tend to be the ancestors of the future population while less successful mutants eventually disappear. The resulting fitness distribution is a wave traveling along the fitness axis, the so-called <italic>traveling fitness wave</italic> [<xref ref-type="bibr" rid="c6">6</xref>–<xref ref-type="bibr" rid="c8">8</xref>]. As the pathogen circulates, hosts develop immunity which leads to a ‘deterioration of the environment’ for the pathogen which approximately balances the increase in average fitness due to adaptation.</p>
<p>The traveling wave framework has been extensively used in this context as it allows for a straightforward way to approach the prediction problem: each variant is assumed to have a fixed fitness relative to other variants, and inferring the fitness of all competing variants should allow prediction of the future composition of the population. Indeed, current methods typically infer the instantaneous growth advantage of a strain based on past and present circulation and then project this growth advantage forward in time [<xref ref-type="bibr" rid="c9">9</xref>–<xref ref-type="bibr" rid="c11">11</xref>].</p>
<p>In terms of modeling, a drawback of the traveling wave approach is the lack of explicit representation of the epidemiological dynamics and of the host’s immunity. Indeed, fitness is only an effective parameter that summarizes the complex interplay between viral antigenic properties and the hosts’ immune systems. As such, it cannot explicitly describe important phenomena such as the build-up of host immunity to new variants, variant specific immunity, or the interaction between strains through antigenic cross-reactivity. Taking the hosts’ immunity and viral cross-immunity into account has the potential to strongly improve predictions [<xref ref-type="bibr" rid="c4">4</xref>] or explain why prediction is difficult [<xref ref-type="bibr" rid="c12">12</xref>].</p>
<p>The interaction between epidemiological dynamics and hosts’ immunity are often modeled using generalizations of the Susceptible-Infected-Recovered model (SIR) to include multiple viral strains [<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c14">14</xref>]. In this setting, the natural question is that of the ultimate fate of the pathogen: will it go extinct, diversify to the point of speciation, or reach the so-called Red Queen State where new strains continuously replace old ones [<xref ref-type="bibr" rid="c15">15</xref>–<xref ref-type="bibr" rid="c18">18</xref>]. To remain tractable, these studies typically approximate population immunity as a low-dimensional landscape in which the viral population evolves and ignore the complex heterogeneity in the immunity of different individuals. Furthermore, immunity is often assumed to be long lived and evolution of the pathogen in a stable low dimensional landscape gives rise to traveling waves.</p>
<p>Here, we study how novel variants of a virus shape the host population’s immunity, which in turn changes their own growth dynamics. To do so, we use a multi-strain SIR model combining immune waning and heterogeneous immunity of the hosts. Such heterogeneity has been demonstrated for influenza virus in individuals of different ages [<xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c20">20</xref>]. We show that this model generically leads to a situation where novel immune evasive variants emerge. In a homogeneous population of hosts, this leads to a succession of selective sweeps where novel variants compete against each other and replace previously circulating variants. However, in a heterogeneous population with more rapid waning of immunity, initially growing variants lose their selective advantage before reaching fixation due to immunological adjustment of the host population. The phenomenology of our model is reminiscent of ecological systems, where adaptation by one species shifts the global equilibrium and distribution of other species but does not necessarily result in a selective sweep. In these systems, adaptation can usually not be modeled by a scalar fitness parameter for each strain [<xref ref-type="bibr" rid="c21">21</xref>].</p>
<p>Strain dynamics in our model differ qualitatively from what is expected in the traveling wave scenario. While adaptive mutations are highly overrepresented, they cease having a growth advantage when reaching intermediate frequencies, a process we call “expiring fitness”. Once the fitness effect of a mutation has expired, its frequency randomly changes up or down as subsequent adaptive mutations occur on the same or on different genomic backgrounds.</p>
<p>This resemblance to neutral evolution could have important consequences for predictability of viral evolution. It is interesting to relate this to the recent observations that the evolution of influenza is not as predictable as one would expect from typical models [<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c12">12</xref>]. In particular, we observed in [<xref ref-type="bibr" rid="c12">12</xref>] that the frequency trajectories of mutants of A/H3N2 influenza show features that are expected in neutral evolution but hard to explain in a traveling wave framework.</p>
</sec>
<sec id="s2" sec-type="results">
<title>B. Results</title>
<sec id="s2a">
<title>1. Multi-strain SIR model</title>
<p>We describe the interaction of several viral strains and host immunity using a Susceptible/Infected compartmental model, similar to those used in [<xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c15">15</xref>]. In the most general form, the model describes N variants of the virus labeled <italic>α</italic> ∈ {1… <italic>N</italic>} circulating among M groups of hosts with distinct exposure histories labeled <italic>i</italic> ∈ {1… <italic>M</italic>} (immune groups). These groups could be different age cohorts or be geographically separated. For each group <italic>i</italic>, we define compartments <inline-formula id="ID1">
<alternatives>
<mml:math display="inline" id="I1"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq1.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> and <inline-formula id="ID2">
<alternatives>
<mml:math display="inline" id="I2"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq2.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> as respectively the number of individuals of this group infected or susceptible to strain a. We assume that the total population of hosts is 1 so that we always have <inline-formula id="ID3">
<alternatives>
<mml:math display="inline" id="I3"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq3.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, and values of <inline-formula id="ID4">
<alternatives>
<mml:math display="inline" id="I4"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq4.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> and <inline-formula id="ID5">
<alternatives>
<mml:math display="inline" id="I5"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq5.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> can be interpreted as fractions of the host population.</p>
<p>As with usual compartmental models, we assume that the dynamics are driven by the interaction of susceptible and infected hosts, leading to infections and gains of immunity. The rate at which hosts of group i susceptible to variant <italic>a</italic> are infected by <italic>a</italic> is <inline-formula id="ID6">
<alternatives>
<mml:math display="inline" id="I6"><mml:mrow><mml:mi>α</mml:mi><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>I</mml:mi><mml:mi>j</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq6.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. Here, a is an overall infection rate while <italic>C<sub>ij</sub></italic> represents the probability of an encounter between individuals of group <italic>i</italic> and <italic>j</italic>. Thus, the above rate takes into account infections with strain <italic>a</italic> caused by hosts of all groups. Considering that infected hosts recover at rate <italic>δ</italic>, we can thus write the dynamics for <inline-formula id="ID7">
<alternatives>
<mml:math display="inline" id="I7"><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq7.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>:
<disp-formula id="FD1">
<alternatives>
<mml:math id="M1" display="block"><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle><mml:msubsup><mml:mi>I</mml:mi><mml:mi>J</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn1.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(1)</label>
</disp-formula>
</p>
<p>In the rest of this work, we will often consider the case <italic>C<sub>ij</sub></italic> = 1/<italic>M</italic>, corresponding to the case where hosts of different groups are equally likely to encounter members of any other group. Note that in this case, if we define the total number of susceptible or infected by <italic>a</italic> as <inline-formula id="ID8">
<alternatives>
<mml:math display="inline" id="I8"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq8.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> and <inline-formula id="ID9">
<alternatives>
<mml:math display="inline" id="I9"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq9.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, we can sum over the immune groups in the above equation to obtain <inline-formula id="ID10">
<alternatives>
<mml:math display="inline" id="I10"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq10.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. We consequently define the reproductive number of strain <italic>a</italic> as <inline-formula id="ID11">
<alternatives>
<mml:math display="inline" id="I11"><mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq11.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. <italic>I<sup>a</sup></italic> grows when <italic>R<sup>a</sup></italic> &gt; 1 and declines when <italic>R<sup>a</sup></italic> &lt; 1. The equilibrium susceptibility is <italic>S<sup>a</sup></italic> = <italic>δ/α,</italic> such that <italic>R<sup>a</sup></italic> = 1.</p>
<p>When a host of group <italic>i</italic> is infected by strain <italic>b</italic>, it also has a chance <inline-formula id="ID12">
<alternatives>
<mml:math display="inline" id="I12"><mml:mrow><mml:mn>0</mml:mn><mml:mo>≤</mml:mo><mml:msubsup><mml:mi>K</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mo>≤</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq12.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> to gain immunity to strain <italic>a</italic>. Thus, <inline-formula id="ID13">
<alternatives>
<mml:math display="inline" id="I13"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq13.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> decreases at a rate proportional to <inline-formula id="ID14">
<alternatives>
<mml:math display="inline" id="I14"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq14.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> and to the number of hosts infected by <italic>b</italic> for every strain <italic>b</italic>. Since susceptibles to <italic>a</italic> are depleted by infections from other strains, the dynamics of all strains are coupled. This coupling is determined by the matrices <bold>K</bold><sub>i</sub> of dimension <italic>N × N</italic>, which in general differ between groups <italic>i</italic> with different prior exposure history. Additionally, waning of immunity at a rate <italic>γ</italic> causes immune hosts to re-enter the susceptible compartment. We can now write the dynamics of <inline-formula id="ID15">
<alternatives>
<mml:math display="inline" id="I15"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq15.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> as
<disp-formula id="FD2">
<alternatives>
<mml:math id="M2" display="block"><mml:msubsup><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>j</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:msubsup><mml:mi>K</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>I</mml:mi><mml:mi>j</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn2.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(2)</label>
</disp-formula>
</p>
<p>where the first term accounts for immunity gains (or loss of susceptibility) due to infections or cross-immunity while the second represents immune waning. This model introduced by Gog and Grenfell [<xref ref-type="bibr" rid="c14">14</xref>] assumes that immunity builds up through exposure and not only through infection. This explains that the change in <inline-formula id="ID16">
<alternatives>
<mml:math display="inline" id="I16"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq16.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> is simply proportional to <inline-formula id="ID17">
<alternatives>
<mml:math display="inline" id="I17"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>⋅</mml:mo><mml:msubsup><mml:mi>I</mml:mi><mml:mi>j</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq17.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, regardless of the susceptibility of hosts to strain b. Alternative models that require infection for acquisition of immunity have qualitatively similar dynamics, but are mathematically more complex (see supplementary material). We also represented loss of susceptibility to <italic>a</italic> due to exposure to <italic>a</italic> using a trivial cross-immunity term <inline-formula id="ID18">
<alternatives>
<mml:math display="inline" id="I18"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq18.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>.</p>
<p>An important property of our model is that the probability to generate cross-immunity can differ between groups. The motivation is that strains <italic>a</italic> and <italic>b</italic> may be perceived as antigenically different by some immune systems, leading to a low <inline-formula id="ID19">
<alternatives>
<mml:math display="inline" id="I19"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq19.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, but as highly similar by others, leading to <inline-formula id="ID20">
<alternatives>
<mml:math display="inline" id="I20"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup><mml:mo>≃</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq20.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. Such a heterogeneous response by different immune systems has been observed experimentally in the case of influenza: in [<xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c20">20</xref>] for instance, it was found that a given mutation in an influenza strain may allow escape from the antibodies of some individuals, i.e. low <inline-formula id="ID21">
<alternatives>
<mml:math display="inline" id="I21"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq21.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, while it had little effect for the serum of other individuals, i.e. high <inline-formula id="ID22">
<alternatives>
<mml:math display="inline" id="I22"><mml:mrow><mml:msubsup><mml:mi>K</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq22.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. Heterogeneous immune response could be caused by varying histories of strain exposure for different individuals, for instance due to difference in age or geographical region. If immune groups correspond to age cohorts, mixing between groups is rapid and we can simplify the connectivity between groups to <italic>C<sub>ij</sub></italic> = 1/<italic>M</italic>. If immune groups are shaped by geographic differences in exposure, the connectivity would be close to 1 on the diagonal (1 − <italic>C<sub>ii</sub></italic> ≪ 1) while off-diagonal terms would be small (<italic>C<sub>ij</sub></italic> ≪ 1 for <italic>i</italic> ≠ <italic>j</italic>).</p>
</sec>
<sec id="s2b">
<title>2. Invasion of an adaptive variant</title>
<p>Hosts’ immune heterogeneity and strain cross-immunity play two different roles in the model. The latter allows the model to reach a non-trivial equilibrium where multiple strains co-exist, while the former affects the convergence to the equilibrium.</p>
<p>To illustrate this, we design a simple scenario with only two strains: a wild-type and a variant. Accordingly, indices (<italic>a, b</italic>) describing strains will take values {<italic>wt, v</italic>}. We consider that the two strains share the same infectivity rate a, which amounts to say that they would have the same reproductive rate in a fully naive population. The case where the two strains differ in intrinsic fitness is explored in detail in the SI. In brief, as long as the difference in intrinsic fitness is not too large compared to cross-immunity effects, the qualitative results given below hold, while larger intrinsic fitness differences lead to more classical dynamics like selective sweeps.</p>
<p>In the first version of this scenario, we will only consider one immune group, that is <italic>M</italic> = 1. In this case, we can skip the indices <italic>i, j</italic> ∈ {1… <italic>M</italic>}, and we only have one cross-immunity matrix <bold>K</bold> that we parametrize as
<disp-formula id="FD3">
<alternatives>
<mml:math id="M3" display="block"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>f</mml:mi></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn3.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(3)</label>
</disp-formula>
</p>
<p>with 0 ≤ <italic>b, f</italic> ≤ 1. <italic>b</italic> quantifies the amount of “backward”-immunity to the wild-type caused by the variant: a large <italic>b</italic> means that it is likely that an infection by the variant causes immunity to the wild-type. Conversely, <italic>f</italic> quantifies the “forward”-immunity: infections by the wild-type causing immunity to the variant. If <italic>f</italic> = <italic>b</italic> = 1, the two strains are antigenically indistinguishable, and thus essentially identical for the model. Conversely, if <italic>f</italic> = <italic>b</italic> = 0, the two strains are completely distinct and do not interact through cross-immunity.</p>
<p>The dynamical equations now take a simplified form:
<disp-formula id="FD4">
<alternatives>
<mml:math id="M4" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>v</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn4.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(4)</label>
</disp-formula>
</p>
<p>We can immediately derive the equilibrium state for this simplified case. For the susceptibles we find <italic>S<sup>a</sup></italic> = <italic>δ/α</italic> for all strains <italic>a</italic>, while the equilibrium prevalence is determined by the inverse of the cross-immunity matrix <bold>K</bold>:
<disp-formula id="FD5">
<alternatives>
<mml:math id="M5" display="block"><mml:msubsup><mml:mi>I</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow><mml:mi>a</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>α</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn5.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(5)</label>
</disp-formula>
</p>
<p>with <inline-formula id="ID23">
<alternatives>
<mml:math display="inline" id="I23"><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq23.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> being the vector [1; 1]. The order of magnitude of the prevalence is given by the ratio of the rate of waning <italic>γ</italic>(1 − <italic>δ/α</italic>) and the recovery rate <italic>δ</italic>. In the following, we frequently use values <italic>α</italic> = 3 and <italic>α</italic> = 5 · 10<sup>−3</sup> in units of inverse generations δ, i.e. we set <italic>δ</italic> = 1. At equilibrium, this corresponds to a fraction ~ 0.003 of the host population being infected at any time. If generation time is a week, which is roughly the case for respiratory viruses such as influenza virus or SARS-cov-2, the fraction of hosts infected in any year is ~ 0.15, which is of similar magnitude as empirical estimates for influenza [<xref ref-type="bibr" rid="c22">22</xref>].</p>
<p>It is also straightforward to compute the fraction of infections caused by the variant at equilibrium, thereafter referred to as the frequency of the variant. We find that this frequency is
<disp-formula id="FD6">
<alternatives>
<mml:math id="M6" display="block"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn6.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(6)</label>
</disp-formula>
</p>
<p>In the case where <italic>b = f</italic>, the variant will ultimately settle at frequency 1/2. This includes the case where <italic>b = f</italic> = 0, where the two strains are completely independent and do not interact. On the contrary if <italic>b</italic> ≠ <italic>f</italic>, the final frequency of the variant can in principle be anywhere between 0 and 1. For example if <italic>b</italic> &gt; <italic>f</italic>, the variant is more likely to cause immunity to the wild-type than the wild-type is to cause immunity to the variant. In this case, <italic>α</italic> &gt; 1/2 and the variant will be the dominant variant.</p>
<p>In our invasion scenario, only the wild-type is initially present in the population, that is <italic>I<sup>v</sup></italic> = 0 at <italic>t</italic> &lt; 0. The details of the equilibrium reached by the system in the absence of the mutant is given in the SI. Importantly, in this initial state, the number of hosts susceptible to the variant is always larger than the equilibrium value <italic>δ/α</italic> unless <italic>f</italic> = 1, but smaller than 1 unless <italic>f</italic> = 0. This comes from the fact that due to cross-immunity, part of the hosts are immune to the variant even if it is not yet circulating. As a result, when the variant is introduced at <italic>t</italic> = 0, for instance because it emerged by mutation, its growth rate is initially positive.</p>
<p>The top row of <xref ref-type="fig" rid="fig1">Figure 1</xref> shows the dynamics of the model after the introduction of the variant in a homogeneous population (<italic>M</italic> = 1). As expected, the number of infections by the variant initially rises while the number of susceptibles <italic>S<sup>v</sup></italic> decreases. However, as <italic>S<sup>v</sup></italic> goes below the critical value <italic>δ/α, I<sup>v</sup></italic> starts to decline and then oscillates around the equilibrium value before finally converging to it. The mathematical properties of these oscillations are discussed in the SI.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>FIG. 1.</label>
<caption><p>Invasion scenario for <bold>Top row</bold>: one immune group, <bold>Middle row</bold>: <italic>M</italic> = 10 immune groups and fast mixing <italic>C<sub>ij</sub></italic> = 1/<italic>M</italic> and <bold>Bottom row</bold> <italic>M</italic> = 10 immune groups and slow mixing <italic>C<sub>ij</sub></italic> = 1/10<italic>M</italic>. Other parameters are the same for all rows: in units of <italic>δ</italic>, we set <italic>α</italic> = 3 and <italic>γ</italic> = 5 · 10<sup>−3</sup>, and <italic>f</italic> = 0.65, <italic>b</italic> = 0.8, <italic>ε</italic> = 0.99. For both rows, graphs represent: <bold>Left</bold>: number of hosts infectious with the wild-type and the variant; <bold>Middle</bold>: number of hosts susceptible to the wild-type and the variant, with the equilibrium value <italic>δ/α</italic> as a gray line; <bold>Right</bold>: fraction of the infections due to the variant. The thick gray line shows the expected equilibrium frequency <italic>¡3</italic> in the case with one immune group, given in <xref ref-type="disp-formula" rid="FD6">Eq. 6</xref>. The dashed line shows the trajectory of a constant fitness logistic growth with the same initial growth rate.</p></caption>
<graphic xlink:href="2402.07252v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>However, these strong and slowly damped oscillations are not what is observed in circulating viruses. For instance, in the first oscillation in the specific example of <xref ref-type="fig" rid="fig1">Figure 1</xref>, the prevalence of the wild-type <italic>I<sup>wt</sup></italic> goes down to microscopic levels and the frequency of the variant approaches one, see <xref ref-type="fig" rid="fig1">Figure 1</xref>. During stochastic circulation in a finite population of hosts the wild-type would likely be lost. The theoretical equilibrium that is reached at long times is thus not very relevant, and what would be actually observed in reality is a selective sweep by the variant.</p>
<p>Oscillations are the consequence of the rapid rise of the variant followed by an overshoot. This effect is mitigated by immunological heterogeneity, as shown in the following example with <italic>M</italic> = 10 groups. For group <italic>i</italic> = 1, the cross-immunity matrix <italic>K</italic><sub>1</sub> takes the same form as in the previous scenario, given by <xref ref-type="disp-formula" rid="FD3">Equation 3</xref>. However, for other groups, we assume that the two strains are virtually identical, with the cross-immunity having the form
<disp-formula id="FD7">
<alternatives>
<mml:math id="M7" display="block"><mml:msub><mml:mi>K</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>&gt;</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ε</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn7.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(7)</label>
</disp-formula>
</p>
<p>where <italic>ε</italic> ≪ 1. Our reasoning is that we expect an adaptive variant to escape the existing immunity for part of the host population, here immune group 1, while having little effect on the rest of the hosts. As a result, a larger fraction of the hosts will initially be immune to the variant. If mixing is rapid, the initial growth rate of the variant is smaller by a factor <italic>M</italic> compared to the one-group case. For <italic>ε</italic> = 0, the equilibrium frequency does not depend on <italic>M</italic> and <xref ref-type="disp-formula" rid="FD6">Equation 6</xref> remains valid, while for small <italic>ε</italic> the equilibrium shifts slightly. If mixing is slow, the initial growth of the variant is rapid as in the one-group case, but then spreads only slowly across groups.</p>
<p>The central and bottom rows of <xref ref-type="fig" rid="fig1">Figure 1</xref> show the result of the invasion for <italic>M</italic> groups respectively for the rapid and slow mixing cases. In both scenarios, the initial number of hosts susceptible to the variant is now closer to <italic>δ/α</italic>, and accordingly the initial growth rate of <italic>I<sup>v</sup></italic> is smaller. When mixing is fast, the frequency of the variant initially resembles a standard selective sweep (dashed line in <xref ref-type="fig" rid="fig1">Figure 1</xref>) before saturating, while dynamics are more complicated for the slow mixing case. Either way, the main effect of the immune groups is that the overshoot past the equilibrium is much smaller and dampening of the oscillations stronger. As a result, the frequency of the variant approaches its equilibrium value without effectively sweeping to fixation before. While this simple two-strain model predicts that the two strains come to an equilibrium at frequency <italic>β</italic>, their frequency will of course continue to change due to emergence of additional strains, which we will discuss below.</p>
<p>Even though the variant has a clear growth rate advantage when it appears, this does not result in it replacing the wild-type. This contrasts with the typical “selective sweep” that occurs when the growth rate advantage stays constant, which is illustrated as a dashed line in the figure. We refer to frequency trajectories of a variant that at first rise exponentially before settling at an intermediate frequency as <italic>partial sweeps</italic>. As we will discuss below, such partial sweeps can lead to qualitatively different evolutionary dynamics and its predictability.</p>
<p>If the initial growth is due to higher susceptibility, it is misleading to think of it as an intrinsic fitness advantage of the variant. What allows the initial growth is better described as an imbalance in the immune state of the host population, which gradually disappears as the variant becomes more frequent, as shown in the central panels of <xref ref-type="fig" rid="fig1">Figure 1</xref>. In this sense, our model is comparable to ecological systems where interaction between organisms cannot be fully explained using a scalar fitness [<xref ref-type="bibr" rid="c21">21</xref>]. An important implication is that predicting the equilibrium frequency reached by the variant and its ultimate fate is hard from the observation of a partial frequency trajectory.</p>
</sec>
<sec id="s2c">
<title>3. Ultimate fate of the invading variant</title>
<p>In the invasion scenario discussed above, dynamics stop after the initial variant has reached an equilibrium frequency. However, as the viral population evolves, new adaptive mutants can appear. In the framework of the SIR model, a new strain translates into extending the cross-immunity matrix by one row and one column. Each new variant will perform its own partial sweep, and saturate at frequencies <italic>β<sub>2</sub>, β<sub>3</sub>,…</italic> This process is shown in panel <bold>A</bold> of <xref ref-type="fig" rid="fig2">Figure 2</xref>, using the SIR model to simulate up to N = 7 variants. For the sake of illustration, it shows a simple scenario where the initial variant appears at time 0 in a homogeneous wild-type population, and subsequent mutants appear at regular time intervals. Simulations are performed using <italic>M</italic> = 10 immune groups, resulting in a slight overshoot of the equilibrium frequency for each trajectory.</p>
<p>Here, we focus on the mutation or set of mutations <italic>A</italic> that defines the initial variant. The initial growth rate advantage given by <italic>A</italic> eventually disappears, meaning that after some time we can consider it as neutral. As subsequent mutants appear, they either do so on the background of the wild-type, in which case they do not carry <italic>A</italic>, or on the background of the initial variant in which case they do carry A. If we suppose that recombination is negligible, the frequency of A increases or decreases as each new variant undergoes its own partial sweep. This process is shown in panel <bold>B</bold> of <xref ref-type="fig" rid="fig2">Figure 2</xref>, with shades of red (resp. blue) indicating a variant carrying A (resp. not carrying A). The thick line in between the red and blue surfaces indicate the frequency at which mutation A is found, and in practice moves up and down randomly.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>FIG. 2.</label>
<caption><p><bold>A</bold> Simulation of SIR <xref ref-type="disp-formula" rid="FD1">Equations 1</xref> &amp; <xref ref-type="disp-formula" rid="FD2">2</xref> with additional strains appearing at regular time intervals. The fraction of infections (frequency) caused by each strain is shown as a function of time. The first strain to appear at <italic>t</italic> = 0 is the variant of interest, and curves are shown in shades of red if they appear on the background of this variant, and of blue if they appear on the background of the wild-type. <bold>B</bold>: Same as <bold>A</bold> but with frequencies stacked vertically. The black line delimiting the red and blue areas represents the frequency at which the mutations defining the original variant are found. <bold>C</bold>: Three realizations of the random walk of <xref ref-type="disp-formula" rid="FD8">Equation 8</xref>, all starting at <italic>x ≃</italic> 0.5. Two instances converge rapidly to frequency 0 and 1, corresponding to apparent selective sweeps, while the remaining one oscillates for a longer time. <bold>D</bold>: Representation of a partial sweep using the scalar fitness parametrization of <xref ref-type="disp-formula" rid="FD10">Equation 10</xref>. The frequency <italic>x</italic> of the variant is shown as a blue line saturating at value <italic>β</italic> (gray line). The thin dashed line shows a selective sweep with constant fitness advantage <italic>s</italic><sub>0</sub>. The fitness s is a red dashed line, using the right-axis.</p></caption>
<graphic xlink:href="2402.07252v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The scenario illustrated in <xref ref-type="fig" rid="fig2">Fig. 2</xref> suggests that many aspects of the variant dynamics can be approximated by a simple abstraction: If <italic>x</italic> is the frequency of a mutation <italic>A</italic>, a new variant has a probability <italic>x</italic> to appear on the background of <italic>A</italic> and thus carry <italic>A</italic>, and a probability 1 – <italic>x</italic> to not carry <italic>A</italic>. If new mutants emerged well separated in time with rate <italic>ρ</italic>, meaning that they reach equilibrium before the next variant emerges, and if new variants have a similar cross-immunity with all existing variants (see SI), the dynamics of <italic>x(t)</italic> are described by a particular random walk: in each time interval d<italic>t</italic>, a partial sweep of amplitude <italic>β</italic> occurs with probability <italic>ρ</italic>d<italic>t</italic> · <italic>P<sub>β</sub>(β)</italic>, changing x in the following way:
<disp-formula id="FD8">
<alternatives>
<mml:math id="M8" display="block"><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>+</mml:mo><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mtext>  where  </mml:mtext><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>x</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>with probaility </mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mtext>with probaility </mml:mtext><mml:mi>x</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:mrow></mml:math>
<graphic xlink:href="2402.07252v1_eqn8.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(8)</label>
</disp-formula>
</p>
<p>For example, if a new mutant appearing on the background of <italic>A</italic> does a partial sweeps of amplitude <italic>β</italic>, the frequency of <italic>A</italic> among the fraction of strains (1 – <italic>β</italic>) not concerned by the sweep will still be <italic>x</italic>, and its frequency among the fraction <italic>β</italic> of strains concerned by the sweep will be 1. Overall, this gives a frequency change of Δ<italic>x</italic> = (1 – <italic>x</italic>)<italic>β</italic>. A similar reasoning gives us the frequency change when the new mutant appears on the wild-type background. Finally, if no sweep occurs in the time interval d<italic>t</italic>, that is with probability 1 – <italic>ρ</italic>d<italic>t</italic>, <italic>x</italic> remains unchanged. The resulting frequency dynamics of mutations has many similarities to the effect of ‘genetic draft’, that is the frequency dynamics of neutral mutations due to linked selective sweeps [<xref ref-type="bibr" rid="c23">23</xref>].</p>
<p>Examples of trajectories from the random walk are shown on panel <bold>C</bold> of <xref ref-type="fig" rid="fig2">Figure 2</xref>, all initially starting around <italic>x</italic><sub>0</sub> ≃ 1/2. Two trajectories are seen converging monotonously to 0 and 1. This is a consequence of one interesting property of <xref ref-type="disp-formula" rid="FD8">Equation 8</xref>: the probability for Δ<italic>x</italic> to be positive increases with <italic>x</italic> but the magnitude of the upwards steps decreases as 1 – <italic>x</italic>, and symmetrically with downward steps. This leads to trajectories leading almost exponentially to 0 and 1: it can in fact be shown that trajectories that <italic>always</italic> go downwards or upwards represent a finite and relatively large fraction of all possible trajectories (see SI). On the other hand, steps away from the closest boundary are unlikely but much larger, resulting in ‘jack-pot’ events [<xref ref-type="bibr" rid="c24">24</xref>]. This can be seen for the blue trajectory in <xref ref-type="fig" rid="fig2">Figure 2</xref>, which oscillates for a longer time.</p>
<p>It is also interesting to look at the moments of the step size Δ<italic>x</italic>. The first two are easily computed, and we find
<disp-formula id="FD9">
<alternatives>
<mml:math id="M9" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mtext> </mml:mtext><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext> </mml:mtext><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:msup><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn9.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(9)</label>
</disp-formula>
</p>
<p>The first moment being 0 means that for the random walk, increasingly probable but small steps towards the closest boundary (0 or 1) are exactly compensated by rarer but larger steps away from the boundary. Importantly, this means that on average, the trajectory of mutation A is not biased towards either fixation or loss, regardless of the frequency that the initial partial sweep brought it to. For instance, a mutation seen at frequency <italic>x</italic><sub>0</sub> should on average stay at this frequency, which means in practice that in a finite population it has a chance <italic>x</italic><sub>0</sub> to reach 1 and fix, and a chance 1 – <italic>x</italic><sub>0</sub> to reach 0 and vanish.</p>
<p>On the other hand, the second moment closely reminds of the theory of neutral drift [<xref ref-type="bibr" rid="c25">25</xref>]: in neutral evolution, allele frequency also undergoes a zero-average random walk with the second moment having the form <italic>x</italic>(1 – <italic>x</italic>)/<italic>N</italic> with <italic>N</italic> being the population size. Therefore, this model would predict an “effective population size” as <inline-formula id="ID24">
<alternatives>
<mml:math display="inline" id="I24"><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq24.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> completely independent of the size of the viral population. However, there are important difference to neutral drift: in neutral evolution, higher moments of order <italic>k</italic> &gt; 2 decay as <italic>N</italic><sup>1-<italic>k</italic></sup> and are thus negligible in large populations, whereas here they are independent of <italic>N</italic> and scale as <inline-formula id="ID25">
<alternatives>
<mml:math display="inline" id="I25"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq25.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. Depending on higher moments of <italic>P<sub>β</sub></italic>, allele dynamics will deviate qualitatively from neutral behavior.</p>
</sec>
<sec id="s2d">
<title>4. Abstraction as ‘expiring’ fitness advantage</title>
<p>In general, the dynamics of the SIR model proposed in <xref ref-type="disp-formula" rid="FD1">Equations 1</xref>&amp;<xref ref-type="disp-formula" rid="FD2">2</xref> depend on the interactions between N strains through an <italic>N × N</italic> cross-immunity matrix. While this model is useful to give a mechanistic explanation of partial sweeps, it is in general impractical to analyze and numerically simulate for a large number of variants. For this reason, we propose a simpler empirical model for partial sweeps where the growth rate s of the variant is not explicitly set by the susceptibility dynamics in the host population, but instead decays at a rate proportional to the frequency <italic>x</italic> of the variant:.
<disp-formula id="FD10">
<alternatives>
<mml:math id="M10" display="block"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>x</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>  and  </mml:mtext><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mi>x</mml:mi><mml:mi>s</mml:mi><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn10.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(10)</label>
</disp-formula>
</p>
<p>The dynamic of <italic>x</italic> in the first equation is simply given by the usual logistic growth with fitness s. To mimic increasing immunity against the invading variant, the growth advantage s decreases proportionally to the abundance of the variant (second part of <xref ref-type="disp-formula" rid="FD10">Eq. 10</xref>).</p>
<p>The dynamics of this new model are represented in panel <bold>D</bold> of <xref ref-type="fig" rid="fig2">Figure 2</xref>, with an initial frequency <italic>x</italic><sub>0</sub> ≪ 1 and an initial growth rate <italic>s</italic><sub>0</sub> = 0.05. The initial growth of <italic>x</italic> is identical to a classical selective sweep of fitness <italic>s</italic><sub>0</sub> (represented as a dashed line). However, its fitness advantage gradually “expires”, as shown by the red line in the figure. As the variant progressively “runs out of steam”, its frequency finally saturates at a value <italic>β</italic> given by (see SI)
<disp-formula id="FD11">
<alternatives>
<mml:math id="M11" display="block"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn11.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(11)</label>
</disp-formula>
</p>
<p>This final value <italic>β</italic> depends only on the ratio between the initial fitness advantage <italic>s</italic><sub>0</sub> and the rate of fitness decay <italic>v</italic>. For a large enough <italic>s</italic><sub>0</sub>, <italic>β</italic> can be arbitrarily close to 1, meaning that this model still accommodates for full selective sweeps as a special case. In the general case, <italic>x</italic> reaches its final value <italic>β</italic> &lt; 1 and remains there forever unless other variants appear. Due to its simplicity, this model does not show the oscillatory behavior of the SIR model, but otherwise recapitulates the salient feature of invading immune evasive variants: (i) initial exponential growth, and (ii) eventual saturation at an intermediate frequency. This simplified model of partial sweeps leads to the same random walk dynamics as the SIR model above and allows us to study the implications of this dynamics systematically.</p>
</sec>
<sec id="s2e">
<title>5. Consequences for predictability and population dynamics</title>
<p>Accurate prediction of dominant viral variants of the future could improve the choice of antigens in vaccines against rapidly evolving viruses. Specifically, if a potentially adaptive mutation is observed in a viral population, one would want to know if the corresponding variants will grow in frequency, and if yes to what point? The typical traveling wave framework would predict that fast-growing variants should keep on growing until an even fitter one appears. This way of thinking about the prediction problem has shown mixed results. In the case of A/H3N2 influenza for instance, we showed that there are few signatures that suggest fit variants grow in frequency consistently [<xref ref-type="bibr" rid="c12">12</xref>].</p>
<p>In <xref ref-type="fig" rid="fig3">Figure 3</xref>, we reproduce some of our results of Barrat-Charlaix et al. [<xref ref-type="bibr" rid="c12">12</xref>] and extend them to SARS-CoV-2. To quantify predictability, we ask the following question: given the state of a viral population at times 0, 1, … , <italic>t</italic>, what can we say about variant frequencies at times <italic>t</italic> + 1, …? We performed a retrospective analysis of viral evolution and identified all amino-acid mutations that were observed to grow from frequency 0 to an arbitrary threshold <italic>x</italic><sup>*</sup>. Adaptive beneficial mutations should in principle be overrepresented in this group. Looking at the corresponding frequency trajectories, we can see on average whether they keep on growing beyond <italic>x</italic><sup>*</sup>. <xref ref-type="fig" rid="fig3">Figure 3</xref> shows these trajectories for the amino acid substitutions in the HA protein of A/H3N2 influenza, using data from 2000 to 2023, and the SARS-CoV-2 genome using data from 2020 to 2023. Panels on the left show all trajectories that reached <italic>x</italic><sup>*</sup> = 0.4, with their average displayed in black. The panels on the right show the average trajectory for different threshold values <italic>x</italic><sup>*</sup> between 0.1 and 0.8.</p>
<p>While the dynamics of the variants of the two viruses can not be compared directly due to vastly different sampling intensities and different rates of adaptation, the qualitative patterns differ strikingly. In the case of influenza, trajectories of seemingly adaptive mutations show little inertia and on average hover around <italic>x</italic><sup>*</sup> instead of growing. This surprising result is in line with the study in [<xref ref-type="bibr" rid="c12">12</xref>] which used data from the period 2000-2018. On the other hand, trajectories of SARS-CoV-2 mutations show a much smoother behavior with steady growth beyond <italic>x</italic><sup>*</sup>. On longer timescales however, we observe a systematic decrease in frequency: this is explained by the particular initial dynamics of SARS-CoV-2, where new variants arose at a rapid pace and replaced old ones. This process is often called clonal interference and reduces long term predictability.</p>
<p>In our setting of eco-evolutionary adaptation, the random walk model predicts that the probability of fixation of an immune evasive variant is given by the final frequency <italic>β</italic> of its initial partial sweep. Subsequent allele dynamics and diversity are governed by an anomalous coalescent process driven by the random walk defined in <xref ref-type="disp-formula" rid="FD8">Eqs. 8</xref>, leading to little predictability of evolution. This abstraction should hold when partial sweeps are instant and do not overlap, meaning that the rate <italic>ρ</italic> at which new variants emerge is small compared to their initial growth rate <italic>s</italic><sub>0</sub>.</p>
<p>To explore the behavior of our partial sweep model in a more general setting, we simulate evolutionary dynamics of a population under a Wright-Fisher model with expiring fitness dynamics. Simulations involve a population of <italic>N</italic> viruses with a genotype where each position can be in one of two possible states <italic>σ<sub>i</sub></italic> ∈ [0,1]. Fitness effects si are associated with mutations at each position, and the total fitness of a virus is given by <inline-formula id="ID26">
<alternatives>
<mml:math display="inline" id="I26"><mml:mrow><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>σ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq26.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. At each generation, viruses with a fitness <italic>F</italic> expand by a factor <italic>e<sup>F</sup></italic>, and the next generation is constructed by sampling <italic>N</italic> individuals from the previous one. Following <xref ref-type="disp-formula" rid="FD10">Eq. 10</xref>, mutational effects <italic>s<sub>i</sub></italic> decrease by an amount <italic>vx<sub>i</sub> · s<sub>i</sub></italic>, where <italic>x<sub>i</sub></italic> is the frequency at which mutation <italic>i</italic> is found in the population.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>FIG. 3.</label>
<caption><p>Retrospective analysis of predictability of viral evolution: frequency trajectories of all amino acid substitutions that are observed to rise from frequency 0 to <italic>x</italic><sup>*</sup> for <bold>Top</bold>: influenza virus A/H3N2 from 2000 to 2023, and <bold>Bottom</bold>: SARS-CoV-2 from 2020-2023. <bold>Left</bold>: all trajectories for <italic>x</italic><sup>*</sup> = 0.4, with blue ones ultimately vanishing and red ones ultimately fixing. The average of all trajectories is shown as a thick black line. <bold>Right</bold>: showing only the average trajectories for different values of <italic>x</italic><sup>*</sup> (grey lines).</p></caption>
<graphic xlink:href="2402.07252v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We simulate the emergence of adaptive variants in the following way. At a constant rate <italic>ρ</italic>, we pick one sequence position <italic>i</italic> that has no polymorphism and set the fitness effect of the corresponding mutation to an initial value <italic>s<sub>i</sub></italic>, with an amplitude drawn from probability distribution <italic>P<sub>s</sub></italic> and the sign chosen so as to favor mutations. In practice, we use an exponential distribution for <italic>P<sub>s</sub></italic>, meaning that the typical magnitude of initial fitness effects is described by only one parameter <italic>s</italic><sub>0</sub>. The corresponding distribution of partial sweep size is described in the SI. At the same time, we introduce the corresponding mutant in the population at a low frequency, picking its background genotype from a random existing strain. The behavior of the model is determined by (i) the distribution <italic>P<sub>β</sub></italic>, of partial sweeps size depending on <italic>v/s</italic><sub>0</sub>, and (ii) the ratio of the variant emergence rate and their growth rate <italic>ρ/s</italic><sub>0</sub>, which determines how often sweeps overlap and interact.</p>
<p>We use this simulation to address the question of predictability: given the state of the population at generations 0, 1, …, <italic>t</italic>, can we predict its state at future times <italic>t</italic> + 1, …? Specifically, we ask whether we can predict the frequency <italic>x</italic>(<italic>t</italic> + <italic>Δ</italic><italic>t</italic>) of a variant <italic>A</italic>, given it is at frequency <italic>x</italic> at time <italic>t</italic>, as we did previously for influenza virus [<xref ref-type="bibr" rid="c12">12</xref>], see <xref ref-type="fig" rid="fig3">Fig. 3</xref>. The dynamics of isolated selective sweeps (<italic>ρ/s</italic><sub>0</sub> ≪ 1, <italic>v/s</italic><sub>0</sub> ≪ 1) should be perfectly predictable: after an initial stochastic phase when the variant is very rare, its frequency grows monotonically to fixation. This predictability decreases with increasing <italic>ρ/s</italic><sub>0</sub> due to clonal interference [<xref ref-type="bibr" rid="c26">26</xref>], for example when an adaptive variant is outcompeted by an even more adaptive one. We also expect predictability to decrease with increasing <italic>v/s</italic><sub>0</sub> since sweeps are then partial and their ultimate fixation determined by subsequent variants with dynamics that resemble a random walk.</p>
<p>To quantify these effects, we select from a long simulation all rising frequency trajectories of adaptive mutations that cross an arbitrary threshold <italic>x</italic><sup>*</sup>. The results are shown in panel <bold>A</bold> of <xref ref-type="fig" rid="fig4">Figure 4</xref>, where we show the average <italic>x(t)</italic> of rising frequency trajectories after crossing the threshold <italic>x</italic><sup>*</sup> = 0.5. We use three rates of fitness decay: <italic>v</italic> ∈ [0, <italic>s</italic><sub>0</sub>/3, <italic>s</italic><sub>0</sub>, 3<italic>s</italic><sub>0</sub>] and low clonal interference <italic>ρ/s</italic><sub>0</sub> = 0.05. The case <italic>v</italic> = 0 corresponds to a classical traveling wave scenario with constant fitness effects, and, as expected, is the most predictable: the average trajectory rises well above 0.5. For larger values of <italic>v/s</italic><sub>0</sub> , corresponding to a quicker decay of fitness, predictability gradually declines and becomes negligible for <italic>v/s</italic> ≫ 1. Note that this matches quite well with the predictions from the random walk model where the average change in frequency <inline-formula id="ID27">
<alternatives>
<mml:math display="inline" id="I27"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>Δ</mml:mi><mml:mi>x</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq27.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> is null.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>FIG. 4.</label>
<caption><p>Simulations under the Wright-Fisher model with expiring fitness. <bold>A</bold>: Average frequency dynamics of immune escape mutations that are found to cross the frequency threshold <italic>x</italic><sup>*</sup> = 0.5, for four different rates of fitness decay. If the growth advantage is lost rapidly (high <italic>v/s<sub>0</sub></italic>), the trajectories crossing <italic>x</italic><sup>*</sup> have little inertia, while stable growth advantage (small <italic>v/s<sub>0</sub></italic>) leads to steadily increasing frequencies. <bold>B,C,D</bold>: Ultimate probability of p<italic>f<sub>ix</sub></italic> (<italic>x</italic>) of trajectories found crossing frequency threshold <italic>x</italic>. Each panel corresponds to a different rate of emergence of immune escape variants, with four rates of fitness decay per panel. Increased clonal interference <italic>ρ/s<sub>0</sub></italic> and fitness decay <italic>v/s<sub>0</sub></italic> both result in gradual loss of predictability. <bold>E</bold>: Time to most recent common ancestor <italic>T<sub>MRCA</sub></italic> for the simulated population, as a function of the prediction obtained using the random walk <inline-formula id="ID28">
<alternatives>
<mml:math display="inline" id="I28"><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq28.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. Points correspond to different choices of parameters <italic>s</italic><sub>0</sub></p></caption>
<graphic xlink:href="2402.07252v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To explore parameter space more systematically, we quantify predictability as the probability of fixation <italic>pf<sub>ix</sub></italic> of rising variants that cross threshold <italic>x</italic><sup>*</sup>. In a perfectly predictable scenario with well separated selective sweeps, <italic>pf<sub>ix</sub></italic> should be close to 1 regardless of <italic>x</italic><sup>*</sup>, while it should be equal to <italic>x</italic><sup>*</sup> in an unpredictable setting such as neutral evolution.</p>
<p>In panels <bold>B</bold>, <bold>C</bold> and <bold>D</bold> of <xref ref-type="fig" rid="fig4">Figures 4</xref>, probability of fixations are shown for three values of <italic>ρ/s</italic><sub>0</sub> and four values of <italic>v/s</italic><sub>0</sub>. Clonal interference increases when going from left to right among these panels (increasing <italic>ρ/s</italic><sub>0</sub>), while the intensity of fitness decay increases when going from blue to red curves (increasing <italic>v</italic>). Increasing either <italic>ρ/s</italic><sub>0</sub> or <italic>v/s</italic><sub>0</sub> reduces <italic>pf<sub>ix</sub></italic> towards the dashed diagonal corresponding to p<italic>f<sub>ix</sub></italic> = <italic>x</italic><sup>*</sup>. However, as observed previously [<xref ref-type="bibr" rid="c12">12</xref>], in the classic scenario with stable fitness effects <italic>v/s</italic><sub>0</sub> = 0 considerable predictability remains even in cases of strong interference (blue curve in panel <bold>B</bold>).</p>
<p>Finally, we use our simulation to investigate typical levels of diversity in the population and the time to the most recent common ancestor. One quantity that can easily be estimated from the random walk model is the average pairwise coalescence time <italic>T</italic><sub>2</sub>, that is the typical time separating two random strains from their most recent common ancestor (MRCA). In the SI, we show that under the random walk approximation, <inline-formula id="ID29">
<alternatives>
<mml:math display="inline" id="I29"><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>β</mml:mi></mml:msub></mml:mrow></mml:msub></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq29.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, which in neutral models of evolution would correspond to the effective population size <italic>N<sub>e</sub></italic>. A more detailed analysis of the coalescent process reveals that the random walk approximation corresponds to the so-called A-coalescent [<xref ref-type="bibr" rid="c27">27</xref>, <xref ref-type="bibr" rid="c28">28</xref>] (see SI).</p>
<p>In panel <bold>E</bold> of <xref ref-type="fig" rid="fig4">Figure 4</xref>, the average time to the common ancestor of pairs of strains in the population is plotted as a function of <italic>T</italic><sub>2</sub> predicted by the random walk model. Each point in the figure corresponds to one simulation of long duration with a given distribution of partial sweep size <italic>P<sub>β</sub></italic> and a given <italic>ρ</italic> setting <italic>T</italic><sub>2</sub>. We find a good agreement between the empirical time to MRCA and the estimation from the random walk, at least as long the probability of overlap between successive partial sweeps is small (indicated by shading, see SI). With increasing overlaps, coalescence slows down and diversity increases: points in darker shades of red tend to have larger time to MRCA than what is expected from the distribution of <italic>β</italic>. This is expected intuitively: if another adaptive variant emerges before the previous one has reached its final frequency, it has a lower probability to land on the same background and thus tends to be in competition with the first variant. This leads to a smaller effective <italic>β</italic> which slows the dynamics.</p>
</sec>
</sec>
<sec id="s3" sec-type="discussion">
<title>C. Discussion</title>
<p>Evolutionary adaptation is often pictured as an optimization problem in a static environment. In many cases, however, this environment is changed by the presence of the evolving species, for example because a host population develops immunity or a dynamic ecology. Here, we have explored consequences of such eco-evolutionary dynamics in a case of host-pathogen co-evolution where different variants of a pathogen shape each other’s environment through generation of cross-immunity.</p>
<p>Influenza virus evolution has been the subject of intense research with efforts to predict the composition of future viral populations [<xref ref-type="bibr" rid="c9">9</xref>–<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c29">29</xref>]. The A/H3N2 subtype in particular undergoes rapid antigenic change through frequent substitutions in prominent epitopes on its surface proteins [<xref ref-type="bibr" rid="c30">30</xref>–<xref ref-type="bibr" rid="c33">33</xref>]. Given the clear signal of adaptive evolution, one might expect A/H3N2 to be predictable in the sense that variants that grow keep growing. Yet, it has been difficult to find convincing signals of fit, antigenically novel, variants that consistently grow and replace their competitors [<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c12">12</xref>]. In contrast, SARS-CoV-2 evolution has been consistently predictable in the sense that dynamics are well modeled by exponentially growing variants that compete for a common pool of susceptible hosts. However, even in this case, taking into account the immune adaptation of hosts leads to a better description of variant dynamics [<xref ref-type="bibr" rid="c4">4</xref>].</p>
<p>We have shown that depending on (<italic>i</italic>) the heterogeneity of immunity in the population, (<italic>ii</italic>) the asymmetry between backward and forward cross-immune recognition, and (<italic>iii</italic>) waning or turn-over of immunity, the immune escape can either lead to dynamics dominated by selective sweeps, or to one were escape mutations have an initial growth advantage that dissipates before the variant fixes. The former scenario is observed when initial growth is fast, backward immunity high, and waning slow compared to variant dynamics. In this case, new variants can rise to high frequency driven by their own advantage and fix. Immunological heterogeneity slows down the initial rise, allowing for population immunity to respond and adjust before the variant has fixed.</p>
<p>This process of partial sweeps reconciles two seemingly contradicting observations: HA evolution in human influenza A virus is clearly driven by adaptive immune escape and most substitutions are clustered in epitope regions [<xref ref-type="bibr" rid="c34">34</xref>]. On the other hand, most substitutions do not sweep to fixation but tend to meander in a quasi-neutral fashion [<xref ref-type="bibr" rid="c12">12</xref>]. In the partial sweep scenario proposed here, diversity is dominated by immune escape mutations that are rapidly brought to macroscopic frequency by their initial growth advantage, but their ultimate fate is determined mostly by subsequent mutations.</p>
<p>In any real-world scenario, there will a variety of mutations, including some mutations that perform complete selective sweeps, either because they escape immunity of a large fraction of the population (M small), because they generate robust immunity against previous strains (“back-boost” [<xref ref-type="bibr" rid="c35">35</xref>]), or because the increase the intrinsic transmissibility of the virus (for example reverting a previous escape mutation that had a deleterious effect on transmissibility). The degree to which partial sweeps matter will vary from virus to virus and will change over time. Recently emerged viruses circulate in a homogeneous immune landscape and adapt to the new host for some time, consistent with rapid and complete sweeps of variants in SARS-CoV-2. Similarly, influenza virus A/H1N1pdm, which emerged in humans in 2009, exhibited more consistent trajectory dynamics than A/H3N2 [<xref ref-type="bibr" rid="c12">12</xref>].</p>
<p>More generally, qualitative features of the partial sweep dynamics investigated here are expected to exist in any system where the environment responds to evolutionary changes on time scales comparable to the time it takes for the adaptive variants to take over, leading to eco-evolutionary dynamics [<xref ref-type="bibr" rid="c36">36</xref>]. In ecological systems involving eukaryotes, it is the evolutionary part of this interaction that is thought of as slow, while ecology is fast. In the case of rapidly adapting RNA viruses in human populations with long-lived immunological memory, models often assume that viral adaptation is fast while hosts have long-lasting memory. The most complex and least predictable dynamics is expected when the evolutionary and ecological time scales are similar and different host pathogen systems will fall on different points along this axis.</p>
</sec>
</body>
<back>
<sec id="s4" sec-type="code-availability">
<title>Code availability</title>
<list list-type="bullet">
<list-item><p>Figures in the main text can be reproduced using a set of notebooks at <ext-link ext-link-type="uri" xlink:href="https://github.com/PierreBarrat/ExpiringFitnessFigures">https://github.com/PierreBarrat/ExpiringFitnessFigures</ext-link>.</p></list-item>
<list-item><p>Code for the simulations of the SI model is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/PierreBarrat/PartialSweepSIR.jl">https://github.com/PierreBarrat/PartialSweepSIR.jl</ext-link></p></list-item>
<list-item><p>Code for the population dynamics simulation is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/PierreBarrat/WrightFisher.jl">https://github.com/PierreBarrat/WrightFisher.jl</ext-link></p></list-item>
<list-item><p>Code to generate empirical frequency trajectories and their averages is available as scripts ‘flufixation.py’ and ‘sc2fixation.py’ in <ext-link ext-link-type="uri" xlink:href="https://github.com/nextstrain/flu_frequencies">https://github.com/nextstrain/flu_frequencies</ext-link> on branch ‘fixation’.</p></list-item>
</list>
</sec>
<sec id="s5" sec-type="data-availability">
<title>Data availability</title>
<p>Sequence data of influenza viruses was obtained from GISAID [<xref ref-type="bibr" rid="c37">37</xref>]. We thank the teams involved in sample collection, sequencing, and processing of these data for their contribution to global surveillance of influenza virus circulation. A table acknowledging all originating and submitting laboratories is provided as supplementary information.</p>
<p>Sequence data of SARS-CoV-2 viruses was obtained from NCBI and restricted to data from North America to ensure more homogeneous sampling. We are grateful to all teams involved in the collection and generation of these data for generously sharing these data openly.</p>
</sec>
<ref-list>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Cornelius</given-names> <surname>Roemer</surname></string-name>, <string-name><given-names>Daniel J.</given-names> <surname>Sheward</surname></string-name>, <string-name><given-names>Ryan</given-names> <surname>Hisner</surname></string-name>, <string-name><given-names>Federico</given-names> <surname>Gueli</surname></string-name>, <string-name><given-names>Hitoshi</given-names> <surname>Sakaguchi</surname></string-name>, <string-name><given-names>Nicholas</given-names> <surname>Frohberg</surname></string-name>, <string-name><given-names>Josette</given-names> <surname>Schoenmakers</surname></string-name>, <string-name><given-names>Kenta</given-names> <surname>Sato</surname></string-name>, <string-name><given-names>Aine</given-names> <surname>O’Toole</surname></string-name>, <string-name><given-names>Andrew</given-names> <surname>Rambaut</surname></string-name>, <string-name><given-names>Oliver G.</given-names> <surname>Pybus</surname></string-name>, <string-name><given-names>Christopher</given-names> <surname>Ruis</surname></string-name>, <string-name><given-names>Ben</given-names> <surname>Murrell</surname></string-name>, and <string-name><given-names>Thomas P.</given-names> <surname>Peacock</surname></string-name></person-group>. <article-title>SARS-CoV-2 evolution in the Omicron era</article-title>. <source>Nature Microbiology</source>, <month>October</month> <year>2023</year>. <comment>ISSN 2058-5276</comment>. doi:<pub-id pub-id-type="doi">10.1038/s41564-023-01504-w</pub-id>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Velislava N.</given-names> <surname>Petrova</surname></string-name> and <string-name><given-names>Colin A.</given-names> <surname>Russell</surname></string-name></person-group>. <article-title>The evolution of seasonal influenza viruses</article-title>. <source>Nature Reviews Microbiology,</source> <volume>16</volume>(<issue>1</issue>):<fpage>47</fpage>–<lpage>60</lpage>, <month>January</month> <year>2018</year>. <comment>ISSN 1740-1534</comment>. doi:<pub-id pub-id-type="doi">10.1038/nrmicro.2017.118</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nrmicro.2017.118">https://www.nature.com/articles/nrmicro.2017.118</ext-link>. Number: 1 Publisher: <publisher-name>Nature Publishing Group</publisher-name>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Dylan H.</given-names> <surname>Morris</surname></string-name>, <string-name><given-names>Katelyn M.</given-names> <surname>Gostic</surname></string-name>, <string-name><given-names>Simone</given-names> <surname>Pompei</surname></string-name>, <string-name><given-names>Trevor</given-names> <surname>Bedford</surname></string-name>, <string-name><given-names>Marta</given-names> <surname>Luksza</surname></string-name>, <string-name><given-names>Richard A.</given-names> <surname>Neher</surname></string-name>, <string-name><given-names>Bryan T.</given-names> <surname>Grenfell</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Lassig</surname></string-name>, and <string-name><given-names>John W.</given-names> <surname>McCauley</surname></string-name></person-group>. <article-title>Predictive Modeling of Influenza Shows the Promise of Applied Evolutionary Biology</article-title>. <source>Trends in Microbiology</source>, <volume>26</volume> (<issue>2</issue>):<fpage>102</fpage>–<lpage>118</lpage>, <month>February</month> <year>2018</year>. <comment>ISSN 0966-842X</comment>. doi:<pub-id pub-id-type="doi">10.1016/j.tim.2017.09.004</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0966842X17302093">https://www.sciencedirect.com/science/article/pii/S0966842X17302093</ext-link>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Matthijs</given-names> <surname>Meijers</surname></string-name>, <string-name><given-names>Denis</given-names> <surname>Ruchnewitz</surname></string-name>, <string-name><given-names>Jan</given-names> <surname>Eberhardt</surname></string-name>, <string-name><given-names>Marta</given-names> <surname>Luksza</surname></string-name>, and <string-name><given-names>Michael</given-names> <surname>Lassig</surname></string-name></person-group>. <article-title>Population immunity predicts evolutionary trajectories of SARS-CoV-2</article-title>. <source>Cell</source>, <volume>186</volume>(<issue>23</issue>):<fpage>5151</fpage>–<lpage>5164</lpage>.<elocation-id>e13</elocation-id>, <month>November</month> <year>2023</year>. <comment>ISSN 0092-8674</comment>, <fpage>1097</fpage>–<lpage>4172</lpage>. doi:<pub-id pub-id-type="doi">10.1016/j.cell.2023.09.022</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.cell.com/cell/abstract/S0092-8674(23)01076-0">https://www.cell.com/cell/abstract/S0092-8674(23)01076-0</ext-link>. Publisher: <publisher-name>Elsevier</publisher-name>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Lev S.</given-names> <surname>Tsimring</surname></string-name>, <string-name><given-names>Herbert</given-names> <surname>Levine</surname></string-name>, and <string-name><given-names>David A.</given-names> <surname>Kessler</surname></string-name></person-group>. <article-title>RNA Virus Evolution via a FitnessSpace Model</article-title>. <source>Physical Review Letters</source>, <volume>76</volume>(<issue>23</issue>):<fpage>4440</fpage>–<lpage>4443</lpage>, <month>June</month> <year>1996</year>. <comment>ISSN 0031-9007</comment>, <fpage>1079</fpage>–<lpage>7114</lpage>. doi:<pub-id pub-id-type="doi">10.1103/PhysRevLett.76.4440</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://link.aps.org/doi/10.1103/PhysRevLett.76.4440">https://link.aps.org/doi/10.1103/PhysRevLett.76.4440</ext-link>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Igor M.</given-names> <surname>Rouzine</surname></string-name>, <string-name><given-names>John</given-names> <surname>Wakeley</surname></string-name>, and <string-name><given-names>John M.</given-names> <surname>Coffin</surname></string-name></person-group>. <article-title>The solitary wave of asexual evolution</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>100</volume>(<issue>2</issue>):<fpage>587</fpage>–<lpage>592</lpage>, <month>January</month> <year>2003</year>. doi: <pub-id pub-id-type="doi">10.1073/pnas.242719299</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/doi/abs/10.1073/pnas.242719299">https://www.pnas.org/doi/abs/10.1073/pnas.242719299</ext-link>. Publisher: <publisher-name>Proceedings of the National Academy of Sciences</publisher-name>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Michael M</given-names> <surname>Desai</surname></string-name> and <string-name><given-names>Daniel S</given-names> <surname>Fisher</surname></string-name></person-group>. <article-title>Beneficial Mutation-Selection Balance and the Effect of Linkage on Positive Selection</article-title>. <source>Genetics</source>, <volume>176</volume>(<issue>3</issue>):<fpage>1759</fpage>–<lpage>1798</lpage>, <month>July</month> <year>2007</year>. <comment>ISSN 1943-2631</comment>. doi:<pub-id pub-id-type="doi">10.1534/genetics.106.067678</pub-id>. URL <pub-id pub-id-type="doi">10.1534/genetics.106.067678</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Richard A.</given-names> <surname>Neher</surname></string-name></person-group>. <article-title>Genetic Draft, Selective Interference, and Population Genetics of Rapid Adaptation</article-title>. <source>Annual Review of Ecology, Evolution, and Systematics,</source> <volume>44</volume>(<issue>1</issue>):<fpage>195</fpage>–<lpage>215</lpage>, <year>2013</year>. doi:<pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110512-135920</pub-id>. URL <pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110512-135920</pub-id>. _eprint: <pub-id pub-id-type="doi">10.1146/annurev-ecolsys-110512-135920</pub-id>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Marta</given-names> <surname>Luksza</surname></string-name> and <string-name><given-names>Michael</given-names> <surname>Lässig</surname></string-name></person-group>. <article-title>A predictive fitness model for influenza</article-title>. <source>Nature,</source> <volume>507</volume>(<issue>7490</issue>): <fpage>57</fpage>–<lpage>61</lpage>, <month>March</month> <year>2014</year>. <comment>ISSN 1476-4687</comment>. doi:<pub-id pub-id-type="doi">10.1038/nature13087</pub-id>.</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Richard A</given-names> <surname>Neher</surname></string-name>, <string-name><given-names>Colin A</given-names> <surname>Russell</surname></string-name>, and <string-name><given-names>Boris I</given-names> <surname>Shraiman</surname></string-name></person-group>. <article-title>Predicting evolution from the shape of genealogical trees</article-title>. <source>eLife</source>, <volume>3</volume>, <month>November</month> <year>2014</year>. <comment>ISSN 2050-084X</comment>. doi:<pub-id pub-id-type="doi">10.7554/eLife.03568</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4227306/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4227306/</ext-link>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>John</given-names> <surname>Huddleston</surname></string-name>, <string-name><given-names>John R</given-names> <surname>Barnes</surname></string-name>, <string-name><given-names>Thomas</given-names> <surname>Rowe</surname></string-name>, <string-name><given-names>Xiyan</given-names> <surname>Xu</surname></string-name>, <string-name><given-names>Rebecca</given-names> <surname>Kondor</surname></string-name>, <string-name><given-names>David E</given-names> <surname>Wentworth</surname></string-name>, <string-name><given-names>Lynne</given-names> <surname>Whittaker</surname></string-name>, <string-name><given-names>Burcu</given-names> <surname>Ermetal</surname></string-name>, <string-name><given-names>Rodney Stuart</given-names> <surname>Daniels</surname></string-name>, <string-name><given-names>John W</given-names> <surname>McCauley</surname></string-name>, <string-name><given-names>Seiichiro</given-names> <surname>Fujisaki</surname></string-name>, <string-name><given-names>Kazuya</given-names> <surname>Nakamura</surname></string-name>, <string-name><given-names>Noriko</given-names> <surname>Kishida</surname></string-name>, <string-name><given-names>Shinji</given-names> <surname>Watanabe</surname></string-name>, <string-name><given-names>Hideki</given-names> <surname>Hasegawa</surname></string-name>, <string-name><given-names>Ian</given-names> <surname>Barr</surname></string-name>, <string-name><given-names>Kanta</given-names> <surname>Subbarao</surname></string-name>, <string-name><given-names>Pierre</given-names> <surname>Barrat-Charlaix</surname></string-name>, <string-name><given-names>Richard A</given-names> <surname>Neher</surname></string-name>, and <string-name><given-names>Trevor</given-names> <surname>Bedford</surname></string-name></person-group>. <article-title>Integrating genotypes and phenotypes improves long-term forecasts of seasonal influenza A/H3N2 evolution</article-title>. <source>eLife</source>, <volume>9</volume>:<elocation-id>e60067</elocation-id>, <month>September</month> <year>2020</year>. <comment>ISSN 2050-084X</comment>. doi:<pub-id pub-id-type="doi">10.7554/eLife.60067</pub-id>. URL <pub-id pub-id-type="doi">10.7554/eLife.60067</pub-id>. Publisher: <publisher-name>eLife Sciences Publications, Ltd</publisher-name>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Pierre</given-names> <surname>Barrat-Charlaix</surname></string-name>, <string-name><given-names>John</given-names> <surname>Huddleston</surname></string-name>, <string-name><given-names>Trevor</given-names> <surname>Bedford</surname></string-name>, and <string-name><given-names>Richard A</given-names> <surname>Neher</surname></string-name></person-group>. <article-title>Limited Predictability of Amino Acid Substitutions in Seasonal Influenza Viruses</article-title>. <source>Molecular Biology and Evolution</source>, (<comment>msab065</comment>), <month>March</month> <year>2021</year>. <comment>ISSN 0737-4038</comment>. doi:<pub-id pub-id-type="doi">10.1093/molbev/msab065</pub-id>. URL <pub-id pub-id-type="doi">10.1093/molbev/msab065</pub-id>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Sunetra</given-names> <surname>Gupta</surname></string-name>, <string-name><given-names>Neil</given-names> <surname>Ferguson</surname></string-name>, and <string-name><given-names>Roy</given-names> <surname>Anderson</surname></string-name></person-group>. <article-title>Chaos, Persistence, and Evolution of Strain Structure in Antigenically Diverse Infectious Agents</article-title>. <source>Science</source>, <volume>280</volume>(<issue>5365</issue>):<fpage>912</fpage>–<lpage>915</lpage>, <month>May</month> <year>1998</year>. <comment>ISSN 0036-8075</comment>, <fpage>1095</fpage>–<lpage>9203</lpage>. doi:<pub-id pub-id-type="doi">10.1126/science.280.5365.912</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.science.org/doi/10.1126/science.280.5365.912">https://www.science.org/doi/10.1126/science.280.5365.912</ext-link>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Julia R.</given-names> <surname>Gog</surname></string-name> and <string-name><given-names>Bryan T.</given-names> <surname>Grenfell</surname></string-name></person-group>. <article-title>Dynamics and selection of many-strain pathogens</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>99</volume>(<issue>26</issue>):<fpage>17209</fpage>–<lpage>17214</lpage>, <month>December</month> <year>2002</year>. doi: <pub-id pub-id-type="doi">10.1073/pnas.252512799</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/doi/abs/10.1073/pnas.252512799">https://www.pnas.org/doi/abs/10.1073/pnas.252512799</ext-link>. Publisher: <publisher-name>Proceedings of the National Academy of Sciences</publisher-name>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Le</given-names> <surname>Yan</surname></string-name>, <string-name><given-names>Richard A</given-names> <surname>Neher</surname></string-name>, and <string-name><given-names>Boris I</given-names> <surname>Shraiman</surname></string-name></person-group>. <article-title>Phylodynamic theory of persistence, extinction and speciation of rapidly adapting pathogens</article-title>. <source>eLife</source>, <volume>8</volume>:<elocation-id>e44205</elocation-id>, <month>September</month> <year>2019</year>. <comment>ISSN 2050084X</comment>. doi:<pub-id pub-id-type="doi">10.7554/eLife.44205</pub-id>. URL <pub-id pub-id-type="doi">10.7554/eLife.44205</pub-id>. Publisher: <publisher-name>eLife Sciences Publications, Ltd</publisher-name>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Jacopo</given-names> <surname>Marchi</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Lassig</surname></string-name>, <string-name><given-names>Aleksandra M.</given-names> <surname>Walczak</surname></string-name>, and <string-name><given-names>Thierry</given-names> <surname>Mora</surname></string-name></person-group>. <article-title>Antigenic waves of virus-immune coevolution</article-title>. <source>Proceedings of the National Academy of Sciences,</source> <volume>118</volume> (<issue>27</issue>):<elocation-id>e2103398118</elocation-id>, <month>July</month> <year>2021</year>. doi:<pub-id pub-id-type="doi">10.1073/pnas.2103398118</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/doi/full/10.1073/pnas.2103398118">https://www.pnas.org/doi/full/10.1073/pnas.2103398118</ext-link>. Publisher: <publisher-name>Proceedings of the National Academy of Sciences</publisher-name>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Victor</given-names> <surname>Chardes</surname></string-name>, <string-name><given-names>Andrea</given-names> <surname>Mazzolini</surname></string-name>, <string-name><given-names>Thierry</given-names> <surname>Mora</surname></string-name>, and <string-name><given-names>Aleksandra M.</given-names> <surname>Walczak</surname></string-name></person-group>. <article-title>Evolutionary stability of antigenically escaping viruses</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>120</volume>(<issue>44</issue>):<elocation-id>e2307712120</elocation-id>, <month>October</month> <year>2023</year>. doi:<pub-id pub-id-type="doi">10.1073/pnas.2307712120</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/doi/10.1073/pnas.2307712120">https://www.pnas.org/doi/10.1073/pnas.2307712120</ext-link>. Publisher: <publisher-name>Proceedings of the National Academy of Sciences</publisher-name>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Igor M.</given-names> <surname>Rouzine</surname></string-name> and <string-name><given-names>Ganna</given-names> <surname>Rozhnova</surname></string-name></person-group>. <article-title>Antigenic evolution of viruses in host populations</article-title>. <source>PLOS Pathogens</source>, <volume>14</volume>(<issue>9</issue>):<elocation-id>e1007291</elocation-id>, <month>September</month> <year>2018</year>. <comment>ISSN 1553-7374</comment>. doi: <pub-id pub-id-type="doi">10.1371/journal.ppat.1007291</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://journals.plos.org/plospathogens/article?id=10.1371/journal.ppat.1007291">https://journals.plos.org/plospathogens/article?id=10.1371/journal.ppat.1007291</ext-link>. Publisher: <publisher-name>Public Library of Science</publisher-name>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Juhye M</given-names> <surname>Lee</surname></string-name>, <string-name><given-names>Rachel</given-names> <surname>Eguia</surname></string-name>, <string-name><given-names>Seth J</given-names> <surname>Zost</surname></string-name>, <string-name><given-names>Saket</given-names> <surname>Choudhary</surname></string-name>, <string-name><given-names>Patrick C</given-names> <surname>Wilson</surname></string-name>, <string-name><given-names>Trevor</given-names> <surname>Bedford</surname></string-name>, <string-name><given-names>Terry</given-names> <surname>Stevens-Ayers</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Boeckh</surname></string-name>, <string-name><given-names>Aeron C</given-names> <surname>Hurt</surname></string-name>, <string-name><given-names>Seema S</given-names> <surname>Lakdawala</surname></string-name>, <string-name><given-names>Scott E</given-names> <surname>Hensley</surname></string-name>, and <string-name><given-names>Jesse D</given-names> <surname>Bloom</surname></string-name></person-group>. <article-title>Mapping person-to-person variation in viral mutations that escape polyclonal serum targeting influenza hemagglutinin</article-title>. <source>eLife</source>, <volume>8</volume>:<elocation-id>e49324</elocation-id>, <month>August</month> <year>2019</year>. <comment>ISSN 2050-084X</comment>. doi:<pub-id pub-id-type="doi">10.7554/eLife.49324</pub-id>. URL <pub-id pub-id-type="doi">10.7554/eLife.49324</pub-id>. Publisher: <publisher-name>eLife Sciences Publications, Ltd</publisher-name>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Frances C.</given-names> <surname>Welsh</surname></string-name>, <string-name><given-names>Rachel T.</given-names> <surname>Eguia</surname></string-name>, <string-name><given-names>Juhye M.</given-names> <surname>Lee</surname></string-name>, <string-name><given-names>Hugh K.</given-names> <surname>Haddox</surname></string-name>, <string-name><given-names>Jared</given-names> <surname>Galloway</surname></string-name>, <string-name><given-names>Nguyen</given-names> <surname>Van Vinh</surname></string-name>, <string-name><given-names>Andrea N.</given-names> <surname>Loes</surname></string-name>, <string-name><given-names>John</given-names> <surname>Huddleston</surname></string-name>, <string-name><given-names>Timothy C.</given-names> <surname>Yu</surname></string-name>, <string-name><given-names>Mai Quynh</given-names> <surname>Le</surname></string-name>, <string-name><given-names>Nguyen TD</given-names> <surname>Nhat</surname></string-name>, <string-name><given-names>Nguyen Thi Le</given-names> <surname>Thanh</surname></string-name>, <string-name><given-names>Alexander L.</given-names> <surname>Greninger</surname></string-name>, <string-name><given-names>Helen Y.</given-names> <surname>Chu</surname></string-name>, <string-name><given-names>Janet A.</given-names> <surname>Englund</surname></string-name>, <string-name><given-names>Trevor</given-names> <surname>Bedford</surname></string-name>, <string-name><given-names>Frederick A.</given-names> <surname>Matsen</surname></string-name>, <string-name><given-names>Maciej F.</given-names> <surname>Boni</surname></string-name>, and <string-name><given-names>Jesse D.</given-names> <surname>Bloom</surname></string-name></person-group>. <source>Agedependent heterogeneity in the antigenic effects of mutations to influenza hemagglutinin, December 2023</source>. URL <ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2023.12.12.571235v1">https://www.biorxiv.org/content/10.1101/2023.12.12.571235v1</ext-link>. <comment>Pages: 2023.12.12.571235 Section: New Results</comment>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Mikhail</given-names> <surname>Tikhonov</surname></string-name> and <string-name><given-names>Remi</given-names> <surname>Monasson</surname></string-name></person-group>. <article-title>Innovation Rather than Improvement: A Solvable High-Dimensional Model Highlights the Limitations of Scalar Fitness</article-title>. <source>Journal of Statistical Physics</source>, <volume>172</volume>(<issue>1</issue>):<fpage>74</fpage>–<lpage>104</lpage>, <month>July</month> <year>2018</year>. <comment>ISSN 1572-9613</comment>. doi:<pub-id pub-id-type="doi">10.1007/s10955-018-1956-6</pub-id>. URL <pub-id pub-id-type="doi">10.1007/s10955-018-1956-6</pub-id>.</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Adam J.</given-names> <surname>Kucharski</surname></string-name>, <string-name><given-names>Justin</given-names> <surname>Lessler</surname></string-name>, <string-name><given-names>Derek A. T.</given-names> <surname>Cummings</surname></string-name>, and <string-name><given-names>Steven</given-names> <surname>Riley</surname></string-name></person-group>. <article-title>Timescales of influenza A/H3N2 antibody dynamics</article-title>. <source>PLoS biology</source>, <volume>16</volume>(<issue>8</issue>):<elocation-id>e2004974</elocation-id>, <month>August</month> <year>2018</year>. <comment>ISSN 1545-7885</comment>. doi:<pub-id pub-id-type="doi">10.1371/journal.pbio.2004974</pub-id>.</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>John H</given-names> <surname>Gillespie</surname></string-name></person-group>. <article-title>Genetic Drift in an Infinite Population: The Pseudohitchhiking Model</article-title>. <source>Genetics,</source> <volume>155</volume>(<issue>2</issue>):<fpage>909</fpage>–<lpage>919</lpage>, <month>June</month> <year>2000</year>. <comment>ISSN 1943-2631</comment>. doi:<pub-id pub-id-type="doi">10.1093/genetics/155.2.909</pub-id>. URL <pub-id pub-id-type="doi">10.1093/genetics/155.2.909</pub-id>.</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Oskar</given-names> <surname>Hallatschek</surname></string-name></person-group>. <article-title>Selection-Like Biases Emerge in Population Models with Recurrent Jackpot Events</article-title>. <source>Genetics,</source> <volume>210</volume>(<issue>3</issue>):<fpage>1053</fpage>–<lpage>1073</lpage>, <month>November</month> <year>2018</year>. <comment>ISSN 1943-2631</comment>. doi: <pub-id pub-id-type="doi">10.1534/genetics.118.301516</pub-id>. URL <pub-id pub-id-type="doi">10.1534/genetics.118.301516</pub-id>.</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Motoo</given-names> <surname>Kimura</surname></string-name></person-group>. <article-title>Diffusion models in population genetics</article-title>. <source>Journal of Applied Probability</source>, <volume>1</volume>(<issue>2</issue>): <fpage>177</fpage>–<lpage>232</lpage>, <month>December</month> <year>1964</year>. <comment>ISSN 0021-9002</comment>, <fpage>1475</fpage>–<lpage>6072</lpage>. doi:<pub-id pub-id-type="doi">10.2307/3211856</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.cambridge.org/core/product/identifier/S0021900200108368/type/journal_article">https://www.cambridge.org/core/product/identifier/S0021900200108368/type/journal_article</ext-link>.</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Natalja</given-names> <surname>Strelkowa</surname></string-name> and <string-name><given-names>Michael</given-names> <surname>Lassig</surname></string-name></person-group>. <article-title>Clonal Interference in the Evolution of Influenza</article-title>. <source>Genetics</source>, <volume>192</volume>(<issue>2</issue>):<fpage>671</fpage>–<lpage>682</lpage>, <month>October</month> <year>2012</year>. <comment>ISSN 1943-2631</comment>. doi:<pub-id pub-id-type="doi">10.1534/genetics.112.143396</pub-id>. URL <pub-id pub-id-type="doi">10.1534/genetics.112.143396</pub-id>.</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Jason</given-names> <surname>Schweinsberg</surname></string-name></person-group>. <article-title>Coalescents with Simultaneous Multiple Collisions</article-title>. <source>Electronic Journal of Probability</source>, <volume>5</volume>(<issue>none</issue>):<fpage>1</fpage>–<lpage>50</lpage>, <month>January</month> <year>2000</year>. <comment>ISSN 1083-6489</comment>, <fpage>1083</fpage>–<lpage>6489</lpage>. doi:<pub-id pub-id-type="doi">10.1214/EJP.v5-68</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://projecteuclid.org/journals/electronic-journal-of-probability/volume-5/issue-none/Coalescents-with-Simultaneous-Multiple-Collisions/10.1214/EJP.v5-68.full">https://projecteuclid.org/journals/electronic-journal-of-probability/volume-5/issue-none/Coalescents-with-Simultaneous-Multiple-Collisions/10.1214/EJP.v5-68.full</ext-link>. Publisher: <publisher-name>Institute of Mathematical Statistics and Bernoulli Society</publisher-name>.</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Nathanael</given-names> <surname>Berestycki</surname></string-name></person-group>. <article-title>Recent progress in coalescent theory</article-title>. <source>Ensaios Matemáticos,</source> <volume>16</volume>(<issue>1</issue>), <year>2009</year>. <comment>ISSN 21750432</comment>. doi:<pub-id pub-id-type="doi">10.21711/217504322009/em161</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://ensaios.sbm.org.br/wp-content/uploads/sites/14/2019/04/EM_16.pdf">http://ensaios.sbm.org.br/wp-content/uploads/sites/14/2019/04/EM_16.pdf</ext-link>.</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Robin M.</given-names> <surname>Bush</surname></string-name>, <string-name><given-names>Catherine A.</given-names> <surname>Bender</surname></string-name>, <string-name><given-names>Kanta</given-names> <surname>Subbarao</surname></string-name>, <string-name><given-names>Nancy J.</given-names> <surname>Cox</surname></string-name>, and <string-name><given-names>Walter M.</given-names> <surname>Fitch</surname></string-name></person-group>. <article-title>Predicting the Evolution of Human Influenza A</article-title>. <source>Science</source>, <volume>286</volume>(<issue>5446</issue>):<fpage>1921</fpage>–<lpage>1925</lpage>, <month>December</month> <year>1999</year>. doi:<pub-id pub-id-type="doi">10.1126/science.286.5446.1921</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.science.org/doi/10.1126/science.286.5446.1921">https://www.science.org/doi/10.1126/science.286.5446.1921</ext-link>. Publisher: <publisher-name>American Association for the Advancement of Science</publisher-name>.</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Derek J.</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>Alan S.</given-names> <surname>Lapedes</surname></string-name>, <string-name><given-names>Jan C.</given-names> <surname>De Jong</surname></string-name>, <string-name><given-names>Theo M.</given-names> <surname>Bestebroer</surname></string-name>, <string-name><given-names>Guus F.</given-names> <surname>Rimmelzwaan</surname></string-name>, <string-name><given-names>Albert D. M. E.</given-names> <surname>Osterhaus</surname></string-name>, and <string-name><given-names>Ron A. M.</given-names> <surname>Fouchier</surname></string-name></person-group>. <article-title>Mapping the Antigenic and Genetic Evolution of Influenza Virus</article-title>. <source>Science</source>, <volume>305</volume>(<issue>5682</issue>):<fpage>371</fpage>–<lpage>376</lpage>, <month>July</month> <year>2004</year>. <comment>ISSN 0036-8075</comment>, <fpage>1095</fpage>–<lpage>9203</lpage>. doi:<pub-id pub-id-type="doi">10.1126/science.1097211</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.science.org/doi/10.1126/science.1097211">https://www.science.org/doi/10.1126/science.1097211</ext-link>.</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Samir</given-names> <surname>Bhatt</surname></string-name>, <string-name><given-names>Edward C.</given-names> <surname>Holmes</surname></string-name>, and <string-name><given-names>Oliver G.</given-names> <surname>Pybus</surname></string-name></person-group>. <article-title>The Genomic Rate of Molecular Adaptation of the Human Influenza A Virus</article-title>. <source>Molecular Biology and Evolution,</source> <volume>28</volume>(<issue>9</issue>):<fpage>2443</fpage>–<lpage>2451</lpage>, <month>September</month> <year>2011</year>. <comment>ISSN 0737-4038</comment>. doi:<pub-id pub-id-type="doi">10.1093/molbev/msr044</pub-id>. URL <pub-id pub-id-type="doi">10.1093/molbev/msr044</pub-id>.</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Richard A.</given-names> <surname>Neher</surname></string-name>, <string-name><given-names>Trevor</given-names> <surname>Bedford</surname></string-name>, <string-name><given-names>Rodney S.</given-names> <surname>Daniels</surname></string-name>, <string-name><given-names>Colin A.</given-names> <surname>Russell</surname></string-name>, and <string-name><given-names>Boris I.</given-names> <surname>Shraiman</surname></string-name></person-group>. <article-title>Prediction, dynamics, and visualization of antigenic phenotypes of seasonal influenza viruses</article-title>. <source>Proceedings of the National Academy of Sciences,</source> <volume>113</volume>(<issue>12</issue>):<elocation-id>E1701–E1709</elocation-id>, <month>March</month> <year>2016</year>. doi:<pub-id pub-id-type="doi">10.1073/pnas.1525578113</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.pnas.org/doi/full/10.1073/pnas.1525578113">https://www.pnas.org/doi/full/10.1073/pnas.1525578113</ext-link>. Publisher: <publisher-name>Proceedings of the National Academy of Sciences</publisher-name>.</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Kathryn E.</given-names> <surname>Kistler</surname></string-name> and <string-name><given-names>Trevor</given-names> <surname>Bedford</surname></string-name></person-group>. <article-title>An atlas of continuous adaptive evolution in endemic human viruses</article-title>. <source>Cell Host &amp; Microbe</source>, <month>October</month> <year>2023</year>. <comment>ISSN 1931-3128</comment>. doi: <pub-id pub-id-type="doi">10.1016/j.chom.2023.09.012</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S1931312823003803">https://www.sciencedirect.com/science/article/pii/S1931312823003803</ext-link>.</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.</given-names> <surname>Bhatt</surname></string-name>, <string-name><given-names>T. T.</given-names> <surname>Lam</surname></string-name>, <string-name><given-names>S. J.</given-names> <surname>Lycett</surname></string-name>, <string-name><given-names>A. J. Leigh</given-names> <surname>Brown</surname></string-name>, <string-name><given-names>T. A.</given-names> <surname>Bowden</surname></string-name>, <string-name><given-names>E. C.</given-names> <surname>Holmes</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Guan</surname></string-name>, <string-name><given-names>J. L. N.</given-names> <surname>Wood</surname></string-name>, <string-name><given-names>I. H.</given-names> <surname>Brown</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Kellam</surname></string-name>, <collab>Combating Swine Influenza Consortium</collab>, and <string-name><given-names>O. G.</given-names> <surname>Pybus</surname></string-name></person-group>. <article-title>The evolutionary dynamics of influenza A virus adaptation to mammalian hosts</article-title>. <source>Philosophical Transactions of the Royal Society of London. Series B, Biological Sciences</source>, <volume>368</volume> (<issue>1614</issue>):<fpage>20120382</fpage>, <month>March</month> <year>2013</year>. <comment>ISSN 1471-2970</comment>. doi:<pub-id pub-id-type="doi">10.1098/rstb.2012.0382</pub-id>.</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>J. M.</given-names> <surname>Fonville</surname></string-name>, <string-name><given-names>S. H.</given-names> <surname>Wilks</surname></string-name>, <string-name><given-names>S. L.</given-names> <surname>James</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Fox</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Ventresca</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Aban</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Xue</surname></string-name>, <string-name><given-names>T. C.</given-names> <surname>Jones</surname></string-name>, <string-name><surname>Le</surname> <given-names>N. M. H.</given-names></string-name>, <string-name><surname>Pham</surname> <given-names>Q. T.</given-names></string-name>, <string-name><surname>Tran</surname> <given-names>N. D.</given-names></string-name>, <string-name><given-names>Y.</given-names> <surname>Wong</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Mosterin</surname></string-name>, <string-name><given-names>L. C.</given-names> <surname>Katzelnick</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Labonte</surname></string-name>, <string-name><surname>Le</surname> <given-names>T. T.</given-names></string-name>, <string-name><given-names>G. van der</given-names> <surname>Net</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Skepner</surname></string-name>, <string-name><given-names>C. A.</given-names> <surname>Russell</surname></string-name>, <string-name><given-names>T. D.</given-names> <surname>Kaplan</surname></string-name>, <string-name><given-names>G. F.</given-names> <surname>Rimmelzwaan</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Masurel</surname></string-name>, <string-name><given-names>J. C.</given-names> <surname>de Jong</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Palache</surname></string-name>, <string-name><given-names>W. E. P.</given-names> <surname>Beyer</surname></string-name>, <string-name><surname>Le</surname> <given-names>Q. M.</given-names></string-name>, <string-name><surname>Nguyen</surname> <given-names>T. H.</given-names></string-name>, <string-name><given-names>H. F. L.</given-names> <surname>Wertheim</surname></string-name>, <string-name><given-names>A. C.</given-names> <surname>Hurt</surname></string-name>, <string-name><given-names>A. D. M. E.</given-names> <surname>Osterhaus</surname></string-name>, <string-name><given-names>I. G.</given-names> <surname>Barr</surname></string-name>, <string-name><given-names>R. A. M.</given-names> <surname>Fouchier</surname></string-name>, <string-name><given-names>P. W.</given-names> <surname>Horby</surname></string-name>, and <string-name><given-names>D. J.</given-names> <surname>Smith</surname></string-name></person-group>. <article-title>Antibody landscapes after influenza virus infection or vaccination</article-title>. <source>Science</source>, <volume>346</volume>(<issue>6212</issue>):<fpage>996</fpage>–<lpage>1000</lpage>, <month>November</month> <year>2014</year>. doi:<pub-id pub-id-type="doi">10.1126/science.1256427</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.science.org/doi/10.1126/science.1256427">https://www.science.org/doi/10.1126/science.1256427</ext-link>. Publisher: <publisher-name>American Association for the Advancement of Science</publisher-name>.</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>F.</given-names> <surname>Pelletier</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Garant</surname></string-name>, and <string-name><given-names>A.p.</given-names> <surname>Hendry</surname></string-name></person-group>. <article-title>Eco-evolutionary dynamics</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>, <volume>364</volume>(<issue>1523</issue>):<fpage>1483</fpage>–<lpage>1489</lpage>, <month>June</month> <year>2009</year>. doi: <pub-id pub-id-type="doi">10.1098/rstb.2009.0027</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://royalsocietypublishing.org/doi/full/10.1098/rstb.2009.0027">https://royalsocietypublishing.org/doi/full/10.1098/rstb.2009.0027</ext-link>. Publisher: <publisher-name>Royal Society</publisher-name>.</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>Yuelong</given-names> <surname>Shu</surname></string-name> and <string-name><given-names>John</given-names> <surname>McCauley</surname></string-name></person-group>. <article-title>GISAID: Global initiative on sharing all influenza data - from vision to reality</article-title>. <source>Eurosurveillance</source>, <volume>22</volume>(<issue>13</issue>):<fpage>30494</fpage>, <month>March</month> <year>2017</year>. <comment>ISSN 1560-7917</comment>. doi:<pub-id pub-id-type="doi">10.2807/1560-7917.ES.2017.22.13.30494</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.eurosurveillance.org/content/10.2807/1560-7917.ES.2017.22.13.30494?crawler=true">https://www.eurosurveillance.org/content/10.2807/1560-7917.ES.2017.22.13.30494?crawler=true</ext-link>. Publisher: <publisher-name>European Centre for Disease Prevention and Control</publisher-name>.</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>E.</given-names> <surname>Bolthausen</surname></string-name> and <string-name><given-names>A.-S.</given-names> <surname>Sznitman</surname></string-name></person-group>. <article-title>On Ruelle’s Probability Cascades and an Abstract Cavity Method</article-title>. <source>Communications in Mathematical Physics</source>, <volume>197</volume>(<issue>2</issue>):<fpage>247</fpage>–<lpage>276</lpage>, <month>October</month> <year>1998</year>. <comment>ISSN 1432-0916</comment>. doi:<pub-id pub-id-type="doi">10.1007/s002200050450</pub-id>. URL <pub-id pub-id-type="doi">10.1007/s002200050450</pub-id>.</mixed-citation></ref>
<ref id="c39"><label>[39]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>É.</given-names> <surname>Brunet</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Derrida</surname></string-name>, <string-name><given-names>A. H.</given-names> <surname>Mueller</surname></string-name>, and <string-name><given-names>S.</given-names> <surname>Munier</surname></string-name></person-group>. <article-title>Effect of selection on ancestry: An exactly soluble case and its phenomenological generalization</article-title>. <source>Physical Review E</source>, <volume>76</volume>(<issue>4</issue>):<fpage>041104</fpage>, <month>October</month> <year>2007</year>. doi:<pub-id pub-id-type="doi">10.1103/PhysRevE.76.041104</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://link.aps.org/doi/10.1103/PhysRevE.76.041104">https://link.aps.org/doi/10.1103/PhysRevE.76.041104</ext-link>. Publisher: <publisher-name>American Physical Society</publisher-name>.</mixed-citation></ref>
<ref id="c40"><label>[40]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>R. A.</given-names> <surname>Neher</surname></string-name> and <string-name><given-names>O.</given-names> <surname>Hallatschek</surname></string-name></person-group>. <article-title>Genealogies of rapidly adapting populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>110</volume>(<issue>2</issue>):<fpage>437</fpage>–<lpage>442</lpage>, <month>January</month> <year>2013</year>. <comment>ISSN 0027-8424</comment>, <fpage>1091</fpage>–<lpage>6490</lpage>. doi:<pub-id pub-id-type="doi">10.1073/pnas.1213113110</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/cgi/doi/10.1073/pnas.1213113110">http://www.pnas.org/cgi/doi/10.1073/pnas.1213113110</ext-link>.</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<title>Appendix</title>
<sec id="s6">
<title>A. SIR model</title>
<sec id="s6a">
<title>1. Equilibrium of the SIR model with one immune group</title>
<p>To help us compute the equilibrium reached by the SIR model, we introduce additional notation: the vectors <inline-formula id="ID30">
<alternatives>
<mml:math display="inline" id="I30"><mml:mrow><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mn>…</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq30.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> and <inline-formula id="ID31">
<alternatives>
<mml:math display="inline" id="I31"><mml:mrow><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mn>1</mml:mn><mml:mn>1</mml:mn></mml:msup><mml:mo>,</mml:mo><mml:mn>…</mml:mn><mml:mo>,</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>N</mml:mi></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq31.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> will respectively represent the compartments of hosts susceptible and infectious to each strain; the matrix <bold>K</bold> describes the cross-immunity; the vector <inline-formula id="ID32">
<alternatives>
<mml:math display="inline" id="I32"><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq32.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> is a vector of dimension <italic>N</italic> whose elements are all equal to 1.</p>
<p>We derive the equilibrium state for <xref ref-type="disp-formula" rid="FD1">Equations 1</xref>&amp;<xref ref-type="disp-formula" rid="FD2">2</xref>. For each strain <italic>a</italic>, equilibrium for <italic>I</italic><sup>a</sup> is reached when <italic>S<sup>a</sup></italic> = <italic>δ/α.</italic> We thus have <inline-formula id="ID33">
<alternatives>
<mml:math display="inline" id="I33"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:mi>α</mml:mi><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq33.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. Introducing this in the equation for the derivative of <italic>S<sup>a</sup></italic>, we obtain the following equilibrium:
<disp-formula id="FD12">
<alternatives>
<mml:math id="M12" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mover><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>α</mml:mi></mml:mfrac><mml:mover><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>q</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>α</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn12.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A1)</label>
</disp-formula>
</p>
<p>An interesting remark is that at equilibrium, <italic>I</italic> is of order <italic>γ/δ</italic> ≪ 1. Note that the structure of <bold>K</bold> makes it invertible in most cases. Indeed, we impose <italic>K<sup>aa</sup></italic> = 1 and 0 ≤ <italic>K<sup>ab</sup> &lt;</italic> 1 for <italic>a</italic> ≠ <italic>b</italic>.</p>
</sec>
<sec id="s6b">
<title>2. Equilibrium for two viruses with one immune group</title>
<p>We consider the case where two viruses are present, called wild-type (<italic>wt</italic>) and mutant (<italic>m</italic>). The cross-immunity is represented by a 2 × 2 matrix
<disp-formula id="FD13">
<alternatives>
<mml:math id="M13" display="block"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>f</mml:mi></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn13.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A2)</label>
</disp-formula>
</p>
<p>As shown in the previous section, the equilibrium is given by
<disp-formula id="FD14">
<alternatives>
<mml:math id="M14" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>α</mml:mi></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mover><mml:mi>I</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>α</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>K</mml:mi><mml:mover><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn14.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A3)</label>
</disp-formula>
</p>
<p>where <inline-formula id="ID34">
<alternatives>
<mml:math display="inline" id="I34"><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq34.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> stands for [<italic>I<sup>wt</sup>, I<sup>m</sup></italic>] and <inline-formula id="ID35">
<alternatives>
<mml:math display="inline" id="I35"><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq35.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> for [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c1">1</xref>]. It is straightforward to invert the crossimmunity matrix, and we obtain
<disp-formula id="FD15">
<alternatives>
<mml:math id="M15" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>I</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn15.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A4)</label>
</disp-formula>
</p>
<p>Note that without cross-immunity, the number of infected by either virus would be <inline-formula id="ID36">
<alternatives>
<mml:math display="inline" id="I36"><mml:mrow><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>α</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>δ</mml:mi></mml:mfrac></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq36.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. Positive values of <italic>b</italic> and <italic>f</italic> thus have the effect of lowering the equilibrium values of <italic>I<sup>m</sup></italic> and <italic>I<sup>wt</sup></italic> with respect to the absence of cross-immunity.</p>
<p>It is interesting to compute the fraction of infections due to the mutant at equilibrium. This is easily derived from the relations above:
<disp-formula id="FD16">
<alternatives>
<mml:math id="M16" display="block"><mml:mfrac><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn16.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A5)</label>
</disp-formula>
</p>
<p>A few observations can be made:
<list list-type="bullet">
<list-item><p>if <italic>b</italic> = 1 and <italic>f</italic> &lt; 1, then the wild-type vanishes at equilibrium and the mutant reaches frequency 1. In this case, the presence of the mutant alone is enough to keep <italic>S<sup>wt</sup></italic> to its threshold value <inline-formula id="ID37">
<alternatives>
<mml:math display="inline" id="I37"><mml:mrow><mml:msubsup><mml:mi>R</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq37.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, making it impossible for the wild-type to grow.</p></list-item>
<list-item><p>inversely, if <italic>f</italic> = 1, then the mutant stays at frequency 0.</p></list-item>
<list-item><p>if <italic>b, f</italic> &lt; 1, the mutant will reach a finite frequency <italic>x</italic>, with <italic>x</italic> &gt; 0.5 if <italic>b</italic> &gt; <italic>f</italic> and <italic>x</italic> &lt; 0.5 if <italic>b</italic> &lt; <italic>f</italic>.</p></list-item>
</list>
</p>
</sec>
<sec id="s6c">
<title>3. Equilibrium without the mutant</title>
<p>We first derive the equilibrium situation before the mutant virus is introduced in the case with only one immune group. We remind that in this case there is only one cross-immunity matrix which has the form
<disp-formula id="FD17">
<alternatives>
<mml:math id="M17" display="block"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mi>b</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>f</mml:mi></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn17.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>where <italic>b</italic> is the immunity to the wild-type caused by an infection with the mutant, and <italic>f</italic> the reverse.</p>
<p>Since the mutant is absent from the host population, we assume <italic>I<sup>m</sup></italic> = 0. The equilibrium values for <italic>S<sup>wt</sup></italic> and <italic>I<sup>wt</sup></italic> are easily obtained from the dynamical equations:
<disp-formula id="FD18">
<alternatives>
<mml:math id="M18" display="block"><mml:mrow><mml:mtable columnalign="left"><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:mi>α</mml:mi></mml:mrow><mml:mo>=</mml:mo><mml:msubsup><mml:mi>R</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup></mml:mrow></mml:mtd></mml:mtr><mml:mtr columnalign="left"><mml:mtd columnalign="left"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math>
<graphic xlink:href="2402.07252v1_eqn18.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A6)</label>
</disp-formula>
</p>
<p>We then set the derivative of <italic>S<sup>m</sup></italic> to 0:
<disp-formula id="FD19">
<alternatives>
<mml:math id="M19" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>f</mml:mi><mml:msup><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>→</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>α</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn19.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A7)</label>
</disp-formula>
</p>
<p>Since we assume <italic>f</italic> &lt; 1, the initial number of susceptibles to the mutant will be larger than <italic>δ/α</italic>, allowing initial growth of the mutant. Using the dynamical equation for <italic>I<sup>m</sup></italic>, the initial growth rate of the mutant can be written as
<disp-formula id="FD20">
<alternatives>
<mml:math id="M20" display="block"><mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msup><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>S</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>=</mml:mo><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn20.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A8)</label>
</disp-formula>
</p>
<p>If <italic>f</italic> = 0, the growth rate is <italic>α – δ, i.e.</italic> the one expected in a fully naive population.</p>
<p>If <italic>f</italic> = 1 however, the growth rate is 0 as the wild-type confers perfect immunity to the mutant.</p>
<p>The equations above generalize to more immune groups. Cross-immunity matrices <bold>K</bold><sub><italic>i</italic></sub> now depend on parameters <italic>f<sub>i</sub></italic> and <italic>b<sub>i</sub></italic>, and the initial number of susceptibles in immune group <italic>i</italic> is given by
<disp-formula id="FD21">
<alternatives>
<mml:math id="M21" display="block"><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn21.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A9)</label>
</disp-formula>
</p>
<p>In a given immune group i, the mutant growth rate is proportional to <inline-formula id="ID38">
<alternatives>
<mml:math display="inline" id="I38"><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq38.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. The growth rate of the mutant will thus be initially faster in immune groups for which it is antigenically different, <italic>i.e.</italic> <italic>f<sub>i</sub></italic> &lt; 1, than in groups where it is similar to the wild-type, <italic>i.e.</italic> <italic>f<sub>i</sub></italic> ≃ 1.</p>
<p>In the case of a well-mixed population, that is <italic>C<sub>ij</sub></italic> = 1/M, we can write the growth of the infections by the mutant <inline-formula id="ID39">
<alternatives>
<mml:math display="inline" id="I39"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq39.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> as an exponential growth with a time dependent rate. In this case, the overall growth rate is given by the derivative of <inline-formula id="ID40">
<alternatives>
<mml:math display="inline" id="I40"><mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>I</mml:mi><mml:mi>i</mml:mi><mml:mi>m</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq40.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>:
<disp-formula id="FD22">
<alternatives>
<mml:math id="M22" display="block"><mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>α</mml:mi><mml:mi>M</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>M</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>S</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:math>
<graphic xlink:href="2402.07252v1_eqn22.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A10)</label>
</disp-formula>
</p>
<p>In particular, using the invasion scenario from the main text with <italic>ε</italic> = 0 (i.e. <italic>f<sub>i</sub></italic> = 1) in <italic>M</italic> − 1 groups and an arbitrary value <italic>f</italic> in group 1, we obtain the following growth rate at <italic>t</italic>=0:
<disp-formula id="FD23">
<alternatives>
<mml:math id="M23" display="block"><mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mi>M</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mo>+</mml:mo><mml:mi>f</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>I</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn23.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A11)</label>
</disp-formula>
</p>
<p>That is, the initial growth rate for <italic>M</italic> groups is <italic>M</italic> times smaller than the one in the single group case.</p>
<p>In the case of a non well-mixed population, <italic>i.e</italic>. arbitrary <italic>C<sub>ij</sub></italic>, it is not possible to write a pseudo-exponential growth rate as in <xref ref-type="disp-formula" rid="FD22">Eq A10</xref>. However, it is clear that the initial growth rate will also be smaller as in the single group case since the mutant initially only grows in group <italic>i</italic> = 1.</p>
</sec>
<sec id="s6d">
<title>4. Realistic modeling of host’s immune state</title>
<p>The SIR model proposed in the main text relies on the assumption of immunity acquisition through exposure. This explains terms like <inline-formula id="ID41">
<alternatives>
<mml:math display="inline" id="I41"><mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>b</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq41.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> in the derivative of <italic>S<sup>a</sup></italic>: acquiring immunity to <italic>a</italic> through cross-immunity <italic>K<sup>ab</sup></italic>requires a combination of prior susceptibility and exposure to strain <italic>b</italic>. Importantly, this does not depend on the immune state of the hosts with respect to strain <italic>b</italic>.</p>
<p>A more realistic representation would be one where acquiring immunity to strain <italic>a</italic> from exposure to <italic>b</italic> requires being <italic>infected</italic> by <italic>b</italic>. However, this would require keeping track more precisely of the immune state of hosts, as we would need to separate hosts into two groups, namely
<list list-type="bullet">
<list-item><p>hosts who are susceptible to both <italic>a</italic> and <italic>b</italic>, and can thus acquire immunity to <italic>a</italic> through infection by <italic>b</italic>;</p></list-item>
<list-item><p>hosts who are susceptible to <italic>a</italic> but immune to <italic>b</italic>, and can no longer acquire immunty to <italic>a</italic> through infection by <italic>b</italic>.</p></list-item>
</list>
</p>
<p>To test whether our results are robust to such changes of hypothesis, we write a simple SIR model with two strains <italic>a</italic> and <italic>b</italic> where cross-immunity is only activated through infection rather than exposure. To properly track the immune states of the hosts, we introduce the groups <italic>R<sup>a</sup></italic> and <italic>R<sup>b</sup></italic> respectively representing hosts immune to only <italic>a</italic> or only <italic>b</italic>, and <italic>R<sup>ab</sup></italic> representing hosts immune to both <italic>a</italic> and <italic>b</italic>. The compartment <italic>R</italic><sup>0</sup> = 1 − <italic>R<sup>a</sup></italic> − <italic>R<sup>b</sup></italic> − <italic>R<sup>ab</sup></italic> groups hosts susceptible to both strains. It is simpler in this case to write the dynamics in terms of compartments <italic>I</italic> and <italic>R</italic>, rather than I and S as in the main text. For simplicity, we do not use immune groups here. The dynamics involve two equations for the infected:
<disp-formula id="FD24">
<alternatives>
<mml:math id="M24" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn24.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A12)</label>
</disp-formula>
</p>
<p>and three for the immune:
<disp-formula id="FD25">
<alternatives>
<mml:math id="M25" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi>b</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>R</mml:mi><mml:mn>0</mml:mn></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>α</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>R</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:msup><mml:mi>R</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn25.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A13)</label>
</disp-formula>
</p>
<p>In <xref ref-type="fig" rid="fig5">Figure S1</xref>, we show both that the dynamical and equilibrium properties of this model are qualitatively the same as the one from the main text. On the left panel, we show that the dynamics of this new model does not differ qualitatively from the model of the main text. In particular, in the invasion scenario, the frequency of the variant converges to some equilibrium value after some oscillations. On the right, we show that this equilibrium value <italic>β</italic> is different but relatively close to the one from the main text.</p>
</sec>
<sec id="s6e">
<title>5. Change in frequency when adding subsequent strains</title>
<p>This section shows that under certain condition, adding a new variant to the SIR model does not change the relative frequencies of previous variants. This is an important condition for the random walk of the main text to be valid.</p>
<p>Here is a quick summary of the results proved below. Adding a variant to the SI model involves adding a column <inline-formula id="ID42">
<alternatives>
<mml:math display="inline" id="I42"><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq42.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> and a row <inline-formula id="ID43">
<alternatives>
<mml:math display="inline" id="I43"><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq43.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> to the cross-immunity matrix, which can be given by two vectors. If these vectors only depend on one parameter, <italic>i.e</italic>. <inline-formula id="ID44">
<alternatives>
<mml:math display="inline" id="I44"><mml:mrow><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq44.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> and <inline-formula id="ID45">
<alternatives>
<mml:math display="inline" id="I45"><mml:mrow><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>⋅</mml:mo><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq45.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, then the relative frequency of previous strains is unchanged in the new equilibrium. What this means in practice is that the new strain must be at equal “antigenic distance” from all previous strains. A possible interpretation is an antigenic space of infinite dimensions: all mutations explore an antigenic region which is new.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure S 1.</label>
<caption><p><bold>Left</bold> Dynamics of the frequency of the variant for the SIR model from <xref ref-type="disp-formula" rid="FD24">Equations A12</xref>&amp;<xref ref-type="disp-formula" rid="FD25">A13</xref> using the invasion scenario from the main text. Two 2 × 2 cross-immunity matrices are used, with off-diagonal parameters <italic>f</italic> and <italic>b</italic> chosen to give the same equilibrium. The gray line represents the equilibrium that would be obtained using the model of the main text. <bold>Right</bold>: Equilibrium frequency <italic>β</italic> for this new SIR model (y-axis) versus the <italic>β</italic> from the main text (<italic>x</italic>-axis). Each point corresponds to a given pair (<italic>f, b</italic>).</p></caption>
<graphic xlink:href="2402.07252v1_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We start from an initial situation where there are N variants with an <italic>N × N</italic> cross-immunity matrix <bold>K</bold>. At equilibrium, the number of hosts infected by each virus <italic>a</italic> ∈ {1… <italic>N</italic>} is given by the elements of the vector I that can be computed from the cross-immunity matrix and parameters of the model:
<disp-formula id="FD26">
<alternatives>
<mml:math id="M26" display="block"><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover><mml:mrow><mml:msub><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn26.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A14)</label>
</disp-formula>
</p>
<p>where <inline-formula id="ID46">
<alternatives>
<mml:math display="inline" id="I46"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq46.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> is a vector containing only 1’s and of length <italic>N</italic>. The relative frequency of variant <italic>a</italic> with respect to variant <italic>b</italic> is simply defined as
<disp-formula id="FD27">
<alternatives>
<mml:math id="M27" display="block"><mml:msub><mml:mi>f</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn27.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A15)</label>
</disp-formula>
</p>
<p>We assume that the initial population has reached equilibrium.</p>
<p>We now add a new virus to this population, with index <italic>N</italic> + 1. The new cross-immunity matrix <inline-formula id="ID47">
<alternatives>
<mml:math display="inline" id="I47"><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq47.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> is now written as
<disp-formula id="FD28">
<alternatives>
<mml:math id="M28" display="block"><mml:mover accent="true"><mml:mtext>K</mml:mtext><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mtext>K</mml:mtext></mml:mtd><mml:mtd><mml:mrow><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo stretchy="true">→</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn28.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A16)</label>
</disp-formula>
</p>
<p>where <inline-formula id="ID48">
<alternatives>
<mml:math display="inline" id="I48"><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq48.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> and <inline-formula id="ID49">
<alternatives>
<mml:math display="inline" id="I49"><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq49.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> are two vectors of length <italic>N</italic>. This is a general way to write that the backward cross-immunity to variant <italic>a</italic> caused by an infection with the new variant <italic>N</italic> + 1 is <italic>b<sub>a</sub></italic>. Inversely, the forward cross-immunity to variant <italic>N</italic> + 1 caused by an infection with an old variant <italic>a</italic> is <italic>f<sub>a</sub></italic>.</p>
<p>This new cross-immunity matrix will of course result in a new equilibrium for the number of infected hosts, given by the vector <inline-formula id="ID50">
<alternatives>
<mml:math display="inline" id="I50"><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq50.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>:
<disp-formula id="FD29">
<alternatives>
<mml:math id="M29" display="block"><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo stretchy="true">˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>δ</mml:mi><mml:mo>/</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>γ</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:msup><mml:mover accent="true"><mml:mtext>K</mml:mtext><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn29.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>The question we ask here is whether the relative frequency of two variants 1 ≤ <italic>a,b ≤ N</italic> is changed by the addition of the new variant. In other words, we want to know whether the equality below holds:
<disp-formula id="FD30">
<alternatives>
<mml:math id="M30" display="block"><mml:mfrac><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mover><mml:mo>=</mml:mo><mml:mo>?</mml:mo></mml:mover><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>b</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn30.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>Below, we prove this equality under a condition for cross-immunity of the new variant <inline-formula id="ID51">
<alternatives>
<mml:math display="inline" id="I51"><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq51.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> and <inline-formula id="ID52">
<alternatives>
<mml:math display="inline" id="I52"><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq52.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>:
<disp-formula id="FD31">
<alternatives>
<mml:math id="M31" display="block"><mml:mover><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mover><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mi>N</mml:mi></mml:msub><mml:mtext> and </mml:mtext><mml:mover><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>f</mml:mi><mml:mo>⋅</mml:mo><mml:msub><mml:mover><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mi>N</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn31.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A17)</label>
</disp-formula>
</p>
<p>where 0 <italic>&lt; b, f &lt;</italic> 1 are scalars. This amounts to say that cross-immunity is the same between the new variant <italic>N</italic> + 1 and any old variant <italic>a, i.e.</italic> that the new variant is at equal antigenic distance from all previous variants.</p>
<p>To prove the equality, we perform the computation <inline-formula id="ID53">
<alternatives>
<mml:math display="inline" id="I53"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq53.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. To do that, we make use of the following formula for inverting a block matrix:
<disp-formula id="FD32">
<alternatives>
<mml:math id="M32" display="block"><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>A</mml:mi></mml:mtd><mml:mtd><mml:mi>B</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>C</mml:mi></mml:mtd><mml:mtd><mml:mi>D</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi><mml:mi>Λ</mml:mi><mml:mi>C</mml:mi><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>B</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>Λ</mml:mi><mml:mi>C</mml:mi><mml:msup><mml:mi>A</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mi>Λ</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn32.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>where we defined <italic>Λ</italic> = (D – CA<sup>−1</sup>B)<sup>−1</sup>. The following identities map to our problem:
<disp-formula id="FD33">
<alternatives>
<mml:math id="M33" display="block"><mml:mi>A</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>B</mml:mi><mml:mo>=</mml:mo><mml:mover><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>C</mml:mi><mml:mo>=</mml:mo><mml:mover><mml:mrow><mml:msup><mml:mi>F</mml:mi><mml:mi>τ</mml:mi></mml:msup></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>1.</mml:mn></mml:math>
<graphic xlink:href="2402.07252v1_eqn33.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>We immediatly see that <inline-formula id="ID54">
<alternatives>
<mml:math display="inline" id="I54"><mml:mrow><mml:mi>Λ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mtext>T</mml:mtext></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq54.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> reduces to a scalar that we note γ for more clarity. We also define the other scalar value <inline-formula id="ID55">
<alternatives>
<mml:math display="inline" id="I55"><mml:mrow><mml:mi>μ</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mi>N</mml:mi><mml:mtext>T</mml:mtext></mml:msubsup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mi>N</mml:mi></mml:msub></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq55.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. A few manipulations give us the following for <inline-formula id="ID56">
<alternatives>
<mml:math display="inline" id="I56"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq56.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>:
<disp-formula id="FD34">
<alternatives>
<mml:math id="M34" display="block"><mml:msup><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>⋅</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mi>λ</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn34.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>Multiplying this by <inline-formula id="ID57">
<alternatives>
<mml:math display="inline" id="I57"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq57.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> results in
<disp-formula id="FD35">
<alternatives>
<mml:math id="M35" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mover><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mrow><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:munder><mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>⋅</mml:mo><mml:msup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mover><mml:mrow><mml:msub><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:msub></mml:mrow><mml:mo>→</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mi>s</mml:mi><mml:mi>i</mml:mi><mml:mi>z</mml:mi><mml:mi>e</mml:mi><mml:mtext> </mml:mtext><mml:mi>N</mml:mi></mml:mrow></mml:munder><mml:mo>;</mml:mo><mml:munder><mml:munder><mml:mrow><mml:mo>−</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mover accent="true"><mml:mi>f</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mrow><mml:mover><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover></mml:mrow><mml:mi>N</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo stretchy="true">︸</mml:mo></mml:munder><mml:mrow><mml:mi>s</mml:mi><mml:mi>c</mml:mi><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>a</mml:mi><mml:mi>r</mml:mi></mml:mrow></mml:munder></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>I</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi><mml:mi>μ</mml:mi><mml:mi>λ</mml:mi><mml:mi>I</mml:mi><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>λ</mml:mi><mml:mi>I</mml:mi><mml:mo>;</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>λ</mml:mi><mml:mo>+</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi><mml:mi>λ</mml:mi><mml:mi>μ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>I</mml:mi><mml:mo>;</mml:mo><mml:mi>λ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn35.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>where we used the equalities <inline-formula id="ID58">
<alternatives>
<mml:math display="inline" id="I58"><mml:mrow><mml:msup><mml:mtext>K</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover accent="true"><mml:mi>b</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:msup><mml:mtext>K</mml:mtext><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mover accent="true"><mml:mn>1</mml:mn><mml:mo>→</mml:mo></mml:mover><mml:mi>N</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>b</mml:mi><mml:mi>I</mml:mi></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq58.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>.</p>
<p>This result essentially shows that after adding the new variant, the fraction of hosts infected by the previous variants if simply multiplied by a scalar value 1 – bγ(1 — fμ). This implies that the relative frequencies of the original variants are conserved when adding a new one.</p>
</sec>
<sec id="s6f">
<title>6. Case with intrinsic fitness effects</title>
<p>In the SI model of the main text, we assume that the transmission rate <italic>a</italic> is the same for the different strains. It is also interesting to investigate the case where this transmission rate varies. Here, we study a simple extension of the SI model without immune groups where there are two variants - mutant and wild-type - with respective transmission rates <italic>α<sup>wt</sup> = αϕ<sup>wt</sup></italic> and <italic>α<sup>m</sup> = αϕ<sup>m</sup></italic>. The quantities <italic>ϕ<sup>wt</sup></italic>, <italic>ϕ<sup>m</sup></italic> ∈ [<italic>δ/α,∞</italic>[can be interpreted as intrinsic fitness values for the two strains. Note that if <italic>ϕ<sup>a</sup></italic> &lt; <italic>δ/α</italic>, the strain <italic>a</italic> cannot grow even in a fully susceptible population. The cross-immunity is as usual defined by matrix <bold>K</bold> with off-diagonal terms <italic>f</italic> and <italic>b</italic>.</p>
<p>The equations of motion are now
<disp-formula id="FD36">
<alternatives>
<mml:math id="M36" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mover accent="true"><mml:mi>S</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>b</mml:mi><mml:mo>∈</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>+</mml:mo><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mover accent="true"><mml:mi>I</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:msup><mml:mi>I</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn36.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A18)</label>
</disp-formula>
</p>
<p>Computing the equilibrium, we immediately obtain
<disp-formula id="FD37">
<alternatives>
<mml:math id="M37" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>δ</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>a</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>I</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mo>⋅</mml:mo><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mover><mml:mi>h</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn37.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A19)</label>
</disp-formula>
</p>
<p>where we have defined the following quantities:
<disp-formula id="FD38">
<alternatives>
<mml:math id="M38" display="block"><mml:msup><mml:mi>h</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>a</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>G</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mn>1</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mi>b</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:mi>f</mml:mi><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow></mml:mtd><mml:mtd><mml:mn>1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>s</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn38.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A20)</label>
</disp-formula>
</p>
<p>The quantities <italic>h<sup>a</sup></italic> can be interpreted as a scaled growth rate of each variant given a fully susceptible population, and the matrix <bold>G</bold> combines the cross-immunity and the ratio of fitness values <italic>ϕ</italic>. Note that it is straightforward to generalize these equations to an arbitrary number of strains: the relevant quantity will be the scaled cross-immunity matrix defined by <inline-formula id="ID59">
<alternatives>
<mml:math display="inline" id="I59"><mml:mrow><mml:msup><mml:mi>G</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>a</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mstyle><mml:msup><mml:mi>K</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq59.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>.</p>
<p>Inverting <bold>G</bold> and simplifying the equations a bit, we obtain
<disp-formula id="FD39">
<alternatives>
<mml:math id="M39" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msup><mml:mi>I</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msup><mml:mi>I</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>m</mml:mi></mml:msup></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:msup><mml:mi>ξ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn39.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A21)</label>
</disp-formula>
</p>
<p>where we defined
<disp-formula id="FD40">
<alternatives>
<mml:math id="M40" display="block"><mml:mi>ξ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>m</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mrow><mml:mi>w</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn40.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A22)</label>
</disp-formula>
</p>
<p>Note the interesting structure of <xref ref-type="disp-formula" rid="FD39">equations A21</xref>: for each variant, they involve a first term <inline-formula id="ID60">
<alternatives>
<mml:math display="inline" id="I60"><mml:mrow><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>ϕ</mml:mi><mml:mi>a</mml:mi></mml:msup></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq60.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> that depends only of the intrinsic growth rate of the mutant, and a second <inline-formula id="ID61">
<alternatives>
<mml:math display="inline" id="I61"><mml:mrow><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>ξ</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq61.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> that involves cross-immunity and relative growth rate through <italic>ξ</italic>.</p>
<p>These equilibrium equations give us two conditions for the co-existence of the two variants,
<disp-formula id="FD41">
<alternatives>
<mml:math id="M41" display="block"><mml:mi>b</mml:mi><mml:mo>&lt;</mml:mo><mml:msup><mml:mi>ξ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mtext> and </mml:mtext><mml:mi>f</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>ξ</mml:mi><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn41.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(A23)</label>
</disp-formula>
</p>
<p>respectively corresponding to <italic>I<sup>wt</sup></italic> &gt; 0 and <italic>I<sup>m</sup></italic> &gt; 0. We mention three interesting cases below.</p>
<list list-type="bullet">
<list-item><p>If the mutant has an intrinsic fitness disadvantage <italic>ξ</italic> &lt; 1, it will only be able to invade if <italic>f</italic> &lt; <italic>ξ</italic>. Since f represents the probability that a host becomes immune to the mutant if infected by the wild-type, this means that the immune “niche” of the mutant must be large enough when compared to <italic>ξ</italic>.</p></list-item>
<list-item><p>Invertly, if the mutant is fitter and <italic>ξ</italic> &gt; 1, the mutant is always able to invade. The wild-type only survives if <italic>b</italic> &lt; <italic>ξ</italic><sup>−1</sup>, meaning that the immunity to the wild-type caused by the mutant must be small enough.</p></list-item>
<list-item><p>If one considers a situation without total cross-immunity, *i.e.* <italic>b</italic> = <italic>f</italic> = 1, the only way a mutant invades is if <italic>ξ</italic> &gt; 1 meaning <italic>ϕ<sup>m</sup></italic> &gt; <italic>ϕ<sup>wt</sup></italic>, and the result is a full selective sweep.</p></list-item>
</list>
</sec>
<sec id="s6g">
<title>7. Oscillations of the SI model</title>
<p>The SI model from the main text tends to oscillate while returning to equilibrium. Here, we study this behavior in the simple case of one immune group (<italic>M</italic> = 1) and two viruses (wild-type and variant).</p>
<p>The idea is to linearize the dynamical equations around the equilibrium. This gives us
<disp-formula id="FD42">
<alternatives>
<mml:math id="M42" display="block"><mml:mover accent="true"><mml:mi>X</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>Q</mml:mi><mml:mi>X</mml:mi><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn42.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>where <italic>X</italic> = [<italic>S<sup>wt</sup>, S<sup>m</sup>, I<sup>wt</sup>, I<sup>m</sup></italic>] and
<disp-formula id="FD43">
<alternatives>
<mml:math id="M43" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>Q</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>γ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mi>γ</mml:mi></mml:mrow><mml:mo>/</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mtd><mml:mtd><mml:mrow><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mrow><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd><mml:mtd><mml:mn>0</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>g</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mfrac></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>g</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mi>γ</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:mo>⋅</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn43.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>To quantify the convergence to equilibrium is the frequency of the oscillations, we need the eigenvalues of matrix <italic>Q</italic>. For low enough <italic>γ</italic>, we can prove that the four eigenvalues are
<disp-formula id="FD44">
<alternatives>
<mml:math id="M44" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>λ</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mi>α</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mi>γ</mml:mi><mml:mo>±</mml:mo><mml:mi>i</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>λ</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mfrac><mml:mi>α</mml:mi><mml:mi>δ</mml:mi></mml:mfrac><mml:mi>γ</mml:mi><mml:mo>±</mml:mo><mml:mi>i</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>γ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>4</mml:mn></mml:mfrac><mml:mfrac><mml:mrow><mml:msup><mml:mi>α</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>γ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn44.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>This is only valid if the terms in the square roots above are positive, which requires <italic>γ</italic> to be small enough. In our setting, we assume <italic>γ</italic> ≪ <italic>α, γ,</italic> so this will always hold.</p>
<p>From the eigenvalues we can compute:
<list list-type="bullet">
<list-item><p>the rate of convergence to equilibrium: <italic>αγ/2δ</italic>. This means that convergence is slower for a smaller waning rate <italic>γ</italic>.</p></list-item>
<list-item><p>the two oscillation frequencies that appear:
<disp-formula id="FD45">
<alternatives>
<mml:math id="M45" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mrow><mml:mi>γ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>α</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>l</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>w</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow></mml:msub><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>f</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>b</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msqrt><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn45.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p></list-item>
</list>
</p>
<p>Note that since (1 – <italic>b</italic>)(1 – <italic>f</italic>)/(1 – <italic>bf</italic>) ≤ 1, we always have <italic>ω<sub>low</sub> ≤ ω<sub>high</sub>.</italic> With the values of the main text <italic>α</italic> = 3,δ = 1,<italic>γ</italic> = 5 · 10<sup>−3</sup> (units are inverse of generations), we obtain <italic>ω<sub>high</sub></italic> ≃ 0.016. If one generation is one week, this gives us a period <inline-formula id="ID62">
<alternatives>
<mml:math display="inline" id="I62"><mml:mrow><mml:msubsup><mml:mi>ω</mml:mi><mml:mrow><mml:mi>h</mml:mi><mml:mi>i</mml:mi><mml:mi>g</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>≃</mml:mo><mml:mn>60</mml:mn><mml:mi>w</mml:mi></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq62.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, that is approximately one year.</p>
</sec>
</sec>
<sec id="s7">
<title>B. Other</title>
<sec id="s7a">
<title>1. Differential equation with expiring fitness effects</title>
<p>This section gives a few results about the expiring fitness equations from the main text. We rewrite the equations here for reference:
<disp-formula id="FD46">
<alternatives>
<mml:math id="M46" display="block"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>s</mml:mi><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>v</mml:mi><mml:mi>x</mml:mi><mml:mi>s</mml:mi><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn46.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>First, we prove the expression for the amplitude of the partial sweeps. We divide the equation for <inline-formula id="ID63">
<alternatives>
<mml:math display="inline" id="I63"><mml:mover accent="true"><mml:mi>x</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq63.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> by the one for <inline-formula id="ID64">
<alternatives>
<mml:math display="inline" id="I64"><mml:mover accent="true"><mml:mi>s</mml:mi><mml:mo>˙</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq64.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> to obtain
<disp-formula id="FD47">
<alternatives>
<mml:math id="M47" display="block"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mi>v</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn47.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>This immediately gives us
<disp-formula id="FD48">
<alternatives>
<mml:math id="M48" display="block"><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>s</mml:mi><mml:mo>/</mml:mo><mml:mi>v</mml:mi></mml:mrow></mml:msup></mml:math>
<graphic xlink:href="2402.07252v1_eqn48.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>with <italic>γ</italic> constant. At <italic>t</italic> = 0, we have <italic>s</italic> = <italic>s</italic><sub>0</sub> and <italic>x</italic> = <italic>x<sub>0</sub></italic> ≪ 1, while for <italic>t</italic> → ∞ we have <italic>s</italic> = 0 and <italic>x</italic> = <italic>β</italic> to be determined. From the <italic>t</italic> = 0 case we obtain <italic>γ = (x<sub>0</sub> – 1)e–<sup>−s<sub>0</sub>/v</sup></italic>, and from <italic>t</italic> ∓ ∞ we get <italic>β</italic> = 1 + γ. Assuming <italic>x</italic><sub>0</sub> ≪ 1, we obtain the result of the main text:
<disp-formula id="FD49">
<alternatives>
<mml:math id="M49" display="block"><mml:mi>β</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>/</mml:mo><mml:mi>v</mml:mi><mml:mo>.</mml:mo></mml:mrow></mml:msup></mml:math>
<graphic xlink:href="2402.07252v1_eqn49.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>We now try to find an expression for the probability that two partial sweeps overlap. First, we try to estimate the time it takes for one partial sweep to complete. While we could not solve the differential equations of the main text analytically, we can give an approximate expression for the time dependent frequency <italic>x</italic> during the partial sweep:
<disp-formula id="FD50">
<alternatives>
<mml:math id="M50" display="block"><mml:mi>x</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>t</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>≃</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mi>β</mml:mi></mml:mrow><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mfrac><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn50.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>where <italic>β</italic> is a function of <italic>s</italic> and <italic>v</italic> and <italic>x<sub>0</sub></italic> = <italic>x(t</italic> = 0). This is simply the expression of a logistic growth starting at <italic>x<sub>0</sub></italic> and saturating at <italic>β</italic>. From there, we compute the time <italic>T<sub>r</sub></italic>(s) it takes a partial sweep of initial fitness s to reach a frequency <italic>rβ</italic> with <italic>x<sub>0</sub>β</italic><sup>−1</sup> &lt; <italic>r</italic> &lt; 1. We quickly find
<disp-formula id="FD51">
<alternatives>
<mml:math id="M51" display="block"><mml:msub><mml:mi>T</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msup><mml:mi>s</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>β</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mfrac><mml:mi>r</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn51.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>We now consider that two consecutive partial sweeps of initial fitnesses <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> overlap if the first one is not yet at frequency rft1 while the second one is already at (1 − <italic>r</italic>)<italic>β</italic><sub>2</sub>. For instance, taking <italic>r</italic> = 3/4, this an overlap occurs if the first sweep is not yet at 3/4 of its final value while the second one is already at 1/4 of its final value. Thus, for an overlap to occur, we need the time <italic>τ</italic> between the two partial sweeps to be smaller than <italic>T<sub>r</sub></italic> (<italic>s</italic><sub>1</sub>) – <italic>T</italic><sub>1-<italic>r</italic></sub> (<italic>s</italic><sub>2</sub>). For sweeps happening at rate <italic>ρ</italic>, this has probability 1 – exp (–<italic>ρ(T<sub>r</sub></italic>(<italic>s</italic><sub>1</sub>) – <italic>T</italic><sub>1-<italic>r</italic></sub>(<italic>s</italic><sub>2</sub>))). Since the two sweeps have random initial fitness effects, we find that the overall probability for two consecutive sweeps to overlap is
<disp-formula id="FD52">
<alternatives>
<mml:math id="M52" display="block"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mtext>overlap</mml:mtext><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>{</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mi>r</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>r</mml:mi></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msup><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn52.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>This integrates over all possible pairs of sweep amplitudes (or initial fitnesses) and weighs them by the probability that the time between the two leads to an overlap. It is this quantity (computed numerically) that is used for the scale of the colorbar in panel <bold>E</bold> of <xref ref-type="fig" rid="fig4">Figure 4</xref> of the main text.</p>
</sec>
<sec id="s7b">
<title>2. Distribution of partial sweep size β</title>
<p>This section discusses the distribution of the size of partial sweeps <italic>β</italic> in the context of <xref ref-type="disp-formula" rid="FD10">Equation 10</xref> of the main text as well as the choice of parameters for panel <bold>E</bold> of <xref ref-type="fig" rid="fig4">Figure 4</xref>.</p>
<p>A first interesting case is when fitness effects are exponentially distributed, with parameter <italic>s</italic><sub>0</sub>:
<disp-formula id="FD53">
<alternatives>
<mml:math id="M53" display="block"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>s</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn53.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>This is the distribution we use in most of the population simulations. We compute the corresponding distribution of <italic>β</italic> in a straightforward way:
<disp-formula id="FD54">
<alternatives>
<mml:math id="M54" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>    </mml:mtext><mml:mo>=</mml:mo><mml:msubsup><mml:mi>s</mml:mi><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mi>α</mml:mi><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>s</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mi>d</mml:mi><mml:mi>s</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>    </mml:mtext><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn54.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>Taking the derivative with respect to <italic>x</italic>, we obtain
<disp-formula id="FD55">
<alternatives>
<mml:math id="M55" display="block"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mrow><mml:mo stretchy="false">(</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow><mml:mrow><mml:mi>α</mml:mi><mml:mo>/</mml:mo><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn55.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>This distribution can accomodate various shape: for <italic>α</italic>/<italic>s</italic><sub>0</sub> <italic>&gt;</italic> 1 it peaks at 0, and for <italic>α/s</italic><sub>0</sub> &lt; 1 it peaks at 1. We can also compute the following formular for the moments of <italic>β</italic>:
<disp-formula id="FD56">
<alternatives>
<mml:math id="M56" display="block"><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mtext> </mml:mtext><mml:mi>a</mml:mi><mml:mi>n</mml:mi><mml:mi>d</mml:mi><mml:mtext> </mml:mtext><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>s</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn56.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>When investigating the coalescence time in the main text, we use a different distribution for fitness effects. In this case, we want a finer control over the second moment of <italic>β</italic>, and we decide to sample <italic>β</italic> directly using a Beta distribution. The Beta distribution has a support over [0, 1] and can accomodate many different shapes. It is defined by two parameters <italic>a</italic> and <italic>b</italic>:
<disp-formula id="FD57">
<alternatives>
<mml:math id="M57" display="block"><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mi>b</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn57.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>In our case, it is more practical to parametrize it by its mean m and variance <italic>v</italic>. For given <italic>m</italic> and <italic>v</italic> &lt; <italic>m</italic>(1 − <italic>m</italic>) we have
<disp-formula id="FD58">
<alternatives>
<mml:math id="M58" display="block"><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>v</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>m</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mi>b</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>v</mml:mi></mml:mfrac><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>m</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2402.07252v1_eqn58.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>In the case of panel <bold>E</bold> of <xref ref-type="fig" rid="fig4">Figure 4</xref> and in order to explore a wide range of distributions, we used three values of <italic>m</italic>: {0.3, 0.6, 0.9}, and for each <italic>m</italic>
<list list-type="bullet">
<list-item><p>a low variance <italic>v</italic> = <italic>ε · m<sup>2</sup></italic> with <italic>ε</italic> = 10<sup>−5</sup></p></list-item>
<list-item><p>a high variance <italic>v</italic> = <italic>m</italic>(1 − <italic>m</italic>)/3</p></list-item>
</list>
</p>
<p>For a given set of parameters defining a Beta distribution, we decide on the fitness effects by first sampling a <italic>β</italic> for each new adaptive mutation, and then computing <italic>s</italic> by using <xref ref-type="disp-formula" rid="FD11">Equation 11</xref> from the main text. For each distribution <italic>P<sub>β</sub></italic>, the simulation is performed for 6 values of <italic>ρ</italic> ∈ [0.003,0.01, 0.018, 0.032, 0.056, 0.1].</p>
</sec>
<sec id="s7c">
<title>3. Random walk: monotonous trajectories</title>
<p>Here we compute the probability that in the random walk defined in the main text, a trajectory starting at <italic>x</italic><sub>0</sub> converges straight to 0 without ever taking a step up. While going to 0 requires an infinite amount of downward steps, the probability is still finite since the steps are increasingly likely to go down. For simplicity, we compute this for a fixed <italic>β</italic>.</p>
<p>If the random walk always goes down, its position at time step <italic>t</italic> will be <italic>x<sub>t</sub></italic> = (1 – <italic>β</italic>)<sup><italic>t</italic></sup><italic>x</italic><sub>0</sub>. Since the probability of going down is 1 − <italic>x<sub>t</sub></italic>, the probability of always going down is
<disp-formula id="FD59">
<alternatives>
<mml:math id="M59" display="block"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:mi>o</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>t</mml:mi></mml:msup><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn59.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(B1)</label>
</disp-formula>
</p>
<p>We simplify this expression by taking the logarithm and assuming that (1 – <italic>β</italic>)<sup>t</sup> ≪ 1 for <italic>t</italic> ≥ 1:
<disp-formula id="FD60">
<alternatives>
<mml:math id="M60" display="block"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mi>o</mml:mi><mml:mi>w</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:msub><mml:mo>≃</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn60.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>Since the random walk is invariant by the change <italic>x</italic> → 1 – <italic>x</italic>, we can easily compute the probability of a trajectory always going up, and thus of a monotonous trajectory going straight to either boundary 0 or 1.</p>
<p>The quality of the approximation is quite good, as can be seen from <xref ref-type="fig" rid="fig6">Figure S2</xref>. The same figure also shows that this probability is relatively high, even for <italic>x</italic><sub>0</sub> far from either boundary.</p>
</sec>
<sec id="s7d">
<title>4. Coalescent</title>
<p>Consider a partial sweep happening between generations <italic>t</italic> and <italic>t</italic> + 1, with probability <italic>ρ</italic>. One individual <italic>A</italic> in generation <italic>t</italic> will then have <italic>βN</italic> children in generation <italic>t</italic> + 1. Any individual in generation <italic>t</italic> + 1 has a probability <italic>β</italic> of having <italic>A</italic> as a direct ancestor, and a probability 1 — <italic>β</italic> of the opposite. If we consider <italic>n</italic> lineages at generation <italic>t</italic> + 1 and look backward in time, the probability that at least <italic>k</italic> out of <italic>n</italic> have <italic>A</italic> as an ancestor is <italic>β<sup>k</sup></italic>. Averaging over <italic>P<sub>β</sub></italic>, we find the probability of <italic>k</italic> specificlineages to have a common ancestor in the previous generation:
<disp-formula id="FD61">
<alternatives>
<mml:math id="M61" display="block"><mml:msub><mml:mi>q</mml:mi><mml:mi>k</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn61.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure S 2.</label>
<caption><p>Probability of a strictly monotonous trajectory in the random walk of the main text, as a function of <italic>β</italic> (fixed) and the initial value <italic>x</italic><sub>0</sub>. The “exact” solution is obtained by numerically computing the product in <xref ref-type="disp-formula" rid="FD59">Equation B1</xref> up to <italic>t</italic> = 100.</p></caption>
<graphic xlink:href="2402.07252v1_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Another useful quantity is the probability <italic>λ<sub>n</sub>(k)</italic> that given <italic>n</italic> lineages, a particular set of exactly <italic>k</italic> lineages merge one generation back. If a partial sweep of known amplitude <italic>β</italic> took place, this requires the set of <italic>k</italic> lineages to merge at this generation, with probability <italic>β<sup>k</sup></italic>, and that the other <italic>n − k</italic> do not merge, with probability (1 − <italic>β)<sup>n-k</sup></italic>.</p>
<disp-formula id="FD62">
<alternatives>
<mml:math id="M62" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>λ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>k</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>  </mml:mtext><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mi>k</mml:mi></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mi>P</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>β</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mi>d</mml:mi><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mn>1</mml:mn></mml:msubsup><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mfrac><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>β</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mi>d</mml:mi><mml:mi>β</mml:mi><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2402.07252v1_eqn62.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(B2)</label>
</disp-formula>
<p>This turns out to be the definition of the Λ-coalescent with Λ(<italic>β</italic>) <italic>α β</italic><sup>2</sup><italic>P(β)</italic> [<xref ref-type="bibr" rid="c27">27</xref>, <xref ref-type="bibr" rid="c28">28</xref>].</p>
<p>The Λ-coalescent is a general model for genealogies of multiple mergers. We mention two interesting subcases:
<list list-type="bullet">
<list-item><p>if <italic>P(β)</italic> = <italic>δ(β)</italic> where <italic>δ</italic> is the Dirac distribution with all of the mass at 0, the only possible merge is <italic>k</italic> = 2 and we recover the Kingman coalescent [28]. For this reason, we expect our coalescent to approach Kingman’s when <italic>β</italic> ≪ 1, which will be shown explicitely below.</p></list-item>
<list-item><p>if Λ(<italic>β</italic>) is uniform in [0,1], meaning <italic>P(β) α α<sup>−2</sup></italic>, we obtain the Bolthausen-Sznitman coalescent [<xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c38">38</xref>], which is used to describe the genealogy of populations under strong selection [<xref ref-type="bibr" rid="c38">38</xref>–<xref ref-type="bibr" rid="c40">40</xref>].</p></list-item>
</list>
</p>
<p>Finally, we derive a few more properties of the partial sweep coalescent and show the explicit link to Kingman’s when <italic>β</italic> ≪ 1. Using the <italic>λ<sub>n</sub>(k)</italic>’s, we can compute the times <italic>T<sub>n</sub></italic>: the time during which exactly <italic>n</italic> lineages are present in parallel in the genealogy. If there are <italic>n</italic> lineages present, any coalescence will lower the number of lineages below <italic>n</italic>. The time <italic>T<sub>n</sub></italic> is thus exponentially distributed with rate <italic>v(n)</italic>, where <italic>v(n)</italic> is the total rate of coalescence given <italic>n</italic> lineages:
<disp-formula id="FD63">
<alternatives>
<mml:math id="M63" display="block"><mml:mi>v</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>n</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mi>ρ</mml:mi></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>λ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn63.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>Since we have <inline-formula id="ID65">
<alternatives>
<mml:math display="inline" id="I65"><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>Λ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq65.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, we finally obtain
<disp-formula id="FD64">
<alternatives>
<mml:math id="M64" display="block"><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>0</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mi>ρ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mtable><mml:mtr><mml:mtd><mml:mi>n</mml:mi></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mi>k</mml:mi></mml:mtd></mml:mtr></mml:mtable></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>Λ</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>k</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>n</mml:mi></mml:msup><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi></mml:math>
<graphic xlink:href="2402.07252v1_eqn64.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(B3)</label>
</disp-formula>
</p>
<p>With <inline-formula id="ID66">
<alternatives>
<mml:math display="inline" id="I66"><mml:mi>n</mml:mi><mml:mrow><mml:mo>〈</mml:mo><mml:mi>β</mml:mi><mml:mo>〉</mml:mo></mml:mrow><mml:mo>≪</mml:mo><mml:mn>1</mml:mn></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq66.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>, we now exactly recover the Kingman coalescent. For simplicity, we assume a constant <italic>β</italic> and expand <italic>T<sub>n</sub></italic> up to the second order in <italic>nβ</italic>, to obtain
<disp-formula id="FD65">
<alternatives>
<mml:math id="M65" display="block"><mml:msubsup><mml:mi>T</mml:mi><mml:mi>n</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>n</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>e</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2402.07252v1_eqn65.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</disp-formula>
</p>
<p>These are the times expected for the Kingman coalescent with population size <italic>N<sub>e</sub></italic> = 1/<italic>ρβ</italic><sup>2</sup>.</p>
<p>In the high <italic>n</italic> limit, we also obtain <italic>T<sub>n</sub> → ρ<sup>−1</sup></italic>, since quantities of the type (1 – <italic>β</italic>)<sup><italic>n</italic></sup> vanish. This is expected as coalescences only take place when a partial sweep happens, with rate <italic>ρ</italic>. It is another qualitative difference with the Kingman coalescent: since <italic>T<sub>n</sub> ≥ ρ<sup>−1</sup></italic> for all <italic>n</italic>, one must wait a time ~ <italic>ρ</italic><sup>−1</sup> to observe the first coalescence even in large trees. The shortest branches will thus always be of order <italic>ρ</italic><sup>−1</sup>. In contrast, in the Kingman process, the shortest branches vanish when the number of lineages n increases. This difference is clearly visible when looking at terminal branches of trees in <xref ref-type="fig" rid="fig8">Figure S4</xref>.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure S 3.</label>
<caption><p>Average coalescence times <inline-formula id="ID67">
<alternatives>
<mml:math display="inline" id="I67"><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mi>n</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2402.07252v1_ieq67.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> for a partial sweep coalescent with effective population size <italic>N<sub>e</sub></italic> and a Kingman coalescent with population size <italic>N<sub>e</sub></italic>. For simplicity, a constant <italic>β</italic> is used: <bold>Left</bold>: a high value <italic>β</italic> = 0.25; <bold>Right</bold>: a low value <italic>β</italic> = 0.05. For low <italic>β</italic>, the two coalescent processes are very similar until a high <italic>n</italic>. They considerably differ if <italic>β</italic> is larger. Note that for the partial sweep process, <italic>T<sub>n</sub></italic> never goes below <italic>ρ</italic><sup>−1</sup>.</p></caption>
<graphic xlink:href="2402.07252v1_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure S 4.</label>
<caption><p>Realisations of different coalescence processes for 30 lineages (leaves). <bold>Left</bold>: Partial sweep coalescent, with constant <italic>β</italic> = 0.4 and <italic>ρ</italic> = 0.00625 such that <italic>N<sub>e</sub></italic> = <italic>(ρβ</italic><sup>2</sup>)<sup>−1</sup> = 1000. <bold>Right</bold>: Kingman coalescent with population size <italic>N</italic> = <italic>N<sub>e</sub></italic> = 1000.</p></caption>
<graphic xlink:href="2402.07252v1_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
</app>
</app-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.97350.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Nourmohammad</surname>
<given-names>Armita</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Washington</institution>
</institution-wrap>
<city>Seattle</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>important</bold> study provides a new perspective on how human immunity shapes the antigenic evolution of pathogens. By combining theory and simulation the authors make a <bold>solid</bold> case for the importance of eco-evolutionary interactions in population-level virus-host dynamics, which arise due to coupling between the dynamics of immune memories and viral variants. Although the work does not propose improved data-driven viral forecasting methods, it makes a conceptual contribution that advances the field's understanding of this problem's intrinsic difficulty.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.97350.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>In this work, the authors study the dynamics of fast-adapting pathogens under immune pressure in a host population with prior immunity. In an immunologically diverse population, an antigenically escaping variant can perform a partial sweep, as opposed to a sweep in a homogeneous population. In a certain parameter regime, the frequency dynamics can be mapped onto a random walk with zero mean, which is reminiscent of neutral dynamics, albeit with differences in higher order moments. Next, they develop a simplified effective model of time dependent selection with expiring fitness advantage, and posit that the resulting partial sweep dynamics could explain the behaviour of influenza trajectories empirically found in earlier work (Barrat-Charlaix et al. Molecular Biology and Evolution, 2021). Finally, the authors put forward an interesting hypothesis: the mode of evolution is connected to the age of a lineage since ingression into the human population. A mode of meandering frequency trajectories and delayed fixation has indeed been observed in one of the long-established subtypes of human influenza, albeit so far only over a limited period from 2013 to 2020. The paper is overall interesting and well-written. Some aspects, detailed below, are not yet fully convincing and should be treated in a substantial revision.</p>
<p>Major points</p>
<p>(1) The quasi-neutral behaviour of amino acid changes above a certain frequency (reported in Fig, 3), which is the main overlap between influenza data and the authors' model, is not a specific property of that model. Rather, it is a generic property of travelling wave models and more broadly, of evolution under clonal interference (Rice et al. Genetics 2015, Schiffels et al. Genetics 2011). The authors should discuss in more detail the relation to this broader class of models with emergent neutrality. Moreover, the authors' simulations of the model dynamics are performed up to the onset of clonal interference \rho/s_0 = 1 (see Fig. 4). Additional simulations more deeply in the regime of clonal interference (e.g. \rho / s_0 = 5) show more clearly the behaviour in this regime.</p>
<p>In this context, I also note that the modelling results of this paper, in particular the stalling of frequency increase and the decrease in the number of fixations, are very similar to established results obtained from similar dynamical assumptions in the broader context of consumer resource models; see, e.g., Good et al. PNAS 2018. The authors should place their model in this broader context.</p>
<p>(2) The main conceptual problem of this paper is the inference of generic non-predictability from the quasi-neutral behaviour of influenza changes. There is no question that new mutations limit the range of predictions, this problem being most important in lineages with diverse immune groups such as influenza A(H3N2). However, inferring generic non-predictability from quasi-neutrality is logically problematic because predictability refers to individual trajectories, while quasi-neutrality is a property obtained by averaging over many trajectories (Fig. 3). Given an SIR dynamical model for trajectories, as employed here and elsewhere in the literature, the up and down of individual trajectories may be predictable for a while even though allele frequencies do not increase on average. The authors should discuss this point more carefully.</p>
<p>(3) To analyze predictability and population dynamics (section 5), the authors use a Wright-Fisher model with expiring fitness dynamics. While here the two sources of the emerging neutrality are easily tuneable (expiring fitness and clonal interference), the connection of this model to the SIR model needs to be substantiated: what is the starting selection s_0 as a function of the SIR parameters (f, b, M, \epsilon), the selection decay \nu = \nu(f, b, M, \epsilon, \gamma)? This would enable the comparison of the partial sweep timing in both models and corroborate the mapping of the SIR onto the simplified W-F model. In addition, the authors' point would be strengthened if the SIR partial sweeps in Fig.1 and Fig.2 were obtained for a combination of parameters that results in a realistic timescale of partial sweeps.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.97350.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This work addresses a puzzling finding in the viral forecasting literature: high-frequency viral variants evince signatures of neutral dynamics, despite strong evidence for adaptive antigenic evolution. The authors explicitly model interactions between the dynamics of viral adaptations and of the environment of host immune memory, making a solid theoretical and simulation-based case for the essential role of host-pathogen eco-evolutionary dynamics. While the work does not directly address improved data-driven viral forecasting, it makes a valuable conceptual contribution to the key dynamical ingredients (and perhaps intrinsic limitations) of such efforts.</p>
<p>Strengths:</p>
<p>This paper follows up on previous work from these authors and others concerning the problem of predicting future viral variant frequency from variant trajectory (or phylogenetic tree) data, and a model of evolving fitness. This is a problem of high impact: if such predictions are reliable, they empower vaccine design and immunization strategies. A key feature of this previous work is a &quot;traveling fitness wave&quot; picture, in which absolute fitnesses of genotypes degrade at a fixed rate due to an advancing external field, or &quot;degradation of the environment&quot;. The authors have contributed to these modeling efforts, as well as to work that critically evaluates fitness prediction (references 11 and 12). A key point of that prior work was the finding that fitness metrics performed no better than a baseline neutral model estimate (Hamming distance to a consensus nucleotide sequence). Indeed, the apparent good performance of their well-adopted &quot;local branching index&quot; (LBI) was found to be an artifact of its tendency to function as a proxy for the neutral predictor. A commendable strength of this line of work is the scrutiny and critique the authors apply to their own previous projects. The current manuscript follows with a theory and simulation treatment of model elaborations that may explain previous difficulties, as well as point to the intrinsic hardness of the viral forecasting inference problem.</p>
<p>This work abandons the mathematical expedience of traveling fitness waves in favor of explicitly coupled eco-evolutionary dynamics. The authors develop a multi-compartment susceptible/infected model of the host population, with variant cross-immunity parameters, immune waning, and infectious contact among compartments, alongside the viral growth dynamics. Studying the invasion of adaptive variants in this setting, they discover dynamics that differ qualitatively from the fitness wave setting: instead of a succession of adaptive fixations, invading variants have a characteristic &quot;expiring fitness&quot;: as the immune memories of the host population reconfigure in response to an adaptive variant, the fitness advantage transitions to quasi-neutral behavior. Although their minimal model is not designed for inference, the authors have shown how an elaboration of host immunity dynamics can reproduce a transition to neutral dynamics. This is a valuable contribution that clarifies previously puzzling findings and may facilitate future elaborations for fitness inference methods.</p>
<p>The authors provide open access to their modeling and simulation code, facilitating future applications of their ideas or critiques of their conclusions.</p>
<p>Weaknesses:</p>
<p>The current modeling work does not make direct contact with data. I was hoping to see a more direct application of the model to a data-driven prediction problem. In the end, although the results are compelling as is, this disconnect leaves me wondering if the proposed model captures the phenomena in detail, beyond the qualitative phenomenology of expiring fitness. I would imagine that some data is available about cross-immunity between strains of influenza and sarscov2, so hopefully some validation of these mechanisms would be possible.</p>
<p>After developing the SIR model, the authors introduce an effective &quot;expiring fitness&quot; model that avoids the oscillatory behavior of the SIR model. I hoped this could be motivated more directly, perhaps as a limit of the SIR model with many immune groups. As is, the expiring fitness model seems to lose the eco-evolutionary interpretability of the SIR model, retreating to a more phenomenological approach. In particular, it's not clear how the fitness decay parameter nu and the initial fitness advantage s_0 relate to the key ecological parameters: the strain cross-immunity and immune group interaction matrices.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.97350.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this work the authors start presenting a multi-strain SIR model in which viruses circulate in an heterogeneous population with different groups characterized by different cross-immunity structures. They argue that this model can be reformulated as a random walk characterized by new variants saturating at intermediate frequencies. Then they recast their microscopic description to an effective formalism in which viral strains lose fitness independently from one another. They study several features of this process numerically and analytically, such as the average variants frequency, the probability of fixation, and the coalescent time. They compare qualitatively the dynamics of this model to variants dynamics in RNA viruses such as flu and SARS-CoV-2</p>
<p>Strengths:</p>
<p>The idea that a vanishing fitness mechanisms that produce partial sweeps may explain important features of flu evolution is very interesting. Its simplicity and potential generality make it a powerful framework. As noted by the authors, this may have important implications for predictability of virus evolution and such a framework may be beneficial when trying to build predictive models for vaccine design. The vanishing fitness model is well analyzed and produces interesting structures in the strains coalescent. Even though the comparison with data is largely qualitative, this formalism would be helpful when developing more accurate microscopic ingredients that could reproduce viral dynamics quantitatively.</p>
<p>
This general framework has a potential to be more universal than human RNA viruses, in situations where invading mutants would saturate at intermediate frequencies.</p>
<p>Weaknesses:</p>
<p>The authors build the narrative around a multi-strain SIR model in which viruses circulate in an heterogeneous population, but the connection of this model to the rest of the paper is not well supported by the analysis.</p>
<p>
When presenting the random walk coarse-grained description in section 3 of the Results, there is no quantitative relation between the random walk ingredients - importantly P(\beta) - and the SIR model, just a qualitative reasoning that strains would initially grow exponentially and saturate at intermediate frequencies. So essentially any other microscopic description with these two features would give rise to the same random walk.</p>
<p>Currently it's unclear whether the specific choices for population heterogeneity and cross-immunity structure in the SIR model matter for the main results of the paper. In section 2, it seems that the main effect of these ingredients are reduced oscillations in variants frequencies and a rescaled initial growth rate. But ultimately a homogeneous population would also produce steady state coexistence between strains, and oscillation amplitude likely depends on parameters choices. Thus a homogeneous population may lead to a similar coarse-grained random walk.</p>
<p>Similarly, it's unclear how the SIR model relates to the vanishing fitness framework, other than on a qualitative level given by the fact that both descriptions produce variants saturating at intermediate frequencies. Other microscopic ingredients may lead to a similar description, yet with quantitative differences.</p>
<p>At the same time, from the current analysis the reader cannot appreciate the impact of such a mean field approximation where strains lose fitness independently from one another, and under what conditions such assumption may be valid.</p>
<p>In summary, the central and most thoroughly supported results in this paper refer to a vanishing fitness model for human RNA viruses. The current narrative, built around the SIR model as a general work on host-pathogen eco-evolution in the abstract, introduction, discussion and even title, does not seem to match the key results and may mislead readers. The SIR description rather seems one of the several possible models, featuring a negative frequency dependent selection, that would produce coarse-grained dynamics qualitatively similar to the vanishing fitness description analyzed here.</p>
</body>
</sub-article>
</article>