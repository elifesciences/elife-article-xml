<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">88039</article-id>
<article-id pub-id-type="doi">10.7554/eLife.88039</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.88039.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Genetics and Genomics</subject>
</subj-group>
</article-categories><title-group>
<article-title>The Impact of Stability Considerations on Genetic Fine-mapping</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Aw</surname>
<given-names>Alan J</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Jin</surname>
<given-names>Lionel Chentian</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Ioannidis</surname>
<given-names>Nilah M</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a4">4</xref>
    <email>nilah@berkeley.edu</email>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0734-9868</contrib-id>
<name>
<surname>Song</surname>
<given-names>Yun S</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a4">4</xref>
    <email>yss@berkeley.edu</email>
</contrib>
    <aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an7q238</institution-id><institution>Department of Statistics, University of California, Berkeley</institution></institution-wrap>, <city>Berkeley</city>, <country country="US">United States</country></aff>
    <aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an7q238</institution-id><institution>Center for Computational Biology, University of California, Berkeley</institution></institution-wrap>, <city>Berkeley</city>, <country country="US">United States</country></aff>
    <aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01gmv5d77</institution-id><institution>McKinsey &amp; Company</institution></institution-wrap>, <city>Seattle</city>, <country country="US">United States</country></aff>
    <aff id="a4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an7q238</institution-id><institution>Computer Science Division, University of California, Berkeley</institution></institution-wrap>, <city>Berkeley</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Young</surname>
<given-names>Alexander</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of California, Los Angeles</institution>
</institution-wrap>
<city>Los Angeles</city>
<country country="US">United States</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Weigel</surname>
<given-names>Detlef</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Biology Tübingen</institution>
</institution-wrap>
<city>Tübingen</city>
<country country="DE">Germany</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
    <fn id="n1" fn-type="present-address"><label>†</label><p>Present address: Department of Genetics, University of Pennsylvania, Philadelphia, United States</p></fn>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-07-18">
<day>18</day>
<month>07</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2026-01-08">
<day>08</day>
<month>01</month>
<year>2026</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP88039</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-04-11">
<day>11</day>
<month>04</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-04-13">
<day>13</day>
<month>04</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.04.11.536456"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-07-18">
<day>18</day>
<month>07</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.88039.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.88039.1.sa2">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.88039.1.sa1">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.88039.1.sa0">Reviewer #2 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Aw et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Aw et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-88039-v2.pdf"/>
<abstract>
<p>Fine-mapping methods, which aim to identify genetic variants responsible for complex traits following genetic association studies, typically assume that sufficient adjustments for confounding within the association study cohort have been made, e.g., through regressing out the top principal components (i.e., residualization). Despite its widespread use, however, residualization may not completely remove all sources of confounding. Here, we propose a complementary stability-guided approach that does not rely on residualization, which identifies consistently fine-mapped variants across different genetic backgrounds or environments. Simulations show that stability guidance neither outperforms nor underperforms residualization, but each approach picks up different variants considerably often. Critically, prioritizing variants that match between the residualization and stability-guided approaches enhances recovery of causal variants. We further demonstrate the utility of the stability approach by applying it to fine-map eQTLs in the GEUVADIS data. Using 378 different functional annotations of the human genome, including recent deep learning-based annotations (e.g., Enformer), we compare enrichments of these annotations among variants for which the stability and traditional residualization-based fine-mapping approaches agree against those for which they disagree, and find that the stability approach enhances the power of traditional fine-mapping methods in identifying variants with functional impact. Finally, in cases where the two approaches report distinct variants, our approach identifies variants comparably enriched for functional annotations. Our findings suggest that the stability principle, as a conceptually simple device, complements existing approaches to fine-mapping, reinforcing recent advocacy of evaluating cross-population and cross-environment portability of biological findings. To support visualization and interpretation of our results, we provide a Shiny app, available at: <ext-link ext-link-type="uri" xlink:href="https://alan-aw.shinyapps.io/stability_v0/">https://alan-aw.shinyapps.io/stability_v0/</ext-link>.</p>
</abstract>
<funding-group>
<award-group id="par-1">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100000002</institution-id>
<institution>HHS | National Institutes of Health (NIH)</institution>
</institution-wrap>
</funding-source>
<award-id>R35-GM134922</award-id>
<principal-award-recipient>
<name>
<surname>Song</surname>
<given-names>Yun S</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="par-2">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="FundRef">http://dx.doi.org/10.13039/100014989</institution-id>
<institution>Chan Zuckerberg Initiative (CZI)</institution>
</institution-wrap>
</funding-source>
<award-id>CZF2019- 002449</award-id>
<principal-award-recipient>
<name>
<surname>Song</surname>
<given-names>Yun S</given-names>
</name>
</principal-award-recipient>
</award-group>
</funding-group>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>The revised version includes additional simulation studies and analysis of another fine-mapping method.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>An important challenge faced by computational precision health research is the lack of generalizability of biological findings, which are often obtained by studying cohorts that do not include particular communities of individuals. Known as the <italic>cross-population generalizability</italic> or <italic>portability problem</italic>, the challenge persists in multiple settings, including gene expression prediction (<xref ref-type="bibr" rid="c32">Keys et al., 2020</xref>) and polygenic risk prediction (<xref ref-type="bibr" rid="c46">Mostafavi et al., 2020</xref>). Generalizable biological signals, such as the functional impact of a variant, are important, as they ensure that general conclusions drawn from cohort-specific analyses are not based on spurious discoveries. Portability problems are potentially attributable to cohort-biased discoveries being treated as generalizable true signals. Efforts to address such problems have included the use of diverse cohorts typically representing multiple population ancestries (<xref ref-type="bibr" rid="c42">Márquez-Luna et al., 2017</xref>), meta-analyses of earlier studies across diverse cohorts (<xref ref-type="bibr" rid="c55">Turley et al., 2021</xref>; <xref ref-type="bibr" rid="c24">Han and Eskin, 2012</xref>; <xref ref-type="bibr" rid="c45">Morris, 2011</xref>; <xref ref-type="bibr" rid="c60">Willer et al., 2010</xref>), or focusing on biological markers that are more likely <italic>a priori</italic> to play a causal role (including proxy variables), e.g., rare variants (<xref ref-type="bibr" rid="c64">Zaidi and Mathieson, 2020</xref>) or the transcriptome (<xref ref-type="bibr" rid="c37">Liang et al., 2022</xref>).</p>
<p>In this paper, we consider an approach based on the notion of <italic>stability</italic> to improve generalizability. Being a pillar of veridical data science (<xref ref-type="bibr" rid="c62">Yu and Kumbier, 2020</xref>), stability refers to the robustness of statistical conclusions to <italic>perturbations</italic> of the data. Perturbations are not arbitrary, but instead they encode the practitioner’s beliefs about the quality of the data and the nature of relationship between variables. Well-chosen perturbation schemes will help the practitioner obtain statistical conclusions that are robust, in the sense that they are generalizable rather than spurious findings, and therefore more likely to capture the true signal. For example, in sparse linear models, prioritizing the stability of effect sizes to cross-validation “perturbations” leads to a much smaller set of selected features without reducing predictive performance (<xref ref-type="bibr" rid="c38">Lim and Yu, 2016</xref>). In another example involving the application of random forests to detect higher-order interactions between gene regulation features (<xref ref-type="bibr" rid="c7">Basu et al., 2018</xref>), interactions stable to bootstrap perturbations are also largely consistent with known physical interactions between the associated transcription factor binding or enhancer sites.</p>
<p>To further investigate the utility of the stability approach, we focus on a procedure known as (genetic) fine-mapping (<xref ref-type="bibr" rid="c52">Schaid et al., 2018</xref>). Fine-mapping is the task of identifying genetic variants that causally affect some trait of interest. From the viewpoint of stability, previous works focusing on cross-population stability of fine-mapped variants typically use Bayesian linear models. The linear model has allowed modeling of heterogeneous effect sizes across different user-defined populations (e.g., ethnic groups, ancestrally distinct populations, or study cohorts), and it is common to assume that causal variants share correlated effects across populations (see, e.g., eq. (24) of <xref ref-type="bibr" rid="c34">LaPierre et al., 2021</xref> or eq. (9) of <xref ref-type="bibr" rid="c59">Wen et al., 2015</xref>).</p>
<p>Unlike the parametric approaches described above, we here apply a <italic>non-parametric</italic> fine-mapping method to GEUVADIS (<xref ref-type="bibr" rid="c35">Lappalainen et al., 2013</xref>), a database of gene expression traits measured across individuals of diverse genetic ancestries and from different geographical environments, whose accompanying genotypes are available through the 1000 Genomes Project (1kGP) (<xref ref-type="bibr" rid="c1">1000 Genomes Project Consortium et al., 2015</xref>). We apply fine-mapping through two approaches, one that is commonly used in practice and another that is guided by stability. First, we perform simulations using 1kGP genotypes to evaluate the strength of each approach. We next evaluate the agreement of fine-mapped variants between the two approaches on GEUVADIS data, and then measure the functional significance of variants picked by both approaches using a much wider range of functional annotations than considered in previous studies. By performing various statistical tests on the functional annotations, we evaluate the advantages brought about by the incorporation of stability. Finally, we investigate the broader applicability of the stability approach, by implementing and analyzing a stability-guided version of the fine-mapping algorithm SuSiE on simulated data. To support visualization of results obtained from the GEUVADIS analysis at both the single gene and genome-wide levels, we provide an interactive Shiny app which is available at: <ext-link ext-link-type="uri" xlink:href="https://alan-aw.shinyapps.io/stability_v0/">https://alan-aw.shinyapps.io/stability_v0/</ext-link>. Our app is open-source and designed to support geneticists in interpreting our results, thereby also addressing a growing demand for accessible, <italic>integrative</italic> software to interpret genetic findings in the age of big data and variant annotation databases.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Experimental Design</title>
<p>We apply the fine-mapping method PICS (<xref ref-type="bibr" rid="c54">Taylor et al., 2021</xref>; <xref ref-type="bibr" rid="c18">Farh et al., 2015</xref>; see <xref ref-type="statement" rid="alg1">Algorithm 1</xref> in Probabilistic Identification of Causal SNPs) to the GEUVADIS data (<xref ref-type="bibr" rid="c35">Lappalainen et al., 2013</xref>), which consists of <italic>T</italic> = 22, 720 gene expression traits measured across <italic>N</italic> = 445 individuals, with their accompanying genotypes obtained from the 1000 Genomes Project (<xref ref-type="bibr" rid="c1">1000 Genomes Project Consortium et al., 2015</xref>). These individuals are of either European or African ancestry, with about four fifths of the cohort made up of individuals of (self-identified) European descent. In particular, these ancestrally different subpopulations have distinct linkage disequilibrium patterns and environmental exposures, which constitute potential confounders that we wish to stabilize the fine-mapping procedure against.</p>
<p>PICS, like many eQTL analysis methods, requires the lead variant at a locus to compute posterior probabilities, so we perform marginal regressions of each gene expression trait against variants within the fine-mapping locus. Our implementation of PICS generates three sets of variants, which represent putatively causal variants that are (marginally) highly associated, moderately associated and weakly associated with the gene expression phenotype. (See Materials and Methods for details.) As illustrated in <xref rid="fig1" ref-type="fig">Figure 1A</xref>, we compare two versions of the fine-mapping procedure — one that is typically performed in practice, and another that is motivated by the stability approach.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
    <caption><title>An overview of our study of the impact of stability considerations on genetic fine-mapping.</title>
        <p><bold>A</bold>. The two ways in which we perform fine-mapping, the first of which (colored in green) prioritizes the stability of variant discoveries to subpopulation perturbations. The data illustrates the case where there are two distinct environments, or subpopulations (denoted <italic>E</italic><sub>1</sub> and <italic>E</italic><sub>2</sub>), that split the observations. <bold>B</bold>. Key steps in our comparison of the stability-guided approach with the popular residualization approach.</p></caption>
<graphic xlink:href="536456v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s2a1">
<title>Stable variant</title>
<p>Specifically, to incorporate stability into fine-mapping and obtain what we call the <italic>stable variant</italic> or stable SNP, we encode into the algorithm our belief that for a gene expression trait, a causal variant would presumably act through the same mechanism regardless of the population from which they originate. Indeed, if a set of genetic variants were causal, the same algorithm should report it, if run on subsets of the data corresponding to heterogeneous populations. This belief is consistent with recent simulation studies showing that the inclusion of GWAS variants discovered in diverse populations both mitigates false discoveries driven by linkage disequilibrium differences (<xref ref-type="bibr" rid="c36">Li et al., 2022</xref>) and improves generalizability of polygenic score construction (<xref ref-type="bibr" rid="c12">Cavazos and Witte, 2021</xref>). Hence, the stable variant is the variant with the highest probability of being causal, conditioned on being reported by PICS in the most number of subpopulations. Incorporating Stability provides a formal definition of the stable variant.</p>
</sec>
<sec id="s2a2">
<title>Top variant</title>
<p>The stability consideration we have described is closely related to a popular procedure known as correction for population structure, which residualizes the trait using measured confounders (e.g., top principal components computed from the genotype matrix). We call the variant returned by the residualization approach the <italic>top variant</italic> or top SNP. The residualization approach removes the effects of genetic ancestry and environental exposures on a trait, and is used to avoid the risk of low statistical power borne by stratified analyses. The top variant is formally defined towards the end of Probabilistic Identification of Causal SNPs. We remark that the top variant is a function of the residualized trait, as opposed to the stable variant, which is a function of the unresidualized trait (see <xref rid="fig1" ref-type="fig">Figure 1A</xref>).</p>
</sec>
</sec>
<sec id="s2b">
<title>Simulation Study</title>
<p>We simulated 100 genes from GEUVADIS gene expression data, sampled proportionally across the 22 autosomes. Mirroring the approach described in Section 4 of <xref ref-type="bibr" rid="c56">Wang et al. (2020</xref>), synthetic gene expression phenotypes were simulated based on the sampled genes, and involve two parameters: <italic>C</italic>, the number of causal variants, and <italic>ϕ</italic>, the proportion of variance in gene expression explained by variants in <italic>cis</italic>. Whenever available, gene expression canonical TSS was used to include only variants lying within 1 Mb upstream and downstream when simulating gene expression phenotypes. We considered all combinations of <italic>C ∈</italic> {1, 2, 3} and <italic>ϕ ∈</italic> {0.05, 0.1, 0.2, 0.4}, and simulated two replicates for each gene and for each combination of <italic>C</italic> and <italic>ϕ</italic>. Altogether, we generated 100× 3× 4× 2 = 2, 400 datasets, on which we ran PICS and SuSiE. For PICS, we ran four versions: the <italic>stability-guided</italic> version and <italic>residualization</italic> version, which return the stable variant and top variant respectively; a <italic>combined</italic> version, which runs stability-guided PICS on covariate-residualized phenotypes; as well as a <italic>plain</italic> version, where no correction for population stratification or stability guidance was applied. For SuSiE, we ran two versions: the stability-guided version and the residualization version. We also ran a separate set of simulations comprising six scenarios of environmental heterogeneity by ancestry on 10 genes from Chromosomes 1, 20, 21 and 22 (6 × 10 × 3 × 4 × 2 = 1, 440 generated datasets), on which we ran the plain and stability-guided versions of PICS.</p>
<sec id="s2b1">
<title>Evaluation on simulated genes</title>
<p>Following <xref ref-type="bibr" rid="c43">Mazumder (2020</xref>), we analyze the recovery probability of all fine-mapping algorithms as a function of the Signal-to-Noise Ratio (SNR), defined here as the ratio of true signal to background noise: SNR = var(<bold>Xb</bold>)/<italic>σ</italic><sup>2</sup>(see Simulation Study and Evaluation Details in Materials and Methods for details).</p>
</sec>
</sec>
<sec id="s2c">
<title>Analysis of GEUVADIS Data</title>
<p>We compare the results obtained by using each approach, across a range of categories of functional annotations including conservation, pathogenicity, chromatin accessibility, transcription factor binding and histone modification, and across biological assays and computational predictions. See <xref rid="tbl1" ref-type="table">Table 1</xref> for full list of annotations covered. (Supplementary File 1 Section S5 contains a full description of each quantity and its interpretation.)</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
    <caption><title>A list of 378 functional annotations across which the biological significances of stable and top fine-mapped single nucleotide polymorphisms are compared.</title>
        <p>Annotations that report multiple scores have the total number of scores reported shown in parentheses. Scores mined from the FAVOR database (<xref ref-type="bibr" rid="c65">Zhou et al., 2023</xref>) are indicated by an asterisk. (<italic>TSS</italic> = Transcription Start Site, <italic>bp</italic> = base pair)</p></caption>
<graphic xlink:href="536456v2_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p><xref rid="fig1" ref-type="fig">Figure 1B</xref> summarizes the key steps of our investigation. To be clear, a first comparison is between the set of genes for which the top and stable variants match and the set of genes for which the top and stable variants disagree; comparisons are made between matching variants and one of the non-matching sets of variants (top or stable). A second comparison is restricted to the set of genes with non-matching top and stable variants, i.e., between <italic>paired</italic> sets of variants fine-mapped to a gene, where one set of a pair corresponds to the output of the residualization approach whereas the other corresponds to the output of the stability-guided approach. We additionally compare across three fine-mapping output sets, corresponding to variants that have a high, moderate or weak marginal association with the expression phenotype. For brevity, we term these three sets Potential Set 1, Potential Set 2 and Potential Set 3, respectively. (See <xref ref-type="statement" rid="alg1">Algorithm 1</xref> for details.) For each Potential Set, we find the top and stable variants as described in Incorporating Stability.</p>
</sec>
<sec id="s2d">
<title>Simulations justify exploration of stability guidance</title>
<p>To better understand how stability guidance may support the discovery of causal variants across ancestrally diverse cohorts that possess confounding exogenous factors, we selected 10 genes from Chromosomes 1, 20, 21 and 22 to simulate six scenarios where environmental heterogeneity by ancestry influences gene expression. We consider four scenarios where environmental <italic>variance</italic> differed between ancestries and two scenarios where environmental <italic>mean</italic> differed between ancestries. We also vary the number of causal variants and proportion of variance in gene expression expressed in <italic>cis</italic>. We run Stable PICS, which returns stable variants; alongside a “plain” version of PICS (Plain PICS), which neither performs PC-residualization of phenotypes nor incorporates stability.</p>
<p>We find that, across these simulations, performance was not significantly different between Stable PICS and Plain PICS: both approaches recover the true causal variant in Potential Set 1 with similar frequencies in simulations involving one causal variant, and in simulations involving two or more causal variants the leading potential sets recover at least one causal variant with similar frequency (<xref rid="fig2" ref-type="fig">Figure 2A</xref>). These also hold for lower potential sets (<xref rid="fig2_S1" ref-type="fig">Figure 2—figure supplement 1</xref>). While the two approaches agree more often than not, there is greater disagreement when considering simulations with low SNR (which may potentially reflect real gene expression data — see Stable variants frequently do not match top variants in GEUVADIS). For example, we identified 83% matching variants in Potential Set 1 across all simulations, but this dropped to 74% when restricting to simulations with <italic>ϕ</italic> = 0.05. We next split results by whether the variant returned by Plain PICS had a large posterior probability (PP) — defined as <italic>&gt;</italic> 0.9 to reflect thresholds reported in practice — and found strong agreement between the two approaches when PP was large: for Potential Set 1 the agreement was 98%, Potential Set 2 was 90%, and Potential Set 3 was 93% (Supplementary File 2A). These observations together imply that the two approaches disagree particularly when SNR is low and the PP of variants returned by Plain PICS is not large, and Stable PICS recovers causal variants accurately in certain cases where Plain PICS fails to do so (otherwise their performances would be different).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Simulation study results.</title>
    <p><bold>A</bold>. The frequency with which at least one causal variant is recovered in Potential Set 1 by Plain PICS and Stable PICS, across 1, 440 simulated gene expression data that incorporate ancestry-mediated environmental heterogeneity. Recovery frequencies are stratified by simulations differing in the number of causal variants, and the Venn diagram reports the number of matching and non-matching variants in Potential Set 1 across all simulations. <bold>B</bold>. The frequency with which at least one causal variant is recovered in Potential Set 1 by Combined PICS, Stable PICS and Top PICS, across 2, 400 simulated gene expression data. Recovery frequencies are stratified by the SNR parameter <italic>ϕ</italic> used in simulations, and the Venn diagram reports the number of matching and non-matching variants in Potential Set 1 across all simulations. <bold>C</bold>. The frequency with which at least one causal variant is recovered in Credible Set 1 by Stable SuSiE and Top SuSiE. Venn diagram reports the number of matching and non-matching variants in Potential Set 1 across all simulations. <bold>D</bold>. The frequency with which matching and non-matching variants in the first credible or potential set recover a causal variant, obtained from comparing top and stable approaches to an algorithm. <xref ref-type="fig" rid="fig2_S1">Figure 2—figure supplement 1</xref>. Plain PICS vs Stable PICS (Potential Sets 2 and 3) <xref ref-type="fig" rid="fig2_S2">Figure 2—figure supplement 2</xref>. Performance of PICS Algorithms (Potential Sets 2 and 3) <xref ref-type="fig" rid="fig2_S3">Figure 2—figure supplement 3</xref>. Performance of SuSiE Algorithms (Credible Sets 2 and 3) <xref ref-type="fig" rid="fig2_S4">Figure 2—figure supplement 4</xref>. Matching vs Non-matching Variants (Potential and Credible Sets 1 and 2) <xref ref-type="fig" rid="fig2_S5">Figure 2—figure supplement 5</xref>. Stable PICS vs Stable SuSiE (1 causal variant) <xref ref-type="fig" rid="fig2_S6">Figure 2—figure supplement 6</xref>. Stable PICS vs Stable SuSiE (2 causal variants) <xref ref-type="fig" rid="fig2_S7">Figure 2—figure supplement 7</xref>. Stable PICS vs Stable SuSiE (3 causal variants) <xref ref-type="fig" rid="fig2_S8">Figure 2—figure supplement 8</xref>. Matching Top vs Stable SNP posterior probabilities <xref ref-type="fig" rid="fig2_S9">Figure 2—figure supplement 9</xref>. Non-matching Top vs Stable SNP posterior probabilities <xref ref-type="fig" rid="fig2_S10">Figure 2—figure supplement 10</xref>. Stable PICS vs SuSiE (1 causal variant) <xref ref-type="fig" rid="fig2_S11">Figure 2—figure supplement 11</xref>. Stable PICS vs SuSiE (2 causal variants) <xref ref-type="fig" rid="fig2_S12">Figure 2—figure supplement 12</xref>. Stable PICS vs SuSiE (3 causal variants) <xref ref-type="fig" rid="fig2_S13">Figure 2—figure supplement 13</xref>. Distribution of number of variants recovered by PICS (1 causal variant) <xref ref-type="fig" rid="fig2_S14">Figure 2—figure supplement 14</xref>. Distribution of number of variants recovered by PICS (2 causal variants) <xref ref-type="fig" rid="fig2_S15">Figure 2—figure supplement 15</xref>. Distribution of number of variants recovered by PICS (3 causal variants) <xref ref-type="fig" rid="fig2_S16">Figure 2—figure supplement 16</xref>. Distribution of number of variants recovered by SuSiE (1 causal variant) <xref ref-type="fig" rid="fig2_S17">Figure 2—figure supplement 17</xref>. Distribution of number of variants recovered by SuSiE (2 causal variants) <xref ref-type="fig" rid="fig2_S18">Figure 2—figure supplement 18</xref>. Distribution of number of variants recovered by SuSiE (3 causal variants) <xref ref-type="fig" rid="fig2_S19">Figure 2—figure supplement 19</xref>. Variant recovery frequency of PICS and SuSiE matching and non-matching variants (1 causal variant) <xref ref-type="fig" rid="fig2_S20">Figure 2—figure supplement 20</xref>. Distribution of number of variants recovered by PICS matching and non-matching variants (2 causal variants) <xref ref-type="fig" rid="fig2_S21">Figure 2—figure supplement 21</xref>. Distribution of number of variants recovered by SuSiE matching and non-matching variants (2 causal variants) <xref ref-type="fig" rid="fig2_S22">Figure 2—figure supplement 22</xref>. Distribution of number of variants recovered by PICS matching and non-matching variants (3 causal variants) <xref ref-type="fig" rid="fig2_S23">Figure 2—figure supplement 23</xref>. Distribution of number of variants recovered by SuSiE matching and non-matching variants (3 causal variants) <xref ref-type="fig" rid="fig2_S24">Figure 2—figure supplement 24</xref>. Plain PICS vs Stable PICS in environmental heterogeneity Simulations (1 causal variant) <xref ref-type="fig" rid="fig2_S25">Figure 2—figure supplement 25</xref>. Plain PICS vs Stable PICS in environmental heterogeneity simulations (2 causal variants) <xref ref-type="fig" rid="fig2_S26">Figure 2—figure supplement 26</xref>. Plain PICS vs Stable PICS in environmental heterogeneity simulations (3 causal variants) <xref ref-type="fig" rid="fig2_S27">Figure 2—figure supplement 27</xref>. Plain PICS vs Stable PICS in “variance shift (<italic>t</italic> = 8)” environmental heterogeneity simulations <xref ref-type="fig" rid="fig2_S28">Figure 2—figure supplement 28</xref>. Plain PICS vs Stable PICS in “variance shift (<italic>t</italic> = 16)” environmental heterogeneity simulations <xref ref-type="fig" rid="fig2_S29">Figure 2—figure supplement 29</xref>. Plain PICS vs Stable PICS in “variance shift (<italic>t</italic> = 128)” environmental heterogeneity simulations <xref ref-type="fig" rid="fig2_S30">Figure 2—figure supplement 30</xref>. Plain PICS vs Stable PICS in “variance shift (<italic>t</italic> = 256)” environmental heterogeneity simulations <xref ref-type="fig" rid="fig2_S31">Figure 2—figure supplement 31</xref>. Plain PICS vs Stable PICS in “mean shift (|<italic>i</italic> − 3|)” environmental heterogeneity simulations <xref ref-type="fig" rid="fig2_S32">Figure 2—figure supplement 32</xref>. Plain PICS vs Stable PICS in “mean shift (<italic>i</italic> = 3)” environmental heterogeneity simulations</p></caption>
<graphic xlink:href="536456v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Looking closely at each simulation scenario, we see that Stable PICS recovers a causal variant more frequently than Plain PICS in scenarios where there are multiple causal variants and environmental heterogeneity is driven by a “spiked mean shift” (Simulation Study and Evaluation Details), while Plain PICS generally outperforms when environmental heterogeneity is driven by differences in environmental variation. For example, in a set of spiked mean shift simulations with three causal variants, with low signal-to-noise ratio (<italic>ϕ</italic> = 0.1) and with exogenous variable drawn from <italic>N</italic>(2<italic>σ, σ</italic><sup>2</sup>) for only GBR individuals (rest are drawn from <italic>N</italic>(0, <italic>σ</italic><sup>2</sup>)), the frequencies at which at least one causal variant is recovered were 80% and 75% for Stable PICS and Plain PICS, respectively (see <xref rid="fig2_S32" ref-type="fig">Figure 2— figure supplement 32</xref>). However, none of these differences in performance is statistically significant. In summary, these findings demonstrate that non-genetic confounding in cohorts can reduce power in methods not adjusting or accounting for ancestral confounding, but can be remedied by approaches that do so. (Performances stratified by SNR and number of potential sets included are summarized in <xref rid="fig2_S24" ref-type="fig">Figure 2—figure supplements 24</xref>-<xref rid="fig2_S26" ref-type="fig">26</xref>; performances stratified by each scenario are summarized in <xref rid="fig2_S27" ref-type="fig">Figure 2—figure supplements 27</xref>-<xref rid="fig2_S32" ref-type="fig">32</xref>)</p>
</sec>
<sec id="s2e">
<title>Simulations reveal advantages (and disadvantages) of stability guidance</title>
<p>We next conduct a larger set of simulations using 100 genes selected across all 22 autosomes. Similar to the earlier set of simulations, we vary both the number of causal variants and proportion of variance in gene expression explained by variants in <italic>cis</italic>. However, here we compare stability-guided fine-mapping against residualization fine-mapping, a commonly used approach.</p>
<sec id="s2e1">
<title>No difference in power between Stability guidance and Residualization, although consider ably many variants do not match</title>
<p>Comparing stable and top variants returned by Stable PICS and PICS run via the residualization approach (Top PICS), we observed similar causal variant recovery rates. Across all 2, 400 simulated gene expression phenotypes, the stable variant in Potential Set 1 was causal with frequency 0.63, which is close to and not significantly different from the frequency at which the Potential Set 1 top variant was causal (0.64; McNemar test <italic>p</italic>-value = 0.38). Similarly close frequencies were observed for lower potential sets (Potential Set 2: stable = 0.12,top = 0.13; Potential Set 3: stable = 0.041,top = 0.047), as well as when results were stratified by SNR (<xref rid="fig2" ref-type="fig">Figure 2B</xref>). However, top and stable variants often disagreed, with Potential Set 1 having 72% matching top and stable variants, Potential Set 2 matching at 40% and Potential Set 3 matching at 25% (<xref rid="fig2_S2" ref-type="fig">Figure 2—figure supplement 2</xref>). Stratifying results by simulation parameters (number of causal variants, <italic>S</italic>, and SNR, <italic>ϕ</italic>), we generally observed matching fractions increasing with SNR, at least in Potential Set 1: for example, in simulations involving one causal variant, the matching fraction is 69.5% under SNR = 0.05/(1 − 0.05) ≈ 0.053, and it increases monotonically to 89.5% under SNR = 0.4/(1 − 0.4) ≈ 0.67 (Supplementary File 2B). There was no clear relationship between matching fractions and the number of causal variants simulated.</p>
</sec>
<sec id="s2e2">
<title>Searching for matching variants between Top PICS and Stable PICS improves causal variant recovery</title>
<p>Given that stable and top variants frequently do not match despite achieving similar performance, we suspect that, similar to the smaller set of simulations on which Plain PICS and Stable PICS were compared, each approach can recover causal variants in scenarios where the other does not. We thus explore ways to combine the residualization and stability-driven approaches, by considering (i) combining them into a single fine-mapping algorithm (we call the resulting procedure <italic>Combined PICS</italic>); and (ii) prioritizing matching variants between the two algorithms. Comparing the performance of Combined PICS against both Top and Stable PICS, however, we find no significant difference in its ability to recover causal variants (<xref rid="fig2" ref-type="fig">Figure 2B</xref>). This conclusion held even when we analyzed performance by stratifying simulations by SNR and number of causal variants simulated (<italic>ϕ</italic> and <italic>S</italic> parameters; see <xref rid="fig2_S13" ref-type="fig">Figure 2—figure supplements 13</xref>-<xref rid="fig2_S15" ref-type="fig">15</xref>). On the other hand, matching variants between Top and Stable PICS are significantly more likely to be causal. Across all simulations, a matching variant in Potential Set 1 was 2.5× as likely to be causal than either a non-matching top or stable variant (<xref rid="fig2" ref-type="fig">Figure 2D</xref>) — a result that was qualitatively consistent even when we stratified simulations by SNR and number of causal variants simulated (<xref rid="fig2_S19" ref-type="fig">Figure 2—figure supplements 19</xref>, 20 and 22). A similar trend was observed for Potential Set 2, although we do not see much higher causal variant recovery when comparing matching and non-matching variants in Potential Set 3 (<xref rid="fig2_S4" ref-type="fig">Figure 2—figure supplement 4</xref>).</p>
</sec>
<sec id="s2e3">
<title>Stability guidance improves causal variant recovery in SuSiE</title>
<p>To explore the applicability of stability guidance beyond PICS, we developed a similar procedure that runs the fine-mapping algorithm SuSiE (<xref ref-type="bibr" rid="c56">Wang et al., 2020</xref>) on multiple slices and returns a stable variant. We call this approach <italic>Stable SuSiE</italic>. We then compared Stable SuSiE against SuSiE applied to residualized phenotypes (<italic>Top SuSiE</italic>), analogous to our comparisons for PICS earlier. First, similar to PICS, we generally observe no significance differences in performance between Stable and Top SuSiE, although empirically more causal variants are recovered by Top SuSiE in larger SNR simulation settings (<xref rid="fig2" ref-type="fig">Figure 2C</xref>), while more causal variants are recovered by Stable SuSiE in lower credible sets (<xref rid="fig2_S3" ref-type="fig">Figure 2—figure supplement 3</xref>; see also <xref rid="fig2_S16" ref-type="fig">Figure 2—figure supplements 16</xref>-<xref rid="fig2_S18" ref-type="fig">18</xref>). Similar to PICS, we also observed matching fractions increasing with SNR in Potential Set 1 (Supplementary File 2C). Next, comparing matching versus non-matching variants between the approaches, we observe a boost in causal variant recovery similar to that observed in PICS (<xref rid="fig2" ref-type="fig">Figure 2D</xref>), which persisted even when we stratified results by simulation parameters (<xref rid="fig2_S19" ref-type="fig">Figure 2—figure supplements 19</xref>, <xref rid="fig2_S21" ref-type="fig">21</xref> and <xref rid="fig2_S23" ref-type="fig">23</xref>). However, one difference is that, unlike in PICS, this boost was unique to Credible Set 1 — for the other two credible sets improvements in causal variant recovery were observed only when SNR is high, with non-matching Stable SuSiE variants recovering at least one causal variant with the highest frequency in low SNR scenarios (<xref rid="fig2_S4" ref-type="fig">Figure 2—figure supplement 4</xref>).</p>
</sec>
<sec id="s2e4">
<title>Other analyses</title>
<p>Our key findings from the simulation study are as follows. Stability guidance, on its own, does not significantly outperform nor underperform other standard approaches at causal variant recovery. However, prioritizing variants that agree between stability-guided fine-mapping and standard fine-mapping can significantly boost causal variant recovery. In the Supplement, we also describe findings from investigations into the impact of including more potential sets on matching frequency and causal variant recovery (Supplementary File 1 Section S2), the differences in posterior probability between non-matching variants (Supplementary File 1 Section S3), the relative performance of SuSiE and Stable PICS (Supplementary File 1 Section S4), and interpreting matching variants with very low (stable) posterior probability (Supplementary File 1 Section S11).</p>
</sec>
</sec>
<sec id="s2f">
<title>Stable variants frequently do not match top variants in GEUVADIS</title>
<p>Having identified scenarios that favor stability guidance, as well as strategies for using stability guidance to recover causal variants, we now turn to analysis of real gene expression data from GEUVADIS. As a preliminary analysis, when interrogating if the residualization and stability-guided approaches produce the same candidate causal variants, we find that for Potential Set 1, which corresponds to the set typically reported in fine-mapping studies, 56.2% of genes had matching top and stable variants (see <xref rid="fig3" ref-type="fig">Figure 3</xref>). Moving down potential sets, we find less agreement (Potential Set 2: 36.2%, Potential Set 3: 25.6%), providing evidence that as the marginal association of a variant with the expression phenotype decreases, the two approaches prioritize different signals when searching for putatively causal variants. This result is most consistent with our simulations using <italic>S</italic> = 3 causal variants and low SNR (<italic>ϕ</italic> = 0.05), where we observed 56.5%, 37% and 24.5% matching top and stable variants in Potential Sets 1, 2 and 3 respectively.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Venn diagram showing the number of matching and non-matching variants for Potential Set 1 in GEUVADIS fine-mapped variants.</title>
<p><xref rid="fig3_S1" ref-type="fig">Figure 3—figure supplement 1</xref>. Matching GEUVADIS Top vs Stable SNP posterior probabilities <xref rid="fig3_S2" ref-type="fig">Figure 3—figure supplement 2</xref>. Non-matching GEUVADIS Top vs Stable SNP posterior probabilities</p></caption>
<graphic xlink:href="536456v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Because our simulations demonstrate that prioritizing matching variants boosts causal variant recovery, we proceeded with comparing functional impact of matching stable and top variants against non-matching variants. For the rest of this Section, we report only results for Potential Set 1, given that it corresponds to the set typically reported in fine-mapping. Results for the other potential sets are provided in Supplementary File 1 Sections S7 and S8.</p>
</sec>
<sec id="s2g">
<title>Matching versus Non-Matching Variants</title>
<p>For each gene, our algorithm finds the top eQTL variant and the stable eQTL variant, which may not coincide. We thus run (one-sided) unpaired Wilcoxon tests on matching and non-matching sets of variants, to detect significant functional enrichment of one set of variants over the other. We find that the top variants that are also stable for the corresponding gene (<italic>N</italic><sub>match</sub> = 12, 743 maximum annotatable) score significantly higher in functional annotations than the top variants that are not stable (<italic>N</italic><sub>non-match</sub> = 9, 921 maximum annotatable). Notably, 361 out of 378 functional annotations report one-sided greater <italic>p</italic>-values <italic>&lt;</italic> 0.05 for the matching (i.e., both top and stable) variants after correcting for multiple testing using the Benjamini-Hochberg (BH) procedure, with many of these annotations measuring magnitudes of functional impact or functional enrichment (e.g., Enformer perturbation scores, FATHMM.XF score). Amongst the 17 remaining functional annotations, none has significantly lower scores for the matching variants. (Supplementary File 1 Section S7 lists these functional annotations in detail.) We also find that empirically, the matching variants tend to have greater agreement in posterior probabilities than non-matching variants (<xref rid="fig2_S1" ref-type="fig">Figure 2—figure supplements 1</xref> and <xref rid="fig2_S2" ref-type="fig">2</xref>).</p>
<p>As an example of a significant functional annotation, consider raw CADD scores (<xref ref-type="bibr" rid="c49">Rentzsch et al., 2019</xref>) — a higher value of which indicates a greater likelihood of deleterious effects. Out of the 22, 559 genes for which both the top and the stable variant are annotatable, looking at the distribution of top variant scores, the one corresponding to the 12, 685 genes with matching top and stable variants stochastically dominates the one corresponding to the remaining 9, 874 genes (<xref rid="fig4" ref-type="fig">Figure 4A</xref>). This relationship is more pronounced when we inspect PHRED-scaled CADD scores, where we apply a sliding cutoff threshold for calling variant deleteriousness (i.e., potential pathogenicity — see <xref ref-type="bibr" rid="c49">Rentzsch et al., 2019</xref>). We find that a greater proportion of matching variants than of either non-matching variant is classified as deleterious under the typical range of deleteriousness cutoffs (<xref rid="fig4" ref-type="fig">Figure 4B</xref>).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><p><italic>Top Row</italic>. CADD scores. <bold>A</bold>. Empirical cumulative distribution functions of raw CADD scores of matching and non-matching variants across all genes, for Potential Set 1. Non-matching variants are further divided into stable and top variants, with a score lower threshold of 1.0 and upper threshold of 5.0 used to improve visualization. <bold>B</bold>. For a deleteriousness cutoff, the percent of (i) all matching variants, (ii) all non-matching top variants, and (iii) all non-matching stable variants, which are classified as deleterious. We use a sliding cutoff threshold ranging from 10 to 20 as recommended by CADD authors. <italic>Bottom Row</italic>. Empirical cumulative distribution functions of perturbation scores of Enformer-predicted H3K27me3 ChIP-seq track. Score upper threshold of 0.015 and empirical CDF lower threshold of 0.5 used to improve visualization. <bold>C</bold>. Perturbation scores computed from predictions based on centering input sequences on the gene TSS as well as its two flanking positions. <bold>D</bold>. Perturbation scores computed from predictions based on centering input sequences on the gene TSS only.</p></caption>
<graphic xlink:href="536456v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Another example demonstrating significant functional enrichment of matching variants over non-matching variants is the perturbation scores on H3K9me3 ChIP-seq peaks, as predicted by the Enformer (<xref ref-type="bibr" rid="c4">Avsec et al., 2021</xref>). Out of the 6, 364 genes for which the distance of both the top and the stable variant to the TSS are within the Enformer input sequence length constraint, looking at the the distribution of top variant scores, the one corresponding to the 4, 491 genes with matching top and stable variants stochastically dominates the one corresponding to the remaining 1, 873 genes (<xref rid="fig4" ref-type="fig">Figure 4C,D</xref>). This relationship is true regardless of whether perturbation scores are calculated from an average of input sequences centered on the gene TSS and its two flanking positions (<xref rid="fig4" ref-type="fig">Figure 4C</xref>), or from input sequences centered on the gene TSS only (<xref rid="fig4" ref-type="fig">Figure 4D</xref>). (See Supplementary File 1 Section S6 for details on Enformer annotation calculation.)</p>
<p>Similarly, amongst all stable variants, those variants that match the top variant are significantly more enriched in functional annotations: 363 functional annotations report one-sided greater BH adjusted <italic>p</italic>-values <italic>&lt;</italic> 0.05 for the matching variants, and none of the remaining 15 annotations present significant depletion for the matching variants set.</p>
</sec>
<sec id="s2h">
<title>Top versus Stable variants when they do not match</title>
<p>Focusing on the genes for which the top and stable variants are different, we run (one-sided) paired Wilcoxon tests to detect significant functional enrichment of one set of variants over the other. We find in general that for some genes stable variants can carry more functional impact than top variants, and for other genes top variants carry more functional impact — although neither of these patterns is statistically significant genome-wide after multiple testing correction using the BH procedure. For example, for raw CADD scores, out of the 9, 874 genes for which the top and the stable variants do not match, 4, 906 genes have higher scoring stable variants than top variants, whereas 4, 968 genes have higher scoring top variants than stable variants (<xref rid="fig5" ref-type="fig">Figure 5A</xref>). Looking at the accompanying PHRED-scaled CADD scores (CADD PHRED) for Potential Set 1, when applying a sliding cutoff threshold for calling variant deleteriousness, we find that even though a higher fraction of genes have top but not stable variant classified as deleterious, the difference is usually not significant (<xref rid="fig5" ref-type="fig">Figure 5B</xref>). <xref rid="fig5" ref-type="fig">Figure 5B</xref> also demonstrates that no matter how the cutoff is chosen, there are genes for which the top variant is not classified deleterious while the stable variant is. Taken together, these observations suggest that the stability-guided approach can sometimes be more useful at identifying variants of functional significance, and in a broad sense both fine-mapped variants should be equally prioritized for potential of carrying functional impact.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><p><bold>A</bold>. Paired scatterplot of raw CADD scores of both top and stable variant for each gene, for Potential Set 1. <bold>B</bold>. Percent of genes that are classified as (i) having deleterious top variant only, (ii) having deleterious stable variant only, and (iii) having both top and stable variant deleterious, using a sliding cutoff threshold ranging from 10 to 20 as recommended by CADD authors.</p></caption>
<graphic xlink:href="536456v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Because our comparison between the top and stable variants yielded no significant functional enrichment of one over the other, we investigate whether external factors — for example, the posterior probability of the variants — might moderate the relative enrichment of one variant over the other (i.e., we perform <italic>trend analysis</italic> — see Section for a list of all moderators). Here, we find that all but one of the moderators considered — namely, the Posterior Probability of Top Variant (see <xref rid="tbl2" ref-type="table">Table 2</xref>) — did not produce any significant trends for Potential Set 1. There is a small but significant positive correlation (Pearson’s <italic>r</italic> = 0.05) between the posterior probability of the top variant and the difference between the stable variant and top variant FIRE scores (<xref ref-type="bibr" rid="c29">Ioannidis et al., 2017</xref>), and a small but significant negative correlation (Pearson’s <italic>r</italic> = −0.07) between the posterior probability of the top variant and the difference between the stable variant and top variant Absolute Distance to Canonical TSS. (Details are reported in Supplementary File 1 Section S8.)</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
    <caption><title>List of 6 moderating factors considered.</title>
    </caption>
<graphic xlink:href="536456v2_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<sec id="s2h1">
<title>Additional comparisons</title>
<p>We perform various <italic>conditional analyses</italic> to evaluate whether additional restrictions to characteristics of fine-mapping outputs may boost the power of either approach over the other. Such characteristics include (i) the positive posterior probability support (i.e., how many variants reported a positive posterior probability from fine-mapping), and (ii) the posterior probability of the top or stable variant. Results from our conditional analysis of (i) are reported in Supplementary File 1 Section S9. As an example, for (ii) we further perform a comparison between top and stable variants, by restricting to genes where the posterior probability of the top variant or the stable variant exceeds 0.9. Such restriction of valid fine-mapped variant-gene pairs is useful in training variant effect prediction models requiring reliable positive and negative examples, as seen in <xref ref-type="bibr" rid="c57">Wang et al. (2021</xref>). We find that for genes where the top variant posterior probability exceeds 0.9, there is no significant enrichment of the top variant over the stable variant across the 378 annotations considered (all BH-adjusted <italic>p</italic>-values exceed 0.05). Interestingly, when focusing on genes where the stable variant posterior probability exceeds 0.9, FIRE scores of the top variant are significantly larger than the stable variant (BH-adjusted <italic>p</italic>-value = 1 × 10<sup>−6</sup>). Detailed results are reported in Supplementary File 1 Section S10.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>We have shown that a stability-guided approach complements existing approaches to detect biologically meaningful variants in genetic fine-mapping. Through various statistical comparisons, we have found that prioritizing the agreement between existing approaches and a stability-guided approach enhances the functional impact of the fine-mapped variant. Incorporating stability into fine-mapping also provides an adjuvant approach that helps discover variants of potential functional impact in case standard approaches fail to pick up variants of functional significance. Our findings are consistent with earlier reports of stable discoveries having the tendency to capture actual physical or mechanistic relationships, potentially making such discoveries generalizable or portable (<xref ref-type="bibr" rid="c7">Basu et al., 2018</xref>).</p>
<p>The link between stability and generalizability is not new. In the machine learning and statistics literature, it has been shown that stable algorithms provably lead to generalization errors that are well-controlled (<xref ref-type="bibr" rid="c10">Bousquet and Elisseeff, 2002</xref>, Theorem 17, p. 510). Furthermore, in certain classes of algorithms (e.g., sparse regression), it has been demonstrated empirically that this mathematical relationship is explained precisely by the stable algorithm removing spurious discoveries (<xref ref-type="bibr" rid="c38">Lim and Yu, 2016</xref>).</p>
<p>The stability-guided approach is also distinct from other subsampling approaches, such as the bootstrap (<xref ref-type="bibr" rid="c17">Efron and Tibshirani, 1994</xref>). First, the bootstrap is more often deployed as a method for calibrating uncertainty surrounding a prediction, which is not the objective of our method. Next, in settings where the bootstrap is deployed as a type of perturbation against which a prediction or estimand is expected to be stable (<xref ref-type="bibr" rid="c7">Basu et al., 2018</xref>), a stability threshold is implicitly needed and would require tuning to be chosen (e.g., in <xref ref-type="bibr" rid="c7">Basu et al., 2018</xref> this threshold was chosen to be 50%). Here, we leverage interpretable existing external annotations to define the perturbation against which we expect the fine-mapped variant to be stable — in other words, the user relates what is meant by the fine-mapped variant being stable to a biologically meaningful concept like “portable across environmentally and LD pattern-wise heterogeneous populations.”</p>
<p>The last sentence in the preceding paragraph suggests there are teleological similarities between the stability-guided approach and meta-analysis approaches (<xref ref-type="bibr" rid="c55">Turley et al., 2021</xref>). We emphasize that meta-analyses rely on already analyzed cohorts, thereby implicitly assuming that <italic>within-cohort</italic> heterogeneities have been sufficiently accounted for prior to the reporting of findings for that cohort. The stability-guided approach, however, is relevant to the <italic>cohort-specific analysis itself</italic>, where existing approaches may present methodological insufficiencies resulting in inflated false discoveries. In other words, whereas the goal of meta-analysis may be stated as identifying consistent hits across cohorts while also assuming that findings specific to each cohort are reliable, the goal of a stability-guided approach is to search for consistent signals despite the presence of potential confounders within a single cohort. Our analysis has focused on comparing the stability-guided approach against residualization, a convenient and popular approach to account for population structure, which reflects this difference in purpose.</p>
<p>Related to the previous point, while revising our work we came across a few recent papers that developed multi-ancestry fine-mapping algorithms to investigate causal variant heterogeneity across ancestries. <xref ref-type="bibr" rid="c21">Gao and Zhou (2024</xref>) and <xref ref-type="bibr" rid="c63">Yuan et al. (2024</xref>) found that complex traits have both shared and non-negligible ancestry-specific causal signals, although the proportion of trait-specific causal variants that are ancestry-specific is probably low (<xref ref-type="bibr" rid="c26">Hu et al., 2025</xref>; <xref ref-type="bibr" rid="c53">Shi et al., 2021</xref>). On the other hand, for molecular quantitative traits, which include RNA sequencing reads that we have studied in this work, <xref ref-type="bibr" rid="c41">Lu et al. (2025</xref>) reported highly correlated effect sizes in <italic>cis</italic> QTLs across ancestries, with effect heterogeneity concentrated at predicted loss-of-function-intolerant genes. These findings are all consistent with our goal of leveraging stability guidance to identify generalizable causal signals, and also imply that stability guidance would be particularly useful for molecular quantitative trait fine-mapping.</p>
<p>There are several limitations to our present work. First, we have chosen to focus on a non-parametric approach to fine-mapping, but multiple parametric fine-mapping approaches have been extended to incorporate cross-population heterogeneity (e.g., <xref ref-type="bibr" rid="c59">Wen et al., 2015</xref>; <xref ref-type="bibr" rid="c34">LaPierre et al., 2021</xref>; <xref ref-type="bibr" rid="c40">Lu et al., 2022</xref>). While our present work is a proof-of-concept of the applicability of the stability to genetic fine-mapping, we believe that future work focusing on comparing functional impact of variants prioritized by our stability-driven approach or these parametric methods will shed more light on the efficacy of the stability principle at detecting generalizable biological signals. Our results for SuSiE on simulated gene expression data are promising in this regard. Second, our analyses assume that there is at most one <italic>cis</italic> eQTL prioritized by each potential set of PICS. This is owing to the implicit assumption that all other variants in high LD with the causal variant are simply tagging it, though we acknowledge the possibility of relaxing this assumption. Understanding the impact of this relaxation requires extensive investigation, hence we defer it to future work. Third, while we have relied on numerous computational and experimental annotations to evaluate the functional impact of our fine-mapped variants, some computational variant effect predictors may themselves be biased owing to the lack of ancestral diversity of training data. Recent work has found that deep learning-based gene expression predictors — despite outperforming traditional statistical models at inferring regulatory tracks — explain surprisingly little of gene expression variation across ancestries (<xref ref-type="bibr" rid="c27">Huang et al., 2023</xref>) and yield limited power at predicting individual gene expression levels more broadly (<xref ref-type="bibr" rid="c51">Sasse et al., 2023</xref>). While this complicates the use of such predictors in their present form as strong evidence of functional impact, it is more constructive to understand their shortcomings and develop strategies to fine-tune their predictions for future use as trustworthy functional impact metrics — an emerging desideratum in the era of computational biomedicine (<xref ref-type="bibr" rid="c31">Katsonis et al., 2022</xref>; <xref ref-type="bibr" rid="c6">Barbadilla-Martínez et al., 2025</xref>; <xref ref-type="bibr" rid="c8">Benegas et al., 2025</xref>; <xref ref-type="bibr" rid="c39">Livesey et al., 2025</xref>).</p>
<p>In closing, while our work explores stability to subpopulation perturbations where subpopulations are defined by ancestry, we emphasize that our stability-guided slicing methodology is applicable to all settings where meaningful external labels are available to the data analyst. For instance, environmental or geographical variables, which are well-recognized determinants of some health outcomes (<xref ref-type="bibr" rid="c19">Favé et al., 2018</xref>; <xref ref-type="bibr" rid="c2">Abdellaoui et al., 2022</xref>) and arguably better measure potential confounders than ancestry labels, can be the basis on which slices are defined in the stability-guided approach. As the barriers to access larger biobank-scale datasets, which contain such aforementioned variables, continue to be lowered, we expect stability-driven analyses conducted on such data and relying on carefully defined slices will help users better understand genetic drivers of complex traits. Given its utility in our present work, we believe that the stability approach in precision medicine may find uses beyond genetic fine-mapping and few other biological tasks previously studied, ultimately empowering the discovery of veridical effects not previously known.</p>
</sec>
<sec id="s4">
<title>Materials and Methods</title>
    <p>We use publicly available GEUVADIS B-lymphocyte RNA-seq measurements from 445 individuals (<xref ref-type="bibr" rid="c35">Lappalainen et al., 2013</xref>), whose genotypes are also available from the 1000 Genomes Project (<xref ref-type="bibr" rid="c1">1000 Genomes Project Consortium et al., 2015</xref>). The 445 individuals come from five populations: Tuscany Italian (TSI, <italic>N</italic> = 91), Great British (GBR, <italic>N</italic> = 86), Finnish (FIN, <italic>N</italic> = 92), Utah White American (CEU, <italic>N</italic> = 89) and Yoruban (YRI, <italic>N</italic> = 87). The mRNA measurements are normalized for library depth, expression frequency across individuals as well as PEER factors, as reported in the <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/files/E-GEUV-1/E-GEUV-1/analysis_results/GeuvadisRNASeqAnalysisFiles_README.txt">GEU-VADIS databank</ext-link>. Of the available normalized gene expression phenotypes, only those with non-empty sets of variants lying within 1Mb upstream or downstream of the canonical transcription start site were kept for (<italic>cis</italic>) fine-mapping. This process yielded 22, 664 genes used in all subsequent analyses involving the PICS fine-mapping algorithm.</p>
<sec id="s4a">
<title>Probabilistic Identification of Causal SNPs</title>
<p>We implement Probabilistic Identification of Causal SNPs (PICS) (<xref ref-type="bibr" rid="c18">Farh et al., 2015</xref>), which is based on an earlier genome-wide analysis identifying genetic and epigenetic maps of causal autoimmune disease variants (<xref ref-type="bibr" rid="c18">Farh et al., 2015</xref>).</p>
<p>We assume that <bold>X</bold> and <bold>y</bold> are the <italic>N</italic> × <italic>P</italic> locus haplotype (or genotype) matrix and the <italic>N</italic> × 1 vector of phenotype values respectively, with <bold>y</bold> possibly already adjusted by relevant covariates. For consistency of exposition, let the SNPs be named <italic>A</italic><sub>1</sub>,…, <italic>A</italic><sub><italic>P</italic></sub>. Recall the goal of fine-mapping is to return information about which SNP(s) in the set {<italic>A</italic><sub>1</sub>,…, <italic>A</italic><sub><italic>P</italic></sub>} is (are) causal, given the input pair {<bold>X, y</bold>} and possibly other external information such as functional annotations or, more generally, prior biological knowledge.</p>
<sec id="s4a1">
<title>Overview</title>
<p>Probabilistic Identification of Causal SNPs (PICS) is a Bayesian, non-parametric approach to fine-mapping. Given the observed patterns of association at a locus, and furthermore not assuming a parametric model relating the causal variants to the trait itself, one can estimate the probability that any SNP is causal by performing permutations that preserve its marginal association with the trait as well as the LD patterns at the locus.</p>
<p>To see how this is accomplished, suppose that <italic>A</italic><sub>1</sub> is the lead SNP. We are interested in <inline-formula id="inline-eqn-1"><inline-graphic xlink:href="536456v2_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, the probability that <italic>A</italic><sub><italic>i</italic></sub>is causal, for each <italic>i ∈</italic> [<italic>P</italic> ]. By Bayes’ theorem,
<disp-formula id="eqn1">
<graphic xlink:href="536456v2_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Focusing on the focal SNP <italic>i</italic>, permute the rows of <bold>X</bold> such that the association between the focal SNP and the trait <bold>y</bold> is invariant; see Supplementary File 1 Section S1 for a concrete mathematical description of this set of constrained permutations. Then the first term on RHS of <xref ref-type="disp-formula" rid="eqn1">eq. (1)</xref>, <inline-formula id="inline-eqn-2"><inline-graphic xlink:href="536456v2_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, is estimated by the proportion of all permutations where <italic>A</italic><sub>1</sub> emerges as the lead SNP. The second term, <inline-formula id="inline-eqn-3"><inline-graphic xlink:href="536456v2_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, is the prior probability of the focal SNP being causal, which the user can choose based on prior knowledge. The default setting in PICS is <inline-formula id="inline-eqn-4"><inline-graphic xlink:href="536456v2_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. <xref rid="fig6" ref-type="fig">Figure 6</xref> provides a visual summary of the method.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
    <caption><title>Visual summary of the PICS algorithm described in Probabilistic Identification of Causal SNPs.</title>
        <p><bold>A</bold>. Breakdown of the calculation of the probability of a focal SNP <italic>A</italic><sub><italic>i</italic></sub> being causal. <bold>B</bold>. Illustration of the permutation procedure used to generate the null distribution. An example <italic>N</italic> × <italic>P</italic> genotype array with <italic>N</italic> = <italic>P</italic> = 6 is used, with two valid row shuffles, or permutations, of the original array shown. Entries affected by the shuffle are highlighted, as is the focal SNP (<italic>A</italic><sub>3</sub>).</p></caption>
<graphic xlink:href="536456v2_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>By running the permutation procedure across all SNPs in the locus, one obtains <inline-formula id="inline-eqn-5"><inline-graphic xlink:href="536456v2_inline5.gif" mimetype="image" mime-subtype="gif"/></inline-formula> <sub>for each <italic>i</italic>. These posterior probabilities are then normalized so that <inline-formula id="inline-eqn-6"><inline-graphic xlink:href="536456v2_inline6.gif" mimetype="image" mime-subtype="gif"/></inline-formula>.</sub></p>
<p>Finally, the above procedure is performed after restricting the set of all SNPs to only those with correlation magnitude |<italic>r</italic>| <italic>&gt;</italic> 0.5 to the lead SNP.</p>
</sec>
<sec id="s4a2">
<title>Algorithm</title>
<p>Based on the computation of posterior probabilities described above (<xref ref-type="disp-formula" rid="eqn1">eq. (1)</xref>), the full PICS algorithm returns putatively causal variants as follows.</p>
<p>The last line of <xref ref-type="statement" rid="alg1">Algorithm 1</xref> returns a list of posterior probability vectors corresponding to each potential set. For our work, we set |<italic>r</italic>| = 0.5, <italic>C</italic> = 3, <italic>R</italic> = 500 and <bold>p</bold><sub>0</sub> = (1/<italic>P</italic>, …, 1/<italic>P</italic>) throughout implementations of <xref ref-type="statement" rid="alg1">Algorithm 1</xref>.</p>
<statement id="alg1">
<label>Algorithm 1</label>
<title>PICS</title>
<p><fig id="alg1a" position="float" fig-type="figure">
<graphic xlink:href="536456v2_alg1.tif" mimetype="image" mime-subtype="tiff"/>
</fig></p>
</statement>
<p>As mentioned in the Introduction, we apply two different approaches to implementing <xref ref-type="statement" rid="alg1">Algorithm 1</xref>. One is guided by stability and will be introduced shortly in Incorporating Stability. The other, which we now describe, is based on regressing out confounders, i.e., residualization. In implementing the residualization approach, we regress the top five principal components, obtained from the genotype matrix <bold>X</bold>, from the gene expression phenotype, <bold>y</bold>. We choose five principal components based on the elbow method, an approach described in <xref ref-type="bibr" rid="c11">Brown et al. (2018</xref>). This yields residuals <bold>y</bold><sup><italic>r</italic></sup>(<xref rid="fig1" ref-type="fig">Figure 1A</xref>), which we use as the input phenotype array in <xref ref-type="statement" rid="alg1">Algorithm 1</xref>. We subsequently report the variant with highest posterior probability in each potential set as the putatively causal variant for that potential set. This variant is referred to as the top variant.</p>
<p>We remark that there are other ways of using potential confounders in variable selection, such as inclusion as covariates in a linear model. Because our algorithm explicitly avoids assuming a linear model, we have chosen the residualization approach just described.</p>
</sec></sec>
<sec id="s4b">
<title>Incorporating Stability</title>
<p>Our stability-guided approach to implementing PICS follows the steps outlined below. Let (<bold>X, y</bold>) be the genotype array and gene expression array. Assume that there are <italic>K</italic> subpopulations making up the dataset, and let <italic>E</italic><sub><italic>k</italic></sub> denote the set of row indices of <bold>X</bold> corresponding to individuals from subpopulation <italic>k</italic>. (In our present work, <italic>K</italic> = 5. The five subpopulations are Utahns (<italic>N</italic><sub>CEU</sub> = 89), Finns (<italic>N</italic><sub>FIN</sub> = 92), British (<italic>N</italic><sub>GBR</sub> = 86), Toscani (<italic>N</italic><sub>TSI</sub> = 91) and Yoruban (<italic>N</italic><sub>YRI</sub> = 87).)</p>
<list list-type="order">
<list-item><p>Run <xref ref-type="statement" rid="alg1">Algorithm 1</xref> on the pair (<bold>X, y</bold>). Obtain list of posterior probability vectors, <inline-formula id="inline-eqn-7"><inline-graphic xlink:href="536456v2_inline7.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. Recall that <italic>C</italic> is the number of potential sets.</p></list-item>
<list-item><p>For each subpopulation <italic>k</italic> = 1,…, <italic>K</italic>, run <xref ref-type="statement" rid="alg1">Algorithm 1</xref> on the pair <inline-formula id="inline-eqn-8"><inline-graphic xlink:href="536456v2_inline8.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. Obtain <inline-formula id="inline-eqn-9"><inline-graphic xlink:href="536456v2_inline9.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for each <italic>k</italic>.</p></list-item>
<list-item><p>(Stability-guided choice of putatively causal variants) Collect the probability vectors in lists ℒ and <inline-formula id="inline-eqn-10"><inline-graphic xlink:href="536456v2_inline10.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. Operationalizing the principle that a stable variant has positive probability across multiple slices, we pick causal variants as follows. For potential set <italic>c</italic>, pick the variants that have (i) positive probability in <inline-formula id="inline-eqn-11"><inline-graphic xlink:href="536456v2_inline11.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in Step 1, and moreover (ii) have positive probability in the most number of probability vectors; call this set of variants 𝒮<sub><italic>c</italic></sub>(note 𝒮<sub><italic>c</italic></sub>is a subset of the support of <inline-formula id="inline-eqn-12"><inline-graphic xlink:href="536456v2_inline12.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for Potential Set <italic>c</italic>). Among members of 𝒮<sub><italic>c</italic></sub>, select the variant that had the highest posterior probability in <inline-formula id="inline-eqn-13"><inline-graphic xlink:href="536456v2_inline13.gif" mimetype="image" mime-subtype="gif"/></inline-formula>.</p></list-item>
</list>
<p>In other words, the stability-guided approach reports the variant that not only appears with positive probability in the most number of subsets including the pooled sample, but also has the largest probability in the pooled sample. This variant is referred to as the stable variant.</p>
<p>To illustrate the last step, suppose there are <italic>K</italic> = 2 subpopulations, <italic>C</italic> = 1 potential set, and <italic>P</italic> = 5 SNPs. Let the outputs from Steps 1 and 2 be
<disp-formula id="ueqn1">
<graphic xlink:href="536456v2_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
In this example, the second and fourth variants have positive probability in the most number of probability vectors (𝒮<sub>1</sub> = {<italic>A</italic><sub>2</sub>, <italic>A</italic><sub>4</sub>}). Among <italic>A</italic><sub>2</sub> and <italic>A</italic><sub>4</sub>, <italic>A</italic><sub>2</sub> has a higher posterior probability (i.e., 0.43) in <inline-formula id="inline-eqn-14"><inline-graphic xlink:href="536456v2_inline14.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, so the stable variant reported is <italic>A</italic><sub>2</sub>. As a side remark, the posterior probability vector ℒ does not generally agree with the posterior probability vector computed using the residualization approach, because the latter is computed by running <xref ref-type="statement" rid="alg1">Algorithm 1</xref> on the pair (<bold>X, y</bold><sup><italic>r</italic></sup>) rather than (<bold>X, y</bold>), as described earlier.</p>
<sec id="s4b1">
<title>Stability-guided SuSiE</title>
<p>We apply the stability principle to SuSiE (<xref ref-type="bibr" rid="c56">Wang et al., 2020</xref>) in a similar manner as described above. Concretely, we run SuSiE on the pair (<bold>X, y</bold>), before running it again on each subpopulation <italic>k</italic> = 1,…, <italic>K</italic>. Collecting the posterior inclusion probability (PIP) vectors across each subpopulation and the entire sample, we then keep only variants that have posterior probability at least 1/(no. variants included), owing to SuSiE tending to return nonzero probabilities to all variants included in the fine-mapping. These “good” variants (i.e., variants with PIP at least as large as the prior inclusion probability) are analogous to the “variants with positive probability” in PICS. The remaining steps are identical to stability-guided PICS.</p>
</sec>
</sec>
<sec id="s4c">
<title>Simulation Study and Evaluation Details</title>
<sec id="s4c1">
<title>Main Simulation Study</title>
<p>We simulate 2, 400 synthetic gene expression data, which vary by two parameters: <italic>C</italic>, the number of causal variants, and <italic>ϕ</italic>, the proportion of variance in <bold>y</bold> explained by the genotypes <bold>X</bold>. Phenotypes are simulated as follows.</p>
<list list-type="order">
<list-item><p>For a gene, whenever its canonical transcription start site (TSS) is available, restrict the genotype matrix <bold>X</bold> to only variants lying within 1Mb upstream and downstream. Else, use variants spanning the entire autosome associated with that gene. This ensures that <italic>cis</italic> eQTLs are used in simulation, for the most part.</p></list-item>
<list-item><p>Sample the indices of the <italic>C</italic> causal variants, 𝒞, uniformly at random from {1, …, <italic>p</italic>}, where <italic>p</italic> is the number of variants included in <bold>X</bold> from Step 1.</p></list-item>
<list-item><p>For each <italic>j ∈</italic> 𝒞, independently draw <italic>b</italic><sub><italic>j</italic></sub> ∼ <italic>N</italic>(0, 0.6<sup>2</sup>) and, for all <italic>j</italic> ∉ 𝒞, set <italic>b</italic><sub><italic>j</italic></sub> = 0.</p></list-item>
<list-item><p>Set <italic>σ</italic><sup>2</sup>to achieve the desired proportion of variance explained <italic>ϕ</italic>.</p></list-item>
<list-item><p>Generate the phenotype by drawing <bold>y</bold> ∼ <italic>N</italic>(<bold>Xb</bold>, <italic>σ</italic><sup>2</sup><bold>I</bold><sub><italic>n</italic>×<italic>n</italic></sub>).</p></list-item>
</list>
<p>After gene expression data were simulated, we ran three versions of PICS: the stability-guided version, the residualization version, and an uncorrected version, where no correction for population stratification or stability guidance was applied. To investigate the broader applicability of the stability approach, we also ran two versions of SuSiE (<xref ref-type="bibr" rid="c56">Wang et al., 2020</xref>), a popular fine-mapping method relying on variational approximation techniques. The first version runs SuSiE on residualized phenotypes, while the second version incorporates stability in selecting the most likely causal variant(s). In both approaches, we rely on default parameters of SuSiE while setting the number of credible sets to return to 3 (i.e., <monospace>L=3</monospace> in <monospace>susieR::susie</monospace>).</p>
</sec>
<sec id="s4c2">
<title>Smaller Simulation Study</title>
<p>To investigate whether non-genetic confounding between ancestries in a multi-ancestry cohort can hinder the performance of fine-mapping algorithms that do not correct for potential confounding by ancestry, we simulate a smaller set of synthetic gene expression data. We select 10 genes from Chromosomes 1, 20, 21 and 22, and repeated the simulation steps as described above, up to Step 4. At Step 4, instead of choosing a single <italic>σ</italic><sup>2</sup>, we allow <italic>σ</italic><sup>2</sup>to depend on the ancestry of the individual in order to capture environmental heterogeneity. We specifically consider six scenarios that we classify as (environmental) variance heterogeneity and mean heterogeneity.</p>
<list list-type="bullet">
<list-item><p><italic>Variance heterogeneity</italic>. Let <bold><italic>α</italic></bold>(<italic>t</italic>) = (<italic>α</italic><sub>TSI</sub>(<italic>t</italic>), <italic>α</italic><sub>GBR</sub>(<italic>t</italic>), <italic>α</italic><sub>FIN</sub>(<italic>t</italic>), <italic>α</italic><sub>CEU</sub>(<italic>t</italic>), <italic>α</italic><sub>YRI</sub>(<italic>t</italic>)) be a vector of exponentiated proportions, where we define the exponentiated proportion of a subpopulation POP (POP <italic>∈</italic> {TSI, FIN, GBR, CEU, YRI})as <inline-formula id="inline-eqn-15"><inline-graphic xlink:href="536456v2_inline15.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. In Step 4, we define a vector of ancestry-specific exogenous variances, <bold><italic>σ</italic></bold><sup><bold>2</bold></sup>(<italic>t</italic>) = 5<italic>σ</italic><sup>2</sup><bold><italic>α</italic></bold>(<italic>t</italic>), where <italic>σ</italic><sup>2</sup>is calculated as in Step 4 of the original simulation setup. We then generate phenotypes independently in Step 5 by conditioning on the individual’s population membership (POP): <italic>y</italic><sub><italic>i</italic></sub> ∼ <italic>N</italic>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub><bold>b, <italic>σ</italic></bold><sup><bold>2</bold></sup>(<italic>t</italic>)(<italic>k</italic>)), where <italic>k</italic> is the index that corresponds to the population membership of individual <italic>i</italic> and <bold><italic>x</italic></bold><sub><italic>i</italic></sub> denotes the genotypes of individual <italic>i</italic>. For example, if <italic>t</italic> = 0, <bold><italic>α</italic></bold>(<italic>t</italic>) = <bold><italic>α</italic></bold>(0) = (1/5, 1/5, 1/5, 1/5, 1/5) and <bold><italic>σ</italic></bold><sup><bold>2</bold></sup>(<italic>t</italic>) = (<italic>σ</italic><sup>2</sup>, <italic>σ</italic><sup>2</sup>, <italic>σ</italic><sup>2</sup>, <italic>σ</italic><sup>2</sup>, <italic>σ</italic><sup>2</sup>), which reduces to our original simulation setup. The choice of <italic>t &gt;</italic> 0 determines the heterogeneity of the exogenous variance among the subpopulations, with a larger <italic>t</italic> producing higher heterogeneity. Here, we consider four choices of <italic>t</italic>: 8, 16, 128, and 256.</p></list-item>
<list-item><p><italic>Mean heterogeneity</italic>. Step 5 of the original simulation setup is modified to include an ancestry-dependent mean vector. We arbitrarily let GBR be the “focal” population, and generate phenotypes in two ways.</p>
<list list-type="bullet">
<list-item><p>“Smooth mean”: After <italic>σ</italic><sup>2</sup>is calculated in Step 4 of the original simulation setup, define the mean exogenous noise vector as <bold><italic>μ</italic></bold> = (<italic>μ</italic><sub>TSI</sub>, <italic>μ</italic><sub>GBR</sub>, <italic>μ</italic><sub>FIN</sub>, <italic>μ</italic><sub>CEU</sub>, <italic>μ</italic><sub>YRI</sub>) = (2<italic>σ</italic>, 0, <italic>σ, σ</italic>, 2<italic>σ</italic>). An individual <italic>i</italic> has their phenotype simulated as <italic>y</italic><sub><italic>i</italic></sub> ∼ <italic>N</italic>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub><bold>b</bold> + <bold><italic>μ</italic></bold>(<italic>k</italic>), <italic>σ</italic><sup>2</sup>), where again <italic>k</italic> is the index that corresponds to the population membership of individual <italic>i</italic>. This effectively increases the gene expression of all but GBR individuals in a positive direction with varying amounts of shift.</p></list-item>
<list-item><p>“Spiked mean”: After <italic>σ</italic><sup>2</sup>is calculated in Step 4 of the original simulation setup, define <bold><italic>μ</italic></bold> = (0, 2<italic>σ</italic>, 0, 0, 0) and simulate individual <italic>i</italic>’s phenotype as <italic>y</italic><sub><italic>i</italic></sub> ∼ <italic>N</italic>(<bold><italic>x</italic></bold><sub><italic>i</italic></sub><bold>b</bold> + <bold><italic>μ</italic></bold>(<italic>k</italic>), <italic>σ</italic><sup>2</sup>). This effectively increases the gene expression of GBR individuals only in a positive direction, while the other subpopulation individuals share the same zero mean (as in the original simulation setup).</p></list-item>
</list></list-item></list>
<p>For brevity, we refer to these six scenarios by t=8, t=16, t=128, t=256, |i-3| and i=3.</p>
</sec>
<sec id="s4c3">
<title>Evaluation</title>
<p>Several metrics have been used to evaluate Bayesian fine-mapping algorithms (see e.g., <xref ref-type="bibr" rid="c13">Cui et al., 2024</xref>; <xref ref-type="bibr" rid="c61">Yang et al., 2023</xref>; <xref ref-type="bibr" rid="c56">Wang et al., 2020</xref>; <xref ref-type="bibr" rid="c9">Benner et al., 2016</xref>; <xref ref-type="bibr" rid="c58">Wen et al., 2016</xref>; <xref ref-type="bibr" rid="c25">Hormozdiari et al., 2015</xref>), many of which compute credible sets and analyze their coverage. A challenge in using credible sets for our study is that the posterior probabilities returned by the PICS algorithm are not posterior inclusion probabilities in a strict sense: they do not measure the frequency with which a variant should be included in a <italic>linear model</italic> (cf. <xref ref-type="bibr" rid="c23">Griffin and Steel, 2021</xref>; note PICS does not assume a model relating features to outcome). This complicates defining credible sets and coverage, so we follow <xref ref-type="bibr" rid="c43">Mazumder (2020</xref>) instead and evaluate performance of all algorithms by computing the signal recovery probability as a function of the signal to background noise (SNR). By the definition of <italic>ϕ</italic> (see <xref ref-type="bibr" rid="c56">Wang et al., 2020</xref> for details), we may compute SNR directly from <italic>ϕ</italic> as SNR = <italic>ϕ</italic>/(1 − <italic>ϕ</italic>).</p>
</sec>
</sec>
<sec id="s4d">
<title>Statistical Comparison Methodology</title>
<p>We rely on 378 external functional annotations to interpret biological significance of our variants, summarized in <xref rid="tbl1" ref-type="table">Table 1</xref>. Supplementary File 1 Section S5 provides interpretation for the functional annotations, while Supplementary File 1 Section S6 describes in greater detail how we generate annotations from Enformer predictions.</p>
<p>Our comparison of the top and stable variants is two-fold. First, we evaluate the relative significance of the stable variant against the top variant, by running paired Wilcoxon two-sample tests across all pairs of top and stable variants across all GEUVADIS gene expression phenotypes. We compute one-directional <italic>p</italic>-values in either direction to check for significant depletion or enrichment of the stable variant with respect to a particular annotation. Raw <italic>p</italic>-values are adjusted for false discovery rate control by applying the standard Benjamini-Hochberg (BH) procedure (<monospace>R command p.adjust(…,method=‘BH’)</monospace>) to <italic>p</italic>-values across all 378 annotations and all potential sets.</p>
<p>To investigate whether various external factors might moderate the differences in functional annotations, we next perform trend tests. Basically, for some external factor <italic>F</italic>, we run a trend test to see if values of <italic>F</italic> are associated with attenuation or augmentation of differences in functional annotation of the top and stable variants. The list of all external factors <italic>F</italic> is provided in <xref rid="tbl2" ref-type="table">Table 2</xref>.</p>
<p>For (1) Degree of Stability, we perform a Jonckheere-Terpstra test (R command <monospace>clinfun:: jonckheere.test(…,nperm=5000))</monospace>. For (2) Population Diversity, (3) Population Differentiation and (6) Degree of Certainty of Causality Using Residualization Approach, we perform a correlation test (R command <monospace>cor.test(…))</monospace>. For (4) Inclusion of Distal Subpopulations (Top) and (5) Inclusion of Distal Subpopulations (Stable), we perform an unpaired Wilcoxon test (R command <monospace>wilcox.test(…))</monospace>. Finally, for each moderator, we again compute one-directional <italic>p</italic>-values in either direction, before applying the BH procedure to all <italic>p</italic>-values across annotations and potential sets for that moderator only.</p>
</sec>
</sec>
</body>
<back>
<sec sec-type="supplementary" id="supplementary34">
<fig id="fig2_S1" position="float" fig-type="figure">
<label>Figure 2—figure supplement 1.</label>
    <caption><title>Frequency with which at least one causal variant is recovered in Potential Sets 2 and 3 by Plain PICS and Stable PICS, across 1, 440 simulated gene expression phenotypes.</title>
        <p>Recovery frequencies are stratified by simulations differing in the number of causal variants, but Venn diagrams report the number of matching and non-matching variants across all simulations.</p></caption>
<graphic xlink:href="536456v2_fig2_S1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S2" position="float" fig-type="figure">
<label>Figure 2—figure supplement 2.</label>
    <caption><title>Frequency with which at least one causal variant is recovered in Potential Sets 2 and 3 by Combined PICS, Stable PICS and Top PICS, across 2, 400 simulated gene expression phenotypes.</title>
        <p>Recovery frequencies are stratified by simulations differing in the signal-to-noise ratio (SNR) parameter <italic>ϕ</italic>, but Venn diagrams report the number of matching and non-matching variants across all simulations.</p></caption>
<graphic xlink:href="536456v2_fig2_S2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S3" position="float" fig-type="figure">
<label>Figure 2—figure supplement 3.</label>
    <caption><title>Frequency with which at least one causal variant is recovered in Potential Sets 2 and 3 by Stable SuSiE and Top SuSiE, across 2, 400 simulated gene expression phenotypes.</title>
        <p>Recovery frequencies are stratified by simulations differing in the signal-to-noise ratio (SNR) parameter <italic>ϕ</italic>, but Venn diagrams report the number of matching and non-matching variants across all simulations.</p></caption>
<graphic xlink:href="536456v2_fig2_S3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S4" position="float" fig-type="figure">
<label>Figure 2—figure supplement 4.</label>
    <caption><title>Frequencies with which matching and non-matching variants in the credible or potential set recover a causal variant, obtained from comparing top and stable approaches to an algorithm.</title>
        <p>Analysis is performed over 2, 400 simulated gene expression phenotypes, and recovery frequencies are stratified by simulations differing in the signal-to-noise ratio (SNR) parameter <italic>ϕ</italic>. <bold>A</bold>. Credible or Potential Set 2. <bold>B</bold>. Credible or Potential Set 3.</p></caption>
<graphic xlink:href="536456v2_fig2_S4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S5" position="float" fig-type="figure">
<label>Figure 2—figure supplement 5.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0 or 1) recovered by stability-guided algorithms in simulations with one causal variant, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of credible or potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S6" position="float" fig-type="figure">
<label>Figure 2—figure supplement 6.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1 or 2) recovered by stability-guided algorithms in simulations with two causal variants, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of credible or potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S7" position="float" fig-type="figure">
<label>Figure 2—figure supplement 7.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by stability-guided algorithms in simulations with three causal variants, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of credible or potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S8" position="float" fig-type="figure">
<label>Figure 2—figure supplement 8.</label>
    <caption><title>Posterior probabilities of matching top and stable variants across 2, 400 simulated gene expression phenotypes.</title>
        <p>Points are coloured by the number of causal variants, <italic>S ∈</italic> {1, 2, 3}, set in simulations.</p></caption>
<graphic xlink:href="536456v2_fig2_S8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S9" position="float" fig-type="figure">
<label>Figure 2—figure supplement 9.</label>
    <caption><title>Posterior probabilities of non-matching top and stable variants across 2, 400 simulated gene expression phenotypes.</title>
        <p>Points are coloured by the number of causal variants, <italic>S ∈</italic> {1, 2, 3}, set in simulations.</p></caption>
<graphic xlink:href="536456v2_fig2_S9.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S10" position="float" fig-type="figure">
<label>Figure 2—figure supplement 10.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0 or 1) recovered by Stable PICS or Top SuSiE in simulations with one causal variant, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of credible or potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S10.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S11" position="float" fig-type="figure">
<label>Figure 2—figure supplement 11.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1 or 2) recovered by Stable PICS or Top SuSiE in simulations with two causal variants, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of credible or potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S11.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S12" position="float" fig-type="figure">
<label>Figure 2—figure supplement 12.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by Stable PICS or Top SuSiE in simulations with three causal variants, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of credible or potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S12.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S13" position="float" fig-type="figure">
<label>Figure 2—figure supplement 13.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0 or 1) recovered by PICS algorithms in simulations with one causal variant, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S13.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S14" position="float" fig-type="figure">
<label>Figure 2—figure supplement 14.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1 or 2) recovered by PICS algorithms in simulations with two causal variants, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S14.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S15" position="float" fig-type="figure">
<label>Figure 2—figure supplement 15.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by PICS algorithms in simulations with three causal variants, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S15.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S16" position="float" fig-type="figure">
<label>Figure 2—figure supplement 16.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0 or 1) recovered by SuSiE algorithms in simulations with one causal variant, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of credible sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S16.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S17" position="float" fig-type="figure">
<label>Figure 2—figure supplement 17.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1 or 2) recovered by SuSiE algorithms in simulations with two causal variants, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of credible sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S17.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S18" position="float" fig-type="figure">
<label>Figure 2—figure supplement 18.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by SuSiE algorithms in simulations with three causal variants, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of credible sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S18.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S19" position="float" fig-type="figure">
<label>Figure 2—figure supplement 19.</label>
    <caption><title>Frequency with which the causal variant is recovered by a matching variant, non-matching top variant or non-matching stable variant in simulations involving one causal variant.</title>
        <p>Recovery frequencies are stratified by simulations differing in the signal-to-noise ratio (SNR) parameter <italic>ϕ</italic>.</p></caption>
<graphic xlink:href="536456v2_fig2_S19.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S20" position="float" fig-type="figure">
<label>Figure 2—figure supplement 20.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1 or 2) recovered by matching Top and Stable PICS variants, non-matching Top PICS variants and non-matching Stable PICS variants, in simulations involving two causal variants.</title>
        <p>Empirical distributions are stratified by simulations differing in the signal-to-noise ratio (SNR) parameter <italic>ϕ</italic> (increasing SNR from left to right).</p></caption>
<graphic xlink:href="536456v2_fig2_S20.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S21" position="float" fig-type="figure">
<label>Figure 2—figure supplement 21.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1 or 2) recovered by matching Top and Stable SuSiE variants, non-matching Top SuSiE variants and non-matching Stable SuSiE variants, in simulations involving two causal variants.</title>
        <p>Empirical distributions are stratified by simulations differing in the signal-to-noise ratio (SNR) parameter <italic>ϕ</italic> (increasing SNR from left to right).</p></caption>
<graphic xlink:href="536456v2_fig2_S21.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S22" position="float" fig-type="figure">
<label>Figure 2—figure supplement 22.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by matching Top and Stable PICS variants, non-matching Top PICS variants and non-matching Stable PICS variants, in simulations involving three causal variants.</title>
        <p>Empirical distributions are stratified by simulations differing in the signal-to-noise ratio (SNR) parameter <italic>ϕ</italic> (increasing SNR from left to right).</p></caption>
<graphic xlink:href="536456v2_fig2_S22.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S23" position="float" fig-type="figure">
<label>Figure 2—figure supplement 23.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by matching Top and Stable SuSiE variants, non-matching Top SuSiE variants and non-matching Stable SuSiE variants, in simulations involving three causal variants.</title>
        <p>Empirical distributions are stratified by simulations differing in the signal-to-noise ratio (SNR) parameter <italic>ϕ</italic> (increasing SNR from left to right).</p></caption>
<graphic xlink:href="536456v2_fig2_S23.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S24" position="float" fig-type="figure">
<label>Figure 2—figure supplement 24.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0 or 1) recovered by Plain or Stable PICS in simulations with one causal variant and environmental heterogeneity, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S24.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S25" position="float" fig-type="figure">
<label>Figure 2—figure supplement 25.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1 or 2) recovered by Plain or Stable PICS in simulations with two causal variants and environmental heterogeneity, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S25.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S26" position="float" fig-type="figure">
<label>Figure 2—figure supplement 26.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by Plain or Stable PICS in simulations with three causal variants and environmental heterogeneity, stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>The impact of including more number of potential sets on the distribution is shown (increasing number of included sets from top to bottom).</p></caption>
<graphic xlink:href="536456v2_fig2_S26.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S27" position="float" fig-type="figure">
<label>Figure 2—figure supplement 27.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by Plain or Stable PICS in “<italic>t</italic> = 8” simulations involving environmental heterogeneity (variance shift scenario), stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>Each row reports the distribution for simulations with a specific number of causal variants (1, 2 or 3), and we use all three potential sets to compute the number of causal variants recovered in each case.</p></caption>
<graphic xlink:href="536456v2_fig2_S27.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S28" position="float" fig-type="figure">
<label>Figure 2—figure supplement 28.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by Plain or Stable PICS in “<italic>t</italic> = 16” simulations involving environmental heterogeneity (variance shift scenario), stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>Each row reports the distribution for simulations with a specific number of causal variants (1, 2 or 3), and we use all three potential sets to compute the number of causal variants recovered in each case.</p></caption>
<graphic xlink:href="536456v2_fig2_S28.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S29" position="float" fig-type="figure">
<label>Figure 2—figure supplement 29.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by Plain or Stable PICS in “<italic>t</italic> = 128” simulations involving environmental heterogeneity (variance shift scenario), stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>Each row reports the distribution for simulations with a specific number of causal variants (1, 2 or 3), and we use all three potential sets to compute the number of causal variants recovered in each case.</p></caption>
<graphic xlink:href="536456v2_fig2_S29.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S30" position="float" fig-type="figure">
<label>Figure 2—figure supplement 30.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by Plain or Stable PICS in “<italic>t</italic> = 256” simulations involving environmental heterogeneity (variance shift scenario), stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>Each row reports the distribution for simulations with a specific number of causal variants (1, 2 or 3), and we use all three potential sets to compute the number of causal variants recovered in each case.</p></caption>
<graphic xlink:href="536456v2_fig2_S30.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S31" position="float" fig-type="figure">
<label>Figure 2—figure supplement 31.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by Plain or Stable PICS in “|<italic>i</italic>−3|” simulations involving environmental heterogeneity (mean shift scenario), stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>Each row reports the distribution for simulations with a specific number of causal variants (1, 2 or 3), and we use all three potential sets to compute the number of causal variants recovered in each case.</p></caption>
<graphic xlink:href="536456v2_fig2_S31.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2_S32" position="float" fig-type="figure">
<label>Figure 2—figure supplement 32.</label>
    <caption><title>Empirical discrete probability distributions over the number of causal variants (0, 1, 2 or 3) recovered by Plain or Stable PICS in “<italic>i</italic> = 3” simulations involving environmental heterogeneity (mean shift scenario), stratified by the SNR parameter used in simulations (increasing SNR from left to right).</title>
        <p>Each row reports the distribution for simulations with a specific number of causal variants (1, 2 or 3), and we use all three potential sets to compute the number of causal variants recovered in each case.</p></caption>
<graphic xlink:href="536456v2_fig2_S32.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig3_S1" position="float" fig-type="figure">
<label>Figure 3—figure supplement 1.</label>
    <caption><title>Pair density plot of posterior probabilities of the top variant and the stable variant, in case they match.</title>
    </caption>
<graphic xlink:href="536456v2_fig3_S1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig3_S2" position="float" fig-type="figure">
<label>Figure 3—figure supplement 2.</label>
    <caption><title>Pair density plot of posterior probabilities of the top variant and the stable variant, in case they do not match.</title>
    </caption>
<graphic xlink:href="536456v2_fig3_S2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="das" sec-type="data-availability">
<title>Data availability</title>
<p>We provide the following data and scripts on the Github repository <ext-link ext-link-type="uri" xlink:href="https://github.com/songlab-cal/StableFM">https://github.com/songlab-cal/StableFM</ext-link>: fine-mapped variants with their functional annotations and moderator variable quantities, code for reproducing Main Text figures in this manuscript and building our visualization app.</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>This research is supported in part by an NIH grant R35-GM134922 and grant number CZF2019-002449 from the Chan Zuckerberg Initiative Foundation. We thank Carlos Albors, Gonzalo Benegas, Ryan Chung, Ziyue Gao, Iain Mathieson and Yutong Wang for helpful discussions; members of the Yu Group at Berkeley for feedback on the work; and Aniketh Reddy for help with data processing.</p>
</ack>
<sec id="additional-info" sec-type="additional-information">
<title>Additional information</title>
<sec id="s6">
<title>Author Contributions</title>
<p>AJA, NMI, and YSS designed the study. AJA performed data analyses and developed the interactive visualization app. LCJ developed the interactive visualization app. NMI and YSS supervised the research.</p>
</sec>
</sec>
    <sec id="additional-files" sec-type="supplementary-material">
        <title>Additional files</title>
        <supplementary-material id="supp1">
            <label>Supplementary file 1</label>
            <media xlink:href="536456v2_file01.pdf"/>
        </supplementary-material>
        <supplementary-material id="supp2">
            <label>Supplementary file 2</label>
            <media xlink:href="536456v2_file02.pdf"/>
        </supplementary-material>
    </sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>1000 Genomes Project Consortium, et al</collab></person-group>. <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>. <year>2015</year>; <volume>526</volume>(<issue>7571</issue>):<fpage>68</fpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abdellaoui</surname> <given-names>A</given-names></string-name>, <string-name><surname>Dolan</surname> <given-names>CV</given-names></string-name>, <string-name><surname>Verweij</surname> <given-names>KJ</given-names></string-name>, <string-name><surname>Nivard</surname> <given-names>MG</given-names></string-name></person-group>. <article-title>Gene–environment correlations across geographic regions affect genome-wide association studies</article-title>. <source>Nature Genetics</source>. <year>2022</year>; <volume>54</volume>(<issue>9</issue>):<fpage>1345</fpage>–<lpage>1354</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adzhubei</surname> <given-names>IA</given-names></string-name>, <string-name><surname>Schmidt</surname> <given-names>S</given-names></string-name>, <string-name><surname>Peshkin</surname> <given-names>L</given-names></string-name>, <string-name><surname>Ramensky</surname> <given-names>VE</given-names></string-name>, <string-name><surname>Gerasimova</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bork</surname> <given-names>P</given-names></string-name>, <string-name><surname>Kondrashov</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Sunyaev</surname> <given-names>SR</given-names></string-name></person-group>. <article-title>A method and server for predicting damaging missense mutations</article-title>. <source>Nature Methods</source>. <year>2010</year>; <volume>7</volume>(<issue>4</issue>):<fpage>248</fpage>–<lpage>249</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Avsec</surname> <given-names>Ž</given-names></string-name>, <string-name><surname>Agarwal</surname> <given-names>V</given-names></string-name>, <string-name><surname>Visentin</surname> <given-names>D</given-names></string-name>, <string-name><surname>Ledsam</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Grabska-Barwinska</surname> <given-names>A</given-names></string-name>, <string-name><surname>Taylor</surname> <given-names>KR</given-names></string-name>, <string-name><surname>Assael</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Jumper</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kohli</surname> <given-names>P</given-names></string-name>, <string-name><surname>Kelley</surname> <given-names>DR</given-names></string-name></person-group>. <article-title>Effective gene expression prediction from sequence by integrating long-range interactions</article-title>. <source>Nature Methods</source>. <year>2021</year>; <volume>18</volume>(<issue>10</issue>):<fpage>1196</fpage>–<lpage>1203</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Balasubramanian</surname> <given-names>S</given-names></string-name>, <string-name><surname>Fu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Pawashe</surname> <given-names>M</given-names></string-name>, <string-name><surname>McGillivray</surname> <given-names>P</given-names></string-name>, <string-name><surname>Jin</surname> <given-names>M</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Karczewski</surname> <given-names>KJ</given-names></string-name>, <string-name><surname>MacArthur</surname> <given-names>DG</given-names></string-name>, <string-name><surname>Gerstein</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Using ALoFT to determine the impact of putative loss-of-function variants in protein-coding genes</article-title>. <source>Nature Communications</source>. <year>2017</year>; <volume>8</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation></ref>
    <ref id="c6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barbadilla-Martínez</surname> <given-names>L</given-names></string-name>, <string-name><surname>Klaassen</surname> <given-names>N</given-names></string-name>, <string-name><surname>van Steensel</surname> <given-names>B</given-names></string-name>, <string-name><surname>de Ridder</surname> <given-names>J.</given-names></string-name></person-group> <article-title>Predicting gene expression from DNA sequence using deep learning models</article-title>. <source>Nature Reviews Genetics</source>. <year>2025</year>; p. <fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Basu</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kumbier</surname> <given-names>K</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>JB</given-names></string-name>, <string-name><surname>Yu</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Iterative random forests to discover predictive and stable high-order interactions</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2018</year>; <volume>115</volume>(<issue>8</issue>):<fpage>1943</fpage>–<lpage>1948</lpage>.</mixed-citation></ref>
    <ref id="c8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benegas</surname> <given-names>G</given-names></string-name>, <string-name><surname>Ye</surname> <given-names>C</given-names></string-name>, <string-name><surname>Albors</surname> <given-names>C</given-names></string-name>, <string-name><surname>Li</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Song</surname> <given-names>YS</given-names></string-name></person-group>. <article-title>Genomic language models: opportunities and challenges</article-title>. <source>Trends in Genetics</source>. <year>2025</year>;.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benner</surname> <given-names>C</given-names></string-name>, <string-name><surname>Spencer</surname> <given-names>CC</given-names></string-name>, <string-name><surname>Havulinna</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Salomaa</surname> <given-names>V</given-names></string-name>, <string-name><surname>Ripatti</surname> <given-names>S</given-names></string-name>, <string-name><surname>Pirinen</surname> <given-names>M.</given-names></string-name></person-group> <article-title>FINEMAP: efficient variable selection using summary data from genome-wide association studies</article-title>. <source>Bioinformatics</source>. <year>2016</year>; <volume>32</volume>(<issue>10</issue>):<fpage>1493</fpage>–<lpage>1501</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bousquet</surname> <given-names>O</given-names></string-name>, <string-name><surname>Elisseeff</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Stability and generalization</article-title>. <source>The Journal of Machine Learning Research</source>. <year>2002</year>; <volume>2</volume>:<fpage>499</fpage>–<lpage>526</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brown</surname> <given-names>BC</given-names></string-name>, <string-name><surname>Bray</surname> <given-names>NL</given-names></string-name>, <string-name><surname>Pachter</surname> <given-names>L.</given-names></string-name></person-group> <article-title>Expression reflects population structure</article-title>. <source>PLoS Genetics</source>. <year>2018</year>; <volume>14</volume>(<issue>12</issue>):<fpage>e1007841</fpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cavazos</surname> <given-names>TB</given-names></string-name>, <string-name><surname>Witte</surname> <given-names>JS</given-names></string-name></person-group>. <article-title>Inclusion of variants discovered from diverse populations improves polygenic risk score transferability</article-title>. <source>Human Genetics and Genomics Advances</source>. <year>2021</year>; <volume>2</volume>(<issue>1</issue>):<fpage>100017</fpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cui</surname> <given-names>R</given-names></string-name>, <string-name><surname>Elzur</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Kanai</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ulirsch</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Weissbrod</surname> <given-names>O</given-names></string-name>, <string-name><surname>Daly</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Neale</surname> <given-names>BM</given-names></string-name>, <string-name><surname>Fan</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Finucane</surname> <given-names>HK</given-names></string-name></person-group>. <article-title>Improving fine-mapping by modeling infinitesimal effects</article-title>. <source>Nature Genetics</source>. <year>2024</year>; <volume>56</volume>(<issue>1</issue>):<fpage>162</fpage>–<lpage>169</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cunningham</surname> <given-names>F</given-names></string-name>, <string-name><surname>Allen</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Allen</surname> <given-names>J</given-names></string-name>, <string-name><surname>Alvarez-Jarreta</surname> <given-names>J</given-names></string-name>, <string-name><surname>Amode</surname> <given-names>MR</given-names></string-name>, <string-name><surname>Armean</surname> <given-names>IM</given-names></string-name>, <string-name><surname>Austine-Orimoloye</surname> <given-names>O</given-names></string-name>, <string-name><surname>Azov</surname> <given-names>AG</given-names></string-name>, <string-name><surname>Barnes</surname> <given-names>I</given-names></string-name>, <string-name><surname>Bennett</surname> <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Ensembl 2022</article-title>. <source>Nucleic Acids Research</source>. <year>2022</year>; <volume>50</volume>(<issue>D1</issue>):<fpage>D988</fpage>–<lpage>D995</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davenport</surname> <given-names>EE</given-names></string-name>, <string-name><surname>Amariuta</surname> <given-names>T</given-names></string-name>, <string-name><surname>Gutierrez-Arcelus</surname> <given-names>M</given-names></string-name>, <string-name><surname>Slowikowski</surname> <given-names>K</given-names></string-name>, <string-name><surname>Westra</surname> <given-names>HJ</given-names></string-name>, <string-name><surname>Luo</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Shen</surname> <given-names>C</given-names></string-name>, <string-name><surname>Rao</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Pearson</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Discovering in vivo cytokine-eQTL interactions from a lupus clinical trial</article-title>. <source>Genome Biology</source>. <year>2018</year>; <volume>19</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davydov</surname> <given-names>EV</given-names></string-name>, <string-name><surname>Goode</surname> <given-names>DL</given-names></string-name>, <string-name><surname>Sirota</surname> <given-names>M</given-names></string-name>, <string-name><surname>Cooper</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Sidow</surname> <given-names>A</given-names></string-name>, <string-name><surname>Batzoglou</surname> <given-names>S.</given-names></string-name></person-group> <article-title>Identifying a high fraction of the human genome to be under selective constraint using GERP++</article-title>. <source>PLoS Computational Biology</source>. <year>2010</year>; <volume>6</volume>(<issue>12</issue>):<fpage>e1001025</fpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Efron</surname> <given-names>B</given-names></string-name>, <string-name><surname>Tibshirani</surname> <given-names>RJ</given-names></string-name></person-group>. <source>An Introduction to the Bootstrap</source>. <publisher-name>CRC press</publisher-name>; <year>1994</year>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Farh</surname> <given-names>KKH</given-names></string-name>, <string-name><surname>Marson</surname> <given-names>A</given-names></string-name>, <string-name><surname>Zhu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kleinewietfeld</surname> <given-names>M</given-names></string-name>, <string-name><surname>Housley</surname> <given-names>WJ</given-names></string-name>, <string-name><surname>Beik</surname> <given-names>S</given-names></string-name>, <string-name><surname>Shoresh</surname> <given-names>N</given-names></string-name>, <string-name><surname>Whitton</surname> <given-names>H</given-names></string-name>, <string-name><surname>Ryan</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Shishkin</surname> <given-names>AA</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Genetic and epigenetic fine mapping of causal autoimmune disease variants</article-title>. <source>Nature</source>. <year>2015</year>; <volume>518</volume>(<issue>7539</issue>):<fpage>337</fpage>–<lpage>343</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Favé</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Lamaze</surname> <given-names>FC</given-names></string-name>, <string-name><surname>Soave</surname> <given-names>D</given-names></string-name>, <string-name><surname>Hodgkinson</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gauvin</surname> <given-names>H</given-names></string-name>, <string-name><surname>Bruat</surname> <given-names>V</given-names></string-name>, <string-name><surname>Grenier</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Gbeha</surname> <given-names>E</given-names></string-name>, <string-name><surname>Skead</surname> <given-names>K</given-names></string-name>, <string-name><surname>Smargiassi</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Gene-by-environment interactions in urban populations modulate risk phenotypes</article-title>. <source>Nature Communications</source>. <year>2018</year>; <volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Lou</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bedford</surname> <given-names>J</given-names></string-name>, <string-name><surname>Mu</surname> <given-names>XJ</given-names></string-name>, <string-name><surname>Yip</surname> <given-names>KY</given-names></string-name>, <string-name><surname>Khurana</surname> <given-names>E</given-names></string-name>, <string-name><surname>Gerstein</surname> <given-names>M.</given-names></string-name></person-group> <article-title>FunSeq2: a framework for prioritizing noncoding regulatory variants in cancer</article-title>. <source>Genome Biology</source>. <year>2014</year>; <volume>15</volume>(<issue>10</issue>):<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname> <given-names>B</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>X.</given-names></string-name></person-group> <article-title>MESuSiE enables scalable and powerful multi-ancestry fine-mapping of causal variants in genome-wide association studies</article-title>. <source>Nature Genetics</source>. <year>2024</year>; <volume>56</volume>(<issue>1</issue>):<fpage>170</fpage>–<lpage>179</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gong</surname> <given-names>J</given-names></string-name>, <string-name><surname>Mei</surname> <given-names>S</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>C</given-names></string-name>, <string-name><surname>Xiang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Ye</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Feng</surname> <given-names>J</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>R</given-names></string-name>, <string-name><surname>Diao</surname> <given-names>L</given-names></string-name>, <string-name><surname>Guo</surname> <given-names>AY</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>PancanQTL: systematic identification of cis-eQTLs and trans-eQTLs in 33 cancer types</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year>; <volume>46</volume>(<issue>D1</issue>):<fpage>D971</fpage>–<lpage>D976</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Griffin</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Steel</surname> <given-names>MF</given-names></string-name></person-group>. <chapter-title>Adaptive computational methods for Bayesian variable selection</chapter-title>. <source>Handbook of Bayesian Variable Selection</source> <publisher-name>Chapman and Hall/CRC</publisher-name>; <year>2021</year>. p. <fpage>109</fpage>–<lpage>130</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Han</surname> <given-names>B</given-names></string-name>, <string-name><surname>Eskin</surname> <given-names>E.</given-names></string-name></person-group> <article-title>Interpreting meta-analyses of genome-wide association studies</article-title>. <source>PLoS Genetics</source>. <year>2012</year>; <volume>8</volume>(<issue>3</issue>):<fpage>e1002555</fpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hormozdiari</surname> <given-names>F</given-names></string-name>, <string-name><surname>Kichaev</surname> <given-names>G</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>WY</given-names></string-name>, <string-name><surname>Pasaniuc</surname> <given-names>B</given-names></string-name>, <string-name><surname>Eskin</surname> <given-names>E.</given-names></string-name></person-group> <article-title>Identification of causal genes for complex traits</article-title>. <source>Bioinformatics</source>. <year>2015</year>; <volume>31</volume>(<issue>12</issue>):<fpage>i206</fpage>–<lpage>i213</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname> <given-names>S</given-names></string-name>, <string-name><surname>Ferreira</surname> <given-names>LA</given-names></string-name>, <string-name><surname>Shi</surname> <given-names>S</given-names></string-name>, <string-name><surname>Hellenthal</surname> <given-names>G</given-names></string-name>, <string-name><surname>Marchini</surname> <given-names>J</given-names></string-name>, <string-name><surname>Lawson</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Myers</surname> <given-names>SR</given-names></string-name></person-group>. <article-title>Fine-scale population structure and widespread conservation of genetic effect sizes between human groups across traits</article-title>. <source>Nature Genetics</source>. <year>2025</year>; <volume>57</volume>(<issue>2</issue>):<fpage>379</fpage>–<lpage>389</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname> <given-names>C</given-names></string-name>, <string-name><surname>Shuai</surname> <given-names>RW</given-names></string-name>, <string-name><surname>Baokar</surname> <given-names>P</given-names></string-name>, <string-name><surname>Chung</surname> <given-names>R</given-names></string-name>, <string-name><surname>Rastogi</surname> <given-names>R</given-names></string-name>, <string-name><surname>Kathail</surname> <given-names>P</given-names></string-name>, <string-name><surname>Ioannidis</surname> <given-names>NM</given-names></string-name></person-group>. <article-title>Personal transcriptome variation is poorly explained by current genomic deep learning models</article-title>. <source>Nature Genetics</source>. <year>2023</year>; <volume>55</volume>(<issue>12</issue>):<fpage>2056</fpage>–<lpage>2059</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Huang</surname> <given-names>YF</given-names></string-name>, <string-name><surname>Gulko</surname> <given-names>B</given-names></string-name>, <string-name><surname>Siepel</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Fast, scalable prediction of deleterious noncoding variants from functional and population genomic data</article-title>. <source>Nature Genetics</source>. <year>2017</year>; <volume>49</volume>(<issue>4</issue>):<fpage>618</fpage>–<lpage>624</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ioannidis</surname> <given-names>NM</given-names></string-name>, <string-name><surname>Davis</surname> <given-names>JR</given-names></string-name>, <string-name><surname>DeGorter</surname> <given-names>MK</given-names></string-name>, <string-name><surname>Larson</surname> <given-names>NB</given-names></string-name>, <string-name><surname>McDonnell</surname> <given-names>SK</given-names></string-name>, <string-name><surname>French</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Battle</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Hastie</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Thibodeau</surname> <given-names>SN</given-names></string-name>, <string-name><surname>Montgomery</surname> <given-names>SB</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>FIRE: Functional inference of genetic variants that regulate gene expression</article-title>. <source>Bioinformatics</source>. <year>2017</year>; <volume>33</volume>(<issue>24</issue>):<fpage>3895</fpage>–<lpage>3901</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karollus</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mauermeier</surname> <given-names>T</given-names></string-name>, <string-name><surname>Gagneur</surname> <given-names>J.</given-names></string-name></person-group> <article-title>Current sequence-based models capture gene expression determinants in promoters but mostly ignore distal enhancers</article-title>. <source>Genome Biology</source>. <year>2023</year>; <volume>24</volume>(<issue>1</issue>):<fpage>56</fpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katsonis</surname> <given-names>P</given-names></string-name>, <string-name><surname>Wilhelm</surname> <given-names>K</given-names></string-name>, <string-name><surname>Williams</surname> <given-names>A</given-names></string-name>, <string-name><surname>Lichtarge</surname> <given-names>O.</given-names></string-name></person-group> <article-title>Genome interpretation using in silico predictors of variant impact</article-title>. <source>Human Genetics</source>. <year>2022</year>; <volume>141</volume>(<issue>10</issue>):<fpage>1549</fpage>–<lpage>1577</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keys</surname> <given-names>KL</given-names></string-name>, <string-name><surname>Mak</surname> <given-names>AC</given-names></string-name>, <string-name><surname>White</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Eckalbar</surname> <given-names>WL</given-names></string-name>, <string-name><surname>Dahl</surname> <given-names>AW</given-names></string-name>, <string-name><surname>Mefford</surname> <given-names>J</given-names></string-name>, <string-name><surname>Mikhaylova</surname> <given-names>AV</given-names></string-name>, <string-name><surname>Contreras</surname> <given-names>MG</given-names></string-name>, <string-name><surname>Elhawary</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Eng</surname> <given-names>C</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>On the cross-population generalizability of gene expression prediction models</article-title>. <source>PLoS Genetics</source>. <year>2020</year>; <volume>16</volume>(<issue>8</issue>):<fpage>e1008927</fpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kheradpour</surname> <given-names>P</given-names></string-name>, <string-name><surname>Kellis</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Systematic discovery and characterization of regulatory motifs in ENCODE TF binding experiments</article-title>. <source>Nucleic Acids Research</source>. <year>2014</year>; <volume>42</volume>(<issue>5</issue>):<fpage>2976</fpage>–<lpage>2987</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>LaPierre</surname> <given-names>N</given-names></string-name>, <string-name><surname>Taraszka</surname> <given-names>K</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>H</given-names></string-name>, <string-name><surname>He</surname> <given-names>R</given-names></string-name>, <string-name><surname>Hormozdiari</surname> <given-names>F</given-names></string-name>, <string-name><surname>Eskin</surname> <given-names>E.</given-names></string-name></person-group> <article-title>Identifying causal variants by fine mapping across multiple studies</article-title>. <source>PLoS Genetics</source>. <year>2021</year>; <volume>17</volume>(<issue>9</issue>):<fpage>e1009733</fpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lappalainen</surname> <given-names>T</given-names></string-name>, <string-name><surname>Sammeth</surname> <given-names>M</given-names></string-name>, <string-name><surname>Friedländer</surname> <given-names>MR t</given-names></string-name> <string-name><surname>Hoen</surname> <given-names>PA</given-names></string-name>, <string-name><surname>Monlong</surname> <given-names>J</given-names></string-name>, <string-name><surname>Rivas</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Gonzalez-Porta</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kurbatova</surname> <given-names>N</given-names></string-name>, <string-name><surname>Griebel</surname> <given-names>T</given-names></string-name>, <string-name><surname>Ferreira</surname> <given-names>PG</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title>. <source>Nature</source>. <year>2013</year>; <volume>501</volume>(<issue>7468</issue>):<fpage>506</fpage>–<lpage>511</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname> <given-names>S</given-names></string-name>, <string-name><surname>Sesia</surname> <given-names>M</given-names></string-name>, <string-name><surname>Romano</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Candès</surname> <given-names>E</given-names></string-name>, <string-name><surname>Sabatti</surname> <given-names>C.</given-names></string-name></person-group> <article-title>Searching for robust associations with a multi-environment knockoff filter</article-title>. <source>Biometrika</source>. <year>2022</year>; <volume>109</volume>(<issue>3</issue>):<fpage>611</fpage>–<lpage>629</lpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Pividori</surname> <given-names>M</given-names></string-name>, <string-name><surname>Manichaikul</surname> <given-names>A</given-names></string-name>, <string-name><surname>Palmer</surname> <given-names>AA</given-names></string-name>, <string-name><surname>Cox</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Wheeler</surname> <given-names>HE</given-names></string-name>, <string-name><surname>Im</surname> <given-names>HK</given-names></string-name></person-group>. <article-title>Polygenic transcriptome risk scores (PTRS) can improve portability of polygenic risk scores across ancestries</article-title>. <source>Genome Biology</source>. <year>2022</year>; <volume>23</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>18</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lim</surname> <given-names>C</given-names></string-name>, <string-name><surname>Yu</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Estimation stability with cross-validation (ESCV)</article-title>. <source>Journal of Computational and Graphical Statistics</source>. <year>2016</year>; <volume>25</volume>(<issue>2</issue>):<fpage>464</fpage>–<lpage>492</lpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Livesey</surname> <given-names>BJ</given-names></string-name>, <string-name><surname>Badonyi</surname> <given-names>M</given-names></string-name>, <string-name><surname>Dias</surname> <given-names>M</given-names></string-name>, <string-name><surname>Frazer</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kumar</surname> <given-names>S</given-names></string-name>, <string-name><surname>Lindorff-Larsen</surname> <given-names>K</given-names></string-name>, <string-name><surname>McCandlish</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Orenbuch</surname> <given-names>R</given-names></string-name>, <string-name><surname>Shearer</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Muffley</surname> <given-names>L</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Guidelines for releasing a variant effect predictor</article-title>. <source>Genome Biology</source>. <year>2025</year>; <volume>26</volume>(<issue>1</issue>):<fpage>97</fpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Gopalan</surname> <given-names>S</given-names></string-name>, <string-name><surname>Yuan</surname> <given-names>D</given-names></string-name>, <string-name><surname>Conti</surname> <given-names>DV</given-names></string-name>, <string-name><surname>Pasaniuc</surname> <given-names>B</given-names></string-name>, <string-name><surname>Gusev</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mancuso</surname> <given-names>N.</given-names></string-name></person-group> <article-title>Multi-ancestry fine-mapping improves precision to identify causal genes in transcriptome-wide association studies</article-title>. <source>The American Journal of Human Genetics</source>. <year>2022</year>; <volume>109</volume>(<issue>8</issue>):<fpage>1388</fpage>–<lpage>1404</lpage>.</mixed-citation></ref>
    <ref id="c41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Carr</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>A</given-names></string-name>, <string-name><surname>Gazal</surname> <given-names>S</given-names></string-name>, <string-name><surname>Mohammadi</surname> <given-names>P</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>L</given-names></string-name>, <string-name><surname>Pirruccello</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kachuri</surname> <given-names>L</given-names></string-name>, <string-name><surname>Gusev</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Improved multiancestry fine-mapping identifies cis-regulatory variants underlying molecular traits and disease risk</article-title>. <source>Nature Genetics</source>. <year>2025</year>; p. <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Márquez-Luna</surname> <given-names>C</given-names></string-name>, <string-name><surname>Loh</surname> <given-names>PR</given-names></string-name>, <collab>Consortium SATDS</collab>, <string-name><surname>Consortium</surname> <given-names>STD</given-names></string-name>, <string-name><surname>Price</surname> <given-names>AL</given-names></string-name></person-group>. <article-title>Multiethnic polygenic risk scores improve risk prediction in diverse populations</article-title>. <source>Genetic Epidemiology</source>. <year>2017</year>; <volume>41</volume>(<issue>8</issue>):<fpage>811</fpage>–<lpage>823</lpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mazumder</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Discussion of “Best Subset, Forward Stepwise or Lasso? Analysis and Recommendations Based on Extensive Comparisons”</article-title>. <source>Statistical Science</source>. <year>2020</year>; <volume>35</volume>(<issue>4</issue>):<fpage>602</fpage>–<lpage>608</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McVicker</surname> <given-names>G</given-names></string-name>, <string-name><surname>Gordon</surname> <given-names>D</given-names></string-name>, <string-name><surname>Davis</surname> <given-names>C</given-names></string-name>, <string-name><surname>Green</surname> <given-names>P.</given-names></string-name></person-group> <article-title>Widespread genomic signatures of natural selection in hominid evolution</article-title>. <source>PLoS Genetics</source>. <year>2009</year>; <volume>5</volume>(<issue>5</issue>):<fpage>e1000471</fpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morris</surname> <given-names>AP</given-names></string-name></person-group>. <article-title>Transethnic meta-analysis of genomewide association studies</article-title>. <source>Genetic Epidemiology</source>. <year>2011</year>; <volume>35</volume>(<issue>8</issue>):<fpage>809</fpage>–<lpage>822</lpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mostafavi</surname> <given-names>H</given-names></string-name>, <string-name><surname>Harpak</surname> <given-names>A</given-names></string-name>, <string-name><surname>Agarwal</surname> <given-names>I</given-names></string-name>, <string-name><surname>Conley</surname> <given-names>D</given-names></string-name>, <string-name><surname>Pritchard</surname> <given-names>JK</given-names></string-name>, <string-name><surname>Przeworski</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Variable prediction accuracy of poly-genic scores within an ancestry group</article-title>. <source>eLife</source>. <year>2020</year>; <volume>9</volume>:<elocation-id>e48376</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.48376</pub-id></mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ng</surname> <given-names>PC</given-names></string-name>, <string-name><surname>Henikoff</surname> <given-names>S.</given-names></string-name></person-group> <article-title>SIFT: Predicting amino acid changes that affect protein function</article-title>. <source>Nucleic Acids Research</source>. <year>2003</year>; <volume>31</volume>(<issue>13</issue>):<fpage>3812</fpage>–<lpage>3814</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pollard</surname> <given-names>KS</given-names></string-name>, <string-name><surname>Hubisz</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Rosenbloom</surname> <given-names>KR</given-names></string-name>, <string-name><surname>Siepel</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Detection of nonneutral substitution rates on mammalian phylogenies</article-title>. <source>Genome Research</source>. <year>2010</year>; <volume>20</volume>(<issue>1</issue>):<fpage>110</fpage>–<lpage>121</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rentzsch</surname> <given-names>P</given-names></string-name>, <string-name><surname>Witten</surname> <given-names>D</given-names></string-name>, <string-name><surname>Cooper</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Shendure</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kircher</surname> <given-names>M.</given-names></string-name></person-group> <article-title>CADD: predicting the deleteriousness of variants throughout the human genome</article-title>. <source>Nucleic Acids Research</source>. <year>2019</year>; <volume>47</volume>(<issue>D1</issue>):<fpage>D886</fpage>–<lpage>D894</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rogers</surname> <given-names>MF</given-names></string-name>, <string-name><surname>Shihab</surname> <given-names>HA</given-names></string-name>, <string-name><surname>Mort</surname> <given-names>M</given-names></string-name>, <string-name><surname>Cooper</surname> <given-names>DN</given-names></string-name>, <string-name><surname>Gaunt</surname> <given-names>TR</given-names></string-name>, <string-name><surname>Campbell</surname> <given-names>C.</given-names></string-name></person-group> <article-title>FATHMM-XF: accurate prediction of pathogenic point mutations via extended features</article-title>. <source>Bioinformatics</source>. <year>2018</year>; <volume>34</volume>(<issue>3</issue>):<fpage>511</fpage>–<lpage>513</lpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sasse</surname> <given-names>A</given-names></string-name>, <string-name><surname>Ng</surname> <given-names>B</given-names></string-name>, <string-name><surname>Spiro</surname> <given-names>AE</given-names></string-name>, <string-name><surname>Tasaki</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bennett</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Gaiteri</surname> <given-names>C</given-names></string-name>, <string-name><surname>De Jager</surname> <given-names>PL</given-names></string-name>, <string-name><surname>Chikina</surname> <given-names>M</given-names></string-name>, <string-name><surname>Mostafavi</surname> <given-names>S.</given-names></string-name></person-group> <article-title>Benchmarking of deep neural networks for predicting personal gene expression from DNA sequence highlights shortcomings</article-title>. <source>Nature Genetics</source>. <year>2023</year>; <volume>55</volume>(<issue>12</issue>):<fpage>2060</fpage>–<lpage>2064</lpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schaid</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>W</given-names></string-name>, <string-name><surname>Larson</surname> <given-names>NB</given-names></string-name></person-group>. <article-title>From genome-wide associations to candidate causal variants by statistical fine-mapping</article-title>. <source>Nature Reviews Genetics</source>. <year>2018</year>; <volume>19</volume>(<issue>8</issue>):<fpage>491</fpage>–<lpage>504</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shi</surname> <given-names>H</given-names></string-name>, <string-name><surname>Gazal</surname> <given-names>S</given-names></string-name>, <string-name><surname>Kanai</surname> <given-names>M</given-names></string-name>, <string-name><surname>Koch</surname> <given-names>EM</given-names></string-name>, <string-name><surname>Schoech</surname> <given-names>AP</given-names></string-name>, <string-name><surname>Siewert</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>SS</given-names></string-name>, <string-name><surname>Luo</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Amariuta</surname> <given-names>T</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>H</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Population-specific causal disease effect sizes in functionally important regions impacted by selection</article-title>. <source>Nature Commu nications</source>. <year>2021</year>; <volume>12</volume>(<issue>1</issue>):<fpage>1098</fpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taylor</surname> <given-names>KE</given-names></string-name>, <string-name><surname>Ansel</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Marson</surname> <given-names>A</given-names></string-name>, <string-name><surname>Criswell</surname> <given-names>LA</given-names></string-name>, <string-name><surname>Farh</surname> <given-names>KKH.</given-names></string-name></person-group> <article-title>PICS2: next-generation fine mapping via probabilistic identification of causal SNPs</article-title>. <source>Bioinformatics</source>. <year>2021</year>; <volume>37</volume>(<issue>18</issue>):<fpage>3004</fpage>–<lpage>3007</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Turley</surname> <given-names>P</given-names></string-name>, <string-name><surname>Martin</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Goldman</surname> <given-names>G</given-names></string-name>, <string-name><surname>Li</surname> <given-names>H</given-names></string-name>, <string-name><surname>Kanai</surname> <given-names>M</given-names></string-name>, <string-name><surname>Walters</surname> <given-names>RK</given-names></string-name>, <string-name><surname>Jala</surname> <given-names>JB</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>K</given-names></string-name>, <string-name><surname>Millwood</surname> <given-names>IY</given-names></string-name>, <string-name><surname>Carey</surname> <given-names>CE</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Multi-ancestry meta-analysis yields novel genetic discoveries and ancestry-specific associations</article-title>. <source>BioRxiv</source>. <year>2021</year>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname> <given-names>G</given-names></string-name>, <string-name><surname>Sarkar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Carbonetto</surname> <given-names>P</given-names></string-name>, <string-name><surname>Stephens</surname> <given-names>M.</given-names></string-name></person-group> <article-title>A simple new approach to variable selection in regression, with application to genetic fine mapping</article-title>. <source>Journal of the Royal Statistical Society Series B: Statistical Methodology</source>. <year>2020</year>; <volume>82</volume>(<issue>5</issue>):<fpage>1273</fpage>–<lpage>1300</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname> <given-names>QS</given-names></string-name>, <string-name><surname>Kelley</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Ulirsch</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kanai</surname> <given-names>M</given-names></string-name>, <string-name><surname>Sadhuka</surname> <given-names>S</given-names></string-name>, <string-name><surname>Cui</surname> <given-names>R</given-names></string-name>, <string-name><surname>Albors</surname> <given-names>C</given-names></string-name>, <string-name><surname>Cheng</surname> <given-names>N</given-names></string-name>, <string-name><surname>Okada</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Aguet</surname> <given-names>F</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Leveraging supervised learning for functionally informed fine-mapping of cis-eQTLs identifies an additional 20,913 putative causal eQTLs</article-title>. <source>Nature Communications</source>. <year>2021</year>; <volume>12</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wen</surname> <given-names>X</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Luca</surname> <given-names>F</given-names></string-name>, <string-name><surname>Pique-Regi</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Efficient integrative multi-SNP association analysis via deterministic approximation of posteriors</article-title>. <source>The American Journal of Human Genetics</source>. <year>2016</year>; <volume>98</volume>(<issue>6</issue>):<fpage>1114</fpage>–<lpage>1129</lpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wen</surname> <given-names>X</given-names></string-name>, <string-name><surname>Luca</surname> <given-names>F</given-names></string-name>, <string-name><surname>Pique-Regi</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Cross-population joint analysis of eQTLs: fine mapping and functional annotation</article-title>. <source>PLoS Genetics</source>. <year>2015</year>; <volume>11</volume>(<issue>4</issue>):<fpage>e1005176</fpage>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Willer</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Li</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Abecasis</surname> <given-names>GR</given-names></string-name></person-group>. <article-title>METAL: fast and efficient meta-analysis of genomewide association scans</article-title>. <source>Bioinformatics</source>. <year>2010</year>; <volume>26</volume>(<issue>17</issue>):<fpage>2190</fpage>–<lpage>2191</lpage>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>C</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>L</given-names></string-name>, <string-name><surname>Khan</surname> <given-names>A</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>A</given-names></string-name>, <string-name><surname>Vardarajan</surname> <given-names>B</given-names></string-name>, <string-name><surname>Mayeux</surname> <given-names>R</given-names></string-name>, <string-name><surname>Kiryluk</surname> <given-names>K</given-names></string-name>, <string-name><surname>Ionita-Laza</surname> <given-names>I.</given-names></string-name></person-group> <article-title>CARMA is a new Bayesian model for fine-mapping in genome-wide association meta-analyses</article-title>. <source>Nature Genetics</source>. <year>2023</year>; <volume>55</volume>(<issue>6</issue>):<fpage>1057</fpage>– <lpage>1065</lpage>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname> <given-names>B</given-names></string-name>, <string-name><surname>Kumbier</surname> <given-names>K.</given-names></string-name></person-group> <article-title>Veridical data science</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2020</year>; <volume>117</volume>(<issue>8</issue>):<fpage>3920</fpage>– <lpage>3929</lpage>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yuan</surname> <given-names>K</given-names></string-name>, <string-name><surname>Longchamps</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Pardiñas</surname> <given-names>AF</given-names></string-name>, <string-name><surname>Yu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>TT</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Lam</surname> <given-names>M</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>R</given-names></string-name>, <string-name><surname>Xia</surname> <given-names>Y</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Fine-mapping across diverse ancestries drives the discovery of putative causal variants underlying human complex traits and diseases</article-title>. <source>Nature Genetics</source>. <year>2024</year>; <volume>56</volume>(<issue>9</issue>):<fpage>1841</fpage>–<lpage>1850</lpage>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zaidi</surname> <given-names>AA</given-names></string-name>, <string-name><surname>Mathieson</surname> <given-names>I.</given-names></string-name></person-group> <article-title>Demographic history mediates the effect of stratification on polygenic scores</article-title>. <source>eLife</source>. <year>2020</year>; <volume>9</volume>:<elocation-id>e61548</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.61548</pub-id></mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname> <given-names>H</given-names></string-name>, <string-name><surname>Arapoglou</surname> <given-names>T</given-names></string-name>, <string-name><surname>Li</surname> <given-names>X</given-names></string-name>, <string-name><surname>Li</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Zheng</surname> <given-names>X</given-names></string-name>, <string-name><surname>Moore</surname> <given-names>J</given-names></string-name>, <string-name><surname>Asok</surname> <given-names>A</given-names></string-name>, <string-name><surname>Kumar</surname> <given-names>S</given-names></string-name>, <string-name><surname>Blue</surname> <given-names>EE</given-names></string-name>, <string-name><surname>Buyske</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>FAVOR: functional annotation of variants online resource and annotator for variation across the human genome</article-title>. <source>Nucleic Acids Research</source>. <year>2023</year>; <volume>51</volume>(<issue>D1</issue>):<fpage>D1300</fpage>–<lpage>D1311</lpage>.</mixed-citation></ref>
    <ref id="dataref1"><mixed-citation publication-type="data" specific-use="analyzed"><person-group person-group-type="author"><string-name><surname>Dermitzakis</surname><given-names>E</given-names></string-name>, <string-name><surname>Kurbatova</surname><given-names>N</given-names></string-name>, <string-name><surname>Lappalainen</surname><given-names>T</given-names></string-name></person-group> (<year iso-8601-date="2012">2012</year>) <article-title>RNA-sequencing of 465 lymphoblastoid cell lines from the 1000 Genomes</article-title>. <source>ArrayExpress</source>. <pub-id pub-id-type="accession">E-GEUV-1</pub-id> <ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/arrayexpress/studies/E-GEUV-1">https://www.ebi.ac.uk/biostudies/arrayexpress/studies/E-GEUV-1</ext-link></mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88039.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Young</surname>
<given-names>Alexander</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of California, Los Angeles</institution>
</institution-wrap>
<city>Los Angeles</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>important</bold> study presents a methodologically rigorous framework for stability-guided fine-mapping, extending PICS and generalizing to methods such as SuSiE, supported by comprehensive simulations and functional enrichment analyses. The evidence is now <bold>convincing</bold>, demonstrating improved causal variant recovery and offering a robust alternative for cross-population fine-mapping. The approach will be of particular interest to statistical geneticists, computational biologists, and biomedical researchers who rely on fine-mapping to interpret genetic association signals.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88039.2.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Aw et al. have proposed that utilizing stability analysis can be useful for fine-mapping of cross populations. In addition, the authors have performed extensive analyses to understand the cases where the top eQTL and stable eQTL are the same or different via functional data.</p>
<p>Comments on revisions:</p>
<p>The authors have answered all my concerns.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88039.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Aw et al presents a new stability-guided fine-mapping method by extending the previously proposed PICS method. They applied their stability-based method to fine-map cis-eQTLs in the GEUVADIS dataset and compared it against residualization-based approaches. They evaluated the performance of the proposed method using publicly available functional annotations and demonstrated that the variants identified by their stability-based method show enrichment for these functional annotations.</p>
<p>The authors have substantially strengthened the manuscript by addressing the major concerns raised in the initial review. I acknowledge that they have conducted comprehensive simulation studies to show the performance of their proposed approach and that they have extended their approach to SuSiE (&quot;Stable SuSiE&quot;) to demonstrate the broader applicability of the stability-guided principle beyond PICS.</p>
<p>One remaining question is the interpretation of matching variants with very low stable posterior probabilities (~0), which the authors have analyzed in detail but without fully conclusive findings. I agree with the authors that this event is relatively rare and the current sample size is limited but this might be something to keep in mind for future studies.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88039.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Aw</surname>
<given-names>Alan J</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Jin</surname>
<given-names>Lionel Chentian</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ioannidis</surname>
<given-names>Nilah M</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Song</surname>
<given-names>Yun S</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-0734-9868</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1:</bold></p>
<p>Major comments:</p>
<p>(1) It would be interesting to see how much fine-mapping stability can improve the fine-mapping results in cross-population. One can simulate data using true genotype data and quantify the amount the fine-mapping methods improve utilizing the stability idea.</p>
</disp-quote>
<p>We agree, and have performed simulation studies where we assume that causal variants are shared across populations. Specifically, by mirroring the simulation approach described in Wang et al. (2020), we generated 2,400 synthetic gene expression phenotypes across 22 autosomes, using GEUVADIS gene expression metadata (i.e., gene transcription start site) to ensure largely <italic>cis</italic> expression phenotypes were simulated. We additionally generated 1,440 synthetic gene expression phenotypes that incorporate environmental heterogeneity, to motivate our pursuit of fine-mapping stability in the first place (see Response to Reviewer 2, Comment 6). These are described in Results section “Simulation study”:</p>
<p>We evaluated the performance of the PICS algorithm, specifically comparing the approach incorporating stability guidance against the residualization approach that is more commonly used — similar to our application to the real GEUVADIS data. We additionally investigated two ways of “combining” the residualization and stability guidance approaches: (1) running stability-guided PICS on residualized phenotypes; (2) prioritizing matching variants returned by both approaches. See Response to Reviewer 2, Comment 5.</p>
<disp-quote content-type="editor-comment">
<p>(2) I would be very interested to see how other fine-mapping methods (FINEMAP, SuSiE, and CAVIAR) perform via the stability idea.</p>
</disp-quote>
<p>Thank you for this valuable comment. We ran SuSiE on the same set of simulated datasets. Specifically, we ran a version that uses residualized phenotypes (supposedly removing the effects of population structure), and also a version that incorporates stability. The second version is similar to how we incorporate stability in PICS. We investigated the performance of Stable SuSiE in a similar manner to our investigation of PICS. First we compared the performance relative to SuSiE that was run on residualized phenotypes. Motivated by our finding in PICS that prioritizing matching variants improves causal variant recovery, we did the same analysis for SuSiE. This analysis is described in Results section “Stability guidance improves causal variant recovery in SuSiE.”</p>
<p>We reported overall matching frequencies and causal variant recovery rates of top and stable variants for SuSiE in Figures 2C&amp;D.</p>
<p>Frequencies with which Stable and Top SuSiE variants match, stratified by the simulation parameters, are summarized in Supplementary File 2C (reproduced for convenience in Response to Reviewer 2, Comment 3). Causal variant recovery rates split by the number of causal variants simulated, and stratified by both signal-to-noise ratio and the number of credible sets included, are reported in Figure 2—figure supplements 16-18. We reproduce Figure 2—figure supplement 18 (three causal variants scenario) below for convenience. Analogous recovery rates for matching versus non-matching top or stable variants are reported in Figure 2—figure supplements 19, 21 and 23.</p>
<disp-quote content-type="editor-comment">
<p>(3) I am a little bit concerned about the PICS's assumption about one causal variant. The authors mentioned this assumption as one of their method limitations. However, given the utility of existing fine-mapping methods (FINEMAP and SuSiE), it is worth exploring this domain.</p>
</disp-quote>
<p>Thank you for raising this fair concern. We explored this domain, by considering simulations that include two and three causal variants (see Response to Reviewer 2, Comment 3). We looked at how well PICS recovers causal variants, and found that each potential set largely does not contain more than one causal variant (Figure 2—figure supplements 20 and 22). This can be explained by the fact that PICS potential sets are constructed from variants with a minimum linkage disequilibrium to a focal variant. On the other hand, in SuSiE, we observed multiple causal variants appearing in lower credible sets when applying stability guidance (Figure 2—figure supplements 21 and 23). A more extensive study involving more fine-mapping methods and metrics specific to violation of the one causal variant assumption could be pursued in future work.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2:</bold></p>
<p>Aw et al. presents a new stability-guided fine-mapping method by extending the previously proposed PICS method. They applied their stability-based method to fine-map cis-eQTLs in the GEUVADIS dataset and compared it against what they call residualization-based method. They evaluated the performance of the proposed method using publicly available functional annotations and claimed the variants identified by their proposed stability-based method are more enriched for these functional annotations.</p>
<p>While the reviewer acknowledges the contribution of the present work, there are a couple of major concerns as described below.</p>
<p>Major:</p>
<p>(1) It is critical to evaluate the proposed method in simulation settings, where we know which variants are truly causal. While I acknowledge their empirical approach using the functional annotations, a more unbiased, comprehensive evaluation in simulations would be necessary to assess its performance against the existing methods.</p>
</disp-quote>
<p>Thank you for this point. We agree. We have performed a simulation study where we assume that causal variants are shared across populations (see response to Reviewer 1, Comment 1). Specifically, by mirroring the simulation approach described in Wang et al. (2020), we generated 2,400 synthetic gene expression phenotypes across 22 autosomes, using GEUVADIS gene expression metadata (i.e., gene transcription start site) to ensure <italic>cis</italic> expression phenotypes were simulated.</p>
<disp-quote content-type="editor-comment">
<p>(2) Also, simulations would be required to assess how the method is sensitive to different parameters, e.g., LD threshold, resampling number, or number of potential sets.</p>
</disp-quote>
<p>Thank you for raising this point. The underlying PICS algorithm was not proposed by us, so we followed the default parameters set (LD threshold, r<sup>2</sup> = 0.5; see Taylor et al., 2021 Bioinformatics) to focus on how stability considerations will impact the existing fine-mapping algorithm. We attempted to derive the asymptotic joint distribution of the p-values, but it was too difficult. Hence, we used 500 permutations because such a large number would allow large-sample asymptotics to kick in. However, following your critical suggestion we varied the number of potential sets in our analyses of simulated data. We briefly mention this in the Results.</p>
<p>“In the Supplement, we also describe findings from investigations into the impact of including more potential sets on matching frequency and causal variant recovery…”</p>
<p>A detailed write-up is provided in Supplementary File 1 Section S2 (p.2):</p>
<p>“The number of credible or potential sets is a parameter in many fine-mapping algorithms. Focusing on stability-guided approaches, we consider how including more potential sets for stable fine-mapping algorithms affects both causal variant recovery and matching frequency in simulations…</p>
<p>Causal variant recovery. We investigate both Stable PICS and Stable SuSiE. Focusing first on simulations with one causal variant, we observe a modest gain in causal variant recovery for both Stable PICS and Stable SuSiE, most noticeably when the number of sets was increased from 1 to 2 under the lowest signal-to-noise ratio setting…”</p>
<p>We observed that increasing the number of potential sets helps with recovering causal variants for Stable PICS (Figure 2—figure supplements 13-15). This observation also accounts for the comparable power that Stable PICS has with SuSiE in simulations with low signal-to-noise ratio (SNR), when we increase the number of credible sets or potential sets (Figure 2—figure supplements 10-12).</p>
<disp-quote content-type="editor-comment">
<p>(3) Given the previous studies have identified multiple putative causal variants in both GWAS and eQTL, I think it's better to model multiple causal variants in any modern fine-mapping methods. At least, a simulation to assess its impact would be appreciated.</p>
</disp-quote>
<p>We agree. In our simulations we considered up to three causal variants in <italic>cis</italic>, and evaluated how well the top three Potential Sets recovered all causal variants (Figure 2—figure supplements 13-15; Figure 2—figure supplement 15). We also reported the frequency of variant matches between Top and Stable PICS stratified by the number of causal variants simulated in Supplementary File 2B and 2C. Note Supplementary File 2C is for results from SuSiE fine-mapping; see Response to Reviewer 1, Comment 2.</p>
<p>Supplementary File 2B. Frequencies with which Stable and Top PICS have matching variants for the same potential set. For each SNR/ “No. Causal Variants” scenario, the number of matching variants is reported in parentheses.</p>
<p>Supplementary File 2C. Frequencies with which Stable and Top SuSiE have matching variants for the same credible set. For each SNR/ “No. Causal Variants” scenario, the number of matching variants is reported in parentheses.</p>
<disp-quote content-type="editor-comment">
<p>(4) Relatedly, I wonder what fraction of non-matching variants are due to the lack of multiple causal variant modeling.</p>
</disp-quote>
<p>PICS handles multiple causal variants by including more potential sets to return, owing to the important caveat that causal variants in high LD cannot be statistically distinguished. For example, if one believes there are three causal variants that are not too tightly linked, one could make PICS return three potential sets rather than just one. To answer the question using our simulation study, we subsetted our results to just scenarios where the top and stable variants do not match. This mimics the exact scenario of having modeled multiple causal variants but still not yielding matching variants, so we can investigate whether these non-matching variants are in fact enriched in the true causal variants.</p>
<p>Because we expect causal variants to appear in some potential set, we specifically considered whether these non-matching causal variants might match along different potential sets across the different methods. In other words, we compared the stable variant with the top variant from another potential set for the other approach (e.g., Stable PICS Potential Set 1 variant vs Top PICS Potential Set 2 variant). First, we computed the frequency with which such pairs of variants match. A high frequency would demonstrate that, even if the corresponding potential sets do not have a variant match, there could still be a match between non-corresponding potential sets across the two approaches, which shows that multiple causal variant modeling boosts identification of matching variants between both approaches — regardless of whether the matching variant is in fact causal.</p>
<p>Low frequencies were observed. For example, when restricting to simulations where Top and Stable PICS Potential Set 1 variants did not match, about 2-3% of variants matched between the Potential Set 1 variant in Stable PICS and Potential Sets 2 and 3 variants in Top PICS; or between the Potential Set 1 variant in Top PICS and Potential Sets 2 and 3 variants in Stable PICS (Supplementary File 2D). When looking at non-matching Potential Set 2 or Potential Set 3 variants, we do see an increase in matching frequencies (between 10-20%) between Potential Set 2 variants and other potential set variants between the different approaches. However, these percentages are still small compared to the matching frequencies we observed between corresponding potential sets (e.g., for simulations with one causal variant this was 70-90% between Top and Stable PICS Potential Set 1, and for simulations with two and three causal variants this was 55-78% and 57-79% respectively).</p>
<p>We next checked whether these “off-diagonal” matching variants corresponded to the true causal variants simulated. Here we find that the causal variant recovery rate is mostly less than the corresponding rate for diagonally matching variants, which together with the low matching frequency suggests that the enrichment of causal variants of “off-diagonal” matching variants is much weaker than in the diagonally matching approach. In other words, the fraction of non-matching (causal) variants due to the lack of multiple causal variant modeling is low.</p>
<p>We discuss these findings in Supplementary File 1 Section S2 (bottom of p.2).</p>
<disp-quote content-type="editor-comment">
<p>(5) I wonder if you can combine the stability-based and the residualization-based approach, i.e., using the residualized phenotypes for the stability-based approach. Would that further improve the accuracy or not?</p>
</disp-quote>
<p>This is a good idea, thank you for suggesting it. We pursued this combined approach on simulated gene expression phenotypes, but did not observe significant gains in causal variant recovery (Figure 2B; Figure 2—figure supplements 2, 13 and 15). We reported this Results “Searching for matching variants between Top PICS and Stable PICS improves causal variant Recovery.”</p>
<p>“We thus explore ways to combine the residualization and stability-driven approaches, by considering (i) combining them into a single fine-mapping algorithm (we call the resulting procedure Combined PICS); and (ii) prioritizing matching variants between the two algorithms. Comparing the performance of Combined PICS against both Top and Stable PICS, however, we find no significant difference in its ability to recover causal variants (Figure 2B)...”</p>
<p>However, we also confirmed in our simulations that prioritizing matching variants between the two approaches led to gains in causal variant recovery (Figure 2D; Figure 2—figure supplements 4, 19, 20 and 22). We reported this Results “Searching for matching variants between Top PICS and Stable PICS improves causal variant Recovery.”</p>
<p>“On the other hand, matching variants between Top and Stable PICS are significantly more likely to be causal. Across all simulations, a matching variant in Potential Set 1 is 2.5X as likely to be causal than either a non-matching top or stable variant (Figure 2D) — a result that was qualitatively consistent even when we stratified simulations by SNR and number of causal variants simulated (Figure 2—figure supplements 19, 20 and 22)...”</p>
<p>This finding is consistent with our analysis of real GEUVADIS gene expression data, where we reported larger functional significance of matching variants relative to non-matching variants returned by either Top of Stable PICS.</p>
<disp-quote content-type="editor-comment">
<p>(6) The authors state that confounding in cohorts with diverse ancestries poses potential difficulties in identifying the correct causal variants. However, I don't see that they directly address whether the stability approach is mitigating this. It is hard to say whether the stability approach is helping beyond what simpler post-hoc QC (e.g., thresholding) can do.</p>
</disp-quote>
<p>Thank you for raising this fair point. Here is a model we have in mind. Gene expression phenotypes (Y) can be explained by both genotypic effects (G, as in genotypic allelic dosage) and the environment (E): Y = G + E. However, both G and E depend on ancestry (A), so that Y = G|A+E|A. Suppose that the causal variants are shared across ancestries, so that (G|A=<italic>a</italic>)=G for all ancestries <italic>a</italic>. Suppose however that environments are heterogeneous by ancestry: (E|A=<italic>a</italic>) = e(<italic>a</italic>) for some function e that depends non-trivially on <italic>a</italic>. This would violate the exchangeability of exogenous E in the full sample, but by performing fine-mapping on each ancestry stratum, the exchangeability of exogenous E is preserved. This provides theoretical justification for the stability approach.</p>
<p>We next turned to simulations, where we investigated 1,440 simulated gene expression phenotypes capturing various ways in which ancestry induces heterogeneity in the exogenous E variable (simulation details in Lines 576-610 of Materials and Methods). We ran Stable PICS, as well as a version of PICS that did not residualize phenotypes or apply the stability principle. We observed that (i) causal variant recovery performance was not significantly different between the two approaches (Figure 2—figure supplements 24-32); but (ii) disagreement between the approaches can be considerable, especially when the signal-to-noise ratio is low (Supplementary File 2A). For example, in a set of simulations with three causal variants, with SNR = 0.11 and E heterogeneous by ancestry by letting E be drawn from <italic>N</italic>(2σ,σ<sup>2</sup>) for only GBR individuals (rest are <italic>N</italic>(0,σ<sup>2</sup>)), there was disagreement between Potential Set 1 and 2 variants in 25% of simulations — though recovery rates were similar (Probability of recovering at least one causal variant: 75% for Plain PICS and 80% for Stable PICS). These points suggest that confounding in cohorts can reduce power in methods not adjusting or accounting for ancestral heterogeneity, but can be remedied by approaches that do so. We report this analysis in Results “Simulations justify exploration of stability guidance”</p>
<p>In the current version of our work, we have evaluated, using both simulations and empirical evidence, different ways to combine approaches to boost causal variant recovery. Our simulation study shows that prioritizing matching variants across multiple methods improves causal variant recovery. On GEUVADIS data, where we might not know which variants are causal, we already demonstrated that matching variants are enriched for functional annotations. Therefore, our analyses justify that the adverse consequence of confounding on reducing fine-mapping accuracy can be mitigated by prioritizing matching variants between algorithms including those that account for stability.</p>
<disp-quote content-type="editor-comment">
<p>(7) For non-matching variants, I wonder what the difference of posterior probabilities is between the stable and top variants in each method. If the difference is small, maybe it is due to noise rather than signal.</p>
</disp-quote>
<p>We have reported differences in posterior probabilities returned by Stable and Top PICS for GEUVADIS data; see Figure 3—figure supplement 1. For completeness, we compute the differences in posterior probabilities and summarize these differences both as histograms and as numerical summary statistics.</p>
<p>Potential Set 1</p>
<p>- Number of non-matching variants = 9,921</p>
<p>- Table of Summary Statistics of (Stable Posterior Probability – Top Posterior Probability)</p>
<table-wrap id="sa3table1">
<label>Author response table 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-table1.jpg" mimetype="image"/>
</table-wrap>
<p>- Histogram of (Stable Posterior Probability – Top Posterior Probability)</p>
<fig id="sa3fig1">
<label>Author response image 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-fig1.jpg" mimetype="image"/>
</fig>
<p>Potential Set 2</p>
<p>- Number of non-matching variants = 14,454</p>
<p>- Table of Summary Statistics of (Stable Posterior Probability – Top Posterior Probability)</p>
<table-wrap id="sa3table2">
<label>Author response table 2.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-table2.jpg" mimetype="image"/>
</table-wrap>
<p>- Histogram of (Stable Posterior Probability – Top Posterior Probability)</p>
<fig id="sa3fig2">
<label>Author response image 2.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-fig2.jpg" mimetype="image"/>
</fig>
<p>Potential Set 3</p>
<p>- Number of non-matching variants = 16,814</p>
<p>- Table of Summary Statistics of (Stable Posterior Probability – Top Posterior Probability)</p>
<table-wrap id="sa3table3">
<label>Author response table 3.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-table3.jpg" mimetype="image"/>
</table-wrap>
<p>- Histogram of (Stable Posterior Probability – Top Posterior Probability)</p>
<fig id="sa3fig3">
<label>Author response image 3.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-fig3.jpg" mimetype="image"/>
</fig>
<p>We also compared the difference in posterior probabilities between non-matching variants returned by Stable PICS and Top PICS for our 2,400 simulated gene expression phenotypes. Focusing on just Potential Set 1 variants, we find two equally likely scenarios, as demonstrated by two distinct clusters of points in a “posterior probability-posterior probability” plot. The first is, as pointed out, a small difference in posterior probability (points lying close to y=x). The second, however, reveals stable variants with very small posterior probability (of order 4 x 10<sup>–5</sup> to 0.05) but with a non-matching top variant taking on posterior probability well distributed along [0,1]. Moving down to Potential Sets 2 and 3, the distribution of pairs of posterior probabilities appears less clustered, indicating less tendency for posterior probability differences to be small ( Figure 2—figure supplement 8).</p>
<p>Here are the histograms and numerical summary statistics.</p>
<p>Potential Set 1</p>
<p>- Number of non-matching variants = 663 (out of 2,400)</p>
<p>- Table of Summary Statistics of (Stable Posterior Probability – Top Posterior Probability)</p>
<table-wrap id="sa3table4">
<label>Author response table 4.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-table4.jpg" mimetype="image"/>
</table-wrap>
<p>- Histogram of (Stable Posterior Probability – Top Posterior Probability)</p>
<fig id="sa3fig4">
<label>Author response image 4.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-fig4.jpg" mimetype="image"/>
</fig>
<p>Potential Set 2</p>
<p>Number of non-matching variants = 1,429 (out of 2,400)</p>
<p>- Table of Summary Statistics of (Stable Posterior Probability – Top Posterior Probability)</p>
<table-wrap id="sa3table5">
<label>Author response table 5.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-table5.jpg" mimetype="image"/>
</table-wrap>
<p>- Histogram of (Stable Posterior Probability – Top Posterior Probability)</p>
<fig id="sa3fig5">
<label>Author response image 5.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-fig5.jpg" mimetype="image"/>
</fig>
<p>Potential Set 3</p>
<p>- Number of non-matching variants = 1,810 (out of 2,400)</p>
<p>- Table of Summary Statistics of (Stable Posterior Probability – Top Posterior Probability)</p>
<table-wrap id="sa3table6">
<label>Author response table 6.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-table6.jpg" mimetype="image"/>
</table-wrap>
<p>- Histogram of (Stable Posterior Probability – Top Posterior Probability)</p>
<fig id="sa3fig6">
<label>Author response image 6.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88039-sa3-fig6.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>(8) It's a bit surprising that you observed matching variants with (stable) posterior probability ~ 0 (SFig. 1). What are the interpretations for these variants? Do you observe functional enrichment even for low posterior probability matching variants?</p>
</disp-quote>
<p>Thank you for this question. We have performed a thorough analysis of matching variants with very low stable posterior probability, which we define as having a posterior probability &lt; 0.01 (Supplementary File 1 Section S11). Here, we briefly summarize the analysis and key findings.</p>
<p>Analysis</p>
<p>First, such variants occur very rarely — only 8 across all three potential sets in simulations, and 17 across all three potential sets for GEUVADIS (the latter variants are listed in Supplementary 2E). We begin interpreting these variants by looking at allele frequency heterogeneity by ancestry, support size — defined as the number of variants with positive posterior probability in the ALL slice* — and the number of slices including the stable variant (i.e., the stable variant reported positive posterior probability for the slice).</p>
<p>*Note that the stable variant posterior probability need not be at least 1/(Support Size). This is because the algorithm may have picked a SNP that has a lower posterior probability in the ALL slice (i.e., not the top variant) but happens to appear in the most number of other slices (i.e., a stable variant).</p>
<p>For variants arising from simulations, because we know the true causal variants, we check if these variants are causal. For GEUVADIS fine-mapped variants, we rely on functional annotations to compare their relative enrichment against other matching variants that did not have very low stable posterior probability.</p>
<p>Findings</p>
<p>While we caution against generalizing from observations reported here, which are based on very small sample sizes, we noticed the following. In simulations, matching variants with very low stable posterior probability are largely depleted in causal variants, although factors such as the number of slices including the stable variant may still be useful. In GEUVADIS, however, these variants can still be functionally enriched. We reported three examples in Supplementary File 1 Section S11 (pp. 8-9 of Supplement), where the variants were enriched in either VEP or biologically interpretable functional annotations, and were also reported in earlier studies. We partially reproduce our report below for convenience.</p>
<p>“However, we occasionally found variants that stand out for having large functional annotation scores. We list one below for each potential set.</p>
<p>- Potential Set 1 reported the variant rs12224894 from fine-mapping ENSG00000255284.1 (accession code <italic>AP006621.3</italic>) in Chromosome 11. This variant stood out for lying in the promoter flanking region of multiple cell types and being relatively enriched for GC content with a 75bp flanking region. This variant has been reported as a cis eQTL for AP006632 (using whole blood gene expression, rather than lymphoblastoid cell line gene expression in this study) in a clinical trial study of patients with systemic lupus erythematosus (Davenport et al., 2018). Its nearest gene is GATD1, a ubiquitously expressed gene that codes for a protein and is predicted to regulate enzymatic and catabolic activity. This variant appeared in all 6 slices, with a moderate support size of 23.</p>
<p>- Potential Set 2 reported the variant rs9912201 from fine-mapping ENSG00000108592.9 (mapped to <italic>FTSJ3</italic>) in Chromosome 17. Its FIRE score is 0.976, which is close to the maximum FIRE score reported across all Potential Set 2 matching variants. This variant has been reported as a SNP in high LD to a GWAS hit SNP rs7223966 in a pan-cancer study (Gong et al., 2018). This variant appeared in all 6 slices, with a moderate support size of 32.</p>
<p>- Potential Set 3 reported the variant rs625750 from fine-mapping ENSG00000254614.1 (mapped to <italic>CAPN1-AS1</italic>, an RNA gene) in Chromosome 11. Its FIRE score is 0.971 and its B statistic is 0.405 (region under selection), which lie at the extreme quantiles of the distributions of these scores for Potential Set 3 matching variants with stable posterior probability at least 0.01. Its associated mutation has been predicted to affect transcription factor binding, as computed using several position weight matrices (Kheradpour and Kellis, 2014). This variant appeared in just 3 slices, possibly owing to the considerable allele frequency difference between ancestries (maximum AF difference = 0.22). However, it has a small support size of 4 and a moderately high Top PICS posterior probability of 0.64.</p>
<p>To summarize, our analysis of GEUVADIS fine-mapped variants demonstrates that matching variants with very low stable posterior probability could still be functionally important, even for lower potential sets, conditional on supportive scores in interpretable features such as the number of slices containing the stable variant and the posterior probability support size…”</p>
</body>
</sub-article>
</article>