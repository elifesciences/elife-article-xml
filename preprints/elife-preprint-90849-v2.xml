<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">90849</article-id>
<article-id pub-id-type="doi">10.7554/eLife.90849</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.90849.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Genetics and Genomics</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories><title-group>
<article-title>Hybridization breaks species barriers in long-term coevolution of a cyanobacterial population</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3561-024X</contrib-id>
<name>
<surname>Birzu</surname>
<given-names>Gabriel</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<email>gbirzu@ufl.edu</email>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Muralidharan</surname>
<given-names>Harihara Subrahmaniam</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Goudeau</surname>
<given-names>Danielle</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4758-7369</contrib-id>
<name>
<surname>Malmstrom</surname>
<given-names>Rex R</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Fisher</surname>
<given-names>Daniel S</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
<email>dsfisher@stanford.edu</email>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7965-4258</contrib-id>
<name>
<surname>Bhaya</surname>
<given-names>Devaki</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
<email>dbhaya@carnegiescience.edu</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00f54p054</institution-id><institution>Department of Applied Physics, Stanford University</institution></institution-wrap>, <city>Stanford</city>, <country country="US">United States</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02y3ad647</institution-id><institution>Department of Physics, University of Florida</institution></institution-wrap>, <city>Gainesville</city>, <country country="US">United States</country></aff>
<aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/047s2c258</institution-id><institution>Department of Computer Science, University of Maryland, College Park</institution></institution-wrap>, <city>College Park</city>, <country country="US">United States</country></aff>
<aff id="a4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jbv0t02</institution-id><institution>DOE Joint Genome Institute, Lawrence Berkeley National Laboratory</institution></institution-wrap>, <city>Berkeley</city>, <country country="US">United States</country></aff>
<aff id="a5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04jr01610</institution-id><institution>Department of Plant Biology, Carnegie Institution for Science</institution></institution-wrap>, <city>Washington</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Weigel</surname>
<given-names>Detlef</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Biology Tübingen</institution>
</institution-wrap>
<city>Tübingen</city>
<country country="DE">Germany</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Weigel</surname>
<given-names>Detlef</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Biology Tübingen</institution>
</institution-wrap>
<city>Tübingen</city>
<country country="DE">Germany</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="others"><label>†</label><p>Joint senior authors.</p></fn>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-11-07">
<day>07</day>
<month>11</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-10-21">
<day>21</day>
<month>10</month>
<year>2025</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP90849</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-08-11">
<day>11</day>
<month>08</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-06-07">
<day>07</day>
<month>06</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.06.06.543983"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-11-07">
<day>07</day>
<month>11</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.90849.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.90849.1.sa2">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.90849.1.sa1">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.90849.1.sa0">Reviewer #2 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Birzu et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Birzu et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-90849-v2.pdf"/>
<abstract>
<p>Bacterial species often undergo rampant recombination yet maintain cohesive genomic identity. Ecological differences can generate recombination barriers between species and sustain genomic clusters in the short term. But can these forces prevent genomic mixing during long-term coevolution? Cyanobacteria in Yellowstone hot springs comprise several diverse species that have coevolved for hundreds of thousands of years, providing a rare natural experiment. By analyzing more than 300 single-cell genomes, we show that despite each species forming a distinct genomic cluster, much of the diversity within species is the result of hybridization driven by selection, which has mixed their ancestral genotypes. This widespread mixing is contrary to the prevailing view that ecological barriers can maintain cohesive bacterial species and highlights the importance of hybridization as a source of genomic diversity.</p>
</abstract>
<funding-group>
<award-group id="funding-1">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/01cmst727</institution-id>
<institution>Simons Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>730295</award-id>
</award-group>
<award-group id="funding-2">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/021nxhr62</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>PHY-1607606</award-id>
</award-group>
<award-group id="funding-2a">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/021nxhr62</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>PHY-2210386</award-id>
</award-group>
<award-group id="funding-2b">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/021nxhr62</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>2125965</award-id>
</award-group>
<award-group id="funding-2c">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/021nxhr62</institution-id>
<institution>National Science Foundation</institution>
</institution-wrap>
</funding-source>
<award-id>1921429</award-id>
</award-group>
<award-group id="funding-3">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/01cwqze88</institution-id>
<institution>National Institutes of Health</institution>
</institution-wrap>
</funding-source>
<award-id>R01-AI-100947</award-id>
</award-group>
</funding-group>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Added four extra figures and significantly expanded main text; extended analysis of recombination rate inferences and added comparisons to two previously proposed methods.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>The origin, persistence, and extinction of species in obligate sexual populations is a fundamental problem in evolutionary theory <xref ref-type="bibr" rid="c13">Coyne and Orr (2004)</xref>. But in bacteria, long thought to be primarily asexual, our understanding is still very limited <xref ref-type="bibr" rid="c24">Fraser et al. (2009)</xref>; <xref ref-type="bibr" rid="c59">Rocha (2018)</xref>. While it has long been known that bacteria can acquire non-essential genes from distantly-related strains <xref ref-type="bibr" rid="c58">Rivera et al. (1998)</xref>, in recent years, studies across a wide range of bacteria have found that homologous recombination of core genes is also ubiquitous <xref ref-type="bibr" rid="c18">Didelot and Maiden (2010)</xref>; <xref ref-type="bibr" rid="c80">Yahara et al. (2015)</xref>; <xref ref-type="bibr" rid="c60">Rosen et al. (2015)</xref>; <xref ref-type="bibr" rid="c25">Garud et al. (2019)</xref>; <xref ref-type="bibr" rid="c62">Sakoparnig et al. (2021)</xref>. How does the interplay between selection acting both asexually and on transferred elements, and barriers to recombination from geographical separation, mechanistic effects, and epistatic interactions lead to formation and maintenance of cohesive species?</p>
<p>One explanation is that ecological specialization provides barriers to recombination <xref ref-type="bibr" rid="c31">Kashtan et al. (2014)</xref>; <xref ref-type="bibr" rid="c3">Arevalo et al. (2019)</xref>. This view is supported by evidence that selective sweeps of individual genes through parts of a population can lead to distinct ecological subtypes, or ecotypes, even in highly recombining bacterial populations <xref ref-type="bibr" rid="c14">Croucher et al. (2011)</xref>; <xref ref-type="bibr" rid="c64">Shapiro et al. (2012)</xref>; <xref ref-type="bibr" rid="c4">Bao et al. (2016)</xref>. But it also raises an important open question: if species coexist and recombine with each other, do genetic differences continue to increase over evolutionary time or does recombination gradually break down barriers between species?</p>
<p>Answering this question is challenging because data on the underlying evolutionary dynamics is lacking. The time scales of direct observations and laboratory experiments are too short, while those corresponding to phylogenetic relationships between extant species are too long. And since spatial dynamics over these intermediate time scales are unknown in most bacteria <xref ref-type="bibr" rid="c27">Hanson et al. (2012)</xref>; <xref ref-type="bibr" rid="c25">Garud et al. (2019)</xref> it is difficult to control for changes in local community structure during evolution. Therefore, microbial communities that coevolved for long time periods can act as natural experiments for studying bacterial speciation. The cyanobacterial populations found in hot springs from Yellowstone National Park form a natural incubator in which one such natural experiment is ongoing. These communities have two key features that allow us to identify and quantify the effects of coevolution on intermediate time scales.</p>
<p>First, like other thermophilic communities, these populations are geographically islolated <xref ref-type="bibr" rid="c52">Papke et al. (2003)</xref>; <xref ref-type="bibr" rid="c78">Whitaker et al. (2003)</xref>. To date, the two most abundant species, <italic>Synechococcus</italic> A and B, have not been found outside of North America, suggesting that their global mixing time is much longer than for most other bacteria <xref ref-type="bibr" rid="c52">Papke et al. (2003)</xref>. Comparison of two isolate genomes from these species, OS-A and OS-B’, suggest a divergence time considerably longer than the formation of the Yellowstone caldera around 640, 000 years ago <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>. This would imply their ancestors colonized the caldera independently.</p>
<p>Second, these populations have considerable sub-species diversity, suggesting ongoing evolutionary processes generate and maintain it. Analysis of variants of 16S rRNA and marker genes was initially interpreted as evidence of asexual ecotypes occupying distinct niches <xref ref-type="bibr" rid="c75">Ward et al. (1998</xref>, <xref ref-type="bibr" rid="c73">2006</xref>). However, deep amplicon data from a diverse, but largely OS-B’-like sample revealed extensive recombination <xref ref-type="bibr" rid="c60">Rosen et al. (2015)</xref>. Genetic exchange with other genomic clusters—which we refer to as hybridization—was also evident, particularly with relatives of OS-A. To date, evidence of hybridization in bacteria has mainly been from comparisons between reference genomes from large genomic databases <xref ref-type="bibr" rid="c66">Smillie et al. (2011)</xref>; <xref ref-type="bibr" rid="c21">Diop et al. (2022)</xref>, with only a handful of studies investigating hybridization in natural environments <xref ref-type="bibr" rid="c70">Tyson et al. (2004)</xref>; <xref ref-type="bibr" rid="c41">Lo et al. (2007)</xref>; <xref ref-type="bibr" rid="c65">Sheppard et al. (2008)</xref>. The primary focus of the current paper is to determine the impact of hybridization on the long-term coevolution of a natural microbial community.</p>
<p>Characterizing hybridization requires long-distance linkage between variants that cannot be obtained from traditional metagenomics. Strain isolates are often not representative of the population diversity <xref ref-type="bibr" rid="c8">Browne et al. (2016)</xref>; <xref ref-type="bibr" rid="c82">Zheng et al. (2022)</xref>, while metagenome assembly destroys linkage. Recruiting metagenomic reads to reference genomes can in some cases be used to infer linkage <xref ref-type="bibr" rid="c25">Garud et al. (2019)</xref>, but the high diversity of <italic>Synechococcus</italic> prevents us from using such approaches. To circumvent these problems, we used single-cell genomics <xref ref-type="bibr" rid="c57">Rinke et al. (2013)</xref>; <xref ref-type="bibr" rid="c82">Zheng et al. (2022)</xref> to obtain over 300 genomes from the Mushroom and Octopus Springs, which contain two of the most well-studied communities from the Yellowstone caldera <xref ref-type="bibr" rid="c74">Ward et al. (2012)</xref>. This is to our knowledge the first large sample of genomes from hot spring cyanobacterial populations <italic>without</italic> the compositional bias due to strain isolation.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Population comprises three distinct highly-recombining genomic clusters</title>
<p>Previous analysis of 16S amplicons identified two main clusters similar to OS-A and OS-B’, but also several others at frequencies below 1% <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>. But whether clusters within 16S amplicons correspond to clusters at the whole genome level in such a rapidly recombining population is not clear <xref ref-type="bibr" rid="c60">Rosen et al. (2015)</xref>; <xref ref-type="bibr" rid="c43">Miller and Carvey (2019)</xref>. Therefore, we first compared each single-amplified genome (SAG) to <italic>Synechococcus</italic> OS-A and OS-B’. Almost all SAGs (330 out of 331) comprised two clusters with an average nucleotide divergence of ~ 2% from one of the reference genomes and ~ 15% from the other. We labeled the cluster closer to OS-A by <italic>α</italic> (128 SAGs) and the other by <italic>β</italic> (202 SAGs), to distinguish them from the reference genomes. Surprisingly, one SAG (approximately 70% complete) was ~ 15% diverged from both OS-A and OS-B’ and formed a separate cluster which we labeled <italic>γ</italic> (<xref rid="fig1" ref-type="fig">fig. 1A</xref>). Clustering methods based on different metrics gave identical results (<xref rid="fig2" ref-type="fig">figs. 2</xref>, <xref rid="fig3" ref-type="fig">3</xref> in <xref ref-type="app" rid="app2">Appendix 2</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Synechococcus population comprises three genomic clusters.</title>
<p>(<bold>A</bold>) The mean divergence across homologous genes from the two reference genomes is shown for every genome in the data. Each dot represents a single genome and is colored according to its assigned species. (<bold>B</bold>) The relative abundances of all three species across samples from different temperatures within Mushroom Spring. Abundances were estimated based on read recruitment from the metagenome to core genes from the <italic>γ</italic> genome, as well as representative genomes from the <italic>α</italic> and <italic>β</italic> populations. Dashed lines show the minimum detection frequencies from the single-cell (black) and metagenome (gray) data, respectively (see <xref ref-type="app" rid="app3">Appendix 3</xref>). Shaded gray region shows temperature range of the 8 single-cell samples.</p></caption>
<graphic xlink:href="543983v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Genetic linkage analysis shows extensive recombination within <italic>α</italic> and <italic>β</italic>.</title>
<p>(<bold>A</bold>) Linkage disequilibrium <inline-formula><inline-graphic xlink:href="543983v2_inline48.gif" mimetype="image" mime-subtype="gif"/></inline-formula> as a function of separation between SNPs <italic>x</italic> averaged across all core genes from <italic>α</italic> (orange circles) and <italic>β</italic> (blue squares). Genome-wide estimates from SNPs in different genes are shown to the right of the black dashed line using the same symbols. Fully unlinked controls for the genome-wide linkage are shown by crosses of corresponding colors. Dashed lines show fit to linkage decay curves in an inifinite sample using Eq. (6) for <italic>α</italic> (orange) and <italic>β</italic> (blue) separately. (<bold>B</bold>) Scatter plot of 16S and genome-wide divergences between all pairs of genomes within the same species. Solid lines show linear regressions indicating very weak Pearson correlation coefficient, <italic>R</italic>, within each species. This demonstrates that 16S divergence is a poor proxy of whole genome divergence.</p></caption>
<graphic xlink:href="543983v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title><italic>α</italic> and <italic>β</italic> have distinct patterns of within-species diversity.</title>
<p>(<bold>A</bold>) The synonymous diversity <italic>π</italic><sub><italic>S</italic></sub> within <italic>α</italic> (orange) and <italic>β</italic> (blue) at all core genes ordered according to their respective reference genomes. The solid line shows the value of <italic>π</italic><sub><italic>S</italic></sub>, with lighter colors showing one standard deviation across different pairs around the mean. Both lines were smoothed by averaging over a sliding window of 5 genes with a step size of 2 genes. (<bold>B</bold>) Distribution of the fraction of polymorphic four-fold degenerate (4D) sites for each <italic>α</italic> core gene (blue histogram) is shown together with Poisson fit based on the number of genes without any polymorphic sites (black line and dots). Inset shows zoomed-in region of low-diversity genes (&lt; 5% polymorphic 4D sites) together with the same fit. (<bold>C</bold>) The same as (B) using data from <italic>β</italic>. The Poisson distribution is fitted using the mean of the distribution, which provides a better fit than the number of genes without polymorphic sites (data not shown). (<bold>D</bold>) Histogram of synonymous diversities <italic>π</italic><sub><italic>S</italic></sub> within genes for <italic>β</italic> (blue), <italic>α</italic> low-diversity backbone (orange), and <italic>α</italic> high-diversity (hybrid) genes (red). Note the overlap between the diversity in the <italic>β</italic> core genome and the hybrid <italic>α</italic> genes.</p></caption>
<graphic xlink:href="543983v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To investigate the extent that these clusters characterize the distribution of genomes throughout the two springs, we used single-cell genomes as references and recruited reads from a large collection of metagenome samples to determine the abundance of <italic>α, β</italic>, and, particularly, <italic>γ</italic> across different environments (see <xref ref-type="app" rid="app3">Appendix 3</xref>). We found that 95% of reads were part of a main cloud of sequences with ≤ 5% nucleotide divergence from one of the three main clusters. We used the fraction of reads within each main cloud to infer the abundances of each cluster in the metagenomic samples. The abundance of <italic>γ</italic> was highly correlated with <italic>α</italic> (<xref rid="fig3" ref-type="fig">figs. 3</xref> and <xref rid="fig4" ref-type="fig">4</xref> in <xref ref-type="app" rid="app3">Appendix 3</xref>) and increased rapidly with temperature in the Mushroom Spring samples (<xref rid="fig1" ref-type="fig">fig. 1B</xref>). One interpretation of this pattern is that <italic>α, β</italic>, and <italic>γ</italic> represent distinct species adapted to different temperatures. Alternatively, genotypes within the same cluster could be adapted to different temperatures or other environmental conditions. The relative abundances of the clusters would then reflect the complex eco-evolutionary processes that maintain the diversity in the population.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Alignments reveal distinct patterns of hybridization across different genes.</title>
<p>Three core gene alignments, each chosen to illustrate a distinct pattern of hybridization are shown. Rows represent different cells and columns different positions along the gene. One sequence was chosen randomly as a reference (top row), with nucleotides shown in different colors. The species assigned to each cell are indicated by the colored rectangles on the left, using the same color scheme as the species clusters. Rows were sorted hierarchically based on pairwise distances. Nucleotides are shown in grey if they are identical to the reference genome and in a different color if different. Species clusters were assigned as described in the main text and <xref ref-type="app" rid="app1">Appendix 1</xref>. (<bold>A</bold>) Segment of an alignment containing three distinct species clusters (<italic>α</italic> shown in orange, <italic>β</italic> shown in blue, and <italic>γ</italic> shown in green) of a non-hybrid gene. (<bold>B</bold>) Segment of an alignment containing two distinct clusters (<italic>α</italic> and <italic>β</italic>) and six different simple hybrids. The direction of the transfer was inferred as described in the main text and and is indicated on the left. Transfers from <italic>α</italic> into <italic>β</italic> and <italic>β</italic> into <italic>α</italic> are highlighted in orange and blue, respectively. Note that the presence of more than one type of transfer is rare and was chosen here for illustration. (<bold>C</bold>) Segment of a alignment without distinct species clusters chosen to illustrate mosaic hybrid genes. Regions with clear hybrid blocks are highlighted in purple. Note the extensive hybridization on short length scales, despite the fact that sequences from the same species cluster with each other based on pairwise distances.</p></caption>
<graphic xlink:href="543983v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Previous analysis using a much more limited dataset proposed that <italic>β</italic> formed a quasisexual population, in which rapid recombination led to random assortment of alleles within the cluster <xref ref-type="bibr" rid="c60">Rosen et al. (2015)</xref>. Motivated by these results, we investigated the impact of recombination on the diversity within the two main clusters.</p>
<p>We quantified recombination rates in <italic>α</italic> and <italic>β</italic> using a standard measure of linkage disequilibrium, <inline-formula><inline-graphic xlink:href="543983v2_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. Given a pair of sites with alleles <monospace>a/A</monospace> and <inline-formula><inline-graphic xlink:href="543983v2_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is defined as
<disp-formula id="eqn1">
<graphic xlink:href="543983v2_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where ⟨·⟩ is the average across pairs of sites. In asexual populations with conventional demo-graphic drift, <inline-formula><inline-graphic xlink:href="543983v2_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula> independently of the location of the sites. Recombination events affecting one but not both sites can unlink mutations, leading to a decrease in <inline-formula><inline-graphic xlink:href="543983v2_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. Because sites further apart have more opportunities to become unlinked,<inline-formula><inline-graphic xlink:href="543983v2_inline5.gif" mimetype="image" mime-subtype="gif"/></inline-formula> decreases with the distance between sites.</p>
<p>In <italic>β</italic>, the linkage disequilibrium <inline-formula><inline-graphic xlink:href="543983v2_inline6.gif" mimetype="image" mime-subtype="gif"/></inline-formula> decreased by around a factor of 10 over distances of ~ 1 kbp (<xref rid="fig2" ref-type="fig">fig. 2A</xref>). This agreed quantitatively with earlier results based on deep amplicon sequencing from ref. <xref ref-type="bibr" rid="c60">Rosen et al. (2015)</xref>, which showed a decrease by a factor of ~ 7 over distances of up to 300 bp, using a different but related measure of linkage, conventionally denoted as ⟨ <italic>r</italic><sup>2</sup>⟩. Over genome-wide length scales, linkage was small <inline-formula><inline-graphic xlink:href="543983v2_inline7.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and close to a fully-unlinked control <inline-formula><inline-graphic xlink:href="543983v2_inline8.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. We found similar results for <italic>α</italic>, but with a quantitatively slower decrease in linkage by a factor of ~ 8 over ~ 1 kbp. Nevertheless, genome-wide linkage values were still close to the fully-unlinked control (<inline-formula><inline-graphic xlink:href="543983v2_inline9.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for the data vs <inline-formula><inline-graphic xlink:href="543983v2_inline10.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for the control). As a consequence of rapid recombination, we found that diversity in marker genes, such as 16S rRNA, were poor predictors of whole-genome diversity (<xref rid="fig2" ref-type="fig">Fig. 2B</xref>). These results are consistent with each cluster representing a quasisexual population and imply that phylogenies inferred from whole genomes do not reflect the evolutionary history of the population.</p>
<p>While linkage decay in <italic>α</italic> and <italic>β</italic> was similar, we found diversity patterns at the gene level were qualitatively different (<xref rid="fig3" ref-type="fig">fig. 3A</xref>). The typical diversity at synonymous sites in <italic>β</italic> was <italic>π</italic><sub><italic>S</italic></sub> ≈ 0.04, with ~ 2× variation across genes (<xref rid="fig3" ref-type="fig">Fig. 3A</xref>), consistent with previous results <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>. In contrast, <italic>π</italic><sub><italic>S</italic></sub> in <italic>α</italic> varied wildly by over two orders of magnitude (<xref rid="fig3" ref-type="fig">Fig. 3A</xref>), ranging from <italic>π</italic><sub><italic>S</italic></sub> ≈ 0.2 in some genes, to others that did not have a single mutation. Note that because here we only used synonymous sites, these variations cannot be explained by differences in the strength of purifying selection or the accumulation of non-synonymous mutations during rapid adaptation <xref ref-type="bibr" rid="c47">Neher (2022)</xref>. Importantly, the low-diversity segments of the <italic>α</italic> genome spanned multiple samples and springs and are thus unlikely to be the result of a very recent clonal expansion as is often seen in human commensal and pathogenic bacteria <xref ref-type="bibr" rid="c19">Didelot and Wilson (2015)</xref>; <xref ref-type="bibr" rid="c25">Garud et al. (2019)</xref>; <xref ref-type="bibr" rid="c62">Sakoparnig et al. (2021)</xref>; <xref ref-type="bibr" rid="c76">Weimann et al. (2024)</xref>.</p>
<p>Beyond the low-diversity genes in <italic>α</italic>, we found genomes in both species containing segments very similar or identical to homologous regions from the other species. We performed extensive checks to verify that these segments were not assembly artifacts or cross-contamination between reaction wells during whole-genome amplification (<xref ref-type="app" rid="app10">Appendix 10</xref>). Such segments could represent accessory genes transferred between species, as has been widely reported in both Synechococcus and other species <xref ref-type="bibr" rid="c5">Bhaya et al. (2007)</xref>; <xref ref-type="bibr" rid="c66">Smillie et al. (2011)</xref>. Alternatively, they could be the result of homologous recombination with other species within the core genome. We refer to the later process as <italic>hybridization</italic> throughout. To distinguish between these two possibilities, we first identified the core genes shared by <italic>α</italic> and <italic>β</italic>.</p>
<p>We defined core genes by constructing groups of orthologous genes (orthogroups) and identifying those that were likely present in all genomes. Specifically, we clustered gene sequences in several steps using standard methods based on similarity (<xref ref-type="app" rid="app1">Appendix 1</xref>). We used phylogenetic distances to identify and separate distant paralogs within the same orthogroup. To assign clusters corresponding to each species, we analyzed the abundance distributions of orthogroups in <italic>α</italic> and <italic>β</italic> separately. Because of the incomplete nature of our genomes (average coverage ≈ 0.3, with a range of ≈ 0.05 − 0.95; see <xref ref-type="app" rid="app1">Appendix 1</xref>), the assignment has to be done statistically. Distributions for both species were bimodal, with a peak near zero corresponding to flexible genes and another at high abundances corresponding to core genes. We used a binomial fit to determine single-copy genes that were likely present in all genomes and found 1825 core <italic>α</italic> and 1737 core <italic>β</italic> orthogroups. Of these, 1448 orthogroups were shared by both <italic>α</italic> and <italic>β</italic> and make up the Synechococcus <italic>core genes</italic>. We focus the rest of our analysis on these core genes.</p>
</sec>
<sec id="s2b">
<title>Gene-level analysis reveals distinct patterns of hybridization between species</title>
<p>We first performed a quantitative comparison of the synonymous diversity between <italic>α</italic> and <italic>β</italic> across the core genes. We hypothesized that the low-diversity segments of <italic>α</italic> genome were the result of mutation accumulation since their common ancestor. If mutation rates across genes are similar, we expect the fraction of polymorphic sites <italic>f</italic><sub><italic>p</italic></sub> for each gene to follow a Poisson distribution. Empirically, we found that for <italic>f</italic><sub><italic>p</italic></sub> &lt; 0.05, the data closely matched the Poisson expectation with a single fit parameter (<xref rid="fig3" ref-type="fig">fig. 3B</xref>). This group, which we call the <italic>ancestral backbone of α</italic>, contained around half of the core genes (675 out of 1448). Note that this result is distinct from the distribution of divergences <italic>between</italic> species, which was shown previously to also follows a Poisson distribution <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>. The remaining half (773 out of 1448) had up to ten times higher fraction of segregating sites and were inconsistent with the backbone polymorphism rate. As our subsequent analysis shows, the high diversity in these genes is the result of hybridization. We therefore refer to this group as the <italic>hybrid α</italic> genes. In <italic>β</italic>, the distribution of <italic>f</italic><sub><italic>p</italic></sub> had a single peak, but a simple Poisson process was poor fit to the data (<xref rid="fig3" ref-type="fig">Fig. 3C</xref>). This suggests a substantial fraction of the diversity is not simply be due to mutations but is introduced through recombination with other strains or species. Consistent with this interpretation, we found the distribution of synonymous diversities in the hybrid <italic>α</italic> overlapped that of <italic>β</italic>, and both were two orders of magnitude higher than in the <italic>α</italic> backbone (<xref rid="fig3" ref-type="fig">Fig. 3D</xref>). These results suggest that hybridization had a large impact on the genetic diversity of both <italic>α</italic> and <italic>β</italic>. We therefore developed a method to identify hybrid segments directly and test this hypothesis.</p>
<p>We used hierarchical clustering to identify and characterize hybridization patterns between species. If hybridization is common, as in our case, inferences based on phylogenetic trees would not provide reliable estimates of pairwise divergences. We therefore used pairwise nucleotide distances directly. The distribution of pairwise distances was bimodal, with a clear gap around <italic>d</italic> = 0.075, consistent with our comparisons to the reference genomes (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). Based on this observation we defined species clusters for each gene using a simple cutoff at <italic>d</italic><sub><italic>c</italic></sub> = 0.075 (<xref rid="fig2" ref-type="fig">Fig. 2</xref> in <xref ref-type="app" rid="app1">Appendix 1</xref>) together with additional constraints to ensure that clusters were well separated and consistent with asexual divergence from a common ancestor (<xref ref-type="app" rid="app1">Appendix 1</xref>).</p>
<p>Detailed analysis of species clusters revealed evidence of hybridization in roughly half of the genome. We found two distinct patterns of hybridization. Around 75% of core genes (1078 out of 1448) had 2-3 clusters of sizes roughly proportional to abundances of <italic>α, β</italic>, and <italic>γ</italic> in the samples (<xref rid="fig1" ref-type="fig">Fig. 1</xref> in <xref ref-type="app" rid="app5">Appendix 5</xref>). The majority of these genes (844 out of 1078) had clusters each of which contained sequences from a single species (<xref rid="fig4" ref-type="fig">Fig. 4A</xref>), as expected if they were asexually diverged. We call these <italic>non-hybrid loci</italic>. A significant minority (234 out of 1078) contained a mixture of sequences from different species (<xref rid="fig4" ref-type="fig">Fig. 4B</xref>), representing recent transfers of whole genes between species. We call these <italic>simple hybrid loci</italic>. The remaining 25% of core genes (370 out of 1448) formed either a single cluster or had one very large cluster containing most sequences (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>). As we show below, these large clusters result from complex patterns of hybridization <italic>within single genes</italic>. We thus call these <italic>mosaic hybrid loci</italic>. In around a quarter of these loci we found evidence of complete or near-complete gene sweeps, but in most the divergence between <italic>α</italic> and <italic>β</italic> was typical. Almost half (297 out of 773) of high-diversity <italic>α</italic> genes were mosaic hybrids. To better understand the dynamics of hybridization in the population, we analyzed both hybridization patterns in detail, starting with the simple hybrid loci.</p>
</sec>
<sec id="s2c">
<title>Simple hybrid genes are common and reveal distinct patterns of hybridization across species</title>
<p>We used a simple set of heuristic criteria to assign the transfer direction of simple hybrids. If species evolved by asexual divergence from common ancestor, we expect each orthogroup to contain 2-3 clusters of sizes roughly proportional to the species abundances. For example, based on the average coverage and the proportion of <italic>β</italic> in our samples (<xref rid="fig1" ref-type="fig">fig. 1A</xref>), we expect the largest cluster to contain ~ 80 sequences from <italic>β</italic> genomes. In some cases (45 out of 1063), we also find a minority of sequences from <italic>α</italic> genomes in this <italic>β</italic> cluster, which we infer to be the result of a hybridization event from <italic>β</italic> into <italic>α</italic> (<xref rid="fig4" ref-type="fig">fig. 4B</xref>). An alternative explanation would be a transfer from a third species that underwent a full selective sweep through <italic>β</italic> and only a partial sweep through <italic>α</italic>. This scenario would imply that hybridization is even more common than we infer so our method is conservative. We infer transfers from <italic>α</italic> into <italic>β</italic> in a similar way (<xref rid="fig4" ref-type="fig">fig. 4B</xref>). When third cluster is present and contains <italic>γ</italic>, we assign all other sequences in the cluster to hybridization with <italic>γ</italic>. Note that we cannot distinguish between transfer <italic>from</italic> and <italic>to γ</italic> in this case. When third cluster is present but does not contain <italic>γ</italic> or in cases where we find a fourth cluster, we assign those sequences to hybridization with an unknown species <italic>X</italic>. Using this procedure, we systematically determine the frequencies of different hybridization events in <italic>α</italic> and <italic>β</italic>.</p>
<p>We found simple hybrids were present in 5 −10% of core genes in both species (<xref rid="fig5" ref-type="fig">fig. 5AB</xref>) Specifically, we found 185 simple hybrid loci in <italic>α</italic> and 68 in <italic>β</italic>. Note that we conservatively excluded contigs that were fully hybrid from this analysis so our numbers likely underestimate hybridization rates in the population (<xref ref-type="app" rid="app5">Appendix 5</xref>). In both species, simple hybrids were scattered along the genome and contained alleles from different donor species (shown in different colors in <xref rid="fig5" ref-type="fig">fig. 5AB</xref>), implying multiple hybridization events occurred independently, as expected when recombined segments are much shorter than the genome. Around 80% of <italic>α</italic> hybrid alleles were present in multiple cells, while in <italic>β</italic> the fraction was lower, at around 50%. The frequencies of simple hybrids were highly variable, ranging from singletons to frequencies close to 100%, consistent with a continual hybridization scenario. Surprisingly, around half of hybrids in <italic>β</italic> and a fifth of those in <italic>α</italic> were from unknown donors. However, a systematic search over the 34 metagenomic samples did not find evidence of other <italic>Synechococcus</italic> species in either spring (<xref ref-type="app" rid="app3">Appendix 3</xref>, <xref rid="fig5" ref-type="fig">figs. 5</xref>, <xref rid="fig6" ref-type="fig">6</xref>, <xref rid="fig7" ref-type="fig">7</xref>). These sequences could be the result of hybridization with species that were formerly present in the caldera and are now either extinct or at very low abundances. Alternatively, the hybrid sequences could have resulted from hybridization with, as yet, undiscovered species from other springs. But regardless of the exact scenario, overall, these results suggest the current population is descended from multiple cyanobacterial species that hybridized with each other.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Transfers of whole-gene alleles between species is common.</title>
<p>The frequency of hybrid gene alleles along the <italic>α</italic> (<bold>A</bold>) and <italic>β</italic> (<bold>B</bold>) genomes. Different colors show the donor species, with unknown species labeled <italic>X</italic> and shown in magenta. The orange lines on top show mosaic loci without distinct gene clusters. Note that the x-axis in (B) is shared with (C). (<bold>C</bold>) The mean synonymous divergence between <italic>α</italic> and <italic>β</italic> at homologous loci, ordered according to OS-B’. Smoothed line over a sliding window of five genes with a step size of two genes is shown in black. Maximum and minimum divergences at each locus are shown in red and blue, respectively. (Insets, middle) A zoomed-in region from a typical genomic region (left) and a diversity trough (right), with dots representing individual genes. (Insets, bottom) Alignment segments of individual genes, subsampled to 40 sequences for clarity. The first sequence is arbitrarily chosen as the reference with each nucleotide represented by a different color. Other sites are colored gray if same as reference or using nucleotide colors if mutated. Left colored bars show the species of each genome.</p></caption>
<graphic xlink:href="543983v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><title>Diversity within hybrid genes and diversity troughs reveal mixture of soft and hard sweeps.</title>
<p>(<bold>A</bold>) The distribution of synonymous diversities in <italic>α</italic> genomes in the diversity troughs (purple histogram) is compared to a random sample of genes from the <italic>α</italic> backbone of the same size (orange histogram). The orange line shows the bootstrapped distribution of the <italic>α</italic> backbone. (<bold>B</bold>) Same as (A), but comparing diversity troughs in <italic>β</italic> genomes with the <italic>β</italic> core genome. (<bold>C</bold>) Each circle shows the synonymous diversity of a non-singleton simple hybrid locus (see <xref ref-type="fig" rid="fig5">Fig. 5AB</xref>) in <italic>α</italic>. The donor species are shown in different colors as labeled on the x-axis. For transfers between <italic>α</italic> and <italic>β</italic>, the diversity within <italic>β</italic> is shown as squares of the same color as a control, with sequences from the same locus connected by a line. The orange horizontal lines shows the synonymous diversity in the low diversity <italic>α</italic> backbone. Transfers above this line likely contain multiple independent events.</p></caption>
<graphic xlink:href="543983v2_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7.</label>
<caption><title>Hybridization between species leads to mixing of short DNA segments within single genes.</title>
<p>(<bold>A</bold>, top) Alignment segment of <italic>α</italic> genomes from a representative locus with four SNP blocks. The inferred ancestral <italic>α</italic> haplotype (labeled <italic>α</italic><sub>1</sub>) is highlighted in orange and the hybrid haplotype (all <italic>β</italic> here; labeled <italic>α</italic><sub>2</sub>) is shown in blue. Note the SNPs in different blocks in differrent sets of cells. (Middle) Illustration of SNP block analysis pipeline. (Right) The consensus alignment of the two <italic>α</italic> haplotypes, <italic>β</italic>, and <italic>γ</italic> is constructed. (Left) Pairwise divergences between consensus sequences are calculated. Note that <italic>α</italic><sub>2</sub> is identical to <italic>β</italic> here. (<bold>B</bold>) The joint distribution of divergences of <italic>α</italic> SNP block haplotypes from the other species for all SNP blocks. Each point represents a haplotype with coordinates showing the divergence from <italic>β</italic> (x-axis) and <italic>γ</italic> (y-axis). The orange and blue dots show the two haplotypes from the example in (A). Marginal distributions are shown on the top and right. Note the high density of haplotypes near the axes, indicating transfer from one of the other known species. (<bold>C</bold>) Same as panel (B) for <italic>β</italic> block haplotypes. Note the much larger number of haplotypes far from the axes compared to (B), indicating transfers of unknown origin. (<bold>D</bold>) Histogram of linkage coefficients between pairs of block haplotypes at different loci for <italic>α</italic> (orange histogram) and <italic>β</italic> (blue histogram) compared to the expectation under a fully unlinked model (solid orange and blue lines, respectively).</p></caption>
<graphic xlink:href="543983v2_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2d">
<title>Soft and hard selective gene sweeps drive hybridization of whole genes</title>
<p>Is the genomic mixing between species the result of neutral processes or does positive selection for beneficial hybrids play an important role? Distinguishing between these alternatives is difficult in general, so we instead focused on cases where beneficial hybrid genes swept through the entire host species, i.e., full gene sweeps. Full gene sweeps would greatly reduce the synonymous divergence between <italic>α</italic> and <italic>β</italic>, making them much easier to detect. Visually, we observed the synonymous divergence between <italic>α</italic> and <italic>β</italic> contained several <italic>diversity troughs</italic>, in which the average diversity was well below typical values. We identified the genes contained in these troughs by imposing a simple cutoff <italic>d</italic><sub><italic>trough</italic></sub> = 0.2 on the synonymous divergence between <italic>α</italic> and <italic>β</italic>, which we chose close to the inflection point of the synonymous divergence distribution across genes (data not shown).</p>
<p>A systematic search revealed 91 very low divergence loci, spread across more than half a dozen diversity troughs (<xref rid="fig5" ref-type="fig">fig. 5C</xref>). Comparing alignments of typical genes and diversity trough genes revealed a dramatic difference in fixed substitutions between species, which can only be explained by a recent selective sweep. The largest diversity trough contained 27 genes, representing around 25% of diversity trough genes, most of which were part of a nitrogen-fixation pathway. In addition, the nitrogen fixation pathway is one of the largest genomic segments in which the gene order between <italic>α</italic> and <italic>β</italic> is conserved <xref ref-type="bibr" rid="c5">Bhaya et al. (2007)</xref>, suggesting all genes were transferred simultaneously. The most likely explanation is that at least one of the ancestors acquired the ability to fix nitrogen after it colonized the Yellowstone caldera and that this gave it a substantial selective advantage. The genetic diversity within the pathway genes gave further clues about the hybridization process. The diversity within the trough was similar in both species (<italic>π</italic><sub><italic>S</italic></sub> = 0.052 in <italic>α</italic> and <italic>π</italic><sub><italic>S</italic></sub> = 0.039 in <italic>β</italic>) and was close to the average diversity within <italic>β</italic> (<italic>π</italic><sub><italic>S</italic></sub> = 0.042), suggesting the <italic>β</italic> ancestor already had the ability to fix N when it colonized the caldera. However, the trough diversity was more than an order of magnitude larger than the diversity within the <italic>α</italic> backbone (<xref rid="fig6" ref-type="fig">Fig. 6AB</xref>). This large discrepancy strongly suggests <italic>α</italic> acquired the pathway from <italic>β</italic> through multiple independent transfers after they colonized the Yellowstone caldera.</p>
<p>We performed a similar analysis of diversity within simple hybrid genes to determine the direction and timing of transfers. We focused our analysis on <italic>α</italic>, where we had more data. Presence of hybrid genes at high frequencies suggests the hybridization process may be driven by selection. Two distinct patterns of diversity could result. If a single allele was transferred into <italic>α</italic> and then underwent a selective sweep, we would see very little diversity among the hybrid alleles. This is known as a hard sweep. Alternatively, if multiple hybrid alleles were transferred into <italic>α</italic> while undergoing a sweep, the diversity would be comparable to that in the host species. This is the pattern we observed in the diversity troughs and is known as a soft sweep.</p>
<p>We found evidence that both hard and soft sweeps contribute to hybridization in the population (<xref rid="fig6" ref-type="fig">fig. 6C</xref>). Around 15% of <italic>α</italic> simple hybrids (31 out of 153) had no diversity at all, regardless of the donor species, consistent with hard sweeps driving their spread. In the remaining 85% (122 out of 153) diversity within <italic>α</italic> was 1-2 orders of magnitude higher than the <italic>α</italic> backbone diversity. As a result, the diversity could not be due to mutation accumulation since the common <italic>α</italic> ancestor, but must have originated from multiple independent transfers—i.e., a soft sweep. We further verified the presence of soft sweeps within <italic>α</italic> by comparing the diversity of individual genes. In most cases the diversity within <italic>α</italic> at these loci was similar to <italic>β</italic>, with handful of cases <italic>α</italic> having significantly less, consistent with a subset of <italic>β</italic> alleles sweeping through the population simultaneously (<xref rid="fig6" ref-type="fig">fig. 6C</xref>).</p>
</sec>
<sec id="s2e">
<title>Recombination within hybrid genes leads to extensive genomic mixing on short genomic length scales</title>
<p>Selective sweeps of individual genes could also lead to mixing of other genomic segments from the donor species into the host population through genetic hitchhiking. If the diversity within the two hybridizing species is low, this process would result in blocks of tightly linked SNPs consisting of primarily two haplotypes, one from the host and another from the donor (<xref rid="fig7" ref-type="fig">fig. 7A</xref>). Anecdotally, we frequently observed such patterns in mosaic hybrid genes (<xref rid="fig4" ref-type="fig">figs. 4C</xref>, <xref ref-type="fig" rid="fig7">7A</xref>). We developed a systematic method to search for SNP blocks based on clustering the SNP linkage matrix. Briefly, we search for consecutive SNPs that have perfect linkage (see <xref ref-type="app" rid="app6">Appendix 6</xref>). We used <italic>α</italic> hybrid genes to calibrate our method and chose very conservative parameters to avoid false positives. Consistent with this, only around 17% of SNPs from the <italic>α</italic> hybrid genes belonged to blocks.</p>
<p>Despite the very conservative thresholds used in our algorithm, we found over one thousand SNP blocks in each species, scattered across hundreds of genes, including in highly-conserved ribosomal genes and genes in which distinct species clusters could be assigned (<xref rid="fig7" ref-type="fig">figs. 7BC</xref>; <xref ref-type="app" rid="app6">Appendix 6</xref> 1, 2). Most blocks were short, with typical lengths around 70 bp in <italic>α</italic> and around 30 bp in <italic>β</italic> (<xref ref-type="app" rid="app6">Appendix 6</xref>, <xref rid="fig1" ref-type="fig">fig. 1</xref>). The divergences between SNP block haplotypes was similar to that between species, consistent with hybridization (<xref ref-type="app" rid="app6">Appendix 6</xref>, <xref rid="fig3" ref-type="fig">fig. 3</xref>). To confirm their hybrid origin, we mapped the haplotypes from each block to the two other species in our sample. We found 66% (406 out of 605) of SNP blocks within <italic>α</italic> and 15% of those within <italic>β</italic> (128 out of 776) contained a haplotype identical to consensus of other species (<xref rid="fig7" ref-type="fig">fig. 7B</xref>). Note that we only considered blocks in which all three species were present for this comparison. In addition, we found a comparable number of blocks that were statistically similar but did not match the other species <italic>α, β, γ</italic> (<xref rid="fig7" ref-type="fig">fig. 7BC</xref>). The most likely explanation is that these blocks resulted from hybridization with other species, similar to the whole-gene hybrids found previously (<xref rid="fig5" ref-type="fig">fig. 5</xref>).</p>
<p>How much linkage is maintained between blocks? Given the relatively high divergences between species, one might expect epistatic interactions between blocks to constrain the genotypic structure of the population. Conversely, if recombination is dominant, each genome would be a mosaic of segments from the two ancestral species. To answer this question we calculated the linkage coefficients between haplotypes for each pair of blocks and compared their distribution to a fully unlinked control (see <xref ref-type="app" rid="app6">Appendix 6</xref> for details). Within the <italic>β</italic> species the two distributions were almost identical, implying that the genomes are consistent with a random mixture of block haplotypes, as was previously proposed <xref ref-type="bibr" rid="c60">Rosen et al. (2015)</xref>. Within <italic>α</italic> the linkage coefficients were statistically larger than those predicted from the unlinked control (<xref rid="fig7" ref-type="fig">fig. 7D</xref>), but the overall value was still low, with ⟨<italic>r</italic><sup>2</sup>⟩ ≈ 0.12 for data compared to ⟨<italic>r</italic><sup>2</sup>⟩ ≈ 0.05 for unlinked control. These results are consistent with the slower rate of linkage decrease within <italic>α</italic> compared to <italic>β</italic> discussed previously. We also found similar results for the linkage between hybrid gene alleles (<xref ref-type="app" rid="app4">Appendix 4</xref>). Thus, rather than finding clonal subpopulations, every one of the ~ 300 cells in our sample has a unique combination of SNP block haplotypes.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>By analyzing over 300 <italic>Synechococcus</italic> single-cell genomes, we show that hybridization plays a major role in shaping their genomic diversity. Our results suggest a simple scenario for the evolutionary history of the population (<xref rid="fig8" ref-type="fig">fig. 8</xref>; see also <xref ref-type="app" rid="app7">Appendix 7</xref>). Multiple strains were geographically separated and evolved independently into distinct species from an ancestral population. They then colonized the Yellowstone caldera after its formation around 640, 000 years ago and have since been gradually hybridizing. The presence of genes with multiple sequence clusters and previous analysis of 16S sequences <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref> suggest at least four independent colonizers, but the current population is dominated by the descendants of only three—the ancestors of <italic>α, β</italic>, and <italic>γ</italic>. The <italic>β</italic> population has been hybridizing with others and recombining with itself long enough that its genomes are a mosaic of different ancestral segments, consistent with a quasisexual population. But <italic>α</italic> still exhibits a large fraction of low-diversity genomic segments, interlaced with clearly hybridized segments. Molecular clock estimates using the low diversity regions of the <italic>α</italic> genomes suggest it emerged around 10<sup>4−5</sup> years ago and on these time scales the population is well-mixed across springs (<xref ref-type="app" rid="app9">Appendix 9</xref>, <xref rid="fig1" ref-type="fig">fig. 1</xref>). Using the hybridized genomic segments of <italic>α</italic> as a control, we also estimated the contribution of de-novo mutations to the <italic>β</italic> diversity. This analysis suggests that the ancestor of <italic>β</italic> colonized the Yellowstone caldera soon after its formation (<xref ref-type="app" rid="app7">Appendix 7</xref>).</p>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8.</label>
<caption><title>Hybridization between previously isolated lineages is main source of diversity within the population.</title>
<p>(Main panel) An illustration of the evolutionary scenario consistent with the main results of this paper. A single common ancestor (gray) for the population (<italic>t</italic><sub>0</sub>) diverged into several species (four shown here) following spatial isolation (<italic>t</italic><sub>1</sub>). The species colonized the Yellowstone caldera, represented by the yellow rectangle, at different times (<italic>t</italic><sub>2</sub>−<italic>t</italic><sub>3</sub>) and began hybridizing. This process continued up to the present (<italic>t</italic><sub>4</sub>). (Top inset) Illustration of the mechanism for generating unlinked SNP blocks through recombination between a hybrid segment (blue) containing a beneficial region (red star) and the rest of the host species (orange). Note the four distinct haplotypes highlighted at the end. (Bottom inset) Zoom in of the ancestry of a particular genome (middle) compared with the donor (orange, top) and host (green, bottom) ancestral genomes. After the initial hybridization, recombination with other host genomes (red arrows) creates a mosaic structure across a range of genomic length scales.</p></caption>
<graphic xlink:href="543983v2_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Diversity within species is often modeled using neutral processes <xref ref-type="bibr" rid="c19">Didelot and Wilson (2015)</xref>; <xref ref-type="bibr" rid="c59">Rocha (2018)</xref>; <xref ref-type="bibr" rid="c11">Chen et al. (2022)</xref>. But in this <italic>Synechococcus</italic> population, there is overwhelming evidence for the crucial role played by selection. The diversity troughs resulted from selective sweeps through the whole population that likely overcame mechanistic barriers to recombination, genetic incompatibilities, and ecological differences, evident in the apparent preferences to different temperatures of the three species. Moreover, the thousands of blocks composed of tightly linked SNPs we observe are difficult to explain through neutral drift, due to the long time it would take for them to reach observable frequencies. Instead, genetic hitchhiking during selective sweeps is by far the most likely explanation.</p>
<p>Selective sweeps of single genes through subpopulations have been argued to lead to the formation of separate ecotypes, recombination barriers, and eventual speciation <xref ref-type="bibr" rid="c14">Croucher et al. (2011)</xref>; <xref ref-type="bibr" rid="c64">Shapiro et al. (2012)</xref>. But we find multiple cases of genes from one species partially sweeping through another, sometimes via several independent transfer events. Thus gene sweeps do not necessarily lead to ecological specialization, but can do the opposite, acting to homogenize the population. Overall, the population shows abundant evidence of hybridization on a wide range of genomic scales leading to both homogenization between species—through the erosion of genomic clusters—and diversification within species.</p>
<p>Whether the erosion of genomic clusters we observe would continue indefinitely remains an open question. The hybridization process appears to be very slow: we estimate that the genomic mixing we observe occurred over at least 10<sup>4</sup> years likely started soon after <italic>α</italic> became abundant (see <xref ref-type="app" rid="app7">Appendix 7</xref>). It is therefore possible that the current population is an evolutionary transient that would eventually lead to a single hybrid population. This scenario would be contrary to the prevailing view that microbial evolution leads to increased specialization <xref ref-type="bibr" rid="c64">Shapiro et al. (2012)</xref>; <xref ref-type="bibr" rid="c29">Jain et al. (2018)</xref>. Distinguishing between these two scenarios would require a detailed understanding of how the diversity changes during the hybridization process. For example, a better theoretical understanding of how SNP correlations within and between SNP blocks change after an initial transfer could generate testable predictions about single- and multi-site frequency spectra that could be checked in the data. Some statistical features will likely be more sensitive to selective pressures that act at the whole-genome level and could help maintain clusters indefinitely. Similar approaches could shed light on the evolutionary history of other highly recombining bacteria, such as <italic>H. pylori</italic> or <italic>SAR11</italic> <xref ref-type="bibr" rid="c71">Vergin et al. (2007)</xref>; <xref ref-type="bibr" rid="c33">Kennemann et al. (2011)</xref>. Thus, how extensive hybridization affects, and is affected by, ecology and how the interplay between selection at both gene and genome scales shapes the diversity of long-term coexisting populations are intriguing questions for future work.</p>
<p>The importance of hybridization in eukaryotic evolution is increasingly being recognized but there have been few investigations in prokaryotes <xref ref-type="bibr" rid="c63">Sankararaman et al. (2014)</xref>; <xref ref-type="bibr" rid="c44">Moran et al. (2021)</xref>. Metagenomic studies on communities in acid mine drainages revealed several hybrid bacterial and archaeal populations whose genomes were mosaics of hundreds of kbp segments from two different ancestors <xref ref-type="bibr" rid="c70">Tyson et al. (2004)</xref>; <xref ref-type="bibr" rid="c41">Lo et al. (2007)</xref>. Those results are consistent with very recent hybridization, after the start of mining operations <xref ref-type="bibr" rid="c17">Denef and Banfield (2012)</xref>. Our study shows the effects of this process over much longer time scales. At the level of individual genes, evidence for hybridization has been observed among commensal and pathogenic species of <italic>Campylobacter</italic> <xref ref-type="bibr" rid="c65">Sheppard et al. (2008)</xref>; <xref ref-type="bibr" rid="c46">Mourkas et al. (2022)</xref>. But unlike the thermophilic <italic>Synechococcus</italic>, such host-associated bacteria are globally dispersed and have likely sampled many different environments, on a wide range of time scales, during their evolutionary history. It is thus difficult to identify which evolutionary forces drive their hybridization.</p>
<p>For the Yellowstone <italic>Synechococcus</italic>, a fortuitous combination of spatial separation and later mixing on the same time scales on which speciation and then hybridization can extensively shape—but not completely overwrite—their diversity, has enabled us to infer a great deal about the evolutionary history and the effects of full and partial sweeps. This provides a window into processes that shape species-level bacterial diversity. But for most bacterial populations, the effects of these processes are obscured by the broad range—and little knowledge—of the time scales on which different strains have co-occurred and are able to exchange DNA. Investigating whether hybridization plays a major role in other communities will thus require developing a predictive theory that can distinguish between possible evolutionary scenarios.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>We thank Benjamin H. Good, Alana Papula, and Freddy Bunbury for helpful comments and discussions. G.B. and D.S.F. gratefully acknowledge support from the Simons Foundation via a Postdoctoral Fellowship Award 730295 to G.B. and Sabbatical Fellowship to D.S.F. This work was also supported by NSF Grants PHY-1607606 and PHY-2210386 to D.S.F. H.S.M. was supported by the National Institutes of Health grant R01-AI-100947 to Mihai Pop. D.B. acknowledges support from the NSF/BIO-BBSRC collaborative research grant 1921429, NSF MIM grant 2125965, Joint Genome Institute Community Sequencing Project 503441 and 509352, and the Carnegie Institution for Science. Samples processed for single cell genome amplification were collected using NP Park Permits: YELL-5494 to David Ward (multi year), YELL-5660 to D.B. (2007-2008), and YELL 5694 to D.B. (2007-2009). The work (proposal: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.46936/10.25585/60001132">https://doi.org/10.46936/10.25585/60001132</ext-link>) conducted by the U.S. Department of Energy Joint Genome Institute (<ext-link ext-link-type="uri" xlink:href="https://ror.org/04xm1d337">https://ror.org/04xm1d337</ext-link>), a DOE Office of Science User Facility, is supported by the Office of Science of the U.S. Department of Energy operated under Contract No. DE-AC02-05CH11231.</p>
</ack>
<sec id="additional-info" sec-type="additional-information">
<title>Additional information</title>
<sec id="s16" sec-type="data-availability">
<title>Data and materials availability</title>
<p>All SAG assemblies and metagenome samples used in this study can be found on the JGI website (<ext-link ext-link-type="uri" xlink:href="https://genome.jgi.doe.gov/portal/">https://genome.jgi.doe.gov/portal/</ext-link>) under the project ID 503441. The analyzed data and code used to produce the results are available on GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/gbirzu/yellowstone_cyanobacteria_hybridization.git">https://github.com/gbirzu/yellowstone_cyanobacteria_hybridization.git</ext-link>).</p>
</sec>
<sec id="s14">
<title>Authors contributions</title>
<p>G.B. designed and performed the data analysis, contributed to the design the project, and wrote the paper. H.S.M. analyzed the metagenome data. R.R.M. performed the single-cell sorting, sequencing, and assembly. D.G. performed the single-cell sorting, sequencing, and assembly. D.S.F. designed and supervised the data analysis, supervised and contributed to the design of the project, and wrote the paper. D.B. supervised and contributed to the design of the project and wrote the paper.</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allewalt</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Bateson</surname> <given-names>MM</given-names></string-name>, <string-name><surname>Revsbech</surname> <given-names>NP</given-names></string-name>, <string-name><surname>Slack</surname> <given-names>K</given-names></string-name>, <string-name><surname>Ward</surname> <given-names>DM</given-names></string-name></person-group>. <article-title>Effect of Temperature and Light on Growth of and Photosynthesis by &lt;em&gt;Synechococcus&lt;/em&gt; Isolates Typical of Those Predominating in the Octopus Spring Microbial Mat Community of Yellowstone National Park</article-title>. <source>Applied and Environmental Microbiology</source>. <year>2006</year> <month>Jan</month>; <volume>72</volume>(<issue>1</issue>):<fpage>544</fpage>. <ext-link ext-link-type="uri" xlink:href="http://aem.asm.org/content/72/1/544.abstract">http://aem.asm.org/content/72/1/544.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1128/AEM.72.1.544-550.2006</pub-id>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Altschul</surname> <given-names>SF</given-names></string-name>, <string-name><surname>Gish</surname> <given-names>W</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>W</given-names></string-name>, <string-name><surname>Myers</surname> <given-names>EW</given-names></string-name>, <string-name><surname>Lipman</surname> <given-names>DJ</given-names></string-name></person-group>. <article-title>Basic local alignment search tool</article-title>. <source>Journal of Molecular Biology</source>. <year>1990</year> <month>Oct</month>; <volume>215</volume>(<issue>3</issue>):<fpage>403</fpage>–<lpage>410</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0022283605803602">http://www.sciencedirect.com/science/article/pii/S0022283605803602</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/S0022-2836(05)80360-2</pub-id>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arevalo</surname> <given-names>P</given-names></string-name>, <string-name><surname>VanInsberghe</surname> <given-names>D</given-names></string-name>, <string-name><surname>Elsherbini</surname> <given-names>J</given-names></string-name>, <string-name><surname>Gore</surname> <given-names>J</given-names></string-name>, <string-name><surname>Polz</surname> <given-names>MF</given-names></string-name></person-group>. <article-title>A Reverse Ecology Approach Based on a Biological Definition of Microbial Populations</article-title>. <source>Cell</source>. <year>2019</year> <month>Aug</month>; <volume>178</volume>(<issue>4</issue>):<fpage>820</fpage>–<lpage>834.e14</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0092867419307366">http://www.sciencedirect.com/science/article/pii/S0092867419307366</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.cell.2019.06.033</pub-id>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bao</surname> <given-names>YJ</given-names></string-name>, <string-name><surname>Shapiro</surname> <given-names>BJ</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>SW</given-names></string-name>, <string-name><surname>Ploplis</surname> <given-names>VA</given-names></string-name>, <string-name><surname>Castellino</surname> <given-names>FJ</given-names></string-name></person-group>. <article-title>Phenotypic differentiation of Streptococcus pyogenes populations is induced by recombination-driven gene-specific sweeps</article-title>. <source>Scientific Reports</source>. <year>2016</year> <month>Nov</month>; <volume>6</volume>(<issue>1</issue>):<fpage>36644</fpage>. <pub-id pub-id-type="doi">10.1038/srep36644</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/srep36644</pub-id>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bhaya</surname> <given-names>D</given-names></string-name>, <string-name><surname>Grossman</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Steunou</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Khuri</surname> <given-names>N</given-names></string-name>, <string-name><surname>Cohan</surname> <given-names>FM</given-names></string-name>, <string-name><surname>Hamamura</surname> <given-names>N</given-names></string-name>, <string-name><surname>Melendrez</surname> <given-names>MC</given-names></string-name>, <string-name><surname>Bateson</surname> <given-names>MM</given-names></string-name>, <string-name><surname>Ward</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Heidelberg</surname> <given-names>JF</given-names></string-name></person-group>. <article-title>Population level functional diversity in a microbial community revealed by comparative genomic and metagenomic analyses</article-title>. <source>The ISME Journal</source>. <year>2007</year> <month>Dec</month>; <volume>1</volume>(<issue>8</issue>):<fpage>703</fpage>–<lpage>713</lpage>. <pub-id pub-id-type="doi">10.1038/ismej.2007.46</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/ismej.2007.46</pub-id>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Birzu</surname> <given-names>G</given-names></string-name>, <string-name><surname>Hallatschek</surname> <given-names>O</given-names></string-name>, <string-name><surname>Korolev</surname> <given-names>KS</given-names></string-name></person-group>. <article-title>Fluctuations uncover a distinct class of traveling waves</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2018</year>; <volume>115</volume>(<issue>16</issue>):<fpage>E3645</fpage>–<lpage>E3654</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Birzu</surname> <given-names>G</given-names></string-name>, <string-name><surname>Hallatschek</surname> <given-names>O</given-names></string-name>, <string-name><surname>Korolev</surname> <given-names>KS</given-names></string-name></person-group>. <article-title>Genealogical structure changes as range expansions transition from pushed to pulled</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2021</year> <month>Aug</month>; <volume>118</volume>(<issue>34</issue>):<fpage>e2026746118</fpage>. <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/content/118/34/e2026746118.abstract">http://www.pnas.org/content/118/34/e2026746118.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1073/pnas.2026746118</pub-id>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Browne</surname> <given-names>HP</given-names></string-name>, <string-name><surname>Forster</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Anonye</surname> <given-names>BO</given-names></string-name>, <string-name><surname>Kumar</surname> <given-names>N</given-names></string-name>, <string-name><surname>Neville</surname> <given-names>BA</given-names></string-name>, <string-name><surname>Stares</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Goulding</surname> <given-names>D</given-names></string-name>, <string-name><surname>Lawley</surname> <given-names>TD</given-names></string-name></person-group>. <article-title>Culturing of ‘unculturable’ human microbiota reveals novel taxa and extensive sporulation</article-title>. <source>Nature</source>. <year>2016</year> <month>May</month>; <volume>533</volume>(<issue>7604</issue>):<fpage>543</fpage>– <lpage>546</lpage>. <pub-id pub-id-type="doi">10.1038/nature17645</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nature17645</pub-id>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Capella-Gutiérrez</surname> <given-names>S</given-names></string-name>, <string-name><surname>Silla-Martínez</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Gabaldónz</surname> <given-names>T</given-names></string-name></person-group>. <article-title>trimAl: a tool for automated alignment trimming in large-scale phylogenetic analyses</article-title>. <source>Bioinformatics</source>. <year>2009</year> <month>Aug</month>; <volume>25</volume>(<issue>15</issue>):<fpage>1972</fpage>–<lpage>1973</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp348</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btp348</pub-id>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname> <given-names>MY</given-names></string-name>, <string-name><surname>Teng</surname> <given-names>WK</given-names></string-name>, <string-name><surname>Zhao</surname> <given-names>L</given-names></string-name>, <string-name><surname>Hu</surname> <given-names>CX</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>YK</given-names></string-name>, <string-name><surname>Han</surname> <given-names>BP</given-names></string-name>, <string-name><surname>Song</surname> <given-names>LR</given-names></string-name>, <string-name><surname>Shu</surname> <given-names>WS</given-names></string-name></person-group>. <article-title>Comparative genomics reveals insights into cyanobacterial evolution and habitat adaptation</article-title>. <source>The ISME Journal</source>. <year>2020</year> <month>Sep</month>; <volume>15</volume>:<fpage>211</fpage>–<lpage>227</lpage> <pub-id pub-id-type="doi">10.1038/s41396-020-00775-z</pub-id>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Song</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Zeng</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Luo</surname> <given-names>H.</given-names></string-name></person-group> <article-title>Prochlorococcus have low global mutation rate and small effective population size</article-title>. <source>Nature Ecology &amp; Evolution</source>. <year>2022</year> <month>Feb</month>; <volume>6</volume>(<issue>2</issue>):<fpage>183</fpage>–<lpage>194</lpage>. <pub-id pub-id-type="doi">10.1038/s41559-021-01591-0</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/s41559-021-01591-0</pub-id>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cohan</surname> <given-names>FM</given-names></string-name></person-group>. <article-title>What are Bacterial Species?</article-title> <source>Annual Review of Microbiology</source>. <year>2002</year> <month>Oct</month>; <volume>56</volume>(<issue>1</issue>):<fpage>457</fpage>–<lpage>487</lpage>. <pub-id pub-id-type="doi">10.1146/annurev.micro.56.012302.160634</pub-id>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Coyne</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Orr</surname> <given-names>HA</given-names></string-name></person-group>. <source>Speciation</source>. <publisher-loc>Sunderland, Mass</publisher-loc>.: <publisher-name>Sinauer Associates</publisher-name>; <year>2004</year>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Fraser</surname> <given-names>C</given-names></string-name>, <string-name><surname>Quail</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Burton</surname> <given-names>J</given-names></string-name>, <string-name><surname>van der Linden</surname> <given-names>M</given-names></string-name>, <string-name><surname>McGee</surname> <given-names>L</given-names></string-name>, <string-name><surname>von Gottberg</surname> <given-names>A</given-names></string-name>, <string-name><surname>Song</surname> <given-names>JH</given-names></string-name>, <string-name><surname>Ko</surname> <given-names>KS</given-names></string-name>, <string-name><surname>Pichon</surname> <given-names>B</given-names></string-name>, <string-name><surname>Baker</surname> <given-names>S</given-names></string-name>, <string-name><surname>Parry</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Lambertsen</surname> <given-names>LM</given-names></string-name>, <string-name><surname>Shahinas</surname> <given-names>D</given-names></string-name>, <string-name><surname>Pillai</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Mitchell</surname> <given-names>TJ</given-names></string-name>, <string-name><surname>Dougan</surname> <given-names>G</given-names></string-name>, <string-name><surname>Tomasz</surname> <given-names>A</given-names></string-name>, <string-name><surname>Klugman</surname> <given-names>KP</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Rapid Pneumococcal Evolution in Response to Clinical Interventions</article-title>. <source>Science</source>. <year>2011</year> <month>Jan</month>; <volume>331</volume>(<issue>6016</issue>):<fpage>430</fpage>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/331/6016/430.abstract">http://science.sciencemag.org/content/331/6016/430.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1126/science.1198545</pub-id>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Croucher</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Page</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Connor</surname> <given-names>TR</given-names></string-name>, <string-name><surname>Delaney</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Keane</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Bentley</surname> <given-names>SD</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J</given-names></string-name>, <string-name><surname>Harris</surname> <given-names>SR</given-names></string-name></person-group>. <article-title>Rapid phylogenetic analysis of large samples of recombinant bacterial whole genome sequences using Gubbins</article-title>. <source>Nucleic Acids Research</source>. <year>2014</year> <month>Nov</month>; <volume>43</volume>(<issue>3</issue>):<fpage>e15</fpage>–<lpage>e15</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gku1196</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/nar/gku1196</pub-id>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Darling</surname> <given-names>AC</given-names></string-name>, <string-name><surname>Mau</surname> <given-names>B</given-names></string-name>, <string-name><surname>Blattner</surname> <given-names>FR</given-names></string-name>, <string-name><surname>Perna</surname> <given-names>NT</given-names></string-name></person-group>. <article-title>Mauve: multiple alignment of conserved genomic sequence with rearrangements</article-title>. <source>Genome research</source>. <year>2004</year>; <volume>14</volume>(<issue>7</issue>):<fpage>1394</fpage>–<lpage>1403</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Denef</surname> <given-names>VJ</given-names></string-name>, <string-name><surname>Banfield</surname> <given-names>JF</given-names></string-name></person-group>. <article-title>In Situ Evolutionary Rate Measurements Show Ecological Success of Recently Emerged Bacterial Hybrids</article-title>. <source>Science</source>. <year>2012</year>; <volume>336</volume>(<issue>6080</issue>):<fpage>462</fpage>–<lpage>466</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname> <given-names>X</given-names></string-name>, <string-name><surname>Maiden</surname> <given-names>MCJ</given-names></string-name></person-group>. <article-title>Impact of recombination on bacterial evolution</article-title>. <source>Trends in Microbiology</source>. <year>2010</year> <month>Jul</month>; <volume>18</volume>(<issue>7</issue>):<fpage>315</fpage>–<lpage>322</lpage> doi: <pub-id pub-id-type="doi">10.1016/j.tim.2010.04.002</pub-id>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Didelot</surname> <given-names>X</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>DJ</given-names></string-name></person-group>. <article-title>ClonalFrameML: Effcient Inference of Recombination in Whole Bacterial Genomes</article-title>. <source>PLOS Computational Biology</source>. <year>2015</year> <month>Feb</month>; <volume>11</volume>(<issue>2</issue>):<fpage>e1004041</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004041</pub-id>, doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1004041</pub-id>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname> <given-names>W</given-names></string-name>, <string-name><surname>Baumdicker</surname> <given-names>F</given-names></string-name>, <string-name><surname>Neher</surname> <given-names>RA</given-names></string-name></person-group>. <article-title>panX: pan-genome analysis and exploration</article-title>. <source>Nucleic Acids Research</source>. <year>2018</year> <month>Jan</month>; <volume>46</volume>(<issue>1</issue>):<fpage>e5</fpage>–<lpage>e5</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkx977</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/nar/gkx977</pub-id>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diop</surname> <given-names>A</given-names></string-name>, <string-name><surname>Torrance</surname> <given-names>EL</given-names></string-name>, <string-name><surname>Stott</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Bobay</surname> <given-names>LM</given-names></string-name></person-group>. <article-title>Gene flow and introgression are pervasive forces shaping the evolution of bacterial species</article-title>. <source>Genome Biology</source>. <year>2022</year> <month>Nov</month>; <volume>23</volume>(<issue>1</issue>):<fpage>239</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-022-02809-5</pub-id>, doi: <pub-id pub-id-type="doi">10.1186/s13059-022-02809-5</pub-id>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Emms</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Kelly</surname> <given-names>S.</given-names></string-name></person-group> <article-title>OrthoFinder: solving fundamental biases in whole genome comparisons dramatically improves orthogroup inference accuracy</article-title>. <source>Genome Biology</source>. <year>2015</year> <month>Aug</month>; <volume>16</volume>(<issue>1</issue>):<fpage>157</fpage>. <pub-id pub-id-type="doi">10.1186/s13059-015-0721-2</pub-id>, doi: <pub-id pub-id-type="doi">10.1186/s13059-015-0721-2</pub-id>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Enright</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Van Dongen</surname> <given-names>S</given-names></string-name>, <string-name><surname>Ouzounis</surname> <given-names>CA</given-names></string-name></person-group>. <article-title>An effcient algorithm for large-scale detection of protein families</article-title>. <source>Nucleic Acids Research</source>. <year>2002</year> <month>Apr</month>; <volume>30</volume>(<issue>7</issue>):<fpage>1575</fpage>–<lpage>1584</lpage>. <pub-id pub-id-type="doi">10.1093/nar/30.7.1575</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/nar/30.7.1575</pub-id>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fraser</surname> <given-names>C</given-names></string-name>, <string-name><surname>Alm</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Polz</surname> <given-names>MF</given-names></string-name>, <string-name><surname>Spratt</surname> <given-names>BG</given-names></string-name>, <string-name><surname>Hanage</surname> <given-names>WP</given-names></string-name></person-group>. <article-title>The Bacterial Species Challenge: Making Sense of Genetic and Ecological Diversity</article-title>. <source>Science</source>. <year>2009</year> <month>Feb</month>; <volume>323</volume>(<issue>5915</issue>):<fpage>741</fpage>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/323/5915/741.abstract">http://science.sciencemag.org/content/323/5915/741.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1126/science.1159388</pub-id>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garud</surname> <given-names>NR</given-names></string-name>, <string-name><surname>Good</surname> <given-names>BH</given-names></string-name>, <string-name><surname>Hallatschek</surname> <given-names>O</given-names></string-name>, <string-name><surname>Pollard</surname> <given-names>KS</given-names></string-name></person-group>. <article-title>Evolutionary dynamics of bacteria in the gut microbiome within and across hosts</article-title>. <source>PLOS Biology</source>. <year>2019</year> <month>Jan</month>; <volume>17</volume>(<issue>1</issue>):<fpage>e3000102</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pbio.3000102</pub-id>, doi: <pub-id pub-id-type="doi">10.1371/journal.pbio.3000102</pub-id>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gibbons</surname> <given-names>TR</given-names></string-name>, <string-name><surname>Mount</surname> <given-names>SM</given-names></string-name>, <string-name><surname>Cooper</surname> <given-names>ED</given-names></string-name>, <string-name><surname>Delwiche</surname> <given-names>CF</given-names></string-name></person-group>. <article-title>Evaluation of BLAST-based edge-weighting metrics used for homology inference with the Markov Clustering algorithm</article-title>. <source>BMC bioinformatics</source>. <year>2015</year>; <volume>16</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>14</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hanson</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Fuhrman</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Horner-Devine</surname> <given-names>MC</given-names></string-name>, <string-name><surname>Martiny</surname> <given-names>JBH</given-names></string-name></person-group>. <article-title>Beyond biogeographic patterns: processes shaping the microbial landscape</article-title>. <source>Nature Reviews Microbiology</source>. <year>2012</year> <month>Jul</month>; <volume>10</volume>(<issue>7</issue>):<fpage>497</fpage>–<lpage>506</lpage>. <pub-id pub-id-type="doi">10.1038/nrmicro2795</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nrmicro2795</pub-id>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hudson</surname> <given-names>RR</given-names></string-name></person-group>. <article-title>The sampling distribution of linkage disequilibrium under an infinte allele model without selection</article-title>. <source>Genetics</source>. <year>1985</year> <month>Mar</month>; <volume>109</volume>(<issue>3</issue>):<fpage>611</fpage>. <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/content/109/3/611.abstract">http://www.genetics.org/content/109/3/611.abstract</ext-link>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jain</surname> <given-names>C</given-names></string-name>, <string-name><surname>Rodriguez-R</surname> <given-names>LM</given-names></string-name>, <string-name><surname>Phillippy</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Konstantinidis</surname> <given-names>KT</given-names></string-name>, <string-name><surname>Aluru</surname> <given-names>S.</given-names></string-name></person-group> <article-title>High throughput ANI analysis of 90K prokaryotic genomes reveals clear species boundaries</article-title>. <source>Nature Communications</source>. <year>2018</year> <month>Nov</month>; <volume>9</volume>(<issue>1</issue>):<fpage>5114</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-018-07641-9</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/s41467-018-07641-9</pub-id>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Jukes</surname> <given-names>TH</given-names></string-name>, <string-name><surname>Cantor</surname> <given-names>CR</given-names></string-name></person-group>. <chapter-title>Evolution of Protein Molecules</chapter-title>. In: <person-group person-group-type="editor"><string-name><surname>Munro</surname> <given-names>HN</given-names></string-name></person-group>, editor. <source>Mammalian Protein Metabolism</source> <publisher-name>Academic Press</publisher-name>; <year>1969</year>.p. <fpage>21</fpage>–<lpage>132</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/B9781483232119500097">http://www.sciencedirect.com/science/article/pii/B9781483232119500097</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/B978-1-4832-3211-9.50009-7</pub-id>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kashtan</surname> <given-names>N</given-names></string-name>, <string-name><surname>Roggensack</surname> <given-names>SE</given-names></string-name>, <string-name><surname>Rodrigue</surname> <given-names>S</given-names></string-name>, <string-name><surname>Thompson</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Biller</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Coe</surname> <given-names>A</given-names></string-name>, <string-name><surname>Ding</surname> <given-names>H</given-names></string-name>, <string-name><surname>Marttinen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Malmstrom</surname> <given-names>RR</given-names></string-name>, <string-name><surname>Stocker</surname> <given-names>R</given-names></string-name>, <string-name><surname>Follows</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Stepanauskas</surname> <given-names>R</given-names></string-name>, <string-name><surname>Chisholm</surname> <given-names>SW</given-names></string-name></person-group>. <article-title>Single-Cell Genomics Reveals Hundreds of Coexisting Subpopulations in Wild &lt;em&gt;Prochlorococcus&lt;/em&gt;</article-title>. <source>Science</source>. <year>2014</year> <month>Apr</month>; <volume>344</volume>(<issue>6182</issue>):<fpage>416</fpage>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/344/6182/416.abstract">http://science.sciencemag.org/content/344/6182/416.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1126/science.1248575</pub-id>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Katoh</surname> <given-names>K</given-names></string-name>, <string-name><surname>Standley</surname> <given-names>DM</given-names></string-name></person-group>. <article-title>MAFFT Multiple Sequence Alignment Software Version 7: Improvements in Performance and Usability</article-title>. <source>Molecular Biology and Evolution</source>. <year>2013</year> <month>Apr</month>; <volume>30</volume>(<issue>4</issue>):<fpage>772</fpage>–<lpage>780</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/molbev/mst010</pub-id>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kennemann</surname> <given-names>L</given-names></string-name>, <string-name><surname>Didelot</surname> <given-names>X</given-names></string-name>, <string-name><surname>Aebischer</surname> <given-names>T</given-names></string-name>, <string-name><surname>Kuhn</surname> <given-names>S</given-names></string-name>, <string-name><surname>Drescher</surname> <given-names>B</given-names></string-name>, <string-name><surname>Droege</surname> <given-names>M</given-names></string-name>, <string-name><surname>Reinhardt</surname> <given-names>R</given-names></string-name>, <string-name><surname>Correa</surname> <given-names>P</given-names></string-name>, <string-name><surname>Meyer</surname> <given-names>TF</given-names></string-name>, <string-name><surname>Josenhans</surname> <given-names>C</given-names></string-name>, <string-name><surname>Falush</surname> <given-names>D</given-names></string-name>, <string-name><surname>Suerbaum</surname> <given-names>S.</given-names></string-name></person-group> <article-title>Helicobacter pylori genome evolution during human infection</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2011</year> <month>Mar</month>; <volume>108</volume>(<issue>12</issue>):<fpage>5033</fpage>–<lpage>5038</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1018444108</pub-id>, doi: <pub-id pub-id-type="doi">10.1073/pnas.1018444108</pub-id>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klatt</surname> <given-names>CG</given-names></string-name>, <string-name><surname>Wood</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Rusch</surname> <given-names>DB</given-names></string-name>, <string-name><surname>Bateson</surname> <given-names>MM</given-names></string-name>, <string-name><surname>Hamamura</surname> <given-names>N</given-names></string-name>, <string-name><surname>Heidelberg</surname> <given-names>JF</given-names></string-name>, <string-name><surname>Grossman</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Bhaya</surname> <given-names>D</given-names></string-name>, <string-name><surname>Cohan</surname> <given-names>FM</given-names></string-name>, <string-name><surname>Kühl</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bryant</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Ward</surname> <given-names>DM</given-names></string-name></person-group>. <article-title>Community ecology of hot spring cyanobacterial mats: predominant populations and their functional potential</article-title>. <source>The ISME Journal</source>. <year>2011</year> <month>Aug</month>; <volume>5</volume>(<issue>8</issue>):<fpage>1262</fpage>–<lpage>1278</lpage>. <pub-id pub-id-type="doi">10.1038/ismej.2011.73</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/ismej.2011.73</pub-id>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kriventseva</surname> <given-names>EV</given-names></string-name>, <string-name><surname>Rahman</surname> <given-names>N</given-names></string-name>, <string-name><surname>Espinosa</surname> <given-names>O</given-names></string-name>, <string-name><surname>Zdobnov</surname> <given-names>EM</given-names></string-name></person-group>. <article-title>OrthoDB: the hierarchical catalog of eukaryotic orthologs</article-title>. <source>Nucleic Acids Research</source>. <year>2007</year> <month>Oct</month>; <volume>36</volume>:<fpage>D271</fpage>–<lpage>D275</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gkm845</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/nar/gkm845</pub-id>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Langmead</surname> <given-names>B</given-names></string-name>, <string-name><surname>Salzberg</surname> <given-names>SL</given-names></string-name></person-group>. <article-title>Fast gapped-read alignment with Bowtie 2</article-title>. <source>Nature Methods</source>. <year>2012</year> <month>Apr</month>; <volume>9</volume>(<issue>4</issue>):<fpage>357</fpage>–<lpage>359</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nmeth.1923</pub-id>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname> <given-names>H</given-names></string-name>, <string-name><surname>Popodi</surname> <given-names>E</given-names></string-name>, <string-name><surname>Tang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Foster</surname> <given-names>PL</given-names></string-name></person-group>. <article-title>Rate and molecular spectrum of spontaneous mutations in the bacterium Escherichia coli as determined by whole-genome sequencing</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2012</year>; <volume>109</volume>(<issue>41</issue>):<fpage>E2774</fpage>–<lpage>E2783</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1210309109</pub-id>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname> <given-names>H</given-names></string-name>, <string-name><surname>Handsaker</surname> <given-names>B</given-names></string-name>, <string-name><surname>Wysoker</surname> <given-names>A</given-names></string-name>, <string-name><surname>Fennell</surname> <given-names>T</given-names></string-name>, <string-name><surname>Ruan</surname> <given-names>J</given-names></string-name>, <string-name><surname>Homer</surname> <given-names>N</given-names></string-name>, <string-name><surname>Marth</surname> <given-names>G</given-names></string-name>, <string-name><surname>Abecasis</surname> <given-names>G</given-names></string-name>, <string-name><surname>Durbin</surname> <given-names>R</given-names></string-name>, <collab>1000 Genome Project Data Processing Subgroup</collab></person-group>. <article-title>The Sequence Alignment/Map format and SAMtools</article-title>. <source>Bioinformatics</source>. <year>2009</year> <month>Jun</month>; <volume>25</volume>(<issue>16</issue>):<fpage>2078</fpage>–<lpage>2079</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btp352</pub-id>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kussell</surname> <given-names>E.</given-names></string-name></person-group> <article-title>Correlated Mutations and Homologous Recombination Within Bacterial Populations</article-title>. <source>Genetics</source>. <year>2017</year> <month>Feb</month>; <volume>205</volume>(<issue>2</issue>):<fpage>891</fpage>. <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/content/205/2/891.abstract">http://www.genetics.org/content/205/2/891.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1534/genetics.116.189621</pub-id>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kussell</surname> <given-names>E.</given-names></string-name></person-group> <article-title>Inferring bacterial recombination rates from large-scale sequencing datasets</article-title>. <source>Nature Methods</source>. <year>2019</year> <month>Feb</month>; <volume>16</volume>(<issue>2</issue>):<fpage>199</fpage>–<lpage>204</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-018-0293-7</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/s41592-018-0293-7</pub-id>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lo</surname> <given-names>I</given-names></string-name>, <string-name><surname>Denef</surname> <given-names>VJ</given-names></string-name>, <string-name><surname>VerBerkmoes</surname> <given-names>NC</given-names></string-name>, <string-name><surname>Shah</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Goltsman</surname> <given-names>D</given-names></string-name>, <string-name><surname>DiBartolo</surname> <given-names>G</given-names></string-name>, <string-name><surname>Tyson</surname> <given-names>GW</given-names></string-name>, <string-name><surname>Allen</surname> <given-names>EE</given-names></string-name>, <string-name><surname>Ram</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Detter</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Richardson</surname> <given-names>P</given-names></string-name>, <string-name><surname>Thelen</surname> <given-names>MP</given-names></string-name>, <string-name><surname>Hettich</surname> <given-names>RL</given-names></string-name>, <string-name><surname>Banfield</surname> <given-names>JF</given-names></string-name></person-group>. <article-title>Strain-resolved community proteomics reveals recombining genomes of acidophilic bacteria</article-title>. <source>Nature</source>. <year>2007</year> <month>Mar</month>; <volume>446</volume>(<issue>7135</issue>):<fpage>537</fpage>–<lpage>541</lpage>. <pub-id pub-id-type="doi">10.1038/nature05624</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nature05624</pub-id>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meyer-Dombard</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Swingley</surname> <given-names>W</given-names></string-name>, <string-name><surname>Raymond</surname> <given-names>J</given-names></string-name>, <string-name><surname>Havig</surname> <given-names>J</given-names></string-name>, <string-name><surname>Shock</surname> <given-names>EL</given-names></string-name>, <string-name><surname>Summons</surname> <given-names>RE</given-names></string-name></person-group>. <article-title>Hydrothermal ecotones and streamer biofilm communities in the Lower Geyser Basin, Yellowstone National Park</article-title>. <source>Environmental Microbiology</source>. <year>2011</year> <month>Aug</month>; <volume>13</volume>(<issue>8</issue>):<fpage>2216</fpage>–<lpage>2231</lpage>. <pub-id pub-id-type="doi">10.1111/j.1462-2920.2011.02476.x</pub-id>, doi: <pub-id pub-id-type="doi">10.1111/j.14622920.2011.02476.x</pub-id>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname> <given-names>SR</given-names></string-name>, <string-name><surname>Carvey</surname> <given-names>D.</given-names></string-name></person-group> <article-title>Ecological Divergence with Gene Flow in a Thermophilic Cyanobacterium</article-title>. <source>Microbial Ecology</source>. <year>2019</year> <month>Jul</month>; <volume>78</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>41</lpage>. <pub-id pub-id-type="doi">10.1007/s00248-018-1267-0</pub-id>, doi: <pub-id pub-id-type="doi">10.1007/s00248-018-1267-0</pub-id>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moran</surname> <given-names>BM</given-names></string-name>, <string-name><surname>Payne</surname> <given-names>C</given-names></string-name>, <string-name><surname>Langdon</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Powell</surname> <given-names>DL</given-names></string-name>, <string-name><surname>Brandvain</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Schumer</surname> <given-names>M.</given-names></string-name></person-group> <article-title>The genomic consequences of hybridization</article-title>. <source>eLife</source>. <year>2021</year> <month>Aug</month>; <volume>10</volume>:<fpage>e69016</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.69016</pub-id>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moran</surname> <given-names>NA</given-names></string-name>, <string-name><surname>McLaughlin</surname> <given-names>HJ</given-names></string-name>, <string-name><surname>Sorek</surname> <given-names>R.</given-names></string-name></person-group> <article-title>The Dynamics and Time Scale of Ongoing Genomic Erosion in Symbiotic Bacteria</article-title>. <source>Science</source>. <year>2009</year>; <volume>323</volume>(<issue>5912</issue>):<fpage>379</fpage>–<lpage>382</lpage>. <pub-id pub-id-type="doi">10.1126/science.1167140</pub-id>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mourkas</surname> <given-names>E</given-names></string-name>, <string-name><surname>Yahara</surname> <given-names>K</given-names></string-name>, <string-name><surname>Bayliss</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Calland</surname> <given-names>JK</given-names></string-name>, <string-name><surname>Johansson</surname> <given-names>H</given-names></string-name>, <string-name><surname>Mageiros</surname> <given-names>L</given-names></string-name>, <string-name><surname>Muñoz-Ramirez</surname> <given-names>ZY</given-names></string-name>, <string-name><surname>Futcher</surname> <given-names>G</given-names></string-name>, <string-name><surname>Méric</surname> <given-names>G</given-names></string-name>, <string-name><surname>Hitchings</surname> <given-names>MD</given-names></string-name>, <string-name><surname>Sandoval-Motta</surname> <given-names>S</given-names></string-name>, <string-name><surname>Torres</surname> <given-names>J</given-names></string-name>, <string-name><surname>Jolley</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Maiden</surname> <given-names>MC</given-names></string-name>, <string-name><surname>Ellström</surname> <given-names>P</given-names></string-name>, <string-name><surname>Waldenström</surname> <given-names>J</given-names></string-name>, <string-name><surname>Pascoe</surname> <given-names>B</given-names></string-name>, <string-name><surname>Sheppard</surname> <given-names>SK</given-names></string-name></person-group>. <article-title>Host ecology regulates interspecies recombination in bacteria of the genus Campylobacter</article-title>. <source>eLife</source>. <year>2022</year> <month>Feb</month>; <volume>11</volume>:<fpage>e73552</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.73552</pub-id>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Neher</surname> <given-names>RA</given-names></string-name></person-group>. <article-title>Contributions of adaptation and purifying selection to SARS-CoV-2 evolution</article-title>. <source>Virus Evolution</source>. <year>2022</year> <month>Jul</month>; <volume>8</volume>(<issue>2</issue>):<fpage>veac113</fpage>. <pub-id pub-id-type="doi">10.1093/ve/veac113</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/ve/veac113</pub-id>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Neher</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Hallatschek</surname> <given-names>O.</given-names></string-name></person-group> <article-title>Genealogies of rapidly adapting populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2013</year> <month>Jan</month>; <volume>110</volume>(<issue>2</issue>):<fpage>437</fpage>–<lpage>42</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3545819&amp;tool=pmcentrez&amp;rendertype=abstract">http://www.pubmedcentral.nih.gov/articlerender.fcgi?artid=3545819&amp;tool=pmcentrez&amp;rendertype=abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1073/pnas.1213113110</pub-id>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nei</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gojobori</surname> <given-names>T.</given-names></string-name></person-group> <article-title>Simple methods for estimating the numbers of synonymous and nonsynonymous nucleotide substitutions</article-title>. <source>Molecular Biology and Evolution</source>. <year>1986</year> <month>Sep</month>; <volume>3</volume>(<issue>5</issue>):<fpage>418</fpage>–<lpage>426</lpage>. <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040410</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/oxfordjournals.molbev.a040410</pub-id>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ohta</surname> <given-names>T</given-names></string-name>, <string-name><surname>Kimura</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Linkage disequilibrium at steady state determined by random genetic drift and recurrent mutation</article-title>. <source>Genetics</source>. <year>1969</year> <month>Sep</month>; <volume>63</volume>(<issue>1</issue>):<fpage>229</fpage>–<lpage>238</lpage>. <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pubmed/5365295">https://www.ncbi.nlm.nih.gov/pubmed/5365295</ext-link>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Page</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Cummins</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Hunt</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wong</surname> <given-names>VK</given-names></string-name>, <string-name><surname>Reuter</surname> <given-names>S</given-names></string-name>, <string-name><surname>Holden</surname> <given-names>MTG</given-names></string-name>, <string-name><surname>Fookes</surname> <given-names>M</given-names></string-name>, <string-name><surname>Falush</surname> <given-names>D</given-names></string-name>, <string-name><surname>Keane</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Parkhill</surname> <given-names>J.</given-names></string-name></person-group> <article-title>Roary: rapid large-scale prokaryote pan genome analysis</article-title>. <source>Bioinformatics</source>. <year>2015</year> <month>Nov</month>; <volume>31</volume>(<issue>22</issue>):<fpage>3691</fpage>–<lpage>3693</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btv421</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btv421</pub-id>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Papke</surname> <given-names>RT</given-names></string-name>, <string-name><surname>Ramsing</surname> <given-names>NB</given-names></string-name>, <string-name><surname>Bateson</surname> <given-names>MM</given-names></string-name>, <string-name><surname>Ward</surname> <given-names>DM</given-names></string-name></person-group>. <article-title>Geographical isolation in hot spring cyanobacteria</article-title>. <source>Environmental Microbiology</source>. <year>2003</year>; <volume>5</volume>(<issue>8</issue>):<fpage>650</fpage>–<lpage>659</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname> <given-names>MN</given-names></string-name>, <string-name><surname>Dehal</surname> <given-names>PS</given-names></string-name>, <string-name><surname>Arkin</surname> <given-names>AP</given-names></string-name></person-group>. <article-title>FastTree 2 – Approximately Maximum-Likelihood Trees for Large Alignments</article-title>. <source>PLOS ONE</source>. <year>2010</year> <month>Mar</month>; <volume>5</volume>(<issue>3</issue>):<fpage>e9490</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0009490</pub-id>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quast</surname> <given-names>C</given-names></string-name>, <string-name><surname>Pruesse</surname> <given-names>E</given-names></string-name>, <string-name><surname>Yilmaz</surname> <given-names>P</given-names></string-name>, <string-name><surname>Gerken</surname> <given-names>J</given-names></string-name>, <string-name><surname>Schweer</surname> <given-names>T</given-names></string-name>, <string-name><surname>Yarza</surname> <given-names>P</given-names></string-name>, <string-name><surname>Peplies</surname> <given-names>J</given-names></string-name>, <string-name><surname>Glöckner</surname> <given-names>FO</given-names></string-name></person-group>. <article-title>The SILVA ribosomal RNA gene database project: improved data processing and web-based tools</article-title>. <source>Nucleic Acids Research</source>. <year>2013</year> <month>Jan</month>; <volume>41</volume>(<issue>D1</issue>):<fpage>D590</fpage>–<lpage>D596</lpage>. <pub-id pub-id-type="doi">10.1093/nar/gks1219</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/nar/gks1219</pub-id>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Quinlan</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Hall</surname> <given-names>IM</given-names></string-name></person-group>. <article-title>BEDTools: a flexible suite of utilities for comparing genomic features</article-title>. <source>Bioinformatics</source>. <year>2010</year> <month>Mar</month>; <volume>26</volume>(<issue>6</issue>):<fpage>841</fpage>–<lpage>842</lpage>. <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/bioinformatics/btq033</pub-id>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rinke</surname> <given-names>C</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>J</given-names></string-name>, <string-name><surname>Nath</surname> <given-names>N</given-names></string-name>, <string-name><surname>Goudeau</surname> <given-names>D</given-names></string-name>, <string-name><surname>Thompson</surname> <given-names>B</given-names></string-name>, <string-name><surname>Poulton</surname> <given-names>N</given-names></string-name>, <string-name><surname>Dmitrieff</surname> <given-names>E</given-names></string-name>, <string-name><surname>Malmstrom</surname> <given-names>R</given-names></string-name>, <string-name><surname>Stepanauskas</surname> <given-names>R</given-names></string-name>, <string-name><surname>Woyke</surname> <given-names>T.</given-names></string-name></person-group> <article-title>Obtaining genomes from uncultivated environmental microorganisms using FACS–based singlecell genomics</article-title>. <source>Nature Protocols</source>. <year>2014</year> <month>May</month>; <volume>9</volume>(<issue>5</issue>):<fpage>1038</fpage>–<lpage>1048</lpage>. <pub-id pub-id-type="doi">10.1038/nprot.2014.067</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nprot.2014.067</pub-id>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rinke</surname> <given-names>C</given-names></string-name>, <string-name><surname>Schwientek</surname> <given-names>P</given-names></string-name>, <string-name><surname>Sczyrba</surname> <given-names>A</given-names></string-name>, <string-name><surname>Ivanova</surname> <given-names>NN</given-names></string-name>, <string-name><surname>Anderson</surname> <given-names>IJ</given-names></string-name>, <string-name><surname>Cheng</surname> <given-names>JF</given-names></string-name>, <string-name><surname>Darling</surname> <given-names>A</given-names></string-name>, <string-name><surname>Malfatti</surname> <given-names>S</given-names></string-name>, <string-name><surname>Swan</surname> <given-names>BK</given-names></string-name>, <string-name><surname>Gies</surname> <given-names>EA</given-names></string-name>, <string-name><surname>Dodsworth</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Hedlund</surname> <given-names>BP</given-names></string-name>, <string-name><surname>Tsiamis</surname> <given-names>G</given-names></string-name>, <string-name><surname>Sievert</surname> <given-names>SM</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>WT</given-names></string-name>, <string-name><surname>Eisen</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Hallam</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Kyrpides</surname> <given-names>NC</given-names></string-name>, <string-name><surname>Stepanauskas</surname> <given-names>R</given-names></string-name>, <string-name><surname>Rubin</surname> <given-names>EM</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Insights into the phylogeny and coding potential of microbial dark matter</article-title>. <source>Nature</source>. <year>2013</year> <month>Jul</month>; <volume>499</volume>(<issue>7459</issue>):<fpage>431</fpage>–<lpage>437</lpage>. <pub-id pub-id-type="doi">10.1038/nature12352</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nature12352</pub-id>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rivera</surname> <given-names>MC</given-names></string-name>, <string-name><surname>Jain</surname> <given-names>R</given-names></string-name>, <string-name><surname>Moore</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Lake</surname> <given-names>JA</given-names></string-name></person-group>. <article-title>Genomic evidence for two functionally distinct gene classes</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1998</year> <month>May</month>; <volume>95</volume>(<issue>11</issue>):<fpage>6239</fpage>–<lpage>6244</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.95.11.6239</pub-id>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rocha</surname> <given-names>EPC</given-names></string-name></person-group>. <article-title>Neutral Theory, Microbial Practice: Challenges in Bacterial Population Genetics</article-title>. <source>Molecular Biology and Evolution</source>. <year>2018</year> <month>Jun</month>; <volume>35</volume>(<issue>6</issue>):<fpage>1338</fpage>–<lpage>1347</lpage>. <pub-id pub-id-type="doi">10.1093/molbev/msy078</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/molbev/msy078</pub-id>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rosen</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Davison</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bhaya</surname> <given-names>D</given-names></string-name>, <string-name><surname>Fisher</surname> <given-names>DS</given-names></string-name></person-group>. <article-title>Fine-scale diversity and extensive recombination in a quasisexual bacterial population occupying a broad niche</article-title>. <source>Science</source>. <year>2015</year> <month>May</month>; <volume>348</volume>(<issue>6238</issue>):<fpage>1019</fpage>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/348/6238/1019.abstract">http://science.sciencemag.org/content/348/6238/1019.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1126/science.aaa4456</pub-id>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rosen</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Davison</surname> <given-names>M</given-names></string-name>, <string-name><surname>Fisher</surname> <given-names>DS</given-names></string-name>, <string-name><surname>Bhaya</surname> <given-names>D.</given-names></string-name></person-group> <article-title>Probing the ecological and evolutionary history of a thermophilic cyanobacterial population via statistical properties of its microdiversity</article-title>. <source>PLOS One</source>. <year>2018</year> <month>Nov</month>; <volume>13</volume>(<issue>11</issue>):<fpage>e0205396</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pone.0205396</pub-id>, doi: <pub-id pub-id-type="doi">10.1371/journal.pone.0205396</pub-id>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sakoparnig</surname> <given-names>T</given-names></string-name>, <string-name><surname>Field</surname> <given-names>C</given-names></string-name>, <string-name><surname>van Nimwegen</surname> <given-names>E.</given-names></string-name></person-group> <article-title>Whole genome phylogenies reflect the distributions of recombination rates for many bacterial species</article-title>. <source>eLife</source>. <year>2021</year> <month>Jan</month>; <volume>10</volume>:<fpage>e65366</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.65366</pub-id>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sankararaman</surname> <given-names>S</given-names></string-name>, <string-name><surname>Mallick</surname> <given-names>S</given-names></string-name>, <string-name><surname>Dannemann</surname> <given-names>M</given-names></string-name>, <string-name><surname>Prüfer</surname> <given-names>K</given-names></string-name>, <string-name><surname>Kelso</surname> <given-names>J</given-names></string-name>, <string-name><surname>Pääbo</surname> <given-names>S</given-names></string-name>, <string-name><surname>Patterson</surname> <given-names>N</given-names></string-name>, <string-name><surname>Reich</surname> <given-names>D.</given-names></string-name></person-group> <article-title>The genomic landscape of Neanderthal ancestry in present-day humans</article-title>. <source>Nature</source>. <year>2014</year> <month>Mar</month>; <volume>507</volume>(<issue>7492</issue>):<fpage>354</fpage>–<lpage>357</lpage>. <pub-id pub-id-type="doi">10.1038/nature12961</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nature12961</pub-id>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shapiro</surname> <given-names>BJ</given-names></string-name>, <string-name><surname>Friedman</surname> <given-names>J</given-names></string-name>, <string-name><surname>Cordero</surname> <given-names>OX</given-names></string-name>, <string-name><surname>Preheim</surname> <given-names>SP</given-names></string-name>, <string-name><surname>Timberlake</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Szabó</surname> <given-names>G</given-names></string-name>, <string-name><surname>Polz</surname> <given-names>MF</given-names></string-name>, <string-name><surname>Alm</surname> <given-names>EJ</given-names></string-name></person-group>. <article-title>Population Genomics of Early Events in the Ecological Differentiation of Bacteria</article-title>. <source>Science</source>. <year>2012</year> <month>Apr</month>; <volume>336</volume>(<issue>6077</issue>):<fpage>48</fpage>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/336/6077/48.abstract">http://science.sciencemag.org/content/336/6077/48.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1126/science.1218198</pub-id>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sheppard</surname> <given-names>SK</given-names></string-name>, <string-name><surname>McCarthy</surname> <given-names>ND</given-names></string-name>, <string-name><surname>Falush</surname> <given-names>D</given-names></string-name>, <string-name><surname>Maiden</surname> <given-names>MCJ</given-names></string-name></person-group>. <article-title>Convergence of &lt;em&gt;Campylobacter&lt;/em&gt; Species: Implications for Bacterial Evolution</article-title>. <source>Science</source>. <year>2008</year> <month>Apr</month>; <volume>320</volume>(<issue>5873</issue>):<fpage>237</fpage>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/320/5873/237.abstract">http://science.sciencemag.org/content/320/5873/237.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1126/science.1155532</pub-id>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smillie</surname> <given-names>CS</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>MB</given-names></string-name>, <string-name><surname>Friedman</surname> <given-names>J</given-names></string-name>, <string-name><surname>Cordero</surname> <given-names>OX</given-names></string-name>, <string-name><surname>David</surname> <given-names>LA</given-names></string-name>, <string-name><surname>Alm</surname> <given-names>EJ</given-names></string-name></person-group>. <article-title>Ecology drives a global network of gene exchange connecting the human microbiome</article-title>. <source>Nature</source>. <year>2011</year> <month>Dec</month>; <volume>480</volume>(<issue>7376</issue>):<fpage>241</fpage>–<lpage>244</lpage>. <pub-id pub-id-type="doi">10.1038/nature10571</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nature10571</pub-id>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sniegowski</surname> <given-names>PD</given-names></string-name>, <string-name><surname>Gerrish</surname> <given-names>PJ</given-names></string-name>, <string-name><surname>Lenski</surname> <given-names>RE</given-names></string-name></person-group>. <article-title>Evolution of high mutation rates in experimental populations of E. coli</article-title>. <source>Nature</source>. <year>1997</year> <month>Jun</month>; <volume>387</volume>(<issue>6634</issue>):<fpage>703</fpage>–<lpage>705</lpage>. <pub-id pub-id-type="doi">10.1038/42701</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/42701</pub-id>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname> <given-names>YS</given-names></string-name>, <string-name><surname>Song</surname> <given-names>JS</given-names></string-name></person-group>. <article-title>Analytic computation of the expectation of the linkage disequilibrium coeffcient r2</article-title>. <source>Theoretical Population Biology</source>. <year>2007</year> <month>Feb</month>; <volume>71</volume>(<issue>1</issue>):<fpage>49</fpage>–<lpage>60</lpage>. <ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0040580906001158">http://www.sciencedirect.com/science/article/pii/S0040580906001158</ext-link>, doi: <pub-id pub-id-type="doi">10.1016/j.tpb.2006.09.001</pub-id>.</mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stepanauskas</surname> <given-names>R</given-names></string-name>, <string-name><surname>Fergusson</surname> <given-names>EA</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>J</given-names></string-name>, <string-name><surname>Poulton</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Tupper</surname> <given-names>B</given-names></string-name>, <string-name><surname>Labonté</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Becraft</surname> <given-names>ED</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Pachiadaki</surname> <given-names>MG</given-names></string-name>, <string-name><surname>Povilaitis</surname> <given-names>T</given-names></string-name>, <string-name><surname>Thompson</surname> <given-names>BP</given-names></string-name>, <string-name><surname>Mascena</surname> <given-names>CJ</given-names></string-name>, <string-name><surname>Bellows</surname> <given-names>WK</given-names></string-name>, <string-name><surname>Lubys</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Improved genome recovery and integrated cell-size analyses of individual uncultured microbial cells and viral particles</article-title>. <source>Nature Communications</source>. <year>2017</year> <month>Jul</month>; <volume>8</volume>(<issue>1</issue>):<fpage>84</fpage>. <pub-id pub-id-type="doi">10.1038/s41467-017-00128-z</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/s41467-017-00128-z</pub-id>.</mixed-citation></ref>
<ref id="c70"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tyson</surname> <given-names>GW</given-names></string-name>, <string-name><surname>Chapman</surname> <given-names>J</given-names></string-name>, <string-name><surname>Hugenholtz</surname> <given-names>P</given-names></string-name>, <string-name><surname>Allen</surname> <given-names>EE</given-names></string-name>, <string-name><surname>Ram</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Richardson</surname> <given-names>PM</given-names></string-name>, <string-name><surname>Solovyev</surname> <given-names>VV</given-names></string-name>, <string-name><surname>Rubin</surname> <given-names>EM</given-names></string-name>, <string-name><surname>Rokhsar</surname> <given-names>DS</given-names></string-name>, <string-name><surname>Banfield</surname> <given-names>JF</given-names></string-name></person-group>. <article-title>Community structure and metabolism through reconstruction of microbial genomes from the environment</article-title>. <source>Nature</source>. <year>2004</year> <month>Mar</month>; <volume>428</volume>(<issue>6978</issue>):<fpage>37</fpage>–<lpage>43</lpage>. <pub-id pub-id-type="doi">10.1038/nature02340</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nature02340</pub-id>.</mixed-citation></ref>
<ref id="c71"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vergin</surname> <given-names>KL</given-names></string-name>, <string-name><surname>Tripp</surname> <given-names>HJ</given-names></string-name>, <string-name><surname>Wilhelm</surname> <given-names>LJ</given-names></string-name>, <string-name><surname>Denver</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Rappé</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Giovannoni</surname> <given-names>SJ</given-names></string-name></person-group>. <article-title>High intraspecific recombination rate in a native population of Candidatus Pelagibacter ubique (SAR11)</article-title>. <source>Environmental Microbiology</source>. <year>2007</year>; <volume>9</volume>(<issue>10</issue>):<fpage>2430</fpage>–<lpage>2440</lpage>.</mixed-citation></ref>
<ref id="c72"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Virtanen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Gommers</surname> <given-names>R</given-names></string-name>, <string-name><surname>Oliphant</surname> <given-names>TE</given-names></string-name>, <string-name><surname>Haberland</surname> <given-names>M</given-names></string-name>, <string-name><surname>Reddy</surname> <given-names>T</given-names></string-name>, <string-name><surname>Cournapeau</surname> <given-names>D</given-names></string-name>, <string-name><surname>Burovski</surname> <given-names>E</given-names></string-name>, <string-name><surname>Peterson</surname> <given-names>P</given-names></string-name>, <string-name><surname>Weckesser</surname> <given-names>W</given-names></string-name>, <string-name><surname>Bright</surname> <given-names>J</given-names></string-name>, <string-name><surname>van der Walt</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Brett</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>J</given-names></string-name>, <string-name><surname>Millman</surname> <given-names>KJ</given-names></string-name>, <string-name><surname>Mayorov</surname> <given-names>N</given-names></string-name>, <string-name><surname>Nelson</surname> <given-names>ARJ</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>E</given-names></string-name>, <string-name><surname>Kern</surname> <given-names>R</given-names></string-name>, <string-name><surname>Larson</surname> <given-names>E</given-names></string-name>, <string-name><surname>Carey</surname> <given-names>CJ</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nature Methods</source>. <year>2020</year> <month>Mar</month>; <volume>17</volume>(<issue>3</issue>):<fpage>261</fpage>–<lpage>272</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/s41592-019-0686-2</pub-id>.</mixed-citation></ref>
<ref id="c73"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ward</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Bateson</surname> <given-names>MM</given-names></string-name>, <string-name><surname>Ferris</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Kühl</surname> <given-names>M</given-names></string-name>, <string-name><surname>Wieland</surname> <given-names>A</given-names></string-name>, <string-name><surname>Koeppel</surname> <given-names>A</given-names></string-name>, <string-name><surname>Cohan</surname> <given-names>FM</given-names></string-name></person-group>. <article-title>Cyanobacterial ecotypes in the microbial mat community of Mushroom Spring (Yellowstone National Park, Wyoming) as species-like units linking microbial community composition, structure and function</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>. <year>2006</year> <month>Nov</month>; <volume>361</volume>(<issue>1475</issue>):<fpage>1997</fpage>–<lpage>2008</lpage>. <pub-id pub-id-type="doi">10.1098/rstb.2006.1919</pub-id>.</mixed-citation></ref>
<ref id="c74"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Ward</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Castenholz</surname> <given-names>RW</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>SR</given-names></string-name></person-group>. <chapter-title>Cyanobacteria in geothermal habitats</chapter-title>. <person-group person-group-type="editor"><string-name><surname>Whitton</surname> <given-names>BA</given-names></string-name></person-group> <source>Ecology of cyanobacteria II: their diversity in space and time</source> <publisher-name>Springer Dordrecht</publisher-name>; <year>2012</year>.p. <fpage>39</fpage>–<lpage>63</lpage>. Publisher: <publisher-name>Springer</publisher-name>.</mixed-citation></ref>
<ref id="c75"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ward</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Ferris</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Nold</surname> <given-names>SC</given-names></string-name>, <string-name><surname>Bateson</surname> <given-names>MM</given-names></string-name></person-group>. <article-title>A Natural View of Microbial Biodiversity within Hot Spring Cyanobacterial Mat Communities</article-title>. <source>Microbiology and Molecular Biology Reviews</source>. <year>1998</year> <month>Dec</month>; <volume>62</volume>(<issue>4</issue>):<fpage>1353</fpage>. <ext-link ext-link-type="uri" xlink:href="http://mmbr.asm.org/content/62/4/1353.abstract">http://mmbr.asm.org/content/62/4/1353.abstract</ext-link>.</mixed-citation></ref>
<ref id="c76"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weimann</surname> <given-names>A</given-names></string-name>, <string-name><surname>Dinan</surname> <given-names>AM</given-names></string-name>, <string-name><surname>Ruis</surname> <given-names>C</given-names></string-name>, <string-name><surname>Bernut</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pont</surname> <given-names>S</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>K</given-names></string-name>, <string-name><surname>Ryan</surname> <given-names>J</given-names></string-name>, <string-name><surname>Santos</surname> <given-names>L</given-names></string-name>, <string-name><surname>Ellison</surname> <given-names>L</given-names></string-name>, <string-name><surname>Ukor</surname> <given-names>E</given-names></string-name>, <string-name><surname>Pandurangan</surname> <given-names>AP</given-names></string-name>, <string-name><surname>Krokowski</surname> <given-names>S</given-names></string-name>, <string-name><surname>Blundell</surname> <given-names>TL</given-names></string-name>, <string-name><surname>Welch</surname> <given-names>M</given-names></string-name>, <string-name><surname>Blane</surname> <given-names>B</given-names></string-name>, <string-name><surname>Judge</surname> <given-names>K</given-names></string-name>, <string-name><surname>Bousfield</surname> <given-names>R</given-names></string-name>, <string-name><surname>Brown</surname> <given-names>N</given-names></string-name>, <string-name><surname>Bryant</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Kukavica-Ibrulj</surname> <given-names>I</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Evolution and host-specific adaptation of Pseudomonas aeruginosa</article-title>. <source>Science</source>. <year>2024</year>; <volume>385</volume>(<issue>6704</issue>):<fpage>eadi0908</fpage>. <pub-id pub-id-type="doi">10.1126/science.adi0908</pub-id>.</mixed-citation></ref>
<ref id="c77"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weissman</surname> <given-names>DB</given-names></string-name>, <string-name><surname>Hallatschek</surname> <given-names>O.</given-names></string-name></person-group> <article-title>The Rate of Adaptation in Large Sexual Populations with Linear Chromosomes</article-title>. <source>Genetics</source>. <year>2014</year> <month>Apr</month>; <volume>196</volume>(<issue>4</issue>):<fpage>1167</fpage>. <ext-link ext-link-type="uri" xlink:href="http://www.genetics.org/content/196/4/1167.abstract">http://www.genetics.org/content/196/4/1167.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1534/genetics.113.160705</pub-id>.</mixed-citation></ref>
<ref id="c78"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whitaker</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Grogan</surname> <given-names>DW</given-names></string-name>, <string-name><surname>Taylor</surname> <given-names>JW</given-names></string-name></person-group>. <article-title>Geographic Barriers Isolate Endemic Populations of Hyperthermophilic Archaea</article-title>. <source>Science</source>. <year>2003</year> <month>Aug</month>; <volume>301</volume>(<issue>5635</issue>):<fpage>976</fpage>. <ext-link ext-link-type="uri" xlink:href="http://science.sciencemag.org/content/301/5635/976.abstract">http://science.sciencemag.org/content/301/5635/976.abstract</ext-link>, doi: <pub-id pub-id-type="doi">10.1126/science.1086909</pub-id>.</mixed-citation></ref>
<ref id="c79"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Eisen</surname> <given-names>JA</given-names></string-name></person-group>. <article-title>A simple, fast, and accurate method of phylogenomic inference</article-title>. <source>Genome Biology</source>. <year>2008</year> <month>Oct</month>; <volume>9</volume>(<issue>10</issue>):<fpage>R151</fpage>. <pub-id pub-id-type="doi">10.1186/gb-2008-9-10-r151</pub-id>, doi: <pub-id pub-id-type="doi">10.1186/gb-2008-9-10-r151</pub-id>.</mixed-citation></ref>
<ref id="c80"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yahara</surname> <given-names>K</given-names></string-name>, <string-name><surname>Didelot</surname> <given-names>X</given-names></string-name>, <string-name><surname>Jolley</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Kobayashi</surname> <given-names>I</given-names></string-name>, <string-name><surname>Maiden</surname> <given-names>MCJ</given-names></string-name>, <string-name><surname>Sheppard</surname> <given-names>SK</given-names></string-name>, <string-name><surname>Falush</surname> <given-names>D.</given-names></string-name></person-group> <article-title>The Landscape of Realized Homologous Recombination in Pathogenic Bacteria</article-title>. <source>Molecular Biology and Evolution</source>. <year>2015</year> <month>Oct</month>; <volume>33</volume>(<issue>2</issue>):<fpage>456</fpage>– <pub-id pub-id-type="doi">10.1093/molbev/msv237</pub-id>, doi: <pub-id pub-id-type="doi">10.1093/molbev/msv237</pub-id>.</mixed-citation></ref>
<ref id="c81"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yarza</surname> <given-names>P</given-names></string-name>, <string-name><surname>Yilmaz</surname> <given-names>P</given-names></string-name>, <string-name><surname>Pruesse</surname> <given-names>E</given-names></string-name>, <string-name><surname>Glöckner</surname> <given-names>FO</given-names></string-name>, <string-name><surname>Ludwig</surname> <given-names>W</given-names></string-name>, <string-name><surname>Schleifer</surname> <given-names>KH</given-names></string-name>, <string-name><surname>Whitman</surname> <given-names>WB</given-names></string-name>, <string-name><surname>Euzéby</surname> <given-names>J</given-names></string-name>, <string-name><surname>Amann</surname> <given-names>R</given-names></string-name>, <string-name><surname>Rosselló-Móra</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Uniting the classification of cultured and uncultured bacteria and archaea using 16S rRNA gene sequences</article-title>. <source>Nature Reviews Microbiology</source>. <year>2014</year> <month>Sep</month>; <volume>12</volume>(<issue>9</issue>):<fpage>635</fpage>–<lpage>645</lpage>. <pub-id pub-id-type="doi">10.1038/nrmicro3330</pub-id>, doi: <pub-id pub-id-type="doi">10.1038/nrmicro3330</pub-id>.</mixed-citation></ref>
<ref id="c82"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname> <given-names>W</given-names></string-name>, <string-name><surname>Zhao</surname> <given-names>S</given-names></string-name>, <string-name><surname>Yin</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Needham</surname> <given-names>DM</given-names></string-name>, <string-name><surname>Evans</surname> <given-names>ED</given-names></string-name>, <string-name><surname>Dai</surname> <given-names>CL</given-names></string-name>, <string-name><surname>Lu</surname> <given-names>PJ</given-names></string-name>, <string-name><surname>Alm</surname> <given-names>EJ</given-names></string-name>, <string-name><given-names>David A</given-names> <surname>Weitz</surname></string-name></person-group>. <article-title>High-throughput, single-microbe genomics with strain resolution, applied to a human gut microbiome</article-title>. <source>Science</source>. <year>2022</year>; <volume>376</volume>(<issue>6597</issue>):<fpage>eabm1483</fpage> <pub-id pub-id-type="doi">10.1126/science.abm1483</pub-id>.</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<title>Appendix 1</title>
<sec id="s4">
<title>Materials and methods</title>
<sec id="s4a">
<title>Sample collection and sequencing</title>
<p>Cork borers (approximate diameter 0.5 to 1 mm) were used to collect mat core samples from Octopus Spring (44.53401N, 110.79781W) and Mushroom Spring (44.53861N, 110.79791W). Samples were collected in 2005, 2006, 2007 and 2009 under YNP Park Permits (YELL-5494, YELL-5660, YELL 5694). Cores were immediately frozen until later use. Frozen samples were shipped to the Joint Genome Institute (JGI) in 2019, where they were processed and sequenced.</p>
<p>At JGI, for disaggregation of sample, frozen mat cores were cut into pieces using a razor blade on glass over dry ice and aliquoted chunks of approximately 5 mm diameter. Next, 500 μl PBS and 50 μl of 500 mM NaEDTA were added. Samples were vortexed briefly, sonicated for 1 minute on benchtop sonicator, vortexed briefly again. Passed 25 times through a 25 gauge needle and run through a 35 μm strainer cap. Next, 100 μl were placed in 900 μl PBS and stain with SYBR Green at 1X. Samples were run on the Influx with Gate SYBR+ Cells and Gate 670/30 off of 632 autofluoresence. Next samples were sorted on a BD influx following the protocol outlined in Ref. <xref ref-type="bibr" rid="c56">Rinke et al. (2014)</xref>, and single-cells genomes were amplified with WGAX protocol as described in Ref. <xref ref-type="bibr" rid="c69">Stepanauskas et al. (2017)</xref>. Certain samples from plate YuBhay.Octo06.RedA.3 received an additional treatment with lysozyme (20 min at room temp in 50 U/μl prior to alkaline lysis) because of difficulty lysing the cells. Otherwise, they followed the standard alkaline lysis described in Ref. <xref ref-type="bibr" rid="c69">Stepanauskas et al. (2017)</xref>. In brief, libraries were made with Nextera XT v2 kits and sequenced on an Illumina Novseq in 2 × 150 bp mode. Reads were assembled into contigs and annotated using the Integrated Microbial Genomes (IMG) platform as described in Ref. <xref ref-type="bibr" rid="c57">Rinke et al. (2013)</xref>. All of the data generated for this study is available on the JGI website, under the project ID 503441.</p>
</sec>
<sec id="s4b">
<title>Data processing</title>
<fig id="figA1_1" position="float" fig-type="figure">
<label>Appendix 1—figure 1.</label>
<caption><title>The genome coverage across SAGs is highly variable.</title>
<p>The SAG coverage, defined as the total length of contigs, is shown for all 331 SAGs (after quality control). SAGs were grouped by species (see 2) sorted in descending order of coverage within each species. The solid orange and blue horizontal lines show the genome sizes of OS-A and OS-B’. The dashed orange and blue lines show the threshold used to define high-coverage SAGs. The values of the thresholds are set at 75% of the length of the reference genomes.</p></caption>
<graphic xlink:href="543983v2_figA1_1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In this section we describe the procedure we used to process the single-amplified genomes (SAGs). Our analysis is based on grouping genes into orthologous gene clusters or <italic>orthogroups</italic>, which are then analyzed separately. This procedure makes it much easier to analyze the fragmented and incomplete genomes resulting from single-cell sequencing (<xref rid="figA1_1" ref-type="fig">Fig. 1</xref>) compared multiple sequence alignment (MSA) of entire genomes, which are sometimes used for analyzing genomes obtained from isolates. An alternative approach is to align the assemblies or even the raw reads to reference genomes. In our case, there are only two reference genomes available, OS-A and OS-B’, so aligning to them would likely result in biases in the inferred diversity.</p>
<p>There are several ways of constructing orthogroups: 1. pairwise comparisons, or 2. graph methods. Graph methods have the advantage that they produce sets of mutually homologous genes so we decided to use this approach. There are several packages available for identifying homologous gene clusters among samples of different genomes. Most widely-used packages, such as OrthoDB <xref ref-type="bibr" rid="c35">Kriventseva et al. (2007)</xref> and OrthoFinder <xref ref-type="bibr" rid="c22">Emms and Kelly (2015)</xref>, were designed for finding homologs between different eukaryotic species and are inappropriate for studying large bacterial pangenomes <xref ref-type="bibr" rid="c20">Ding et al. (2018)</xref>. More recently, several groups have developed packages that allow for efficient construction of large bacterial pangenomes <xref ref-type="bibr" rid="c51">Page et al. (2015)</xref>; <xref ref-type="bibr" rid="c20">Ding et al. (2018)</xref>. However, such packages are primarily aimed at studying large collection of isolate genomes and were not designed to handle samples with low genome coverage, which are common in single-cell sequencing projects such as ours. As a result we implemented a custom pipeline for processing the single-cell genome assemblies and constructing the pangenome from these sequences. The pipeline is divided into two parts: 1. a pre-processsing step where assemblies are filtered for contamination and checked for misassemblies and misannotations, and 2. a gene clustering step, in which clusters of homologous genes are identified and paralogs are separated from true orthologs. The second half of the pipeline closely follows the approach taken in Ref. <xref ref-type="bibr" rid="c20">Ding et al. (2018)</xref>. A more detailed outline of the pipeline is given below. For details on our definition of the core genome and the assignment of sequence clusters within orthogroups to different species see Sec. 5.</p>
</sec>
<sec id="s4c">
<title>Outline of data processing pipeline</title>
<list list-type="order">
<list-item><p>Data pre-processing</p></list-item>
<list-item><p>Orthogroup clustering</p></list-item>
<list-item><p>Orthogroup MSA</p></list-item>
<list-item><p>Deep branch splitting</p></list-item>
<list-item><p>Orthogroup species clustering</p></list-item>
<list-item><p>Reference genome mapping</p></list-item>
</list>
<p>The rest of this section explains how each step in the pipeline was performed. Readers not interested in the details may wish to move on to the next section.</p>
<sec id="s4c1">
<label>1.</label>
<title>Data pre-processing</title>
<p>The goal of this step is to remove 1. SAGs from non-Synechococcus OS species, 2. SAGs that might have resulted from sequencing multiple cell in the same reaction well, and 3. contigs that might be the result of contamination from external DNA or other sequencing wells. We first removed all SAGs that were positive controls in which multiple cells were amplified in the same reaction well (all SAGs from the third column of the 384-well plate in our case). We then aligned all of the genes in our data to the OS-A and OS-B’ reference genomes using BLAST (alignment parameters: <monospace>-evalue 1E-10 -word_size</monospace> <monospace>8 -qcov_hsp_perc 75.0</monospace>). We then removed all SAGs with &gt; 50% of genes that did not map to either reference genome.The remaining SAGs are assumed to be from Synechococcus OS cells. Next, we filtered out all contigs without any hits to OS-A and OS-B’.This was done to avoid external DNA or cross-contamination from affecting the rate of hybridization we observed.</p>
<p>Next, we removed any remaining SAGs that were suspected to have been the result of sequencing multiple cells in the same well. We reasoned that sequencing multiple cells would lead to an increase in the number of duplicated genes in the SAG. We used the probability of sampling a gene with more than one copy in the two reference genomes, both ~ 10%, as a benchmark and removed all SAGs with a multicopy frequency &gt; 20%.</p>
<p>Preliminary analysis of the data following the above filtering procedure revealed the existence of a small number of palindromic contigs, in which the first half of the sequence was mirrored exactly in the second half, that were very likely the result of assembly artifacts. To remove these artifacts we labeled the genes in each contig based on the hits to the reference genomes and used these to search for palindromic sequences within each contigs. We then removed any contig that contained a palindromic subsequence that was either longer than 4 genes or contained &gt; 50% of genes in the contig. Finally, we removed all partial genes from the remaining contigs to simplify the analysis of the multiple-sequence alignments (MSA), which we perfomed next.</p>
</sec>
<sec id="s4c2">
<label>2.</label>
<title>Orthogroup clustering</title>
<p>The goal of this step is to obtain clusters of orthologous genes or <italic>orthogroups</italic>, which were used in subsequent analysis. To do this we followed Refs. <xref ref-type="bibr" rid="c51">Page et al. (2015)</xref>; <xref ref-type="bibr" rid="c20">Ding et al. (2018)</xref> and used a Markov clustering algorithm to find groups of sequences that were similar to each other and well-separated from all other sequences <xref ref-type="bibr" rid="c23">Enright et al. (2002)</xref>. The Markov clustering algorithm takes as input a similarity graph, where each node represents a gene sequence and the weight of each edge represents the similarity between the two sequences.</p>
<p>We constructed the gene similarity graph by translating all of the gene sequences in the filtered dataset and performing an all-to-all protein alignment using BLAST (alignment parameters: <monospace>-evalue 1E-3 -word_size 3 -qcov_hsp_perc 75.0</monospace>). Other approaches either perform a pre-alignment clustering <xref ref-type="bibr" rid="c51">Page et al. (2015)</xref> or use faster but less sensitive methods for all-to-all alignments <xref ref-type="bibr" rid="c20">Ding et al. (2018)</xref>, but we found that this was not necessary in our case. The higher sensitivity provided by BLAST could help distinguish between paralogs within large gene families and minimize gene misassignments, but we did not extensively test how the performance would be affected by using other methods. We used the bitscore from the alignments to define the weight of each edge in the similarity graph. Using the bitscore instead of the e-value is a simple way to correct for the minimum e-value of 1<italic>E</italic> −180 in BLAST and has been shown previously to improve the clustering performance <xref ref-type="bibr" rid="c26">Gibbons et al. (2015)</xref>.</p>
<p>We used MCL (v. 14-137) to cluster the resulting similarity graph and obtain orthogroups <xref ref-type="bibr" rid="c23">Enright et al. (2002)</xref>. We used a relatively small inflation parameter (<monospace>-I 1.5</monospace>) in order to cluster genes aggressively and used subsequent steps in the pipeline to split clusters resulting from incorrect cluster assignments or the presence of paralogs (steps 5 and 6). As a first step, we did an additional clustering based on sequence length as follows. We constructed a graph in which all sequences in an orthogroup were represented as nodes and edges where attached between pairs of sequences if the difference between their lengths was less than 30% of their average length. We then identified all connected components in this graph. Because homologous genes in OS-A and OS-B’ sometimes have different lengths, we hypothesized that each orthgroup should contain at most two main clusters. We therefore used the following heuristic algorithm to filter out orthogroups with unusual gene length patterns that could possibly result from overly aggressive clustering. If a single length cluster was present or the largest cluster contained &gt; 80% of sequences, only the sequences from the largest cluster were kept and the rest were removed. If two clusters accounted for &gt; 80% of sequences, only the sequences in those two clusters were kept and the rest removed. In all other cases we removed the orthogroup from our dataset and did not include it in subsequent analysis.</p>
</sec>
<sec id="s4c3">
<label>3.</label>
<title>Orthogroup MSA</title>
<p>The filtered orthogroups from the previous step were aligned using a custom codon-aware alignment algorithm. Briefly, nucleotide sequences were translated into protein sequences and aligned using MAFFT (v. 7.475 with default parameters) <xref ref-type="bibr" rid="c32">Katoh and Standley (2013)</xref>. The alignments were then reverse-translated using nucleotide sequences as templates. After alignment, phylogenetic trees for each orthogroup were constructed using FastTree (v. 2.1.11 with parameters <monospace>-nj -noml</monospace>) <xref ref-type="bibr" rid="c53">Price et al. (2010)</xref>.</p>
</sec>
<sec id="s4c4">
<label>4.</label>
<title>Deep branch splitting</title>
<p>In this step we separated gene clusters within the initial orthogroups that were joined by unsually long branches in the phylogenetic tree. Specifically, we implemented the following algorithm. For each orthogroup, we checked the branch length for each node in the phylogenetic tree and grouped any sequences with a branch length greater than a cutoff value <italic>b</italic><sub><italic>c</italic></sub> = 0.3 into separate orthogroups. Each newly-created orthogroup was realigned as in step 3 and the procedure was repeated until no new orthogroups could be separated. We used the results from previous analysis of homologous genes in OS-A and OS-B’, which showed that typical divergences were ~ 0.15 <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>, as a benchmark to set <italic>b</italic><sub><italic>c</italic></sub>. Based on those results, we expected very few genuine homologs with divergences above <italic>b</italic><sub><italic>c</italic></sub> = 0.3. The clusters that resulted after this step represent the final orthogroups that were used in subsequent analysis.</p>
</sec>
<sec id="s4c5">
<label>5.</label>
<title>Orthogroup species clustering</title>
<p>We next sought to determine which orthogroups could be reliably partitioned into distinct species clusters, which would be expected if the different species asexually diverged from a common ancestor. To do this, we implemented the following algorithm in a custom Python script. For each orthogroup, the alignments were trimmed to remove excess gaps at the edges using a custom script. We then calculated the fraction of sites with different nucleotide between each pair of sequences and hierarchically clustered the sequences using average linkage as implemented in the Python Scipy package (v. 1.9.3) <xref ref-type="bibr" rid="c72">Virtanen et al. (2020)</xref>. Preliminary clusters were assigned using a distance cutoff <italic>d</italic><sub><italic>c</italic></sub> = 0.075 (<xref rid="figA1_2" ref-type="fig">Fig. 2</xref>). To ensure that the clusters were well-separated and robust we implemented an additional check by requiring that the minimum distance between any two sequences from different clusters be at least <italic>c</italic> = 1.5 times greater than the maximum distance between any two sequences within either cluster. Any clusters which did not satisfy this criterion were designated as <italic>mosaic orthogroups</italic>. We validated the robustness of the cluster assignments by <italic>d</italic><sub><italic>c</italic></sub> and <italic>c</italic> and found only small changes in the results.</p>
<fig id="figA1_2" position="float" fig-type="figure">
<label>Appendix 1—figure 2.</label>
<caption><title>Distribution of pairwise nucleotide distances within orthogroups shows clear gap around <italic>π</italic><sub><italic>ij</italic></sub> ≈ 0.075.</title>
<p>(<bold>A</bold>) Histogram of nucleotide distances between all pairs of cells across the 1,448 core orthogroups. The dashed red line showns the distance cutoff used to define species clusters (<italic>d</italic><sub><italic>c</italic></sub> = 0.075). (<bold>B</bold>) Distribution of orthogroups according to the number of species clusters. Species clusters were generated as described in the text using the distance cutoff shown in (A).</p></caption>
<graphic xlink:href="543983v2_figA1_2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Manual examination of the mosaic orthogroup alignments revealed a small fraction with a large number of gaps. Such alignments could be the result of rapidly evolving genes in the presence of hybridization, but may also result from misalignments or the inclusion of non-orthologous sequences during the orthogroup construction. To simplify subsequent analysis we therefore removed mosaic orthogroups with an unusually high fraction of gaps.</p>
</sec>
<sec id="s4c6">
<label>6.</label>
<title>Mapping to reference</title>
<p>For this step we use reciprocal best hit (RBH) given by BLAST to map the consensus sequences to the OS-A and OS-B’ reference CDS. Since at this point in the pipeline most sequences within one OG are less that 10% diverged from each other, we use nucleotide sequences for this step to increase the accuracy of the mapping. The consensus sequence for each OG is constructed by _nding at the consensus codon at each residue along the CDS after replacing all codons containing gaps by a gap codon. The resulting sequences that have RBH to OS-B’ are mapped onto those respective genes. The genes without RBH to OS-B’ are searched against OS-A and mapped to it if an RBH is found.</p>
</sec>
</sec>
</sec>
</app>
<app id="app2">
<title>Appendix 2</title>
<sec id="s5">
<title>SAG species assignment</title>
<p>In this section, we outline the method we used to assign genomes to each species cluster. We also verify the robustness of the species assignment by using three different methods and show that they give identical results.</p>
<p>Comparisons of genomes from bacterial populations often reveal clusters at different length and divergence scales <xref ref-type="bibr" rid="c29">Jain et al. (2018)</xref>. But the interpretation of such clusters is controversial <xref ref-type="bibr" rid="c12">Cohan (2002)</xref>; <xref ref-type="bibr" rid="c24">Fraser et al. (2009)</xref>. There three main possible interpretations for such patterns. One interpretation is that the clusters represent the bacterial analog of eukaryotic species, which are sexually and ecologically isolated from each other. In practice a whole-genome divergence cutoff of 5% is frequently used to define bacterial species <xref ref-type="bibr" rid="c29">Jain et al. (2018)</xref> An alternative interpretation is that clusters are the result of clonal expansions of particular strains from a much more diverse and possibly more genetically homogeneous population. The third interpretation is that the clusters are the result of uneven sampling from a larger and more diverse population. The unique combination of having a large collection of genomes, with minimal compositional bias, from a geographically isolated population allows us to test these alternatives. We will mainly aim to distinguish between the first two interpretations and the third one by checking whether there are robust genomic clusters in our sample. More discussion on the evidence concerning the first two hypotheses can be found in Secs. 3 and 5.</p>
<p>We used three different methods to check whether the genomes form robust clusters: the phylogenetic tree of the 16S rRNA sequences, average genome-wide divergence from the two reference genomes OS-A and OS-B’, and patters of divergences between triplets formed by the SAG and the two reference sequences at different loci. The phylogenetic tree of the 16S is the simplest and still the most commonly used method to characterize the diversity of natural microbial communities <xref ref-type="bibr" rid="c81">Yarza et al. (2014)</xref>. Because of its practical importance, we included it for comparison with the other two methods. However, in a highly recombining population like the Yellowstone Synechococcus, it is not clear to what extent the 16S divergence accurately reflects the whole genome diversity. To address this question, we used the divergences across the entire genome as a comparison. The main limitation of using summary statistics such as the average divergence across the entire genome is that it obscures heterogeneities along the genome that could have important ecological and evolutionary implications. There are different ways to address this concern. Here, we used an extension of a method first used in Ref. <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>, which provides a coarse description of the variation in the diversity patterns across different loci. We present the results from each of these analyses next.</p>
<p>We first constructed the phylogenetic tree of 16S sequences. Predicted 16S rRNA sequences (117 from 331 filtered SAGs) were extracted and aligned using MAFFT (v7.453) <xref ref-type="bibr" rid="c32">Katoh and Standley (2013)</xref>. Two sequences (SAGs MA02M11_3 and MuA02C9) were incomplete and were removed from the analysis. The remaining (115) sequences were hierarchicaly clustered using the average linkage (UPGMA) method implemented in Scipy. Results are shown in <xref rid="figA2_3" ref-type="fig">Fig. 3</xref>, with the colored background showing the species assignment using whole genome divergences (see below) for comparison. We found perfect agreement between the whole-genome assignment and the largest three clusters in the 16S phylogenetic tree.</p>
<p>The average divergence within the <italic>α</italic> cluster approximately half that of <italic>β</italic> (1 · 10<sup>−3</sup> vs. 2 · 10<sup>−3</sup>). However, a significant fraction of the average divergence within <italic>β</italic> was due to two outliers (MuA1L16 and MusA1J8). After removing the outliers, the average divergence within <italic>β</italic> decreased to 1.7 · 10<sup>−3</sup>. Closer investigation of the alignments revelead that both outlier <italic>β</italic> sequences contained a short segment of 3 SNPs that were identical to all <italic>α</italic> sequences and different from all other <italic>β</italic> sequences, at positions 1067−1072. In addition, MuA1L16 contained larger segment of almost 200 bp (positions 390−570) containing 10 SNPs and an insertion that were different from all other <italic>β</italic> and were identical to the consensus <italic>α</italic>. Apart from these segments, the outlier sequences were typical of the <italic>β</italic> species. This pattern is similar to the SNP blocks discussed in the main text and in Sec. 6 and therefore is likely the result of hybridization between <italic>α</italic> and <italic>β</italic>.</p>
<p>We compared the 16S rRNA clusters to whole-genome divergences from the two reference genomes, OS-A and OS-B’. We aligned all of the predicted genes from each SAG to all of the coding DNA sequences (CDS) from each reference genome using BLAST (v2.13.0+) <xref ref-type="bibr" rid="c2">Altschul et al. (1990)</xref>. For each SAG, we calculated the divergence to each reference genome (<italic>d</italic> = 1 − pident/100) and calculated the average over the best hits across all genes. The results for all SAGs with more than 100 hits to both references are shown in <xref rid="fig5" ref-type="fig">Fig. 5A</xref>. Three clear clusters were observed, which we labeled as <italic>α, β</italic>, and <italic>γ</italic>. The species of each SAG was assigned as the label correspoding to the cluster it belonged to in <xref rid="fig5" ref-type="fig">Fig. 5A</xref>.</p>
<p>The previous two metrics do not reflect possible heterogeneity in the patterns of diversity along the genome. To characterize this variation on a gene-by-gene basis we extended a method that was previously used to analyze amplicond data from the Mushroom Spring in Ref. <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>. We refer to this method as <italic>gene triplet analysis</italic>. This analysis exploits the separation of scales between and within species clusters, at most loci and in most cells, we observed previously in order to coarse grain the high-dimensional matrix of pairwise divergences into a small number of discrete patterns. Specifically, we take triplets of sequences from the SAGs, OS-A, OS-B’, at loci where all three are homologous and calculate the divergences between all 3 pairs of sequences. These divergences typically form a triangle as shown in <xref rid="figA2_1" ref-type="fig">Fig. 1</xref>. (Note that it is possible to have triplets of divergences that violate the triangle inequality, which cannot be represented as triangles in a two-dimensional space. In our data, such cases were rare but this may not be generally true, particularly for sequences that are not clearly separated and which are the result of extensive recombination. Note however that the classification into distinct patterns given below can still be done even in these cases.) To reduce the dimensionality of the data further, we define a main cloud diameter <italic>d</italic><sub><italic>M</italic></sub> = 0.1 for the diversity within species. We then classify the shape of the triangle into the 5 distinct patterns shown in <xref rid="figA2_1" ref-type="fig">Fig. 1</xref>, depending whether each side of the triangle is longer or shorter than <italic>d</italic><sub><italic>M</italic></sub>. For example, denote the divergence triplet by (<italic>d</italic><sub><italic>XA</italic></sub>, <italic>d</italic><sub><italic>XB</italic></sub>, <italic>d</italic><sub><italic>AB</italic></sub>), representing the divergences between the SAG sequence and OS-A, the SAG sequence and OS-B’, and OS-A and OS-B’, respectively. Then the first pattern in 1A (labeled “XA-B”) contains loci where <italic>d</italic><sub><italic>XA</italic></sub> &lt; <italic>d</italic><sub><italic>M</italic></sub>, <italic>d</italic><sub><italic>XB</italic></sub> ≥ <italic>d</italic><sub><italic>M</italic></sub>, and <italic>d</italic><sub><italic>AB</italic></sub> &lt; <italic>d</italic><sub><italic>M</italic></sub>, the second pattern (labeled “XAB”) contains loci where <italic>d</italic><sub><italic>XA</italic></sub> &lt; <italic>d</italic><sub><italic>M</italic></sub>, <italic>d</italic><sub><italic>XB</italic></sub> &lt; <italic>d</italic><sub><italic>M</italic></sub>, and <italic>d</italic><sub><italic>AB</italic></sub> &lt; <italic>d</italic><sub><italic>M</italic></sub>, and so on. The cutoff of <italic>d</italic><sub><italic>M</italic></sub> = 0.1 is the same as the one used in Ref. <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref> and provides a good separation between species at a gene by gene basis. The results of our analysis, however, do not depend on the specific value of <italic>d</italic><sub><italic>M</italic></sub> as discussed at the end.</p>
<p>For each SAG we assigned all genes that were orthologous to OS-A and OS-B’ to one of the 5 patterns described above. The three rows in <xref rid="figA2_1" ref-type="fig">Fig. 1</xref> show typical examples of an <italic>α</italic> (<xref rid="figA2_1" ref-type="fig">Fig. 1A</xref>), a <italic>β</italic> (<xref rid="figA2_1" ref-type="fig">Fig. 1B</xref>), and the <italic>γ</italic> (<xref rid="figA2_1" ref-type="fig">Fig. 1C</xref>) SAG. The majority of genes across each row in <xref rid="figA2_1" ref-type="fig">Fig. 1</xref> are found in the XA-B, XB-A, and X-A-B patterns, respectively. This is consistent with the species clusters we saw in the genome-wide average divergences from before. However, we also find a significant minority of genes forming other patterns, most notably XAB, representing genes where all three sequences are within the main cloud (<italic>d</italic> &lt; <italic>d</italic><sub><italic>M</italic></sub>). Some of these genes were contained in the diversity troughs discussed in the main text and in Sec.5. In the case of the <italic>γ</italic> SAG, the fact that X-A-B is the dominant pattern rules out the possibility that <italic>γ</italic> is a hybrid resulting from the mixture of <italic>α</italic> and <italic>β</italic>. Such hybrids have been observed after recent clonal expansions in acid mine drainage microbial communities <xref ref-type="bibr" rid="c70">Tyson et al. (2004)</xref>; <xref ref-type="bibr" rid="c41">Lo et al. (2007)</xref>, but do not appear to be present at substantial frequency in the Yellowstone community. Instead, it appears that <italic>γ</italic> is a distinct species that diverged from the other two around the same time <italic>α</italic> and <italic>β</italic> diverged from each other.</p>
<p>Using the pattern described above allows us to compare different SAGs to each other and allows us to test the robustness of the species assignment based on the average genome-wide divergence. Specifically, we assigned to each SAG a gene triple fingerprint <italic>f</italic> = (<italic>f</italic><sub><italic>XA</italic>−<italic>B</italic></sub>, <italic>f</italic><sub><italic>XAB</italic></sub>, <italic>f</italic><sub><italic>X</italic>−<italic>A</italic>−<italic>B</italic></sub>, <italic>f</italic><sub><italic>X</italic>−<italic>AB</italic></sub>, <italic>f</italic><sub><italic>XB</italic>−<italic>A</italic></sub>), representing the fraction of genes with each pattern (note that ∑<sub><italic>i</italic></sub> <italic>f</italic><sub><italic>i</italic></sub> = 1). We then compared the fingerprints of each SAG with the species assignment based on the average divergence from OS-A and OS-B’ from <xref rid="figA2_1" ref-type="fig">Fig. 1A</xref>. We found that the fingerprints formed three clear patterns that exactly matched the assignments based on the average divergence (<xref rid="figA2_2" ref-type="fig">Fig. 2</xref>). We tested this assignment for different values of <italic>d</italic><sub><italic>M</italic></sub> ranging from 1% to 20% and found that the fingerprint patterns were robust across the entire range (data not shown). These results show that the classification into distinct species is robust and consistent across the three methods described.</p>
<fig id="figA2_1" position="float" fig-type="figure">
<label>Appendix 2—figure 1.</label>
<caption><title>Species clusters at the gene level approximately match those at the genome level.</title>
<p>Figures show gene-by-gene comparison of three cells to the OS-A and OS-B’ reference genomes. The cells shown are representative of the <italic>α</italic> (<bold>A</bold>; OctA1J9)and <italic>β</italic> (<bold>B</bold>; MA02H14_2) clusters and the one <italic>γ</italic> cell (<bold>C</bold>; OcA3L13). Each core gene with homologs in both OS-A and OS-B’ was compared to the references and the divergences plotted as a triangle with each side length equal to the divergence between a given pair. The cell sequence is represented by a black dot, with the OS-A and OS-B’ sequences represented by the orange upward and blue downward triangles, respectively. The black circle is a 10% radius which was chosen as a cutoff to classify each gene. The different columns show genes in one of the five possible patterns labeled as follows: XA-B (the cell sequence is less than 10% divergend from OS-A and more than 10% diverged from OS-B’), XAB (all three sequences are within 10% of each other), X-A-B (all three sequences are more than 10% diverged from each other), X-AB (the cell is more than 10% diverged from both OS-A and OS-B’, but both references are less than 10% diverged from each other), and XB-A (the cell is less than 10% diverged from OS-B’ and more than 10% diverged from OS-A).</p></caption>
<graphic xlink:href="543983v2_figA2_1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figA2_2" position="float" fig-type="figure">
<label>Appendix 2—figure 2.</label>
<caption><title>Proportion of gene triplet patterns shows three distinct clusters.</title>
<p>The proportion of genes in each of the five patterns shown in 1 is show of each cell passing our quality control criteria (see <xref ref-type="app" rid="app1">Appendix 1</xref>). Lines represent different cells and are colored according to the species classification based on whole-genome divergences.</p></caption>
<graphic xlink:href="543983v2_figA2_2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figA2_3" position="float" fig-type="figure">
<label>Appendix 2—figure 3.</label>
<caption><title>Phylogenetic tree inferred from 16S rRNA agrees with whole-genome species classification.</title>
<p>The pairwise divergences between all 16S sequences passing quality control was calculated from the multiple sequence alignment performed using MAFFT <xref ref-type="bibr" rid="c32">Katoh and Standley (2013)</xref>. The tree was generated using a hierarchical agglomerative clustering algorithm with average linkage (UPGMA) as implemented in SciPy <xref ref-type="bibr" rid="c72">Virtanen et al. (2020)</xref></p></caption>
<graphic xlink:href="543983v2_figA2_3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</app>
<app id="app3">
<title>Appendix 3</title>
<sec id="s6">
<title>Metagenome analysis</title>
<sec id="s6a">
<title>Phylogeny of γ</title>
<p>Here we present the details of the phylogenetic analysis of the <italic>γ</italic> SAG, OA3L13 which shows that it represents a new uncharacterized species within the Yellowstone cyanobacteria population. To establish its phylogeny we used a concatenated alignment of marker genes, following Ref. <xref ref-type="bibr" rid="c79">Wu and Eisen (2008)</xref>. Of the 31 marker genes used in Ref. <xref ref-type="bibr" rid="c79">Wu and Eisen (2008)</xref>, 16 were covered in the <italic>γ</italic> SAG (<italic>dnaG, frr, pgk, rplA, rplK, rplL, rplM, rplS, rplT, rpsB, rpsI, rpsJ, rpsK, rpsM, smpB</italic>, and <italic>tsf</italic>) and were used to determine its phylogeny. We used a large collection of cyanobacterial genomes from Ref. <xref ref-type="bibr" rid="c10">Chen et al. (2020)</xref> to check for closely related species to <italic>γ</italic>. The concatenated alignment was constructed as follows. For each of the 16 marker genes, we extracted the alignment of all species labeled “Thermal springs” that were within one of the subsections labeled I through V in <xref ref-type="bibr" rid="c10">Chen et al. (2020)</xref> and added the <italic>γ</italic> sequence to the alignment. All “?” characters were replaced with “X”. The sequences were then realigned using MAFFT (v7.453) <xref ref-type="bibr" rid="c32">Katoh and Standley (2013)</xref> using default parameters and the alignments were concatenated and trimmed using trimal (v1.4.rev22) <xref ref-type="bibr" rid="c9">Capella-Gutiérrez et al. (2009)</xref> with default parameters. Finally, the resulting sequences were realigned using MAFFT and the phylogenetic trees were inferred using FastTree (v2.1.11) <xref ref-type="bibr" rid="c53">Price et al. (2010)</xref> with default parameters. The resulting tree is shown in <xref rid="figA3_1" ref-type="fig">Fig. 1</xref>.</p>
<p>To verify that the lack of other closely-related genomes to <italic>γ</italic> was not due to the incompleteness of our reference database, we searched for homologs to the 16 <italic>γ</italic> marker genes in the NCBI database. We used the Web version of blast on NCBI with the megablast settings and word size 16. For all 16 marker genes the top two hits were from OS-A and OS-B’, while all other high-scoring hits had less than 85% nucleotide identity. We also matching sequences to the 16S rRNA using the SILVA database (v138.1) <xref ref-type="bibr" rid="c54">Quast et al. (2013)</xref>. Using the non-redundant version of the database (SSU Ref NR99) only gave hits to OS-A and OS-B’ sequences. Using the full database we did find several sequences that were less than 10 SNPs away from the <italic>γ</italic> sequence across the entire 16S rRNA (&gt; 99.7% identity), including one from a previous study of Yellowstone microbiomes <xref ref-type="bibr" rid="c42">Meyer-Dombard et al. (2011)</xref>. The corresponding divergence of 3 · 10<sup>−3</sup> is comparable to the typical diversity within species in our SAGs of 1−2 · 10<sup>−3</sup> and much less than the typical divergence between species, which is approximately 2 − 4 · 10<sup>−2</sup> (Sec. 2).</p>
<table-wrap id="tblA3_1" orientation="portrait" position="float">
<label>Appendix 3—table 1.</label>
<caption><title>Best hits to OA3L13 16S rRNA in SILVA SSU Ref database.</title></caption>
<graphic xlink:href="543983v2_tblA3_1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<fig id="figA3_1" position="float" fig-type="figure">
<label>Appendix 3—figure 1.</label>
<caption><title><italic>γ</italic> SAG represents a new distinct species within Yellowstone Synechococcus.</title>
<p>Shows the maximum likelyhood tree obtained from an alignment of 16 marker genes present in the <italic>γ</italic> SAG together with all other thermophilic cyanobacteria from Ref. <xref ref-type="bibr" rid="c10">Chen et al. (2020)</xref>. Colored labels show the two Yellowstone Synechococcus, OS-A (orange) and OS-B’ (blue), and the <italic>γ</italic> SAG OA3L13 (green).</p></caption>
<graphic xlink:href="543983v2_figA3_1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Inferred abundances of <italic>γ</italic> from metagenomic samples are consistent with a single <italic>γ</italic> SAG in our data (see Sec. 3). To further verify that no other <italic>γ</italic> SAGs were accidentally excluded during quality control (see Sec. 1) we performed a BLAST search (alignment parameters: <monospace>-evalue 1E-10 -word_size 9 -qcov_hsp_perc 75.0</monospace>) of the <italic>γ</italic> genes against the contigs from the SAGs that were filtered out. The results were consistent with the majority of the excluded SAGs containing mostly <italic>α</italic> and <italic>β</italic> genes, with a smaller number of SAGs with divergences around twice as large (<xref rid="figA3_2" ref-type="fig">Fig. 2</xref>). This confirms that no other <italic>γ</italic> SAGs were present in our data.</p>
<fig id="figA3_2" position="float" fig-type="figure">
<label>Appendix 3—figure 2.</label>
<caption><title>SAGs excluded during quality control do not include additional <italic>γ</italic> genomes.</title>
<p>The distribution of divergences from the best BLAST hit to the <italic>γ</italic> SAG (OcA3L13) across genes for each SAG excluded during the quality control process (see Sec. 1) is shown. Each line represents the probability density of divergences across genes for one of the 44 SAGs.</p></caption>
<graphic xlink:href="543983v2_figA3_2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s6b">
<title>Estimating abundances of α, β, and γ</title>
<p>To estimate abundances of the three main species <italic>α, β</italic>, and <italic>γ</italic> in the Octopus and Mushroom Springs we recruited metagenomic reads from 34 samples taken from both springs (see Sec. 1) to SAGs from each species. We chose the one <italic>γ</italic> SAG (OA3L13, ≈ 70% coverage) along with representative SAGs from <italic>α</italic> (MA02D15, ≈ 77% coverage) and <italic>β</italic> (OcA2H14, ≈ 96% coverage) as reference genomes. Hybridization on length scales longer than the typical read size (150 bp in our case) can lead to errors in our estimates of species abundances. To minimize these errors we only used core genes where three distinct species clusters could be identified and there was no evidence of hybridization in the single-cell data (see Secs. 1 and 5). This resulted in set of ≈ 400 genes for each reference. We aligned all the metagenomic reads to these target gene sequences using BowTie2 (v2.3.4, default parameters) <xref ref-type="bibr" rid="c36">Langmead and Salzberg (2012)</xref> and extracted reads aligning to each of the three reference sequences using Samtools (v1.7.0) <xref ref-type="bibr" rid="c38">Li et al. (2009)</xref> and bedtools bamtofastq command (v2.26.0) <xref ref-type="bibr" rid="c55">Quinlan and Hall (2010)</xref>.</p>
<p>We assigned the recruited reads to each species clusters if their divergence from their respective reference was less than the “main cloud” radius <italic>d</italic><sub><italic>M</italic></sub>. We determined <italic>d</italic><sub><italic>M</italic></sub> self-consistently from the data as follows. For each reference, counted the number of reads that had divergences less than <italic>d</italic><sub><italic>M</italic></sub> from that reference sequence and more than <italic>d</italic><sub><italic>M</italic></sub> from the other two reference sequences, for <italic>d</italic><sub><italic>M</italic></sub> from 1% to 15%. If the population consists of species clusters with typical diversity <italic>π</italic>, the number of reads within the cloud will increase until <italic>d</italic><sub><italic>M</italic></sub> ≈ <italic>π</italic>. As <italic>d</italic><sub><italic>M</italic></sub> approaches the typical divergence between species <italic>d</italic> ≈ 15%, more reads will start to map to multiple reference sequences so the number of reads uniquely assigned to each species cluster will decrease. Therefore, the number of reads uniquely assigned to each species cluster should have a maximum as a function of <italic>d</italic><sub><italic>M</italic></sub>. We indeed found this to be the case for all three species (data not shown). Empirically, we found that <italic>d</italic><sub><italic>M</italic></sub> = 5% was close to the maximum for all three species so we used this value throughout our analysis.</p>
<p>We found that the average depth of recruited reads across genes varied within the same sample. However the variations across samples were highly correlated, which confirmed that most reads aligning to our chosen genes came from genomes that were part of the same species cluster rather than from genes transferred across species (<xref rid="figA3_3" ref-type="fig">Fig. 3</xref>). We found that the genes that recruited the largest numbers of reads had reads depths that were much more similar within the same sample compared to other genes. Interestingly, we found much more variation in depth between genes within the <italic>γ</italic> cluster compared to <italic>α</italic> and <italic>β</italic> (<xref rid="figA3_3" ref-type="fig">Fig. 3</xref>). One likely explanation for this is that <italic>γ</italic> contains much more diversity compared to either <italic>α</italic> or <italic>β</italic>.</p>
<fig id="figA3_3" position="float" fig-type="figure">
<label>Appendix 3—figure 3.</label>
<caption><title>Number of reads recruited to different loci from the three main species are highly correlated across samples.</title>
<p>The three panels show the average depth of reads recruited to representative SAGs from <italic>α</italic> (top), <italic>β</italic> (middle), and <italic>γ</italic> (bottom), respectively. Each panel shows 100 genes with the highest average read depth across samples, with each line representing one gene. Only reads that were &lt; 5% diverged from the reference genomes were included.</p></caption>
<graphic xlink:href="543983v2_figA3_3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We estimated the abundance of each species cluster by averaging the depth of the 100 genes with the highest average depth across all samples for each cluster. We found that <italic>γ</italic> was more than an order of magnitude more abundant than our detection threshold given by the metagenomic read depth in 32 out of the 34 metagenome samples (<xref rid="figA3_4" ref-type="fig">Fig. 4</xref>). Moreover, its abundance in the two samples for which we had single-cell and metagenome data (MSe4 and OSM3) was close to the detection threshold of the single-cell samples, which was around 2%. This explains why we only obtained a single <italic>γ</italic> cell from the single-cell samples after our quality controls. Finally, we found that the abundance of <italic>γ</italic> was highly correlated with <italic>α</italic> across all samples and was only present at abundances higher than <italic>O</italic>(1)% in the Mushroom Spring sample taken from 65 <sup>°</sup>C. This suggests that <italic>γ</italic> is, together with <italic>α</italic>, primarily adapted to growth at higher temperatures.</p>
<fig id="figA3_4" position="float" fig-type="figure">
<label>Appendix 3—figure 4.</label>
<caption><title>Abundance of <italic>γ</italic> is significantly above detection threshold in 32 of 34 metagenomic samples and is highly correlated with <italic>α</italic>.</title>
<p>The relative abundances of <italic>α</italic> (orange circles), <italic>β</italic> (blue squares), and <italic>γ</italic> (green diamonds) across all 34 metageomic samples. The detection threshold for the single-cell (<italic>f</italic><sub><italic>t</italic></sub> = 1/48 ≈ 0.021, based on the maximum number of SAGs per sample) and metagenomic samples are shown in black and grey dashed lines, respectively. The asterisks on the x-axis label the two samples (MSe4 and OSM3) with both single-cell and metagenomic data.</p></caption>
<graphic xlink:href="543983v2_figA3_4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s6c">
<title>Other <bold><italic>Synechococccus</italic></bold> species</title>
<p>Are other <italic>Synechococcus</italic> species present in Mushroom or Octopus Spring apart from <italic>α, β</italic>, and <italic>γ</italic>? To answer this question, we again used the 34 samples from which we have high-depth metagenomes. We used BLAST with highly sensitive parameter choices to minimize the number of true <italic>Synechococcus</italic> reads not captured. For computational efficiency, we focused on the 100 genes with highest coverage depth in the metagenomes across all three references.</p>
<p>To determine how much of the population is in the <italic>α</italic>-<italic>β</italic>-<italic>γ</italic> main cloud, we used the same three SAGs as in the previous subsection as references and recruited reads using BLAST (<monospace>-task blastn -evalue 1e-3 -word_size 6 -num_threads 32</monospace>). Using these parameters, we could recruit reads belonging to the dominant <italic>Roseiflexus</italic> species in our samples, which is in a different phylum from <italic>Synechococcus</italic>. We were therefore confident that any reads from other potential <italic>Synechococcus</italic> species would be included in our analysis. To limit the analysis to just <italic>Synechococcus</italic> species, we removed all reads that were more than 20% diverged from all of our references from subsequent analysis.</p>
<p>Because of the large amount of data in this analysis, we focus on just the Mushroom Spring samples taken from different temperatures (MS temperature series). We recruited a total of 4, 522, 833 reads with an average depth per gene of 4980. We calculated the minimum divergence from the three reference sequences for each read and found 94% within 5% divergence of one of them (<xref rid="figA3_5" ref-type="fig">Fig. 5A</xref>). For comparison, we determined the typical divergences between species by dividing the reference sequences into 150 bp segments (the same size as our reads) and calculating the divergences between all three pairs of species (<xref rid="figA3_5" ref-type="fig">Fig. 5B</xref>). The middle 95-percentile of the combined distributions extended down to a divergence of around 5% (8 SNPs), consistent with our cutoff for the intraspecies divergences at these loci. These results are consistent with all of the <italic>Synechococcus</italic> reads being from one of the three species and set an upper bound on the relative abundance of any other species at below 4%.</p>
<p>To check how sensitive our detection method is to the presence of other species, we used the Mushroom Spring sample from 65 in which <italic>γ</italic> had a relatively high abundance. To mimic the presence of another species, we compared the previous distributions to the distribution of the minimum divergence from <italic>α</italic> and <italic>β</italic> only (dashed red line in <xref rid="figA3_5" ref-type="fig">Fig. 5A</xref>). We found a 19% decrease in cumulative number of reads within 5% from the references in this case, which was very close to the 21% abundance of <italic>γ</italic> we estimated in the previous subsection based on the average depth across loci. This shows that our method is sensitive to presence of other species and illustrates the benefits of combining single-cell and metagenome analysis for identifying unknown species.</p>
<fig id="figA3_5" position="float" fig-type="figure">
<label>Appendix 3—figure 5.</label>
<caption><title>Vast majority of <italic>Synechococcus</italic> core gene sequences are within the <italic>α</italic>-<italic>β</italic>-<italic>γ</italic> main clouds.</title>
<p>(<bold>A</bold>) Cumulative distribution of the minimum divergence of each read from the reference sequences across all loci used in the left panel. Different colors represent samples taken from different temperatures from Mushroom Spring. Solid lines show minimum divergence from all three references and dashed lines from <italic>α</italic> and <italic>β</italic> only. Shaded olive region shows the typical divergences between species shown in the right panel. (<bold>B</bold>) Histogram of pairwise divergences between three representative SAGs for <italic>α, β</italic>, and <italic>γ</italic> at the 100 core loci chosen for illustration. Distributions are across all 150 bp segments from each locus. Shaded olive region the middle 95% percentile for the combined distribution.</p></caption>
<graphic xlink:href="543983v2_figA3_5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To further verify that no other <italic>Synechococcus</italic> species were present in our samples we closely examined the diversity of 16S sequences. We used only single reads in our analysis instead of trying to assemble full sequences to prevent misinference caused by hybridization. Because the diversity along the 16S sequence is highly heterogeneous, variation between read recruitment locations can dominate the variation between species. We controlled for this by limiting the analysis to reads that aligned within a given regions of the 16S. For 150 bp reads, we found that using segment sizes of 200 bp provided best compromise between increasing depth and minimizing variance due to alignment location. To find the most informative region, we calculated the nucleotide diversity at each site ℋ<sub><italic>i</italic></sub> = 2⟨<italic>f</italic><sub><italic>i</italic></sub>(1 − <italic>f</italic>)⟩, where <italic>f</italic><sub><italic>i</italic></sub> is the minor allele frequency at site <italic>i</italic>, and averaged it over all 200 bp segments along the 16S (<xref rid="figA3_6" ref-type="fig">Fig. 6A</xref>). We found the diversity varied by more than a factor of four consistent with the presence of conserved and variable regions. The diversity was nearly identical when using all three species as reference genomes, suggesting our recruitment captured all sequences within the main cloud. The highest average diversity was close to 400-600 bp segment which we chose for further analysis.</p>
<p>We calculated the distribution of divergences from the <italic>γ</italic> allele for all reads recruited from this segment for MS temperature series. We found temperatures of 60 °C and below had two distinct peaks close to 4% and 8% divergences. For comparison, we calculated the range of divergences from <italic>α</italic> and <italic>β</italic> for all 150 bp subsegments within the 400−600 bp segment and found these matched with the two peaks we observed. At 65 °C we also found only two peaks, one close to zero and another close to 4%, consistent with our previous estimates showing that this sample mainly consisted of <italic>α</italic> and <italic>γ</italic> cells.</p>
<fig id="figA3_6" position="float" fig-type="figure">
<label>Appendix 3—figure 6.</label>
<caption><title>Diversity of <italic>Synechococcus</italic> 16S rRNA sequences from Mushroom Spring temperature series samples is entirely contained within the <italic>α</italic>-<italic>β</italic>-<italic>γ</italic> main clouds.</title>
<p>(<bold>A</bold>) Average diversity ℋ (see text) of metagenome reads from all 34 samples mapping to <italic>Synechococcus</italic> along the length of the 16S sequence. Averaging was done over all sites within a 200 bp window starting at the location given by the x-axis. Results for reads recruited using each of the three main species as a reference sequence are shown in different colors. Black dashed line indicates the 400 − 600 bp segment with the highest diversity which was chosen for subsequent analysis. (<bold>B</bold>) Distribution of nucleotide divergences from the <italic>γ</italic> allele within the 400 − 600 bp segment of the 16S for four different samples taken from Mushroom Spring. Shaded regions show the range of divergences of OS-A (orange) and OS-B’ (blue) from <italic>γ</italic> across all 51 windows of 150 bp length, corresponding to the range of expected divergences of reads from <italic>α</italic> and <italic>β</italic>.</p></caption>
<graphic xlink:href="543983v2_figA3_6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Do peaks correspond to single-species clusters or are they amalgamation of several distinct species with similar divergences from each other? To answer this question we constructed a multiple-sequence alignment of all of the 16S reads recruited across the 34 metagenome samples and performed a hierarchical clustering on the pairwise divergence matrix using average linkage. Pairwise divergences were calculated by padding the reads with gaps to ensure all sequences were 200 bp in length and calculating the nucleotide divergence ignoring any gaps. For the MS temperature series, we found 97% of reads were in one of the three clusters associated with <italic>α, β</italic>, or <italic>γ</italic> (<xref rid="figA3_7" ref-type="fig">Fig. 7A-D</xref>). Consistent with our previous results, samples below 65 °C had two main clusters close to OS-A and OS-B’ (<xref rid="figA3_7" ref-type="fig">Fig. 7A-C</xref>), while at 65 °C they were close to <italic>γ</italic> and OS-A (<xref rid="figA3_7" ref-type="fig">Fig. 7D</xref>). Aggregating across all 34 metagenome samples, we found that <italic>α</italic> and <italic>β</italic> were the two dominant clusters, with <italic>γ</italic> being the next largest (<xref rid="figA3_7" ref-type="fig">Fig. 7EF</xref>). We also observed a large difference in the overall abundances of <italic>α</italic> and <italic>β</italic> across the two springs, but the very large heterogeneity across samples we found previously (<xref rid="figA3_4" ref-type="fig">Fig. 4</xref>) suggests this is likely due to the particular samples used in this study and may not necessarily be an accurate reflection of the overall abundances in the two springs.</p>
<fig id="figA3_7" position="float" fig-type="figure">
<label>Appendix 3—figure 7.</label>
<caption><title>All <italic>Synechococcus</italic> 16S rRNA sequences from the metagenome samples belong to one of the three known species clusters.</title>
<p>(<bold>A</bold>-<bold>D</bold>) Each subpanel shows the matrix of pairwise divergences between all reads recruited to the 400 − 600 bp segment of the <italic>γ</italic> 16S rRNA sequence for the four samples from the MS temperature series. Dashed lines highlight the OS-A, OS-B’, and <italic>γ</italic> reference sequences in this segment for comparison. (<bold>E, F</bold>) Same as above using a subsample of reads recruited from all 34 metagenome samples divided by spring.</p></caption>
<graphic xlink:href="543983v2_figA3_7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
</app>
<app id="app4">
<title>Appendix 4</title>
<sec id="s7">
<title>Linkage analysis</title>
<p>In this section we summarize our analysis of linkage disequilibrium within <italic>α</italic> and <italic>β</italic>. The structure of this section is as follows. We begin by reviewing definitions of two commonly-used ways to quantify linkage disequilibrium. We then compare the rate of decay of linkage disequilibrium within and between the two species. We next compare the decrease in linkage in the data to theoretical predictions from the neutral model and show that while the decay is similar to the neutral model prediction, the overall shape of the linkage decay curves cannot be fully explained by the classical neutral model. We then show that within <italic>α</italic> there is substantial heterogeneity in the rate of linkage decay in low-diversity regions compared to high-diversity ones. Surprisingly, we find that linkage decreases more rapidly in low-divergence regions, suggesting the absence of a clonal frame for <italic>α</italic> even on short time scales. The final subsection presents a technical validation of our method for processing alignments showing that our results are robust to filtering for outlier gene alleles.</p>
<sec id="s7a">
<title>Statistical measures of linkage disequilibrium</title>
<p>We used two distinct but related methods for quantifying linkage disequilibrium, <inline-formula><inline-graphic xlink:href="543983v2_inline11.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <italic>r</italic><sup>2</sup>. Both metrics are related to the correlation coefficient between alleles at two loci, but differ in their normalization. For a single pair of loci A and B with alleles A/a and B/b, we can define the correlation coefficient between their respective frequencies as
<disp-formula id="eqn2">
<graphic xlink:href="543983v2_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Using this expression, we can define a statistical measure of linkage as a function of distance along the genome by averaging over pairs of loci with with a given separation <italic>x</italic> = |<italic>x</italic><sub><italic>A</italic></sub> −<italic>x</italic><sub><italic>B</italic></sub>|, where <italic>x</italic><sub><italic>A</italic></sub> and <italic>x</italic><sub><italic>B</italic></sub> are the positions of the two loci along the genome. The two most common ways to perform the average are
<disp-formula id="eqn3">
<graphic xlink:href="543983v2_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
and
<disp-formula id="eqn4">
<graphic xlink:href="543983v2_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
For a neutral panmitic and well-mixed population both metrics decrease as <inline-formula><inline-graphic xlink:href="543983v2_inline12.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. For <inline-formula><inline-graphic xlink:href="543983v2_inline13.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, there also exists an analytic expression <xref ref-type="bibr" rid="c50">Ohta and Kimura (1969)</xref>:
<disp-formula id="eqn5">
<graphic xlink:href="543983v2_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>N</italic> is the population size, and <italic>R</italic> the recombination rate per base pair per generation. When recombination is rare and occurs via crossover <italic>R</italic>(<italic>x</italic>) ≈ <italic>R</italic><sub>0</sub><italic>x</italic>, and the expression is consistent with the scaling <inline-formula><inline-graphic xlink:href="543983v2_inline14.gif" mimetype="image" mime-subtype="gif"/></inline-formula> mentioned previously. While numerical and theoretical studies have shown that <italic>r</italic><sup>2</sup> is more sensitive to low-frequency alleles compared to <inline-formula><inline-graphic xlink:href="543983v2_inline15.gif" mimetype="image" mime-subtype="gif"/></inline-formula> <xref ref-type="bibr" rid="c28">Hudson (1985)</xref>; <xref ref-type="bibr" rid="c68">Song and Song (2007)</xref>, our analysis did not reveal significant differences between two metrics. We therefore focus here on <inline-formula><inline-graphic xlink:href="543983v2_inline16.gif" mimetype="image" mime-subtype="gif"/></inline-formula> which is more commonly used and easier to compare to theoretical predictions.</p>
<p>We calculated <inline-formula><inline-graphic xlink:href="543983v2_inline17.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <italic>r</italic><sup>2</sup>(<italic>x</italic>) for <italic>α</italic> and <italic>β</italic> separately and together. Both procedures are similar so we focus on the analysis for all <italic>α</italic> and <italic>β</italic> sequences. Unless otherwise stated, all analyses were performed on alignments of individual genes and the results were averaged across genes. Using this method, we can easily obtain linkage information over distances of up to around 1 kbp. Over longer distances the results can be dominated by specific recombination events in small number of unusually long genes and are therefore less useful for quantifying genome-wide statistical patterns. We thus perform most of our analysis up to distances of around 1 kbp, except when caculating typical genome-wide linkage as discussed below.</p>
<p>Alignments for each orthogroupwere first trimmed to remove segments with excess numbers of gaps. We then determined a consensus sequence by taking the most common codon sequence at each location along the reading frame, excluding gaps. Each nucleotide was the labeled 0 if it was a gap, 1 if it was the same as the consensus, and 2 if it was different from the consensus. While this does not distinguish between biallelic and multi-allelic sites, the latter are much more less common that the former and should not affect our conclusions. Finally, we calculated the two linkage coefficients using <xref ref-type="disp-formula" rid="eqn3">Eqs. 3</xref> and <xref ref-type="disp-formula" rid="eqn4">Eqs. 4</xref>. To estimate linkage across distances longer than a single gene, we performed the average across SNPs spanning a pair of genes and then averaged the values across a random sample of 1000 pairs of genes.</p>
<p>The linkage calculations within each species were performed in an analogous way, with the exception of a two-step filtering process of the alignments at the beginning. We describe this procedure in detail at the end of this section.</p>
</sec>
<sec id="s7b">
<title>Linkage decrease within vs between species</title>
<fig id="figA4_1" position="float" fig-type="figure">
<label>Appendix 4—figure 1.</label>
<caption><title>Genetic linkage analysis shows extensive recombination within <italic>α</italic> and <italic>β</italic>.</title>
<p>Linkage disequilibrium <inline-formula><inline-graphic xlink:href="543983v2_inline49.gif" mimetype="image" mime-subtype="gif"/></inline-formula> as a function of separation between SNPs <italic>x</italic> averaged across all core genes among the <italic>α</italic> (orange circles), <italic>β</italic> (blue squares), or all of the cells (black diamonds). Genome-wide estimates from SNPs in different genes are shown to the right of the black dashed line using the same symbols. Fully unlinked controls for the genome-wide linkage are shown as horizontal lines of different colors. The main cloud cutoff for both <italic>α</italic> and <italic>β</italic> was set to <italic>c</italic> = 0.05.</p></caption>
<graphic xlink:href="543983v2_figA4_1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Our analysis showed that within both <italic>α</italic> and <italic>β</italic>, linkage quickly decreased by approximately an order of magnitude over a distance of ~ 1 kbp (orange circles and blue squares in <xref rid="figA4_1" ref-type="fig">Fig. 1</xref>). However, when considering the population as a whole, we find linkage disequilibrium is maintained across the whole length of the genome (black diamonds in <xref rid="figA4_1" ref-type="fig">Fig. 1</xref>). Within <italic>β</italic>, the linkage at distances of 1 kbp was identical to the genomewide linkage between random pairs of genes. Within <italic>α</italic>, the decrease was slower, but followed a similar pattern. The value of the genome-wide linkage was slightly higher than at 1 kbp, likely because of the reduced sample size at long genomic distances caused by poor genome coverage. Consistent with this, we found that the genomewide-linkage values in both species were close to completely unlinked controls obtained by randomly permuting each column of the alignments (<inline-formula><inline-graphic xlink:href="543983v2_inline18.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in <italic>α</italic> and <inline-formula><inline-graphic xlink:href="543983v2_inline19.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in <italic>β</italic>). Overall, these results suggest that the dynamics leading to the reassortment of alleles are similar in the two species and only differ in the length scale over which alleles become unlinked. We discuss this in more detail in the next section.</p>
<p>The fact that both species have similar levels of genomewide linkage despite the sample size of <italic>α</italic> being less than half of that of <italic>β</italic> shows that our estimates for the genomewide linkage are not significantly affected by the sample size effect. We further validated this by taking random samples from <italic>β</italic> main cloud equal to the size of the <italic>α</italic> main cloud at each locus and recalculating the linkage curves. We found the results for the full <italic>β</italic> main cloud and the subsampled main cloud were almost identical (<xref rid="figA4_2" ref-type="fig">Fig. 2</xref>). This shows that the sample size does not have a large effect on our results and cannot explain the differences in linkage decay between the two species.</p>
<fig id="figA4_2" position="float" fig-type="figure">
<label>Appendix 4—figure 2.</label>
<caption><title>Samples size has small effect on linkage estimates.</title>
<p>Linkage disequilibria curves for the whole <italic>α</italic> and <italic>β</italic> populations shown in 1 are compared to a random subsample of <italic>β</italic> sequences chosen to match the <italic>α</italic> sample size at each locus (shown in gray).</p></caption>
<graphic xlink:href="543983v2_figA4_2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The rapid decrease in linkage sets important limits on how much information about the diversity in the population is contained in samples of marker genes. To illustrate this, we performed a linear regression between the whole-genome divergences and the 16S rRNA divergence. Consistent with our previous analysis, we found slightly stronger linkage in <italic>α</italic> compared to <italic>β</italic>, but in both cases the correlations were weak and the 16S divergences explained less than 10% of the genome-wide divergences (<xref rid="figA4_1" ref-type="fig">Fig. 1B</xref>). These results show that frequent recombination in the population makes marker genes, such as the 16S rRNA, poor predictors of the genome-wide diversity.</p>
</sec>
<sec id="s7c">
<title>Comparison to model of neutral drift with recombination</title>
<p>To get a more quantitative understanding of the effects of recombination on the genetic diversity in our population we compared our previous results to theoretical predictions from population genetics. At short distances, the prediction from <xref ref-type="disp-formula" rid="eqn5">Eq. 5</xref> is that <inline-formula><inline-graphic xlink:href="543983v2_inline20.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. However, in our data the value of <inline-formula><inline-graphic xlink:href="543983v2_inline21.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for nearby sites was very close to one. While the Yellostone Synechococcus have a strong mutational bias towards GC nucleotides <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>, <xref ref-type="disp-formula" rid="eqn5">Eq. 5</xref> is independent of the relative rates of mutations. As a result we conclude that the neutral model cannot explain the linkage curves we observe.</p>
<fig id="figA4_3" position="float" fig-type="figure">
<label>Appendix 4—figure 3.</label>
<caption><title>Linkage decay curves for <italic>α</italic> and <italic>β</italic> collapse on to the same curve after rescaling distances by average recombination rate <italic>ρ</italic>.</title>
<p>Shows the linkage decay as a function of distances between sites rescaled by the recombination rates <italic>ρ</italic> fitted from <xref rid="figA4_2" ref-type="fig">Fig. 2A</xref> (main text). The solid black line shows the theoretical prediction from the neutral model given by <xref ref-type="disp-formula" rid="eqn5">Eq. 5</xref>.</p></caption>
<graphic xlink:href="543983v2_figA4_3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>While the overall level of <inline-formula><inline-graphic xlink:href="543983v2_inline22.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in our data is inconsistent with the neutral prediction, we can still ask whether the rate of decay with distance has a similar functional form. To do this we followed Ref. <xref ref-type="bibr" rid="c25">Garud et al. (2019)</xref> and fit the linkage curves to the following functional form:
<disp-formula id="eqn6">
<graphic xlink:href="543983v2_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>ρ</italic> = 2<italic>NR</italic> is the population recombination rate. We performed the fit by choosing <italic>A</italic> such that the above expression matched the value of <inline-formula><inline-graphic xlink:href="543983v2_inline23.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in the data for neighboring sites (<italic>x</italic> = 1). We then fitted the curves by eye by adjusting the value of <italic>ρ</italic>.</p>
<p>We found that this functional form could fit the data very well for both species up to distances of <italic>x</italic> ≈ 300 bp (<xref rid="figA4_2" ref-type="fig">Fig. 2</xref> in main text). For longer distances the linkage decrease was slightly slower than predicted by (6). One possible interpretation of this slowdown is that longer distances have a significant overlap with the distribution of lengths of recombined segments <italic>L</italic><sub><italic>r</italic></sub>, beyond which we expect linkage to reach the genomewide level <xref ref-type="bibr" rid="c25">Garud et al. (2019)</xref>. This suggests that recombined segments as short as 300 bp might play an important role in recombination process within the population.</p>
<p>We further validated that the linkage curves have the same functional form by rescaling distances between sites by the recombination rate <italic>ρ</italic> inferred previously. We found a very good collapse of the linkage curves for the two species when plotted against the rescaled distances <xref rid="figA4_3" ref-type="fig">Fig. 3B</xref>. This strongly implies that the dynamics leading to the decay of linkage are the same in both species, with the differences between them being length scale over which sites are effectively linked.</p>
</sec>
<sec id="s7d">
<title>Linkage on intermediate length scales</title>
<p>Our analysis so far was limited to either distances up to the length of typical genes (~ 1 kbp) or across the entire genome. Extending our analysis over distances in between these two extremes is difficult due to several technical challenges. The first is the fact that typical coverages for our SAGs is around 30%. Together with the a typical contig size of ~ 10 kbp, this means that our sample size quickly decreases with distance. The second challenge is that at longer distances gene order might vary across genomes making it difficult to define a genomic distance at the population level.</p>
</sec>
<sec id="s7e">
<title>Linkage between multi-SNP alleles</title>
<p>We calculated the linkage disequilibrium between multi-SNP features, such as SNP blocks or hybrid alleles, using (2) as in the case of biallelic SNPs. In the case of SNP blocks shown in <xref rid="fig7" ref-type="fig">Fig. 7E</xref> in the main text, we calculate the frequencies for the four haplotypes within SAGs that are covered at both loci. The unlinked controls (represented by solid lines in <xref rid="fig7" ref-type="fig">Fig. 7E</xref>) were obtained by a random permutation of the alleles at each locus independently, while keeping the SAGs that are covered at each locus fixed. This procedure preserves any correlations in genome coverage between nearby loci and provides the most accurate estimate of <inline-formula><inline-graphic xlink:href="543983v2_inline23a.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for a completely unlinked genome.</p>
<p>The linkage between hybrid gene alleles were calculated similarly as for the SNP blocks, except for the genotype assignment. At each locus, we labeled the most abundant allele using upper case letters (<italic>A, B</italic>, …) and grouped all of the remaining ones into a single allele labeled by a lower case letter (<italic>a, b</italic>, …). The linkage matrix <inline-formula><inline-graphic xlink:href="543983v2_inline24.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and the unlinked control were calculated the same as previously described. The results for <italic>α</italic> were <inline-formula><inline-graphic xlink:href="543983v2_inline25.gif" mimetype="image" mime-subtype="gif"/></inline-formula> compared to <inline-formula><inline-graphic xlink:href="543983v2_inline26.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for the unlinked control. For <italic>β</italic> the results were <inline-formula><inline-graphic xlink:href="543983v2_inline26a.gif" mimetype="image" mime-subtype="gif"/></inline-formula> compared to <inline-formula><inline-graphic xlink:href="543983v2_inline26b.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for the unlinked control. Note that the average linkage disequilibrium was close to the unlinked controls in both species, with <italic>α</italic> having slightly higher linkage. These agree with those from the analysis of SNP blocks shown in the main text.</p>
</sec>
<sec id="s7f">
<title>Determining the main cloud cutoff for α and β</title>
<fig id="figA4_4" position="float" fig-type="figure">
<label>Appendix 4—figure 4.</label>
<caption><title>The effect of the main cloud diameter <italic>c</italic> on the rate of linkage decay.</title>
<p>The linkage decay within <italic>α</italic> (left panel) and <italic>β</italic> (right panel) is plotted for different main cloud cutoffs <italic>c</italic> (see main text). Note the convergence of the curves for <italic>c</italic> ≤ 0.05.</p></caption>
<graphic xlink:href="543983v2_figA4_4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For each species, we first selected all of the sequences that belonged to SAGs assigned to that species (see Sec. 2). We then calculated the consensus sequence for this group of sequences, as described above, and removed all sequences with divergences greater that a main cloud cutoff <italic>c</italic>. This is a simple way to remove sequences that are the result of gene-level hybridization (see Sec. 5 and <xref ref-type="bibr" rid="c60">Rosen et al. (2015)</xref> for a similar procedure). We chose the main cloud cutoff for each species by calculating the linkage curves for different values and choosing the largest value for which the curves did not noticeably change (<xref rid="figA4_4" ref-type="fig">Fig. 4</xref>). Based on this criterion, we use <italic>c</italic> = 0.05 for <italic>α</italic> and <italic>c</italic> = 0.1 for <italic>β</italic> throughout.</p>
</sec>
</sec>
</app>
<app id="app5">
<title>Appendix 5</title>
<sec id="s8">
<title>Gene-level hybridization</title>
<p>This section describes the method we used to quantify hybridization at the gene level. Our method uses a set of simple heuristics to assign labels to the species clusters defined in <xref ref-type="app" rid="app1">Appendix 1</xref> based on the composition of species to which the sequences belonged to. We then identified hybridization events by searching for for discrepancies between the gene and whole-genome labels as explained below.</p>
<sec id="s8a">
<title>Simple hybrid genes</title>
<p>We first assigned labels to the species-level clusters constructed as described in Sec. 1. Based on the gene triplet results presented in Sec. 2, we expect most sequences to be contained in two main clusters, close to OS-A and OS-B’, respectively, with at least one sequence forming a separate cluster whenever the orthogroup was covered in the <italic>γ</italic> SAG. Based on this expectation, we considered all of the clusters from each orthogroup in decreasing order of their sizes and labeled them as described in the main text.</p>
<p>We next determined which orthogroups are part of the core genome. We defined a gene as a core gene if it is likely present in all of the genomes in our sample. The average coverage for each SAG in our sample was approximately 30% so it is not possible to directly determine whether some genes are always present. Instead, we use a statistical measure of the coverage to assign orthogroups to the core genome. Specifically, we used the rank-coverage plot across all orthogroups and SAGs (equivalent to the complementary cumulative distribution) to determine an appropriate cutoff for the core genome. The rank-coverage plot showed three distinct regions. First there were around a dozen orthogroups that had unsually high abundances, with the number of sequences in some cases being greater than the number of SAGs in our sample. These are likely multiple-copy genes and IS elements and were excluded from further analysis. Then there was a large plateau comprising over 1, 000 orthogroups with coverages in the range 100 − 150, followed by a sharp decrease (on a logarithmic scale) in the coverage. We found that setting a coverage threshold for the presence at 20% of the number of SAGs from each species approximately matched the shoulder between the plateau and the sharp decrease and so we used this as a criterion for assigning core genes.</p>
<p>The final step in our algorithm is to catalog hybridization events, which we do by simply searching for gene sequences whose labels were different from the whole-genome species assignment. Analysis of these results showed a large number of transfers, mainly from <italic>β</italic> into <italic>α</italic>, which came from contigs that did not contain any genes labeled as the host species. One explanation for the presence of such contigs is that they represents larger genomic segments flanked by repetitive regions (such as IS elements) that are transferred and integrated into the host genome. Long repetitive genomic segments can lead to contig breaks during assembly, which would explain the complete absence of genes belonging to the host cluster. Alternatively, such contigs could be the result of contamination with external DNA. However, the contamination hypothesis does not explain why there seem to be more transfers from <italic>β</italic> into <italic>α</italic> than vice versa. We also did not find any evidence of differences in the number of such transfers between the sample containing only <italic>α</italic> SAGs (OS2005, see Sec. 10) and samples containing mixtures of <italic>α</italic> and <italic>β</italic>. While this evidence suggests these transfers are very likely the result of hybridization, we cannot rule out the possibility of contamination. We therefore excluded all hybridization events on contigs that did not contain any genes labeled as the host genome from the analysis. The results of our analysis are summarized in <xref rid="fig5" ref-type="fig">Fig. 5AB</xref> in the main text.</p>
<fig id="figA5_1" position="float" fig-type="figure">
<label>Appendix 5—figure 1.</label>
<caption><title>Majority of orthogroups contain hybrid sequences.</title>
<p>Orthogroups were classiffed into four mutually exclusive groups depending on the amount of hybridization observed. The majority of mixed-species orthogroups are mosaic hybrids (see main text) and shown in orange. Orthogroups in which the local sequence clusters matched the whole genome ones were labeled as “no hybrids and shown in blue, those in which a single cell contained a sequence from a different cluster were labeled “singleton hybrids” and shown in green, and those in which multiple cells contained sequences from different clusters were labeled “non-singleton hybrids” and shown in red.</p></caption>
<graphic xlink:href="543983v2_figA5_1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
</app>
<app id="app6">
<title>Appendix 6</title>
<sec id="s9">
<title>Linkage block detection and analysis</title>
<p>In this section we describe the method we used to discover SNP blocks and the statistical analyses we performed.</p>
<sec id="s9a">
<title>Processing alignments for SNP block detection</title>
<p>In order to identify linkage blocks originating from hybridization the raw alignments from the pangenome construction were processed as follows. We divided core OGs into distinct species clusters, as explained in Secs. 1 and 5, and removed any sequences from SAGs assigned to a different species than the cluster. This was done to avoid false positive blocks due to the presence of recently transferred whole-gene alleles from different species. For OGs with mixed-species mosaic clusters, all sequences in the cluster were initially included. Alignments were then trimmed and codons that contained a high frequency of gaps were removed. Finally, we defined a main cloud of sequences for <italic>α</italic> and <italic>β</italic> comprising sequences within a divergence diameter <italic>d</italic><sub><italic>M</italic></sub> = 0.1 from the consensus for each species and removed all sequences outside it.</p>
</sec>
<sec id="s9b">
<title>SNP block detection method</title>
<p>We used a linkage-based approach to search for evidence of hybridization within genes. Visual inspection of the alignments in the highly-diverse <italic>α</italic> genes and in most <italic>β</italic> genes revealed segments with high SNP density grouped into two haplotypes in strong linkage disequilibrium. We hypothesized that these SNP blocks were the result of intragenic hybridization and we developed an algorithm to systematically identify them.</p>
<p>The algorithm can be summarized by the following steps.</p>
<list list-type="order">
<list-item><p>Read orthogroup alignment</p></list-item>
<list-item><p>Pre-process alignment</p>
<list list-type="alpha-lower">
<list-item><p>Trim alignment edges and remove columns with high fraction of gap codons</p></list-item>
<list-item><p>For each species, infer consensus sequence and remove sequences outside a predetermined diameter around the consensus</p></list-item>
<list-item><p>Replace all SNPs with absolute frequencies <italic>n</italic> &lt; <italic>n</italic><sub><italic>c</italic></sub> = 4 with the consensus for their respective columns</p></list-item>
</list></list-item>
<list-item><p>For each species <italic>s</italic>, subsample sequences from cells assigned to <italic>s</italic></p></list-item>
<list-item><p>Calculate the linkage matrix <inline-formula><inline-graphic xlink:href="543983v2_inline26c.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for all pairs of SNPs</p></list-item>
<list-item><p>Identify groups of consecutive SNPs with <inline-formula><inline-graphic xlink:href="543983v2_inline26d.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, up to a rounding error of <italic>ϵ</italic> = 10<sup>−5</sup>, containing at least <italic>l</italic><sub><italic>min</italic></sub> = 5 SNPs</p></list-item>
</list>
<p>The inclusion of step 2c accounts for the possibility of more recent low-frequency SNPs emerging after the the initial hybridization took place. Note that typical alignments depths are ~ 30 for <italic>α</italic> and ~ 70 for <italic>β</italic>, and are considerably larger than <italic>n</italic><sub><italic>c</italic></sub>.</p>
<p>We applied the above algorithm to the alignments of all of the core genes and obtained a total of 1,000 blocks within <italic>α</italic> and 1,483 blocks within <italic>β</italic>. Most blocks were short, but those in <italic>α</italic> were on average more than twice as long as those in <italic>β</italic> (⟨<italic>L</italic>⟩ = 68 in <italic>α</italic> vs ⟨<italic>L</italic>⟩ = 29 in <italic>β</italic>; <xref rid="figA6_1" ref-type="fig">Fig. 1A</xref>). Similarly, <italic>α</italic> blocks contained more SNPs on average compared to <italic>β</italic>, although here the difference was less pronounced (⟨<italic>l</italic>⟩ = 11.3 in <italic>α</italic> vs ⟨<italic>l</italic>⟩ = 7.9 in <italic>β</italic>; <xref rid="figA6_1" ref-type="fig">Fig. 1B</xref>).</p>
<fig id="figA6_1" position="float" fig-type="figure">
<label>Appendix 6—figure 1.</label>
<caption><title>Typical blocks are short and contain a handful of SNPs.</title>
<p>(<bold>A</bold>) The distribution of lengths of SNP blocks within <italic>α</italic> (orange) and <italic>β</italic> (blue) genomes, detected using the algorithm described in this section. (<bold>B</bold>) The distribution of the number of SNPs within the same blocks as in (A).</p></caption>
<graphic xlink:href="543983v2_figA6_1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To identify hybrid haplotypes, we first determined the consensus sequences for the two block haplotypes, together with the other two species within the block segment. We then labeled any haplotypes whose sequence was identical to one of the other two species as a hybrid segment with the corresponding species as the donor. These result are shown in <xref ref-type="table" rid="tblA6_1">Table 1</xref>.</p>
<table-wrap id="tblA6_1" orientation="portrait" position="float">
<label>Appendix 6—table 1.</label>
<caption><title>Number of SNP blocks within <italic>α</italic> and <italic>β</italic> containing haplotypes that mapped to different donor species in core genome.</title></caption>
<graphic xlink:href="543983v2_tblA6_1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>To control for other processes that could potentially produce similar patterns of linkage disequilibrium we compared the distributions of divergences between haplotypes and block lengths for cases where a hybrid haplotype could be identified directly to cases we could not. No obvious difference in the distributions could be seen between the two cases, consistent with our interpretation that the blocks without matches to other species in our sample are also the result of hybridization.</p>
<fig id="figA6_2" position="float" fig-type="figure">
<label>Appendix 6—figure 2.</label>
<caption><title>Examples of blocks and hybrid sequences within ribosomal genes.</title>
<p>Aligments are represented as described previously with blocks highlighted in purple. (<bold>A</bold>) Alignment of 16S sequences with a <italic>β</italic> cell containing a hybrid segment starting at around position 340 and ending around position 580 in the alignment. Note the shorter block shared by the first two <italic>β</italic> sequences at the endo of the alignment (around position 1070). (<bold>B</bold>) Alignment of the SSU ribosomal protein rpsN with <italic>α</italic> cells ordered at the top and <italic>β</italic> cells at the bottom of the alignment. The first <italic>α</italic> cell was chosen as the reference sequence and is shown in color. Note the large fraction of <italic>α</italic> cells around 200-300 bp that are similar to the <italic>β</italic> sequences and distinct from the <italic>α</italic> reference. (<bold>C</bold>) Segment of alignment of <italic>β</italic> sequences at the LSU ribosomal protein rplM. The reference sequence was chosen to illustrate short SNP block in the center of the alignment.</p></caption>
<graphic xlink:href="543983v2_figA6_2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s9c">
<title>Haplotype divergences</title>
<p>We further verified that the divergences between block haplotypes were consistent with what we would expect from hybridization. We calculated the fraction of nonsynonymous and synonymous nucleotide substitutions, <italic>p</italic><sub><italic>N</italic></sub> and <italic>p</italic><sub><italic>S</italic></sub>, respectively, between the consensus sequences of each haplotype (see Sec. 7). We then removed blocks with either <italic>p</italic><sub><italic>N</italic></sub> or <italic>p</italic><sub><italic>S</italic></sub> were above a threshold of 0.6. This was done to avoid large errors in estimating the divergence, which we calculated using the Jukes-Cantor correction <italic>d</italic> = −(3/4) ln(1 − 4<italic>p</italic>/3) <xref ref-type="bibr" rid="c30">Jukes and Cantor (1969)</xref>. The overall number of such blocks was small (46 out of 1442 in <italic>α</italic> and 143 out of 2008 in <italic>β</italic>) so their removal does not affect our conclusions about the typical blocks. We found that the distributions of both the nonsynonymous and synonymous divergences were similar to those previously reported from comparisons of OS-A and OS-B’ <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>, and consistent with our hybridization hypothesis (<xref rid="figA6_3" ref-type="fig">Fig. 3</xref>).</p>
<fig id="figA6_3" position="float" fig-type="figure">
<label>Appendix 6—figure 3.</label>
<caption><title>Block haplotypes have high synonymous and non-synonymous divergences, consistent with them being generated through hybridization.</title>
<p>Panels show histograms of nonsynonymous (blue) and synonymous (orange) divergences between the two haplotypes of SNP blocks from <italic>α</italic> (<bold>A</bold>) and <italic>β</italic> (<bold>B</bold>), respectively. Solid vertical lines show the mean</p></caption>
<graphic xlink:href="543983v2_figA6_3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
</app>
<app id="app7">
<title>Appendix 7</title>
<sec id="s10">
<title>Genetic diversity analysis</title>
<p>In this section we present our analysis of the genetic diversity within individual genes in <italic>α</italic> and <italic>β</italic>. In the first subsection we define the different metrics we used and present the variations in diversity along the genome of both species. In the next four subsections we compare the diversity of different genes and use the <italic>α</italic> backbone to roughly infer the time scales of the evolutionary process. In the last subsection we present a scenario for the evolution of the population.</p>
<sec id="s10a">
<title>Nucleotide diversity along the core genome</title>
<p>We quantified the nucleotide diversity across all genes in both <italic>α</italic> and <italic>β</italic> using the following procedure. Alignments were trimmed for excess gaps and sequences were assigned to each species as described in <xref ref-type="app" rid="app2">Appendix 2</xref>. We then define the nucleotide diversity in the usual way as
<disp-formula id="eqn7">
<graphic xlink:href="543983v2_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>I</italic> is an index for sequences in the alignment, <italic>S</italic> is the sample size, equal to the number of elements in <italic>I</italic>, and <italic>π</italic><sub><italic>ij</italic></sub> is the fraction of nucleotide substitutions between <italic>i</italic> and <italic>j</italic>, excluding gaps. To calculate synonymous (<italic>π</italic><sub><italic>S</italic></sub>) and non-synonymous diversities (<italic>π</italic><sub><italic>N</italic></sub>) we replace <italic>π</italic><sub><italic>ij</italic></sub> with the fraction of synonymous <inline-formula><inline-graphic xlink:href="543983v2_inline27.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and non-synonymous substitutions <inline-formula><inline-graphic xlink:href="543983v2_inline28.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, respectively. We calculated <inline-formula><inline-graphic xlink:href="543983v2_inline29.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="543983v2_inline30.gif" mimetype="image" mime-subtype="gif"/></inline-formula> using two different methods: the fraction of four-fold degenerate (4D) and one-fold degenerate (1D) sites, respectively, at which <italic>i</italic> and <italic>j</italic> differ and using the NeiGojobori method <xref ref-type="bibr" rid="c49">Nei and Gojobori (1986)</xref>. We found that both methods gave similar results and used the one that was most convenient for each analysis.</p>
<p>To calculate the divergence between species, we first determined the proportion of sites that were substituted as follows:
<disp-formula id="eqn8">
<graphic xlink:href="543983v2_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>I</italic><sub><italic>α</italic></sub> and <italic>I</italic><sub><italic>β</italic></sub> are the indices of sequences from <italic>α</italic> and <italic>β</italic> in the alignment, and <italic>S</italic><sub><italic>α</italic></sub> and <italic>S</italic><sub><italic>β</italic></sub> are number of sequences from each species, respectively. The fraction of pairwise substitutions <italic>π</italic><sub><italic>ij</italic></sub> is the same as above. We then use the Jukes-Cantor correction <xref ref-type="bibr" rid="c30">Jukes and Cantor (1969)</xref> to correct for the effect of multiple substitutions at a single site
<disp-formula id="eqn9">
<graphic xlink:href="543983v2_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
The synonymous (<italic>d</italic><sub><italic>S</italic></sub>) and non-synonymous divergences (<italic>d</italic><sub><italic>N</italic></sub>) were calculated in a similar way by replacing <italic>π</italic><sub><italic>ij</italic></sub> with <inline-formula><inline-graphic xlink:href="543983v2_inline31.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="543983v2_inline32.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in (8), respectively. Finally, to calculate the diversity within each species separately we take the sum in (7) over <italic>I</italic><sub><italic>α</italic></sub> or <italic>I</italic><sub><italic>β</italic></sub> only.</p>
</sec>
<sec id="s10b">
<title>Diversity heterogeneity along core genome</title>
<p>There are two plausible explanations for the heterogeneity within <italic>α</italic> found in <xref rid="fig3" ref-type="fig">Fig. 3</xref> (main text). The low diversity genes could be due to local sweeps similar to the ones that formed the diversity troughs shown in <xref rid="fig5" ref-type="fig">Fig. 5</xref> in the main text. Under this scenario, the high diversity genes would represent the typical diversity within <italic>α</italic> that has accumulated since its common ancestor. Since the high diversity genes are as diverse as typical <italic>β</italic> genes, this scenario would imply <italic>α</italic> and <italic>β</italic> each had common ancestors at similar time in the past. Alternatively, the low diversity genes could represent the typical diversity within <italic>α</italic>, with the high diversity genes being the result of hybridization with other species.</p>
<p>To distinguish between these two possibilities we developed a method to separate low diversity from high diversity genes within <italic>α</italic>. Specifically we calculated the fraction <inline-formula><inline-graphic xlink:href="543983v2_inline33.gif" mimetype="image" mime-subtype="gif"/></inline-formula> of 4D sites at locus <italic>l</italic> that were polymorphic within the <italic>α</italic> alignment. Here <inline-formula><inline-graphic xlink:href="543983v2_inline34.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the number of synonymous polymorphisms and <inline-formula><inline-graphic xlink:href="543983v2_inline35.gif" mimetype="image" mime-subtype="gif"/></inline-formula> the number synonymous sites at that gene. By using 4D sites we naturally control for differences in gene conservation. If mutation rates across loci do not vary too much, we expect the distribution of <inline-formula><inline-graphic xlink:href="543983v2_inline36.gif" mimetype="image" mime-subtype="gif"/></inline-formula> across genes to be given by a Poisson distribution. The mean of this Poisson distribution can be fitted from the fraction of sites that are not polymorphic
<disp-formula id="eqn10">
<graphic xlink:href="543983v2_eqn10.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
from which we get the following estimate for the mean:
<disp-formula id="eqn11">
<graphic xlink:href="543983v2_eqn11.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
When we compared this prediction to the data for <italic>α</italic> we found that the Poisson distribution gave an excellent fit for around half of the core genes (675 out of 1448) with <inline-formula><inline-graphic xlink:href="543983v2_inline37.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. In the remaining core genes (773 out of 1448), <inline-formula><inline-graphic xlink:href="543983v2_inline38.gif" mimetype="image" mime-subtype="gif"/></inline-formula> was much larger than predicted from the Poisson (<xref rid="fig3" ref-type="fig">Fig. 3B</xref> in main text). Note that the agreement in the inset of <xref rid="fig3" ref-type="fig">Fig. 3B</xref> is based on a single fitting parameter. Based on these results we chose a threshold of <inline-formula><inline-graphic xlink:href="543983v2_inline39.gif" mimetype="image" mime-subtype="gif"/></inline-formula> to define the <italic>α ancestral backbone</italic>, with all other genes labeled as hybrid.</p>
<p>To validate our partition, calculate the synonymous diversity <italic>π</italic><sub><italic>S</italic></sub> within each group. We found that our criterion produced a clear separation in the synonymous diversity, with low diversity genes having a mean <italic>π</italic><sub><italic>S</italic></sub> ≈ 1.7 × 10<sup>−3</sup>, compared to <italic>π</italic><sub><italic>S</italic></sub> ≈ 3.4 × 10<sup>−2</sup> for the high diversity genes. As a result, we estimate that more than 95% of the genetic diversity within <italic>α</italic> is the result of hybridization. This result shows that molecular clock estimate of the time since the most common ancestor based on <italic>T</italic><sub><italic>MRCA</italic></sub> = <italic>π</italic><sub><italic>S</italic></sub> /(2<italic>μτ</italic>), where <italic>μ</italic> is the mutation rate per division and <italic>τ</italic> the generation time, should be interpreted with caution. In the case of <italic>α</italic> the estimate using the average <italic>π</italic><sub><italic>S</italic></sub> across the whole genome would be around an order of magnitude less than the true value, even without considering how mutation rates might change over such long time scales.</p>
<p>We performed a similar analysis for <italic>β</italic> but did not find any large peak near <inline-formula><inline-graphic xlink:href="543983v2_inline40.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (<xref rid="fig3" ref-type="fig">Fig. 3C</xref> in main text). Instead the distribution of <inline-formula><inline-graphic xlink:href="543983v2_inline41.gif" mimetype="image" mime-subtype="gif"/></inline-formula> was close to unimodal but with significantly fatter tails compared to the Poisson. Given the excellent fit to the Poisson for <italic>α</italic> in the region where SNPs are purely due to mutations, this suggests that other mechanisms plat an important role in generating the diversity within <italic>β</italic>. The most parsimonious explanation is that the hybridization process we observed in <italic>α</italic> has covered most of the original <italic>β</italic> genome by this point. While it is not clear what the distribution of <inline-formula><inline-graphic xlink:href="543983v2_inline42.gif" mimetype="image" mime-subtype="gif"/></inline-formula> should be in this case, it is plausible that it need not be Poisson <xref ref-type="bibr" rid="c62">Sakoparnig et al. (2021)</xref>. Further evidence in favor of this hypothesis is the presence of SNP blocks across a large fraction of <italic>β</italic> core genes, as discussed in the main text and 6.</p>
</sec>
<sec id="s10c">
<title>Contribution of hybridization to genetic diversity</title>
<p>The large number of SNP block found throughout the genomes of both <italic>α</italic> and <italic>β</italic> show that hybridization is an important source of genetic diversity for the <italic>Synechococcus</italic> population. However, because of the requirement for perfect linkage within SNP blocks, the total number of SNPs that are the result of hybridization is likely much higher than the one we infer from our algorithm. To obtain quantitative estimates of the total contribution from hybridization to the diversity we use <italic>α</italic> as a control. As shown previously, only ≈ 5% of the total diversity in the high-diversity loci from <italic>α</italic> can be attributed to mutations. These loci contained 603, 588 sites and 64, 462 SNPs, of which 10, 391 SNPs were found inside SNP blocks. Thus only around 17% of the SNPs that are likely the result of hybridization, or hybrid SNPs, are included in the SNP blocks.</p>
<p>Within the <italic>β</italic> core genome, we have 1, 591, 476 sites and 146, 906 SNPs, of which 14, 819 were within SNP blocks. Assuming a similar ratio of hybrid SNPs to SNPs in SNP blocks as in <italic>α</italic>, we estimate that around 90, 000 or approximately 60% of SNPs in <italic>β</italic> are the result of hybridization. This is consistent with <italic>β</italic> having evolved over longer time compared to <italic>α</italic>. However, our knowledge of how multi-locus SNP patterns change over the course of evolution is limited so the estimates for <italic>β</italic> should be interpreted with caution. In particular, if larger segments continue to be broken up due to recombination, it is likely that the fraction of hybrid SNPs within blocks would decrease over time for a constant minimum block size <italic>l</italic><sub><italic>min</italic></sub> (see Sec. 6). Thus the overall contribution of hybridization to the <italic>β</italic> genetic diversity may be even higher.</p>
</sec>
<sec id="s10d">
<title>Geological constraints on microbial evolution</title>
<p>Combining genetic diversity analysis with evidence from the geological record of the Yellowstone caldera allows us to make inferences about the evolutionary history of the Synechococcus population. If we assume that most of the fixed variants between species are the result of mutation accumulation, then we can use the typical synonymous divergence between species to infer the time since the most recent common ancestor for the whole population. Typical bacterial mutation rates for natural populations are around <italic>μ</italic> ~ 10<sup>−9.5</sup> per bp per generation <xref ref-type="bibr" rid="c11">Chen et al. (2022)</xref>. Using this rates as a baseline and assuming generation times of <italic>τ</italic> ~ 1 − 10 days gives an estimate of <italic>T</italic><sub><italic>MRCA</italic></sub> ~ 10<sup>6.5</sup>−10<sup>7.5</sup> years <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>.</p>
<p>For our argument, the lower bound is the more important one since it determines whether we can exclude the single-colonizer hypothesis. A <italic>T</italic><sub><italic>MRCA</italic></sub> below 10<sup>6.5</sup> years would imply a shorter division time or higher mutation rate than our estimates. Our lower bound of one day for the division time is around the same as the fastest division rate observed in the laboratory. If the population is in steady state, as it appears to be, the division time sets the maximum generation time, which can be attained if the death rate is equally high. If the death rate is lower than this, other factors would limit cell division and the generation times would be longer. Taken together, we can be fairly confident that a generation time of one day is a hard lower bound.</p>
<p>The mutation rate is less certain since we do not have any reliable measurements and experimentally measured mutation rates might not be a good predictor of substitution rates over evolutionary times <xref ref-type="bibr" rid="c59">Rocha (2018)</xref>. We can instead use other bacteria to estimate a range of values. In wild-type <italic>E. coli</italic>, mutation rates of ≈ 2 · 10<sup>−10</sup> per bp per generation have been measured in laboratory conditions <xref ref-type="bibr" rid="c37">Lee et al. (2012)</xref>, but mutator strains with rates that are up to 100 times higher are also known <xref ref-type="bibr" rid="c67">Sniegowski et al. (1997)</xref>. In natural populations, rates as high as 4·10<sup>−9</sup> have been inferred using longitudinal sequencing <xref ref-type="bibr" rid="c45">Moran et al. (2009)</xref>. If we use 10<sup>−8.5</sup> mutations per bp per generation as an upper bound, we would infer a lower bound of <italic>T</italic><sub><italic>MRCA</italic></sub> ~ 10<sup>5.5</sup> years, which very narrowly overlap with the time since the formation of the Yellowstone caldera. Thus, while it is not inconceivable that the three species could have diverged within the caldera, such a scenario would requires all the relevant parameters to be at the limit of currently known values. In addition, such a scenario would require additional hypotheses to explain why the strains initially diverged into distinct species, with seemingly little genetic exchange between them <xref ref-type="bibr" rid="c61">Rosen et al. (2018)</xref>, and then only much later started to hybridize. Taken together, current evidence suggests the most likely scenario is that <italic>α, β</italic>, and <italic>γ</italic> diverged from a common ancestor before the formation of the caldera around 640 000 years ago.</p>
</sec>
<sec id="s10e">
<title>Upper bound on mixing time between springs</title>
<fig id="figA7_1" position="float" fig-type="figure">
<label>Appendix 7—figure 1.</label>
<caption><title>Non-hybrid regions of <italic>α</italic> have similar levels of diversity within and between springs.</title>
<p>The distribution of pairwise synonymous diversity was calculated across non-hybrid genes from the alpha <italic>α</italic> population for different subgroups of cells. Square symbols show the distributions for pairs of cells from the same spring (purple for Mushroom Spring and cyan for Octopus Spring). The cyano triangles show the distribution for a random subsample of cells from the Octopus Spring of the same size as the Mushroom Spring sample (<italic>n</italic> = 35) for comparison. The red diamonds show the distribution for pairs of cells from different springs. Non-hybrid genes were determined using a 5% cutoff in the fraction of polymorphic synonymous sites (see text).</p></caption>
<graphic xlink:href="543983v2_figA7_1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>By using the diversity within <italic>α</italic> as a proxy for time, we can obtain estimates on the time scales of spatial mixing that influences the diversity within the population. To do this, we calculated the pairwise distances in the low diversity regions of the <italic>α</italic> genome between pairs of cells in each spring separately and pairs of cells from different springs. We found that the distribution all three distributions were similar (<xref rid="figA7_1" ref-type="fig">Fig. 1</xref>). The mean of the distribution for cells Mushroom Spring was slightly lower than those from the Octopus spring (<italic>π</italic><sub><italic>S</italic></sub> = 8.6 · 10<sup>−4</sup> vs <italic>π</italic><sub><italic>S</italic></sub> = 1.1 · 10<sup>−3</sup>) and this difference could not be explained by difference in sample sizes between the two springs. However, both values were very close to the mean of cells from different springs (<italic>π</italic><sub><italic>S</italic></sub> = 1.0 · 10<sup>−3</sup>). This suggests that the time scale of spatial processes relevant for the long-term evolution of the population, <italic>τ</italic><sub><italic>m</italic></sub> is much shorter time scales than <italic>T</italic><sub><italic>MRCA</italic></sub> for <italic>α</italic>. Taking <italic>T</italic><sub><italic>MRCA</italic></sub> ~ 3 · 10<sup>3</sup> years as a reference point sets an upper bound of <italic>τ</italic><sub><italic>m</italic></sub> ≪ 3 · 10<sup>3</sup> years.</p>
</sec>
<sec id="s10f">
<title>Proposed scenario for Synechococcus evolution</title>
<p>We propose the following scenario that is consistent with our previous discussion. First we argued that a small number (3-6, but possibly more) of Synechococcus populations that had been evolving separately for ~ 10<sup>6</sup> − 10<sup>7</sup> years independently colonized the Yellowstone caldera after its formation 640 000 years ago. After colonization, they started to hybridize leading to a gradual mixing of their genomes (<xref rid="fig8" ref-type="fig">Fig. 8A</xref>). This can be most clearly seen in the <italic>α</italic> species, where the diversity in core genes that do not show signs of hybridization is more than an order of magnitude less that those that do. Moreover, genes that have undergone hybridization account for the majority of diversity within <italic>α</italic>. Within <italic>β</italic> we do not observe such heterogeneity, but we find SNP blocks are even more prevalent than in <italic>α</italic> (Table 1). The simplest explanation for this pattern is that <italic>β</italic> has been undergoing hybridization for longer and by now all of its core genome has been mixed with other species. Consistent with this explanation, we find that only a small fraction of SNP blocks within <italic>β</italic> can be traced back to <italic>α</italic> (Table 1). Most of the <italic>β</italic> SNP blocks cannot be traced to either <italic>α</italic> or <italic>γ</italic> and are likely the result of a combination of hybridization with species that are not currently within the Lower Geyser Basin, have abundances lower than our detection threshold, or have gone extinct.</p>
</sec>
</sec>
</app>
<app id="app8">
<title>Appendix 8</title>
<sec id="s11">
<title>Estimate of recombination parameters</title>
<p>There are several important parameters that determine the impact of recombination and hybridization on the evolution of the population. First are the rate of recombination and mutation in the population. We denote the population recombination rate by <italic>ρ</italic> = 2<italic>TR</italic> and the population mutation rate by <italic>θ</italic> = 2<italic>Tμ</italic>, where <italic>T</italic> is the average time since the most common ancestor, <italic>R</italic> is the recombination rate per site, and <italic>μ</italic> is the mutation rate per site. Note that in the panmitic Wright-Fisher model, <italic>T</italic> in units of generation time is equal to the population size <italic>N</italic>, but this is not generally true <xref ref-type="bibr" rid="c48">Neher and Hallatschek (2013)</xref>; <xref ref-type="bibr" rid="c77">Weissman and Hallatschek (2014)</xref>; <xref ref-type="bibr" rid="c6">Birzu et al. (2018</xref>, 2021). A second important parameter is typical length of recombined segments, which we denote by <italic>L</italic><sub><italic>r</italic></sub>. Finally, there is the typical divergence of recombined segments. In this Appendix, we use the nucleotide distance <italic>p</italic> or the synonymous distance <italic>p</italic><sub><italic>S</italic></sub>, as defined in <xref ref-type="app" rid="app7">Appendix 7</xref>. We estimated these parameters for the hybridization process, which we argued previously is the dominant source of diversity in the population.</p>
<p>Before describing the analysis, it is important to note that while some of the simple statistics discussed here may be captured by simple neutral models, the underlying dynamics may be far more complex. Indeed, the analysis in the main text shows extensive evidence of selective sweeps affecting the genetic diversity across a broad range of genomic length scales, contrary to simple neutral theory. Moreover, while our analysis shows that—over time scales implied by our sequencing depth—the <italic>Synechococcus</italic> population is effectively well-mixed within the caldera, the actual population is obviously not. <italic>Synechococcus</italic> cells live in a dense microbial mats spread across thousands of springs separated by distances up to ~ 10<sup>2</sup> km <xref ref-type="bibr" rid="c75">Ward et al. (1998)</xref>. As a result, we expect the long-term evolution of the population to be described by <italic>effective</italic> parameters, which may have little relation to recombination rates and population sizes directly measurable in the field or in the laboratory <xref ref-type="bibr" rid="c48">Neher and Hallatschek (2013)</xref>; <xref ref-type="bibr" rid="c77">Weissman and Hallatschek (2014)</xref>; <xref ref-type="bibr" rid="c6">Birzu et al. (2018</xref>, 2021). Understanding the relationship between the measurable parameters describing recombination, selection, and spatial dynamics of individual cells and the effective parameters at the population scale is an important and interesting topic for future work.</p>
<p>Many different methods have been proposed to estimate these or other closely-related parameters <xref ref-type="bibr" rid="c15">Croucher et al. (2014)</xref>; <xref ref-type="bibr" rid="c19">Didelot and Wilson (2015)</xref>; <xref ref-type="bibr" rid="c40">Lin and Kussell (2019)</xref>. All of the methods we are aware of are based on models that make various assumptions that may not be valid for any given population, such as ours. In our case, an accurate estimate of these parameters requires a quantitative model of the hybridization process and is beyond the scope of the paper. Here, we instead used the results of our previous analysis to get rough estimates of these parameters and compared them to two other commonly-used methods.</p>
<p>We considered each species separately, starting with <italic>α</italic>. For most evolutionary models <italic>θ</italic> can be estimated from the nucleotide diversity <italic>π</italic> <xref ref-type="bibr" rid="c48">Neher and Hallatschek (2013)</xref>. As in the main text, we used only synonymous sites, to control for differences in the strength of purifying selection or the accumulation of non-synonymous mutations during rapid adaptation. Based on our previous analysis, we estimated the population synonymous mutation rate <italic>θ</italic><sub><italic>S</italic></sub> ≈ 2 · 10<sup>−3</sup> (<xref ref-type="app" rid="app7">Appendix 7</xref>). Because of the clear distinction between the ancestral backbone and hybrid genes in <italic>α</italic> we expect this estimate to be reasonably accurate. A rough estimate of <italic>ρ</italic> can be obtained from the linkage disequilibrium curves (<xref rid="figA8_2" ref-type="fig">Fig. 2</xref> in main text). Our previous analysis showed that <italic>ρ</italic> ≈ 0.03 and <italic>ρ</italic> ≈ 0.12 gave good fits for <italic>α</italic> and <italic>β</italic>, respectively. Taking the ratio, we found a ratio between recombination and mutations of <italic>ρ</italic>/<italic>θ</italic><sub><italic>S</italic></sub> ≈ 15—much higher than previous estimates.</p>
<p>Estimating the mutation rate in <italic>β</italic> is more difficult because there are no genes unaffected by hybridization. We instead used the fraction of SNPs found in SNP blocks to estimate the diversity purely due to mutations. In <xref ref-type="app" rid="app7">Appendix 7</xref> we estimated that around 40% of SNPs are the result of mutations. Multiplying with the synonymous diversity gave <italic>θ</italic><sub><italic>S</italic></sub> ≈ 0.02. Using this estimate we found <italic>ρ</italic>/<italic>θ</italic><sub><italic>S</italic></sub> ≈ 6, which is lower than in <italic>α</italic> but still significantly higher than values that have been reported previously.</p>
<p>The other recombination parameters can also be inferred from our analysis. As we showed previously, the typical divergence of hybrid segments is given by the synonymous distance between species <italic>p</italic><sub><italic>S</italic></sub> ≈ 0.4. We estimated the average size of recombined segments from the linkage curves. The recombination rate between two sites on the genome increases linearly with the separation <italic>x</italic> for distances shorter <italic>L</italic><sub><italic>r</italic></sub>. In the standard neutral model, this leads to the scaling <inline-formula><inline-graphic xlink:href="543983v2_inline43.gif" mimetype="image" mime-subtype="gif"/></inline-formula> at intermediate distances (see <xref ref-type="app" rid="app4">Appendix 4</xref>). For <italic>x</italic> &gt; <italic>L</italic><sub><italic>r</italic></sub>, the recombination rate saturates to the genomewide recombination rate ~ <italic>ρL</italic><sub><italic>r</italic></sub>, which results in deviations of the linkage decrease from the predicted <inline-formula><inline-graphic xlink:href="543983v2_inline44.gif" mimetype="image" mime-subtype="gif"/></inline-formula> scaling. In <italic>α</italic>, we observe a deviation around <italic>x</italic> ~ 500 bp. Note that we verified that this plateau cannot be explained by the smaller finite sample size in <italic>α</italic>. A similar argument gives a shorted segment length <italic>L</italic><sub><italic>r</italic></sub> ~ 300 bp in beta. While we cannot directly test that the plateau is not due to sample size, the small effect of subsampling we observed earlier suggests it is an unlikely explanation (<xref rid="figA8_2" ref-type="fig">Fig. 2</xref> in <xref ref-type="app" rid="app4">Appendix 4</xref>). Note that in both species our estimated genomewide recombination rate <italic>ρL</italic><sub><italic>r</italic></sub> is much greater than one, consistent with the genomewide linkage being close to the unlinked control, as discussed in the main text.</p>
<sec id="s11a">
<title>Comparison to other methods</title>
<p>We compared our analysis to standard methods. ClonalFrameML and other related software are perhaps the most widely used methods to infer bacterial recombination <xref ref-type="bibr" rid="c19">Didelot and Wilson (2015)</xref>. Such methods assume that recombination rates are rare enough that they can be described by a Poisson process on an asexual tree, similar to mutations. We refer to assumption as the <italic>clonal frame hypothesis</italic>. ClonalFrameML uses the inferred phylogenetic tree from pairwise distances to identify discrete recombination events and assign them to branches on the tree. The recombination rate, genetic divergence, and length of recombined segments are then inferred from these events.</p>
<p>Note that the clonal frame hypothesis is inconsistent with the rapid decrease in linkage we observed (<xref rid="figA8_2" ref-type="fig">Fig. 2</xref> in main text). Nevertheless it is useful to see how the method performs on our data.</p>
<p>We used a subset of high-coverage SAGs to create whole-genome alignments for <italic>α</italic> and <italic>β</italic>, which we then analyzed with ClonalFrameML. We first selected SAGs more than 75% complete, which resulted in a dataset of 2 <italic>α</italic> and 12 <italic>β</italic> SAGs (<xref rid="figA8_1" ref-type="fig">Fig. 1</xref> in <xref ref-type="app" rid="app1">Appendix 1</xref>). For each species, we chose the genes that mapped to OS-A or OS-B’ and created concatenated alignments of the entire genome in the order of the references. Missing genes or sequences were replaced by gaps. We constructed the phylogenetic tree using FastTree and ran ClonalFrameML on the alignments and trees with default parameters.</p>
<fig id="figA8_1" position="float" fig-type="figure">
<label>Appendix 8—figure 1.</label>
<caption><title>ClonalFrameML does not converge to self-consistent set of recombination events in high-coverage <italic>β</italic> SAGs.</title>
<p>Whole-genome alignments for 12 high-coverage <italic>β</italic> SAGs were generated as described in the main text. The phylogenetic tree for this subset was inferred using FastTree with default parameters and used as input for ClonalFrameML. The histogram shows the distribution of the length of recombined segments inferred by ClonalFrameML. The solid black line shows the maximum-likelihood exponential distribution used to fit the inferred segments. Note the heavy tail of the inferred distribution which is inconsistent with the exponential fit.</p></caption>
<graphic xlink:href="543983v2_figA8_1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For both species ClonalFrameML inferred a ratio of recombination to mutation rates <italic>ρ</italic>/<italic>θ</italic> ≈ 1 (<italic>R</italic>/<italic>θ</italic> in <xref ref-type="bibr" rid="c19">Didelot and Wilson (2015)</xref>) and a fraction of nucleotide differences for imported segments of <italic>p</italic> = 0.07 − 0.09 (<italic>ν</italic> in <xref ref-type="bibr" rid="c19">Didelot and Wilson (2015)</xref>) (note that both <italic>θ</italic> and <italic>p</italic> reported by ClonalFrameML refer to nucleotide rather than synonymous differences). The values of <italic>p</italic> are around half of the distance between species <italic>p</italic> ≈ 0.15 and are inconsistent with our metagenome analysis which showed no genomes present in OS or MS at these divergences. The main difference between the species was in the average length of recombined segments, which was almost 10 times higher in <italic>α</italic> (<italic>L</italic><sub><italic>r</italic></sub> = 365) compared to <italic>β</italic> (<italic>L</italic><sub><italic>r</italic></sub> = 45).</p>
<p>A detailed comparison of the results of ClonalFrameML with our analysis is beyond the scope of this paper. Nevertheless, we found several inconsistencies in the assignment of recombined segments by ClonalFrameML. Because of the lack of data in <italic>α</italic>, we focused this analysis on <italic>β</italic>. First, we found that the distribution of recombined segment lengths was inconsistent the exponential distribution assumed by ClonalFrameML and had a mean that was almost double the inferred <italic>δ</italic> = 45 (<xref rid="figA8_1" ref-type="fig">Fig. 1</xref>). Second, manual validation of a small sample of randomly chosen recombined segments revealed identical patterns present in other cells that were not assigned to the recombination event (data not shown). We suspect that these misassignments are due to the inconsistency of the observed segments with the asexual tree.</p>
<p>The failure of ClonalFrameML to fit the data should not be surprising. As we showed, the low-levels of linkage at whole-genome scales in <italic>α</italic> and <italic>β</italic> are inconsistent with the existence of a clonal frame assumed by the model. In addition, manual validation of some of the recombined segments detected revealed spurious segments caused by gaps in coverage due to the incomplete nature of the SAGs. These results caution against the naive application of methods such as ClonalFrameML to SAG datasets in general, but also to other populations for which the clonal frame hypothesis may not hold.</p>
<fig id="figA8_2" position="float" fig-type="figure">
<label>Appendix 8—figure 2.</label>
<caption><title>SNP correlation profiles in <italic>α</italic> agree with mcorr fits, but show significant discrepancies at short distances in <italic>β</italic>.</title></caption>
<graphic xlink:href="543983v2_figA8_2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>An alternative method for fitting the clonal frame model was proposed recently by <xref ref-type="bibr" rid="c39">Lin and Kussell (2017</xref>, 2019). Instead of identifying recombination events directly, they use the correlations between SNPs to infer the recombination parameters statistically. Specifically, they model a local (“sample”) population that evolves according to a neutral model with recombination. They assume that the population recombines with a larger and more diverse “pool” that evolves according to the same model but with different parameters. Under this model and assuming the recombination to mutation rate ratios are the same in the sample and pool populations, they show that the conditional probability that two sequences differ at a site given that they differ at a second site <italic>l</italic> bp away, <italic>P</italic> (<italic>l</italic>), depends only on population mutation rate (<italic>θ</italic> in our notation), the population recombination rate (<italic>ρ</italic>) and the average length of recombined segments (<italic>L</italic><sub><italic>r</italic></sub>). By fitting the analytical expression for <italic>P</italic> (<italic>l</italic>) from the model to the data, all of the model parameters can be inferred.</p>
<table-wrap id="tblA8_1" orientation="portrait" position="float">
<label>Appendix 8—table 1.</label>
<caption><title>Comparison between recombination parameters obtained from our analysis, mcorr <xref ref-type="bibr" rid="c40">Lin and Kussell (2019)</xref>, and ClonalFrameML <xref ref-type="bibr" rid="c19">Didelot and Wilson (2015)</xref>.</title>
<p>For each species, the four columns show the estimated ratio of recombination and mutation rates <italic>ρ</italic>/<italic>θ</italic>, the average length of recombined segments <italic>L</italic><sub><italic>r</italic></sub>, the fraction of nucleotide differences between host and recombined segments <italic>p</italic>, and the ancestral nucleotide diversity <italic>θ</italic> estimated by the different methods. All quantities were converted to the notation used in the text as follows. The mcorr columns are the best fit values of the parameters <italic>ϕ</italic><sub><italic>s</italic></sub>/<italic>θ</italic><sub><italic>s</italic></sub>, <italic>f, d</italic><sub><italic>p</italic></sub>, and <italic>θ</italic><sub><italic>s</italic></sub> from <xref ref-type="bibr" rid="c40">Lin and Kussell (2019)</xref>. The ClonalFrameML columns are the maximum likelihood values of the parameters <inline-formula><inline-graphic xlink:href="543983v2_inline53.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and <italic>θ</italic> from <xref ref-type="bibr" rid="c19">Didelot and Wilson (2015)</xref>. Note that our analysis and mcorr only used synonymous sites, while ClonalFrameML used all sites. The diversity parameters (<italic>ρ</italic>/<italic>θ, p</italic>, and <italic>θ</italic>) from ClonalFrameML that are not directly comparable to the other two analyses are marked by asterisks.</p></caption>
<graphic xlink:href="543983v2_tblA8_1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>We generated alignments of the high-coverage <italic>α</italic> and <italic>β</italic> SAGs using Mauve <xref ref-type="bibr" rid="c16">Darling et al. (2004)</xref> and followed <xref ref-type="bibr" rid="c40">Lin and Kussell (2019)</xref> to fit <italic>P</italic> (<italic>l</italic>). Note that unlike in ClonalFrameML, we used only synonymous sites for the mcorr analysis, so the divergences cannot be directly compared between the two methods. We found the model fit the data for <italic>α</italic> reasonably well up two distances around 300 bp, with the exception of the first two points. However, the model was not able to capture the slower decay in correlations at longer genomic distances (see also <xref ref-type="app" rid="app4">Appendix 4</xref>). In <italic>β</italic> the fit at short distances was considerably poorer (<xref rid="figA8_2" ref-type="fig">Fig. 2</xref>). In particular, correlations between nearby SNPs were ~2× higher in the data compared to the model. The increased correlations at short distances could be due to genetic hitchhiking during gene sweeps or could be a sign of subtle forms of population structure within <italic>β</italic>. Distinguishing between these scenarios is an interesting topic for future work.</p>
<p>Compared to ClonalFrameML, the recombined fragment lengths inferred by mcorr were larger (especially for <italic>β</italic>) and were reasonably close to our estimate. In addition, the mcorr estimate of the diversity due to mutations (<italic>θ</italic> in our notation) agreed remarkably well with our estimates in both species. Similar to ClonalFrameML, the synonymous divergence of hybrid segments was between the divergence between species and the diversity within species and was inconsistent with our metagenome analysis. Finally, the ratio of recombination and mutation rates was similar to the one inferred from ClonalFrameML and more than an order of magnitude smaller than our estimates. These results are summarized in Table 1. We leave a more careful analysis of the differences as a topic for future work.</p>
</sec>
</sec>
</app>
<app id="app9">
<title>Appendix 9</title>
<sec id="s12">
<title>Variation in hybridization across samples</title>
<p>In this section we describe how we quantified associations between genomic features and populations from different samples. Our primary focus was on differences in hybridization patterns so we analyzed the variations in hybrid gene and SNP block haplotype frequencies across different samples and locations. Given the small number of samples in our study, we limited the number of statistical tests we performed in order to avoid false positives. For each of the two main species, <italic>α</italic> and <italic>β</italic>, we tested for the effect of sample location and sample composition separately, as described below.</p>
<sec id="s12a">
<title>Variation in SNP block haplotype frequencies</title>
<p>We considered two distinct hypotheses that could lead to associations between block haplotypes and environmental conditions from which the sample was taken. First, we considered if the community composition was associated with specific haplotypes by comparing samples in which a single species was present to samples which contained a mixture of <italic>α</italic> and <italic>β</italic>. For <italic>α</italic>, we chose the 48 cells from pure-<italic>α</italic> sample OS2005 as the test group and the 45 <italic>α</italic> cells from MS2004, MS2006, and OS2009 as the control. For <italic>β</italic>, we chose the 44 cells from the pure-<italic>β</italic> sample MS2005 as the test group and the 46 <italic>β</italic> cells from MS2004 and MS2006 as the control. We denote these two tests as “<italic>α</italic>-composition” and “<italic>β</italic>-composition” tests, respectively. Second, we considered the hypothesis that sample location was associated with specific haplotypes. For this test we divided all cells from each species into two groups labeled MS and OS, based on the location from which the sample was taken. These tests are denoted by “<italic>α</italic>-location” and “<italic>β</italic>-location”, respectively.</p>
<p>We used the following permutation test to find block haplotypes that were significantly associated with each environmental variable. We first removed all blocks in which the minority haplotype was below an arbitrary cutoff frequency, set at 5 sequences. This was done in order to avoid tests which were statistically underpowered. We then calculated the two-sided p-value for the association for each block individually using Fisher’s exact test.</p>
<table-wrap id="tblA9_1" orientation="portrait" position="float">
<label>Appendix 9—table 1.</label>
<caption><title>Result of tests for associations between SNP block haplotypes and two environmental variables related to the samples.</title>
<p>The rows show the results of the different tests described in the main text. The p-value <italic>p</italic> for each block was determined using Fisher’s exact test and minimum p-value from the randomized control <inline-formula><inline-graphic xlink:href="543983v2_inline54.gif" mimetype="image" mime-subtype="gif"/></inline-formula> was used to correct for false-discovery rates (see main text for details). The first four columns show total number of blocks in each category. The last olumn shows the largest value of the <inline-formula><inline-graphic xlink:href="543983v2_inline55.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (most significant association) for each test.</p></caption>
<graphic xlink:href="543983v2_tblA9_1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>Because the sampling depth for each block is variable due to variations in coverage, standard methods that correct for the false-discovery rate are not well-suited in our case. We instead the following procedure to determine significant associations. We randomized the composition of the test and control cell groups for each test, while keeping the total number within each group fixed. We then recalculated the p-values using the same procedure as before and recorded the lowest p-value across all blocks <inline-formula><inline-graphic xlink:href="543983v2_inline45.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. We used the ratio <inline-formula><inline-graphic xlink:href="543983v2_inline46.gif" mimetype="image" mime-subtype="gif"/></inline-formula> between the minimum p-value in the randomized control and the p-value in the test group as a measure of significance of the association. We arbitrarily set a threshold value of <inline-formula><inline-graphic xlink:href="543983v2_inline47.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, above which associations were deemed highly significant. The results of these tests are summarized in Table 1.</p>
<p>Overall, we found very few blocks that were associated with either the sample composition or location. This is consistent with the results from the main text (7C), which showed that the block haplotypes are close to unlinked even on distances comparable to the whole genome. The largest number of associations was with the sample composition in the <italic>α</italic> species, consistent with the previously-mentioned results, which showed a small but statistically significant increase in linkage within the <italic>α</italic> species compared to the <italic>β</italic>. Nevertheless, the overall fraction of blocks whose haplotypes were strongly associated with the sample composition was ≈ 1.2% and still small. We therefore concluded that neither the composition of the population within samples or the location have a large effect on the hybridization patterns revealed by the SNP blocks. A complete table with the results of these tests can be found in the supplementary data tables.</p>
</sec>
<sec id="s12b">
<title>Variation in hybrid gene transfers</title>
<p>We also examined variations in the rate of transfers of whole gene alleles across species. The lower overall number of such events compared to the SNP blocks make statistical tests for associations much more likely to yield false positives in this case. As a result, we limited the analysis to a qualitative comparison of the number of different types of transfers across samples shown in <xref rid="figA9_1" ref-type="fig">Fig. 1</xref>. We did not observe any systematic variations with either sample location or sample composition for either species.</p>
<fig id="figA9_1" position="float" fig-type="figure">
<label>Appendix 9—figure 1.</label>
<caption><title>Numbers and types of gene transfers between species are similar across samples.</title>
<p>The number of hybrid gene transfers from each donor found in <italic>α</italic> (<bold>A</bold>) and <italic>β</italic> (<bold>B</bold>) cells across all eight samples in the data. The labels <italic>A, B</italic>, and <italic>C</italic>, denote <italic>α, β</italic>, and <italic>γ</italic>, respectively, while <italic>X</italic> denotes other Synechococcucus clusters.</p></caption>
<graphic xlink:href="543983v2_figA9_1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
</app>
<app id="app10">
<title>Appendix 10</title>
<sec id="s13">
<title>Data quality control</title>
<p>Beyond the processing steps outlined in Sec. 1, we also explicitly verified that the hybridization patterns we observe cannot be explained by sequencing and genome assembly artifacts. Specifically, we tested if misassembly of reads from distinct alleles of the same gene could explain the presence of hybrid sequences. We considered two main sources of such reads: cross-contamination from neighboring reaction wells during whole-genome amplification (WGA) and the presence of paralogs horizontally transferred from other species.</p>
<p>Distinguishing between hybridization and artifacts is hard because both can lead to similar signals. Here, structure of data provides us natural controls. First, <italic>α</italic> has genes with low diversity and little sign of hybridization and high-diversity genes with extensive hybridization. We can use former to establish baseline for genome coverage and check for deviations in the later. If the hybridized genes are caused by misassemblies of actual between <italic>α</italic> genes and contamination from <italic>β</italic> or between different alleles of the same gene within <italic>α</italic> cells, we should see an increase in the coverage at these loci. Second, the variability in species composition across samples provides controls for cross-contamination between reaction wells. Specifically, OS2005 contained 48 cells, all classified as <italic>α</italic>, while MS2004, MS2006, and OS2009 together contained 45 <italic>α</italic> cells amplified on plates with mixtures of <italic>α</italic> and <italic>β</italic> cells in similar proportions (<xref rid="figA10_1" ref-type="fig">Fig. 1</xref>). We will refer to the former as the <italic>control SAGs sample</italic> and the later as the <italic>test SAGs sample</italic>. We used these two groups as a measure of the contribution of cross-contamination from neighboring <italic>β</italic> cells to the observed hybridization in <italic>α</italic>.</p>
<fig id="figA10_1" position="float" fig-type="figure">
<label>Appendix 10—figure 1.</label>
<caption><title>Species composition is highly variable across samples.</title></caption>
<graphic xlink:href="543983v2_figA10_1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We first divided the core <italic>α</italic> OGs into test and control groups as follows. We first divided OGs into low- and high-diversity groups based on the probability that synonymous sites are segregating in the sample using a cutoff at 0.05. From the low-diversity OGs, we chose the subset that were grouped into <italic>α</italic> and <italic>β</italic>, or <italic>α, β</italic>, and <italic>γ</italic> clusters during the pagenome construction (approximately 300 each out of a total of ~ 800). These OGs were nearly clonal in the <italic>α</italic> sample and showed little no evidence of hybridization in our entire data. These OGs will form the <italic>control OG group</italic>. From the high-diversity OGs, we selected those where all sequences were grouped together in a single mixed-species cluster (~ 300 out of a total of ~ 600). These include the cases with the most extensive hybridization and thus formed the <italic>test OG group</italic>.</p>
<p>We validated that core gene coverage can be described by a random process in which each gene has a fixed probability <italic>p</italic> of being present in the assembly. We fitted the baseline probability <italic>p</italic> using the low-diversity genes from the OS2005 <italic>α</italic> cells. Many of these genes were clonal within the entire <italic>α</italic> sample and showed no evidence of hybridization with the other species in our sample. They thus provide a good baseline for the expected coverage in the absence of contamination. While the coverage among different SAGs was highly variable (<xref rid="figA10_2" ref-type="fig">Fig. 2A</xref>), we found that the distribution of coverages of different genes was well fitted by a Gaussian distribution with the mean and variance given by assuming each gene is an independent Bernoulli random variable with success probability <italic>p</italic> ≈ 0.29. We tested the independence assumption by calculating the covariance between the presence of different genes (<xref rid="figA10_2" ref-type="fig">Fig. 2C</xref>). Under our very simple model, any correlations between the coverage at different loci would be purely due to statistical fluctuations caused by finite sample sizes. The distribution of diagonal (<italic>C</italic><sub><italic>aa</italic></sub>) and off-diagonal (<italic>C</italic><sub><italic>ab</italic></sub>) components of the covariance matrix can then be calculated exactly given <italic>p</italic>. We compared the values obtained from the data with these predictions and found a very good agreement (<xref rid="figA10_2" ref-type="fig">Fig. 2D</xref>).</p>
<fig id="figA10_2" position="float" fig-type="figure">
<label>Appendix 10—figure 2.</label>
<caption><title>Genome coverage across core genes is well-explained by independent presence-absence model.</title>
<p>(<bold>A</bold>) shows the presence-absence matrix <italic>P</italic><sub><italic>ia</italic></sub> of low-diversity OGs in the control SAG sample OS2005 (see main text for definitions). Rows and columns were ordered in decreasing order of the sums across the columns and rows, respectively. (<bold>B</bold>) shows the correlation matrix between OG presences defined as <inline-formula><inline-graphic xlink:href="543983v2_inline50.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="543983v2_inline51.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. Note the use of the mean abundance for each SAG rather than <italic>p</italic> = (<italic>NL</italic>)<sup>−1</sup>∑<sub><italic>i,a</italic></sub> <italic>P</italic><sub><italic>ia</italic></sub> to account for the large variability in coverage between SAGs. (<bold>C</bold>) shows the distribution of OG presences <inline-formula><inline-graphic xlink:href="543983v2_inline52.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. The solid orange line shows the Gaussian fit under the assumption that each gene is a Bernoulli random variable with success probability <italic>p</italic>. (<bold>D</bold>) shows the distribution of the entries in the covariance matrix from (B) together with the predictions for the diagonal (orange) and off-diagonal (green) components under the assumption that each gene is independent and present in the final assembly with probability <italic>p</italic>. Note the value of <italic>p</italic> was obtained from panel (C) and there are no free parameters for the predicted curves.</p></caption>
<graphic xlink:href="543983v2_figA10_2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Having validated our gene presence model, we can now use it to perform simple but quite powerful test for different artifacts. Consider the extreme case where all of the hybrid genes we observe are the result of misassemblies of reads from two distinct alleles, one from <italic>α</italic> and one from either <italic>β</italic> or <italic>γ</italic>, from the same reaction well. Note that for this argument it is unimportant whether the alternative allele is due to contamination or genuine horizontal transfer that resulted in two distinct, unmixed copies of the gene. In either case, the probability of observing the gene in our assembly would be <italic>P</italic><sub><italic>obs</italic></sub> = <italic>p</italic>(2 − <italic>p</italic>) ≈ 0.5, which is significantly higher than for a true single-copy gene. We tested for such an increase by comparing the distribution of coverages among <italic>α</italic> cells in the OS2005 sample of high-diversity genes that formed a single mixed cluster across all sequences in our data (see <xref ref-type="app" rid="app1">Appendix 1</xref>) and low-diversity genes with distinct <italic>α</italic> and <italic>β</italic> or <italic>α, β</italic>, and <italic>γ</italic> clusters. We found the two distributions were very similar to each other (<xref rid="figA10_3" ref-type="fig">Fig. 3A</xref>), with a small but statistically significant increase in the mean coverage at low-diversity genes with distinct species clusters (<italic>p</italic><sub><italic>control</italic></sub> ≈ 0.3 vs <italic>p</italic><sub><italic>test</italic></sub> ≈ 0.28). The difference is in the opposite direction from the one expected from the misassembly hypothesis, but it corresponds to less than an extra copy of a gene on average and is unlikely to have any consequence for our conclusions.</p>
<p>Note that the misassembly hypothesis above would also predict a specific pattern for the the sequences within <italic>α</italic>, with a large fraction 2(1 −<italic>p</italic>)/(2 −<italic>p</italic>) ≈ 0.83 having either the pure <italic>α</italic> or the pure <italic>β</italic> alleles, and <italic>p</italic>/(2 − <italic>p</italic>) ≈ 0.17 containing a mixture. We do not find evidence of such patterns in our data. More importantly, the 0.17 fraction is an upper bound on the maximum frequency of mixtures that can be explained by through misassembly as any lower amounts of contamination would lead to fewer chimeric sequences. Note that both of the above tests take advantage of the fact that the typical genome coverage is low.</p>
<p>Using a similar method to the one described above we can also check for contributions from cross-contamination between reaction wells on the formation of chimeric sequences. Here, we compared the coverage distribution of mixed-species orthogroups in the mixed <italic>α</italic> − <italic>β</italic> samples described previously with the control group from the all <italic>α</italic> sample OS2005. If cross contamination with <italic>β</italic> was a significant contributor to the presence of mixed-species orthogroups one would expect a large difference between the two distributions. We did observe a large systematic difference between the two groups in the overall coverage <italic>p</italic> across all genes (data not shown), which was likely due to batch effects in the amplification and sequencing. We therefore compared the mean-centered distributions between the two groups and found no difference between them and the fit to the independent presence-absence model from before (<xref rid="figA10_3" ref-type="fig">Fig. 3B</xref>).</p>
<fig id="figA10_3" position="float" fig-type="figure">
<label>Appendix 10—figure 3.</label>
<caption><title>Variability in core gene presence is inconsistent with observed hybridization being dominated by artifacts.</title>
<p>(<bold>A</bold>) compares the presence distributions among the control SAG sample of the test OG group (blue) with the control group (orange), as defined in the main text. (<bold>B</bold>) compares the presence distributions of the test OG group in the control (blue) and test (orange) SAG samples. The green line shows the fit from 2C. All distributions were centered at zero to control for batch effects (see main text).</p></caption>
<graphic xlink:href="543983v2_figA10_3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Beyond the indirect presence of hybridization given by the presence of mixed-species orthogroups, we also tested for any effect of cross-contamination on the presence of linkage blocks. We applied the same algorithm described in Sec. 6 to the subsample of 48 <italic>α</italic> cells from OS2005 and compared the results with those from random samples of <italic>α</italic> cells from samples with mixtures of <italic>α</italic> and <italic>β</italic> cells. We found that the number of blocks detected in OS2005 was similar to the bootstrapped distribution from mixed <italic>α</italic> −<italic>β</italic> samples (<xref rid="figA10_4" ref-type="fig">Fig. 4A</xref>). We also found the distribution of block lengths and divergences between block haplotypes to be similar as well (<xref rid="figA10_4" ref-type="fig">Fig. 4BC</xref>).</p>
<fig id="figA10_4" position="float" fig-type="figure">
<label>Appendix 10—figure 4.</label>
<caption><title>Linkage blocks are robust to large variations in species composition across samples.</title>
<p>(<bold>A</bold>) Bootstrapped distribution of the number of linkage blocks detected in alignments across 4-fold degenerate sites. The distribution was obtained by randomly choosing groups of 48 SAGs from samples containing mixtures of <italic>α</italic> and <italic>β</italic> SAGs (MS2004, MS2006, OS2006, OS2007, and OS2009). The arrow shows the number of blocks detected using the 48 SAGs from OS2005, which only contained <italic>α</italic> SAGs. Comparison of the distributions of block lengths (<bold>B</bold>) and divergence between the two haplotypes from each block (<bold>C</bold>) are shown in the other two panel. OS2005 (shown in blue) is compared to a randomly chosen sample from panel A (shown in orange).</p></caption>
<graphic xlink:href="543983v2_figA10_4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Based on the evidence presented above, we concluded that cross-contamination between reaction wells and genome assembly artifacts do not contribute significantly to the presence of mixed-species orthogroups or linkage blocks. While we cannot definitively exclude that some sequences we observe are the result of amplification or assembly errors, the evidence above shows that they are rare enough to not have a significant effect on our main conclusions.</p>
</sec>
</app>
</app-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90849.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Weigel</surname>
<given-names>Detlef</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Biology Tübingen</institution>
</institution-wrap>
<city>Tübingen</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Compelling</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study provides <bold>important</bold> insights into bacterial genome evolution by analyzing single-cell genome sequences of cyanobacteria from Yellowstone hot springs. Using <bold>compelling</bold> evidence, the authors demonstrate that both homologous recombination within species and frequent hybridization across species are major drivers of genome diversification. Despite the challenges that are inherent to sparse and fragmented single-cell data, the analyses are thorough, carefully controlled, and supported by multiple complementary approaches, making the conclusions highly robust. This work represents a significant advance in our understanding of microbial evolution in natural environments.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90849.2.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>What are the overarching principles by which prokaryotic genomes evolve? This fundamental question motivates the investigations in this excellent piece of work. While it is still very common in this field to simply assume that prokaryotic genome evolution can be described by a standard model from mathematical population genetics, and fit the genomic data to such a model, a smaller group of researchers rightly insists that we should not have such preconceived ideas and instead try to carefully look at what the genomic data tell us about how prokaryotic genomes evolve. This is the approach taken by the authors of this work. Lacking a tight theoretical framework, the challenge of such approaches is to device analysis methods that are robust to all our uncertainties about what the underlying evolutionary dynamics might be.</p>
<p>The authors here focus on a collection of ~300 single-cell genomes from a relatively well-isolated habitat with a relatively simple species composition, i.e. cyanobacteria living in hot springs in Yellowstone National Park. They convincingly demonstrate that the relative simplicity of this habitat increases our ability to interpret what the genomic data tells us about the evolutionary dynamics.</p>
<p>Using a very thorough and multi-faceted analysis of these data, the authors convincingly show that there are three main species of Synechococcus cyanobacteria living in this habitat, and that apart from very frequent recombination within each species (which is in line with insights from other recent studies) there is also a remarkably frequent occurrence of hybridization events between the different species, and with as of yet unindentified other genomes. Moreover, these hybridization events drive much of the diversity within each species. The authors also show convincing evidence that many of these hybridization events are not neutral but are driven by natural selection.</p>
<p>Strengths:</p>
<p>The great strength of this paper is that, by not making any preconceived assumptions about what the evolutionary dynamics is expected to look like, but instead devicing careful analysis methods to tease apart what the data tells us about what has happened in the evolution in these genomes, highly novel and unexpected results are obtained, i.e. the major role of hybridization across the 3 main species living in this habitat.</p>
<p>The analysis is very thorough and reading the detailed descriptions in the appendices it is clear that these authors took a lot of care in using these methods and avoiding the pitfalls that unfortunately affect many other studies in this research area.</p>
<p>The picture of the evolutionary dynamics of these three Synechococcus species that emerges from this analysis is quite novel and surprising. I think this study is a major stepping stone toward development of more realistic quantitative theories of genome evolution in prokaryotes.</p>
<p>The analysis methods that the authors employ are also partially quite novel and will no doubt by very valuable for analysis of many other datasets.</p>
<p>Weaknesses:</p>
<p>The main text is tight and concise, but this sort of hides the very large amount of careful complementary analyses that went into the conclusions presented in the main text. The appendices are quite well written but they are substantial, so that really understanding the paper is not an easy read. However, I do not really think the authors can be faulted for this. The topic is complex and a lot of care is required to make sure conclusions are valid.</p>
<p>A very interesting observation is that a lot of hybridization events (i.e. about half) originate from species other than the alpha, beta, and gamma Synechococcus species from which the genomes that are analyzed here derive. For this to occur, these other species must presumably also be living in the same habitat and must be relatively abundant. But if they are, why are they not being captured by the sampling? I did not see a clear explanation for this very common occurrence of hybridization events from outside of these Synechococcus species. The authors raise the possibility that these other species used to live in these hot springs but are now extinct or that the occur in other pools. I guess this is possible but I still find it puzzling and wonder if these donors could have been filtered out at some step of the experimental and/or analysis procedures.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90849.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary.</p>
<p>Birzu et al. describe two sympatric hotspring cyanobacterial species (&quot;alpha&quot; and &quot;beta&quot;) and infer recombination across the genome, including inter-species recombination events (hybridization) based on single-cell genome sequencing. The evidence for hybridization is strong and the authors took care to control for artefacts such as contamination during sequencing library preparation. Despite hybridization, the species remain genetically distinct from each other. The authors also present evidence for selective sweeps of genes across both species - a phenomenon which is widely observed for antibiotic resistance genes in pathogens, but rarely documented in environmental bacteria.</p>
<p>Strengths.</p>
<p>This manuscript describes some of the most thorough and convincing evidence to date of recombination happening within and between co-habitating bacteria in nature. Their single-cell sequencing approach allows them to sample the genetic diversity from two dominant species. Although single-cell genome sequences are incomplete, they contain much more information about genetic linkage than typical short-read shotgun metagenomes, enabling a reliable analysis of recombination. The authors also go to great lengths to quality-filter the single-cell sequencing data and to exclude contamination and read mismapping as major drivers of the signal of recombination. This is a fascinating dataset with intricate analyses showing the great extent of between-species hybridization that is possible in nature.</p>
<p>Weaknesses.</p>
<p>This revised version is much improved, with a much clearer flow and organisation within both the main text and supplement. The remaining weaknesses that I note below are certainly not critical, but are simply useful context for the reader to keep in mind.</p>
<p>My main concern is that the evidence for selection on the hybridized genes is incomplete and statements about the 'overwhelming evidence for the crucial role played by selection' (lines 334-5) are a bit overstated. What fraction of the hybridization events were driven by positive selection? The breakdown of hard (15%) vs soft (85%) sweeps is given, out of 153 (as sidenote, it is not clear if this is 153 genes or events, troughs, etc.). But how many of the hybridization events (or genes) have evidence for a selective sweep relative to those that do not? I recognize that this may be a hard question to answer, because it may be statistically easier to identify a hybridization event that rises to high frequency due to positive selection from a neutral event that remains rare. Even a rough estimate would be useful; would it be something like 153 out of the number of core genes tested (~700)?</p>
<p>Regardless, I think that Figure 6 (A and B) could benefit from comparison to a neutral model, including hybridization but no selection to see if a similar pattern (notably, higher synonymous diversity in alpha troughs compared to the backbone) could arise due to hybridization alone without selection.</p>
<p>An implicit assumption in microbiology is often that cross-species recombination events are driven by selection. The authors recognize that &quot;diversity troughs resulted from selective sweeps [...] likely overcame mechanistic barriers to recombination, genetic incompatibilities, and ecological differences&quot; (lines 335-7) and thus would not be retained unless they had some strong adaptive value to offset these costs. There are surprisingly few tests of the hypothesis that cross-species recombination events tend to be driven by selection. An analysis of Streptococcus spp. genomes showed that between-species recombination events tended to be accompanied by positive selection, whereas most within-species events were not (Shapiro et al. Trends in Microbiology 2009; reanalysis of data from Lefebure &amp; Stanhope, Genome Biology 2007). There are probably other examples out there, but the authors could highlight that they provide rare data to support a common expectation.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90849.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Birzu</surname>
<given-names>Gabriel</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3561-024X</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Muralidharan</surname>
<given-names>Harihara Subrahmaniam</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Goudeau</surname>
<given-names>Danielle</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Malmstrom</surname>
<given-names>Rex R</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-4758-7369</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Fisher</surname>
<given-names>Daniel S</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bhaya</surname>
<given-names>Devaki</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7965-4258</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews</p>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>Summary:</p>
<p>What are the overarching principles by which prokaryotic genomes evolve? This fundamental question motivates the investigations in this excellent piece of work. While it is still very common in this field to simply assume that prokaryotic genome evolution can be described by a standard model from mathematical population genetics, and fit the genomic data to such a model, a smaller group of researchers rightly insists that we should not have such preconceived ideas and instead try to carefully look at what the genomic data tell us about how prokaryotic genomes evolve. This is the approach taken by the authors of this work. Lacking a tight theoretical framework, the challenge of such approaches is to devise analysis methods that are robust to all our uncertainties about what the underlying evolutionary dynamics might be.</p>
<p>The authors here focus on a collection of ~300 single-cell genomes from a relatively well-isolated habitat with relatively simple species composition, i.e. cyanobacteria living in hotsprings in Yellowstone National Park, and convincingly demonstrate that the relative simplicity of this habitat increases our ability to interpret what the genomic data tells us about the evolutionary dynamics.</p>
<p>Using a very thorough and multi-faceted analysis of these data, the authors convincingly show that there are three main species of Synechococcus cyanobacteria living in this habitat, and that apart from very frequent recombination within each species (which is in line with insights from other recent studies) there is also a remarkably frequent occurrence of hybridization events between the different species, and with as of yet unidentified other genomes. Moreover, these hybridization events drive much of the diversity within each species. The authors also show convincing evidence that these hybridization events are not neutral but are driven by selected by natural selection.</p>
<p>Strengths:</p>
<p>The great strength of this paper is that, by not making any preconceived assumptions about what the evolutionary dynamics is expected to look like, but instead devising careful analysis methods to tease apart what the data tells us about what has happened in the evolution in these genomes, highly novel and unexpected results are obtained, i.e. the major role of hybridization across the 3 main species living in this habitat.</p>
<p>The analysis is very thorough and reading the detailed supplementary material it is clear that these authors took a lot of care in devising these methods and avoiding the pitfalls that unfortunately affect many other studies in this research area.</p>
<p>The picture of the evolutionary dynamics of these three Synechococcus species that emerge from this analysis is highly novel and surprising. I think this study is a major stepping stone toward the development of more realistic quantitative theories of genome evolution in prokaryotes.</p>
<p>The analysis methods that the authors employ are also partially novel and will no doubt be very valuable for analysis of many other datasets.</p>
</disp-quote>
<p>We thank the reviewer for their appreciation of our work.</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses:</p>
<p>I feel the main weakness of this paper is that the presentation is structured such that it is extremely difficult to read. I feel readers have essentially no chance to understand the main text without first fully reading the 50-page supplement with methods and 31 supplementary materials. I think this will unfortunately strongly narrow the audience for this paper and below in the recommendations for the authors I make some suggestions as to how this might be improved.</p>
<p>
A very interesting observation is that a lot of hybridization events (i.e. about half) originate from species other than the alpha, beta, and gamma Synechococcus species from which the genomes that are analyzed here derive. For this to occur, these other species must presumably also be living in the same habitat and must be relatively abundant. But if they are, why are they not being captured by the sampling? I did not see a clear explanation for this very common occurrence of hybridization events from outside of these Synechococcus species. The authors raise the possibility that these other species used to live in these hot springs but are now extinct. I'm not sure how plausible this is and wonder if there would be some way to find support for this in the data (e.g that one does not observe recent events of import from one of these unknown other species). This was one major finding that I believe went without a clear interpretation.</p>
</disp-quote>
<p>We agree with the reviewer that the extent of hybridization with other species is surprising. While we do feel that our metagenome data provide convincing evidence that “X” species are not present in MS or OS, we cannot currently rule out the presence of X in other springs. In the revision we explicitly mention the alternative hypothesis (Lines 239-242).</p>
<disp-quote content-type="editor-comment">
<p>The core entities in the paper are groups of orthologous genes that show clear evidence of hybridization. It is thus very frustating that exactly the methods for identifying and classifying these hybridization events were really difficult to understand (sections I and V of the supplement). Even after several readings, I was unsure of exactly how orthogroups were classified, i.e. what the difference between M and X clusters is, what a `simple hybrid' corresponds to (as opposed to complex hybrids?), what precisely the definitions of singlet and non-singlet hybrids are, etcetera. It also seems that some numbers reported in the main text do not match what is shown in the supplement. For example, the main text talks about &quot;around 80 genes with more than three clusters (SM, Sec. V; fig. S17).&quot;, but there is no group with around 80 genes shown in Fig S17! And similarly, it says &quot;We found several dozen (100 in α and 84 in β) simple hybrid loci&quot; and I also cannot match those numbers to what is shown in the supplement. I am convinced that what the authors did probably made sense. But as a reader, it is frustrating that when one tries to understand the results in detail, it is very difficult to understand what exactly is going on. I mention this example in detail because the hybrid classification is the core of this paper, but I had similar problems in other sections.</p>
</disp-quote>
<p>We thank the reviewer for pointing out these issues with our original presentation. In the revision, we have redone most of the analysis to simplify the methods and check the consistency of the results. We did not find any qualitative differences in our results after reanalysis, but some of the numbers for different hybridization patterns have changed. The most notable difference is an increase in the number of alpha-gamma simple hybrids and a corresponding decrease in mixed-species clusters (now labeled mosaic hybrids). These transfers are difficult to assign because we only have access to a single gamma genome. We have added a short explanation of this point in Lines 219-222.</p>
<p>To improve the presentation, we significantly expanded the “Results” section to better explain our analysis and the different steps we take. We included two additional figures (Figs. 3 and 4) that illustrate the different types of hybrids and the heterogeneity in the diversity of alpha which is discussed in the main text and is important for interpreting our results. We also included two additional figures (Figs. 2 and 6) that were previously in the Appendix but were mentioned in the main text. We believe these changes should address most of the issues raised by the reviewer and hopefully make the manuscript easier to read.</p>
<disp-quote content-type="editor-comment">
<p>Although I generally was quite convinced by the methods and it was clear that the authors were doing a very thorough job, there were some instances where I did not understand the analysis. For example, the way orthogroups were built is very much along the lines used by many in the field (i.e. orthoMCL on the graph of pairwise matchings, building phylogenies of connected components of the graph, splitting the phylogenies along long branches). But then to subdivide orthogroups into clusters of different species, the authors did not use the phylogenetic tree already built but instead used an ad hoc pairwise hierarchical average linkage clustering algorithm.</p>
</disp-quote>
<p>The reviewer is correct that there is an unexplained discrepancy between the clustering methods we used at different steps in our pipeline. We followed previous work by using phylogenetic distances for the initial clustering of orthogroups. On these scales we expect hybridization to play a minor role and phylogenetic distances to correlate reasonably well with evolutionary divergence. However, because of the extensive hybridization we observed, the use of phylogenetic models for species clustering is more difficult to justify. We therefore chose to simply use pairwise nucleotide distances, which make fewer assumptions about the underlying evolutionary processes and should be more robust. We have briefly explained our reasoning and the details of our clustering method in the revision (Lines 182-190).</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>Summary:</p>
<p>Birzu et al. describe two sympatric hotspring cyanobacterial species (&quot;alpha&quot; and &quot;beta&quot;) and infer recombination across the genome, including inter-species recombination events (hybridization) based on single-cell genome sequencing. The evidence for hybridization is strong and the authors took care to control for artefacts such as contamination during sequencing library preparation. Despite hybridization, the species remain genetically distinct from each other. The authors also present evidence for selective sweeps of genes across both species - a phenomenon which is widely observed for antibiotic resistance genes in pathogens, but rarely documented in environmental bacteria.</p>
<p>Strengths:</p>
<p>This manuscript describes some of the most thorough and convincing evidence to date of recombination happening within and between cohabitating bacteria in nature. Their single-cell sequencing approach allows them to sample the genetic diversity from two dominant species. Although single-cell genome sequences are incomplete, they contain much more information about genetic linkage than typical short-read shotgun metagenomes, enabling a reliable analysis of recombination. The authors also go to great lengths to quality-filter the single-cell sequencing data and to exclude contamination and read mismapping as major drivers of the signal of recombination.</p>
</disp-quote>
<p>We thank the reviewer for their appreciation of our work.</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses:</p>
<p>Despite the very thorough and extensive analyses, many of the methods are bespoke and rely on reasonable but often arbitrary cutoffs (e.g. for defining gene sequence clusters etc.). Much of this is warranted, given the unique challenges of working with single-cell genome sequences, which are often quite fragmented and incomplete (30-70% of the genome covered). I think the challenges of working with this single-cell data should be addressed up-front in the main text, which would help justify the choices made for the analysis.</p>
</disp-quote>
<p>We have significantly expanded the “Results” section to better justify and explain the choices we made during our analysis. We hope these changes address the reviewer’s concerns and make the manuscript more accessible to readers.</p>
<disp-quote content-type="editor-comment">
<p>The conclusions could also be strengthened by an analysis restricted to only a subset of the highest quality (&gt;70% complete) genomes. Even if this results in a much smaller sample size, it could enable more standard phylogenetic methods to be applied, which could give meaningful support to the conclusions even if applied to just ~10 genomes or so from each species. By building phylogenetic trees, recombination events could be supported using bootstraps, which would add confidence to the gene sequence clustering-based analyses which rely on arbitrary cutoffs without explicit measures of support.</p>
</disp-quote>
<p>It seems to us that the reviewer’s suggestion presupposes that the recombination events we find can be described as discrete events on an asexual phylogeny, similar to how rare mutations are treated in standard phylogenetic inference. Popular tools, such as ClonalFrame and its offshoots, have attempted to identify individual recombination events starting from these assumptions. But the main conclusion of both our linkage and SNP block analysis is that the ClonalFrame assumptions do not hold for our data. Under a clonal frame, the SNP blocks we observe should be perfectly linked, similar to mutations on an asexual tree. But our results in Fig. 7D show the opposite. Part of the issue may have been that in our original presentation, we only briefly discuss the results of our linkage analysis and refer readers to the Appendix for more details. To fix this issue we have added an extra figure (Fig. 2), showing rapid linkage decrease in both species and that at long distances the linkage values are essentially identical to the unlinked case, similar to sexual populations. We hope that this change will help clarify this point.</p>
<disp-quote content-type="editor-comment">
<p>The manuscript closes without a cartoon (Figure 4) which outlines the broad evolutionary scenario supported by the data and analysis. I agree with the overall picture, but I do think that some of the temporal ordering of events, especially the timing of recombination events could be better supported by data. In particular, is there evidence that inter-species recombination events are increasing or decreasing over time? Are they currently at steady-state? This would help clarify whether a newly arrived species into the caldera experiences an initial burst of accepting DNA from already-present species (perhaps involving locally adaptive alleles), or whether recombination events are relatively constant over time.</p>
</disp-quote>
<p>The reviewer raises some very interesting questions about the dynamics of recombination in the population, which we hope to pursue in future work. We have added this as an open question in the Discussion (Lines 365-382).</p>
<disp-quote content-type="editor-comment">
<p>These questions could be answered by counting recombination events that occur deeper or more recently in a phylogenetic tree.</p>
</disp-quote>
<p>The reviewer here seems to presuppose that recombination is rare enough that a phylogenetic tree can reliably be inferred, which is contrary to our linkage analysis (see the response to an earlier comment). Perhaps the reviewer missed this point in our original manuscript since it was discussed primarily in the Appendix. See also our response to a previous comment by the reviewer.</p>
<disp-quote content-type="editor-comment">
<p>The cartoon also shows a 'purple' species that is initially present, then donates some DNA to the 'blue' species before going extinct. In this model, 'purple' DNA should also be donated to the more recently arrived 'orange' species, in proportion to its frequency in the 'blue' genome. This is a relatively subtle detail, but it could be tested in the real data, and this may actually help discern the order of the inferred recombination events.</p>
</disp-quote>
<p>We have included an extra figure in the main text (Fig. 6) that addresses the question of timing of events. A quantitative test of our cartoon model along the lines the reviewer suggested would certainly be worthwhile and we hope to do that in future work.</p>
<disp-quote content-type="editor-comment">
<p>The abstract also makes a bold claim that is not well-supported by the data: &quot;This widespread mixing is contrary to the prevailing view that ecological barriers can maintain cohesive bacterial species...&quot; In fact, the two species are cohesive in the sense that they are identifiable based on clustering of genome-wide genetic diversity (as shown in Fig 1A). I agree that the mixing is 'widespread' in the sense that it occurs across the genome (as shown in Figure 2A) but it is clearly not sufficient to erode species boundaries. So I believe the data is consistent with a Biological Species Concept (sensu Bobay &amp; Ochman, Genome Biology &amp; Evolution 2017) that remains 'fuzzy' - such that there are still inter-species recombination events, just not sufficient to erode the cohesion of genomic clusters. Therefore, I think the data supports the emerging picture of most bacteria abiding by some version of a BSC, and is not particularly 'contrary' to the prevailing view.</p>
</disp-quote>
<p>We have revised the phrase mentioned by the reviewer to “prevent genetic mixture between bacterial species,” which more accurately represents our conclusions.</p>
<disp-quote content-type="editor-comment">
<p>The final Results paragraph begins by posing a question about epistatic interactions, but fails to provide a definitive answer to the extent of epistasis in these genomes. Quantifying epistatic effects in bacterial genomes is certainly of interest, but might be beyond the scope of this paper. This could be a Discussion point rather than an underdeveloped section of the Results.</p>
</disp-quote>
<p>We agree with the reviewer that an exhaustive analysis of epistasis in the population is beyond the scope of the manuscript. Our original intention was to answer whether SNP blocks we discovered showed evidence of strong linkage, as might be expected if only a small number of strains are present in the population. In light of the previous comments by the reviewer regarding the consistency with the clonal frame hypothesis, we believe this is especially relevant for our results. Moreover, the results we found‑especially for the beta population‑were quite conclusive: SNP block linkages in beta are indistinguishable from an unlinked model. To avoid misdirecting the reader about the significance of our results, we have revised the relevant paragraph (Lines 316-319).</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations For The Authors:</bold></p>
<p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p>
<p>Although I am entirely convinced of the validity of the results, methodology, and interpretations presented in this work, I must say I found the paper very hard to read. And I think I am really quite familiar with these kinds of approaches. I fear that for people other than experts on these kinds of comparative genomic analyses, this paper will be almost impossible to read. With the aim of expanding the audience for this compelling work, I think the authors might want to consider ways to improve the presentation.</p>
<p>At the end of a long project, the obtained results typically form a web of mutual interconnections and dependencies and one of the key challenges in presenting the results in a paper is having to untangle this web of connected results and analysis into a linear ordered narrative so that, at any point in the narrative, understanding the next point only depends on previous points in the narrative. I frankly feel that this paper fails at this.</p>
<p>The paper reads to me as if one author put together the supplement by essentially writing a report of all the analyses that were done together with supplementary figures summarizing all those analyses, and that another author then wrote the main text by using the materials in the supplement almost in the way a cook uses ingredients for a dish. Almost every other sentence in the main text refers to results in the (31!) supplementary figures and can only be understood by reading the appropriate corresponding sections in the supplementary materials. I found it essentially impossible to read the main text without having first read the entire 50-page supplement.</p>
<p>I think the paper could be hugely improved by trying to restructure the presentation so as to make it more linear. The main text can be expanded to include a summary of the crucial methods and analysis results from the supplement needed to understand the narrative in the main text. For example, as it currently stands it is really challenging to understand what is shown in figures 2 and 3 of the main text without having to first read a very substantial part of the supplement. Figure 3, even after having read the relevant sections in the supplement, took me quite a while to understand and almost felt like a puzzle to decypher. Rethinking which parts of the supplement are really necessary would also help. Finally, it would also help if the terminology was kept as simple, transparent, and consistent as possible.</p>
<p>I understand that my suggestion to thoroughly reorganize the presentation may feel like a big hassle, but I am afraid that in its current form, these important results are essentially rendered inaccessible to all but a small group of experts in this area. This paper deserves a wider readership.</p>
</disp-quote>
<p>We thank the reviewer for these valuable suggestions. In the revision, we have significantly expanded and restructured the “Results” section to make the presentation more linear, as the reviewer suggested (see our reply to the public comment by the reviewer for details). We hope these changes will make the manuscript easier to read.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p>
<p>I found this paper challenging to follow since the main text was so condensed and the supplementary material so extensive. Given that eLife does not impose strong limits on the length of the main text, I suggest moving some key sections from the supplement into the main text to make it easier for the reader to follow rather than flipping back and forth. Adding to the confusion, supplementary figures were referenced out of order in the main text (e.g. S23 is referenced before S1). Please check the numbering and ensure figures are mentioned in the main text in the correct order.</p>
</disp-quote>
<p>We thank the reviewer for their feedback on the presentation of the results. In response to similar comments from Reviewer #1, we have significantly expanded and restructured the “Results” section to make it easier to read (see also our responses to Reviewer #1).</p>
<disp-quote content-type="editor-comment">
<p>Page 2: The term 'coevolution' is typically reserved for two species that mutually impose selective pressures on one another (e.g. predator-prey interactions; see Janzen, Evolution 1980). In the context of these two cyanobacterial species, it's not clear that this is the case so I would simply refer to them 'cohabitating' or being sympatric in the same environment.</p>
</disp-quote>
<p>It is true that the term &quot;coevolution” has become associated with predator-prey interactions, as the reviewer said. However, we feel that in our case “coevolution” fairly accurately describes the continual hybridization over long time scales we observe. We have therefore chosen to keep the term.</p>
<disp-quote content-type="editor-comment">
<p>Page 3: The authors mention that the gamma SAG is ~70% complete, which turns out to be quite high. It would be useful to mention early in the Results the mean/median completeness across SAGs, and how this leads to some challenges in analysing the data. Some of the material from the Supplement could be moved into the Results here.</p>
</disp-quote>
<p>We have added a short note on the completeness in the Results (Lines 153-154). We have also added an extra figure in Appendix 1 with the completeness of all the SAGs for interested readers.</p>
<disp-quote content-type="editor-comment">
<p>I was left puzzled by the sentence: &quot;Alternatively, high rates of recombination could generate different genotypes within each genome cluster that are adapted to different temperatures, with the relative frequencies of each cluster being only a correlated and not a causal driver of temperature adaptation.&quot; This is suggesting that individual genes or alleles, rather than entire genomes, could be adapted to temperature. But figure 1B seems to imply that the entire genome is adapted to different temperatures. Anyway, this does not seem to be a key point and could probably be removed (or clarified if the authors deem this an important point, which I failed to understand).</p>
</disp-quote>
<p>We have revised this section to clarify the alternative hypothesis mentioned by the reviewer (Lines 100-103).</p>
<disp-quote content-type="editor-comment">
<p>Page 4. 'Several dozen' hybrid genes were found, but please also specify how many genes were tested. In general, it would be good to briefly outline the sample size (SAGs or genes) considered for each analysis.</p>
</disp-quote>
<p>We have added the total numbers of genes we analyzed at each step of our analysis.</p>
<disp-quote content-type="editor-comment">
<p>'Mosaic hybrid loci' are mentioned alongside the issue of poor alignment. Presumably, the mosaic hybrid loci are first filtered to remove the poor alignments? This should be specified, and please mention how many loci are retained before/after this filter.</p>
</disp-quote>
<p>We thank the reviewer for highlighting this important point. In the revision, we have implemented a more aggressive filtering of genes with poor alignments. We have added an extra paragraph to Appendix 1 (step 5 in the pipeline analysis) briefly explaining the issue.</p>
<disp-quote content-type="editor-comment">
<p>Page 5. &quot;By contrast, the diversity of mosaic loci was typical of other loci within beta, suggesting most of the beta genome has undergone hybridization.&quot; Please point to the data (figure) to support this statement.</p>
</disp-quote>
<p>We have restructured our discussion of the different hybrid loci so this comment is no longer relevant. In case the reviewer is interested, the synonymous diversity within beta was 0.047, while in mosaic hybrids it was 0.064.</p>
<disp-quote content-type="editor-comment">
<p>Page 6. &quot;The largest diversity trough contained 28 genes.&quot; Since this trough is discussed in detail and seems to be of interest, it would be nice to illustrate it, perhaps as an inset in Figure 2 or as a separate figure. If I understood correctly, this trough includes genes (in a nitrogen-fixation pathway) that are present in all genomes, but are exchanged by homologous recombination. So I don't think it's correct to say that the &quot;ancestors acquired the ability to fix nitrogen.&quot; Rather, the different alleles of these same genes were present in the ancestor. So perhaps there was a selective sweep involving alleles in this region that provided adaptation to local nitrogen sources or concentrations, but not a gain of new genes. Perhaps I misunderstood, in which case clarification would be appreciated.</p>
</disp-quote>
<p>The reviewer raises an interesting possibility. We agree that it is in principle possible that the ancestor contained the nitrogen fixation genes and the selective sweep simply replaced the ancestral alleles. In this particular case, there is additional evidence that the entire pathway was acquired around roughly the same time from gene order. The gene order between alpha and beta is almost entirely different, with only a few segments containing more than 2-3 genes in the same order, as shown by Bhaya et al. 2007 and confirmed by additional unpublished analysis of the SAGs. One of the few exceptions is the nitrogen fixation pathway, which has essentially the same gene order over more than 20 kbp. Thus, if the ancestor of both alpha and beta contained the nitrogen-fixation pathway, we would expect these genes to be scatter across the genome. We have revised the sentences in question to clarify this point (Lines 260-271).</p>
<disp-quote content-type="editor-comment">
<p>Page 6. Last paragraph on epistasis references Fig 3C, but I believe it should be Fig 3D.</p>
</disp-quote>
<p>Fixed.</p>
<disp-quote content-type="editor-comment">
<p>Page 7. Figure 3 legend. &quot;Note that alpha-2 is identical to gamma here.&quot; I believe it should be beta, not gamma.</p>
</disp-quote>
<p>The reviewer is correct. We have fixed this error.</p>
<disp-quote content-type="editor-comment">
<p>Page 8. What is the evidence for &quot;at least six independent colonizers&quot;? I could not find the data supporting this claim.</p>
</disp-quote>
<p>The statement mentioned by the reviewer was based on the maximum number of species clusters we identified in different core genes. However, during the revision, we found that only a handful of genes contained five or more clusters. We did find several tens of genes with four clusters. In addition, Rosen et al. (2018) also found additional 16S clusters at low frequency in the same springs. Based on these results we conservatively estimate that at least four independent strains colonized the caldera, but the number could be much greater. We have revised the text in question accordingly (Lines 336-339) and added Fig. 2 in Appendix 1 to support the conclusion.</p>
<disp-quote content-type="editor-comment">
<p>Page 9. Line 200: &quot;acting to homogenize the population.&quot; It should be specified that the population is only homogenized at these introgressed loci, not genome-wide. Otherwise, the genome-wide species clusters seen in Fig 1 would not be maintained.</p>
</disp-quote>
<p>It is true that the selective sweeps that lead to diversity throughs only homogenize the introgressed loci. But other hybrid segments could also rise to high frequency in the population during the sweep through hitchhiking. The fact that we observe SNP blocks generated through secondary recombination events of introgressed segments throughout the genome supports this view. While we do not fully understand the dynamics of this process currently, we do feel that the current evidence supports the statement that mixing is occurring throughout the genome and not just at a few loci so we have kept the original statement.</p>
<disp-quote content-type="editor-comment">
<p>The final sentence (lines 221-222) is vague and uninformative. On the one hand, &quot;investigating whether hybridization plays a major role&quot; is what the current manuscript has already done - depending on what is meant by 'major' (how much of the genome? Or whether there are ecological implications?). It is also not clear what is meant by a predictive theory and 'possible evolutionary scenarios. This should be elaborated upon, otherwise, it is not clear what the authors mean. Otherwise, this sentence could be cut.</p>
</disp-quote>
<p>We thank the reviewer for their feedback. One possible source of confusion could be that in this sentence we were referring to detecting hybridization in other communities. We have changed “these communities” to “other communities” to make this clearer.</p>
<disp-quote content-type="editor-comment">
<p>Supplement.</p>
<p>Broadly speaking, I appreciate the thorough and careful analysis of the single cell data. On the other hand, it is hard to evaluate whether these custom analyses are doing what is intended in many cases. Would it be possible to consider an analysis using more established methods, e.g. taking a subset of genomes with 'good' completeness and using Panaroo to find the core and accessory genome, then ClonalFrameML or Gubbins to infer a phylogeny and recombination events? Such analyses could probably be applied to a subset of the sample with relatively complete genomes. I don't want to suggest an overly time-consuming analysis, but the authors could consider what would be feasible.</p>
</disp-quote>
<p>We have added a comparison between our analysis and that from two other methods, including ClonalFrameML mentioned by the author. One important point that we feel might have been lost in the first version is that our linkage results imply that recombination is not rare such that it can be mapped onto an asexual tree as assumed by ClonalFrameML. Note that this is not simply due to technical limitations due to incomplete coverage and is instead a consequence of the evolutionary dynamics of the population. Consistent with this, we found several inconsistencies in how recombination events were assigned by ClonalFrameML. We have summarized these conclusions in Appendix 7 of the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p>Page 8. Line 190. What is meant by 'minimal compositional bias'?</p>
</disp-quote>
<p>We mean that the sample is not biased towards strains that grow in the lab. We have revised the sentence to clarify.</p>
<disp-quote content-type="editor-comment">
<p>Page 25. Figure S14 is not referenced in the text.</p>
</disp-quote>
<p>We have added part of this figure to the main text since it illustrates one of our main results, namely that sites at long genomic distances are essentially unlinked.</p>
<disp-quote content-type="editor-comment">
<p>Page 26. The 'unlinked controls' (line 530) are very useful, but it would be even more informative to see if these controls also show the same decline in linkage with distance in the genome as observed in the real data. In particular, it would be good to know if the observed rapid decline in linkage with distance in the low-diversity regions is also observed in controls. Currently, it is unclear if this observation might be due to higher uncertainty in inferring linkage in low-diversity regions, which by definition have less polymorphism to include in the linkage calculation.</p>
</disp-quote>
<p>We thank the reviewer for the suggestion. After further consideration, we have decided to remove the subsection on linkage decrease in the low-diversity regions. We feel such detailed quantitative analysis would be better suited for a more technical paper, which we hope to do at a later time.</p>
<disp-quote content-type="editor-comment">
<p>Page 26. There are some sections with missing identifiers (Sec ??).</p>
</disp-quote>
<p>Fixed.</p>
<disp-quote content-type="editor-comment">
<p>Page 27. The information about the typical breadth of SAG coverage (~30%) would be better to include earlier in the Supplement, and also mentioned in the main text so the reader can more easily understand the nature of the dataset.</p>
</disp-quote>
<p>We have added an extra figure with the SAG coverages to Appendix 1.</p>
<disp-quote content-type="editor-comment">
<p>Page 29. Any sensitivity analysis around the S = 0.9 value? Even if arbitrary, could the authors provide justification why they think this value is reasonable?</p>
</disp-quote>
<p>We have significantly revised this section in response to earlier comments by one of the reviewers. We hope that this would clarify the details of our methods to interested readers. To answer the reviewer’s specific question, we chose this heuristic after examining the fraction of cells of each species in different species clusters. For the clusters assigned to alpha and beta, we found a sharp peak near one and that a cutoff of 0.9 captured most clusters while still being high enough to inconsistent with a mixed cluster.</p>
<disp-quote content-type="editor-comment">
<p>Page 30. I could not see where Fig. S17 was mentioned in the text. Also, how are 'simple hybrid genes' defined?</p>
</disp-quote>
<p>We have removed this figure in the revision. The definition of the different types of hybrid genes have been added to the main text in response to a comment from the other reviewer.</p>
<disp-quote content-type="editor-comment">
<p>Page 36. It is hard to see that divergence is 'high' relative to what reference. Would it be possible to include the expected value (from ref. 12) in the plot, or at least explicitly mentioned in the text?</p>
</disp-quote>
<p>We have added the mean synonymous and non-synonymous divergences between alpha and beta to the figures for reference.</p>
<disp-quote content-type="editor-comment">
<p>Page 38. Line 770 &quot;would be comparable to that of beta.&quot; This is not necessarily the case since beta could have a different time to its most recent common ancestor. It could have a different time to the last bottleneck or selective sweep, etc.</p>
</disp-quote>
<p>We thank the reviewer for pointing out this misleading statement. Our point here was that in the first scenario the TMRCA of alpha and beta would be similar since the diversity in the high-diversity alpha genes is similar to beta. We have clarified this statement in the revision.</p>
<disp-quote content-type="editor-comment">
<p>Page 39. Line 793. The use of the term 'genomic backbone' implies the presence of a clonal frame, which is not what the data seems to support. Perhaps another term such as 'genetic diversity' would more appropriately capture the intended meaning here.</p>
</disp-quote>
<p>We agree with the reviewer that the low-diversity regions may not be asexual. We used “genomic backbone” to distinguish from the “clonal frame,” which is usually used to mean that the backbone is asexual. We have added a note in the revision to clarify this point.</p>
<disp-quote content-type="editor-comment">
<p>Page 39. Lines 802-805. I found this explanation hard to follow. Could the logic be clarified?</p>
</disp-quote>
<p>We simply meant that although the beta distribution is unimodal, it is not consistent with a simple Poisson distribution, unlike in alpha. We have added an extra sentence to clarify this.</p>
</body>
</sub-article>
</article>