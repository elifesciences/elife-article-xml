<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">105948</article-id>
<article-id pub-id-type="doi">10.7554/eLife.105948</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.105948.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Physics of Living Systems</subject>
</subj-group>
</article-categories><title-group>
<article-title>Microbiomes Through the Looking Glass: Linking Species Interactions to Dysbiosis through a Disordered Lotka-Volterra Framework</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Pasqualini</surname>
<given-names>Jacopo</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Maritan</surname>
<given-names>Amos</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rinaldo</surname>
<given-names>Andrea</given-names>
</name>
<xref ref-type="aff" rid="A2">2</xref>
<xref ref-type="aff" rid="A3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Facchin</surname>
<given-names>Sonia</given-names>
</name>
<xref ref-type="aff" rid="A4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Savarino</surname>
<given-names>Edoardo</given-names>
</name>
<xref ref-type="aff" rid="A4">4</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Altieri</surname>
<given-names>Ada</given-names>
</name>
<xref ref-type="aff" rid="A5">5</xref>
<email xlink:href="ada.altieri@u-paris.fr">ada.altieri@u-paris.fr</email>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Suweis</surname>
<given-names>Samir</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A6">6</xref>
<email xlink:href="samir.suweis@pd.infn.it">samir.suweis@pd.infn.it</email>
</contrib>
<aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00240q980</institution-id><institution>Dipartimento di Fisica “G. Galilei” e INFN sezione di Padova, Università di Padova</institution></institution-wrap>, <city>Padua</city>, <country country="IT">Italy</country></aff>
<aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00240q980</institution-id><institution>Dipartimento di Ingegneria Civile, Edile e Ambientale ICEA, University of Padova</institution></institution-wrap>, <city>Padua</city>, <country country="IT">Italy</country></aff>
<aff id="A3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02s376052</institution-id><institution>EPFL, Ecole Polytechnique Fedéralé Lausanne</institution></institution-wrap>, <city>Lausanne</city>, <country country="CH">Switzerland</country></aff>
<aff id="A4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00240q980</institution-id><institution>Dipartimento di Scienze Chirurgiche, Oncologiche e Gastroenterologiche DiSCOG, University of Padova</institution></institution-wrap>, <city>Padua</city>, <country country="IT">Italy</country></aff>
<aff id="A5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05f82e368</institution-id><institution>Laboratoire Matière et Systèmes Complexes (MSC), Université Paris Cité, CNRS</institution></institution-wrap>, <city>Paris</city>, <country country="FR">France</country></aff>
<aff id="A6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00240q980</institution-id><institution>Padova Neuroscience Center, University of Padova</institution></institution-wrap>, <city>Padua</city>, <country country="IT">Italy</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Bitbol</surname>
<given-names>Anne-Florence</given-names>
</name>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1020-494X</contrib-id>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution>
</institution-wrap>
<city>Lausanne</city>
<country country="CH">Switzerland</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Walczak</surname>
<given-names>Aleksandra M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>CNRS</institution>
</institution-wrap>
<city>Paris</city>
<country country="FR">France</country>
</aff>
</contrib>
</contrib-group>
<pub-date pub-type="epub">
<day>29</day>
<month>08</month>
<year>2025</year>
</pub-date>
<pub-date date-type="original-publication" iso-8601-date="2025-04-11">
<day>11</day>
<month>04</month>
<year>2025</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-10-15">
<day>15</day>
<month>10</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP105948</elocation-id>
<history><date date-type="sent-for-review" iso-8601-date="2025-01-29">
<day>29</day>
<month>01</month>
<year>2025</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-06-11">
<day>11</day>
<month>06</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.48550/arXiv.2406.07465"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2025-04-11">
<day>11</day>
<month>04</month>
<year>2025</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.105948.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.105948.1.sa4">eLife Assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.105948.1.sa3">Reviewer #1 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.105948.1.sa2">Reviewer #2 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.105948.1.sa1">Reviewer #3 (Public review):</self-uri>
<self-uri content-type="author-comment" xlink:href="https://doi.org/10.7554/eLife.105948.1.sa0">Author response:</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Pasqualini et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Pasqualini et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-105948-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>The rapid advancement of environmental sequencing technologies, such as metagenomics, has significantly enhanced our ability to study microbial communities. The eubiotic composition of these communities is crucial for maintaining ecological functions and host health. Species diversity is only one facet of a healthy community’s organization; together with abundance distributions and interaction structures, it shapes reproducible macroecological states, i.e., joint statistical fingerprints that summarize whole-community behavior. Despite recent developments, a theoretical framework connecting empirical data with ecosystem modeling is still in its infancy, particularly in the context of disordered systems. Here, we present a novel framework that couples statistical-physics tools for disordered systems with metagenomic data, explicitly linking diversity, interactions, and stability to define and compare these macroecological states. By employing the generalized Lotka-Volterra model with random interactions, we reveal two different emergent patterns of species-interaction networks and species abundance distributions for healthy and diseased microbiomes. On the one hand, healthy microbiomes have similar community structures across individuals, characterized by strong species interactions and abundance diversity consistent with neutral stochastic fluctuations. On the other hand, diseased microbiomes show greater variability driven by deterministic factors, thus resulting in less ecologically stable and more divergent communities. Our findings suggest the potential of disordered system theory to characterize microbiomes and to capture the role of ecological interactions on stability and functioning.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="s1" sec-type="intro">
<title>1 Introduction</title>
<p>Microbial communities are a fundamental reservoir of ecological functions and biological diversity. They are relevant for any environmental and host-associated ecosystem, ranging from soil to the human gut. In particular, the human gut microbiome, by interacting with the host’s metabolism and immune system <xref ref-type="bibr" rid="c1">Levy et al. [2016]</xref>, <xref ref-type="bibr" rid="c2">Barroso-Batista et al. [2015]</xref>, <xref ref-type="bibr" rid="c3">Barreto and Gordo [2023]</xref>, is a key regulator of human health. Dysbiosis is defined as an alteration in the composition of healthy microbiomes associated with the gastrointestinal tract <xref ref-type="bibr" rid="c4">Lloyd-Price et al. [2019]</xref>, <xref ref-type="bibr" rid="c5">Das and Nair [2019]</xref>, <xref ref-type="bibr" rid="c6">Nishida et al. [2018]</xref>.</p>
<p>Recently, stochastic non-interacting neutral <xref ref-type="bibr" rid="c7">Zeng et al. [2015]</xref>, <xref ref-type="bibr" rid="c8">Venkataraman et al. [2015]</xref>, <xref ref-type="bibr" rid="c9">Sala et al. [2016]</xref>, <xref ref-type="bibr" rid="c10">Sieber et al. [2019]</xref>, <xref ref-type="bibr" rid="c11">Descheemaeker and De Buyl [2020]</xref>, <xref ref-type="bibr" rid="c12">Grilli [2020]</xref>, <xref ref-type="bibr" rid="c13">Zaoli and Grilli [2022]</xref>, and logistic models have been successfully used to describe empirical patterns such as species abundance distribution (SAD) and species presence/absence statistics in different types of communities. However, focusing on single-species properties <xref ref-type="bibr" rid="c14">Azaele et al. [2016]</xref>, <xref ref-type="bibr" rid="c12">Grilli [2020]</xref> fails to characterize altered states of microbiome <xref ref-type="bibr" rid="c15">Seppi et al. [2023]</xref>, <xref ref-type="bibr" rid="c16">Pasqualini et al. [2024]</xref>. In particular, recent studies indicate that gut dysbiosis is associated with shifts in microbial species interaction patterns. Network-level properties of species interactions – such as the balance of positive and negative interactions, average interaction strength, and connectivity of the inferred interaction matrix – have been shown to systematically differ between healthy and dysbiotic gut communities (see, for instance, <xref ref-type="bibr" rid="c17">Bashan et al. [2016]</xref>, <xref ref-type="bibr" rid="c15">Seppi et al. [2023]</xref>). Pairwise species interactions have been quantified in simplified in-vitro consortia <xref ref-type="bibr" rid="c18">Kehe et al. [2021]</xref>, <xref ref-type="bibr" rid="c19">Venturelli et al. [2018]</xref>; we assume that the same classes of interactions also operate – albeit in a more complex form – in the native gut microbiome.</p>
<p>For these reasons, several approaches have been proposed in recent years to infer microbial interactions <xref ref-type="bibr" rid="c20">Faust and Raes [2012]</xref>, <xref ref-type="bibr" rid="c21">Xiao et al. [2017]</xref>, <xref ref-type="bibr" rid="c22">Camacho-Mateu et al. [2024]</xref>. However, such inference protocols remain very challenging and problematic in many respects <xref ref-type="bibr" rid="c23">Faisal et al. [2010]</xref>, <xref ref-type="bibr" rid="c24">Angulo et al. [2017]</xref>, <xref ref-type="bibr" rid="c25">Tu et al. [2019]</xref>, <xref ref-type="bibr" rid="c26">Armitage and Jones [2019]</xref>, <xref ref-type="bibr" rid="c27">Holt [2020]</xref>: a) the very high dimension of typical microbiome datasets and the lack of longitudinal (long-term) experiments; b) the time-dependent nature of microbial species interactions <xref ref-type="bibr" rid="c28">Pacciani-Mori et al. [2021]</xref>; c) abiotic factors such as resources, temperature, and pH, can introduce environmental filtering effects <xref ref-type="bibr" rid="c29">Sireci et al. [2022]</xref> and induce effective interactions; d) experimental and technical challenges that introduce sampling effects, false positive species <xref ref-type="bibr" rid="c30">Tovo et al. [2020]</xref>, spurious correlation, and bias in the data <xref ref-type="bibr" rid="c31">Weiss et al. [2016]</xref>, <xref ref-type="bibr" rid="c32">Gloor et al. [2017]</xref>, <xref ref-type="bibr" rid="c33">Dohlman and Shen [2019]</xref>. Therefore, even in a scenario where metagenomic samples are noise- and bias-free, reconstructing species-interaction networks of the underlying microbial dynamics remains a hard task.</p>
<p>An alternative, theoretically more elegant approach was pioneered by <xref ref-type="bibr" rid="c34">May May [1972]</xref>, proposing to use random matrices to model species interaction networks, i.e., each entry of the adjacency matrix is extracted at random from a given distribution. Given the impossibility of empirically measuring the interaction strengths, the advantage of such an approach is the reduction from ∼ <italic>S</italic><sup>2</sup> (if <italic>S</italic> is the number of species) to just a few parameters (e.g., 2) used to parameterize the distribution <xref ref-type="bibr" rid="c35">Allesina and Tang [2012]</xref>.</p>
<sec id="s1-1">
<title>1.1 Insights from Disordered Systems Theory</title>
<p>Although previous studies have largely focused on neutral theory and logistic models – including variants like the Stochastic Logistic Model that account for environmental fluctuations – they often neglect inter-species interactions, limiting their ability to reproduce macroecological patterns at a global scale. Moreover, higher-order correlations among species are known to generate non-trivial effects, such as the emergence of persistent fluctuations or chaotic dynamics due to the non-reciprocity of interactions.</p>
<p>In recent years, increasing attention has been devoted to studying population dynamics through the generalized Lotka-Volterra (gLV) equations, employing disordered systems techniques (also known as <italic>glassy</italic>), such as replica and cavity methods and Dynamical Mean-Field Theory approaches, originally developed in the context of statistical physics <xref ref-type="bibr" rid="c36">Bunin [2017]</xref>, <xref ref-type="bibr" rid="c37">Galla [2018]</xref>, <xref ref-type="bibr" rid="c38">Biroli et al. [2018]</xref>, <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref>, <xref ref-type="bibr" rid="c40">Lorenzana and Altieri [2022]</xref>. Indeed, due to the inherently high dimensionality of microbial datasets, random matrix theory and methods from disordered systems turn out to be particularly well suited. A striking feature of their application to ecological dynamics is that the resulting properties and dynamical regimes do not depend on species-specific details, provided that species are statistically equivalent under relabeling or time-averaging. Phase diagrams can thus be established in terms of a few effective parameters (e.g., the mean <italic>μ</italic> and the variance <italic>σ</italic><sup>2</sup> of the random interactions strengths) <xref ref-type="bibr" rid="c41">Barbier et al. [2018]</xref>. However, despite a range of very interesting results, this approach has remained confined mainly to purely theoretical domains (but see <xref ref-type="bibr" rid="c42">Hatton et al. [2024]</xref>) and has only recently been used to give an interpretation of controlled experiments with synthetic microbial communities <xref ref-type="bibr" rid="c43">Hu et al. [2022]</xref>.</p>
</sec>
</sec>
<sec id="s2" sec-type="results">
<title>2 Results</title>
<p>We now provide a <italic>proof of concept</italic> of the applicability of a high-dimensional disordered setting to human microbiomes. Specifically in the following section, we introduce the disordered generalized Lokta-Volterra (dgLV) model, infer its parameters from healthy and unhealthy cohorts of gut microbiomes, and test whether the resulting interaction patterns and stability metrics discriminate healthy from diseased macro-ecological states. Finally, we will introduce quantitative metrics to define microbiome stability and estimate the contribution of distinct ecological forces to the dynamics.</p>
<sec id="s2-1">
<title>2.1 Disordered generalized Lotka-Volterra model</title>
<p>The dgLV model describes the time evolution of the concentration abundances of a local pool of <italic>S</italic> interacting species, i.e.,</p>
<disp-formula id="FD1">
<alternatives>
<mml:math id="M1" display="block"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>η</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>λ</mml:mi><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn1.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(1)</label>
</disp-formula>
<p>where <italic>N<sub>i</sub></italic> is the populations of species <italic>i</italic>-th, <italic>K<sub>i</sub></italic> is its carrying capacity, and <italic>r<sub>i</sub></italic> the growth rate where <inline-formula id="ID1">
<alternatives>
<mml:math display="inline" id="I1"><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq1.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> is a constant, which we will assume will not depend on the species, i.e. <italic>ρ<sub>i</sub></italic> = <italic>ρ</italic>. The coefficients <italic>α<sub>ij</sub></italic> are random i.i.d random variables with <inline-formula id="ID2">
<alternatives>
<mml:math display="inline" id="I2"><mml:mi mathvariant="double-struck">E</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mo>/</mml:mo><mml:mi>S</mml:mi></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq2.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> and <inline-formula id="ID3">
<alternatives>
<mml:math display="inline" id="I3"><mml:mi mathvariant="double-struck">E</mml:mi><mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi mathvariant="double-struck">E</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mi>S</mml:mi></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq3.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. We also include an immigration species-independent rate <italic>λ</italic>, which will be treated as a reflecting wall mathematically regularizing the problem, and a demographic noise term <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref> <italic>η<sub>i</sub></italic>, with <inline-formula id="ID4">
<alternatives>
<mml:math display="inline" id="I4"><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>η</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>T</mml:mi><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>t</mml:mi><mml:mo>′</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq4.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, and where <italic>δ</italic> denotes the Dirac delta and <italic>T</italic> sets the scale of noise intensity. For notational purposes, we also introduce its inverse <italic>β</italic> = <italic>T</italic><sup>−1</sup>. Finally, we require that the interactions are symmetric, i.e., <italic>α<sub>ij</sub></italic> = <italic>α<sub>ji</sub></italic>. We can thus map this problem into an equilibrium thermodynamic one that is exactly solvable. As shown in the Appendix, <xref ref-type="sec" rid="s6-1">section S1</xref>, it is possible to justify this symmetric assumption and a linear dependence between the growth rate and the carrying capacity, namely <italic>r<sub>i</sub></italic> = <italic>ρK<sub>i</sub></italic>, by considering the quasi-stationary approximation of the MacArthur consumer-resource model. In the following, we set <italic>ρ</italic> =1 (following also <xref ref-type="bibr" rid="c38">Biroli et al. [2018]</xref>).</p>
<p>The presence of a noise term in <xref ref-type="disp-formula" rid="FD1">Eq. (1)</xref> allows us to write the Fokker-Planck equation of the system and study its stationary solution (see <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref>, <xref ref-type="bibr" rid="c44">Altieri and Biroli [2022]</xref> for a detailed derivation in a similar Hamiltonian formalism). Here, we adopt the Itô prescription for the stochastic dynamics in such a way as to prevent species resurgence by noise.</p>
<p>The replica formalism, a well-known technique in disordered systems, comes into play and allows us to derive a non-interacting Hamiltonian corresponding to the dgLV symmetric interactions <italic>α<sub>ij</sub></italic> (see Methods and Appendix, <xref ref-type="sec" rid="s6-2">Section S2</xref>, for a complete derivation). In simple words, instead of trying to solve the problem for one random setup, the formalism considers many replicas of the system and averages their behaviors. This approach helps to smooth out the randomness and reveals the typical behavior of the system. We also assume a single equilibrium scenario, known as <italic>replica-symmetric</italic> (RS) regime. Although the SADs of empirical microbial communities display fat tails, a feature more compatible with the multi-attractors phase of the asymmetric 1RSB <xref ref-type="bibr" rid="c45">Mallmin et al. [2024]</xref> case or with the gLV with time-dependent disordered interactions <xref ref-type="bibr" rid="c46">Suweis et al. [2024]</xref> <italic>(annealed</italic> version), we consider this simplification as it is the regime in which we can obtain explicit analytical relations between the model parameters and the data and where model inversion is feasible. By employing a cavity argument <xref ref-type="bibr" rid="c47">Mezard and Montanari [2009]</xref>, <xref ref-type="bibr" rid="c48">Altieri and Baity-Jesi [2024]</xref>, one can indeed analytically derive the SAD of the model (see Methods and Appendix, Section S4):</p>
<disp-formula id="FD2">
<alternatives>
<mml:math id="M2" display="block"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi>ν</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mi>ζ</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn2.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(2)</label>
</disp-formula>
<p>where the auxiliary variable <inline-formula id="ID5">
<alternatives>
<mml:math display="inline" id="I5"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>o</mml:mi></mml:msub></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi><mml:mi>z</mml:mi></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq5.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> takes the disorder interactions into account; <italic>z</italic> is a standardized Gaussian variable, <italic>ν</italic> = <italic>βλ</italic> &gt; 0. We introduce, respectively, the mean abundance <inline-formula id="ID6">
<alternatives>
<mml:math display="inline" id="I6"><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>N</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq6.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, the self-overlap <inline-formula id="ID7">
<alternatives>
<mml:math display="inline" id="I7"><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq7.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, and the overlap <inline-formula id="ID8">
<alternatives>
<mml:math display="inline" id="I8"><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>N</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq8.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, which we will collectively refer to as <italic>order parameters</italic> in the following sections. Specifically, <italic>q</italic><sub>0</sub> measures the similarity between two different configurations at stationarity of the system with two different disorder realizations, while <italic>q<sub>d</sub></italic> measures the similarity of two stationary configurations generated with the same disorder realization. Finally, we introduce a constant that, inspired by the Field Theory jargon, we dub as mass <italic>m</italic> = 1 − <italic>βσ</italic><sup>2</sup> (<italic>q<sub>d</sub></italic> − <italic>q</italic><sub>0</sub>) &gt; 0 for the theory to be consistent <xref ref-type="bibr" rid="c38">Biroli et al. [2018]</xref>.</p>
<p>The RS ansatz can also be characterized by its stability to external perturbations, such as the external temperature, the immigration rate, or the interaction heterogeneity. To investigate the stability of the RS phase, we consider the Hessian matrix of the theory by performing a harmonic expansion of the replicated free energy, as originally pointed out in <xref ref-type="bibr" rid="c49">de Almeida and Thouless [1978]</xref>. When the leading eigenvalue of the Hessian matrix, the so-called <italic>replicon mode</italic>, goes below zero, unstable equilibria appear: either the system moves towards a One-step Replica Symmetric Breaking (1-RSB) phase with multiple locally stable minima, or it develops a marginal full-RSB phase, leading to a hierarchical structure of states and therefore to an extremely rough landscape (also known as <italic>Gardner amorphous-like phase</italic>). In other words, the RS ansatz no longer represents a thermodynamically stable phase in the latter cases.</p>
<p>Based on standard calculations in disordered systems, the <italic>replicon</italic> mode <italic>ℜ</italic> can be analytically evaluated and reads:</p>
<disp-formula id="FD3">
<alternatives>
<mml:math id="M3" display="block"><mml:mi>ℜ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mover accent="true"><mml:mrow><mml:mo>&lt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>ξ</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>&gt;</mml:mo></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mover accent="true"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>N</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn3.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(3)</label>
</disp-formula>
<p>where <inline-formula id="ID9">
<alternatives>
<mml:math display="inline" id="I9"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>N</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>ξ</mml:mi></mml:mrow></mml:mfrac></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq9.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> is the species response to an external perturbation, keeping track of non-extinct species only. For more details, see S3 in the Appendix.</p>
<p>(The replicon eigenvalue refers to a particular type of fluctuation around the saddle-point (mean-field) solution in the replica framework. When diagonalizing the Hessian matrix of the replicated free energy, fluctuations split into three sectors: longitudinal, anomalous, and replicon. The replicon mode is the most sensitive to criticality signaling – by its vanishing trend – the emergence of many nearly-degenerate states. It essentially describes how ‘soft’ the system is to microscopic rearrangements in configuration space.)</p>
</sec>
<sec id="s2-2">
<title>2.2 Data Through the Glass</title>
<p>We now consider cross-sectionally sampled gut microbiomes of two different cohorts: one of healthy and another of diseased individuals. Here we focus on chronic inflammation syndromes, but, in principle, what we present holds for groups of phenotypically distinct populations. We can idealize the samples of each group as generated from the stationary distribution of the dgLV <xref ref-type="disp-formula" rid="FD1">Eq. (1)</xref>, with <italic>different</italic> realizations of the disorder <bold><italic>α</italic></bold>, but with shared <italic>μ</italic> and <italic>σ</italic> (see Material and Methods). The approach we propose considers all samples in the same group as coming from the same statistical ensemble. On the other hand, it distinguishes ecological regimes characterized by distinct phenotypes through different statistics (e.g., dissimilar <italic>μ</italic> and <italic>σ</italic>) of the random species interactions <bold><italic>α</italic></bold>. We aim to test the hypothesis that each cohort will be described by a different set of ecological parameters, precisely with <bold><italic>θ</italic></bold> = (<italic>μ</italic>, <italic>σ</italic>, <italic>T</italic>, <italic>λ</italic>).</p>
<p>To calculate the order parameters (<italic>h</italic>, <italic>q<sub>d</sub></italic>, <italic>q</italic><sub>0</sub>, <italic>K</italic>) from the data, we thus need to specify how we perform the ensemble and the disorder averages empirically (see <xref ref-type="fig" rid="fig1">Figure 1</xref>). Since time series data are rarely available, we rely on an effective mean-field description and estimate the ensemble average by averaging over species (that is, different species are realizations of the same underlying stochastic process <xref ref-type="bibr" rid="c14">Azaele et al. [2016]</xref>, known as neutral hypothesis), i.e., <inline-formula id="ID10">
<alternatives>
<mml:math display="inline" id="I10"><mml:mrow><mml:mo>〈</mml:mo><mml:mo>⋅</mml:mo><mml:mo>〉</mml:mo></mml:mrow><mml:mo>∼</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>c</mml:mi><mml:mi>i</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo></mml:mstyle></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq10.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. Then, we assume that the average over the disorder can be computed as a sample average. In other words, within a given phenotype (healthy/unhealthy), each measured microbiome configuration is a sample from the stationary distribution of the dgLV model, with a given realization of the disorder, i.e., <inline-formula id="ID11">
<alternatives>
<mml:math display="inline" id="I11"><mml:mover accent="true"><mml:mo>⋅</mml:mo><mml:mo>¯</mml:mo></mml:mover><mml:mo>∼</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>R</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>s</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>p</mml:mi><mml:mi>l</mml:mi><mml:mi>e</mml:mi><mml:mi>s</mml:mi></mml:mrow></mml:msub><mml:mo>⋅</mml:mo></mml:mstyle></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq11.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, where <italic>R</italic> is the number of samples and typically <italic>R</italic> ≫ 1. Moreover, due to our limited knowledge of the fine details governing the interactions in each microbiome, it is reasonable to assume that all communities with a given macrostate – a point in the (<italic>h</italic>, <italic>q</italic><sub>0</sub>, <italic>q<sub>d</sub></italic>, <italic>K</italic>) space – experience the same demographic noise <italic>T</italic>, immigration rate <italic>λ</italic>, and disorder parameters <italic>μ</italic> and <italic>σ</italic>. Eventually, we can compute the order parameters from the data as:</p>
<disp-formula id="FD4">
<alternatives>
<mml:math id="M4" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>N</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>R</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>R</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>N</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>R</mml:mi></mml:mfrac><mml:msup><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>R</mml:mi></mml:munderover><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mn>2</mml:mn></mml:msup></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2406.07465v2_eqn4.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(4)</label>
</disp-formula>
<p>where <italic>N<sub>j,a</sub></italic> represents the population density of species <italic>j</italic> in sample <italic>a</italic>.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>The inference protocol of the dgLV generative model is performed by a moment matching optimization procedure.</title>
<p>We aim to infer the free parameters <bold><italic>θ</italic></bold> = (<italic>μ</italic>, <italic>σ</italic>, <italic>T</italic>, <italic>λ</italic>) – shown on the right – so that to match the mean abundance, higher-order correlations between species abundances, and the average carrying capacity for the two cohorts, i.e. (<italic>h</italic>, <italic>q</italic><sub>0</sub>, <italic>q<sub>d</sub></italic>, <italic>K</italic>) – on the left. This procedure allows us to extract ecological dynamics information for cross-sectional data of healthy (blue) and diseased (red) microbiomes, which are conceptualized as independent disorder realizations.</p></caption>
<graphic xlink:href="2406.07465v2_fig1.tif" mime-subtype="tif" mimetype="image"/>
</fig>
<p>To evaluate the carrying capacities <italic>K<sub>i</sub></italic> from the data, as done in most of the works using dgLV equations <xref ref-type="bibr" rid="c36">Bunin [2017]</xref>, <xref ref-type="bibr" rid="c38">Biroli et al. [2018]</xref>, <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref>, <xref ref-type="bibr" rid="c46">Suweis et al. [2024]</xref>, <xref ref-type="bibr" rid="c45">Mallmin et al. [2024]</xref>, we assume that in each cohort all species are characterized by the same carrying capacity <italic>K<sub>i</sub></italic> = <italic>K</italic>. Here, we define <italic>K</italic> as the average of the maximum relative abundances of species across the available samples for each cohort, so that <inline-formula id="ID12">
<alternatives>
<mml:math display="inline" id="I12"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mrow><mml:mi>max</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mi>a</mml:mi></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mstyle></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq12.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>.</p>
<p>Note also that, from metagenomics, we only have access to compositional data for species abundances <xref ref-type="bibr" rid="c16">Pasqualini et al. [2024]</xref>. This is crucial to properly treat different samples and end up with a consistent analysis. Moreover, this approach allows us to give an ecological interpretation of some of the order parameters. In particular, because of the compositionality of the data, we have that <inline-formula id="ID13">
<alternatives>
<mml:math display="inline" id="I13"><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq13.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> and <inline-formula id="ID14">
<alternatives>
<mml:math display="inline" id="I14"><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>S</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq14.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, while <italic>q<sub>d</sub></italic> provides information on pairwise products between species abundances within each replica. <xref ref-type="fig" rid="fig2">Figure 2</xref> shows the values of such order parameters between healthy and unhealthy cohorts for two randomized instances. In the data, we observe a systematic difference between healthy and unhealthy cohorts, pointing to a higher average local diversity in healthy samples (panels a, c), as also observed in <xref ref-type="bibr" rid="c16">Pasqualini et al. [2024]</xref>. Panel b highlights a higher <italic>q<sub>d</sub></italic> in unhealthy patients, a signature of the weakening species interactions in those samples. We will further investigate this aspect by inferring the species interactions in both cohorts.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Order parameters inferred from the data using Eqs. <xref ref-type="disp-formula" rid="FD4">(4)</xref>.</title>
<p>Panel a) shows <italic>h</italic>, b) <italic>q<sub>d</sub></italic>, and panel c) <italic>q</italic><sub>0</sub> in healthy (blue) and unhealthy (red) cohorts. The gray points show the values for the corresponding null models where sample labels have been randomized. Standard deviations have been computed over 5000 realizations.</p></caption>
<graphic xlink:href="2406.07465v2_fig2.tif" mime-subtype="tif" mimetype="image"/>
</fig>
<p>From the modeling point of view, it can be rigorously shown that constraining the abundances to be normalized to one corresponds to introducing a Lagrange multiplier in the expression of the free energy. However, this only acts on the linear term, contributing to shifting the mean of the random interactions, <italic>μ</italic>, but does not affect the heterogeneity <italic>σ</italic>, and therefore the phase diagram overall. For more details, we refer the interested reader to the Appendix (end of Section S2) along with <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref>. In <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref> the authors also showed how a global normalizing constraint on species abundances reflects in a one-to-one mapping with the random replicant model <xref ref-type="bibr" rid="c50">Biscari and Parisi [1995]</xref> (the replicator equations originally introduced by <xref ref-type="bibr" rid="c51">Diederich and Opper [1989]</xref> and recast within the replica formalism <xref ref-type="bibr" rid="c50">Biscari and Parisi [1995]</xref>, <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref> describe the dynamics of an ensemble of replicants that evolve via random couplings).</p>
</sec>
<sec id="s2-3">
<title>2.3 Species interactions patterns characterize the state of microbiomes</title>
<p>We thus collect all the parameters estimated from the data in a vector <bold><italic>π</italic></bold> = (<italic>h</italic>, <italic>q<sub>d</sub></italic>, <italic>q</italic><sub>0</sub>, <italic>K</italic>). As we will better detail in the Methods, we develop a moment matching inference algorithm to infer the model parameters <bold><italic>θ</italic></bold>, as depicted in <xref ref-type="fig" rid="fig1">Figure 1</xref>. The idea of the method is to introduce a cost function <italic>𝒞</italic>(<bold><italic>θ</italic></bold>|<bold><italic>π</italic></bold>), representing a total relative error for some self-consistent equations. If the parameters <bold><italic>θ</italic></bold> are such that the right part of the self-consistent equation equals the left part, the problem is considered solved. Because the landscape associated with this cost function presents several minima, we perform multiple optimization procedures to collect an ensemble of possible solutions, from which we retain the top 30. First, we find that different solutions <bold><italic>θ</italic></bold>* of the optimization problem provide ecological insights into the underlying microbiome populations.</p>
<p>As originally predicted in <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref>, among all the parameters that define <xref ref-type="disp-formula" rid="FD1">Eq. (1)</xref>, the only ones relevant for reproducing the theoretical phase diagram are the amplitude of demographic noise and the heterogeneity of interactions. The mean interaction strength, provided it is sufficiently positive, does not play a significant role. This prediction is fully confirmed by the inference procedure applied to the two microbiome datasets, allowing us to identify a universal signature that distinguishes healthy from unhealthy states. <xref ref-type="fig" rid="fig3">Figure 3a</xref> shows, indeed, that inferred noise (<italic>T</italic>) and interaction heterogeneity strength (<italic>σ</italic>) for healthy and diseased microbiomes are clustered in the two-dimensional plane.</p>
<p>In particular, the SAD for the healthy cohort is robust among the different solutions of the inference procedure, as depicted by the superposition of the different curves in the inset of <xref ref-type="fig" rid="fig3">Figure 3A</xref>. On the other hand, SADs inferred from unhealthy patients have high sensitivity to different solutions. In particular, some of them display a mode for high-abundance species (light red lines in <xref ref-type="fig" rid="fig3">Figure 3a</xref>), a signature of dominant strain in the gut. Consistently, the distribution of the interactions <italic>P</italic> (<italic>α<sub>i,j</sub></italic>) generated through the inferred parameters <italic>μ</italic> and <italic>σ</italic> is different between healthy and diseased cohorts, giving a distinct pattern of interactions (see <xref ref-type="fig" rid="fig3">Figure 3b</xref>), a result that is compatible with that found by Bashan and collaborators <xref ref-type="bibr" rid="c17">Bashan et al. [2016]</xref>. Remarkably, we find that dysbiosis reduces the heterogeneity of interaction strengths, a result also observed when taking correlations as a proxy for interactions <xref ref-type="bibr" rid="c15">Seppi et al. [2023]</xref>.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><p>Panel a: inferred <italic>T</italic> (demographic noise strength) and <italic>σ</italic> (interactions heterogeneity) for healthy (blue) and diseased (red) microbiomes are clustered. Darker dots correspond to better solutions (i.e., solutions with a lower value of the cost function <italic>𝒜</italic>), while the two points with hexagonal markers correspond to the best two (healthy and diseased, respectively) solutions. In the first panel inset, we also show (in log-log scale) the SADs corresponding to each solution. To have a more concise representation, we present each SAD fixing the disorder to its average <inline-formula id="ID15">
<alternatives>
<mml:math display="inline" id="I15"><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq15.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. Panel b: the probability density function of the inferred interactions <italic>α<sub>i,j</sub></italic> for healthy (blue) and diseased (red) microbiomes. Dysbiosis reduces the heterogeneity of the interaction strengths. The quantities reported in the legend are the average and standard deviation of <italic>α<sub>i,j</sub></italic>. They have are calculated as <inline-formula id="ID16">
<alternatives>
<mml:math display="inline" id="I16"><mml:msubsup><mml:mi>μ</mml:mi><mml:mi>X</mml:mi><mml:mi>α</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>μ</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msub><mml:mi>S</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq16.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> and <inline-formula id="ID17">
<alternatives>
<mml:math display="inline" id="I17"><mml:msubsup><mml:mi>σ</mml:mi><mml:mi>X</mml:mi><mml:mi>α</mml:mi></mml:msubsup><mml:mo>=</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>X</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>S</mml:mi><mml:mi>X</mml:mi></mml:msub></mml:mrow></mml:msqrt></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq17.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, where <italic>S<sub>X</sub></italic> is the species pool size, estimates as the set of all the observed species in a dataset, <italic>X</italic>. <italic>X</italic> can be healthy (<italic>H</italic>) or diseased (<italic>D</italic>).</p></caption>
<graphic xlink:href="2406.07465v2_fig3.tif" mime-subtype="tif" mimetype="image"/>
</fig>
<p>We then assess how close the inferred <italic>σ</italic> and <italic>β</italic> = 1/<italic>T</italic> (a.k.a. inverse temperature in a statistical physics approach) are to the critical replica symmetry-breaking (RSB) line of the dgLV (<italic>ℜ</italic> = 0), evaluated by keeping all the other parameters constant (see Methods). We find again that the replicon values <italic>ℜ</italic> corresponding to each solution of our optimization protocol are significantly different for the two investigated microbiome phenotypes (see <xref ref-type="fig" rid="fig4">Figure 4a</xref>). In particular, diseased microbiomes are closer to marginal stability within the replica-symmetric ansatz <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref>, <xref ref-type="bibr" rid="c52">Mézard et al. [1987]</xref>, <xref ref-type="bibr" rid="c49">de Almeida and Thouless [1978]</xref>. Furthermore, by investigating the shape of the SAD given by <xref ref-type="disp-formula" rid="FD2">Eq. (2)</xref>, we can estimate the ratio between niche (represented by species interaction) and neutral (represented by birth/death and immigration) ecological forces, which can be captured by the quantity <italic>ψ</italic> <xref ref-type="bibr" rid="c53">Wu et al. [2021]</xref>. It detects the emergence of peaks in the species abundance distribution as a hallmark of niche processes (see Appendix 2).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><p>Panel a: The replicon eigenvalue corresponding to each solution of our optimization procedure (shaded dots). The solid hexagon represents the replicon corresponding to the best solutions that minimize the error in predicting the order parameters of the theory (minimum <italic>𝒞</italic>). The two investigated microbiome phenotypes (healthy in blue, diseased in red) are significantly different. In particular, diseased microbiomes are closer to the marginal stability of replica-symmetric ansatz (grey horizontal line). Panel b: Solutions of the moment-matching objective function are shown as a function of <italic>ψ</italic> and <italic>m</italic>, which in turn depend on the SAD parameters (see main text). Healthy (blue) and diseased (red) microbiomes appear to be clustered. Therefore, distinct ecological organization scenarios (strong neutrality/emergent neutrality) emerge. Darker dots correspond to solutions with lower values of the cost function, while hexagonal markers correspond to the two best solutions.</p></caption>
<graphic xlink:href="2406.07465v2_fig4.tif" mime-subtype="tif" mimetype="image"/>
</fig>
<p>Inspired by field-theory arguments (see Methods and Appendix, Section S2), we can call <italic>mass</italic> of the theory the <italic>m</italic> parameter, as defined above in <xref ref-type="disp-formula" rid="FD2">Eq. (2)</xref>. In classical and quantum field theory, the particle-particle interaction embedded in the quadratic term is typically referred to as a mass source. In our context, <italic>m</italic> = 1 − <italic>βσ</italic><sup>2</sup> (<italic>q<sub>d</sub></italic> − <italic>q</italic><sub>0</sub>) captures quadratic fluctuations of species abundances, as also appearing in the expression of the leading eigenvalue of the stability matrix. When <italic>m</italic> → 0, the analytical order parameters diverge and the system enters the unphysical regime of unbounded growth. As such, the <italic>mass</italic> term can be considered a complementary stability measure, capable of capturing the transition to the unbounded growth regime.</p>
<p>In the model, two kinds of effects compete to shape the community structure. On the one hand, we have niche effects, encoded in disordered interactions and thus tracked by the parameters <italic>μ</italic>, <italic>σ</italic>, and <italic>K</italic>. Their overall effect is selective and tends to concentrate the SAD around the typical abundance value. On the other hand, we have neutral effects encoded in the stochastic dynamics and immigration, governing the low abundance regime of the SAD. When the demographic noise amplitude is stronger than immigration (<italic>ν</italic> &lt; 1, as in our case), the SAD exhibits a low-abundance integrable divergence. In the opposite scenario, for <italic>ν</italic> &gt; 1, there is no divergence and the SAD is modal. Since interactions are random, the probability of observing an internal mode can be estimated as the fraction of SADs realizations having non-trivial solutions to the stationary point equation. Such a quantity, dubbed as the niche-neutral ratio, can be analytically evaluated:</p>
<disp-formula id="FD5">
<alternatives>
<mml:math id="M5" display="block"><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>ζ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>E</mml:mi><mml:mi>r</mml:mi><mml:mi>f</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>ζ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn5.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(5)</label>
</disp-formula>
<p>where <inline-formula id="ID18">
<alternatives>
<mml:math display="inline" id="I18"><mml:msup><mml:mi>ζ</mml:mi><mml:mo>*</mml:mo></mml:msup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>β</mml:mi></mml:mfrac></mml:mrow></mml:msqrt></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq18.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> and <inline-formula id="ID19">
<alternatives>
<mml:math display="inline" id="I19"><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq19.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. When <italic>ψ</italic> ≈ 1, niche and neutral forces give comparable contributions to the dynamics, as both low abundance divergence and a finite abundance mode coexist in the SAD. Finally, if the typical abundance diverges, we enter the unbounded growth phase, which means that the mass <italic>m</italic> and the niche-neutral ratio <italic>ψ</italic> are not independent, as suggested by the analytical expression for <italic>ψ</italic>. For an exhaustive derivation of this result, see Appendix 2. With the obtained model parameters, we are able to evaluate <italic>m</italic> and <italic>ψ</italic> for healthy and diseased microbiomes. Also in this case healthy and diseased microbiomes are visibly clustered, as shown in <xref ref-type="fig" rid="fig4">Figure 4</xref>. Unhealthy microbiomes turn out to be closer to the unbounded growth phase, and the niche-neutral ratio is larger by five orders of magnitude than the healthy case <italic>ψ<sub>D</sub></italic> ≈ 10<sup>5</sup><italic>ψ<sub>H</sub></italic>. This leads us to argue that selective pressure is way larger in diseased states, while in the healthy one, birth and death effects are the key drivers of the dynamics. These results are also confirmed by the SAD shapes in the inset of <xref ref-type="fig" rid="fig3">Figure 3</xref> (panel a).</p>
<p>In summary, in the Result section we demonstrate that: (i) the inference pipeline robustly recovers demographic noise and interaction heterogeneity by calculating <italic>h</italic>, <italic>q</italic><sub>0</sub> and <italic>q<sub>d</sub></italic> from the data; (ii) These parameters cluster by health status and (iii) diseased microbiomes lie closer to the replica-symmetry-breaking threshold, indicating reduced ecological resilience.</p>
</sec>
</sec>
<sec id="s3" sec-type="discussion|conclusion">
<title>3 Discussion and Conclusions</title>
<p>In our exploration of the gut microbiome through the lens of disordered systems and random matrix theory, we have proposed a connection between the theoretical framework of disordered systems and practical analyses of environmental microbiome data. In particular, we have characterized healthy and unhealthy gut microbiomes using the disordered generalized Lotka-Volterra model (dgLV) for population dynamics. We now interpret our theoretical findings in a biological context, contrast them with previous work, and outline limitations and future directions.</p>
<p>The first major result of our work suggests a different role for the various ecological forces shaping the human gut microbial community. In this sense, the niche-neutral ratio <italic>ψ</italic>, highlights the different roles of interactions in healthy and diseased microbiomes. In the healthy case, neutral forces, such as random birth and death of individuals, characterize the dynamics, making configurations corresponding to this state alike. On the contrary, in diseased microbiomes, disordered, sample-specific interactions are the dominant ecological force, making individual realizations differ significantly from one another. An ecological interpretation of our findings suggests that healthy microbiomes are governed primarily by demographic stochasticity, reflecting a quasi-neutral regime characterized by similar community structures across individuals. Conversely, microbiomes from diseased patients exhibit significantly greater variability, suggesting that deterministic ecological factors – such as weakened species interactions – override neutrality, leading to structural instability and distinct microbial compositions. This observation aligns with the “Anna Karenina principle” <xref ref-type="bibr" rid="c16">Pasqualini et al. [2024]</xref>, <xref ref-type="bibr" rid="c59">Ma [2020]</xref> holding for gut microbiomes, which can be phrased as: “All healthy gut microbiomes are alike; each unhealthy gut microbiome is unhealthy in its own way”. Supporting this interpretation, our analysis of the replicon eigenvalue <italic>ℜ</italic> shows that the healthy state is associated with pronounced stability to external perturbations. The unhealthy state, instead, being closer to the RSB line, exhibits diminished stability and, consequently, reduced robustness against external perturbations.</p>
<p>Our study also sheds light on the role of demographic noise within the context of the dgLV model. In the limit <italic>T</italic> → 0, the SAD transitions to a truncated Gaussian, with a prominent peak at zero reflecting the fraction of extinct species. In contrast to a zero-noise scenario, where species extinctions are observed, the inclusion of demographic noise in the dgLV model suggests a picture where no species goes extinct, supporting the <italic>everything is everywhere</italic> hypothesis <xref ref-type="bibr" rid="c12">Grilli [2020]</xref>, <xref ref-type="bibr" rid="c55">Pigani et al. [2024]</xref>. In other words, within this framework, zeros in the data are due to sampling effects and not due to local species extinctions <xref ref-type="bibr" rid="c12">Grilli [2020]</xref>, <xref ref-type="bibr" rid="c16">Pasqualini et al. [2024]</xref>.</p>
<p>A notable limitation of our study lies in the discrepancy between the empirical Species Abundance Distribution (SAD) observed in the data and the theoretical distribution predicted by the quenched dgLV model <xref ref-type="bibr" rid="c46">Suweis et al. [2024]</xref>. While empirical data showcase a diverse range of species abundance, following a power-law distribution, the model predictions tend to exhibit exponential decay in SAD tails. This mismatch underscores the need for further refinement of the model to accurately capture the nuanced patterns observed in real-world data. For example, it has recently been proposed that introducing an annealed disorder can generate SADs that more closely resemble the empirical ones <xref ref-type="bibr" rid="c46">Suweis et al. [2024]</xref> (unlike the <italic>quenched</italic> approximation, the <italic>annealed</italic> version assumes that random couplings are not fixed but rather fluctuate over time, with their covariance governed by independent Ornstein-Uhlenbeck processes). Another possibility is to set the dgLV model parameters in such a way as to reproduce the multi-attractor phase. In fact, in this region, the SADs display a more heterogeneous shape <xref ref-type="bibr" rid="c56">Arnoulx de Pirey and Bunin [2024]</xref>. We plan to explore this follow-up direction by combining one-step replica-symmetry-breaking (1RSB) computations in the multiple-attractor phase with Dynamical Mean-Field Theory analysis for the asymmetric interaction case. This latter approach is particularly well suited for studying inherently non-equilibrium dynamics and for extending the framework to systems subject to environmental fluctuations in addition to demographic noise.</p>
<p>Another related limitation is the challenge of generating species abundance samples from the dgLV model that mirrors the statistical properties of the observed empirical data. In our current framework, each microbiome sample could be extracted from <italic>p</italic>(<italic>N</italic>|<italic>ζ</italic>), where <italic>ζ</italic> is a realization of the disorder. However, <italic>p</italic>(<italic>N</italic>|<italic>ζ</italic>) near <italic>N</italic> → 0 presents a power-law exponent <italic>ν</italic> − 1, with <italic>ν<sub>H,D</sub></italic> ≈ 10<sup>−3</sup>. This results in numerical instabilities and dominates the sampling process, posing difficulties in generating representative synthetic samples. Moreover, while microbiome data are inherently compositional <xref ref-type="bibr" rid="c16">Pasqualini et al. [2024]</xref>, the dgLV model species populations <italic>N<sub>i</sub></italic> are positive real numbers. However, as already noted, it can be shown that introducing a normalization <inline-formula id="ID20">
<alternatives>
<mml:math display="inline" id="I20"><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>/</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq20.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> in such equations does not change the structure of the proposed solutions <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref> and therefore should not affect the conclusions of our work.</p>
<p>In conclusion, our work proposes a bridge between theory and data, particularly in refining the theoretical models to better align with empirical observations and in exploring the nuances of species abundance distributions within the microbiome context. Moreover, the integration of other forms of environmental variability and species-specific traits could provide a more holistic view of ecological dynamics, as also proposed by the <italic>One Health-One Microbiome</italic> framework <xref ref-type="bibr" rid="c57">Tomasulo et al. [2024]</xref>.</p>
<p>Overall, our study builds a quantitative link between metagenomic data and the disordered gLV framework, revealing how dysbiosis alters gut species interaction networks. By doing so, it lays the groundwork for more advanced, mechanistically informed models to better interpret and ultimately manage complex microbial ecosystems.</p>
</sec>
<sec id="s5" sec-type="materials|methods">
<title>Material and Methods</title>
<sec id="s5-1">
<title>Microbiome dataset and code</title>
<p>We have selected gut microbiome data from three studies <xref ref-type="bibr" rid="c58">Franzosa et al. [2019]</xref>, <xref ref-type="bibr" rid="c4">Lloyd-Price et al. [2019]</xref>, <xref ref-type="bibr" rid="c59">Mars et al. [2020]</xref>, focusing on inflammatory syndromes of the gastrointestinal tract (Crohn’s Disease, Ulcerative Colitis, and Irritable Bowel Syndromes). Considering all the available metadata, we have selected the patients less affected by possible perturbing factors, such as drugs. Finally, our dataset consists of <italic>R</italic><sub>Healthy</sub> = 91 shotgun metagenomic samples from healthy control individuals and <italic>R</italic><sub>Diseased</sub> = 202 shotgun metagenomic samples. All metagenomic preprocessing and reads classification are extensively described in <xref ref-type="bibr" rid="c16">Pasqualini et al. [2024]</xref>. Species abundance profiles from metagenomic data and the parameters values obtained from the moment matching inference are available at the associated Zenodo page.</p>
<p>All the scripts implementing the moment matching inference and the jupyter notebooks to generate the figures are available at the associated GitHub page.</p>
</sec>
<sec id="s5-2">
<title>Free-energy landscape exploration: replica formalism</title>
<p>In the case of symmetric interactions – corresponding to conservative forces in the dynamics – a one-to-one mapping between the multi-species dynamics and a thermodynamic formalism can be safely worked out. The first step consists of writing the Fokker-Planck equation in the presence of a white Gaussian noise defined by a zero mean and a variance of amplitude 2<italic>T</italic>. All technical details, leveraging a Fokker-Planck derivation, can be found in <xref ref-type="bibr" rid="c44">Altieri and Biroli [2022]</xref> for a similar pairwise interacting model, but a different self-regulation term accounting for non-logistic behavior (1).</p>
<p>Once the (quenched) disordered Hamiltonian of the model is obtained, we can resort to techniques known in statistical physics of disordered systems, such as the replica and cavity methods <xref ref-type="bibr" rid="c47">Mezard and Montanari [2009]</xref>, <xref ref-type="bibr" rid="c52">Mézard et al. [1987]</xref>, <xref ref-type="bibr" rid="c60">Zamponi [2010]</xref>. The replica trick, in particular, allows us to handle disordered quantities, such as the free energy and the partition function, which would be otherwise unaffordable (see Appendix below).</p>
<p>We summarize the main findings here along with the expressions of the (RS) order parameters of the model, (<italic>h</italic>, <italic>q<sub>d</sub></italic>, <italic>q</italic><sub>0</sub>). The three expressions below, originally obtained in <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref>, have offered the starting point of this work, allowing for a thorough comparison with the same order parameters measured from metagenomic data. Their analytical expressions are self-consistently determined by the system of equations:</p>
<disp-formula id="FD6">
<alternatives>
<mml:math id="M6" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>h</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mi>d</mml:mi><mml:mo>,</mml:mo></mml:mrow></mml:msub><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:mi>N</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>N</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:mi>N</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:mi>N</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>Z</mml:mi></mml:msub></mml:mrow></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:mi>N</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mi>N</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:mi>N</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mrow><mml:mn>0</mml:mn></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:mi>z</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mover accent="true"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mi>N</mml:mi><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2406.07465v2_eqn6.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(6)</label>
</disp-formula>
<p>where the calligraphic notation stands for the Gaussian integration <inline-formula id="ID21">
<alternatives>
<mml:math display="inline" id="I21"><mml:mi>𝒟</mml:mi><mml:mi>z</mml:mi><mml:mo>≡</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>z</mml:mi></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mi>z</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:msup></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq21.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. In other words, the external average is equivalent to averaging over the quenched disorder <inline-formula id="ID22">
<alternatives>
<mml:math display="inline" id="I22"><mml:mover accent="true"><mml:mo>⋅</mml:mo><mml:mo>¯</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq22.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, whereas the most internal one – over the continuous variable <italic>N</italic> – is interpreted as a thermal average over the single-equilibrium Hamiltonian ℋ<sub>RS</sub>(<italic>N</italic>; <italic>q<sub>d</sub></italic>, <italic>q</italic><sub>0</sub>, <italic>h</italic>). The latter is denoted by <inline-formula id="ID23">
<alternatives>
<mml:math display="inline" id="I23"><mml:mrow><mml:mo>〈</mml:mo><mml:mo>⋅</mml:mo><mml:mo>〉</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq23.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. See Appendix (section S2) for more details.</p>
<p>As long as the system of Eqs. <xref ref-type="disp-formula" rid="FD6">(6)</xref> admits physically reasonable solutions, we might claim that the RS ansatz safely holds. This condition is nevertheless necessary but not sufficient because the stability of the RS solution must also be checked. It therefore requires studying the Hessian matrix of free energy and diagonalizing it on a suitable subspace, called <italic>replicon</italic>, <italic>ℜ</italic>. The main outcome of this computation is captured by <xref ref-type="disp-formula" rid="FD3">Eq. (3)</xref> of the main text. The averaged difference describes the fluctuations between the first and second moments of the species abundances within one state, namely between the diagonal value <italic>q<sub>d</sub></italic> and the off-diagonal contribution <italic>q</italic><sub>0</sub> of the overlap matrix. Detecting a vanishing value of <italic>ℜ</italic> corresponds to the appearance of a marginally stable RS solution (see section s3 of the Appendix).</p>
</sec>
<sec id="s5-3">
<title>Moment matching inference</title>
<p>The parameters <italic>h</italic>, <italic>q</italic><sub>0</sub>, and <italic>q<sub>d</sub></italic> can be self-consistently determined through the saddle point of the dgLV free energy in Eqs. <xref ref-type="disp-formula" rid="FD6">(6)</xref> (see also <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref>). We thus aim to estimate which set of model parameters (i.e. <bold><italic>θ</italic></bold> = (<italic>μ</italic>, <italic>σ</italic>, <italic>T</italic>, <italic>λ</italic>)) will generate values of the order parameters (<italic>h</italic>, <italic>q<sub>d</sub></italic>, <italic>q</italic><sub>0</sub>) matching those directly estimated from the data. The solution of such an inference problem may not be unique or exact. We have thus developed an optimization algorithm so to find a pool of possible solutions that minimize the difference between the order parameters estimated by the model and those directly obtained from the data. To infer the parameters <bold><italic>θ</italic></bold>, we can thus use the self-consistent equations for the order parameters and solve the inverse problem to find the dgLV parameters that match the empirical observations. For each self- consistent equation, we can introduce a relative error <italic>δH</italic>(<bold><italic>θ</italic></bold>|<bold><italic>π</italic></bold>) = (<italic>H</italic>(<bold><italic>θ</italic></bold>|<bold><italic>π</italic></bold>) − <italic>h</italic>)/<italic>h</italic>, <italic>δQ<sub>d</sub></italic>(<bold><italic>θ</italic></bold>|<bold><italic>π</italic></bold>) = (<italic>Q<sub>d</sub></italic>(<bold><italic>θ</italic></bold>|<bold><italic>π</italic></bold>) − <italic>q<sub>d</sub></italic>)/<italic>q<sub>d</sub></italic> and <italic>δQ</italic><sub>0</sub>(<bold><italic>θ</italic></bold>|<bold><italic>π</italic></bold>) = (<italic>Q</italic><sub>0</sub>(<bold><italic>θ</italic></bold>|<bold><italic>π</italic></bold>) − <italic>q</italic><sub>0</sub>)/<italic>q</italic><sub>0</sub>. By summing the square of each of these contributions, we introduce the cost function <italic>C</italic> for our moment matching problem, i.e.,</p>
<disp-formula id="FD7">
<alternatives>
<mml:math id="M7" display="block"><mml:mi>C</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>δ</mml:mi><mml:mi>H</mml:mi><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>δ</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>δ</mml:mi><mml:msubsup><mml:mi>Q</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>π</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn7.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(7)</label>
</disp-formula>
<p>As already observed, the cost function has multiple local minima. To explore the rich structure of minima, we adopt a greedy search optimization strategy. First, we generate a vector <bold><italic>θ</italic></bold><sub>0</sub> so that <italic>m</italic><sub>0</sub> = <italic>m</italic>(<bold><italic>θ</italic></bold><sub>0</sub>|<bold><italic>π</italic></bold>) = 1/2 max(<italic>m</italic>) = 1/2. This condition ensures that the starting point of the optimization is far from the unbounded growth phase. In particular, it allows us to randomly generate an initial value of the interactions heterogeneity from a broad range <italic>σ</italic> ∼ Uniform(0,10) and to get the corresponding initial value of the demographic noise by mean of the relation <inline-formula id="ID24">
<alternatives>
<mml:math display="inline" id="I24"><mml:msub><mml:mi>T</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>σ</mml:mi><mml:mn>0</mml:mn><mml:mn>2</mml:mn></mml:msubsup></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq24.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. The other two parameters are randomly drawn, respectively, as <italic>μ</italic> ∼ Uniform(−1,1) and log<sub>10</sub> <italic>λ</italic><sub>0</sub> ∼ Uniform(−8, −3). The choice of the <italic>μ</italic><sub>0</sub> range is justified by the fact that we do not want to bias the interactions to be mutualistic or competitive. Since the unbounded growth phase emerges at <italic>μ</italic><sub>0</sub> = −1 <xref ref-type="bibr" rid="c38">Biroli et al. [2018]</xref>, <xref ref-type="bibr" rid="c36">Bunin [2017]</xref>, one reasonable choice for the initial condition upper bound is <italic>μ</italic><sub>0</sub> = 1. Secondly, <italic>λ</italic><sub>0</sub> is introduced as a regularizing term for the Langevin dynamics and can be considered small: in this way, we can bound its values as described above. Once the initialization is set, we optimize the cost function. To explore the largest set of solutions, we employ the Broyden–Fletcher–Goldfarb–Shanno algorithm provided by the scipy <xref ref-type="bibr" rid="c61">Virtanen et al. [2020]</xref> routine. Briefly, this method allows us to optimize scalar functions of multiple variables using a generalized secant method. Since <italic>𝒞</italic> is flat almost everywhere except in the region where local minima are clustered, other methods tend to provide – with the same initialization procedure – results on the boundary of the optimization region, signaling poor convergence performance when tested for our problem. To explore a large subset of solutions and take the flatness of the cost function into account, we repeat the process 10<sup>5</sup> times and bound the solutions into a region way larger than the initial conditions <italic>μ</italic> ∈ [−1,100], <italic>σ</italic> ∈ [0,10], <italic>T</italic> ∈ [10<sup>−4</sup>, 10<sup>−2</sup>] and <italic>λ</italic> ∈ [10<sup>−9</sup>, 10<sup>−1</sup>]. In the downstream analysis, we only retain the best 30 solutions, minimizing <italic>𝒞</italic>. At the end of the procedure, we obtain a set of parameters <bold><italic>θ</italic></bold> = (<italic>μ</italic>, <italic>σ</italic>, <italic>T</italic>, <italic>λ</italic>) that, if used in the self-consistent equations, are capable of satisfying them with mean relative error <italic>ɛ</italic> = <italic>δH</italic> + <italic>δQ<sub>d</sub></italic> + <italic>δQ</italic><sub>0</sub> of order <italic>ɛ</italic> ≈ 10<sup>−2</sup>, 10<sup>−3</sup>. As a consistency check, we report the value of <italic>λ</italic>* = 2 × 10<sup>−6</sup> ≈ min <italic>N<sub>data</sub></italic> = 9 × 10<sup>−6</sup> (constant for all of the top 30 solutions), which is slightly below the minimum species relative abundance of the data.</p>
</sec>
<sec id="s5-4">
<title>Cavity method for the species abundance distribution</title>
<p>Another powerful technique rooted in disordered systems is the cavity method, which turns out to be particularly convenient for deriving the species abundance distribution at equilibrium. Without demographic noise, the SAD in the single equilibrium phase is typically captured by a truncated Gaussian distribution <xref ref-type="bibr" rid="c62">Yoshino et al. [2008]</xref>, <xref ref-type="bibr" rid="c36">Bunin [2017]</xref>, <xref ref-type="bibr" rid="c63">Altieri and Franz [2019]</xref>. In the presence of noise and finite migration, the computation gets more involved but is still doable within the cavity approach <xref ref-type="bibr" rid="c47">Mezard and Montanari [2009]</xref>. The basic idea consists of adding a new species to the ecosystem and investigating the resulting joint probability distribution of the typical species. In the thermodynamic limit, the difference between a system composed of <italic>S</italic> species and the corresponding one with <italic>S</italic> + 1 species is negligible. Therefore, one can write:</p>
<disp-formula id="FD8">
<alternatives>
<mml:math id="M8" display="block"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>  </mml:mtext><mml:mo>∝</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn8.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(8)</label>
</disp-formula>
<p>By gathering all relevant information about the so-called <italic>cavity field</italic>, <inline-formula id="ID25">
<alternatives>
<mml:math display="inline" id="I25"><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq25.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, and the higher-order correlation term, we obtain the field distribution, which is defined by the two moments</p>
<disp-formula id="FD9">
<alternatives>
<mml:math id="M9" display="block"><mml:mover accent="true"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mi>h</mml:mi><mml:mtext> </mml:mtext><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:mover accent="true"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn9.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(9)</label>
</disp-formula>
<p>For compactness, we skip all technical details at this stage. Proceeding step-by-step – the full derivation can nevertheless be found in the Appendix – we end up writing the expression for the marginal probability distribution:</p>
<disp-formula id="FD10">
<alternatives>
<mml:math id="M10" display="block"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≃</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mi>N</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mi>ζ</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:menclose notation="horizontalstrike"><mml:mi>Z</mml:mi></mml:menclose><mml:mrow><mml:mo>(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mi>λ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>ζ</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2406.07465v2_eqn10.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(10)</label>
</disp-formula>
<p>where <italic>N<sub>c</sub></italic> has been replaced by <italic>N</italic> denoting the typical species abundance, <italic>m</italic> = [1 − <italic>σ</italic><sup>2</sup><italic>β</italic>(<italic>q<sub>d</sub></italic> − <italic>q</italic><sub>0</sub>)] denotes the <italic>mass</italic> term borrowing field-theory terminology, and <italic>ζ</italic> is an auxiliary Gaussian variable.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>We thank Silvia De Monte for insightful discussions. S.S. acknowledges Iniziativa PNC0000002-DARE – Digital Lifelong Prevention. A.M. acknowledges financial support under the National Recovery and Resilience Plan (NRRP), Mission 4, Component 2, Investment 1.1, Call for tender No. 104 by the Italian Ministry of University and Research (MUR), funded by the European Union – NextGenerationEU – Project Title “Emergent Dynamical Patterns of Disordered Systems with Applications to Natural Communities” – CUP 2022WPHMXK - Grant Assignment Decree No. 2022WPHMXK adopted on 19/09/2023 by the Italian Ministry of Ministry of University and Research (MUR). A.A. acknowledges the support received from the Agence Nationale de la Recherche (ANR), under the grant ANR-23-CE30-0012-01 (project “SIDECAR”).</p>
</ack>
<sec id="additional-info" sec-type="additional-information">
<title>Additional information</title>
<sec id="s4">
<title>Author contributions</title>
<p>S.S. and A.A. designed and supervised research, J.P. performed research, E.V.S. and S.F. provided data filtering criteria; all the authors wrote the paper.</p>
</sec>
</sec>
<app-group>
<app id="s6">
<title>Appendices</title>
<sec id="s6-1">
<title>S1. Mapping between MacArthur and Lotka-Volterra Models</title>
<p>We aim to investigate the mapping between the Lokta-Volterra model and the consumer-resource (CR) or MacArthur (MA) dynamics, as analyzed in <xref ref-type="bibr" rid="c64">Tikhonov and Monasson [2017]</xref>, <xref ref-type="bibr" rid="c63">Altieri and Franz [2019]</xref> for a high-dimensional version. We thus consider <xref ref-type="disp-formula" rid="FD1">Eq. (1)</xref> of the main text, which describes the evolution of <italic>S</italic> randomly interacting species. The self-interaction term parameters are the growth rate <italic>r<sub>i</sub></italic>, and the carrying capacity <italic>K<sub>i</sub></italic>, whereas all the inter-species interaction parameters are collected into the matrix <bold><italic>α</italic></bold>. For this argument, we will consider a simplified model version, where stochasticity (a.k.a. effective temperature) and immigration rate are set to zero, leading to a deterministic version, as in <xref ref-type="bibr" rid="c38">Biroli et al. [2018]</xref>. This model describes the dynamics of the relative species abundances <italic>N<sub>i</sub></italic> – previously normalized with respect to the total number of individuals in the pool – according to:</p>
<disp-formula id="FD11">
<alternatives>
<mml:math id="M11" display="block"><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mtext>​ </mml:mtext><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mtext>​ </mml:mtext><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mi>ρ</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn11.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(11)</label>
</disp-formula>
<p>where we have introduced <inline-formula id="ID26">
<alternatives>
<mml:math display="inline" id="I26"><mml:mfrac><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>K</mml:mi><mml:malignmark/><mml:mi>i</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>ρ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>ρ</mml:mi></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq26.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, the proportionality constant between growth rate and carrying capacity. Our goal is to re-derive here a generalized Lotka-Volterra (gLV) model with symmetric interactions and therefore to justify the assumption adopted in the main text. To do that, we introduce the MacArthur model, which describes how <italic>S</italic> species compete to grab <italic>M</italic> available resources. For more details, see also <xref ref-type="bibr" rid="c53">Wu et al. [2021]</xref>. We thus consider the following set of coupled ODEs, describing the joint dynamics of resources abundances <italic>R<sub>α</sub></italic> and species abundances <italic>N<sub>i</sub></italic>:</p>
<disp-formula id="FD12">
<alternatives>
<mml:math id="M12" display="block"><mml:mrow><mml:mo>{</mml:mo><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>β</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>R</mml:mi><mml:mi>β</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mover accent="true"><mml:mi>R</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>f</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>α</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math>
<graphic xlink:href="2406.07465v2_eqn12.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(12)</label>
</disp-formula>
<p>where <inline-formula id="ID27">
<alternatives>
<mml:math display="inline" id="I27"><mml:msub><mml:mi>f</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq27.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> describes resources logistic regulation in the absence of consumer species. The parameters here are the death rate of each species <italic>m<sub>i</sub></italic>, the carrying capacity of each resource <inline-formula id="ID28">
<alternatives>
<mml:math display="inline" id="I28"><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msub></mml:mrow></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq28.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, and the uptake matrix <bold><italic>C</italic></bold>, which describes the consumption or production versus microbial growth inhibition of the resource <italic>β</italic> per unit of time by the species <italic>i</italic>. Each row of the matrix can be considered an <italic>M</italic>-dimensional vector, <inline-formula id="ID29">
<alternatives>
<mml:math display="inline" id="I29"><mml:msub><mml:mover accent="true"><mml:mi>C</mml:mi><mml:mo>→</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq29.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, which we will refer to as the uptake profile of the species <italic>i</italic>. The key point is that such vectors might have negative entries, as it happens in the case of microbial growth inhibition. If the dynamics of resources is much faster than the one of species, we can consider the associated equation in the stationary state. With this approximation, provided that the resources abundance is larger than zero (<italic>R<sub>α</sub></italic> &gt; 0), we can evaluate the stationary value of the resource abundances</p>
<disp-formula id="FD13">
<alternatives>
<mml:math id="M13" display="block"><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>R</mml:mi><mml:mi>α</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>α</mml:mi></mml:msub><mml:mo>−</mml:mo></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>α</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn13.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(13)</label>
</disp-formula>
<p>By plugging the obtained resource abundance in the equation for species dynamics, we precisely recover the <italic>Generalized Lotka-Volterra</italic> model</p>
<disp-formula id="FD14">
<alternatives>
<mml:math id="M14" display="block"><mml:mfrac><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>N</mml:mi><mml:mo>˙</mml:mo></mml:mover><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>β</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>β</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>β</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>β</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>β</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>=</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn14.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(14)</label>
</disp-formula>
<disp-formula id="FD15">
<alternatives>
<mml:math id="M15" display="block"><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>β</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>β</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub><mml:mo>.</mml:mo></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2406.07465v2_eqn15.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(15)</label>
</disp-formula>
<p>(16)</p>
<p>Note that, between the second and third passage, we decomposed the sum over <italic>j</italic> in the diagonal and off-diagonal terms, respectively <italic>j</italic> = <italic>i</italic> and <italic>j</italic> ≠ <italic>i</italic>, then swapped the summation over resources and species. Finally, we have introduced the quantities</p>
<disp-formula id="FD17">
<alternatives>
<mml:math id="M17" display="block"><mml:msubsup><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mrow><mml:mi>M</mml:mi><mml:mi>A</mml:mi></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>β</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mover accent="true"><mml:mi>K</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>β</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>m</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mo>,</mml:mo><mml:mtext> </mml:mtext><mml:msub><mml:mi>A</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>β</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>C</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mo>,</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>C</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mo>,</mml:mo><mml:mi>j</mml:mi></mml:mrow><mml:mi>T</mml:mi></mml:msubsup></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn17.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(17)</label>
</disp-formula>
<p>Since the interactions are expressed as a scalar product between uptake profiles, the derived equations correspond to a gLV model with symmetric interactions.</p>
</sec>
<sec id="s6-2">
<title>S2. Replica formalism for the disordered Generalized Lotka-Volterra model</title>
<p>To obtain a full characterization of the different emergent phases in the disordered Generalized Lotka-Volterra model, we can take advantage of the replica method. Using the replica identity <xref ref-type="bibr" rid="c52">Mézard et al. [1987]</xref>, <xref ref-type="bibr" rid="c48">Altieri and Baity-Jesi [2024]</xref>, i.e. <inline-formula id="ID30">
<alternatives>
<mml:math display="inline" id="I30"><mml:mover accent="true"><mml:mrow><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mi>Z</mml:mi></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:munder><mml:mrow><mml:mi>lim</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mfrac><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:mfrac></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq30.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> – which has been rigorously proven in some specific instances <xref ref-type="bibr" rid="c65">Guerra and Toninelli [2002]</xref>, <xref ref-type="bibr" rid="c66">Panchenko and Talagrand [2007]</xref>, <xref ref-type="bibr" rid="c67">Dia et al. [2016]</xref> – the disordered average is directly computed on the replicated partition function, for <italic>n</italic> replicas of the same sample. The index <italic>n</italic> is initially treated as an integer, however relying on the assumption that the analytical continuation <italic>n</italic> → 0 exists.</p>
<disp-formula id="FD18">
<alternatives>
<mml:math id="M18" display="block"><mml:mover accent="true"><mml:mrow><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>/</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2406.07465v2_eqn18.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(18)</label>
</disp-formula>
<p>where <italic>β</italic> = 1/<italic>T</italic> is the inverse of the demographic noise amplitude. The overline <inline-formula id="ID31">
<alternatives>
<mml:math display="inline" id="I31"><mml:mover accent="true"><mml:mo>⋅</mml:mo><mml:mo>¯</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq31.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> in the partition function denotes the average over the disorder, namely over the Gaussian variables <italic>α<sub>ij</sub></italic> with finite mean <italic>μ</italic>/<italic>S</italic> and variance <italic>σ</italic><sup>2</sup>/<italic>S</italic>. The index <italic>a</italic> takes the number of replicas into account, with <italic>a</italic> = 1,…, <italic>n</italic>.</p>
<p>The analytical treatment requires the introduction of the overlap matrix, <italic>Q<sub>ab</sub></italic> – whose diagonal value is <inline-formula id="ID32">
<alternatives>
<mml:math display="inline" id="I32"><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq32.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> <inline-formula id="ID33">
<alternatives>
<mml:math display="inline" id="I33"><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq33.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, which can be easily parametrized in the replica space, as well as the average abundance <inline-formula id="ID34">
<alternatives>
<mml:math display="inline" id="I34"><mml:msub><mml:mi>h</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>S</mml:mi></mml:munderover><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq34.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> For the latter, we will consider the uniformity condition, with <italic>h<sub>a</sub></italic> = <italic>h</italic>, Ɐ<italic>a</italic>. We can thus re-express the free energy as a function of the aforementioned order parameters</p>
<disp-formula id="FD19">
<alternatives>
<mml:math id="M19" display="block"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:mrow></mml:mfrac><mml:mi>ln</mml:mi><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mi>d</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mi>a</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2406.07465v2_eqn19.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(19)</label>
</disp-formula>
<p>which remains, at this level, as general as possible. The action <italic>𝒜</italic> reads</p>
<disp-formula id="FD20">
<alternatives>
<mml:math id="M20" display="block"><mml:mi>A</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>a</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo></mml:mrow></mml:mstyle><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mn>4</mml:mn></mml:mfrac></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mi>ρ</mml:mi><mml:mi>μ</mml:mi><mml:mi>β</mml:mi><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac></mml:mrow></mml:mstyle><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>S</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mi>ln</mml:mi><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>,</mml:mo></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2406.07465v2_eqn20.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(20)</label>
</disp-formula>
<p>to be eventually evaluated by the Laplace method, or saddle-point approximation, in the large <italic>S</italic> limit.</p>
<p>By resorting to the replica-symmetric (RS) ansatz – according to which the overlap matrix is parametrized by two values only, <italic>q<sub>d</sub></italic> and <italic>q</italic><sub>0</sub>, the diagonal value or self-overlap, and the off-diagonal value, respectively – the last piece in <xref ref-type="disp-formula" rid="FD20">Eq. (20)</xref> can be expressed as a function of an effective Hamiltonian <inline-formula id="ID35">
<alternatives>
<mml:math display="inline" id="I35"><mml:msub><mml:mo>ℋ</mml:mo><mml:mrow><mml:mtext>eff</mml:mtext></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq35.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. It essentially embeds the contribution of the quadratic Lotka-Volterra potential and the additional Lagrange multipliers enforcing the above expressions for <italic>Q<sub>ab</sub></italic>, <italic>Q<sub>aa</sub></italic> and <italic>h<sub>a</sub></italic>.</p>
<disp-formula id="FD21">
<alternatives>
<mml:math id="M21" display="block"><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>e</mml:mi><mml:mi>f</mml:mi><mml:mi>f</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>β</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo></mml:mrow></mml:mstyle><mml:mfrac><mml:mrow><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>β</mml:mi></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:mi>ρ</mml:mi><mml:mi>μ</mml:mi></mml:mrow></mml:mstyle><mml:mi>h</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:mi>ln</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2406.07465v2_eqn21.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(21)</label>
</disp-formula>
<p>The free energy is thus re-written as <inline-formula id="ID36">
<alternatives>
<mml:math display="inline" id="I36"><mml:mi>F</mml:mi><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mi>lim</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mtext> </mml:mtext><mml:mi>ln</mml:mi><mml:mo>⁡</mml:mo><mml:mtext> </mml:mtext><mml:msup><mml:mi>Z</mml:mi><mml:mi>n</mml:mi></mml:msup><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:munder><mml:mrow><mml:mi>lim</mml:mi><mml:mo>⁡</mml:mo></mml:mrow><mml:mrow><mml:mi>n</mml:mi><mml:mo>→</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:munder><mml:mtext> </mml:mtext><mml:mi>𝒜</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>h</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>n</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq36.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. However, integrating the quenched disorder out implies a further complication: replica indices turn out to be coupled, as is evident in the second term above. The next step will then require the introduction of an auxiliary Gaussian variable z, with zero mean and unit variance so that:</p>
<disp-formula id="FD22">
<alternatives>
<mml:math id="M22" display="block"><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mstyle><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>Z</mml:mi><mml:mi>i</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>/</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mrow></mml:msup><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∏</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:munderover><mml:mrow><mml:mi>d</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>;</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:msup></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn22.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(22)</label>
</disp-formula>
<p>with the associated replica symmetric Hamiltonian:</p>
<disp-formula id="FD23">
<alternatives>
<mml:math id="M23" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mi>μ</mml:mi><mml:mi>h</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>ρ</mml:mi><mml:msqrt><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ln</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>                           </mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mi>μ</mml:mi><mml:mi>h</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>ρ</mml:mi><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ln</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2406.07465v2_eqn23.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(23)</label>
</disp-formula>
<p>Note that, although in the computation above we have considered a species-dependent <italic>K<sub>i</sub></italic> to be as general as possible, in our work we have assumed <italic>K<sub>i</sub></italic> = <italic>K</italic> for all species. The full expressions of the parameters <italic>h</italic>, <italic>q</italic><sub>0</sub>, and <italic>q<sub>d</sub></italic>, to be obtained by a saddle-point approximation of the RS free energy have been reported in the Methods. They can be solved iteratively as also explained in <xref ref-type="bibr" rid="c39">Altieri et al. [2021]</xref>, <xref ref-type="bibr" rid="c40">Lorenzana and Altieri [2022]</xref>.</p>
<sec id="s6-2-1">
<title>Comment on compositional abundances</title>
<p>For purely theoretical purposes, dealing with absolute or relative abundances makes little difference. However, for the metagenomics data available to us, it is essential to perform the analysis as a function of relative abundances. Forcing the abundances to be normalized is formally equivalent to adding a global constraint in the Hamiltonian such that <inline-formula id="ID37">
<alternatives>
<mml:math display="inline" id="I37"><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mstyle></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq37.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> through the Lagrange multiplier <italic>γ</italic>. Accordingly, the original partition function can be recast as</p>
<disp-formula id="FD24">
<alternatives>
<mml:math id="M24" display="block"><mml:mover accent="true"><mml:mi>Z</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>j</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>i</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mi>μ</mml:mi><mml:mo>/</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>/</mml:mo><mml:mi>S</mml:mi></mml:mrow></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>i</mml:mi><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mi>d</mml:mi><mml:mi>γ</mml:mi><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mi>H</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn24.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(24)</label>
</disp-formula>
<p>The procedure explained above remains exactly the same along with the introduction of <italic>n</italic> replicas of the reference system. Optimizing over <italic>Q<sub>ab</sub></italic>, <italic>H<sub>a</sub></italic>, and the parameter <italic>γ<sub>a</sub></italic> things get easier within the RS approximation. In fact, <italic>γ<sub>a</sub></italic> = <italic>γ</italic>, satisfying a uniformity condition for all replicas. The only visible difference is in the linear term of (23) which now incorporates the explicit dependence on the multiplier <italic>γ</italic> leading to</p>
<disp-formula id="FD25">
<alternatives>
<mml:math id="M25" display="block"><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>,</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mo>−</mml:mo><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ρ</mml:mi><mml:mi>μ</mml:mi><mml:mi>h</mml:mi><mml:mo>−</mml:mo><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>ρ</mml:mi><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:msub><mml:mi>K</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mi>γ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ln</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn25.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(25)</label>
</disp-formula>
<p>We have already discussed in the text how the <italic>μ</italic> parameter does not play a significant role in determining the different phases, confirming prior results by Bunin and collaborators <xref ref-type="bibr" rid="c36">Bunin [2017]</xref>, <xref ref-type="bibr" rid="c40">Lorenzana and Altieri [2022]</xref>. Once more, we can safely claim that the actual differences and emerging data clustering between healthy and sick samples are driven by the noise amplitude <italic>T</italic> and the interaction heterogeneity <italic>σ</italic>.</p>
</sec>
</sec>
<sec id="s6-3">
<title>S3. Stability analysis: Hessian matrix and zero modes</title>
<p>To properly understand the stability of the single equilibrium phase and highlight possibly emergent multiple attractor regimes, we need to perform a stability computation. Computing the stability against external perturbations requires first the definition of the replicated partition function:</p>
<disp-formula id="FD26">
<alternatives>
<mml:math id="M26" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>Z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mo>&lt;</mml:mo><mml:mi>b</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>b</mml:mi></mml:msubsup><mml:mo>+</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mfrac><mml:mrow><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>a</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mi>ρ</mml:mi><mml:mi>β</mml:mi><mml:mi>μ</mml:mi><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup><mml:msup><mml:mi>h</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:msub><mml:mi>V</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>      </mml:mtext><mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>a</mml:mi></mml:munder><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>ln</mml:mi><mml:msubsup><mml:mi>N</mml:mi><mml:mi>i</mml:mi><mml:mi>a</mml:mi></mml:msubsup></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2406.07465v2_eqn26.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(26)</label>
</disp-formula>
<p>then the study the harmonic fluctuation of the free energy around the RS solution. For the latter, the Hessian matrix of the action <italic>𝒜</italic> is needed</p>
<disp-formula id="FD27">
<alternatives>
<mml:math id="M27" display="block"><mml:msub><mml:mi>Μ</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>≡</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>A</mml:mi></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>∂</mml:mo><mml:msub><mml:mi>Q</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>δ</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>ρ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:mo>,</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msup><mml:msup><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2406.07465v2_eqn27.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(27)</label>
</disp-formula>
<p>where the subscript <inline-formula id="ID38">
<alternatives>
<mml:math display="inline" id="I38"><mml:msub><mml:mrow><mml:mo>〈</mml:mo><mml:mo>⋅</mml:mo><mml:mo>〉</mml:mo></mml:mrow><mml:mi>c</mml:mi></mml:msub></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq38.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> denotes the connected part of the correlation function. Leveraging well-known techniques in field theory and disordered systems <xref ref-type="bibr" rid="c68">De Dominicis and Giardina [2006]</xref>, we decompose the Hessian matrix [27] as a function of three different correlators among which the one living in the replicon subspace <xref ref-type="bibr" rid="c68">De Dominicis and Giardina [2006]</xref>, <xref ref-type="bibr" rid="c69">Altieri et al. [2016]</xref> provides the leading contribution:</p>
<disp-formula id="FD28">
<alternatives>
<mml:math id="M28" display="block"><mml:mi>ℜ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>ρ</mml:mi><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>ρ</mml:mi><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn28.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(28)</label>
</disp-formula>
<p>Three different elements appear in the computation depending on the constraint/equality condition of their replica indices</p>
<disp-formula id="FD29">
<alternatives>
<mml:math id="M29" display="block"><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>b</mml:mi></mml:mrow></mml:msub><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>a</mml:mi><mml:mi>c</mml:mi></mml:mrow></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mover accent="true"><mml:mi>M</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mrow><mml:mi>a</mml:mi><mml:mi>b</mml:mi><mml:mo>,</mml:mo><mml:mi>c</mml:mi><mml:mi>d</mml:mi></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:msup><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:msup><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mi>a</mml:mi></mml:msup><mml:msup><mml:mi>N</mml:mi><mml:mi>b</mml:mi></mml:msup><mml:msup><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msup><mml:msup><mml:mi>N</mml:mi><mml:mi>d</mml:mi></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn29.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(29)</label>
</disp-formula>
<p>Sticking to a single-equilibrium regime, namely in the RS approximation, the expression for the replicon eigenvalue can be further simplified</p>
<disp-formula id="FD30">
<alternatives>
<mml:math id="M30" display="block"><mml:mi>ℜ</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>ρ</mml:mi><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>β</mml:mi><mml:mi>ρ</mml:mi><mml:mi>σ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mover accent="true"><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn30.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(30)</label>
</disp-formula>
<p>which precisely corresponds to <xref ref-type="disp-formula" rid="FD3">Eq. (3)</xref> of the main text. A strictly positive or a vanishing value of the replicon are associated with a stable or marginally stable phase, respectively. In the second case, the RS ansatz is no longer valid and requires the use of a one-step or multiple-step replica-symmetry breaking.</p>
</sec>
<sec id="s6-5">
<title>S4. Cavity argument for the species abundance distribution</title>
<p>In the absence of demographic fluctuations and immigration, it is well-known that the species abundance distribution reflects a truncated Gaussian <xref ref-type="bibr" rid="c62">Yoshino et al. [2008]</xref>, <xref ref-type="bibr" rid="c36">Bunin [2017]</xref>, <xref ref-type="bibr" rid="c64">Tikhonov and Monasson [2017]</xref>, <xref ref-type="bibr" rid="c40">Lorenzana and Altieri [2022]</xref>. Albeit the computation gets more complicated in the presence of demographic noise, we can nevertheless employ the cavity method <xref ref-type="bibr" rid="c47">Mezard and Montanari [2009]</xref>, <xref ref-type="bibr" rid="c60">Zamponi [2010]</xref>, <xref ref-type="bibr" rid="c48">Altieri and Baity-Jesi [2024]</xref> to obtain the single-species marginal probability distribution. Based on a cavity argument, we pretend to add a new species to the ecosystem and eventually investigate the resulting joint probability distribution. In the thermodynamic limit, for <italic>S</italic> ≫ 1, it reads</p>
<disp-formula id="FD31">
<alternatives>
<mml:math id="M31" display="block"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:msub><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2406.07465v2_eqn31.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(31)</label>
</disp-formula>
<p>where, for the sake of simplicity, we have assumed the carrying capacities to be species-independent, i.e. <italic>K<sub>i</sub></italic> = <italic>K</italic>.</p>
<p>The last piece in parentheses denotes the <italic>cavity field</italic>, <inline-formula id="ID39">
<alternatives>
<mml:math display="inline" id="I39"><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq39.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> which, as long as the single equilibrium phase is concerned, can be assumed to be a Gaussian random variable. The probability distribution is formally factorized and the only coupling with the new species occurs via <italic>h<sub>c</sub></italic>:</p>
<disp-formula id="FD32">
<alternatives>
<mml:math id="M32" display="block"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:munder><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msub><mml:mi>P</mml:mi><mml:mi>S</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>≠</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2406.07465v2_eqn32.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(32)</label>
</disp-formula>
<p>The probability distribution conditioned to <italic>h<sub>c</sub></italic> then reads:</p>
<disp-formula id="FD33">
<alternatives>
<mml:math id="M33" display="block"><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>∝</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn33.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(33)</label>
</disp-formula>
<p>where the thermal and the disordered averages of the cavity field, <italic>h<sub>c</sub></italic>, must eventually be evaluated. Furthermore, to go beyond a naïve mean-field approximation, we need to subtract the background effect exerted by all other species on the picked one through an <italic>Onsager reaction term</italic>.</p>
<disp-formula id="FD34">
<alternatives>
<mml:math id="M34" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mrow><mml:mo>+</mml:mo><mml:mi>∞</mml:mi></mml:mrow></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:mi>var</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac></mml:mrow></mml:mrow></mml:mstyle><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mn>1</mml:mn><mml:mi>T</mml:mi></mml:mfrac><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mn>2</mml:mn></mml:mfrac><mml:mo>−</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>exp</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>var</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>                    </mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>Z</mml:mi></mml:mfrac><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>var</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>K</mml:mi><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2406.07465v2_eqn34.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(34)</label>
</disp-formula>
<p>In the above expression, <inline-formula id="ID40">
<alternatives>
<mml:math display="inline" id="I40"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq40.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> and <inline-formula id="ID41">
<alternatives>
<mml:math display="inline" id="I41"><mml:mi>var</mml:mi><mml:mo>⁡</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msubsup><mml:mi>h</mml:mi><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msubsup></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msup><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq41.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> stand respectively for the first moment and the variance of the field with respect to the thermal average, in the thermodynamic limit. The normalization, <italic>Z</italic>, can formally be expressed as a combination of error and hypergeometric functions as follows</p>
<disp-formula id="FD35">
<alternatives>
<mml:math id="M35" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>Z</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mn>0</mml:mn><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>var</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>K</mml:mi><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mn>2</mml:mn><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mi>T</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>    </mml:mtext><mml:mo>=</mml:mo><mml:msup><mml:mn>2</mml:mn><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>var</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msup><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>H</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>F</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mi>λ</mml:mi><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>var</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo></mml:mrow></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>    </mml:mtext><mml:mo>+</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo>+</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msqrt><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>var</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:mrow><mml:mrow><mml:mi>G</mml:mi><mml:mi>a</mml:mi><mml:mi>m</mml:mi><mml:mi>m</mml:mi><mml:mi>a</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mi>H</mml:mi><mml:mi>y</mml:mi><mml:mi>p</mml:mi><mml:mi>e</mml:mi><mml:mi>r</mml:mi><mml:mi>g</mml:mi><mml:mi>e</mml:mi><mml:mi>o</mml:mi><mml:mi>m</mml:mi><mml:mi>e</mml:mi><mml:mi>t</mml:mi><mml:mi>r</mml:mi><mml:mi>i</mml:mi><mml:mi>c</mml:mi><mml:mi>F</mml:mi><mml:mn>1</mml:mn><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>T</mml:mi><mml:mo>+</mml:mo><mml:mi>λ</mml:mi></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>T</mml:mi></mml:mrow></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mo>,</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>T</mml:mi><mml:mo>−</mml:mo><mml:mi>var</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msub><mml:mi>h</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2406.07465v2_eqn35.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(35)</label>
</disp-formula>
<p>The next step requires the computation of the disordered average. By doing so, we end up with the distribution of the second field, which is defined in terms of the two moments:</p>
<disp-formula id="FD36">
<alternatives>
<mml:math id="M36" display="block"><mml:mover accent="true"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mi>j</mml:mi></mml:munder><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mi>μ</mml:mi><mml:mi>h</mml:mi><mml:mtext>  </mml:mtext><mml:mo>,</mml:mo><mml:mtext>  </mml:mtext><mml:mover accent="true"><mml:mrow><mml:msup><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>j</mml:mi><mml:mo>,</mml:mo><mml:mi>k</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mover accent="true"><mml:mrow><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>i</mml:mi></mml:mrow></mml:msub><mml:msub><mml:mi>α</mml:mi><mml:mrow><mml:mi>c</mml:mi><mml:mi>j</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow></mml:mstyle><mml:mover accent="true"><mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow><mml:mrow><mml:mo>〈</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>j</mml:mi></mml:msub></mml:mrow><mml:mo>〉</mml:mo></mml:mrow></mml:mrow><mml:mo stretchy="true">¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn36.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(36)</label>
</disp-formula>
<p>A similar derivation was obtained in the case of a generalized Lotka-Volterra model with noise to be compared with numerical distributions in different regimes <xref ref-type="bibr" rid="c53">Wu et al. [2021]</xref>. The resulting species abundance distribution typically exhibits a divergence at <italic>N</italic> = 0 and a secondary maximum, therefore closer to what is referred to as <italic>niche scenario</italic>.</p>
<p>Then, by introducing a rescaled random variable <italic>ζ</italic> and integrating over it, the marginal probability distribution becomes</p>
<disp-formula id="FD37">
<alternatives>
<mml:math id="M37" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mi>S</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>∞</mml:mi></mml:mrow><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>ζ</mml:mi></mml:mrow><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mrow></mml:mfrac><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>−</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>h</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:menclose notation="horizontalstrike"><mml:mi>Z</mml:mi></mml:menclose><mml:mrow><mml:mo>(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mrow><mml:mi>λ</mml:mi><mml:mo>/</mml:mo><mml:mi>T</mml:mi></mml:mrow></mml:mrow></mml:msubsup></mml:mrow></mml:mfrac><mml:mi>exp</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mi>c</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>d</mml:mi></mml:msub><mml:mo>−</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:msub><mml:mi>N</mml:mi><mml:mi>c</mml:mi></mml:msub><mml:mi>ζ</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>                    </mml:mtext><mml:mo>→</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi>D</mml:mi><mml:mi>ζ</mml:mi><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:menclose notation="horizontalstrike"><mml:mi>Z</mml:mi></mml:menclose><mml:mrow><mml:mo>(</mml:mo><mml:mi>ζ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:msup><mml:mi>N</mml:mi><mml:mrow><mml:mi>β</mml:mi><mml:mi>λ</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:mi>exp</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mfrac><mml:mi>β</mml:mi><mml:mn>2</mml:mn></mml:mfrac><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>m</mml:mi><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>ζ</mml:mi><mml:mi>N</mml:mi></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2406.07465v2_eqn37.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(37)</label>
</disp-formula>
<p>where <italic>N<sub>c</sub></italic> is just replaced by <italic>N</italic> denoting the typical species abundance and <italic>T</italic> → 1/<italic>β</italic>. The expression for the normalization is roughly similar to the one in <xref ref-type="disp-formula" rid="FD34">Eq. (34)</xref> with the only difference being that the mean and the variance of the cavity field must be replaced by the quenched average of <inline-formula id="ID42">
<alternatives>
<mml:math display="inline" id="I42"><mml:mover accent="true"><mml:mi>h</mml:mi><mml:mo>˜</mml:mo></mml:mover></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq42.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> and <italic>σ</italic><sup>2</sup> (<italic>q<sub>d</sub></italic> − <italic>q</italic><sub>0</sub>), respectively.</p>
</sec>
<sec id="s6-6">
<title>S5. Estimation of Neutral and Niche processes</title>
<p>Following the results of the cavity method in Section 5, we can describe the species abundance distribution of the system (see <xref ref-type="disp-formula" rid="FD37">Eq. (37)</xref>) via the quantities <italic>ν</italic> = <italic>βλ</italic> &gt; 0, the quadratic coefficient <italic>m</italic> = 1 − <italic>σ</italic><sup>2</sup><italic>β</italic>(<italic>q<sub>d</sub></italic> − <italic>q</italic><sub>0</sub>) and the disorder variable <inline-formula id="ID43">
<alternatives>
<mml:math display="inline" id="I43"><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>h</mml:mi><mml:mo>+</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi><mml:mi>z</mml:mi></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq43.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>, where <italic>z</italic> is a standardized normal variable.</p>
<p>As we specified in the main text, we refer to the quadratic coefficient <italic>m</italic> as a mass. When the mass becomes negative, the self-consistent equations <xref ref-type="disp-formula" rid="FD6">(6)</xref> in the Methods section are no longer well-defined, and the order parameters diverge. This signals a transition to an unbounded growth regime.</p>
<p>So far, the obtained SAD is flexible enough to accommodate different qualitative shapes frequently appearing in theoretical ecology <xref ref-type="bibr" rid="c14">Azaele et al. [2016]</xref>. When <italic>ν</italic> &gt; 1, the migration strength turns out to be stronger than demographic fluctuations and the distribution resembles a modal log-normal. On the other hand, when 0 &lt; <italic>ν</italic> &lt; 1 demographic noise overcomes immigration, and a low-abundance (integrable) divergence appears. In our case, <italic>ν</italic> ≈ 10<sup>−3</sup>, so demographic noise is much stronger than immigration.</p>
<p>When the divergence in zero appears, two further shapes are possible. If there exists a secondary extremum for the species abundance distribution, then there is an coexistence of niche (driven by species interactions) and neutral (driven by demographic noise) effects. Conversely, if no secondary extrema exist, birth and death effects are the key drivers of the dynamics. In our interpretation of the model, the species abundance distribution is the stationary distribution of a <italic>single</italic> realization of the Lotka-Volterra dynamics. Given a set of parameters <bold><italic>θ</italic></bold> = (<italic>μ</italic>, <italic>σ</italic>, <italic>β</italic>, <italic>λ</italic>), it is possible to evaluate how many realizations of the Lotka-Volterra dynamics will display a secondary extremum. Taking the form of a fraction, we introduce a quantity <italic>ψ</italic> that captures the chance of displaying such an extremum and measures the relative contribution between selective and neutral effects. Namely, we can evaluate the probability that ℋ<sub>RS</sub> has a minimum different from zero:</p>
<disp-formula id="FD38">
<alternatives>
<mml:math id="M38" display="block"><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mn>0</mml:mn><mml:mo>→</mml:mo><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mrow><mml:mi>β</mml:mi><mml:mi>N</mml:mi></mml:mrow></mml:mfrac><mml:mo>+</mml:mo><mml:mi>m</mml:mi><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mi>ζ</mml:mi><mml:mo>=</mml:mo><mml:mn>0.</mml:mn></mml:math>
<graphic xlink:href="2406.07465v2_eqn38.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(38)</label>
</disp-formula>
<p>Being an algebraic equation of degree two, it has two solutions <inline-formula id="ID44">
<alternatives>
<mml:math display="inline" id="I44"><mml:msubsup><mml:mi>N</mml:mi><mml:mo>±</mml:mo><mml:mo>*</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:msqrt><mml:mrow><mml:msup><mml:mi>ζ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>−</mml:mo><mml:mn>4</mml:mn><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>/</mml:mo><mml:mi>β</mml:mi></mml:mrow></mml:msqrt></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:mi>m</mml:mi></mml:mrow></mml:mfrac></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq44.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. Introducing <inline-formula id="ID45">
<alternatives>
<mml:math display="inline" id="I45"><mml:mi>ζ</mml:mi><mml:mo>*</mml:mo><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>m</mml:mi></mml:mrow><mml:mi>β</mml:mi></mml:mfrac></mml:mrow></mml:msqrt></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq45.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> the condition for the local extrema to appear if <inline-formula id="ID46">
<alternatives>
<mml:math display="inline" id="I46"><mml:msup><mml:mi>ζ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&gt;</mml:mo><mml:mfrac><mml:mrow><mml:mn>4</mml:mn><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>ν</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>β</mml:mi></mml:mfrac><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>*</mml:mo></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>&gt;</mml:mo><mml:mn>0</mml:mn></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq46.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. This probability amounts to</p>
<disp-formula id="FD39">
<alternatives>
<mml:math id="M39" display="block"><mml:mi>ψ</mml:mi><mml:mo>=</mml:mo><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:msup><mml:mi>ζ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mo>&gt;</mml:mo><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mi>ζ</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>&gt;</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>ℙ</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>&lt;</mml:mo><mml:mo>−</mml:mo><mml:msup><mml:mi>ζ</mml:mi><mml:mo>∗</mml:mo></mml:msup></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>Erfc</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>ζ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>+</mml:mo><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:mi>Erfc</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mi>ζ</mml:mi><mml:mo>∗</mml:mo></mml:msup><mml:mo>−</mml:mo><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo stretchy="true">¯</mml:mo></mml:mover></mml:mrow><mml:mrow><mml:msqrt><mml:mn>2</mml:mn></mml:msqrt><mml:msub><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2406.07465v2_eqn39.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(39)</label>
</disp-formula>
<p>where <inline-formula id="ID47">
<alternatives>
<mml:math display="inline" id="I47"><mml:mover accent="true"><mml:mi>ζ</mml:mi><mml:mo>¯</mml:mo></mml:mover><mml:mo>=</mml:mo><mml:mi>K</mml:mi><mml:mo>−</mml:mo><mml:mi>μ</mml:mi><mml:mi>h</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>σ</mml:mi><mml:mi>ζ</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msqrt><mml:mi>σ</mml:mi></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq47.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> are the moments of the variable tracking the different disorder realizations. When the quantity <italic>ψ</italic> is of order 1, niche and neutral contributions to the dynamics can be considered comparable. In principle, we should check which of the two ± solutions is actually a maximum. The convexity of the SAD is easy to evaluate:</p>
<disp-formula id="FD40">
<alternatives>
<mml:math id="M40" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mi>ζ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:mi>N</mml:mi><mml:mo>=</mml:mo><mml:msubsup><mml:mi>N</mml:mi><mml:mo>±</mml:mo><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo>=</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>                        </mml:mtext><mml:mo>=</mml:mo><mml:msub><mml:mrow><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msup><mml:mo>∂</mml:mo><mml:mn>2</mml:mn></mml:msup><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:msup><mml:mi>N</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>β</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mo>∂</mml:mo><mml:msub><mml:mi>ℋ</mml:mi><mml:mrow><mml:mi>R</mml:mi><mml:mi>S</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mo>∂</mml:mo><mml:mi>N</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mrow><mml:mo>|</mml:mo></mml:mrow><mml:mrow><mml:msubsup><mml:mi>N</mml:mi><mml:mo>±</mml:mo><mml:mo>∗</mml:mo></mml:msubsup></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mn>2</mml:mn><mml:mi>m</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>+</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>y</mml:mi></mml:mfrac><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>∓</mml:mo><mml:msqrt><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:mi>y</mml:mi></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&lt;</mml:mo><mml:mn>0</mml:mn></mml:mrow></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2406.07465v2_eqn40.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
<label>(40)</label>
</disp-formula>
<p>where <inline-formula id="ID48">
<alternatives>
<mml:math display="inline" id="I48"><mml:mi>y</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>ζ</mml:mi><mml:mo>*</mml:mo></mml:mrow><mml:mi>ζ</mml:mi></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mn>2</mml:mn></mml:msup></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq48.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>. From the first inequality, straightforward algebraic manipulations confirm that <inline-formula id="ID49">
<alternatives>
<mml:math display="inline" id="I49"><mml:msubsup><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq49.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> is the stable solution. Intuitively, since <italic>P</italic>(<italic>N</italic>|<italic>ζ</italic>) has a divergence in zero, any secondary maximum <inline-formula id="ID50">
<alternatives>
<mml:math display="inline" id="I50"><mml:msubsup><mml:mi>N</mml:mi><mml:mo>+</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq50.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula> – if it exists – must be greater than the minimum <inline-formula id="ID51">
<alternatives>
<mml:math display="inline" id="I51"><mml:msubsup><mml:mi>N</mml:mi><mml:mo>−</mml:mo><mml:mo>*</mml:mo></mml:msubsup></mml:math>
<inline-graphic xlink:href="2406.07465v2_ieq51.tif" mime-subtype="tif" mimetype="image"/>
</alternatives>
</inline-formula>.</p>
</sec>
</app>
</app-group>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Maayan</given-names> <surname>Levy</surname></string-name>, <string-name><given-names>Christoph A</given-names> <surname>Thaiss</surname></string-name>, and <string-name><given-names>Eran</given-names> <surname>Elinav</surname></string-name></person-group>. <article-title>Metabolites: messengers between the microbiota and the immune system</article-title>. <source>Genes &amp; development</source>, <volume>30</volume>(<issue>14</issue>):<fpage>1589</fpage>–<lpage>1597</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>João</given-names> <surname>Barroso-Batista</surname></string-name>, <string-name><given-names>Jocelyne</given-names> <surname>Demengeot</surname></string-name>, and <string-name><given-names>Isabel</given-names> <surname>Gordo</surname></string-name></person-group>. <article-title>Adaptive immunity increases the pace and predictability of evolutionary change in commensal gut bacteria</article-title>. <source>Nature communications</source>, <volume>6</volume>(<issue>1</issue>):<fpage>8945</fpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Hugo C</given-names> <surname>Barreto</surname></string-name> and <string-name><given-names>Isabel</given-names> <surname>Gordo</surname></string-name></person-group>. <article-title>Intrahost evolution of the gut microbiota</article-title>. <source>Nature Reviews Microbiology</source>, <volume>21</volume>(<issue>9</issue>): <fpage>590</fpage>–<lpage>603</lpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jason</given-names> <surname>Lloyd-Price</surname></string-name>, <string-name><given-names>Cesar</given-names> <surname>Arze</surname></string-name>, <string-name><given-names>Ashwin N</given-names> <surname>Ananthakrishnan</surname></string-name>, <string-name><given-names>Melanie</given-names> <surname>Schirmer</surname></string-name>, <string-name><given-names>Julian</given-names> <surname>Avila-Pacheco</surname></string-name>, <string-name><given-names>Tiffany W</given-names> <surname>Poon</surname></string-name>, <string-name><given-names>Elizabeth</given-names> <surname>Andrews</surname></string-name>, <string-name><given-names>Nadim J</given-names> <surname>Ajami</surname></string-name>, <string-name><given-names>Kevin S</given-names> <surname>Bonham</surname></string-name>, <string-name><given-names>Colin J</given-names> <surname>Brislawn</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Multi-omics of the gut microbial ecosystem in inflammatory bowel diseases</article-title>. <source>Nature</source>, <volume>569</volume>(<issue>7758</issue>):<fpage>655</fpage>–<lpage>662</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Bhabatosh</given-names> <surname>Das</surname></string-name> and <string-name><given-names>G</given-names> <surname>Balakrish Nair</surname></string-name></person-group>. <article-title>Homeostasis and dysbiosis of the gut microbiome in health and disease</article-title>. <source>Journal of biosciences</source>, <volume>44</volume>:<fpage>1</fpage>–<lpage>8</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Atsushi</given-names> <surname>Nishida</surname></string-name>, <string-name><given-names>Ryo</given-names> <surname>Inoue</surname></string-name>, <string-name><given-names>Osamu</given-names> <surname>Inatomi</surname></string-name>, <string-name><given-names>Shigeki</given-names> <surname>Bamba</surname></string-name>, <string-name><given-names>Yuji</given-names> <surname>Naito</surname></string-name>, and <string-name><given-names>Akira</given-names> <surname>Andoh</surname></string-name></person-group>. <article-title>Gut microbiota in the pathogenesis of inflammatory bowel disease</article-title>. <source>Clinical journal of gastroenterology</source>, <volume>11</volume>:<fpage>1</fpage>–<lpage>10</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Qinglong</given-names> <surname>Zeng</surname></string-name>, <string-name><given-names>Jeet</given-names> <surname>Sukumaran</surname></string-name>, <string-name><given-names>Steven</given-names> <surname>Wu</surname></string-name>, and <string-name><given-names>Allen</given-names> <surname>Rodrigo</surname></string-name></person-group>. <article-title>Neutral models of microbiome evolution</article-title>. <source>PLoS computational biology</source>, <volume>11</volume>(<issue>7</issue>):<elocation-id>e1004365</elocation-id>, <year>2015</year>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Arvind</given-names> <surname>Venkataraman</surname></string-name>, <string-name><given-names>Christine M</given-names> <surname>Bassis</surname></string-name>, <string-name><given-names>James M</given-names> <surname>Beck</surname></string-name>, <string-name><given-names>Vincent B</given-names> <surname>Young</surname></string-name>, <string-name><given-names>Jeffrey L</given-names> <surname>Curtis</surname></string-name>, <string-name><given-names>Gary B</given-names> <surname>Huffnagle</surname></string-name>, and <string-name><given-names>Thomas M</given-names> <surname>Schmidt</surname></string-name></person-group>. <article-title>Application of a neutral community model to assess structuring of the human lung microbiome</article-title>. <source>MBio</source>, <volume>6</volume>(<issue>1</issue>):<fpage>10</fpage>–<lpage>1128</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Claudia</given-names> <surname>Sala</surname></string-name>, <string-name><given-names>Silvia</given-names> <surname>Vitali</surname></string-name>, <string-name><given-names>Enrico</given-names> <surname>Giampieri</surname></string-name>, <string-name><given-names>Ìtalo</given-names> <surname>Faria do Valle</surname></string-name>, <string-name><given-names>Daniel</given-names> <surname>Remondini</surname></string-name>, <string-name><given-names>Paolo</given-names> <surname>Garagnani</surname></string-name>, <string-name><given-names>Matteo</given-names> <surname>Bersanelli</surname></string-name>, <string-name><given-names>Ettore</given-names> <surname>Mosca</surname></string-name>, <string-name><given-names>Luciano</given-names> <surname>Milanesi</surname></string-name>, and <string-name><given-names>Gastone</given-names> <surname>Castellani</surname></string-name></person-group>. <article-title>Stochastic neutral modelling of the gut microbiota’s relative species abundance from next generation sequencing data</article-title>. <source>BMC bioinformatics</source>, <volume>17</volume>(<issue>2</issue>):<fpage>179</fpage>–<lpage>188</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Michael</given-names> <surname>Sieber</surname></string-name>, <string-name><given-names>Lucía</given-names> <surname>Pita</surname></string-name>, <string-name><given-names>Nancy</given-names> <surname>Weiland-Bräuer</surname></string-name>, <string-name><given-names>Philipp</given-names> <surname>Dirksen</surname></string-name>, <string-name><given-names>Jun</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>Benedikt</given-names> <surname>Mortzfeld</surname></string-name>, <string-name><given-names>Sören</given-names> <surname>Franzenburg</surname></string-name>, <string-name><given-names>Ruth A</given-names> <surname>Schmitz</surname></string-name>, <string-name><given-names>John F</given-names> <surname>Baines</surname></string-name>, <string-name><given-names>Sebastian</given-names> <surname>Fraune</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Neutrality in the metaorganism</article-title>. <source>PLoS Biology</source>, <volume>17</volume>(<issue>6</issue>): <elocation-id>e3000298</elocation-id>, <year>2019</year>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Lana</given-names> <surname>Descheemaeker</surname></string-name> and <string-name><given-names>Sophie</given-names> <surname>De Buyl</surname></string-name></person-group>. <article-title>Stochastic logistic models reproduce experimental time series of microbial communities</article-title>. <source>eLife</source>, <volume>9</volume>:<elocation-id>e55650</elocation-id>, <year>2020</year>. <pub-id pub-id-type="doi">10.7554/eLife.55650</pub-id></mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jacopo</given-names> <surname>Grilli</surname></string-name></person-group>. <article-title>Macroecological laws describe variation and diversity in microbial communities</article-title>. <source>Nature communications</source>, <volume>11</volume>(<issue>1</issue>):<fpage>4743</fpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Silvia</given-names> <surname>Zaoli</surname></string-name> and <string-name><given-names>Jacopo</given-names> <surname>Grilli</surname></string-name></person-group>. <article-title>The stochastic logistic model with correlated carrying capacities reproduces beta-diversity metrics of microbial communities</article-title>. <source>PLOS Computational Biology</source>, <volume>18</volume>(<issue>4</issue>):<elocation-id>e1010043</elocation-id>, <year>2022</year>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sandro</given-names> <surname>Azaele</surname></string-name>, <string-name><given-names>Samir</given-names> <surname>Suweis</surname></string-name>, <string-name><given-names>Jacopo</given-names> <surname>Grilli</surname></string-name>, <string-name><given-names>Igor</given-names> <surname>Volkov</surname></string-name>, <string-name><given-names>Jayanth R</given-names> <surname>Banavar</surname></string-name>, and <string-name><given-names>Amos</given-names> <surname>Maritan</surname></string-name></person-group>. <article-title>Statistical mechanics of ecological systems: Neutral theory and beyond</article-title>. <source>Reviews of Modern Physics</source>, <volume>88</volume>(<issue>3</issue>):<fpage>035003</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Marcello</given-names> <surname>Seppi</surname></string-name>, <string-name><given-names>Jacopo</given-names> <surname>Pasqualini</surname></string-name>, <string-name><given-names>Sonia</given-names> <surname>Facchin</surname></string-name>, <string-name><given-names>Edoardo</given-names> <surname>Vincenzo Savarino</surname></string-name>, and <string-name><given-names>Samir</given-names> <surname>Suweis</surname></string-name></person-group>. <article-title>Emergent functional organization of gut microbiomes in health and diseases</article-title>. <source>Biomolecules</source>, <volume>14</volume>(<issue>1</issue>):<fpage>5</fpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jacopo</given-names> <surname>Pasqualini</surname></string-name>, <string-name><given-names>Sonia</given-names> <surname>Facchin</surname></string-name>, <string-name><given-names>Andrea</given-names> <surname>Rinaldo</surname></string-name>, <string-name><given-names>Amos</given-names> <surname>Maritan</surname></string-name>, <string-name><given-names>Edoardo</given-names> <surname>Savarino</surname></string-name>, and <string-name><given-names>Samir</given-names> <surname>Suweis</surname></string-name></person-group>. <article-title>Emergent ecological patterns and modelling of gut microbiomes in health and in disease</article-title>. <source>PLOS Computational Biology</source>, <volume>20</volume>(<issue>9</issue>): <elocation-id>e1012482</elocation-id>, <year>2024</year>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Amir</given-names> <surname>Bashan</surname></string-name>, <string-name><given-names>Travis E</given-names> <surname>Gibson</surname></string-name>, <string-name><given-names>Jonathan</given-names> <surname>Friedman</surname></string-name>, <string-name><given-names>Vincent J</given-names> <surname>Carey</surname></string-name>, <string-name><given-names>Scott T</given-names> <surname>Weiss</surname></string-name>, <string-name><given-names>Elizabeth L</given-names> <surname>Hohmann</surname></string-name>, and <string-name><given-names>Yang-Yu</given-names> <surname>Liu</surname></string-name></person-group>. <article-title>Universality of human microbial dynamics</article-title>. <source>Nature</source>, <volume>534</volume>(<issue>7606</issue>):<fpage>259</fpage>–<lpage>262</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jared</given-names> <surname>Kehe</surname></string-name>, <string-name><given-names>Anthony</given-names> <surname>Ortiz</surname></string-name>, <string-name><given-names>Anthony</given-names> <surname>Kulesa</surname></string-name>, <string-name><given-names>Jeff</given-names> <surname>Gore</surname></string-name>, <string-name><given-names>Paul C</given-names> <surname>Blainey</surname></string-name>, and <string-name><given-names>Jonathan</given-names> <surname>Friedman</surname></string-name></person-group>. <article-title>Positive interactions are common among culturable bacteria</article-title>. <source>Science advances</source>, <volume>7</volume>(<issue>45</issue>):<elocation-id>eabi7159</elocation-id>, <year>2021</year>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ophelia S</given-names> <surname>Venturelli</surname></string-name>, <string-name><given-names>Alex V</given-names> <surname>Carr</surname></string-name>, <string-name><given-names>Garth</given-names> <surname>Fisher</surname></string-name>, <string-name><given-names>Ryan H</given-names> <surname>Hsu</surname></string-name>, <string-name><given-names>Rebecca</given-names> <surname>Lau</surname></string-name>, <string-name><given-names>Benjamin P</given-names> <surname>Bowen</surname></string-name>, <string-name><given-names>Susan</given-names> <surname>Hromada</surname></string-name>, <string-name><given-names>Trent</given-names> <surname>Northen</surname></string-name>, and <string-name><given-names>Adam P</given-names> <surname>Arkin</surname></string-name></person-group>. <article-title>Deciphering microbial interactions in synthetic human gut microbiome communities</article-title>. <source>Molecular systems biology</source>, <volume>14</volume>(<issue>6</issue>):<elocation-id>e8157</elocation-id>, <year>2018</year>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Karoline</given-names> <surname>Faust</surname></string-name> and <string-name><given-names>Jeroen</given-names> <surname>Raes</surname></string-name></person-group>. <article-title>Microbial interactions: from networks to models</article-title>. <source>Nature Reviews Microbiology</source>, <volume>10</volume>(<issue>8</issue>): <fpage>538</fpage>–<lpage>550</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Yandong</given-names> <surname>Xiao</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Tulio Angulo</surname></string-name>, <string-name><given-names>Jonathan</given-names> <surname>Friedman</surname></string-name>, <string-name><given-names>Matthew K</given-names> <surname>Waldor</surname></string-name>, <string-name><given-names>Scott T</given-names> <surname>Weiss</surname></string-name>, and <string-name><given-names>Yang-Yu</given-names> <surname>Liu</surname></string-name></person-group>. <article-title>Mapping the ecological networks of microbial communities</article-title>. <source>Nature communications</source>, <volume>8</volume>(<issue>1</issue>):<fpage>2042</fpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>José</given-names> <surname>Camacho-Mateu</surname></string-name>, <string-name><given-names>Aniello</given-names> <surname>Lampo</surname></string-name>, <string-name><given-names>Matteo</given-names> <surname>Sireci</surname></string-name>, <string-name><given-names>Miguel A</given-names> <surname>Muñoz</surname></string-name>, and <string-name><given-names>José A</given-names> <surname>Cuesta</surname></string-name></person-group>. <article-title>Sparse species interactions reproduce abundance correlation patterns in microbial communities</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>121</volume>(<issue>5</issue>):<elocation-id>e2309575121</elocation-id>, <year>2024</year>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ali</given-names> <surname>Faisal</surname></string-name>, <string-name><given-names>Frank</given-names> <surname>Dondelinger</surname></string-name>, <string-name><given-names>Dirk</given-names> <surname>Husmeier</surname></string-name>, and <string-name><given-names>Colin M</given-names> <surname>Beale</surname></string-name></person-group>. <article-title>Inferring species interaction networks from species abundance data: A comparative evaluation of various statistical and machine learning methods</article-title>. <source>Ecological Informatics</source>, <volume>5</volume>(<issue>6</issue>):<fpage>451</fpage>–<lpage>464</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Marco</given-names> <surname>Tulio Angulo</surname></string-name>, <string-name><given-names>Jaime A</given-names> <surname>Moreno</surname></string-name>, <string-name><given-names>Gabor</given-names> <surname>Lippner</surname></string-name>, <string-name><given-names>Albert-László</given-names> <surname>Barabási</surname></string-name>, and <string-name><given-names>Yang-Yu</given-names> <surname>Liu</surname></string-name></person-group>. <article-title>Fundamental limitations of network reconstruction from temporal data</article-title>. <source>Journal of the Royal Society Interface</source>, <volume>14</volume>(<issue>127</issue>):<fpage>20160966</fpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Chengyi</given-names> <surname>Tu</surname></string-name>, <string-name><given-names>Samir</given-names> <surname>Suweis</surname></string-name>, <string-name><given-names>Jacopo</given-names> <surname>Grilli</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Formentin</surname></string-name>, and <string-name><given-names>Amos</given-names> <surname>Maritan</surname></string-name></person-group>. <article-title>Reconciling cooperation, biodiversity and stability in complex ecological communities</article-title>. <source>Scientific reports</source>, <volume>9</volume>(<issue>1</issue>):<fpage>5580</fpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>David W</given-names> <surname>Armitage</surname></string-name> and <string-name><given-names>Stuart E</given-names> <surname>Jones</surname></string-name></person-group>. <article-title>How sample heterogeneity can obscure the signal of microbial interactions</article-title>. <source>The ISME journal</source>, <volume>13</volume>(<issue>11</issue>):<fpage>2639</fpage>–<lpage>2646</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Robert D</given-names> <surname>Holt</surname></string-name></person-group>. <article-title>Some thoughts about the challenge of inferring ecological interactions from spatial data</article-title>. <source>Biodiversity Informatics</source>, <volume>15</volume>(<issue>1</issue>):<fpage>61</fpage>–<lpage>66</lpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Leonardo</given-names> <surname>Pacciani-Mori</surname></string-name>, <string-name><given-names>Samir</given-names> <surname>Suweis</surname></string-name>, <string-name><given-names>Amos</given-names> <surname>Maritan</surname></string-name>, and <string-name><given-names>Andrea</given-names> <surname>Giometto</surname></string-name></person-group>. <article-title>Constrained proteome allocation affects coexistence in models of competitive microbial communities</article-title>. <source>The ISME Journal</source>, <volume>15</volume>(<issue>5</issue>):<fpage>1458</fpage>–<lpage>1477</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Matteo</given-names> <surname>Sireci</surname></string-name>, <string-name><given-names>Miguel A</given-names> <surname>Muñoz</surname></string-name>, and <string-name><given-names>Jacopo</given-names> <surname>Grilli</surname></string-name></person-group>. <article-title>Environmental fluctuations explain the universal decay of species-abundance correlations with phylogenetic distance</article-title>. <source>bioRxiv</source>, <year>2022</year>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Anna</given-names> <surname>Tovo</surname></string-name>, <string-name><given-names>Peter</given-names> <surname>Menzel</surname></string-name>, <string-name><given-names>Anders</given-names> <surname>Krogh</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Cosentino Lagomarsino</surname></string-name>, and <string-name><given-names>Samir</given-names> <surname>Suweis</surname></string-name></person-group>. <article-title>Taxonomic classification method for metagenomics based on core protein families with core-kaiju</article-title>. <source>Nucleic Acids Research</source>, <volume>48</volume>(<issue>16</issue>):<elocation-id>e93–e93</elocation-id>, <year>2020</year>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sophie</given-names> <surname>Weiss</surname></string-name>, <string-name><given-names>Will</given-names> <surname>Van Treuren</surname></string-name>, <string-name><given-names>Catherine</given-names> <surname>Lozupone</surname></string-name>, <string-name><given-names>Karoline</given-names> <surname>Faust</surname></string-name>, <string-name><given-names>Jonathan</given-names> <surname>Friedman</surname></string-name>, <string-name><given-names>Ye</given-names> <surname>Deng</surname></string-name>, <string-name><given-names>Li</given-names> <surname>Charlie Xia</surname></string-name>, <string-name><given-names>Zhenjiang</given-names> <surname>Zech Xu</surname></string-name>, <string-name><given-names>Luke</given-names> <surname>Ursell</surname></string-name>, <string-name><given-names>Eric J</given-names> <surname>Alm</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Correlation detection strategies in microbial data sets vary widely in sensitivity and precision</article-title>. <source>The ISME journal</source>, <volume>10</volume>(<issue>7</issue>):<fpage>1669</fpage>–<lpage>1681</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Gregory B</given-names> <surname>Gloor</surname></string-name>, <string-name><given-names>Jean M</given-names> <surname>Macklaim</surname></string-name>, <string-name><given-names>Vera</given-names> <surname>Pawlowsky-Glahn</surname></string-name>, and <string-name><given-names>Juan J</given-names> <surname>Egozcue</surname></string-name></person-group>. <article-title>Microbiome datasets are compositional: and this is not optional</article-title>. <source>Frontiers in microbiology</source>, <volume>8</volume>:<fpage>2224</fpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Anders B</given-names> <surname>Dohlman</surname></string-name> and <string-name><given-names>Xiling</given-names> <surname>Shen</surname></string-name></person-group>. <article-title>Mapping the microbial interactome: Statistical and experimental approaches for microbiome network inference</article-title>. <source>Experimental Biology and Medicine</source>, <volume>244</volume>(<issue>6</issue>):<fpage>445</fpage>–<lpage>458</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Robert M</given-names> <surname>May</surname></string-name></person-group>. <article-title>Will a large complex system be stable?</article-title> <source>Nature</source>, <volume>238</volume>:<fpage>413</fpage>–<lpage>414</lpage>, <year>1972</year>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Stefano</given-names> <surname>Allesina</surname></string-name> and <string-name><given-names>Si</given-names> <surname>Tang</surname></string-name></person-group>. <article-title>Stability criteria for complex ecosystems</article-title>. <source>Nature</source>, <volume>483</volume>(<issue>7388</issue>):<fpage>205</fpage>–<lpage>208</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Guy</given-names> <surname>Bunin</surname></string-name></person-group>. <article-title>Ecological communities with lotka-volterra dynamics</article-title>. <source>Physical Review E</source>, <volume>95</volume>(<issue>4</issue>):<fpage>042414</fpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Tobias</given-names> <surname>Galla</surname></string-name></person-group>. <article-title>Dynamically evolved community size and stability of random lotka-volterra ecosystems (a)</article-title>. <source>Europhysics Letters</source>, <volume>123</volume>(<issue>4</issue>):<fpage>48004</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Giulio</given-names> <surname>Biroli</surname></string-name>, <string-name><given-names>Guy</given-names> <surname>Bunin</surname></string-name>, and <string-name><given-names>Chiara</given-names> <surname>Cammarota</surname></string-name></person-group>. <article-title>Marginally stable equilibria in critical ecosystems</article-title>. <source>New Journal of Physics</source>, <volume>20</volume>(<issue>8</issue>):<fpage>083051</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ada</given-names> <surname>Altieri</surname></string-name>, <string-name><given-names>Felix</given-names> <surname>Roy</surname></string-name>, <string-name><given-names>Chiara</given-names> <surname>Cammarota</surname></string-name>, and <string-name><given-names>Giulio</given-names> <surname>Biroli</surname></string-name></person-group>. <article-title>Properties of equilibria and glassy phases of the random lotka-volterra model with demographic noise</article-title>. <source>Physical Review Letters</source>, <volume>126</volume>(<issue>25</issue>):<fpage>258301</fpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Giulia</given-names> <surname>Garcia Lorenzana</surname></string-name> and <string-name><given-names>Ada</given-names> <surname>Altieri</surname></string-name></person-group>. <article-title>Well-mixed lotka-volterra model with random strongly competitive interactions</article-title>. <source>Physical Review E</source>, <volume>105</volume>(<issue>2</issue>):<fpage>024307</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Matthieu</given-names> <surname>Barbier</surname></string-name>, <string-name><given-names>Jean-François</given-names> <surname>Arnoldi</surname></string-name>, <string-name><given-names>Guy</given-names> <surname>Bunin</surname></string-name>, and <string-name><given-names>Michel</given-names> <surname>Loreau</surname></string-name></person-group>. <article-title>Generic assembly patterns in complex ecological communities</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>115</volume>(<issue>9</issue>):<fpage>2156</fpage>–<lpage>2161</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ian A.</given-names> <surname>Hatton</surname></string-name>, <string-name><given-names>Onofrio</given-names> <surname>Mazzarisi</surname></string-name>, <string-name><given-names>Ada</given-names> <surname>Altieri</surname></string-name>, and <string-name><given-names>Matteo</given-names> <surname>Smerlak</surname></string-name></person-group>. <article-title>Diversity begets stability: Sublinear growth and competitive coexistence across ecosystems</article-title>. <source>Science</source>, <volume>383</volume>(<issue>6688</issue>):<elocation-id>eadg8488</elocation-id>, <year>2024</year>. doi:<pub-id pub-id-type="doi">10.1126/science.adg8488</pub-id>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jiliang</given-names> <surname>Hu</surname></string-name>, <string-name><given-names>Daniel R</given-names> <surname>Amor</surname></string-name>, <string-name><given-names>Matthieu</given-names> <surname>Barbier</surname></string-name>, <string-name><given-names>Guy</given-names> <surname>Bunin</surname></string-name>, and <string-name><given-names>Jeff</given-names> <surname>Gore</surname></string-name></person-group>. <article-title>Emergent phases of ecological diversity and dynamics mapped in microcosms</article-title>. <source>Science</source>, <volume>378</volume>(<issue>6615</issue>):<fpage>85</fpage>–<lpage>89</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ada</given-names> <surname>Altieri</surname></string-name> and <string-name><given-names>Giulio</given-names> <surname>Biroli</surname></string-name></person-group>. <article-title>Effects of intraspecific cooperative interactions in large ecosystems</article-title>. <source>SciPost Physics</source>, <volume>12</volume> (<issue>1</issue>):<fpage>013</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Emil</given-names> <surname>Mallmin</surname></string-name>, <string-name><given-names>Arne</given-names> <surname>Traulsen</surname></string-name>, and <string-name><given-names>Silvia</given-names> <surname>De Monte</surname></string-name></person-group>. <article-title>Chaotic turnover of rare and abundant species in a strongly interacting model community</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>121</volume>(<issue>11</issue>):<elocation-id>e2312822121</elocation-id>, <year>2024</year>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Samir</given-names> <surname>Suweis</surname></string-name>, <string-name><given-names>Francesco</given-names> <surname>Ferraro</surname></string-name>, <string-name><given-names>Christian</given-names> <surname>Grilletta</surname></string-name>, <string-name><given-names>Sandro</given-names> <surname>Azaele</surname></string-name>, and <string-name><given-names>Amos</given-names> <surname>Maritan</surname></string-name></person-group>. <article-title>Generalized lotka-volterra systems with time correlated stochastic interactions</article-title>. <source>Physical Review Letters</source>, <volume>133</volume>(<issue>16</issue>):<fpage>167101</fpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Marc</given-names> <surname>Mezard</surname></string-name> and <string-name><given-names>Andrea</given-names> <surname>Montanari</surname></string-name></person-group>. <source>Information, physics, and computation</source>. <publisher-name>Oxford University Press</publisher-name>, <year>2009</year>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ada</given-names> <surname>Altieri</surname></string-name> and <string-name><given-names>Marco</given-names> <surname>Baity-Jesi</surname></string-name></person-group>. <article-title>An introduction to the theory of spin glasses</article-title>. <source>Encyclopedia of Condensed Matter Physics</source>, pages <fpage>361</fpage>–<lpage>370</lpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jairo RL</given-names> <surname>de Almeida</surname></string-name> and <string-name><given-names>David J</given-names> <surname>Thouless</surname></string-name></person-group>. <article-title>Stability of the sherrington-kirkpatrick solution of a spin glass model</article-title>. <source>Journal of Physics A: Mathematical and General</source>, <volume>11</volume>(<issue>5</issue>):<fpage>983</fpage>, <year>1978</year>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Paolo</given-names> <surname>Biscari</surname></string-name> and <string-name><given-names>G</given-names> <surname>Parisi</surname></string-name></person-group>. <article-title>Replica symmetry breaking in the random replicant model</article-title>. <source>Journal of Physics A: Mathematical and General</source>, <volume>28</volume>(<issue>17</issue>):<fpage>4697</fpage>, <year>1995</year>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sigurd</given-names> <surname>Diederich</surname></string-name> and <string-name><given-names>Manfred</given-names> <surname>Opper</surname></string-name></person-group>. <article-title>Replicators with random interactions: A solvable model</article-title>. <source>Physical Review A</source>, <volume>39</volume> (<issue>8</issue>):<fpage>4333</fpage>, <year>1989</year>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Marc</given-names> <surname>Mézard</surname></string-name>, <string-name><given-names>Giorgio</given-names> <surname>Parisi</surname></string-name>, and <string-name><given-names>Miguel</given-names> <surname>Angel Virasoro</surname></string-name></person-group>. <source>Spin glass theory and beyond: An Introduction to the Replica Method and Its Applications</source>, volume <volume>9</volume>. <publisher-name>World Scientific Publishing Company</publisher-name>, <year>1987</year>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Jim</given-names> <surname>Wu</surname></string-name>, <string-name><given-names>Pankaj</given-names> <surname>Mehta</surname></string-name>, and <string-name><given-names>David</given-names> <surname>Schwab</surname></string-name></person-group>. <article-title>Understanding species abundance distributions in complex ecosystems of interacting species</article-title>. <source>arXiv preprint arXiv:2103.02081</source>, <year>2021</year>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Zhanshan</given-names> <surname>Sam Ma</surname></string-name></person-group>. <article-title>Testing the anna karenina principle in human microbiome-associated diseases</article-title>. <source>Iscience</source>, <volume>23</volume>(<issue>4</issue>), <year>2020</year>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Emanuele</given-names> <surname>Pigani</surname></string-name>, <string-name><given-names>Bruno</given-names> <surname>Hay Mele</surname></string-name>, <string-name><given-names>Lucia</given-names> <surname>Campese</surname></string-name>, <string-name><given-names>Enrico</given-names> <surname>Ser-Giacomi</surname></string-name>, <string-name><given-names>Maurizio</given-names> <surname>Ribera</surname></string-name>, <string-name><given-names>Daniele</given-names> <surname>Iudicone</surname></string-name>, and <string-name><given-names>Samir</given-names> <surname>Suweis</surname></string-name></person-group>. <article-title>Deviation from neutral species abundance distributions unveils geographical differences in the structure of diatom communities</article-title>. <source>Science Advances</source>, <volume>10</volume>(<issue>10</issue>):<elocation-id>eadh0477</elocation-id>, <year>2024</year>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Thibaut</given-names> <surname>Arnoulx de Pirey</surname></string-name> and <string-name><given-names>Guy</given-names> <surname>Bunin</surname></string-name></person-group>. <article-title>Many-species ecological fluctuations as a jump process from the brink of extinction</article-title>. <source>Physical Review X</source>, <volume>14</volume>(<issue>1</issue>):<fpage>011037</fpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Antonietta</given-names> <surname>Tomasulo</surname></string-name>, <string-name><given-names>Barbara</given-names> <surname>Simionati</surname></string-name>, and <string-name><given-names>Sonia</given-names> <surname>Facchin</surname></string-name></person-group>. <article-title>Microbiome one health model for a healthy ecosystem</article-title>. <source>Science in One Health</source>, page <fpage>100065</fpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Eric A</given-names> <surname>Franzosa</surname></string-name>, <string-name><given-names>Alexandra</given-names> <surname>Sirota-Madi</surname></string-name>, <string-name><given-names>Julian</given-names> <surname>Avila-Pacheco</surname></string-name>, <string-name><given-names>Nadine</given-names> <surname>Fornelos</surname></string-name>, <string-name><given-names>Henry J</given-names> <surname>Haiser</surname></string-name>, <string-name><given-names>Stefan</given-names> <surname>Reinker</surname></string-name>, <string-name><given-names>Tommi</given-names> <surname>Vatanen</surname></string-name>, <string-name><given-names>A Brantley</given-names> <surname>Hall</surname></string-name>, <string-name><given-names>Himel</given-names> <surname>Mallick</surname></string-name>, <string-name><given-names>Lauren J</given-names> <surname>McIver</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Gut microbiome structure and metabolic activity in inflammatory bowel disease</article-title>. <source>Nature microbiology</source>, <volume>4</volume>(<issue>2</issue>):<fpage>293</fpage>–<lpage>305</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ruben AT</given-names> <surname>Mars</surname></string-name>, <string-name><given-names>Yi</given-names> <surname>Yang</surname></string-name>, <string-name><given-names>Tonya</given-names> <surname>Ward</surname></string-name>, <string-name><given-names>Mo</given-names> <surname>Houtti</surname></string-name>, <string-name><given-names>Sambhawa</given-names> <surname>Priya</surname></string-name>, <string-name><given-names>Heather R</given-names> <surname>Lekatz</surname></string-name>, <string-name><given-names>Xiaojia</given-names> <surname>Tang</surname></string-name>, <string-name><given-names>Zhifu</given-names> <surname>Sun</surname></string-name>, <string-name><given-names>Krishna R</given-names> <surname>Kalari</surname></string-name>, <string-name><given-names>Tal</given-names> <surname>Korem</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Longitudinal multi-omics reveals subset-specific mechanisms underlying irritable bowel syndrome</article-title>. <source>Cell</source>, <volume>182</volume>(<issue>6</issue>):<fpage>1460</fpage>–<lpage>1473</lpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Francesco</given-names> <surname>Zamponi</surname></string-name></person-group>. <article-title>Mean field theory of spin glasses</article-title>. <source>arXivpreprint arXiv:1008.4844</source>, <year>2010</year>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Pauli</given-names> <surname>Virtanen</surname></string-name>, <string-name><given-names>Ralf</given-names> <surname>Gommers</surname></string-name>, <string-name><given-names>Travis E</given-names> <surname>Oliphant</surname></string-name>, <string-name><given-names>Matt</given-names> <surname>Haberland</surname></string-name>, <string-name><given-names>Tyler</given-names> <surname>Reddy</surname></string-name>, <string-name><given-names>David</given-names> <surname>Cournapeau</surname></string-name>, <string-name><given-names>Evgeni</given-names> <surname>Burovski</surname></string-name>, <string-name><given-names>Pearu</given-names> <surname>Peterson</surname></string-name>, <string-name><given-names>Warren</given-names> <surname>Weckesser</surname></string-name>, <string-name><given-names>Jonathan</given-names> <surname>Bright</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Scipy 1.0: fundamental algorithms for scientific computing in python</article-title>. <source>Nature methods</source>, <volume>17</volume>(<issue>3</issue>):<fpage>261</fpage>–<lpage>272</lpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Yoshimi</given-names> <surname>Yoshino</surname></string-name>, <string-name><given-names>Tobias</given-names> <surname>Galla</surname></string-name>, and <string-name><given-names>Kei</given-names> <surname>Tokita</surname></string-name></person-group>. <article-title>Rank abundance relations in evolutionary dynamics of random replicators</article-title>. <source>Physical Review E</source>, <volume>78</volume>(<issue>3</issue>):<fpage>031924</fpage>, <year>2008</year>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ada</given-names> <surname>Altieri</surname></string-name> and <string-name><given-names>Silvio</given-names> <surname>Franz</surname></string-name></person-group>. <article-title>Constraint satisfaction mechanisms for marginal stability and criticality in large ecosystems</article-title>. <source>Physical Review E</source>, <volume>99</volume>(<issue>1</issue>):<fpage>010401</fpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Mikhail</given-names> <surname>Tikhonov</surname></string-name> and <string-name><given-names>Remi</given-names> <surname>Monasson</surname></string-name></person-group>. <article-title>Collective phase in resource competition in a highly diverse ecosystem</article-title>. <source>Physical review letters</source>, <volume>118</volume>(<issue>4</issue>):<fpage>048103</fpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Francesco</given-names> <surname>Guerra</surname></string-name> and <string-name><given-names>Fabio</given-names> <surname>Lucio Toninelli</surname></string-name></person-group>. <article-title>Quadratic replica coupling in the sherrington-kirkpatrick mean field spin glass model</article-title>. <source>Journal of Mathematical Physics</source>, <volume>43</volume>(<issue>7</issue>):<fpage>3704</fpage>–<lpage>3716</lpage>, <year>2002</year>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="data"><person-group person-group-type="author"><string-name><given-names>Dmitry</given-names> <surname>Panchenko</surname></string-name> and <string-name><given-names>Michel</given-names> <surname>Talagrand</surname></string-name></person-group>. <article-title>On the overlap in the multiple spherical sk models</article-title>. <year>2007</year>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Mohamad</given-names> <surname>Dia</surname></string-name>, <string-name><given-names>Nicolas</given-names> <surname>Macris</surname></string-name>, <string-name><given-names>Florent</given-names> <surname>Krzakala</surname></string-name>, <string-name><given-names>Thibault</given-names> <surname>Lesieur</surname></string-name>, <string-name><given-names>Lenka</given-names> <surname>Zdeborová</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Mutual information for symmetric rank-one matrix estimation: A proof of the replica formula</article-title>. <source>Advances in Neural Information Processing Systems</source>, <volume>29</volume>, <year>2016</year>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Cirano</given-names> <surname>De Dominicis</surname></string-name> and <string-name><given-names>Irene</given-names> <surname>Giardina</surname></string-name></person-group>. <source>Random fields and spin glasses: a field theory approach</source>. <publisher-name>Cambridge University Press</publisher-name>, <year>2006</year>.</mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ada</given-names> <surname>Altieri</surname></string-name>, <string-name><given-names>Giorgio</given-names> <surname>Parisi</surname></string-name>, and <string-name><given-names>Tommaso</given-names> <surname>Rizzo</surname></string-name></person-group>. <article-title>Composite operators in cubic field theories and link-overlap fluctuations in spin-glass models</article-title>. <source>Physical Review B</source>, <volume>93</volume>(<issue>2</issue>):<fpage>024422</fpage>, <year>2016</year>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105948.2.sa4</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Bitbol</surname>
<given-names>Anne-Florence</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-1020-494X</contrib-id>
<aff>
<institution-wrap>
<institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution>
</institution-wrap>
<city>Lausanne</city>
<country>Switzerland</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Compelling</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>important</bold> study shows how the relative importance of inter-species interactions in microbiomes can be inferred from empirical species abundance data. The methods based on statistical physics of disordered systems are <bold>compelling</bold> and rigorous, and allow for distinguishing healthy and non-healthy human gut microbiomes via differences in their inter-species interaction patterns. This work should be of broad interest to researchers in microbial ecology and theoretical biophysics.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105948.2.sa3</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this manuscript, the authors develop a novel method to infer ecologically-informative parameters across healthy and diseased states of the gut microbiota, although the method is generalizable to other datasets for species abundances. The authors leverage techniques from theoretical physics of disordered systems to infer different parameters-mean and standard deviation for the strength of bacterial interspecies interactions, a bacterial immigration rate, and the strength of demographic noise-that describe the statistics of microbiota samples from two groups-one for healthy subjects and another one for subjects with chronic inflammation syndromes. To do this, the authors simulate communities with a modified version of the Generalized Lotka-Volterra model and randomly-generated interactions, and then use a moment-matching algorithm to find sets of parameters that better reproduce the data for species abundances. They find that these parameters are different for the healthy and diseased microbiota groups. The results suggest, for example, that bacterial interaction strengths, relative to noise and immigration, are more dominant of microbiota dynamics in diseased states than in healthy states.</p>
<p>We think that this manuscript brings an important contribution that will be of interest in the areas of statistical physics, (microbiota) ecology and (biological) data science. The evidence of their results is solid and the work improves the state-of-the-art in terms of methods.</p>
<p>Strengths:</p>
<list list-type="bullet">
<list-item><p>Using a fairly generic ecological model, the method can identify the change in the relative importance of different ecological forces (distribution of interspecies interactions, demographic noise and immigration) in different sample groups. The authors focus on the case of the human gut microbiota, showing that the data is consistent with a higher influence of species interactions (relative to demographic noise and immigration) in a disease microbiota state than in healthy ones.</p>
</list-item>
<list-item><p>The method is novel, original and it improves the state-of-the-art methodology for the inference of ecologically-relevant parameters. The analysis provides solid evidence on the conclusions.</p>
</list-item>
</list>
<p>Weaknesses:</p>
<list list-type="bullet">
<list-item><p>As a proof of concept for a new inference method, this text maintains a technical focus, which may require some familiarity with statistical physics. Nevertheless, the authors' clear introduction of key mathematical terms and their interpretations, along with a clear discussion of the ecological implications, make the results accessible and easy to follow.</p>
</list-item></list>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105948.2.sa2</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This valuable work aims to infer, from microbiome data, microbial species interaction patterns associated with healthy and unhealthy human gut microbiomes. Using solid techniques from statistical physics, the authors propose that healthy and unhealthy microbiome interaction patterns substantially differ. Unhealthy microbiomes are closer to instability and single-strain dominance; whereas healthy microbiomes showcase near-neutral dynamics, mostly driven by demographic noise and immigration.</p>
<p>Strengths:</p>
<p>This is a well-written article, relatively easy to follow and transparent despite the high degree of technicality of the underlying theory. The authors provide a powerful inferring procedure, which bypasses the issue of having only compositional data. This work shows that embracing the complexity of microbial systems can be used to our advantage, instead of being an insurmountable obstacle. This is a powerful counterpoint to the classic reductionist view that pushes researchers to study much simpler systems, and only hope to one day scale up their findings.</p>
<p>Weaknesses:</p>
<p>As acknowledged by the authors themselves, this is only a proof of concept. Further research is to better understand the dynamical nature of gut-microbiomes. The authors do however point at ways in which species abundance distributions could be better reproduced by dynamical models. They also suggest that they work could explain prior empirical findings invoking the &quot;Anna Karenina principle&quot;, where
healthy microbiomes resemble one another, but disease states tend to all differ.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105948.2.sa1</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>I found the manuscript to be well-written. I have a few questions regarding the model, though the bulk of my comments are requests to provide definitions and additional clarity. There are concepts and approaches used in this manuscript that are clear boons for understanding the ecology of microbiomes but are rarely considered by researchers approaching the manuscript from a traditional biology background. The authors have clearly considered this in their writing of S1 and S2, so addressing these comments should be straightforward. The methods section is particularly informative and well-written, with sufficient explanations of each step of the derivation that should be informative to researchers in the microbial life sciences that are not well-versed with physics-inspired approaches to ecology dynamics.</p>
<p>Strengths:</p>
<p>The modeling efforts of this study primarily rely on a disordered for of the generalized Lotka-Volterra (gLV) model. This model can be appropriate for investigating certain systems and the authors are clear about when and how more mechanistic models (i.e., consumer-resource) can lead to gLV. Phenomenological models such as this have been found to be highly useful for investigating the ecology of microbiomes, so this modeling choice seems justified, and the limitations are laid out.</p>
<p>Weaknesses:</p>
<p>The authors use metagenomic data of diseased and healthy patients that was first processed in Pasqualini et al. (2024). The use of metagenomic data leads me into a question regarding the role of sampling effort (i.e., read counts) in shaping model parameters such as $h$. This parameter is equal to the average of 1/# species across samples because the data are compositional in nature. My understanding is that $h$ was calculated using total abundances (i.e., read counts). The number of observed species is strongly influenced by sampling effort and the authors addressed this point in their revised manuscript.</p>
<p>However, the role of sampling effort can depend on the type of data and my instinct about the role that sampling effort plays in species detection is primarily based on 16S data. The dependency between these two variables may be less severe for the authors' metagenomic pipeline. This potential discrepancy raises a broader issue regarding the investigation of microbial macroecological patterns and the inference of ecological parameters. Often microbial macroecology researchers rely on 16S rRNA amplicon data because that type of data is abundant and comparatively low-cost. Some in microbiology and bioinformatics are increasingly pushing researchers to choose metagenomics over 16S. Sometimes this choice is valid (discovery of new MAGs, investigate allele frequency changes within species, etc.), sometimes it is driven by the false equivalence &quot;more data = better&quot;. The outcome though is that we have a body of more-or-less established microbial macroecological patterns which rest on 16S data and are now slowly incorporating results from metagenomics. To my knowledge there has not been a systematic evaluation of the macroecological patterns that do and do not vary by one's choice in 16S vs. metagenomics. Several of the authors in this manuscript have previously compared the MAD shape for 16S and metagenomic datasets in Pasqualini et al., but moving forward a more comprehensive study seems necessary (2024). These points were addressed by the authors in their revised manuscript.</p>
<p>Final review: The authors addressed all comments and I have no additional comments.</p>
<p>References</p>
<p>Pasqualini, Jacopo, et al. &quot;Emergent ecological patterns and modelling of gut microbiomes in health and in disease.&quot; PLOS Computational Biology 20.9 (2024): e1012482.</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105948.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Pasqualini</surname>
<given-names>Jacopo</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Maritan</surname>
<given-names>Amos</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rinaldo</surname>
<given-names>Andrea</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Facchin</surname>
<given-names>Sonia</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Savarino</surname>
<given-names>Edoardo</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Altieri</surname>
<given-names>Ada</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Suweis</surname>
<given-names>Samir</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations for the Authors:</bold></p>
<p><bold>Reviewer #1:</bold></p>
</disp-quote>
<p>We think that this manuscript brings an important contribution that will be of interest in the areas of statistical physicists, (microbiota) ecology, and (biological) data science. The evidence of their results is solid and the work improves the state-of-the-art in terms of methods. We have a few concerns that, in our opinion, the authors should address.</p>
<disp-quote content-type="editor-comment">
<p>Major concerns:</p>
<p>(1) While the paper could be of interest for the broad audience of e-Life, the way it is written is accessible mainly to physicists. We encourage the authors to take the broad audience into account by i) explaining better the essence of what is being done at each step, ii) highlighting the relevance of the method compared to other methods, iii) discussing the ecological implications of the results.</p>
<p>Examples on how to approach i) include: Modify or expand Figure 1 so that non-familiar readers can understand the summary of the work (e.g. with cartoons representing communities, diseased states and bacterial interactions and their relationship with the inference method); in each section, summarize at the beginning the purpose of what is going to be addressed in this section, and summarize at the end what the section has achieved; in Figure 2, replace symbols by their meaning as much as possible-the same for Figure 1, at the very least in the figure caption.</p>
<p>Example on how to approach ii): Since the authors aim to establish a bridge between disordered systems and microbiome ecology, it could be useful to expand a bit the introduction on disordered systems for biologists/biophysicists. This could be done with an additional text box, which could also highlight the advantages of this approach in comparison to other techniques (e.g. model-free approaches can also classify healthy and diseased states).</p>
<p>Example on how to approach iii): The authors could discuss with more depth the ecological implications of their results. For example, do they have a hypothesis on why demographic and neutral effects could dominate in healthy patients?</p>
</disp-quote>
<p>We thank the reviewer for the observations. Following the suggestion in the revised version, each section outlines the goal of what will be addressed in that section, and summarizes what we have achieved at the end; We also updated Figure 1 and Figure 2.</p>
<p>(i) For figure 1, we expanded and hopefully made more clear how we conceptualize the problem, use the data, andestablish our method. In Figure 2, we enriched the y labels of each panel with the name associated with the order parameter.</p>
<p>(ii) We thank the reviewer for helping us improve the readability of the introductory part, thus providing moreinsights into disordered systems techniques for a broader audience. We have added a few explanations at the end of page 2 – to explain the advantages of such methodology compared to other strategies and models.</p>
<p>(iii) We thank the reviewer for raising the need for a more in-depth ecological discussion of our results. A simple wayto understand why neutral effects may dominate in healthy patients is the following. Neutrality implies that species differences are mainly shaped by stochastic processes such as demographic noise, with species treated as different realizations of the same underlying stochastic ecological dynamics. In our analysis, we observe that healthy individuals tend to exhibit highly similar microbial communities, suggesting that the compositional variability among their microbiomes is compatible—at least in part—with the fluctuations expected from demographic stochasticity alone. In contrast, patients with the disease display significantly more heterogeneous microbial compositions. The diversity and structure of their gut communities cannot be satisfactorily explained by neutral demographic fluctuations alone.</p>
<p>This discrepancy implies that additional deterministic forces—such as altered ecological interactions—are driving the divergence observed in dysbiotic states. In diseased individuals, the breakdown of such interactions leads to a structurally distinct regime that may correspond to a phase of marginal stability, as indicated by our theoretical modeling. This shift marks a transition from a community governed by neutrality and demographic noise to one dominated by non-neutral ecological forces (as depicted in Figure 4). We added these comments in the discussion section of the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p>(2) Taking into account the broader audience, we invite the authors to edit the abstract, as it seems to jump from one ecological concept to another without explicitly communicating what is the link between these concepts. From the first two sentences, the motivation seems to be species diversity, but no mention of diversity comes after the second sentence. There is no proper introduction/definition of what macroecological states are. After that, the authors switch to healthy and unhealthy states, without previously introducing any link between gut microbiota states and the host’s health (which perhaps could be good in the first or second sentence, although other framings can be as valid). After that, interactions appear in the text and are related to instability, but the reader might not know whether this is surprising or if healthy/unhealthy states are generally related to stability.</p>
<p>We pointed out a few examples, but the authors could extend their revision on i), ii) and iii) beyond such specific comments. In our opinion, this would really benefit the paper.</p>
</disp-quote>
<p>In response to the reviewer’s concern about conceptual clarity and structure, we substantially revised the abstract to improve its accessibility and logical flow. In the revised abstract, we now clearly link species diversity to microbiome structure and function from the outset, addressing initial confusion. We provide a concise definition of ”macroecological states,” framing them as reproducible statistical patterns reflecting community-level properties. Additionally, the revised version explicitly connects gut microbiome states to host health earlier, resolving the previous abrupt shift in focus. Finally, we conclude by highlighting how disordered systems theory advances our understanding of microbiome stability and functioning, reinforcing the novelty and broader significance of our approach. Overall, the revised abstract better serves a broad interdisciplinary audience, including readers unfamiliar with the technicalities of disordered systems or microbial ecology, while preserving the scientific depth and accuracy of our work</p>
<disp-quote content-type="editor-comment">
<p>(3) The connection with consumer-resource (CR) models is quite unusual. In Equation (12), why do the authors assume that the consumption term does not depend on R? This should be addressed, since this term is usually dependent on R in microbial ecology models.</p>
<p>In case this is helpful, it is known that the symmetric Lotka-Volterra model emerges from time-scale separation in the MacArthur model, where resources reproduce logistically and are consumed by other species (e.g., plants eaten by herbivores). Consumer-resource models form a broad category, while the MacArthur model is a specific case featuring logistic resource growth. For microbes, a more meaningful justification of the generalized Lotka-Volterra (GLV) model from a consumer-resource perspective involves the consumer-resource dynamics in a chemostat, where time-scale separation is assumed and higher-order interactions are neglected. See, for example: a) The classic paper by MacArthur: R. MacArthur. Species packing and competitive equilibrium for many species. Theoretical Population Biology, 1(1):1-11, 1970. b) Recent works on time-scale separation in chemostat consumer-resource models: Anna Posfai et al., PRL, 2017 Sireci et al., PNAS, 2023 Akshit Goyal et al., PRX-Life, 2025</p>
</disp-quote>
<p>We thank the reviewer for the observation. We apologize for the typo that appeared in the main text and that we promptly corrected. The Consumers-Resources model we had in mind is the classical case proposed by MacArthur, where resources are self-regulated according to a logistic growth mechanism, which leads to the generalized LotkaVolterra model we employ in our work.</p>
<disp-quote content-type="editor-comment">
<p>Minor concerns:</p>
<p>(1) The title has a nice pun for statistical physicists, but we wonder if it can be a bit confusing for the broader audience of e-Life. Although we leave this to the author’s decision, we’d recommend considering changing the title, making it more explicit in communicating the main contribution/result of the work.</p>
</disp-quote>
<p>Following the reviewer’s suggestion, we have introduced an explanatory subtitle: “Linking Species Interactions to Dysbiosis through a Disordered Lotka-Volterra Framework”.</p>
<disp-quote content-type="editor-comment">
<p>(2) Review the references - some preprints might have already been published: Pasqualini J. 2023, Sireci 2022, Wu 2021.</p>
</disp-quote>
<p>We thank the reviewer for pointing our attention to this inaccuracy. We updated the references to Pasqualini and Sireci papers. To our knowledge, Wu’s paper has appeared as an arXiv preprint only.</p>
<disp-quote content-type="editor-comment">
<p>(3) Species do not generally exhibit identical carrying capacities (see Grilli, Nat. Commun., 2020; some taxa are generally more abundant than others. The authors could discuss whether the model, with the inferred parameters, can accurately reproduce the distribution of species’ mean abundances.</p>
</disp-quote>
<p>We thank the reviewer for this insightful comment. As discussed in the revised manuscript (lines 294–299), our current model does not accurately reproduce the empirical species abundance distribution (SAD). This limitation stems from the assumption of constant carrying capacities across species. While empirical observations (e.g., Grilli et al., Nat. Commun., 2020 [1]) show heterogeneous mean abundances often following power-law or log-normal distributions. However, our model assumes constant carrying capacity, resulting in SADs devoid of fat tails, which diverge from empirical data.</p>
<p>This simplification is implemented to maintain the analytical tractability of the disordered generalized Lotka-Volterra (dGLV) framework, a common approach also found in prior works such as Bunin (2017) and Barbier et al. (2018) [2, 3]. Introducing heterogeneity in carrying capacities, such as drawing them from a log-normal distribution, or switching to multiplicative (rather than demographic) noise, could indeed produce SADs that better align with empirical data. Nevertheless, implementing changes would significantly complicate the analytical treatment.</p>
<p>We acknowledge these directions as promising avenues for future research. They could help enhance the empirical realism of the model and its capacity to capture observed macroecological patterns while posing new theoretical challenges for disordered systems analysis</p>
<disp-quote content-type="editor-comment">
<p>(4) A substantial number of cited works (Grilli, Nat. Commun., 2020; Zaoli &amp; Grilli, Science Advances, 2021; Sireci et al., PNAS, 2023; Po-Yi Ho et al., eLife, 2022) suggest that environmental fluctuations play a crucial role in shaping microbiome composition and dynamics. Is the authors’ analysis consistent with this perspective? Do they expect their conclusions to remain robust if environmental fluctuations are introduced?</p>
</disp-quote>
<p>We thank the reviewer for stressing this point. The introduction of environmental fluctuations in the model formally violates detailed balance, thereby preventing the definition of an energy function. To date, no study has integrated random interactions together with both demographic and environmental noise within a unified analytical framework. This is certainly a highly promising direction that some of the authors are already exploring. However, given the inherently out-of-equilibrium nature of the system and the absence of a free energy, we would need to adopt a Dynamical Mean-Field Theory formalism and eventually analyze the corresponding stationary equations to be solved self-consistently. We added, however, a brief note in the Discussion section.</p>
<disp-quote content-type="editor-comment">
<p>(5) The term “order parameters“ may not be intuitive for a biological audience. In any case, the authors should explicitly define each order parameter when first introduced.</p>
</disp-quote>
<p>We thank the reviewer for the comment. We introduced the names of the order parameters as soon as they are introduced, along with a brief explanation of their meaning that may be accessible to an audience with biological background.</p>
<disp-quote content-type="editor-comment">
<p>(6) Line 242: Should ψU be ψD?</p>
</disp-quote>
<p>We thank the reviewer for the observation. We corrected the typo.</p>
<disp-quote content-type="editor-comment">
<p>(7) Given that the authors are discussing healthy and diseased states and to avoid confusion, the authors could perhaps use another word for ’pathological’ when they refer to dynamical regimes (e.g., in Appendix 2: ’letting the system enter the pathological regime of unbounded growth’).</p>
</disp-quote>
<p>We thank the reviewer for the helpful comment. As suggested, we used the term “unphysical” instead of “pathological” where needed.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2:</bold></p>
<p>(1) A technical point that I could not understand is how the authors deal with compositional data. One reason for my confusion is that the order parameters h and q0 are fixed n data to 1/S and 1/S2, and thus I do not see how they can be informative. Same for carrying capacity, why is it not 1 if considering relative abundance?</p>
</disp-quote>
<p>We thank the reviewer for raising this point. We acknowledge that the treatment of compositional data and the interpretation of order parameters h and q0 were not sufficiently clarified in the manuscript. Additionally, there was an imprecision in the text regarding the interpretation of these parameters.</p>
<p>As defined in revised Eq. (4) of the manuscript, h and q0 are to be averaged over the entire dataset, summing across samples α. Specifically, <inline-formula id="sa4equ1"><inline-graphic xlink:href="elife-105948-sa4-equ1.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> and <inline-formula id="sa4equ2"><inline-graphic xlink:href="elife-105948-sa4-equ2.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, where S<sub>α</sub> is the number of species present in sample α and is the average over samples. These parameters are therefore informative, as they encapsulate sample-level ecological diversity, and their variation reflects biological differences between healthy and diseased states. For instance, Pasqualini et al., 2024 [4] reported significant differences in these metrics between health conditions, thereby supporting their ecological relevance.</p>
<p>Regarding carrying capacities, we clarify that although we work with relative abundance data (i.e., compositional data), we do not fix the carrying capacity K to 1. Instead, we set K to the maximum value of xi (relative abundance) within each sample, to preserve compatibility with empirical data and allow for coexistence. While this remains a modeling assumption, it ensures better ecological realism within the constraints of the disordered GLV framework.</p>
<disp-quote content-type="editor-comment">
<p>(2) Obviously I’m missing something, so it would be nice to clarify in simple terms the logic of the argument. I understand that Lagrange multipliers are going to be used in the model analysis, and there are a lot of technical arguments presented in the paper, but I would like a much more intuitive explanation about the way the data can be used to infer order parameters if those are fixed by definition in compositional data.</p>
</disp-quote>
<p>We thank the reviewer for the observation. The order parameters can be measured directly from the data, even in the presence of compositionality, as explained above. We can connect those parameters with the theory even for compositional data, because the only effect of adding the compositionality constraint is to shift the linear coefficient in the Hamiltonian, which corresponds to shifting the average interaction µ. However, the resulting phase diagram is mostly affected by the variance of the interactions σ2 (as µ is such that we are in the bounded phase).</p>
<disp-quote content-type="editor-comment">
<p>(3) Another point that I did not understand comes from the fact that the authors claim that interaction variance is smaller in unhealthy microbiomes. Yet they also find that those are closer to instability, and are more driven by niche processes. I would have expected the opposite to be true, more variance in the interactions leading to instability (as in May’s original paper for instance). Is this apparent paradox explained by covariations in demographic stochasticity (T) and immigration rate (lambda)? If so, I think it would be very useful to comment on that.</p>
</disp-quote>
<p>As Altieri and coworkers showed in their PRL (2021) [5], the phase diagram of our model differs fundamentally from that of Biroli et al. (2018) [6]. In the latter, the intuitive rule – greater interaction variance yields greater instability – indeed holds. For the sake of clarity, we have attached below the resulting phase diagram obtained by Altieri et al.</p>
<p>The apparent paradox arises because the two phase diagrams are tuned by different parameters. Consequently, even at low temperature and with weak interaction variance, our system may sit nearer to the replica-symmetrybreaking (RSB) line.</p>
<p>Fig. 3 in the main text it is not a (σ,T) phase diagram where all other parameters are kept constant. Rather, it is a plot of the inferred σ and T parameters from the data (without showing the corresponding µ).</p>
<p>To capture the full, non-trivial influence of all parameters on stability, we studied the so-called “replicon eigenvalue” in the RS (i.e. single equilibrium) approximation. This leading eigenvalue measures how close a given set of inferred parameters – and hence a microbiome – is to the RSB threshold. For a visual representation of these findings, refer to Figure 4.</p>
<fig id="sa4fig1">
<label>Author response image 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-105948-sa4-fig1.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>(4) What do the empirical SAD look like? It would be nice to see the actual data and how the theoretical SADs compare.</p>
</disp-quote>
<p>The empirical species abundance distributions (SADs) analyzed in our study are presented and discussed in detail in Pasqualini et al., 2024 [4]. Given the overlap in content, we chose not to reproduce these figures in the current manuscript to avoid redundancy.</p>
<p>As we also clarify in the revised text, the theoretical SAD is derived from the disordered generalized Lotka-Volterra (dGLV) model in the unique fixed point phase typically exhibit exponential tails. These distributions do not match the heavier-tailed patterns (e.g., log-normal or power-law-like) observed in empirical microbiome data. This discrepancy stems from the simplifying assumptions of the dGLV framework, including the use of constant carrying capacities and demographic noise.</p>
<p>In the revised manuscript, we have added a brief discussion in the revised manuscript to explicitly acknowledge this limitation and emphasize it as a direction for future refinement of the model, such as incorporating heterogeneous carrying capacities or exploring alternative noise structures.</p>
<disp-quote content-type="editor-comment">
<p>(5) Some typos: often “niche” is written “nice”.</p>
</disp-quote>
<p>We thank the reviewer for this suggestion. After inspecting the text, we corrected the reported typos.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3:</bold></p>
<p>Major comments:</p>
<p>(1) In the S3 text, the authors say that filtered metagenomic reads were processed using the software Kaiju. The description of the pipeline does not mention how core genes were selected, which is often a crucial step in determining the abundance of a species in a metagenomic sample. In addition, the senior author of this manuscript has published a version of Kaiju that leverages marker genes classification methods (deemed Core-Kaiju), but it was not used for either this manuscript or Pasqualini et al. (2014; Tovo et al., 2020). I am not suggesting that the data necessarily needs to be reprocessed, but it would be useful to know how core genes were chosen in Pasqualini et al. and why Core-Kaiju was not used (2014).</p>
</disp-quote>
<p>Prior to the current manuscript and the PLOS Computational Biology paper by Pasqualini et al. [4], we applied the core-Kaiju protocol to the same dataset used in both studies. However, this tool was originally developed and validated using general catalogs of culturable organisms, not specifically tuned for gut microbiomes. As a result, we have realized that in many samples Core Kajiu would filter only very few species (in some samples, the number of identified species was as low as 5–10), undermining the reliability of the analysis. Due to these limitations, we opted to use the standard Kaiju version in our work. We are actively developing an improved version of the core-Kaiju protocol that will overcome the discussed limitations and preliminary results (not shown here) indicate the robustness of the obtained patterns also in this case.</p>
<disp-quote content-type="editor-comment">
<p>(2) My understanding of Pasqualini et al. was that diseased patients experienced larger fluctuations in abundance, while in this study, they had smaller fluctuations (Figure 3a; 2024). Is this a discrepancy between the two models or is there a more nuanced interpretation?</p>
</disp-quote>
<p>We thank the reviewer for the observation. This is only an apparent discrepancy, as the term fluctuation has different meanings in the two contexts. The fluctuations referred to by the reviewer correspond to a parameter of our theory—namely, noise in the interactions. Conversely, in Pasqualini et al. σ indicates environmental fluctuations. Nevertheless, there is no conceptual discrepancy in our results: in both studies, unhealthy microbiomes were found to be less stable. In fact, also in this study, notably Fig. 4, shows that unhealthy microbiomes lie closer to the RSB line, a phenomenon that is also associated with enhanced fluctuations.</p>
<disp-quote content-type="editor-comment">
<p>(3) Line 38-41: It would be helpful to explicitly state what “interaction patterns” are being referenced here. The final sentence could also be clarified. Do microbiomes “host“ interactions or are they better described as a property (“have”, “harbor”). The word “host” may confuse some readers since it is often used to refer to the human host. I am also not sure what point is being made by “expected to govern natural ones”. There are interactions between members of a microbiome; experimental studies have characterized some of these interactions, which we expect to relate in some way to interactions in nature. Is this what the authors are saying?</p>
</disp-quote>
<p>Thanks. We agree that this sentence was not clear. Indeed, we are referring to pairwise species interactions and not to host-microbiome interactions. We have rewritten this part in the following way: In fact, recent work shows that the network-level properties of species-species interactions —for example, the sign balance, average strength, and connectivity of the inferred interaction matrix— shift systematically between healthy and dysbiotic gut communities (see for instance, [7, 8]). Pairwise species interactions have been quantified in simplified in-vitro consortia [9, 10]; we assume that the same classes of interactions also operate—albeit in a more complex form—in the native gut microbiome.</p>
<disp-quote content-type="editor-comment">
<p>(4) Line 43: I appreciate that the authors separated neutral vs. logistic models here.</p>
<p>(5) Lines 51-75: The framing here is well-written and convincing. Network inference is an ongoing, active subject in ecology, and there is an unfortunate focus on inferring every individual interaction because ecologists with biology backgrounds are not trained to think about the problem in the language of statistical physics.</p>
</disp-quote>
<p>We thank the reviewer for these positive comments.</p>
<disp-quote content-type="editor-comment">
<p>(6) Line 87: Perhaps I’m missing something obvious, but I don’t see how ρi sets the intrinsic timescale of the dynamics when its units are 1/(time*individuals), assuming the dimensions of ri are inverse time.</p>
</disp-quote>
<p>We thank the reviewer for the observation. We corrected this phrase in the main text.</p>
<disp-quote content-type="editor-comment">
<p>(7) Lines 189-190: “as close as possible to the data” it would aid the reader if you specified the criteria meant by this statement.</p>
</disp-quote>
<p>We thank the reviewer for the observation. We removed the sentence, as it introduced some redundancy in our argument. In the subsequent text, the proposed method is exposed in details.</p>
<disp-quote content-type="editor-comment">
<p>(8) Line 198: It would aid the reader if you provided some context for what the T - σ plane represents.</p>
</disp-quote>
<p>We thank the referee for the helpful indication. Indeed, we have better clarified the mutual role of the demographic noise amplitude and strength of the random interaction matrix, as theoretically predicted in the PRL (2021) by Altieri and coworkers [5]. Please, find an additional paragraph on page 6 of the resubmitted version.</p>
<disp-quote content-type="editor-comment">
<p>(9) Line 217: Specifying what is meant by “internal modes“ would aid the typical life science reader.</p>
</disp-quote>
<p>We thank the reviewer for the suggestion. Recognizing that referring to “internal modes” to describe the SAD shape in that context might cause confusion, we replaced “internal modes“ with “peaks”.</p>
<disp-quote content-type="editor-comment">
<p>(10) Line 219: Some additional justification and clarification are needed here, as some may think of “m“ as being biomass.</p>
</disp-quote>
<p>We added a sentence to better explain this concept. “In classical and quantum field theory, the particle-particle interaction embedded in the quadratic term is typically referred to as a mass source. In the context of this study, <inline-formula id="sa4equ3"><inline-graphic xlink:href="elife-105948-sa4-equ3.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> captures quadratic fluctuations of species abundances, as also appearing in the expression of the leading eigenvalue of the stability matrix.”</p>
<disp-quote content-type="editor-comment">
<p>Minor comments:</p>
<p>(1) I commend the authors for removing metagenomic reads that mapped to the human genome in the preprocessing stage of their pipeline. This may seem like an obvious pre-processing step, but it is unfortunately not always implemented.</p>
</disp-quote>
<p>We thank the referee for pointing this potential issue. The data used in this work, as well as the bioinformatic workflow used to generate them has been described in detail in Pasqualini et al., 2024 [4]. As one of the main steps for preprocessing, we remove reads mapping to the human genome.</p>
<disp-quote content-type="editor-comment">
<p>(2) Line 13: “Bacterial“ excludes archaea, and while you may not have many high-abundance archaea in your human gut data, this sentence does not specify the human gut. Usually, this exclusion is averted via the term “microbial“, though sometimes researchers raise objections to the term when the data does not include fungal members (e.g., all 16S studies).</p>
</disp-quote>
<p>We thank the reviewer for this suggestion. As to include archaeal organisms, we adopt the term “microbial“ instead of “bacterial“.</p>
<disp-quote content-type="editor-comment">
<p>(3) Line 18: This manuscript is being submitted under the “Physics of Living Systems“ tract, but it may be useful to explicitly state in the Abstract that disordered systems are a useful approach for understanding large, complex communities for the benefit of life science researchers coming from a biology background.</p>
</disp-quote>
<p>Thank. We have modified the abstract following this suggestion.</p>
<disp-quote content-type="editor-comment">
<p>(4) Line 68: Consider using “adapted“ or something similar instead of “mutated“ if there is no specific reason for that word choice.</p>
</disp-quote>
<p>We thank the reviewer for this suggestion, which was implemented in the text.</p>
<disp-quote content-type="editor-comment">
<p>(5) Line 111: It would be useful to define annealed and quenched for a general life science audience.</p>
</disp-quote>
<p>We thank the reviewer for this suggestion. In the “Results” section, we have opted for “time-dependent disordered interactions” to reach a broader audience and avoid any jargon. Moreover, in the Discussion we added a detailed footnote: “In contrast to the quenched approximation, the annealed version assumes that the random couplings are not fixed but instead fluctuate over time, with their covariance governed by independent Ornstein–Uhlenbeck processes.”</p>
<disp-quote content-type="editor-comment">
<p>(6) Line 124: Likewise for the replicon sector.</p>
</disp-quote>
<p>We thank the reviewer for the suggestion. We added a footnote on page 4, after the formula, to highlight the physical intuition behind the introduction of the replicon mode.</p>
<p>“The replicon eigenvalue refers to a particular type of fluctuation around the saddle-point (mean-field) solution within the replica framework. When the Hessian matrix of the replicated free energy is diagonalized, fluctuations are divided into three sectors: longitudinal, anomalous, and replicon. The replicon mode is the most sensitive to criticality signaling – by its vanishing trend – the emergence of many nearly-degenerate states. It essentially describes how ‘soft’ the system is to microscopic rearrangements in configuration space.”</p>
<disp-quote content-type="editor-comment">
<p>(7) Figure 2: It would be helpful to include y-axis labels for each order parameter alongside the mathematical notation.</p>
</disp-quote>
<p>We thank the reviewer for this suggestion. Now the y-axis of Figure 2 includes, along the mathmetical symbol, the label of the represented quantities.</p>
<disp-quote content-type="editor-comment">
<p>(8) Line 242: Subscript “U” is used to denote “Unhealthy” microbiomes, but “D” is used to denote “Diseased” in Figs. 2 and 3 (perhaps elsewhere as well).</p>
</disp-quote>
<p>We thank the reviewer for this observation. After checking the various subscripts in the text, coherently with figure 2 and 3, we homogenized our notation, adopting the subscript “D“ for symbols related to the diseased/unhealthy condition.</p>
<disp-quote content-type="editor-comment">
<p>(9) Line 283: “not to“ should be “not due to“</p>
</disp-quote>
<p>We thank the reviewer for this suggestion. After inspecting the text, we corrected the reported error.</p>
<disp-quote content-type="editor-comment">
<p>(10) Equations 23, 34: Extra “=“ on the RHS of the first line.</p>
</disp-quote>
<p>We consistently follow the same formatting across all the line breaks in the equations throughout the text.</p>
<p>We are thus resubmitting our paper, hoping to have satisfactorily addressed all referees’ concerns.</p>
<p><bold>References</bold></p>
<p>(1) Jacopo Grilli. Macroecological laws describe variation and diversity in microbial communities. Nature communications, 11(1):4743, 2020.</p>
<p>(2) Guy Bunin. Ecological communities with lotka-volterra dynamics. Physical Review E, 95(4):042414, 2017.</p>
<p>(3) Matthieu Barbier, Jean-Franc¸ois Arnoldi, Guy Bunin, and Michel Loreau. Generic assembly patterns in complex ecological communities. Proceedings of the National Academy of Sciences, 115(9):2156–2161, 2018.</p>
<p>(4) Jacopo Pasqualini, Sonia Facchin, Andrea Rinaldo, Amos Maritan, Edoardo Savarino, and Samir Suweis. Emergent ecological patterns and modelling of gut microbiomes in health and in disease. PLOS Computational Biology, 20(9):e1012482, 2024.</p>
<p>(5) Ada Altieri, Felix Roy, Chiara Cammarota, and Giulio Biroli. Properties of equilibria and glassy phases of the random lotka-volterra model with demographic noise. Physical Review Letters, 126(25):258301, 2021.</p>
<p>(6) Giulio Biroli, Guy Bunin, and Chiara Cammarota. Marginally stable equilibria in critical ecosystems. New Journal of Physics, 20(8):083051, 2018.</p>
<p>(7) Amir Bashan, Travis E Gibson, Jonathan Friedman, Vincent J Carey, Scott T Weiss, Elizabeth L Hohmann, and Yang-Yu Liu. Universality of human microbial dynamics. Nature, 534(7606):259–262, 2016.</p>
<p>(8) Marcello Seppi, Jacopo Pasqualini, Sonia Facchin, Edoardo Vincenzo Savarino, and Samir Suweis. Emergent functional organization of gut microbiomes in health and diseases. Biomolecules, 14(1):5, 2023.</p>
<p>(9) Jared Kehe, Anthony Ortiz, Anthony Kulesa, Jeff Gore, Paul C Blainey, and Jonathan Friedman. Positive interactions are common among culturable bacteria. Science advances, 7(45):eabi7159, 2021.</p>
<p>(10) Ophelia S Venturelli, Alex V Carr, Garth Fisher, Ryan H Hsu, Rebecca Lau, Benjamin P Bowen, Susan Hromada, Trent Northen, and Adam P Arkin. Deciphering microbial interactions in synthetic human gut microbiome communities. Molecular systems biology, 14(6):e8157, 2018.</p>
</body>
</sub-article>
</article>