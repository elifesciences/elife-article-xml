<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">92497</article-id>
<article-id pub-id-type="doi">10.7554/eLife.92497</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.92497.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Physics of Living Systems</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Exploiting fluctuations in gene expression to detect causal interactions between genes</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3792-2231</contrib-id>
<name>
<surname>Joly-Smith</surname>
<given-names>Euan</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Talpur</surname>
<given-names>Mir Mikdad</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0006-8049-4793</contrib-id>
<name>
<surname>Allard</surname>
<given-names>Paige</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5934-0489</contrib-id>
<name>
<surname>Papazotos</surname>
<given-names>Fotini</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7876-2820</contrib-id>
<name>
<surname>Potvin-Trottier</surname>
<given-names>Laurent</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2411-6775</contrib-id>
<name>
<surname>Hilfinger</surname>
<given-names>Andreas</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a6">6</xref>
<xref ref-type="aff" rid="a7">7</xref>
<email>andreas.hilfinger@utoronto.ca</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>Department of Physics, University of Toronto</institution></institution-wrap>, <city>Toronto</city>, <country country="CA">Canada</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>Department of Chemical &amp; Physical Sciences, University of Toronto Mississauga</institution></institution-wrap>, <city>Mississauga</city>, <country country="CA">Canada</country></aff>
<aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0420zvk78</institution-id><institution>Centre for Applied Synthetic Biology, Concordia University</institution></institution-wrap>, <city>Montréal</city>, <country country="CA">Canada</country></aff>
<aff id="a4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0420zvk78</institution-id><institution>Department of Biology, Concordia University</institution></institution-wrap>, <city>Montréal</city>, <country country="CA">Canada</country></aff>
<aff id="a5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0420zvk78</institution-id><institution>Department of Physics, Concordia University</institution></institution-wrap>, <city>Montréal</city>, <country country="CA">Canada</country></aff>
<aff id="a6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>Department of Mathematics, University of Toronto</institution></institution-wrap>, <city>Toronto</city>, <country country="CA">Canada</country></aff>
<aff id="a7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03dbr7087</institution-id><institution>Department of Cell &amp; Systems Biology, University of Toronto</institution></institution-wrap>, <city>Toronto</city>, <country country="CA">Canada</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Shou</surname>
<given-names>Wenying</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University College London</institution>
</institution-wrap>
<city>London</city>
<country>United Kingdom</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Walczak</surname>
<given-names>Aleksandra M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>CNRS</institution>
</institution-wrap>
<city>Paris</city>
<country>France</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-01-25">
<day>25</day>
<month>01</month>
<year>2024</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-04-22">
<day>22</day>
<month>04</month>
<year>2025</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP92497</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-09-18">
<day>18</day>
<month>09</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-09-04">
<day>04</day>
<month>09</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.09.01.555799"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-01-25">
<day>25</day>
<month>01</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.92497.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.92497.1.sa2">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.92497.1.sa1">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.92497.1.sa0">Reviewer #2 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Joly-Smith et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Joly-Smith et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-92497-v2.pdf"/>
<abstract>
<p>Characterizing and manipulating cellular behaviour requires a mechanistic understanding of the causal interactions between cellular components. We present an approach to detect causal interactions between genes without the need to perturb the physiological state of cells. This approach exploits naturally occurring cell-to-cell variability which is experimentally accessible from static population snapshots of genetically identical cells without the need to follow cells over time. Our main contribution is a simple mathematical relation that constrains the propagation of gene expression noise through biochemical reaction networks. This relation allows us to rigorously interpret fluctuation data even when only a small part of a complex gene regulatory process can be observed. We show how this relation can, in theory, be exploited to detect causal interactions by synthetically engineering a passive reporter of gene expression, akin to the established “dual reporter as-say”. While the focus of our contribution is theoretical, we also present an experimental proof-of-principle to demonstrate the real-world applicability of our approach in certain circumstances. Our experimental data suggest that the method can detect causal interactions in specific synthetic gene regulatory circuits in <italic>E. coli</italic> confirming our theoretical result in a narrow set of controlled experimental settings. Further work is needed to show that the approach is practical on a large scale, with naturally occurring gene regulatory networks, or in organisms other than <italic>E. coli</italic>.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>In response to peer review comments, we have clarified statements throughout the manuscript. In particular the abstract, introduction, discussion have been rewritten to clarify what we claim to have shown versus what work remains to be done. The supplemental file has also been updated.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s0">
<title>Introduction</title>
<p>Translating molecular abundance data into mechanistic models of cellular processes remains a major challenge of systems biology. High-throughput experimental techniques routinely produce statistical associations between genes through correlation measurements of gene expression variability [<xref ref-type="bibr" rid="c1">1</xref>–<xref ref-type="bibr" rid="c5">5</xref>]. While such statistical associations can provide insightful clues, they do not directly identify causal interactions: even if two components <italic>X</italic> and <italic>Z</italic> are non-spuriously correlated, we cannot conclude that <italic>X</italic> affects <italic>Z</italic> because the causal connection could be reversed or a confounding factor could be regulating both components, even with statistical associations that go beyond correlations such as Granger causality [<xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c7">7</xref>].</p>
<p>Perturbation experiments are a conceptually simple solution to avoid this problem and directly infer causal relationships in gene regulatory networks [<xref ref-type="bibr" rid="c8">8</xref>–<xref ref-type="bibr" rid="c10">10</xref>]. However, they come with practical challenges: drug perturbations can affect multiple targets at once [<xref ref-type="bibr" rid="c11">11</xref>] and genetic perturbations, e.g., through changing gene copy numbers, are not guaranteed to keep cells in their physiologically relevant regime [<xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c13">13</xref>]. For large enough perturbations, everything is expected to affect everything else in the cell.</p>
<p>Here we present a novel mathematical relation which can, in theory, be exploited to infer directional causal interactions between cellular components by utilizing stochastic fluctuations of cellular abundances in unperturbed cells. Existing work on analyzing non-genetic variability has focused on testing completely specified mechanistic models against such fluctuation data [1, 14– 17]. However, completely specifying mechanistic models of cellular processes often requires making a large number of assumptions about unknown details, which can make inferences based on such an approach unreliable [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>].</p>
<p>We thus propose a novel inference method to detect whether a gene <italic>X</italic> causally affects a gene <italic>Z</italic> by exploiting a mathematical identity that constrains an entire class of models. Under certain assumptions, we show how covariability measurements of molecular abundances can, in theory, be used to detect causal interactions by specifying only “local” aspects of the underlying gene expression dynamics [<xref ref-type="bibr" rid="c19">19</xref>–<xref ref-type="bibr" rid="c21">21</xref>].</p>
<p>Experimentally, our proposed inference method is based on an approach similar to the “dual reporter assay” [<xref ref-type="bibr" rid="c22">22</xref>–<xref ref-type="bibr" rid="c25">25</xref>] previously established to quantify stochastic fluctuations in expression differences between copies of a gene of interest. However, instead of analyzing the covariance between the dual reporters, we focus on the covariance of each reporter with a third component of biological interest. We prove that under broad conditions these covariances must be identical in the absence of the causal interaction we wish to establish. Violations of this relation can thus be used to detect causal interactions.</p>
<p>To illustrate the generality of our analytically proven covariance identity, we numerically verify the result in a wide variety of example systems. Additionally, we present an experimental proof-of-principle for a specific set of synthetically constructed gene regulatory circuits in <italic>E. coli</italic> with known interactions. The data establish a baseline estimate for the accuracy of our approach with current experimental methods. Despite the arguable occurrence of a false positive result, the experimental data support our hypothesis that single-cell variability measurements might prove useful in detecting causal interactions in gene regulatory networks.</p>
<p>However, we have not shown that the approach is practical on a large scale, we have not tested our approach using naturally occurring gene regulatory networks, and we have not tested our approach in organisms other than <italic>E. coli</italic>. Additional experimental tests beyond our proof-of-principle demonstration are thus needed to establish the scalability of our method and to show that the method reliably detects causal interactions between endogenous genes in more general experimental settings.</p>
</sec>
<sec id="s1">
<title>Results</title>
<sec id="s1a">
<title>Invariant covariance relation in the absence of causal interactions</title>
<p>Our main mathematical result is a covariance invariant that constrains the fluctuations of two molecular species in a partially specified reaction network. We consider a molecular species of interest <italic>X</italic> that is subject to first-order degradation and is made with an unspecified and time-varying production rate. A reporter species <italic>Y</italic> acts as an identical but separate copy of <italic>X</italic> that is subject to the same control input. This specifies the following stochastic reactions within a larger reaction network
<disp-formula id="eqn1">
<graphic xlink:href="555799v2_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Here <italic>x</italic> and <italic>y</italic> denote the number of copies of molecular species <italic>X</italic> and <italic>Y</italic> respectively, <italic>α</italic> is an arbitrary proportionality constant, and the shared production rate <italic>R</italic> can depend in arbitrary ways on the abundances <italic>z</italic><sub><italic>k</italic></sub> of any cellular component (including <italic>X</italic> and <italic>Y</italic> themselves), collectively denoted as <bold>Z</bold> := {<italic>Z</italic><sub>1</sub>, <italic>Z</italic><sub>2</sub>,<italic>…</italic>} The birth-death events denoted in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> produce or remove one molecule of <italic>X</italic> or <italic>Y</italic> at a time and occur stochastically with the state-dependent rates indicated above the arrows.</p>
<p>If the level of <italic>X</italic> affects the rate of production or degradation of another component, say <italic>Z</italic><sub>3</sub>, we say <italic>X</italic> causally affects <italic>Z</italic><sub>3</sub> and we define causal effects transitively, i.e., if <italic>X</italic> affects <italic>Z</italic><sub>3</sub>, and <italic>Z</italic><sub>3</sub> affects <italic>Z</italic><sub>5</sub>, then <italic>X</italic> affects <italic>Z</italic><sub>5</sub>. In other words, <italic>X</italic> causally affects a cellular component if a directed path can be drawn from <italic>X</italic> to said component in the biochemical reaction network as illustrated in <xref rid="fig1" ref-type="fig">Fig. 1A</xref></p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Causal interactions between genes can be inferred when non-genetic cell-to-cell variability violates the covariance invariant of <xref ref-type="disp-formula" rid="eqn2">Eq.(2)</xref>.</title>
<p><bold>A)</bold> Consider an arbitrary network of interacting cellular components in which an engineered reporter <italic>Y</italic> is introduced to act as a passive read-out of the transcriptional signal that regulates a gene of interest <italic>geneX</italic>, but itself does not regulate other cellular components. Any cellular component belongs to one of two groups: components affected by <italic>X</italic> (red circles), and components not affected by <italic>X</italic> (blue squares), where the arrows indicate directed causal biochemical effects. Specifically, an arrow from <italic>Zi</italic> to <italic>Zj</italic> denotes the existence of a reaction that changes <italic>Zj</italic> with a rate that depends on <italic>Zi</italic> (see SI for details). <bold>B)</bold> The dashed line of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> constrains the normalized covariance between <italic>X</italic> and any cellular component <italic>Z</italic><sub><italic>k</italic></sub> not affected by <italic>X</italic> (blue squares). In contrast, components <italic>Z</italic><sub><italic>k</italic></sub> affected by <italic>X</italic> (red circles), are not constrained by <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>. A violation of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> thus implies the existence of a causal interaction from <italic>X</italic> to <italic>Z</italic><sub><italic>k</italic></sub>. Data points are numerical simulations of specific example networks (see SI for details) to illustrate the analytically proven theorem of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>. <bold>C)</bold> The invariant of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> applies not only to transcriptional reporters but also when <italic>X</italic> and <italic>Y</italic> correspond to co-regulated fluorescent proteins with translation rates that scale with transcript abundances.</p></caption>
<graphic xlink:href="555799v2_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p><italic>Theorem</italic>: if neither <italic>X</italic> nor <italic>Y</italic> causally affect a third cellular component of interest <italic>Z</italic><sub><italic>k</italic></sub> ∈ <bold>Z</bold>, then
<disp-formula id="eqn2">
<graphic xlink:href="555799v2_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>where angular brackets denote ensemble averages, and <italic>η</italic><sub><italic>zk</italic></sub><italic>x</italic> denotes the normalized covariance between <italic>Z</italic><sub><italic>k</italic></sub> and <italic>X</italic> in a population of genetically identical cells that have reached a time-independent distribution of cell-to-cell variability and do not exhibit permanently zero degradation rates for <italic>X</italic> and <italic>Y</italic>.</p>
<p><xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> makes no assumptions on the interactions of all the unspecified cellular components and allows arbitrary effects from the component of interest <italic>Z</italic><sub><italic>k</italic></sub> onto <italic>X</italic> and <italic>Y</italic>. The invariant constrains any cellular component <italic>Z</italic><sub><italic>k</italic></sub> that is not affected by <italic>X</italic> and <italic>Y</italic> as long as the “local” dynamics of <italic>X</italic> and <italic>Y</italic> is given by <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>. The detailed proof of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> is presented in SI. The key condition under which it holds is that the non-genetic population variability has reached a stationary state. In systems in which there is uncertainty about this condition it can be directly verified experimentally.</p>
<p>Note, a violation of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> implies the presence of a causal connection but not vice versa. This is a logical necessity because the dynamics of causally connected genes can be arbitrarily close to that of non-interacting genes.</p>
<p>In a later section, we discuss further generalizations of the dual reporter class defined in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>, allowing for growing and dividing cells, measurement noise, and fluctuations in degradation rates as would be relevant for its application to experimental single-cell data. Note that due to the possibility of feedback, the dynamics of <italic>X</italic> and <italic>Y</italic> is not generally symmetric even though <italic>X</italic> and <italic>Y</italic> are co-regulated [<xref ref-type="bibr" rid="c20">20</xref>], see Fig. S1A. <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> is a statement about stochastic covariability and not a trivial relation based on the (incorrect) assumption that <italic>x</italic>(<italic>t</italic>) = <italic>y</italic>(<italic>t</italic>). For example, the Pearson correlation coefficients <inline-formula><inline-graphic xlink:href="555799v2_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are not necessarily equal even when <italic>X</italic> and <italic>Y</italic> do not affect <italic>Z</italic><sub><italic>k</italic></sub>, see <xref rid="fig2" ref-type="fig">Fig. 2</xref> and Fig. S1B.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Numerical simulations of example systems confirm computationally that the analytically proven <xref ref-type="disp-formula" rid="eqn2">Eq.(2)</xref> constrains cellular abundances and concentrations in growing and dividing cells under fairly general assumptions as long as <italic>X</italic> does not affect <italic>Z</italic>.</title>
<p><bold>A)</bold> To numerically demonstrate the validity of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> we consider ten example birth-death processes covering six different network topologies with non-linear rates, closed-loop feedback, time-varying upstream signals, and fluctuating degradation rates. In all cases chemical species <italic>X</italic> and <italic>Y</italic> are co-regulated but do not affect a third chemical species <italic>Z</italic> of interest. See supplemental Table S1 for details of the simulated systems. <bold>B)</bold> We consider three different cellular growth dynamics that affect molecular abundances through random partitioning of molecules at cell division and molecular concentrations through dilution. Additionally, system reaction rates depend in varying ways on the cell volume. At cell-division, molecular abundances are assumed to be partitioned on average proportional to cell size. <bold>C)</bold> Simulation results for each of the example topologies from panel A, subject to the different growth dynamics of panel B. Model parameters were varied over several orders of magnitude. The numerically obtained Pearson correlations do not satisfy a general relation whereas normalized covariances satisfy <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> for absolute abundances as well as concentrations. Colors correspond to the topologies indicated in panel A (results for individual topologies are compared in supplemental Figs. S3 and S4). For each dot, single-cell trajectories of 20,000 cell divisions were simulated at least 40 times, with the center of the dot corresponding to the average of the simulation ensemble (see Materials and Methods).</p></caption>
<graphic xlink:href="555799v2_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s1b">
<title>Detecting causal interactions between genes through experimentally engineered “dual reporters”</title>
<p>Violation of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> can be used to experimentally deduce the existence of a causal effect from a gene of interest <italic>X</italic> onto another gene of interest Z<sub><italic>k</italic></sub> as follows. If we engineer a co-regulated “dual reporter” system with the properties defined in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>, in which <italic>Y</italic> is a passive reporter (i.e., it does not significantly interact with other cellular components) that responds to the same input as <italic>X</italic>, then a violation of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> implies that changes in <italic>X</italic> must causally affect the abundance of component Z<sub><italic>k</italic></sub>. This is because intrinsic fluctuations from the expression of <italic>X</italic> propagate through the network and affect Z<sub><italic>k</italic></sub>, but those from the passive reporter <italic>Y</italic> do not. As detailed next, this approach can be applied to dual reporters for gene expression both on the transcriptional as well as the translational level, see <xref rid="fig1" ref-type="fig">Fig. 1</xref>.</p>
<sec id="s1b1">
<title>Transcriptional dual reporters</title>
<p>Consider two genes of interest, <italic>geneX</italic> with transcript <italic>X</italic> and <italic>geneZ</italic> with transcript <italic>Z</italic><sub><italic>k</italic></sub>. Our approach relies on engineering a passive reporter gene <italic>geneY</italic> with identical transcriptional control to <italic>geneX</italic> and mRNA lifetime, but with transcript that does not affect other cellular components, see <xref rid="fig2" ref-type="fig">Fig. 2A</xref>. This could be achieved with a transcriptional reporter that is put under control of the same promoter as <italic>geneX</italic> and placed at a similar gene locus. One way to ensure that <italic>geneY</italic> interacts minimally with other cellular components would be to remove its start codon so that it will not be translated into a protein.</p>
<p>Co-regulated mRNA reporters have been engineered to satisfy the assumptions underlying <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>, with transcripts counted with smFISH [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c26">26</xref>]. Alternatively, future improvements in RNAseq [<xref ref-type="bibr" rid="c27">27</xref>–<xref ref-type="bibr" rid="c29">29</xref>] accuracy might allow for reliable fluctuation measurements of transcript levels in single-cells through sequencing approaches.</p>
</sec>
<sec id="s1b2">
<title>Translational dual reporters</title>
<p>The dual reporter assay has been frequently implemented as co-regulated fluorescent proteins [<xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c30">30</xref>]. The invariant of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> directly applies when <italic>X</italic> and <italic>Y</italic> are co-regulated fluorescent proteins with first-order translation rates and maturation times (see SI Sec. 4 B for details of the proof). Fluorescent proteins can then be used to detect causal interactions in gene regulation as follows. The gene of interest <italic>geneX</italic> is fused to a fluorescent protein to make a functional fusion <italic>geneX-FP</italic>.</p>
<p>A passive reporter protein <italic>Y</italic> is made by introducing a spectrally distinguishable fluorescent protein <italic>Y</italic> under the control of the same (but distinct) promoter as <italic>geneX-FP</italic>. The expression level <italic>z</italic><sub><italic>k</italic></sub> of <italic>geneZ</italic> can be measured either through a transcriptional reporter or a functional fusion protein with a third fluorescence reporter. Under the assumption that the fluorescent protein <italic>Y</italic> does not directly affect other cellular components, <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> directly applies to the covariances of fluorescence levels as long as <italic>X</italic> does not causally affect <italic>Z</italic><sub><italic>k</italic></sub>. As the normalized covariances in <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> are independent of scaling factors, standard fluorescence microscopy methods can be used without the need to determine absolute numbers. Two stable fluorescent proteins with similar maturation times [<xref ref-type="bibr" rid="c31">31</xref>] should be chosen to ensure that the assumptions underlying the class of systems is satisfied. Additionally, the translation rates of <italic>X</italic> and <italic>Y</italic> need not be identical, but can be proportional with a fluctuating proportionality factor as defined in the transitions of <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>. As a result, different fluorescent proteins with different ribosome binding sites, mRNA secondary structures, and gene lengths, can be used as long as the translation rates remain proportional.</p>
</sec>
</sec>
<sec id="s1c">
<title>Typical experimental single-cell data can be analyzed using the invariant relation of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref></title>
<p>In the above sections we introduced the main mathematical result and presented the basic logic of how it can be experimentally exploited using synthetically engineered gene expression reporters. Next, we describe how <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> generalizes to the broader class of systems necessary to analyze single-cell experimental data.</p>
<sec id="s1c1">
<title><xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> constrains abundances in growing &amp; dividing cells</title>
<p>The class of stochastic processes presented in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> constrains the dynamics of cellular abundances in stationary processes. However, experimental data typically report measurements of growing and dividing cells. Under the assumption that during cell division, molecular abundances are divided on average proportional to cell size, we can show (see SI) that <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> must be satisfied by the dual reporter abundances when <italic>Z</italic><sub><italic>k</italic></sub> is a component not affected by <italic>geneX</italic>. In this analysis of cellular growth and division, we allow for partitioning noise, division time fluctuations, asymmetric divisions, and arbitrary growth-rate dynamics. see <xref rid="fig2" ref-type="fig">Fig. 2B</xref>.</p>
</sec>
<sec id="s1c2">
<title><xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> constrains concentrations in growing &amp; dividing cells</title>
<p>Chemical reaction rates typically depend on molecular concentrations and not absolute abundance numbers. Under general assumptions (see SI Sec. 12), we can show that the covariance constraint of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> describes molecular concentrations in growing and dividing cells, see <xref rid="fig2" ref-type="fig">Fig. 2</xref>. This result assumes that the abundance of <italic>X</italic> does not affect cell volume or growth rate. This requirement can be intuitively understood, because if <italic>X</italic> affects cell volume then it causally affects the concentration of <italic>Z</italic><sub><italic>k</italic></sub> which depends on volume (see SI Sec. 12).</p>
</sec>
<sec id="s1c3">
<title><xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> applies to reporters with fluctuating degradation rates and fluctuating translation rates</title>
<p>The class of systems defined in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> assumes that the dual reporters are degraded in a first-order process with a constant rate parameter <italic>β</italic>, see <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>. This assumption can be relaxed: the invariant of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> generalizes to the class of systems in which the degradation rate constant is an arbitrary function of all the cellular components that are not affected by the dual reporters, as long as it does not decay to zero (see SI Sec. 4). As a result, the degradation constant can vary in time with arbitrary extrinsic fluctuations. Additionally, for the class of co-regulated fluorescent proteins, the translation rate parameters can also vary with arbitrary extrinsic fluctuations.</p>
</sec>
<sec id="s1c4">
<title>A rule for detecting causality in the face of measurement uncertainty</title>
<p>Under the null hypothesis that there is no causal interaction from <italic>X</italic> to <italic>Z</italic>, <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> is equivalent to <italic>r</italic> = 1, where <italic>r</italic> = <italic>η</italic><sub><italic>xz</italic></sub><italic>/η</italic><sub><italic>yz</italic></sub> is the covariability ratio. Given 95% confidence intervals for an experimentally measured covariability ratio, we can conclude at the 2.5% significance level that there is a causal interaction from <italic>X</italic> to <italic>Z</italic> if <italic>r</italic> = 1 falls outside of the 95% confidence interval of the data (see Fig. S2 for an example)</p>
</sec>
<sec id="s1c5">
<title>In silico validation of analytical results</title>
<p>In order to illustrate the generality of the above results and to perform a numerical sanity check, we simulated several stochastic birth-death systems in growing and dividing cells, see <xref rid="fig2" ref-type="fig">Fig. 2</xref>. We modelled 10 systems made up of 6 network topologies in which a component <italic>Z</italic> is correlated with <italic>X</italic> and <italic>Y</italic> but is not affected by <italic>X</italic>, see <xref rid="fig2" ref-type="fig">Fig. 2A</xref>. These systems include cellular components with non-linear reaction rates and feedback loops, fluctuating degradation rates, and confounding variables that affect all observed components. We analyzed each system subject to three different cellular growth dynamics: periodic exponential growth, periodic linear growth, and linear growth with fluctuating cell-division times and division sizes, see <xref rid="fig2" ref-type="fig">Fig. 2B</xref>.</p>
<p>To numerically test <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>, we generated random sample paths for abundances and concentrations using the Gillespie algorithm [<xref ref-type="bibr" rid="c32">32</xref>, <xref ref-type="bibr" rid="c33">33</xref>]. System parameters were varied over several orders of magnitude. The numerical data verify that the normalized covariances of cellular abundances as well as cellular concentrations satisfy <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> in growing and dividing cells, see <xref rid="fig2" ref-type="fig">Fig. 2C</xref>. The same does not hold for the corresponding Pearson correlation coefficients, see <xref rid="fig2" ref-type="fig">Fig. 2C</xref>. Note, due to finite sampling, any numerical simulation will necessarily show small deviations from the exact equality of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>. Through statistical analyses and re-running systems for increased sampling, we confirmed that the (minuscule) deviations observed in numerical simulations were consistent with finite sampling, see Materials and Methods.</p>
<p>In SI Sec. 14 we simulate a larger example network made of 10 components in which <italic>X</italic> regulates a cascade of components. The results suggest that the relative distance down a regulatory cascade can be inferred from the degree of violation of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>, see Fig. S13.</p>
</sec>
<sec id="s1c6">
<title><xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> constrains data with significant measurement noise</title>
<p>Experimental techniques to measure mRNA abundances or fluorescence levels potentially introduce significant measurement noise. For example, when counting mRNA abundances, smFISH can lead to probabilistic undercounting noise and fluorescence microscopy can report fluorescence levels that includes photon noise, read noise, and segmentation errors, while flow cytometry introduces Poisson noise when used with bacteria [<xref ref-type="bibr" rid="c34">34</xref>].</p>
<p>The invariant of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> holds in the face of measurement noise as long as the noise is symmetric in <italic>X</italic> and <italic>Y</italic> measurements. We can show (SI Sec. 16) that <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> holds in systems with arbitrary multiplicative noise that is independent of the <italic>X</italic> and <italic>Y</italic> signals, and additive noise that is independent of <italic>Z</italic><sub><italic>k</italic></sub>. Additionally, the invariant holds in the face of systematic undercounting that introduces a binomial readout of the signal of interest, along with Poisson-Gaussian noise. If, however, the experiment introduces a different type of noise in <italic>X</italic> as compared to <italic>Y</italic>, then <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> is no longer valid. It is thus important to choose similar measurement techniques while measuring the abundances of <italic>X</italic> and its passive reporter <italic>Y</italic>.</p>
</sec>
</sec>
<sec id="s1d">
<title>Experimental proof-of-principle</title>
<p>Whether the above theoretical approach works in practice depends on two crucial questions: Can we reliably build dual reporter systems that satisfy the assumptions underlying <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>? Are experimental violations of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> larger than measurement uncertainties for current experimental techniques?</p>
<p>As a first test to address these questions we present an experimental proof-of-principle using synthetically engineered gene regulatory circuits in <italic>E. coli</italic>. These circuits consist of variants of the “repressilator”, a celebrated synthetic control circuit in which three genes respectively repress each other [<xref ref-type="bibr" rid="c35">35</xref>, <xref ref-type="bibr" rid="c36">36</xref>].</p>
<sec id="s1d1">
<title>Causally connected genes that break the invariant</title>
<p>Inherent to our fluctuation approach is the direction of inference, i.e., violations of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> imply the presence of a causal connection, whereas agreement with <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> does not imply the absence of causal interactions. The question thus becomes whether a biologically relevant genetic circuit with known causal connections ever breaks our covariance relation.</p>
<p>We engineered four synthetic circuits in which a TetR-YFP fusion protein (<italic>X</italic>) represses an RFP reporter (<italic>Z</italic>), and a passive CFP reporter (<italic>Y</italic>) is under the same transcriptional control as <italic>X</italic>, see <xref rid="fig3" ref-type="fig">Fig. 3A</xref>. While the circuits differ in dynamics and connections, <italic>X</italic> affects <italic>Z</italic> in all cases. See SI Table. S2 for details of the synthetic circuits #1–4. Using time-lapse fluorescent microscopy with cells growing in a microfluidic device (see <xref rid="fig3" ref-type="fig">Fig. 3C</xref>), we measured the normalized covariances from populations of genetically identical cells with high accuracy while discarding all temporal information.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Experimental data from all but one synthetic regulatory circuit are consistent with the theory.</title>
<p><bold>A)</bold> In all synthetic circuits, we considered TetR as our protein of interest (<italic>X</italic>) fused to YFP to allow for quantification through fluorescence microscopy. CFP (<italic>Y</italic>) was used as a passive read-out of the transcriptional control of <italic>tetR</italic> by placing it under the control of a copy of the same <italic>P</italic><sub><italic>LlacO</italic>1</sub> promoter as <italic>tetR</italic>. In all synthetic circuits <italic>X</italic> and <italic>Y</italic> are thus co-regulated by the LacI protein. <bold>B)</bold> We constructed two different types of synthetic circuits using the repressilator motif [<xref ref-type="bibr" rid="c35">35</xref>] as a basis. Left: example circuit in which TetR (<italic>X</italic>) causally affects a RFP reporter (<italic>Z</italic>). Right: negative control example circuit in which RFP was expressed constitutively and thus expected to be independent of TetR levels. In this circuit, <italic>X</italic> does not causally affect <italic>Z</italic> but <italic>X</italic> and <italic>Z</italic> are correlated due to plasmid copy number fluctuations. <bold>C)</bold> <italic>E. coli</italic> cells with the synthetic circuit encoded on the pSC101 plasmid were grown in a microfluidic device and observed over hundreds of cell divisions while daughter cells are washed away. Fluorescence levels of YFP, CFP, and RFP were measured simultaneously for hundreds of mother cells, along with cell area, cell length, and the growth rate. For each strain, the time-lapse data of all cells were combined into a population distribution from which the normalized covariances were computed. All temporal information was thus discarded and not used in the analysis. <bold>D)</bold> Two out of four causal interactions were clearly detected through violations of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>. Of the other two, one was clearly not detected, whereas one was situated right at the limit of experimental detectability but did not violate the null hypothesis test at a 2.5% significance level (see Fig. S2). See Materials and Methods for details of our error analysis. Numbers indicate the synthetic circuits as listed in supplemental Table S2. <bold>E)</bold> All but one negative control circuits led to data consistent with <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> (dashed line). Numbered synthetic circuits are listed in supplemental Tables S3 and S4. The two inconsistent data points corresponding to the same synthetic circuit (number 12) which is presented in detail in <xref ref-type="fig" rid="fig4">Fig. 4</xref>. The false positives either imply that our method works imperfectly or that we detected an unexpected causal interaction from TetR onto growth rate in this circuit. We present evidence for the latter interpretation in the next section</p></caption>
<graphic xlink:href="555799v2_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>We found that circuits #1 and #2 clearly broke the constraint, circuit #4 did not violate it, and circuit #3 showed significant deviations right at the limit of what can be reliably detected, see <xref rid="fig3" ref-type="fig">Fig. 3D</xref>. Using the estimated error bars and a null hypothesis test at the 2.5% significance level, we find that the data from circuit #3 does not reject the null hypothesis of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>, see Fig. S2.</p>
<p>The above repressilator test circuits were chosen for their well-characterized genetic interactions and because oscillating abundances make for a convenient test of the constructs. However, large oscillations in <italic>Z</italic> also make it much more challenging to detect violations of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> because in those circuits the intrinsic noise we exploit is small compared to the periodically varying dynamics of the circuit. Indeed, the two clear violators correspond to altered versions of the repressilator circuit that do not oscillate (see SI Table. S2). These non-oscillating test cases may in fact be the most relevant assessment of using <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> in natural gene regulatory circuits. All the above circuits were made of genes encoded on a low copy number plasmid. We have not shown that our method can successfully detect causal interactions in a chromosomally encoded gene regulatory circuit. However, plasmid copy number fluctuations will reduce the degree of violation of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> by reducing the fraction of reporter variability that is due to the intrinsic noise we exploit (see Sec. 15). A priori, causal connections between chromosomally encoded genes are thus expected to be easier rather than harder to detect with our method.</p>
<p>Overall the experimental data confirm that <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> has the fundamental power to experimentally detect causal interactions. However, the precision of current experimental techniques lies at the edge of what is necessary to detect physiologically relevant interactions when genes show large variability relative to the intrinsic noise we exploit. This highlights the importance of correctly estimating measurement uncertainty in our approach. Our error bars estimate sampling error and errors from non-even sample illumination, temporal drift, background fluorescence, and autofluorescence. These were estimated using a bootstrapping approach where the corrections and the normalized covariances were computed recursively to samples of the data, see Materials and Methods, and supplemental Fig. S6.</p>
</sec>
<sec id="s1d2">
<title>Negative controls</title>
<p>Our crucial theoretical result is that <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> must be satisfied by any circuit in which <italic>X</italic> does not affect <italic>Z</italic>. To experimentally test this prediction we engineered test cases in which <italic>X</italic> and <italic>Y</italic> are co-regulated, while <italic>Z</italic> is a component that is not affected by <italic>X</italic>. This took one of two forms: First, we constructed eight different circuits in which RFP (<italic>Z</italic>) was expressed constitutively using the pRNA1 promoter as previously used as a segmentation marker in <italic>E. coli</italic> [<xref ref-type="bibr" rid="c36">36</xref>, <xref ref-type="bibr" rid="c37">37</xref>]. We used various synthetic circuits and the RFP reporter was either integrated chromosomally or included on the circuit plasmid (the latter leading to correlations between RFP and our synthetic components without introducing a causal interaction). Second, as an additional control, for each circuit we also considered the cellular growth rate as the unaffected cellular property <italic>Z</italic>. While the growth rate affects reporter concentrations through dilution, we did not expect cellular growth to be affected by our synthetic circuits which made growth rates a convenient additional negative con-trol.</p>
<p>We found the data from all but one synthetic circuit consistent with our predicted invariant, see <xref rid="fig3" ref-type="fig">Fig. 3E</xref>. Note, the false positives correspond to the same synthetic circuit: one data point is from taking <italic>Z</italic> as the RFP concentration, while the other data point is from taking <italic>Z</italic> as the growth rate. To rule out experimental error we repeated the experiment twice while swapping the YFP and CFP reporters which confirmed the result (see Fig. S7). Additionally, we confirmed the result using a different cell segmentation pipeline (see Fig. S8).</p>
<p>Taken at face-value, our method thus produced two false positives (out of 16 tests), suggesting that our approach could be valuable but somewhat unreliable. However, next we present experimental evidence that indicate the violating data points were not false positives but may have correctly identified an unexpected causal effect from <italic>X</italic> on <italic>Z</italic> in the outlier circuit.</p>
</sec>
</sec>
<sec id="s1e">
<title>Evidence that RpoS mediated stress response affected cellular growth in the outlier circuit</title>
<p>We observed that the outlier strain (<xref rid="fig4" ref-type="fig">Fig. 4A</xref>) exhibited periods of slow growth (<xref rid="fig4" ref-type="fig">Fig. 4B</xref>), suggesting that cells underwent periods of stress. Indeed, although RFP was thought to be constitutively expressed, RFP exhibited clear temporal dynamics that were negatively correlated with growth rate (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>, Fig. S9). These fluctuations were larger than other strains expressing RFP from the same chromosomal gene (Fig. S10), suggesting that the outlier circuit caused additional fluctuations in the RFP concentration and growth rate.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>In the outlier strain the bacterial stress response is triggered which in turn regulates the “constitutive” RFP reporter.</title>
<p><bold>A)</bold> The outlier strain consists of the repressilator circuit encoded on the pSC101 plasmid with an endogenous copy of the <italic>lacI</italic> gene encoded on the chromosome. This endogenous source of LacI disrupts the regular oscillations of the repressilator circuit. RFP was chromosomally expressed under the control of the pRNA1 promoter [<xref ref-type="bibr" rid="c38">38</xref>]. <bold>B)</bold> The outlier strain exhibited large growth rate variability. <bold>C)</bold> The outlier strain exhibited large variability in RFP levels with the highest peaks occurring after the slowest growth periods. <bold>D)</bold> RFP levels were strongly correlated with RpoS activity as quantified through the known RpoS target gadX [<xref ref-type="bibr" rid="c39">39</xref>]. <bold>E)</bold> Deletion of the <italic>rpoS</italic> gene made the outlier strain consistent with <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>. <bold>F)</bold> Expressing LacI endogenously leads to long periods of low TetR-YFP levels rather than regular repressilator oscillations. Because TetR is the only repressor of the <italic>cI</italic> gene in the synthetic circuit, we hypothesize that during periods of low TetR, CI expression is so high that resource competition with the also highly expressed RFP triggers the bacterial stress response. This interaction, hypothesized to be present in cells with high CI and RFP expression levels, is indicated with a dashed arrow. Solid arrows indicate interactions with direct experimental support [<xref ref-type="bibr" rid="c40">40</xref>].</p></caption>
<graphic xlink:href="555799v2_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>We hypothesized that in the outlier strain the “constitutive” RFP reporter was being affected by the bacterial stress response regulator RpoS [<xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c42">42</xref>]. By measuring the transcriptional activity of the known RpoS target <italic>gadX</italic> [<xref ref-type="bibr" rid="c39">39</xref>] we observed variable RpoS activity with pulses that correlated with periods of slow cellular growth (Fig. S11). Similar pulsing behaviour of RpoS triggering periods of slow growth has been reported previously [<xref ref-type="bibr" rid="c39">39</xref>, <xref ref-type="bibr" rid="c40">40</xref>]. RFP levels were in turn strongly correlated with RpoS activity (<xref rid="fig4" ref-type="fig">Fig. 4D</xref>), as expected for genes for which transcription rates are constant but cell growth is slowed down by RpoS activity. Indeed, upon deleting RpoS, RFP fluctuations as well as growth rate fluctuations satisfy <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>, see <xref rid="fig4" ref-type="fig">Fig. 4E</xref>.</p>
<p>Next, we discuss why the RpoS stress response was triggered in the outlier circuit in a TetR dependent manner. In the outlier strain, LacI was chromosomally expressed, which represses TetR independent of the repressilator circuit. Instead of regular oscillations of TetR, we observed extended periods of very low concentrations, see <xref rid="fig4" ref-type="fig">Fig. 4F</xref>. We conjecture that during those extended periods of low TetR levels, expression of CI is exceedingly high, which in combination with the already highly expressed RFP, leads to resource competition in cells that ultimately triggers RpoS mediated stress response. Note, CI is under the control of the very strong pLtetO1 promoter, which can initiate the transcription of up to 0.3 mRNA/sec in bacteria when fully induced [<xref ref-type="bibr" rid="c43">43</xref>] and has been shown to burden <italic>E. coli</italic> [<xref ref-type="bibr" rid="c44">44</xref>]. RFP is under the control of another strong promoter, pRNA1, previously used as a bright segmentation marker [<xref ref-type="bibr" rid="c36">36</xref>, <xref ref-type="bibr" rid="c37">37</xref>], which we find to affect growth rate (Fig. S12). This RpoS mediated causal effect of TetR on RFP would explain the violations of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> by the outlier circuit, why deletion of <italic>rpoS</italic> removes the outlier data, and why the same circuit without endogenous <italic>lacI</italic> (strain #5) did not violate the constraint, see <xref rid="fig3" ref-type="fig">Fig. 3E</xref>.</p>
<p>The disappearance of the deviation from <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> in the outlier circuit with RpoS knockout provides evidence that the outlier data may not have been a false positive, but detected an unexpected causal interaction mediated by cellular burden and RpoS.</p>
</sec>
<sec id="s1f">
<title>Proposed additional tests</title>
<p>Our data from synthetic circuits in <italic>E. coli</italic> provide a proof-of-principle application in which our theoretical idea survived a first contact with experimental realities in specific synthetic circumstances. Synthetic gene circuits are useful for testing our network inference method because they provide reliably known interactions and can easily be modified to produce an array of circuits to test. However, synthetic circuits are limited in that they may not describe physiologically relevant interactions in naturally occurring systems. In addition, the preceding section suggests that synthetic circuits can put a metabolic burden on cells which can lead to unintended causal interactions. Further experiments are needed to demonstrate that the approach can detect causal interactions in natural gene regulatory circuits.</p>
<p>This requires applying the method on an endogenous network with reliably known natural interactions. For instance, the widely studied lac operon presents an exemplary test candidate: <italic>X</italic> would correspond to LacI, which represses the expression of <italic>lacZ</italic>. Using standard cloning techniques in molecular biology, the endogenous <italic>lacI</italic> and <italic>lacZ</italic> genes in a wild-type strain of <italic>E. coli</italic> can be replaced with <italic>lacI-FP</italic><sub>1</sub> <italic>lacZ-FP</italic><sub>2</sub> fusion genes, where <italic>FP</italic><sub>1</sub> and <italic>FP</italic><sub>2</sub> correspond to two fluorescent proteins of choice. A passive reporter <italic>Y</italic> would correspond to a spectrally distinguishable fluorescent reporter gene <italic>FP</italic><sub>3</sub> placed on the chromosome at similar gene loci to <italic>geneX</italic>. Violation of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> would demonstrate that the method can detect the causal interaction between the LacI repressor and the lac operon expression. Additional negative control genes that are not regulated by LacI can then be studied to test the validity of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> under broader conditions.</p>
<p>Note, that to minimize the metabolic burden of fluorescent proteins, the invariant <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> can be tested sequentially, i.e., doing the experiment with visible <italic>X</italic> and <italic>Z</italic> first, followed by an experiment to measure <italic>Y</italic> and <italic>Z</italic> next. If hybridization or sequencing techniques such as smFISH or scRNAseq are used to measure transcript abundances, then endogenous <italic>geneX</italic> and <italic>geneZ</italic> transcript abundances can be measured directly, and the only metabolic burden comes from the expression of the <italic>geneY</italic> reporter.</p>
</sec>
</sec>
<sec id="s2">
<title>Discussion</title>
<p>A ubiquitous problem in understanding gene regulatory networks is identifying which genes regulate the expression levels of which other genes. Stochastic fluctuations of molecular abundances within cells provide a natural source of information about such regulation. Here, we presented a mathematical identity that potentially allows for the translation of such single-cell variability data into causal interactions. Because correlations do not imply causation, this method requires experimental intervention, but crucially it does not require perturbing the <bold>physiological state of the cells</bold>.</p>
<p><bold>Note that agreement with </bold><xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref><bold> does not prove the non-existence of such a causal interaction because the</bold> lack of deviation can have two reasons: the causal interaction could be negligible or the effect of the intrinsic noise we exploit is not large enough compared with other sources of variability of the target gene. In other words, while deviations of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> rigorously establish causal interactions, “absence of this evidence does not constitute evidence of absence” [<xref ref-type="bibr" rid="c45">45</xref>].</p>
<sec id="s2a">
<title>Limitations of this study</title>
<p>Our method relies on a handful of key assumptions about the molecular reporters used. In the absence of standardized synthetic parts we may not know whether a given engineered system satisfies these assumptions. Only if the assumptions are satisfied, can violations of the invariant rigorously identify the existence of a directed causal interaction.</p>
<p>While the presented experimental study works as a proof-of-principle to illustrate the approach and establish its practical feasibility, at face value it also produced a false positive result. Through additional perturbation experiments we argue that the outlier circuit includes an unexpected causal connection. However, the evidence for this conclusion is weaker than the proven theoretical results presented. The fact that our interpretation of the perturbation experiments will be debated may serve as an illustration of how valuable a fluctuation based approach would be that avoids perturbation experiments altogether.</p>
<p>The negative control circuits in this study were chosen because they lacked a causal interaction from <italic>X</italic> to <italic>Z</italic> when considering the known interactions between the used promoters and proteins. However, the false positive result suggests that unexpected causal interactions can still exist in these circuits. Further perturbation experiments and additional controls would thus be beneficial to directly verify that <italic>X</italic> did not affect <italic>Z</italic> in our synthetic negative control circuits.</p>
<p>Additionally, all experimental synthetic circuits were tested in <italic>E. coli</italic> and eukaryotic test cases remain to be investigated. In eukaryotic cells, promoter sequences may not be the sole factor determining transcription rates. For instance, dual reporter genes with identical promoters have been engineered in mammalian cells [<xref ref-type="bibr" rid="c25">25</xref>]. The expression of these genes underwent bursts that are not coordinated when the genes are placed at distant gene loci [<xref ref-type="bibr" rid="c25">25</xref>]. While the invariant of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> holds in the face of such stochastic bursting, it only holds when, on average, the burst frequency is the same for each dual reporter (see SI Sec. 8). Additional consistency checks should also be reported to test whether the passive reporter reads out the same signal as the gene of interest. This could be done, for example, by testing the invariant of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> with other cellular components that are known to not be affected by <italic>geneX</italic>, or by direct measurement of the transcription activity using a separate method [<xref ref-type="bibr" rid="c46">46</xref>]. However, it is possible that the existence of some of the many other factors of gene regulation in eukaryotes, such as the presence of enhancers or epigenetic modifications, could make the proposed approach difficult to apply. It thus remains to be shown that a passive reporter can be engineered to read-out the same signal as a naturally occurring gene of interest in the face of additional factors of gene regulation in eukaryotes.</p>
</sec>
</sec>
<sec id="s3">
<title>Materials and methods</title>
<sec id="s3a" sec-type="data-availability">
<title>Data and materials availability</title>
<p>Numerical simulation code and data will be available on Github. The segmented and tracked single-cell traces will be available online. Code for analyzing the singlecell traces to compute the normalized covariances will be available on Github. Python code used to run the DeLTA deep learning segmentation pipeline along with our trained U-Net models used for segmentation and chamber identification will be available on Github.</p>
</sec>
<sec id="s3b">
<title>Numerical simulation details</title>
<p>Exact simulated single-cell time trajectories of the abundances were generated using the standard Gillespie algorithm [<xref ref-type="bibr" rid="c32">32</xref>], with an additional step to account for time-dependent rates and divisions [<xref ref-type="bibr" rid="c33">33</xref>] (see SI Sec. 13 for the exact algorithm used). The time trajectories for the concentrations correspond to the abundance trajectories divided by the cell volume trajectories <italic>V</italic> (<italic>t</italic>), with the latter being simulated independently of the species abundances. Simulations were performed with python.</p>
<sec id="s3b1">
<title>Simulated cell growth and division models</title>
<p>Three cellular growth dynamics were simulated. The first and second are linear and exponential growth respectively, with constant division times and symmetric cell divisions. Here <italic>V</italic> (<italic>t</italic>) trajectories were generated analytically as periodic functions. The volume is reduced by factor 1<italic>/</italic>2 at evenly spaced division times {<italic>τ</italic><sub><italic>i</italic></sub>}. Between division times <italic>τ</italic><sub><italic>i</italic></sub>, <italic>τ</italic><sub><italic>i</italic>+1</sub> the volume is given by <inline-formula><inline-graphic xlink:href="555799v2_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for the linear case and <italic>V</italic> (<italic>t</italic>) = <italic>V</italic><sub>0</sub> · 2<sup>(<italic>t−τ</italic></sup><sub><italic>i</italic></sub>)<italic>/t</italic><sub><italic>d</italic></sub> for the exponential case, where <italic>t</italic><sub><italic>d</italic></sub> is the time between divisions, and <italic>V</italic><sub>0</sub> is the volume right after a division. The third simulated volume dynamics is linear growth with stochastic division times and asymmetric divisions. Here a constant linear growth rate <inline-formula><inline-graphic xlink:href="555799v2_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is used. Division times {<italic>τ</italic><sub><italic>i</italic></sub>} and division factors <italic>a</italic><sub><italic>i</italic></sub> are picked recursively: The {<italic>τ</italic><sub><italic>i</italic>+1</sub>} is taken from a normal distribution with mean set to the doubling time:
<disp-formula id="ueqn1">
<graphic xlink:href="555799v2_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where 𝒩(<italic>µ, σ</italic>) is the normal distribution with mean <italic>µ</italic> and standard deviation <italic>σ</italic>. Until then the volume grows linearly with constant rate
<disp-formula id="ueqn2">
<graphic xlink:href="555799v2_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>At <italic>τ</italic><sub><italic>i</italic>+1</sub> the volume is reduced by factor <italic>a</italic><sub><italic>i</italic>+1</sub> taken from a normal distribution with mean set to the ratio of cell volumes at the beginning and end of the cycle
<disp-formula id="ueqn3">
<graphic xlink:href="555799v2_ueqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>As a result, cells that grow more (less) than double in size during a cycle tend to divide with larger (smaller) division factors, ensuring the volume trajectories do not eventually expand (decay) to infinity (zero).</p>
<p>At division, molecular abundances are reduced according to a binomial splitting with probability given by the division factor. For example, if the volume is reduced by a factor of 0.4 at a cell division, i.e., <italic>V →</italic>0.4<italic>V</italic>, then each molecular has probability 0.4 to remain in the followed daughter cell.</p>
</sec>
<sec id="s3b2">
<title>Computing normalized covariances from trajectories</title>
<p>Normalized covariances were computed by integrating over the trajectories to obtain time averages for first and second moments. This is equivalent to using the distribution given by calculating the fraction of the total system time spent in each sampled state. In the ergodic regime, this distribution converges to the stationary distribution of the ensemble.</p>
</sec>
<sec id="s3b3">
<title>Simulated systems</title>
<p>We simulated ten groups of systems defined by their rate functions (see SI Table. S1 for details). For each group, each model parameter was picked randomly multiple times from the set {0.1, 1, 10}. This was done for each of the the three volume dynamics we considered. If a simulated system gave an average abundance in one of the components less than 0.01 molecules, then the system was omitted to avoid numerical errors that arise from divisions of small numbers when computing the normalized covariances. In total, there are 6522 resulting simulations which are plotted in <xref rid="fig2" ref-type="fig">Fig. 2C</xref>.</p>
</sec>
<sec id="s3b4">
<title>Confidence intervals for finite sampling error</title>
<p>For each system, simulated trajectories were generated forty times, and then repeated until the percentage errors of the normalized covariances, taken as the standard error of the mean divided by the mean, reached less than 1% or the number of simulations reached 1,000. Each trajectory ran for 20,000 cell divisions and started with a unique random number generator seed. Each component abundance was set to 1 at the beginning of each trajectory, and the cell cycle time set to 0. We let the simulated cells reach 200 cell divisions before we start to compute the time average integrals for the moments, in order for the effect of the initial condition to dissipate and we analyze the systems’ cyclo-stationarity state. The final normalized covariance for each system corresponds to the average taken over the ensemble of simulated trajectories with 95% confidence intervals given by twice the standard error. Distributions for the uncertainties for each class of systems are plotted in supplemental Figs. S3, S4.</p>
<p>For a given system, <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> was tested by verifying that the ratio <italic>η</italic><sub><italic>xz</italic></sub><italic>/η</italic><sub><italic>yz</italic></sub> produced a 95% confidence interval that encompassed the predicted value of 1. The test was satisfied by 6369 out of 6522 systems (97.7%), consistent with the definition of confidence intervals for finite sampling. The percentage of outliers for each simulated process is plotted in supplemental Fig. S5. Re-simulating the outliers for twice the number of simulations led to a reduction in the standard error by a factor of 1<italic>/</italic> 2, with <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> being satisfied by 143 of the 153 outliers (93.5%). Re-simulating the remaining 10 violators with four times the number of simulations, reduced the errors by a factor of <inline-formula><inline-graphic xlink:href="555799v2_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and all of the 10 outliers satisfied <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> when quantified at such high numerical accuracy.</p>
</sec>
</sec>
<sec id="s3c">
<title>Strain and plasmid construction</title>
<p>All strains, plasmids, full construction details are provided in the SI. The base background strain used throughout the manuscript is <italic>E. coli</italic> MG1655.</p>
<p>The base plasmid used throughout the manuscript is the repressilator [<xref ref-type="bibr" rid="c35">35</xref>, <xref ref-type="bibr" rid="c36">36</xref>]. It consists of three genes: <italic>tetR</italic> from the Tn10 transposon, <italic>cI</italic> from bacteriophage <italic>λ</italic>, and <italic>lacI</italic> from the lactose operon, which have promoters that are repressed by LacI, TetR, and CI respectively. All genes are placed on the low-copy pSC101 plasmid which is inserted into <italic>E. coli</italic> MG1655.</p>
<p>Using standard molecular biology techniques, the repressilator plasmid sequence was altered in a number of ways to construct the different circuits. The <italic>tetR</italic> repressor was set as the gene of interest <italic>geneX</italic> and TetR levels were measured through fluorescence measure-ments of a TetR fusion to the yellow fluorescent protein <italic>mVenus NB</italic> (YFP) [<xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c47">47</xref>]. We engineered the passive reporter <italic>geneY</italic> by expressing a different fluorescent protein <italic>SCFP3A</italic> (CFP) [<xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c48">48</xref>] under the control of the same pLacO1 promoter as <italic>geneX</italic> on the same pSC101 plasmid. Both <italic>X</italic> and <italic>Y</italic> levels are co-regulated by LacI concentrations. To ensure equal degradation times, we used a version of the repressilator in which the three repressing genes lack degradation tags so that circuit proteins are removed predominantly from cell-division and dilution [<xref ref-type="bibr" rid="c36">36</xref>]. The fluorescent proteins <italic>mVenus NB</italic> and <italic>SCFP3A</italic> were chosen since they both have a short maturation half-life (4.1± 0.3min and 6.6 ±0.5min respectively at 37<sup><italic>o</italic></sup>C) compared to the time-scale of the repressilator oscillations (∼5 hours).</p>
<p>For the RFP, we used a modified <italic>mkate2</italic> hybrid (with improved translational efficiency) throughout all experiments, which consists of the <italic>mCherry</italic> N-terminal 11 amino acids followed by the <italic>mKate2</italic> sequence. In the experiment shown in <xref rid="fig4" ref-type="fig">Fig. 4D</xref> in which GFP was used to measure <italic>gadX</italic> expression, we used <italic>gfpmut2</italic> as a transcriptional reporter for the <italic>gadX</italic> promoter, placed on a low-copy pSC101 plasmid (taken from the <italic>E. coli</italic> promoter library [<xref ref-type="bibr" rid="c49">49</xref>]). For <xref rid="fig4" ref-type="fig">Fig. 4E</xref>, we used a strain of <italic>E. coli</italic> MG1655 with <italic>rpoS</italic> deletion taken from the <italic>E. coli</italic> Keio Knockouts library [<xref ref-type="bibr" rid="c50">50</xref>].</p>
<p>We chose the repressilator as the base circuit because the circuit interactions are known and the resulting dynamics (periodic oscillations) can be used as a consistency check to ensure that the TetR-YFP fusion is functional (i.e., still represses the <italic>λ</italic> gene).</p>
</sec>
<sec id="s3d">
<title>Mother machine experiment</title>
<p>We used a microfluidic device commonly called “mother machine” to follow growing and dividing cells for hundreds of generations in controlled environments [<xref ref-type="bibr" rid="c51">51</xref>, <xref ref-type="bibr" rid="c52">52</xref>]. Single-cells are trapped in micrometer wide trenches. As cells grow and divide, the mother cells remain trapped while newborn daughter cells are washed away by the constant flow of growth media. Automated time-lapse microscopy and cell segmentation software enables us to track hundreds of cells in each experiment, while precisely measuring cell fluorescence, growth rate, and cell size. The time-series data for each mother cell can be pooled into a distribution from which the normalized covariances can be computed.</p>
<p>Though the invariant of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> does not require the use of time-series data, we used the additional temporal information as a consistency check for our assumptions. In particular, the highly correlated trajectories of the YFP and CFP fluorescence (see Tables. S3 and S4) are consistent with our assumption that these reporters are co-regulated. Additionally, the observed oscillations in the closed loop circuits are indicative that the TetR-YFP fusion has not lost its function as a result of the added fluorescent protein. Moreover, the time-series data allows us to measure cellular growth rates which can be used to test <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> as shown in <xref ref-type="fig" rid="fig3">Fig. (3)D</xref>.</p>
<sec id="s3d1">
<title>Microfluidic chip preparation</title>
<p>Polydimethylsiloxane (PDMS) (Sylgard 184 Silicon Elastomer, Fisher Scientific) was mixed at a 10:1 (monomer:curing agent) ratio, poured on top of a 1.0 <italic>µ</italic>m tall wafer and degassed for one hour at room temperature before baking for an additional 1.5 hours at 65<sup>°</sup>C. After careful removal of the PDMS from the wafer, individual PDMS chips were cut out with a razor blade. The inlet and outlet holes were punched with a 0.75 mm biopsy puncher (World Precision Instruments). The PDMS chips were sonicated in isopropyl alcohol (Fisher Scientific) for 30 minutes and dried at 65<sup>°</sup>C for 15 minutes. Glass coverslips (Fisher Scientific: 22×40 mm #1.5) were cleaned with 1M potassium hydroxide (KOH, Sigma Aldrich) for 20 minutes. The PDMS chips were bonded to the glass coverslips using a plasma cleaner (Oxygen flow rate at 45 sccm, power at 30W for 15 seconds, Tergeo Plasma Cleaner, PIE Scientific). The completed microfluidic device was heated to reinforce the plasma bonding at 100<sup>°</sup>C for 10 minutes, then 65<sup>°</sup>C for 30 minutes.</p>
</sec>
<sec id="s3d2">
<title>Cell preparation</title>
<p><italic>E. coli</italic> strains were grown overnight in LB with appropriate antibiotics to select for cells containing the constructed plasmids. At ∼3-4 hours prior to the experiment start time, the overnight cultures were diluted 1:100 in imaging media consisting of M9 salts, 10% (v/v) LB, 0.2% (w/v) glucose, 2 mM MgSO4, 0.1 mM CaCl2, 1.5 <italic>µ</italic>M thiamine hydrochloride and 0.85 g/L Pluronic F-108 (Sigma Aldrich, surfactant to prevent cells sticking to the surface of a microfluidic device). At an OD600 of 0.2-0.4, cells were loaded into the main feeding channel of the microfluidic chip and centrifuged at 5000 g for 10 min to push cells into the cell trenches. The feeding channels were then connected to syringes filled with imaging media using Tygon tubing, and the microfluidic chip was placed in a temperature controlled incubation chamber set at 37<sup>°</sup>C. Media was pumped through the feeding channel using syringe pumps (New Era Pump System), first at a rate of 5 <italic>µ</italic>L/min for ∼ 0.5-1 hours to get the cells comfortable in the trenches, then at a high rate of 100 <italic>µ</italic>L/min for 1 hour to clear the inlets and outlets. The rate of media flow was then set back to 5 <italic>µ</italic>L/min for the duration of the experiment.</p>
</sec>
<sec id="s3d3">
<title>Microscopy and image acquisition</title>
<p>Images were acquired using a Zeiss Axio Observer inverted microscope equipped with a 63x Plan-Apochromat M27 oil objective (NA 1.40), an Orca Flash 4.0 LT camera (Hamamatsu), and an LED epifluorescence illuminator (Zeiss Colibri 7). The experiments were performed inside a temperature controlled incubation chamber set at 37<sup>°</sup>C. To reduce photobleaching the exposure time (100 ms) and light intensity (10-20%) were set low, with 16-bit CZI images taken every 5-8 minutes. Focal drift was corrected automatically with the Definite Focus 2 (Zeiss) monitoring and compensation system using an infrared laser (850 nm). In all experiments in which CFP, YFP, and RFP are measured simultaneously (i.e., all experiments except for the one shown in <xref rid="fig4" ref-type="fig">Fig. 4D</xref>), the following filter sets were used for acquisition: CFP (Semrock FF02-475/20-25), YFP (Chroma CT560/39bp), RFP (Zeiss Filter Set 91 HE LED), with respective Zeiss Colibri 7 illumination wavelengths set to 430nm (CFP), 511 nm (YFP), and 590 nm (RFP), along with a the Zeiss TBS 450/538/610 beam splitter. For the experiment in <xref rid="fig4" ref-type="fig">Fig. 4D</xref> in which a gfp reporter is used to measure gadX expression, the following filter sets were used for acquisition: GFP (Chroma ET525/50m) and cy5 (Zeiss BP 690/50) with Zeiss Colibri 7 illumination wavelengths set to 475 nm (GFP) and 630 nm (cy5), along with Zeiss QBS 405/493/575/653 beam splitter.</p>
</sec>
</sec>
<sec id="s3e">
<title>Data analysis</title>
<sec id="s3e1">
<title>Segmentation</title>
<p>Because all three fluorescence channels were used to measure synthetic circuit components throughout, we used the bright-field channel for segmentation. This was achieved with the automated deep learning-based cell segmentation software DeLTA [<xref ref-type="bibr" rid="c53">53</xref>, <xref ref-type="bibr" rid="c54">54</xref>]. The U-Net deep learning models used for channel identification and cell segmentation were trained with a large dataset built from 5 mother machine experiments performed in the Potvin Lab that were generated with the same microscopy and image acquisition setup. In these training datasets a bright RFP is expressed and a thresholding segmentation pipeline is performed on the RFP channel images to obtain segmentation masks. The U-Net deep learning models from DeLTA are trained with these segmentation masks in combination with bright-field images from the training dataset as described in [<xref ref-type="bibr" rid="c53">53</xref>, <xref ref-type="bibr" rid="c54">54</xref>]. The training dataset was segmented with the same thresholding pipeline used in previously described procedures [<xref ref-type="bibr" rid="c36">36</xref>, <xref ref-type="bibr" rid="c55">55</xref>]. We also trained a DelTA model to use the RFP channel for segmentation and obtained similar results on the strains with bright RFP fluorescence. In the SI we include videos of a mother machine with segmentation boundaries obtained from our DeLTA models, along with the single-cell growth trajectories.</p>
<p>We estimated the YFP, CFP, and RFP single-cell concentrations as the average fluorescence intensities of all pixels in the segmentation mask of each cell. Cell area is measured as returned by opencv’s <monospace>contourArea()</monospace> over the segmentation mask. Cell length is measured by fitting a rotated bounding box to the segmented cell. We only analyzed data from the mother cells trapped at the top of the growth chambers.</p>
</sec>
<sec id="s3e2">
<title>Single-cell traces construction</title>
<p>For a given cell chamber with the Region of Interest identified by the U-Net model, a single-cell trace was constructed by selecting the segmented cell in each frame with highest average vertical pixel location. This in effect keeps track of the mother cells trapped at the top of the growth chambers.</p>
<p>Each single-cell trace went through a manual purging process. Traces with cell areas that are not growing and dividing were removed, as they are expected to correspond to dead cells. Traces with growing and dividing cell areas with very low constant fluorescence correspond to cells that lost the inserted plasmid due to random partitioning at cell division. These traces were also purged, but were analyzed separately to measure the cell aut-ofluorescence as described in the next section. Moreover, segmentation and tracking errors were reduced by purging any parts of the traces that exhibited a clear non-biological anomaly (see SI for examples).</p>
<p>Cell divisions were identified by a sudden decrease in the cell area. A division is called whenever the cell lengths dropped to less than 80% of its previous value.</p>
</sec>
<sec id="s3e3">
<title>Temporal drift correction</title>
<p>Focal drift was reduced automatically with a 850 nm infrared laser (Zeiss Definite Focus 2). However, we used an oil objective, which can cause temporal drift from spreading of the oil over time. We thus applied an additional correction to the data as follows.</p>
<p>In a given mother machine experiment, we computed the mean YFP, CFP, and RFP signals of all the cells at each time frame. For example, the mean YFP time-trace is given by
<disp-formula id="eqn3">
<graphic xlink:href="555799v2_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="555799v2_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<italic>t</italic>) is the average YFP intensity taken over the segmented area of the <italic>i</italic><sup><italic>th</italic></sup> cell at time frame <italic>t</italic>, and <italic>N</italic><sub>cells</sub>(<italic>t</italic>) is the number of surviving cells at time frame <italic>t</italic>. The mean time-traces of each fluorophore are fitted with a second degree polynomial according to a least-squared fit. To correct for the drift, we multiply a measured intensity with the reciprocal of the respective fitted polynomial (see Fig. S13). For example, if <italic>f</italic> (<italic>t</italic>) is the obtained fit of ⟨YFP<sub><italic>avg</italic></sub>⟩<sub><italic>t</italic></sub> from <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>, we correct all the YFP<sub><italic>avg</italic></sub> measurements as follows
<disp-formula id="ueqn4">
<graphic xlink:href="555799v2_ueqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where f(0) is the fitted function f(t) taken over the first time frame.</p>
</sec>
<sec id="s3e4">
<title>Uneven illumination and background correction</title>
<p>A single image frame from our setup encompasses ∼30cell trenches with total spatial extension of ∼100 μm. This results in uneven illumination onto the cells. We use the linear gain model [<xref ref-type="bibr" rid="c56">56</xref>, <xref ref-type="bibr" rid="c57">57</xref>] to correct for uneven illumination and background fluorescence:
<disp-formula id="eqn4">
<graphic xlink:href="555799v2_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>I</italic><sup><italic>m</italic></sup>(<italic>x</italic>) and <italic>I</italic><sup><italic>true</italic></sup>(<italic>x</italic>) are the measured and true intensities at horizontal pixel position <italic>x</italic> respectively, the multiplicative term <italic>S</italic>(<italic>x</italic>) models the uneven illumination, and the additive term <italic>D</italic>(<italic>x</italic>) is any background noise that is present when no light is incident on the sensor. For our imaging setup we decompose <italic>I</italic><sup><italic>true</italic></sup>(<italic>x</italic>) as follows
<disp-formula id="eqn5">
<graphic xlink:href="555799v2_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>I</italic><sup><italic>F P</italic></sup> (<italic>x</italic>) is the intensity from the fluorescent proteins, <italic>I</italic><sup><italic>a</italic></sup> is the autofluorescence of the cell, <italic>I</italic><sup><italic>media</italic></sup> is any fluorescence originating from the media, and <italic>I</italic><sup><italic>b</italic></sup> is any fluorescence originating from the PDMS background of the microfluidic device. The total background is given by <italic>b</italic>(<italic>x</italic>) = <italic>I</italic><sup><italic>b</italic></sup>(<italic>x</italic>) <italic>S</italic>(<italic>x</italic>) + <italic>D</italic>(<italic>x</italic>), in which case the imaging model becomes
<disp-formula id="eqn6">
<graphic xlink:href="555799v2_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>We use a ‘prospective’ approach to correct for <italic>S</italic>(<italic>x</italic>) and <italic>b</italic>(<italic>x</italic>) as follows. For each segmented cell in an image, we compute the average intensity in a box of dimensions 50 by 50 pixels located 15 pixels above the cell trench (see Fig. S15A). This in effect estimates <italic>b</italic>(<italic>x</italic>) at the <italic>x</italic> position of just above each cell trench. In each image, this <italic>b</italic>(<italic>x</italic>) is removed from the <italic>I</italic><sup><italic>meas</italic></sup>(<italic>x</italic>) measurements of each segmented cell. To estimate the uneven illumination gain function <italic>S</italic>(<italic>x</italic>) we pool all of the single cell fluorescence measurements according to their horizontal pixel position <italic>x</italic>. Data is binned into bins of size 50 pixels and averages are taken at each bin (see Fig. S15B). The resulting curve gives an estimate of ⟨<italic>I</italic><sup><italic>F P</italic></sup> + <italic>I</italic><sup><italic>af</italic></sup> + <italic>I</italic><sup><italic>media</italic></sup>⟩×<italic>S</italic>(<italic>x</italic>). To estimate <italic>S</italic>(<italic>x</italic>) we fit the curve with a 3rd degree polynomial <italic>p</italic><sub><italic>S</italic></sub>(<italic>x</italic>). To correct for the uneven illumination gain function we multiply the fluorescence measurements by the reciprocal of <italic>p</italic><sub><italic>S</italic></sub>(<italic>x</italic>):where <italic>p</italic><sub><italic>S,max</italic></sub> is the max value of the fit <italic>p</italic><sub><italic>S</italic></sub>(<italic>x</italic>) over <italic>x</italic>.
<disp-formula id="ueqn5">
<graphic xlink:href="555799v2_ueqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s3e5">
<title>Autofluorescence and fluorescing media</title>
<p>The preceding section described how the background and the uneven illumination were corrected using the linear gain imaging model of <xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref>. Even with the background correction, the fluorescence profile across growth chambers empty of cells is not negligible compared to the profiles of some cell-containing chambers, see Fig. S15. This indicates that media fluorescence is not negligible in experiments with strains that produce low levels of fluorescence. Here we show how we estimated the autofluorescence <italic>I</italic><sup><italic>a</italic></sup> and the media fluorescence <italic>I</italic><sup><italic>media</italic></sup> to obtain the sought after fluorescent protein fluorescence <italic>IFP</italic>.</p>
<p>In each mother machine experiment there was a subset of cells that lost the synthetic circuit plasmid due to random partitioning at cell division. These cells were used to estimate <italic>I</italic><sup><italic>a</italic></sup> + <italic>I</italic><sup><italic>media</italic></sup>. Cells that lost the plasmid were identified manually by observing single-cell traces: When a cell loses the plasmid, the CFP and YFP fluorescence decay rapidly and reach a constant low signal level for the remainder of the experiment, see Fig. S14. The segments of the time traces at constant low signal level were cut and saved, with the autofluorescence and the media fluorescence taken as the average fluorescence of the saved traces. Around 10–30 cases of plasmid loss occur for each strain in a mother machine experiment.</p>
<p>Note that <italic>I</italic><sup><italic>a</italic></sup> and <italic>I</italic><sup><italic>media</italic></sup> do not need to be corrected in the RFP channel measurements. This is because RFP is taken as the component either affected or not affected by <italic>X</italic>. For the systems in which RFP is not affected by <italic>X</italic>, any <italic>function</italic> of RFP (like adding autofluorescence and media fluorescence) will also not be affected by <italic>X</italic> and the invariant of <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> will be satisfied. Alternatively, if <italic>X</italic> affects RFP, then it will generally also affect any typically expected function of RFP. We did not correct for <italic>I</italic><sup><italic>a</italic></sup> and <italic>I</italic><sup><italic>media</italic></sup> in the RFP channel because a fraction of circuits have RFP located on the chromosome and not the plasmid.</p>
</sec>
<sec id="s3e6">
<title>Estimating confidence intervals</title>
<p>The corrections from the preceding sections rely on the distribution of single-cell measurements. As a result, sampling error affects the accuracy of the corrections, along with the final estimators of the normalized covariances. We applied two methods to estimate normalized covariance confidence intervals by taking into account sampling error and its effect on the corrections.</p>
<p>First we use bootstrapping, where the data corrections and the normalized covariances are computed over many samples of the data, allowing for replacement in sampling. If an experiment produces <italic>N</italic> single-cell traces of cells with plasmid, and <italic>M</italic> single-cell traces of cells that lost the plasmid, random samples of size <italic>N</italic> and <italic>M</italic> of each respective ensemble are taken. The corrections from the previous sections are then applied using the samples, with the corrected data pooled into a distribution from which the normalized covariances are computed. This is repeated until 100 normalized covariances <italic>η</italic><sub><italic>sample</italic></sub> have been computed for each sample. The final reported normalized covariance corresponds to the average over the <italic>η</italic><sub><italic>sample</italic></sub>, with confidence intervals given by twice the standard deviation. See Fig. S16 and SI Sec. 17 for details.</p>
<p>Second we use sampling without replacement, where the single-cell traces from each experiment are divided into 7 to 10 disjoint sets, and the corrections and the normalized covariances are computed for each set. The reported normalized covariances correspond to the average of those computed from the sets, with error bars being the standard error of the mean (see SI Sec. 17 for details).</p>
<p>A single mother machine experiment typically produced 100–500 single-cell traces of cells with plasmid, and 7–30 single-cell traces of cells that lost the plasmid due to random partitioning at division. The computed normalized covariances from the bootstrapping method are shown in <xref rid="fig3" ref-type="fig">Fig. 3D,E</xref>, while those from the alternative splitting method shown in Fig. S6. The two methods give similar results.</p>
</sec>
</sec>
<sec id="s3f">
<title>Growth rate estimation</title>
<p>We define growth rate in this work as the rate of change of the cell length normalized by cell length:<inline-formula><inline-graphic xlink:href="555799v2_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. To estimate the growth rate from the single-cell traces we assume exponential growth between division events.</p>
<p>In that case, if there is no division event that occurs at time frames <italic>i</italic>−1, <italic>i</italic>, and <italic>i</italic>+1, then the growth rate at time <italic>t</italic><sub><italic>i</italic></sub> is computed as <inline-formula><inline-graphic xlink:href="555799v2_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where <italic>L</italic><sub><italic>i</italic></sub> is the cell length at time <italic>t</italic><sub><italic>i</italic></sub>, <italic>L</italic><sub><italic>i−</italic>1</sub> is the length at the preceding frame, <italic>L</italic><sub><italic>i</italic>+1</sub> is the length at the subsequent frame, and Δ<italic>t</italic> is the time between frames (5–8 min). If there is a division event at the subsequent frame <italic>i</italic> + 1, then the growth rate is computed as <inline-formula><inline-graphic xlink:href="555799v2_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. If there is a division event at the current frame <italic>i</italic>, then the growth rate is computed as<inline-formula><inline-graphic xlink:href="555799v2_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
<p>For illustration we smoothed the growth rate measurements shown in <xref rid="fig4" ref-type="fig">Fig. 4B</xref> using a moving average filter with a window of 5 frames. We did not smooth the data when computing the normalized covariances and CVs shown in <xref rid="fig3" ref-type="fig">Fig. 3</xref>.</p>
</sec>
</sec>

</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>We thank Raymond Fan, B Kell, Seshu Iyengar, Sid Goyal, and Josh Milstein for many helpful discussions. This work was supported by the Natural Sciences and Engineering Research Council of Canada and a New Researcher Award from the University of Toronto Connaught Fund. Simulations were performed on the Niagara, Beluga, and Narval supercomputers at the SciNet HPC Consortium. SciNet is funded by the Canada Foundation for Innovation; the Government of Ontario, Ontario Research Fund - Research Excellence, and the University of Toronto. E.J.S. gratefully acknowledges a doctoral research visit grant to support their experimental work in L.P.T.’s lab at Concordia University.</p>
</ack>
<sec id="d1e2644" sec-type="additional-information">
<title>Additional information</title>
<sec id="s4">
<title>Author Contributions</title>
<p>E.J.S. derived the analytical results. M.M.T and E.J.S. performed the numerical simulations. E.J.S. and P.A. carried out the experiments. E.J.S. and F.P. constructed the synthetic circuits. E.J.S. performed data analysis. E.J.S., L.P.T., and A.H. designed the study. E.J.S. and A.H. wrote the manuscript with input from all authors.</p>
</sec>
</sec>
<sec id="suppd1e2644" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="d1e2621">
<label>Supplemental Information</label>
<media xlink:href="supplements/555799_file02.pdf"/>
</supplementary-material>
<supplementary-material id="d1e2628">
<label>Supplemental movie S1</label>
<media xlink:href="supplements/555799_file03.mp4"/>
</supplementary-material>
<supplementary-material id="d1e2635">
<label>Supplemental movie S2</label>
<media xlink:href="supplements/555799_file04.mp4"/>
</supplementary-material>
</sec>
<ref-list><ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>B.</given-names> <surname>Munsky</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Neuert</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Van Oudenaarden</surname></string-name></person-group>, <source>Science</source> <volume>336</volume>, <fpage>183</fpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Stewart-Ornstein</surname></string-name>, <string-name><given-names>J. S.</given-names> <surname>Weissman</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>El-Samad</surname></string-name></person-group>, <source>Mol. Cell</source> <volume>45</volume>, <fpage>483</fpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. J.</given-names> <surname>Gandhi</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Zenklusen</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Lionnet</surname></string-name>, and <string-name><given-names>R. H.</given-names> <surname>Singer</surname></string-name></person-group>, <source>Nature structural &amp; molecular biology</source> <volume>18</volume>, <fpage>27</fpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M.</given-names> <surname>Saint</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Bertaux</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Tang</surname></string-name>, <string-name><given-names>X.-M.</given-names> <surname>Sun</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Game</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Köferle</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Bähler</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Shahrezaei</surname></string-name>, and <string-name><given-names>S.</given-names> <surname>Marguerat</surname></string-name></person-group>, <source>Nature microbiology</source> <volume>4</volume>, <fpage>480</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Bageritz</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Willnow</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Valentini</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Leible</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Boutros</surname></string-name>, and <string-name><given-names>A. A.</given-names> <surname>Teleman</surname></string-name></person-group>, <source>Nature Methods</source> <volume>16</volume>, <fpage>750</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Wasserman</surname></string-name></person-group>, <source>All of statistics: a concise course in statistical inference</source>, Vol. <volume>26</volume> (<publisher-name>Springer</publisher-name>, <year>2004</year>).</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A. E.</given-names> <surname>Yuan</surname></string-name> and <string-name><given-names>W.</given-names> <surname>Shou</surname></string-name></person-group>, <source>eLife</source> <volume>11</volume>, <elocation-id>e72518</elocation-id> (<year>2022</year>).</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>N.</given-names> <surname>Ji</surname></string-name>, <string-name><given-names>T. C.</given-names> <surname>Middelkoop</surname></string-name>, <string-name><given-names>R. A.</given-names> <surname>Mentink</surname></string-name>, <string-name><given-names>M. C.</given-names> <surname>Betist</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Tonegawa</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Mooijman</surname></string-name>, <string-name><given-names>H. C.</given-names> <surname>Korswagen</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>van Oudenaarden</surname></string-name></person-group>, <source>Cell</source> <volume>155</volume>, <fpage>869</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Tegner</surname></string-name>, <string-name><given-names>M. S.</given-names> <surname>Yeung</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Hasty</surname></string-name>, and <string-name><given-names>J. J.</given-names> <surname>Collins</surname></string-name></person-group>, <source>Proceedings of the National Academy of Sciences</source> <volume>100</volume>, <fpage>5944</fpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>B. N.</given-names> <surname>Kholodenko</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Kiyatkin</surname></string-name>, <string-name><given-names>F. J.</given-names> <surname>Bruggeman</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Sontag</surname></string-name>, <string-name><given-names>H. V.</given-names> <surname>Westerhoff</surname></string-name>, and <string-name><given-names>J. B.</given-names> <surname>Hoek</surname></string-name></person-group>, <source>Proceedings of the National Academy of Sciences</source> <volume>99</volume>, <fpage>12841</fpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T.</given-names> <surname>Kaufman</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Nitzan</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Firestein</surname></string-name>, <string-name><given-names>M. B.</given-names> <surname>Ginzberg</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Iyengar</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Patel</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Ben-Hamo</surname></string-name>, <string-name><given-names>Z.</given-names> <surname>Porat</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Hunter</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Hilfinger</surname></string-name>, <etal>et al.</etal></person-group>, <source>Nature communications</source> <volume>13</volume>, <fpage>2725</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>E. S.</given-names> <surname>Welf</surname></string-name> and <string-name><given-names>G.</given-names> <surname>Danuser</surname></string-name></person-group>, <source>Biophysical journal</source> <volume>107</volume>, <fpage>2492</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M.</given-names> <surname>Vilela</surname></string-name> and <string-name><given-names>G.</given-names> <surname>Danuser</surname></string-name></person-group>, <source>Nature cell biology</source> <volume>13</volume>, <fpage>1011</fpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. M.</given-names> <surname>Schmiedel</surname></string-name>, <string-name><given-names>S. L.</given-names> <surname>Klemm</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Zheng</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Sahay</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Blüthgen</surname></string-name>, <string-name><given-names>D. S.</given-names> <surname>Marks</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>van Oudenaarden</surname></string-name></person-group>, <source>Science</source> <volume>348</volume>, <fpage>128</fpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Baudrimont</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Jaquet</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Wallerich</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Voegeli</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Becskei</surname></string-name></person-group>, <source>Cell reports</source> <volume>26</volume>, <fpage>3752</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. M.</given-names> <surname>Pedraza</surname></string-name> and <string-name><given-names>J.</given-names> <surname>Paulsson</surname></string-name></person-group>, <source>Science</source> <volume>319</volume>, <fpage>339</fpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>N.</given-names> <surname>Eling</surname></string-name>, <string-name><given-names>M. D.</given-names> <surname>Morgan</surname></string-name>, and <string-name><given-names>J. C.</given-names> <surname>Marioni</surname></string-name></person-group>, <source>Nature Reviews Genetics</source> <volume>20</volume>, <fpage>536</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M.</given-names> <surname>Kærn</surname></string-name>, <string-name><given-names>T. C.</given-names> <surname>Elston</surname></string-name>, <string-name><given-names>W. J.</given-names> <surname>Blake</surname></string-name>, and <string-name><given-names>J. J.</given-names> <surname>Collins</surname></string-name></person-group>, <source>Nature Reviews Genetics</source> <volume>6</volume>, <fpage>451</fpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Hilfinger</surname></string-name>, <string-name><given-names>T. M.</given-names> <surname>Norman</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Paulsson</surname></string-name></person-group>, <source>Cell Systems</source> <volume>2</volume>, <fpage>251</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>E.</given-names> <surname>Joly-Smith</surname></string-name>, <string-name><given-names>Z. J.</given-names> <surname>Wang</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Hilfinger</surname></string-name></person-group>, <source>Physical Review E</source> <volume>104</volume>, <fpage>044406</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Hilfinger</surname></string-name>, <string-name><given-names>T. M.</given-names> <surname>Norman</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Vinnicombe</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Paulsson</surname></string-name></person-group>, <source>Phys. Rev. Lett</source>. <volume>116</volume>, <fpage>058101</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. B.</given-names> <surname>Elowitz</surname></string-name>, <string-name><given-names>A. J.</given-names> <surname>Levine</surname></string-name>, <string-name><given-names>E. D.</given-names> <surname>Siggia</surname></string-name>, and <string-name><given-names>P. S.</given-names> <surname>Swain</surname></string-name></person-group>, <source>Science</source> <volume>297</volume>, <fpage>1183</fpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. M.</given-names> <surname>Raser</surname></string-name> and <string-name><given-names>E. K.</given-names> <surname>O’Shea</surname></string-name></person-group>, <source>Science</source> <volume>304</volume>, <fpage>1811</fpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>H.</given-names> <surname>Maamar</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Raj</surname></string-name>, and <string-name><given-names>D.</given-names> <surname>Dubnau</surname></string-name></person-group>, <source>Science</source> <volume>317</volume>, <fpage>526</fpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Raj</surname></string-name>, <string-name><given-names>C. S.</given-names> <surname>Peskin</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Tranchina</surname></string-name>, <string-name><given-names>D. Y.</given-names> <surname>Vargas</surname></string-name>, and <string-name><given-names>S.</given-names> <surname>Tyagi</surname></string-name></person-group>, <source>PLoS Biol</source> <volume>4</volume>, <fpage>e309</fpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. O.</given-names> <surname>Skinner</surname></string-name>, <string-name><given-names>L. A.</given-names> <surname>Sepúlveda</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Xu</surname></string-name>, and <string-name><given-names>I.</given-names> <surname>Golding</surname></string-name></person-group>, <source>Nature protocols</source> <volume>8</volume>, <fpage>1100</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.-E.</given-names> <surname>Saliba</surname></string-name>, <string-name><given-names>A. J.</given-names> <surname>Westermann</surname></string-name>, <string-name><given-names>S. A.</given-names> <surname>Gorski</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Vo-gel</surname></string-name></person-group>, <source>Nucleic acids research</source> <volume>42</volume>, <fpage>8845</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>E.</given-names> <surname>Lubeck</surname></string-name>, <string-name><given-names>A. F.</given-names> <surname>Coskun</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Zhiyentayev</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Ahmad</surname></string-name>, and <string-name><given-names>L.</given-names> <surname>Cai</surname></string-name></person-group>, <source>Nat Meth</source> <volume>11</volume>, <fpage>360</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>V.</given-names> <surname>Svensson</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Vento-Tormo</surname></string-name>, and <string-name><given-names>S. A.</given-names> <surname>Teichmann</surname></string-name></person-group>, <source>Nature protocols</source> <volume>13</volume>, <fpage>599</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Bar-Even</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Paulsson</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Maheshri</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Carmi</surname></string-name>, <string-name><given-names>E.</given-names> <surname>O’Shea</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Pilpel</surname></string-name>, and <string-name><given-names>N.</given-names> <surname>Barkai</surname></string-name></person-group>, <source>Nat. Genet</source>. <volume>38</volume>, <fpage>636</fpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>E.</given-names> <surname>Balleza</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Mark Kim</surname></string-name>, and <string-name><given-names>P.</given-names> <surname>Cluzel</surname></string-name></person-group>, <source>Nature Methods</source> <volume>15</volume>, <fpage>47</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>D. T.</given-names> <surname>Gillespie</surname></string-name></person-group>, <source>J. Phys. Chem</source>. <volume>81</volume>, <fpage>2340</fpage> (<year>1977</year>).</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M.</given-names> <surname>Voliotis</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Thomas</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Grima</surname></string-name>, and <string-name><given-names>C. G.</given-names> <surname>Bowsher</surname></string-name></person-group>, <source>PLoS computational biology</source> <volume>12</volume>, <fpage>e1004923</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Galbusera</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Bellement-Theroue</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Urchueguia</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Julou</surname></string-name>, and <string-name><given-names>E.</given-names> <surname>van Nimwegen</surname></string-name></person-group>, <source>PloS one</source> <volume>15</volume>, <fpage>e0240233</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. B.</given-names> <surname>Elowitz</surname></string-name> and <string-name><given-names>S.</given-names> <surname>Leibler</surname></string-name></person-group>, <source>Nature</source> <volume>403</volume>, <fpage>335</fpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Potvin-Trottier</surname></string-name>, <string-name><given-names>N. D.</given-names> <surname>Lord</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Vinnicombe</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Paulsson</surname></string-name></person-group>, <source>Nature</source> <volume>538</volume>, <fpage>514</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>N. D.</given-names> <surname>Lord</surname></string-name>, <string-name><given-names>T. M.</given-names> <surname>Norman</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Yuan</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Bakshi</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Losick</surname></string-name>, and <string-name><given-names>J.</given-names> <surname>Paulsson</surname></string-name></person-group>, <source>Science</source> <volume>366</volume>, <fpage>116</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.</given-names> <surname>Lin-Chao</surname></string-name> and <string-name><given-names>H.</given-names> <surname>Bremer</surname></string-name></person-group>, <source>Journal of bacteriology</source> <volume>169</volume>, <fpage>1217</fpage> (<year>1987</year>).</mixed-citation></ref>
<ref id="c39"><label>[39]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>N. M.</given-names> <surname>Sampaio</surname></string-name>, <string-name><given-names>C. M.</given-names> <surname>Blassick</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Andreani</surname></string-name>, <string-name><given-names>J.-B.</given-names> <surname>Lu-gagne</surname></string-name>, and <string-name><given-names>M. J.</given-names> <surname>Dunlop</surname></string-name></person-group>, <source>Proceedings of the National Academy of Sciences</source> <volume>119</volume>, <fpage>e2115032119</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c40"><label>[40]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>O.</given-names> <surname>Patange</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Schwall</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Jones</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Villava</surname></string-name>, <string-name><given-names>D. A.</given-names> <surname>Griffith</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Phillips</surname></string-name>, and <string-name><given-names>J. C.</given-names> <surname>Locke</surname></string-name></person-group>, <source>Nature communications</source> <volume>9</volume>, <fpage>5333</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c41"><label>[41]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R.</given-names> <surname>Lange</surname></string-name> and <string-name><given-names>R.</given-names> <surname>Hengge-Aronis</surname></string-name></person-group>, <source>Molecular microbiology</source> <volume>5</volume>, <fpage>49</fpage> (<year>1991</year>).</mixed-citation></ref>
<ref id="c42"><label>[42]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K.</given-names> <surname>Tanaka</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Takayanagi</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Fujita</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Ishihama</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>Takahashi</surname></string-name></person-group>, <source>Proceedings of the National Academy of Sciences</source> <volume>90</volume>, <fpage>3511</fpage> (<year>1993</year>).</mixed-citation></ref>
<ref id="c43"><label>[43]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R.</given-names> <surname>Lutz</surname></string-name> and <string-name><given-names>H.</given-names> <surname>Bujard</surname></string-name></person-group>, <source>Nucleic acids research</source> <volume>25</volume>, <fpage>1203</fpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c44"><label>[44]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>I.</given-names> <surname>Shachrai</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Zaslaver</surname></string-name>, <string-name><given-names>U.</given-names> <surname>Alon</surname></string-name>, and <string-name><given-names>E.</given-names> <surname>Dekel</surname></string-name></person-group>, <source>Molecular cell</source> <volume>38</volume>, <fpage>758</fpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c45"><label>[45]</label><mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><given-names>B. M.</given-names> <surname>Oliver</surname></string-name> and <string-name><given-names>J.</given-names> <surname>Billingham</surname></string-name></person-group>, <source>The 1971 NASA/ASEE Summer Fac. Fellowship Program NASA-CR-114445</source> (<year>1971</year>).</mixed-citation></ref>
<ref id="c46"><label>[46]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T. L.</given-names> <surname>Lenstra</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Rodriguez</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Chen</surname></string-name>, and <string-name><given-names>D. R.</given-names> <surname>Larson</surname></string-name></person-group>, <source>Annual review of biophysics</source> <volume>45</volume>, <fpage>25</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c47"><label>[47]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T.</given-names> <surname>Nagai</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Ibata</surname></string-name>, <string-name><given-names>E. S.</given-names> <surname>Park</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Kubota</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Mikoshiba</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Miyawaki</surname></string-name></person-group>, <source>Nature biotechnology</source> <volume>20</volume>, <fpage>87</fpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c48"><label>[48]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G.-J.</given-names> <surname>Kremers</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Goedhart</surname></string-name>, <string-name><given-names>E. B.</given-names> <surname>van Munster</surname></string-name>, and <string-name><given-names>T. W.</given-names> <surname>Gadella</surname></string-name></person-group>, <source>Biochemistry</source> <volume>45</volume>, <fpage>6570</fpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c49"><label>[49]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Zaslaver</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Bren</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Ronen</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Itzkovitz</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Kikoin</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Shavit</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Liebermeister</surname></string-name>, <string-name><given-names>M. G.</given-names> <surname>Surette</surname></string-name>, and <string-name><given-names>U.</given-names> <surname>Alon</surname></string-name></person-group>, <source>Nature methods</source> <volume>3</volume>, <fpage>623</fpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c50"><label>[50]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T.</given-names> <surname>Baba</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Ara</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Hasegawa</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Takai</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Okumura</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Baba</surname></string-name>, <string-name><given-names>K. A.</given-names> <surname>Datsenko</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Tomita</surname></string-name>, <string-name><given-names>B. L.</given-names> <surname>Wanner</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>Mori</surname></string-name></person-group>, <source>Molecular systems biology</source> <volume>2</volume>, <fpage>2006</fpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c51"><label>[51]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Robert</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Pelletier</surname></string-name>, <string-name><given-names>W. L.</given-names> <surname>Dang</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Taddei</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Wright</surname></string-name>, and <string-name><given-names>S.</given-names> <surname>Jun</surname></string-name></person-group>, <source>Curr. Biol</source>. <volume>20</volume>, <fpage>1099</fpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c52"><label>[52]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>Allard</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Papazotos</surname></string-name>, and <string-name><given-names>L.</given-names> <surname>Potvin-Trottier</surname></string-name></person-group>, <source>Frontiers in Bioengineering and Biotechnology</source> <volume>10</volume>, <fpage>968342</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c53"><label>[53]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.-B.</given-names> <surname>Lugagne</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Lin</surname></string-name>, and <string-name><given-names>M. J.</given-names> <surname>Dunlop</surname></string-name></person-group>, <source>PLoS compu-tational biology</source> <volume>16</volume>, <fpage>e1007673</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c54"><label>[54]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>O. M.</given-names> <surname>O’Connor</surname></string-name>, <string-name><given-names>R. N.</given-names> <surname>Alnahhas</surname></string-name>, <string-name><given-names>J.-B.</given-names> <surname>Lugagne</surname></string-name>, and <string-name><given-names>M. J.</given-names> <surname>Dunlop</surname></string-name></person-group>, <source>PLOS Computational Biology</source> <volume>18</volume>, <fpage>e1009797</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c55"><label>[55]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T. M.</given-names> <surname>Norman</surname></string-name>, <string-name><given-names>N. D.</given-names> <surname>Lord</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Paulsson</surname></string-name>, and <string-name><given-names>R.</given-names> <surname>Losick</surname></string-name></person-group>, <source>Nature</source> <volume>503</volume>, <fpage>481</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c56"><label>[56]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T.</given-names> <surname>Peng</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Thorn</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Schroeder</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Theis</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Marr</surname></string-name>, and <string-name><given-names>N.</given-names> <surname>Navab</surname></string-name></person-group>, <article-title>A basic tool for background and shading correction of optical microscopy images</article-title>, <source>nat. commun</source>., <volume>8</volume>, <fpage>14836</fpage>, (<year>2017</year>).</mixed-citation></ref>
<ref id="c57"><label>[57]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K.</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Li</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Piccinini</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Csucs</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Balazs</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Bevilacqua</surname></string-name>, and <string-name><given-names>P.</given-names> <surname>Horvath</surname></string-name></person-group>, <source>Nature methods</source> <volume>12</volume>, <fpage>404</fpage> (<year>2015</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.92497.2.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Shou</surname>
<given-names>Wenying</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University College London</institution>
</institution-wrap>
<city>London</city>
<country>United Kingdom</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
</front-stub>
<body>
<p>By taking advantage of noise in gene expression, this <bold>important</bold> study introduces a new approach for detecting directed causal interactions between two genes without perturbing either. The main theoretical result is supported by a proof. Preliminary simulations and experiments on small circuits are <bold>solid</bold>, but further investigations are needed to demonstrate the broad applicability and scalability of the method.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.92497.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This paper describes a new approach to detecting directed causal interactions between two genes without directly perturbing either gene. To check whether gene X influences gene Z, a reporter gene (Y) is engineered into the cell in such a way that (1) Y is under the same transcriptional control as X, and (2) Y does not influence Z. Then, under the null hypothesis that X does not affect Z, the authors derive an equation that describes the relationship between the covariance of X and Z and the covariance of Y and Z. Violation of this relationship can then be used to detect causality.</p>
<p>The authors benchmark their approach experimentally in several synthetic circuits. In 4 positive control circuits, X is a TetR-YFP fusion protein that represses Z, which is an RFP reporter. The proposed approach detected the repression interaction in 2 of the 4 positive control circuits. The authors constructed 16 negative control circuit designs in which X was again TetR-YFP, but where Z was either a constitutively expressed reporter, or simply the cellular growth rate. The proposed method detected a causal effect in two of the 16 negative controls, which the authors argue is perhaps not a false positive, but due to an unexpected causal effect. Overall, the data support the potential value of the proposed approach.</p>
<p>Strengths:</p>
<p>The idea of a &quot;no-causality control&quot; in the context of detected directed gene interactions is a valuable conceptual advance that could potentially see play in a variety of settings where perturbation-based causality detection experiments are made difficult by practical considerations.</p>
<p>By proving their mathematical result in the context of a continuous-time Markov chain, the authors use a more realistic model of the cell than, for instance, a set of deterministic ordinary differential equations.</p>
<p>The authors have improved the clarity and completeness of their proof compared to a previous version of the manuscript.</p>
<p>Limitations:</p>
<p>The authors themselves clearly outline the primary limitations of the study: The experimental benchmark is a proof of principle, and limited to synthetic circuits involving a handful of genes expressed on plasmids in E. coli. As acknowledged in the Discussion, negative controls were chosen based on the absence of known interactions, rather than perturbation experiments. Further work is needed to establish that this technique applies to other organisms and to biological networks involving a wider variety of genes and cellular functions. It seems to me that this paper's objective is not to delineate the technique's practical domain of validity, but rather to motivate this future work, and I think it succeeds in that.</p>
<p>Might your new &quot;Proposed additional tests&quot; subsection be better housed under Discussion rather than Results?</p>
<p>I may have missed this, but it doesn't look like you ran simulation benchmarks of your bootstrap-based test for checking whether the normalized covariances are equal. It would be useful to see in simulations how the true and false positive rates of that test vary with the usual suspects like sample size and noise strengths.</p>
<p>It looks like you estimated the uncertainty for eta_xz and eta_yz separately. Can you get the joint distribution? If you can do that, my intuition is you might be able to improve the power of the test (and maybe detect positive control #3?). For instance, if you can get your bootstraps for eta_xz and eta_yz together, could you just use a paired t-test to check for equality of means?</p>
<p>The proof is a lot better, and it's great that you nailed down the requirement on the decay of beta, but the proof is still confusing in some places:</p>
<p>- On pg 29, it says &quot;That is, dividing the right equation in Eq. 5.8 with alpha, we write the ...&quot; but the next equation doesn't obviously have anything to do with Eq. 5.8, and instead (I think) it comes from Eq 5.5. This could be clarified.</p>
<p>- Later on page 29, you write &quot;We now evoke the requirement that the averages xt and yt are stationary&quot;, but then you just repeat Eq. 5.11 and set it to zero. Clearly you needed the limit condition to set Eq. 5.11 to zero, but it's not clear what you're using stationarity for. I mean, if you needed stationarity for 5.11 presumably you would have referenced it at that step.</p>
<p>It could be helpful for readers if you could spell out the practical implications of the theorem's assumptions (other than the no-causality requirement) by discussing examples of setups where it would or wouldn't hold.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.92497.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Joly-Smith</surname>
<given-names>Euan</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3792-2231</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Talpur</surname>
<given-names>Mir Mikdad</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Allard</surname>
<given-names>Paige</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0006-8049-4793</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Papazotos</surname>
<given-names>Fotini</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5934-0489</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Potvin-Trottier</surname>
<given-names>Laurent</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-7876-2820</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Hilfinger</surname>
<given-names>Andreas</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2411-6775</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>Summary:</p>
<p>This manuscript presents a method to infer causality between two genes (and potentially proteins or other molecules) based on the non-genetic fluctuations among cells using a version of the dual-reporter assay as a causal control, where one half of the dual-reporter pair is causally decoupled, as it is inactive. The authors propose a statistical invariant identity to formalize this idea.</p>
</disp-quote>
<p>We thank the referee for this summary of our work.</p>
<disp-quote content-type="editor-comment">
<p>Strengths:</p>
<p>The paper outlines a theoretical formalism, which, if experimentally used, can be useful in causal network inference, which is a great need in the study of biological systems.</p>
</disp-quote>
<p>We thank the referee for highlighting the potential value of our proposed method.</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses:</p>
<p>The practical utility of this method may not be straightforward and potentially be quite difficult to execute. Additionally, further investigations are needed to provide evidence of the broad applicability of the method to naturally occurring systems and its scalability beyond the simple circuit in which it is experimentally demonstrated.</p>
</disp-quote>
<p>We agree with these two points and have rewritten the manuscript, in particular highlighting the considerable future work that remains to be done to establish the broad applicability and scalability of our method.</p>
<p>In the rewritten manuscript we explicitly spell out potential practical issues and we explicitly state that our presented proof–of–principle feasibility study does not guarantee that our method will successfully work in systems beyond the narrowly sampled test circuits. This helps readers to clearly distinguish between what we claim to have done from what remains to be done. The re-written parts and additional clarifications are:</p>
<p>Abstract (p. 1), Introduction (p. 1-2), Sec. “Proposed additional tests” (p. 8), and “Limitations of this study” (p. 10).</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>Summary:</p>
<p>This paper describes a new approach to detecting directed causal interactions between two genes without directly perturbing either gene. To check whether gene X influences gene Z, a reporter gene (Y) is engineered into the cell in such a way that (1) Y is under the same transcriptional control as X, and (2) Y does not influence Z. Then, under the null hypothesis that X does not affect Z, the authors derive an equation that describes the relationship between the covariance of X and Z and the covariance of Y and Z. Violation of this relationship can then be used to detect causality.</p>
<p>The authors benchmark their approach experimentally in several synthetic circuits. In four positive control circuits, X is a TetR-YFP fusion protein that represses Z, which is an RFP reporter. The proposed approach detected the repression interaction in two or three of the positive control circuits. The authors constructed sixteen negative control circuit designs in which X was again TetR-YFP, but where Z was either a constitutively expressed reporter or simply the cellular growth rate. The proposed method detected a causal effect in one of the eight negative controls, which the authors argue is not a false positive, but due to an unexpected causal effect. Overall, the data support the practical usefulness of the proposed approach.</p>
</disp-quote>
<p>We thank the referee for their summary of our work.</p>
<disp-quote content-type="editor-comment">
<p>Strengths:</p>
<p>The idea of a &quot;no-causality control&quot; in the context of detected directed gene interactions is a valuable conceptual advance that could potentially see play in a variety of settings where perturbation-based causality detection experiments are made difficult by practical considerations.</p>
<p>By proving their mathematical result in the context of a continuous-time Markov chain, the authors use a more realistic model of the cell than, for instance, a set of deterministic ordinary differential equations.</p>
</disp-quote>
<p>We thank the referee for summarizing the value of our work.</p>
<disp-quote content-type="editor-comment">
<p>Caveats:</p>
<p>The term &quot;causally&quot; is used in the main-text statement of the central theorem (Eq 2) without a definition of this term. This makes it difficult to fully understand the statement of the paper's central theorem without diving into the supplement.</p>
</disp-quote>
<p>We thank the referee for this suggestion. In the revised manuscript we now define causal effects right before the statement of the main theorem of the main text (p. 2). We have also added a definition of the causal network arrows in the caption of Fig. 1 to help readers better understand our central claim.</p>
<disp-quote content-type="editor-comment">
<p>The basic argument of theorem 1 appears to rely on establishing that x(t) and y(t) are independent of their initial conditions. Yet, there appear to be some scenarios where this property breaks down:</p>
<p>(1) Theorem 1 does not seem to hold in the edge case where R=beta=W=0, meaning that the components of interest do not vary with time, or perhaps vary in time only due to measurement noise. In this case x(t), y(t), and z(t) depend on x(0), y(0), and z(0). Since the distributions of x(0), y(0), and z(0) are unspecified, a counterexample to the theorem may be readily constructed by manipulating the covariance matrix of x(0), y(0), and z(0).</p>
<p>(2) A similar problem may occur when transition probabilities decay with time. For example, suppose that again R=0 and X are degraded by a protease (B), but this protease is subject to its own first-order degradation. The deterministic version of this situation can be written, for example, dx/dt=-bx and db/dt=-b. In this system, x(t) approaches x(0)exp(-b(0)) for large t. Thus, as above, x(t) depends on x(0). If similar dynamics apply to the Y and Z genes, we can make all genes depend on their initial conditions, thus producing a pathology analogous to the above example.</p>
<p>The reviewer does not know when such examples may occur in (bio)physical systems. Nevertheless, since one of the advantages of mathematics is the ability to correctly identify the domain of validity for a claim, the present work would be strengthened by &quot;building a fence&quot; around these edge cases, either by identifying the comprehensive set of such edge cases and explicitly prohibiting them in a stated assumption set, or by pointing out how the existing assumptions already exclude them.</p>
</disp-quote>
<p>We thank the referee for bringing to our attention these edge cases that indeed violate our theorem as stated. In the revised manuscript we have “built a fence” around these edge cases by adding two requirements to the premise of our theorem: First, we have added the requirement that the degradation rate does not decay to zero for any possible realization. That is, if beta(t) is the degradation rate of X and Y for a particular cell over time, then taking the time average of beta(t) over all time must be non-zero. Second, we have added the requirement that the system has evolved for enough time such that the dual reporter averages  and , along with the covariances Cov(x, z_{k}) and Cov(y, z_{k}) have reached a time-independent stationary state.</p>
<p>With these requirements, no assumptions need to be made about the initial conditions of the system, because any differences in the initial conditions will decay away as the system reaches stationarity. For instance, the referee’s example (1) is not possible with these requirements because beta(t) can no longer remain zero. Additionally, example (2) is no longer possible because the time average of the degradation rate would be zero, which is no longer allowed (i.e., we would have that integral from 0 to T of b(0)exp(-t)/T dt =  0 when T goes to infinity).</p>
<p>Note that adding the condition that degradation cannot decay to exactly zero does not reduce the biological applicability of the theorem. But as the referee correctly points out any mathematical theorem needs to be accurately stated and stand on its own regardless of whether biological systems could realize particular edge cases. Also note, that the requirement that the cellular ensemble has reached a time-independent distribution of cell-to-cell variability can be (approximately) experimentally verified by taking snapshots of ensemble variability at two sufficiently separate different moments in time.</p>
<p>In response to the referee’s comment, we have added the above requirements when stating the theorem in the main text. We have also added the requirement of non-decay of the degradation rate to the definition of the system in SI Sec. 4, along with the stationarity requirement in theorem 1 in SI Sec 5. We have also added mathematical details to the proof of the invariant in SI Sec 5.</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations for the authors:</bold></p>
<p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p>
<p>This manuscript presents a method to infer causality between two genes (and potentially proteins or other molecules) based on the non-genetic fluctuations among cells using a version of the dual-reporter assay as a causal control, where one half of the dual-reporter pair is causally decoupled, as it is inactive. The authors propose a statistical invariant identity to formalize this idea. They propose and experimentally demonstrate the utility of this idea with a synthetic reporter system in bacteria.</p>
<p>The paper is well written and clearly outlines the principle, the mathematical invariant relationship both to give the reader an intuitive understanding of why the relationship must be true and in their mathematical derivation of the proof of Theorem 1.</p>
<p>The paper outlines a theoretical formalism, which, if experimentally used, can be useful in causal network inference, which is a great need in the study of biological systems. However, the practical utility of this method may not be straightforward and potentially be quite difficult to execute. We think this work could offer a platform to advance the field of network inference, but would encourage the authors to address the following comments.</p>
</disp-quote>
<p>We thank the reviewer for the positive comments on readability, summarizing the value of our work, as well as the critical comments below that helped us improve the manuscript.</p>
<disp-quote content-type="editor-comment">
<p>Major comments:</p>
<p>(1) Although the invariant identity seems theoretically sound, the data from synthetic engineered circuits in this manuscript do not support that the invariant holds for natural causal relations between genes in wild-type cells. In all the positive control synthetic circuits (numbers 1 to 4) the target gene Z i.e. RFP was always on the plasmid, and in circuit #4 there was an additional endogenous copy. The authors recapitulate the X-to-Z causality in circuits 1, 2, and 3 but not 4. Ultimately, the utility of this method lies in the ability to capture causality from endogenous correlations, this observation suggests that the method might not be useful for that task.</p>
</disp-quote>
<p>We thank the referee for their careful reading of our synthetic circuits and sincerely apologize for an error in our description of circuit #4 in the schematic of Table S2 of the supplement. We incorrectly stated that this circuit contained a chromosomally expressed RFP. In fact, in circuit #4 RFP was only on the plasmid just like in the circuits #1-3. We have corrected the schematic in the revised manuscript and have verified that the other circuits are correctly depicted.</p>
<p>In the revised manuscript, we now explicitly spell out that all our “positive control” test cases had the genes of interest expressed on plasmids, and that we have not shown that our method successfully detected causal interactions in a chromosomally encoded gene regulatory circuit, see additional statements in Sec. “Causally connected genes that break the invariant” on p. 6.</p>
<p>In the absence of any explicit experimental evidence, it is then important to consider whether chromosomally encoded circuits are expected to cause problems for our method which is based on a fluctuation test. Due to plasmid copy number fluctuations, X and Z will fluctuate significantly more when expressed on plasmids than when expressed chromosomally. However, because this additional variability is shared between X and Z it does not help our analysis which relies on stochastic <italic>differences</italic> in X and Z expression due to “intrinsic noise” effects downstream of copy number fluctuations. The additional “extrinsic noise” fluctuations due to plasmid copy number variability would wash out violations of Eq. (2) rather than amplify them. If anything, we thus expect our test cases to have been <italic>harder</italic> to analyze than endogenous fluctuations. This theoretical expectation is indeed borne out by numerical test cases presented in the revised supplement where plasmid copy fluctuations severely reduced the violations of Eq. 2, see new additional SI Sec. 15.</p>
<disp-quote content-type="editor-comment">
<p>Additionally, the case of the outlier circuit (number 12) suggests that exogenous expression of certain genes may lead to an imbalance of natural stoichiometry and lead to indirect effects on target genes which can be misinterpreted as causal relations. Knocking out the endogenous copy may potentially ameliorate this issue but that remains to be tested.</p>
</disp-quote>
<p>We agree with the referee that the expression of exogenous genetic reporters can potentially affect cellular physiology and lead to undesired effects. In the revised manuscript we now explicitly spell out that the metabolic burden or the phototoxicity of introducing fluorescent proteins could in principle cause artificial interactions that do not correspond to the natural gene regulatory network, see Sec. “Proposed additional tests” on p. 8.</p>
<p>However, it is also important to consider that the test circuit #12 represents a synthetic circuit with genes that were expressed at extremely high levels (discussed in 3rd paragraph of Sec. “Evidence that RpoS mediated stress response affected cellular growth in the outlier circuit”, p. 8), which led to the presumed cellular burden. Arguably, natural systems would not typically exhibit such high expression levels, but importantly even if they did, our method does not necessarily rely on fluorescently tagged proteins but can, in principle, also be applied to other methods such as transcript counting through sequencing or in-situ hybridization of fluorescent probes.</p>
<disp-quote content-type="editor-comment">
<p>Ultimately, the value of this manuscript will be greatly elevated if the authors successfully demonstrate the recapitulation of some known naturally existing causal and non-causal relations. For this, the authors can choose any endogenous gene Z that is causally controlled by gene X. The gene X can be on the exogenous plasmid along with the reporter and the shared promoter. Same for another gene Z' which is not causally controlled by gene X. Potentially a knockout of endogenous X may be required but it might depend  on what genes are chosen.</p>
<p>If the authors think the above experiments are outside the scope of this manuscript, they should at least address these issues and comment on how this method could be effectively used by other labs to deduce causal relations between their favorite genes.</p>
</disp-quote>
<p>Because a full analysis of naturally occurring gene interactions was beyond the scope of our work, we agree with the referee’s suggestion to add a section to discuss the limitations of our experimental results. In the revised manuscript we reiterate that additional investigations are needed to show that the method works to detect causal interactions between endogenous genes, see Abstract (p. 1), Introduction (p. 1-2), Sec. “Proposed additional tests” (p. 8), and “Limitations of this study”  (p. 9). In the original manuscript we explicitly spelled out how other researchers can potentially carry out this further work in the subsections titled “Transcriptional dual reporters” (p. 3) and ”Translational dual reporters” (p. 3).  In the revised manuscript, we have added a section “Proposed additional tests” (p. 8) in which we propose an experiment analogous to the one proposed by the referee above, involving an endogenous gene circuit found in <italic>E. coli</italic>, as an example to test our invariant.</p>
<disp-quote content-type="editor-comment">
<p>(2) For a theoretical exposition that is convincing, we suggest the authors simulate a larger network (for instance, a network with &gt;10 nodes), like the one shown schematically in Figure 1, and demonstrate that the invariant relationship holds for the causally disconnected entities, but is violated for the causally related entities. It would also be interesting to see if any quantification for the casual distance between &quot;X&quot; and the different causally related entities could be inferred.</p>
</disp-quote>
<p>We thank the referee for this suggestion. We have added SI Sec. 14 where we present simulation results of a larger network with 10 nodes. We find that all of the components not affected by X satisfy Eq. (2) as they must. However, it is important to consider that we have analytically proven the invariant of Eq. (2) for <italic>all</italic> possible systems. It provably applies equally to networks with 5, 100, or 10,000 components. The main purpose of the simulations presented in Fig. (2) is to <italic>illustrate</italic> our results and to show that correlation coefficients do not satisfy such an invariant. However, they are not used as a proof of our mathematical statements.</p>
<p>We thank the referee for the interesting suggestion of quantifying a “causal distance”. Unfortunately, the degree to which Eq. (2) is violated cannot <italic>directly</italic> equate to an absolute measure for the “causal distance” of an interaction. This is because both the strength of the interaction <italic>and</italic> the size of the stochastic fluctuations in X affect the degree to which Eq. (2) is violated. The distance from the line should thus be interpreted as a lower bound on the causal effect from X to Z because we do not know the magnitude of stochastic effects inherent to the expression of the dual reporters X and Y. While the dual reporters X and Y are identically regulated, they will differ due to stochastic fluctuations. Propagation of these fluctuations from X to Z are what creates an asymmetry between the normalized covariances. In the most extreme example, if X and Y do not exhibit any stochastic fluctuations we have x(t)=y(t) for all times and Eq. (2) will not be violated even in the presence of a strong causal link from X to Z.</p>
<p>However, it might be possible to infer a <italic>relative</italic> causal distance to compare causal interactions within cells.</p>
<p>That is, in a given network, the normalized covariances between X, Y and two other components of interest Z1, Z2 that are affected by X can be compared. If the asymmetry between (η𝑥𝑧1 , η𝑦𝑧1) is larger than the asymmetry between (η𝑥𝑧2 , η𝑦𝑧2) , then we might be able to conclude that X affects Z1 with a stronger interaction than the interaction from X to Z2, because here the intrinsic fluctuations in X are the same in both cases.</p>
<p>In response to the referee’s comment and to test the idea of a relative causal distance, we have simulated a larger network made of 10 components. In this network, X affects a cascade of components called Z8, Z9, and Z10, see the additional SI Sec. 14. Here the idea of a causal distance can be defined as the distance down the cascade: Z8 is closest to X and so has the largest causal strength, whereas Z10 has the weakest. Indeed, simulating this system we find that the asymmetry between η𝑥𝑧8 and η𝑦𝑧8 is the largest whereas that between  η𝑥𝑧10 and η𝑦𝑧10 the smallest. We also find that all of the components not affected by X have normalized covariances that satisfy Eq. (2). This result suggests that the relative causal distance or strength in a network could potentially be estimated from the degree of the violations of Eq. (2).</p>
<p>However, we note that these are preliminary results. In the case of the specific regulatory cascade now considered in SI Sec. 14, the idea of a causal distance can be well defined. Once feedback is introduced into the system, this definition may no longer make sense. For instance, consider the same network that we simulate in SI Sec. 14, but where the most downstream component in the cascade, Z10, feeds back and affects X and Y. In such a circuit it is unclear whether Z8 or Z10 is “causally closer” to X. A more thorough theoretical analysis, equipped with a more universal quantitative definition for causal distance or strength, would be needed to deduce what information can be inferred from the relative distances in the violations of Eq. (2). While this defines an interesting research question, answering it goes beyond the scope of the current manuscript.</p>
<disp-quote content-type="editor-comment">
<p>Minor comments:</p>
<p>- The method relies on the gene X and the reporter Y having the same control which would result in similar dynamics. The authors do not quantitatively compare the YFP and CFP expression if this indeed holds for the synthetic circuits. It would be useful to know how much deviation between the two can be tolerated while not affecting the outcome.</p>
</disp-quote>
<p>We thank the referee for their comment. The invariant of Eq. (2) is indeed only guaranteed to hold only when the transcription rate of Y is proportional to that of X. How much levels of X and Y covary depends on the stochastic effects intrinsic to the expression of the dual reporters as well as how similar the transcriptional control of X and Y is. The stochastic difference between X and Y is exactly what we exploit.</p>
<p>However, in the limit of high YFP and CFP levels, intrinsic fluctuations that cause stochastic expression differences between X and Y become negligible and we can directly infer whether they are indeed tightly co-regulated from time-traces: Below, we show two single cell traces taken with our experimental setup in which the YFP and CFP fluorescence trajectories are almost exactly proportional. Both of these traces are from circuit #10 as defined in Table. S4.</p>
<fig id="sa2fig1">
<label>Author response image 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-92497-sa2-fig1.jpg" mimetype="image"/>
</fig>
<p>We chose the above traces because they showed the highest correlation between YFP and CFP levels. Other traces for lower expression levels have lower correlations due to effects of intrinsic noise (see Tables S2-S4). However, the existence of one trace in which YFP is almost perfectly proportional to CFP throughout can only occur if the YFP and CFP genes are under the same control. And, since the control of YFP and CFP genes in all of our synthetic circuits are identical (with the same promoters and plasmid positions), these data strongly suggest that our dual reporters are tightly co-regulated in all the synthetic circuits. Moreover, the negative control experiments presented in Fig. 3E provide a natural consistency check that the YFP and CFP are under the same control and satisfy Eq. (1).</p>
<p>We agree that it would be useful to know how much the X and Y production rates can differ for Eq. (2) to hold. Importantly, our proven theorem already allows for the rates to differ by an unspecified proportionality constant. In response to the referee’s comment we have derived a more general condition under which our approach holds. In the newly added SI Sec. 7 we prove that Eq. (2) holds also when rates differ as long as the difference is stochastic in nature with an average of zero. We also prove that Eq. (2) holds in the face of multiplicative noise that is independent of the X and Y production rates.</p>
<p>However, the production rates of X and Y cannot differ in all ways. Some types of differences between the X and Y production rates can lead to deviations of Eq. (2) even when there is no causal interaction. To highlight this, we added the results of simulations of a toy model in which the X and Y production rates differ by an additive noise term that <italic>does not</italic> average to zero, see Fig. S19B of the newly added SI Sec. 7.</p>
<disp-quote content-type="editor-comment">
<p>- The invariant should potentially hold true for any biological species that are causally related e.g. protein-protein interactions. Also, this method could potentially find many applications in eukaryotic cells. Although it's outside the scope of current work to experimentally demonstrate such applications, the authors should comment on experimental strategies to apply this method to overcome potential pitfalls (e.g. presence of enhancers in eukaryotic cells).</p>
</disp-quote>
<p>We thank the referee for this suggestion. We agree that there are potential pitfalls that could come into effect when our proposed approach is applied on more complex systems such as eukaryotic gene expression. In response to the referee’s comment, we have added an explicit discussion of these potential pitfalls in the discussion section “Limitations of this study” (see p. 10).</p>
<p>In particular, in eukaryotes there are many genes in which promoter sequences may not be the sole factor determining transcription rates. Other factors that can be involved in gene regulation include the presence of enhancers, epigenetic modifications, and bursts in gene expression, to name a few. We thus propose a few strategies, which include positioning the passive reporter at a similar gene loci as the gene of interest, measuring the gene regulation activities of the gene of interest and its passive reporter using a separate method, and exploiting the invariant with a third gene, where it is known there is no causal interaction, as a consistency check. In addition, we include in the SI a new section SI Sec. 8 which shows that the invariant holds in the face of many types of bursty gene expression dynamics.</p>
<p>However, the above is not a comprehensive list. Some of the issues the referee mentions are serious and may not be straightforward to overcome. We now spell this out explicitly in the revised manuscript (p. 10).</p>
<disp-quote content-type="editor-comment">
<p>- In the legend of Fig. 1, the sentence &quot;Data points here are for...&quot; is missing a few words, or needs to be rephrased.</p>
</disp-quote>
<p>We thank the referee for this comment. We have rewritten the figure caption, which now reads “Data points are numerical simulations of specific example networks (see SI for details) to illustrate the analytically proven theorem of Eq. 2.”</p>
<disp-quote content-type="editor-comment">
<p>- Fig. 2 talks about the uncertainties associated with each point on the scatter plots. However, it is difficult to understand the quantification in such a plot. It would be great to have a plot quantifying the uncertainties in the invariant relation for the different topologies studied, specifically in order to understand if one topology is consistently deviating more from the x=y line than the other topologies studied here.</p>
</disp-quote>
<p>We thank the referee for this suggestion. In the supplement of the revised manuscript we have added supplemental Figs. S3, S4, and  S5 to separately quantify the uncertainty of the difference processes plotted in Fig. 2 and have added a new section (SI Sec. 11) to discuss the processes simulated in Fig. 2 in more detail. In short, each simulated process generated less than ~5% of outliers when considering 95% confidence intervals (with the max percentage deviation being 5.01% for process 5, see Fig. S5). These outliers were then simulated over a larger number of simulations to reduce the sampling error, which resulted in 0% of outliers (see Sec. “Confidence intervals for finite sampling error” on Materials and Methods on p. 11). Some simulated processes generated larger percentage errors in the normalized covariances than others, but this is expected as different processes have different dynamics which will result in different degrees of sampling of the underlying distributions.</p>
<p>Note, that the invariant of Eq. 2 is analytically proven for all tested topologies as none of the topologies include a causal effect from X to Z. Any deviation of the numerical data from the straight line prediction of Eq. 2 (right column in Fig. 2C) is due to the finite sampling of a stochastic process to estimate the true covariance from the sampling covariance. Any given parameter set was simulated several times which allowed us to estimate the sampling error from differences in between repeated samples. In the additional SI figures we now quantify this error for the different topologies.</p>
<p>In addition to the above changes we want to highlight that the purpose of the simulations presented in Fig. (2) is not to prove our statements or explore the behavior of different topologies. The purpose of the data presented in the right column of Fig. 2C is to illustrate the theoretical invariant and act as a numerical sanity check of our analytically proven result. In contrast, the data in the left column of Fig 2C illustrates that the correlations do not satisfy an invariant like Eq. 2 which applies to covariances but not correlations.</p>
<disp-quote content-type="editor-comment">
<p>- The legend for Fig. 3 seems to end abruptly. There likely needs to be more.</p>
</disp-quote>
<p>We thank the referee for catching this mistake. We have corrected the accidentally truncated figure caption of Fig. 3.</p>
<disp-quote content-type="editor-comment">
<p>- There is a typo in equation (5.3) on page 23 of supplementary material, there should be x instead of y in the degradation equation of x.</p>
</disp-quote>
<p>We thank the referee for catching this mistake which has been corrected in the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p>- In the supplemental material, to understand the unexpected novel discovery of causality, Figure S5 is presented. However, this doesn't give the context for other negative controls designed, and the effect of rfp dynamics (which can be seen in the plots both in the main paper and the supplement) in the growth rate of cells in those constructs. As a baseline, it would be nice to have those figures.</p>
</disp-quote>
<p>We thank the referee for this suggestion. We have now included representative RFP traces with the growth rates for other negative control circuits, see Fig. S10. In addition, we have now included the cross correlation functions between RFP and growth rate in these negative control circuits, see Fig. S10A. While in all cases, RFP and growth rate are negatively correlated, the outlier circuit exhibits the largest negative correlation.</p>
<p>The suggested comparison of the referee thus highlights that – in isolation – a negative correlation between RFP and growth rate is only weak evidence for our hypothesized causal interaction because negative correlations can result from the effect of growth rate affecting volume dilution and thus RFP concentration. Crucially, we thus additionally considered the overall variability of growth rate and found the outlier circuit has the largest growth rate variability which is indicative of something that is affecting the growth rate of those cells, see Fig. S10B. To compare the magnitude of RFP variability against other strains requires constraining the comparison group to other synthetic circuits that have RFP located on the chromosome rather than a plasmid. This is why we compare the CV of the outlier with the CV of circuit #5, which corresponds to the “regular” repressilator (i.e., the outlier circuit without the endogenous lacI gene). As an additional comparison, we computed the CV for a strain of <italic>E. coli</italic> that does not contain a synthetic plasmid at all, but still contains the RFP gene on the chromosome. We find that the CVs in the outlier circuit to be larger than in these two additional circuits, suggesting that the outlier circuit causes additional fluctuations in the RFP and growth rate. We now spell this out explicitly in the revised manuscript (see Sec. “Evidence that RpoS mediated stress response affected cellular growth in the outlier circuit“, p. 8).</p>
<p>The referee is correct that the above arguments are only circumstantial evidence, but they do show that the data is consistent with a plausible explanation of the hypothesized causal interaction. Our main evidence for an RpoS mediated stress response that explains the deviations from Eq. 2 in the outlier circuit is the perturbation experiment in which the deviation disappears for the RpoS knockout strain. We now spell out this argument explicitly in the revised manuscript (see Sec. “Evidence that RpoS mediated stress response affected cellular growth in the outlier circuit“, p. 8).</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p>
<p>The proof of theorem 1 relies on an earlier result, lemma 1. Lemma 1 only guarantees the existence of a &quot;dummy&quot; system that satisfies the separation requirement and preserves the dynamics of X and Y. However, in principle, it may be possible to maintain the dynamics of X and Y while still changing the relationship between Cov(X,Zk) and Cov(Y,Zk). This could occur if the dynamics of Zk differ in a particular way between the original system and the dummy system. So lemma 1 needs to be a little stronger- it needs  to mention that the dynamics of Zk are preserved, or something along these lines. The proof of lemma 1 appears to contain the necessary ingredients for what is actually needed, but this should be clarified.</p>
</disp-quote>
<p>We agree with the referee that this is an important distinction. Lemma 1 does in fact guarantee that any component Zk that is not affected by X and Y will have the same dynamics in the “dummy” system. However, as the referee points out, this is not stated in the lemma statement nor in the proof of the lemma. In response to the referee’s comment, we have made it clear in the lemma statement that the Zk dynamics are preserved in the “dummy” system, and we have also added details to the proof to show that this is the case, see Lemma 1 on p. 27 of the SI.</p>
<disp-quote content-type="editor-comment">
<p>Readers who are familiar with chemical reaction diagrams, but not birth-death process diagrams may waste some time trying to interpret Equation 1 as a chemical reaction diagram with some sort of rate constant as a label on each arrow (I did this). It may be helpful to either provide a self-contained definition of the notation used, or mention a source where the necessary definitions can be found.</p>
</disp-quote>
<p>We agree with the referee. In the revised manuscript we have added a description of the notation used below Equation 1 of the main text, see p. 2. The notational overloading of the “arrow notation” is a perennial problem in the field and we thank the referee for reminding us of the need to clarify what the arrows mean in our diagrams.</p>
<disp-quote content-type="editor-comment">
<p>It would be helpful if the authors could propose a rule for deciding whether dependence is detected or not. As it stands presently, the output of the approach seems to be a chart like that in Figure 3D where you show eta_xz and eta_yz with confidence interval bars and the reader must visually assess whether the points more-or-less fall on the line of unity. It would be better to have some systematic procedure for making a &quot;yes or no&quot; call as to whether a causal link was detected or not. Having a systematic detection rule would allow you to make a call as to whether dependence in circuit 3 was detected or not. It would also allow you or a future effort to evaluate the true positive rate of the approach in simulated settings.</p>
</disp-quote>
<p>We thank the referee for this suggestion. In the revised manuscript we have added an explicit rule for detecting causality using the invariant of Eq. (2). Specifically, Eq. (2) can be re-written as r = 1 where r is the covariability ratio r = etaXZ/etaYZ. In that case, given 95% confidence intervals for the experimentally determined covariability ratio r, we say that there is a causal interaction if the confidence intervals overlap with the value of r = 1.</p>
<p>This corresponds to a null hypothesis test at the 2.5% significance level. The reason that it is at 2.5% significance and not 5% significance is as follows. Let’s say we measure a covariability ratio of r_m, and the 95% confidence interval is [r_m - e_m, r_m + e_m] for some error e_m. Without loss of generality, let’s say that r_m &gt; 1 (the same applies if r_m &lt; 1). This means that Prob(r &lt; r_m - e_m) = 2.5% and Prob(r &gt; r_m + e_m) = 2.5% , where r is the actual value of the covariability ratio. Under the null hypothesis that there is no causal interaction, we set r = 1. However, we now have Prob(1 &lt; r_m + e_m) = 0, because we know that r_m &gt; 1 and so we must have r_m + e_m &gt; 1. The probability that the value of 1 falls outside the error bars is therefore 2.5% under the null hypothesis.</p>
<p>This proposed rule is the same rule that we used to detect statistical outliers in our simulations, where we found a “false positive” rate of 2.3% over 6522 simulated systems due to statistical sampling error (as discussed in the Materials and Methods section). In response to the referee’s suggestion, we have added the section “A rule for detecting causality in the face of measurement uncertainty” (p. 4). We also apply the rule to the experimental data and find that the rule detects 2/4 causal interactions in Fig. 3D. We have clarified this in the Fig. 3D caption, in the main text, and we have added a figure in the SI (Fig. S2) where we apply the null hypothesis test on the measured covariability ratios.</p>
<p>Note, whether the third interaction is “detected” or not depends on the cut-off value used. We picked the most common 95% rule to be consistent with the traditional statistical approaches. With this rule one of the data points lies right at the cusp of detection, but ultimately falls into the “undetected” category if a strictly binary answer is sought under the above rule.</p>
<disp-quote content-type="editor-comment">
<p>It would be helpful to mention what happens when the abundance of a species hits zero. Specifically, there are two ways to interpret the arrow from X to X+d with a W on top:</p>
<p>Interpretation (1):</p>
<p>P(X+d | X) = W if X+d {greater than or equal to} 0  P(X+d | X) = 0 if X_i+d_i &lt; 0 for at least one i</p>
<p>Interpretation (2):</p>
<p>P(X+d | X) = W regardless of whether X+d &lt; 0  W = 0 whenever X_i &lt; d_i for at least one i</p>
<p>Interpretation (1) corresponds to a graph where the states are indexed on the non-negative integers. Interpretation (2) corresponds to a graph where the states are indexed on the integers (positive or negative), and W is responsible for enforcing the non-negativity of mass. I believe you need the second interpretation because the first interpretation leads to problems with your definition of causality. For example, consider the reaction:</p>
<p>(Na, K) -- 0.1 --&gt; (Na-1, K+1)</p>
<p>This could occur if Na and K are the intracellular concentrations of sodium and potassium ions in a cell that has an ATP-driven sodium-potassium exchanger whose rate is limited by the frequency with which extracellular potassium ions happen to flow by. Per the definition of causality found in the appendix, Na has no causal effect on K since Na does not show up in the reaction rate term. However, under interpretation (1), Na clearly has a causal effect on K according to a reasonable definition of causality because if Na=0, then the reaction cannot proceed, whereas if Na&gt;0 then it can. However, under interpretation (2), the reaction above cannot exist and so this scenario is excluded.</p>
</disp-quote>
<p>We thank the referee for this comment that helped us clarify the meaning of arrows with propensities. In short, interpretation (2) corresponds to the definition of our stochastic systems. This is consistent with the standard notation used for the chemical master equation. As the referee points out, because molecular abundances cannot be negative, any biochemical system must then have the property that the propensity of a reaction must be equal to zero when the system is in a state in which an occurrence of that reaction would take one of the abundances to negative numbers. Stochastic networks that do not have this property cannot correspond to biochemical reaction networks.</p>
<p>In the revised manuscript, we now spell this out explicitly to avoid any confusion, see SI page 25.</p>
<p>Furthermore, we additionally discuss the referee’s example in which the rate of exchanging Na for K through an ion exchanger is approximately independent of the intracellular Na concentration. Because biochemical systems cannot become negative, it cannot be that the rate is truly constant, but at some point for low concentrations must go down until it becomes exactly zero for zero molecules.</p>
<p>Importantly, agreement with Eq. (2) does not imply that there is no causal effect from X to Zk. It is the deviation from Eq. (2) that implies the existence of a causal effect from X to Zk. Therefore, although the above referee’s example would constitute a causal interaction in our framework, it would not lead to a deviation of Eq. (2) because the fluctuations in Na (which we exploit) do not propagate to K. From a practical point of view, our method thus detects whether changing X <italic>over the observed range</italic> affects the production and degradation rates of Zk.</p>
<disp-quote content-type="editor-comment">
<p>In the course of setting up the negative control benchmark circuits, a perturbation-based causal validation would be nice. For instance, first, verify that X does not affect Z by intervening on X (e.g. changing its copy number or putting it under the control of an inducible promoter), and ensuring that Z's activity is not affected by such interventions upon X. This approach would help to adjudicate questions of whether the negative control circuits actually have an unknown causal link. The existing benchmark is already reasonably solid in my view, and I do not know how feasible this would be with the authors' setup, but I think that a perturbation-based validation could in principle be the gold standard benchmark.</p>
</disp-quote>
<p>We agree that additional perturbation-based validation tests on all of the negative control circuits would indeed improve the evidence that our method worked as advertised. While such experiments are indeed beyond the scope of our current work we now explicitly point out the benefits of such additional controls in the revised Discussion.</p>
<disp-quote content-type="editor-comment">
<p>Below is a series of comments about typography, mostly about section 4 of the supplement.</p>
</disp-quote>
<p>We thank the referee for their careful reading and highlighting those mistakes.</p>
<disp-quote content-type="editor-comment">
<p>At the bottom of page 21, Z_aff is defined as the set of components that are affected by X. However, later Z_aff seems to refer to components affected by X or Y. For instance, in the proof of lemma 1, it is written &quot;However, because a is part of z_aff, the {ak} variables must be affected by X and/or Y.&quot;</p>
</disp-quote>
<p>We thank the referee for catching this mistake. We have changed the definition of Z_aff throughout the supplement to refer to components affected by X or Y. If it can be experimentally ensured that Y is a passive reporter (i.e., it does not affect other components in the cell), then the theorem can only be violated if X affects Z.</p>
<disp-quote content-type="editor-comment">
<p>In the equation following Eq 5.2, W_k and d_k should be W_i and d_i ?</p>
</disp-quote>
<p>Yes, the referee is correct. In the revised manuscript we have corrected W_k and d_k to W_i and d_i.</p>
<disp-quote content-type="editor-comment">
<p>In Eq 5.3 in the lower-left transition diagram, I think a &quot;y&quot; should be an &quot;x&quot;.</p>
</disp-quote>
<p>Yes, the referee is correct. In the revised manuscript  we have fixed this typo.</p>
<disp-quote content-type="editor-comment">
<p>In the master equation above Eq 5.5, the &quot;R&quot; terms for the y reactions are missing the alpha term, and I think two of the beta terms need to be multiplied by x and y respectively.</p>
</disp-quote>
<p>The referee is correct. In the revised manuscript  we have fixed this typo.</p>
<disp-quote content-type="editor-comment">
<p>The notation of Eq 5.8, where z_k(t) is the conditional expectation of z_kt, is strange and difficult to follow. Why does z_k(t) not get a bar over it like its counterparts for x, y, R, and beta? The bars, although not a perfect solution, do help.</p>
</disp-quote>
<p>We agree with the referee’s comment and have added further explanations to define the averages in question, see SI p. 28. In short, when we condition on the history of the components not affected by X or Y, we in effect condition on the time trajectories of z_{k} (when it is part of the components not affected by X and/or Y) and beta (since it only depends on the components not affected by X or Y). We thus previously did not include the bars when taking the averages of these components in the conditional space because the conditioning in effect sets their time-trajectories (so they become deterministic functions of time). In the revised manuscript we now also denote these conditional expectations with bars and we have added comments to the proof to clarify their definition.</p>
<disp-quote content-type="editor-comment">
<p>I think it would be helpful to show how the relationship =/alpha is obtained from Eq 5.5.</p>
</disp-quote>
<p>We agree with this suggestion and have added the derivations, see Eqs. (5.9) - (5.13) in the revised SI.</p>
<disp-quote content-type="editor-comment">
<p>In the main text, the legend of Fig 3 cuts off mid-sentence.</p>
</disp-quote>
<p>We thank the referee for catching this mistake which has been fixed in the revised manuscript.</p>
</body>
</sub-article>
</article>