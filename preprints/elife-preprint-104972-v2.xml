<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">104972</article-id>
<article-id pub-id-type="doi">10.7554/eLife.104972</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.104972.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>A stochastic explanation for observed local-to-global foraging states in Caenorhabditis elegans</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Margolis</surname>
<given-names>Andrew</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Gordus</surname>
<given-names>Andrew</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A3">3</xref>
<email>agordus@jhu.edu</email>
</contrib>
<aff id="A1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00za53h95</institution-id><institution>Department of Biology, Johns Hopkins University</institution></institution-wrap>, <city>Baltimore</city>, <country country="US">United States</country></aff>
<aff id="A2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/046rm7j60</institution-id><institution>David Geffen School of Medicine, University of California, Los Angeles</institution></institution-wrap>, <city>Los Angeles</city>, <country country="US">United States</country></aff>
<aff id="A3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00za53h95</institution-id><institution>Solomon H. Snyder Department of Neuroscience, Johns Hopkins University</institution></institution-wrap>, <city>Baltimore</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Portman</surname>
<given-names>Douglas</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Rochester</institution>
</institution-wrap>
<city>Rochester</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Desplan</surname>
<given-names>Claude</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>New York University</institution>
</institution-wrap>
<city>New York</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<pub-date pub-type="epub">
<day>10</day>
<month>04</month>
<year>2025</year>
</pub-date>
<pub-date date-type="original-publication" iso-8601-date="2025-02-13">
<day>13</day>
<month>02</month>
<year>2025</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-06-10">
<day>10</day>
<month>06</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP104972</elocation-id>
<history><date date-type="sent-for-review" iso-8601-date="2024-11-07">
<day>07</day>
<month>11</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-10-30">
<day>30</day>
<month>10</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.48550/arXiv.2309.15174"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2025-02-13">
<day>13</day>
<month>02</month>
<year>2025</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.104972.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.104972.1.sa4">eLife Assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.104972.1.sa3">Reviewer #1 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.104972.1.sa2">Reviewer #2 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.104972.1.sa1">Reviewer #3 (Public review):</self-uri>
<self-uri content-type="author-comment" xlink:href="https://doi.org/10.7554/eLife.104972.1.sa0">Author response:</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Margolis &amp; Gordus</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Margolis &amp; Gordus</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-104972-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>Abrupt changes in behavior can often be associated with changes in underlying behavioral states. When placed off food, the foraging behavior of <italic>C. elegans</italic> can be described as a change between an initial local-search behavior characterized by a high rate of reorientations, followed by a global-search behavior characterized by sparse reorientations. This is commonly observed in individual worms, but when numerous worms are characterized, only about half appear to exhibit this behavior. We propose an alternative model that predicts both abrupt and continuous changes to reorientation that does not rely on behavioral states. This model is inspired by molecular dynamics modeling that defines the foraging reorientation rate as a decaying parameter. By stochastically sampling from the time interval probability distribution defined by this rate, both abrupt and gradual changes to reorientation rates can occur, matching experimentally observed results. Crucially, this model does not depend on behavioral states or information accumulation. Even though abrupt behavioral changes do occur, they are not necessarily indicative of abrupt changes in behavioral states, especially when abrupt changes are not universally observed in the population.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
</front>
<body>
<sec id="s1" sec-type="intro">
<title>Introduction</title>
<p>The search for food in the absence of informative sensory cues is an essential animal behavior<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. A foraging strategy that is observed in nearly all animals is the Area Restricted Search (ARS)<sup><xref ref-type="bibr" rid="c2">2</xref></sup>. In ARS animals randomly forage for food<sup><xref ref-type="bibr" rid="c3">3</xref></sup>, but appetitive sensory cues (like an encounter with food) will cause the animal to restrict their search area by reorienting more frequently, thus increasing the likelihood of food encounters. Conversely, when removed from food, animals will decrease their reorientation rate to increase dispersal<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c4">4</xref></sup>. <italic>Caenorhabditis elegans</italic> and <italic>Drosophila melanogaster</italic> larvae appear to progressively increase their diffusion constant while foraging off of food by decreasing their rates of reorientation<sup><xref ref-type="bibr" rid="c4">4</xref></sup>. However in separate studies<sup><xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c6">6</xref></sup>, individual worms appear to make an abrupt change from a high to low rate of reorientation. This behavior has been described as a switch from a local to global search strategy, that relies on evidence accumulation to trigger the behavioral switch<sup><xref ref-type="bibr" rid="c6">6</xref></sup>.</p>
<p>A central challenge with defining these possible state transitions is the stochastic nature of the behavior itself. Reorientations are random and follow Poisson statistics<sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c13">13</xref></sup>. This is very similar to the temporal behavior of individual molecules in solution<sup><xref ref-type="bibr" rid="c14">14</xref></sup>. Individual molecules defined by the same reaction kinetics can stochastically produce long or short time intervals between reaction events, not because one molecule is inherently faster than the other, but because they are stochastically sampling from the same probability distribution. The diversity of times between individual worm reorientations is very similar to this. The exponentially decaying reorientation rate emerges from the average of trajectories that do not necessarily conform to this curve individually. However, even those that produce abrupt switches in reorientation rates could still emerge from a simple exponential decay strategy. Since reorientations occur stochastically, the abrupt changes in reorientation rates could simply be the result of stochastic sampling of an underlying decay phenomenon<sup><xref ref-type="bibr" rid="c15">15</xref></sup>. Here, we show that a simple, stochastic model that does not rely on switches in behavioral state is sufficient to reproduce the reorientation kinetics observed in experimental data.</p>
</sec>
<sec id="s2" sec-type="results">
<title>Results</title>
<sec id="s2-1">
<title>Local-to-global behavioral transitions are inconsistently observed</title>
<p>In López-Cruz <italic>et al</italic><sup><xref ref-type="bibr" rid="c5">5</xref></sup>., the foraging behaviors of individual worms were tracked for 45 minutes after being removed from food. As observed previously<sup><xref ref-type="bibr" rid="c4">4</xref></sup>, the reorientation rate from this study followed an exponential decay (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). It was reported that roughly half the worms appeared to make a sudden single switch from local to global search as observed in Calhoun <italic>et al</italic><sup><xref ref-type="bibr" rid="c6">6</xref></sup>, however the other half appeared to produce no discernable change in search strategy, or exhibited multiple switches (<xref ref-type="fig" rid="fig1">Figure 1 b–d</xref>). Whether or not a worm performed a single decision was defined in López-Cruz <italic>et al</italic><sup><xref ref-type="bibr" rid="c5">5</xref></sup> by fitting individual reorientation data to two lines using the MATLAB function <italic>findchangepts</italic> (<xref ref-type="fig" rid="fig1">Figure 1b</xref>)<sup><xref ref-type="bibr" rid="c16">16</xref></sup>. This function divides each trace into two regions that are defined by minimizing the sum of the residual squared error of two local linear regressions. The location of the transition point is varied until the total residual error attains a minimum (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). A large change in slope indicates a sudden change in reorientation rate, and the intersect between the two lines determines the decision-time<sup><xref ref-type="bibr" rid="c5">5</xref></sup> (<xref ref-type="fig" rid="fig1">Figure 1b</xref>). A worm was identified as making a sudden local-to-global foraging switch based on visually assessing the magnitude of the slope difference. To evaluate this property more objectively, we assessed the distributions of slope-differences (<italic>s<sub>1</sub>-s<sub>2</sub></italic>) and transition times to see whether two densities were clearly distinguishable. The resulting distributions for the experimental data were continuous, with no clear boundary between deciders and nondeciders (<xref ref-type="fig" rid="fig1">Figure 1e</xref>).</p>
<p>Why do some worms appear to make a decision, while others do not? In aggregate, the reorientation rate decays (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). Despite the population average conforming to a gradual decay, individual trajectories produce a wide diversity of trajectories which sometimes conform to an apparent drop in reorientation rate (<xref ref-type="fig" rid="fig1">Figure 1c</xref>), while others do not (<xref ref-type="fig" rid="fig1">Figure 1d</xref>). If the worms are executing a decision, this would seem to indicate only a fraction of the worms decide to switch from local to global foraging strategies, while others use a different strategy. An alternative hypothesis is that sudden changes in reorientation are random events, that do not occur due to an underlying change in strategy, but because of the inherently random nature of the behavior itself <sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c13">13</xref></sup>.</p>
</sec>
<sec id="s2-2">
<title>A stochastic model generates abrupt and gradual changes in search strategy</title>
<p>We tested this hypothesis by modeling individual worms by stochastic sampling of a decaying reorientation rate with the Gillespie algorithm (<xref ref-type="fig" rid="fig2">Figure 2a</xref>), a common strategy used to model the kinetics of individual molecules<sup><xref ref-type="bibr" rid="c17">17</xref></sup>. With this strategy, the time between chemical events is modeled by randomly sampling from the time-interval distributions defined by the reaction rates. Although the algorithm was originally developed to model discrete molecular events based on known kinetic parameters, it can be used to generate time trajectories for any discrete events when the kinetics are known. A behavioral example of this is the Lotka-Voltera predator-prey competition model where predator and prey populations fluctuate out of phase due to predation. Stochastic fluctuations of predator and prey populations can be modeled using the Gillespie algorithm<sup><xref ref-type="bibr" rid="c18">18</xref>–<xref ref-type="bibr" rid="c20">20</xref></sup>.</p>
<p>Experimentally, reorientation rate is measured as the number of reorientation events that occurred in an observational window. However, these are discrete stochastic events, so we can describe them in terms of propensity, i.e. the probability of observing a transitional event (in this case, a reorientation) is:
<disp-formula id="FD1">
<alternatives>
<mml:math id="M1" display="block"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mtext>P</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>t</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>,</mml:mo><mml:mtext>t</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2309.15174v3_eqn1.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(1)</label>
</disp-formula>
</p>
<p>Here, Ω is reorientation number, <italic>P(Ω</italic> + 1, <italic>t</italic>) is the probability of observing a reorientation event at time t, and <italic>a<sub>1</sub></italic> is the propensity for this event to occur. Observationally, the frequency of reorientations observed decays over time, so we can define the propensity as:
<disp-formula id="FD2">
<alternatives>
<mml:math id="M2" display="block"><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>α</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:math>
<graphic xlink:href="2309.15174v3_eqn2.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(2)</label>
</disp-formula>
</p>
<p>Where <italic>α</italic> is the initial propensity at t=0, and <italic>β</italic> is the propensity at t = ∞.</p>
<p>We can model this decay as the reorientation propensity coupled to a decaying factor (M):
<disp-formula id="FD3">
<alternatives>
<mml:math id="M3" display="block"><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>t</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>M</mml:mi><mml:mo>,</mml:mo><mml:mtext>t</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2309.15174v3_eqn3.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(3)</label>
</disp-formula>
</p>
<p>Where the propensity of this event (<italic>a<sub>2</sub></italic>) is:
<disp-formula id="FD4">
<alternatives>
<mml:math id="M4" display="block"><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mi>M</mml:mi></mml:math>
<graphic xlink:href="2309.15174v3_eqn4.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(4)</label>
</disp-formula>
</p>
<p>Since <italic>M</italic> is a first-order decay process, when integrated, the <italic>M</italic> observed at time <italic>t</italic> is:
<disp-formula id="FD5">
<alternatives>
<mml:math id="M5" display="block"><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>t</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mn>0</mml:mn><mml:mo>)</mml:mo></mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math>
<graphic xlink:href="2309.15174v3_eqn5.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(5)</label>
</disp-formula>
</p>
<p>We can couple the probability of observing a reorientation to this decay by redefining <italic>a<sub>1</sub></italic> as:
<disp-formula id="FD6">
<alternatives>
<mml:math id="M6" display="block"><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mi>α</mml:mi><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mstyle><mml:mi>M</mml:mi><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:math>
<graphic xlink:href="2309.15174v3_eqn6.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(6)</label>
</disp-formula>
</p>
<p>So that now:
<disp-formula id="FD7">
<alternatives>
<mml:math id="M7" display="block"><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>+</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>t</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mi>γ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>,</mml:mo><mml:mtext>t</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2309.15174v3_eqn7.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(7)</label>
</disp-formula>
</p>
<p>A critical detail should be noted. While reorientations are modeled as discrete events, the amount of M at time <italic>t</italic>=0 is chosen to be large (<italic>M</italic><sub>0</sub> ← 1,000), so that over the timescale of 40 minutes, the decay in M is practically continuous. This ensures that sudden changes in reorientations are not due to sudden changes in M, but due to the inherent stochasticity of reorientations.</p>
<p>To model both processes, we can create the master equation:
<disp-formula id="FD8">
<alternatives>
<mml:math id="M8" display="block"><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mi>d</mml:mi><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>,</mml:mo><mml:mtext>M</mml:mtext><mml:mo>,</mml:mo><mml:mtext>t</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mstyle><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mtext>M</mml:mtext><mml:mo>,</mml:mo><mml:mtext>t</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>,</mml:mo><mml:mtext>M</mml:mtext><mml:mo>,</mml:mo><mml:mtext>t</mml:mtext></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>,</mml:mo><mml:mtext>M+1</mml:mtext><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Ω</mml:mi><mml:mo>,</mml:mo><mml:mtext>M</mml:mtext><mml:mo>,</mml:mo><mml:mi>t</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2309.15174v3_eqn8.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(8)</label>
</disp-formula>
</p>
<p>Since these are both Poisson processes, the probability density function for a state change <italic>i</italic> occurring at time <italic>t</italic> is:
<disp-formula id="FD9">
<alternatives>
<mml:math id="M9" display="block"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>t</mml:mi></mml:mrow></mml:msup></mml:math>
<graphic xlink:href="2309.15174v3_eqn9.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(9)</label>
</disp-formula>
</p>
<p>The probability that an event will <italic>not</italic> occur in time interval t is:
<disp-formula id="FD10">
<alternatives>
<mml:math id="M10" display="block"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>τ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msubsup><mml:mo>∫</mml:mo><mml:mi>τ</mml:mi><mml:mi>∞</mml:mi></mml:msubsup><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>t</mml:mi><mml:mo>=</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2309.15174v3_eqn10.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(10)</label>
</disp-formula>
</p>
<p>The probability that no events will occur for ALL transitions in this time interval is:
<disp-formula id="FD11">
<alternatives>
<mml:math id="M11" display="block"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>τ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>t</mml:mi><mml:mo>&gt;</mml:mo><mml:mi>τ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∏</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mi>τ</mml:mi></mml:mrow></mml:msup></mml:mrow></mml:mstyle><mml:mo>=</mml:mo><mml:mi>exp</mml:mi><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mo>−</mml:mo><mml:mi>τ</mml:mi><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>]</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2309.15174v3_eqn11.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(11)</label>
</disp-formula>
</p>
<p>We can draw a random number (<italic>r</italic><sub>0</sub> ∈ [0,1]) that represents the probability of no events in time interval <italic>τ</italic>, so that this time interval can be assigned by rearranging <xref ref-type="disp-formula" rid="FD11">equation 11</xref>:
<disp-formula id="FD12">
<alternatives>
<mml:math id="M12" display="block"><mml:mi>τ</mml:mi><mml:mo>←</mml:mo><mml:mfrac><mml:mrow><mml:mo>−</mml:mo><mml:mi>ln</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>r</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:math>
<graphic xlink:href="2309.15174v3_eqn12.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(12)</label>
</disp-formula>
</p>
<p>where:
<disp-formula id="FD13">
<alternatives>
<mml:math id="M13" display="block"><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>i</mml:mi></mml:msub><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2309.15174v3_eqn13.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(13)</label>
</disp-formula>
</p>
<p>This is the time interval for any event (Ω+1 or <italic>M</italic>-1) happening at <italic>t</italic> + τ. The probability of which event occurs is proportional to its propensity:
<disp-formula id="FD14">
<alternatives>
<mml:math id="M14" display="block"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>i</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:mfrac></mml:mstyle></mml:math>
<graphic xlink:href="2309.15174v3_eqn14.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(14)</label>
</disp-formula>
</p>
<p>We can draw a second number (<italic>r</italic><sub>2</sub> ∈ [0,1]) that represents this probability so that which event occurs at time t + τ is determined by the smallest <italic>n</italic> that satisfies:
<disp-formula id="FD15">
<alternatives>
<mml:math id="M15" display="block"><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2309.15174v3_eqn15.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(15)</label>
</disp-formula>
</p>
<p>so that:
<disp-formula id="FD16">
<alternatives>
<mml:math id="M16" display="block"><mml:mi>e</mml:mi><mml:mi>v</mml:mi><mml:mi>e</mml:mi><mml:mi>n</mml:mi><mml:mi>t</mml:mi><mml:mtext> </mml:mtext><mml:mi>i</mml:mi><mml:mo>←</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>n</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>r</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>⋅</mml:mo><mml:msub><mml:mi>a</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>≤</mml:mo><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>n</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>a</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow></mml:mstyle></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2309.15174v3_eqn16.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(16)</label>
</disp-formula>
</p>
<p>For example, if the propensity <italic>a<sub>1</sub></italic> is 10% of <italic>a<sub>0</sub></italic> at time <italic>t</italic>, then there is a 10% chance that the resulting reaction will occur at time <italic>t</italic>. The elegant efficiency of the Gillespie algorithm is two-fold. First, it models all transitions simultaneously, not separately. Second, it provides floating-point time resolution. Rather than drawing a random number, and using a cumulative probability distribution of interval-times to decide whether an event occurs at discrete steps in time, the Gillespie algorithm uses this distribution to draw the interval-time itself. The time resolution of the prior approach is limited by step size, whereas the Gillespie algorithm’s time resolution is limited by the floating-point precision of the random number that is drawn.</p>
<p>In this way, the Gillespie algorithm enables the simultaneous modeling of numerous reactions in parallel with machine-precision time resolution. To ensure the reorientation rate itself is a smooth decay, a large value of M is used to approximate a continuous function. The underlying assumptions are:
<list list-type="order">
<list-item><p>Reorientations are stochastic<sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c13">13</xref></sup>.</p></list-item>
<list-item><p>All the worms experience a common decay of a signaling factor (<italic>M</italic>) (<xref ref-type="disp-formula" rid="FD5">Equation 5</xref>) that influences the reorientation rate (<xref ref-type="disp-formula" rid="FD7">Equation 7</xref>).</p></list-item>
</list>
</p>
<p>In our approach, we fit the exponential curve in <xref ref-type="disp-formula" rid="FD2">Eq. 2</xref> to the average reorientation rate from the experimental data from López-Cruz<sup><xref ref-type="bibr" rid="c5">5</xref></sup> (<xref ref-type="fig" rid="fig2">Figure 2b</xref>), and then used these parameters (<italic>α, β, γ</italic>) to model 1,631 individual worms (the same number of animals in the experimental data). Even though the initial average rates of reorientation are ~1.5 events/minute, there is considerable variance in observed initial rates (<xref ref-type="fig" rid="fig1">Figure 1a</xref>). To address this variance, starting values of <italic>M</italic> were assigned based on randomly drawing a rate from the observed experimental rates at <italic>t</italic> = 0, and adjusting <italic>M</italic> so that the starting rate for that <italic>in silico</italic> worm matched the initial rate of the randomly drawn experimental worm:
<disp-formula id="FD17">
<alternatives>
<mml:math id="M17" display="block"><mml:msub><mml:mi>M</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>←</mml:mo><mml:mfrac><mml:mrow><mml:msub><mml:mi>M</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>r</mml:mi><mml:mo>−</mml:mo><mml:mi>β</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mi>α</mml:mi></mml:mfrac></mml:math>
<graphic xlink:href="2309.15174v3_eqn17.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(17)</label>
</disp-formula>
</p>
<p>where <italic>r</italic> is an initial rate randomly drawn from the experimental data.</p>
<p><italic>In silico</italic> reorientation curves generated produced single-transition and multi/absent transition curves, as observed experimentally (<xref ref-type="fig" rid="fig2">Figure 2c</xref>). When plotted along with the experimental data, the <italic>in silico</italic> data produced a distribution of linear regression parameters comparable to the experimental worms (<xref ref-type="fig" rid="fig2">Figure 2d</xref>). The simulation was able to produce individual trajectories that demonstrated switching behavior, despite the lack of a switching mechanism in the model (<xref ref-type="disp-formula" rid="FD2">Equations 2</xref> and <xref ref-type="disp-formula" rid="FD3">3</xref>). Furthermore, our model demonstrated a continuum of switching to non-switching behavior that was observed in experimental results (<xref ref-type="fig" rid="fig2">Figure 2d</xref>).</p>
<p>The experimental transition distribution was shifted slightly earlier, however it is important to note that the experimental data were drawn from experiments where 10-15 animals were tracked together. Collisions occurred, but were excluded from analysis. However, in addition to touch, animals also reorient in response to pheromones when they cross the tracks left by other animals, which is more likely early in the recording when the animals are in close proximity <sup><xref ref-type="bibr" rid="c21">21</xref>,<xref ref-type="bibr" rid="c22">22</xref></sup>. This in turn may contribute to a higher initial rate early in the experimental observations. Since this dataset does not have information about when and where worms crossed pheromone tracks from other animals, this effect cannot be excluded.</p>
<p>This exception aside, modeling worm foraging behavior with a simple exponential decay of reorientations was sufficient to capture most experimentally observed dynamics, both switch and non-switch-like. Sudden switches between fast and slow reorientation rates were observed in both the experimental and modeled data (<xref ref-type="fig" rid="fig2">Figure 2e</xref>), despite the model not relying on a switch strategy, and the decay in M being continuous.</p>
<p>Sometimes the experimental data produced switch-like behavior (<xref ref-type="fig" rid="fig2">Figure 2e</xref>, upper left panel), while other times the reorientation rate appeared to be constant (<xref ref-type="fig" rid="fig2">Figure 2e</xref>, lower right panel). The stochastic model produced reorientation data with similar dynamics, despite not relying on a decision paradigm.</p>
<p>It is important to emphasize that the model was not explicitly designed to match the sudden changes in reorientation rates observed in the experimental data. Kinetic parameters were simply chosen to match the <italic>average</italic> population behavior. Sudden changes in reorientation rate were not due to sudden changes in the underlying model; stochastic behavior naturally produces sudden bunching of random events. Even if the reorientation rate is set to a constant value, stochastic sampling will still produce sudden changes in rate, even though the rate has no time-dependence (<xref ref-type="fig" rid="fig2">Figure 2f</xref>).</p>
</sec>
<sec id="s2-3">
<title>Discrete changes in M are inconsistent with experimental data</title>
<p>A large initial value for <italic>M<sub>0</sub></italic> (<italic>M<sub>0</sub></italic> = 1000) was initially chosen to ensure a smooth change in reorientation rate, so that sudden changes in reorientation number were not necessarily due to sudden changes in <italic>M</italic>. To test how sensitive the model was to stochastic changes in <italic>M</italic>, the initial value of <italic>M</italic> was tested at <italic>M<sub>0</sub></italic> = 1000, 100, 10, or 1. On average, all values of <italic>M<sub>0</sub></italic> were sufficient to reproduce the average reorientation decay observed in experimental data (<xref ref-type="fig" rid="fig3">Figure 3a</xref>). The distributions of transition times and slope differences were also comparable for <italic>M<sub>0</sub></italic> = 1000, 100, or 10, indicating that the model is not particularly sensitive to initial values of <italic>M<sub>0</sub></italic>.</p>
<p>However, despite producing a similar average decay in reorientation rates, the distribution of slope differences was distinctly bimodal for <italic>M<sub>0</sub></italic> = 1 (<xref ref-type="fig" rid="fig3">Figure 3b</xref>). This was not surprising, since when <italic>M<sub>0</sub></italic> = 1, the model is by definition a two-state system. Either the worm has a reorientation rate of <italic>α</italic> (<italic>M</italic> = 1), or a reorientation rate of <italic>β</italic>, (<italic>M</italic> = 0). The probability of switching from <italic>M</italic> = 1 to <italic>M</italic> = 0 increases with a timescale of <italic>γ</italic> (<italic>γ</italic> = 0.11 min<sup>−1</sup>). The bimodal slope and transition time distributions for <italic>M<sub>0</sub></italic> = 1 were distinctly different than those observed for the experimental or <italic>M<sub>0</sub></italic> = 1000,100,10 models.</p>
<p>Since the slope and transition time distributions were generated from a recursive algorithm rather than a purely analytical model, the model distribution for these metrics was compared to the experimental distribution using the Jensen-Shannon divergence (JSD):
<disp-formula id="FD18">
<alternatives>
<mml:math id="M18" display="block"><mml:mi>J</mml:mi><mml:mi>S</mml:mi><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Q</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>M</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2309.15174v3_eqn18.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(18)</label>
</disp-formula>
</p>
<p>where <italic>D</italic> is the Kullback-Leibler divergence :
<disp-formula id="FD19">
<alternatives>
<mml:math id="M19" display="block"><mml:mi>D</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>P</mml:mi><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>Q</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:msub><mml:mo>∑</mml:mo><mml:mi>x</mml:mi></mml:msub><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mtext>ln</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>Q</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mstyle></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2309.15174v3_eqn19.tif" mime-subtype="tif" mimetype="image"/></alternatives>
<label>(19)</label>
</disp-formula>
</p>
<p>and <italic>P(x)</italic> and <italic>Q(x)</italic> are the two probability distributions being compared. <italic>M(x)</italic> is a mixture distribution of <italic>P</italic> and <italic>Q</italic>. This metric provides a useful, parameter-free measure for comparing distributions using mutual information. A short distance between two distributions indicates they are more similar than two distributions separated by a longer distance.</p>
<p>To compare how similar the different models (<italic>M<sub>0</sub></italic> = 1000, 100, 10, 1) compared to the experimental distribution of transition times and slope differences, we ran the model twenty times for each <italic>M<sub>0</sub></italic>, and calculated the JSD between the model and experimental distributions (<xref ref-type="fig" rid="fig3">Figure 3c</xref>). The non-binary models (<italic>M<sub>0</sub></italic> ≠ 1) all produced comparable distances, but the binary models (<italic>M<sub>0</sub></italic> = 1) were significantly more distant than the rest, indicating this model was more dissimilar than the others when compared to the experimental data. A continuous decline in reorientation rate is more consistent with experimental observations than a discrete change in reorientation rate.</p>
</sec>
</sec>
<sec id="s3" sec-type="discussion">
<title>Discussion</title>
<p>The lack of a decision simplifies the dispersal strategy for <italic>C. elegans</italic>. Rather than relying on the accumulation of evidence to make a discrete decision, the worm relies on a decaying signal in the absence of food that drives the reorientation rate. This strategy increases the diffusion constant of the worm, and ensures a more efficient search strategy to find food<sup><xref ref-type="bibr" rid="c4">4</xref></sup>. The stochastic nature of this search is consistent with prior characterizations of worm behavior and neuronal dynamics<sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c13">13</xref></sup>, and implies that any individual worm would exhibit all the variability of the population if allowed to perform this task multiple times. We consider this to be a null model: simple stochastic models should be sufficient to explain observably stochastic behaviors.</p>
<p>The decay in M can be considered the memory timescale of the last food encounter. With an observed <italic>γ</italic> of 0.07 min<sup>−1</sup>, this would mean a memory τ<sub>1/2</sub> of ~10 minutes. In principle M should rise on the presence of food to increase the reorientation rate, on a timescale that is not addressed here. The reliance of the reorientation rate on a decaying factor (M) implies that the rate is influenced by a signaling factor which decays in time. It is well established that the reorientation rate is influenced by numerous signaling factors, and is the basis of the biased random walk that drives taxis in shallow gradients<sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c13">13</xref></sup>.</p>
<p>A decay in reorientation rate, rather than a sudden change, is consistent with observations made by López-Cruz <italic>et al</italic><sup><xref ref-type="bibr" rid="c5">5</xref></sup>. They found that the neurons AIA and ADE redundantly suppress reorientations, and that silencing either one was sufficient to restore the large number of reorientations during early foraging. AIA and ADE synapse onto several neurons that drive reorientations<sup><xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c23">23</xref></sup>, and their output was inhibited over long timescales (tens of minutes) by presynaptic glutamate binding to MGL-1, a slow G-Protein coupled receptor expressed in AIA and ADE. Their results support a model where sensory neurons suppress the synaptic output of AIA and ADE, which in turn leads to a large number of reorientations early in foraging. As time passes, glutamatergic input from the sensory neurons decrease, which leads to disinhibition of AIA and ADE, and a subsequent suppression of reorientations.</p>
<p>The sensory inputs into AIA and ADE are sequestered into two separate circuits, with AIA receiving chemosensory input and ADE receiving mechanosensory input. Since the suppression of either AIA or ADE is sufficient to increase reorientations, the decay in reorientations is likely due to the synaptic output of both of these neurons decaying in time. This correlates with an observed decrease in sensory neuron activity as well, so the timescale of reorientation decay could be tied to the timescale of sensory neuron activity, which in turn is influencing the timescale of AIA/ADE reorientation suppression. This implies that our factor “M” is likely the sum of several different sensory inputs decaying in time.</p>
<p>The molecular basis of which sensory neuron signaling factors contribute to decreased AIA and ADE activity is made more complicated by the observation that the glutamatergic input provided by the sensory neurons was not essential, and that additional factors besides glutamate contribute to the signaling to AIA and ADE. In addition to this, it is simply not the sensory neuron activity that decays in time, but also the sensitivity of AIA and ADE to sensory neuron input that decays in time. Simply depolarizing sensory neurons after the animals had starved for 30 minutes was insufficient to rescue the reorientation rates observed earlier in the foraging assay. This observation could be due to decreased presynaptic vesicle release, and/or decreased receptor localization on the postsynaptic side.</p>
<p>In summary, there are two neuronal properties that appear to be decaying in time. One is sensory neuron activity, and the other is decreased potentiation of presynaptic input onto AIA and ADE. Our factor “M” is a phenomenological manifestation of these numerous decaying factors. Altered ionotropic glutamate signaling and dopamine release also influence foraging kinetics<sup><xref ref-type="bibr" rid="c24">24</xref></sup>, as well as neuropeptides<sup><xref ref-type="bibr" rid="c25">25</xref></sup>. The signaling factor M could be the result of one or all of these factors decaying in time. Further work will be needed to reveal how the kinetics of reorientations emerges explicitly from these underlying signaling kinetics.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1</label>
<caption><title>Foraging kinetics of <italic>C. elegans</italic></title>
<p><italic>(<bold>a</bold>)</italic> Average experimental population reorientation rate (black line) in a rolling 2-minute window. Blue bins represent probability of observed reorientation rate. <italic>(<bold>b</bold>)</italic> Abrupt transitions were identified by performing two linear regressions on observed reorientation curves. Transition times (t<sub>rans</sub>) were defined by the intersection of the regressions (dashed line). The slopes of the two regressions are s<sub>1</sub> and s<sub>2</sub>. <italic>(<bold>c</bold>)</italic> An example of an experimental reorientation curve with an abrupt reorientation transition (marked by vertical line). <italic>(<bold>d</bold>)</italic> An example of an experimental reorientation curve that lacked an abrupt reorientation transition. <italic>(<bold>e</bold>)</italic> Distribution of slope differences and transition times from regressions fit to the experimental data. Insets are individual examples of experimental cumulative reorientation curves. Number of worms (N) = 1631. Dashed line represents the median slope difference. All data curated from López-Cruz <italic>et al</italic><sup><xref ref-type="bibr" rid="c5">5</xref></sup>.</p></caption>
<graphic xlink:href="2309.15174v3_fig1.tif" mime-subtype="tif" mimetype="image"/>
</fig>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2</label>
<caption><title>Stochastic modeling of foraging kinetics of <italic>C. elegans</italic></title>
<p><italic>(<bold>a</bold>)</italic> Outline of the Gillespie algorithm. Step 1: two random numbers (<italic>r<sub>1</sub></italic> and <italic>r<sub>2</sub></italic>) are drawn from a uniform distribution [0,1]. Step 2: The time interval for a new event (<italic>τ</italic>) is randomly assigned based on the total propensities (<italic>a<sub>0</sub></italic>) and <italic>r<sub>1</sub></italic>. Step 3: The event <italic>i</italic> (either a decay of M (M←M-1) or a new reorientation (Ω—Ω+1)) at t + <italic>τ</italic> is determined by the probability (<italic>P(i)</italic>) of the event <italic>i</italic> occurring. This probability is determined by the relative propensity (<italic>a<sub>i</sub>/a<sub>0</sub></italic>) of the event <italic>i</italic>. <italic>(<bold>b</bold>)</italic> (Top) The parameters <italic>α, β</italic>, and <italic>γ</italic> are assigned based on fitting a decay curve (red) to the observed average reorientation rate (blue). Dashed lines are + and − standard deviation. (Bottom) Average model population reorientation rate (black line) in a rolling 2-minute window. Red bins represent probability of observed reorientation rate. N = 1631, <italic>α</italic> = 1.49 min<sup>−1</sup>, <italic>β</italic> = 0.1937 min<sup>−1</sup>, <italic>γ</italic> = 0.11 min<sup>−1</sup>. <italic>(<bold>c</bold>)</italic> (Top) An example of a modeled abrupt reorientation transition. (Bottom) An example of a modeled reorientation curve that lacked an abrupt reorientation transition. Red data are cumulative reorientations and orange data are <italic>M</italic>. <italic>(<bold>d</bold>)</italic> Distribution of slope differences and transition times from regressions fit to the experimental (blue) and modeled (red) data. Insets are individual examples of experimental and modeled cumulative reorientation curves. Dashed line represents the median experimental slope difference. <italic>(<bold>e</bold>)</italic> Examples of experimental (blue) and modeled (red) cumulative reorientation curves for individual worms, with similar stochastic dynamics. For each example drawn from experiments (blue), the <italic>in silico</italic> worm with the highest correlation from N=1631 iterations is shown (red). Sudden changes in rate are indicated with arrows. <italic>M</italic> for each example is shown in orange. <italic>(<bold>f</bold>)</italic> Examples of modeled data when the reorientation rate is constant (<italic>α</italic> = 1.5). Sudden changes in rate are indicated with arrows.</p></caption>
<graphic xlink:href="2309.15174v3_fig2.tif" mime-subtype="tif" mimetype="image"/>
</fig>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3</label>
<caption><title>Scaling of foraging kinetics of <italic>C. elegans</italic></title>
<p><italic>(<bold>a</bold>)</italic> Average reorientation rates for experiments (blue), and models where <italic>M<sub>0</sub></italic> = 1000 (red), <italic>M<sub>0</sub></italic> = 100 (plum), <italic>M<sub>0</sub></italic> = 10 (magenta), or <italic>M<sub>0</sub></italic> = 1 (cyan). Dashed lines indicate standard deviation. <italic>(<bold>b</bold>)</italic> Distribution of slope differences and transition times from regressions fit to the experimental data (blue), and models where <italic>M<sub>0</sub></italic> = 1000 (red), <italic>M<sub>0</sub></italic> = 100 (plum), <italic>M<sub>0</sub></italic> = 10 (magenta), or <italic>M<sub>0</sub></italic> = 1 (cyan). Number of worms for both experiment and models (N) = 1631. Dashed line represents the median slope difference for the experimental data. <italic>(<bold>c</bold>)</italic> The Jensen-Shannon divergence between the experimental distribution for slope difference and transition time in <italic>(<bold>b</bold>)</italic>, and the distributions generated from models where <italic>M<sub>0</sub></italic> = 1000 (red), <italic>M<sub>0</sub></italic> = 100 (plum), <italic>M<sub>0</sub></italic> = 10 (magenta), or <italic>M<sub>0</sub></italic> = 1 (cyan). Twenty distributions were generated for each M0 model. P-values calculated using Tukey’s range test: &lt;0.001: ***.</p></caption>
<graphic xlink:href="2309.15174v3_fig3.tif" mime-subtype="tif" mimetype="image"/>
</fig>
</sec>
</body>
<back>
<sec id="s4" sec-type="data-availability">
<title>Data availability</title>
<p>Experimental data were curated from López-Cruz <italic>et al</italic>5.</p>
</sec>
<ack>
<title>Acknowledgments</title>
<p>We thank A. López-Cruz and C. Bargmann, for sharing their experimental data, and also thank them, A. Samuel and members of the Gordus lab for helpful discussions and comments on the manuscript. A.G. acknowledges funding from NIH (R35GM124883).</p>
</ack>
<sec id="d1e1932" sec-type="additional-information">
<title>Additional information</title>
<sec id="s5" sec-type="code-availability">
<title>Source Code availability</title>
<p>Analysis was performed using custom written code in MATLAB which can be found in this repository: <ext-link ext-link-type="uri" xlink:href="https://github.com/GordusLab/Margolis_foraging">https://github.com/GordusLab/Margolis_foraging</ext-link></p>
</sec>
<sec id="s6">
<title>Author Contributions</title>
<p>A.M. and A.G. conceived the research plan, analyzed the data, and wrote the paper.</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reiss</surname>, <given-names>A.P.</given-names></string-name>, and <string-name><surname>Rankin</surname>, <given-names>C.H.</given-names></string-name></person-group> (<year>2021</year>). <article-title>Gaining an understanding of behavioral genetics through studies of foraging in Drosophila and learning in C. elegans</article-title>. <source>J Neurogenet</source> <volume>35</volume>, <fpage>119</fpage>–<lpage>131</lpage>. <pub-id pub-id-type="doi">10.1080/01677063.2021.1928113</pub-id>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dorfman</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hills</surname>, <given-names>T.T.</given-names></string-name>, and <string-name><surname>Scharf</surname>, <given-names>I.</given-names></string-name></person-group> (<year>2022</year>). <article-title>A guide to area-restricted search: a foundational foraging behaviour</article-title>. <source>Biological Reviews</source> <volume>97</volume>, <fpage>2076</fpage>–<lpage>2089</lpage>. <pub-id pub-id-type="doi">10.1111/brv.12883</pub-id>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Codling</surname>, <given-names>E.A.</given-names></string-name>, <string-name><surname>Plank</surname>, <given-names>M.J.</given-names></string-name>, and <string-name><surname>Benhamou</surname>, <given-names>S.</given-names></string-name></person-group> (<year>2008</year>). <article-title>Random walk models in biology</article-title>. <source>Journal of The Royal Society Interface</source> <volume>5</volume>, <fpage>813</fpage>–<lpage>834</lpage>. <pub-id pub-id-type="doi">10.1098/rsif.2008.0014</pub-id>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klein</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Krivov</surname>, <given-names>S.V.</given-names></string-name>, <string-name><surname>Ferrer</surname>, <given-names>A.J.</given-names></string-name>, <string-name><surname>Luo</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Samuel</surname>, <given-names>A.D.</given-names></string-name>, and <string-name><surname>Karplus</surname>, <given-names>M.</given-names></string-name></person-group> (<year>2017</year>). <article-title>Exploratory search during directed navigation in C. elegans and Drosophila larva</article-title>. <source>eLife</source> <volume>6</volume>, <elocation-id>e30503</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.30503</pub-id>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>López-Cruz</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Sordillo</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Pokala</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>Q.</given-names></string-name>, <string-name><surname>McGrath</surname>, <given-names>P.T.</given-names></string-name>, and <string-name><surname>Bargmann</surname>, <given-names>C.I.</given-names></string-name></person-group> (<year>2019</year>). <article-title>Parallel Multimodal Circuits Control an Innate Foraging Behavior</article-title>. <source>Neuron</source> <volume>102</volume>, <fpage>407</fpage>–<lpage>419</lpage>.<elocation-id>e8</elocation-id>. <pub-id pub-id-type="doi">10.1016/j.neuron.2019.01.053</pub-id>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Calhoun</surname>, <given-names>A.J.</given-names></string-name>, <string-name><surname>Chalasani</surname>, <given-names>S.H.</given-names></string-name>, and <string-name><surname>Sharpee</surname>, <given-names>T.O.</given-names></string-name></person-group> (<year>2014</year>). <article-title>Maximally informative foraging by Caenorhabditis elegans</article-title>. <source>eLife</source> <volume>3</volume>, <elocation-id>e04220</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.04220</pub-id>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pierce-Shimomura</surname>, <given-names>J.T.</given-names></string-name>, <string-name><surname>Morse</surname>, <given-names>T.M.</given-names></string-name>, and <string-name><surname>Lockery</surname>, <given-names>S.R.</given-names></string-name></person-group> (<year>1999</year>). <article-title>The fundamental role of pirouettes in Caenorhabditis elegans chemotaxis</article-title>. <source>J Neurosci</source> <volume>19</volume>, <fpage>9557</fpage>–<lpage>9569</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.19-21-09557.1999</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhao</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Khare</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Feldman</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Dent</surname>, <given-names>J.A.</given-names></string-name></person-group> (<year>2003</year>). <article-title>Reversal frequency in Caenorhabditis elegans represents an integrated response to the state of the animal and its environment</article-title>. <source>J Neurosci</source> <volume>23</volume>, <fpage>5319</fpage>–<lpage>5328</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.23-12-05319.2003</pub-id>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stephens</surname>, <given-names>G.J.</given-names></string-name>, <string-name><surname>Bueno de Mesquita</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Ryu</surname>, <given-names>W.S.</given-names></string-name>, and <string-name><surname>Bialek</surname>, <given-names>W.</given-names></string-name></person-group> (<year>2011</year>). <article-title>Emergence of long timescales and stereotyped behaviors in Caenorhabditis elegans</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>, <fpage>7286</fpage>–<lpage>7289</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1007868108</pub-id>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Flavell</surname>, <given-names>S.W.</given-names></string-name>, <string-name><surname>Pokala</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Macosko</surname>, <given-names>E.Z.</given-names></string-name>, <string-name><surname>Albrecht</surname>, <given-names>D.R.</given-names></string-name>, <string-name><surname>Larsch</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Bargmann</surname>, <given-names>C.I.</given-names></string-name></person-group> (<year>2013</year>). <article-title>Serotonin and the neuropeptide PDF initiate and extend opposing behavioral states in C. elegans</article-title>. <source>Cell</source> <volume>154</volume>, <fpage>1023</fpage>–<lpage>1035</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2013.08.001</pub-id>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gordus</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Pokala</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Levy</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Flavell</surname>, <given-names>S.W.</given-names></string-name>, and <string-name><surname>Bargmann</surname>, <given-names>C.I.</given-names></string-name></person-group> (<year>2015</year>). <article-title>Feedback from network states generates variability in a probabilistic olfactory circuit</article-title>. <source>Cell</source> <volume>161</volume>, <fpage>215</fpage>–<lpage>227</lpage>. <pub-id pub-id-type="doi">10.1016/j.cell.2015.02.018</pub-id>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roberts</surname>, <given-names>W.M.</given-names></string-name>, <string-name><surname>Augustine</surname>, <given-names>S.B.</given-names></string-name>, <string-name><surname>Lawton</surname>, <given-names>K.J.</given-names></string-name>, <string-name><surname>Lindsay</surname>, <given-names>T.H.</given-names></string-name>, <string-name><surname>Thiele</surname>, <given-names>T.R.</given-names></string-name>, <string-name><surname>Izquierdo</surname>, <given-names>E.J.</given-names></string-name>, <string-name><surname>Faumont</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Lindsay</surname>, <given-names>R.A.</given-names></string-name>, <string-name><surname>Britton</surname>, <given-names>M.C.</given-names></string-name>, <string-name><surname>Pokala</surname>, <given-names>N.</given-names></string-name>, <etal>et al.</etal></person-group> (<year>2016</year>). <article-title>A stochastic neuronal model predicts random search behaviors at multiple spatial scales in C. elegans</article-title>. <source>eLife</source> <volume>5</volume>, <elocation-id>e12572</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.12572</pub-id>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Yuichi</given-names> <surname>Iino</surname></string-name> and <string-name><given-names>Kazushi</given-names> <surname>Yoshida</surname></string-name></person-group> (<year>2009</year>). <article-title>Parallel Use of Two Behavioral Mechanisms for Chemotaxis in &lt;em&gt;Caenorhabditis elegans&lt;/em&gt;</article-title>. <source>J. Neurosci</source>. <volume>29</volume>, <fpage>5370</fpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.3633-08.2009</pub-id>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singh</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Punia</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Chaudhury</surname>, <given-names>S.</given-names></string-name></person-group> (<year>2022</year>). <article-title>Theoretical Tools to Quantify Stochastic Fluctuations in Single-Molecule Catalysis by Enzymes and Nanoparticles</article-title>. <source>ACS Omega</source> <volume>7</volume>, <fpage>47587</fpage>–<lpage>47600</lpage>. <pub-id pub-id-type="doi">10.1021/acsomega.2c06316</pub-id>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Srivastava</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Clark</surname>, <given-names>D.A.</given-names></string-name>, and <string-name><surname>Samuel</surname>, <given-names>A.D.T.</given-names></string-name></person-group> (<year>2009</year>). <article-title>Temporal Analysis of Stochastic Turning Behavior of Swimming C. elegans</article-title>. <source>Journal of Neurophysiology</source> <volume>102</volume>, <fpage>1172</fpage>–<lpage>1179</lpage>. <pub-id pub-id-type="doi">10.1152/jn.90952.2008</pub-id>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Killick</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Fearnhead</surname>, <given-names>P.</given-names></string-name>, and <string-name><surname>Eckley</surname>, <given-names>I.A.</given-names></string-name></person-group> (<year>2012</year>). <article-title>Optimal Detection of Changepoints With a Linear Computational Cost</article-title>. <source>Journal of the American Statistical Association</source> <volume>107</volume>, <fpage>1590</fpage>–<lpage>1598</lpage>. <pub-id pub-id-type="doi">10.1080/01621459.2012.737745</pub-id>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gillespie</surname>, <given-names>D.T.</given-names></string-name></person-group> (<year>1977</year>). <article-title>Exact stochastic simulation of coupled chemical reactions</article-title>. <source>J. Phys. Chem.</source> <volume>81</volume>, <fpage>2340</fpage>–<lpage>2361</lpage>. <pub-id pub-id-type="doi">10.1021/j100540a008</pub-id>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Palombi</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Ferriani</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Toti</surname>, <given-names>S.</given-names></string-name></person-group> (<year>2020</year>). <article-title>Coevolutionary dynamics of a variant of the cyclic Lotka-Volterra model with three-agent interactions</article-title>. <source>The European Physical Journal B</source> <volume>93</volume>, <fpage>194</fpage>. <pub-id pub-id-type="doi">10.1140/epjb/e2020-100552-5</pub-id>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reichenbach</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Mobilia</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Frey</surname>, <given-names>E.</given-names></string-name></person-group> (<year>2006</year>). <article-title>Coexistence versus extinction in the stochastic cyclic Lotka-Volterra model</article-title>. <source>Phys. Rev. E</source> <volume>74</volume>, <fpage>051907</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevE.74.051907</pub-id>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Constable</surname>, <given-names>G.W.A.</given-names></string-name>, and <string-name><surname>McKane</surname>, <given-names>A.J.</given-names></string-name></person-group> (<year>2015</year>). <article-title>Models of Genetic Drift as Limiting Forms of the Lotka-Volterra Competition Model</article-title>. <source>Phys. Rev. Lett.</source> <volume>114</volume>, <fpage>038101</fpage>. <pub-id pub-id-type="doi">10.1103/PhysRevLett.114.038101</pub-id>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hong</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Ryu</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Ow</surname>, <given-names>M.C.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Je</surname>, <given-names>A.R.</given-names></string-name>, <string-name><surname>Chinta</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Huh</surname>, <given-names>Y.H.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>K.J.</given-names></string-name>, <string-name><surname>Butcher</surname>, <given-names>R.A.</given-names></string-name>, <string-name><surname>Choi</surname>, <given-names>H.</given-names></string-name>, <etal>et al.</etal></person-group> (<year>2017</year>). <article-title>Early Pheromone Experience Modifies a Synaptic Activity to Influence Adult Pheromone Responses of C. elegans</article-title>. <source>Current Biology</source> <volume>27</volume>, <fpage>3168</fpage>–<lpage>3177</lpage>.<elocation-id>e3</elocation-id>. <pub-id pub-id-type="doi">10.1016/j.cub.2017.08.068</pub-id>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dal Bello</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Perez-Escudero</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Schroeder</surname>, <given-names>F.C.</given-names></string-name>, and <string-name><surname>Gore</surname>, <given-names>J.</given-names></string-name></person-group> (<year>2021</year>). <article-title>Inversion of pheromone preference optimizes foraging in C. elegans</article-title>. <source>eLife</source> <volume>10</volume>, <elocation-id>e58144</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.58144</pub-id>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gray</surname>, <given-names>J.M.</given-names></string-name>, <string-name><surname>Hill</surname>, <given-names>J.J.</given-names></string-name>, and <string-name><surname>Bargmann</surname>, <given-names>C.I.</given-names></string-name></person-group> (<year>2005</year>). <article-title>A circuit for navigation in <italic>Caenorhabditis elegans</italic></article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>102</volume>, <fpage>3184</fpage>–<lpage>3191</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.0409009101</pub-id>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hills</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Brockie</surname>, <given-names>P.J.</given-names></string-name>, and <string-name><surname>Maricq</surname>, <given-names>A.V.</given-names></string-name></person-group> (<year>2004</year>). <article-title>Dopamine and Glutamate Control Area-Restricted Search Behavior in Caenorhabditis elegans</article-title>. <source>Journal of Neuroscience</source> <volume>24</volume>, <fpage>1217</fpage>–<lpage>1225</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.1569-03.2004</pub-id>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Campbell</surname>, <given-names>J.C.</given-names></string-name>, <string-name><surname>Polan-Couillard</surname>, <given-names>L.F.</given-names></string-name>, <string-name><surname>Chin-Sang</surname>, <given-names>I.D.</given-names></string-name>, and <string-name><surname>Bendena</surname>, <given-names>W.G.</given-names></string-name></person-group> (<year>2016</year>). <article-title>NPR-9, a Galanin-Like G-Protein Coupled Receptor, and GLR-1 Regulate Interneuronal Circuitry Underlying Multisensory Integration of Environmental Cues in Caenorhabditis elegans</article-title>. <source>PLOS Genetics</source> <volume>12</volume>, <elocation-id>e1006050</elocation-id>. <pub-id pub-id-type="doi">10.1371/journal.pgen.1006050</pub-id>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104972.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Portman</surname>
<given-names>Douglas</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Rochester</institution>
</institution-wrap>
<city>Rochester</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>valuable</bold> paper uses a quantitative modeling approach to explore a well-studied transition in motor behavior in the nematode C. elegans. The authors provide <bold>solid</bold> evidence that this transition, which has been considered by many in the field to be a two-state behavior, can instead be described as a process whose parameters are smoothly modulated within a single state. This finding provides insight into the relationships between latent internal states and observable behavioral states, and suggests that relatively simple neuronal mechanisms can drive behavioral sequences that appear more complex.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104972.2.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary of what the authors were trying to achieve</p>
<p>This paper concerns mechanisms of foraging behavior in C. elegans. Upon removal from food, C. elegans first executes a stereotypical local search behavior in which it explores a small area by executing many random, undirected reversals and turns called &quot;reorientations.&quot; If the worm fails to ﬁnd food, it transitions to a global search in which it explores larger areas by suppressing reorientations and executing long forward runs (Hills et al., 2004). At the population level, reorientation rate declines gradually. Nevertheless, about 50% of individual worms appear to exhibit an abrupt transition between local and global search, which is evident as a discrete transition from high to low reorientation rate (Lopez-Cruz et al., 2019). This observation has given rise to the hypothesis that local and global search correspond to separate internal states with the possibility of sudden transitions between them (Calhoun et al., 2014). The objective of the paper is to demonstrate that is not necessary to posit distinct internal states to account for discrete transitions from high to low reorientation rate. On the contrary, discrete transitions can occur simply because of the stochastic nature of the reorientation behavior itself.</p>
<p>Major strengths and weaknesses of the methods and results</p>
<list list-type="bullet">
<list-item><p>The model was not explicitly designed to match the sudden, stable changes in reorientation rates observed in the experimental data from individual worms. Kinetic parameters were simply chosen to match the average population behavior. Nevertheless, many sudden stable changes in reorientation rates occurred. This is a strong argument that apparent state changes can arise as an epiphenomenon of stochastic processes.</p>
</list-item>
<list-item><p>The new stochastic model is more parsimonious than reorientation-state change model because it posits one state rather than two.</p>
</list-item>
<list-item><p>A prominent feature of the empirical data is that 50% of the worms exhibit a single (apparent) state change and the rest show either no state changes or multiple state changes. Does the model reproduce these proportions? This obvious question was not addressed.</p>
</list-item>
<list-item><p>There is no obvious candidate for the neuronal basis of the decaying factor M. The authors speculate that decreasing sensory neuron activity might be the correlate of M but then provide contradictory evidence that seems to undermine that hypothesis. The absence of a plausible neuronal correlate of M weakens the case for the model.</p>
</list-item>
</list>
<p>Appraisal of whether the authors achieved their aims, and whether the results support their conclusions</p>
<p>The authors have made a solid case that is not necessary to posit distinct internal states to account for discrete transitions from high to low reorientation rate. On the contrary, discrete transitions can occur simply because of the stochastic nature of the reorientation behavior itself.</p>
<p>Impact of the work on the field, and the utility of the methods and data to the community</p>
<p>Posting hidden internal states to explain behavioral sequences is gaining acceptance in behavioral neuroscience. The likely impact of the paper is to establish a compelling example of how statistical reasoning can reduce the number of hidden states to achieve more parsimonious models.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104972.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this study, the authors build a statistical model that stochastically samples from a time-interval distribution of reorientation rates. The form of the distribution is extracted from a large array of behavioral data, is then used to describe not only the dynamics of individual worms (including the inter-individual variability in behavior), but also the aggregate population behavior. The authors note that the model does not require an assumption about behavioral state transitions, or evidence accumulation, as has been done previously, but rather that the stochastic nature of behavior is &quot;simply the product of stochastic sampling from an exponential function&quot;.</p>
<p>Strengths:</p>
<p>This model provides a strong juxtaposition to other foraging models in the worm. Rather than evoking a behavioral transition function (that might arise from a change in internal state or the activity of a cell type in the network), or evidence accumulation (which again maps onto a cell type, or the activity of a network) - this model explains behavior via the stochastic sampling of a function of an exponential decay. The underlying model and the dynamics being simulated, as well as the process of stochastic sampling are well described and the model fits the exponential function (equation 1) to data on a large array of worms exhibiting diverse behaviors (1600+ worms from Lopez-Cruz et al). The work of this study is able to explain or describe the inter-individual diversity of worm behavior across a large population. The model is also able to capture two aspects of the reorientations, including the dynamics (to switch or not to switch) and the kinetics (slow vs fast reorientations). The authors also work to compare their model to a few others including the Levy walk (whose construction arises from a Markov process) to a simple exponential distribution, all of which have been used to study foraging and search behaviors.</p>
<p>Weaknesses:</p>
<p>This manuscript has two weaknesses that dampen the enthusiasm for the results. First, in all of the examples the authors cite where a Gillespie algorithm is used to sample from a distribution, be it the kinetics associated with chemical dynamics, or a Lotka-Volterra Competition Model, there are underlying processes that govern the evolution of the dynamics, and thus the sampling from distributions. In one of their references for instance, the stochasticity arises from the birth and death rates, thereby influencing the genetic drift in the model. In these examples, the process governing the dynamics (and thus generating the distributions from which one samples) are distinct from the behavior being studied. In this manuscript, the distribution being sampled from is the exponential decay function of the reorientation rate (lines 100-102). This appears to be tautological - a decay function fitted to the reorientation data is then sampled to generate the distributions of the reorientation data. That the model performs well, and matches the data is commendable, but it is unclear how that could not be the case if the underlying function generating the distribution was fit to the data.</p>
<p>The second weakness is somewhat related to the first, in that absent an underlying mechanism or framework, one is left wondering what insight the model provides. Stochastic sampling a function generated by fitting the data to produce stochastic behavior is where one ends up in this framework, and the authors indeed point this out: &quot;simple stochastic models should be sufficient to explain observably stochastic behaviors.&quot; (Line 233-234). But if that is the case, what do we learn about how the foraging is happening. The authors suggest that the decay parameter M can be considered a memory timescale; which offers some suggestion, but then go on to say that the &quot;physical basis of M can come from multiple sources&quot;. Here is where one is left for want: The mechanisms suggested, including loss of sensory stimuli, alternations in motor integration, ionotropic glutamate signaling, dopamine, and neuropeptides are all suggested: this is basically all of the possible biological sources that can govern behavior, and one is left not knowing what insight the model provides. The array of biological processes listed are so variable in dynamics and meaning, that their explanation of what govern M is at best unsatisfying. Molecular dynamics models that generate distributions can point to certain properties of the model, such as the binding kinetics (on and off rates, etc.) as explanations for the mechanisms generating the distributions, and therefore point to how a change in the biology affects the stochasticity of the process. It is unclear how this model provides such a connection, especially taken in aggregate with the previous weakness.</p>
<p>Providing a roadmap of how to think about the processes generating M, the meaning of those processes in search, and potential frameworks that are more constrained and with more precise biological underpinning (beyond the array of possibilities described) would go a long way to assuaging the weaknesses.</p>
<p>Comments on revised version:</p>
<p>The authors have addressed the main concerns of the manuscript.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104972.2.sa0</article-id>
<title-group>
<article-title>None</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Margolis</surname>
<given-names>Andrew</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gordus</surname>
<given-names>Andrew</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #1 (Public review):</bold></p>
<p>Summary:</p>
<p>This paper concerns mechanisms of foraging behavior in C. elegans. Upon removal from food, C. elegans first executes a stereotypical local search behavior in which it explores a small area by executing many random, undirected reversals and turns called &quot;reorientations.&quot; If the worm fails to find food, it transitions to a global search in which it explores larger areas by suppressing reorientations and executing long forward runs (Hills et al., 2004). At the population level, the reorientation rate declines gradually. Nevertheless, about 50% of individual worms appear to exhibit an abrupt transition between local and global search, which is evident as a discrete transition from high to low reorientation rate (Lopez-Cruz et al., 2019). This observation has given rise to the hypothesis that local and global search correspond to separate internal states with the possibility of sudden transitions between them (Calhoun et al., 2014). The main conclusion of the paper is that it is not necessary to posit distinct internal states to account for discrete transitions from high to low reorientation rates. On the contrary, discrete transitions can occur simply because of the stochastic nature of the reorientation behavior itself.</p>
<p>Strengths:</p>
<p>The strength of the paper is the demonstration that a more parsimonious model explains abrupt transitions in the reorientation rate.</p>
<p>Weaknesses:</p>
<p>(1) Use of the Gillespie algorithm is not well justified. A conventional model with a fixed dt and an exponentially decaying reorientation rate would be adequate and far easier to explain. It would also be sufficiently accurate - given the appropriate choice of dt - to support the main claims of the paper, which are merely qualitative. In some respects, the whole point of the paper - that discrete transitions are an epiphenomenon of stochastic behavior - can be made with the authors' version of the model having a constant reorientation rate (Figure 2f).</p>
</disp-quote>
<p>We apologize, but we are not sure what the reviewer means by “fixed dt”. If the reviewer means taking discrete steps in time (dt), and modeling whether a reorientation occurs, we would argue that the Gillespie algorithm is a better way to do this because it provides floating-point precision, rather than a time resolution limited by dt, which we hopefully explain in the updated text (Lines 107-192).</p>
<p>The reviewer is correct that discrete transitions are an epiphenomenon of stochastic behavior as we show in Figure 2f. However, abrupt stochastic jumps that occur with a constant rate do not produce persistent changes in the observed rate because it is by definition, constant. The theory that there are local and global searches is based on the observation that individual worms often abruptly change their reorientation rates. But this observation is only true for a fraction of worms. We are trying to argue that the reason why this is not observed for all, or even most worms is because these are the result of stochastic sampling, not a sudden change in search strategy.</p>
<disp-quote content-type="editor-comment">
<p>(2) In the manuscript, the Gillespie algorithm is very poorly explained, even for readers who already understand the algorithm; for those who do not it will be essentially impossible to comprehend. To take just a few examples: in Equation (1), omega is defined as reorientations instead of cumulative reorientations; it is unclear how (4) follows from (2) and (3); notation in (5), line 133, and (7) is idiosyncratic. Figure 1a does not help, partly because the notation is unexplained. For example, what do the arrows mean, what does &quot;*&quot; mean?</p>
</disp-quote>
<p>We apologize for this, you are correct, 𝛀 is cumulative reorientations, and we have edited the text for clarity (Lines 107-192):</p>
<p>We apologize for the arrow notation confusion. Arrow notation is commonly used in pseudocode to indicate variable assignment, and so we used it to indicate variable assignment updates in the algorithm.</p>
<p>We added Figure 2a to help explain the Gillespie algorithm for people who are unfamiliar with it, but you are correct, some notation, like probabilities, were left unexplained. We have added more text to the figure legend. Hopefully this additional text, along with lines 105-190, provide better clarification.</p>
<disp-quote content-type="editor-comment">
<p>(3) In the model, the reorientation rate dΩ⁄dt declines to zero but the empirical rate clearly does not. This is a major flaw. It would have been easy to fix by adding a constant to the exponentially declining rate in (1). Perhaps fixing this obvious problem would mitigate the discrepancies between the data and the model in Figure 2d.</p>
</disp-quote>
<p>You are correct that the model deviates slightly at longer times, but this result is consistent with Klein et al. that show a continuous decline of reorientations. However, we have added a constant to the model (b, Equation 2), since an infinite run length is likely not physiological.</p>
<disp-quote content-type="editor-comment">
<p>(4) Evidence that the model fits the data (Figure 2d) is unconvincing. I would like to have seen the proportion of runs in which the model generated one as opposed to multiple or no transitions in reorientation rate; in the real data, the proportion is 50% (Lopez). It is claimed that the &quot;model demonstrated a continuum of switching to non-switching behavior&quot; as seen in the experimental data but no evidence is provided.</p>
</disp-quote>
<p>We should clarify that the 50% proportion cited by López-Cruz was based on an arbitrary difference in slopes, and by assessing the data visually (López-Cruz, Figure S2). We added a comment in the text to clarify this (Lines 76 – 78). We sought to avoid this subjective assessment by plotting the distribution of slopes and transition times produced by the method used in López-Cruz. We should also clarify by what we meant by “a continuum of switching and non-switching” behavior. Both the transition time distributions and the slope-difference distributions do not appear to be the result of two distributions (the distributions in Figure 1 are not bimodal). This is unlike roaming and dwelling on food, where two distinct distributions of behavioral metrics can be identified based on speed and angular speed (Flavell et al, 2009, Fig S2a).</p>
<p>Based on the advice of Reviewer #3, we have also modeled the data using different starting amounts of <italic>M</italic> (<italic>M<sub>0</sub></italic>). By definition, an initial value of <italic>M<sub>0</sub></italic> = 1 is a two-state switching strategy; the worm either uses a reorientation rate of a (when <italic>M</italic> = 1) or b (when <italic>M</italic> = 0). As expected, this does produce a bimodal distribution of slope differences (Figure 3b), which is significantly different than the experimental distribution (Figure 3c). We have added a new section to explain this in more detail (Lines 253 – 297).</p>
<disp-quote content-type="editor-comment">
<p>(5) The explanation for the poor fit between the model and data (lines 166-174) is unclear. Why would externally triggered collisions cause a shift in the transition distribution?</p>
</disp-quote>
<p>Thank you, we rewrote the text to clarify this better (Lines 227-233). There were no externally triggered collisions; 10 animals were used per experiment. They would occasionally collide during the experiment, but these collisions were excluded from the data that were provided. However, worms are also known to increase reorientations when they encounter a pheromone trail, and it is unknown (from this dataset) which orientations may have been a result of this phenomenon.</p>
<disp-quote content-type="editor-comment">
<p>(6) The discussion of Levy walks and the accompanying figure are off-topic and should be deleted.</p>
</disp-quote>
<p>Thank you, we agree that this topic is tangential, and we removed it.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public review):</bold></p>
<p>Summary:</p>
<p>In this study, the authors build a statistical model that stochastically samples from a timeinterval distribution of reorientation rates. The form of the distribution is extracted from a large array of behavioral data, and is then used to describe not only the dynamics of individual worms (including the inter-individual variability in behavior), but also the aggregate population behavior. The authors note that the model does not require assumptions about behavioral state transitions, or evidence accumulation, as has been done previously, but rather that the stochastic nature of behavior is &quot;simply the product of stochastic sampling from an exponential function&quot;.</p>
<p>Strengths:</p>
<p>This model provides a strong juxtaposition to other foraging models in the worm. Rather than evoking a behavioral transition function (that might arise from a change in internal state or the activity of a cell type in the network), or evidence accumulation (which again maps onto a cell type, or the activity of a network) - this model explains behavior via the stochastic sampling of a function of an exponential decay. The underlying model and the dynamics being simulated, as well as the process of stochastic sampling, are well described and the model fits the exponential function (Equation 1) to data on a large array of worms exhibiting diverse behaviors (1600+ worms from Lopez-Cruz et al). The work of this study is able to explain or describe the inter-individual diversity of worm behavior across a large population. The model is also able to capture two aspects of the reorientations, including the dynamics (to switch or not to switch) and the kinetics (slow vs fast reorientations). The authors also work to compare their model to a few others including the Levy walk (whose construction arises from a Markov process) to a simple exponential distribution, all of which have been used to study foraging and search behaviors.</p>
<p>Weaknesses:</p>
<p>This manuscript has two weaknesses that dampen the enthusiasm for the results. First, in all of the examples the authors cite where a Gillespie algorithm is used to sample from a distribution, be it the kinetics associated with chemical dynamics, or a Lotka-Volterra Competition Model, there are underlying processes that govern the evolution of the dynamics, and thus the sampling from distributions. In one of their references, for instance, the stochasticity arises from the birth and death rates, thereby influencing the genetic drift in the model. In these examples, the process governing the dynamics (and thus generating the distributions from which one samples) is distinct from the behavior being studied. In this manuscript, the distribution being sampled is the exponential decay function of the reorientation rate (lines 100-102). This appears to be tautological - a decay function fitted to the reorientation data is then sampled to generate the distributions of the reorientation data. That the model performs well and matches the data is commendable, but it is unclear how that could not be the case if the underlying function generating the distribution was fit to the data.</p>
</disp-quote>
<p>Thank you, we apologize that this was not clearer. In the Lotka-Volterra model, the density of predators and prey are being modeled, with the underlying assumption that rates of birth and death are inherently stochastic. In our model, the number of reorientations are being modeled, with the assumption (based on the experiments), that the occurrence of reorientations is stochastic, just like the occurrence (birth) of a prey animal is stochastic. However, the decay in M is phenomenological, and we speculate about the nature of M later in the manuscript.</p>
<p>You are absolutely right that the decay function for M was fit to the population average of reorientations and then sampled to generate the distributions of the reorientation data. This was intentional to show that the parameters chosen to match the population average would produce individual trajectories with comparable stochastic “switching” as the experimental data. All we’re trying to show really is that observed sudden changes in reorientation that appear persistent can be produced by a stochastic process without resorting to binary state assignments. In Calhoun, et al 2014 it is reported all animals produced switch-like behavior, but in Klein et al, 2017 it is reported that no animals showed abrupt transitions. López-Cruz et al seem to show a mix of these results, which can easily be explained by an underlying stochastic process.</p>
<disp-quote content-type="editor-comment">
<p>The second weakness is somewhat related to the first, in that absent an underlying mechanism or framework, one is left wondering what insight the model provides.</p>
<p>Stochastic sampling a function generated by fitting the data to produce stochastic behavior is where one ends up in this framework, and the authors indeed point this out: &quot;simple stochastic models should be sufficient to explain observably stochastic behaviors.&quot; (Line 233-234). But if that is the case, what do we learn about how the foraging is happening? The authors suggest that the decay parameter M can be considered a memory timescale; which offers some suggestion, but then go on to say that the &quot;physical basis of M can come from multiple sources&quot;. Here is where one is left for want: The mechanisms suggested, including loss of sensory stimuli, alternations in motor integration, ionotropic glutamate signaling, dopamine, and neuropeptides are all suggested: these are basically all of the possible biological sources that can govern behavior, and one is left not knowing what insight the model provides. The array of biological processes listed is so variable in dynamics and meaning, that their explanation of what governs M is at best unsatisfying. Molecular dynamics models that generate distributions can point to certain properties of the model, such as the binding kinetics (on and off rates, etc.) as explanations for the mechanisms generating the distributions, and therefore point to how a change in the biology affects the stochasticity of the process. It is unclear how this model provides such a connection, especially taken in aggregate with the previous weakness.</p>
<p>Providing a roadmap of how to think about the processes generating M, the meaning of those processes in search, and potential frameworks that are more constrained and with more precise biological underpinning (beyond the array of possibilities described) would go a long way to assuaging the weaknesses.</p>
</disp-quote>
<p>Thank you, these are all excellent points. We should clarify that in López-Cruz et al, they claim that only 50% of the animals fit a local/global search paradigm. We are simply proposing there is no need for designating local and global searches if the data don’t really support it. The underlying behavior is stochastic, so the sudden switches sometimes observed can be explained by a stochastic process where the underlying rate is slowing down, thus producing the persistently slow reorientation rate when an apparent “switch” occurs. What we hope to convey is that foraging doesn’t appear to follow a decision paradigm, but instead a gradual change in reorientations which for individual worms, can occasionally produce reorientation trajectories that appear switch-like.</p>
<p>As for M, you are correct, we should be more explicit, and we have added text (Lines 319-359) to expand upon its possible biological origin.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public review):</bold></p>
<p>Summary:</p>
<p>This intriguing paper addresses a special case of a fundamental statistical question: how to distinguish between stochastic point processes that derive from a single &quot;state&quot; (or single process) and more than one state/process. In the language of the paper, a &quot;state&quot; (perhaps more intuitively called a strategy/process) refers to a set of rules that determine the temporal statistics of the system. The rules give rise to probability distributions (here, the probability for turning events). The difficulty arises when the sampling time is finite, and hence, the empirical data is finite, and affected by the sampling of the underlying distribution(s). The specific problem being tackled is the foraging behavior of C. elegans nematodes, removed from food. Such foraging has been studied for decades, and described by a transition over time from 'local'/'area-restricted' search'(roughly in the initial 10-30 minutes of the experiments, in which animals execute frequent turns) to 'dispersion', or 'global search' (characterized by a low frequency of turns). The authors propose an alternative to this two-state description - a potentially more parsimonious single 'state' with time-changing parameters, which they claim can account for the full-time course of these observations.</p>
<p>Figure 1a shows the mean rate of turning events as a function of time (averaged across the population). Here, we see a rapid transient, followed by a gradual 4-5 fold decay in the rate, and then levels off. This picture seems consistent with the two-state description. However, the authors demonstrate that individual animals exhibit different &quot;transition&quot; statistics (Figure 1e) and wish to explain this. They do so by fitting this mean with a single function (Equations 1-3).</p>
<p>Strengths:</p>
<p>As a qualitative exercise, the paper might have some merit. It demonstrates that apparently discrete states can sometimes be artifacts of sampling from smoothly time-changing dynamics. However, as a generic point, this is not novel, and so without the grounding in C. elegans data, is less interesting.</p>
<p>Weaknesses:</p>
<p>(1) The authors claim that only about half the animals tested exhibit discontinuity in turning rates. Can they automatically separate the empirical and model population into these two subpopulations (with the same method), and compare the results?</p>
</disp-quote>
<p>Thank you, we should clarify that the observation that about half the animals exhibit discontinuity was not made by us, but by López-Cruz et al. The observed fraction of 50% was based on a visual assessment of the dual regression method we described. We added text (Lines 76-79) to clarify this. To make the process more objective, we decided to simply plot the distributions of the metrics they used for this assessment to see if two distinct populations could be observed. However, the distributions of slope differences and transition times do not produce two distinct populations. Our stochastic approach, which does not assume abrupt state-transitions, also produces comparable distributions. To quantify this, we have added a section varying <italic>M<sub>0</sub></italic>, including setting <italic>M<sub>0</sub></italic> to 1, so that the model by definition is a switch model. This model performs the worst (Lines 253-296, Figure 3).</p>
<disp-quote content-type="editor-comment">
<p>(2) The equations consider an exponentially decaying rate of turning events. If so, Figure 2b should be shown on a semi-logarithmic scale.</p>
</disp-quote>
<p>We chose to not do this because this average is based on the number of discrete reorientation events observed within a 2-minute window. The range of events ranges from 0 to 6 (hence a rate of 0.5-3 min<sup>-1</sup>), which does not span one order of magnitude. Instead, we included a heat map (Figure 1a, Figure 2b bottom panel) which shows the density that the average is based on. We hope this provides some clarity to the reader.</p>
<disp-quote content-type="editor-comment">
<p>(3) The variables in Equations 1-3 and the methods for simulating them are not well defined, making the method difficult to follow. Assuming my reading is correct, Omega should be defined as the cumulative number of turning events over time (Omega(t)), not as a &quot;turn&quot; or &quot;reorientation&quot;, which has no derivative. The relevant entity in Figure 1a is apparently &lt;Omega (t)&gt;, i.e. the mean number of events across a population which can be modelled by an expectation value. The time derivative would then give the expected rate of turning events as a function of time.</p>
</disp-quote>
<p>Thank you, you are correct. Please see response to Reviewer #1.</p>
<disp-quote content-type="editor-comment">
<p>(4) Equations 1-3 are cryptic. The authors need to spell out up front that they are using a pair of coupled stochastic processes, sampling a hidden state M (to model the dynamic turning rate) and the actual turn events, Omega(t), separately, as described in Figure 2a. In this case, the model no longer appears more parsimonious than the original 2-state model. What then is its benefit or explanatory power (especially since the process involving M is not observable experimentally)?</p>
</disp-quote>
<p>Thank you, yes we see how as written this was confusing. In our response to Reviewer #1, and in the text, we added an important detail:</p>
<p>While reorientations are modeled as discrete events, which is observationally true, the amount of <italic>M</italic> at time <italic>t</italic>=0 is chosen to be large (<italic>M<sub>0</sub></italic> = 1000), so that over the timescale of 40 minutes, the decay in <italic>M</italic> is practically continuous. This ensures that sudden changes in reorientations are not due to sudden changes in <italic>M</italic>, but due to the inherent stochasticity of reorientations.</p>
<p>However you are correct that if <italic>M</italic> was chosen to have a binary value of 0 or 1, then this would indeed be the two state model. We added a new section to address this (Lines 253-287, Figure 3). Unlike the experiments, the two-state model produces bimodal distributions in slope and transition times, and these distributions are significantly different than the experimental data (Figure 3).</p>
<disp-quote content-type="editor-comment">
<p>(5) Further, as currently stated in the paper, Equations 1-3 are only for the mean rate of events. However, the expectation value is not a complete description of a stochastic system. Instead, the authors need to formulate the equations for the probability of events, from which they can extract any moment (they write something in Figure 2a, but the notation there is unclear, and this needs to be incorporated here).</p>
</disp-quote>
<p>Thank you, yes please see our response to Reviewer #1. We have clarified the text in Lines 105-190.</p>
<disp-quote content-type="editor-comment">
<p>(6) Equations 1-3 have three constants (alpha and gamma which were fit to the data, and M0 which was presumably set to 1000). How does the choice of M0 affect the results?</p>
</disp-quote>
<p>Thank you, this is a good question. We address this in lines 253-296. Briefly, the choice of <italic>M<sub>0</sub></italic> does not have a strong effect on the results, unless we set it to <italic>M<sub>0</sub></italic>, which by definition, creates a two-state model. This model was significantly different than the experimental data, relative to the other models (Figure 3c).</p>
<disp-quote content-type="editor-comment">
<p>(7) M decays to near 0 over 40 minutes, abolishing omega turns by the end of the simulations. Are omega turns entirely abolished in worms after 30-40 minutes off food? How do the authors reconcile this decay with the leveling of the turning rate in Figure 1a?</p>
</disp-quote>
<p>Yes, Reviewer #1 recommended adding a baseline reorientation rate which we did for all models (Equation 2). However, we should also note that in Klein et al they observed a continuous decay over 50 minutes. Though realistically, it is likely not plausible that worms will produce infinitely long runs at long time points.</p>
<disp-quote content-type="editor-comment">
<p>(8) The fit given in Figure 2b does not look convincing. No statistical test was used to compare the two functions (empirical and fit). No error bars were given (to either). These should be added. In the discussion, the authors explain the discrepancy away as experimental limitations. This is not unreasonable, but on the flip side, makes the argument inconclusive. If the authors could model and simulate these limitations, and show that they account for the discrepancies with the data, the model would be much more compelling.</p>
<p>To do this, I would imagine that the authors would need to take the output of their model (lists of turning times) and convert them into simulated trajectories over time. These trajectories could be used to detect boundary events (for a given size of arena), collisions between individuals, etc. in their simulations and to see their effects on the turn statistics.</p>
</disp-quote>
<p>Thank you, we have added dashed lines to indicate standard deviation to Figures 2b and 3a. After running the models several times, we found that some of the small discrepancies noted (like s<sub>1</sub>-s<sub>2</sub> &lt; 0 for experiments but not the model), were spurious due to these data points being &lt;1% of the data, so we cut this from the text. To compare how similar the continuous (<italic>M<sub>0</sub></italic> &gt; 1) and discrete (<italic>M<sub>0</sub></italic> = 1) models were to the experimental data, we calculated a Jensen-Shannon distance for the models, and found that the discrete model was significantly more dissimilar to the experimental data than the continuous models (Lines 289-296, Figure 3c).</p>
<disp-quote content-type="editor-comment">
<p>(9) The other figures similarly lack any statistical tests and by eye, they do not look convincing. The exception is the 6 anecdotal examples in Figure 2e. Those anecdotal examples match remarkably closely, almost suspiciously so. I'm not sure I understood this though - the caption refers to &quot;different&quot; models of M decay (and at least one of the 6 examples clearly shows a much shallower exponential). If different M models are allowed for each animal, this is no longer parsimonious. Are the results in Figure 2d for a single M model? Can Figure 2e explain the data with a single (stochastic) M model?</p>
</disp-quote>
<p>We certainly don’t want the panels in Figure 2e to be suspicious! These comparisons were drawn from calculating the correlations between all model traces and all experimental traces, and then choosing the top hits. Every time we run the simulation, we arrive at a different set of examples. Since it was recommended we add a baseline rate, these examples will be a completely different set when we run the simulation, again.</p>
<p>We apologize for the confusion regarding <italic>M</italic>. Since the worms do not all start out with identical reorientation rates, we drew the initial <italic>M</italic> value from a distribution centered on <italic>M<sub>0</sub></italic> to match the initial distribution of observed experimental rates (Lines 206-214). However, the decay in <italic>M</italic> (γ), as well as α and β, are the same for all in silico animals.</p>
<disp-quote content-type="editor-comment">
<p>(10) The left axes of Figure 2e should be reverted to cumulative counts (without the normalization).</p>
</disp-quote>
<p>Thank you, we made this change.</p>
<disp-quote content-type="editor-comment">
<p>(11) The authors give an alternative model of a Levy flight, but do not give the obvious alternative models:</p>
<p>
a) the 1-state model in which P(t) = alpha exp (-gamma t) dt (i.e. a single stochastic process, without a hidden M, collapsing equations 1-3 into a single equation).</p>
<p>b) the originally proposed 2-state model (with 3 parameters, a high turn rate, a low turn rate, and the local-to-global search transition time, which can be taken from the data, or sampled from the empirical probability distributions). Why not? The former seems necessary to justify the more complicated 2-process model, and the latter seems necessary since it's the model they are trying to replace. Including these two controls would allow them to compare the number of free parameters as well as the model results. I am also surprised by the Levy model since Levy is a family of models. How were the parameters of the Levy walk chosen?</p>
</disp-quote>
<p>Thank you, we removed this section completely, as it is tangential to the main point of the paper.</p>
<disp-quote content-type="editor-comment">
<p>(12) One point that is entirely missing in the discussion is the individuality of worms. It is by now well known that individual animals have individual behaviors. Some are slow/fast, and similarly, their turn rates vary. This makes this problem even harder. Combined with the tiny number of events concerned (typically 20-40 per experiment), it seems daunting to determine the underlying model from behavioral statistics alone.</p>
</disp-quote>
<p>Thank you, yes we should have been more explicit in the reasoning behind drawing the initial <italic>M</italic> from a distribution (response to comment #9). We assume that not every worm starts out with the same reorientation rate, but that some start out fast (high <italic>M</italic>) and some start out slow (low <italic>M</italic>). However, we do assume <italic>M</italic> decays with the same kinetics, which seems sufficient to produce the observed phenomena. Multiple decay rates are not needed to replicate the experimental data.</p>
<disp-quote content-type="editor-comment">
<p>(13) That said, it's well-known which neurons underpin the suppression of turning events (starting already with Gray et al 2005, which, strangely, was not cited here). Some discussion of the neuronal predictions for each of the two (or more) models would be appropriate.</p>
</disp-quote>
<p>Thank you, yes we will add Gray et al, but also the more detailed response to Reviewer #2 (Lines 319-359 of manuscript).</p>
<disp-quote content-type="editor-comment">
<p>(14) An additional point is the reliance entirely on simulations. A rigorous formulation (of the probability distribution rather than just the mean) should be analytically tractable (at least for the first moment, and possibly higher moments). If higher moments are not obtainable analytically, then the equations should be numerically integrable. It seems strange not to do this.</p>
</disp-quote>
<p>Thank you for suggesting this. For the Levy section (which we cut) this would have been an improvement. However, since the distributions of slope differences and transition times are based on a recursive algorithm, rather than an analytical formulation, we decided to use the Jensen-Shannon divergence to compare distributions (Lines 272-296, Figure 3c) since this is a parameter-free approach.</p>
<disp-quote content-type="editor-comment">
<p>In summary, while sample simulations do nicely match the examples in the data (of discontinuous vs continuous turning rates), this is not sufficient to demonstrate that the transition from ARS to dispersion in C. elegans is, in fact, likely to be a single 'state', or this (eq 1-3) single state. Of course, the model can be made more complicated to better match the data, but the approach of the authors, seeking an elegant and parsimonious model, is in principle valid, i.e. avoiding a many-parameter model-fitting exercise.</p>
<p>As a qualitative exercise, the paper might have some merit. It demonstrates that apparently discrete states can sometimes be artifacts of sampling from smoothly time-changing dynamics. However, as a generic point, this is not novel, and so without the grounding in C. elegans data, is less interesting.</p>
</disp-quote>
<p>Thank you, we agree that this is a generic phenomenon, which is partly why we did this. The data from López-Cruz seem to agree in part with Calhoun et al, that claim abrupt transitions occur, and Klein et al, which claim they do not occur. Since the underlying phenomenon is stochastic, we propose the mixed observations of sudden and gradual changes in search strategy are simply the result of a stochastic process, which can produce both phenomena for individual observations. We hope this work can help clarify why sudden changes in search strategy are not consistently observed. We propose a simple hypothesis that there is no change in search strategy. The reorientation rate decays in time, and due to the stochastic nature of this behavior, what appears as a sudden change for individual observations is not due to an underlying decision, but rather the result of a stochastic process.</p>
</body>
</sub-article>
</article>