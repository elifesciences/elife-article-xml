<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">107540</article-id>
<article-id pub-id-type="doi">10.7554/eLife.107540</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.107540.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories><title-group>
<article-title>Longitudinal tracking of neuronal activity from the same cells in the developing brain using Track2p</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Majnik</surname>
<given-names>Jure</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>jure.majnik@inserm.fr</email>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Mantez</surname>
<given-names>Manon</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zangila</surname>
<given-names>Sofia</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bugeon</surname>
<given-names>Stéphane</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Guignard</surname>
<given-names>Leo</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5542-3076</contrib-id>
<name>
<surname>Platel</surname>
<given-names>Jean-Claude</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
    <xref ref-type="author-notes" rid="n1">*</xref>
<email>jean-claude.platel@inserm.fr</email>
</contrib>
<contrib contrib-type="author" corresp="yes" equal-contrib="yes">
<name>
<surname>Cossart</surname>
<given-names>Rosa</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
    <xref ref-type="author-notes" rid="n1">*</xref>
<email>rosa.cossart@inserm.fr</email>
</contrib>
    <aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/035xkbk20</institution-id><institution>Aix Marseille Univ, Inserm, INMED, Turing Center for Living Systems</institution></institution-wrap>, <city>Marseille</city>, <country country="FR">France</country></aff>
    <aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/035xkbk20</institution-id><institution>Aix-Marseille Univ, CNRS, IBDM, UMR7288, Turing Centre for Living Systems</institution></institution-wrap>, <city>Marseille</city>, <country country="FR">France</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Petreanu</surname>
<given-names>Leopoldo</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Champalimaud Center for the Unknown</institution>
</institution-wrap>
<city>Lisbon</city>
<country country="PT">Portugal</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Huguenard</surname>
<given-names>John R</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Stanford University School of Medicine</institution>
</institution-wrap>
<city>Stanford</city>
<country country="US">United States</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
    <fn id="n1" fn-type="equal"><label>*</label><p>These authors contributed equally</p></fn>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-07-09">
<day>09</day>
<month>07</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP107540</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2025-05-13">
<day>13</day>
<month>05</month>
<year>2025</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2025-03-01">
<day>01</day>
<month>03</month>
<year>2025</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2025.02.26.640367"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Majnik et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Majnik et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-107540-v1.pdf"/>
<abstract>
<title>Abstract</title><p>Understanding cortical circuit development requires tracking neuronal activity across days in the growing brain. While <italic>in vivo</italic> calcium imaging now enables such longitudinal studies, automated tools for reliably tracking large populations of neurons across sessions remain limited. Here, we present a novel cell-tracking method based on sequential image registration, validated on calcium imaging data from the barrel cortex of mouse pups over one postnatal week. Our approach enables robust long-term analysis of several hundreds of individual neurons, allowing quantification of neuronal dynamics and representational stability over time. Using this method, we identified a key developmental transition in neuronal activity statistics, marking the emergence of arousal state modulation. Beyond this key finding, our method provides an essential tool for tracking developmental trajectories of individual neurons, which could help identify potential deviations associated with neurodevelopmental disorders.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>

</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Early postnatal development in rodents is a period of intense circuit wiring and remodelling at several scales through various major processes that include neuronal growth, synaptogenesis, apoptosis, migration, rise of intracortical connectivity, functional maturation of inhibitory synapses and the disappearance of transient connectivity schemes <sup><xref ref-type="bibr" rid="c1">1</xref>–<xref ref-type="bibr" rid="c4">4</xref></sup>. Critical periods for various sensory systems open and close during this time, further highlighting the profound reshaping of cortical networks <sup><xref ref-type="bibr" rid="c4">4</xref></sup>. This developmental period of remodelling is crucial for establishing the functional architecture of the mature cortex. Most importantly, all of these developmental processes are activity-dependent, with collective dynamics playing a critical role in the proper integration of neurons into functional networks <sup><xref ref-type="bibr" rid="c5">5</xref></sup>. These network dynamics sequentially unfold while relying on different mechanisms and circuits for their generation <sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c5">5</xref></sup>. The emergence of functional brain circuits during development is therefore a precisely timed choreography, the timing of which is inherently tied to the age of the organism under study.</p>
<p>However, developmental age lacks precision due to significant variations in physical characteristics and growth patterns, even among offspring from the same genetic lineage (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). Hence, longitudinal imaging from the same animal across days is the optimal solution to better capture the evolution of circuit dynamics during development. Additionally, developmental variability extends beyond the organism level, becoming even more pronounced at the single neuron level (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). While population-level descriptions of cortical circuit development are crucial, individual neurons exhibit unique developmental trajectories rooted in their specific origin, birth timing and cellular identity <sup><xref ref-type="bibr" rid="c1">1</xref></sup>. In addition, the singular dynamics of sparse individual neurons can matter, as demonstrated for the rare hub cells <sup><xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c7">7</xref></sup>. Thus, in order to fully understand the circuit basis of cortical development in health and disease, it is crucial to track neuronal activity at both population and individual cell levels in the growing brain of the same animal. This hurdle spans both experimental methodology and data analysis.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Tracking developmental trajectories at the organismal and cellular level.</title><p>Postnatal development in mammals is not a strictly stereotyped process (left) but rather shows variability across individual organisms as well as across individual cells of the same organism (right). Performing an acute experiment (dashed grey line) only provides a single snapshot of the developmental trajectory of an individual organism (or cell). Alternatively, a longitudinal experiment (grey arrow) allows to track the properties of the same individual (or cell) throughout development, which is especially important in the case of variability in developmental trajectories (right).</p></caption>
<graphic xlink:href="640367v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Significant progress has been made over the recent years to develop innovative solutions to meet this challenge on the experimental side, using two-photon calcium imaging. Technical improvements included modified head plates and specialized surgical and care protocols <sup><xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c8">8</xref>–<xref ref-type="bibr" rid="c12">12</xref></sup>. Still, in many cases, different neurons from the same mouse were recorded at different ages, or the tracking of individual cells could only be achieved through visual inspection and manual annotation of relatively sparse, often genetically-subscribed neuronal populations expressing a calcium fluorescent reporter. The gold standard for developmental circuit analysis would be automated tracking of densely labeled neuronal populations, enabling efficient longitudinal monitoring while eliminating the burden of manual cell tracking. An algorithm capable of accurate automatic tracking of the same neurons across multiple days of brain development is thus essential.</p>
<p>Methods for tracking the activity of large populations of cells across days have been successfully developed and deployed in the adult brain <sup><xref ref-type="bibr" rid="c13">13</xref>–<xref ref-type="bibr" rid="c16">16</xref></sup>. In adult circuits, cell tracking is indeed relatively straightforward due to their structural stability, with minimal tissue growth, negligible morphological changes, and constant numbers of neurons. In contrast, the first weeks of mouse neocortical development are characterized by rapid and critical developmental changes spanning several scales from synapses, to single neurons and networks. These include extensive brain growth <sup><xref ref-type="bibr" rid="c17">17</xref>,<xref ref-type="bibr" rid="c18">18</xref></sup>, substantial morphological changes <sup><xref ref-type="bibr" rid="c19">19</xref></sup> as well as changes to cell numbers due to programmed cell death <sup><xref ref-type="bibr" rid="c10">10</xref></sup>. This makes tracking the same cells across sessions substantially more difficult during development compared to the adult brain.</p>
<p>To overcome the technical limitations detailed above, we developed an experimental protocol using chronic calcium imaging in mice and a novel cell tracking algorithm (Track2p), specifically tailored to development. This allowed us to track the activity of large, densely labelled, populations of neurons during early postnatal development, which has not been possible before. The algorithm overcomes the challenges of cell tracking during brain growth by applying sequential registration and cell matching steps, using the spatial overlap of cells on adjacent recordings as a matching criterion. Track2p is freely available as an open-source package with an interactive GUI, enabling researchers to analyze longitudinal calcium imaging data from both developing and mature circuits.</p>
<p>Applying the algorithm to a dataset recorded during the second postnatal week in mouse barrel cortex, a critical period for the formation of topographic maps in that region, yielded hundreds of identified neurons tracked across all days. Assessing the quality of the algorithm by benchmarking it on a newly generated ground truth dataset showed high tracking performance <sup><xref ref-type="bibr" rid="c20">20</xref></sup>. Leveraging ground truth benchmarking, we demonstrate that explicitly accounting for developmental processes, such as brain growth, are critical for accurately tracking cells during postnatal development. Our work thus shows that chronic calcium imaging and cell tracking using Track2p can be used to monitor the changing physiological properties of large populations of matched neurons during early cortical development. We demonstrate that the statistics of activity patterns in the tracked population display two periods of stability, with a critical transition point around postnatal day 11 (P11), marking the emergence of a stable behavioral state representation.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Cell tracking using image registration and ‘overlap-based’ matching</title>
<p>Tracking neuronal activity across multiple days presents unique challenges due to the dynamic nature of brain development. We developed a novel tracking algorithm, called Track2p. As in other tracking algorithms for calcium imaging data <sup><xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c16">16</xref>,<xref ref-type="bibr" rid="c21">21</xref></sup>, the final goal of Track2p is to follow individual cells across sessions allowing the user to compare their functional properties in downstream analyses. To achieve this goal, the algorithm takes as input a set of preprocessed recordings (using Suite2p <sup><xref ref-type="bibr" rid="c23">23</xref></sup>), each consisting of a set of regions of interest (ROIs i.e. putative neurons detected based on activity, see Methods) and their respective calcium fluorescence traces, as well as a mean image of the field of view (FOV). Briefly, the algorithm aims to match ROIs in any given pair of consecutive sessions based on their spatial overlap, assuming that the more the two overlap in anatomical space, the more likely they correspond to the same neuron. Due to developmental processes such as brain growth and other experimental factors, it is necessary to account for day-to-day changes that occur between the two recordings before computing spatial overlaps. This is achieved by performing affine image registration on the mean FOV images between consecutive days.</p>
<p>We apply the registration and spatial matching iteratively, starting with the first pair of sessions (s<sub>0</sub> and s<sub>1</sub>) as follows (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>):</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><title>The Track2p pipeline for tracking cells across recordings.</title>
<p><bold>A</bold>: Schematic overview of the Track2p algorithm and the GUI capabilities. Dashed squares represent optional steps in the pipeline. <bold>B</bold>: The transformation (T) between two consecutive days is computed by registering the mean FOV images. Top: An overlay of the reference (red, s<sub>0</sub>) and the moving (green, s<sub>1</sub>) images before registration. Bottom: Same two images after registration. Scale bar: 50 μm. <bold>C</bold>: Applying the transform to ROIs from Suite2p segmentation. The ROI color code is the same as in B, the intersection of the ROIs is shown in yellow. Top: Overlap before T. Bottom: Overlap after T. Note: Only a few example ROIs are displayed for explanation purposes. <bold>D</bold>: Cell matching using linear sum assignment. ROIs are the same as C with indexes for the two recordings added for illustrative purposes. Cells from one recording are matched to cells from another maximising the sum of the intersection over union (IoU) across all matches. <bold>E</bold>: Filtering putative false and true matches by thresholding the IoU distribution. Top: The distribution of IoU values for matched ROI pairs shows a bimodal distribution, which is used to reject putative false positive matches. Bottom: Final result of the cell linking for a pair of recordings. <bold>F</bold>: Top: In the case of tracking across more than 2 imaging sessions, the steps from B to D are repeated sequentially to link the cells across all days. Bottom: Example matches for five cells (rows) successfully tracked across five consecutive days (columns). Note: The figures shown are for illustrative purposes only, see <xref rid="fig3" ref-type="fig">Fig. 3</xref> for application to real data.</p></caption>
<graphic xlink:href="640367v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Firstly, we estimate the spatial transformation between s<sub>0</sub> and s<sub>1</sub> using affine image registration (<xref rid="fig2" ref-type="fig">Fig. 2B</xref>, the transformation is denoted as T). We employ affine transformation, since it can account both for rigid transformations (rotations and translations arising from minor mismatches in FOV alignment across experiments) as well as scaling and shearing (mostly due to brain growth). The changes across the two consecutive recordings are approximated as the transformation registering the mean FOV from session s<sub>1</sub> (green in <xref rid="fig2" ref-type="fig">Fig. 2B</xref>) to the mean FOV of s<sub>0</sub> serving as reference (red in <xref rid="fig2" ref-type="fig">Fig. 2B</xref>).</p>
<p>Secondly, the computed transformation is applied to the ROIs from session s<sub>1</sub> (green in <xref rid="fig2" ref-type="fig">Fig. 2C</xref>) to align them to ROIs from session s<sub>0</sub> (red in <xref rid="fig2" ref-type="fig">Fig. 2C</xref>). The amount of spatial overlap after registration (yellow in <xref rid="fig2" ref-type="fig">Fig. 2C</xref>, bottom), can indicate the accuracy of the estimated transformation between the two days. Assuming that the transformation is accurately estimated, ROIs corresponding to the same cells display substantial spatial overlap, with some ROIs from one recording also potentially overlapping poorly, if not at all, with any ROI from another.</p>
<p>Thirdly, once the ROIs are aligned, the algorithm proceeds with the matching (<xref rid="fig2" ref-type="fig">Fig. 2D</xref>). This is done by computing a spatial similarity metric (intersection over union - IoU) between each ROI from session s<sub>0</sub> and each transformed ROI from session s<sub>1</sub>. Matches are then assigned in a globally optimal way by maximising the sum of IoU values across all matches using a linear sum assignment algorithm.</p>
<p>Finally, since two consecutive sessions contain different sets of detected cells (see * in <xref rid="fig2" ref-type="fig">Fig. 2D</xref>, bottom) and since ROIs can overlap even if the signal does not come from the same cells (see + in <xref rid="fig2" ref-type="fig">Fig. 2D</xref>, bottom) we perform an additional filtering step on the assigned matches. Assuming that the IoU values for putative true and putative false matches come from different distributions, we would expect a bimodal distribution of IoU values across all assigned matches (see histogram in <xref rid="fig2" ref-type="fig">Fig. 2E</xref>). To reject the putative false positives, we compute a threshold based on automatic thresholding methods (Otsu’s method <sup><xref ref-type="bibr" rid="c24">24</xref></sup>). This ensures that assigned matches with low spatial similarity are rejected (see + in <xref rid="fig2" ref-type="fig">Fig. 2D and E</xref>) while the matches with high similarity are accepted (see x in <xref rid="fig2" ref-type="fig">Fig. 2D and E</xref>). This yields the final matching for the first pair of consecutive imaging sessions (s<sub>0</sub> and s<sub>1</sub>). In the case of more than 2 recordings, this tracking procedure is then iteratively applied for all consecutive pairs of sessions (s<sub>0</sub> to s<sub>1</sub>, s<sub>1</sub> to s<sub>2</sub> … s<sub>N-1</sub> to s<sub>N</sub> , and so on), with tracks being extended sequentially from s<sub>0</sub> to s<sub>N</sub> based on the identified matches, and terminated if a match was not identified at any particular session (<xref rid="fig5" ref-type="fig">Fig. 5F</xref>).</p>
<p>We provide an open-source implementation of the algorithm, combined with a user- friendly graphical user interface (GUI), allowing non-specialist users to run the algorithm and interact with its outputs (see <xref rid="fig2" ref-type="fig">Fig. 2A</xref> top, <xref rid="figs1" ref-type="fig">Extended Data Fig. 1</xref> and Supp. Info.: Software). Both the algorithm and the GUI come with a simple installation procedure and extensive documentation to facilitate the ease of use and accessibility of Track2p.</p>
</sec>
<sec id="s2b">
<title>Tracking neurons across days in the early postnatal neocortex</title>
<p>In order to validate our method on experimental data, we next applied Track2p to a longitudinal dataset consisting of daily recordings of the same 720x720 μm FOV throughout the second postnatal week of mouse barrel cortex development (postnatal days 8 (P8) to P14, n=7 imaging sessions from one mouse; for more details see Methods.) In addition to the calcium indicator (GCaMP8m), we virally expressed a sparse anatomical marker (tdTomato) targeting GABAergic neurons using conditional expression in GAD67-Cre mice <sup><xref ref-type="bibr" rid="c22">22</xref></sup>. This dual- labelling strategy facilitated reliable FOV identification across sessions and provided an anatomical reference for Track2p’s initial cross-session registration and tracking (<xref rid="fig3" ref-type="fig">Fig. 3</xref>, for comparison with tracking based on GCaMP8m registration see the ‘Benchmarking on manually tracked cells’ section). Before running Track2p, each recording was preprocessed using Suite2p <sup><xref ref-type="bibr" rid="c23">23</xref></sup> for active cell detection (segmentation) and calcium fluorescence trace extraction (see Methods). The outputs of Suite2p (ROIs, traces and FOV images) were then used as inputs to the Track2p algorithm.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><title>Track2p tracks hundreds of cells throughout the second postnatal week of development in the mouse neocortex despite substantial brain growth.</title>
<p><bold>A</bold>: Top left and right: Mean images of the ‘anatomical’ channel (tdTomato in GABAergic cells) for the first two imaging days (P8 and P9). Scale bar: 100 μm. Bottom left: Overlay of the two images after registration (pseudocolored as red and green respectively). Bottom middle: Overlay of the ROIs after registration (same colour code for P8 and P9). Bottom right: Distribution of IoU values for matched pairs showing the automatic threshold (grey dashed line). <bold>B</bold>: Same as A but for the last two imaging days (P13 and P14). <bold>C</bold>: Nine representative examples of matches visualised in the mean ‘functional’ channel (signal from pan-neuronal GCaMP8m expression) on the first and last days of recording (P8 and P14). The blue dot indicates the centroid of the ROI. <bold>D</bold>: Overlay of all ROIs successfully tracked across all days (N=728) on the mean ‘functional’ channel image of the first (P8, left) and last (P14, right) imaging days. Each tracked ROI is shown in the same color across the plots. Note the expansion of the FOV at P14 compared to P8. Scale bar: 100 μm. <bold>E</bold>: Graph plotting the proportion (y-axis) and absolute number (grey text) of cells successfully tracked from the first day of imaging onwards. <bold>F</bold>: Brain growth quantified as the relative increase in pairwise distances between tracked cells normalised to the first day. Grey dots represent the mean for each recording. Note: For visualisations in panels A, B, C and D across all days see <xref rid="figs2" ref-type="fig">Extended Data Fig. 2</xref>.</p></caption>
<graphic xlink:href="640367v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
    <p>The Track2p algorithm appeared to successfully register the mean FOV for each successive pair of imaging sessions (based on visual inspection of Track2p outputs; for the first and last pairs see <xref rid="fig3" ref-type="fig">Fig. 3A and B</xref> bottom left; for the equivalent of <xref rid="fig3" ref-type="fig">Fig. 3</xref> across all days see <xref rid="figs2" ref-type="fig">Extended Data Fig. 2A</xref>). Registering the ROIs for each pair of consecutive recordings showed a great degree of overlap for the majority of ROIs (yellow area in <xref rid="fig3" ref-type="fig">Fig. 3A and B</xref> bottom). We did however observe several ROIs that were only present in one session from the pair, likely due to differences in cell detection and developmental factors such as growth, silencing or cell death. When matching ROIs across sessions using spatial overlap (IoU), we would expect these ROIs to show significantly lower IoU values compared to the cells that were present in both sessions. Indeed, the IoU distribution of assigned matches revealed a bimodal distribution for each pair of imaging sessions, allowing us to use classical histogram thresholding methods <sup><xref ref-type="bibr" rid="c24">24</xref></sup>, clearly separating the distributions of putative true and false matches (<xref rid="fig3" ref-type="fig">Fig. 3A and B</xref> bottom right, <xref rid="fig2" ref-type="fig">Extended Data Fig. 2B</xref>). Propagating the putative matches yielded a total of 728 ROIs that were tracked across all days in this example mouse (out of 1988 ROIs detected in the first recording, <xref rid="fig3" ref-type="fig">Fig. 3E</xref>). We used the subset of cells successfully tracked across all days for all our future analyses.</p>
<p>Plotting ROIs overlaid on top of the mean image of the GCaMP8m imaging channel (<xref rid="fig3" ref-type="fig">Fig. 3D</xref> for contours on whole FOV, C for magnified example matches) and visually inspecting the matches using the Track2p GUI indicated excellent tracking with Track2p. These visualisations also revealed the substantial growth of the neocortex during the course of the experiment (FOV area covered by ROIs at P8 compared to P14 in <xref rid="fig3" ref-type="fig">Fig. 3D</xref>), with some cells growing out of the FOV (see top and left in <xref rid="fig3" ref-type="fig">Fig. 3D</xref>) and the pairwise distances between matched ROIs increasing by approximately 15% (<xref rid="fig3" ref-type="fig">Fig. 3F</xref>).</p>
<p>Applying Track2p on an example longitudinal imaging dataset thus demonstrated that it can successfully track activity from a large number of putatively matched neurons throughout early postnatal development in mice, as confirmed by visual inspection. To assess the tracking performance in a more quantitative and objective way, we next benchmarked Track2p’s performance on manually generated ground truth for our specific experimental setting.</p>
</sec>
<sec id="s2c">
<title>Benchmarking on manually tracked cells</title>
<p>In order to benchmark Track2p, expert annotators manually tracked cells across sessions (similarly as in the Cell Tracking Challenge <sup><xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c25">25</xref></sup>). Benchmarking was performed based on a dataset from 3 mouse pups imaged under the same experimental conditions as described in the previous section (including the dataset shown in <xref rid="fig3" ref-type="fig">Fig. 3</xref>). For each experiment, we chose 64 homogeneously distributed ROIs detected on the first day and tracked them based on visual inspection across consecutive sessions (for more details see Methods and <xref rid="figs3" ref-type="fig">Extended Data Fig. 3</xref>). This left us with on average 20 neurons per experiment that we were able to manually track across all days (‘GT’ in <xref rid="fig4" ref-type="fig">Fig 4</xref>.). We then proceeded to compare these to cell tracks identified by Track2p. For the purposes of evaluation we used a fully automatic tracking procedure (without manual curation and with default Track2p parameters).</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><title>Evaluation of tracking performance on a manually tracked ground truth dataset during the second postnatal week of development in the mouse neocortex.</title>
<p><bold>A</bold>: A schematic representation of possible cases when comparing ground truth tracks (GT, solid lines) with those reconstructed by Track2p (T2P, dashed lines). The CT metric favours perfect matches (top row) and penalises all types of mismatches (bottom four rows). <bold>B</bold>: Graph showing the CT score for all three GT datasets across evaluated conditions. Mean CT scores of 0.93, 0.91, 0.22 and 0.00 for ‘Anatomical’, ‘Functional’, ‘Rigid’ and ‘CellReg’ respectively. Blue denotes the example mouse illustrated in <xref rid="fig3" ref-type="fig">Fig. 3</xref>. <bold>C</bold>: Proportion of fully correctly reconstructed GT traces for increasing time spans starting from P8 for the baseline (‘Anatomical’) condition. <bold>D</bold>, <bold>E</bold> and <bold>F</bold>: Same as C but for the ‘Functional’, ‘Rigid’ and ‘CellReg’ conditions respectively.</p></caption>
<graphic xlink:href="640367v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Different metrics exist for evaluating cell tracking. Since we are aiming to track cells across all days, a robust cell tracking metric should reward perfect track matches with ground truth while imposing penalties for missed or incorrectly identified tracks. For this reason we used a biologically inspired ‘complete tracks’ quality metric, which corresponds to the F1 score for completely reconstructed full tracks (we refer to this value as ‘CT’ according to <sup><xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c25">25</xref></sup>). A CT score of 1 would correspond to perfect tracking, while a CT score of 0 would correspond to no matches or a large proportion of wrong matches (see <xref rid="fig4" ref-type="fig">Fig. 4A</xref> and Methods for more details). Additionally, to assess tracking performance over time, we quantified the proportion of reconstructed ground truth tracks across progressively shorter time intervals (‘Prop. correct in <xref rid="fig4" ref-type="fig">Fig. 4C-F</xref>, see Methods).</p>
<p>Track2p was evaluated under three different scenarios, and compared to the performance of a widely used algorithm developed for longitudinal tracking in the adult brain (CellReg <sup><xref ref-type="bibr" rid="c21">21</xref></sup>, see Methods). The initial evaluation was done using day-to-day registration based on a sparse anatomical marker (as in <xref rid="fig3" ref-type="fig">Fig. 3</xref>). Calculating the CT score in this condition showed remarkably high tracking performance for all datasets (see ‘Anatomical’ in <xref rid="fig4" ref-type="fig">Fig. 4B</xref>, mean CT = 0.93). To test whether a sparse marker was strictly necessary for successful tracking, we next ran the algorithm using the mean image of the GCaMP8m channel as a comparison. Interestingly, this evaluation showed a similar performance (see ‘Functional’ in <xref rid="fig4" ref-type="fig">Fig. 4B</xref>, mean CT = 0.91), indicating that dense calcium indicator labelling alone can provide comparable tracking performance, eliminating the requirement for sparse anatomical labeling.</p>
<p>To show the importance of a method tailored to the growing brain, we next compared the baseline tracking performance with two alternative conditions: firstly, by using Track2p without explicitly accounting for day-to-day growth, performing a rigid instead of affine registration of consecutive recordings; and secondly, by comparing Track2p to CellReg tracking <sup><xref ref-type="bibr" rid="c21">21</xref></sup>. In both scenarios, tracking performance significantly deteriorated compared to our baseline method (see ‘Rigid’ and ‘CellReg’ in <xref rid="fig4" ref-type="fig">Fig. 4B</xref>, mean CT = 0.22 and CT = 0 respectively). Interestingly however, these methods still managed to correctly reconstruct a portion of tracks across shorter age spans in certain cases (<xref rid="fig4" ref-type="fig">Fig. 4E and F</xref>), with the performance dropping significantly for longer tracks in comparison to the baseline condition (<xref rid="fig4" ref-type="fig">Fig. 4C and D</xref>).</p>
<p>These comparisons demonstrate Track2p’s robust cell tracking performance in the developing brain, maintaining high accuracy over extended periods of development. However, tracking performance certainly depends on the type of experimental data (age, model system, brain area, imaging parameters, FOV alignment etc.), hence we also provide additional resources and documentation, allowing users to benchmark Track2p for their particular use case.</p>
</sec>
<sec id="s2d">
<title>Development of firing statistics from hundreds of tracked neurons across postnatal development</title>
<p>Having validated the performance of cell tracking, we next analyzed the development of functional properties of the tracked population of neurons across the second postnatal week of mouse barrel cortex development. For this, we used a full dataset of 6 mice imaged daily for a minimum of 6 consecutive days within the second postnatal week (P7 to P14, see <xref rid="fig5" ref-type="fig">Fig. 5B</xref> for summary, we used this dataset for all subsequent analyses). On average 526 (± 190 std) neurons per mouse were successfully tracked across all days using Track2p. During the course of the experiment, the weight of a mouse increased on average by 55 % (± 18% std), with the pairwise distance between neurons increasing on average by 15 % (± 7% std) (<xref rid="fig5" ref-type="fig">Fig. 5C</xref> and <xref rid="figs5" ref-type="fig">Extended Data Fig. 5F</xref>). Weight was found to vary significantly across mice, as early as the first experimental day, and to correlate with brain growth (r=0.92, <xref rid="figs5" ref-type="fig">Extended Data Fig. 5E</xref>). Our robust tracking capability provides a comprehensive view of the evolution of neuronal dynamics within single mice, while also allowing us to take into account the heterogeneity of the developmental timelines across mice.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><title>Evolution of neuronal activity statistics from hundreds of tracked neurons during the second postnatal week of mouse development.</title>
<p><bold>A:</bold> Raster plots showing the activity of all 728 tracked neurons as a function of time for the example mouse at P8 (top) and P14 (bottom). Each row in the raster corresponds to the trace of a single cell with the sorting determined by their Rastermap embedding computed at P14. Grey traces underneath the raster show a metric of global motion of the mouse computed from videography (see Methods). <bold>B</bold>: Overview of the full dataset, indicating the imaging days for each mouse (left) and the total number of cells successfully tracked (with Track2p) across all recording days (right); * indicates mice used in the evaluation of the algorithm (<xref rid="fig3" ref-type="fig">Fig 3</xref>); blue denotes the example mouse. <bold>C</bold>: Graphs plotting the mouse weight (left) and the mean pairwise distance between tracked neurons (right; normalized to P9 which corresponds to the earliest common day across all mice) as a function of imaging days t. <bold>D</bold>: Graphs plotting the distribution of calcium fluorescence event rates in all tracked neurons from the example mouse as a function of age (left), the mean value across days for all mice (middle) and a statistical comparison between the early (≤ P11) and late (&gt; P11) epochs (right). Example mouse is shown in blue; same in E, F and G. *: Mann–Whitney U test, p = 7.6 x 10<sup>-6</sup>. For standard deviation see <xref rid="figs5" ref-type="fig">Extended Data Fig. 5G</xref>. <bold>E</bold>: Same as D but for pairwise correlations. *: Mann–Whitney U test, p = 1.8 x 10<sup>-6</sup>. For standard deviation see <xref rid="figs5" ref-type="fig">Extended Data Fig. 5H</xref>. <bold>F</bold>: Graphs plotting pairwise correlations as a function of anatomical distance for all pairs of tracked neurons across all ages in the example mouse (left), the estimated pairwise correlation of neighbouring neurons as a function of age for all mice (middle) and a statistical comparison across the two epochs (right). *: Mann–Whitney U test, p = 2.7 x 10<sup>-7</sup>. <bold>G</bold>: Cumulative distribution plot of the explained variance as a function of the number of principal components (PCs) for the example mouse across ages (left), number of PCs accounting for 90% of the variance as a function of age for all mice (right) and a statistical comparison across the two epochs (right). *: Mann–Whitney U test, p = 4.0 x 10<sup>-6</sup>.</p></caption>
<graphic xlink:href="640367v1_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The early postnatal period of cortical development studied here is characterized by the transition from synchronous calcium events recruiting many neurons to progressively more decorrelated population dynamics <sup><xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c27">27</xref></sup>. In order to visualise these global changes in our dataset of longitudinally imaged mice, we first plotted rasterplots of calcium fluorescence traces as a function of time for all tracked neurons on each imaging day (<xref rid="fig5" ref-type="fig">Fig. 5A</xref> for P8 and P14, all days in Extended data <xref rid="fig4" ref-type="fig">Fig. 4A</xref>). Visual inspection of these rasterplots clearly indicates the disappearance of recurring periods of highly synchronous activity from around P11 onwards as well as a global increase in single-neuron activity rates. Accordingly, quantifying calcium event rates as a function of age indicated a gradual increase in the mean and a widening of the distribution with age (<xref rid="fig5" ref-type="fig">Fig. 5D</xref> and <xref rid="figs5" ref-type="fig">Extended Data Fig. 5A</xref> and G, all statistical comparisons were done between an ‘early’ (≤ P11) and ‘late’ (&gt; P11) set of recordings). This evolution also signalled the transition towards long-tailed firing rate distributions, which are ubiquitous in adult brain circuits <sup><xref ref-type="bibr" rid="c28">28</xref></sup>.</p>
<p>Next, we analyzed the distributions of pairwise correlations between activity traces from all longitudinally tracked neurons as a function of mouse age (<xref rid="fig5" ref-type="fig">Fig. 5D</xref> and Extended Data Fig 5B and H). Consistent with the disappearance of highly synchronous network events observed in the rasterplots, we found a significant decrease in mean pairwise correlations, indicating a progressive decorrelation of neuronal activity (<xref rid="fig5" ref-type="fig">Fig. 5E</xref>). The spatial distribution of pairwise correlations also evolved across days from highly correlated locally to more broadly distributed (<xref rid="fig5" ref-type="fig">Fig. 5F</xref>), suggesting the gradual breakdown of spatially clustered assemblies <sup><xref ref-type="bibr" rid="c5">5</xref></sup>.</p>
<p>We finally turned to characterising the dominant population patterns of neural activity using principal component analysis (PCA). Interestingly, we observed an increase in the number of components required to explain a fixed amount of variance in the neural data across days, suggesting a developmental increase in dimensionality (<xref rid="fig5" ref-type="fig">Fig. 5G</xref>), consistent with the statistics of spontaneous activity described in the adult brain <sup><xref ref-type="bibr" rid="c29">29</xref></sup>. Notably, the plots of summary statistics for our entire dataset, indicated a clear outlier, consistent across all quantifications (<xref rid="fig5" ref-type="fig">Fig. 5D, E, F</xref> and G). This outlier mouse displayed a similar but delayed developmental trajectory, compared to the other mice. Interestingly, it also showed the lowest initial weight and a less pronounced growth in weight and cortical size (<xref rid="fig5" ref-type="fig">Fig. 5C</xref>), likely indicating a lower maturation stage at the onset of the experiments, although the contribution of other experimental factors cannot be excluded given the invasiveness of imaging surgery.</p>
<p>To fully leverage our longitudinal approach, we next turned to comparing the functional properties of the same neurons across development, which is only possible when tracking cells across days.</p>
</sec>
<sec id="s2e">
<title>A marked reorganisation of the functional network structure during the second postnatal week</title>
<p>We first examined the stability of the correlation structure, which we will refer to as ‘Functional connectivity’ (FC). Two alternative possibilities could be envisaged (see <xref rid="fig6" ref-type="fig">Fig. 6A</xref>,: (i) FC could be conserved across days, meaning that a highly connected pair on a given day would remain highly connected on the next (<xref rid="fig6" ref-type="fig">Fig. 6A</xref>, left); (ii) FC could reorganise, losing the structure from the previous day (<xref rid="fig6" ref-type="fig">Fig. 6A</xref>, right). In the first case, the FC values for all pairs would remain similar across the two days (<xref rid="fig6" ref-type="fig">Fig. 6A</xref>, bottom left) whereas in the second case they would be different (<xref rid="fig6" ref-type="fig">Fig. 6A</xref>, bottom right). To discriminate between the two cases, we defined a ‘FC similarity’ score for any pair of imaging days with matched neurons for a given mouse (Pearson correlation (r) across all neuron pairs, see <xref rid="fig6" ref-type="fig">Fig. 6A</xref>, bottom). Such FC similarity metric, encapsulates a variety of possible sources of network changes, from local or long-range connectivity, intrinsic excitability to neuromodulation.</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption><title>Transition between two stable functional network structures during the second postnatal week of barrel cortex development.</title>
<p><bold>A</bold>: Schematic explanation of the framework to compare functional connectivity across days; grey nodes represent neurons, strength of a functional connection is denoted by the opacity of the blue edge between two nodes. For a network of 4 neurons and a given connectivity C<sub>d</sub> (16 connections, top) we can imagine that the connectivity on the next day (C<sub>d+1</sub>) could be ‘conserved’ (middle left) or it could be ‘reorganised’ (middle right). A scatter plot comparing all 16 functional connections between C<sub>d</sub> and C<sub>d+1</sub> would indicate a high correlation in the ‘conserved’ case (bottom left) and low correlation in the reorganised case (bottom right). We refer to this correlation as ‘FC similarity’. <bold>B</bold>: Scatter plots of FC for three different pairs of recording days: a pair of early sessions (P8 to P9, top left), an early and a late session (P8 to P14, top middle) and a pair of late sessions (P13 to P14, top right). Within-session FC similarity (bottom scatter plots) i.e. comparing the first and second half of an imaging session at early (P8<sub>1/2</sub> to P8<sub>2/2</sub>, bottom left) and late ages (P14<sub>1/2</sub> to P14<sub>2/2</sub>, bottom right). For visualisation purposes a random subset of 200 pairs is displayed; Linear fit and r (pearson correlation or ‘FC similarity’) are computed on all pairs; Symbols next to r values indicate the same values in panels C and D. <bold>C</bold>: FC similarity between P8 and all other days for the example mouse (left). Sigmoid fit: solid grey line; inflection point (‘transition age’, see Methods): dotted grey vertical line; linear portion of the sigmoid (‘transition time’, see Methods: two dashed grey vertical lines). Transition age (middle) and transition time (right) as a function of initial weight at P7 are plotted for all mice. <bold>D</bold>: FC similarity matrix (left) for all pairs of recording days (off diagonal), with within-session FC similarity on the diagonal for the example mouse (left) and average FC similarity across all mice for the same period (right). <bold>E</bold>: Box plots comparing within day (left) or across-day (right) FC similarity for early (≤ P11) and late (&gt; P11) developmental epochs pooled across all mice. *: statistically significant; ns: not statistically significant (Kruskall-Wallis test: p = 3.6 x 10<sup>-22</sup>; post-hoc Mann–Whitney U tests with Bonferroni correction, early within - late within: p = 3.3 x 10<sup>-3</sup>, early to early - late to late: p = n. s., early to early - early to late: p = 1.7 x 10<sup>-12</sup>, late to late - early to late: p = 4.2 x 10<sup>-5</sup>, for all possible comparisons see <xref rid="figs6" ref-type="fig">Extended Data Fig. 6K</xref>).</p></caption>
<graphic xlink:href="640367v1_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
    <p>Quantifying FC similarity across two early sessions for an example animal (P8 to P9, <xref rid="fig6" ref-type="fig">Fig. 6B</xref> top left) indicated remarkable stability, almost identical to the FC similarity within a given imaging day session which we took as a reference (computed as FC similarity between the first and second half of a same day recording, <xref rid="fig6" ref-type="fig">Fig 6B</xref>, bottom left). Conversely when comparing across more distant developmental ages, we noticed that a large part of the correlation structure was lost, resulting in lower FC similarity (P8 to P14, <xref rid="fig6" ref-type="fig">Fig. 6B</xref>, top middle). Interestingly, FC similarity between a pair of later developmental sessions, was again comparable to within-session similarity (P13 to P14 and P14 within, <xref rid="fig6" ref-type="fig">Fig. 6B</xref>, right), indicating that the functional network structure was stable, but different from that of earlier ages. Of note, within session stability was consistently lower later than earlier. Quantifying calcium event rate similarity across days indicated a similar pattern (see <xref rid="figs6" ref-type="fig">Extended Data Fig. 6F-J</xref>).</p>
<p>To investigate this further we proceeded to compute the FC similarity for all possible combinations of sessions in all mice. Interestingly we observed a sigmoid-like decay of FC similarity when taking P8 as a reference (<xref rid="fig6" ref-type="fig">Fig. 6C</xref>). Plotting the full FC similarity matrix for all possible combinations of sessions also indicated two stable FC regimes with seemingly two blocks along the diagonal (<xref rid="fig6" ref-type="fig">Fig. 6D</xref> left for example, 6D right for average and 6E for statistical comparison). Interestingly, the sharpness of the transition in FC varied across mice (<xref rid="figs6" ref-type="fig">Extended Data Fig. 6C</xref>) and could in part be explained by the weight of the mouse at the onset of the experiment (<xref rid="fig6" ref-type="fig">Fig. 6C</xref>, linear part of sigmoid fit). Such variation across mice could reflect either inherent individual differences in developmental processes or experimental factors, where mice with a lower initial weight may have experienced delayed development due to higher sensitivity to the imaging procedure.</p>
<p>Altogether, our analyses indicate that the second postnatal week marks a transition between two stable functional network structures in the barrel cortex of developing mice. Additionally, this shows how tracking cells during development opens new analysis possibilities using self-referencing between neurons, providing new insights into how the developmental choreography unfolds in the same population of neurons across days.</p>
</sec>
<sec id="s2f">
<title>Developmental emergence of stable behavioral state modulation</title>
<p>As a first attempt to investigate the mechanisms underlying this network transition, we examined neural activity in relation to behavioral state. The second postnatal week marks the emergence of active sensation, suggesting that changes in arousal state modulation might drive this network reorganization. In the adult cortex, arousal strongly shapes both global firing rates and neural correlations <sup><xref ref-type="bibr" rid="c30">30</xref>–<xref ref-type="bibr" rid="c33">33</xref></sup>, making it a promising candidate for orchestrating the developmental shift we observed.</p>
<p>To this aim, we sorted the neurons based on the similarity of their activity patterns, using Rastermap <sup><xref ref-type="bibr" rid="c34">34</xref></sup>, and examined the relationship between neuronal activity and behavioral states, indirectly measured using the videos capturing mouse movement (as in <sup><xref ref-type="bibr" rid="c30">30</xref></sup>, see Methods). Interestingly, this sorting revealed a subpopulation of neurons that were highly correlated with the animal’s motion at later, but not earlier developmental stages (<xref rid="fig5" ref-type="fig">Fig. 5A</xref>, see <xref rid="figs4" ref-type="fig">Extended Data Fig. 4A</xref> for all days). We first quantified this relationship by computing the temporal correlation between the first principal component of neuronal activity with the animal’s motion. Interestingly, this correlation showed a steep increase after P11 for most mice (<xref rid="fig7" ref-type="fig">Fig. 7D</xref>). This suggested that global fluctuations in neural activity are more strongly modulated by active movement at later than earlier developmental stages.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption><title>Regression analysis to study the development and stability of neural representations.</title>
<p><bold>A</bold>: Left: A decoding model is fitted on each day to predict a behavioural variable (y, mouse motion) from the simultaneously recorded calcium imaging data (X, activity raster). Right: The model is then tested on the same day (using cross-validation) to assess the encoding of the variable on that given day. <bold>B</bold>: Overlay of animal’s motion (grey) and the predicted signal from neural activity (green) fit on the same day for example early (P8, top) and late recordings (P14, bottom). Symbols indicate the corresponding R<sup>2</sup> values in panels C and G. Only the first 5 min of the recording are shown for visualisation purposes, for full traces of all recordings see <xref rid="figs7" ref-type="fig">Extended Data Fig. 7</xref>. <bold>C</bold>: Graphs indicating R<sup>2</sup> values for same-day cross-validated decoding performance as a function of mouse age. Green indicates the example mouse (also in D). <bold>D</bold>: Graph plotting the correlation between the animal’s motion and the first principal component signal across days (left) and a statistical comparison of the early (≤ P11) and late (&gt; P11) epochs (right). *: Mann–Whitney U test, p = 1.2 x 10<sup>-3</sup>. <bold>E</bold>: Left: Same as in A an individual model is fitted on each day. Right: To assess the stability of the representation, each model is tested across different days, which is only possible when tracking neurons across sessions. <bold>F</bold>: Same as B but for examples of cross-day decoding early to early (P9 to P8), late to late (P13 to P14) and early to late (P8 to P14). Symbols indicate the corresponding R<sup>2</sup> values in panel G. <bold>G</bold>: Full prediction performance matrix showing R<sup>2</sup> values for all combinations of fit and test datasets (rows and columns respectively) for the example mouse (left) and average across all mice for the same period (right). Diagonal entries correspond to same-day decoding, off-diagonal entries to cross-day recording. <bold>H</bold>: Box plots comparing R<sup>2</sup> values for same day (left) or across-day (right) decoding for early (≤ P11) and late (&gt; P11) developmental epochs pooled across all mice.*: statistically significant; ns: not statistically significant (Kruskall-Wallis test: p = 4.5 x 10<sup>-10</sup>; post-hoc Mann–Whitney U tests with Bonferroni correction, early within - late within: p = 1.6 x 10<sup>-3</sup>, early to early - late to late: p = 6.5 x 10<sup>-6</sup>, early to early - early to late: p = n. s., late to late - early to late: p = 2.4 x 10<sup>-5</sup>, for all possible comparisons see <xref rid="figs7" ref-type="fig">Extended Data Fig. 7I</xref>).</p></caption>
<graphic xlink:href="640367v1_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
    <p>Finally, we asked whether behavioral state could be decoded from population activity dynamics using regression analysis. Despite substantial variability, the same-day decoding performance increased with development (<xref rid="fig7" ref-type="fig">Fig. 7A-C</xref>). Since we tracked the same neurons across days, we could also probe the stability of this representation across days, by fitting a model on one day and testing it on all other days (cross-day decoding, <xref rid="fig7" ref-type="fig">Fig. 7E-H</xref>, <xref rid="figs7" ref-type="fig">Extended Data Fig. 7B and C</xref><sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c35">35</xref></sup>). Interestingly, this analysis showed that, once developed, this representation was indeed stable, allowing for accurate cross-day decoding, with the same neurons showing either consistently positive or negative modulation across days (see <xref rid="figs7" ref-type="fig">Extended Data Fig. 7D</xref> for the activity traces of an example cell with a high weight for decoding).</p>
<p>Hence, by combining Track2p longitudinal cell tracking with decoding approaches, one can systematically map the emergence and stability of cortical representations in the developing brain.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Here we described Track2P, a cell tracking algorithm that can be used to follow the changing dynamics of hundreds of matched neurons from daily calcium imaging recordings in the growing brain of living mouse pups. At the core of the method lies sequential affine registration followed by cell matching for each subsequent pair of recordings, which lead to a better tracking performance during development when using Track2p compared to other methods. Using this benchmarked approach, we observed a sharp developmental transition from highly synchronized activity to multidimensional, behavior-state dependent neural dynamics. Beyond this key finding, our method opens a much needed tool for investigating the developmental functional trajectories of individual neurons during early postnatal brain development, and their deviations caused by genetic mutations or environmental perturbations.</p>
<p>Developing and benchmarking Track2p showed that it is able to track large populations of neurons despite substantial brain growth and other developmental changes through extended periods of time during development. We suggest this is mostly due to affine transform being a good approximation of the growth processes that occur between two consecutive days of imaging, with the cell matching step allowing to account for slight non- linearities in tissue growth day-by-day. Currently available methods typically register all imaging FOVs to a single reference, which we believe result in the accumulation of non- linearities making registration more difficult and resulting in poorer tracking performance.</p>
<p>From a practical perspective, Track2p reduces manual cell tracking time by transforming a tedious process of manual annotation into a fast and automated procedure. Indeed, considering the time needed for manually tracking all cells in our dataset, we estimate that it would require approximately 5 person-days (120 hours) of work per subject under our experimental conditions, highlighting the necessity of automatic tracking in large scale calcium imaging recordings. To aid future research, we provide Track2p fully open-source, with substantial documentation and an accompanying GUI facilitating the use of the algorithm by users without previous coding knowledge.</p>
<p>Besides developing the algorithm, we also showcase analysis techniques that can be used to gain unique insights from longitudinal calcium recordings, drawing inspiration from previous research studying plasticity, learning and representational drift in the adult brain <sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c35">35</xref>,<xref ref-type="bibr" rid="c36">36</xref></sup>. We specifically highlight: 1) quantifications of functional statistics of the tracked population across days (<xref rid="fig4" ref-type="fig">Fig 4</xref>); 2) correlation analyses to compare these across days (<xref rid="fig5" ref-type="fig">Fig 5</xref>); 3) regression analyses to study the emergence and stability of neural representations across recording days (<xref rid="fig6" ref-type="fig">Fig 6</xref>).</p>
<p>Last, we would like to emphasize that this analytical advancement is grounded on optimized experimental procedures to image daily cortical dynamics through a glass window mounted on the developing pup head. Previous studies had described adaptations of the surgical procedure or head fixation to developing pups <sup><xref ref-type="bibr" rid="c8">8</xref></sup>, however, by measuring the increase in pairwise distance between tracked neurons as a function of age per animal, we now provide a quantitative metric to estimate the invasiveness of the procedure. Interestingly, we observed a growth rate that closely matched <italic>ex vivo</italic> quantifications <sup><xref ref-type="bibr" rid="c18">18</xref></sup>, indicating a minimal impact of our experimental preparation on anatomical brain growth, also confirmed by mouse weight measurements. While we observed a slightly slower weight gain in imaged pups compared to their littermates, further investigation is needed to definitively assess whether repetitive daily imaging might influence cognitive developmental trajectories, for example through maternal separation.</p>
<p>Applying these techniques in our dataset during early postnatal development, we observed a significant and fast change in the nature of neuronal dynamics and state modulation in the barrel cortex, centered on P11, that manifests in several ways: (1) an increase in activity rates; (2) a decrease in pairwise correlations; (3) a shift from locally clustered to widely distributed correlations; (4) an increase in the dimensionality of spontaneous activity; (5) a remapping of the functional pairwise correlation structure; (6) the emergence of a stable representation of spontaneous active movement.</p>
<p>If the first three changes had already been described previously in different cortical areas <sup><xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c27">27</xref>,<xref ref-type="bibr" rid="c29">29</xref>,<xref ref-type="bibr" rid="c37">37</xref>–<xref ref-type="bibr" rid="c40">40</xref></sup>, the last two could not be observed without the dense longitudinal tracking of the same neurons across several days in the growing brain permitted by Track2P. This multifaceted transition likely reflects several concurrent developmental processes, including changes in sleep architecture and neuromodulatory tone <sup><xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c41">41</xref>–<xref ref-type="bibr" rid="c43">43</xref></sup>, maturation and rewiring of local inhibitory circuits <sup><xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c37">37</xref>,<xref ref-type="bibr" rid="c40">40</xref>,<xref ref-type="bibr" rid="c44">44</xref>–<xref ref-type="bibr" rid="c47">47</xref></sup> or disengagement from peripheral sensory inputs <sup><xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c48">48</xref></sup>. This postnatal spurt is correlated with sparsification, disappearance of the spindle-burst oscillations and increase in dimensionality of the representations <sup><xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c27">27</xref>,<xref ref-type="bibr" rid="c29">29</xref>,<xref ref-type="bibr" rid="c37">37</xref>,<xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c49">49</xref>–<xref ref-type="bibr" rid="c52">52</xref></sup>. Such drastic and fast changes are accompanied by significant behavioral changes, maybe the most salient ones being the change in the nature and duration of sleep as well as the start of active exploration<sup><xref ref-type="bibr" rid="c53">53</xref></sup>. The start of behavioural state-modulation and dimensionality increase could reflect the same phenomenon by which spontaneous motor behavior, including facial movements, drives multidimensional brainwide activity in the adult visual cortex <sup><xref ref-type="bibr" rid="c30">30</xref></sup>. This representation is present and stable from P11 onwards, as revealed using our decoding approach. The early absence of representation of spontaneous motor behavior is in agreement with the previously reported lack of reafferent brain activity in response to self-generated wake movement until P11 <sup><xref ref-type="bibr" rid="c54">54</xref>–<xref ref-type="bibr" rid="c56">56</xref></sup>. Thus, although we did not distinguish here between sleep and wake-generated movements, it is likely that our decoding mostly took into account wake behavior, given the long periods of motor activity observed. Hence, we cannot exclude that twitching activity occurring during active sleep could contribute to an earlier representation of spontaneous motion, as reported previously <sup><xref ref-type="bibr" rid="c57">57</xref></sup>. More refined behavioral analysis, particularly of sleep-wake transitions and twitches, could provide additional insights.</p>
<p>Therefore, the mid-second postnatal week marks a transition between two stable functional connectivity structures, indicating that globally, early and late functional connectivities differ. However, singular developmental trajectories cannot be excluded. Future studies could examine whether different cell types transition at different times or different paces, for example depending on their time of birth <sup><xref ref-type="bibr" rid="c1">1</xref></sup>, or whether unique neurons, such as hub cells, could maintain exceptional and stable functional connectivity <sup><xref ref-type="bibr" rid="c6">6</xref></sup>. One population of particular interest for tracking are the neurons that contribute the most to behavioral prediction. Indeed, these could form a distinct population of movement-correlated neurons embedded in specific wiring schemes, as recently demonstrated <sup><xref ref-type="bibr" rid="c58">58</xref></sup>.</p>
<p>This developmental transition centered around P11, which corresponds roughly to birth in human brain development, spans a period between one and four days, depending on the initial weight of the imaged pup. This transition may not yet be the last step before a mature adult-like network but instead represent a transient state <sup><xref ref-type="bibr" rid="c59">59</xref></sup> preceding the emergence of mature activity patterns. Its timing, correlated with animal weight, suggests it may represent a conserved developmental milestone. Hence, comparative studies across brain regions and species, including potential parallels in human development, would be valuable.</p>
<p>We believe that combining Track2p tracking and the analysis methods described here provides a template for future investigations of more complex developmental phenomena, such as the emergence of sensory representations and cognitive functions. Also, longitudinal imaging uniquely enables investigation of activity-dependent development, including how early activity patterns predict later functional properties and assembly formation of the same cells. Indeed, there is nothing precluding further studies to continue tracking the activity of the same cells until adulthood. Additionally, this approach opens possibilities for targeted manipulation studies to examine how early perturbations affect subsequent circuit development. The ability to track the same cells throughout early postnatal development should thus open doors to entirely new classes of experiments not possible before, providing deeper mechanistic insights into developmental principles and pathologies. This is even more important considering that alterations of developmental trajectories at early postnatal time points are starting to be pointed out as the roots for many developmental disorders <sup><xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c60">60</xref></sup>.</p>
</sec>
<sec id="s4" sec-type="data-availability">
<title>Data and code availability</title>
<p>All Track2p code (algorithm and GUI) is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/juremaj/track2p">https://github.com/juremaj/track2p</ext-link>, with more extensive documentation and demos available at: <ext-link ext-link-type="uri" xlink:href="https://track2p.github.io/home.html">https://track2p.github.io/home.html</ext-link>. The code used for running downstream analyses and the data used in this study will be made available upon publication.</p>
</sec>
</body>
<back>
<sec id="s5">
<title>Methods</title>
<sec id="s5a">
<title>Data acquisition</title>
<sec id="s5a1">
<title>Animals</title>
<p>All experimental procedures were approved by the French ethics committee (Ministère de l’Enseignement Supérieur, de la Recherche et de l’Innovation (MESRI); Comité d’éthique CEEA-014; APAFiS # 30716-2021032215171216 v8 ) and conducted in agreement with the European Council Directive 86/609/EEC. GAD67-Cre mice were kindly donated by Dr. Hannah Monyer (Heidelberg University). Mice were bred and stored in an animal facility with room temperature (RT) and relative humidity maintained at 22 ± 1°C and 50 ± 20%, respectively. Mice were provided <italic>ad libitum</italic> access to water and food. A total of 6 mice were used in the study, all heterozygous GAD67-Cre transgenics.</p>
</sec>
</sec>
<sec id="s5b">
<title>Virus injections</title>
<p>We performed viral injections at P0 as previously described <sup><xref ref-type="bibr" rid="c61">61</xref></sup>. Briefly, we prepared a solution of AAV-hSyn-GCaMP8m and AAV-FLEX-tdTomato (2:1 volumetric ratio, 10<sup>12</sup> genome copies per millilitre; Addgene) with a small volume (10:1) of 0.05% trypan blue (T8154 Sigma) to verify the success of the injection. We then briefly anaesthetised the mouse on ice and injected 2μL of the solution in the right lateral ventricle using a glass micropipette. Pups were left to recover on a heating pad at 37°C before being returned to the dam.</p>
</sec>
<sec id="s5c">
<title>Cranial window surgery</title>
<p>All procedures were performed as in <sup><xref ref-type="bibr" rid="c6">6</xref></sup>. Surgeries were performed at P7 for all mice. Briefly, betadine and lidocaine cream were applied topically, covering the area of the intended incision. Isoflurane was used for induction of global anaesthesia and maintained via a nose cone throughout the procedure. A heating pad was used to maintain body temperature. After skin removal a head plate (4mm inner diameter, Luigs and Neumann) was fixed to the part of the skull covering the barrel cortex using glue (SuperGlue3) and Super Bond (DSM Dentaire). A craniotomy was performed within the head plate opening before finally applying a thin layer of Kwik-Sil (WPI) to the surface of the dura and covering it with a glass cover-slip (3mm, Warner Instruments). The cover-slip was last fixed to the headplate and the skull again using glue and Super Bond. Mice were left to recover on a heating pad at 37°C for at least 1 hour before returning them to the home cage.</p>
</sec>
<sec id="s5d">
<title>Chronic 2-photon calcium imaging</title>
<p>Longitudinal two-photon calcium imaging was performed for each mouse for at least 6 consecutive days (see <xref rid="fig5" ref-type="fig">Fig. 5</xref> for details). Imaging was performed using a Bruker (Ultima 2P) microscope with a Coherent Mai-Tai excitation laser (950 nm excitation light) and a 16x Nikon objective (NA 0.8). Before detection, emitted light was split into two optical paths each associated with a filter (red and green, 580-620 and 500-550 nm respectively), allowing us to simultaneously record the GCaMP8m and the tdTomato signal. The acquisition was performed using the Prairie view software. All recordings were performed in layer 2/3 (depth between 100-200 µm from the pial surface) with a 720 x 720 µm field of view and 512 x 512 pixel resolution. Imaging rate was 30 Hz (resonant scanner) and each session lasted 20 minutes. All experiments were performed in the dark, under sensory-minimised conditions, with mice being free to spontaneously run on a non-motorised treadmill (Luigs and Neumann). To facilitate alignment and cell tracking, we kept the alignment of the head mount with respect to the microscope fixed across all sessions for the same mouse. To record from the same region across days we manually aligned the imaging plane in x, y and z to best match the reference images of the red channel (tdTomato) from all previous recording days. During the course of each recording, pups were kept warm by a heating element mounted to the imaging setup. After each imaging session, the pups were returned to their home cage with the dam and their littermates.</p>
</sec>
<sec id="s5e">
<title>Videography</title>
<p>All videography was performed using a Basler camera (Basler ACE2 1920), with an infrared LED light source (ThorLabs 850 nm) pointed at the mouse. Videos were recorded at 30 Hz, with the microscope acquisition acting as a trigger for camera frame acquisition, also allowing for simple synchronisation across the two modalities. All acquisition was done using custom python scripts using the PyPylon wrapper for the Basler camera software (Pylon Camera Software Suite, <ext-link ext-link-type="uri" xlink:href="https://github.com/basler/pypylon">https://github.com/basler/pypylon</ext-link>).</p>
</sec>
<sec id="s5f">
<title>Processing of calcium imaging data</title>
<p>Calcium imaging data was preprocessed using the Suite2p pipeline, sequentially performing motion correction, ROI detection, signal extraction and spike deconvolution <sup><xref ref-type="bibr" rid="c23">23</xref></sup> for each recording separately. Suite2p additionally provides a cell classification feature, providing a probability of a classifier categorising an ROI as being a true cell. We considered all ROIs above the default threshold of 0.5 as true cells. We used baseline corrected fluorescence traces as our dF/F (using the default Suite2p parameters) for all subsequent analyses.</p>
</sec>
<sec id="s5g">
<title>Preprocessing videography</title>
<p>We used the global movements of the mouse as a proxy of its arousal state. Similarly as in <sup><xref ref-type="bibr" rid="c62">62</xref></sup> we quantified these by looking at the pixel-wise difference of consecutive frames in the videography recording, by squaring this difference and summing the values across all pixels. This yielded a scalar value quantifying the motion of the mouse at each time point, which was used for all subsequent analyses.</p>
</sec>
<sec id="s5h">
<title>Cell tracking</title>
<sec id="s5h1">
<title>Image and ROI registration</title>
<p>As explained in the main text, Track2p aligns the ROIs based on mean FOV image registration. The implementation allows the user to choose which channel to use for computing the transformation (‘anatomical’ or ‘functional’ channel), as well as which types of transformation to estimate (rigid or affine). Unless otherwise stated, we used the ‘anatomical’ (tdTomato in GAD67-Cre expressing cells) channel with affine transformation (referred to as the ‘baseline’ condition). For the purposes of evaluation we additionally ran tracking using the functional channel with affine registration (‘functional’ in <xref rid="fig4" ref-type="fig">Fig.4</xref>) and using the anatomical channel with rigid registration (‘rigid’ in <xref rid="fig4" ref-type="fig">Fig.4</xref>). Once registering the images, we applied the same transform to all ROIs from the subsequent session that were considered as cells (see main text). All Track2p image registration is done using the itk-elastix toolbox <sup><xref ref-type="bibr" rid="c63">63</xref></sup>.</p>
</sec>
<sec id="s5h2">
<title>Cell matching</title>
<p>Cell matching was done in a way to maximise the sum of the intersection over union (IoU) across all matches of ROIs between two sessions. For this reason we defined a cost matrix M with entries corresponding to:
<disp-formula>
<graphic xlink:href="640367v1_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Where r<sub>s_k, i</sub> is the i-th ROI in session s<sub>k</sub> and r’<sub>s_(k+1), j</sub> is the j-th ROI in the subsequent session s<sub>k+1</sub> after registering it to the coordinate system of s<sub>k</sub>. Assigning matches between the two sets of ROIs in this way corresponds to a linear sum assignment problem, with the goal to find a matrix X that yields the optimal assignment cost:
<disp-formula>
<graphic xlink:href="640367v1_ueqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Where X<sub>i,j</sub> equals 1 if and only if ROI r<sub>s,i</sub> is assigned to r<sub>s+1,i</sub> and 0 otherwise. Additionally, since the number of ROIs is not necessarily the same across two sessions, M and X are not necessarily square. In this case, if there are more rows than columns, then not every row needs to be assigned to a column, and vice versa. We solve this problem by using the algorithm described in <sup><xref ref-type="bibr" rid="c64">64</xref></sup> and implemented in SciPy.</p>
<p>Additionally, some of the matches can be putative false positives. To avoid this issue, we use an approach similar to the one described in <sup><xref ref-type="bibr" rid="c21">21</xref></sup>, using a statistical threshold to filter matches based on their IoU distribution. To do this we use the Skimage implementation of Otsu’s method applied to the IoU histogram <sup><xref ref-type="bibr" rid="c24">24</xref></sup>.</p>
</sec>
</sec>
<sec id="s5i">
<title>Generating a ground truth dataset</title>
<p>Since manually tracking all cells would require prohibitive amounts of time (see Discussion), we decided to generate sparse manual annotations, only tracking a subset of all cells from the first recording day onwards. To do this, we took the first recording (s<sub>0</sub>), and we defined a grid of 8 x 8 (64) equidistant points over the FOV and, for each point, identified the closest ROI in terms of euclidean distance from the median pixel of the ROI (see <xref rid="figs3" ref-type="fig">Extended Data Fig. 3A</xref>). We then manually tracked these 64 ROIs across subsequent days. The manual tracking was done using the Suite2p GUI, by visualising the FOV and masks from two recordings side by side and choosing the matching ROI from the subsequent recording or terminating the track if we could not find a match (see <xref rid="figs3" ref-type="fig">Extended Data Fig. 3B</xref>). Only neurons that were detected and tracked across all sessions were taken into account and referred to as our ground truth dataset (‘GT’ in <xref rid="fig4" ref-type="fig">Fig. 4</xref>). When comparing the GT to Track2p tracks, we only considered Track2p tracks that originated from one of the 64 ROIs chosen for evaluation initially. All manual tracking was performed blind to the Track2p outputs.</p>
</sec>
<sec id="s5j">
<title>Tracking evaluation metrics</title>
<p>For the evaluation of Track2p under different conditions and comparison to CellReg, we used the ‘Complete tracks’ metric (<sup><xref ref-type="bibr" rid="c20">20</xref>,<xref ref-type="bibr" rid="c25">25</xref></sup>, <xref rid="fig3" ref-type="fig">Fig. 3B</xref>), defined as:
<disp-formula>
<graphic xlink:href="640367v1_ueqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Where T<sub>rc</sub> is the number of perfectly reconstructed tracks, T<sub>c</sub> is the number of total tracks identified by Track2p for the 64 s<sub>0</sub> ROIs chosen for manual tracking and T<sub>gt</sub> is the number of total tracks in the ground truth dataset (from the same 64 s<sub>0</sub> ROIs). In the case of perfect tracking, CT will be equal to 1 (where all computed tracks are equivalent to the ground truth tracks (T<sub>rc</sub>=T<sub>c</sub>=T<sub>gt</sub>)). Conversely, in the case of failed tracking, the value of CT will be close to 0 (for example when there is a poor match between ground truth and reconstructed tracks (T<sub>rc</sub>≈0) or when there are many falsely reconstructed tracks not present in the ground truth (T<sub>c</sub>&gt;&gt;T<sub>gt</sub>)). The CT metric is mathematically equivalent to an F1 score where true positives are defined as perfectly reconstructed tracks (<xref rid="fig4" ref-type="fig">Fig. 4A</xref> row 1), false negatives as tracks from GT without a match in Track2p (<xref rid="fig4" ref-type="fig">Fig. 4A</xref> row 2) and false positives as tracks from Track2p without a match in GT (<xref rid="fig4" ref-type="fig">Fig. 4A</xref> rows 3, 4 and 5).</p>
<p>In the final step of evaluation we looked at when the algorithms from the original evaluation failed in their tracking of the ground truth neurons. For this we used a metric of the proportion of correctly reconstructed tracks for an increasingly longer number of sessions (s) (referred to as ‘Prop. correct’ in <xref rid="fig4" ref-type="fig">Fig 4C-F</xref>):
<disp-formula>
<graphic xlink:href="640367v1_ueqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Where T<sub>gt</sub> is equivalent as above and T<sub>rc</sub>(s) is equivalent as T<sub>rc</sub> but for full tracks up to session s. Since in this case we kept the GT consistent with the initial evaluation, including only the neurons identified across all days, this metric is agnostic to possible false positives at shorter time epochs.</p>
<p>To facilitate evaluation by individual users under different experimental conditions, we provide a helper script (Jupyter notebook) aiding the whole evaluation process by both defining a grid of cells to manually track (see previous section), as well as to compute the tracking quality metrics once the ground truth dataset is completed.</p>
</sec>
<sec id="s5k">
<title>CellReg Tracking</title>
<p>To compare Track2p with CellReg, we ran the MATLAB implementation of CellReg tracking (<ext-link ext-link-type="uri" xlink:href="https://github.com/zivlab/CellReg">https://github.com/zivlab/CellReg</ext-link>) according to the provided user manual. We first attempted tracking using the default rigid registration, which yielded an error, terminating the algorithm and indicating that subsequent sessions do not resemble the reference session and suggesting to use non-rigid registration. We then re-launched the algorithm with non-rigid registration and used those results to evaluate the tracking the same way as for Track2p (see Results). Notably, even when running CellReg using non-rigid registration, we noticed that the algorithm did not find any tracks spanning all days (T<sub>rc</sub> = 0), which explains the CT score of 0 for all day evaluation.</p>
</sec>
<sec id="s5l">
<title>Functional properties of tracked neurons</title>
<sec id="s5l1">
<title>Calcium event rates</title>
<p>To quantify the calcium event rate statistics we used SciPy’s peak detection algorithm (Python). For this we first denoised the traces slightly by averaging using a bin size of 10 frames and then proceeded to detect any peaks with a height and prominence of at least one standard deviation. We then calculated the rate as the number of peaks per minute within the recording. When quantifying the stability of the rates across days we computed the Pearson correlation coefficient across all neurons for each possible combination of sessions recorded from the same mouse.</p>
</sec>
<sec id="s5l2">
<title>Pairwise correlations and PCA</title>
<p>We quantified pairwise correlations by computing the Pearson correlation between the full traces of all pairs of simultaneously recorded neurons within each session. To quantify the spatial properties of pairwise correlations, we additionally calculated the euclidean distance between ROI centroids for each corresponding pair of neurons. When plotting the pairwise correlations as a function of pairwise distance we averaged in bins of 30 µm. The correlation of neighbouring neurons was estimated as the intercept of an exponential fit to the full data.</p>
<p>When comparing the stability of the correlation structure across days, we refer to this as ‘FC stability’, which we calculate as the Pearson correlation between all pairs of original correlation matrices for a given mouse. When fitting a sigmoid using the first day as the reference, we fix the upper limit of the sigmoid to within-day FC stability for that day and leave the other parameters free. We calculate the inflection point (‘transition age’) and the linear portion (‘transition time’) of the sigmoid using the extrema of the first and fourth derivatives respectively.</p>
<p>For principal component analysis (PCA) we used the scikit-learn implementation (Python).</p>
</sec>
</sec>
<sec id="s5m">
<title>Decoding</title>
<p>All decoding was done using linear regression with ridge regularisation (ridge regression) to avoid overfitting given the large number of neurons. Ridge regression optimises the weights (β) that minimise the following loss function:
<disp-formula>
<graphic xlink:href="640367v1_ueqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Where in our case y is behavioural data, X is neural data and λ is a regularisation parameter. To choose the optimal λ and to reliably estimate the model performance on same-day decoding we used nested cross-validation (see for example <sup><xref ref-type="bibr" rid="c65">65</xref>,<xref ref-type="bibr" rid="c66">66</xref></sup>), ensuring data efficiency and a splitting between training, validation and test data. Briefly, a grid search for the optimal λ is performed by using the train set to fit models with different λ values and choosing the value corresponding to the model with the best performance on the held out validation set (model selection). This model is then evaluated on the test data that was used neither in model fitting nor in the hyperparameter optimization (model evaluation). To ensure data efficiency, nested cross-validation repeats this procedure for all possible splits of the data, with an outer cross-validation loop used for model evaluation and an inner loop for model selection. We used 5 fold splits for both the inner and outer loops, splits were done on consecutive 2 minute blocks of the recording. For cross-day decoding we fit a new model with the optimal lambda for that given day and evaluated it on all other days. For all decoding analysis we slightly denoised the dF/F as well as the behaviour traces by averaging in bins of 10 consecutive timestamps. All models were implemented and fitted using PyTorch (Python).</p>
</sec>
</sec>
<sec id="s6">
<title>Extended Data Figures</title>
<fig id="figs1" position="float" orientation="portrait" fig-type="figure">
<label>Extended Data Figure 1.</label>
<caption><title>Overview of the graphical user interface for interactive visualisation and curation of tracked cells.</title><p><bold>A</bold>. The menu bar allows the users to run the Track2p algorithm (under ‘Run’), import the results of a previous run (under ‘File’) or to visualise population activity (under ‘Visualisation’; opens the raster window in F) <bold>B.</bold> The interface displays the mean image for each day of the recording (the channel can be chosen by the user), with ROIs of the cells tracked across all days overlaid. This plot allows the user to select which cell to visualise across days. This visualisation corresponds to <xref rid="fig3" ref-type="fig">Fig. 3D</xref>. <bold>C.</bold> Once a cell is selected this section provides a high magnification image of the FOV for all days. Underneath each high magnification image the Suite2p index on that day (i) and the Suite2p cell probability (p) are displayed. This visualisation corresponds to <xref rid="fig2" ref-type="fig">Fig. 2E</xref>. <bold>D.</bold> The activity traces are presented in order from the first (top) to the last (bottom) session of the tracking. (The type of traces can be chosen by the user). <bold>E.</bold> Curation bar on the bottom of the window allows browsing all tracked cells to perform the manual curation. If a track is considered faulty during the manual inspection, its state can be set to zero (by clicking on the cross). (The ‘Apply curation’ is used to update the FOV visualisations by coloring all contours of tracks assigned as bad in white.) <bold>F</bold>. Raster visualisation window allows the users to visualise the time series of the whole population and sorting the rasters to show population level features and their stability across days.</p></caption>
<graphic xlink:href="640367v1_figs1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs2" position="float" orientation="portrait" fig-type="figure">
<label>Extended Data Figure 2.</label>
<caption><title>Track2p outputs across all days for the example mouse.</title>
<p><bold>A</bold>. Top: Mean FOV of the sparse anatomical marker (tdTomato) expressed in GABAergic neurons for all days. Middle: Overlay of two neighbouring days before registration. Red: reference image, green: moving image. Bottom: Overlay after registration. <bold>B</bold>. Histogram of IoU values for all assigned ROI matches in each pair of subsequent recordings. Statistical threshold for filtering matches is shown with a dashed line. <bold>C</bold>. Overlay of all ROIs successfully tracked across all days on the mean FOV image of the GCaMP8m channel for all imaging days. Each tracked ROI is shown with the same contour color across all days.</p></caption>
<graphic xlink:href="640367v1_figs2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs3" position="float" orientation="portrait" fig-type="figure">
<label>Extended Data Figure 3.</label>
<caption><title>Generating a ground truth dataset for Track2p evaluation.</title>
<p><bold>A</bold>: Overlay of ROIs selected for manual tracking on top of the mean image of the GCaMP8m channel on the first day of the recording for all three datasets used in the evaluation. Blue crosses indicate an 8x8 grid of equidistant points used to select ROIs for manual tracking. Contours are denoting the closest ROI to each of the points from the grid, with the number denoting the index of this ROI in the first dataset. Green ROIs denote ROIs that were manually tracked across all days, orange shows those that could not be manually tracked in at least one of the sessions. Note that green cells show a relatively homogenous distribution across the FOV. <bold>B</bold>. Example showing the manual tracking procedure. Left: A ROI chosen for manual tracking (index 141, green circle) visualised in the Suite2p GUI on the first day of recording (P8). Right: The same ROI identified manually on the next day (purple circle). Surrounding contours denote other surrounding ROIs detected on that imaging day.</p></caption>
<graphic xlink:href="640367v1_figs3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs4" position="float" orientation="portrait" fig-type="figure">
<label>Extended Data Figure 4.</label>
<caption><title>Activity of tracked cells across all days for the example mouse.</title><p><bold>A</bold>. Raster plots and simultaneously recorded mouse movements (blue traces) for all tracked neurons on each subsequent day from P8 (top) to P14 (bottom) for the example mouse (related to <xref rid="fig4" ref-type="fig">Fig. 4A</xref>). <bold>B</bold>. Representative example dF/F traces of individual tracked neurons, with the trace of each neuron displayed in the same color across days. Neurons were chosen in equal increments along the rows of the corresponding raster plots in A.</p></caption>
<graphic xlink:href="640367v1_figs4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs5" position="float" orientation="portrait" fig-type="figure">
<label>Extended Data Figure 5.</label>
<caption><title>Development of neuronal activity statistics in the tracked population of neurons for the full dataset.</title>
<p><bold>A</bold>. Distributions of calcium event rates (related to <xref rid="fig5" ref-type="fig">Fig. 5D</xref>). <bold>B</bold>. Distributions of pairwise correlations (related to <xref rid="fig5" ref-type="fig">Fig. 5E</xref>). <bold>C</bold>. Pairwise correlations as a function of distance (related to <xref rid="fig5" ref-type="fig">Fig. 5F</xref>). <bold>D</bold>. Cumulative proportion of total variance explained by PCA (related to <xref rid="fig5" ref-type="fig">Fig. 5G</xref>). <bold>E</bold>: Relationship between the initial weight of each mouse and its brain growth estimated as the slope of the line of pairwise cell distances (<xref rid="fig5" ref-type="fig">Fig. 5C</xref>). <bold>F</bold>: Statistical comparison of mouse weight (left) and normalised mean distance between cells (right) between the two developmental epochs (related to <xref rid="fig5" ref-type="fig">Fig. 5C</xref>). <bold>G</bold>: Standard deviation of the calcium fluorescence event rates population of tracked neurons across days for all mice (left) and a statistical comparison between the early and late epochs (right) (related to <xref rid="fig5" ref-type="fig">Fig. 5D</xref>). <bold>H</bold>: Same as G but for pairwise correlations (related to <xref rid="fig5" ref-type="fig">Fig. 5E</xref>).</p></caption>
<graphic xlink:href="640367v1_figs5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs6" position="float" orientation="portrait" fig-type="figure">
<label>Extended Data Figure 6.</label>
<caption><title>Stability of neural activity statistics for all mice in the dataset.</title>
<p><bold>A</bold>: Scatter plots of FC values for all combinations of recordings for the example mouse (related to <xref rid="fig5" ref-type="fig">Fig. 5B</xref>). <bold>B</bold>. FC stability matrices for all mice in the dataset. Asterisk denotes the example mouse (related to <xref rid="fig5" ref-type="fig">Fig. 5D</xref>). <bold>C</bold>. Mean FC stability matrix averaged across all mice in the dataset. <bold>D</bold>. Box plots of the distribution of individual FC stability values in different conditions pooled across mice (same as <xref rid="fig5" ref-type="fig">Fig. 5E</xref>). <bold>E</bold>. Statistical significance of pairwise comparisons of data from D. <bold>F-J</bold>: Same as A-E but for stability of calcium event rates. <bold>K</bold>: P values for all statistical comparisons between FC stability of different developmental epochs (related D and E in this figure and <xref rid="fig6" ref-type="fig">Fig 6E</xref>). <bold>L</bold>: Same as K but for calcium event rate stability.</p></caption>
<graphic xlink:href="640367v1_figs6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs7" position="float" orientation="portrait" fig-type="figure">
<label>Extended Data Figure 7.</label>
<caption><title>Relationship between spontaneous behaviour and neural activity for all mice in the dataset.</title>
    <p><bold>A</bold>. Cross-validated same day prediction for all recording days in the example mouse (related to <xref rid="fig6" ref-type="fig">Fig. 6B and C</xref>). <bold>B</bold>: Prediction of a decoder fit on P14 across all days (related to <xref rid="fig6" ref-type="fig">Fig. 6F and G</xref>). <bold>C</bold>. Prediction of a decoder fit on P8 across all days (related to <xref rid="fig6" ref-type="fig">Fig. 6F and G</xref>). <bold>D</bold>. Example dF/F trace of a highly predictive neuron for a model fit at P14. Notice that the activity closely corresponds to the movement trace also on two earlier days (P12 and P13). <bold>E</bold>. Full matrices of R<sup>2</sup> values for all combinations of train and test recordings in each mouse. Example mouse (*). <bold>F</bold>. Mean R<sup>2</sup> matrix averaged across all mice in the dataset. <bold>G</bold>. Box plots of the distribution of individual R<sup>2</sup> values in different conditions pooled across mice (same as <xref rid="fig5" ref-type="fig">Fig. 5E</xref>). <bold>H</bold>. Statistical significance of pairwise comparisons of data from G. <bold>I</bold>: P values for all statistical comparisons of decoder performance for all comparisons (related D and E in this figure and <xref rid="fig7" ref-type="fig">Fig. 7H</xref>).</p></caption>
<graphic xlink:href="640367v1_figs7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s8">
<title>Supplementary Information: Software</title>
<sec id="s8a">
<title>Interactive visualisation and curation using the Track2p GUI</title>
<p>To facilitate the ease of as well as to visually evaluate and curate the quality of Track2p tracking, we’ve designed an intuitive graphical interface (GUI) that makes it easy for users to launch the Track2p algorithm and interact with the outputs. Track2p GUI allows the users to perform cell tracking as well as generate some preliminary visualisations of cell activity without requiring any programming skills on behalf of the user (<xref rid="figs1" ref-type="fig">Extended Data Fig. 1A</xref>). Additionally, we’ve made the algorithm and the GUI simply installable via pip, and provide plenty of documentation on the project’s website: <ext-link ext-link-type="uri" xlink:href="https://track2p.github.io/">https://track2p.github.io/</ext-link>.</p>
<p>Track2p provides several data visualisation functionalities. Firstly, while running the algorithm, a set of figures is generated that can be used to monitor the progress at each consecutive step, as well as to provide a visual overview of tracking quality, for example based on a visual assessment of registration quality, IoU histograms or zoomed-in images of example tracked cells. The GUI itself provides an interactive view of the FOV overlaid with ROIs tracked across all days (<xref rid="figs1" ref-type="fig">Extended Data Fig. 1B</xref>, similar to <xref rid="fig3" ref-type="fig">Fig. 3D</xref>). The user can then select a cell from this window that is then displayed in a zoomed in view across all days (<xref rid="figs1" ref-type="fig">Extended Fig. 1B</xref>, similar to <xref rid="fig3" ref-type="fig">Fig. 3C</xref>). The visualised cell can be selected interactively by selecting it from contours displayed over the whole FOV. Based on these visualisations, users can also assess the tracking performance and, if necessary, manually curate the results by manually identifying cases of incorrect tracking (<xref rid="figs1" ref-type="fig">Extended Fig. 1E</xref>). Under conditions shown in this paper manual curation should not be strictly necessary (see <xref rid="fig4" ref-type="fig">Fig. 4</xref> for evaluation without manual curation), however this will depend greatly on the particularities of the dataset used.</p>
<p>Additionally, the GUI also provides activity visualisation, plotting the activity time series of the selected ROI for each recording (<xref rid="figs1" ref-type="fig">Extended Fig. 1C</xref>, similar to <xref rid="figs4" ref-type="fig">Extended Data Fig. 4B</xref>), while also offering the visualisation of the activity of the whole population across all days by generating raster plots of neuronal activity (<xref rid="figs1" ref-type="fig">Extended Fig. 1F</xref>, similar to <xref rid="fig5" ref-type="fig">Fig. 5A</xref> and <xref rid="figs4" ref-type="fig">Extended Data Fig. 4A</xref>). These visualisations can allow the user to visually inspect changes to activity statistics at the single cell level as well as changes to population level phenomena such as synchronisation (assemblies) and sequences at the level of all tracked neurons. Raster sorting capabilities can also give a visual insight into the stability of these phenomena across recordings. Currently the user can choose between PCA (Principal Component Analysis) or t-SNE (t-distributed Stochastic Neighbor Embedding) techniques to re-sort the rows of the raster based on dimensionality reduction. These methods aim to sort cells with similar fluorescence traces in adjacent rows of the raster plot, visualizing co-varying activity patterns at the population level. Additionally, the user can choose between individual sorting and sorting that is preserved across days. Individual sorting better shows these population phenomena for each specific day, however in this case the correspondence between the cells across days is lost due to independent sorting. On the other hand, across-day sorting allows the user to focus on one day to visualize the stability of these population phenomena and see if they are preserved across other days, since the sorting of the neurons remains consistent across sessions.</p>
</sec>
</sec>
<ack>
<title>Acknowledgements</title>
<p>We thank all the members of the Cossart lab for helpful discussions and constructive feedback. We thank Drs. Lorenzo Fontolan and Michel Picardo for critical feedback on the manuscript. We thank INMED’s animal facility and PBMC technological platform for excellent technical support. This work was supported by the European Research Council under the European Union’s Horizon 2020 research and innovation program (grant agreement no. 951330), by the Fondation Bettencourt Schueller and the Fondation Roger de Spoelberch; R.C. is supported by CNRS. J-C. P. is supported by INSERM. The project leading to this publication has received funding from the French government under the “France 2030” investment plan managed by the French National Research Agency (reference : ANR-16-CONV000X / ANR-17-EURE-0029) and from Excellence Initiative of Aix-Marseille University - A*MIDEX (AMX-19-IET-004).</p>
</ack>
    <sec id="supp" sec-type="supplementary-material">
        <title>Additional files</title>
        <supplementary-material id="supp1">
            <label>Supplementary Video 1</label>
<caption><title>Example of videography and 2-photon calcium imaging data acquired throughout the second postnatal week.</title>
<p>Note the substantial growth of the mouse, the development of the whisker pad and opening of the eyes; and the loss of synchrony and spatial organisation in the calcium imaging data. For visualisation purposes, the videos were manually aligned using Fiji.</p>
</caption>
            <media xlink:href="supplements/640367v1_file01.mov"/>
        </supplementary-material>
    </sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cossart</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Garel</surname>, <given-names>S</given-names></string-name></person-group>. <article-title>Step by step: cells with multiple functions in cortical circuit assembly</article-title>. <source>Nat Rev Neurosci</source> <volume>23</volume>, <fpage>395</fpage>–<lpage>410</lpage> (<year>2022</year>).</mixed-citation></ref>
    <ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Molnár</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Luhmann</surname>, <given-names>H. J.</given-names></string-name> &amp; <string-name><surname>Kanold</surname>, <given-names>P. O</given-names></string-name></person-group>. <article-title>Transient cortical circuits match spontaneous and sensory-driven activity during development</article-title>. <source>Science</source> <volume>370</volume>, <elocation-id>eabb2153</elocation-id> (<year>2020</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blankenship</surname>, <given-names>A. G.</given-names></string-name> &amp; <string-name><surname>Feller</surname>, <given-names>M. B</given-names></string-name></person-group>. <article-title>Mechanisms underlying spontaneous patterned activity in developing neural circuits</article-title>. <source>Nature Reviews Neuroscience</source> <volume>11</volume>, <fpage>18</fpage>–<lpage>29</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reh</surname>, <given-names>R. K.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Critical period regulation across multiple timescales</article-title>. <source>Proc National Acad Sci</source> <volume>117</volume>, <fpage>23242</fpage>–<lpage>23251</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname>, <given-names>M. W.</given-names></string-name>, <string-name><surname>Kourdougli</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Portera-Cailliau</surname>, <given-names>C</given-names></string-name></person-group>. <article-title>Network state transitions during cortical development</article-title>. <source>Nat. Rev. Neurosci</source>. <volume>25</volume>, <fpage>535</fpage>–<lpage>552</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bollmann</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Prominent in vivo influence of single interneurons in the developing barrel cortex</article-title>. <source>Nat. Neurosci</source>. <volume>26</volume>, <fpage>1555</fpage>–<lpage>1565</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>, <given-names>D. C.</given-names></string-name>, <string-name><surname>Santos-Valencia</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Song</surname>, <given-names>J. H.</given-names></string-name>, <string-name><surname>Franks</surname>, <given-names>K. M.</given-names></string-name> &amp; <string-name><surname>Luo</surname>, <given-names>L</given-names></string-name></person-group>. <article-title>Embryonically active piriform cortex neurons promote intracortical recurrent connectivity during development</article-title>. <source>Neuron</source> (<year>2024</year>) doi:<pub-id pub-id-type="doi">10.1016/j.neuron.2024.06.007</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Che</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>García</surname>, <given-names>N. V. D. M</given-names></string-name></person-group>. <article-title>An in vivo Calcium Imaging Approach for the Identification of <italic>Cell</italic>-Type Specific Patterns in the Developing Cortex</article-title>. <source>Front. Neural Circuits</source> <volume>15</volume>, <issue>747724</issue> (<year>2021</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duan</surname>, <given-names>Z. R. S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>GABAergic Restriction of Network Dynamics Regulates Interneuron Survival in the Developing Cortex</article-title>. <source>Neuron</source> <volume>105</volume>, <fpage>75</fpage>–<lpage>92.e5</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wong</surname>, <given-names>F. K.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Pyramidal cell regulation of interneuron survival sculpts cortical networks</article-title>. <source>Nature</source> <volume>557</volume>, <fpage>668</fpage>–<lpage>673</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>He</surname>, <given-names>C. X.</given-names></string-name>, <string-name><surname>Arroyo</surname>, <given-names>E. D.</given-names></string-name>, <string-name><surname>Cantu</surname>, <given-names>D. A.</given-names></string-name>, <string-name><surname>Goel</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Portera-Cailliau</surname>, <given-names>C</given-names></string-name></person-group>. <article-title>A Versatile Method for Viral Transfection of Calcium Indicators in the Neonatal Mouse Brain</article-title>. <source>Front. Neural Circuits</source> <volume>12</volume>, <issue>56</issue> (<year>2018</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mòdol</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Assemblies of Perisomatic GABAergic Neurons in the Developing Barrel Cortex</article-title>. <source>Neuron</source> <fpage>1</fpage>–<lpage>18</lpage> (<year>2019</year>) doi:<pub-id pub-id-type="doi">10.1016/j.neuron.2019.10.007</pub-id>.</mixed-citation></ref>
    <ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Beest</surname></string-name>, <string-name><surname>E. H.</surname></string-name> <etal>et al.</etal></person-group> <article-title>Tracking neurons across days with high-density probes</article-title>. <source>Nat. Methods</source> <fpage>1</fpage>–<lpage>10</lpage> (<year>2024</year>) doi:<pub-id pub-id-type="doi">10.1038/s41592-024-02440-1</pub-id>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname>, <given-names>J. S.</given-names></string-name>, <string-name><surname>Briguglio</surname>, <given-names>J. J.</given-names></string-name>, <string-name><surname>Cohen</surname>, <given-names>J. D.</given-names></string-name>, <string-name><surname>Romani</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Lee</surname>, <given-names>A. K</given-names></string-name></person-group>. <article-title>The Statistical Structure of the Hippocampal Code for Space as a Function of Time, Context, and Value</article-title>. <source>Cell</source> <volume>183</volume>, <fpage>620</fpage>–<lpage>635.e22</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ziv</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Long-term dynamics of CA1 hippocampal place codes</article-title>. <source>Nature Neuroscience</source> <fpage>1</fpage>–<lpage>5</lpage> (<year>2013</year>) doi:<pub-id pub-id-type="doi">10.1038/nn.3329</pub-id>.</mixed-citation></ref>
    <ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnston</surname>, <given-names>K. G.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Tracking longitudinal population dynamics of single neuronal calcium signal using SCOUT</article-title>. <source>Cell Rep Methods</source> <volume>2</volume>, <issue>100207</issue> (<year>2022</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lyck</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Krøigård</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Finsen</surname>, <given-names>B</given-names></string-name></person-group>. <article-title>Unbiased cell quantification reveals a continued increase in the number of neocortical neurons during early post-natal development in mice</article-title>. <source>Eur. J. Neurosci</source>. <volume>26</volume>, <fpage>1749</fpage>–<lpage>1764</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thompson</surname>, <given-names>C. L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>A High-Resolution Spatiotemporal Atlas of Gene Expression of the Developing Mouse Brain</article-title>. <source>Neuron</source> <volume>83</volume>, <fpage>309</fpage>–<lpage>323</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nakazawa</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Mizuno</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Iwasato</surname>, <given-names>T</given-names></string-name></person-group>. <article-title>Differential dynamics of cortical neuron dendritic trees revealed by long-term in vivo imaging in neonates</article-title>. <source>Nat. Commun</source>. <volume>9</volume>, 3106 (<year>2018</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maška</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The Cell Tracking Challenge: 10 years of objective benchmarking</article-title>. <source>Nat. Methods</source> <volume>20</volume>, <fpage>1010</fpage>–<lpage>1020</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sheintuch</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Tracking the Same Neurons across Multiple Days in Ca2+ Imaging Data</article-title>. <source>Cell Rep</source>. <volume>21</volume>, <fpage>1102</fpage>–<lpage>1115</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tolu</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>A versatile system for the neuronal subtype specific expression of lentiviral vectors</article-title>. <source>FASEB J</source>. <volume>24</volume>, <fpage>723</fpage>–<lpage>730</lpage> (<year>2010</year>).</mixed-citation></ref>
    <ref id="c23"><label>23.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Pachitariu</surname>, <given-names>M.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Suite2p: beyond 10,000 neurons with standard two-photon microscopy</article-title>. <source>bioRxiv</source> (<year>2017</year>) doi:<pub-id pub-id-type="doi">10.1101/061507</pub-id>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Otsu</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>A Threshold Selection Method from Gray-Level Histograms. <italic>IEEE Trans. Syst., Man</italic></article-title>, <source>Cybern</source>. <volume>9</volume>, <fpage>62</fpage>–<lpage>66</lpage> (<year>1979</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ulman</surname>, <given-names>V.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>An objective comparison of cell-tracking algorithms</article-title>. <source>Nat. Methods</source> <volume>14</volume>, <fpage>1141</fpage>–<lpage>1152</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rochefort</surname>, <given-names>N. L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Sparsification of neuronal activity in the visual cortex at eye-opening</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source> <volume>106</volume>, <fpage>15049</fpage>–<lpage>15054</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Golshani</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Internally Mediated Developmental Desynchronization of Neocortical Network Activity</article-title>. <source>Journal of Neuroscience</source> <volume>29</volume>, <fpage>10890</fpage>–<lpage>10899</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mizuseki</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name></person-group> <article-title>Preconfigured, Skewed Distribution of Firing Rates in the <italic>Hippocampus</italic> and Entorhinal Cortex</article-title>. <source>CellReports</source> <volume>4</volume>, <fpage>1010</fpage>–<lpage>1021</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Avitan</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Stringer</surname>, <given-names>C</given-names></string-name></person-group>. <article-title>Not so spontaneous: Multi-dimensional representations of behaviors and context in sensory areas</article-title>. <source>Neuron</source> (<year>2022</year>) doi:<pub-id pub-id-type="doi">10.1016/j.neuron.2022.06.019</pub-id>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stringer</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Pachitariu</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Steinmetz</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Carandini</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Harris</surname>, <given-names>K. D</given-names></string-name></person-group>. <article-title>High-dimensional geometry of population responses in visual cortex</article-title>. <source>Nature</source> <fpage>1</fpage>–<lpage>21</lpage> (<year>2019</year>) doi:<pub-id pub-id-type="doi">10.1038/s41586-019-1346-5</pub-id>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Benisty</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Rapid fluctuations in functional connectivity of cortical networks encode spontaneous behavior</article-title>. <source>Nat. Neurosci</source>. <volume>27</volume>, <fpage>148</fpage>–<lpage>158</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Niell</surname>, <given-names>C. M.</given-names></string-name> &amp; <string-name><surname>Stryker</surname>, <given-names>M. P</given-names></string-name></person-group>. <article-title>Modulation of Visual Responses by Behavioral State in Mouse Visual Cortex</article-title>. <source>Neuron</source> <volume>65</volume>, <fpage>472</fpage>–<lpage>479</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gentet</surname>, <given-names>L. J.</given-names></string-name>, <string-name><surname>Avermann</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Matyas</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Staiger</surname>, <given-names>J. F.</given-names></string-name> &amp; <string-name><surname>Petersen</surname>, <given-names>C. C. H</given-names></string-name></person-group>. <article-title>Membrane Potential Dynamics of GABAergic Neurons in the Barrel Cortex of Behaving Mice</article-title>. <source>Neuron</source> <volume>65</volume>, <fpage>422</fpage>–<lpage>435</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stringer</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Rastermap: a discovery method for neural population recordings</article-title>. <source>Nat. Neurosci</source>. <volume>28</volume>, <fpage>201</fpage>–<lpage>212</lpage> (<year>2025</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lütcke</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Margolis</surname>, <given-names>D. J.</given-names></string-name> &amp; <string-name><surname>Helmchen</surname>, <given-names>F</given-names></string-name></person-group>. <article-title>Steady or changing? Long-term monitoring of neuronal population activity</article-title>. <source>Trends Neurosci</source>. <volume>36</volume>, <fpage>375</fpage>–<lpage>384</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Driscoll</surname>, <given-names>L. N.</given-names></string-name>, <string-name><surname>Pettit</surname>, <given-names>N. L.</given-names></string-name>, <string-name><surname>Minderer</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Chettih</surname>, <given-names>S. N.</given-names></string-name> &amp; <string-name><surname>Harvey</surname>, <given-names>C. D</given-names></string-name></person-group>. <article-title>Dynamic Reorganization of Neuronal Activity Patterns in Parietal Cortex</article-title>. <source>Cell</source> <volume>170</volume>, <fpage>986</fpage>–<lpage>999.e16</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Colonnese</surname>, <given-names>M. T</given-names></string-name></person-group>. <article-title>Rapid Developmental Emergence of Stable Depolarization during Wakefulness by Inhibitory Balancing of Cortical Network Excitability</article-title>. <source>J. Neurosci</source>. <volume>34</volume>, <fpage>5477</fpage>– <lpage>5485</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Colonnese</surname>, <given-names>M. T.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>A conserved switch in sensory processing prepares developing neocortex for vision</article-title>. <source>Neuron</source> <volume>67</volume>, <fpage>480</fpage>–<lpage>498</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dard</surname>, <given-names>R. F.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The rapid developmental rise of somatic inhibition disengages hippocampal dynamics from self-motion</article-title>. <source>eLife</source> <volume>11</volume>, <elocation-id>e78116</elocation-id> (<year>2022</year>). <pub-id pub-id-type="doi">10.7554/eLife.78116</pub-id></mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mòdol</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Moissidis</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Selten</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Oozeer</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Marín</surname>, <given-names>O</given-names></string-name></person-group>. <article-title>Somatostatin interneurons control the timing of developmental desynchronization in cortical networks</article-title>. <source>Neuron</source> <volume>112</volume>, <fpage>2015</fpage>–<lpage>2030.e5</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rio-Bermudez</surname>, <given-names>C. D.</given-names></string-name> &amp; <string-name><surname>Blumberg</surname>, <given-names>M. S</given-names></string-name></person-group>. <article-title>Sleep as a window on the sensorimotor foundations of the developing hippocampus</article-title>. <source>Hippocampus</source> (<year>2021</year>) doi:<pub-id pub-id-type="doi">10.1002/hipo.23334</pub-id>.</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Herlenius</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Lagercrantz</surname>, <given-names>H</given-names></string-name></person-group>. <article-title>Neurotransmitters and neuromodulators during early human development</article-title>. <source>Early Hum. Dev</source>. <volume>65</volume>, <fpage>21</fpage>–<lpage>37</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ahmad</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Dwyer</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Sokoloff</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Blumberg</surname>, <given-names>M. S</given-names></string-name></person-group>. <article-title>Coincident development and synchronization of sleep-dependent delta in the cortex and medulla</article-title>. <source>Curr. Biol</source>. <volume>34</volume>, <fpage>2570</fpage>–<lpage>2579.e5</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marques-Smith</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>A Transient Translaminar GABAergic Interneuron Circuit Connects Thalamocortical Recipient Layers in Neonatal Somatosensory Cortex</article-title>. <source>Neuron</source> <volume>89</volume>, <fpage>536</fpage>–<lpage>549</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anastasiades</surname>, <given-names>P. G.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>GABAergic interneurons form transient layer-specific circuits in early postnatal neocortex</article-title>. <source>Nature Communications</source> <volume>7</volume>, <issue>10584</issue> (<year>2016</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tuncdemir</surname>, <given-names>S. N.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Early Somatostatin Interneuron Connectivity Mediates the Maturation of Deep Layer Cortical Circuits</article-title>. <source>Neuron</source> <volume>89</volume>, <fpage>521</fpage>–<lpage>535</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chini</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Pfeffer</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Hanganu-Opatz</surname>, <given-names>I</given-names></string-name></person-group>. <article-title>An increase of inhibition drives the developmental decorrelation of neural activity</article-title>. <source>eLife</source> <volume>11</volume>, <elocation-id>e78811</elocation-id> (<year>2022</year>). <pub-id pub-id-type="doi">10.7554/eLife.78811</pub-id></mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gribizis</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Visual Cortex Gains Independence from Peripheral Drive before Eye Opening</article-title>. <source>Neuron</source> <volume>104</volume>, <fpage>711</fpage>–<lpage>723.e3</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minlebaev</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Colonnese</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Tsintsadze</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Sirota</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Khazipov</surname>, <given-names>R</given-names></string-name></person-group>. <article-title>Early Gamma Oscillations Synchronize Developing Thalamus and Cortex</article-title>. <source>Science</source> <volume>334</volume>, <fpage>226</fpage>–<lpage>229</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Colonnese</surname>, <given-names>M. T</given-names></string-name></person-group>. <article-title>Development of Activity in the Mouse Visual Cortex</article-title>. <source>J. Neurosci</source>. <volume>36</volume>, <fpage>12259</fpage>–<lpage>12275</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Micheva</surname>, <given-names>K. D.</given-names></string-name> &amp; <string-name><surname>Beaulieu</surname>, <given-names>C</given-names></string-name></person-group>. <article-title>Quantitative aspects of synaptogenesis in the rat barrel field cortex with special reference to GABA circuitry</article-title>. <source>The Journal of Comparative Neurology</source> <volume>373</volume>, <fpage>340</fpage>–<lpage>354</lpage> (<year>1996</year>).</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luhmann</surname>, <given-names>H. J.</given-names></string-name> &amp; <string-name><surname>Khazipov</surname>, <given-names>R</given-names></string-name></person-group>. <article-title>Neuronal Activity Patterns in the Developing Barrel Cortex</article-title>. <source>Neuroscience</source> <volume>368</volume>, <fpage>256</fpage>–<lpage>267</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blumberg</surname>, <given-names>M. S.</given-names></string-name>, <string-name><surname>Dooley</surname>, <given-names>J. C.</given-names></string-name> &amp; <string-name><surname>Tiriac</surname>, <given-names>A</given-names></string-name></person-group>. <article-title>Sleep, plasticity, and sensory neurodevelopment</article-title>. <source>Neuron</source> <volume>110</volume>, <fpage>3230</fpage>–<lpage>3242</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tiriac</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Del Rio-Bermudez</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Blumberg</surname>, <given-names>M. S</given-names></string-name></person-group>. <article-title>Self-Generated Movements with “Unexpected” Sensory Consequences</article-title>. <source>Curr Biol</source> <volume>24</volume>, <fpage>2136</fpage>–<lpage>2141</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tiriac</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Blumberg</surname>, <given-names>M. S</given-names></string-name></person-group>. <article-title>Gating of reafference in the external cuneate nucleus during self-generated movements in wake but not sleep</article-title>. <source>eLife</source> <volume>5</volume>, <elocation-id>e18749</elocation-id> (<year>2016</year>). <pub-id pub-id-type="doi">10.7554/eLife.18749</pub-id></mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dooley</surname>, <given-names>J. C.</given-names></string-name> &amp; <string-name><surname>Blumberg</surname>, <given-names>M. S</given-names></string-name></person-group>. <article-title>Developmental “awakening” of primary motor cortex to the sensory consequences of movement</article-title>. <source>eLife</source> <volume>7</volume>, <elocation-id>e41841</elocation-id> (<year>2018</year>). <pub-id pub-id-type="doi">10.7554/eLife.41841</pub-id></mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khazipov</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Early motor activity drives spindle bursts in the developing somatosensory cortex</article-title>. <source>Nature</source> <volume>432</volume>, <fpage>758</fpage>–<lpage>761</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Inácio</surname>, <given-names>A. R.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Distinct brain-wide presynaptic networks underlie the functional identity of individual cortical neurons</article-title>. <source>bioRxiv</source> 2023.05.25.542329 (<year>2024</year>) doi:<pub-id pub-id-type="doi">10.1101/2023.05.25.542329</pub-id>.</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Domínguez</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>A transient postnatal quiescent period precedes emergence of mature cortical dynamics</article-title>. <source>eLife</source> <volume>10</volume>, <elocation-id>e69011</elocation-id> (<year>2021</year>). <pub-id pub-id-type="doi">10.7554/eLife.69011</pub-id></mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tasnim</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The developmental timing of spinal touch processing alterations predicts behavioral changes in genetic mouse models of autism spectrum disorders</article-title>. <source>Nat. Neurosci</source>. <volume>27</volume>, <fpage>484</fpage>–<lpage>496</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ratsifandrihamanana</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>Dard</surname>, <given-names>R. F.</given-names></string-name>, <string-name><surname>Denis</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Cossart</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Picardo</surname>, <given-names>M. A</given-names></string-name></person-group>. <article-title>Protocol to image and analyze hippocampal network dynamics in non-anesthetized mouse pups</article-title>. <source>STAR Protoc</source>. <volume>4</volume>, <issue>102760</issue> (<year>2023</year>).</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stringer</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Spontaneous behaviors drive multidimensional, brainwide activity</article-title>. <source>Science</source> <volume>364</volume>, <issue>255</issue> (<year>2019</year>).</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ntatsis</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>itk-elastix: Medical image registration in Python</article-title>. <source>Proc. 22nd Python Sci. Conf</source>. 101–105 (<year>2023</year>) doi:<pub-id pub-id-type="doi">10.25080/gerudo-f2bc6f59-00d</pub-id>.</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crouse</surname>, <given-names>D. F</given-names></string-name></person-group>. <article-title>On implementing 2D rectangular assignment algorithms</article-title>. <source>IEEE Trans. Aerosp. Electron. Syst</source>. <volume>52</volume>, <fpage>1679</fpage>–<lpage>1696</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Varoquaux</surname>, <given-names>G.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Assessing and tuning brain decoders: Cross-validation, caveats, and guidelines</article-title>. <source>NeuroImage</source> <volume>145</volume>, <fpage>166</fpage>–<lpage>179</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c66"><label>66.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Glaser</surname>, <given-names>J. I.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Machine Learning for Neural Decoding</article-title>. <source>eNeuro</source> <volume>7</volume> (<year>2020</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.107540.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Petreanu</surname>
<given-names>Leopoldo</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Champalimaud Center for the Unknown</institution>
</institution-wrap>
<city>Lisbon</city>
<country>Portugal</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Compelling</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>important</bold> study presents a new method for longitudinally tracking cells in two-photon imaging data that addresses the specific challenges of imaging neurons in the developing cortex. It provides <bold>compelling</bold> evidence demonstrating reliable longitudinal identification of neurons across the second postnatal week in mice. The study should be of interest to development neuroscientists engaged in population-level recordings using two-photon imaging.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.107540.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This manuscript presents a compelling and innovative approach that combines Track2p neuronal tracking with advanced analytical methods to investigate early postnatal brain development. The work provides a powerful framework for exploring complex developmental processes such as the emergence of sensory representations, cognitive functions, and activity-dependent circuit formation. By enabling the tracking of the same neurons over extended developmental periods, this methodology sets the stage for mechanistic insights that were previously inaccessible.</p>
<p>Strengths:</p>
<p>(1) Innovative Methodology:</p>
<p>
The integration of Track2p with longitudinal calcium imaging offers a unique capability to follow individual neurons across critical developmental windows.</p>
<p>(2) High Conceptual Impact:</p>
<p>
The manuscript outlines a clear path for using this approach to study foundational developmental questions, such as how early neuronal activity shapes later functional properties and network assembly.</p>
<p>(3) Future Experimental Potential:</p>
<p>
The authors convincingly argue for the feasibility of extending this tracking into adulthood and combining it with targeted manipulations, which could significantly advance our understanding of causality in developmental processes.</p>
<p>(4) Broad Applicability:</p>
<p>
The proposed framework can be adapted to a wide range of experimental designs and questions, making it a valuable resource for the field.</p>
<p>Weaknesses:</p>
<p>No major weaknesses were identified by this reviewer. The manuscript is conceptually strong and methodologically sound. Future studies will need to address potential technical limitations of long-term tracking, but this does not detract from the current work's significance and clarity of vision.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.107540.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The manuscript by Majnik and colleagues introduces &quot;Track2p&quot;, a new tool designed to track neurons across imaging sessions of two-photon calcium imaging in developing mice. The method addresses the challenge of tracking cells in the growing brain of developing mice. The authors showed that &quot;Track2p&quot; successfully tracks hundreds of neurons in the barrel cortex across multiple days during the second postnatal week. This enabled the identification of the emergence of behavioral state modulation and desynchronization of spontaneous network activity around postnatal day 11.</p>
<p>Strengths:</p>
<p>The manuscript is well written, and the analysis pipeline is clearly described. Moreover, the dataset used for validation is of high quality, considering the technical challenges associated with longitudinal two-photon recordings in mouse pups. The authors provide a convincing comparison of both manual annotation and &quot;CellReg&quot; to demonstrate the tracking performance of &quot;Track2p&quot;. Applying this tracking algorithm, Majnik and colleagues characterized hallmark developmental changes in spontaneous network activity, highlighting the impact of longitudinal imaging approaches in developmental neuroscience. Additionally, the code is available on GitHub, along with helpful documentation, which will facilitate accessibility and usability by other researchers.</p>
<p>Weaknesses:</p>
<p>(1) The main critique of the &quot;Track2p&quot; package is that, in its current implementation, it is dependent on the outputs of &quot;Suite2p&quot;. This limits adoption by researchers who use alternative pipelines or custom code. One potential solution would be to generalize the accepted inputs beyond the fixed format of &quot;Suite2p&quot;, for instance, by accepting NumPy arrays (e.g., ROIs, deltaF/F traces, images, etc.) from files generated by other software. Otherwise, the tool may remain more of a useful add-on to &quot;Suite2p&quot; (see <ext-link ext-link-type="uri" xlink:href="https://github.com/MouseLand/suite2p/issues/933">https://github.com/MouseLand/suite2p/issues/933</ext-link>) rather than a fully standalone tool.</p>
<p>(2) Further benchmarking would strengthen the validation of &quot;Track2p&quot;, particularly against &quot;CaIMaN&quot; (Giovannucci et al., eLife, 2019), which is widely used in the field and implements a distinct registration approach.</p>
<p>(3) The authors might also consider evaluating performance using non-consecutive recordings (e.g., alternate days or only three time points across the week) to demonstrate utility in other experimental designs.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.107540.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this manuscript, Majnik et al. developed a computational algorithm to track individual developing interneurons in the rodent cortex at postnatal stages. Considerable development in cortical networks takes place during the first postnatal weeks; however, tools to study them longitudinally at a single-cell level are scarce. This paper provides a valuable approach to study both single-cell dynamics across days and state-driven network changes. The authors used Gad67Cre mice together with virally introduced TdTom to track interneurons based on their anatomical location in the FOV and AAVSynGCaMP8m to follow their activity across the second postnatal week, a period during which the cortex is known to undergo marked decorrelation in spontaneous activity. Using Track2P, the authors show the feasibility of tracking populations of neurons in the same mice, capturing with their analysis previously described developmental decorrelation and uncovering stable representations of neuronal activity, coincident with the onset of spontaneous active movement. The quality of the imaging data is compelling, and the computational analysis is thorough, providing a widely applicable tool for the analysis of emerging neuronal activity in the cortex. Below are some points for the authors to consider.</p>
<p>Major points:</p>
<p>(1) The authors used 20 neurons to generate a ground truth dataset. The rationale for this sample size is unclear. Figure 1 indicates the capability to track ~728 neurons. A larger ground truth data set will increase the robustness of the conclusions.</p>
<p>(2) It is unclear how movement was scored in the analysis shown in Figure 5A. Was the time that the mouse spent moving scored after visual inspection of the videos? Were whisker and muscle twitches scored as movement, or was movement quantified as the amount of time during which the treadmill was displaced?</p>
<p>(3) The rationale for binning the data analysis in early P11 is unclear. As the authors acknowledged, it is likely that the decoder captured active states from P11 onwards. Because active whisking begins around P14, it is unlikely to drive this change in network dynamics at P11. Does pupil dilation in the pups change during locomotor and resting states? Does the arousal state of the pups abruptly change at P11?</p>
</body>
</sub-article>
</article>