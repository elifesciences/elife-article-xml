<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">107390</article-id>
<article-id pub-id-type="doi">10.7554/eLife.107390</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.107390.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Passive muscle forces in <italic>Drosophila</italic> are large but insufficient to support a fly’s weight</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Wang</surname>
<given-names>Ninghan</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Babski</surname>
<given-names>Helene</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Perdomo</surname>
<given-names>Jonathan Elliot</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>McMahan</surname>
<given-names>Sarah Beth</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ramakrishnan</surname>
<given-names>Arun</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Biswas</surname>
<given-names>Tirthabir</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2608-0403</contrib-id>
<name>
<surname>Bhandawat</surname>
<given-names>Vikas</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>vb468@drexel.edu</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04bdffz58</institution-id><institution>School of Biomedical Engineering and Health Sciences, Drexel University</institution></institution-wrap>, <city>Philadelphia</city>, <country country="US">United States</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04bdffz58</institution-id><institution>College of Nursing and Health Professionals, Drexel University</institution></institution-wrap>, <city>Philadelphia</city>, <country country="US">United States</country></aff>
<aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/013sk6x84</institution-id><institution>Janelia Research Campus</institution></institution-wrap>, <city>Ashburn</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Berman</surname>
<given-names>Gordon J</given-names>
</name>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3588-7820</contrib-id><role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution>
</institution-wrap>
<city>Atlanta</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Sen</surname>
<given-names>Sonia Q</given-names>
</name>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-4693-3378</contrib-id><role>Senior Editor</role>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/04xf4yw96</institution-id><institution>Tata Institute for Genetics and Society</institution>
</institution-wrap>
<city>Bangalore</city>
<country>India</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-08-12">
<day>12</day>
<month>08</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP107390</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2025-04-29">
<day>29</day>
<month>04</month>
<year>2025</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2025-08-02">
<day>02</day>
<month>08</month>
<year>2025</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2025.04.29.651225"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Wang et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Wang et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-107390-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Movement of a limb is shaped by active forces generated by muscle contraction but also by passive forces within individual muscles and joints. In small animals such as insects, the contribution of passive forces to limb movement can match the active forces. However, most measurements of passive forces are limited to the femur-tibia joint in large insects. Here we take advantage of genetic tools in <italic>Drosophila</italic> to measure passive torques at multiple joints in the fly’s leg. We genetically inactivate all the motor neurons to assess passive forces. We find that the passive torques are well approximated by a linear spring, i.e., the passive torques linearly increase with angular deviation from the rest angle. The torques are much larger than the gravitational torque due to the leg itself. We estimate that the passive torques are seventy times smaller than necessary to support the weight of the animal. We also inactivated all the motor neurons in a freely standing fly and found that, as predicted from the model, the fly falls when the motor neurons are inactivated. We found that the height at which a fly stands, and, therefore the active forces vary. The fly’s height affects the time to initiate a fall. The time it takes for the fall is consistent with the active forces decaying with a time constant of ∼100 ms. Thus, although passive forces are strong and will have a large effect on limb kinematics, they are not strong enough to support the weight of the fly.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Adding 1) A missing table
2) Supplementary videos</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Movement of an animal’s limb is shaped not only by active forces generated by muscle contraction but also by other forces including inertial forces produced by gravity, recoil of one limb segment resulting from the movement of another segment, and passive forces in the muscles and joints [<xref ref-type="bibr" rid="c1">1</xref>-<xref ref-type="bibr" rid="c11">11</xref>]. The relative contribution of these forces depends on the size of the limb [<xref ref-type="bibr" rid="c1">1</xref>]: both inertial forces and active forces scale with the mass of the limb which in turn scales with the volume of the limb and therefore depends on the third power of limb length (L<sup>3</sup>). In contrast, passive forces scale with either the cross-sectional area of the muscle or the surface area of the joint and therefore have a L<sup>2</sup> dependence. As the size of the limb decreases, the relative contribution of passive forces which is inversely proportional to L (L<sup>2</sup>/L<sup>3</sup>) increases [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c12">12</xref>]. This scaling law implies that both the movement and posture of low mass limbs are influenced more by passive forces than by inertial forces. Therefore, understanding the control of small biomechanical systems such as the insect leg or human wrist [<xref ref-type="bibr" rid="c13">13</xref>-<xref ref-type="bibr" rid="c15">15</xref>] or ankle [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c16">16</xref>] is impossible without first understanding passive forces.</p>
<p>Recent work has begun to explore the consequences of large passive muscle forces in the context of the control of an insect limb. One such consequence is that the insect limb assumes a gravity-independent position because the passive forces are strong enough to counteract the effect of gravitational forces [<xref ref-type="bibr" rid="c1">1</xref>]. Another consequence is that active muscle forces are necessary through the entire duration of a leg’s movement: In large limbs such as a human leg, active forces are necessary only at the beginning of movement because inertial forces (or momentum) can carry the leg through the rest of its movement. In insect legs, inertial forces are weak compared to passive muscle forces causing the limb to return to its position determined by passive forces. Therefore, active forces are necessary throughout the movement. Another recent study has shown that passive forces play an important role in stopping the limb accurately [<xref ref-type="bibr" rid="c2">2</xref>]. A similarly important role for passive forces was found in the aimed movement of locust legs [<xref ref-type="bibr" rid="c3">3</xref>]. Efforts to measure passive forces in insect legs have been primarily limited to the femur-tibia (FTi) joint of large insects [<xref ref-type="bibr" rid="c4">4</xref>-<xref ref-type="bibr" rid="c7">7</xref>]. These efforts have found that the passive forces at the FTi joint arise from both the elastic properties of the cuticle and from the passive forces within the muscle itself. A limitation to our current understanding of passive muscle forces is a lack of similar measurement at other leg joints. Another limitation is that much of the effort in the measurement of passive forces has been limited to large insects; if scaling law holds true, the effect of passive forces is likely to be even more consequential in small insects such as <italic>Drosophila</italic> which are several orders of magnitude lighter than larger insects. In particular, the passive forces measured in the FTi joint of multiple arthropods suggest that the passive forces might be sufficient to support the weight of the respective animals [<xref ref-type="bibr" rid="c4">4</xref>]. If scaling laws hold, the passive forces in the <italic>Drosophila</italic> leg are even more likely to support the weight of a fly.</p>
<p>In this study we measure passive torques in the leg of an intact <italic>Drosophila</italic> by reversibly inactivating all motor neurons and estimating passive torques at each joint from the resulting leg configuration. We show that the torques at each joint can be modeled as a linear spring. The passive torques cannot support the weight of the fly; torques at least 70 times larger are necessary. This prediction was verified by silencing all the motor neurons in a freely walking or standing fly. Unexpectedly, the same fly stands at vastly different heights. Consistent with the idea that the active forces necessary to maintain a given height increases with the height of the fly, the time it takes to initiate a fall increases with the height of the fly. The rate at which a fly falls is consistent with the active forces decaying with a time constant of ∼100 ms Apart from reporting the passive forces in an important model system, our methodology is novel and complements the ones employed in larger insects because we were able to determine the torques at each joint in a completely intact leg. Moreover, employing genetic methods allows an assessment of the role of passive forces not possible otherwise.</p>
</sec>
<sec id="s2">
<title>Results</title>
<p>We reasoned that the rest position of the leg when a fly is attached to a tether and suspended in air would be determined by the equilibrium between torques due to active muscle forces, gravity, and passive forces. When all the motor neurons are genetically inactivated, the only two forces remaining are the gravitational force and the passive forces; therefore, the equilibrium angle for any joint is determined by the torques due to these forces. We manipulated the gravitational torque by rotating the body; in response, the joint angle at rest changed. By calculating the gravitational torque at different rest positions, we can estimate how passive torque varies with joint angle.</p>
<p>The flies of the genotype <italic>VGlut-Gal4; UAS-GtACR1</italic> express the light-activated anion conducting channel - <italic>Guillardia theta</italic> anion-conducting receptor1 (GtACR1)[<xref ref-type="bibr" rid="c17">17</xref>] in all glutamatergic neurons. Since the motor neurons in <italic>Drosophila</italic> are glutamatergic, they are silenced when the fly is illuminated with green light. We rotated a tethered fly of the above genotype using a precision rotational drive while recording its leg position using two cameras (<xref rid="fig1" ref-type="fig">Figure 1A</xref>). Inactivation causes a change in the leg’s rest position; however, in preliminary experiments, the body rotation did not have a large effect on the rest positions of the leg following inactivation. This result is consistent with the one already reported for stick insects and shows that passive forces within the leg are much larger than the gravitational force on a leg and dominate limb position [<xref ref-type="bibr" rid="c1">1</xref>]. Therefore, in this scenario, changing the fly’s orientation does not affect the leg rest position because changing the fly’s orientation will only affect gravitational forces which are too weak compared to the passive forces.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Passive forces in the fly leg are much stronger than gravitational force.</title>
<p><bold>A</bold><sub><bold>1</bold></sub>.Experimental set-up. <italic>UAS-GtACR1; VGlut-Gal4</italic> flies expressing light-activated anionic channels (<italic>GtACR1</italic>) under the control of <italic>VGlut</italic> promoter are rotated. Motor neurons in these flies are inactivated when stimulated with green light. One leg is kept intact, and a weight (blue square) is attached. <bold>A</bold><sub><bold>2</bold></sub>. When a weight (blue arrow) is added, the additional gravitational force is sufficient to elicit a measureable change in leg posture upon inactivation of the motor neurons. <bold>B.</bold> The two camera views are used to reconstruct the 3D configuration of the leg. The cross placed on the fly’s back (blue cross) is used to align the leg with respect to the body. <bold>C</bold>. Multiple trials for each body orientation is shown. Body was rotated through five angles from -30 to +30. Each body orientation is shown in different color. Same color scheme will signify body orientation in <xref ref-type="fig" rid="fig1">Figures 1</xref>-<xref ref-type="fig" rid="fig3">3</xref>. For each orientation, the leg configuration is similar. The leg configuration changes with changes in body angle because the gravitational torque is different.</p></caption>
<graphic xlink:href="651225v2_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To increase gravitational force on the leg, we added a weight (∼20-100x the leg mass) to the tarsus (<xref rid="fig1" ref-type="fig">Figure 1A</xref>, Supplementary Video 1). Adding a weight resulted in much larger changes in limb posture upon inactivation. Two camera views were used to determine the three-dimensional configuration of the leg, and the tether placed on the fly’s back was used to determine the leg configuration in a body-centered coordinate system (<xref rid="fig1" ref-type="fig">Figure 1B</xref>). There was a change in posture with changes in the angle of body rotation (<xref rid="fig1" ref-type="fig">Figure 1C</xref>). The legs rest in distinct and consistent postures that are strongly affected by the angle of the body (<xref rid="fig1" ref-type="fig">Figure 1C</xref>) implying a relationship between limb posture and passive forces.</p>
<p>At each body angle, we inactivated the motor neurons multiple times, measured the joint angles and the corresponding gravitational torques to determine the relationship between joint angle and passive torques. We hypothesized that, for small deviations from the resting position, the passive torques can be modeled as an angular spring [<xref ref-type="bibr" rid="c3">3</xref>].. <xref rid="fig2" ref-type="fig">Figure 2A</xref> illustrates this idea for a 1-segment limb; the passive force is conceptualized as a spring which has a rest angle θ<sub>0</sub> (red dotted line) at which there is no passive force. Gravitational forces acting on the weight will result in a deviation from θ<sub>0</sub> which in turn would result in restorative forces that increase linearly with the angular deviation from rest angle. The joint will rest at an angle θ at which the torque due to restorative forces cancel those due to the gravitational forces. Gravitational torques can be calculated from the limb configuration, allowing us to infer the passive torque, which for a linear spring is given by the product of the angular spring constant and angular deviation from rest angle.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>An angular spring describes the passive torques at each joint.</title>
<p><bold>A</bold>.Schematic that describes our analytical framework. As gravity (black arrow) pulls a limb segment away from its rest position (dotted red), passive forces increase linearly until torques due the passive forces balance torques due to gravity (at black dotted line). <bold>B</bold>. Definition of each of the four degrees of freedom (R=Right, A=Anterior, I=Inferior). <bold>C</bold>. Equilibrium angle is plotted as a function of body angle and changes with body rotation. Each marker is a separate measurement (n &gt;6). As in <xref ref-type="fig" rid="fig1">Figure 1C</xref>, marker color denotes body orientation. <bold>D</bold>. The gravitational torque around the levation-depression axis was calculated. The torque changes linearly with the joint angle as shown by the large correlation between the levation-depression angle and the passive torque generated to counter gravitation forces.</p></caption>
<graphic xlink:href="651225v2_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Because the legs have multiple degrees of freedom, although conceptually like a single joint, the calculation of torques about each axis is somewhat more involved (see Methods). Calculation of the gravitational torque requires estimating the limb configuration and aligning leg configuration to the vertical. We consider 4-degrees of freedom: an insect thorax-coxa (<italic>ThC</italic>) joint has two-degrees of freedom (protraction-retraction and pronation-supination); the levation-depression degree of freedom is at the coxa-trochanter (<italic>CTr</italic>) joint (<xref rid="fig2" ref-type="fig">Figure 2B</xref>). There is an additional degree of freedom at the <italic>FTi</italic> joint. We estimate the torque about each degree of freedom.</p>
<p>The method for calculating passive torques is shown in <xref rid="fig2" ref-type="fig">Figure 2C</xref> and <xref rid="fig2" ref-type="fig">2D</xref> using the example of one joint – levation-depression – in a single fly; group data is presented in <xref rid="fig3" ref-type="fig">Figure 3</xref>. As the body angle is changed, the leg stops at different levation-depression angles (<xref rid="fig2" ref-type="fig">Figure 2C</xref>) because the gravitational torque about the levation-depression joint changes with body orientation. If passive forces can be approximated as a linear spring, we anticipate a linear relationship between torque and angle. This linearity is exactly what we observe (<xref rid="fig2" ref-type="fig">Figure 2D</xref>). The spring constant <italic>K</italic><sub>θ</sub> and rest angle θ<sub>0</sub> was calculated using linear regression (<xref rid="fig2" ref-type="fig">Figure 2D</xref>, black line). The spring constant <italic>K</italic><sub>θ</sub> showed some variability across flies as did the rest angle θ<sub>0</sub> (<xref rid="fig2" ref-type="fig">Figure 2D</xref>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Passive torques at each of the four joints within a leg are well-described by a linear spring A.</title>
<p>Definition of each of the four degrees of freedom (R=Right, A=Anterior, I=Inferior). Same as <xref ref-type="fig" rid="fig2">Figure 2A</xref>. <bold>B</bold>. Torque-angle relationships for the joints in the mesothoracic leg showing a linear relationship for each degree of freedom. Number of trials between 9-12. <bold>C</bold>. The passive force spring constant (κ) and equilibrium joint angles for four degrees of freedom for each leg. The red line is the median; the blue lines mark the inter-quartile range. The median values can also be found in <xref rid="tbl1" ref-type="table">Table 1</xref>.</p></caption>
<graphic xlink:href="651225v2_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>The rest angle at a given rotation showed some variability; the standard deviation for the data shown in <xref rid="fig2" ref-type="fig">Figure 2D</xref> is ∼10°; this variation is consistent across most flies. To better understand the sources of this variability, we quantified the contribution of different sources of variability: We first considered the variability due to reconstruction errors. To this end, we evaluated errors due to calibration and used the calibration errors to estimate differences in both the joint angles and the sensitivity of the estimated <italic>K</italic> to these changes and found that calibration errors are small as the interquartile range is &lt;5% different from the reported value (<xref rid="figS1" ref-type="fig">Figure 2-S1</xref>). Next, we focused on biological reasons for variability. Because muscles also receive octopaminergic input, it is possible that the variability is due to different levels of octopaminergic modulation in different trials. To address this issue, we performed the same experiment in flies where both the octopaminergic and glutamatergic neurons are silenced (<xref rid="figS2" ref-type="fig">Figure 2-S2</xref>). We found no difference in variability when both neural populations are inactivated (<xref rid="figS2" ref-type="fig">Figure 2-S2</xref>). Experiments using a larger mass resulted in a decrease in variability but did not yield different values for <italic>K</italic> (<xref rid="figS2" ref-type="fig">Figure 2-S2</xref>). Overall, a larger mass did result in lower variance, but it also caused the FTi joint to be extended to its limits in some cases. The decreased variability with higher weights does provide hints to the main sources of variability: Joint friction and coupling between different degrees of freedom mean that the gravitational torque acting on a joint will not bring it to rest at a unique position. A full analysis is beyond the scope of this study, but we have performed some analysis and discussed the implication (<xref rid="figS3" ref-type="fig">Figure 2-S3</xref>, methods and discussion).</p>
<p>We measured the passive forces at each of the other joints (<xref rid="fig3" ref-type="fig">Figure 3A</xref>). For each degree of freedom, we observed a linear relationship between torque and angle allowing us to calculate the angular spring constant and the rest angle (<xref rid="fig3" ref-type="fig">Figure 3B</xref>). The equilibrium angle and spring constant for each joint on each of the three right legs were calculated (<xref rid="fig3" ref-type="fig">Figure 3C</xref> and <xref rid="tbl1" ref-type="table">Table 1</xref>).</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><title>Median stiffness for each of the measured joints in mN/<sup>º</sup></title></caption>
<graphic xlink:href="651225v2_tbl1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>The interquartile range of spring constant implies about a 2-fold range across flies (<xref rid="fig3" ref-type="fig">Figure 3C</xref>). With some exceptions, joints within a leg have similar stiffness: The most significant exception is that the retraction-protraction stiffness is smaller in the prothoracic legs compared to other joints in the same leg, and larger in comparison to the other joints in the metathoracic leg. There is a corresponding difference in the joint angle with the prothoracic leg being more protracted and the metathoracic leg being more retracted compared to the mesothoracic leg.</p>
<p>There is more difference in spring constant across legs. The spring constant for the prothoracic legs are about 50% larger than the stiffness of the mesothoracic legs except for the retraction-protraction axis whose spring constant is much lower. The spring constants for the metathoracic leg is much higher.</p>
<p>How strong are the passive forces in flies? One method to contextualize the passive forces is to assess whether these passive forces are strong enough to support the fly. To assess how the measured passive forces compare with the forces necessary to support the fly’s weight, we created a model of the fly using the physics simulation engine OpenSim[<xref ref-type="bibr" rid="c18">18</xref>] . The fly was modeled based on the measured dimensions of the fly’s head, thorax, and abdomen, and each of the legs (<xref rid="tbl2" ref-type="table">Table 2</xref>). (<xref rid="fig4" ref-type="fig">Figure 4A</xref> and Supplementary video 2). The ThC joint was modeled as a ball joint with three degrees of freedom, and the FTi joint as a hinge joint with one degree of freedom. We incorporate the CTr joint movement as the third DOF in the ThC joint. We did not measure passive torques at the TiTa joint, and thus the CTr and TiTa joints are both kept fixed at their equilibrium positions in the model (<xref rid="fig4" ref-type="fig">Figure 4A</xref> and Supplementary video 2).</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><title>Ellipsoid radii for each body (μm)</title></caption>
<graphic xlink:href="651225v2_tbl2.tif" mime-subtype="tiff" mimetype="image"/>
<graphic xlink:href="651225v2_tbl2a.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>OpenSim model shows that the passive forces are ∼100-fold weaker than the forces required to support the fly.</title>
<p><bold>A</bold>. Schematic of the fly in the OpenSim model showing the fly in all three views (Scale bar = 0.5mm). <bold>B</bold>. Three timepoints of the simulation showing that the fly falls within 20 millisecond. <bold>C</bold>. Final equilibrium positions of the body at 4 different stiffnesses. <bold>D</bold>. Height of the CoM as a function of joint stiffness. The x-axis is scaled so that measured stiffness is 1.</p></caption>
<graphic xlink:href="651225v2_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Flies simulated with the measured passive stiffness were unable to support themselves and fell within 20 milliseconds, which is close to the freefall time (<xref rid="fig4" ref-type="fig">Figure 4B</xref>), implying that the weight of the fly is much larger than can be supported passively. As we increased the passive stiffness, we found that a 40-fold increase implemented uniformly across all leg joints was necessary to support the fly. At that force, the fly was barely supported over the ground (<xref rid="fig4" ref-type="fig">Figure 4C</xref>). As we increased the stiffness further, a more normal posture like the experimental flies was observed. Based on the height of the fly above the ground, we estimate that the stiffness is ∼80-fold higher than the measured passive forces. The plot of equilibrium height and joint stiffness is shown in <xref rid="fig4" ref-type="fig">Figure 4D</xref>.</p>
<p>To test the prediction made by the OpenSim model, we placed the fly of the same genotype as the ones used for tethered experiments - <italic>VGlut-Gal4; UAS-GtACR1</italic> - in a small rectangular chamber and video-recorded multiple views of freely walking flies as we inactivated the motor neurons with a green light (<xref rid="fig5" ref-type="fig">Figure 5A</xref>). We selected inactivation trials in which the flies are standing on all six legs, i.e., they are stopped. Using DeepLabCut[<xref ref-type="bibr" rid="c19">19</xref>] (DLC), we automatically tracked a point on the fly’s head in all views. Using these views, we performed a transformation to reconstruct the 3-dimensional position of the fly (see methods for details). We found that inactivation of motor neurons resulted in a rapid decrease in the fly’s height. The fly fell to the ground on every trial (n=92 from 8 flies). One trial is shown in <xref rid="fig5" ref-type="fig">Figure 5B</xref>; in this trial, the fall initiates in ∼40 milliseconds, there is a rapid drop – during which some part of the fly’s thorax or abdomen touches the ground. In some trials, the rapid drop is followed by a second phase – during which the height of the head continues to change as more of the body collapses to the ground.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Passive forces alone are not stong enough to support the weight of a fly.</title>
<p><bold>A</bold>. A schematic of the walking chamber used to collect data about falling experiments. Because we have four views of the fly, the fly’s head could be located in multiple views to extract its position in all three dimensions. <bold>B</bold>. An example of a falling trial. Light on at t=0. Three frames showing the position of the fly at different times is shown. <bold>C</bold>. Flies stand at different heights in different trials. Few trials from one fly are plotted - the starting height varies from 0.4 mm to 0.1 mm in this fly. <bold>D</bold>. Time it takes to initiate a fall depends on the height of the fly. There is a significant correlation between height and time for fall initiation (r<sup>2</sup>=0.35). <bold>E</bold>. Apart from the time to initiate a fall, the rate of falling is much slower than that anticipated from immediate dissipation of the active forces (dotted line). <bold>F</bold>. The distribution of the slopes of the fall. Note that the rate of falling if the active forces dissipated immediately would be 37 mm/s.</p></caption>
<graphic xlink:href="651225v2_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>As expected from the measurement of passive forces, the passive forces are too small to support the fly’s weight. However, there were two unexpected findings. The first finding is that there was a large variation in the initial height of the fly (<xref rid="fig5" ref-type="fig">Figure 5C</xref>), consistent with a recent study of flies walking on a treadmill[<xref ref-type="bibr" rid="c20">20</xref>]. This large variation in initial height implies that the active forces supporting the flies vary from trial-to-trial both within the same fly and across flies. Based on the OpenSim model, an active force of only 40X the passive force is necessary to support a fly standing at a height of 0.1 mm; the required force increases to 100X for a height of 0.4 mm (see <xref rid="fig4" ref-type="fig">Figure 4D</xref>). Consistent with this higher active force as the fly’s height increases, the time it takes to initiate a fall also increases with the height of the fly (<xref rid="fig5" ref-type="fig">Figure 5D</xref>). The time to initiate a fall varies from 40 milliseconds to 300 milliseconds, partly depending on the height of the fly.</p>
<p>Second, although the flies fell on each trial, it took much longer for the actual flies to fall compared to the simulated flies. As discussed above, one component of the difference is the time it takes to initiate a fall. A second component is the rate at which the fly fell to the ground. The rate at which the fly fell to the ground was much smaller in the experimental flies than it was in the simulated flies (<xref rid="fig5" ref-type="fig">Figure 5E</xref>). The median rate of falling was 1.3 mm/s compared to 37 mm/s for the simulated flies (<xref rid="fig5" ref-type="fig">Figure 5F</xref>).</p>
<p>The most likely reason for the longer than expected time for the fly to fall are delays associated with motor neuron inactivation and muscle inactivation. Based on measurements using the tethered fly (such as the one in Supplementary Video 1), we estimated that it takes about 350 milliseconds for the active forces to decay based on the time it takes for a fly’s limb to reach the new limb configuration defined by passive forces alone. To further estimate the possible delays, we performed in vivo whole-cell patch-clamp recordings from motor neurons. We used a line (e49-Gal4) in which it is easier to identify the motor neurons because of their position in the VNC as opposed to the broader set of neurons labeled by VGlut-Gal4. Using a digital mirror device (DMD) that allows us to stimulate either the entire VNC or only the recorded motor neuron, we show that the inhibition of motor neuron is intrinsic, i.e., reflects opening of ion-channels in the motor neuron itself (<xref rid="fig6" ref-type="fig">Figure 6B</xref>). A spot of light on the cell body produces as much of the hyperpolarization as stimulating the entire fly (mean of 11.3 mV vs 13.1 mV across 9 neurons). Conversely, excluding the cell body produces only a small effect on the MN (mean of 2.6 mV). The normalized change in voltage as a function of time is shown in <xref rid="fig6" ref-type="fig">Figure 6C</xref>. The MNs had a similar time-course: the initiation of inhibitory response took ∼30 milliseconds; this number is similar in all MNs (<xref rid="fig6" ref-type="fig">Figure 6C</xref>). The time it took for MNs to complete 90% inactivation ranged between 52-114 milliseconds (<xref rid="fig6" ref-type="fig">Figure 6C</xref>) implying that passive forces will take at least between 50-100 millisecond to decline as this measurement does not consider the delay between motor neuron inactivation and loss of muscle stiffness. This delay – between motor neuron inactivation and loss of muscle stiffness - will be different for different muscles and estimates for many muscles are not available currently. The delay for the slow tibial motor neuron is ∼40 millisecond[<xref ref-type="bibr" rid="c21">21</xref>]. Assuming a similar delay for all muscles, we reasoned that the decay of active forces will occur with a time constant equal to the sum of the two time constants discussed above giving a range of 100-150 milliseconds.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><title>The dynamics of the fly’s fall suggest that active forces decay with a timeconstant of ∼100 ms and is consistent with the time-course of motor neuron inactivation.</title>
<p><bold>A</bold>. Schematic of the set-up used to evaluate motor neuron inactivation. A DMD projector was used to either shine light on the motor neuron cell body (T), stimulate a non-target area (N), or provide full-field stimulation (F). <bold>B</bold>. Sample trace from a single-neuron showing that stimulating just the cell-body (left 5 trials) causes similar inhibition as the full field stimulation (right 5 trials). Stimulating regions not including the cell body (middle 5 traces) causes only a small depolarization. <bold>C</bold>. Time course of hyperpolarization in different motor neurons. <bold>D</bold>. OpenSim simulations show that an exponential decay with a time constant 100 ms best fits the dynamics of the fall. An exponential decay of 200 ms and 300 ms produces falls that are considerably slower.</p></caption>
<graphic xlink:href="651225v2_fig6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To estimate whether the temporal delays associated with neural inactivation and muscle inactivation can explain the time course of the fall that we observe, we created an OpenSim model in which the stiffness decayed exponentially. For the median fall, the fly stands at a height of 0.5 mm. Using the relationship plotted in <xref rid="fig4" ref-type="fig">Figure 4D</xref>, the active forces necessary to support the fly at that height is ∼ 90X the estimated passive forces. If we decrease the active forces such that the force at any time t is given by an exponential decay <italic>f</italic>(<italic>t</italic>) = <italic>f</italic><sub><italic>a</italic></sub> · <italic>e</italic> <sup>−<italic>t</italic>/τ</sup> + <italic>f</italic><sub><italic>p</italic></sub>. Here <italic>f</italic><sub><italic>a</italic></sub> and <italic>f</italic><sub><italic>p</italic></sub> are active and passive forces, respectively. The τ represents the time constant of the decay of the forces. When the active forces decay at an exponential rate of 100 ms, the initial slope of the resulting simulated decay is similar to the median fall (<xref rid="fig6" ref-type="fig">Figure 6D</xref>); a rate of decay of 200 ms produces a fall that is considerably slower than the actual fall (6D). This simulation shows that dynamics of the fall are consistent with the expected rate at which the active force would decay.</p>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>By leveraging the genetic tools in <italic>Drosophila</italic>, we could measure passive torques in all the joints of the fly’s middle leg except the tibia-tarsus joint within an intact leg. This method complements more invasive methods used in larger insects [<xref ref-type="bibr" rid="c22">22</xref>] by providing an estimate of passive torques for all leg joints in a completely intact leg. Optogenetics also allows for reversible inactivation, and measurements in a completely intact animal which is not possible with denervation techniques employed in large insects. A possible limitation of this method is that it is not as informative regarding the origin of the passive forces; a limitation that can be overcome in future work. As demonstrated in this study, the usefulness of this method is in connecting the measured passive torques to its consequences for the whole animal.</p>
<p>There are several important differences between our passive measurements, and those made previously. In most previous studies, a single joint is studied in isolation, and therefore there is a single degree of freedom. In this study, we examine the entire leg with multiple degrees of freedom. When the motor neurons are silenced, and the leg posture changes as it finds its new equilibrium, this new position can be different on different trials because of the multiple degrees of freedom. For instance, the torque along a given axis of rotation need not only be controlled by the angle of rotation about that axis, but also by other angular degrees of freedom relevant at the given joint. Therefore, one can achieve the same torque with slightly different angle of rotation about the torque axis due to compensatory changes in other angular degrees of freedom. This implies that equilibrium can be reached not just at a unique angle of rotation but rather for a small range of angles.</p>
<p>Despite this degeneracy, the passive torques in each joint is well described as a linear spring over a relatively large range of motion that extends over 40 degrees on each side of the rest position (see <xref rid="fig3" ref-type="fig">Figure 3</xref>). This linearity is consistent with the linearity in passive forces estimated during aimed leg movements in the locust [<xref ref-type="bibr" rid="c3">3</xref>]. Similarly, measurements in the FTi joint of a stick insect [<xref ref-type="bibr" rid="c6">6</xref>] show a roughly linear dependence on angle except when the joint is extended beyond 150°. The linearity observed here might reflect a similar cancelation between two non-linear processes as observed in the locust and stick insect: The non-linear increase in the force exerted as the joint moves away from its rest angle which in counteracted by a similar non-linear decrease in the moment arm.</p>
<p>The median stiffness of all the joints we investigated lie within a 7-fold range from 8X10<sup>-9</sup> Nm/° for the levation-depression in the mesothoracic leg to 6X10<sup>-8</sup> Nm/° for the retraction-protraction in the metathoracic leg. Most joints within a leg have similar stiffness; larger differences are observed across legs: prothoracic legs are stiffer than mesothoracic legs and methathoracic legs have the stiffest joints. Although more work is needed to fully understand differences across joints and legs, the narrow range of stiffness values are consistent with the similarity in the number of muscle fibers at each joint [<xref ref-type="bibr" rid="c23">23</xref>]. Differences in moment arm due to differences in attachment point are more likely to underlie differences across stiffness values than differences in the number of muscle fibers [<xref ref-type="bibr" rid="c24">24</xref>]. The most consistent difference in the rest angle is the difference in the retraction-protraction angle between the legs with the prothoracic leg more protracted and metathoracic leg more retracted than the mesothoracic leg. Similar differences were observed in the passive position of stick insect legs, and these differences were hypothesized to occur due to the differences in muscle attachment and resulting moment arms [<xref ref-type="bibr" rid="c24">24</xref>].</p>
<p>The range of stiffness values for a given joint across flies has an interquartile range that suggests about 30% variation on either side of the median. The contributions to this variability from errors resulting from the errors in tracking, in 3D-reconstruction, and uncertainty in linear regression is small (<xref rid="figS1" ref-type="fig">Figure 2-S1</xref>). Therefore, much of this variability is biological and comparable to measurements made in larger animals such as locust and stick insect [<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c6">6</xref>]. We also did not find a strong correlation between joint stiffness at the different joints in the same fly; higher stiffness at one joint is not predictive of higher stiffness at another joint further suggesting that small differences in spring constants are probably not critical.</p>
<p>In many studies, an asymmetry is observed between the passive forces when the joint angle is increased versus when the angle is decreased resulting in about a 10° difference in rest position in locust [<xref ref-type="bibr" rid="c4">4</xref>], stick insect [<xref ref-type="bibr" rid="c1">1</xref>], and false stick insect [<xref ref-type="bibr" rid="c5">5</xref>] depending on which direction the approach to rest is made. This asymmetry results from the different cross-sections of the muscles as well as different origins of the passive forces in the muscle versus at the joint. The data in this study is more consistent with symmetry between extension and flexion because the spring constants appear to be similar irrespective of whether the joint is more extended or flexed. One reason for the symmetry might be the number of muscle fibers are similar between extensors and flexor.</p>
<p>Another reason is that in larger insects, there are a group of inhibitory motor neurons that play a crucial role in tuning passive muscle properties, and these properties could be different whether the muscle is returning to the rest position from an extended or a flexed position [<xref ref-type="bibr" rid="c25">25</xref>]. In flies, these inhibitory motor neurons are not present [<xref ref-type="bibr" rid="c21">21</xref>].</p>
<p>Previous estimates of passive forces in the FTi joint have suggested that they might be sufficient to support the weight of the insect. As an example, the FTi joint on each leg of a stick insect produces 6 mN of passive force [<xref ref-type="bibr" rid="c1">1</xref>]; together the 6 legs of the stick insect should produce forces sufficient to support the weight of a stick insect (10 mN). Similar estimates in cockroaches suggested that a mere 20° change in the FTi joint is enough to generate sufficient passive forces to support a cockroach. Based on these findings, and the fact that the scaling laws should make passive forces even larger in relation to the weight of the insect, we expected that the passive forces should be able to support the weight of a fly. Surprisingly, the passive torques we measured were insufficient to support the weight of the fly. In fact, the required torques were approximately two orders of magnitude too weak. Both the predictions from our measurement with tethered flies, and experiments with freely walking flies support these conclusions. Back of the envelope calculations based on previous measurements suggest that stick insects, locusts, cockroaches should all be able to support their weight using passive forces alone; at the very least, these forces are unlikely to be 100-fold smaller. Thus, it appears that the passive torques measured in flies are at least two-orders of magnitude smaller than anticipated from measurements in larger insects. This difference is particularly striking because we are likely measuring the dynamic passive forces that are present soon after movement that are much larger [<xref ref-type="bibr" rid="c26">26</xref>-<xref ref-type="bibr" rid="c29">29</xref>], rather than the static forces measured typically.</p>
<p>More work is necessary to assess whether this discrepancy is due to methodological differences or reflect real biological differences. There are key differences between the genetic inactivation method employed in this study, and denervated or isolated legs employed in studies in larger insects. In the genetically inactivated flies, other sources of modulation remain preserved that might contribute to the measurement. Denervated/isolated leg preparations provide measurements that are closer to the actual mechanical properties of the leg. One possibility is that passive torques scale with the moment of inertia of the leg. If that is the case, the corresponding scaling law would be (mass)<sup>5/3</sup> implying that the passive torques would scale non-linearly with the mass of the insect. This would neatly explain why passive forces and the resulting torques produced in locust and stick insect which are 1000-fold heavier than flies are in the correct order of magnitude to support the weight of these insects while being 100-fold weaker in flies since the ratio of passive forces to mass scales by (mass)<sup>2/3</sup>.</p>
<p>Even though passive forces are not strong enough to support the fly, they are strong enough to impact both the posture of the limb and its movement. Femur has a mass of ∼7 μg, and length of 600 μm yielding a moment of inertia of 2.6X10<sup>-15</sup> Nm. The passive torques produced by deflecting the femur by 10° is ∼10<sup>-10</sup>. Thus, the passive torques produced are several orders of magnitude greater than the gravitational torques on the femur, and account for the gravity independent positions of the limb. Passive forces will also have a large effect on the movement of the limb.</p>
<p>A challenge with motor control in insect limb is that the forces required are small when compared to forces produced by muscles and joints within these limbs. To achieve these small forces, active forces much larger than the forces necessary to move the limb are counteracted with equally large passive forces leaving a small residual force[<xref ref-type="bibr" rid="c3">3</xref>]. This finding has led to the conclusion that passive forces in both locust [<xref ref-type="bibr" rid="c3">3</xref>] and stick insects [<xref ref-type="bibr" rid="c1">1</xref>] are of the same magnitude as the active forces. There is some evidence to suggest that passive forces are specifically adapted to match the active forces [<xref ref-type="bibr" rid="c5">5</xref>]. However, passive and active forces have only been compared during movements when the leg is unimpeded by ground contact. Our results suggest that the active forces are ∼100-fold larger than the passive forces during weight bearing tasks. It is possible that much smaller active forces are generated once the leg is lifted off the ground, and that the active forces during unimpeded ground contact in <italic>Drosophila</italic>, too, is of the same order as the passive forces. Alternatively, it is possible that flies might operate in a different force regime in which the passive forces are much greater than the residual torque, and the active force itself is much greater than the passive forces.</p>
<p>Another issue to consider in the motor control of fly limbs is that the decay of active forces will take time. Cessation of firing, decrease in forces following decrease in firing would require ∼100 millisecond which is of the same order of magnitude as a single step in the fly which appears to be implausible. It is more likely that fly locomotion works in a regime in which active forces cancel each other out to produce small residual forces.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<label>1.</label>
<title>Flies</title>
<p>All experiments, except motor neuron recordings, were performed on 3-5 day old female flies of genotype <italic>VGlut1(OK371)-Gal4; UAS-GtACR1</italic>. Motor neuron recordings were performed on <italic>e49-Gal4; UAS-GtACR1</italic> flies. The flies were reared at 25°C, and 12 hr:12 hr light: dark cycle until eclosion when they were transferred to food containing retinal (0.02% concentration of all-trans retinal) and kept in complete darkness until experiments were performed. We also performed experiments silencing both octopaminergic and glutamatergic neurons (<xref rid="figS2" ref-type="fig">Figure 2-S2</xref>) using <italic>VGlut1(OK371)-Gal4/Tdc2-Gal4; UAS-GtACR1</italic> flies.</p>
</sec>
<sec id="s4b">
<label>2.</label>
<title>Experiments on tethered flies</title>
<p>Flies were attached to a tether using a small drop of UV glue (Kemxert-300) that was cured using UV light provided by a UV-gun (LED-100 from Electro-lite). We made the tether using a D-Sub pin (Digi-Key #A2160-ND) with a 1cm length hypodermic tube (0.025”OD x 0.017”ID) epoxied on the female end. Two pieces of tungsten wire (0.005”OD), 1cm x 0.5cm epoxied together at a 90-degree angle made up the long and short axis for the tether, and this was attached inside the exposed end of hypodermic tube with epoxy. The tether was mounted to a precision rotational mount (Edmund Optics #66514) to allow small, precise rotations of the fly. In pilot experiments, we found that sometimes the fly’s legs would get entangled with each other when they are inactivated preventing an accurate assessment of the limb position. Therefore, in most experiments all legs except the leg being experimented with was removed. For tethered experiments, all data was collected with a weight attached to the leg. Most experiments were performed with a weight whose mass was ∼20X the mass of the fly’s rear leg (a 1/4mm length piece of wire was weighed to be 0.19 mg), then attached to the distal tarsus using a small drop of UV glue cured with a UV light). We also performed some experiments with weight that was ∼50 X and 100X the mass of the rear leg.</p>
<p>The flies were imaged using two USB 3.0 camera Basler acA1920-150 μm (50hz, 1920 px x 1200 px) and a Infinistix lens (0.5X, Edmund Optics #54675) to collect videos from two vantage points. A filter was placed on the lens to block visible light (570nm long pass filter, Edmund Optics #54656). Exposure was set at 1 millisecond. The flies were illuminated with 850 nm high-powered LED (Thor Labs #M850LP1). Each trial started with a 60-second period during which the neurons were not inactivated. During the rest of the trial 8 seconds of inactivation were interleaved with 2 second periods of rest. During the stimulus period, the flies were irradiated with green light (Thor Labs #M530L3).</p>
<p>Passive stop frames were automatically extracted from the two videos by assessing frames during which the legs were completely stopped during the inactivation period. This extraction method is not foolproof as the legs can get entangled with the stubs of the other legs, and to the cross that marked the long and short axis of the fly . Therefore, we manually inspected all stop frames and eliminated these cases. All the data for mesothoracic leg was collected from 20X weights, the data from metathoracic leg was a mixture of 20X and 100X weights, and from the prothoracic leg was a mixture of 20X and 50X weights.</p>
<p>We annotated four points on the fly’s leg on each camera view: the coxa, FTi joint, TiTa joint, the location of the weight, and the end of the tarsi; using direct linear transformation[<xref ref-type="bibr" rid="c30">30</xref>], we used the two views to obtain the 3-D position of each of the four points. Because rotations are not pure rotation, and there is some chance of translation, we used a cross attached to the dorsal surface of the fly’s thorax as an internal reference frame; the two axes of this cross were aligned to the fly’s long and short axes.</p>
<p>Calculation of torques and joint angles is described in the next section. After these calculations, we performed a robust linear fit using MATLAB.</p>
<p>The tethered experiments were performed in three batches. In the initial experiments, we targeted 18-24 trials per orientation. In the second and third set we used 9-12 trials, since we realized that the data was less variable than we expected. Not every trial could be used. Trials were rejected because the legs either got entangled with other legs or with the cross. Some experiments had to be stopped before all the trials could be completed because 1) The weight fell off, 2) flies could sometimes ripoff all or part of the leg while attempting to remove the weight, 3) between each inactivation bout, the leg moved vigorously. Experiments were stopped if this movement ceased before the end of the experiment, 4) Finally, sometimes the fly’s leg could get permanently stuck. Regardless, we only used flies in which we had at least 6 trials for a given orientation.</p>
</sec>
<sec id="s4c">
<label>2.</label>
<title>Calculation of passive joint forces</title>
<p>This section describes the calculation of passive joint torques for each degree of freedom. We use the tracked world coordinates of physical wires oriented along the fly’s body axes to establish an anatomical coordinate system at the tether, which we will refer to as the body axes. The position vector for the left-right axis is defined by subtracting the right (<italic>w</italic><sub><italic>R</italic></sub>) from the left (<italic>w</italic><sub><italic>L</italic></sub>) world coordinate of the physical wire:
<disp-formula id="ueqn1">
<graphic xlink:href="651225v2_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The position vector for the anterior-posterior axis is defined by subtracting the posterior (<italic>w</italic><sub><italic>P</italic></sub>) from the anterior (<italic>w</italic><sub><italic>A</italic></sub>) world coordinate of the oriented physical wire:
<disp-formula id="ueqn2">
<graphic xlink:href="651225v2_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We then perform the Gram-Schmidt process for orthonormalizing a set of vectors to obtain orthogonal <inline-formula><inline-graphic xlink:href="651225v2_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="651225v2_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula> basis vectors. The left-right axis <inline-formula><inline-graphic xlink:href="651225v2_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is defined by normalizing <inline-formula><inline-graphic xlink:href="651225v2_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula>:
<disp-formula id="ueqn3">
<graphic xlink:href="651225v2_ueqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
To obtain the orthogonal anterior-posterior axis, we first obtain the orthogonal projection of normalized <inline-formula><inline-graphic xlink:href="651225v2_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula> on the subspace spanned by <inline-formula><inline-graphic xlink:href="651225v2_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula>:
<disp-formula id="ueqn4">
<graphic xlink:href="651225v2_ueqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The difference between <italic>v</italic><sub>2</sub> and its orthogonal projection onto the previous subspace is orthogonal to the vectors in that subspace, thus giving us the <inline-formula><inline-graphic xlink:href="651225v2_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula> basis vector:
<disp-formula id="ueqn5">
<graphic xlink:href="651225v2_ueqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Similarly, to obtain the orthogonal dorsal-ventral axis, we first obtain the orthogonal projection of normalized <inline-formula><inline-graphic xlink:href="651225v2_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula> on the subspace spanned by <inline-formula><inline-graphic xlink:href="651225v2_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="651225v2_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula>:
<disp-formula id="ueqn6">
<graphic xlink:href="651225v2_ueqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Likewise, the difference between <italic>v</italic><sub>3</sub> and its orthogonal projection onto the previous subspace is orthogonal to the vectors in that subspace, which yields the <inline-formula><inline-graphic xlink:href="651225v2_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula> basis vector:
<disp-formula id="ueqn7">
<graphic xlink:href="651225v2_ueqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Each leg segment unit vector is defined as the radius vector relative to its point of attachment and are symbolized by <inline-formula><inline-graphic xlink:href="651225v2_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="651225v2_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for the femur, tibia, and tarsus axes respectively. The femur vector is defined as the difference between the femur-tibia and coxa-trochanter joint positions in world coordinates:
<disp-formula id="eqn1">
<graphic xlink:href="651225v2_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The tibia vector is defined as the difference between the tibia-tarsus and femur-tibia joint positions in world coordinates:
<disp-formula id="eqn2">
<graphic xlink:href="651225v2_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We use these unit vectors to calculate the four angles which describe the degrees of freedom considered here: Levation-depression (<italic>θ</italic>), protraction-retraction (<italic>φ</italic>), and pronation-supination (<italic>γ</italic>) at the proximal coxa joints, as well as extension-flexion (<italic>Ψ</italic>) at the femur-tibia joint.</p>
<p>The levation-depression angle (<italic>θ</italic>) is calculated as the angle formed by the femur’s projection in the body’s transverse <inline-formula><inline-graphic xlink:href="651225v2_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula>-plane with the body’s dorsal-ventral <inline-formula><inline-graphic xlink:href="651225v2_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula>-axis. In this convention, 0° corresponds to the femur pointing vertically. We obtain the femur vector’s components in the transverse plane:
<disp-formula id="ueqn8">
<graphic xlink:href="651225v2_ueqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Finally, <italic>θ</italic> is the inverse cosine of the dot product between the femur’s transverse plane projection and <inline-formula><inline-graphic xlink:href="651225v2_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula>:
<disp-formula id="eqn3">
<graphic xlink:href="651225v2_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The protraction-retraction angle (<italic>φ</italic>) is calculated as the angle formed by the femur’s projection in the body’s coronal <inline-formula><inline-graphic xlink:href="651225v2_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula>-plane and the body’s anterior-posterior <inline-formula><inline-graphic xlink:href="651225v2_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>-axis, with 0° corresponding to the femur pointing anteriorly.</p>
<p>We obtain the femur vector’s components in the coronal plane:
<disp-formula id="ueqn9">
<graphic xlink:href="651225v2_ueqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Finally, <italic>φ</italic> is the inverse cosine of the dot product between the femur’s <italic>XY</italic>-projection and <inline-formula><inline-graphic xlink:href="651225v2_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula>:
<disp-formula id="eqn4">
<graphic xlink:href="651225v2_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
To determine angles at the femur-tibia joint we establish a reference frame at the femur vector <inline-formula><inline-graphic xlink:href="651225v2_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The femur-tibia (<italic>FTi</italic>) reference frame is defined by the orthonormal basis vectors <inline-formula><inline-graphic xlink:href="651225v2_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="651225v2_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqn7">Equations 7</xref>-9):
<disp-formula id="eqn5">
<graphic xlink:href="651225v2_eqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn6">
<graphic xlink:href="651225v2_eqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn7">
<graphic xlink:href="651225v2_eqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Using the femur-tibia reference frame, the extension-flexion angle (<italic>Ψ</italic>) is defined as the angle formed by the femur and tibia vectors (<xref ref-type="disp-formula" rid="eqn10">Equation 10</xref>):
<disp-formula id="eqn8">
<graphic xlink:href="651225v2_eqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The pronation-supination angle (<italic>γ</italic>) is calculated by relating the elevation (<italic>Ψ</italic>) and azimuthal angle (<italic>γ</italic>) of <inline-formula><inline-graphic xlink:href="651225v2_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to the projection of <inline-formula><inline-graphic xlink:href="651225v2_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in the femur-tibia axes. We then solve for <italic>γ</italic> (Equation11):
<disp-formula id="eqn9">
<graphic xlink:href="651225v2_eqn11.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We then determine passive forces by evaluating torques along each rotational axis. The fly’s leg is static so it can be assumed that only gravitational and passive forces are acting on the leg. The gravitational torques due to limb mass are negligible with respect to the torque due to the applied weight at the tarsi (&gt;20 times total leg mass), and thus they can be ignored. The gravity vector <inline-formula><inline-graphic xlink:href="651225v2_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is defined with an acceleration of -9.81m/s<sup>2</sup> along the vertical axis of the world coordinate system (<italic>z</italic><sub><italic>global</italic></sub>). <xref ref-type="disp-formula" rid="eqn12">Equation 12</xref> describes the net torque at the leg’s point of attachment, or origin, due to the applied weight <inline-formula><inline-graphic xlink:href="651225v2_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula> relative to the leg’s point of attachment. For the meso- and metathoracic legs, the point of attachment is defined as the coxa-trochanter joint position since the coxa is small and has a negligible influence on leg torque. For the prothoracic leg, it is defined as the thorax-coxa joint due to the much larger length of the prothoracic coxa. With <italic>m</italic><sub><italic>W</italic></sub> the mass of the applied weight, the net torque is thus represented by the cross products of the weight position vector and its gravitational force vector (<xref ref-type="disp-formula" rid="eqn12">Equation 12</xref>):
<disp-formula id="eqn10">
<graphic xlink:href="651225v2_eqn12.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The torque vector at the femur-tibia joint <inline-formula><inline-graphic xlink:href="651225v2_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is calculated in the same way, but using the radius vector of the applied weight’s center of mass relative to the <italic>FTi</italic> joint (<xref ref-type="disp-formula" rid="eqn13">Equation 13</xref>):
<disp-formula id="eqn11">
<graphic xlink:href="651225v2_eqn13.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The levation-depression axis is represented by the vector orthogonal to the femur’s projection in the body’s transverse <inline-formula><inline-graphic xlink:href="651225v2_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula>-plane and the body’s dorsal-ventral <inline-formula><inline-graphic xlink:href="651225v2_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula>-axis. Thus the torque τ<sub><italic>θ</italic></sub> about this axis is the projection of <inline-formula><inline-graphic xlink:href="651225v2_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula> onto the unit vector formed by the cross product of <inline-formula><inline-graphic xlink:href="651225v2_inline31.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="651225v2_inline32.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqn14">Equation 14</xref>):
<disp-formula id="eqn12">
<graphic xlink:href="651225v2_eqn14.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The protraction-retraction axis is represented by the vector orthogonal to the femur’s projection in the body’s coronal <inline-formula><inline-graphic xlink:href="651225v2_inline33.gif" mime-subtype="gif" mimetype="image"/></inline-formula>-plane and the body’s right-left <inline-formula><inline-graphic xlink:href="651225v2_inline34.gif" mime-subtype="gif" mimetype="image"/></inline-formula>-axis. Thus, the protraction-retraction torque (τ<sub><italic>φ</italic></sub>) about this axis is the projection of <inline-formula><inline-graphic xlink:href="651225v2_inline35.gif" mime-subtype="gif" mimetype="image"/></inline-formula> onto the vector formed by the cross product of <inline-formula><inline-graphic xlink:href="651225v2_inline36.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="651225v2_inline37.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqn15">Equation 15</xref>):
<disp-formula id="eqn13">
<graphic xlink:href="651225v2_eqn15.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The extension-flexion axis is orthogonal to the femur <inline-formula><inline-graphic xlink:href="651225v2_inline38.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and tibia axis <inline-formula><inline-graphic xlink:href="651225v2_inline39.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Thus, the extension-flexion torque (τ<sub><italic>Ψ</italic></sub>) is the projection of <inline-formula><inline-graphic xlink:href="651225v2_inline40.gif" mime-subtype="gif" mimetype="image"/></inline-formula> onto the cross product of <inline-formula><inline-graphic xlink:href="651225v2_inline41.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="651225v2_inline42.gif" mime-subtype="gif" mimetype="image"/></inline-formula>:
<disp-formula id="eqn14">
<graphic xlink:href="651225v2_eqn16.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The pronation-supination axis exists along the femur vector represented by <inline-formula><inline-graphic xlink:href="651225v2_inline43.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Thus, the pronation-supination torque is simply the projection of <inline-formula><inline-graphic xlink:href="651225v2_inline44.gif" mime-subtype="gif" mimetype="image"/></inline-formula> onto this vector (<xref ref-type="disp-formula" rid="eqn17">Equation 17</xref>):
<disp-formula id="eqn15">
<graphic xlink:href="651225v2_eqn17.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
To verify the accuracy of our calculated joint parameters, we used forward kinematics and determined the mapping function from joint space to the world coordinate system in Cartesian space. Leg positions from each body rotation were reconstructed into world coordinates from joint positions and then overlaid onto the original tracking data. This verified that our angle calculations are capturing the passive stop positions accurately.</p>
</sec>
<sec id="s4d">
<label>3.</label>
<title>Estimating errors in the measurement of spring constant due to reconstruction</title>
<p>The accuracy of our 3D reconstructions is dependent on the quality of the Direct Linear Transformation (DLT) coefficients obtained from the two-camera system calibration. To verify that our DLT calibrations capture the transformation from 2D camera coordinates to 3D world coordinates, we used inverse DLT to obtain pixel coordinates from the 3D-reconstructed leg joint positions using corresponding calibration coefficients. We then overlaid these points on the corresponding frames for all acquisitions and found that the coefficients accurately capture the inverse transformation from 3D-reconstructed leg coordinates to corresponding pixel positions for each camera (<xref rid="figS1" ref-type="fig">Figure 2S1-A</xref>).</p>
<p>To estimate the error in the reconstruction attributable to the camera calibration, we performed the following procedure: First, we obtained a random subsample of half of the control points used in the calibration. The control points consist of the pixel coordinates of a fixed object for each camera, and its corresponding 3D coordinate. The control points were acquired by moving a motorized micromanipulator to desired locations. We then run the DLT calibration to obtain new coefficients, and then finally use this new calibration to predict the 3D coordinate of the other half of the control points. We repeat this procedure 100 times and record the error in the predictions for each iteration, which yields a distribution of errors along each axis for the camera calibration (<xref rid="figS1" ref-type="fig">Figure 2-S1B</xref>). We found that the error distribution for each camera calibration is well-described by a normal distribution, and that reconstruction error is low, on the order of &lt;50μm for each axis (<xref rid="figS1" ref-type="fig">Figure 2-S1C</xref>).</p>
<p>We then performed error propagation to investigate the extent to which DLT error affects our findings. To do this, we performed 1000 simulations of error propagation for each 3D-reconstructed point by random sampling from the DLT camera calibration’s error distribution to obtain 1000 simulated legs. We used these simulated legs to measure the spring constant. We found that the resulting distributions of spring constants were in a small range (<xref rid="figS1" ref-type="fig">Figure 2-S1D</xref> and <xref rid="figS2" ref-type="fig">2-S1E</xref>).</p>
</sec>
<sec id="s4e">
<label>4.</label>
<title>Evaluating the limitation of the linear approximation</title>
<p>Our data clearly indicates that passive forces can be approximated by a linear spring. However, the leg does not settle in the same position over multiple trials. One reason for this variation is that there are many degrees of freedom within the leg; the many degrees of freedom mean that the gravitational torque can cause displacement along any degree of freedom. One consequence of these multiple degrees of freedom is that the torque produced along a given degree of freedom is dependent on how the body is rotated. Rotating the body along its long axis causes a large torque along the levation-depression joint, and a small torque along the extension-flexion axis. The converse is true for rotation along the fly’s short axis.</p>
<p>Another consequence is that the variation in torque within the same experimental condition, i.e., body rotation. Some of this variation is because there is some coupling between different degrees of freedom (DOFs). A full analysis of this coupling is beyond the scope of this study. We performed some analyses to show that some of the variation comes from coupling from other DOFs.</p>
<p>To test whether joint torque variability correlates with actions at other DOFs, we obtained the residuals from our angle-torque fits and correlated these with the corresponding angles denoting the other DOFs. We found that in the majority of cases the analyzed residuals exhibit a correlation with angles at other DOFs, suggesting that residual torques for one DOF can be affected by movement at other DOFs (<xref rid="figS3" ref-type="fig">Figure 2-S3A</xref>). To further investigate this coupling, we performed regression using multiple combinations of angles to predict levation-depression torque and determine whether a better fit is obtained for the fly. We found that multiple regression results in a closer fit by plotting R<sup>2</sup> vs. the combination of angle DOF predictors (<xref rid="figS3" ref-type="fig">Figure 2-S3B</xref>). The regression model for levation-depression torque (τ<sub><italic>θ</italic></sub>) thus can be described with retraction-protraction (<italic>φ</italic>) using the following regression model, where the passive torque equals the torque due to gravity (τ<sub><italic>G</italic></sub>) at equilibrium with τ<sub>0</sub> the y-intercept and τ<sub><italic>I</italic></sub> the torque due to other internal forces in the joint:
<disp-formula id="eqn16">
<graphic xlink:href="651225v2_eqn23.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Using the stiffness coefficients κ<sub><italic>θ</italic></sub> and κ<sub><italic>φ</italic></sub> obtained from the multiple regression model, the effective angle due to <italic>φ</italic> thus becomes:
<disp-formula id="eqn17">
<graphic xlink:href="651225v2_eqn24.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
By plotting this effective angle vs. torque, we show that the fit is indeed improved due to the inclusion of the other DOF (<xref rid="figS3" ref-type="fig">Figure 2-S3C</xref>). Since the effective angles produced by the estimated coefficients from the multiple regression fits yield lower R<sup>2</sup> values for LD torque than when only using the LD angle, it suggests that LD torque variation is partially explained by coupled actions at multiple DOFs.</p>
</sec>
<sec id="s4f">
<label>5.</label>
<title>Experiments in freely walking flies</title>
<p>Inactivation experiments to assess whether a freely-moving fly falls when its motor neurons are inactivated were performed in a walking chamber.</p>
<p>Flies were placed in a rectangular plastic chamber measuring 25mm × 10mm × 10mm (LxWxH) and left to acclimate for 10 minutes before starting the experiment. The flies were imaged using two USB 3.0 Basler acA1920-150 μm cameras (100Hz, 960 px x 520 px) equipped with telocentric lenses on both cameras (Edmund Optics 0.40x SilverTL, part number 56-677) to record the video at 100 fps at 960×520 resolution. A filter was placed on the lens to block visible light (720nm infrared filter, Hoya B-52RM72-GB). The flies were illuminated with 850nm high-powered LED (ThorLabs #M850L3). Trials were designed in the following way: 5 seconds of control conditions were followed by 15 seconds of inactivation and concluded by 5 seconds of control conditions. During the inactivation period, the flies were irradiated with green light (Thor Labs #M530L3). We collected 88 trials from 8 flies (with a minimum of 7 and a maximum of 12 trials per fly) where flies were located at the bottom of the chamber right before the onset of inactivation period.</p>
<p>The head of the fly was automatically tracked using DeepLabCut (DLC; Mathis et al., 2018). Briefly, the head was manually annotated on unique frames manually extracted from the recordings of the 8 flies within the dataset and we trained 4 distinct Resnet-50 (He et al., 2016) for the 2 mirror-reflected views, the central top view and bottom view.</p>
<p>To transform the two-dimensional camera coordinates from each of the four views into a single set of three-dimensional world coordinates, triangulation was performed. The position of a fluorescent microbead fixed at the tip of a pulled glass micropipette and moved using a micromanipulator was captured using a custom-made MATLAB interface (GUI). Briefly, images of the microbead at 130 known positions were taken and the position of the bead semi-automatically detected 3 times in the top camera view (in the 2 mirror reflections as well as the real chamber) and once in the bottom view. Triangulation was performed using direct linear transformation (DLT); the mean squared error was 49 μm.</p>
<p>The resulting transformation matrix was used to transform the 4 sets of head coordinates in the camera reference frame provided by the automatic DLC tracking to generate the fly’s head in world coordinates.</p>
</sec>
<sec id="s4g">
<label>6.</label>
<title>Simulation in OpenSim</title>
<p>To determine the degree to which our experimentally determined stiffness values at each degree of freedom are sufficient to support the legs, we incorporate these forces into a mechanical model of the fly and simulate this model dropping onto a platform with the force of gravity. The mechanical model derived from the fly’s anatomy (<xref rid="fig4" ref-type="fig">Figure 4A</xref>) was generated in OpenSim 4.1[<xref ref-type="bibr" rid="c18">18</xref>]. MATLAB integration modules were used to generate the model by defining rigid bodies interconnected by joints. The dimensions, masses, and center of mass positions for each body segment were obtained from previous experimental measurements and from earlier work[<xref ref-type="bibr" rid="c31">31</xref>]. Each body segment was approximated as an ellipsoid (dimensions in <xref rid="tbl2" ref-type="table">Table 2</xref>). To model the leg joint dynamics, we introduced a ball joint at the <italic>ThC</italic> with three degrees of freedom corresponding to protraction-retraction, pronation-supination, and levation-depression, as well as a hinge joint at the <italic>FTi</italic> with one degree of freedom for extension-flexion. The initial angles at these joints were estimated from measured equilibrium leg positions at zero torque. We kept the <italic>CTr</italic> and <italic>TiTa</italic> joints locked in their equilibrium positions. To model the angular spring properties of the leg, we introduce a torsional spring force at each degree-of-freedom with a stiffness that corresponds to each of our experimentally measured values for each leg. For the mesothoracic leg: 8.614 E-9 mN·m/° for levation-depression, 1.01 E-8 mN·m/° for retraction-protraction, 1.202 E-8 mN·m/° for extension-flexion, and 9.873 E-8 mN·m/° for pronation-supination. To simulate the forces arising from the legs contacting with the platform, we introduced Hunt-Crossley forces between the leg tip and platform geometries. We set a maximum simulation time of 0.3 seconds, which we established was enough time for the model to reach a final equilibrium resting position (<xref rid="fig4" ref-type="fig">Figure 4B</xref>). We found that the experimental stiffness was not sufficient to support the body, and thus we scaled the stiffness values by different magnitudes to determine how much the stiffness had to be scaled to support the body (<xref rid="fig4" ref-type="fig">Figure 4C</xref>). We found that the model transitions to a stable support position – i.e., the model does not fall - when scaling 40-fold. In addition, a scaling value of 1,000 exhibits high stiffness as the equilibrium position approaches the initial equilibrium joint positions. To determine the relationship between the model’s resting equilibrium position and joint stiffness, we plotted scaling values with the model’s final thorax center-of-mass height at the end of 0.3 seconds (<xref rid="fig4" ref-type="fig">Figure 4D</xref>).</p>
<p>The fly model with these properties was dropped to the floor. The contact between the ground and each of the legs was described using the Hunt Crossley Forces. The model bounces on the floor a few times before stabilizing at its equilibrium configuration and height.</p>
</sec>
<sec id="s4h">
<label>7.</label>
<title>OpenSim simulation to determine how fast the active forces decay (<xref rid="fig6" ref-type="fig">Figure 6</xref>)</title>
<p>The goal of the OpenSim model in <xref rid="fig6" ref-type="fig">Figure 6</xref> was to assess the time course by which the active forces decay for the median fall. The median height of the fly was 0.5 mm. The height of the fly depends on the active forces before the light is turned on, and the active forces can be predicted from the height of the fly. We assumed that when MNs are inhibited, the active forces will decay exponentially to asymptote to the passive forces. In other words, <italic>f(t)</italic> – the force as a function of time – is given by <italic>f</italic>(<italic>t</italic>) = <italic>f</italic><sub><italic>a</italic></sub> · <italic>e</italic><sup>−<italic>t</italic>/<italic>τ</italic></sup> + <italic>f</italic><sub><italic>p</italic></sub>. Here <italic>f</italic><sub><italic>a</italic></sub> and <italic>f</italic><sub><italic>p</italic></sub> <italic>a</italic>re active and passive forces, respectively. The τ represents the time constant of the decay of the active forces. We simulated the decay with different time-constants ranging from 0.1 seconds to 1 seconds. Data for 0.1 second, 0.2 second, and 0.3 second are presented.</p>
</sec>
<sec id="s4i">
<label>8.</label>
<title>Electrophysiology recordings of motor neurons</title>
<p>Flies were anesthetized on ice and placed ventral side up in a custom-made chamber. The head was pitched backwards to make room for patch electrode, and the head and thorax was secured in place using wax. The front legs were pulled out and fixed to the side of the body using wax to enable the dissection of the cuticle above the thorax. A small window was made in the cuticle covering the first and second thoracic segment under external saline (103 mmol/L NaCl, 5 mmol/L KCl, 5 mmol/L Tris, 10 mmol/L glucose, 26 mmol/L NaHC03, 1 mmol/L NaH2P04, 1.5 mmol/L CaCl2, 4 mmol/L MgCl2, osmolarity adjusted to 270–285 mOsm, bubbled with 95% O2/5% CO2 to pH 7.1–7.4). The trachea and perineuronal sheath around the first ganglia were removed with fine forceps. Leg motor neurons were targeted for recording by expression of the light-gated anion channel GtACR1 tagged with EYFP, visualized using an Olympus BX51W1 upright microscope equipped with epifluorescence and standard filters. Glass electrodes containing internal solution were used to carry out whole-cell recordings (electrode resistance ranged from 5 to 10 MΩ; 140 mmol/L K-aspartate, 1 mmol/L KCl, 10 mmol/L HE-PES, 1 mmol/L EGTA, 0.5 mmol/L Na3GTP, 4 mmol/L MgATP, 265–270 mOsm, pH 7.1–7.4). Voltage was recorded at 10 kHz using a model 2400 patch-clamp amplifier (A-M systems) and low-pass filtered at 5 kHz.</p>
<p>To optogenetically inhibit the motor neuron we used a digital mirror device(DMD) which is a projector that allows the stimulation of any arbitrary ROI. The construction of the digital mirror device has already described in detail recently[<xref ref-type="bibr" rid="c32">32</xref>]. During each trial, light spots with 530nm wavelength will be projected onto the patched MN or other neurons in the brain for 5s, then have 5s recovery period and was repeated multiple times.</p>
</sec>
</sec>

</body>
<back>
<sec>
<fig id="figS1" position="float" fig-type="figure">
<label>Figure 2-S1.</label>
<caption><title>Reconstruction errors resulting from the camera calibration are small.</title>
<p><bold>A</bold>.To test the accuracy of calibration coefficients obtained from the DLT camera calibration, we used inverse DLT to obtain pixel coordinates from the 3D-reconstructed XYZ leg joint positions and overlaid these points on the corresponding frames. The reconstructed leg segments lie on top of the actual leg.</p>
<p><bold>B</bold>.Error distribution across each axis for DLT camera calibrations used for 3D reconstruction of leg kinematics. Error values were obtained by 100 iterations of random subsampling of control points into two sets: The training set for calculating calibration coefficients and the testing set for evaluating prediction accuracy.</p>
<p><bold>C</bold>.The error distribution for each camera calibration is well-captured by a normal distribution.</p>
<p><bold>D</bold>.We sampled from the Gaussian distribution in C to create 1000 simulated legs. This figure shows 4 randomly selected simulations. The first panel shows the original data, while the other four show randomly selected iterations. The variation in results due to DLT error propagation is small.</p>
<p><bold>E</bold>.Final stiffness distributions for levation-depression from all 1000 iterations of DLT error propagation simulations show that variation in results due to DLT error is small.</p></caption>
<graphic xlink:href="651225v2_fig2_S1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Figure 2-S2.</label>
<caption><title>Larger weight and silencing octopaminergic neurons does not affect spring constant measurements.</title>
<p><bold>A</bold>. Standard deviations (SDs) of joint angle values across experimental conditions: x20 etc. refers to the mass of the additional weight. x20, x50, x100 means 20,50,100 times the mass of the leg, respectively. Three masses were used. Tdc2 refers to the case when both glutamatergic and octopaminergic neurons are silenced. Tdc2 experiments were performed with x50 weight. Joint angle SD values per trial for each experimental condition. Probability density functions for trial joint angle SDs by experimental condition. Higher weight reduces the standard deviation. There is no further decrease in SD when both glutamatergic and octopaminergic neurons are silenced.</p>
<p><bold>B</bold>.Stiffness values obtained from experiments with higher weights and when octopaminergic neurons are inactivated. The values lie within the interquartile range observed with the smaller weights.</p>
<p>Octopaminergic neuromodulation is silenced optogenetically along with motor neurons using the genetic construct Tdc2-Gal4;UAS-GtACR1(lll) x VGlut(OK371)-Gal4(ll). For all other flies, only motor neurons are optogenetically silenced via the construct VGlut(OK371)-Gal4(ll) x UAS-GtACR1(lll).</p></caption>
<graphic xlink:href="651225v2_fig2_S2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Figure 2-S3.</label>
<caption><title>Variation in torque can be explained by the coupled actions of multiple degrees of freedom, as well as other internal forces.</title>
<p><bold>A</bold>.Examples showing that the angle at one degree of freedom is correlated with residuals (torque that is not explained by changes at the original angle) in other degrees of freedom suggesting that torque variation at one degree of freedom (DOF) may depend on other DOFs. As an explicit example of this analysis, for the leftmost panel in A, we first fit the retraction-protraction torque to the changes in retraction-protraction angle as shown in <xref rid="fig2" ref-type="fig">Figures 2</xref>-<xref rid="fig3" ref-type="fig">3</xref>. Residuals are calculated as the difference between the actual torque and linear fit and are plotted here against the value of the levation-depression angle on the same torque. A significant correlation is found in &gt;60% of cases implying a coupling between the different angles. Importantly, these correlations are likely to be second-order effects.</p>
<p><bold>B</bold>.Using multiple DOF angles to predict levation-depression (LD) torque results in a higher R-squared value than when using only the LD angle. We did not perform this analysis systematically. However, in the 6 flies (just to test the idea), we performed the analysis on we found that there was a much higher correlation when other degrees of freedom were used. Extension-flexion degrees of freedom seem to have a particularly large effect. Levation-depression for two of the flies are shown.</p></caption>
<graphic xlink:href="651225v2_fig2_S3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<ack>
<title>Acknowledgments</title>
<p>We would like to acknowledge the members of Bhandawat lab for discussions. Amoolya Tirumalai helped with initial experiments, Kate Medrano with analysis, and Michael Matthews with OpenSim. This research was supported by RO1DC015827 (VB), RO1NS097881 (VB) and an NSF CAREER award (IOS-1652647 to VB).</p>
</ack>
<sec id="d1e1677" sec-type="additional-information">
<title>Additional information</title>
<sec id="s5">
<title>Author contributions</title>
<p>VB: Conceptualization; Supervision; Funding acquisition; Writing;analysis. NW: Experimentation, analysis. HB: Experimentation, analysis. JP: Experimentation, analysis;. SBM: Experimentation, analysis; TB: Conceptualization, analysis, writing; AR: Conceptualization, analysis,</p>
</sec>
</sec>
<sec id="suppd1e1677" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="d1e1661">
<label>Supplementary Video 1.</label>
<caption><title>Example video of a tethered fly prep with inactivation phases.</title> <p>Experimental fly in tethered prep experiences two phases of inactivation with attached weight (0.19mg). Inactivation time is indicated by the “on” cue in the top right corner of the video.</p></caption>
<media xlink:href="supplements/651225_file03.mp4"/>
</supplementary-material>
<supplementary-material id="d1e1668">
<label>Supplementary Video 2.</label>
<caption><title>Overview of the 3D biomechanical model with simulated joint stiffness parameters.</title> <p>Video showing an overview of the <italic>Drosophila</italic> 3D biomechanical model developed in OpenSim 4.1. This includes a rotated model of the fly as well as a 100ms simulation of the falling fly with joint stiffness values scaled by 80.</p></caption>
<media xlink:href="supplements/651225_file04.mp4"/>
</supplementary-material>
</sec>
<ref-list>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hooper</surname>, <given-names>S.L.</given-names></string-name>, <string-name><surname>Guschlbauer</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Blümel</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Rosenbaum</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Gruhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Akay</surname>, <given-names>T.</given-names></string-name>, and <string-name><surname>Büschges</surname>, <given-names>A.</given-names></string-name></person-group> (<year>2009</year>). <article-title>Neural control of unloaded leg posture and of leg swing in stick insect, cockroach, and mouse differs from that in larger animals</article-title>. <source>Journal of Neuroscience</source> <volume>29</volume>, <fpage>4109</fpage>–<lpage>4119</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frazier</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Larsen</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Neff</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Quimby</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Carney</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>DiCaprio</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Zill</surname>, <given-names>S.</given-names></string-name></person-group> (<year>1999</year>). <article-title>Elasticity and movements of the cockroach tarsus in walking</article-title>. <source>Journal of Comparative Physiology A</source> <volume>185</volume>, <fpage>157</fpage>–<lpage>172</lpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zakotnik</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Matheson</surname>, <given-names>T.</given-names></string-name>, and <string-name><surname>Dürr</surname>, <given-names>V.</given-names></string-name></person-group> (<year>2006</year>). <article-title>Co-contraction and passive forces facilitate load compensation of aimed limb movements</article-title>. <source>Journal of Neuroscience</source> <volume>26</volume>, <fpage>4995</fpage>–<lpage>5007</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ache</surname>, <given-names>J.M.</given-names></string-name>, and <string-name><surname>Matheson</surname>, <given-names>T.</given-names></string-name></person-group> (<year>2012</year>). <article-title>Passive resting state and history of antagonist muscle activity shape active extensions in an insect limb</article-title>. <source>Journal of neurophysiology</source> <volume>107</volume>, <fpage>2756</fpage>–<lpage>2768</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ache</surname>, <given-names>J.M.</given-names></string-name>, and <string-name><surname>Matheson</surname>, <given-names>T.</given-names></string-name></person-group> (<year>2013</year>). <article-title>Passive joint forces are tuned to limb use in insects and drive movements without motor activity</article-title>. <source>Current Biology</source> <volume>23</volume>, <fpage>1418</fpage>–<lpage>1426</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>von Twickel</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Guschlbauer</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Hooper</surname>, <given-names>S.L.</given-names></string-name>, and <string-name><surname>Bueschges</surname>, <given-names>A.</given-names></string-name></person-group> (<year>2019</year>). <article-title>Swing velocity profiles of small limbs can arise from transient passive torques of the antagonist muscle alone</article-title>. <source>Current Biology</source> <volume>29</volume>, <fpage>1</fpage>–<lpage>12.e17</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Page</surname>, <given-names>K.L.</given-names></string-name>, <string-name><surname>Zakotnik</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Durr</surname>, <given-names>V.</given-names></string-name>, and <string-name><surname>Matheson</surname>, <given-names>T.</given-names></string-name></person-group> (<year>2008</year>). <article-title>Motor control of aimed limb movements in an insect</article-title>. <source>Journal of neurophysiology</source> <volume>99</volume>, <fpage>484</fpage>–<lpage>499</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname>, <given-names>M.M.</given-names></string-name>, <string-name><surname>Pai</surname>, <given-names>D.K.</given-names></string-name>, <string-name><surname>Tresch</surname>, <given-names>M.C.</given-names></string-name>, and <string-name><surname>Sandercock</surname>, <given-names>T.G.</given-names></string-name></person-group> (<year>2012</year>). <article-title>Passive elastic properties of the rat ankle</article-title>. <source>Journal of biomechanics</source> <volume>45</volume>, <fpage>1728</fpage>–<lpage>1732</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dudek</surname>, <given-names>D.M.</given-names></string-name>, and <string-name><surname>Full</surname>, <given-names>R.J.</given-names></string-name></person-group> (<year>2006</year>). <article-title>Passive mechanical properties of legs from running insects</article-title>. <source>Journal of Experimental Biology</source> <volume>209</volume>, <fpage>1502</fpage>–<lpage>1515</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dudek</surname>, <given-names>D.M.</given-names></string-name>, and <string-name><surname>Full</surname>, <given-names>R.J.</given-names></string-name></person-group> (<year>2007</year>). <article-title>An isolated insect leg’s passive recovery from dorso-ventral perturbations</article-title>. <source>Journal of Experimental Biology</source> <volume>210</volume>, <fpage>3209</fpage>–<lpage>3217</lpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hooper</surname>, <given-names>S.L.</given-names></string-name></person-group> (<year>2012</year>). <article-title>Body size and the neural control of movement</article-title>. <source>Current Biology</source> <volume>22</volume>, <fpage>R318</fpage>–<lpage>R322</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Naris</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Szczecinski</surname>, <given-names>N.S.</given-names></string-name>, and <string-name><surname>Quinn</surname>, <given-names>R.D.</given-names></string-name></person-group> (<year>2020</year>). <article-title>A neuromechanical model exploring the role of the common inhibitor motor neuron in insect locomotion</article-title>. <source>Biological cybernetics</source> <volume>114</volume>, <fpage>23</fpage>–<lpage>41</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Binder-Markey</surname>, <given-names>B.I.</given-names></string-name>, and <string-name><surname>Murray</surname>, <given-names>W.M.</given-names></string-name></person-group> (<year>2017</year>). <article-title>Incorporating the length-dependent passive-force generating muscle properties of the extrinsic finger muscles into a wrist and finger biomechanical musculoskeletal model</article-title>. <source>Journal of biomechanics</source> <volume>61</volume>, <fpage>250</fpage>–<lpage>257</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Charles</surname>, <given-names>S.K.</given-names></string-name>, and <string-name><surname>Hogan</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2012</year>). <article-title>Stiffness, not inertial coupling, determines path curvature of wrist motions</article-title>. <source>Journal of neurophysiology</source> <volume>107</volume>, <fpage>1230</fpage>–<lpage>1240</lpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peaden</surname>, <given-names>A.W.</given-names></string-name>, and <string-name><surname>Charles</surname>, <given-names>S.K.</given-names></string-name></person-group> (<year>2014</year>). <article-title>Dynamics of wrist and forearm rotations</article-title>. <source>Journal of biomechanics</source> <volume>47</volume>, <fpage>2779</fpage>–<lpage>2785</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Souza</surname>, <given-names>T.R.</given-names></string-name>, <string-name><surname>Fonseca</surname>, <given-names>S.T.</given-names></string-name>, <string-name><surname>Gonçalves</surname>, <given-names>G.G.</given-names></string-name>, <string-name><surname>Ocarino</surname>, <given-names>J.M.</given-names></string-name>, and <string-name><surname>Mancini</surname>, <given-names>M.C.</given-names></string-name></person-group> (<year>2009</year>). <article-title>Prestress revealed by passive co-tension at the ankle joint</article-title>. <source>Journal of biomechanics</source> <volume>42</volume>, <fpage>2374</fpage>–<lpage>2380</lpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mohammad</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Stewart</surname>, <given-names>J.C.</given-names></string-name>, <string-name><surname>Ott</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Chlebikova</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Chua</surname>, <given-names>J.Y.</given-names></string-name>, <string-name><surname>Koh</surname>, <given-names>T.-W.</given-names></string-name>, <string-name><surname>Ho</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Claridge-Chang</surname>, <given-names>A.</given-names></string-name></person-group> (<year>2017</year>). <article-title>Optogenetic inhibition of behavior with anion channelrhodopsins</article-title>. <source>Nature methods</source> <volume>14</volume>, <fpage>271</fpage>–<lpage>274</lpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Delp</surname>, <given-names>S.L.</given-names></string-name>, <string-name><surname>Anderson</surname>, <given-names>F.C.</given-names></string-name>, <string-name><surname>Arnold</surname>, <given-names>A.S.</given-names></string-name>, <string-name><surname>Loan</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Habib</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>John</surname>, <given-names>C.T.</given-names></string-name>, <string-name><surname>Guendelman</surname>, <given-names>E.</given-names></string-name>, and <string-name><surname>Thelen</surname>, <given-names>D.G.</given-names></string-name></person-group> (<year>2007</year>). <article-title>OpenSim: open-source software to create and analyze dynamic simulations of movement</article-title>. <source>IEEE transactions on biomedical engineering</source> <volume>54</volume>, <fpage>1940</fpage>–<lpage>1950</lpage>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathis</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Mamidanna</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Cury</surname>, <given-names>K.M.</given-names></string-name>, <string-name><surname>Abe</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Murthy</surname>, <given-names>V.N.</given-names></string-name>, <string-name><surname>Mathis</surname>, <given-names>M.W.</given-names></string-name>, and <string-name><surname>Bethge</surname>, <given-names>M.</given-names></string-name></person-group> (<year>2018</year>). <article-title>DeepLabCut: markerless pose estimation of user-defined body parts with deep learning</article-title>. <source>Nature neuroscience</source> <volume>21</volume>, <fpage>1281</fpage>–<lpage>1289</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pratt</surname>, <given-names>B.G.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>S.-Y.J.</given-names></string-name>, <string-name><surname>Chou</surname>, <given-names>G.M.</given-names></string-name>, and <string-name><surname>Tuthill</surname>, <given-names>J.C.</given-names></string-name></person-group> (<year>2024</year>). <article-title>Miniature linear and split-belt treadmills reveal mechanisms of adaptive motor control in walking Drosophila</article-title>. <source>Current Biology</source> <volume>34</volume>, <fpage>4368</fpage>–<lpage>4381.e4365</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Azevedo</surname>, <given-names>A.W.</given-names></string-name>, <string-name><surname>Dickinson</surname>, <given-names>E.S.</given-names></string-name>, <string-name><surname>Gurung</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Venkatasubramanian</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Mann</surname>, <given-names>R.S.</given-names></string-name>, and <string-name><surname>Tuthill</surname>, <given-names>J.C.</given-names></string-name></person-group> (<year>2020</year>). <article-title>A size principle for recruitment of Drosophila leg motor neurons</article-title>. <source>eLife</source> <volume>9</volume>, <elocation-id>e56754</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.56754</pub-id></mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Full</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Ahn</surname>, <given-names>A.</given-names></string-name></person-group> (<year>1995</year>). <article-title>Static forces and moments generated in the insect leg: comparison of a three-dimensional musculo-skeletal computer model with experimental measurements</article-title>. <source>The Journal of experimental biology</source> <volume>198</volume>, <fpage>1285</fpage>–<lpage>1298</lpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soler</surname>, <given-names>C.d.</given-names></string-name>, <string-name><surname>Daczewska</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Da Ponte</surname>, <given-names>J.P.</given-names></string-name>, <string-name><surname>Dastugue</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Jagla</surname>, <given-names>K.</given-names></string-name></person-group> (<year>2004</year>). <article-title>Coordinated development of muscles and tendons of the Drosophilaleg</article-title>. <source>Development</source> <volume>131</volume>, <fpage>6041</fpage>–<lpage>6051</lpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guschlbauer</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Hooper</surname>, <given-names>S.L.</given-names></string-name>, <string-name><surname>Mantziaris</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Schwarz</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Szczecinski</surname>, <given-names>N.S.</given-names></string-name>, and <string-name><surname>Büschges</surname>, <given-names>A.</given-names></string-name></person-group> (<year>2022</year>). <article-title>Correlation between ranges of leg walking angles and passive rest angles among leg types in stick insects</article-title>. <source>Current Biology</source> <volume>32</volume>, <fpage>2334</fpage>–<lpage>2340.e3</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wolf</surname>, <given-names>H.</given-names></string-name></person-group> (<year>2014</year>). <article-title>Inhibitory motoneurons in arthropod motor control: organisation, function, evolution</article-title>. <source>Journal of Comparative Physiology A</source> <volume>200</volume>, <fpage>693</fpage>–<lpage>710</lpage>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abbott</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Lowy</surname>, <given-names>J.</given-names></string-name></person-group> (<year>1957</year>). <article-title>Stress relaxation in muscle</article-title>. <source>Proceedings of the Royal Society of London. Series B-Biological Sciences</source> <volume>146</volume>, <fpage>281</fpage>–<lpage>288</lpage>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guschlbauer</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Scharstein</surname>, <given-names>H.</given-names></string-name>, and <string-name><surname>Büschges</surname>, <given-names>A.</given-names></string-name></person-group> (<year>2007</year>). <article-title>The extensor tibiae muscle of the stick insect: biomechanical properties of an insect walking leg muscle</article-title>. <source>Journal of Experimental Biology</source> <volume>210</volume>, <fpage>1092</fpage>–<lpage>1108</lpage>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bässler</surname>, <given-names>U.</given-names></string-name>, <string-name><surname>Wolf</surname>, <given-names>H.</given-names></string-name>, and <string-name><surname>Stein</surname>, <given-names>W.</given-names></string-name></person-group> (<year>2007</year>). <article-title>Functional recovery following manipulation of muscles and sense organs in the stick insect leg</article-title>. <source>Journal of Comparative Physiology A</source> <volume>193</volume>, <fpage>1151</fpage>–<lpage>1168</lpage>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blümel</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Hooper</surname>, <given-names>S.L.</given-names></string-name>, <string-name><surname>Guschlbauerc</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>White</surname>, <given-names>W.E.</given-names></string-name>, and <string-name><surname>Büschges</surname>, <given-names>A.</given-names></string-name></person-group> (<year>2012</year>). <article-title>Determining all parameters necessary to build Hill-type muscle models from experiments on single muscles</article-title>. <source>Biological cybernetics</source> <volume>106</volume>, <fpage>543</fpage>–<lpage>558</lpage>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hedrick</surname>, <given-names>T.L.</given-names></string-name></person-group> (<year>2008</year>). <article-title>Software techniques for two-and three-dimensional kinematic measurements of biological and biomimetic systems</article-title>. <source>Bioinspiration &amp; biomimetics</source> <volume>3</volume>, <fpage>034001</fpage>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ramdya</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Thandiackal</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Cherney</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Asselborn</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Benton</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Ijspeert</surname>, <given-names>A.J.</given-names></string-name>, and <string-name><surname>Floreano</surname>, <given-names>D.</given-names></string-name></person-group> (<year>2017</year>). <article-title>Climbing favours the tripod gait over alternative faster insect gaits</article-title>. <source>Nature communications</source> <volume>8</volume>, <fpage>1</fpage>–<lpage>11</lpage>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tao</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Ayembem</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Barranca</surname>, <given-names>V.J.</given-names></string-name>, and <string-name><surname>Bhandawat</surname>, <given-names>V.</given-names></string-name></person-group> (<year>2024</year>). <article-title>Neurons underlying aggression-like actions that are shared by both males and females in Drosophila</article-title>. <source>Journal of Neuroscience</source> <volume>44</volume> <elocation-id>e0142242024</elocation-id>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.107390.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Berman</surname>
<given-names>Gordon J</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<contrib-id authenticated="true" contrib-id-type="orcid">http://orcid.org/0000-0003-3588-7820</contrib-id>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/03czfpz43</institution-id><institution>Emory University</institution>
</institution-wrap>
<city>Atlanta</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>valuable</bold> study introduces a novel experimental and modeling framework to quantify passive joint torques in Drosophila, revealing that passive forces are insufficient to support body weight, contrary to prior assumptions based on larger insects. The approach is technically impressive, combining genetic silencing, kinematic tracking, and biomechanical modeling. However, the strength of evidence is <bold>incomplete</bold>, limited by concerns about the specificity of the genetic tools, simplifications in the mechanical model, and limited functional interpretation.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.107390.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this work, Wang et al. use a combination of genetic tools, novel experimental approaches and biomechanical models to quantify the contribution of passive leg forces in Drosophila. They also deduce that passive forces are not sufficient to support the body weight of the animal. Overall, the contribution of passive forces reported in this work is much less than what one would expect based on the size of the organism and previous literature from larger insects and mammals. This is an interesting finding, but some major caveats in their approach remain unanswered.</p>
<p>Strengths:</p>
<p>(1) The authors combine experimental measurements and modeling to quantify the contributions of passive forces at limb joints in Drosophila.</p>
<p>(2) The authors replicate a previous experimental strategy (Hooper et al 2009, J. Neuro) to suspend animals in air for measuring passive forces and, as in previous studies, find that passive forces are much stronger than gravitational forces acting on the limbs. While in these previous studies using large insects, a lot of invasive approaches for accurately quantifying passive forces are possible (e.g., physically cutting of nerves, directly measuring muscle forces in isolated preparations, etc), the small size of Drosophila makes this difficult. The authors overcome this using a novel approach where they attach additional weight to the leg (changes gravitational force) and inactivate motor neurons (remove active forces). With a few approximations and assumptions, the authors then deduce the contribution of passive forces at each joint for each leg.</p>
<p>(3) The authors find interesting differences in passive forces across different legs. This could have behavioral implications.</p>
<p>(4) Finally, the authors compare experimental results of how a free-standing Drosophila is lowered (&quot;falls down&quot;) on silencing motor neurons, to a biomechanical &quot;OpenSim&quot; model for deducing the role of passive forces in supporting the body weight of the fly. Using this approach, they conclude that passive forces are not sufficient to support the body weight of the fly.</p>
<p>Weaknesses:</p>
<p>(1) Line 65 &quot;(Figure 1A). Inactivation causes a change in the leg's rest position; however, in preliminary experiments, the body rotation did not have a large effect on the rest positions of the leg following inactivation. This result is consistent with the one already reported for stick insects and shows that passive forces within the leg are much larger than the gravitational force on a leg and dominate limb position [1].&quot; This is the direct replication of the previous work by Hooper et al 2009 and therefore authors should ideally show the data for this condition (no weight attached).</p>
<p>(2) The authors use vglut-gal4, a very broad driver for inactivating motor neurons. The driver labels all glutamatergic neurons, including brain descending neurons and nerve cord interneurons, in addition to motor neurons. Additionally, the strength of inactivation might differ in different neurons (including motor neurons) depending on the expression levels of the opsins. As a result, in this condition, the authors might not be removing all active forces. This is a major caveat that authors do not address. They explore that they are not potentially silencing all inputs to muscles by using an additional octopaminergic driver, but this doesn't address the points mentioned above. At the very least, the authors should try using other motor neuron drivers, as well as other neuronal silencers. This driver is so broad that authors couldn't even use it for physiology experiments. Additionally, the authors could silence VGlut-labeled motor neurons and record muscle activity (potentially using GCaMP as has been done in several recent papers cited by the authors, Azevedo et al, 2020) as a much more direct readout.</p>
<p>(3) Figure 4 uses an extremely simplified OpenSim model that makes several assumptions that are known to be false. For example, the Thorax-Coxa joint is assumed to be a ball and socket joint, which it is not. Tibia-tarsus joint is completely ignored and likely makes a major contribution in supporting overall posture, given the importance of the leg &quot;claw&quot; for adhering to substrates. Moreover, there are a couple of recent open-source neuromechanical models that include all these details (NeuromechFly by Lobato-Rios et al, 2022, Nat. Methods, and the fly body model by Vaxenburg et al, 2025, Nature). Leveraging these models to rule in or rule out contributions at other joints that are ignored in the authors' OpenSim model would be very helpful to make their case.</p>
<p>(4) Figure 5 shows the experimental validation of Figure 4 simulations; however, it suffers from several caveats.</p>
<p>a) The authors track a single point on the head of the fly to estimate the height of the fly. This has several issues. Firstly, it is not clear how accurate the tracking would be. Secondly, it is not clear how the fly actually &quot;falls&quot; on VGlut silencing; do all flies fall in a similar manner in every trial? Almost certainly, there will be some &quot;pitch&quot; and &quot;role&quot; in the way the fly falls. These will affect the location of this single-tracked point that doesn't reflect the authors' expectations. Unless the authors track multiple points on the fly and show examples of tracked videos, it is hard to believe this dataset and, hence, any of the resulting interpretations.</p>
<p>b) As described in the previous point, the &quot;reason&quot; the fly falls on silencing all glutamatergic neurons could be due to silencing all sorts of premotor/interneurons in addition to the silencing of motor neurons.</p>
<p>c) (line 175) &quot;The first finding is that there was a large variation in the initial height of the fly (Figure 5C), consistent with a recent study of flies walking on a treadmill[20].&quot; The cited paper refers to how height varies during &quot;walking&quot;. However, in the current study, the authors are only looking at &quot;standing&quot; (i.e. non-walking) flies. So it is not the correct reference. In my opinion, this could simply reflect poor estimation of the fly's height based on poor tracking or other factors like pitch and role.</p>
<p>d) &quot;The rate at which the fly fell to the ground was much smaller in the experimental flies than it was in the simulated flies (Figure 5E). The median rate of falling was 1.3 mm/s compared to 37 mm/s for the simulated flies (Figure 5F). (Line 190) The most likely reason for the longer than expected time for the fly to fall is delays associated with motor neuron inactivation and muscle inactivation.&quot; I don't believe this reasoning. There are so many caveats (which I described in the above points) in the model and the experiment, that any of those could be responsible for this massive difference between experiment and modeling. Simply not getting rid of all active forces (inadequate silencing) could be one obvious reason. Other reasons could be that the model is using underestimates of passive forces, as alluded to in point 3.</p>
<p>(5) Final figure (Figure 6) focuses on understanding the time course of neuronal silencing. First of all, I'm not entirely sure how relevant this is for the story. It could be an interesting supplemental data. But it seems a bit tangential. Additionally, it also suffers from major caveats.</p>
<p>a) The authors now use a new genetic driver for which they don't have any behavioral data in any previous figures. So we do not know if any of this data holds true for the previous experiments. The authors perform whole-cell recordings from random unidentified motor neurons labeled by E49-Gal4&gt;GtACR1 to deduce a time constant for behavioral results obtained in the VGlut-Gal4&gt;GtACR1 experiments.</p>
<p>b) The DMD setup is useful for focal inactivation, however, the appropriate controls and data are not presented. Line 200 &quot;A spot of light on the cell body produces as much of the hyperpolarization as stimulating the entire fly (mean of 11.3 mV vs 13.1 mV across 9 neurons). Conversely, excluding the cell body produces only a small effect on the MN (mean of 2.6 mV).&quot; First of all, the control experiment for showing that DMD is indeed causing focal inactivation would be to gradually move the spot of light away from the labeled soma, i.e. to the neighboring &quot;labelled&quot; soma and show that there is indeed focal inactivation. Instead authors move it quite a long distance into unlabeled neuropil. Secondly, I still don't get why the authors are doing this experiment. Even if we believe the DMD is functioning perfectly, all this really tells us is that a random subset motor neurons (maybe 5 or 6 cells, legend is missing this info) labeled by E49-Gal4 is strongly hyperpolarized by its own GtACR1 channel opening, rather than being impacted because of hyperpolarizations in other E49-Gal4 labeled neurons. This has no relevance to the interpretation of any of the VGlut-Gal4 behavioral data. VGLut-Gal4 is much broader and also labels all glutamatergic neurons, most of which are inhibitory interneurons whose silencing could lead to disinhibition of downstream networks.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.107390.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors aim to quantify passive muscle forces in the legs of Drosophila, and test the hypothesis that these forces would be sufficient to support body weight in small insects. They take advantage of the genetic tools available in Drosophila, and use a combination of genetic silencing (optogenetic inactivation of motor neurons), kinematic measurements, and simulations using OpenSim. This integrative toolkit is used to examine the role of passive torques across multiple leg joints. They find that passive forces are weaker than expected - in particular, passive forces were found to be too weak to support the body weight of the fly. This challenges previous scaling assumptions derived from studies in larger insects and has potential implications for our understanding of motor control in small animals.</p>
<p>Strengths:</p>
<p>The primary strength of this work lies in its integration of multiple analyses. By pulling together simulations, kinematic measurements from high-resolution videos, and genetic manipulation, they are able to overcome limitations of past studies. In particular, optogenetic manipulation allowed for measurements to be made in whole animals, and the modeling component is valuable because it both validates experimental findings and elucidates the mechanism behind some of the observed dynamic consequences (e.g., the rapid fall after motor inactivation). The conclusions made in the study are well-supported by the data and could have an impact on a number of fields, including invertebrate neurobiology and bioinspired design.</p>
<p>Weaknesses:</p>
<p>While (as mentioned above) the study's conclusions are well-supported by the results and modeling, limitations arise because of the assumptions made. For instance, using a linear approximation may not hold at larger joint angles, and future studies would benefit from accounting for nonlinearities. Future studies could also delve into the source of passive forces, which is important for more deeply understanding the anatomical and physical basis of the results in this study. For instance, assessments of muscle or joint properties to correlate stiffness values with physical structure might be an area of future consideration</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.107390.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors present a novel method to measure passive joint torques - torques due to internal forces other than active muscle contraction - in the fruit fly: genetically inactivating all motor neurons in intact limb acted upon by a gravitational load results in a change in limb configuration; evaluating the moment equilibrium condition about the limb joints then yields a direct estimate of the passive joint torques. Deactivating all motor neurons in an intact standing fly provided two further conclusions: First, because deactivation causes the fly to drop to the floor, the passive joint torques are deemed insufficient to maintain rotational equilibrium against the body weight; using a multi-body-dynamics simulation, the authors estimate that the passive torques would need to be about 40-80 times higher to maintain a typical posture without active muscle action. Second, a delay between the motor neuron inactivation and the onset of the &quot;free fall&quot; motivates the authors to invoke a simple exponential decay model, which is then used to derive a time constant for muscle deactivation, in robust agreement with direct electro-physiological recordings.</p>
<p>Strengths:</p>
<p>The experimental design that permits determination of passive joint torques is elegant, effective, novel, and altogether excellent; it permits measurements previously impossible. A careful error analysis is presented, and a spectrum of technically challenging methods, including multi-body dynamics and e-phys, is deployed to further interpret and contextualise the results.</p>
<p>Weaknesses:</p>
<p>(1) Passive torques are measured, but only some short speculative statements, largely based on previous work, are offered on their functional significance; some of these claims are not well supported by experimental evidence or theoretical arguments. Passive forces are judged as &quot;large&quot; compared to the weight force of the limb, but the arguably more relevant force is the force limb muscles can generate, which, even in equilibrium conditions, is already about two orders of magnitude larger. The conclusion that passive forces are dynamically irrelevant seems natural, but contrasts with the assertion that &quot;passive forces [...] will have a strong influence on limb kinematics&quot;. As a result, the functional significance of passive joint torques in the fruit fly, if any, remains unclear, and this ambiguity represents a missed opportunity. We now know the magnitude of passive joint torques - do they matter and for what? Are they helpful, for example, to maintain robust neuronal control, or a mechanical constraint that negatively impacts performance, e.g., because they present a sink for muscle work?</p>
<p>(2) The work is framed with a scaling argument, but the assumptions that underpin the associated claims are not explicit and can thus not be evaluated. This is problematic because at least some arguments appear to contradict textbook scaling theory or everyday experience. For example, active forces are assumed to scale with limb volume, when every textbook would have them scale with area instead; and the asserted scaling of passive forces involves some hidden assumptions that demand more explicit discussion to alert the reader to associated limitations. Passive forces are said to be important only in small animals, but a quick self-experiment confirms that they are sufficient to stabilize human fingers or ankles against gravity, systems orders of magnitude larger than an insect limb, in seeming contradiction with the alleged dominance of scale. Throughout the manuscript, there are such and similar inaccuracies or ambiguities in the mechanical framing and interpretation, making it hard to fairly evaluate some claims, and rendering others likely incorrect.</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.107390.1.sa4</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Wang</surname>
<given-names>Ninghan</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Babski</surname>
<given-names>Helene</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Perdomo</surname>
<given-names>Jonathan Elliot</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>McMahan</surname>
<given-names>Sarah Beth</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ramakrishnan</surname>
<given-names>Arun</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Biswas</surname>
<given-names>Tirthabir</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bhandawat</surname>
<given-names>Vikas</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2608-0403</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 1</bold>:</p>
<p>(1) Line 65 &quot;(Figure 1A). Inactivation causes a change in the leg's rest position; however, in preliminary experiments, the body rotation did not have a large effect on the rest positions of the leg following inactivation. This result is consistent with the one already reported for stick insects and shows that passive forces within the leg are much larger than the gravitational force on a leg and dominate limb position [1].&quot; This is the direct replication of the previous work by Hooper et al 2009 and therefore authors should ideally show the data for this condition (no weight attached).</p>
</disp-quote>
<p>We did not present this data – the effect of inactivation on the leg’s rest position in unweighted leg - because it was already reported in the case of stick insects. However, we understand the reviewer’s point that it is important to present the data showing this replication. We will do the same in the revised version.</p>
<disp-quote content-type="editor-comment">
<p>(2) The authors use vglut-gal4, a very broad driver for inactivating motor neurons. The driver labels all glutamatergic neurons, including brain descending neurons and nerve cord interneurons, in addition to motor neurons. Additionally, the strength of inactivation might differ in different neurons (including motor neurons) depending on the expression levels of the opsins. As a result, in this condition, the authors might not be removing all active forces. This is a major caveat that authors do not address. They explore that they are not potentially silencing all inputs to muscles by using an additional octopaminergic driver, but this doesn't address the points mentioned above. At the very least, the authors should try using other motor neuron drivers, as well as other neuronal silencers. This driver is so broad that authors couldn't even use it for physiology experiments. Additionally, the authors could silence VGlut-labeled motor neurons and record muscle activity (potentially using GCaMP as has been done in several recent papers cited by the authors, Azevedo et al, 2020) as a much more direct readout.</p>
</disp-quote>
<p>This reviewer critique is related to the use of vglut-gal4 –a broad driver– to inactivate motor neurons (MNs). The reviewer argues that the use of a broad driver might result in some effects that are not due to MN inactivation. Conversely, it is possible that not all MNs are inactivated. These critiques raise important points that we will address in the revision by 1) performing experiments with other MN drivers as suggested by the reviewer, 2) performing experiments in flies that are inactivated by freezing. These measurements will provide other estimates of passive forces allowing us to better triangulate the range of values for the passive forces. Moreover, it appears that one of the reviewer’s main concern is that the passive forces are overestimated because of the residual active forces. We will discuss this possibility in detail. It is important to note that in the end what we hope to accomplish is to provide a useful estimate of the passive forces. It is unlikely that the passive force will be a precise number like a physical constant as the passive forces likely depend on recent history.</p>
<disp-quote content-type="editor-comment">
<p>(3) Figure 4 uses an extremely simplified OpenSim model that makes several assumptions that are known to be false. For example, the Thorax-Coxa joint is assumed to be a ball and socket joint, which it is not. Tibia-tarsus joint is completely ignored and likely makes a major contribution in supporting overall posture, given the importance of the leg &quot;claw&quot; for adhering to substrates. Moreover, there are a couple of recent open-source neuromechanical models that include all these details (NeuromechFly by Lobato-Rios et al, 2022, Nat. Methods, and the fly body model by Vaxenburg et al, 2025, Nature). Leveraging these models to rule in or rule out contributions at other joints that are ignored in the authors' OpenSim model would be very helpful to make their case.</p>
</disp-quote>
<p>Our OpenSim model predates the newer mechanical model. In the revised manuscript, we will revisit the model in light of recent developments.</p>
<disp-quote content-type="editor-comment">
<p>(4) Figure 5 shows the experimental validation of Figure 4 simulations; however, it suffers from several caveats.</p>
<p>a) The authors track a single point on the head of the fly to estimate the height of the fly. This has several issues. Firstly, it is not clear how accurate the tracking would be. Secondly, it is not clear how the fly actually &quot;falls&quot; on VGlut silencing; do all flies fall in a similar manner in every trial? Almost certainly, there will be some &quot;pitch&quot; and &quot;role&quot; in the way the fly falls. These will affect the location of this single-tracked point that doesn't reflect the authors' expectations. Unless the authors track multiple points on the fly and show examples of tracked videos, it is hard to believe this dataset and, hence, any of the resulting interpretations.</p>
<p>b) As described in the previous point, the &quot;reason&quot; the fly falls on silencing all glutamatergic neurons could be due to silencing all sorts of premotor/interneurons in addition to the silencing of motor neurons.</p>
<p>c) (line 175) &quot;The first finding is that there was a large variation in the initial height of the fly (Figure 5C), consistent with a recent study of flies walking on a treadmill[20].&quot; The cited paper refers to how height varies during &quot;walking&quot;. However, in the current study, the authors are only looking at &quot;standing&quot; (i.e. non-walking) flies. So it is not the correct reference. In my opinion, this could simply reflect poor estimation of the fly's height based on poor tracking or other factors like pitch and role.</p>
<p>d) &quot;The rate at which the fly fell to the ground was much smaller in the experimental flies than it was in the simulated flies (Figure 5E). The median rate of falling was 1.3 mm/s compared to 37 mm/s for the simulated flies (Figure 5F). (Line 190) The most likely reason for the longer than expected time for the fly to fall is delays associated with motor neuron inactivation and muscle inactivation.&quot; I don't believe this reasoning. There are so many caveats (which I described in the above points) in the model and the experiment, that any of those could be responsible for this massive difference between experiment and modeling. Simply not getting rid of all active forces (inadequate silencing) could be one obvious reason. Other reasons could be that the model is using underestimates of passive forces, as alluded to in point 3.</p>
</disp-quote>
<p>(4a) Although we agree that measuring different points on the body would allow us to estimate the moments, we disagree that the height of the fly cannot be evaluated from the measurement of a single point. The measurements have been performed using the same techniques that we used to assess the fly’s height in a different study where we estimated the resolution of our imaging system to be ~20 mm(Chun et. al. 2021). We will include these details in the revised manuscript. The video showing the falling experiments are not available or referenced in the manuscript. These will be made available.</p>
<p>b) We will repeat the “falling” experiment with a more restrictive driver.</p>
<p>c) We disagree with the reviewer on this point. The system has a resolution of ~20 mm and is sufficient to make conclusion about the difference in the height of the fly. We will clarify this point in the revised manuscript.</p>
<p>d) We do not follow the reviewer’s rationale here. The passive forces in the model (along with any residual forces) are the same in the model as well as in the experiment. Moreover, there will be a delay between light onset, neuronal inactivation and muscle inactivation. These processes are not instantaneous. In Figure 6, we estimate these delays and have concluded that they will cause substantial delay. In the revised manuscript, we will discuss other reasons for the delay suggested by the reviewer.</p>
<disp-quote content-type="editor-comment">
<p>(5) Final figure (Figure 6) focuses on understanding the time course of neuronal silencing. First of all, I'm not entirely sure how relevant this is for the story. It could be an interesting supplemental data. But it seems a bit tangential. Additionally, it also suffers from major caveats.</p>
<p>a) The authors now use a new genetic driver for which they don't have any behavioral data in any previous figures. So we do not know if any of this data holds true for the previous experiments. The authors perform whole-cell recordings from random unidentified motor neurons labeled by E49-Gal4&gt;GtACR1 to deduce a time constant for behavioral results obtained in the VGlut-Gal4&gt;GtACR1 experiments.</p>
<p>b) The DMD setup is useful for focal inactivation, however, the appropriate controls and data are not presented. Line 200 &quot;A spot of light on the cell body produces as much of the hyperpolarization as stimulating the entire fly (mean of 11.3 mV vs 13.1 mV across 9 neurons). Conversely, excluding the cell body produces only a small effect on the MN (mean of 2.6 mV).&quot; First of all, the control experiment for showing that DMD is indeed causing focal inactivation would be to gradually move the spot of light away from the labeled soma, i.e. to the neighboring &quot;labelled&quot; soma and show that there is indeed focal inactivation. Instead authors move it quite a long distance into unlabeled neuropil. Secondly, I still don't get why the authors are doing this experiment. Even if we believe the DMD is functioning perfectly, all this really tells us is that a random subset motor neurons (maybe 5 or 6 cells, legend is missing this info) labeled by E49-Gal4 is strongly hyperpolarized by its own GtACR1 channel opening, rather than being impacted because of hyperpolarizations in other E49-Gal4 labeled neurons. This has no relevance to the interpretation of any of the VGlut-Gal4 behavioral data. VGLut-Gal4 is much broader and also labels all glutamatergic neurons, most of which are inhibitory interneurons whose silencing could lead to disinhibition of downstream networks.</p>
</disp-quote>
<p>(5 a) However, we can address the reviewer critique by recording from the Vglut line while using a MN line to target the recordings to MNs.</p>
<p>b) Once we use the Vglut driver to perform these recordings, it will help assess how much of the MN inactivation is due to the GtACR expressed in the MN versus other neurons.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 2</bold>:</p>
<p>While (as mentioned above) the study's conclusions are well-supported by the results and modeling, limitations arise because of the assumptions made. For instance, using a linear approximation may not hold at larger joint angles, and future studies would benefit from accounting for nonlinearities. Future studies could also delve into the source of passive forces, which is important for more deeply understanding the anatomical and physical basis of the results in this study. For instance, assessments of muscle or joint properties to correlate stiffness values with physical structure might be an area of future consideration.</p>
</disp-quote>
<p>We agree with these comments but believe that these studies represent avenues for future work.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 3</bold>:</p>
<p>(1) Passive torques are measured, but only some short speculative statements, largely based on previous work, are offered on their functional significance; some of these claims are not well supported by experimental evidence or theoretical arguments. Passive forces are judged as &quot;large&quot; compared to the weight force of the limb, but the arguably more relevant force is the force limb muscles can generate, which, even in equilibrium conditions, is already about two orders of magnitude larger. The conclusion that passive forces are dynamically irrelevant seems natural, but contrasts with the assertion that &quot;passive forces [...] will have a strong influence on limb kinematics&quot;. As a result, the functional significance of passive joint torques in the fruit fly, if any, remains unclear, and this ambiguity represents a missed opportunity. We now know the magnitude of passive joint torques - do they matter and for what? Are they helpful, for example, to maintain robust neuronal control, or a mechanical constraint that negatively impacts performance, e.g., because they present a sink for muscle work?</p>
</disp-quote>
<p>To us, measuring passive forces was the first step to understanding neural/biomechanical control of limb. In general, we agree with these comments and would like to understand the role of passive forces in overall control of limb. A complete discussion of the role of the significance of passive forces in the control of limb is beyond the scope of this study. We would like to note that it is unlikely that the active forces are two orders of magnitude larger during unloaded movement of the limb. However, these issues will have to be settled in future work.</p>
<disp-quote content-type="editor-comment">
<p>(2) The work is framed with a scaling argument, but the assumptions that underpin the associated claims are not explicit and can thus not be evaluated. This is problematic because at least some arguments appear to contradict textbook scaling theory or everyday experience. For example, active forces are assumed to scale with limb volume, when every textbook would have them scale with area instead; and the asserted scaling of passive forces involves some hidden assumptions that demand more explicit discussion to alert the reader to associated limitations. Passive forces are said to be important only in small animals, but a quick self-experiment confirms that they are sufficient to stabilize human fingers or ankles against gravity, systems orders of magnitude larger than an insect limb, in seeming contradiction with the alleged dominance of scale. Throughout the manuscript, there are such and similar inaccuracies or ambiguities in the mechanical framing and interpretation, making it hard to fairly evaluate some claims, and rendering others likely incorrect.</p>
</disp-quote>
<p>We interpret this comment as making two separate points. The first one is that the reviewer says that our statement that active forces depend on the third power of the limb or L<sup>3</sup> is incorrect. We agree and apologize for this oversight. Specifically, on L6-7 we say, “both inertial forces and active forces scale with the mass if the limb which in turn scales with the volume of the limb and therefore depends on the third power of limb length (L<sup>3</sup>)”. Instead, this statement should read “inertial forces scale with the mass if the limb which in turn scales with the volume of the limb and therefore depends on the third power of limb length (L<sup>3</sup>)”. However, this oversight does not affect the scaling argument as the scaling arguments in the rest of the manuscript only involves inertial forces and not active forces.</p>
<p>The second point is about the scaling law that governs passive forces. In the current manuscript, we have assumed that the passive forces scale as L<sup>2</sup> based on previous work. The reviewer has pointed out that this assumption might be incorrect or at the very least needs a rationale. We agree with this assessment: passive forces that arise in the muscle are likely to scale as L<sup>2</sup> but passive forces that arise in the joint might not. In the revised manuscript, we will discuss this concern.</p>
<disp-quote content-type="editor-comment">
<p><bold>Response to the public comment:</bold></p>
<p>There was a comment from a reader: “None of our work cited in various places in this preprint (i.e., Zakotnik et al. 2006, Guschlbauer et al. 2007, Page et al. 2008, Hooper et al. 2009, Hooper 2012, Ache and Matheson 2012, Blümel et al. 2012, Ache and Matheson 2013, von Twickel et al. 2019, and Guschlbauer et al. 2022) claims or implies that passive forces could be sufficient to support the weight of an insect or any animal. To claim or suggest otherwise (as done in lines 33-35) is incorrect and sets up a misleading straw man that misrepresents our work. All statements in the preprint regarding our work related to this specific matter need to be removed or edited accordingly. For instance, the investigations, calculations, and interpretations in Hooper et al. 2009 are solely about limbs that are not being used in stance or other loaded tasks (indeed, the article's title specifically refers to &quot;unloaded&quot; leg posture and movements). Trying to use this work to predict whether passive muscle forces alone can support a stick insect against gravity requires considering much more than the oversimplified calculation given in lines 290-292. Other “back of the envelope calculations” (lines 299-300) are likely also insufficient and erroneous. The discussion in lines 289-304 needs to be edited accordingly”</p>
</disp-quote>
<p>We thank the reader for their comment. However, we interpret these studies differently. The studies above rightly focused on unloaded legs because it would be difficult to study passive forces in an intact insect without genetic tools. The commenter correctly points out that these studies do not comment on whether passive forces are strong enough to support the weight of the fly. However, we disagree that our arguments based on their results are unreasonable or strawman. We think that our interpretation of their measurements is correct. Moreover, we were motivated by Yox et. el. 1982 who states in so many words: “Stiffness of the muscles in the joints of all the legs might be sufficient to support a resting arthropod. A more rigorous analysis of all supporting limbs and joint angles would be required to prove this hypothesis”. We were inspired by this comment. In the revised manuscript, we will make it clear that the statement made in Line 33 is based on Yox. et. al. and our interpretation of measurements made by others.</p>
</body>
</sub-article>
</article>