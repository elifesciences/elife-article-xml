<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">88895</article-id>
<article-id pub-id-type="doi">10.7554/eLife.88895</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.88895.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Chromosomes and Gene Expression</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Transcriptional immune suppression and upregulation of double stranded DNA damage and repair repertoires in ecDNA-containing tumors</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2017-4246</contrib-id>
<name>
<surname>Lin</surname>
<given-names>Miin S.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Jo</surname>
<given-names>Se-Young</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Luebeck</surname>
<given-names>Jens</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Chang</surname>
<given-names>Howard Y.</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wu</surname>
<given-names>Sihan</given-names>
</name>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Mischel</surname>
<given-names>Paul S.</given-names>
</name>
<xref ref-type="aff" rid="a8">8</xref>
<xref ref-type="aff" rid="a9">9</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5810-6241</contrib-id>
<name>
<surname>Bafna</surname>
<given-names>Vineet</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a10">10</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Bioinformatics and Systems Biology Graduate Program, University of California at San Diego</institution>, La Jolla, CA, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>Department of Biomedical Systems Informatics and Brain Korea 21 PLUS Project for Medical Science, Yonsei University College of Medicine</institution>, Seoul, South Korea</aff>
<aff id="a3"><label>3</label><institution>Department of Computer Science and Engineering, University of California at San Diego</institution>, La Jolla, CA, <country>USA</country></aff>
<aff id="a4"><label>4</label><institution>Center for Personal Dynamic Regulomes, Stanford University</institution>, Stanford, CA, <country>USA</country></aff>
<aff id="a5"><label>5</label><institution>Department of Genetics, Stanford University</institution>, Stanford, CA, <country>USA</country></aff>
<aff id="a6"><label>6</label><institution>Howard Hughes Medical Institute, Stanford University</institution>, Stanford, CA, <country>USA</country></aff>
<aff id="a7"><label>7</label><institution>Children’s Medical Center Research Institute, University of Texas Southwestern Medical Center</institution>, Dallas, TX, <country>USA</country></aff>
<aff id="a8"><label>8</label><institution>Sarafan Chemistry, Engineering, and Medicine for Human Health (Sarafan ChEM-H), Stanford University</institution>, Stanford, CA, <country>USA</country></aff>
<aff id="a9"><label>9</label><institution>Department of Pathology, Stanford University School of Medicine</institution>, Stanford, CA, <country>USA</country></aff>
<aff id="a10"><label>10</label><institution>Halıcıoğlu Data Science Institute, University of California at San Diego</institution>, La Jolla, CA, <country>USA</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Gingeras</surname>
<given-names>Thomas R</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Cold Spring Harbor Laboratory</institution>
</institution-wrap>
<city>Cold Spring Harbor</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>White</surname>
<given-names>Richard M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Oxford</institution>
</institution-wrap>
<city>Oxford</city>
<country>United Kingdom</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>Correspondence: Vineet Bafna, <email>vbafna@ucsd.edu</email>; Paul S. Mischel, <email>pmischel@stanford.edu</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-08-10">
<day>10</day>
<month>08</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2024-02-27">
<day>27</day>
<month>02</month>
<year>2024</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP88895</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-06-13">
<day>13</day>
<month>06</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-04-24">
<day>24</day>
<month>04</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.04.24.537925"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-08-10">
<day>10</day>
<month>08</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.88895.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.88895.1.sa3">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.88895.1.sa2">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.88895.1.sa1">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.88895.1.sa0">Reviewer #3 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Lin et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Lin et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-88895-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>Extrachromosomal DNA is a common cause of oncogene amplification in cancer. The non-chromosomal inheritance of ecDNA enables tumors to rapidly evolve, contributing to treatment resistance and poor outcome for patients. The transcriptional context in which ecDNAs arise and progress, including chromosomally-driven transcription, is incompletely understood. We examined gene expression patterns of 870 tumors of varied histological types, to identify transcriptional correlates of ecDNA. Here we show that ecDNA containing tumors impact four major biological processes. Specifically, ecDNA containing tumors upregulate DNA damage and repair, cell cycle control, and mitotic processes, but downregulate global immune regulation pathways. Taken together, these results suggest profound alterations in gene regulation in ecDNA containing tumors, shedding light on molecular processes that give rise to their development and progression.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>V.B. is a co-founder, paid consultant, SAB member and has equity interest in Boundless Bio, inc. and Abterra Biosciences, Inc. H.Y.C. is a co-founder of Accent Therapeutics, Boundless Bio, Cartography Biosciences, Orbital Therapeutics, and an advisor of 10x Genomics, Arsenal Biosciences, Chroma Medicine, and Spring Discovery. P.S.M. is a co-founder and advisor of Boundless Bio. J.L. receives compensation as a consultant for Boundless Bio. The remaining authors declare no competing interests.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Clarity of method description, Comparisons to other methods for feature prediction, and other changes suggested by eLife reviewers.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Extrachromosomal DNA (ecDNA) are large, functional, circular double-stranded DNA molecules that are enriched for oncogenes, highly amplified, and frequently observed in a wide variety of cancer types<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref></sup>. ecDNAs lack centromeres and are asymmetrically segregated into daughter cells during cell division, driving intratumoral genetic heterogeneity, accelerated evolution, and rapid treatment resistance<sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c4">4</xref></sup>. Further, recent studies demonstrate strong positive selection for ecDNA during tumor progression<sup><xref ref-type="bibr" rid="c5">5</xref></sup>. ecDNAs also exhibit highly accessible chromatin and altered cis- and trans-regulation, including cooperative intramolecular interactions<sup><xref ref-type="bibr" rid="c6">6</xref></sup>, promoting elevated expression of oncogenic transcriptional programs<sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c9">9</xref></sup>, further contributing to poor outcome for patients<sup><xref ref-type="bibr" rid="c2">2</xref></sup>.</p>
<p>The recent development of computational tools that enable detection of ecDNA from whole genome sequencing data, has facilitated analyses of well-curated, publicly available datasets, including The Cancer Genome Atlas (TCGA), thereby providing an important opportunity to identify transcriptional repertoires that are preferentially detected in bona fide, clinical ecDNA-containing tumors. To shed new light on the gene expression patterns that may enhance ecDNA development and progression, we examined global transcriptional analysis of ecDNA-containing tumors.</p>
</sec>
<sec id="s2">
<title>Results</title>
<p>A recent analysis utilized the tools AmpliconArchitect and AmpliconClassifier on 1,921 tumors from The Cancer Genome Atlas (TCGA) to suggest that ecDNA prevalence ranges from 0% to 59.6% across multiple tumor tissue subtypes<sup><xref ref-type="bibr" rid="c2">2</xref></sup>. Using AmpliconClassifier (AC), the analysis classified tumor samples into five subtypes: ecDNA(+), Breakage Fusion Bridge (BFB), complex non-cyclic, linear, and no-amplification. However, due to limitations imposed by short-read sequencing, AC may classify some ecDNA(+) structures as complex non-cyclic when breakpoints are missed. Secondly, BFB cycles can give rise to ecDNA formation, making discernment of the two modes of amplification difficult. To limit false-negative ecDNA classifications in the ecDNA(-) set, we treated samples with only a linear or no-amplification status as ecDNA(-), removing complex non-cyclic and BFB(+) samples from the analysis. In order to understand the transcriptional programs active in maintaining ecDNA, we selected 870 samples from 14 tumor types with at least three ecDNA(+) samples each, and compared the gene expression data of the resulting 234 ecDNA(+) and 636 ecDNA(-) samples (<bold>Table S1</bold>).</p>
<sec id="s2a">
<title>Machine learning identifies candidate genes for ecDNA maintenance</title>
<p>In lieu of identifying genes that are highly differentially expressed between ecDNA(+) and ecDNA(-) samples but driven by a small subset of cases (e.g. gene A in <bold>Fig. S1a</bold>), we sought to identify genes (e.g. gene B) whose expression level was predictive of ecDNA presence. We assumed that genes that were persistently over-expressed or under-expressed in ecDNA(+) samples relative to ecDNA(-) samples were more likely to be involved in ecDNA biogenesis or maintenance, or in mediating the cellular response to the presence of ecDNA.</p>
<p>To identify a minimal set of genes whose expression values were consistently predictive of ecDNA presence, we used Boruta,<sup><xref ref-type="bibr" rid="c10">10</xref></sup> an automated feature selection algorithm (<bold><xref rid="fig1" ref-type="fig">Fig. 1a</xref></bold> and Methods). Given the unequal representation of ecDNA(+) and ecDNA(-) samples within each of the 14 tumor types, we performed Boruta on 200 datasets, each consisting of a random selection of 80% of the 870 samples (<bold><xref rid="fig1" ref-type="fig">Fig. 1a</xref></bold>), and chose the criterion of a gene being labeled as a Boruta gene in at least 10 of the 200 trials to be selected for downstream analysis. The Boruta analysis identified a set of 408 genes with persistent differential expression, hereafter denoted as the Core gene set.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Genes predictive of ecDNA status.</title>
<p><bold>(a)</bold> The feature selection algorithm, Boruta, was applied to 200 datasets of randomly selected subsets consisting of 80% of all samples. Genes selected by Boruta in at least 10 of the 200 trials were identified as the Core set of genes (408) that were predictive of ecDNA presence. <bold>(b)</bold> Identification of highly co-expressed and stable gene clusters using pvclust expanded the Core set by an additional 235 genes to the final list of 643 CorEx genes. <bold>(c)</bold> Out of 354 clusters, the majority (344) of clusters contained 1 or 2 Core genes. <bold>(d)</bold> Most clusters were small, with only 7 clusters containing more than 10 genes.</p></caption>
<graphic xlink:href="537925v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2b">
<title>Extending the Core set with co-expressed genes</title>
<p>We note that the Core gene set is not a comprehensive list of discriminatory genes, using a toy example. Consider gene “B”, a member of the core gene set, and another gene, “C”, whose expression values across all samples are nearly identical to the expression values of core gene B. The Boruta analysis would not need to assign gene C to the core set in addition to gene B, because adding both genes incurs the same predictive power as adding one. However, either, or both genes may play an important functional role. To correct this, we ran pvclust<sup><xref ref-type="bibr" rid="c11">11</xref></sup> to cluster all gene expression values, and to identify stable clusters using multiscale bootstrap resampling (<bold><xref rid="fig1" ref-type="fig">Fig. 1b</xref></bold>; Methods). We used an approximately unbiased (AU) confidence value of 0.95 to select the most highly co-expressed gene clusters. An AU confidence value of 0.95 represents the rejection of the null hypothesis that a group of genes fail to form a stable cluster at a significance level of 0.05. Recomputing the number of Boruta trials that members of a cluster were selected in, we selected clusters that appeared in at least 10 of the 200 Boruta trials (Methods). This resulted in the selection of 354 recurring clusters (<bold>Table S2</bold>).</p>
<p>Notably, among the 354 clusters, only 2 clusters (with 14 total genes) did not contain any Core genes. As most genes do not have completely identical expression patterns, we would expect one gene to be consistently picked as a Boruta gene over another co-expressed gene. Consistent with this hypothesis, most (344/354) clusters contained only 1 or 2 Core genes (<bold><xref rid="fig1" ref-type="fig">Fig. 1c</xref></bold>). When selecting clusters that contained at least 1 Core and 1 co-expressed gene, 53 of 71 clusters contained 1 to 3 Core genes (<bold>Fig. S1b</bold>), confirming that a few genes per co-expressed cluster provide sufficient predictive value, but other co-expressed genes might still play an important functional role in maintaining ecDNA presence. This is true for clusters of various sizes, including the 2-member cluster #74 and the 21-member cluster #3. In cluster #74, <italic>CSTF1</italic> had similar expression values to the Core gene <italic>RAE1</italic>, which is a mitotic checkpoint regulator implicated in tumor progression<sup><xref ref-type="bibr" rid="c12">12</xref></sup> (<bold>Fig. S1c; Table S3</bold>). While not necessarily increasing the predictive value, <italic>CSTF1</italic> is also a proto-oncogene involved in aberrant alternative splicing events<sup><xref ref-type="bibr" rid="c13">13</xref></sup>. In cluster #3, 12 genes were highly co-expressed with 9 Core genes (<bold>Fig. S1d; Table S3</bold>), and were enriched in cell-cycle related biological processes (Methods). Importantly, the total number of genes per cluster was also small (<bold><xref rid="fig1" ref-type="fig">Fig. 1d</xref></bold>), with only 7 of 354 clusters carrying more than 10 genes. This suggests that the Core genes have specific roles that cannot be accomplished by multiple other genes.</p>
<p>Summarizing, the 354 clusters contained 643 genes, which included 408 Core genes and 235 additional genes (<bold><xref rid="fig1" ref-type="fig">Fig. 1b</xref></bold>). Together, we define these genes as the CorEx (Core+co-expressed) genes (<bold>Table 1</bold>). To address the concern that the selection of CorEx genes based on bulk RNA-seq expression data could be confounded by tumor purity, we utilized a composite tumor purity score (CPE)<sup><xref ref-type="bibr" rid="c14">14</xref></sup>, and observed that the ecDNA(-) samples had slightly (but significantly) lower purity than ecDNA(+) samples (<italic>p</italic>-value 0.0036; <bold>Fig. S2a</bold>). This is consistent with reduced detection of ecDNA in less pure samples. However, lower sensitivity of ecDNA detection would reduce the strength of the signal but not result in false positives. Indeed, when we compared the significance of CorEx gene directionality in highly pure samples (tumor purity≥0.8; n=287) versus all samples (n=870), we found significant correlation (<bold>Fig. S2b</bold>), indicating robustness of the CorEx set. The remaining manuscript investigates the functional properties of these genes.</p>
</sec>
<sec id="s2c">
<title>CorEx genes are better predictors of ecDNA status compared to other gene sets</title>
<p>We validated the relevance of CorEx genes in ecDNA presence by running cross-validation experiments (<bold><xref rid="fig2" ref-type="fig">Fig. 2a</xref></bold>; Methods) to test the predictive power of CorEx gene expression in determining the ecDNA status of the sample. For comparisons, we used three other gene lists. The first list was a randomly chosen gene subset of identical size. For the second list, we performed a differential expression analysis using DESeq2<sup><xref ref-type="bibr" rid="c15">15</xref></sup> and picked the 643 most significantly differentially expressed genes in terms of the absolute value of their shrunken log-fold change estimate (LFC; Methods). Using the sign of the LFC value as the determinant for directionality, 240 of these genes were up-regulated, while 403 were down-regulated. Notably, only 86 of these Top-|LFC| genes overlapped with the CorEx gene set (<bold>Table S5</bold>; <bold>Fig. S3d</bold>). For the third list, we used a generalized linear model (GLM) to predict 3,012 genes whose expression levels were significantly associated with sample ecDNA status using a logit function after controlling for tumor subtype (Methods). Together, the 3 additional gene lists were denoted as random, Top-|LFC|, and GLM.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Validation of CorEx genes.</title>
<p><bold>(a)</bold> Cross-validation experiments validating the predictive value of CorEx genes. Precision denotes the fraction of predicted samples that were truly ecDNA(+). Recall refers to the fraction of ecDNA(+) samples that were predicted correctly. <bold>(b)</bold> For precision windows of width 0.1 and a value of at least 0.5, recall values were plotted as boxplots. The interquartile ranges for CorEx and Core genes overlap, suggesting similar predictive power. (Continued on the following page.). CorEx genes have higher predictive rates compared to the top 643 differentially expressed genes based on logarithmic fold changes from a DESeq2 analysis (Top-|LFC| genes), 3,012 significant genes selected from a generalized linear model (GLM), and 643 randomly selected genes. <bold>(c)</bold> CorEx genes were consistently up- or down-regulated in ecDNA(+) samples across tumor types, with the exception of SARC. AU <italic>p</italic>-values from multiscale bootstrap resampling are shown at the dendrogram branches. <bold>(d)</bold> Of the 643 Top-|LFC| genes, 240 were up-regulated while 403 were down-regulated in ecDNA(+) samples. Of the CorEx genes, 325 were up-regulated while 318 were down-regulated. The absolute LFC values of the Top-|LFC| gene set was significantly greater than that of the CorEx genes (<italic>p</italic>-value 1.83e-158). <bold>(e)</bold> The normalized gene expression values of the CorEx genes were significantly higher than that of the Top-|LFC| gene set (<italic>p</italic>-value &lt; 2e-308). ***<italic>p</italic>-value &lt; 0.001.</p></caption>
<graphic xlink:href="537925v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For cross-validation tests, we performed multiple random 80-20 splits of the samples to generate 200 training and test data-sets (<bold><xref rid="fig2" ref-type="fig">Fig. 2a</xref></bold>). For each training-test data-set, a Random Forest method was used to train the predictability of the 5 gene lists (Methods) on the training data, and the predictive performance was tested on the test data. Expectedly, none of the gene lists was a great predictor of ecDNA status of a sample. Nevertheless, the average of the area under the precision recall curve (AUPRC) was higher for CorEx and Core genes (0.48 and 0.5), relative to GLM and Top-|LFC| (mean AUPRC: 0.43 each; <bold><xref rid="fig2" ref-type="fig">Fig. 2b</xref></bold>, <bold>S3b</bold>). For precision values of at least 0.7, the CorEx genes had significantly higher recall than Top-|LFC| genes (Mann-Whitney U-test p-value 4.8e-21) or GLM genes (p-value 8.5e-20). In turn, the Top-|LFC| and GLM genes were more predictive than random (mean AUPRC: 0.36). Expectedly, the predictive performance did not change when switching between Core genes and CorEx genes, because each of the non-core gene in the CorEx list had an expression pattern similar to at least one Core gene (<bold><xref rid="fig2" ref-type="fig">Fig. 2b</xref></bold>, <bold>S3a</bold>).</p>
<p>To test the persistence of CorEx genes across tumor types, we re-computed Cliff’s delta values<sup><xref ref-type="bibr" rid="c16">16</xref>,<xref ref-type="bibr" rid="c17">17</xref></sup> for each of the 11 TCGA tumor types that had at least 10 ecDNA(+) and at least 10 ecDNA(-) samples. The directionality of gene expression patterns was significantly similar to TCGA in each tissue type, with one exception (<bold><xref rid="fig2" ref-type="fig">Fig. 2c</xref>; Table S4</bold>). The sole exception was the tumor type of Sarcoma (SARC). It is notable that the TCGA-SARC samples included many liposarcomas. In addition to containing ecDNA, liposarcoma samples are known to have extensively rearranged structures indicative of chromothripsis and neo-chromosome formation<sup><xref ref-type="bibr" rid="c18">18</xref></sup>. For other tissue types, the <italic>p</italic>-values against a null hypothesis of no match to the pan-cancer prediction ranged from 4.2e-12 to 3.5e-85 (Fisher’s exact test) for the significant associations (Methods). The results were similar if we tested using only Core genes (<bold>Fig. S3c</bold>). Summarizing, the 643 CorEx genes are differentially expressed across a multitude of tumor types, and have consistently higher or lower expression in ecDNA(+) samples relative to ecDNA(-) samples. These results are consistent with a pan-cancer role of CorEx genes in ecDNA biogenesis and maintenance.</p>
<p>The Top-|LFC| genes were also different from the CorEx genes by other metrics. Not surprisingly, the log-fold change (LFC) values of the top-|LFC| genes were higher than the LFC values of the CorEx genes (<bold><xref rid="fig2" ref-type="fig">Fig. 2d</xref></bold>, MWU <italic>p</italic>-value 1.83e-158). However, much of the LFC change was due to the very low expression of the top-|LFC| genes in either ecDNA(+), or ecDNA(-) samples. In fact, the CorEx genes had higher expression in both ecDNA(+) and ecDNA(-) samples compared to the Differentially Expressed (DE) genes (<bold><xref rid="fig2" ref-type="fig">Fig. 2e</xref></bold>, MWU <italic>p</italic>-value &lt; 2e-308). While the absolute log fold-change in expression of CorEx genes between ecDNA(+) and ecDNA(-) samples was not that high (median: 0.30, mean: 0.41), it was persistent across all samples (variance: 0.14, standard deviation: 0.37).</p>
<p>For example, the genes <italic>ITLN1</italic> and <italic>PNMT</italic> had the second and eighth-highest absolute LFC values of 3.92 and 2.89 in the top-|LFC| list. However, their normalized expression values in most ecDNA(+) samples were low. <italic>ITLN1</italic> had a normalized RSEM expression value ≤ <italic>8</italic> (21<sup>st</sup> percentile) in 210/234 ecDNA(+) samples. Similarly, the normalized RSEM expression value of <italic>PNMT</italic> in 223/234 ecDNA(+) samples was less than 8.5 (rank percentile: 41.1%). For <italic>PNMT</italic>, the differential expression was mediated by 11 ecDNA(+) samples having an expression value ≥ <italic>11</italic>, and 5 of the 11 samples contained <italic>PNMT</italic> on an ecDNA amplicon (<bold>Fig. S3e</bold>). Similarly, 3 samples with high RSEM contained <italic>ITLN1</italic> on an amplicon (<bold>Fig. S3f</bold>), partly accounting for the high |LFC| value. In contrast, the CorEx gene, <italic>RAE1</italic>, had a high normalized expression value in both ecDNA(+) and ecDNA(-) samples (average 9.72, rank percentile 74.3%), with a small but persistent LFC value of 0.33.</p>
<p>The results confirm our intuition that differential expression can arise due to multiple reasons, including low expression of the gene in a majority of samples, or the copy number amplification of a gene in a few samples. In contrast, the CorEx genes were selected based on persistent over- or under-expression in ecDNA(+) samples.</p>
</sec>
<sec id="s2d">
<title>CorEx genes primarily up-regulate three biological processes: Cell Cycle, Cell division, and DNA Damage Response</title>
<p>To identify enriched biological processes specific to either up-regulated or down-regulated genes in ecDNA(+) samples, we combined two metrics of effect size, Cliff’s delta<sup><xref ref-type="bibr" rid="c16">16</xref>,<xref ref-type="bibr" rid="c17">17</xref></sup>, and log fold change<sup><xref ref-type="bibr" rid="c15">15</xref></sup> to determine the directionality of CorEx genes (<bold>Table S6</bold>; Methods). The two effect size metrics were mostly in agreement in terms of directionality. Of the 7,288 genes that passed the negligible effect size thresholds in both metrics, only 14 were not in concordance. This more stringent approach, in comparison to a simple directionality based on the sign of a single effect size value, was applied given that enrichment analysis on gene sets is dependent on not only the number of up- or down-regulated genes but also the degree of overlap with genes under a specific biological process term (Methods). Using this approach, among the 643 CorEx genes, 262 genes were found to be up-regulated in ecDNA(+), while 271 were found to be down-regulated (<bold>Table 1</bold>; Methods). 110 genes did not make the effect size cut-off. The numbers were similar for the 408 Core genes, with 190 up-regulated, 196 down-regulated, and 22 genes not making the cut-off.</p>
<p>We performed enrichment analysis on gene sets to identify the Gene Ontology (GO) biological processes that are enriched in CorEx genes (Methods). Briefly, we applied a one-sided Fisher’s exact test using gene sets from MSigDB<sup><xref ref-type="bibr" rid="c19">19</xref>–<xref ref-type="bibr" rid="c21">21</xref></sup>, using a false discovery rate of 5% (Benjamini-Hochberg procedure). The UP-regulated genes enriched 187 Biological processes (<bold>Table S7</bold>). Note that the GO-biological process (BP) terms are not independent, because of their hierarchical organization, and sharing of genes across different GO terms. Therefore, we used an approach similar to that used in DAVID<sup><xref ref-type="bibr" rid="c22">22</xref></sup> to cluster the biological processes enriched by the UP-regulated genes into 11 broad categories (<bold>Table S8</bold>; <bold>Fig S4</bold>; Methods). The 11 categories were assigned a name using manual inspection of the constituent GO terms, or called “Other.” The 11 categories (including “Other”) are shown in a waterfall plot to explain the contribution of each gene to a category (<bold><xref rid="fig3" ref-type="fig">Fig. 3a</xref></bold>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Up-regulated CorEx genes.</title>
<p><bold>(a)</bold> GO biological processes enriched in up-regulated genes were clustered into 11 broad categories. The horizontal barplot represents the number of GO biological processes belonging to each of the 11 broad categories, while the vertical barplot represents the number of broad categories that a specific GO biological process belongs to. <bold>(b)</bold> Genes up- or down-regulated in processes involved in major double-strand break (DSB) damage repair pathways. Many critical genes in the c-NHEJ pathway were down-regulated in ecDNA(+) samples relative to ecDNA(-) samples.</p></caption>
<graphic xlink:href="537925v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The 10 categories included expected participation of biological processes involved in (a) cell-cycle regulation (Mitotic/Meiotic Cell Cycle, G1/S, G2/M) (b) cell-division (Spindle Organization, Cell Division, Chromosome Condensation, Chromosome Segregation), (c) DNA Damage response (DNA Repair), and (d) the HOX Gene cluster. Indeed, one of the largest clusters, cluster #3, containing 9 Core genes and 12 co-expressed genes, was enriched in GO-BP terms related to the cell cycle (<bold>Table S9</bold>). Notably, the enriched categories also included a role for the <italic>HOX</italic> genes with 17 members of the <italic>HOX</italic> family up-regulated in ecDNA(+) cancers (<bold>Table S8</bold>). Many recent reports have associated <italic>HOX</italic> genes with cancer, including an association with their phenotypic “hallmarks”<sup><xref ref-type="bibr" rid="c23">23</xref></sup>. Genes involved in angiogenesis (<italic>HOXA2</italic>, <italic>HOXC5</italic>), genome instability (<italic>HOXC5</italic>, <italic>HOXC11</italic>), deregulating cellular energetics (<italic>HOXA4</italic>, <italic>HOXC5</italic>), and metastasis (<italic>HOXA2</italic>) were all up-regulated in ecDNA(+) cancers.</p>
<p>While Meiotic cell-cycle was also enriched, only 7 genes were allocated specifically to the group of enriched terms: <italic>SEPP1</italic>, <italic>SNRPA1</italic>, <italic>TMEM203</italic>, <italic>RNF114</italic>, <italic>TAF4</italic>, <italic>TNFAIP6</italic>, and <italic>PTX3</italic> (<bold>Table S10</bold>). Though these genes have roles in the meiotic cell cycle, they have also been implicated in cancer and other inflammatory diseases. The spliceosomal protein SNRPA1 is a pro-metastatic splicing enhancer<sup><xref ref-type="bibr" rid="c24">24</xref></sup>. TNFAIP6, together with PTX3, activates the Wnt/β-catenin pathway to promote gastric carcinoma cell invasion<sup><xref ref-type="bibr" rid="c25">25</xref></sup>. TMEM203 is a STING-centered signaling regulator implicated in inflammatory diseases<sup><xref ref-type="bibr" rid="c26">26</xref></sup>. RNF114 is a zinc-binding protein whose over-expression is an indicator of epithelial inflammation and implicated in various tumors<sup><xref ref-type="bibr" rid="c27">27</xref></sup>. TAF4, a transcription initiation factor, when overexpressed, is implicated in ovarian cancer by playing a role in dedifferentiation that promotes metastasis and chemoresistance<sup><xref ref-type="bibr" rid="c28">28</xref></sup>. Finally, in looking at the genes in the “Other” category, <italic>SHCBP1</italic> was the only gene unique to it. A member of the neural precursor cell proliferation process, SHCBP1 is reported to promote tumor cell signaling and proliferation<sup><xref ref-type="bibr" rid="c29">29</xref></sup>.</p>
<p>Taken together, the 11 biological process categories explain 165 of the 262 up-regulated CorEx genes, and suggest that Mitotic Cell-Division, Cell cycle regulation, and DNA Damage response are the three broad categories of biological processes up-regulated to ensure ecDNA presence, along with an up-regulation of genes in the <italic>HOX</italic> cluster.</p>
</sec>
<sec id="s2e">
<title>CorEx genes upregulate specific Double-strand break repair pathways</title>
<p>The 16 enriched DNA damage response GO terms contained terms “double-strand break repair” and “recombination”, but none contained the terms “single-strand”, “nucleotide-excision”, or “mismatch-repair” (<bold>Table S8</bold>), suggesting that the CorEx genes are largely composed of genes involved in multiple double-strand break (DSB) repair pathways, which include classical non-homologous end-joining (c-NHEJ), Alternative end-joining (Alt-EJ), single-strand annealing (SSA), or homology directed repair (HDR)<sup><xref ref-type="bibr" rid="c30">30</xref></sup>.</p>
<p>The choice of these varied DSB repair mechanisms for ecDNA presence is not well understood. We compiled and hand-curated a list of 129 genes involved in DSB repair and marked them for their role in one or more of these 4 pathways (<bold>Table S11</bold>). Of these genes, a high number (67) were up-regulated in ecDNA(+), while a smaller number (15) were down-regulated, relative to ecDNA(-) samples. This breakdown of 129 DDR genes contrasts with an analysis using all genes where a near identical number of genes (5,256, and 5,251) were up- and down-regulated in ecDNA(+) samples, confirming that DDR genes are significantly up-regulated relative to all differentially expressed genes (<italic>p</italic>-value &lt; 0.0001; Fisher’s exact test). When broken down to the roles of genes in individual DSB repair pathways, we found that Alt-EJ with 11 up-regulated and 1 down-regulated genes (<italic>p</italic>-value 0.0063), SSA (11 up, 1 down (<italic>p</italic>-value 0.0063)), and HR (46 up, 8 down; <italic>p</italic>-value &lt;0.00001) were all up-regulated. However, classical NHEJ (14 up, 7 down; <italic>p</italic>-value: 0.19) was not significantly up-regulated in ecDNA(+) samples relative to ecDNA(-) samples (Methods, <bold>Table S12, Table S13</bold>).</p>
<p>The expression of key genes in these pathways raises the possibility of an increased role of non-classical-NHEJ processes in ecDNA development or progression, relative to c-NHEJ (<bold><xref rid="fig3" ref-type="fig">Fig. 3b</xref>; Table S11</bold>). A number of genes involved in c-NHEJ were downregulated in ecDNA-containing tumors relative to non-ecDNA tumors. These included <italic>XLF</italic>/<italic>NHEJ1</italic> (MWU <italic>p</italic>-value 2.05e-03), which is a key member of the ligase complex required for c-NHEJ; <italic>LIG4</italic>, another member of the ligase complex (MWU <italic>p</italic>-value 0.03), <italic>PNKP</italic>, which generates 5΄-phosphate/3΄-hydroxyl DNA termini required for ligation (MWU <italic>p-</italic>value 3.90e-06); and also, DNA polymerases λ (<italic>POLL</italic>; MWU <italic>p</italic>-value 1.09e-21) and μ (<italic>POLM</italic>; MWU <italic>p</italic>-value 0.01), which promotes the ligation of terminally compatible overhangs requiring fill-in synthesis and promotes the ligation of incompatible 3ʹ overhangs<sup><xref ref-type="bibr" rid="c31">31</xref></sup> in a template independent manner, respectively. This does not imply a defect in these repair processes, but rather, potentially additional or preferential utilization of alternative DSB repair pathways in ecDNA-containing tumors.</p>
<p>TP53BP1 is key to blocking resection and promoting the c-NHEJ pathway choice, but is displaced by BRCA1 and the MRN complex to initiate resection in the broken strands<sup><xref ref-type="bibr" rid="c32">32</xref>,<xref ref-type="bibr" rid="c33">33</xref></sup>. <italic>BRCA1</italic> was significantly up-regulated in ecDNA(+) samples (<bold><xref rid="fig3" ref-type="fig">Fig. 3b</xref></bold>), while <italic>TP53BP-1</italic> was significantly down-regulated (MWU <italic>p</italic>-value 0.016), although with negligible effect size (<bold>Table S11)</bold>. Supporting the role of alternative pathway choice for DDR, key genes in the Alt-EJ pathway, including <italic>PARP-1</italic>, DNA polymerase θ (<italic>POLQ</italic>), <italic>LIG1</italic>, <italic>LIG3</italic>, <italic>FEN1</italic> were all significantly up-regulated in ecDNA(+) samples. Homology directed repair is the preferred pathway when a sister chromatid is available to act as a template. HDR is initiated by additional and extensive resection. The genes <italic>BLM</italic>, <italic>EXO1</italic>, <italic>RPA1</italic>, <italic>RPA3</italic> which promote additional resection, as well as <italic>BRCA1</italic>, <italic>BRCA2</italic>, <italic>RAD51</italic>, and others that support HDR were all found to be significantly up-regulated. We can conclude that the specific pathway choice for DSB repair in ecDNA(+) samples is dominated by alt-EJ and homology directed repair pathways, while c-NHEJ is not a preferred choice.</p>
</sec>
<sec id="s2f">
<title>CorEx genes primarily down-regulate immune system processes</title>
<p>Using methodology similar to the analysis of the up-regulated genes, the down-regulated genes enriched 73 GO terms (<bold>Table S14</bold>), and could be clustered into seven broad categories, including “Other” (<bold><xref rid="fig4" ref-type="fig">Fig. 4a</xref></bold>; <bold>Table S15</bold>; <bold>Fig. S5</bold>). Surprisingly, all categories were immunomodulatory. The most enriched broad category contained 75 CorEx genes relating to the Lymphocyte activation pathway. It included genes enriching “T-cell activation” (28 CorEx genes; <italic>p</italic>-value 2.58e-05), and “Positive regulation of cell-cell adhesion” (16 CorEx genes; <italic>p</italic>-value 4.49e-03). Other down-regulated pathways included Cytokine activation, especially for genes in the IL-12 pathway (6 CorEx genes, <italic>p</italic>-value 7.17e-03), TNF super-family (12 CorEx genes, <italic>p</italic>-value 7.24e-03), and Inflammation, including, for example, down-regulation of Toll-like receptor 2 signaling (4 CorEx genes, <italic>p</italic>-value 4.49e-03). Finally, the broad category of Leukocyte chemotaxis was also enriched among the down-regulated genes. The chemotaxis genes include many chemokines and their receptors involved in trafficking of T cells to the site of the tumor. The remaining down-regulated genes included four fucosyltransferases, and the category marked “Other.” <italic>FUT2</italic> silencing is associated with reduced adhesion and increased metastatic potential<sup><xref ref-type="bibr" rid="c34">34</xref></sup>. Notably, the category marked “Other” was dominated by genes in NF-κB pathway regulation (14 CorEx genes, <italic>p</italic>-value 2.28e-02).</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Down-regulated CorEx genes.</title>
<p><bold>(a)</bold> GO biological processes enriched in down-regulated genes were clustered into 7 broad categories. The horizontal barplot represents the number of GO biological processes belonging to each of the 7 broad categories, while the vertical barplot represents the number of broad categories that a specific GO biological process belongs to. <bold>(b)</bold> Four of these categories map to steps in the cancer-immunity cycle. CorEx genes in three of the four categories were significantly down-regulated compared to all genes (Fisher’s exact test).</p></caption>
<graphic xlink:href="537925v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>NF-κB signaling represents a prototypical, proinflammatory pathway<sup><xref ref-type="bibr" rid="c35">35</xref></sup> with multiple roles, including apoptosis. Specifically, 8 of the 14 down-regulated genes involved caspase activation (<bold>Table S16</bold>), representing the pro-apoptotic arm of NF-κB signaling. A parallel pathway for sensing endogenous ligands secreted in cell death and cancer is mediated by Toll-like receptor (TLR) proteins<sup><xref ref-type="bibr" rid="c36">36</xref></sup>. Remarkably, all ten TLRs were significantly down-regulated in ecDNA(+) tumors. They included TLRs expressed on the cell membrane that bind lipids and proteins as well as TLRs expressed on endosomal membranes that bind DNA. The CorEx down-regulated genes also included many involved in TLR signaling, such as <italic>TLR3</italic>, <italic>CYBA</italic>, <italic>LYN</italic>, and <italic>TIRAP</italic>.</p>
<p>Four of the seven broad categories mapped to facets of the cancer immune cycle<sup><xref ref-type="bibr" rid="c37">37</xref></sup> (<bold><xref rid="fig4" ref-type="fig">Fig. 4b</xref></bold>). We tested if CorEx genes in these categories were more likely to be down-regulated rather than up-regulated, when compared to the non-CorEx differentially expressed genes. The Inflammation category, which mapped to the “Cancer antigen presentation” facet, showed 18 up-regulated and 76 down-regulated CorEx genes (<italic>p</italic>-value 0.005, Fisher exact test, <bold>Table S15</bold>). Similarly, the CorEx genes related to the “Trafficking of T cells” facet (“Leukocyte migration and chemotaxis” category, 13 up, 49 down-regulated; <italic>p</italic>-value 0.03) and “Infiltration and recognition of tumor cells by cytotoxic T cells” facet (“Lymphocyte activation” category, 23 up, 75 down-regulated; <italic>p</italic>-value 0.0075) were also significantly down-regulated. However, down-regulation in the “Priming and activation” facet (“Cytokine production” category, 6 up, 28 down-regulated) was not significant at the 5% level.</p>
<p>As the RNA data were bulk-sequenced, transcripts were sampled from tumor cells and cells from the tumor microenvironment. Thorsson <italic>et al</italic>.<sup><xref ref-type="bibr" rid="c38">38</xref></sup> mined immune cell expression signatures to identify six immune subtypes: wound healing (C1), IFN-γ dominant (C2), inflammatory (C3), lymphocyte depleted (C4), immunologically quiet (C5), and TGF-β dominant (C6). A recent study analyzing the tumor microenvironment (TME) of ecDNA(+) vs. ecDNA(-) samples in seven tumor subtypes revealed an association of ecDNA presence with immune evasion<sup><xref ref-type="bibr" rid="c39">39</xref></sup>. Our results (<bold>Fig. S6</bold>), which used an updated version of the classification method for these ecDNA(+) samples, were broadly consistent with those from the Wu <italic>et al</italic><sup><xref ref-type="bibr" rid="c39">39</xref></sup>. study. Our results suggested an increase in C1 and C2 subtypes and a depletion of C3 and C6 between ecDNA(+) and ecDNA(-) categories (<italic>p</italic>-value 3.96e-03, Chi-squared test). Notably, the C3 (inflammatory) subtype is associated with lower levels of somatic copy number alterations, and C6 with high lymphocyte infiltration, while C1 is associated with elevated levels of angiogenic genes. These are consistent with our findings of increased somatic copy numbers, increased expression of angiogenic genes on ecDNA(+) samples, and reduced lymphocyte infiltration.</p>
</sec>
<sec id="s2g">
<title>ecDNA(+) samples carry a higher mutational burden relative to ecDNA(-) samples</title>
<p>In order to understand if the change in transcriptional program was driven by mutations to the genes, we checked if ecDNA(+) samples have differential levels of mutation relative to ecDNA(-). Intriguingly, we found that the total mutation burden was significantly higher in ecDNA(+) samples relative to ecDNA(-) samples (<bold><xref rid="fig5" ref-type="fig">Fig. 5a</xref></bold>). The result was significant also when mutations were limited to deleterious substitutions as measured by SIFT or PolyPhen2, and high-impact insertions and deletions (<bold>Fig. S7a</bold>). However, when controlling for cancer type, only glioblastoma (GBM; lower mutations in ecDNA(+)), low-grade gliomas (LGG; higher mutations in ecDNA(+)), and uterine corpus endometrial carcinoma (UCEC; lower mutations in ecDNA(+)) continued to show differential total mutational burden (<bold>Fig. S7b</bold>). Next, we tested if specific genes were differentially mutated between the two classes (<bold><xref rid="fig5" ref-type="fig">Fig. 5b</xref></bold>). For deleterious/high-impact mutations, <italic>TP53</italic> was the only gene whose mutational patterns were significantly higher in ecDNA(+) compared to ecDNA(-) (OR 2.67, Bonferroni adjusted <italic>p</italic>-value 4.22e-07). BRAF mutations, however, were more common in ecDNA(-) samples and were significant to an adjusted <italic>p</italic>-value &lt; 0.1 (OR 0.27). The excess of <italic>TP53</italic> mutations in ecDNA(+) samples provides additional support to the hypothesis that mutations in DNA damage response or cell cycle checkpoints are important for ecDNA presence. Other genes that are differentially mutated with nominal significance (unadjusted <italic>p</italic>-value &lt; 0.005) are shown in <bold>Table S17</bold>.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Mutational characteristics of ecDNA-containing tumors.</title>
<p><bold>(a)</bold> Total mutation burden of ecDNA(+) and ecDNA(-) samples. ecDNA(+) samples have significantly higher mutation burden than the ecDNA(-) samples (<italic>p</italic>-value &lt; 0.0001, Mann Whitney test). <bold>(b)</bold> Odds ratios of differentially mutated genes in ecDNA(+) and ecDNA(-) (<italic>p</italic>-value &lt; 0.005). The size of the dot indicates whether the corresponding gene belongs to the Cancer Gene Census (CGC) or not (Non-CGC). Only <italic>TP53</italic> and <italic>BRAF</italic> showed significance at the level of FDR &lt; 0.1 (Benjamini-Hochberg).</p></caption>
<graphic xlink:href="537925v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We also tested if a collection of gene mutations could predict ecDNA status using XGBoost<sup><xref ref-type="bibr" rid="c40">40</xref></sup>, which uses an adaptive boosting of “weak classifiers” to predict class. Here, each mutated gene was treated as a weak classifier of ecDNA status. However, the two classes could not be separated with high accuracy (<bold>Fig. S7c</bold>). An unsupervised principal component analysis did not separate the two classes either. Only the first principal component explained a significant proportion (14%) of the total variance (<bold>Fig. S7d</bold>) and did not separate the bulk of the samples. Finally, we recapitulated earlier findings that ecDNA(+) samples enrich for APOBEC activity through the presence of the mutation signatures SBS2 and SBS13<sup><xref ref-type="bibr" rid="c41">41</xref>,<xref ref-type="bibr" rid="c42">42</xref></sup> (<bold>Fig. S8</bold>). The enrichment in <italic>TP53</italic> mutations was also consistent with previous findings<sup><xref ref-type="bibr" rid="c5">5</xref></sup>. On balance, however, collections of gene mutations did not distinguish ecDNA(+) samples from ecDNA(-) samples, at least at a pan-cancer level, in contrast to the gene expression data.</p>
</sec>
<sec id="s2h">
<title>Persistently occurring genes in ecDNA(+) samples represent potential vulnerabilities</title>
<p>Any CorEx gene is either a Core gene that was selected as a feature in at least 5% of 200 Boruta trials, or be highly co-expressed with a Core gene. Because the selection criterion of 5% is arbitrary, we also tested robustness with 8 other cut-offs ranging from 5-of-200 to 200-of-200 Boruta trials. The number of CorEx genes expectedly decreases with more stringent cut-offs. However, of the 187 GO terms that were enriched by 262 CorEx UP-genes using 10 of 200 Boruta trials as the selection criteria, 93 terms (49.7%) were enriched for each cut-off (<bold>Fig. S9</bold>), and 155 terms (82.9%) were enriched in at least 5 of the 8 cut-off criteria. Given that our subsequent analyses utilized the hierarchy of GO terms and identified 4 GO-categories enriched by UP-regulated genes, the conclusions would hold regardless of the specific cut-off.</p>
<p>To rank CorEx genes by importance, we computed harmonic mean rank values based on three categories: a) the average GINI importance statistic from the trained random forest models; b) the number of Boruta trials that a gene was selected in; and c) the number of Boruta trials (out of 200) that a gene was selected in when counting by cluster (Methods). 65 genes that were up-regulated (47 genes) or down-regulated (18 genes) had a harmonic rank lower than 3 (<bold>Table 1)</bold>. The next highest ranked gene had harmonic rank exceeding 17. These 65 genes represent the most persistent differentially expressed CorEx genes, and appeared as Core (or clustered gene) in all 200 Boruta trials. Notably, of the 24 genes most frequently expressed on ecDNA,<sup><xref ref-type="bibr" rid="c2">2</xref></sup> only EGFR and CDK4 were included in the list of 65 genes, suggesting that the most persistent CorEx genes do not themselves appear frequently on ecDNA.</p>
<p>Expectedly, the high-ranked up-regulated genes impacted cell division (16 genes), cell cycle regulation (10 genes), DNA damage response (16 genes). Only 12 of the 47 genes were not included in the gene sets of any enriched GO term. Many of these genes were from small CorEx clusters with less than 3 members, but we also found 6 genes from the HOX gene cluster (cluster #17), and another cluster of 21 genes (cluster #3). Members of cluster #3 appeared in all 200 Boruta trials; however, there were three genes all involved in cell-division (<italic>TPX2</italic>, <italic>KIF2C</italic>, and <italic>AURKA</italic>), each of which appeared in at least 180 Boruta trials. High expression among these three genes is associated with poor prognosis<sup><xref ref-type="bibr" rid="c43">43</xref></sup>, and due to the highly persistent nature of their differential expression across ecDNA(+) samples, they represent a possible widespread vulnerability for ecDNA(+) samples.</p>
<p>Intriguingly, 14 of the 18 down-regulated genes with low harmonic rank came from a single cluster (#2; <bold>Table S2</bold>), and 13 of the 18 genes did not specifically enrich any specific BP ontology. Six of the down-regulated genes appeared in 180 or more Boruta trials (<italic>CHMP7</italic>, <italic>XPO7</italic>, <italic>INTS9</italic>, <italic>TACR1</italic>, <italic>KIAA1967</italic>, and <italic>PCM1</italic>). Some of these genes (<italic>CHMP7</italic>, <italic>XPO7</italic>, <italic>KIAA1967</italic>) are reported to be tumor suppressor genes<sup><xref ref-type="bibr" rid="c44">44</xref>–<xref ref-type="bibr" rid="c46">46</xref></sup>. However, the exact functional role of down-regulating these genes in ecDNA(+) samples remains to be elucidated.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>ecDNA is increasingly recognized as a major cause of oncogene amplification, intratumoral genetic heterogeneity, accelerated evolution, and treatment resistance, but many of the underlying processes involved in its formation, function, and progression are not fully understood. The ability to conduct multi-omic studies of well-curated, bona fide clinical tumor samples, such as the TCGA, presents an opportunity to learn about differentially regulated gene expression programs that may be involved in ecDNA biogenesis or maintenance, and in worse outcomes for patients<sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c9">9</xref></sup>. Using a relatively intuitive set of principles, we have developed a machine learning approach that identifies differentially expressed, co-regulated genes in ecDNA-containing tumors, highlighting four main biological processes: non-c-NHEJ DSB repair, cell cycle, proliferation control, and immune regulation.</p>
<p>The GO analysis revealed three core biological processes that were up-regulated and only the immune system processes as being down-regulated. These observations strengthen the case for targeting proteins involved in mitotic cell-division<sup><xref ref-type="bibr" rid="c47">47</xref></sup>, cell-cycle regulation, and DNA damage response in ecDNA(+) cancers, but also reveal roles for the <italic>HOX</italic> cluster of genes. Also, in this paper, we did not extensively study the role of ncRNA in prediction of ecDNA status. We do note that <italic>HOTAIR</italic>, encoded in the <italic>HOXC</italic> locus, is independently associated with metastasis and poor outcomes<sup><xref ref-type="bibr" rid="c48">48</xref></sup>. Further experiments are needed to provide a mechanistic basis for the role of <italic>HOX</italic> cluster genes in maintaining ecDNA presence, as also for involvement of ncRNA.</p>
<p>The DNA damage genes are broadly up-regulated in ecDNA(+) samples, especially in double-strand break repair. Within this broad category of mechanisms, our analysis suggests that alternative DSB repair pathways such as Alt-EJ are preferred relative to classical NHEJ. This is consistent with previous observations of small microhomologies at breakpoint junctions<sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c49">49</xref></sup>, and has important implications in therapeutic selection that will need to be validated in future experimental studies. We note, however, the microhomology analyses typically study breakpoint junctions, and might ignore double-strand breaks in non-junctional sequences which could be observed, for example at replication-transcription junctions.</p>
<p>The down-regulated genes were primarily immunomodulatory in nature, in addition to a few persistently down-regulated tumor suppressor genes. Lowered expression of immunomodulatory genes in ecDNA(+) samples has been previously reported<sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c39">39</xref></sup>, but not mechanistically explained. Remarkably, the down-regulated immunomodulatory genes encompassed most aspects of the cancer immune cycle, suggesting impaired recognition of tumor DNA and proteins as foreign in ecDNA(+) tumors. Sensing of foreign DNA, including tumor DNA, is often mediated by the cGAS/STING pathway<sup><xref ref-type="bibr" rid="c50">50</xref>,<xref ref-type="bibr" rid="c51">51</xref></sup>. Intriguingly, cGAS was significantly up-regulated in ecDNA(+) samples, while STING was significantly down-regulated, suggesting a role for STING agonists in intervention. Finally, in addition to the down-regulation of genes in the toll-like receptor family, we observed a down-regulation of genes involved in regulating TLR signaling pathways that were part of the CorEx list. Understanding the mechanisms of broad down-regulation of TLRs could provide insight into vulnerabilities of ecDNA(+) tumors.</p>
<p>Mutation data alone does not provide as clear a picture of the genes involved in ecDNA status prediction. We did observe that the total mutation burden (TMB) was higher in ecDNA(+) samples. However, that relationship is much less clear after controlling for cancer type. High TMB has been positively correlated with sensitivity to immunotherapy<sup><xref ref-type="bibr" rid="c52">52</xref></sup>, and better patient outcomes; however, the gene expression patterns suggest that immunomodulatory genes are down-regulated in ecDNA(+) samples, and patients with ecDNA(+) tumors have worse outcomes<sup><xref ref-type="bibr" rid="c2">2</xref></sup>. Notably, other results have suggested that the correlation between TMB and response to immunotherapy is not uniform, and it can vary across different tumor subtypes<sup><xref ref-type="bibr" rid="c53">53</xref></sup>. Specifically, our data is consistent with previous results which showed that Gliomas with high TMB have worse response to immunotherapy relative to gliomas with low TMB<sup><xref ref-type="bibr" rid="c53">53</xref></sup>. In general, no collection of gene mutations was predictive of ecDNA status, although mutations in <italic>TP53</italic> were more likely in ecDNA(+) samples, and perhaps are an important driver for ecDNA formation<sup><xref ref-type="bibr" rid="c5">5</xref></sup>.</p>
<p>These results suggest that cancer cells that contain ecDNA have profound alterations in their global transcriptional patterns. Importantly, these transcriptional differences do not arise solely from genes on the ecDNAs themselves, but rather suggest that fundamental global processes involved in DSB repair, cell cycle control, and immune regulation contribute to ecDNA formation and pathogenesis.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>TCGA sample ecDNA status classification</title>
<p>Amplicon Classifier (version 0.4.9, <ext-link ext-link-type="uri" xlink:href="https://github.com/jluebeck/AmpliconClassifier">https://github.com/jluebeck/AmpliconClassifier</ext-link>) classified amplicons detected in 1,921 TCGA samples into five sub-types: ecDNA, BFB, complex non-cyclic, linear, and no-amplification. When classifying a sample with multiple amplicons, the order of preference is as follows: ecDNA, BFB, complex non-cyclic, linear, and no-amplification. Given the challenges of detecting ecDNA from short read data, and to avoid possible false-negative ecDNA classifications, samples with a BFB or complex non-cyclic status which were not called ecDNA(+), were removed from the analysis. We treated samples with the linear amplification and no-amplification classifications as ecDNA(-). Of the 1,921 samples, 1,535 samples classified as ecDNA(+) and ecDNA(-) had RNA-seq data, including 1,406 primary solid tumor samples, 95 tumor metastasis samples, and 34 primary blood derived cancer – peripheral blood samples. Removing metastases results in a total of 1,440 samples, including 243 ecDNA(+) and 1,197 ecDNA(-) samples. While the set of 1,440 samples represented 24 tumor types, ten of these tumor types had insufficient numbers of ecDNA(+) samples, including four tumor types with no ecDNA(+) samples. To prevent the 561 ecDNA(-) samples representing these tumors from skewing the analysis, we removed 570 samples representing tumor types with less than three ecDNA(+) samples. This resulted in a total of 870 samples representing 14 tumor types, of which 234 were classified as ecDNA(+) and 636 were classified as ecDNA(-).</p>
</sec>
<sec id="s4b">
<title>Gene expression datasets</title>
<p>Gene expression data for 32 studies part of the TCGA Pan-cancer Atlas was downloaded from cBioPortal (01.05.2021) (<ext-link ext-link-type="uri" xlink:href="https://www.cbioportal.org/">https://www.cbioportal.org/</ext-link>). The cBioPortal “data_RNA_Seq_v2_expression_median.txt” data is sourced from the file “EB++AdjustPANCAN_IlluminaHiSeq_RNASeqV2.geneExp.tsv” (synapse id: syn4976363). Briefly, the matrices contain batch corrected values of the upper-quartile (UQ) normalized RSEM estimated counts data from Broad firehose (tumor.uncv2.mRNAseq_RSEM_all.txt). Missing values due to the batch effect correction process were imputed using <italic>K</italic>-nearest neighbors (KNN). For each tumor type, values were imputed based on gene vectors under the assumption that genes are similarly expressed between samples of the same tumor type. For genes with less than 60% of samples with missing values, values were imputed using the logarithmic (base 2) of the gene expression value plus one, and subsequently back-transformed when writing the imputed matrices to file. The resulting gene expression matrix used for the Boruta analysis described below consisted of 870 TCGA samples and 16,309 protein-coding genes (based on “hgnc_complete_set.txt” downloaded from HGNC on 7.24.2018). To generate a RSEM raw counts matrix for the DESeq2 analysis described below, mRNAseq_Preprocess.Level_3 data was downloaded from Broad Firehose (tumor.uncv2.mRNAseq_raw_counts.txt).</p>
</sec>
<sec id="s4c">
<title>Boruta analysis</title>
<p>To identify a minimal set of genes whose expression values were predictive of the sample being ecDNA(+), we used Boruta<sup><xref ref-type="bibr" rid="c10">10</xref></sup>, an automated feature selection algorithm that utilizes multiple iterations of the random forest classifier to determine the statistical significance of selected features. The algorithm is terminated when all features are categorized as “confirmed” or “rejected”, or until the user-defined number of iterations is reached. In our modified version of the BorutaPy python package (6.21.2021; <ext-link ext-link-type="uri" xlink:href="https://github.com/scikit-learn-contrib/boruta_py">https://github.com/scikit-learn-contrib/boruta_py</ext-link>), we set the maximum number of iterations to 400, a stagnant count maximum of 5, and a tentative count minimum of 50. This translates to termination of Boruta if 400 iterations are reached, or if the tentative count (features that have yet to be “confirmed” or “rejected”) falls to or below 50 and these tentative features remain tentative for 5 iterations.</p>
<p>While we use a standard implementation of Boruta, the method is briefly described here for expository purposes. In each iteration, <italic>i</italic>, within a single Boruta trial, the input is a gene expression matrix, <italic>M</italic>, of dimension <italic>r</italic> x c, where <italic>r</italic> is the number of samples and <italic>c</italic> is the number of tentative or confirmed features (i.e., genes). Boruta generates <italic>c</italic> shadow feature vectors by random shuffling of feature vectors in matrix <italic>M</italic>, generating a new matrix <italic>M’</italic> of dimension <italic>r</italic> x 2<italic>c</italic>. A random forest classifier (class_weight=balanced_subsample, max_depth=7) is then used to quantify the importance of each feature in separating ecDNA(+) from ecDNA(-) samples. Specifically, there are two possible outcomes for a feature: 1) if the feature scores higher than the best scoring shadow feature, the feature is considered a “hit”, and 2) if the feature scores lower than the best scoring shadow feature, the feature is considered a “non-hit”. Features are rejected after <italic>i</italic> iterations, if the number of hits is not significantly higher than expected by chance, using a Bonferroni corrected <italic>p</italic>-value.</p>
<p>In order to evaluate the ability of selected features in predicting the ecDNA status of a tumor sample, we left out 20% of ecDNA(+) and 20% of ecDNA(-) samples for the hold-out testing dataset in the evaluation procedure described below, and performed Boruta on the gene expression matrix consisting of the remaining 80% of samples. However, due to the unequal representation of ecDNA(+) and ecDNA(-) samples within each of the tumor subtypes, we opted to generate 200 training (80%) and testing (20%) datasets to decrease the bias that may be introduced during random sampling. For each of the 200 datasets, a Boruta analysis was performed on the 80% training data. Features categorized as “confirmed” were considered as Boruta genes for that specific trial. Of the 941 Boruta genes combined across the 200 trials, 408 genes were present in at least 10 of the 200 Boruta trials, and subsequently defined as the Core set of genes in downstream analyses.</p>
</sec>
<sec id="s4d">
<title>Highly co-expressed genes</title>
<p>To identify genes co-expressed with the core set of Boruta genes, hierarchical clustering of the 16,309 genes was performed using the R package pvclust<sup><xref ref-type="bibr" rid="c11">11</xref></sup> (ver. 2.2-0; dist.method=correlation, method=ward.D2, nboot=1000). A total of 843 significant clusters (AU &gt; 0.95) with at least 1 Boruta gene were selected, consisting of 1,375 genes. To obtain the final list of CorEx genes, we apply a minimal count of 10 trials for the gene or 10 trials for the cluster of genes seen in 200 Boruta trials. A cluster is determined to be seen in a Boruta trial if at least one of its members is selected in the trial. This results in 354 clusters, with a total number of 643 genes, of which 408 are Core genes.</p>
</sec>
<sec id="s4e">
<title>Evaluation of CorEx genes</title>
<p>To evaluate a set of genes, <italic>G</italic>, as predictive of ecDNA presence in tumor samples, we performed cross-validation and hyper-parameter tuning on each of the 80% training datasets, and evaluated the final model on the corresponding hold-out 20% testing dataset using the scikit-learn package. Specifically, the gene expression matrix for cross-validation and hyper-parameter tuning consisted of <italic>m</italic> samples from the training dataset and <italic>n</italic> genes from set <italic>G</italic>. RandomizedSearchCV (n_iter=50, cv=5, scoring=f1) was first used to narrow down a wide range of hyper-parameters for the random forest classifier (RandomForestClassifier, class_weight=’balanced_subsample’), and GridSearchCV (cv=StratifiedKFold(n_splits=5, shuffle=True), scoring=f1) was then used to test every combination of a smaller range of hyper-parameters given the best parameters from RandomizedSearchCV. The hyper-parameters tuned (initial values) include the number of trees in the forest (n_estimators: np.linspace(100, 2000, num = 10)), the maximum depth of the tree (max_depth: None, np.linspace(10, 100, num = 10)), the minimum number of samples required to split an internal node (min_samples_split: (2, 5, 10)), and the minimum number of samples required to be at a leaf node (min_samples_leaf: (1, 2, 4)). The best estimator from the GridSearchCV hyper-parameter tuning was then evaluated on the 20% testing dataset, where the gene expression matrix consisted of <italic>m</italic> samples from the testing dataset and <italic>n</italic> genes from set <italic>G</italic>. Performing this procedure on each of the 200 training/testing datasets resulted in 200 data points for each of the 3 metrics computed using sklearn.metrics: precision_score, recall_score, and average_precision_score (AUPR).</p>
<p>We performed this procedure on the following sets of genes, <italic>G</italic>: the 408 Core genes, 408 randomly selected genes, the 643 CorEx genes, 643 randomly selected genes, a set of 643 most differentially expressed genes based on the absolute log-fold change estimates from a conventional DE analysis using DESeq2<sup><xref ref-type="bibr" rid="c15">15</xref></sup> as described below, and the set of 3,012 significant genes from the GLM analysis described below.</p>
</sec>
<sec id="s4f">
<title>Generalized linear model (GLM) analysis</title>
<p>We tested each of 16,309 genes independently in a separate logistic regression model using the glm() function in the R stats package (v4.2.0), and retained genes that were significant (<italic>p</italic>-value 0.01). Specifically, the model was defined as glm(<italic>y</italic> ∼ <italic>g</italic><sub><italic>j</italic></sub> + <italic>t</italic>, data = <italic>M</italic>, family = binomial(link = ‘logit’)), where <italic>y</italic> is the response vector where <italic>y</italic><sub><italic>i</italic></sub>=1 if sample <italic>i</italic> ∈ {<italic>1</italic>,…,<italic>870</italic>} is ecDNA(+) and <italic>y</italic><sub><italic>i</italic></sub> =0 otherwise, <italic>g</italic><sub><italic>j</italic></sub> is the vector of expression values for gene <italic>j</italic> ∈ {<italic>1</italic>,…,<italic>16309</italic>} in samples <italic>i</italic> ∈ {<italic>1</italic>,…,<italic>870</italic>}, <italic>t</italic> is the covariate vector representing the tumor subtypes of samples <italic>i</italic> ∈ {<italic>1</italic>,…,<italic>870</italic>}, and <italic>M</italic> is the data matrix containing values of gene expression, tumor subtype, and ecDNA status for all samples. The equation for the binomial logistic regression described above is formulated as <inline-formula><inline-graphic xlink:href="537925v2_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, where <italic>p</italic> is the probability that the dependent variable <italic>y</italic> is 1, <italic>X</italic> are the independent variables, and <italic>β</italic> are the coefficients of the model. In this case, <italic>k</italic>=1 represents independent variable gene <italic>j</italic> and <italic>k</italic>=2 represents the tumor subtype covariate <italic>t</italic>. Of the 16,309 genes tested independently, 3,012 genes were significant at <italic>p</italic>-value&lt;0.01.</p>
</sec>
<sec id="s4g">
<title>Default DE analysis</title>
<p>We performed a default DESeq2<sup><xref ref-type="bibr" rid="c15">15</xref></sup> (R package, ver. 1.36.0) analysis to obtain shrunken maximum <italic>a posteriori</italic> (MAP) log-fold change estimates for effect size (i.e., LFC). Specifically, to obtain i) LFC effect size values per gene for integration with its Cliff’s delta effect size value when determining if a gene is up- or down-regulated in ecDNA(+) samples, and ii) a list of <italic>n</italic> top-ranked genes by absolute value of the LFC (with application of an adjusted <italic>p</italic>-value &lt;0.05 cutoff and LFC threshold of <italic>log<sub>2</sub></italic>(<italic>1</italic>.<italic>1</italic>) = <italic>0</italic>.<italic>13</italic>) for use in comparison against genes selected as important in the prediction of ecDNA in samples. For comparisons against Core genes, <italic>n</italic> is set to 408, and for comparisons against CorEx genes, <italic>n</italic>, is set to 643.</p>
<p>To obtain the LFC effect size metric between ecDNA(+) vs. ecDNA(-) samples for each gene’s expression, we fed as input to DESeq2 a matrix of raw RSEM estimated counts. To take into account batch effects, we included the center and platform information of samples, downloaded from synapse id syn4976363 (EB++GeneExpAnnotation.tsv), in the design of the DESeq object:</p>
<preformat>DESeq_object &lt;-DESeqDataSetFromMatrix(countData =
AC_0_4_9_TCGA_matrix, colData = coldata, design =
∼batch+condition)</preformat>
<p>To compute results, the lfcThreshold was set to <italic>log<sub>2</sub></italic>(<italic>1</italic>.<italic>1</italic>) for an accurate computation of <italic>p</italic>-values and the contrast set to c(“condition”, “ecDNA(+)”, “ecDNA(-)”) to obtain the logarithmic fold change of the form <inline-formula><inline-graphic xlink:href="537925v2_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. By setting the lfcThreshold, the null hypothesis tested is that |<italic>LFC</italic>| ≤ <italic>θ</italic>, where <italic>θ</italic> = (<italic>1</italic>.<italic>1</italic>), and the alternative hypothesis is that |<italic>LFC</italic>| &gt; <italic>θ</italic>. A <italic>log<sub>2</sub></italic>(<italic>1</italic>.<italic>1</italic>) value is chosen as the minimal value/negligible effect size threshold as it represents a 10% fold-change, and anything below this fold-change would likely not be of biological interest<sup><xref ref-type="bibr" rid="c54">54</xref></sup>. The specific commands run are as follows:</p>
<preformat>DESeq_object$condition &lt;-relevel(DESeq_object$condition, ref = “Non_ecDNA”)
DESeq_object &lt;-DESeq(DESeq_object)
results &lt;-results(DESeq_object, lfcThreshold= log2(1.1),
contrast=c(“condition”,“ecDNA”,“Non_ecDNA”))</preformat>
<p>To obtain the shrunken MAP log-fold change estimates, we used the lfcShrink function provided in DESeq2, using the default apeglm method for the empirical Bayes shrinkage procedure<sup><xref ref-type="bibr" rid="c55">55</xref></sup>:</p>
<preformat>lfcShrink(DESeq_object, lfcThreshold= log2(1.1),
coef=“condition_ecDNA_vs_Non_ecDNA”, type=“apeglm”)</preformat>
</sec>
<sec id="s4h">
<title>Up- or Down-regulated genes in ecDNA(+) samples</title>
<p>To categorize genes as “up-” or “down-” regulated in ecDNA(+) samples, we integrated two effect size metrics, Cliff’s delta (<italic>d</italic>)<sup><xref ref-type="bibr" rid="c16">16</xref>,<xref ref-type="bibr" rid="c17">17</xref></sup> and the DESeq2 shrunken MAPlog-fold change estimate (LFC<sup><xref ref-type="bibr" rid="c15">15</xref></sup>). Effect size is a measure of the magnitude of deviation from the null hypothesis, and unlike <italic>p</italic>-values, has the advantage of not being impacted by sample size<sup><xref ref-type="bibr" rid="c56">56</xref></sup>. This property is especially useful when comparing effect size values of a gene between tests where sample sizes differ. Comparing <italic>p</italic>-values between such tests would be invalid.</p>
<p>Cliff’s delta, <italic>d</italic>, is a non-parametric measure of the separation between two distributions and ranges from −1 to 1. Given two distributions, <italic>X</italic> = {<italic>i<sub>1</sub></italic>, <italic>i<sub>2</sub></italic>,…, <italic>i</italic><sub><italic>m</italic></sub>} and <italic>Y</italic> = {<italic>j<sub>1</sub></italic>, <italic>j<sub>2</sub></italic>,…, <italic>j</italic><sub><italic>n</italic></sub>}, comparisons are made between each of <italic>m</italic> values in <italic>X</italic> and <italic>n</italic> values in <italic>Y</italic>. Cliff’s delta is computed as <inline-formula><inline-graphic xlink:href="537925v2_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, where <italic>#</italic>(<italic>i</italic> &gt; <italic>j</italic>) is the number of times a member of <italic>X</italic> is greater than a member of <italic>Y</italic>, and <italic>#</italic>(<italic>i</italic> &lt; <italic>j</italic>) is the number of times a member of <italic>X</italic> is less than a member of <italic>Y</italic><sup><xref ref-type="bibr" rid="c16">16</xref></sup>. A negative <italic>d</italic> indicates that values in <italic>Y</italic> tend to be higher than <italic>X</italic>, while a positive <italic>d</italic> indicates that values in <italic>X</italic> tend to be higher than <italic>Y</italic>. The magnitude of the effect size of Cliff’s delta can be separated into four levels: |<italic>d</italic>| &lt; <italic>0</italic>.<italic>147</italic> for negligible effects, <italic>0</italic>.<italic>147</italic> ≤ |<italic>d</italic>| &lt; <italic>0</italic>.<italic>33</italic> for small effects, <italic>0</italic>.<italic>33</italic> ≤ |<italic>d</italic>| &lt; <italic>0</italic>.<italic>474</italic> for medium effects, and |<italic>d</italic>| ≥ <italic>0</italic>.<italic>474</italic> for large effects<sup><xref ref-type="bibr" rid="c56">56</xref></sup>. The python package used to compute Cliff’s delta values can be accessed at <ext-link ext-link-type="uri" xlink:href="https://github.com/neilernst/cliffsDelta">https://github.com/neilernst/cliffsDelta</ext-link>. The input values used to compute Cliff’s delta are log-transformed normalized gene expression values plus one as described in the “Gene expression datasets” section of methods.</p>
<p>The DESeq2 LFC is computed as described above. To allow integration of the Cliff’s delta effect size with the DESeq2 LFC, we also separated the LFC values into four levels: |<italic>LFC</italic>| &lt; <italic>log<sub>2</sub></italic>(<italic>1</italic>.<italic>1</italic>) for negligible effects, <italic>log<sub>2</sub></italic>(<italic>1</italic>.<italic>1</italic>) ≤ |<italic>LFC</italic>| &lt; <italic>log<sub>2</sub></italic>(<italic>1</italic>.<italic>5</italic>) for small effects, <italic>log<sub>2</sub></italic>(<italic>1</italic>.<italic>5</italic>) ≤ |<italic>LFC</italic>| &lt; <italic>log<sub>2</sub></italic>(<italic>2</italic>) or medium effects, and |<italic>LFC</italic>| ≥ <italic>log<sub>2</sub></italic>(<italic>2</italic>) for large effects.</p>
<p>For each gene, <italic>g</italic>, whether the gene is up-regulated or down-regulated in ecDNA(+) samples is determined by the signage and magnitude of its effect sizes <italic>d</italic><sub><italic>gg</italic></sub> and <italic>LFC</italic><sub><italic>gg</italic></sub>. The initial criteria for <italic>d</italic><sub><italic>gg</italic></sub>and <italic>LFC</italic><sub><italic>gg</italic></sub>to be used as a determinant in the direction of a gene is for it to have a magnitude larger than that of a negligible effect. If the signage of <italic>d</italic><sub><italic>gg</italic></sub>and <italic>LFC</italic><sub><italic>gg</italic></sub>are both positive, gene <italic>g</italic> is considered up-regulated in ecDNA(+). If only a single value has a magnitude larger than the negligible effect threshold (e.g, <italic>d</italic><sub><italic>gg</italic></sub> &gt; <italic>0</italic> and <italic>LFC</italic><sub><italic>gg</italic></sub> = −<italic>0</italic>.<italic>1</italic>), gene <italic>g</italic> is considered up-regulated in ecDNA(+). In the case of conflicting signages between the two values, the effect size with a larger magnitude takes precedence. For example, if <italic>d</italic><sub><italic>gg</italic></sub> = −<italic>0</italic>.<italic>2</italic> and <italic>LFC</italic><sub><italic>gg</italic></sub> = <italic>0</italic>.<italic>847</italic>, given that <italic>d</italic><sub><italic>gg</italic></sub>has a small negative effect and <italic>LFC</italic><sub><italic>gg</italic></sub>has a large positive effect, gene <italic>g</italic> is considered up-regulated in ecDNA(+) samples.</p>
</sec>
<sec id="s4i">
<title>Tumor heatmap</title>
<p>A Cliff’s delta effect size matrix representing 643 CorEx genes was generated to compare TCGA with tumor expression patterns. For each of the 11 tumor types with at least 10 ecDNA(+) and at least 10 ecDNA(-) samples, we re-computed Cliff’s delta. Using a Fisher’s exact test (fisher_exact function from the scipy.stats python package; alternative hypothesis: two-sided), we tested the null-hypothesis of whether the up- and down-directionality of CorEx genes in TCGA vs. each tumor were independent of each other. The contingency table is as below. The directionality of a gene (up or down) was based solely on the signage of the gene’s Cliff’s delta effect size value.</p>
<table-wrap id="utbl1" orientation="portrait" position="float">
<graphic xlink:href="537925v2_utbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s4j">
<title>TCGA</title>
<sec id="s4j1">
<title>Gene Ontology (GO) enrichment analysis</title>
<p>To identify Gene Ontology Biological Process (GOBP) terms that were enriched in either the set of down-regulated or up-regulated CorEx genes, we applied one-sided Fisher’s exact tests (alternative=”greater”; scipy.stats python package) on 2×2 contingency tables for each GOBP term. Specifically, in the contingency table below, N is the total number of genes in the universe (i.e., 16k for the number of genes measured in the RNAseq data), n is the number of DE genes (either up- or down-regulated in ecDNA(+) samples), m is the number of genes belonging to the GOBP term as defined by gene sets from MSigDB (c5.go.bp.v7.5.1.entrez), and k is the number of DE genes that belong to the GOBP term. The false discovery rate was controlled at 5% and adjusted <italic>p</italic>-values were computed using the Benjamini-Hochberg procedure (fdr correction from python statsmodels package). A final set of GOBP terms with adjusted <italic>p</italic>-value&lt;0.05 was used for downstream analysis.</p>
<table-wrap id="utbl2" orientation="portrait" position="float">
<graphic xlink:href="537925v2_utbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
</sec>
<sec id="s4k">
<title>Clustering gene sets</title>
<p>To cluster enriched gene sets into categories for visualization purposes, Cohen’s kappa coefficient (python sklearn cohen_kappa_score) was used to determine term-term “connectivity” (agreement of term-term pairs) – an approach described in the DAVID paper<sup><xref ref-type="bibr" rid="c22">22</xref></sup>. Given a <italic>r</italic> × <italic>c</italic> binary matrix, where enriched GOBP terms are rows, CorEx genes are columns, and values are 1 if a CorEx gene is part of the GOBP term or 0 otherwise, kappa scores were computed between each pair of terms, where term <italic>t</italic><sub><italic>i</italic></sub> ∈ <italic>t</italic> and <italic>i</italic> = {<italic>1</italic>,<italic>2</italic>,<italic>3</italic>,…. <italic>n</italic>}: <italic>Kappa</italic>_<italic>Score</italic>(<italic>t</italic><sub><italic>x</italic></sub>, <italic>t</italic><sub><italic>y</italic></sub>), where <italic>x</italic> ∈ <italic>i</italic> and y ∈ <italic>i</italic>.</p>
<p>Each term, <italic>t</italic><sub><italic>i</italic></sub>, formed an initial seeding group, <italic>g</italic><sub><italic>i</italic></sub>, where a term <italic>t</italic><sub><italic>x</italic></sub> is part of <italic>g</italic><sub><italic>i</italic></sub> if <italic>Kappa</italic>_<italic>Score</italic>(<italic>t</italic><sub><italic>i</italic></sub>, <italic>t</italic><sub><italic>x</italic></sub>) ≥ <italic>score threshold</italic>. If at least 50% of term-term pairs in <italic>g</italic><sub><italic>i</italic></sub> have a <italic>Kappa</italic>_<italic>Score</italic> ≥ <italic>score threshold</italic>, the initial seeding group <italic>g</italic><sub><italic>i</italic></sub> is retained for the next step. The second criteria ensures that terms within the same seeding group have strong interconnectivity. An iterative merging of seeding groups then follows: groups sharing p% or more members are merged. The representative term for each group was determined as the member with the highest interconnectivity score with other members of the group. After the automatic grouping process, a manual inspection leads to the merging of outliers or smaller groups into representative groups. We used a kappa score threshold of 0.5, and condition of p≥25% of shared members when merging for the down-regulated genes, and a kappa score threshold of 0.6 and condition of p≥50% of shared members when merging for the up-regulated genes.</p>
</sec>
<sec id="s4l">
<title>DDR pathway genes</title>
<p>We hand-curated 88 genes for double-stranded break DNA damage repair pathways (a-EJ, HR, c-NHEJ, SSA) via an extensive literature search, and added an additional 51 genes from the following MSigDB (c5.go.bp.v2022.1.Hs.entrez.gmt) GO biological process terms: GO:0097680 (double strand break repair via classical nonhomologous end joining), GO:0097681 (double strand break repair via alternative nonhomologous end joining), GO:1905168 (positive regulation of double strand break repair via homologous recombination), and GO:0045002 (double strand break repair via single strand annealing). This resulted in a final list of 129 genes. The directionality of the genes, as either up- or down-regulated in ecDNA(+) samples, is based on the full set of 1,440 samples, consisting of 243 ecDNA(+) and 1,197 ecDNA(-) samples representing 24 tumor types (<bold>Table S12</bold>; <bold>Table S13</bold>).</p>
<p>To test whether the number of genes passing our effect size thresholds for all genes 5,256 (UP) and 5,251 (DOWN) was significantly different from the up-/down-regulated genes implicated in each of the 4 pathways, we performed a Fisher’s exact test (fisher_exact function from the scipy.stats python package) on the contingency table below, where <italic>c</italic> and <italic>d</italic> are the up- and down-regulated genes for each of the pathways tested.</p>
<p>Contingency table:</p>
<table-wrap id="utbl3" orientation="portrait" position="float">
<graphic xlink:href="537925v2_utbl3.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>Pathway values:</p>
<table-wrap id="utbl4" orientation="portrait" position="float">
<graphic xlink:href="537925v2_utbl4.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s4m">
<title>Physical presence on amplicons</title>
<p>To determine physical presence of a gene on an amplicon, gene coordinates listed in the gene annotations file GRCh37/human_hg19_september_2011/Genes_July_2010_hg19.gff, downloaded from the AA repo on 3/21/2022, were mapped to amplicon genomic intervals (bed files). A gene is determined to be physically present on an amplicon if its genomic coordinates are fully encompassed within the amplicon genomic intervals.</p>
</sec>
<sec id="s4n">
<title>Mutational analysis</title>
<p>We pulled the list of mutations from the open-access version of MC3 dataset (<ext-link ext-link-type="uri" xlink:href="https://ellrottlab.org/project/mc3/">https://ellrottlab.org/project/mc3/</ext-link>), then investigated differences between ecDNA(+) and ecDNA(-) samples. Synonymous mutations were excluded when calculating the mutation burden.</p>
<p>For the differentially mutated gene analysis, only damaging mutations were selected by using snpEff<sup><xref ref-type="bibr" rid="c57">57</xref></sup> annotation which is originally included in the MC3 dataset. First, mutations annotated as HIGH in the IMPACT column were selected to obtain frameshift INDELs and stop gain SNVs. Next, mutations predicted to be damaging by SIFT<sup><xref ref-type="bibr" rid="c58">58</xref></sup> and PolyPhen2<sup><xref ref-type="bibr" rid="c59">59</xref></sup>, were selected to obtain damaging missense mutations. Finally, we generated 2-by-2 contingency tables for each gene with cells <italic>a</italic>, <italic>b</italic>, <italic>c</italic>, and <italic>d</italic> representing the number of individuals with and without damaging mutations in ecDNA(+) and (-) tumors. The odds ratios were computed as <inline-formula><inline-graphic xlink:href="537925v2_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, where <italic>a</italic> is the number of individuals in ecDNA(+) with the mutation, <italic>b</italic> is the number of individuals in ecDNA(+) without the mutation, <italic>c</italic> is the number of individuals in ecDNA(-) with the mutation, and <italic>d</italic> is the number of individuals in ecDNA(-) without the mutation. To determine if a gene contained mutations that were implicated in cancer, we checked genes against the Cancer Gene Census (CGC) database (v97)<sup><xref ref-type="bibr" rid="c60">60</xref></sup>, marking genes in the database as CGC and those that were not as non-CGC.</p>
</sec>
<sec id="s4o">
<title>Classification with mutational status</title>
<p>First, we created a binary matrix representing whether a gene is damaged or not, from the MC3 damaging mutation set described as above. Then we divided the whole matrix into 80% of the training set and 20% of the test set. Hyperopt was applied on the training set to select the best parameters for the XGBoost<sup><xref ref-type="bibr" rid="c40">40</xref></sup> model. The optimal parameters estimated by Hyperopt (eta = 0.1, max_depth = 6, min_child_weight = 3.0, scale_pos_weight = 4.9) were input to the XGBoost model, and the ecDNA status of each sample were also input as an answer set. The performance of the model was checked by inputting the 20% test set to the model and comparing the output result with the answer. Principal component analysis was also performed with the same mutational matrix as above, using the scikit.learn package.</p>
</sec>
<sec id="s4p">
<title>Ranking of CorEx genes</title>
<p>To rank CorEx genes by importance, we computed harmonic mean rank values based on three categories: a) the average Gini importance statistic or mean decrease impurity (MDI) MDI (feature importance) values extracted from the trained random forest models on 200 training sets during the evaluation method described above, b) the number of Boruta trials (out of 200) that a gene is selected in, rounded to 2-digits, and c) the number of Boruta trials (out of 200) that a gene is selected in when counting by cluster, rounded to 2-digits. The ranks for each category are adjusted separately so that genes with the same value share the same rank value. For example, if using the Boruta trial count as the rank value:</p>
<table-wrap id="utbl5" orientation="portrait" position="float">
<graphic xlink:href="537925v2_utbl5.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>The harmonic mean rank is defined as:
<disp-formula>
<graphic xlink:href="537925v2_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
</sec>
<sec id="s4q">
<title>Tumor immune subtype</title>
<p>We classified ecDNA(+) and ecDNA(-) samples into the 6 immune subtype categories (Thorsson et al., 2018<sup><xref ref-type="bibr" rid="c38">38</xref></sup>) provided in Table S6 from Bagaev et al., 2021<sup><xref ref-type="bibr" rid="c61">61</xref></sup>.</p>
</sec>
<sec id="s4r">
<title>Impact of tumor purity on CorEx gene expression</title>
<p>To investigate the effects of the presence of non-cancer tissue (impurity) in bulk RNA-seq samples on the analyses performed in this study, we utilized the consensus measurement of purity estimations (CPE) for TCGA samples from a publication by Aran et al.<sup><xref ref-type="bibr" rid="c14">14</xref></sup>. Of the 870 TCGA samples (234 ecDNA(+), 636 ecDNA(-)) with gene expression (RNA-seq) data, 701 samples (174 ecDNA(+), 527 ecDNA(-)) were assigned a CPE value by Aran et al.. To determine if the presence of undetected ecDNA in ecDNA(-) samples would confound the results by reducing the discriminating power of genes, we measured the expression directionality of CorEx genes in all samples (n=870) versus samples which had a high tumor purity (CPE≥0.8, n=287). Specifically, <italic>p</italic>-values were obtained by performing Mann-Whitney U rank tests (scipy.stats python package) on gene expression values of ecDNA(+) and ecDNA(-) samples for both the 870 TCGA samples and 287 TCGA samples with high tumor purity. Genes with a significantly (<italic>p</italic>-value≤0.05) higher expression in ecDNA(+) samples (alternative=“greater”) were labeled as “UP”, while genes with a significantly lower expression in ecDNA(+) samples (alternative= “less”) were labeled as “DOWN”. To generate a plot that compared gene directionality of all samples vs. high purity samples using <italic>p</italic>-values, a function <italic>F</italic> was applied to <italic>p</italic>-values. Specifically, <italic>F</italic>(<italic>p</italic>) = <italic>d</italic> ⋅ <italic>log</italic><sub>10</sub>(<italic>p</italic>), where <italic>p</italic> is the <italic>p</italic>-value and <italic>d</italic> = 1 if directionality is “DOWN” and <italic>d</italic> = −1 if directionality is “UP”.</p>
</sec>
</sec>
<sec id="s5">
<title>Author Contributions</title>
<p>M.S.L., P.S.M, and V.B. conceived and designed the experiments and core narrative of the manuscript. All analyses were performed by M.S.L., apart from the following ones. Mutational analysis was performed by S.J. The amplicon classifications were performed by J.L. S.W, V.B, H.Y.C. and P.S.M. provided guidance on the analysis and interpretation of results. M.S.L., S.J., J.L., and V.B. wrote the manuscript with feedback from all authors.</p>
</sec>
<sec id="d1e2171" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e2294">
<label>Table 1</label>
<media xlink:href="supplements/537925_file02.xlsx"/>
</supplementary-material>
<supplementary-material id="d1e2301">
<label>Supplementary Tables</label>
<media xlink:href="supplements/537925_file03.xlsx"/>
</supplementary-material>
<supplementary-material id="d1e2308">
<label>Supplementary Tables Captions</label>
<media xlink:href="supplements/537925_file04.pdf"/>
</supplementary-material>
<supplementary-material id="d1e2315">
<label>Supplementary Figures</label>
<media xlink:href="supplements/537925_file05.pdf"/>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>This project was supported by Cancer Grand Challenges CGCSDF-2021\100007 with support from Cancer Research UK and the National Cancer Institute (V.B, H.Y.C., P.S.M.) M.S.L., J.L., and V.B. were supported in part by grants U24CA264379, R01GM114362, and OT2CA278635 from the NIH and CGCATF-2021/100025 from CRUK. S.J. was supported by a grant of the Korea Health Technology R&amp;D Project through the Korea Health Industry Development Institute (KHIDI), funded by the Ministry of Health &amp; Welfare, Republic of Korea (grant number: HI19C1330).</p>
</ack>
<sec id="s6">
<title>Competing Interests</title>
<p>V.B. is a co-founder, paid consultant, SAB member and has equity interest in Boundless Bio, inc. and Abterra Biosciences, Inc. H.Y.C. is a co-founder of Accent Therapeutics, Boundless Bio, Cartography Biosciences, Orbital Therapeutics, and an advisor of 10x Genomics, Arsenal Biosciences, Chroma Medicine, and Spring Discovery. P.S.M. is a co-founder and advisor of Boundless Bio. J.L. receives compensation as a consultant for Boundless Bio. The remaining authors declare no competing interests.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Turner</surname>, <given-names>K. M.</given-names></string-name> <etal>et al.</etal> <article-title>Extrachromosomal oncogene amplification drives tumour evolution and genetic heterogeneity</article-title>. <source>Nature</source> <volume>543</volume>, <fpage>122</fpage>–<lpage>125</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Kim</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title>Extrachromosomal DNA is associated with oncogene amplification and poor outcome across multiple cancers</article-title>. <source>Nat. Genet</source>. <volume>52</volume>, <fpage>891</fpage>–<lpage>897</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Nathanson</surname>, <given-names>D. A.</given-names></string-name> <etal>et al.</etal> <article-title>Targeted therapy resistance mediated by dynamic regulation of extrachromosomal mutant EGFR DNA</article-title>. <source>Science</source> <volume>343</volume>, <fpage>72</fpage>–<lpage>76</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Lange</surname>, <given-names>J. T.</given-names></string-name> <etal>et al.</etal> <article-title>The evolutionary dynamics of extrachromosomal DNA in human cancers</article-title>. <source>Nat. Genet</source>. <volume>54</volume>, <fpage>1527</fpage>–<lpage>1533</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Luebeck</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>Extrachromosomal DNA in the cancerous transformation of Barrett’s oesophagus</article-title>. <source>Nature</source> (<year>2023</year>) doi:<pub-id pub-id-type="doi">10.1038/s41586-023-05937-5</pub-id>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Hung</surname>, <given-names>K. L.</given-names></string-name> <etal>et al.</etal> <article-title>ecDNA hubs drive cooperative intermolecular oncogene expression</article-title>. <source>Nature</source> <volume>600</volume>, <fpage>731</fpage>–<lpage>736</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Circular ecDNA promotes accessible chromatin and high oncogene expression</article-title>. <source>Nature</source> <volume>575</volume>, <fpage>699</fpage>–<lpage>703</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Morton</surname>, <given-names>A. R.</given-names></string-name> <etal>et al.</etal> <article-title>Functional Enhancers Shape Extrachromosomal Oncogene Amplifications</article-title>. <source>Cell</source> <volume>179</volume>, <fpage>1330</fpage>–<lpage>1341.e13</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>van Leen</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Brückner</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Henssen</surname>, <given-names>A. G</given-names></string-name>. <article-title>The genomic and spatial mobility of extrachromosomal DNA and its implications for cancer therapy</article-title>. <source>Nat. Genet</source>. <volume>54</volume>, <fpage>107</fpage>–<lpage>114</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Kursa</surname>, <given-names>M. B.</given-names></string-name> &amp; <string-name><surname>Rudnicki</surname>, <given-names>W. R</given-names></string-name>. <article-title>Feature Selection with the Boruta Package</article-title>. <source>J. Stat. Softw</source>. <volume>36</volume>, (<year>2010</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Suzuki</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Shimodaira</surname>, <given-names>H</given-names></string-name>. <article-title>Pvclust: an R package for assessing the uncertainty in hierarchical clustering</article-title>. <source>Bioinformatics</source> <volume>22</volume>, <fpage>1540</fpage>–<lpage>1542</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Kobayashi</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> <article-title>Mitotic checkpoint regulator RAE1 promotes tumor growth in colorectal cancer</article-title>. <source>Cancer Sci</source>. <volume>112</volume>, <fpage>3173</fpage>–<lpage>3189</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Wang</surname>, <given-names>Q.</given-names></string-name> <etal>et al.</etal> <article-title>Prognostic Potential of Alternative Splicing Markers in Endometrial Cancer</article-title>. <source>Mol. Ther. - Nucleic Acids</source> <volume>18</volume>, <fpage>1039</fpage>–<lpage>1048</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Aran</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Sirota</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Butte</surname>, <given-names>A. J</given-names></string-name>. <article-title>Systematic pan-cancer analysis of tumour purity</article-title>. <source>Nat. Commun</source>. <volume>6</volume>, <fpage>8971</fpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Love</surname>, <given-names>M. I.</given-names></string-name>, <string-name><surname>Huber</surname>, <given-names>W.</given-names></string-name> &amp; <string-name><surname>Anders</surname>, <given-names>S</given-names></string-name>. <article-title>Moderated estimation of fold change and dispersion for RNA-seq data with DESeq2</article-title>. <source>Genome Biol</source>. <volume>15</volume>, <fpage>550</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Cliff</surname>, <given-names>N</given-names></string-name>. <article-title>Dominance statistics: Ordinal analyses to answer ordinal questions</article-title>. <source>Psychol. Bull</source>. <volume>114</volume>, <fpage>494</fpage>–<lpage>509</lpage> (<year>1993</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Cliff</surname>, <given-names>N</given-names></string-name>. <article-title>Answering Ordinal Questions with Ordinal Data Using Ordinal Statistics</article-title>. <source>Multivar. Behav. Res</source>. <volume>31</volume>, <fpage>331</fpage>–<lpage>350</lpage> (<year>1996</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Garsed</surname>, <given-names>D. W.</given-names></string-name> <etal>et al.</etal> <article-title>The Architecture and Evolution of Cancer Neochromosomes</article-title>. <source>Cancer Cell</source> <volume>26</volume>, <fpage>653</fpage>–<lpage>667</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Subramanian</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Gene set enrichment analysis: A knowledge-based approach for interpreting genome-wide expression profiles</article-title>. <source>Proc. Natl. Acad. Sci</source>. <volume>102</volume>, <fpage>15545</fpage>–<lpage>15550</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Liberzon</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Molecular signatures database (MSigDB) 3.0</article-title>. <source>Bioinformatics</source> <volume>27</volume>, <fpage>1739</fpage>–<lpage>1740</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Liberzon</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>The Molecular Signatures Database Hallmark Gene Set Collection</article-title>. <source>Cell Syst</source>. <volume>1</volume>, <fpage>417</fpage>–<lpage>425</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Huang</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal> <article-title>The DAVID Gene Functional Classification Tool: a novel biological module-centric algorithm to functionally analyze large gene lists</article-title>. <source>Genome Biol</source>. <volume>8</volume>, <fpage>R183</fpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Feng</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> <article-title>Homeobox Genes in Cancers: From Carcinogenesis to Recent Therapeutic Intervention</article-title>. <source>Front. Oncol</source>. <volume>11</volume>, <fpage>770428</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Fish</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal> <article-title>A prometastatic splicing program regulated by SNRPA1 interactions with structured RNA elements</article-title>. <source>Science</source> <volume>372</volume>, <fpage>eabc7531</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Cui</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal> <article-title>TNFAIP6 Promotes Gastric Carcinoma Cell Invasion via Upregulating PTX3 and Activating the Wnt/β-Catenin Signaling Pathway</article-title>. <source>Contrast Media Mol. Imaging 2022</source>, <fpage>1</fpage>–<lpage>9</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> <article-title>TMEM203 is a binding partner and regulator of STING-mediated inflammatory signaling in macrophages</article-title>. <source>Proc. Natl. Acad. Sci</source>. <volume>116</volume>, <fpage>16479</fpage>–<lpage>16488</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><surname>Feng</surname>, <given-names>Z.</given-names></string-name>, <etal>et al.</etal> <article-title><italic>RNF114</italic> Silencing Inhibits the Proliferation and Metastasis of Gastric Cancer</article-title>. <source>J. Cancer</source> <volume>13</volume>, <fpage>565</fpage>–<lpage>578</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Ribeiro</surname>, <given-names>J. R.</given-names></string-name>, <string-name><surname>Lovasco</surname>, <given-names>L. A.</given-names></string-name>, <string-name><surname>Vanderhyden</surname>, <given-names>B. C.</given-names></string-name> &amp; <string-name><surname>Freiman</surname>, <given-names>R. N</given-names></string-name>. <article-title>Targeting TBP-Associated Factors in Ovarian Cancer</article-title>. <source>Front. Oncol</source>. <volume>4</volume>, (<year>2014</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Xu</surname>, <given-names>N.</given-names></string-name> <etal>et al.</etal> <article-title>SHCBP1 promotes tumor cell proliferation, migration, and invasion, and is associated with poor prostate cancer prognosis</article-title>. <source>J. Cancer Res. Clin. Oncol</source>. <volume>146</volume>, <fpage>1953</fpage>–<lpage>1969</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Chang</surname>, <given-names>H. H. Y.</given-names></string-name>, <string-name><surname>Pannunzio</surname>, <given-names>N. R.</given-names></string-name>, <string-name><surname>Adachi</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Lieber</surname>, <given-names>M. R</given-names></string-name>. <article-title>Non-homologous DNA end joining and alternative pathways to double-strand break repair</article-title>. <source>Nat. Rev. Mol. Cell Biol</source>. <volume>18</volume>, <fpage>495</fpage>–<lpage>506</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Ghosh</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Raghavan</surname>, <given-names>S. C</given-names></string-name>. <article-title>20 years of DNA Polymerase μ, the polymerase that still surprises</article-title>. <source>FEBS J</source>. <volume>288</volume>, <fpage>7230</fpage>–<lpage>7242</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Daley</surname>, <given-names>J. M.</given-names></string-name> &amp; <string-name><surname>Sung</surname>, <given-names>P</given-names></string-name>. <article-title>53BP1, BRCA1, and the Choice between Recombination and End Joining at DNA Double-Strand Breaks</article-title>. <source>Mol. Cell. Biol</source>. <volume>34</volume>, <fpage>1380</fpage>–<lpage>1388</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Fouquin</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>PARP2 controls double-strand break repair pathway choice by limiting 53BP1 accumulation at DNA damage sites and promoting end-resection</article-title>. <source>Nucleic Acids Res</source>. <volume>45</volume>, <fpage>12325</fpage>–<lpage>12339</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>He</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Guo</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Tian</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Lin</surname>, <given-names>R</given-names></string-name>. <article-title>FUT2 inhibits the EMT and metastasis of colorectal cancer by increasing LRP1 fucosylation</article-title>. <source>Cell Commun. Signal. CCS</source> <volume>21</volume>, <fpage>63</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Lawrence</surname>, <given-names>T</given-names></string-name>. <article-title>The Nuclear Factor NF-B Pathway in Inflammation</article-title>. <source>Cold Spring Harb. Perspect. Biol</source>. <volume>1</volume>, <fpage>a001651</fpage>–<lpage>a001651</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Urban-Wojciuk</surname>, <given-names>Z.</given-names></string-name> <etal>et al.</etal> <article-title>The Role of TLRs in Anti-cancer Immunity and Tumor Rejection</article-title>. <source>Front. Immunol</source>. <volume>10</volume>, <fpage>2388</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><surname>Chen</surname>, <given-names>D. S.</given-names></string-name> &amp; <string-name><surname>Mellman</surname>, <given-names>I</given-names></string-name>. <article-title>Oncology Meets Immunology: The Cancer-Immunity Cycle</article-title>. <source>Immunity</source> <volume>39</volume>, <fpage>1</fpage>–<lpage>10</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Thorsson</surname>, <given-names>V.</given-names></string-name> <etal>et al.</etal> <article-title>The Immune Landscape of Cancer</article-title>. <source>Immunity</source> <volume>48</volume>, <fpage>812</fpage>–<lpage>830.e14</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal> <article-title>Extrachromosomal DNA formation enables tumor immune escape potentially through regulating antigen presentation gene expression</article-title>. <source>Sci. Rep</source>. <volume>12</volume>, <fpage>3590</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><surname>Chen</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Guestrin</surname>, <given-names>C.</given-names></string-name> <article-title>XGBoost: A Scalable Tree Boosting System</article-title>. in <source>Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining 785–794</source> (<collab>Association for Computing Machinery</collab>, <year>2016</year>). doi:<pub-id pub-id-type="doi">10.1145/2939672.2939785</pub-id>.</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><string-name><surname>Bergstrom</surname>, <given-names>E. N.</given-names></string-name> <etal>et al.</etal> <article-title>Mapping clustered mutations in cancer reveals APOBEC3 mutagenesis of ecDNA</article-title>. <source>Nature</source> <volume>602</volume>, <fpage>510</fpage>–<lpage>517</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><string-name><surname>Hadi</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal> <article-title>Distinct Classes of Complex Structural Variation Uncovered across Thousands of Cancer Genome Graphs</article-title>. <source>Cell</source> <volume>183</volume>, <fpage>197</fpage>–<lpage>210.e32</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><string-name><surname>Luca</surname>, <given-names>M. D.</given-names></string-name>, <string-name><surname>Lavia</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Guarguaglini</surname>, <given-names>G</given-names></string-name>. <article-title>A Functional Interplay Between Aurora-A, Plk1 and TPX2 at Spindle Poles: Plk1 Controls Centrosomal Localization of Aurora-A and TPX2 Spindle Association</article-title>. <source>Cell Cycle</source> <volume>5</volume>, <fpage>296</fpage>–<lpage>303</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><string-name><surname>Guo</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Shi</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Zhao</surname>, <given-names>Z.</given-names></string-name> &amp; <string-name><surname>Wang</surname>, <given-names>M</given-names></string-name>. <article-title>Multidimensional Analysis of the Role of Charged Multivesicular Body Protein 7 in Pan-Cancer</article-title>. <source>Int. J. Gen. Med</source>. Volume <volume>14</volume>, <fpage>7907</fpage>–<lpage>7923</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><string-name><surname>Innes</surname>, <given-names>A. J.</given-names></string-name> <etal>et al.</etal> <article-title>XPO7 is a tumor suppressor regulating p21 <sup>CIP1</sup>-dependent senescence</article-title>. <source>Genes Dev</source>. <volume>35</volume>, <fpage>379</fpage>–<lpage>391</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><string-name><surname>Qin</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal> <article-title>DBC1 functions as a tumor suppressor by regulating p53 stability</article-title>. <source>Cell Rep</source>. <volume>10</volume>, <fpage>1324</fpage>–<lpage>1334</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><string-name><surname>Von Hoff</surname>, <given-names>D. D.</given-names></string-name> <etal>et al.</etal> <article-title>Elimination of extrachromosomally amplified MYC genes from human tumor cells reduces their tumorigenicity</article-title>. <source>Proc. Natl. Acad. Sci</source>. <volume>89</volume>, <fpage>8165</fpage>–<lpage>8169</lpage> (<year>1992</year>).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><string-name><surname>Gupta</surname>, <given-names>R. A.</given-names></string-name> <etal>et al.</etal> <article-title>Long noncoding RNA HOTAIR reprograms chromatin state to promote cancer metastasis</article-title>. <source>Nature</source> <volume>464</volume>, <fpage>1071</fpage>–<lpage>1076</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><string-name><surname>Sanborn</surname>, <given-names>J. Z.</given-names></string-name> <etal>et al.</etal> <article-title>Double Minute Chromosomes in Glioblastoma Multiforme Are Revealed by Precise Reconstruction of Oncogenic Amplicons</article-title>. <source>Cancer Res</source>. <volume>73</volume>, <fpage>6036</fpage>–<lpage>6045</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><string-name><surname>Samson</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Ablasser</surname>, <given-names>A.</given-names></string-name> <article-title>The cGAS–STING pathway and cancer</article-title>. <source>Nat. Cancer</source> (<year>2022</year>) doi:<pub-id pub-id-type="doi">10.1038/s43018-022-00468-w</pub-id>.</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><string-name><surname>Sun</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Wu</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Du</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>X.</given-names></string-name> &amp; <string-name><surname>Chen</surname>, <given-names>Z. J</given-names></string-name>. <article-title>Cyclic GMP-AMP Synthase Is a Cytosolic DNA Sensor That Activates the Type I Interferon Pathway</article-title>. <source>Science</source> <volume>339</volume>, <fpage>786</fpage>–<lpage>791</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><string-name><surname>Rizvi</surname>, <given-names>N. A.</given-names></string-name> <etal>et al.</etal> <article-title>Mutational landscape determines sensitivity to PD-1 blockade in non– small cell lung cancer</article-title>. <source>Science</source> <volume>348</volume>, <fpage>124</fpage>–<lpage>128</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><string-name><surname>McGrail</surname>, <given-names>D. J.</given-names></string-name> <etal>et al.</etal> <article-title>High tumor mutation burden fails to predict immune checkpoint blockade response across all cancer types</article-title>. <source>Ann. Oncol</source>. <volume>32</volume>, <fpage>661</fpage>–<lpage>672</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><string-name><surname>McCarthy</surname>, <given-names>D. J.</given-names></string-name> &amp; <string-name><surname>Smyth</surname>, <given-names>G. K</given-names></string-name>. <article-title>Testing significance relative to a fold-change threshold is a TREAT</article-title>. <source>Bioinformatics</source> <volume>25</volume>, <fpage>765</fpage>–<lpage>771</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><string-name><surname>Zhu</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Ibrahim</surname>, <given-names>J. G.</given-names></string-name> &amp; <string-name><surname>Love</surname>, <given-names>M. I</given-names></string-name>. <article-title>Heavy-tailed prior distributions for sequence count data: removing the noise and preserving large differences</article-title>. <source>Bioinformatics</source> <volume>35</volume>, <fpage>2084</fpage>–<lpage>2092</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><string-name><surname>Romano</surname>, <given-names>Jeanine</given-names></string-name>, <string-name><given-names>Jeffrey D.</given-names> <surname>Kromrey</surname></string-name>, <string-name><given-names>Jesse</given-names> <surname>Coraggio</surname></string-name>, &amp; <string-name><given-names>Jeff</given-names> <surname>Skowronek</surname></string-name>. <article-title>Appropriate statistics for ordinal level data: Should we really be using t-test and Cohen’sd for evaluating group differences on the NSSE and other surveys?</article-title> <source>Annu. Meet. Fla. Assoc. Institutional Res</source>. <volume>177</volume>, <fpage>34</fpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><string-name><surname>Cingolani</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal> <article-title>A program for annotating and predicting the effects of single nucleotide polymorphisms, SnpEff: SNPs in the genome of Drosophila melanogaster strain w1118; iso-2; iso-3</article-title>. <source>Fly (Austin)</source> <volume>6</volume>, <fpage>80</fpage>–<lpage>92</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><string-name><surname>Ng</surname>, <given-names>P. C.</given-names></string-name> &amp; <string-name><surname>Henikoff</surname>, <given-names>S</given-names></string-name>. <article-title>SIFT: Predicting amino acid changes that affect protein function</article-title>. <source>Nucleic Acids Res</source>. <volume>31</volume>, <fpage>3812</fpage>–<lpage>3814</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><string-name><surname>Adzhubei</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Jordan</surname>, <given-names>D. M.</given-names></string-name> &amp; <string-name><surname>Sunyaev</surname>, <given-names>S. R</given-names></string-name>. <article-title>Predicting functional effect of human missense mutations using PolyPhen-2</article-title>. <source>Curr. Protoc. Hum. Genet</source>. Chapter <volume>7</volume>, <collab>Unit7.20</collab> (<year>2013</year>).</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="journal"><string-name><surname>Sondka</surname>, <given-names>Z.</given-names></string-name> <etal>et al.</etal> <article-title>The COSMIC Cancer Gene Census: describing genetic dysfunction across all human cancers</article-title>. <source>Nat. Rev. Cancer</source> <volume>18</volume>, <fpage>696</fpage>–<lpage>705</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="journal"><string-name><surname>Bagaev</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Conserved pan-cancer microenvironment subtypes predict response to immunotherapy</article-title>. <source>Cancer Cell</source> <volume>39</volume>, <fpage>845</fpage>–<lpage>865.e7</lpage> (<year>2021</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88895.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Gingeras</surname>
<given-names>Thomas R</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Cold Spring Harbor Laboratory</institution>
</institution-wrap>
<city>Cold Spring Harbor</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study of extrachromosomal DNA (ecDNA) identifies genes that distinguish ecDNA+ and ecDNA- tumors. The findings in the manuscript are <bold>important</bold> and the genomic analyses <bold>convincing</bold>. However, some of the data remain observational and the inferences would therefore be more robust with experimental validation. This manuscript could well be of relevance to biologists interested in cancer biology and gene regulation.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88895.2.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Recently discovered extrachromosomal DNA (ecDNA) provides an alternative non-chromosomal means for oncogene amplification and a potent substrate for selective evolution of tumors. The current work aims to identify key genes whose expression distinguishes ecDNA+ and ecDNA- tumors and the associated processes to shed light on the biological mechanisms underlying ecDNA genesis and their oncogenic effects. This is clearly an important question and through detailed analysis this work points to specific GO processes associated (up and down) with ecDNA+ tumors, namely, specific DNA damage repair processes and specific oncogenic processes.</p>
<p>In the initial submission I had commented on lack of clarity of method, potential biases, and in some cases inappropriate interpretation. In the revised version, the authors have addressed all my comments satisfactorily and I think this is an important work furthering our understanding of mechanisms underlying ecDNA+ tumors.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88895.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>In their manuscript Lin et al. describe an important study on the transcriptional programs associated with the presence of extrachromosomal DNA in a cohort of 870 cancers of different origins. The authors find that compared to cancers lacking such amplifications, ecDNA+ cancers express higher levels of DNA damage repair-associated genes, but lower levels of immune-related gene programs.</p>
<p>This work is very timely and its findings have the potential to be very impactful, as the transcriptional context differences between ecDNA+ and ecDNA- cancers are currently largely unknown. The observation that immune programs are downregulated in ecDNA+ cancers may initiate new preclinical and translational studies that impact the way ecDNA+ cancers are treated in the future. Thus, this study has important theoretical implications that have the potential to substantially advance our understanding of ecDNA+ cancers.</p>
<p>Strengths:</p>
<p>The authors provide compelling evidence for their conclusions based on large patient datasets. The methods they used and analyses are rigorous.</p>
<p>Weaknesses:</p>
<p>The biological interpretation of the data remains observational. The direct implication of these genes in ecDNA(+) tumors is not tested experimentally.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88895.2.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>Using a combination of approaches, including automated feature selection and hierarchical clustering, the author identified a set of genes persistently associated with extrachromosomal DNA (ecDNA) presence across cancer types. The authors further validated the gene set identified using gene ontology enrichment analysis and identified that upregulated genes in extrachromosomal DNA-containing tumors are enriched in biological processes like DNA damage and cell proliferation, whereas downregulated genes are enriched in immune response processes.</p>
<p>Comments for the previous version:</p>
<p>Major comments:</p>
<p>(1) The authors presented a solid comparative analysis of ecDNA-containing and ecDNA-free tumors. An established automated feature selection approach, Boruta, was used to select differentially expressed genes (DEG) in ecDNA(+) and ecDNA(-) TCGA tumor samples, and the iterative selection process and two-tier multiple hypothesis testing ensured the selection of reliable DEGs. The author showed that the DEG selected using Boruta has stronger predictive power than genes with top log-fold changes.</p>
<p>(2) The author performed a thorough interpretation of the findings with GO enrichment analysis of biological processes enriched in the identified DEG set and presented interesting findings, including the enrichment in DNA damage process among the genes upregulated in ecDNA(+) tumors.</p>
<p>(3) Overall, the authors achieved their aims with solid data mining and analysis approaches applied to public data tumor data sets.</p>
<p>(4) While it may not be the scope of this study, it will be interesting to at least have some justification for choosing Boruta over other feature selection methods, such as Recursive Feature Elimination (RFE) and backward stepwise selection.</p>
<p>(5) The authors showed that DESEQ-selected DEGs with top log-fold changes have less strong predictive power and speculated that this may be due to the fact that genes with top log-fold changes (LFC) are confined only to a small subset of samples. It will be interesting to select DEGs with top log-fold changes after first partitioning the tumor samples. For example, randomly partition the tumor samples, identify the DEGs with top LFC, combine the DEGs identified from each partition, then evaluate the predictive power of these DEGs against the Boruta-selected DEGs.</p>
<p>(6) While the authors showed that the presence of mutations was not able to classify ecDNA(+) and (-) tumor samples, it will be interesting to see if variant allele frequencies of the genes containing these mutations have predictive power.</p>
<p>Comments for the revised version:</p>
<p>The authors addressed the comments and recommendations with solid analysis and explanations in the revision. The added analysis using GLM is especially appreciated and provides convincing evidence for the predicting power of the Boruta-selected genes. The only comment is at this point is that it is recommended that the author provide some justification for choosing Boruta over other feature selection methods. It is not necessary to provide benchmarking results - justification based on the review of previous literature is sufficient, as it is not well explained in the paper why Boruta was chosen in the first place. Is it state-of-the-art? Has it demonstrated better performance in other settings? A few sentences answering these questions should suffice.</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88895.2.sa4</article-id>
<title-group>
<article-title>Author Response</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Lin</surname>
<given-names>Miin S.</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2017-4246</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Jo</surname>
<given-names>Se-Young</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Luebeck</surname>
<given-names>Jens</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Chang</surname>
<given-names>Howard Y.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wu</surname>
<given-names>Sihan</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Mischel</surname>
<given-names>Paul S.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bafna</surname>
<given-names>Vineet</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5810-6241</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>eLife assessment</bold></p>
<p>This study of extrachromosomal DNA (ecDNA) aims to identify genes that distinguish ecDNA+ and ecDNA- tumors. This timely study is important in addressing the genes responding to the amplification of the ecDNA. The data presented are for the most part solid, there were concerns regarding the clarity in the description of the analysis methods and whether the evidence for specific genes required to maintain the ecDNA+ state was entirely conclusive.</p>
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>Recently discovered extrachromosomal DNA (ecDNA) provides an alternative non-chromosomal means for oncogene amplification and a potent substrate for selective evolution of tumors. The current work aims to identify key genes whose expression distinguishes ecDNA+ and ecDNA- tumors and the associated processes to shed light on the biological mechanisms underlying ecDNA genesis and their oncogenic effects. While this is clearly an important question, the analysis and the evidence supporting the claims are weak. The specific machine learning approach seems unnecessarily convoluted, insufficiently justified and explained, and the language used by the authors conflates correlation with causality. This work points to specific GO processes associated (up and down) with ecDNA+ tumors, many of which are expected but some seem intriguing, such as association with DSB pathways. My specific comments are listed below.</p>
</disp-quote>
<p>Response. As some of the specific questions below address similar concerns, we have answered them briefly here. As a high level point, the reviewer is correct in that other statistical or ML approaches could potentially have been used, and that some are simpler. However, the test used here directly addresses the question: Find a collection of genes whose expression value is predictive of ecDNA status in the sample. Because the underlying method in the Boruta analysis uses random forests, it can test predictive power without relying on a linearity assumption implicit in other methods. In this revision, we also compare against a Generalized Linear Model and show that it is less suited to the specific task above. We also address the reviewer concerns about specific parameter choices by showing robustness to the specific parameter.</p>
<disp-quote content-type="editor-comment">
<p>(A) The claim of identifying genes required to 'maintain' ecDNA+ status is not justified - predictive features are not necessarily causal.</p>
</disp-quote>
<p>Response. We agree with the reviewer that predictive features are correlative and not causal. In the manuscript, we identify genes whose expression (when used as a feature) is predictive of ecDNA presence or absence. Such predictive genes are consistently over-expressed or consistently under-expressed in ecDNA(+) samples relative to ecDNA(-) samples even though they are not required to be on ecDNA. To our knowledge, we did not claim that these genes are causal for ecDNA formation or maintenance, only that such genes and the underlying biological processes are worth investigating. In the beginning of the manuscript, we had written the following paragraph, but we have removed the last line (struck out here):</p>
<p>“In lieu of identifying genes that are highly differentially expressed between ecDNA(+) and ecDNA(-) samples but driven by a small subset of cases (e.g. gene A in Fig. S1a), we sought to identify genes (e.g. gene B) whose expression level was predictive of ecDNA presence.  We assumed that genes that were persistently over-expressed or under-expressed in ecDNA(+) samples relative to ecDNA(-) samples were more likely to be involved in ecDNA biogenesis or maintenance, or in mediating the cellular response to the presence of ecDNA.”</p>
<p>We revised the manuscript to make sure that there are no claims that refer to causality. We revisited all phrases where the words like “maintain” were used and added appropriate disclaimers, or replaced them by the phrase, “ecDNA presence.” The remaining statements say, for example, “These results are consistent with a pan-cancer role of CorEx genes in ecDNA biogenesis and maintenance,” and do not claim causality.</p>
<disp-quote content-type="editor-comment">
<p>(B) The methods and procedures to identify the key genes is hyper-parameterized and convoluted and casts doubt on the robustness of the findings given the size and heterogeneity of the data.</p>
<p>(a) In the first two paragraphs of Boruta Analysis Methods section, authors describe an iterative procedure where in each iteration, a binomial p-value is computed for each gene based on number of iterations thus far in which the gene was selected (higher GINI index than max of shadow features). But then in the third paragraph they simply perform Random Forest in 200 random 80% of samples and pick a gene if it is selected in at least 10/200. It is ultimately not clear what was done. Why 10/200? Also &quot;the probability that a gene is a &quot;hit&quot; or &quot;non-hit&quot; in each iteration is 0.5&quot; is unclear. That probability is of a gene achieving GINI index higher than the max of shadow features. How can it be 0.5?</p>
</disp-quote>
<p>Response. We believe that there is some misunderstanding about the algorithm, and we agree that the description should have been more clear. We have greatly simplified the description in the manuscript. However, we want to provide some higher-level explanation here. Boruta is a standard feature extraction algorithm (Kursa, Journal of Statistical Software September 2010, Volume 36, Issue 11), and we used a Python implementation of the method. Given a gene expression data-set with class labels on samples, Boruta extracts features (genes) that best predict the class labels using a Random Forest Classifier, as long as the features are more predictive than permuted features added in each iteration. As we are using an implementation of a published method, we have removed non-essential details, referring directly to the publication. Nevertheless, to address the reviewer’s specific critique, the number of false-features added changes in each iteration (it equals the number of accepted+uncommitted features). Therefore, the choice of 0.5 by Boruta (it is fixed in the published method and not a user-specified parameter) is a conservative approach. If a gene was no better than a randomly chosen feature, its predictive performance would exceed the most predictive randomly chosen feature by at most 0.5 (but could be lower, making the choice of 0.5 conservative).</p>
<p>While Boruta iteratively picks genes that are significantly better than random features, the list of genes predicted might be specific to the data-set, and might change with different data-sets. Therefore, we employed a bootstrapping strategy: we performed 200 trials each time picking 80% of the ecDNA(+) samples and 80% of the ecDNA(-) samples at random, thus generating many data-sets while maintaining class imbalance. For each of the 200 trials, we performed a Boruta analysis. Finally, we picked a gene if it was selected as a Boruta feature in at least 10 of 200 trials.</p>
<p>The reviewer has a reasonable critique about why 10 (of 200) specifically, and why not fewer or more. Most genes are weak predictors by themselves. For example, RAE1, which is the top ranked gene, picked in all 200 Boruta trials, can only predict ecDNA status with poor recall for any meaningful precision.</p>
<fig id="sa4fig1">
<label>Author response image 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig1.jpg" mimetype="image"/>
</fig>
<p>Given the weakness of an individual gene as a classifier, its repeated selection in multiple Boruta trials is already a significant event. By requiring a gene to be picked in 5% of the trials (10/200), we were selecting a small, but more robust list of genes. However, to further explore the reviewer’s concerns, we also applied 8 other selection criteria ranging from 5 (of 200 Boruta trials) to 200 of 200 Boruta trials. See Figure below. The number of CorEx genes expectedly decreases. However, of the 187 GO terms that were enriched by 262 UP-genes using 10 of 200 Boruta trials as the selection criteria, 93 terms (49.7%) were enriched for each cut-off (see Author response image 2), and 155 terms (82.9%) were enriched in at least 5 of the 8 cut-off criteria. Given that the remaining analysis works on the hierarchy of GO terms and finds 4 GO-categories (Mitotic Cell Cycle, G1/S, G2/M; cell-division; DSB DNA Damage response; and the HOX Gene cluster) enriched by UP-regulated genes, those conclusions would hold regardless of the specific cut-off.</p>
<fig id="sa4fig2">
<label>Author response image 2.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig2.jpg" mimetype="image"/>
</fig>
<p>The number of GO terms that were enriched by DOWN-regulated genes is smaller, only 73, and falls rapidly for higher cut-offs, with 25 at a cut-off of 15. Therefore we see fewer terms enriched for more stringent cut-offs. However, they all support immune processes. These results do suggest that there are fewer genes that are consistently down-regulated in ecDNA(+) cancers, and expression change in a small number of genes may be sufficient to promote conditions for ecDNA.</p>
<p>Finally, we note that in the final section we discuss the 65 most highly ranked genes with a harmonic mean rank &lt;= 3. These 65 CorEx genes (or a member of their cluster) appear in each of 200 Boruta trials. Thus, their choice is also not dependent on the cut-off of 10 in 200. In summary, the conclusions of the paper do not depend upon the specific cut-off of 10 in 200 trials.</p>
<p>We have added the figure as a supplemental figure and have added the following text to the manuscript on pages 17 and 18.</p>
<p>“Any CorEx gene is either a Core gene that was selected as a feature in at least 5% of 200 Boruta trials, or be highly co-expressed with a Core gene. Because the selection criterion of 5% is arbitrary, we also tested robustness with 8 other cut-offs ranging from 5-of-200 to 200-of-200 Boruta trials. The number of CorEx genes expectedly decreases with more stringent cut-offs. However, of the 187 GO terms that were enriched by 262 CorEx UP-genes using 10 of 200 Boruta trials as the selection criteria, 93 terms (49.7%) were enriched for each cut-off (Fig. S9), and 155 terms (82.9%) were enriched in at least 5 of the 8 cut-offs. Given that our subsequent analyses utilized the hierarchy of GO terms and identified 4 GO-categories enriched by UP-regulated genes, the conclusions would hold regardless of the specific cut-off.”</p>
<disp-quote content-type="editor-comment">
<p>(b) The approach of combining genes with clusters is arbitrary. Why not start with clusters and evaluate each cluster (using some gene set summary score) for their ability to discriminate? Ultimately, one needs additional information to disambiguate correlated genes (i.e. in a coexpression cluster) in terms of causality.</p>
</disp-quote>
<p>Response. In general, the approach proposed by the reviewer is reasonable. However, we did consider that possibility and found that our approach was easier to implement. For example, if we clustered first, we would have the challenge of choosing the correct set of clusters. Also, the Boruta analysis would become very difficult while dealing with clusters (e.g., how to define falsefeatures?). We tested other methods of picking genes that were suggested by other reviewers such as generalized linear models. They turned out not to be as predictive of ecDNA status, as described later in the response. Finally, we performed many experiments to ensure the validity of the clustering. Specifically, we had the following text in the paper:</p>
<p>“Notably, among the 354 clusters, only 2 clusters (with 14 total genes) did not contain any Core genes. As most genes do not have completely identical expression patterns, we would expect one gene to be consistently picked as a Boruta gene over another co-expressed gene. Consistent with this hypothesis, most (344/354) clusters contained only 1 or 2 Core genes (Fig. 1c). When selecting clusters that contained at least 1 Core and 1 co-expressed gene, 53 of 71 clusters contained 1 to 3 Core genes (Fig. S1b), confirming that a few genes per co-expressed cluster provide sufficient predictive value, but other co-expressed genes might still play an important functional role in maintaining ecDNA(+) status.”</p>
<p>These experiments suggest that the genes found by extending the Core genes through clustering do not radically change the Core genes, but only enhance the set.</p>
<disp-quote content-type="editor-comment">
<p>(c) The cross-validation procedure is not clear at all. There is a mention of 80-20 split but exactly how/if the evaluation is done on the 20% is muddled. The way precision-recall procedure is also a bit convoluted - why not simply use the area under the PR curve?</p>
</disp-quote>
<p>Response. We apologize if the method was unclear. We have rewritten the methods part to make things clearer. As a high level point, there are two places where we use the same 80-20 split, and that resulted in some confusion. We start by randomly picking 80% of the ecDNA(+) and 80% of ecDNA(-) samples to create an 80-20 split of all samples. This procedure is repeated to generate 200 80-20 split data-sets. These data-sets are hereafter called 200 training and test samples.</p>
<p>In the first usage, we use only the ‘training’ part of the 200 samples. We apply Boruta to each training set, and this helps us select the Core genes, which are then expanded to form the CorEx set. At this point, the CorEx genes are frozen for analysis in the rest of the paper. One question that we subsequently answer is what is the predictive power of the CorEx genes in determining if the sample is ecDNA(+) or ecDNA(-)? We also compare the predictive performance of CorEx genes relative to (a) Core genes, (b) LFC genes, and (c) random genes. In the revised manuscript, we have added another list of 3,012 genes selected using a single gene generalized linear model (GLM) for feature prediction. To make these comparisons, we utilized the same 200 training and test data-sets as before. In each test, we trained a random forest classifier on the training set and predicted on the ‘test’ set, for each of the 5 gene lists. This provided a uniform and fair method for testing which of the 5 gene lists was the better predictor of ecDNA status.</p>
<p>The precision recall values are plotted in Fig. 2b (also included below). We note that none of the gene lists was a great predictor of ecDNA status of a sample. However, the CorEx and Core genes were significantly more predictive than GLM, LFC, and random genes. The predictive power of GLM genes was very similar to LFC, and better than random.</p>
<p>For each of these 200 tests, we obtained a separate area under the precision-recall curve number for each of the gene-sets. To address the reviewer’s comments regarding a single number, we reported the average of the AUPRC for each of the gene-sets in the revision. The mean AUPRC values were added to the manuscript and are described here as well: Core_408_genes: 0.495
CorEx_643_genes: 0.48 Random_643_genes: 0.36 top_lfc_643_genes: 0.429
GLM_R_3012_genes: 0.426</p>
<p>We also changed Figure 2b to show box-plots showing distribution of recall values for specific precision windows instead of maximum recall. For ease of checking, the figure is reproduced below.</p>
<fig id="sa4fig3">
<label>Author response image 3.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig3.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>(d) The claim is that Boruta genes are different from differentially expressed genes but the differential expression seems to be estimated without regards to cancer type, which would certainly be highly biased and misleading. Why not do a simple regression of gene expression by ecDNA status, cancer type and select the genes that show significant coefficient for ecDNA status?</p>
</disp-quote>
<p>Response. As requested by the reviewer, and in the more detailed questions below, we added an alternative model with a generalized linear model (GLM) analysis that controlled for tumor subtype. The method itself is described in the Methods section and pasted below. The GLM genes were tested along with the LFC, CorEx, Core genes as described in response to the previous question, and those results are now presented in Figure 2b and on pages 6 and 7 of the revised manuscript.</p>
<p>“We tested each of 16,309 genes independently in a separate logistic regression model using the glm() function in the R stats package (v4.2.0), and retained genes that were significant
(p-value 0.01). Specifically, the model was defined as glm(𝑦 ~ 𝑔𝑗 + 𝑡𝑡, data = 𝑀, family = binomial(link = 'logit')), where y is the response vector where 𝑦𝑖=1 if sample 𝑖 ∈ {1, . . . ,870} is ecDNA(+) and 𝑦𝑖 =0 otherwise, 𝑔𝑗 is the vector of expression values for gene j ∈ {1, . . . ,16309} in samples 𝑖 ∈ {1,. . . ,870}, t is the covariate vector representing the tumor subtypes of samples 𝑖 ∈ {1, . . . ,870}, and 𝑀 is the data matrix containing values of gene expression, tumor subtype, and ecDNA status for all samples. The equation for the binomial logistic regression described above 𝑝𝑝 is formulated as <inline-formula id="sa4equ1"><inline-graphic xlink:href="elife-88895-sa4-equ1.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> where p is the probability that the dependent variable y is 1, 𝑋 are the independent variables, and 𝛽 are the coefficients of the model. In this case, k=1 represents independent variable gene j and k=2 represents the tumor subtype covariate t. Of the 16,309 genes tested independently, 3,012 genes were significant at pvalue&lt;0.01.”</p>
<disp-quote content-type="editor-comment">
<p>(C) After identifying key features (which the authors inappropriate imply to be causal) they perform a series of enrichment/correlative analysis.</p>
</disp-quote>
<p>Response. We have reviewed the document to ensure that we did not use the word ‘causal.’ If the reviewer can point to specific text, we are happy to change the phrasing.</p>
<disp-quote content-type="editor-comment">
<p>(a) It is known that ecDNA status associates with poor survival, and so are cell cycle related signal. Then the association between Boruta genes and those processes is entirely expected. Is it not? The same goes for downregulation of immune processes.</p>
</disp-quote>
<p>Response. We agree with the reviewer that cell cycle related signals and immune related signals are associated with low survival, and so does ecDNA. However, many cellular processes could be associated with low survival (including for example, metabolic processes, protein and DNA biosynthesis, etc.). The unexpected part is that there appear to be only 4 major processes that are upregulated in ecDNA(+) cancers relative to ecDNA(-) cancers, and only one (immune response) that is downregulated.</p>
<disp-quote content-type="editor-comment">
<p>(b) The association with DSB specifically is interesting. Further analysis or discussion of why this should be would strengthen the work.</p>
</disp-quote>
<p>Response. We thank the reviewer for their comment, and agree with their perspective. Note that we devoted a fair amount of text to analysis of DSB pathways. Specifically, we parsed the 4 main pathways in Figure 3b, and found our data to suggest that many genes in the classical nonhomologous end joining repair pathway are down-regulated in ecDNA(+) samples relative to ecDNA(-) samples. In contrast, Alternative end-joining and homology directed repair pathways are upregulated. This is a surprising result because c-NHEJ is considered to be an important mechanism of DSB repair. We have some lines in the discussion that address this:</p>
<p>“The DNA damage genes are broadly up-regulated in ecDNA(+) samples, especially in double-strand break repair. Within this broad category of mechanisms, our analysis suggests that alternative DSB repair pathways such as Alt-EJ are preferred relative to classical NHEJ. This is consistent with previous observations of small microhomologies at breakpoint junctions, and has important implications in therapeutic selection that will need to be validated in future experimental studies. We note, however, the microhomology analyses typically study breakpoint junctions, and might ignore double-strand breaks in non-junctional sequences which could be observed, for example at replication-transcription junctions.”</p>
<p>We note that additional experimental work to corroborate these findings is significant effort and will be part of ongoing research in our collaborators’ laboratories.</p>
<disp-quote content-type="editor-comment">
<p>(c) On page 15, second paragraph, when providing the up versus down CorEx genes, please also provide up versus down for non-CorEx genes as well to get a sense of magnitude.</p>
</disp-quote>
<p>Response. We thank the reviewer for the comment. We note that Supplementary Table S15 has the complete contingency tables as well as the Fisher Exact Test statistic for all categories. For the specific categories mentioned in the paper, the chi-square tables are reproduced below. As we are citing TableS15 (containing all numbers and the statistic p-value) in the main text, we thought it was better to leave the text as it was.</p>
<p>Category: Inflammation (p-value: 0.005)</p>
<p>CorEx: 18 (UP), 76 (DOWN)</p>
<p>Non-CorEx: 325 (UP), 657 (DOWN)</p>
<p>Category: Leukocyte migration and chemotaxis (p-value: 0.03)</p>
<p>CorEx: 13 (UP), 49 (DOWN)</p>
<p>Non-CorEx: 213 (UP), 410 (DOWN)</p>
<p>Category: Lymphocyte activation (p-value: 0.0075)</p>
<p>CorEx: 23 (UP), 75 (DOWN)</p>
<p>Non-CorEx: 334 (UP), 560 (DOWN)</p>
<p>Category: Cytokine production (p-value: 0.117)</p>
<p>CorEx: 6 (UP), 28 (DOWN)</p>
<p>Non-CorEx: 93 (UP), 208 (DOWN)</p>
<disp-quote content-type="editor-comment">
<p>(d) The finding that Boruta genes are associated with high mutation burden is intriguing because in general mutation burden is associated with better survival and immunotherapy response. This counter-intuitive result should be scrutinized more to strengthen the work.</p>
</disp-quote>
<p>Response. We agree with the reviewer that it is an intriguing observation. However, we are cautious in our interpretation. This is for the following reasons (all mentioned in the text):</p>
<p>(1) The total mutation burden was significantly higher in ecDNA(+) samples relative to ecDNA(-) samples (Fig. 5a). However, when controlling for cancer type, only glioblastoma, low-grade gliomas, and uterine corpus endometrial carcinoma continued to show differential total mutational burden (Fig. S7b).</p>
<p>(2) We tested if specific genes were differentially mutated between the two classes (Fig. 5b). For deleterious/high-impact mutations, TP53 was the only gene whose mutational patterns were significantly higher in ecDNA(+) compared to ecDNA(-) (OR 2.67, Bonferroni adjusted p-value 4.22e-07). BRAF mutations, however, were more common in ecDNA(-) samples and were significant to an adjusted p-value &lt; 0.1 (OR 0.27).</p>
<p>(3) In response to another reviewer’s comment, we also tested correlation with variant allele frequencies, and did not find any significant correlation except for TP53. We decided not to include that result in the paper.</p>
<p>These tissue specific cases might be confounding the main observation, but we have placed all of them together so that the reader can gain a better understanding. It is worth noting that the correlation between high TMB and immunotherapy response is also now controversial, and perhaps not true for all cancer types. See for example
(<ext-link ext-link-type="uri" xlink:href="https://www.annalsofoncology.org/article/S0923-7534(21)00123-X/fulltext">https://www.annalsofoncology.org/article/S0923-7534(21)00123-X/fulltext</ext-link>), which suggests that this relationship is not true for Glioma, and in Glioma (which is ecDNA enriched), higher TMB is associated with worse immunotherapy response. Our results are consistent with that finding. We have modified the discussion paragraph to better reflect this.</p>
<p>“Mutation data alone does not provide as clear a picture of the genes involved in ecDNA maintenance. We did observe that the total mutation burden (TMB) was higher in ecDNA(+) samples. However, that relationship is much less clear after controlling for cancer type. High TMB has been positively correlated with sensitivity to immunotherapy52, and better patient outcomes; however, the gene expression patterns suggest that immunomodulatory genes are downregulated in ecDNA(+) samples, and patients with ecDNA(+) tumors have worse outcomes2. Notably, other results have suggested that the correlation between TMB and response to immunotherapy is not uniform, and it can vary across different tumor subtypes53. Specifically, our data is consistent with previous results which showed that Gliomas with high TMB have worse response to immunotherapy relative to gliomas with low TMB53. In general, no collection of gene mutations was predictive of ecDNA status, although mutations in TP53 were more likely in ecDNA(+) samples, and perhaps are an important driver for ecDNA formation5.”</p>
<disp-quote content-type="editor-comment">
<p>(e) On page 17 &quot;12 of the 47 genes not specifically enriching any known GO biological Process&quot; is confusing. How can individual gene enrich for a GO process?</p>
</disp-quote>
<p>Response. We agree that the statement was incorrectly phrased. We have changed it to state that “Only 12 of the 47 genes were not included in the gene sets of any enriched GO term.”</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>In their manuscript entitled &quot;Transcriptional immune suppression and upregulation of double stranded DNA damage and repair repertoires in ecDNA-containing tumors&quot; Lin et al. describe an important study on the transcriptional programs associated with the presence of extrachromosomal DNA in a cohort of 870 cancers of different origin. The authors find that compared to cancers lacking such amplifications, ecDNA+ cancers express higher levels of DNA damage repair-associated genes, but lower levels of immune-related gene programs.</p>
<p>This work is very timely and its findings have the potential to be very impactful, as the transcriptional context differences between ecDNA+ and ecDNA- cancers are currently largely unknown. The observation that immune programs are downregulated in ecDNA+ cancers may initiate new preclinical and translational studies that impact the way ecDNA+ cancers are treated in the future. Thus, this study has important theoretical implications that have the potential to substantially advance our understanding of ecDNA+ cancers.</p>
<p>Strengths</p>
<p>The authors provide compelling evidence for their conclusions based on large patient datasets. The methods they used and analyses are rigorous.</p>
<p>Weaknesses</p>
<p>The biological interpretation of the data remains observational. The direct implication of these genes in ecDNA(+) tumors is not tested experimentally.</p>
</disp-quote>
<p>Response. We agree with the reviewer that experimental tests would be ideal. Towards that, there are some challenges. The immune system genes cannot be tested in cell line models as they need a tumor microenvironment. Tests of DSB repair mechanisms and cell cycle control can be performed in cell-lines, but not with the TCGA samples which are not available. Some of our collaborators are actively working on these topics, but that extensive experimental work is beyond the scope of this paper.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public Review):</bold></p>
<p>Summary:</p>
<p>Using a combination of approaches, including automated feature selection and hierarchical clustering, the author identified a set of genes persistently associated with extrachromosomal DNA (ecDNA) presence across cancer types. The authors further validated the gene set identified using gene ontology enrichment analysis and identified that upregulated genes in extrachromosomal DNA-containing tumors are enriched in biological processes like DNA damage and cell proliferation, whereas downregulated genes are enriched in immune response processes.</p>
<p>Major comments:</p>
<p>(1) The authors presented a solid comparative analysis of ecDNA-containing and ecDNA-free tumors. An established automated feature selection approach, Boruta, was used to select differentially expressed genes (DEG) in ecDNA(+) and ecDNA(-) TCGA tumor samples, and the iterative selection process and two-tier multiple hypothesis testing ensured the selection of reliable DEGs. The author showed that the DEG selected using Boruta has stronger predictive power than genes with top log-fold changes.</p>
<p>(2) The author performed a thorough interpretation of the findings with GO enrichment analysis of biological processes enriched in the identified DEG set, and presented interesting findings, including the enrichment in DNA damage process among the genes upregulated in ecDNA(+) tumors.</p>
<p>(3) Overall, the authors achieved their aims with solid data mining and analysis approaches applied to public data tumor data sets.</p>
<p>(4) While it may not be the scope of this study, it will be interesting to at least have some justification for choosing Boruta over other feature selection methods, such as Recursive Feature Elimination (RFE) and backward stepwise selection.</p>
</disp-quote>
<p>Response. We actually agree with the reviewer that some other feature selection methods could work just as well, and note that the Boruta analysis is not our creation, but a published feature selection method (Kursa, Journal of Statistical Software September 2010, Volume 36, Issue 11). We use Boruta to identify relevant genes, but the bulk of the paper is to understand the biological processes driven by that gene selection. Even if we had chosen another method that performed slightly better, it likely would not change the main conclusions. However, to address the reviewers concerns on over-reliance on one method, we added a different gene list created by a generalized linear model analysis, with the goal of checking if the expression of a gene could predict the ecDNA status of the sample after controlling for tumor subtype. Thus, we tested 5 different genelists in terms of their power in predicting ecDNA. While none of the lists is a great predictor of ecDNA status, the Core and CorEx gene lists are significantly better than the other lists. The Figure below replaces the previous Figure panels 2b and 2c.</p>
<fig id="sa4fig4">
<label>Author response image 4.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig4.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>(1) The authors showed that DESEQ-selected DEGs with top log-fold changes have less strong predictive power and speculated that this may be due to the fact that genes with top log-fold changes (LFC) are confined only to a small subset of samples. It will be interesting to select DEGs with top log-fold changes after first partitioning the tumor samples. For example, randomly partition the tumor samples, identify the DEGs with top LFC, combine the DEGs identified from each partition, then evaluate the predictive power of these DEGs against the Boruta-selected DEGs.</p>
</disp-quote>
<p>Response. This is a great comment. We added a generalized linear model test for selecting genes whose expression is predictive of ecDNA status. The GLM list described above uses a standard methodology (Analysis of Variance) controls for tumor type as a covariate, and its predictive performance is only slightly better than the Top-|LFC| genes, while improving over a random gene set.</p>
<disp-quote content-type="editor-comment">
<p>(2) While the authors showed that the presence of mutations was not able to classify ecDNA(+) and (-) tumor samples, it will be interesting to see if variant allele frequencies of the genes containing these mutations have predictive power.</p>
</disp-quote>
<p>Response. This is a great suggestion. To address the reviewer’s question, we used allelic counts (REFs and ALTs) information from the MC3 variant callset, and calculated allele frequencies of all variants from samples where ecDNA status was available. Next, we conducted a Wilcoxon rank-sum test between VAFs of the ecDNA(+) group and VAFs of the ecDNA(-) group for every mutated gene. We found 1,073 genes with p&lt;0.05, but among them, only TP53 passed the multiple testing correction (padj&lt;0.05, Benjamini-Hochberg). As the results are identical to the tests based solely on presence of mutations, we decided not to include this data.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p>
<p>(A) The presentation should be substantially streamlined.</p>
<p>(B) Preferably use a more intuitive simpler ML approach with fewer parameters to make it more credible. Because there are relatively few samples across numerous cancer types with greater variability in representation, a simpler procedure with transparent controls will be more convincing.</p>
</disp-quote>
<p>Response. We accept the reviewer’s criticism in that other statistical or ML approaches could potentially have been used, and that some are simpler. However, the test used here directly addresses the question: Find a collection of genes whose expression value is predictive of ecDNA status in the sample. Because the underlying method in the Boruta analysis uses random forests, it can test predictive power without relying on a linearity assumption implicit in other methods. In this revision, we also compare against a Generalized Linear Model (regression analysis) and show that it is less suited to the specific task above. We address the reviewer concerns about specific parameter choices by showing robustness to the specific parameter. All details are provided in the initial questions, and in the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p>(C) Avoid using any term implying causality unless you can bring in direct experimental evidence (e.g. mutagenesis experiment followed by ecDNA measurement. Some places you use the word 'maintain ecDNA' and other places 'ecDNA impact'. But these are all associations. How can you distinguish causal genes from downstream effects without additional data?</p>
</disp-quote>
<p>Response. We note that the word causal does not appear anywhere in the manuscript, and was not intended. Additionally we have revised the manuscript and are open to specific changes requested by the reviewer or the editors.</p>
<disp-quote content-type="editor-comment">
<p>(D) Along these lines, if Boruta genes are indeed causal, one would expect Boruta-Up genes to be amplified more than expected in the ecDNA+; converse for Boruta-down genes.</p>
</disp-quote>
<p>Response. We did not understand the reviewer’s question. By “amplified,” if the reviewer means “amplification of transcript level,” then that is exactly what the Boruta analysis is showing. Specifically, for each gene, we have the ability to pick a transcript level cut-off ‘t’ so that samples in which the expression is higher than t are more likely to be ecDNA(+). However, we are not claiming that there is causality, just that the transcript level is (weakly) predictive of the ecDNA status of the sample.</p>
<disp-quote content-type="editor-comment">
<p>(E) A strawman control should be a simple regression-based gene identification that controls for ecDNA status and cancer type.</p>
</disp-quote>
<p>Response. We agree that this was a very good suggestion. In the revision, we have applied a GLM, which controls for tumor type. Thus, we have 5 gene-lists (including the Core and CorEx genes). As described in the revised manuscript but also in response to the main comments above, none of the lists are a great predictor. However, the CorEx and Core genes are significantly better at predicting ecDNA status of a sample.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p>
<p>Comments</p>
<p>(1) The analysis hinges on a classification of tumors into ecDNA(+) and ecDNA(-) using AmpliconClassifier. It would be good to know how robust the outcomes are with respect to the performance of AmpliconClassifier - how many false positives and negatives will
AmpliconClassifier generate on this dataset and how would this influence the CorEx genes?</p>
</disp-quote>
<p>Response. This is a very reasonable request. AA has been extensively tested on established cell-lines for its ability in predicting ecDNA status, and this information is published in multiple venues, including Kim, Nature genetics 2020, and shows precision 85% for recall 83%. For completeness, we have reproduced the relevant plot from that paper here, and the relevant text here, but are not including it in the manuscript.</p>
<p>“To evaluate the accuracy of the AmpliconArchitect predictions, we analyzed whole-genome sequencing data from a panel of 44 cancer cell lines, and examined tumor cells in metaphase. We used 35 unique fluorescence in-situ hybridization (FISH) probes in combination with matched centromeric probes (81 distinct “cell-line, probe” combinations) to determine the intranuclear location of amplicons (Supplementary Table 2). Following automated analysis &gt;1,600 images, we observed that 85% of amplicons characterized as ‘Circular’ by whole genome sequencing profile demonstrated an extrachromosomal fluorescent signal, representing the positive predictive value. Of the amplicons corresponding to extrachromosomally located FISH probes, 83% were classified as Circular, representing the sensitivity (Extended Data Fig. 1A).”</p>
<fig id="sa4fig5">
<label>Author response image 5.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig5.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>(2) It is unclear why genes are labeled Boruta genes when they are present in 10 out of 200 runs, this seems like an unexpectedly low number. How did the authors arrive at this number? Do the authors have any ground truth to estimate how well Boruta works in this setting and implementation?</p>
</disp-quote>
<p>Response. This is a great question and asked by another reviewer as well. Given the weakness of an individual gene as a classifier, its repeated selection in multiple Boruta trials is already a significant event. By requiring a gene to be picked in 5% of the trials (10/200), we were selecting a small, but more robust list of genes. However, to further explore the reviewer’s concerns, we also applied 8 other selection criteria ranging from 5 (of 200 Boruta trials) to 200 of 200 Boruta trials. See Figure below. The number of CorEx genes expectedly decreases with increasing stringency. However, of the 187 GO terms that were enriched by UP-genes, 93 terms (50%) were enriched regardless of the cut-off (see Figure below), and 153 terms (82%) were enriched in at least 5 of the 8 cut-offs. Given that the remaining analysis works on the hierarchy of GO terms and finds 4 GO-categories (Mitotic Cell Cycle, G1/S, G2/M; cell-division; DSB DNA Damage response; and the HOX Gene cluster) enriched by UP-regulated genes, those conclusions would hold regardless of the specific cut-off.</p>
<fig id="sa4fig6">
<label>Author response image 6.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig6.jpg" mimetype="image"/>
</fig>
<p>The number of GO terms that were enriched by DOWN-regulated genes is smaller, only 73, and falls rapidly for higher cut-offs, with 25 at a cut-off of 15. Therefore we see fewer terms enriched for more stringent cut-offs. However, they all support immune processes. These results do suggest that there are fewer genes that are consistently down-regulated in ecDNA(+) cancers, and expression change in a small number of genes may be sufficient to promote conditions for ecDNA.</p>
<p>We have added the figure as a supplemental figure and have added the following text to the manuscript on pages 17 and 18.</p>
<p>“Any CorEx gene is either a Core gene that was selected as a feature in at least 5% of 200 Boruta trials, or be highly co-expressed with a Core gene. Because the selection criterion of 5% is arbitrary, we also tested robustness with 8 other cut-offs ranging from 5-of-200 to 200-of-200 Boruta trials. The number of CorEx genes expectedly decreases with more stringent cut-offs.</p>
<p>However, of the 187 GO terms that were enriched by 262 CorEx UP-genes using 10 of 200 Boruta trials as the selection criteria, 93 terms (49.7%) were enriched for each cut-off (Fig. S9), and 155 terms (82.9%) were enriched in at least 5 of the 8 cut-offs. Given that our subsequent analyses utilized the hierarchy of GO terms and identified 4 GO-categories enriched by UP-regulated genes, the conclusions would hold regardless of the specific cut-off.”</p>
<disp-quote content-type="editor-comment">
<p>(3) Authors extend the core gene set with co-expressed genes, arguing that &quot;gene C&quot; would not add predictive power in addition to &quot;gene B&quot; and is therefore not identified as a Boruta gene. However, from its description in the manuscript (summarized: &quot;Boruta [...] selects the highest feature importance score, s, of shadow features as a cut off, and returns features with a higher score than s.&quot;), it isn't immediately obvious to me why Boruta would not return both genes B and C. Maybe the authors could explain this better.</p>
</disp-quote>
<p>Response. We consider the following.</p>
<p>(1) Consider 100 ecDNA(+) and 100 ecDNA(-) samples. Let the expression levels of genes B and C in the data-sets be as described in the figure below; y-axis is the gene expression, and x-axis is just a listing of all samples, with green color denoting ecDNA(+) samples and orange color denoting ecDNA(-) samples.</p>
<fig id="sa4fig7">
<label>Author response image 7.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig7.jpg" mimetype="image"/>
</fig>
<p>(2) Then, if we choose gene B and a transcript level of 1.25, we have a perfect prediction of ecDNA status because all samples where gene B has a transcript level higher than 1.25 are ecDNA(+) and otherwise they are ecDNA(-). Similarly, using Gene C, we can get perfect predictions. Thus, when Boruta has to select a gene, it will pick either Gene B or Gene C, because picking both will not improve prediction. We can therefore use Boruta to pick one gene, and then co-expression clustering to pick the other gene.</p>
<p>As an example, cluster #3 consists of 21 genes that were up-regulated in ecDNA(+) samples and enriched in cell-cycle related biological processes (Table S3). While these genes were expressed similarly in ecDNA(+) samples, and separately, in ecDNA(-) samples, out of the 21 genes, only 9 genes were selected in at least 10 out of 200 Boruta trials (i.e., Core genes). Of the 12 remaining genes (i.e., CorEx genes), 8 genes were not selected by the Boruta method at all, 3 genes were selected in less than 5 out of 200 Boruta trials, and 1 gene was selected in 9 out of 200 Boruta trials.</p>
<fig id="sa4fig8">
<label>Author response image 8.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig8.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>(4) In Fig 2a, I would like to see the variability of the precision and recall in the main text, not only the maximum values. Authors could plot mean + standard deviation for precision and recall separately, or use S2a/b.</p>
</disp-quote>
<p>Response. We have replaced Figures 2b and 2c with a combined figure (Fig. 2b) that gives a box-plot describing the distribution of recall values for 5 gene lists: four from the original manuscript, and another gene list created using a Generalized Linear Model (GLM).</p>
<fig id="sa4fig9">
<label>Author response image 9.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig9.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>(5) Since the authors analyze bulk RNA, the gene expression signatures they notice could, in principle, originate from non-tumor cells as well. I do not believe this is the case, however, the paper would be strengthened by an analysis that shows that the difference in expression patterns of the Corex genes between ecDNA(+) and ecDNA(-)-samples does come from tumor cells. One way of showing this would be by using single-cell mRNA-sequencing data, and another way of showing this would be to show that Corex gene-expression correlates with tumor purity in bulk samples.</p>
</disp-quote>
<p>Response. The reviewer is correct. Unfortunately, our analysis requires data with whole-genome sequencing (WGS) for ecDNA prediction, as well as RNA-seq for transcriptome profiling. The TCGA data-set is the only available data-set with a significant number of samples that includes both WGS and RNA-seq. They have not made tissue samples available for scRNA analysis, to our knowledge. The reviewer raises an important question regarding purity, but testing if CorEx gene expression correlates with tumor purity would require a large range of purity values, something that scientists would avoid when collecting samples.</p>
<p>However, the presence of non-cancer tissue (impurity) could reduce sensitivity of ecDNA detection, and therefore, change the results. To better investigate this, we started with a publication that investigated multiple tumor purity metrics and devised a composite score (CPE; Aran et al., 2015). Using their composite tumor purity, we find that ecDNA(-) samples have slightly lower purity than ecDNA(+) samples (p-value 0.0036; Fig. S2a).</p>
<p>This result is not surprising because one would expect lower detection of ecDNA in less pure samples. The presence of undetected ecDNA in ecDNA(-) samples would confound the results by reducing the discriminating power of genes, but would not give false results. To test this, we measured the expression directionality in CorEx genes in all samples versus samples which had a high tumor purity (CPE 0.8). The results suggest that the p-values of directionality in the pure samples were highly correlated with the expression data from all samples (Fig. S2b).</p>
<fig id="sa4fig10">
<label>Author response image 10.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig10.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>(6) The biological interpretation of the data remains a bit too observational. Can the authors offer an interpretation of the enriched GO terms? And are any of these genes already implicated in ecDNA(+) tumors?</p>
</disp-quote>
<p>Response. To answer the second question first, prior to our study, the focus was on genes that were amplified on ecDNA. Indeed many oncogenes known to be amplified in cancer are in fact amplified on ecDNA (Turner, Nature 2017, Kim Nature genetics 2020). This study is unique in that it identifies genes whose expression values are predictive of ecDNA(+) status. The Figure below lists 24 genes most frequently amplified on ecDNA from Kim, Nature Genetics 2020. With the exception of EGFR and CDK4, none of these 24 genes was included in the list of the 65 genes reported by us as the most frequently selected genes in the Boruta trials (lowest harmonic rank). Thus, most persistent CorEx genes do not lie on ecDNA. However, they all play important roles in biological processes relevant to cancer pathology including Immune Response, Mitotic cell Cycle, Cell division, and DSB repair. We agree with the reviewer that the results are observational (although statistically significant in populations), and some of our collaborators are actively working to experimentally validate some of these genes. The experimental work, however, is beyond the scope of this paper.</p>
<p>We have added the following statement to the manuscript. “Notably, of the 24 genes most frequently expressed on ecDNA,2 only EGFR and CDK4 were included in the list of 65 genes, suggesting that the most persistent CorEx genes do not themselves appear frequently on ecDNA.”</p>
<fig id="sa4fig11">
<label>Author response image 11.</label>
<graphic mime-subtype="jpg" xlink:href="elife-88895-sa4-fig11.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p>
<p>Minor comments:</p>
<p>(1) The authors performed gene ontology enrichment test but referred to it as gene set enrichment analysis. Usually gene set enrichment analysis does not refer to Fischer's exact test-based analysis but rather the one described in Subramanian et al 2005. The term correction should be made to avoid confusion.</p>
</disp-quote>
<p>Response. We have rephrased text in the manuscript to prevent confusion between enrichment analysis on gene sets using an one-sided Fisher’s exact test and the Gene Set Enrichment Analysis (GSEA) method that exists as a software. We have also revised the header in the methods section from “Gene set enrichment analysis” to “Gene Ontology (GO) enrichment analysis”.</p>
<disp-quote content-type="editor-comment">
<p>(2) A couple of figures could use more detailed labels and captions. In Figure 2c, it is unclear what the numbers 100 and 54 right next to the Cliff's Delta heatmap indicate. In Figures 3a and 4a, it is not immediately clear what the barplot on top of the heatmap indicates and there is no label for the y-axis.</p>
</disp-quote>
<p>Response. These are good suggestions, and we have added descriptions to the figure captions.</p>
</body>
</sub-article>
</article>