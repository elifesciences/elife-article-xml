<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">94597</article-id>
<article-id pub-id-type="doi">10.7554/eLife.94597</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.94597.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Cancer Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Comparison of Tug-of-War Models Assuming Moran versus Branching Process Population Dynamics</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0010-4251</contrib-id>
<name>
<surname>Dinh</surname>
<given-names>Khanh N.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">*</xref>
<xref ref-type="corresp" rid="cor1">**</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Kurpas</surname>
<given-names>Monika K.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">*</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kimmel</surname>
<given-names>Marek</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Irving Institute for Cancer Dynamics and Department of Statistics, Columbia University</institution>, New York, NY, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>Department of Systems Biology and Engineering, Silesian University of Technology</institution>, Gliwice, <country>Poland</country></aff>
<aff id="a3"><label>3</label><institution>Departments of Statistics and Bioengineering, Rice University</institution>, Houston, TX, <country>USA</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Flegg</surname>
<given-names>Jennifer</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>The University of Melbourne</institution>
</institution-wrap>
<city>Melbourne</city>
<country>Australia</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Moses</surname>
<given-names>Alan M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Toronto</institution>
</institution-wrap>
<city>Toronto</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>**</label> Corresponding author; email: <email>knd2127@columbia.edu</email></corresp>
<fn id="n1" fn-type="equal"><label>*</label><p>These authors contributed equally.</p></fn>
<fn id="n2" fn-type="conflict"><p>The authors declare no potential conflicts of interest.</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-05-22">
<day>22</day>
<month>05</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP94597</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-01-15">
<day>15</day>
<month>01</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-02-21">
<day>21</day>
<month>02</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.10.20.563302"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Dinh et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Dinh et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-94597-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Mutations arising during cancer evolution are typically categorized as either ‘drivers’ or ‘passengers’, depending on whether they increase the cell fitness. Recently, McFarland et al. introduced the Tug-of-War model for the joint effect of rare advantageous drivers and frequent but deleterious passengers. We examine this model under two common but distinct frameworks, the Moran model and the branching process. We show that frequently used statistics are similar between a version of the Moran model and the branching process conditioned on the final cell count, under different selection scenarios. We infer the selection coefficients for three breast cancer samples, resulting in good fits of the shape of their Site Frequency Spectra. All fitted values for the selective disadvantage of passenger mutations are nonzero, supporting the view that they exert deleterious selection during tumorigenesis that driver mutations must compensate.</p>
</abstract>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Some text has been revised for clarity.</p></fn>
</fn-group>
<fn-group content-type="external-links">
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://ega-archive.org/">https://ega-archive.org/</ext-link>
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>As demonstrated in the seminal paper [<xref ref-type="bibr" rid="c12">12</xref>], mutations in different cancers vary substantially in counts and patterns. These differences reflect distinct defects in DNA repair mechanisms, cancer exposures, and cell types. The authors also reported evidence for ‘driver’ mutations in about 120 genes, which contribute to tumorigenesis. However, the majority of somatic mutations are likely ‘passengers’, which do not have an effect on tumor progression. In the language of population genetics, driver mutations are selectively advantageous to cancers, while the passengers are at best neutral.</p>
<p>The concept of a model involving the joint effect of rare advantageous and frequent neutral or slightly deleterious mutations can be applied to describe evolution of cancer genes. To the best of our knowledge, such model was first introduced by McFarland and co-authors, in a series of publications [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c20">20</xref>], and named the Tug-of-War model to reflect the competition between driver and passenger mutations.</p>
<p>The original Tug-of-War model [<xref ref-type="bibr" rid="c18">18</xref>] assumed that the cell death rate increases with the number of cells in the population increasing, which creates a mechanism for limiting the eventual tumor size. In other papers [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c17">17</xref>], a Moran model was used for the population process, which provides a strict bound on the number of proliferating cells (see relevant discussion in [<xref ref-type="bibr" rid="c16">16</xref>]). Another assumption of [<xref ref-type="bibr" rid="c18">18</xref>] was that driver mutations become instantly fixed in the population, which may be acceptable under very strong selection (for mathematical details, see Bobrowski et al. [<xref ref-type="bibr" rid="c2">2</xref>]), but in general it is not satisfied.</p>
<p>The literature includes many examples of comparisons of how mutation, drift and selection interact in different population dynamics frameworks such as branching process versus Moran model [<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c4">4</xref>] or Wright-Fisher model with population of varying size [<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c6">6</xref>]. Two possible modes of selection in cell populations are “crowding out” in which a faster-growing clone makes the slower-growing one rare to the point of being negligible, or “competitive replacement”, in which individual cells inhibit each other’s replacement by a descendant. Supercritical branching process models lead to the former, while the Moran and Wright-Fisher models to the latter. A version interpolating between these two mechanisms is the well-cited Gerrish and Lenski model [<xref ref-type="bibr" rid="c11">11</xref>]. We will return to these models in the Discussion.</p>
<p>In the present paper, we compare the Tug-of-War in the multitype Moran model with constant population size and a critical multitype branching process. The latter is conditional on non-extinction or other restrictions. We explore similarities and differences between the two types of selection in cell populations. This contributes to the ongoing discussion of which models are most appropriate for proliferating cell populations under drift, mutation, and selection.</p>
<p>We begin with mathematical definitions of the two versions of Tug-of-War process. Then we present simulation results, which demonstrate the differences between the long-term behavior of the two versions under different selection scenarios. Finally, we infer the selection coefficients for some breast cancer samples using the Moran framework, and cross-examine the fitted parameters with the branching process.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Models and Data</title>
<sec id="s2a">
<label>2.1</label>
<title>Moran process Tug-of-War models</title>
<p>Model descriptions in this section, are essentially summaries of the descriptions in [<xref ref-type="bibr" rid="c16">16</xref>] and to avoid redundancy, we summarize only the most essential features. For more detailed descriptions, see [<xref ref-type="bibr" rid="c16">16</xref>].</p>
<sec id="s2a1">
<label>2.1.1</label>
<title>Model A</title>
<p>In this model (<bold><xref rid="fig1" ref-type="fig">Figure 1A</xref></bold>), we contextualize the Tug-of-War within the Moran model framework with multiple allelic types. We examine a population with a constant size of <italic>N</italic> cells. Each cell <italic>i</italic> is described by a pair of integers <italic>γ</italic><sub><italic>i</italic></sub> = (<italic>α</italic><sub><italic>i</italic></sub>, <italic>β</italic><sub><italic>i</italic></sub>), where <italic>α</italic><sub><italic>i</italic></sub> and <italic>β</italic><sub><italic>i</italic></sub> represent the quantities of drivers and passengers in its genotype, respectively. The cell’s fitness is then defined as</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Graphical depiction of cell death and division events in <bold>(A)</bold> Moran A model, <bold>(B)</bold> Moran B model, and <bold>(C)</bold> branching process. <bold>Notation for all models:</bold> <italic>t</italic>, current time; <italic>T</italic>, time to next event; <italic>f</italic> (<italic>α, β</italic>), fitness of cell with <italic>α</italic> drivers and <italic>β</italic> passengers; Σ<sub><italic>f</italic></sub> =Σ<sub><italic>k</italic></sub> <italic>f</italic> (<italic>α</italic><sub><italic>k</italic></sub>, <italic>β</italic><sub><italic>k</italic></sub>). <bold>Notation for Moran models:</bold> <italic>N</italic>, constant cell count in the process; <italic>i</italic>, cell dying and to be replaced; <italic>j</italic>, cell replacing cell <italic>i</italic>; <bold>Notation for branching process:</bold> <italic>N</italic> (<italic>t</italic>), cell count at time <italic>t</italic>; <italic>i</italic>, cell chosen for division; {<italic>g</italic><sub>0</sub>, <italic>g</italic><sub>1</sub>, <italic>g</italic><sub>2</sub>}, progeny count distribution; <italic>X</italic>, progeny count of cell <italic>i</italic>; <italic>N</italic> (<italic>t</italic> + <italic>T</italic>), cell count at time <italic>t</italic> + <italic>T</italic> after division event.</p></caption>
<graphic xlink:href="563302v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>
<disp-formula id="ueqn1">
<graphic xlink:href="563302v2_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>s &gt;</italic> 0 is the selective advantage associated with a driver mutation, while <italic>d ∈</italic> (0, 1) represents the selective disadvantage of a passenger mutation (selection coefficients, of driver and passenger mutations; see the Natural Selection chapter of the book by Durrett [<xref ref-type="bibr" rid="c9">9</xref>]). Under the time-continuous Markov Chain assumption, the time until the next death - replacement event is exponentially distributed with parameter Σ<sub><italic>f</italic></sub> =Σ <sub><italic>i∈{</italic>1,…,<italic>N }</italic></sub> <italic>f</italic><sub><italic>i</italic></sub>. The dying cell <italic>i</italic> is selected from a distribution biased by fitness, i.e., with probability mass function (pmf) {<italic>f</italic><sub><italic>i</italic></sub><italic>/</italic>Σ<sub><italic>f</italic></sub>, <italic>i</italic> = 1, …, <italic>N }</italic>. The cell <italic>j</italic> that replaces the dying cell is selected from the same distribution.</p>
<p>The time until the next mutation event is exponentially distributed with parameter N<italic>μ</italic>, where <italic>μ</italic> is the mutation rate per cell. The cell selected to mutate is chosen uniformly among the <italic>N</italic> cells. Its state then changes from (α, <italic>β</italic>) to (α + 1, <italic>β</italic>) with probability <italic>p ∈</italic> (0, 1), or to (α, <italic>β</italic> + 1) with probability 1 <italic>− p</italic>. In combination, the time to the next event is random and exponentially distributed with parameter
<disp-formula id="eqn1">
<graphic xlink:href="563302v2_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
called the total rate of death - replacement and mutation events.</p>
</sec>
<sec id="s2a2">
<label>2.1.2</label>
<title>Model B</title>
<p>Model B (<bold><xref rid="fig1" ref-type="fig">Figure 1B</xref></bold>) is defined similarly to Model A, with the time until the next death - replacement event being exponentially distributed with parameter Σ<sub><italic>f</italic></sub>. However, instead of being biased by fitness, the dying cell is chosen among all <italic>N</italic> cells uniformly. The time until the next event is likewise exponentially distributed with the same parameter in Equ. (1).</p>
</sec>
<sec id="s2a3">
<label>2.1.3</label>
<title>Model A versus Model B</title>
<p>As we noted in [<xref ref-type="bibr" rid="c16">16</xref>], the crucial difference between Model A and Model B lies in the expected fitness increment in the population after the death - replacement event. This is equal to the difference of <italic>f</italic><sub><italic>j</italic></sub> <italic>− f</italic><sub><italic>i</italic></sub>, where <italic>f</italic><sub><italic>i</italic></sub> and <italic>f</italic><sub><italic>j</italic></sub> are the fitnesses of the dead cell and the replacing cell, in the absence of mutations. The mutation-selection balance condition was derived in [<xref ref-type="bibr" rid="c2">2</xref>] in the form of
<disp-formula id="eqn2">
<graphic xlink:href="563302v2_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
When <italic>ps &gt;</italic> (1 <italic>− p</italic>)<italic>d</italic>, drivers “dominate” over passengers, and the reverse occurs if <italic>ps &lt;</italic> (1 <italic>− p</italic>)<italic>d</italic>. The expected fitness is intact after the death - replacement process in Model A, hence the expected fitness trend follows the mutation-selection condition. In Model B, the outcome is more complex (see Results and Discussion).</p>
</sec>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Branching process model</title>
<p>For the branching process model (<bold><xref rid="fig1" ref-type="fig">Figure 1C</xref></bold>), we consider a population consisting of <italic>N</italic> (<italic>t</italic>) cells at time <italic>t</italic>. Similar to the Moran models, the fitness of a cell <italic>i</italic> of type (<italic>α</italic><sub><italic>i</italic></sub>, <italic>β</italic><sub><italic>i</italic></sub>) with <italic>α</italic><sub><italic>i</italic></sub> drivers and <italic>β</italic><sub><italic>i</italic></sub> passengers is defined by <italic>f</italic><sub><italic>i</italic></sub> = (1 + <italic>s</italic>) <sup><italic>αi</italic></sup> (1 <italic>− d</italic>) <sup><italic>βi</italic></sup>.</p>
<p>Two possible event types can occur in the branching process: cell division and mutation. The time to the next cell division is exponentially distributed with rate Σ<sub><italic>f</italic></sub> = Σ<sub><italic>i∈{</italic>1,…,<italic>N</italic> (<italic>t</italic>)}</sub> <italic>f</italic><sub><italic>i</italic></sub>, fitness sum of all <italic>N</italic> (<italic>t</italic>) cells. The dividing cell is chosen from the <italic>N</italic> (<italic>t</italic>) cells with probability weighted by fitness {<italic>f</italic><sub><italic>i</italic></sub><italic>/</italic>Σ<sub><italic>f</italic></sub> }, and its progeny count follows a given pmf {<italic>g</italic><sub>0</sub>, <italic>g</italic><sub>1</sub>, … }. If the progeny count is 0, the population loses the chosen cell. On the other hand, it survives if the progeny count is 1, and multiplies if the progeny count is more than 1. Additionally, the time to the next mutation event is exponentially distributed with rate <italic>μN</italic> (<italic>t</italic>). A uniformly chosen cell acquires a driver and changes its type to (<italic>α</italic> + 1, <italic>β</italic>) with probability <italic>p</italic>, or it acquires another passenger to become type (<italic>α, β</italic> + 1) with probability 1 <italic>− p</italic>.</p>
<sec id="s2b1">
<label>2.2.1</label>
<title>Criticality and conditioning</title>
<p>One important difference between the Moran and branching process settings is that the total cell count at any time remains constant at <italic>N</italic> in the Moran models. The branching process model starts from the same cell count, i.e. <italic>N</italic> (0) = <italic>N</italic>, but it can change at random throughout time. For a direct comparison to Moran models, we may assume that 𝔼 (<italic>N</italic> (<italic>t</italic>)) = <italic>N</italic>. This is satisfied if we require that the mean progeny count of any cell is 1, i.e. that the branching process is critical [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c15">15</xref>].</p>
<p>Even with criticality, at any time <italic>N</italic> (<italic>t</italic>) can fixate at 0 (in which case the process enters extinction) or increase to a larger count. The probability of extinction increases as either <italic>t</italic> increases ([<xref ref-type="bibr" rid="c15">15</xref>], Section 3.3) or the cell fitness increases as a result of time scale change. We analyze the effects of two types of conditioning on the results of the branching process. The first type conditions the branching process on non-extinction, meaning <italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>&gt;</italic> 0 at the final time <italic>t</italic><sub><italic>f</italic></sub>. The second type imposes a more stringent condition on the branching process, requiring that <italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [<italic>N − c, N</italic> + <italic>c</italic>] for some small constant <italic>c</italic>.</p>
</sec>
<sec id="s2b2">
<label>2.2.2</label>
<title>Distribution of progeny cell counts</title>
<p>We also study the impact of the distribution of progeny cell count {<italic>g</italic><sub><italic>k</italic></sub>, <italic>k</italic> = 0, 1, … } on the outcomes of the branching process. In this study, we impose <italic>g</italic><sub><italic>k</italic></sub> = 0 for <italic>k &gt;</italic> 2. Therefore, a chosen cell dies if <italic>k</italic> = 0, remains unchanged if <italic>k</italic> = 1, or divides into two progeny cells if <italic>k</italic> = 2. The criticality requirement, discussed in the previous section, is satisfied if <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub>. Note that the branching process setting discussed in this paper is equivalent to a birth-death process where each cell <italic>i</italic> with fitness <italic>f</italic><sub><italic>i</italic></sub> dies with rate <italic>g</italic><sub>0</sub><italic>f</italic><sub><italic>i</italic></sub> or divides with rate <italic>g</italic><sub>2</sub><italic>f</italic><sub><italic>i</italic></sub>.</p>
<p>A common progeny count distribution is such that <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 and <italic>g</italic><sub>1</sub> = 0.5, which is equivalent to a binomial distribution with rates <italic>n</italic> = 2, <italic>p</italic> = 0.5. For a direct comparison in simulations to the Moran models, the fitness in the branching process is scaled up by 4. Hence, the wait time until the next division event of a cell with fitness <italic>f</italic><sub><italic>i</italic></sub> is exponentially distributed with rate 4<italic>f</italic><sub><italic>i</italic></sub>. This event has equal probability to be a cell death or a cell division, both at 0.25. Therefore, the model is equivalent to a birth-death process, where the birth and death rates are 0.25 <italic>×</italic> 4<italic>f</italic><sub><italic>i</italic></sub> = <italic>f</italic><sub><italic>i</italic></sub>. In comparison, in the Moran models, the death - replacement events also occur at rate <italic>f</italic><sub><italic>i</italic></sub>, resulting in two cells being chosen to divide and die, respectively. Because the event rates are now similar, it is easier to directly compare the model behaviors under different selection scenarios.</p>
<p>We will also investigate the effect of changing the progeny cell count distribution {<italic>g</italic><sub>0</sub>, <italic>g</italic><sub>1</sub>, <italic>g</italic><sub>2</sub>}. First, we retain the criticality by assuming <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub>, and analyze the branching process with different values for <italic>g</italic><sub>1</sub>. We set <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.5 and <italic>g</italic><sub>1</sub> = 0, which doubles the probabilities for cell division and death events. This is similar to increasing the birth and death rates in a birth-death process, hence we name this model “fast BP”. We also consider <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.05 and <italic>g</italic><sub>1</sub> = 0.9 (“slow BP”), which decreases the cell division and death probabilities. Second, we investigate the supercritical branching process by setting <italic>g</italic><sub>2</sub> <italic>&gt; g</italic><sub>0</sub>. For each of these parameter sets, we will analyze the differences in sample statistics, compared to the binomial branching process and the Moran models.</p>
</sec>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Site Frequency Spectrum</title>
<p>As in other preceding paragraphs, in this section, we include a summary of the descriptions in [<xref ref-type="bibr" rid="c16">16</xref>]. For more details, see [<xref ref-type="bibr" rid="c16">16</xref>].</p>
<p>One of the common summary statistics of the sequence data is the so-called Site Frequency Spectrum. In a sequencing experiment with <italic>n</italic> cells, we can estimate for each novel somatic mutation call the number of cells carrying that mutation. The number <italic>S</italic><sub><italic>n</italic></sub>(<italic>k</italic>) of mutations present in <italic>k</italic> cells is put into a vector (<italic>S</italic><sub><italic>n</italic></sub>(1), <italic>S</italic><sub><italic>n</italic></sub>(2), …, <italic>S</italic><sub><italic>n</italic></sub>(<italic>n −</italic> 1)) called the Site Frequency Spectrum, abbreviated to SFS. Frequently number of cells that were sampled is not know, as for example in the bulk sequencing data. However, we can estimate the relative proportion of the mutant at each site, and so arrive at a frequency spectrum based on proportions with notation <italic>S</italic>(<italic>x</italic>) = <italic>S</italic>(<italic>k/n</italic>), where <italic>x</italic> is treated as a continuous variable, such that <italic>x ∈</italic> (0, 1) (or <italic>x ∈</italic> (0, 1<italic>/</italic>2) if we consider diploid genome). The SFSs <italic>S</italic>(<italic>k</italic>) and <italic>S</italic>(<italic>x</italic>) are idealized versions of the empirical variant allele frequency (VAF) graph. It is convenient for reasons explained in [<xref ref-type="bibr" rid="c16">16</xref>] (Section 2.4) to employ the cumulative tail of the SFS <italic>S</italic>(<italic>x</italic>)
<disp-formula id="eqn3">
<graphic xlink:href="563302v2_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
</sec>
<sec id="s2d">
<label>2.4</label>
<title>DNA Sequencing of Cell Samples from Breast Cancer Specimens</title>
<sec id="s2d1">
<label>2.4.1</label>
<title>DNA sample collection and processing</title>
<p>Most of the details of DNA sample collection and processing in this section, overlap with those in [<xref ref-type="bibr" rid="c16">16</xref>] and we refer to the description there. We only mention here several basic details. Tissue samples from primary breast tumor were collected at the Department of Applied Radiology of the Maria Sklodowska-Curie National Research Institute of Oncology, Krakow Branch in Poland. The set of tumor and normal control samples called specimen G2 is HER2+ breast cancer, while sets described as G32 and G41 are triple-negative breast cancer type and luminal A type, respectively.</p>
</sec>
<sec id="s2d2">
<label>2.4.2</label>
<title>Removal of FFPE artifacts</title>
<p>Fixation of tissues in formalin leads to deamination of cytosine to uracil, which can be recognized by sequencing as C<italic>&gt;</italic>T or G<italic>&gt;</italic>A type modifications [<xref ref-type="bibr" rid="c8">8</xref>].</p>
<p>A significant portion of the variants detected in our WES data are a possible artifact of sample fixation in formalin. This is indicated primarily by the statistics of the number of variants of a specific type, where C:G<italic>&gt;</italic>T:A definitely dominates (<xref rid="tbl1" ref-type="table">Table 1</xref>).</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><title>Statistics of the number of variants of a specific type.</title></caption>
<graphic xlink:href="563302v2_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>The reason for such a large number of this type of changes may be the duplication of variants related to deamination in PCR amplification (necessary in the case of WES, especially in the case of samples with a low amount of DNA).</p>
<p>Omitting all C:G<italic>&gt;</italic>T:A variants would result in the loss of approximately 1/6 of the true variants. However, information about the frequency of reads with a specific orientation can be used to identify variants associated with the method of sample fixation. For this purpose, the SOBDetector [<xref ref-type="bibr" rid="c7">7</xref>] program was used. The software is based on the fact that formalin fixation most likely affects only one of the DNA strands (the C:G pair becomes the T:G pair) and therefore the paired-end next-generation sequencing approach can help this additional filtering step. By counting not only the number of reads supporting alternative alleles, but also the relative orientation of the reads (Forward-Reverse:FR or Reverse-Forward:RF), these FFPE artifacts will likely have a strand orientation bias toward one of the directions, while true mutations should have approximately the same number of FR and RF reads.</p>
<p>This work uses data in which the expected FFPE artifacts have been filtered out by SOBDetector.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Results</title>
<sec id="s3a">
<label>3.1</label>
<title>Behavior of Moran and branching process models in extreme cases</title>
<p>We investigate the similarities and differences between Moran and branching process models. One thousand simulations are performed for each model, and each simulation starts with <italic>N</italic> = 100 cells with no mutations at <italic>t</italic><sub>0</sub> = 0 under different values for the selection coefficients <italic>s</italic> and <italic>d</italic>, mutation rate <italic>μ</italic> and probability <italic>p</italic> of driver mutations (or equivalently probability 1 <italic>− p</italic> of passenger mutations). We then examine the statistics at final time <italic>t</italic><sub><italic>f</italic></sub> = 100 as well as during the entire time line [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>].</p>
<p>Five versions of branching processes are studied. This includes the branching process with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 and <italic>g</italic><sub>1</sub> = 0.5 conditioned on non-extinction (yellow), and the same branching process conditioned on the final population <italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) restricted in [90, 110] (orange). These models are termed “binomial BP” in the comparisons, since the progeny cell count distribution is binomial in this case. We also include the branching process with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.5, <italic>g</italic><sub>1</sub> = 0 (purple, termed “fast BP”) and <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.05, <italic>g</italic><sub>1</sub> = 0.9 (cyan, termed “slow BP”), both conditioned on <italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110].</p>
<p>The fifth branching process model is conditioned on non-extinction with <italic>g</italic><sub>0</sub>, <italic>g</italic><sub>1</sub> and <italic>g</italic><sub>2</sub> computed such that the population size is expected to double between [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>] under neutral evolution. It can be shown that <italic>g</italic><sub>0</sub> and <italic>g</italic><sub>2</sub> are required to satisfy
<disp-formula id="ueqn2">
<graphic xlink:href="563302v2_ueqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
We choose <italic>g</italic><sub>1</sub> = 0.5, resulting in <italic>g</italic><sub>0</sub> = 0.2465 and <italic>g</italic><sub>2</sub> = 0.2535. This model is referred to as “supercritical BP” (gray) in the numerical comparisons. Finally, Moran A and Moran B are represented in dark blue and green, respectively.</p>
<p>Since we scale up the fitness by 4 in the branching process models to make them similar to the Moran models, in the results we scale the fitnesses down by 4, for more convenient comparisons. The division count, defined to be the total number of cell division events observed in a simulation, increases linearly with the total cell count and cell fitness, i.e. the rate at which cells divide. Since the expected cell count in a critical BP is identical to the Moran models, the division count in BP is 4 times higher than in the Moran models due to the fitness being scaled up. Therefore, we also downscale the BP division count by 4 to directly compare between different models.</p>
<sec id="s3a1">
<label>3.1.1</label>
<title>Neutral evolution case</title>
<p><bold><xref rid="fig3" ref-type="fig">Figure 3</xref></bold> presents the simulated results for <italic>s</italic> = <italic>d</italic> = 0, which implies that all mutations are neutral, <italic>μ</italic> = 0.1 and <italic>p</italic> = 1<italic>/</italic>11.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><p>The Site Frequency Spectrum (SFS). <bold>(A)</bold> Genealogy of a sample of <italic>n</italic> = 10 cells includes 14 mutational events, denoted by red dots. Time is running down the page. Mutations 1, 3, 4, 11, 13, and 14 (total of 6 mutations) are present in a single cell, mutations 2, 5, 7 and 12 (total of 4 mutations) are present in two cells, mutations 9 and 10 (2 mutations) are present in three cells, mutation 8 (1 mutation) is present in five cells and mutation 6 (1 mutation) is present in 9 cells. <bold>(B)</bold> The resulting site frequency spectrum, <italic>S</italic><sub>10</sub>(1) = 6, <italic>S</italic><sub>10</sub>(2) = 4, <italic>S</italic><sub>10</sub>(3) = 2, <italic>S</italic><sub>10</sub>(5) = 1, and <italic>S</italic><sub>10</sub>(9) = 1, other <italic>S</italic><sub><italic>n</italic></sub>(<italic>k</italic>) equal to 0.</p></caption>
<graphic xlink:href="563302v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><p>Comparisons between Moran and branching process (BP) models in the “neutral” setting. <bold>(A)</bold> Average cumulative tail of the mutational Site Frequency Spectra. <bold>(B)</bold> Distributions of allele counts at <italic>t</italic><sub><italic>f</italic></sub>. <bold>(C)</bold> Distributions of singleton counts at <italic>t</italic><sub><italic>f</italic></sub>. <bold>(D-F)</bold> Distributions of counts of driver mutations <bold>(D)</bold>, passenger mutations <bold>(E)</bold> and divisions <bold>(F)</bold> within [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>]. <bold>(G-N)</bold> Trajectories of the averages over time of population sizes (+/-std) <bold>(G)</bold>, cumulative mutation counts <bold>(H)</bold>, fitness <bold>(I)</bold>, cumulative division/replacement counts <bold>(J)</bold>, allele counts <bold>(K)</bold>, percentage of singletons among all alleles <bold>(L)</bold>, allele birth counts <bold>(M)</bold> and allele death counts <bold>(N)</bold>. Allele death counts (lines) are categorized into mutation events (circles) and division/replacement events (diamonds). Dark blue = Moran A, green = Moran B, yellow = “binomial BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 (non-extinction), orange = “binomial BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), purple = “fast BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.5 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), cyan = “slow BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.05 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), gray = “supercritical BP” with <italic>g</italic><sub>0</sub> = 0.2465, <italic>g</italic><sub>1</sub> = 0.5 and <italic>g</italic><sub>2</sub> = 0.2535 (non-extinction).</p></caption>
<graphic xlink:href="563302v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Since all cells have the same fitness, the formulations for Moran A and Moran B are identical. This is reflected in identical distributions among all statistics among the two variations (see Appendix C, <xref rid="tbl2" ref-type="table">Table 2</xref>, dark blue for Moran A and green for Moran B). Moreover, the binomial BP conditioned on <italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110] also has the same distributions of allele counts and singleton counts, albeit with slightly higher variances (at final time in <bold><xref rid="fig3" ref-type="fig">Figure 3B-C</xref></bold> and throughout history in <bold><xref rid="fig3" ref-type="fig">Figure 3K-L</xref></bold>). The higher variances originate from wider distributions of event counts in the BP compared to Moran, these latter stemming from the fact that total cell count in BP varies throughout time, as opposed to Moran where the total cell count remains constant (<bold><xref rid="fig3" ref-type="fig">Figure 3D-G</xref></bold>). Note that even though the statistics have higher variances, their averages are similar to the Moran models both throughout time and at the final time (Appendix C, <xref rid="tbl2" ref-type="table">Table 2</xref>, orange).</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><p>Statistics (mean <italic>±</italic> standard deviation) for <xref rid="fig3" ref-type="fig">Figure 3</xref> (neutral evolution). <bold>Model color code:</bold> dark blue = Moran A, green = Moran B, yellow = “binomial BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 (nonextinction), orange = “binomial BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), purple = “fast BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.5 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), cyan = “slow BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.05 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), gray = “supercritical BP” with <italic>g</italic><sub>0</sub> = 0.2465, <italic>g</italic><sub>1</sub> = 0.5 and <italic>g</italic><sub>2</sub> = 0.2535 (non-extinction). <bold>Statistics:</bold> B = allele counts at <italic>t</italic><sub><italic>f</italic></sub>, C = singleton counts at <italic>t</italic><sub><italic>f</italic></sub>, D = driver mutation count within [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>], E = passenger mutation count within [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>], F = division count within [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>].</p></caption>
<graphic xlink:href="563302v2_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>The impact of relaxing the conditioning of BP can be observed by comparing binomial BP conditioned on <italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110], binomial BP conditioned on non-extinction and supercritical binomial BP with <italic>g</italic><sub>0</sub> = 0.2465, <italic>g</italic><sub>1</sub> = 0.5 and <italic>g</italic><sub>2</sub> = 0.2535, conditioned on non-extinction. As the population size can vary widely throughout time if conditioned only on non-extinction (<bold><xref rid="fig3" ref-type="fig">Figure 3G</xref></bold>), every statistics in the comparison has much higher variances (Appendix C, <xref rid="tbl2" ref-type="table">Table 2</xref>, yellow for critical BP and gray for supercritical BP). However, for critical BP, the averages remain faithful to both Moran models and the more stringently conditioned BP. Only in the case of supercritical BP do all statistics differ, even cumulative mutation count (<bold><xref rid="fig3" ref-type="fig">Figure 3H</xref></bold>) and cumulative division/replacement count (<bold><xref rid="fig3" ref-type="fig">Figure 3J</xref></bold>), which is strictly associated with rapidly growing population size.</p>
<p>We then evaluate the impact of changing the progeny cell count distributions, while retaining criticality. The fast BP has increased <italic>g</italic><sub>0</sub> and <italic>g</italic><sub>2</sub> and therefore is equal to a birth-death process with higher rates. This leads to higher variances in the population size throughout time compared to the binomial BP, even if similarly conditioned (<bold><xref rid="fig3" ref-type="fig">Figure 3G</xref></bold>, Appendix C: <xref rid="tbl2" ref-type="table">Table 2</xref>, purple). Importantly, the fast BP also results in both less alleles and lower percentage of singletons within all alleles (<bold><xref rid="fig3" ref-type="fig">Figure 3B-C, K-L</xref></bold>). Conversely, the slow BP is equivalent to a birth-death process with lower rates, whose population size therefore varies less than the binomial BP (<bold><xref rid="fig3" ref-type="fig">Figure 3G</xref></bold>). Both its allele count and percentage of singleton count is much higher than in the binomial BP (<bold><xref rid="fig3" ref-type="fig">Figure 3B-C, K-L</xref></bold>, Appendix C: <xref rid="tbl2" ref-type="table">Table 2</xref>, cyan).</p>
<p><xref rid="fig3" ref-type="fig">Figure 3N</xref> details the rates at which alleles are lost from the population, divided into two categories: (a) cell deaths (division with no progeny cells in BP, or replacement in Moran), and (b) cell mutation (where the only remaining cell that carries the allele mutates into a different allele). The allele death counts, either combined or categorized to (a) or (b), are similar in all cases except supercritical BP and fast or slow BP. The rate of allele death is slightly lower for slow BP and slightly higher in the case of fast BP. They also have different categorized allele death counts. Compared to binomial BP, alleles are removed more frequently due to mutations in slow BP. Conversely, they are more likely to be removed due to failed divisions in fast BP. The supercritical BP is the only case in which allele death count does not reach plateau and is still increasing during the simulated time period, as the population grows exponentially.</p>
</sec>
<sec id="s3a2">
<label>3.1.2</label>
<title>Balanced evolution</title>
<p><bold><xref rid="fig4" ref-type="fig">Figure 4</xref></bold> showcases the simulated results for <italic>s</italic> = 0.1, <italic>d</italic> = 0.01, <italic>μ</italic> = 0.1 and <italic>p</italic> = 1<italic>/</italic>11. As <italic>ps</italic> = (1 <italic>− p</italic>)<italic>d</italic>, condition (2) is satisfied, therefore the average fitness remains constant for Moran A model (<bold><xref rid="fig4" ref-type="fig">Figure 4I</xref></bold>). Moreover, the fitness in binomial BP also remains unchanged on average over time. As a result, the distributions for all statistics are similar between the balanced evolution setting and the neutral evolution setting (Appendix B, <xref rid="tbl3" ref-type="table">Table 3</xref>), discussed in the last section, for Moran A and binomial BP. The outcomes following modulation of the progeny cell count distribution or relaxing the conditioning for BP, likewise remain unchanged compared to the neutral evolution setting.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3:</label>
<caption><title>Statistics for <xref rid="fig4" ref-type="fig">Figure 4</xref> (balanced evolution)</title></caption>
<graphic xlink:href="563302v2_tbl3.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><p>Comparisons between Moran and branching process (BP) models in the “balanced” setting. <bold>(A)</bold> Average cumulative tail of the mutational Site Frequency Spectra. <bold>(B)</bold> Distributions of allele counts at <italic>t</italic><sub><italic>f</italic></sub>. <bold>(C)</bold> Distributions of singleton counts at <italic>t</italic><sub><italic>f</italic></sub>. <bold>(D-F)</bold> Distributions of counts of driver mutations <bold>(D)</bold>, passenger mutations <bold>(E)</bold> and divisions <bold>(F)</bold> within [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>]. <bold>(G-N)</bold> Trajectories of the averages over time of population sizes (+/-std) <bold>(G)</bold>, cumulative mutation counts <bold>(H)</bold>, fitness <bold>(I)</bold>, cumulative division/replacement counts <bold>(J)</bold>, allele counts <bold>(K)</bold>, percentage of singletons among all alleles <bold>(L)</bold>, allele birth counts <bold>(M)</bold> and allele death counts <bold>(N)</bold>. Allele death counts (lines) are categorized into mutation events (circles) and division/replacement events (diamonds). Dark blue = Moran A, green = Moran B, yellow = “binomial BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 (non-extinction), orange = “binomial BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), purple = “fast BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.5 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), cyan = “slow BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.05 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), gray = “supercritical BP” with <italic>g</italic><sub>0</sub> = 0.2465, <italic>g</italic><sub>1</sub> = 0.5 and <italic>g</italic><sub>2</sub> = 0.2535 (non-extinction).</p></caption>
<graphic xlink:href="563302v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>However, the fitness in Moran B increases over time instead of remaining constant (<bold><xref rid="fig4" ref-type="fig">Figure 4I</xref></bold>), which leads to slightly higher division count (<bold><xref rid="fig4" ref-type="fig">Figure 4F</xref></bold>) even though the mutation count, depending only on the population size which remains constant, is unchanged (<bold><xref rid="fig4" ref-type="fig">Figure 4D-E</xref></bold>). This results in slightly lower allele count and singleton count (<bold><xref rid="fig4" ref-type="fig">Figure 4B-C</xref></bold>), indicative of selective pressure.</p>
</sec>
<sec id="s3a3">
<label>3.1.3</label>
<title>Driver domination case</title>
<p>To understand the consequences when the driver mutations are strongly selectively advantageous, we set <italic>s</italic> = 0.25, <italic>d</italic> = 0, <italic>μ</italic> = 0.1 and <italic>p</italic> = 1<italic>/</italic>10 and compare the statistics in <bold><xref rid="fig5" ref-type="fig">Figure 5</xref></bold> and in Appendix B, <xref rid="tbl4" ref-type="table">Table 4</xref>.</p>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Table 4:</label>
<caption><title>Statistics for <xref rid="fig5" ref-type="fig">Figure 5</xref> (driver domination)</title></caption>
<graphic xlink:href="563302v2_tbl4.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><p>Comparisons between Moran and branching process (BP) models in the “selective” setting. <bold>(A)</bold> Average cumulative tail of the mutational Site Frequency Spectra. <bold>(B)</bold> Distributions of allele counts at <italic>t</italic><sub><italic>f</italic></sub>. <bold>(C)</bold> Distributions of singleton counts at <italic>t</italic><sub><italic>f</italic></sub>. <bold>(D-F)</bold> Distributions of counts of driver mutations <bold>(D)</bold>, passenger mutations <bold>(E)</bold> and divisions <bold>(F)</bold> within [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>]. <bold>(G-N)</bold> Trajectories of the averages over time of population sizes (+/-std) <bold>(G)</bold>, cumulative mutation counts <bold>(H)</bold>, fitness <bold>(I)</bold>, cumulative division/replacement counts <bold>(J)</bold>, allele counts <bold>(K)</bold>, percentage of singletons among all alleles <bold>(L)</bold>, allele birth counts <bold>(M)</bold> and allele death counts <bold>(N)</bold>. Allele death counts (lines) are categorized into mutation events (circles) and division/replacement events (diamonds). Dark blue = Moran A, green = Moran B, yellow = “binomial BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 (non-extinction), orange = “binomial BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), purple = “fast BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.5 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), cyan = “slow BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.05 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), gray = “supercritical BP” with <italic>g</italic><sub>0</sub> = 0.2465, <italic>g</italic><sub>1</sub> = 0.5 and <italic>g</italic><sub>2</sub> = 0.2535 (non-extinction).</p></caption>
<graphic xlink:href="563302v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Because condition (2) is no longer satisfied, the fitness coefficients and mutation rates are not at equilibrium and fitness in Moran A increases over time (<bold><xref rid="fig5" ref-type="fig">Figure 5I</xref></bold>), leading to an increase in its replacement count (<bold><xref rid="fig5" ref-type="fig">Figure 5J</xref></bold>) as compared to the neutral or balanced evolution setting. As a result, the counts of both alleles and singletons are slightly lower in the selective evolution as compared to previous settings (<bold><xref rid="fig5" ref-type="fig">Figure 5B-C</xref></bold>). The same is also true for all remaining models. Remarkably, binomial BP still behaves identically to Moran A, differing only in population size over time (<bold><xref rid="fig5" ref-type="fig">Figure 5G</xref></bold>). As before, relaxing the conditioning on binomial BP leads only to higher variances of the statistics without changing their averages. Like in previous examples, supercritical BP has much higher averages and variances in all statistics than other models, both at the end of simulation as well as throughout time. Similarly as in the previous case, changing the progeny cell count distribution in BP while retaining criticality results in allele count and singleton count converging to different values (<bold><xref rid="fig5" ref-type="fig">Figure 5B-C, K-L</xref></bold>).</p>
<p>As in the balanced evolution setting, the only model differing in fitness from the remaining critical processes is Moran B (<bold><xref rid="fig5" ref-type="fig">Figure 5I</xref></bold>), this time resulting in twice as many replacements compared to other models (<bold><xref rid="fig5" ref-type="fig">Figure 5F, J</xref></bold>). In later moments of the simulation, the number of replacements is even higher than in the critical BP. Consequently, in Moran B, the counts of alleles and singletons decrease at a fast rate after reaching maximum values (<bold><xref rid="fig5" ref-type="fig">Figure 5B-C, K-L</xref></bold>).</p>
</sec>
<sec id="s3a4">
<label>3.1.4</label>
<title>Passenger domination case</title>
<p>Finally, we investigate the setting where passenger mutations are strongly deleterious, with parameters <italic>s</italic> = 0, <italic>d</italic> = 0.5, <italic>μ</italic><sub><italic>d</italic></sub> = 0.1 and <italic>p</italic> = 1<italic>/</italic>10 corresponding to <bold><xref rid="fig6" ref-type="fig">Figure 6</xref></bold>.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><p>Comparisons between Moran and branching process (BP) models in the “deleterious” setting. <bold>(A)</bold> Average cumulative tail of the mutational Site Frequency Spectra. <bold>(B)</bold> Distributions of allele counts at <italic>t</italic><sub><italic>f</italic></sub>. <bold>(C)</bold> Distributions of singleton counts at <italic>t</italic><sub><italic>f</italic></sub>. <bold>(D-F)</bold> Distributions of counts of driver mutations <bold>(D)</bold>, passenger mutations <bold>(E)</bold> and divisions <bold>(F)</bold> within [<italic>t</italic><sub>0</sub>, <italic>t</italic><sub><italic>f</italic></sub>]. <bold>(G-N)</bold> Trajectories of the averages over time of population sizes (+/-std) <bold>(G)</bold>, cumulative mutation counts <bold>(H)</bold>, fitness <bold>(I)</bold>, cumulative division/replacement counts <bold>(J)</bold>, allele counts <bold>(K)</bold>, percentage of singletons among all alleles <bold>(L)</bold>, allele birth counts <bold>(M)</bold> and allele death counts <bold>(N)</bold>. Allele death counts (lines) are categorized into mutation events (circles) and division/replacement events (diamonds). Dark blue = Moran A, green = Moran B, yellow = “binomial BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 (non-extinction), orange = “binomial BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), purple = “fast BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.5 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), cyan = “slow BP” with <italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.05 (<italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), gray = “supercritical BP” with <italic>g</italic><sub>0</sub> = 0.2465, <italic>g</italic><sub>1</sub> = 0.5 and <italic>g</italic><sub>2</sub> = 0.2535 (non-extinction).</p></caption>
<graphic xlink:href="563302v2_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In Moran A, as cells accumulate increasingly more mutations, their fitness decrease to 0 because of the passenger mutations’ deleterious coefficient (<bold><xref rid="fig6" ref-type="fig">Figure 6I</xref></bold>), therefore they stop dividing (<bold><xref rid="fig6" ref-type="fig">Figure 6J</xref></bold>). However, the mutation process depends only on the population size (<bold><xref rid="fig6" ref-type="fig">Figure 6G</xref></bold>) and therefore occurs at a constant rate throughout time (<bold><xref rid="fig6" ref-type="fig">Figure 6H</xref></bold>). The consequence is that every cell sooner or later would acquire a unique mutation, therefore the cell population almost consists only of singletons (<bold><xref rid="fig6" ref-type="fig">Figure 6B-C</xref></bold>).</p>
<p>As is the case for other settings, binomial BP matches the average statistics from Moran A throughout history and at the final time (Appendix B, <xref rid="tbl5" ref-type="table">Table 5</xref>). The same is true for relaxing the conditioning on binomial BP, which only increases the variances. However, unlike the selective evolution setting, altering the progeny cell count distribution does not change the steady state values for the allele and singleton counts, as both converge to the same distributions as binomial BP and Moran A (<bold><xref rid="fig6" ref-type="fig">Figure 6B-C, K-L</xref></bold>). Nonetheless, compared to these models, the fast BP converges faster and the slow BP takes more time to converge.</p>
<table-wrap id="tbl5" orientation="portrait" position="float">
<label>Table 5:</label>
<caption><title>Statistics for <xref rid="fig6" ref-type="fig">Figure 6</xref> (passenger domination)</title></caption>
<graphic xlink:href="563302v2_tbl5.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>The deleterious evolution setting is the only scenario in which supercritical BP behaves similarly to most of the other models. While fitness tends to zero, cells stop dividing an the impact of the supercriticality is no longer significant.</p>
<p>Finally, as usual, Moran B has a much higher steady state fitness compared to other models (<bold><xref rid="fig6" ref-type="fig">Figure 6I</xref></bold>). Therefore, although the replacement count is lower than in the balanced or selective evolution settings, cells do not stop dividing as is the case with Moran A, because the fitness does not converge to 0 (<bold><xref rid="fig6" ref-type="fig">Figure 6E, I</xref></bold>). This results in much lower allele count and singleton count (<bold><xref rid="fig6" ref-type="fig">Figure 6A-B, J-K</xref></bold>). Despite accumulating passenger mutation, after the initial period of dropping the average fitness stays at nonzero value, due to the drift process favoring fixation of clones with higher fitness.</p>
<p>In the deleterious evolution scenario, since cells stop dividing, the main reason of cells’ death is mutation (<bold><xref rid="fig6" ref-type="fig">Figure 6N</xref></bold>), except model B in which cells keep dividing (<bold><xref rid="fig6" ref-type="fig">Figure 6J</xref></bold>).</p>
</sec>
</sec>
<sec id="s3b">
<label>3.2</label>
<title>Fitting breast cancer SFS</title>
<p>We use the Moran A model to fit the mutational SFS from 3 samples of breast cancer. We fix population size <italic>N</italic> = 100 cells, average time between mutation events <italic>L</italic> = <italic>Nμ</italic> = 6, probability of driver mutations <italic>p</italic> = 0.01, final time <italic>t</italic><sub><italic>f</italic></sub> = 100. We then vary the values for <italic>s</italic> and <italic>d</italic>, simulate the SFS from 1,000 simulations and compute the average SFS. For a given sample, we compute the cumulative tail of the SFS <italic>S</italic>(<italic>f</italic><sub><italic>i</italic></sub>) i.e., the proportion of mutations occurring at frequencies <italic>&gt; f</italic><sub><italic>i</italic></sub>, and similarly the average {<italic>S</italic>(<italic>f</italic><sub><italic>i</italic></sub>|<italic>s, d</italic>)} for every combination of (<italic>s, d</italic>). The reverse cumulative SFS is evaluated for mutations with frequency <italic>f &gt;</italic> 0.05. The error for (<italic>s, d</italic>) is defined as
<disp-formula id="ueqn3">
<graphic xlink:href="563302v2_ueqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>I</italic> is the largest index such that <inline-formula><inline-graphic xlink:href="563302v2_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <italic>S</italic>(<italic>f</italic><sub><italic>i</italic></sub>|<italic>s, d</italic>) are both positive.</p>
<p><xref rid="fig7" ref-type="fig">Figures 7</xref>-<xref rid="fig9" ref-type="fig">9</xref> present the fitting results for the SFS from the breast SFS data. The (<italic>s, d</italic>) combinations with low error exhibit a trade-off between driver and passenger mutations: the observed SFS can be simulated by Moran A with either low values for <italic>s</italic> and <italic>d</italic>, or high values for both (panel A in each figure). As a result, the 100 best (<italic>s, d</italic>) parameters (marked as squares) can be approximated by linear regression.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7:</label>
<caption><p>Results from fitting the SFS from sample G2. <bold>(A)</bold> Heatmap of error between data SFS tail and average SFS tail for distinct (<italic>s, d</italic>) combinations in Moran A. Dark blue squares: 100 best (<italic>s, d</italic>) combinations, with linear regression. Dark red square: best (<italic>s, d</italic>) combination. <bold>(B)</bold> Comparison between sample SFS (black line), average SFS under Moran A from 100 best (<italic>s, d</italic>) combinations (dark blue dots) and the best (<italic>s, d</italic>) combination (dark red dots). <bold>(C)</bold> Comparison between sample SFS (black line), average SFS under “binomial BP” (<italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25, <italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]) from 100 best (<italic>s, d</italic>) combinations (red dots) and the best (<italic>s, d</italic>) combination (dark red dots). Each SFS from Moran A or binomial BP is averaged from 1,000 simulations.</p></caption>
<graphic xlink:href="563302v2_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The range of best <italic>d</italic> parameter values does not vary among cases, with the G2 sample (<xref rid="fig7" ref-type="fig">Figure 7</xref>, panel A) having greater tolerance for changes in this parameter value. The impact of the <italic>s</italic> parameter on the SFS tail shape is significant: the range of the best fits varies between cases. The value of <italic>s</italic> is small for sample G2 (<xref rid="fig7" ref-type="fig">Figure 7</xref>, panel A) and slightly bigger for G32 (<xref rid="fig8" ref-type="fig">Figure 8</xref>, panel A). In the case of sample G41, the best fit was obtained using a relatively high <italic>s</italic> parameter value (<xref rid="fig9" ref-type="fig">Figure 9</xref>, panel A), indicating strong selection.</p>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8:</label>
<caption><p>Results from fitting the SFS from sample G32. <bold>(A)</bold> Heatmap of error between data SFS and average SFS for distinct (<italic>s, d</italic>) combinations in Moran A. Dark blue squares: 100 best (<italic>s, d</italic>) combinations, with linear regression. Dark red square: best (<italic>s, d</italic>) combination. <bold>(B)</bold> Comparison between sample SFS (black line), average SFS under Moran A from 100 best (<italic>s, d</italic>) combinations (dark blue dots) and the best (<italic>s, d</italic>) combination (dark red dots). <bold>(C)</bold> Comparison between sample SFS (black line), average SFS under “binomial BP” (<italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25, <italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]) from 100 best (<italic>s, d</italic>) combinations (red dots) and the best (<italic>s, d</italic>) combination (dark red dots). Each SFS from Moran A or binomial BP is averaged from 1,000 simulations.</p></caption>
<graphic xlink:href="563302v2_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig9" position="float" fig-type="figure">
<label>Figure 9:</label>
<caption><p>Results from fitting the SFS from sample G41. <bold>(A)</bold> Heatmap of error between data SFS and average SFS for distinct (<italic>s, d</italic>) combinations in Moran A. Dark blue squares: 100 best (<italic>s, d</italic>) combinations, with linear regression. Dark red square: best (<italic>s, d</italic>) combination. <bold>(B)</bold> Comparison between sample SFS (black line), average SFS under Moran A from 100 best (<italic>s, d</italic>) combinations (dark blue dots) and the best (<italic>s, d</italic>) combination (dark red dots). <bold>(C)</bold> Comparison between sample SFS (black line), average SFS under “binomial BP” (<italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25, <italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]) from 100 best (<italic>s, d</italic>) combinations (red dots) and the best (<italic>s, d</italic>) combination (dark red dots). Each SFS from Moran A or binomial BP is averaged from 1,000 simulations.</p></caption>
<graphic xlink:href="563302v2_fig9.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We compare the SFS from the 100 best (<italic>s, d</italic>) parameters against the breast cancer data-based SFS (<xref rid="fig7" ref-type="fig">Figures 7</xref>-<xref rid="fig9" ref-type="fig">9</xref>, panel B). The SFS from each sample is well fitted with Moran A, not only with the optimal parameter set but also with other (<italic>s, d</italic>) combinations. The fit is particularly good for the region of SFS with low frequency (<italic>f &lt;</italic> 0.2). There are exponentially fewer mutations occurring at larger <italic>f</italic>, resulting in relatively higher discrepancy in the long tail of the SFS from Moran A. However, the overall shape of the observed SFS can be fitted well by the Moran A model.</p>
<p>We also compare the SFS from the binomial BP (<italic>g</italic><sub>0</sub> = <italic>g</italic><sub>2</sub> = 0.25, <italic>N</italic> (<italic>t</italic><sub><italic>f</italic></sub>) <italic>∈</italic> [90, 110]), using the 100 best (<italic>s, d</italic>) parameters from Moran A inference (<xref rid="fig7" ref-type="fig">Figures 7</xref>-<xref rid="fig9" ref-type="fig">9</xref>, panel C). Similarly to Moran A, the SFS from BP can fit the shape of the observed SFS tail well. This is consistent with our finding from the previous section that the binomial BP with tight conditioning on the final population size behaves similarly to the Moran A model, resulting in similar statistics under a range of selection scenarios.</p>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Discussion and Conclusion</title>
<p>As it has been expected, Moran model A behaves comparably to the binomial BP conditioned on final population size being close to the initial count. This manifests in similar statistics under different extremes of selection scenarios (Section 3.1), including values that are observable in sequencing samples. Crucially, SFS fitting results for experimental breast cancer data (Section 3.2) are similar between the two models. This finding might hold mathematical importance, and requires further investigation. Moreover, interestingly, the similarity between Moran A and binomial BP becomes more pronounced as the latter is conditioned more tightly to resemble the constant population size expected in Moran models. When conditioned only on non-extinction, the population size of each BP realization may deviate significantly (<bold><xref rid="fig3" ref-type="fig">Figures 3</xref>-<xref rid="fig6" ref-type="fig">6G</xref></bold>). This leads to higher variances in allele and singleton counts (<bold><xref rid="fig3" ref-type="fig">Figures 3</xref>-<xref rid="fig6" ref-type="fig">6B-C, K-L</xref></bold>) as well as mutation and division/replacement counts (<bold><xref rid="fig3" ref-type="fig">Figures 3</xref>-<xref rid="fig5" ref-type="fig">5D-F, H-N</xref></bold>), although the means of these statistics remain similar (Appendix B, Tables 2-5). However, the high population size variance also results in different SFS in non-extinction BP compared to tightly conditioned BP and Moran model A (<bold><xref rid="fig3" ref-type="fig">Figures 3</xref>-<xref rid="fig6" ref-type="fig">6A</xref></bold>).</p>
<p>Our Moran model B, similar though not identical to the model introduced in [<xref ref-type="bibr" rid="c2">2</xref>], exhibits a phenomenon known as the drift barrier, which prevents the deleterious passenger mutations from dominating temporal trends in fitness, even under mutation-selection balance condition tipped in their favor (<italic>sp &lt; dq</italic>). Indeed, under this condition, due to drift, the fitness may decrease or increase depending on how much smaller <italic>sp</italic> is than <italic>dq</italic>. In addition, fitness generally increases at mutation-selection equilibrium (<italic>sp</italic> = <italic>dq</italic>). On the contrary, trends in Moran model A and binomial BP model follow the mutation-selection condition.</p>
<p>The effect of increasing fitness in model B was already predicted in [<xref ref-type="bibr" rid="c2">2</xref>] and described in [<xref ref-type="bibr" rid="c16">16</xref>]. While in Moran A fitness stays constant (as expected), in the case of Moran B, clones with higher fitness are favored, even for the same initial conditions and in absence of new mutations (see section 3.1.1 in [<xref ref-type="bibr" rid="c16">16</xref>]). This behavior results from the difference between Moran A and Moran B in the expected change in population fitness after a death-replacement event. As shown in <xref ref-type="disp-formula" rid="eqn4">Eqs. (4)</xref> and <xref ref-type="disp-formula" rid="eqn5">(5)</xref> in [<xref ref-type="bibr" rid="c16">16</xref>], the expected fitness change is 0 in Moran A and is <italic>≥</italic> 0 in Moran B. In general, fitness in Moran A depends only on the balance between drivers and passengers, while the trends in Moran B are more complex, as explained mathematically and confirmed by simulations in [<xref ref-type="bibr" rid="c2">2</xref>]. The drift and selection pattern in Moran B biases it toward increasing fitness.</p>
<p>Among the BP variations, the supercritical model behaves differently in all cases compared to other models, due to the difference in population size growth rate (<bold><xref rid="fig3" ref-type="fig">Figures 3</xref>-<xref rid="fig5" ref-type="fig">5G</xref></bold>). The only exception is the deleterious evolution setting, in which the impact of supercriticality is less prominent, since the fitness being close to zero means cells stop dividing. In this scenario all statistics are much more similar to those obtained from other models (Appendix C, <xref rid="tbl5" ref-type="table">Table 5</xref>).</p>
<p>Our experiments with different progeny cell count distributions in BP show that the fast BP always has higher variances in the population size throughout time compared to the binomial BP, even if similarly conditioned (<bold><xref rid="fig3" ref-type="fig">Figures 3</xref>-<xref ref-type="fig" rid="fig6">6G</xref></bold>). The fast BP also results in both less alleles and lower percentage of singletons within all alleles (<bold><xref rid="fig3" ref-type="fig">Figures 3</xref>-<xref ref-type="fig" rid="fig5">5B-C, K-L</xref></bold>). This is not observed in case of deleterious evolution (<bold><xref rid="fig6" ref-type="fig">Figure 6B-C, K-L</xref></bold>), where there is only a difference in the rate of reaching the steady state, which is the same as for other models. On the other hand, the averages of mutation and division/replacement event counts (<bold><xref rid="fig3" ref-type="fig">Figures 3-6D-F</xref></bold> and Appendix C, <xref rid="tbl2" ref-type="table">Table 2</xref>-<xref rid="tbl5" ref-type="table">5</xref>) do not differ from averages for Moran model A and binomial BP. Reversely, the population size in slow BP varies less, and the allele count and percentage of singleton count is much higher, compared to the binomial BP.</p>
<p>There are features shared between all Moran models and BP variations across different selection scenarios. The more division/replacement events occur during a simulation, the less alleles and singletons we observe both at the sampling time point as well as throughout tumor history. This is especially pronounced in case of deleterious evolution, where in Moran B continuously dividing population under selective pressure prevents the accumulation of singletons (<bold><xref rid="fig6" ref-type="fig">Figure 6B-C, K-L</xref></bold>). Conversely, if the events occurring during a simulation are dominantly mutations, then the population consists of more alleles and singletons. In conclusion, across models, higher selection is associated with less alleles and singletons, higher pace of allele death, and cumulative SFS with fat tail.</p>
<p>It seems relevant to note that the frequently cited reference by Gerrish and Lenski [<xref ref-type="bibr" rid="c11">11</xref>] introduces a model of competition in populations of constant size in an asexual population. From the reading of this corner-stone paper, it seems that it uses results from supercritical branching processes and then just scales them intuitively into the constant population size framework. This method seems not mathematically rigorous. Our comparison of Moran and branching process models identifies subtle but important differences between the two approaches. Overall, we have shown that the critical binomial BP and the Moran A model behave similarly in the Tug-of-War setting under distinct selection scenarios. This finding is relevant for improving simulating efficiency and optimizing model inference. Branching process and Moran model remain the two main stochastic modeling approaches in population genetics, where they provide the theoretical framework to uncover a tumor’s history from sequencing snapshots. However, BP simulation is considerably more time-consuming, as the cell population size can change arbitrarily due to random fluctuations. This problem is exacerbated in critical or near-critical BP, which is applicable for modeling many cancers. In this setting, the BP often has high probability of extinction, hence the high fraction of simulations that have to be discarded makes model inference computationally costly. In such cases, it would be more efficient to employ Moran A, which we have shown to provide comparable sample statistics and which is easier to implement. However, more work is needed to establish the theoretical equivalence between the Moran A model and the critical BP, and if this compatibility breaks down under certain conditions.</p>
<p>Both the Moran A model and the binomial BP can fit the SFS tail in our breast cancer samples well. However, the inference is complicated by a wide range of selection coefficients that result in equally comparable SFS to the data. These coefficients exhibit a trade-off between driver and passenger mutations, as the same SFS can result from driver mutations being more advantageous if the passenger mutations are also more deleterious, and vice versa. Therefore, the mutational SFS alone is not adequate to differentiate between these different selection settings. Separately, we found that the inference for all of our samples requires <italic>d &gt;</italic> 0, confirming the observations from McFarland et al. [<xref ref-type="bibr" rid="c19">19</xref>] that passenger mutations exhibit a deleterious effect during tumor progression.</p>
</sec>
</body>
<back>
<sec id="s5">
<title>Data availability</title>
<p>The breast cancer sequencing data can be found under <ext-link ext-link-type="uri" xlink:href="https://ega-archive.org/">https://ega-archive.org/</ext-link> with accession number: EGAD00001009081. Any queries should be directed to the corresponding author.</p>
</sec>
<sec id="s6">
<title>Funding</title>
<p>This research was funded by a subsidy for the maintenance and development of research potential BKM-581/RAU1/2023 (02/040/BKM23/1048) granted by the Polish Ministry of Science and Higher Education (M.K.K) and by Polish National Science Center grant 2021/41/B/NZ2/04134 (M.K.).</p>
<p>K.D. acknowledged the support from the Herbert and Florence Irving Institute for Cancer Dynamics and Department of Statistics at Columbia University.</p>
</sec>
<app-group>
<app id="app1">
<label>APPENDIX</label>
<sec id="s7">
<label>A</label>
<title>Elements of mathematical population genetics</title>
<sec id="s7a">
<label>A.1</label>
<title>Wright-Fisher model and Moran model comparison</title>
<sec id="s7a1">
<label>A1.1</label>
<title>Wright–Fisher model</title>
<p>There are two copies of each gene in a diploid cell. The copies can be of the same allele (e.g. <italic>AA</italic> or <italic>aa</italic>) or two different alleles (<italic>Aa</italic>). If the population consists of <italic>N</italic> diploid individuals, there exist 2<italic>N</italic> copies in total. In the accordance with Wright-Fisher model, in each generation random alleles are drawn with replacement from gene pool of size 2<italic>N</italic> – the generations do not overlap. Such reproduction scheme can be described mathematically as a discrete-time Markov chain – the future allele frequencies are dependent only on the present frequencies, not on those from past generations. Due to the randomness in the process, allele frequencies change at a rate which is inversely proportional to the population size. These fluctuations correspond to a process of genetic drift.</p>
<p>The state of the population in each generation can be described as the number of <italic>A</italic> alleles in the population, which can range from 0 (loss of allele <italic>A</italic>) to 2<italic>N</italic> (fixation of allele <italic>A</italic> and loss of allele <italic>a</italic>). The states 0 and 2<italic>N</italic> are called “absorbing states” because the population is not able to leave any of these (considering no mutation or migration events). In other cases, the transition probability can be calculated based on binomial distribution. In the population with <italic>i</italic> copies of allele <italic>A</italic>, the frequency of allele <italic>A</italic> is equal to <italic>p</italic> = <italic>i/</italic>2<italic>N</italic> and the frequency of allele <italic>a</italic> is <italic>q</italic> = 1 <italic>− p</italic>. The probability of changing state from <italic>i</italic> copies of <italic>A</italic> to <italic>j</italic> copies of <italic>A</italic> (for <italic>i, j</italic> = 0, 1, 2, …, 2<italic>N</italic>) in one generation is [<xref ref-type="bibr" rid="c13">13</xref>]:
<disp-formula id="eqn4">
<graphic xlink:href="563302v2_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
</sec>
</sec>
<sec id="s7b">
<title>Moran model</title>
<p>In the Moran model [<xref ref-type="bibr" rid="c21">21</xref>], in each step of algorithm, a single random allele <italic>x</italic> from haploid population of 2<italic>N</italic> individuals dies and is being “replaced” by another randomly chosen allele from the population (including <italic>x</italic> itself), thus ensuring that the population size remains constant. Unlike the Wright-Fisher model, where an allele can have up to 2<italic>N</italic> offspring, in the Moran model the allele can have 0 or 2 descendants. The time between birth-death events (the lifespan of an individual allele) is exponentially distributed with mean equal to 1 and generations do overlap.</p>
<p>As in the Wright-Fisher model, this reproduction scheme can be described mathematically by Markov chain. In this case, however, it is the continuous-time Markov chain with values in the set {0, 1, …, 2<italic>N }</italic>. Therefore, the mathematical solutions for the Moran model are easier to ascertain than the Wright-Fisher model. However, there are fewer time steps to be computed in the WrightFisher model. As a result, the simulations are more computationally convenient in the Wright-Fisher framework, compared to the Moran model. The Moran and Wright-Fisher models give qualitatively similar results, but genetic drift runs twice as fast in the Moran model [<xref ref-type="bibr" rid="c9">9</xref>].</p>
<p>The details regarding Moran model are described in section 2.1.</p>
</sec>
<sec id="s7c">
<label>A.2</label>
<title>Infinitely many alleles version of Wright-Fisher model</title>
<p>For neutrality testing purposes we consider the “infinitely many alleles” (IAM) version of the Wright-Fisher model. This type of model is particularly useful in molecular population genetics and was inspired by molecular nature of the gene. Average gene is sequence of 3000 nucleotides (A, G, T and C), so there are 4<sup>3000</sup> possible sequences (alleles), the number which for practical purposes can be taken as infinity, what leads to infinitely many alleles model.</p>
<p>Most nucleotide mutations will lead to sequences not currently existing in the population, so in this case all mutants are assumed to be of a new allelic type - there is no reverse mutation. In such a model each allele will sooner or later be lost from the population.</p>
</sec>
<sec id="s7d">
<label>A.2.1</label>
<title>Expected allele number</title>
<p>Under assumptions of the IAM, let us define <bold>A</bold> = (<italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, …, <italic>A</italic><sub><italic>n</italic></sub>) as the vector of the allelic types each of which is represented by exactly <italic>j</italic> genes in the sample. The following Ewens Sampling Formula (ESF) was derived in [<xref ref-type="bibr" rid="c10">10</xref>] and [<xref ref-type="bibr" rid="c14">14</xref>]
<disp-formula id="eqn5">
<graphic xlink:href="563302v2_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
with
<disp-formula id="ueqn4">
<graphic xlink:href="563302v2_ueqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Furthermore, the probability distribution of number <italic>K</italic> of different alleles in the sample has the form
<disp-formula id="eqn6">
<graphic xlink:href="563302v2_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Under neutrality <italic>θ</italic> = <italic>nμ</italic>, where <italic>μ</italic> denotes mutation coefficient and <italic>n</italic> is the sample size. <inline-formula><inline-graphic xlink:href="563302v2_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula>is the absolute value of a Stirling number of the first kind. The expression for the expected value of <italic>K</italic> can be derived from Equ. (6)
<disp-formula id="eqn7">
<graphic xlink:href="563302v2_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
with the corresponding expression for variance of <italic>K</italic>
<disp-formula id="eqn8">
<graphic xlink:href="563302v2_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<xref ref-type="disp-formula" rid="eqn5">Equations (5)</xref> and <xref ref-type="disp-formula" rid="eqn6">(6)</xref> show jointly that the conditional distribution of the vector <bold>A</bold> = (<italic>A</italic><sub>1</sub>, <italic>A</italic><sub>2</sub>, …<italic>A</italic><sub><italic>n</italic></sub>), given the value of <italic>K</italic>, is
<disp-formula id="eqn9">
<graphic xlink:href="563302v2_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <bold>a</bold> = (<italic>a</italic><sub>1</sub>, <italic>a</italic><sub>2</sub>, …, <italic>a</italic><sub><italic>n</italic></sub>). From (9) the procedure can be derived, which allows testing the null hypothesis that the alleles in the sample are selectively equivalent (neutral).</p>
</sec>
</sec>
<sec id="s8">
<label>B</label>
<title>Statistics in Section 3.1</title>
<p><xref rid="tbl2" ref-type="table">Tables 2</xref>, <xref rid="tbl3" ref-type="table">3</xref>, <xref rid="tbl4" ref-type="table">4</xref>, <xref rid="tbl5" ref-type="table">5</xref> contain some statistics for <xref rid="fig3" ref-type="fig">Figures. 3</xref>, <xref rid="fig4" ref-type="fig">4</xref>, <xref rid="fig5" ref-type="fig">5</xref>, <xref rid="fig6" ref-type="fig">6</xref>, respectively. The models are named according to their colors in the figures, which are listed in legend for <xref rid="tbl2" ref-type="table">Table 2</xref> along with the statistics.</p>
</sec>
</app>
</app-group>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="book"><string-name><given-names>Krishna B</given-names> <surname>Athreya</surname></string-name>, <string-name><given-names>Peter E</given-names> <surname>Ney</surname></string-name>, and <string-name><given-names>PE</given-names> <surname>Ney</surname></string-name>. <source>Branching processes</source>. <publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>, <year>1972</year>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><string-name><given-names>Adam</given-names> <surname>Bobrowski</surname></string-name>, <string-name><given-names>Marek</given-names> <surname>Kimmel</surname></string-name>, <string-name><given-names>Monika K</given-names> <surname>Kurpas</surname></string-name>, and <string-name><given-names>Elżbieta</given-names> <surname>Ratajczyk</surname></string-name>. <article-title>Moran process version of the tug-of-war model: Behavior revealed by mathematical analysis and simulation studies</article-title>. <source>Discrete and Continuous Dynamical Systems-B</source>, <volume>28</volume>(<issue>8</issue>):<fpage>4532</fpage>–<lpage>4563</lpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><string-name><given-names>Conrad J</given-names> <surname>Burden</surname></string-name> and <string-name><given-names>Helmut</given-names> <surname>Simon</surname></string-name>. <article-title>Genetic drift in populations governed by a Galton– Watson branching process</article-title>. <source>Theoretical population biology</source>, <volume>109</volume>:<fpage>63</fpage>–<lpage>74</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="other"><string-name><given-names>Alexander MG</given-names> <surname>Cox</surname></string-name>, <string-name><given-names>Emma</given-names> <surname>Horton</surname></string-name>, and <string-name><given-names>Denis</given-names> <surname>Villemonais</surname></string-name>. <article-title>Binary branching processes with Moran type interactions</article-title>. <source>arXiv preprint</source> <pub-id pub-id-type="arxiv">2207.03323</pub-id>, <year>2022</year>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><string-name><given-names>Krzysztof A</given-names> <surname>Cyran</surname></string-name> and <string-name><given-names>Marek</given-names> <surname>Kimmel</surname></string-name>. <article-title>Alternatives to the Wright–Fisher model: The robustness of mitochondrial Eve dating</article-title>. <source>Theoretical Population Biology</source>, <volume>78</volume>(<issue>3</issue>):<fpage>165</fpage>–<lpage>172</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><given-names>David</given-names> <surname>Dingli</surname></string-name>, <string-name><given-names>Arne</given-names> <surname>Traulsen</surname></string-name>, and <string-name><given-names>Franziska</given-names> <surname>Michor</surname></string-name>. <article-title>(A)symmetric stem cell replication and cancer</article-title>. <source>PLoS computational biology</source>, <volume>3</volume>(<issue>3</issue>):<fpage>e53</fpage>, <year>2007</year>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><given-names>Miklos</given-names> <surname>Diossy</surname></string-name>, <string-name><given-names>Zsofia</given-names> <surname>Sztupinszki</surname></string-name>, <string-name><given-names>Marcin</given-names> <surname>Krzystanek</surname></string-name>, <string-name><given-names>Judit</given-names> <surname>Borcsok</surname></string-name>, <string-name><given-names>Aron C</given-names> <surname>Eklund</surname></string-name>, <string-name><given-names>István</given-names> <surname>Csabai</surname></string-name>, <string-name><given-names>Anders Gorm</given-names> <surname>Pedersen</surname></string-name>, and <string-name><given-names>Zoltan</given-names> <surname>Szallasi</surname></string-name>. <article-title>Strand Orientation Bias Detector to determine the probability of FFPE sequencing artifacts</article-title>. <source>Briefings in Bioinformatics</source>, <volume>22</volume>(<issue>6</issue>):<fpage>bbab186</fpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><given-names>Hongdo</given-names> <surname>Do</surname></string-name> and <string-name><given-names>Alexander</given-names> <surname>Dobrovic</surname></string-name>. <article-title>Sequence artifacts in DNA from formalin-fixed tissues: causes and strategies for minimization</article-title>. <source>Clinical chemistry</source>, <volume>61</volume>(<issue>1</issue>):<fpage>64</fpage>–<lpage>71</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="book"><string-name><given-names>Richard</given-names> <surname>Durrett</surname></string-name>. <source>Probability models for DNA sequence evolution</source>. <publisher-name>Springer</publisher-name>, <year>2008</year>.</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><string-name><given-names>Warren J</given-names> <surname>Ewens</surname></string-name>. <article-title>The sampling theory of selectively neutral alleles</article-title>. <source>Theoretical population biology</source>, <volume>3</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>112</lpage>, <year>1972</year>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><string-name><given-names>Philip J</given-names> <surname>Gerrish</surname></string-name> and <string-name><given-names>Richard E</given-names> <surname>Lenski</surname></string-name>. <article-title>The fate of competing beneficial mutations in an asexual population</article-title>. <source>Genetica</source>, <volume>102</volume>:<fpage>127</fpage>, <year>1998</year>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><string-name><given-names>Christopher</given-names> <surname>Greenman</surname></string-name>, <string-name><given-names>Philip</given-names> <surname>Stephens</surname></string-name>, <string-name><given-names>Raffaella</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>Gillian L</given-names> <surname>Dalgliesh</surname></string-name>, <string-name><given-names>Christopher</given-names> <surname>Hunter</surname></string-name>, <string-name><given-names>Graham</given-names> <surname>Bignell</surname></string-name>, <string-name><given-names>Helen</given-names> <surname>Davies</surname></string-name>, <string-name><given-names>Jon</given-names> <surname>Teague</surname></string-name>, <string-name><given-names>Adam</given-names> <surname>Butler</surname></string-name>, <string-name><given-names>Claire</given-names> <surname>Stevens</surname></string-name>, <etal>et al.</etal> <article-title>Pat-terns of somatic mutation in human cancer genomes</article-title>. <source>Nature</source>, <volume>446</volume>(<issue>7132</issue>):<fpage>153</fpage>–<lpage>158</lpage>, <year>2007</year>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="book"><string-name><given-names>Daniel L</given-names> <surname>Hartl</surname></string-name>, <string-name><given-names>Andrew G</given-names> <surname>Clark</surname></string-name>, and <string-name><given-names>Andrew G</given-names> <surname>Clark</surname></string-name>. <source>Principles of population genetics</source>, volume <volume>116</volume>. <publisher-name>Sinauer associates Sunderland, MA</publisher-name>, <year>1997</year>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><string-name><given-names>Samuel</given-names> <surname>Karlin.</surname></string-name> <article-title>Addendum to a paper of W. Ewens</article-title>. <source>Theor. Popul. Biol</source>., <volume>3</volume>:<fpage>113</fpage>–<lpage>116</lpage>, <year>1972</year>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="book"><string-name><given-names>M</given-names> <surname>Kimmel</surname></string-name> and <string-name><surname>Axelrod</surname> <given-names>DE</given-names></string-name>. <source>Branching processes in biology</source>, <edition>2nd</edition> Ed. <publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>, <year>2015</year>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><given-names>Monika K</given-names> <surname>Kurpas</surname></string-name> and <string-name><given-names>Marek</given-names> <surname>Kimmel</surname></string-name>. <article-title>Modes of selection in tumors as reflected by two mathematical models and site frequency spectra</article-title>. <source>Frontiers in Ecology and Evolution</source>, <volume>10</volume>, <year>2022</year>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><string-name><given-names>Monika Klara</given-names> <surname>Kurpas</surname></string-name>, <string-name><given-names>Roman</given-names> <surname>Jaksik</surname></string-name>, <string-name><given-names>Pawel</given-names> <surname>Kuś</surname></string-name>, and <string-name><given-names>Marek</given-names> <surname>Kimmel</surname></string-name>. <article-title>Genomic analysis of SARS-CoV-2 Alpha, Beta and Delta Variants of Concern uncovers signatures of neutral and non-neutral evolution</article-title>. <source>Viruses</source>, <volume>14</volume>(<issue>11</issue>):<fpage>2375</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><string-name><given-names>Christopher D</given-names> <surname>McFarland</surname></string-name>, <string-name><given-names>Leonid A</given-names> <surname>Mirny</surname></string-name>, and <string-name><given-names>Kirill S</given-names> <surname>Korolev</surname></string-name>. <article-title>Tug-of-war between driver and passenger mutations in cancer and other adaptive processes</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>111</volume>(<issue>42</issue>):<fpage>15138</fpage>–<lpage>15143</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><string-name><given-names>Christopher D</given-names> <surname>McFarland</surname></string-name>, <string-name><given-names>Julia A</given-names> <surname>Yaglom</surname></string-name>, <string-name><given-names>Jonathan W</given-names> <surname>Wojtkowiak</surname></string-name>, <string-name><given-names>Jacob G</given-names> <surname>Scott</surname></string-name>, <string-name><given-names>David L</given-names> <surname>Morse</surname></string-name>, <string-name><given-names>Michael Y</given-names> <surname>Sherman</surname></string-name>, and <string-name><given-names>Leonid A</given-names> <surname>Mirny</surname></string-name>. <article-title>The damaging effect of passenger mutations on cancer progression</article-title>. <source>Cancer Research</source>, <volume>77</volume>(<issue>18</issue>):<fpage>4763</fpage>–<lpage>4772</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="other"><string-name><given-names>Christopher Dennis</given-names> <surname>McFarland</surname></string-name>. <article-title>The role of deleterious passengers in cancer</article-title>. <source>PhD thesis</source>, <year>2014</year>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="other"><string-name><given-names>Patrick Alfred Pierce</given-names> <surname>Moran</surname></string-name> <etal>et al.</etal> <article-title>The statistical processes of evolutionary theory</article-title>. <source>The statistical processes of evolutionary theory</source>., <year>1962</year>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.94597.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Flegg</surname>
<given-names>Jennifer</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>The University of Melbourne</institution>
</institution-wrap>
<city>Melbourne</city>
<country>Australia</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Inadequate</kwd>
<kwd>Incomplete</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study uses numerical simulations to characterize and compare variants of two widely used mathematical models and then applies those models to inferring evolutionary parameters from breast cancer data. The copious numerical results will be of some interest to mathematical biologists working with similar models. The finding that many breast cancer mutations are mildly deleterious is <bold>valuable</bold> but the evidence supporting this claim is <bold>incomplete</bold> because the mathematical modelling and statistical methods are insufficiently justified and <bold>inadequately</bold> validated.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.94597.1.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This paper can be seen as an extension of a recent study by two of the same authors [1]. In the previous paper, the authors considered two variants of the Moran process, labelled Model A and Model B, and examined differences between the evolutionary dynamics of these two models. They further described the site frequency spectra, expected allele counts, and expected singleton counts of these models, building on analytical results from prior studies, and used numerical simulations to investigate the models' evolutionary dynamics. Finally, they compared the site frequency spectra of the two models (using numerical simulations) to spectra derived from a small breast cancer data set (two sets of three samples).</p>
<p>In the new paper, the authors consider the same two Moran process variants (Model A and Model B) and some related branching processes. As before, they compare the site frequency spectra and various summary statistics of these models, but here they present only numerical simulations (except that some prior analytical results are summarized in Appendix A, which are never referred to in the main text and seem unconnected to the study). They then compare the site frequency spectra of these models (again using numerical simulations) to those derived from the same breast cancer samples as before and thus infer some evolutionary parameters.</p>
<p>The first main conclusion is that the critical branching process and the Moran process models behave similarly and generate similar site frequency spectra. This finding is unsurprising (indeed, the authors acknowledge that the result &quot;has been expected&quot;). For a reasonably large population size, the population size in the critical branching process has been shown to vary relatively little over time and the model is thus essentially a continuous time Moran process (see, for example, Equation 8.55 in ref 2). Nor is it surprising that the authors see stronger similarities when they select only the subset of branching process replicates in which the final population size is particularly close to the initial population size (this is because, in these replicates, the population size likely varies even less than usual).</p>
<p>The second main conclusion is that, although &quot;the mutational SFS alone is not adequate&quot; to quantify the strength of selection, &quot;All fitted values for the selective disadvantage of passenger mutations are nonzero, supporting the view that they exert deleterious selection during tumorigenesis&quot;. Although the question of whether mildly deleterious mutations play an important role in cancer evolution is of considerable interest, it's debatable whether the results presented here help resolve the issue.</p>
<p>Many prominent researchers have called into question whether cancer evolutionary parameters can be reliably inferred from site frequency spectra (e.g., [3-7]), even using sophisticated statistical methods. The statistical approach used here (though not named as such in the paper) is a crude kind of approximate Bayesian computation. To improve the accuracy of the results, it would have been better to have set reasonably vague priors for the uncertain mutation rates, rather than fixing them arbitrarily. It would also have been better to have chosen a likelihood function explicitly based on an analysis of the sampling and error distributions, rather than just summing the absolute logged deviations. It is well known that &quot;Checking the model is crucial to statistical analysis&quot; and &quot;A good Bayesian analysis, therefore, should include at least some check of the adequacy of the fit of the model to the data and the plausibility of the model for the purposes for which the model will be used&quot; [8]. The authors' failure to describe any attempt to validate or check their model, using simulated data or otherwise, casts doubt on the reliability of their inferences.</p>
<p>Putting aside the potential biassing effects of sampling error, measurement error, and the limitations of the authors' statistical method, it is well established that both population growth and spatial structure profoundly alter the shape of site frequency spectra in ways that can mimic the effects of selection (e.g. [9-11]). Indeed, Figures 3, 4 and 5 show that the critical and super-critical branching processes generate markedly different site frequency spectra. It follows that if the population dynamics and spatial structure of the mathematical model used for inference don't match those of the biological process that produced the data then any inferred evolutionary parameter values will be unreliable. Breast cancer has two indisputable ecological features that shape its evolutionary dynamics: the cell population expands by many orders of magnitude from a single cell, and the population is spatially structured. In the authors' mathematical model, the population size is initially 100 cells and either remains constant or varies little, and there is no spatial structure. These profound mismatches between model and data cast further doubt on what is supposed to be the paper's most important biological finding.</p>
<p>In this paper the authors offer no justification for their decision to model breast cancer as a non-growing, non-spatial cell population. Nor do they engage with the extensive recent literature on the challenges of inferring evolutionary parameters from cancer site frequency spectra (they cite none of the many relevant papers listed at <ext-link ext-link-type="uri" xlink:href="https://www.sottorivalab.org/neutral-evolution.html">https://www.sottorivalab.org/neutral-evolution.html</ext-link>). Their 2022 paper [1] claims that, &quot;it sometimes makes sense to consider cancer growth in the framework of constant-population models. Our models correspond to the situation in which a constant population of N &quot;healthy&quot; stem cells is gradually replaced by a growing clone of transformed cells with increasing fitness.&quot; No evidence was presented to support this hypothesis regarding breast cancer progression. On the other hand, a wealth of evidence supports the consensus view that, in breast cancer and other human solid tumours, the number of cells with unlimited proliferative potential is several orders of magnitude greater than 100 and grows over time (e.g. [12]).</p>
<p>Analytic expressions for the site frequency spectra with neutral mutations are already known. It is well known that the site frequency spectrum of an exponentially growing population has a tail following a power law S_k ~ k^(-2) [13, 14]. Similarly, it is known that for the critical branching process or the Moran process, the site frequency spectrum at equilibrium is S_k ~ k^(-1) [13, 15]. Especially noteworthy yet uncited studies that use those results about site frequency spectra to make inferences based on sequencing data include ref 16, in which selection is inferred, and ref 17, in which evolutionary parameters of constant populations (healthy cell populations) are inferred.</p>
<p>Although the paper is well written, the figures are ineffective in communicating the results. As others have put it, &quot;A figure is meant to express an idea or introduce some facts or a result that would be too long (or nearly impossible) to explain only with words&quot; and &quot;If your figure is able to convey a striking message at first glance, chances are increased that your article will draw more attention from the community&quot; [18]. On the contrary, Figures 3, 4, 5 and 6 are bewilderingly complicated, crowded, and repetitive. These figures comprise no fewer than fifty-six plots, each containing numerous curves or histograms, spread across four pages. To compare the results of different scenarios, the reader is presumably expected to put these figures side by side and try to spot the differences, hampered by inconsistent axis ranges, absence of axis labels, absence of titles, absence of legends, and unreliable captions (&quot;cyan&quot; seems to refer to pale blue, and &quot;orange&quot; to something closer to red). For example, the only notable difference between Figures 3 and 4 is in the shape of a single green curve in panel I. In the main text of a published paper, one would expect fewer, more carefully curated figures drawing attention to salient features, so that the reader can infer the main results with minimal effort. The rest can be put in supplementary figures.</p>
<p>In summary, this paper adds somewhat to our understanding of some standard mathematical models; whether it tells us anything new about cancer is open to debate.</p>
<p>References</p>
<p>
(1) Kurpas, Monika K., and Marek Kimmel. &quot;Modes of selection in tumors as reflected by two mathematical models and site frequency spectra.&quot; Frontiers in Ecology and Evolution 10 (2022): 889438.</p>
<p>
(2) Bailey, Norman TJ. The elements of stochastic processes with applications to the natural sciences. John Wiley &amp; Sons, 1964.</p>
<p>
(3) Tarabichi, Maxime, et al. &quot;Neutral tumor evolution?.&quot; Nature Genetics 50.12 (2018): 1630-1633.</p>
<p>
(4) McDonald, Thomas O., Shaon Chakrabarti, and Franziska Michor. &quot;Currently available bulk sequencing data do not necessarily support a model of neutral tumor evolution.&quot; Nature Genetics 50.12 (2018): 1620-1623.</p>
<p>
(5) Balaparya, Abdul, and Subhajyoti De. &quot;Revisiting signatures of neutral tumor evolution in the light of complexity of cancer genomic data.&quot; Nature Genetics 50.12 (2018): 1626-1628.</p>
<p>
(6) Noorbakhsh, Javad, and Jeffrey H. Chuang. &quot;Uncertainties in tumor allele frequencies limit power to infer evolutionary pressures.&quot; Nature Genetics 49.9 (2017): 1288-1289.</p>
<p>
(7) Bozic, Ivana, Chay Paterson, and Bartlomiej Waclaw. &quot;On measuring selection in cancer from subclonal mutation frequencies.&quot; PLoS Computational Biology 15.9 (2019): e1007368.</p>
<p>
(8) Neher, Richard A., and Oskar Hallatschek. &quot;Genealogies of rapidly adapting populations.&quot; Proceedings of the National Academy of Sciences 110.2 (2013): 437-442.</p>
<p>
(9) Gelman, Andrew, et al. Bayesian data analysis (Third Edition). Chapman and Hall/CRC, 2014.</p>
<p>
(10) Fusco, Diana, et al. &quot;Excess of mutational jackpot events in expanding populations revealed by spatial Luria-Delbrück experiments.&quot; Nature Communications 7.1 (2016): 12760.</p>
<p>
(11) Noble, Robert, et al. &quot;Spatial structure governs the mode of tumour evolution.&quot; Nature Ecology &amp; Evolution 6.2 (2022): 207-217.</p>
<p>
(12) Lawson, Devon A., et al. &quot;Single-cell analysis reveals a stem-cell program in human metastatic breast cancer cells.&quot; Nature 526.7571 (2015): 131-135.</p>
<p>
(13) Gunnarsson, Einar B., Leder, Kevin, and Foo Jasmine. &quot;Exact site frequency spectra of neutrally evolving tumors: A transition between power laws reveals a signature of cell viability&quot; Theoretical Population Biology 142 (2021) 67-90</p>
<p>
(14) Durrett, Richard &quot;Branching Process Models of Cancer&quot; Springer (2015)</p>
<p>
(15) Durrett, Richard &quot;Probability Models for DNA Sequence Evolution&quot; Springer Science &amp; Business media (2008)</p>
<p>
(16) Williams, Mark J. et al. &quot;Quantification of subclonal selection in cancer from bulk sequencing data.&quot; Nature Genetics 50 (6). 895-903 (2018)</p>
<p>
(17) Moeller, Marius E. et al. &quot;Measures of genetic diversification in somatic tissues at bulk and single-cell resolution&quot; eLife (2024) 12:RP89780</p>
<p>
(18) Rougier, Nicolas P., Michael Droettboom, and Philip E. Bourne. &quot;Ten simple rules for better figures.&quot; PLoS Computational Biology 10.9 (2014): e1003833.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.94597.1.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this manuscript, the authors present a comparison of two models of cancer evolution with advantageous drivers and deleterious passengers: a fixed-population &quot;Moran&quot; model, and a &quot;Branching Process&quot; (BP) model with dynamic population size. The Moran model is more mathematically-tractable, but since cancer is a disease of uncontrolled growth, it is unclear to me how clinically-relevant it is to consider a model with constant population size. Intriguingly, both models can explain observed Site Frequency Spectrums (SFSs) in three breast cancers, which suggests that the Moran model may have some value. This distinction between the two models is addressed well.</p>
<p>Strengths:</p>
<p>The comparisons of the various BP models (extinction/non-extinction, and balanced/supercritical) are very interesting. The survivability of rare, fitness-disadvantaged clones has huge implications for treatment resistance in general - drug resistant clones are very often disadvantaged in the absence of drug. Clinical sequencing is, most decidedly, investigating population dynamics conditioned on non-extinction, however most published models do not condition on non-extinction - an unfortunate community oversight that this publication rectifies.</p>
<p>Site Frequency Spectrums in three breast cancers are measured with unprecedented resolution to my knowledge (allele abundances below one in a thousand).</p>
<p>Detailed description of the behavior of the various models.</p>
<p>Weaknesses:</p>
<p>I do not believe Moran B is a useful theoretical distinction between Moran A. Incorporating fitness effects into the birth process, instead of the death process, is generally mathematically equivalent when time is measured in generations (or cell divisions). Visible differences in the two models in Figures 2-6 by all accounts seem to be due to the fact that Moran B experiences more evolution in the balanced/driver-dominated case, and less evolution in the passenger dominated case. We generally do not use arbitrary time steps for this reason - we quantify time in 'generations'.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.94597.1.sa3</article-id>
<title-group>
<article-title>Author Response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Dinh</surname>
<given-names>Khanh N.</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0010-4251</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Kurpas</surname>
<given-names>Monika K.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kimmel</surname>
<given-names>Marek</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p><bold>eLife assessment</bold></p>
<p>We thank the Editors for identifying qualified reviewers. We agree that the “evidence supporting this claim (that ‘many breast cancer mutations are mildly deleterious’) is incomplete”. Much more detail is needed to state this decisively and we do not claim completeness here. As far as validation, we carried out synthetic testing of the models as suggested by Reviewer #1 and the results seem good.</p>
<p><bold>Reviewer #1:</bold></p>
<p>We thank the Reviewer for a very thorough examination of not only the current paper but also our previous paper. We agree that the illustration material can be overwhelming and we plan to use the Reviewer’s advice in that matter. In addition, we originally put some textbook material in the Appendix, and arguably some of it may be considered superfluous.</p>
<p>Most of the references the Reviewer provides are known to us, although it is likely we should cite and discuss more. All of the above will be included in the revision we are planning.</p>
<p>The Reviewer is certainly correct that population growth and spatial effects play a major role in cancer. However, the effects of constraining environment are quite strong and the reality lies somewhere between the Moran and branching process models; exactly what we attempt to clarify. As for spatial effects, most tumors extracted in clinic are dissected in bulk and sub-sampling is rare, so the spatial information is rarely accessible.</p>
<p>The subsequent point of importance concerns the weak specificity of the site frequency spectra (SFS) with respect to the underlying genetic and demographic forces. This cannot be denied. However, we just meant to state that our SFS are consistent with a model involving slightly deleterious passengers.</p>
<p>Regarding the validation of the estimation procedures which is a point well-taken, we carried out synthetic testing of the models as suggested by Reviewer #1 and the results seem good. This will be discussed in full in the revision.</p>
<p>In our view, the most important remark is the one concerning scaling of the models. The Reviewer is certainly correct that 100 stem cells are insufficient to drive a realistic tumor. However, what we had in mind but not explained sufficiently, is that a sample of 100 cells corresponds to average-depth coverage in bulk sequencing. Therefore, the strict interpretation is that the model mirrors what is observed in the sample. A more accurate approach would be to up-scale the model and then sample 100 cells from it. The Moran-type model can be up-scaled using diffusion approximation, and we hope to include these computations in the revision. The associated criticism concerning tumor growth seems less relevant, since we experimented with less or more stringent constraints in our models.</p>
<p><bold>Reviewer #2:</bold></p>
<p>We thank Reviewer #2 for studying our paper and some very positive comments. Among others, the Reviewer underscores the fact that the Moran-type model generates SFS concordant with the data (with all necessary reservations). The Reviewer concurs with us that conditioning on non-extinction is not very common in the literature, while it should be.</p>
<p>Similarly as the Reviewer, we are somewhat puzzled by the differences in behavior between models A and B. Model B seems more parsimonious, but Model A looks more similar to the critical or slightly supercritical branching process. We will work to clarify these observations.</p>
</body>
</sub-article>
</article>