<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">96627</article-id>
<article-id pub-id-type="doi">10.7554/eLife.96627</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.96627.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.5</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Spatial periodicity in grid cell firing is explained by a neural sequence code of 2-D trajectories</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7700-4312</contrib-id>
<name>
<surname>RG</surname>
<given-names>Rebecca</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0964-676X</contrib-id>
<name>
<surname>Ascoli</surname>
<given-names>Giorgio A</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sutton</surname>
<given-names>Nate M</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0340-0128</contrib-id>
<name>
<surname>Dannenberg</surname>
<given-names>Holger</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<email>hdannenb@gmu.edu</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jqj7156</institution-id><institution>Department of Mathematical Sciences, George Mason University</institution></institution-wrap>, <city>Fairfax</city>, <country country="US">United States</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02jqj7156</institution-id><institution>Department of Bioengineering, George Mason University</institution></institution-wrap>, <city>Fairfax</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Peyrache</surname>
<given-names>Adrien</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>McGill University</institution>
</institution-wrap>
<city>Montreal</city>
<country>Canada</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Colgin</surname>
<given-names>Laura L</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Texas at Austin</institution>
</institution-wrap>
<city>Austin</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-06-05">
<day>05</day>
<month>06</month>
<year>2024</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-04-24">
<day>24</day>
<month>04</month>
<year>2025</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP96627</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-02-16">
<day>16</day>
<month>02</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-02-17">
<day>17</day>
<month>02</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.05.30.542747"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-06-05">
<day>05</day>
<month>06</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.96627.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.96627.1.sa3">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.96627.1.sa2">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.96627.1.sa1">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.96627.1.sa0">Reviewer #3 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, RG et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>RG et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-96627-v2.pdf"/>
<abstract>
<title>Abstract</title><p>Spatial periodicity in grid cell firing has been interpreted as a neural metric for space providing animals with a coordinate system in navigating physical and mental spaces. However, the specific computational problem being solved by grid cells has remained elusive. Here, we provide mathematical proof that spatial periodicity in grid cell firing is the only possible solution to a neural sequence code of 2-D trajectories and that the hexagonal firing pattern of grid cells is the most parsimonious solution to such a sequence code. We thereby provide a likely teleological cause for the existence of grid cells and reveal the underlying nature of the global geometric organization in grid maps as a direct consequence of a simple local sequence code. A sequence code by grid cells provides intuitive explanations for many previously puzzling experimental observations and may transform our thinking about grid cells.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>grid cells</kwd>
<kwd>cell sequences</kwd>
<kwd>path integration</kwd>
<kwd>trajectory coding</kwd>
</kwd-group>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Edited in response to peer-review comments.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<sec id="s1a">
<title>What is the nature of the problem being solved by grid cells?</title>
<p>Grid cells in the medial entorhinal cortex (MEC)<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref></sup> and adjacent regions such as the pre- and parasubiculum<sup><xref ref-type="bibr" rid="c3">3</xref></sup> are hypothesized to supply a “spatial metric” for cognitive map-based navigation and path integration<sup><xref ref-type="bibr" rid="c4">4</xref>–<xref ref-type="bibr" rid="c6">6</xref></sup>, episodic memory<sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c9">9</xref></sup>, and navigating abstract feature spaces<sup><xref ref-type="bibr" rid="c10">10</xref>–<xref ref-type="bibr" rid="c12">12</xref></sup>. Grid cells recorded in freely foraging animals fire at multiple locations in space so that the firing fields form a hexagonal lattice (<xref rid="fig1" ref-type="fig">Figures 1A</xref> – <xref rid="fig1" ref-type="fig">1D</xref>). Since their first discovery, the remarkable spatial periodicity in grid cell firing has been a topic of intense research<sup><xref ref-type="bibr" rid="c6">6</xref></sup>. This research was fueled in part by awe of the beautiful symmetry and complexity displayed in the spatial firing pattern of a single cell. Moreover, research efforts were driven by the hope that understanding the underlying nature of grid cell firing would greatly advance our understanding of how the mammalian brain performs navigational computations and higher cognitive functions such as episodic memory.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Spatially periodic firing of grid cells in 2-D space emerges from a neural sequence code of trajectories.</title>
<p><bold>A,</bold> Schematic drawing of a 1 x 1 m<sup>2</sup> environment surrounded by walls in the presence of a single visual cue card. <bold>B,</bold> Trajectory plot visualizing grid cell spiking activity as a function of the animal’s location in space. Data obtained from the medial entorhinal cortex of a freely foraging mouse<sup><xref ref-type="bibr" rid="c45">45</xref>,<xref ref-type="bibr" rid="c99">99</xref></sup>. The black line indicates the path taken by the animal. Red dots indicate the locations where action potentials (spikes) were generated by the grid cell. <bold>C,</bold> Firing rate map of the spiking data shown in A. Data are visualized as 3 x 3 cm<sup>2</sup> spatial bins, smoothed with a Gaussian kernel. Red and blue colors indicate high and low firing rates. Peak and average firing rates are 15 and 1.9 Hz. <bold>D,</bold> Spatial autocorrelogram of the data shown in B. Red and blue colors indicate high and low correlation values. <bold>E,</bold> The animal’s current position and velocity determine the animal’s trajectory. In a sequence code, directions are represented by pairs of sequentially active cell assemblies with non-overlapping cellular composition. We refer to the individual members in a set of completely distinct cell assemblies as <italic>elements</italic>. The red circle represents the currently active element. The next active element in the sequence code is <italic>uniquely</italic> determined by the currently active cell and the velocity vector (Definition 8). N = North, NE = Northeast, NW = Northwest, W = West, SW = Southwest, and SE = Southeast. <bold>F,</bold> Elements’ firing fields that surround each other symmetrically in a hexagonal lattice packing allow for equal angular resolution in the coding of trajectories by cell sequences. Colors represent distinct elements. <bold>G</bold>, If <bold>an elements</bold>’ firing field was surrounded by fewer or more than six firing fields that touched each other, opposite directions would not be represented at the same angular resolution. In this example, <italic>east</italic> è <italic>west</italic> cannot be distinguished from <italic>east</italic> è <italic>northwest</italic> and <italic>east</italic> è <italic>southwest</italic> because the three directions are represented by the same sequence of elements, <italic>yellow</italic> è <italic>red</italic>. However, the opposite direction, <italic>west</italic> è <italic>east</italic>, is represented by three different cell sequences allowing for a finer angular resolution in the representation of traveling direction. <bold>H,</bold> Example of possible pairs of elements creating a sequence code. If the sequence code shall represent all directions with equal angular resolution, the cellular composition of sequentially active cell assemblies needs to be completely distinct every 60 degrees (E and F). Possible representations of velocity vectors by sequences of two elements are shown for when the currently active element is #1 or #2. Numbers within circles identify distinct elements. <bold>I,</bold> Example of a complete sequence code that uniquely represents all directions at 60 degrees resolution as a function of the currently active element and the traveling direction. <bold>J,</bold> Sequential activation of seven distinct elements can code for infinitively long trajectories along all three major axes of a hexagonal lattice. <bold>K,</bold> The same sequential activation map as in I and J but plotted in 2-D space. Note that the firing fields of individual elements form grid maps in 2-D space, as highlighted in grey for element #1.</p></caption>
<graphic xlink:href="542747v5_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>However, no theory exists to date that explains the emergence of grid cell firing patterns from basic principles, unifying the many seemingly unconnected experimental observations on periodic firing patterns and their distortions in a single framework<sup><xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>. Consequently, currently existing mechanistic models of grid cell firing fall short of explaining the basic question of <italic>why</italic> grid cells exist in the first place. Most previous studies on grid cell function follow a traditional approach based on the well-founded assertion in biology that structure determines function. This approach has resulted in a vast literature describing properties of grid cells in multiple species, how these properties depend on internal neural circuit dynamics and external cues, and how grid cell dynamics can be employed for computational or behavioral functions such as a population code for spatial location<sup><xref ref-type="bibr" rid="c15">15</xref>–<xref ref-type="bibr" rid="c17">17</xref></sup>, memory-guided navigation<sup><xref ref-type="bibr" rid="c4">4</xref>–<xref ref-type="bibr" rid="c6">6</xref></sup> and the planning of direct trajectories to goals<sup><xref ref-type="bibr" rid="c18">18</xref>,<xref ref-type="bibr" rid="c19">19</xref></sup>. However, this traditional approach has been proven notoriously difficult in identifying a teleological cause for the existence of grid cells in mammalian brains, i.e., an explanation of the specific functional purpose they serve. Computational models of grid cells such as oscillatory interference models<sup><xref ref-type="bibr" rid="c20">20</xref>–<xref ref-type="bibr" rid="c24">24</xref></sup> and continuous attractor models<sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c25">25</xref>,<xref ref-type="bibr" rid="c26">26</xref></sup> provide mechanistic explanations of how the spatial periodicity in firing can emerge from the structure of microcircuits within the superficial layers of the MEC<sup><xref ref-type="bibr" rid="c27">27</xref>–<xref ref-type="bibr" rid="c29">29</xref></sup>. However, these mechanistic models, too, cannot identify the teleological cause for the emergence of spatial periodicity in grid cell firing. Consequently, functions of grid cells are often explained in generic terms and statements, such as that grid cells supply a path integration-based “metric for space” or provide a “coordinate system” for spatial mapping. The influential hypothesis that grid cells provide a universal map for space is challenged by experimental data suggesting a yet to be identified local computational function of grid cells<sup><xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>. Here, we identify this local computational function as a trajectory code.</p>
<p>The approach taken in this study in developing a theoretical framework for grid cells differs from mechanistic modeling approaches and from traditional approaches in the grid cell literature that aim to assign functions to grid cells based on their properties. Instead, we turn the question on its head and ask the reverse question: What is an important function performed by the mammalian brain that could either not be performed at all or would be substantially more costly or inefficient to perform in the absence of grid cells? This approach follows the logic proposed by David Marr: “To phrase the matter in another way, an algorithm is likely to be understood more readily by understanding the nature of the problem being solved than by examining the mechanism (and hardware) in which it is embodied” (Marr, 2010, Chapter 1.2).</p>
<p>This study provides mathematical proof that, in Marr’s words, “the nature of the problem being solved” by grid cells is coding of trajectories in 2-D space using cell sequences. By doing so, we offer a specific answer to the question of why grid cell firing patterns are observed in the mammalian brain. Thus, we (1) provide a teleological cause for the existence of grid cells and (2) provide a unifying theoretical framework that spans a bridge between the literature on grid cells and the vast literature on neural sequences in the hippocampal formation.</p>
</sec>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Spatial periodicity in grid cell firing emerges from a cell sequence code of trajectories in 2-D space</title>
<p>To constrain our search for a function that requires grid cells or could not be performed efficiently without grid cells, we reasoned that this function shall rely on sequential activation of grid cell assemblies, in short grid cell sequences. This reasoning rests on well-established experimental data on neural activity in the hippocampal formation showing that cell sequences can provide a code for transitional structures of world states, generating an internal representation for memory-guided navigation<sup><xref ref-type="bibr" rid="c31">31</xref>–<xref ref-type="bibr" rid="c33">33</xref></sup>. Please note that the term “cell sequences” refers either to sequences of single cells or the sequences of cell assemblies, which are often observed in animal experiments as sequential activity of individual cells due to limitations in the number of neurons that can be recorded simultaneously. We further reasoned that, if a fundamental function of grid cells exists, such a function is very likely related to coding of trajectories. This reasoning rests on theoretical work demonstrating that theta sequences of grid cell populations can provide a traveling-direction signal<sup><xref ref-type="bibr" rid="c34">34</xref></sup>, and that temporally structured neural activity in the hippocampal formation may be necessary to temporally bind neural representations of contiguous events<sup><xref ref-type="bibr" rid="c12">12</xref></sup>. Moreover, data obtained from rodent experiments<sup><xref ref-type="bibr" rid="c35">35</xref>,<xref ref-type="bibr" rid="c36">36</xref></sup> and theoretical work<sup><xref ref-type="bibr" rid="c37">37</xref></sup> suggest that grid cells serve path integration and memory-guided navigation. A code for spatial trajectories by cell sequences that is usable across different environments would be very useful to keep track of changes in location relative to a starting point, i.e., path integration.</p>
<p>We therefore set out to provide mathematical proof that spatial periodicity in grid cell firing emerges from the assertion that cell sequences code for trajectories in 2-D space under the constraint that the number of neurons in the brain is finite.</p>
</sec>
<sec id="s2b">
<title>Mathematical proof</title>
<p>In the following, we prove that the firing fields of grid cells emerge from assuming a basic set of axioms defining how cell sequences code for trajectories in 2-D space. In particular, we prove that the grid fields must be arranged such that their centers are placed at the points of a hexagonal lattice. We will draw on geometry and combinatorics for this, enabling us to give a visual but nevertheless rigorous argument.</p>
<p><bold>Definition 1.1. Spatial firing field.</bold> A spatial firing field of a neuron defines a specific region in space, where a neuron is active, i.e., the neuron responds to a specific spatial location of an animal with an increased rate of action potential firing.</p>
<p><bold>Remark 1.2.</bold> Conversely, if the firing fields of multiple neurons overlap at one point in space, multiple neurons are active at the same time.</p>
<p><bold>Definition 1.3. Cell assembly.</bold> We refer to the co-activity of multiple neurons with overlapping firing fields as a functional <italic>cell assembly</italic>.</p>
<p><bold>Definition 1.4. Compound spatial firing field.</bold> A compound spatial firing field is the union of all firing fields of all cells that are part of a cell assembly.</p>
<p><bold>Definition 2.1. Isometry.</bold> An <italic>isometry</italic> is a bijective map of the plane <italic>f</italic> that preserves distance, that is for any two points x and y,
<disp-formula>
<graphic xlink:href="542747v5_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We say that two geometric figures (i.e. shapes in the plane) are <italic>geometrically congruent</italic> if there is an isometry of the plane that sends one figure to the other. We will abbreviate this to <italic>congruent</italic> in what follows.</p>
<p>It is well known that two figures are congruent if one can be laid on top of the other so that they match perfectly. This can be done via rotation, translation, reflection, or a combination of these.</p>
<p><bold>Definition 3.1. Kissing number.</bold> Given a geometric figure, the kissing number is the largest number of non-overlapping figures congruent to the original geometric figure that can be arranged in the plane so that they all touch the original geometric figure.</p>
<p><bold>Remark 3.2.</bold> Kissing numbers are usually computed for spheres embedded in various Euclidean spaces, but here we restrict to the plane and allow convex (see Definition 5) geometric figures other than circles.</p>
<p><bold>Example 3.3.</bold> The kissing number of a circle in the plane is 6, which is achieved using a hexagonal packing of circles<sup><xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c39">39</xref></sup>.</p>
<p><bold>Definition 4.1. Lattice and lattice packing.</bold> A <italic>lattice</italic> in the plane is an infinite set of points such that adding or subtracting any one point to/from another in the lattice returns another point in the lattice, any two points of the lattice are separated by a minimum distance, and any point in the plane is within a maximum distance of a lattice point.</p>
<p>A <italic>lattice packing</italic> is a packing of the plane by congruent geometric objects, such that the centers of the objects are located at the points of a lattice.</p>
<p><bold>Example 4.2.</bold> The points in the plane with integer coordinates form a lattice.</p>
<p><bold>Example 4.3.</bold> The tiling of the plane by equilateral triangles, squares, or hexagons is a lattice packing. So is the hexagonal circle packing, in which every circle is surrounded by six other circles touching it.</p>
<p><bold>Fact 4.4.</bold> A lattice is invariant under isometries that take one point of the lattice to another point of the lattice.</p>
<p><bold>Fact 4.5.</bold> There are five types of a lattice in the plane (Kittel, 1966, Chapter 1) (Supplementary Figure S1, A – E).
<list list-type="order">
<list-item><p>Oblique</p></list-item>
<list-item><p>Square</p></list-item>
<list-item><p>Hexagonal</p></list-item>
<list-item><p>Rectangular</p></list-item>
<list-item><p>Centered rectangular</p></list-item>
</list>
<bold>Definition 5. Convexity.</bold> A geometric object in the plane is <italic>convex</italic> if for any line segment whose endpoints lie on the object, the entirety of the line segment also lies on the object (Supplementary Figure S1, F – H).</p>
<p><bold>Definition 6. Trajectory.</bold> A <italic>trajectory</italic> is a path taken in space.</p>
<p><bold>Remark 6.1.</bold> Note that a code for trajectories is independent of the animal’s spatial location, consistent with the definition of path integration. This implies that, if the number of neurons is finite (Axiom #4) and the space is large, sequences must eventually repeat in different location, resulting in neural sequences coding for the same trajectories at different locations.</p>
<p><bold>Definition 7.1. Cell sequence.</bold> A <italic>cell sequence</italic> refers to continuous neural activity consisting of sequentially active cells or cell assemblies.</p>
<p><bold>Definition 7.2. Elements within a cell sequence.</bold> In the context of a cell sequence, an “element” within a sequence refers either to a single cell or a cell assembly. A sequence of cell assemblies refers to the sequential activity of cell assemblies such that the cellular compositions of two sequentially active cell assemblies do no overlap. Conversely, the firing fields of all cellular components of the first cell assembly do not overlap with the firing fields of all cellular components of the second cell assembly.</p>
<p><bold>Remark 7.3.</bold> Cell assemblies can perform pattern completion and are thereby resistant to noise so that a cell assembly would be activated robustly even if a single cell of this assembly failed to be activated. Moreover, cell assemblies allow for conjunctive coding by individual cells.</p>
<p><bold>Definition 8. Sequence coding of trajectories.</bold> <italic>Sequence coding of trajectories</italic> is given if the identity of the next active element in a sequence is uniquely determined by the currently active element and the velocity vector associated with the current trajectory (<xref rid="fig1" ref-type="fig">Figures 1E</xref><bold> – 1J</bold>).</p>
<p><bold>Axioms (</bold><xref rid="tbl1" ref-type="table">Table 1</xref>). Our goal is to provide a mathematical proof that spatial periodicity in grid cell firing emerges as a parsimonious solution to provide a code for trajectories in 2-D space by cell sequences.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>Axioms from which grid cell firing emerges as the most parsimonious solution to provide a code for trajectories in 2-D space.</title></caption>
<graphic xlink:href="542747v5_tbl1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>In the following sections, we demonstrate that if we assume axioms 1 to 4, it must be the case that the intersecton of all firing fields of trajectory-coding cells or all compound firing fields of cell assemblies must be congruent (the same shape), and the centers of the firing fields must be arranged in a hexagonal lattice. For the sake of simplicity in writing, we refer to cells or cell assemblies as elements.</p>
<p>To illustrate this, note that by Axiom 3, a particular firing field U is surrounded by the maximal number of other firing fields, each of which must be congruent to each other. This implies that all firing fields around U are congruent. Pick a firing field V adjacent to U. By the same argument, it must be the case that all firing fields around V are congruent. Since U is adjacent to V, it is congruent to the firing fields around V. Some of these are adjacent to U as well, so U is congruent to the firing fields around both V and U, as well as to V. By continuing this argument across the whole plane, we see that all firing fields must be congruent.</p>
<p>Since each firing field U must be surrounded by the maximal number of firing fields, the kissing number of the arrangement must be maximal. Further, by the symmetry requirement (Axiom 3), this must be achieved by a hexagonal lattice packing with a kissing number of 6 (<xref rid="fig1" ref-type="fig">Figures 1F</xref><bold> and </bold><xref rid="fig1" ref-type="fig">1G</xref>). Any square lattice packing either has a kissing number of 4 or lacks symmetry between the “corner” firing fields and “side” firing fields.</p>
<p>We now use axiom 1 to demonstrate that the firing fields of trajectory-coding elements must be convex. Examining Supplementary Figure S1H, we see that if a firing field is non-convex, a single sequence will code for more than one trajectory.</p>
<p>At this point, we know that (i) all firing fields are congruent to each other, (ii) they are arranged in a hexagonal lattice, and (iii) each firing field is convex.</p>
<p><bold>Definition 9. Row and diagonal.</bold> We refer to a straight sequence of firing fields along one of the major axes of the hexagonal lattice as a row and along the remaining two axes as diagonals (<xref rid="fig1" ref-type="fig">Figure 1 K</xref>).</p>
<p>As we will proof below, the possibilities of arrangements of firing fields of all distinct elements is restricted by axioms 1-3. We further realize that the elements appearing in one row of the lattice must repeat if the number of elements is finite (Axiom 4).</p>
<p>But as soon as one element repeats, the <italic>sequence</italic> of elements must also repeat. For example, assume we start in a firing field of one trajectory-coding element and travel in some direction. If, for example, elements 1,3, and 4 fire in that order and the animal continues traveling in the same direction, elements 1,3, and 4 will eventually fire again in that order.</p>
<p>Generally speaking, starting in a firing field of element <italic>i</italic> and going along any set of firing fields, some element must eventually become active again since the total number of elements is finite by axiom 4. Once there is a repeat of one element’s firing field, the whole sequence of firing fields of all elements must repeat by axiom 1. More specifically, if we had a sequence 1,2, …, <italic>k</italic>, 1, <italic>t</italic> of elements, then 1,2 and 1, <italic>t</italic> both would code for traveling in the same direction from element 1, contradicting axiom 1.</p>
<p>The repeating sequence of locally active elements must at least have length 3 as if we had a repeat of length 2, we would have a sequence <italic>i</italic>, <italic>j</italic>, <italic>i</italic> along one trajectory, where <italic>i</italic>, <italic>j</italic> would represent two distinct trajectories, contradicting axiom 1. If the same element fired twice in a row, say we had a sequence i,1,1,j, then 1,1 and 1,j would both code for the same trajectory, contradicting axiom 1 again.</p>
<p>It follows that the arrangement in one row determines the possibilities of arrangements in the remaining rows.</p>
<p>More explicitly, assuming axioms 1 and 4, the firing fields of trajectory-coding elements must be spatially periodic, in the sense that starting at any point and continuing in a single direction, the initial sequence of locally active elements must eventually repeat with a repeat length of at least 3 (<xref rid="fig2" ref-type="fig">Figure 2</xref>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Repeating sequences of elements coding for trajectories result in lattice packing of firing fields.</title>
<p>Left panels show firing fields of multiple distinct elements with non-overlapping firing fields arranged in a 2-D lattice packing (grid). Each grid provides a sequence code of trajectories. Mid panels show the sequences that code for the directions along the three major axes of the grid. Right panels highlight the firing fields of an individual element visualizing the type of lattice formed by the firing fields of one element. <bold>A</bold>, An example of the minimal number of seven elements and resulting sequences with repeat length 7 along the three grid axes. The resulting firing fields of individual elements (referred to as a “grid map” in animal experiments) are arranged on a hexagonal lattice rotated by 10.9 degrees against a vertical axis. <bold>B</bold>, An example of eight cells and sequences with repeat lengths 4 along one axis, and repeat length 8 along the two other axes. The resulting firing fields are arranged on a centered rectangular lattice. <bold>C</bold>, An example of nine cells and sequences with repeat length 3 along all three grid axes, resulting in hexagonal lattice packing of indivual elements’ firing fields.</p></caption>
<graphic xlink:href="542747v5_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption><title>The minimum number of distinct elements providing a sequence code of trajectories in 2-D space is 7, and there are exactly 2 possible arrangements of elements up to relabeling.</title>
<p><bold>A</bold>, Repeat lengths that are smaller than 7 result in a violation of a sequence code of trajectories because the code would be ambiguous and not unique. A red question mark indicates that no element can be found for this position that would not violate the sequence code. Red numbers indicate that activity of this element at the current position would violate sequence coding of trajectories due to ambiquity. Blue background color marks the sequential activity of 2 elements that violate the sequence code of trajectories (Definition 8) because the next active cell in the sequence is not uniquely determined by the currently active cell and the velocity vector associated with the current trajectory of an animal. <bold>B</bold>, If the repeat length is 7, there are three potential translations of the sequence in row 1 to fill up row 2 (see Mathematical proof). Only two of those three tranlsations result in an arrangement of elements (up to relabeling of elements) that creates a sequence code for trajectories in 2-D space. These two arrangements are mirror images of each other and imply that the firing fields of each individual grid element fall on the vertices of equilateral triangles, i.e., they form a hexagonal grid. <bold>C</bold>, Both possible arrangements of firing fields imply that grid patterns of other grid elements have the same spacing and rotation, and only differ in spatial phase (compare grid patterns of element #1 and element #6). The smallest angle between one grid axis and the boundary of a rectangular enclosure is 10.9 degrees if one row of sequences is aligned with one of the borders of the enclosure.</p></caption>
<graphic xlink:href="542747v5_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p><bold>Remark.11.3.</bold> This does not require symmetry in the sense that traveling in two different directions from element <italic>i</italic> may give repeating sequences of two different lengths, as seen in <xref rid="fig2" ref-type="fig">Figure 2B</xref>, where the repeats have lengths 4 and 8, depending on the angle of travel from a given element.</p>
<p>The next goal is to determine how our axioms restrict the arrangement of firing fields in a single computational element of trajectory-coding elements. Since these firing fields are arranged in a hexagonal lattice, we determine the possible ways to label the firing fields in this lattice (drawn as circles for convenience), as visually representated in <xref rid="fig4" ref-type="fig">Figures 4</xref> and <xref rid="fig5" ref-type="fig">5</xref>.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Transformation of a sequence code of trajectories from 2-D space to 1-D space.</title>
<p><bold>A</bold>,<bold>B</bold>, A sequence of 7 different elements can code for a trajectory in a 1-D compartmentalized “hairpin” maze (A) or a 1-D circular track (B). Note that the distance between firing fields would increase in the 1-D “hairpin” maze and 1-D circular track compared to the distance between spatial firing fields in a 2-D environment. Also note that sequences could undergo a phase reset at behaviorally relevant points, e.g., the turning points in the “hairpin” maze (A). <bold>C</bold>, The sequence of active elements in a 1-D environment can be interpreted as a cross-section of the trajectory sequence code in a 2-D space. <bold>D</bold>, Anchoring of firing filelds to environmental borders predicts parametric rescaling of an individual element’s grid pattern when a familiar enclosure is deformed. Each color represents one grid element, each circle represents one firing field. For clarity, the complete set of firing fields of an individual element is shown only for one element (orange color). In addition, sequences are shown for all three major axes. Left panel, original maze configuration. Mid and right panel, the environment is compressed along the vertical or horizontal dimension resulting in a parametric deformation of firing fields and the grid pattern of individual elements’ firing fields along the vertical or horizontal dimension. <bold>E</bold>, Progressively faster advancement from the currently active element to the next active element in the sequence code of trajectories results in progressive decrease in grid spacing and thereby a local distortion of the grid map. Open circles represent firing fields of grid elements along the three major axes. The red filled circle in the center represents a salient location such as a rewarded goal location toward which nearby grid fields gravitate.</p></caption>
<graphic xlink:href="542747v5_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Multiple grids provide nearly continuous resolution in the coding of trajectories.</title>
<p><bold>A</bold>, The circles with numbers show the <italic>centers</italic> of the grid fields from 4 grids, each composed of 7 distinct elements (total of 28 grid elements). Shaded areas represent the firing fields of individual elements. Elements with non-overlapping firing fields form “grids”, shown in black, green, blue, and red colors. Each number within a circle identifies a distinct element. If elements represent cell assemblies, a combination of numbers (e.g., “1,2”) identifies a element whose cellular composition is an overlap between two elements with adjacent firing fields. E.g., element “1,2” is composed of cells that are part of elements “1” and “2”, resulting in an overlap of firing fields. For visual clarity, not all element numbers are shown. <bold>B</bold>, Grids #2, #3, and #4 are phase-shifted along one of the three major axes of grid #1. The emerging grid map of an individual element’s firing fields is highlighted in color for one grid element in each grid. The phase-shift of each grid is indicated by showing the transparent grid pattern of grid #1. <bold>C</bold>, When more grid elements are added, the elements can be represented in 3-D neural space as a neural manifold, shown here for a total of 1792 grid elements forming 256 grids of non-overlapping firing fields. The colored cells represent one diagonal axis across rows of non-repeating elements if plotted in the 2-D plane as shown in A.</p></caption>
<graphic xlink:href="542747v5_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Many of the proofs in the rest of this section use the method of proof by cases: we describe all possible ways to label the firing fields, and then explain why some of those cases contradict our hypotheses. A key observation is that the sequence that appears in one row of the lattice restricts the possibilities for which sequences can appear in the adjacent row.</p>
<p>First, we will demonstrate that every sequence of elements along one of the three major axes of the hexagonal lattice (rows and diagonals) must be either a translation of an existent sequence in a parallel axis or consist of a disjoint set of elements.</p>
<p>To prove this statement, suppose that row A consists of elements 1, …, <italic>k</italic> repeating in this order. Then any row that contains any element from 1, …, <italic>k</italic> must contain the full repeat 1, …, <italic>k</italic> by axiom 1. So any row containing any element from 1, …, <italic>k</italic> is a translation of row A, and any element that does not contain them is disjoint from row A.</p>
<p><bold>Remark 12.3.</bold> We count the distance of a translation of a row A by starting at an element <italic>a</italic>, passing to the element diagonally down and to the right of element <italic>a</italic>, and counting spaces moved right from here. Translations must be by 0,1,2, …, <italic>k</italic> − 1 spaces, where row A contains <italic>k</italic> elements.</p>
<p>We note that if a row or diagonal of the hexagonal lattice is a translation of a neighboring row or diagonal, the translation must be by at least 2 and at most <italic>n</italic> − 3, where <italic>n</italic> is the repeat length. If the translation is by 0, we have one element firing adjacent to itself, which contradicts axiom 1. If the translation is by 1, say element i has elements j,i below and immediately to the right (South-East) of it, then j,i is now coding for two distinct trajectories, namely North-West and East. This contradicts axiom 1. If the translation is by <italic>n</italic> − 2, or <italic>n</italic> − 1, these are left-right reflections of translations by 1 or 0, respectively, and have the same issues.</p>
<p>Further, it must be true that sequence repeats in parallel rows or diagonals must be of the same length.</p>
<p>To illustrate this, assume two consecutive rows A and B have sequence repeats of different lengths, say row A consists of 1, …, <italic>k</italic> and row B consists of <italic>k</italic> + 1, …, <italic>k</italic> + <italic>s</italic>, where <italic>k</italic> &lt; <italic>s</italic>. Then, the element sequence 1, <italic>k</italic> + 1 will appear in one repeat and the element sequence 1, <italic>k</italic> + <italic>t</italic> will appear in the next, where <italic>t</italic> is not equal to 1. This contradicts axiom 1 (<xref rid="fig5" ref-type="fig">Figure 5A</xref>).</p>
<p>A final useful fact is that the length of the sequence repeat in any row or diagonal must divide the number of elements. As a result, if the number <italic>n</italic> of elements is prime, the length of the sequence repeat in any row or diagonal must be of length <italic>n</italic>.</p>
<p>In order to prove this last fact, we will work by supposing the repeat length is less than <italic>n</italic> in some dimension, and showing that the repeat length must then divide <italic>n</italic>. Without loss of generality, assume it is the horizontal (West-East) direction, so that one row consists of 1,2, …, <italic>i</italic> repeating, for some <italic>i</italic> &lt; <italic>n</italic>. Then, every row must consist of elements 1,2, …, <italic>i</italic> or be disjoint from the elements in other rows. Since every element will appear in exactly 1 of the distinct rows, the total number of elements must divide evenly into sets of i, one for each distinct row. So, the length of the repeat in each row must divide <italic>n</italic>.</p>
<p>If <italic>n</italic> is prime, every row has repeat length dividing <italic>n</italic>. Since no row can have a repeat of length 1 by the work above, every row has repeat length <italic>n</italic>.</p>
<p>Next, we prove that the minimum number of trajectory-coding elements in 2-D space is 7 and describe the possible arrangements of 7 elements’ firing fields in 2-D space that establish a sequence code of trajectories.</p>
<p>Given the requirement that each firing field is surrounded by 6 firing fields of distinct elements, the minimum number of elements providing a sequence code of trajectories in 2-D space is 7.</p>
<p>By our work above, the repeat length must be 7 in all directions. We may assume the elements are labelled such that row A consists of elements 1,2, … 7 (<xref rid="fig3" ref-type="fig">Figure 3B</xref>). Hence, every row is a translation of row A. Since the translation must be at least 2 and at most 4, we have a total of 3 options for how much row B is translated from row A. In <xref rid="fig3" ref-type="fig">Figure 3B</xref>, we show that translation by 3 yields a contradiction, so translation by 2 and 4 are the only possible options. Once rows A and B are determined, every other row is uniquely determined by axiom 1.</p>
<p>There are thus exactly 2 possible arrangements of 7 elements so that they form a sequence code for trajectories in 2-D space, up to relabeling of cells. Intriguingly, both possible arrangements of 7 elements result in a hexagonal arrangement of firing fields of all distinct elements, and these arrangements are rotated against the wall of a rectangular enclosure by 10.9 degrees (<xref rid="fig3" ref-type="fig">Figure 3B</xref>).</p>
<p>While the two solutions to a sequence code of trajectories with 7 elements both result in a hexagonal lattice packing of firing fields, solutions with 8 or more elements can result in other types of lattice packing (Supplementary Figure S1), such as the oblique lattice or centered rectangular lattice that have also been observed in single element recordings of freely behaving animals<sup><xref ref-type="bibr" rid="c41">41</xref></sup>. Code to compute and visualize “grid maps” of trajectory-coding sequence arrangements with up to 14 elements has been made publicly available to help the scientific community test some of our predictions against future datasets<sup><xref ref-type="bibr" rid="c42">42</xref></sup>. Because (1) each row must either be a translation of the previous row or entirely disjoint from it, (2) the length of the repeat in each row is the same and divides the total number of elements, and (3) if one row is translated from the one above, the translation must be by at least 2 and at most n-3 (where n is the length of the repeating sequence in the previous row), we can classify all possible arrangements of trajectory coding sequences of elements for any particular number of elements. In <xref rid="tbl2" ref-type="table">Table 2</xref>, we list all possible ways to construct a sequence code composed of 7-12 trajectory-coding elements up to translation and rotation. Note that increasing the number of elements in a sequence code does <italic>not</italic> increase the spatial or angular resolution in the representation of a trajectory. Therefore, a code that uses more than the minimal number of 7 elements has no functional benefit (see Discussion).</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
    <caption><title>List of possible grid maps and properties of these grid maps given the total number of elements participating in a trajectory-coding sequence in a rectangular environment.</title>
    <p>For each individual element’s grid map that has a non-zero angle to a border, a reflection or 90°-rotation and reflection up to relabeling of the elements exist, and these additional possibilies are not included in this list.</p><p><sup>a</sup>Repeat lengths across the three major axes of the hexagonal lattice structure of densely packed firing fields.</p><p><sup>b</sup>The smallest angle to a border of a rectangular environment assumes that one sequence of elements is arranged in parallel to one wall.</p></caption>
<graphic xlink:href="542747v5_tbl2.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>The grid pattern that we have found to emerge as the most parsimonious solution assuming axioms 1 to 4 (see Results), i.e., the solution to a sequence code of trajectories using a minimal number of elements, mirrors experimental results on grid elements from animal experiments as we demonstrate below.</p>
</sec>
<sec id="s2c">
<title>Sequence coding of trajectories predicts grid spacing and rotation of grid maps against a wall</title>
<p>The solution to sequence coding of trajectories predicts firing fields on the single cell level that form a hexagonal lattice, as observed in grid cell data obtained from freely behaving rodents<sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c43">43</xref></sup> and crawling Egyptian fruit bats<sup><xref ref-type="bibr" rid="c44">44</xref></sup>. The triangular structure of grid cells’ firing maps (grid maps) have been characterized by three parameters, namely grid field size, grid spacing, and grid orientation<sup><xref ref-type="bibr" rid="c2">2</xref></sup>. Because the sequence code of trajectories model of grid cell firing implies a dense packing of firing fields, the spacing between two adjacent grid fields must change linearly with a change in field size. It follows that the ratio between grid spacing and field size is fixed. When using the distance between the centers of two adjacent grid fields to measure grid spacing and a diameter-like metric to measure grid field size, we can compute the ratio of grid spacing to grid field size as √7 ≈ 2.65 (see Methods). We tested this prediction on a data set of n = 27 grid cells recorded in mice for a previously published study<sup><xref ref-type="bibr" rid="c45">45</xref></sup>. This data has been openly released in another study<sup><xref ref-type="bibr" rid="c46">46</xref></sup>. Quantifying field sizes requires identifying the borders of individual fields as a first step. Since the characteristic feature of a firing field is its firing rate, we chose to use a threshold for the firing rate to determine the field boundaries (see Methods). Setting the field detection threshold to 31% of the peak firing rate optimized detection of grid fields in most grid cells (n = 25 out of 27 cells) (Supplementary Figure S2A). We found that the ratio of the field spacing to a diameter-like metric of the field size was 2.39 ± 0.25 (mean ± SD; n = 25) (Supplementary Figure S2B), which is only slightly smaller than 2.65, the upper bound predicted by the model. Note that the ratio of grid field spacing to field size observed in experimental data is expected to be smaller than the model-predicted ratio because of the many factors that result in out-of-field firing of neurons recorded in experiments, such as transient drifts of grid maps, path integration errors, conjunctive coding properties, and noise in experimental measurements (Supplementary Figure S2C and Supplementary Figure S3).</p>
<p>Another testable prediction of our model is that the grid map associated with the most parsimonious solution using 7 elements is rotated by 10.9 degrees against the nearest wall of a rectangular enclosure (<xref rid="tbl2" ref-type="table">Table 2</xref>). This angle is well within the range of experimentally observed values. Concretely, Stensola et al. (2015)<sup><xref ref-type="bibr" rid="c41">41</xref></sup> reported a distribution of angles with a plateau between ∼6 and ∼12 degrees (mean ± SD: 7.2 ± 3.5). Notably, the median of the angle to the nearest wall in a highly familiar as opposed to a novel environment was 9.8 degrees<sup><xref ref-type="bibr" rid="c41">41</xref></sup>. Under the premise that a sequence of firing fields aligns with one of the geometric boundaries of the environment, the sequence code model explains that the grid pattern typically assumes one of only four distinct orientation configurations relative to the environment<sup><xref ref-type="bibr" rid="c41">41</xref>,<xref ref-type="bibr" rid="c47">47</xref></sup>. Concretely, the four orientation configurations arise when one row of grid fields aligns with one of the two sets of parallel walls in a rectangular environment, and each arrangement can result in two distinct orientations (<xref rid="fig3" ref-type="fig">Figure 3B</xref>). The sequence code model of grid cell firing thus provides a simple and intuitive answer to the otherwise puzzling observation that most grid field maps observed in freely behaving animals are rotated against the nearest wall of a rectangular enclosure.</p>
</sec>
<sec id="s2d">
<title>Sequence coding of trajectories predicts fragmentation of grid maps in 1-D space</title>
<p>Another experimental observation related to the spatial geometry of grid fields that can be explained by a sequence code of trajectories is the fragmentation of grid cell maps in a multicompartment environment (<xref rid="fig4" ref-type="fig">Figures 4A</xref> – <xref rid="fig4" ref-type="fig">4C</xref>). The 2-D spatial periodicity in grid cell firing is replaced by one-dimensional (1-D) spatial periodicity if movement through space is restricted to 1-D trajectories along parallel alleys in a multi-compartment maze<sup><xref ref-type="bibr" rid="c48">48</xref></sup>. A sequence code of trajectories predicts such a fragmentation of grid cell maps because parallel trajectories would result in the same sequential activation of cells, and neural coding on a 1-D tract is most efficient when sequences are aligned with the movement direction (<xref rid="fig4" ref-type="fig">Figure 4A</xref>). Likewise, grid cells have been shown to path integrate distances on a 1-D circular track<sup><xref ref-type="bibr" rid="c49">49</xref></sup>, consistent with a sequence code of a trajectory along a 1-D circular track (<xref rid="fig4" ref-type="fig">Figure 4B</xref>). Notably, Jacob et al. (2019) report in their study that the field spacing of grid cells is increased in a 1-D circular track compared to a 2-D environment. The authors’ explanation is that field spacing is increased due to the lack of visual cues. However, an alternative explanation based on the sequence model of grid cell firing is that the animal’s trajectory on a linear track is represented by a sequence of cells (<xref rid="fig4" ref-type="fig">Figure 4C</xref>). Moreover, the sequence code of trajectories is consistent with an analysis of experimental data<sup><xref ref-type="bibr" rid="c50">50</xref></sup> showing that firing fields of grid cells on a 1-D linear track are compatible with a slice through a 2-D hexagonal pattern. Specifically, a slice through a 2-D hexagonal firing pattern explains linear-track data if translational shifts of the pattern are allowed at turning points without a requirement of rotating or scaling the grid. In the context of the sequence code of trajectories, a translational shift of the grid pattern of a single cell is equivalent to re-anchoring the sequence code after the animal has turned around facing the opposite direction on the linear track. Such a translational shift or re-anchoring of the sequence code is consistent with experimental data showing differential spatial coding by place cells in the hippocampus for inbound and outbound running directions on a linear track<sup><xref ref-type="bibr" rid="c51">51</xref></sup>.</p>
<p>Furthermore, grid cells have been shown to code for traveled distance, elapsed time, or a combination of distance and time when animals run in place on a treadmill<sup><xref ref-type="bibr" rid="c52">52</xref></sup>. The firing pattern of grid cells as time or distance cells is remarkably similar to the firing pattern of grid cells that emerges when animals navigate 1-D linear tracks after correcting for logarithmic expansion in grid field size over time. The fact that grid cells show repeating firing fields in other dimensions than physical space is consistent with a sequence code of trajectories in any type of dimension that has behavioral relevance for the animal. Experimental data<sup><xref ref-type="bibr" rid="c52">52</xref></sup> demonstrate parallel coding of different dimensions by different grid cells, suggesting individual grid cell sequences can provide independent codes of trajectories through different dimensions, thereby enabling parallel processing of different cognitive functions.</p>
</sec>
<sec id="s2e">
<title>Sequence coding of trajectories defined relative to landmarks or boundaries predicts rescaling and restructuring of grid maps with changes in landmarks and boundaries</title>
<p>A sequence code of trajectories does not need to be rigid but instead can be malleable and rescaled in response to changes in the environment as long as the start and end points of the sequences are anchored to salient environmental landmarks. Thus, sequence coding of trajectories by grid cells provide an explanation of distortions of the grid pattern that are frequently observed in animal studies. Experiments in freely behaving rodents demonstrate that stretching or compression of enclosed environments result in stretching or compression of the grid map in the rescaled dimension. For instance, stretching or compressing the borders of a familiar open field recording arena resulted in an increase or decrease of the distance between firing fields in the rescaled dimension of the deformed enclosure<sup><xref ref-type="bibr" rid="c41">41</xref>,<xref ref-type="bibr" rid="c53">53</xref></sup>. Such distortions have been challenging to interpret under the assumption that grid cells provide a “spatial metric” or “coordinate system” for navigation. However, if we assume a sequence code with start and end points of trajectories anchored to landmarks or environmental borders, distortions of the grid along the rescaled dimension would be expected. The sequence code of trajectories would remain the same if trajectories are defined relative to the borders of the environment (<xref rid="fig4" ref-type="fig">Figure 4D</xref>). Moreover, experimental data in rats show that grid maps that have been established in two adjacent compartments separated by a wall within the same larger environment merge once the wall is removed<sup><xref ref-type="bibr" rid="c54">54</xref></sup>. Merging of the two grid maps appeared to happen instantly resulting in local spatial periodicity and continuity between the two original maps<sup><xref ref-type="bibr" rid="c54">54</xref></sup>, consistent with the sequence code of trajectories by grid cells.</p>
<p>Scaling of grids has also been observed in the form of an expansion, i.e., increased grid spacing between individual firing fields and increased field sizes, in response to novelty of the environment<sup><xref ref-type="bibr" rid="c55">55</xref></sup>. Such scaling has also been reported in climbing rats foraging on a vertical wall<sup><xref ref-type="bibr" rid="c56">56</xref></sup>. Both the scaling of grids in response to scaling the borders of an environment and the expansion of grid fields in response to novelty are inconsistent with the hypothesis that grid cells provide a spatial metric for navigation or path integration. However, an increase in grid spacing in response to a novel environment can be explained by a sequence code of trajectories reflecting an initially broader spatial resolution. Specifically, the spatial resolution in the trajectory code is equivalent to the spacing between two adjacent spatial fields, and the spatial resolution is directly proportional to both the grid spacing and the field size. Initially, the overall layout of a novel space is likely more important than the fine-grained details. However, as the animal becomes more familiar with the environment, it is likely paying more attention to spatial details requiring a trajectory code with higher spatial resolution, resulting in a smaller grid map. While this hypothesis needs to be tested in future studies, experimental data show that changes in grid field size co-occur, though to a lesser extent, with changes in the size of place cell firing fields in response to novel environments<sup><xref ref-type="bibr" rid="c55">55</xref>,<xref ref-type="bibr" rid="c57">57</xref>,<xref ref-type="bibr" rid="c58">58</xref></sup>. In summary, sequence coding of trajectories is consistent with the experimentally observed scaling of grids in response to deformations of the borders of the environment and with compression or expansion of firing fields and grid spacing in response to novelty.</p>
<p>Furthermore, a sequence code of trajectories in 2-D space is consistent with experimental data showing that grid fields move toward goal locations<sup><xref ref-type="bibr" rid="c59">59</xref></sup> or restructure their spatial firing maps to incorporate the location of a learned reward<sup><xref ref-type="bibr" rid="c60">60</xref></sup>. These data support the hypothesis that grid cells do not provide a simple metric of space. Instead, the spatial firing pattern of grid cells is malleable in response to relevant contextual features. Such local distortions of global grid patterns by salient locations have recently been compared to spacetime distortions by blackholes<sup><xref ref-type="bibr" rid="c14">14</xref></sup>. We propose that such warping of grid maps is caused by an increased probability that the currently active grid cell activates the next grid cell in the sequence of trajectory-coding cells, resulting in the center of firing fields moving closer together. A reduction of the spacing between spatial fields has been observed in hippocampal place fields, resulting in a backward shift with experience<sup><xref ref-type="bibr" rid="c61">61</xref>–<xref ref-type="bibr" rid="c65">65</xref></sup> due to NMDA receptor-dependent plasticity<sup><xref ref-type="bibr" rid="c66">66</xref></sup>. Under the premise that the grid map is anchored to the reward site, this would result in a progressive decrease in grid spacing toward the reward site, thereby causing local distortions in the grid map of a single grid cell (<xref rid="fig4" ref-type="fig">Figure 4E</xref>). A sequence code of trajectories by grid cells is thus consistent with malleable grid maps because the spacing between adjacent firing fields can change in response to local contextual features without compromising the sequence code. The same mechanism can explain shearing induced asymmetry and multiple alignment solutions that have been shown in experimental data<sup><xref ref-type="bibr" rid="c41">41</xref></sup>.</p>
</sec>
<sec id="s2f">
<title>Multiple grids provide nearly continuous resolution in the coding of trajectories and predict grid cell properties on the population level</title>
<p>In addition to properties of grid cell firing on the single cell level, the definition of sequence coding of trajectories implies an intriguing property of grid cells on the population level, namely that each grid cell’s collection of firing fields is geometrically congruent to any other grid cell’s collection of firing fields. This property mirrors experimental data from single element recordings in rodents showing that adjacent firing field grid patterns of different anatomically close grid cells differ only in phase but have the same orientation and scale<sup><xref ref-type="bibr" rid="c2">2</xref></sup>. Since the firing fields of distinct elements (i) do not overlap and (ii) discretize directions into six running directions only, we asked (i) how other running directions are represented and (ii) how partial transitions between firing fields can be accomplished. Consistent with experimental data<sup><xref ref-type="bibr" rid="c2">2</xref></sup>, the sequence code of trajectories model of grid cell firing accounts for smooth transitions between firing fields and the representations of more than six running directions by using multiple grids of seven elements each, where each element has the same field size. However, the firing fields are shifted in phase. It follows from axiom 3 that one needs to add three grids composed of the same number of elements as the original grid and shifted in phase such that their field centers fall exactly between the firing fields along one major axis of the original grid (<xref rid="fig5" ref-type="fig">Figures 5A</xref><bold> and </bold><xref rid="fig5" ref-type="fig">5B</xref>). Consequently, the firing fields of all distinct elements of the compound grid must again fall on a hexagonal lattice.</p>
<p>Two key conclusions from this theoretical result are that (i) an arbitrarily smooth transition between grid fields/grid cells becomes possible during navigation with an arbitrarily large number of grid cells (organized in fundamental grids of seven elements with non-overlapping firing fields), and (ii) traveling directions can be represented with an arbitrarily high angular resolution (see also the video animation of the sequence model associated with this study). This is consistent with experimental data on simultaneously recorded multiple grid cells with overlapping firing fields and consistent with data showing that grid cell dynamics can be represented with a toroidal manifold (<xref rid="fig5" ref-type="fig">Figure 5C</xref>).</p>
<p>Moreover, experimental data have shown that grid cells cluster into autonomous modules with distinct scale, orientation, symmetry and theta frequency modulation<sup><xref ref-type="bibr" rid="c67">67</xref></sup>. If we assume that grid cells emerge from a sequence code of trajectories, adjacent firing fields in that sequence would provide a discrete sequence of sampling points in the coding of trajectories, and the distance between the centers of two adjacent firing fields would determine the spatial resolution. Doubling the number of sampling points, i.e., doubling the number of firing fields per unit area would double the spatial resolution<sup><xref ref-type="bibr" rid="c68">68</xref></sup>. Conversely, dividing the number of firing fields per unit area in half would halve the spatial resolution. To double or halve the spatial resolution in 2-D space, the number of firing fields per area needs to double or be cut in half, respectively (Supplementary Figure S4). Because firing fields are densely packed, doubling the number of firing fields per unit area in 2-D space would result in dividing the distance between two adjacent firing fields by a factor of √2. This is exactly what has been observed in animal experiments<sup><xref ref-type="bibr" rid="c41">41</xref></sup>.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<sec id="s3a">
<title>A teleological cause for the existence of grid cells</title>
<p>In this study, we prove mathematically that spatial periodicity in grid cell firing emerges as the only possible solution to provide a code of trajectories in 2-D space by cell sequences. Within the space of all possible solutions, hexagonal symmetry in grid cell firing emerges as the most parsimonious solution with respect to the required number of neurons. The hexagonal firing pattern of grid cells in 2-D space is arguably their most intriguing property. Yet, despite decades of experimental and theoretical research, the fundamental nature of the computational problem solved by grid cells has remained largely elusive. Previous studies on grid cells have been fruitful in describing potential functions of the grid cell system such as providing a population code for spatial location<sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c16">16</xref></sup> and in describing functional properties of grid cells and grid cell firing at the level of neuroanatomy, connectivity, neurophysiology, and circuit dynamics. Yet, a specific and intuitive answer to why grid cells have evolved has remained elusive. What is the computational advantage of grid cells over other potential mechanisms or algorithmic implementations in the context of a computational goal? Previous investigations of grid cell function<sup><xref ref-type="bibr" rid="c27">27</xref>–<xref ref-type="bibr" rid="c29">29</xref></sup> based on mechanistic models such as the oscillatory interference<sup><xref ref-type="bibr" rid="c20">20</xref>–<xref ref-type="bibr" rid="c24">24</xref></sup> or continuous attractor models<sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c25">25</xref>,<xref ref-type="bibr" rid="c26">26</xref></sup> do not address the computational goal of or teleological cause for the existence of grid cells. Other studies have used normative models to demonstrate that grid patterns can emerge to optimize the coding of space by grid cells<sup><xref ref-type="bibr" rid="c17">17</xref>,<xref ref-type="bibr" rid="c69">69</xref></sup> or to optimize path integration<sup><xref ref-type="bibr" rid="c37">37</xref>,<xref ref-type="bibr" rid="c70">70</xref>,<xref ref-type="bibr" rid="c71">71</xref></sup>. However, these normative models fall short in demonstrating that grid cells are necessary for the assumed normative functions and often rely on hidden architectural, hyperparameter, and constraint choices to obtain grid cell firing patterns<sup><xref ref-type="bibr" rid="c72">72</xref></sup> as discussed under the next section “Normative models of grid cell firing”.</p>
<p>We therefore deviated from these traditional approaches of investigating the nature of grid cell properties and asked the question: Is there a brain function that could either not be performed at all or would be substantially more costly or difficult to perform in the absence of grid cells? To constrain our search for such a function, we assumed that any coding mechanisms that operates on spatial firing requires cell sequences as a fundamental neural syntax in the brain<sup><xref ref-type="bibr" rid="c32">32</xref>–<xref ref-type="bibr" rid="c34">34</xref></sup>. Recent studies provided compelling evidence for sequential activity of neurons representing spatial trajectories. In particular, Gardner et al. (2022) demonstrated that the sequential activity of hundreds of simultaneously recorded grid cells in freely foraging rats represented spatial trajectories. Complementary preliminary results indicate that grid cells exhibit left-right-alternating “theta sweeps,” characterized by temporally compressed sequences of spiking activity that encode outwardly oriented trajectories from the current location<sup><xref ref-type="bibr" rid="c74">74</xref></sup>.</p>
<p>The concept of sequential grid cell activity extends beyond spatial coding. In various experimental contexts, grid cells have been shown to encode non-spatial variables. For instance, in a stationary auditory task, grid cells fired at specific sounds along a continuous frequency axis<sup><xref ref-type="bibr" rid="c75">75</xref></sup>. Further studies revealed that grid cell sequences also represent elapsed time and distance traversed, such as during a delay period in a spatial alternation task<sup><xref ref-type="bibr" rid="c52">52</xref></sup>(Kraus et al., 2015). Similar findings were reported for elapsed time encoded by grid cell sequences in mice performing a virtual “Door Stop” task<sup><xref ref-type="bibr" rid="c76">76</xref></sup>.</p>
<p>Additionally, spatial trajectories represented by temporally compressed grid cell sequences have been observed during sleep as replay events<sup><xref ref-type="bibr" rid="c77">77</xref>,<xref ref-type="bibr" rid="c78">78</xref></sup>. Collectively, these studies demonstrate that sequential activity of neurons within the MEC, particularly grid cells, consistently encodes ordered experiences, suggesting a fundamental role for temporal structure in neuronal representations.</p>
<p>The theoretical underpinnings of grid cell activity coding for ordered experiences have been explored previously by Rueckemann et al. (2021) who argued that the temporal order in grid cell activation allows for the construction of topologically meaningful representations, or neural codes, grounded in the sequential experience of events or spatial locations. However, while Rueckemann et al. argue that the MEC supports temporally ordered representations through grid cell activity, our findings suggest an inverse relationship: namely, that grid cell activity emerges from temporally ordered spatial experiences. Additional studies demonstrate that hippocampal place cells may derive their spatial coding properties from higher-order sequence learning that integrates sensory and motor inputs<sup><xref ref-type="bibr" rid="c79">79</xref></sup> and that hexagonal grids, if assumed a priori, optimally encode transitions in spatiotemporal sequences<sup><xref ref-type="bibr" rid="c80">80</xref></sup>.</p>
<p>Together, experimental and theoretical evidence demonstrate the significance of sequential neuronal activity within the hippocampus and entorhinal cortex as a core mechanism for representing both spatial and temporal information and experiences.</p>
<p>Assuming that neural coding of trajectories in 2-D space is important for animal navigation and implemented by neural sequences, we show that grid cells are the most effective solution to coding of trajectories by neural sequences. We demonstrate that 7 cells are sufficient to provide an unambiguous code for trajectories in 2-D space and that the only two possible solutions with 7 cells result in firing fields that fall on a hexagonal grid. Notably, these two solutions result in grid maps that are mirror images of each other up to relabeling the cells. Any other solution to the problem would require at least 8 cells, an increase in the number of cells forming a grid by more than 14%. Note that an increase in the number of cells within one grid would not result in an increase in spatial or angular resolution in the coding of trajectories. It can therefore be reasoned that performing the same computational function with the minimum number of cells forming a grid is evolutionary advantageous because it conserves space, cellular material, energy, and resources<sup><xref ref-type="bibr" rid="c81">81</xref></sup>. A solution to a sequence code of trajectories that builds on fundamental units of only 7 grid cells compared to a larger number of cells would then be expected to be most frequently adopted. We therefore argue that we have provided a likely teleological cause for the existence of grid cells and an answer to the fundamental question of why grid cells have emerged in brains of navigating animals, namely that grid cells are the most parsimonious solution to sequence coding of trajectories in 2-D space.</p>
</sec>
<sec id="s3b">
<title>Comparison to normative models of grid cell firing</title>
<p>Normative models generally fall into two classes: One that uses artificial neural network models and one that uses a mathematical or analytical approach. Grid-like firing has been found to emerge in artificial neural networks when the models were trained to perform path integration<sup><xref ref-type="bibr" rid="c80">80</xref></sup> under simple biologically plausible constraints. The emerged grid cells then endowed agents with the ability to perform vector-based navigation<sup><xref ref-type="bibr" rid="c37">37</xref>,<xref ref-type="bibr" rid="c70">70</xref></sup>. While these models demonstrate that path integration is an important driving force in the generation of grid cells, the mechanism that is generating grid cell firing patterns remains obscure due to the untransparent nature of neural networks. Moreover, the results often depend on specific hyperparameter choices to explain the emergence of grid-like elements under anatomical constraints (see<sup><xref ref-type="bibr" rid="c72">72</xref></sup> for a discussion). In contrast, we have provided mathematical proof that spatial periodicity of firing fields emerges from a sequence code of trajectories in 2-D space and that the most parsimonious solution with only seven cells results in hexagonal lattice packing.</p>
</sec>
<sec id="s3c">
<title>Sequence coding of trajectories by grid cells provides a mechanistic explanation for how grid cells serve path integration and can support memory-guided navigation</title>
<p>If the step-by-step advancements from the currently active cell to the next cell in the grid cell sequence are caused by integrating velocity signals, grid cells perform path integration. The ensuing grid cell sequence is then the result of the path integration and can be interpreted as a sequence code by a downstream reader, potentially the hippocampus. While the sequence code of trajectories-model of grid cell firing is agnostic about the neural mechanisms that implements the sequence code, one plausible implementation is a continuous attractor network<sup><xref ref-type="bibr" rid="c5">5</xref>,<xref ref-type="bibr" rid="c25">25</xref></sup>. Interestingly, a sequence code of trajectories begets conformal isometry in the attractor network, i.e., a trajectory in neural space is proportional to a trajectory of an animal in physical space. Different grid cell modules integrate velocity signals at different (spatial) scales that are determined by the distance between the grid field centers of adjacent cells in the sequence. A sequence code of trajectories by grid cells therefore provides a mechanistic explanation for the functional role of grid cells in path integration. The model described in this paper can be implemented with temporal coding (spiking neurons) or rate coding, or even with binary activity states of neurons, where neurons are activated sequentially as a function of the animal’s velocity. Previous modeling work has shown that circuit mechanisms using grid cells in combination with speed-modulated head direction cells and hippocampal place cells can provide a substrate for episodic encoding and retrieval of spatiotemporal trajectories<sup><xref ref-type="bibr" rid="c7">7</xref></sup>. Furthermore, grid cell sequences have been shown to be useful in simulations of new goal-directed trajectories, where grid cells were used in a network of head direction cells, hippocampal place cells and persistent spiking cells to plan forward trajectories through the environment that search for place cells near a goal location<sup><xref ref-type="bibr" rid="c19">19</xref></sup>. Recent experimental data demonstrate that temporally coordinated entorhinal inputs drive hippocampal sequences to perform memory-guided navigation<sup><xref ref-type="bibr" rid="c31">31</xref></sup> and that temporally structured population activity of grid and place cells represent local trajectories essential for goal-directed navigation and planning<sup><xref ref-type="bibr" rid="c82">82</xref></sup>.</p>
<p>As part of the proof that a trajectory code by cell sequences begets spatially periodic firing fields, we proved that the centers of the firing fields must be arranged in a hexagonal lattice. This arrangement implies that the neural space is a conformally isometric embedding of physical space, so that local displacements in neural space are proportional to local displacements of an animal or agent in physical space, as illustrated in <xref rid="fig5" ref-type="fig">Figure 5</xref>. This property has recently been introduced in the grid cell literature as the conformal isometry hypothesis<sup><xref ref-type="bibr" rid="c83">83</xref>,<xref ref-type="bibr" rid="c84">84</xref></sup>. Strikingly, Schøyen et al.<sup><xref ref-type="bibr" rid="c84">84</xref></sup> arrive at similar if not identical conclusions regarding the geometric principles in the neural representations of space by grid cells.</p>
<p>It would provide an advantage to animals if they could plan trajectories towards goals on different spatial scales to “zoom in” or “zoom out” on a cogntive map of their environment. We therefore proposed that each grid module represents trajectories at progressively lower or higher resolution to enable planning of trajectories across different spatial scales. This approach is analogous to mip mapping known from computer graphics, where an image is sampled by a stack of images, each of which is represented with half the resolution of the previous to increase rendering performance<sup><xref ref-type="bibr" rid="c68">68</xref></sup>. A similar idea has previously been implemented in a scale-space model of grid cells<sup><xref ref-type="bibr" rid="c85">85</xref></sup>. It remains to be tested experimentally whether grid cell modules primarily serve the coding of spatial location or a multiscale representation of spatial trajectories. Furthermore, it remains to be shown why the scaling factor used in the grid cell system is 2 and not smaller or larger than 2. Interestingly, a scale ratio of 2 is commonly used in computer vision, specifically in the context of mipmapping and Gaussian pyramids using Gaussion filter kernels to render images across different spatial scales while allowing a smooth and balanced transition between successive levels of an image pyramid <sup><xref ref-type="bibr" rid="c86">86</xref>,<xref ref-type="bibr" rid="c87">87</xref></sup>. Examining whether larger factors lead to an excessive loss of detail between spatial scales, while smaller factors fail to sufficiently reduce the spatial scale to justify additional computational levels, represents a promising direction for future research.</p>
<p>The grid cell model presented in this study assumes complete tiling of space and equal representation of traveling direction. If this assumption was relaxed, there would be gaps in the representation of space and some traveling directions would be represented with larger or smaller fields, hence with smaller or larger angular resolution, respectively (see <xref rid="fig1" ref-type="fig">Figures 1F</xref><bold> and </bold><xref rid="fig1" ref-type="fig">1G</xref>). However, path integration performed by animals is far from being perfect, and it would be of interest for future work to investigate whether non-ideal tiling of space by grid cells may be one of many factors contributing to errors in path integration<sup><xref ref-type="bibr" rid="c35">35</xref>,<xref ref-type="bibr" rid="c36">36</xref></sup>. One potential mechanism to compensate for non-ideal tiling of space is population coding. Grid cells are part of grid cell assemblies, and the population activity of grid cell assemblies can be interpreted by a reader mechanism as a robust population code.</p>
<p>Notably, the trajectory code itself does <italic>not</italic> require anchoring to a reference frame to perform local path integration. Because of the local nature of the trajectory code, path integration can be performed locally without the emergence of a global grid pattern. This has been shown experimentally in mice performing a path integration task where changes in the location of a task-relevant object resulted in translations of grid patterns in single trials <sup><xref ref-type="bibr" rid="c88">88</xref></sup>. Although no global grid pattern was observed because the reference frame was not fixed in space, grid cells performed path integration locally within the reference frame defined by the moving task-relevant object, and grid patterns were visible when the changes in the references frames were accounted for in computing the rate maps.</p>
<p>Sequence coding of trajectories is not limited to physical space but could be useful for cognitive functions such as working memory or episodic memory that connects events into a cohesive story, consistent with experimental data demonstrating a grid-like code of conceptual knowledge space in humans<sup><xref ref-type="bibr" rid="c10">10</xref></sup>. A sequence code of trajectories by grid cells can thus explain data from human subjects that link reduced grid-like activity with path integration deficits observed in Alzheimer’s disease risk carriers<sup><xref ref-type="bibr" rid="c89">89</xref>,<xref ref-type="bibr" rid="c90">90</xref></sup>, and data from rodent experiments demonstrating that grid cell firing is reduced in a rodent animal model of Alzheimer’s disease<sup><xref ref-type="bibr" rid="c91">91</xref>,<xref ref-type="bibr" rid="c92">92</xref></sup>.</p>
</sec>
<sec id="s3d">
<title>Sequence coding of trajectories in 3D space</title>
<p>There is no reason to assume that the sequence code of trajectories described in this study is restricted to 2-D space. We have discussed in previous paragraphs how a sequence code of trajectories by grid cells can code for trajectories in 1-D space. In principle, such a sequence code can be expanded to three-dimensional (3D) or higher dimensional spaces. However, there are multiple equally optimal possibilities to generate a close-packed arrangement of firing fields in 3D space<sup><xref ref-type="bibr" rid="c93">93</xref>,<xref ref-type="bibr" rid="c94">94</xref></sup>, where each sphere touches 12 neighboring spheres. Two examples of lattice packings in 3D that achieve this kissing number are the face-centered cubic and hexagonal close packed arrangements, which both have layers arranged in hexagonal lattices but stack the layers differently<sup><xref ref-type="bibr" rid="c95">95</xref></sup>. A model based on a sequence code of trajectories by grid cells would therefore predict larger variability in spatial periodicity of grid cell firing in 3D space compared to 2-D space. It remains to be determined whether specific solutions to cell sequence coding of trajectories in 3D space could result in local or global symmetries. The distribution of grid cell firing fields in rats exploring a 3D volumetric space is irregular<sup><xref ref-type="bibr" rid="c96">96</xref></sup>. However, since sequences need to repeat, cell sequence coding of trajectories in 3D space predicts some degree of local order in the grid map of a single grid cell. Consistent with this prediction, experimental data show that grid cells recorded in flying bats exhibit fixed local distances between firing fields despite the lack of a global lattice arrangement of firing fields<sup><xref ref-type="bibr" rid="c97">97</xref></sup>. Taken together, these experimental data are consistent with a sequence code of trajectories that expands to 3D space, even though this sequence coding may not need to result in a globally symmetric arrangement of the firing fields of a single cell. Based on data from animals navigating in 3D environments, it has recently been proposed that the characteristic hexagonal firing pattern of grid cells is a “by-product of whatever process causes the cells to fire in spatially discrete regions of uniform size.”<sup><xref ref-type="bibr" rid="c98">98</xref></sup> This study demonstrates that said process is a neural sequence code of trajectories.</p>
</sec>
<sec id="s3e">
<title>Limitations of the study</title>
<p>This study demonstrates a teleological cause for the existence of grid cells, namely sequence coding of trajectories in 2-D. The goal of this study was thus not to provide a mechanistic model of grid cells or biologically-detailed model of the connections between neurons that can mechanistically account for grid cell firing. The model thus remains agnostic about the specific mechanistic implementation as to how a velocity signal is integrated in entorhinal circuits to move activity from one neuron in the sequence to the next neuron in the sequence as a function of the animal’s velocity and makes no predictions about connectivity between neuron types and the connenction strengths.</p>
<p>While we have demonstrated that the ratio of grid field spacing to grid field size in an experimental data set of grid cells obtained from mice is consistent with the prediction made by the trajectory code by neural sequences model of grid cell firing, we acknowledge that future studies should test this model prediction on larger data sets obtained from other species and recorded across different grid cell modules.</p>
</sec>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Key resources table</title>
<table-wrap id="utbl1" orientation="portrait" position="float">
<graphic xlink:href="542747v5_utbl1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
</sec>
<sec id="s4b" sec-type="data-availability">
<title>Data and code availability</title>
<p>This paper analyzes existing, previously published data. The accession numbers for the datasets are listed in the key resources table. All original code has been deposited on GitHub and is publicly available, and DOIs are listed in the key resources table. Any additional information required to reanalyze the data reported in this work is available from the lead contact upon request.</p>
</sec>
<sec id="s4c">
<title>Math notations</title>
<p>A <italic>theorem</italic> is a mathematical statement that can be proved using logical deduction from previously known results.</p>
<p>A <italic>proof</italic> is a logical argument using known results to generate new mathematical statements. The purpose of a proof is to convince the reader that the result follows from known results.</p>
<p>A <italic>plane</italic> is a flat surface extending infinitely far in two dimensions. Also referred to as ℝ<sup>2</sup>, since it can be assigned coordinates of the form (a, b) where a and b are real numbers.</p>
<p>A <italic>Euclidean metric</italic> is the usual notion of distance in the plane. Two points with coordinates (<italic>x</italic><sub>1</sub>, <italic>y</italic><sub>1</sub>) and (<italic>x</italic><sub>2</sub>, <italic>y</italic><sub>2</sub>) have distance <inline-formula><inline-graphic xlink:href="542747v5_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
<p><italic>Adding points</italic> means adding their coordinates, <italic>subtracting one point from another</italic> involves subtracting their coordinates.</p>
<p>A <italic>bijective map</italic> is a correspondence between two sets such that every point in one set is matched with exactly one point in the other set.</p>
<p>A <italic>geometric figure</italic> is a geometric object with a shape in the plane.</p>
<p>We work in ℝ<sup>2</sup> (the plane), with the Euclidean metric.</p>
</sec>
<sec id="s4d">
<title>Quantification and statistical analysis</title>
<sec id="s4d1">
<title>Prediction of ratio between grid field spacing and grid field size</title>
<p>The grid field spacing <italic><bold>s</bold></italic> was computed as a multiple of the diameter <italic><bold>d</bold></italic> of a circular grid field for a grid unit with seven cells. Using the Pythagorean theorem, we can write:
<disp-formula>
<graphic xlink:href="542747v5_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s4d2">
<title>Quantification of grid field spacing and grid field size in experimental data</title>
<p>Since the characteristic feature of a firing field is its firing rate, we chose to use a threshold for the firing rate to determine the field boundaries. Notably, choosing the threshold too low will result in firing fields that are too large and that will merge with each other, thus not allowing identification of individual fields. However, choosing the threshold too high will result in measurements of field sizes that are too small. To avoid bias regarding the predicted value, the person performing the analysis was blinded towards the value predicted by the sequence model of grid cells.</p>
</sec>
<sec id="s4d3">
<title>Field Detection Software Design</title>
<p>Software was created to automatically detect grid cell fields. Those detected fields are used to find the mean field size and spacing for each cell. Open source code for the software is available at github.com/Hippocampome-Org/gridcell_metrics. The code includes data for all cells used for analyses in this article, and allows a user to reproduce the field detection results. The software detects grid fields by the use of a threshold to filter out out-of-field firing. Out-of-field firing is approximated by firing at a location with a firing rate below a specified percentage relative to the peak firing rate given an animal location. The code performs grid field detection using the spatial autocorrelogram of the cell’s firing rate map. The firing rate map was generated by dividing the open-field environment into 3 cm spatial bins and computing, for each spatial bin, the occupancy-normalized spiking rate as described in Dannenberg et al. (2020)<sup><xref ref-type="bibr" rid="c45">45</xref></sup>. Rate maps were then smoothed by a 3 cm wide two-dimensional Gaussian kernel.</p>
<p>The objective of the software is to only analyze the most central field and the six closest fields surrounding it to avoid complications with analyzing fields that contact borders of a plot and have part of their areas missing due to their fields extending past the border. Other fields are detected but not saved for analyses. The DBSCAN clustering algorithm from MATLAB’s (<ext-link ext-link-type="uri" xlink:href="https://mathworks.com">mathworks.com</ext-link>) Statistics and Machine Learning Toolbox is used to automatically separate the field data into clusters. Each cluster represents a detected field area. The field centers are computed as the centroids of the detected clusters. The positions of centroids are computed by calculating the mean of all pixels on the x-axis and y-axis of a field cluster and taking the mean x-axis and y-axis values as the coordinates of the centroid for each field. The area of each field is calculated as the number of pixels in the field. The spacing between fields is calculated as the Euclidean distance between field centroids. The mean spacing value is computed from 6 measurements of the spacings from the center field to each of the 6 surrounding fields. The grid field size is computed as the mean of a diameter-like metric from each fields’ area. The diameter-like metric <italic>d</italic> uses the formula for finding a circle diameter given its area, namely <inline-formula><inline-graphic xlink:href="542747v5_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The ratio of field spacing to field size is then computed as the field spacing divided by the field size.</p>
</sec>
<sec id="s4d4">
<title>Assessment of Field Detection Software Performance</title>
<p>The grid field detection algorithm performed best (measured as the percentage of cells where grid fields could be detected) with the threshold set to 31% (Supplementary Figure S2B). The evaluation of performance was based on data from 27 grid cell recording files that were a part of a previously published study by Dannenberg et al., (2020)<sup><xref ref-type="bibr" rid="c45">45</xref></sup>. Only recording files from baseline conditions (the “Light” condition in Dannenberg et al., 2020<sup><xref ref-type="bibr" rid="c45">45</xref></sup>) were analyzed. Grid cells that met a minimal grid score threshold of 0.19 were included. The grid score was computed as described in Dannenberg et al. (2020)<sup><xref ref-type="bibr" rid="c45">45</xref></sup>. Effective field detection by the software was confirmed by the experimenter as (1) the intended number of fields being detected (center field in plot and 6 closest to it) and (2) the fields being detected without merging of grid fields compared to visual inspection of the cells’ firing rate map. Grid cells that did not have effective field detection by the software were not included in ratio measurements. The software-computed size of grid fields is a function of a threshold parameter that was constant for all cells and was chosen to optimize performance of the software such that the number of grid cells for which the software detected grid fields was maximal. Since the threshold was constant for all cells, field sizes could appear larger or smaller relative to estimated field sizes based on visual inspection of rate maps. However, this was not determined to be a reason to exclude a cell for analysis with the threshold parameter that detected those sizes. Evaluating what size is large or small is considered to be subjective and such a subjective evaluation was avoided to benefit the ability to reproduce results. Small field detection at some thresholds is a known issue that can be addressed further in future work.</p>
</sec>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>This work was supported by the National Institute of Neurological Disorders and Stroke of the National Institutes of Health, grant numbers R00NS116129 to H.D. and R01NS39600 to G.A.A. Thank you to Harrison Bray for helpful conversations about lattice packings, and thank you to Xihui Zheng for help with graphical illustrations. We thank Michael E. Hasselmo for sharing data with us and for comments on the manuscript. We thank Marc W. Howard for helpful comments on the manuscript.</p>
</ack>
<sec id="suppd1e1869" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="d1e1831">
<label>Video animation</label>
<media xlink:href="supplements/542747_file02.mp4"/>
</supplementary-material>
<supplementary-material id="d1e1838">
<label>Supplementary Figure S1</label>
<media xlink:href="supplements/542747_file03.pdf"/>
</supplementary-material>
<supplementary-material id="d1e1845">
<label>Supplementary Figure S2</label>
<media xlink:href="supplements/542747_file04.pdf"/>
</supplementary-material>
<supplementary-material id="d1e1852">
<label>Supplementary Figure S3</label>
<media xlink:href="supplements/542747_file05.pdf"/>
</supplementary-material>
<supplementary-material id="d1e1860">
<label>Supplementary Figure S4</label>
<media xlink:href="supplements/542747_file06.pdf"/>
</supplementary-material>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Molden</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Witter</surname>, <given-names>M. P.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>M.-B</given-names></string-name></person-group>. <article-title>Spatial representation in the entorhinal cortex</article-title>. <source>Science</source> <volume>305</volume>, <fpage>1258</fpage>–<lpage>1264</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hafting</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Molden</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>E. I</given-names></string-name></person-group>. <article-title>Microstructure of a spatial map in the entorhinal cortex</article-title>. <source>Nature</source> <volume>436</volume>, <fpage>801</fpage>–<lpage>806</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boccara</surname>, <given-names>C. N.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Grid cells in pre- and parasubiculum</article-title>. <source>Nat. Neurosci</source>. <volume>13</volume>, <fpage>987</fpage>–<lpage>994</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fuhs</surname>, <given-names>M. C.</given-names></string-name> &amp; <string-name><surname>Touretzky</surname>, <given-names>D. S</given-names></string-name></person-group>. <article-title>A spin glass model of path integration in rat medial entorhinal cortex</article-title>. <source>J. Neurosci. Off. J. Soc. Neurosci</source>. <volume>26</volume>, <fpage>4266</fpage>–<lpage>4276</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McNaughton</surname>, <given-names>B. L.</given-names></string-name>, <string-name><surname>Battaglia</surname>, <given-names>F. P.</given-names></string-name>, <string-name><surname>Jensen</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>M.-B</given-names></string-name></person-group>. <article-title>Path integration and the neural basis of the ‘cognitive map’</article-title>. <source>Nat Rev Neurosci</source> <volume>7</volume>, <fpage>663</fpage>–<lpage>678</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name> &amp; <string-name><surname>McNaughton</surname>, <given-names>B. L</given-names></string-name></person-group>. <article-title>Spatial representation in the hippocampal formation: a history</article-title>. <source>Nat. Neurosci</source>. <volume>20</volume>, <fpage>1448</fpage>–<lpage>1464</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hasselmo</surname>, <given-names>M. E</given-names></string-name></person-group>. <article-title>A model of episodic memory: mental time travel along encoded trajectories using grid cells</article-title>. <source>Neurobiol. Learn. Mem</source>. <volume>92</volume>, <fpage>559</fpage>–<lpage>573</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eichenbaum</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Cohen</surname>, <given-names>N. J</given-names></string-name></person-group>. <article-title>Can we reconcile the declarative memory and spatial navigation views on hippocampal function?</article-title> <source>Neuron</source> <volume>83</volume>, <fpage>764</fpage>–<lpage>770</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schiller</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Memory and Space: Towards an Understanding of the Cognitive Map</article-title>. <source>J. Neurosci. Off. J. Soc. Neurosci</source>. <volume>35</volume>, <fpage>13904</fpage>–<lpage>13911</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Constantinescu</surname>, <given-names>A. O.</given-names></string-name>, <string-name><surname>O’Reilly</surname>, <given-names>J. X.</given-names></string-name> &amp; <string-name><surname>Behrens</surname>, <given-names>T. E. J</given-names></string-name></person-group>. <article-title>Organizing conceptual knowledge in humans with a gridlike code</article-title>. <source>Science</source> <volume>352</volume>, <fpage>1464</fpage>–<lpage>1468</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hawkins</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Lewis</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Klukas</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Purdy</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Ahmad</surname>, <given-names>S</given-names></string-name></person-group>. <article-title>A Framework for Intelligence and Cortical Function Based on Grid Cells in the Neocortex</article-title>. <source>Front. Neural Circuits</source> <volume>12</volume>, <fpage>121</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rueckemann</surname>, <given-names>J. W.</given-names></string-name>, <string-name><surname>Sosa</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Giocomo</surname>, <given-names>L. M.</given-names></string-name> &amp; <string-name><surname>Buffalo</surname>, <given-names>E. A</given-names></string-name></person-group>. <article-title>The grid code for ordered experience</article-title>. <source>Nat. Rev. Neurosci</source>. <volume>22</volume>, <fpage>637</fpage>–<lpage>649</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jeffery</surname>, <given-names>K. J</given-names></string-name></person-group>. <article-title>The mosaic structure of the mammalian cognitive map</article-title>. <source>Learn. Behav</source>. <volume>52</volume>, <fpage>19</fpage>–<lpage>34</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ginosar</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Aljadeff</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Las</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Derdikman</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Ulanovsky</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>Are grid cells used for navigation? On local metrics, subjective spaces, and black holes</article-title>. <source>Neuron</source> <volume>111</volume>, <fpage>1858</fpage>–<lpage>1875</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sreenivasan</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Fiete</surname>, <given-names>I</given-names></string-name></person-group>. <article-title>Grid cells generate an analog error-correcting code for singularly precise neural computation</article-title>. <source>Nat. Neurosci</source>. <volume>14</volume>, <fpage>1330</fpage>–<lpage>1337</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathis</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Herz</surname>, <given-names>A. V. M.</given-names></string-name> &amp; <string-name><surname>Stemmler</surname>, <given-names>M</given-names></string-name></person-group>. <article-title>Optimal population codes for space: grid cells outperform place cells</article-title>. <source>Neural Comput</source>. <volume>24</volume>, <fpage>2280</fpage>–<lpage>2317</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wei</surname>, <given-names>X.-X.</given-names></string-name>, <string-name><surname>Prentice</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Balasubramanian</surname>, <given-names>V</given-names></string-name></person-group>. <article-title>A principle of economy predicts the functional architecture of grid cells</article-title>. <source>eLife</source> <volume>4</volume>, <elocation-id>e08362</elocation-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bush</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Manson</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>Using Grid Cells for Navigation</article-title>. <source>Neuron</source> <volume>87</volume>, <fpage>507</fpage>–<lpage>520</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Erdem</surname>, <given-names>U. M.</given-names></string-name> &amp; <string-name><surname>Hasselmo</surname>, <given-names>M. E</given-names></string-name></person-group>. <article-title>A biologically inspired hierarchical goal directed navigation model</article-title>. <source>J. Physiol. Paris</source> <volume>108</volume>, <fpage>28</fpage>–<lpage>37</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Keefe</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>Dual phase and rate coding in hippocampal place cells: theoretical significance and relationship to entorhinal grid cells</article-title>. <source>Hippocampus</source> <volume>15</volume>, <fpage>853</fpage>–<lpage>866</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burgess</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>O’Keefe</surname>, <given-names>J</given-names></string-name></person-group>. <article-title>An oscillatory interference model of grid cell firing</article-title>. <source>Hippocampus</source> <volume>17</volume>, <fpage>801</fpage>–<lpage>812</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giocomo</surname>, <given-names>L. M.</given-names></string-name>, <string-name><surname>Zilli</surname>, <given-names>E. A.</given-names></string-name>, <string-name><surname>Fransén</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Hasselmo</surname>, <given-names>M. E</given-names></string-name></person-group>. <article-title>Temporal frequency of subthreshold oscillations scales with entorhinal grid cell field spacing</article-title>. <source>Science</source> <volume>315</volume>, <fpage>1719</fpage>–<lpage>1722</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hasselmo</surname>, <given-names>M. E.</given-names></string-name>, <string-name><surname>Giocomo</surname>, <given-names>L. M.</given-names></string-name> &amp; <string-name><surname>Zilli</surname>, <given-names>E. A</given-names></string-name></person-group>. <article-title>Grid cell firing may arise from interference of theta frequency membrane potential oscillations in single neurons</article-title>. <source>Hippocampus</source> <volume>17</volume>, <fpage>1252</fpage>–<lpage>1271</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>Grid cells and theta as oscillatory interference: theory and predictions</article-title>. <source>Hippocampus</source> <volume>18</volume>, <fpage>1157</fpage>–<lpage>1174</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burak</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Fiete</surname>, <given-names>I. R</given-names></string-name></person-group>. <article-title>Accurate path integration in continuous attractor network models of grid cells</article-title>. <source>PLoS Comput. Biol</source>. <volume>5</volume>, <fpage>e1000291</fpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shipston-Sharman</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Solanka</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Nolan</surname>, <given-names>M. F</given-names></string-name></person-group>. <article-title>Continuous attractor network models of grid cell firing based on excitatory-inhibitory interactions</article-title>. <source>J. Physiol</source>. <volume>594</volume>, <fpage>6547</fpage>–<lpage>6557</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zilli</surname>, <given-names>E. A</given-names></string-name></person-group>. <article-title>Models of grid cell spatial firing published 2005-2011</article-title>. <source>Front. Neural Circuits</source> <volume>6</volume>, <fpage>16</fpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Couey</surname>, <given-names>J. J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Recurrent inhibitory circuitry as a mechanism for grid formation</article-title>. <source>Nat. Neurosci</source>. <volume>16</volume>, <fpage>318</fpage>–<lpage>324</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zutshi</surname>, <given-names>I.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Recurrent circuits within medial entorhinal cortex superficial layers support grid cell firing</article-title>. <source>Nat. Commun</source>. <volume>9</volume>, <fpage>3701</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Marr</surname>, <given-names>D.</given-names></string-name></person-group> <source>Vision: A Computational Investigation into the Human Representation and Processing of Visual Information</source>. (<publisher-name>MIT Press</publisher-name>, <publisher-loc>Cambridge, Mass.</publisher-loc>, <year>2010</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Todorova</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Tang</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Oliva</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Fernandez-Ruiz</surname>, <given-names>A</given-names></string-name></person-group>. <article-title>Associative and predictive hippocampal codes support memory-guided behaviors</article-title>. <source>Science</source> <volume>382</volume>, <fpage>eadi8237</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buzsáki</surname>, <given-names>G</given-names></string-name></person-group>. <article-title>Neural syntax: cell assemblies, synapsembles, and readers</article-title>. <source>Neuron</source> <volume>68</volume>, <fpage>362</fpage>–<lpage>385</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>McKenzie</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Davachi</surname>, <given-names>L.</given-names></string-name></person-group> <article-title>Neurophysiology of Remembering</article-title>. <source>Annu. Rev. Psychol.</source> <volume>73</volume>, <fpage>null</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zutshi</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Leutgeb</surname>, <given-names>J. K.</given-names></string-name> &amp; <string-name><surname>Leutgeb</surname>, <given-names>S</given-names></string-name></person-group>. <article-title>Theta sequences of grid cell populations can provide a movement-direction signal</article-title>. <source>Curr. Opin. Behav. Sci</source>. <volume>17</volume>, <fpage>147</fpage>–<lpage>154</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Impaired path integration and grid cell spatial periodicity in mice lacking GluA1-containing AMPA receptors</article-title>. <source>J. Neurosci. Off. J. Soc. Neurosci</source>. <volume>34</volume>, <fpage>6245</fpage>–<lpage>6259</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gil</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Impaired path integration in mice with disrupted grid cell firing</article-title>. <source>Nat. Neurosci</source>. <volume>21</volume>, <fpage>81</fpage>–<lpage>91</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sorscher</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Mel</surname>, <given-names>G. C.</given-names></string-name>, <string-name><surname>Ocko</surname>, <given-names>S. A.</given-names></string-name>, <string-name><surname>Giocomo</surname>, <given-names>L. M.</given-names></string-name> &amp; <string-name><surname>Ganguli</surname>, <given-names>S</given-names></string-name></person-group>. <article-title>A unified theory for the computational and mechanistic origins of grid cells</article-title>. <source>Neuron</source> <volume>111</volume>, <fpage>121</fpage>–<lpage>137.e13</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thue</surname>, <given-names>A</given-names></string-name></person-group>. <article-title>Über die dichteste Zusammenstellung von kongruenten Kreisen in einer Ebene</article-title>. <source>Norske Vid. Selsk. Skr</source>. <volume>1</volume>, <fpage>1</fpage>–<lpage>9</lpage> (<year>1910</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tóth</surname>, <given-names>L. F</given-names></string-name></person-group>. <article-title>Über die dichteste Kugellagerung</article-title>. <source>Math. Z</source>. <volume>48</volume>, <fpage>676</fpage>–<lpage>684</lpage> (<year>1942</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kittel</surname>, <given-names>C</given-names></string-name></person-group>. <source>Introduction to Solid State Physics</source>. (<publisher-name>Wiley</publisher-name>, <publisher-loc>New York ; London</publisher-loc>, <year>1966</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stensola</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Stensola</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>E. I</given-names></string-name></person-group>. <article-title>Shearing-induced asymmetry in entorhinal grid cells</article-title>. <source>Nature</source> <volume>518</volume>, <fpage>207</fpage>–<lpage>212</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gleeson</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Davison</surname>, <given-names>A. P.</given-names></string-name>, <string-name><surname>Silver</surname>, <given-names>R. A.</given-names></string-name> &amp; <string-name><surname>Ascoli</surname>, <given-names>G. A</given-names></string-name></person-group>. <article-title>A Commitment to Open Source in Neuroscience</article-title>. <source>Neuron</source> <volume>96</volume>, <fpage>964</fpage>–<lpage>965</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Hafting</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Witter</surname>, <given-names>M. P.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>M.-B</given-names></string-name></person-group>. <article-title>Grid cells in mice</article-title>. <source>Hippocampus</source> <volume>18</volume>, <fpage>1230</fpage>–<lpage>1238</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yartsev</surname>, <given-names>M. M.</given-names></string-name>, <string-name><surname>Witter</surname>, <given-names>M. P.</given-names></string-name> &amp; <string-name><surname>Ulanovsky</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>Grid cells without theta oscillations in the entorhinal cortex of bats</article-title>. <source>Nature</source> <volume>479</volume>, <fpage>103</fpage>–<lpage>107</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dannenberg</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lazaro</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Nambiar</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Hoyland</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Hasselmo</surname>, <given-names>M. E</given-names></string-name></person-group>. <article-title>Effects of visual inputs on neural dynamics for coding of location and running speed in medial entorhinal cortex</article-title>. <source>eLife</source> <volume>9</volume>, <elocation-id>e62500</elocation-id> (<year>2020</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sutton</surname>, <given-names>N. M.</given-names></string-name>, <string-name><surname>Gutiérrez-Guzmán</surname>, <given-names>B. E.</given-names></string-name>, <string-name><surname>Dannenberg</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Ascoli</surname>, <given-names>G. A</given-names></string-name></person-group>. <article-title>A Continuous Attractor Model with Realistic Neural and Synaptic Properties Quantitatively Reproduces Grid Cell Physiology</article-title>. <source>Int. J. Mol. Sci</source>. <volume>25</volume>, <fpage>6059</fpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Stensola</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name></person-group>, <year>2016</year>).<chapter-title>Grid Cells and Spatial Maps in Entorhinal Cortex and Hippocampus</chapter-title>. in <person-group person-group-type="editor"><string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Christen</surname>, <given-names>Y.</given-names></string-name></person-group><source>Micro-, Meso- and Macro-Dynamics of the Brain</source> (eds.  &amp; ) (<publisher-name>Springer, Cham (CH)</publisher-name>, ).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Derdikman</surname>, <given-names>D.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Fragmentation of grid cell maps in a multicompartment environment</article-title>. <source>Nat. Neurosci</source>. <volume>12</volume>, <fpage>1325</fpage>–<lpage>1332</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jacob</surname>, <given-names>P.-Y.</given-names></string-name>, <string-name><surname>Capitano</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Poucet</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Save</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Sargolini</surname>, <given-names>F</given-names></string-name></person-group>. <article-title>Path integration maintains spatial periodicity of grid cell firing in a 1D circular track</article-title>. <source>Nat. Commun</source>. <volume>10</volume>, <fpage>1</fpage>–<lpage>13</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pröll</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Häusler</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Herz</surname>, <given-names>A. V. M</given-names></string-name></person-group>. <article-title>Grid-Cell Activity on Linear Tracks Indicates Purely Translational Remapping of 2D Firing Patterns at Movement Turning Points</article-title>. <source>J. Neurosci. Off. J. Soc. Neurosci</source>. <volume>38</volume>, <fpage>7004</fpage>–<lpage>7011</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dombeck</surname>, <given-names>D. A.</given-names></string-name>, <string-name><surname>Harvey</surname>, <given-names>C. D.</given-names></string-name>, <string-name><surname>Tian</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Looger</surname>, <given-names>L. L.</given-names></string-name> &amp; <string-name><surname>Tank</surname>, <given-names>D. W</given-names></string-name></person-group>. <article-title>Functional imaging of hippocampal place cells at cellular resolution during virtual navigation</article-title>. <source>Nat. Neurosci</source>. <volume>13</volume>, <fpage>1433</fpage>–<lpage>1440</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kraus</surname>, <given-names>B. J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>During Running in Place, Grid Cells Integrate Elapsed Time and Distance Run</article-title>. <source>Neuron</source> <volume>88</volume>, <fpage>578</fpage>–<lpage>589</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Hayman</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Burgess</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Jeffery</surname>, <given-names>K. J</given-names></string-name></person-group>. <article-title>Experience-dependent rescaling of entorhinal grids</article-title>. <source>Nat. Neurosci</source>. <volume>10</volume>, <fpage>682</fpage>–<lpage>684</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wernle</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Integration of grid maps in merged environments</article-title>. <source>Nat. Neurosci</source>. <volume>21</volume>, <fpage>92</fpage>–<lpage>101</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Ginzberg</surname>, <given-names>L. L.</given-names></string-name>, <string-name><surname>O’Keefe</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>Grid cell firing patterns signal environmental novelty by expansion</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>109</volume>, <fpage>17687</fpage>–<lpage>17692</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Casali</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Bush</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Jeffery</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>Altered neural odometry in the vertical dimension</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>116</volume>, <fpage>4631</fpage>–<lpage>4636</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilson</surname>, <given-names>M. A.</given-names></string-name> &amp; <string-name><surname>McNaughton</surname>, <given-names>B. L</given-names></string-name></person-group>. <article-title>Dynamics of the hippocampal ensemble code for space</article-title>. <source>Science</source> <volume>261</volume>, <fpage>1055</fpage>–<lpage>1058</lpage> (<year>1993</year>).</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karlsson</surname>, <given-names>M. P.</given-names></string-name> &amp; <string-name><surname>Frank</surname>, <given-names>L. M</given-names></string-name></person-group>. <article-title>Network dynamics underlying the formation of sparse, informative representations in the hippocampus</article-title>. <source>J. Neurosci. Off. J. Soc. Neurosci</source>. <volume>28</volume>, <fpage>14271</fpage>–<lpage>14281</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boccara</surname>, <given-names>C. N.</given-names></string-name>, <string-name><surname>Nardin</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Stella</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>O’Neill</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Csicsvari</surname>, <given-names>J</given-names></string-name></person-group>. <article-title>The entorhinal cognitive map is attracted to goals</article-title>. <source>Science</source> <volume>363</volume>, <fpage>1443</fpage>–<lpage>1447</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Butler</surname>, <given-names>W. N.</given-names></string-name>, <string-name><surname>Hardcastle</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Giocomo</surname>, <given-names>L. M</given-names></string-name></person-group>. <article-title>Remembered reward locations restructure entorhinal spatial maps</article-title>. <source>Science</source> <volume>363</volume>, <fpage>1447</fpage>–<lpage>1452</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mehta</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>Quirk</surname>, <given-names>M. C.</given-names></string-name> &amp; <string-name><surname>Wilson</surname>, <given-names>M. A</given-names></string-name></person-group>. <article-title>Experience-dependent asymmetric shape of hippocampal receptive fields</article-title>. <source>Neuron</source> <volume>25</volume>, <fpage>707</fpage>–<lpage>715</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Rao</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Knierim</surname>, <given-names>J. J</given-names></string-name></person-group>. <article-title>A double dissociation between hippocampal subfields: differential time course of CA3 and CA1 place cells for processing changed environments</article-title>. <source>Neuron</source> <volume>42</volume>, <fpage>803</fpage>–<lpage>815</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Roth</surname>, <given-names>E. D.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Rao</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Knierim</surname>, <given-names>J. J</given-names></string-name></person-group>. <article-title>Functional differences in the backward shifts of CA1 and CA3 place fields in novel and familiar environments</article-title>. <source>PloS One</source> <volume>7</volume>, <fpage>e36035</fpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Geiller</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Fattahi</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Choi</surname>, <given-names>J.-S.</given-names></string-name> &amp; <string-name><surname>Royer</surname>, <given-names>S</given-names></string-name></person-group>. <article-title>Place cells are more strongly tied to landmarks in deep than in superficial CA1</article-title>. <source>Nat. Commun</source>. <volume>8</volume>, <fpage>14531</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dong</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Madar</surname>, <given-names>A. D.</given-names></string-name> &amp; <string-name><surname>Sheffield</surname>, <given-names>M. E. J</given-names></string-name></person-group>. <article-title>Distinct place cell dynamics in CA1 and CA3 encode experience in new environments</article-title>. <source>Nat. Commun</source>. <volume>12</volume>, <fpage>2977</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c66"><label>66.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ekstrom</surname>, <given-names>A. D.</given-names></string-name>, <string-name><surname>Meltzer</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>McNaughton</surname>, <given-names>B. L.</given-names></string-name> &amp; <string-name><surname>Barnes</surname>, <given-names>C. A</given-names></string-name></person-group>. <article-title>NMDA receptor antagonism blocks experience-dependent expansion of hippocampal ‘place fields’</article-title>. <source>Neuron</source> <volume>31</volume>, <fpage>631</fpage>–<lpage>638</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c67"><label>67.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stensola</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The entorhinal grid map is discretized</article-title>. <source>Nature</source> <volume>492</volume>, <fpage>72</fpage>–<lpage>78</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c68"><label>68.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><collab>Williams, L. Pyramidal parametrics. <italic>Proc</italic></collab></person-group>. <article-title>10th Annu</article-title>. <source>Conf. Comput. Graph. Interact. Tech</source>. (<year>1983</year>) doi:<pub-id pub-id-type="doi">10.1145/800059</pub-id>.</mixed-citation></ref>
<ref id="c69"><label>69.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathis</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Stemmler</surname>, <given-names>M. B.</given-names></string-name> &amp; <string-name><surname>Herz</surname>, <given-names>A. V</given-names></string-name></person-group>. <article-title>Probable nature of higher-dimensional symmetries underlying mammalian grid-cell activity patterns</article-title>. <source>eLife</source> <volume>4</volume>, (<year>2015</year>).</mixed-citation></ref>
<ref id="c70"><label>70.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Banino</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Vector-based navigation using grid-like representations in artificial agents</article-title>. <source>Nature</source> <volume>557</volume>, <fpage>429</fpage>–<lpage>433</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c71"><label>71.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Cueva</surname>, <given-names>C. J.</given-names></string-name> &amp; <string-name><surname>Wei</surname>, <given-names>X.-X.</given-names></string-name></person-group> <article-title>Emergence of grid-like representations by training recurrent neural networks to perform spatial localization</article-title>. <source>bioRxiv</source> <pub-id pub-id-type="doi">10.48550/arXiv.1803.07770</pub-id> (<year>2018</year>).</mixed-citation></ref>
<ref id="c72"><label>72.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Rylan</given-names> <surname>Schaeffer</surname></string-name>, <string-name><given-names>Mikail</given-names> <surname>Khona</surname></string-name>, &amp; <string-name><given-names>Ila Rani</given-names> <surname>Fiete</surname></string-name></person-group>. <article-title>No Free Lunch from Deep Learning in Neuroscience: A Case Study through Models of the Entorhinal-Hippocampal Circuit</article-title>. <source>bioRxiv</source> 2022.08.07.503109 (<year>2022</year>) doi:<pub-id pub-id-type="doi">10.1101/2022.08.07.503109</pub-id>.</mixed-citation></ref>
<ref id="c73"><label>73.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardner</surname>, <given-names>R. J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Toroidal topology of population activity in grid cells</article-title>. <source>Nature</source> <volume>602</volume>, <fpage>123</fpage>–<lpage>128</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c74"><label>74.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Vollan</surname>, <given-names>A. Z.</given-names></string-name>, <string-name><surname>Gardner</surname>, <given-names>R. J.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>E. I</given-names></string-name></person-group>. <article-title>Left-right-alternating theta sweeps in the entorhinal-hippocampal spatial map</article-title>. <source>bioRxiv</source>. <pub-id pub-id-type="doi">10.1101/2024.05.16.594473</pub-id> (<year>2024</year>).</mixed-citation></ref>
<ref id="c75"><label>75.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aronov</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Nevers</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Tank</surname>, <given-names>D. W</given-names></string-name></person-group>. <article-title>Mapping of a non-spatial dimension by the hippocampal-entorhinal circuit</article-title>. <source>Nature</source> <volume>543</volume>, <fpage>719</fpage>–<lpage>722</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c76"><label>76.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Heys</surname>, <given-names>J. G.</given-names></string-name> &amp; <string-name><surname>Dombeck</surname>, <given-names>D. A</given-names></string-name></person-group>. <article-title>Evidence for a subcircuit in medial entorhinal cortex representing elapsed time during immobility</article-title>. <source>Nat. Neurosci</source>. <volume>21</volume>, <fpage>1574</fpage>–<lpage>1582</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c77"><label>77.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ólafsdóttir</surname>, <given-names>H. F.</given-names></string-name>, <string-name><surname>Carpenter</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Barry</surname>, <given-names>C</given-names></string-name></person-group>. <article-title>Coordinated grid and place cell replay during rest</article-title>. <source>Nat. Neurosci</source>. <volume>19</volume>, <fpage>792</fpage>–<lpage>794</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c78"><label>78.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Neill</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Boccara</surname>, <given-names>C. N.</given-names></string-name>, <string-name><surname>Stella</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Schoenenberger</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Csicsvari</surname>, <given-names>J</given-names></string-name></person-group>. <article-title>Superficial layers of the medial entorhinal cortex replay independently of the hippocampus</article-title>. <source>Science</source> <volume>355</volume>, <fpage>184</fpage>–<lpage>188</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c79"><label>79.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Raju</surname>, <given-names>R. V.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Space is a latent sequence: A theory of the hippocampus</article-title>. <source>Sci. Adv</source>. <volume>10</volume>, <fpage>eadm8470</fpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c80"><label>80.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waniek</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>Hexagonal Grid Fields Optimally Encode Transitions in Spatiotemporal Sequences</article-title>. <source>Neural Comput</source>. <fpage>1</fpage>–<lpage>35</lpage> (<year>2018</year>) doi:<pub-id pub-id-type="doi">10.1162/neco_a_01122</pub-id>.</mixed-citation></ref>
<ref id="c81"><label>81.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Laughlin</surname>, <given-names>S. B.</given-names></string-name> &amp; <string-name><surname>Sejnowski</surname>, <given-names>T. J</given-names></string-name></person-group>. <article-title>Communication in Neuronal Networks</article-title>. <source>Science</source> <volume>301</volume>, <fpage>1870</fpage>–<lpage>1874</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c82"><label>82.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaudhuri-Vayalambrone</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Simultaneous representation of multiple time horizons by entorhinal grid cells and CA1 place cells</article-title>. <source>Cell Rep</source>. <volume>42</volume>, <issue>112716</issue> (<year>2023</year>).</mixed-citation></ref>
<ref id="c83"><label>83.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Xu</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Gao</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>W.-H.</given-names></string-name>, <string-name><surname>Wei</surname>, <given-names>X.-X.</given-names></string-name> &amp; <string-name><surname>Wu</surname>, <given-names>Y. N.</given-names></string-name></person-group> <article-title>An Investigation of Conformal Isometry Hypothesis for Grid Cells</article-title>. <source>bioRxiv</source> <pub-id pub-id-type="doi">10.48550/arXiv.2405.16865</pub-id> (<year>2024</year>).</mixed-citation></ref>
<ref id="c84"><label>84.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Schøyen</surname>, <given-names>V.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Hexagons all the way down: Grid cells as a conformal isometric map of space</article-title>.<source>bioRxiv</source>. <pub-id pub-id-type="doi">10.1101/2024.02.02.578585</pub-id> (<year>2024</year>).</mixed-citation></ref>
<ref id="c85"><label>85.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Waniek</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>Transition Scale-Spaces: A Computational Theory for the Discretized Entorhinal Cortex</article-title>. <source>Neural Comput</source>. <volume>32</volume>, <fpage>330</fpage>–<lpage>394</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c86"><label>86.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burt</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Adelson</surname>, <given-names>E</given-names></string-name></person-group>. <article-title>The Laplacian Pyramid as a Compact Image Code</article-title>. <source>IEEE Trans. Commun</source>. <volume>31</volume>, <fpage>532</fpage>– <lpage>540</lpage> (<year>1983</year>).</mixed-citation></ref>
<ref id="c87"><label>87.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Lindeberg</surname>, <given-names>T</given-names></string-name></person-group>. <source>Scale-Space. in Wiley Encyclopedia of Computer Science and Engineering 2495–2504</source> (<publisher-name>John Wiley &amp; Sons, Ltd</publisher-name>, <year>2008</year>). doi:<pub-id pub-id-type="doi">10.1002/9780470050118.ecse609</pub-id>.</mixed-citation></ref>
<ref id="c88"><label>88.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Peng</surname>, <given-names>J.-J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Grid cells perform path integration in multiple reference frames during self-motion-based navigation</article-title>. <source>bioRxiv</source> <pub-id pub-id-type="doi">10.1101/2023.12.21.572857</pub-id> (<year>2023</year>).</mixed-citation></ref>
<ref id="c89"><label>89.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kunz</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Reduced grid-cell-like representations in adults at genetic risk for Alzheimer’s disease</article-title>. <source>Science</source> <volume>350</volume>, <fpage>430</fpage>–<lpage>433</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c90"><label>90.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bierbrauer</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Unmasking selective path integration deficits in Alzheimer’s disease risk carriers</article-title>. <source>Sci. Adv</source>. <volume>6</volume>, <elocation-id>eaba1394</elocation-id> (<year>2020</year>).</mixed-citation></ref>
<ref id="c91"><label>91.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ying</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Disruption of the grid cell network in a mouse model of early Alzheimer’s disease</article-title>. <source>Nat. Commun</source>. <volume>13</volume>, <fpage>886</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c92"><label>92.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ying</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Reboreda</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Yoshida</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Brandon</surname>, <given-names>M. P</given-names></string-name></person-group>. <article-title>Grid cell disruption in a mouse model of early Alzheimer’s disease reflects reduced integration of self-motion cues</article-title>. <source>Curr. Biol. CB</source> <volume>33</volume>, <fpage>2425</fpage>–<lpage>2437.e5</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c93"><label>93.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stella</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Treves</surname>, <given-names>A</given-names></string-name></person-group>. <article-title>The self-organization of grid cells in 3D</article-title>. <source>eLife</source> <volume>4</volume>, <elocation-id>e05913</elocation-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c94"><label>94.</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><surname>Weisstein</surname>, <given-names>E. W.</given-names></string-name></person-group> <article-title>Sphere Packing</article-title>. <ext-link ext-link-type="uri" xlink:href="https://mathworld.wolfram.com/">https://mathworld.wolfram.com/</ext-link>. <year>no date</year></mixed-citation></ref>
<ref id="c95"><label>95.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Conway</surname>, <given-names>J. H.</given-names></string-name> &amp; <string-name><surname>Sloane</surname>, <given-names>N. J. A</given-names></string-name></person-group>. <source>Sphere Packings, Lattices, and Groups</source>. (<publisher-name>Springer</publisher-name>, <publisher-loc>New York</publisher-loc>, <year>1999</year>).</mixed-citation></ref>
<ref id="c96"><label>96.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grieves</surname>, <given-names>R. M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Irregular distribution of grid cell firing fields in rats exploring a 3D volumetric space</article-title>. <source>Nat. Neurosci</source>. <volume>24</volume>, <fpage>1567</fpage>–<lpage>1573</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c97"><label>97.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ginosar</surname>, <given-names>G.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Locally ordered representation of 3D space in the entorhinal cortex</article-title>. <source>Nature</source> <volume>596</volume>, <fpage>404</fpage>– <lpage>409</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c98"><label>98.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jeffery</surname>, <given-names>K. J</given-names></string-name></person-group>. <article-title>Symmetries and asymmetries in the neural encoding of 3D space</article-title>. <source>Philos. Trans. R. Soc. Lond. B. Biol. Sci</source>. <volume>378</volume>, <fpage>20210452</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c99"><label>99.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dannenberg</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Kelley</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Hoyland</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Monaghan</surname>, <given-names>C. K.</given-names></string-name> &amp; <string-name><surname>Hasselmo</surname>, <given-names>M. E</given-names></string-name></person-group>. <article-title>The Firing Rate Speed Code of Entorhinal Speed Cells Differs across Behaviorally Relevant Time Scales and Does Not Depend on Medial Septum Inputs</article-title>. <source>J. Neurosci</source>. <volume>39</volume>, <fpage>3434</fpage>–<lpage>3453</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c100"><label>100.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sargolini</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title>. <source>Science</source> <volume>312</volume>, <fpage>758</fpage>–<lpage>762</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c101"><label>101.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gatome</surname>, <given-names>C. W.</given-names></string-name>, <string-name><surname>Slomianka</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lipp</surname>, <given-names>H. P.</given-names></string-name> &amp; <string-name><surname>Amrein</surname>, <given-names>I</given-names></string-name></person-group>. <article-title>Number estimates of neuronal phenotypes in layer II of the medial entorhinal cortex of rat and mouse</article-title>. <source>Neuroscience</source> <volume>170</volume>, <fpage>156</fpage>–<lpage>165</lpage> (<year>2010</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96627.2.sa4</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Peyrache</surname>
<given-names>Adrien</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>McGill University</institution>
</institution-wrap>
<city>Montreal</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>valuable</bold> study presents a theoretical framework in which spatial periodicity in grid cell firing emerges as the optimal solution for encoding two-dimensional spatial trajectories via sequential neural activation. The idea is supported by <bold>solid</bold> evidence, though it rests on several key assumptions that merit careful consideration. This work will be of interest to neuroscientists investigating the neural mechanisms underlying spatial navigation.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96627.2.sa3</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This manuscript aims to explain the emergence of grid-like spatial firing patterns. Rather than taking the existence of grid cells as a given and asking what does their properties say about their function, the authors reverse the approach: they begin with a proposed computational function that the brain may need to perform-coding of 2D spatial trajectories using sequences of neural activity-and ask what type of neural code would optimally support this function. They show that, under a set of formal assumptions, such a code leads to the emergence of spatial periodicity and a hexagonal grid pattern. The aim is to provide a normative explanation for the existence of grid cells grounded in functional constraints.</p>
<p>Strengths:</p>
<p>The manuscript presents a mathematically well-defined framework that is internally consistent. The derivation is structured and leads to a hexagonal lattice as the most efficient solution for representing directional trajectories. The authors provide comparisons to experimental observations and extend the model to explain several findings in the grid cell literature. In the revised version, the discussion of foundational assumptions is expanded, and the manuscript better situates itself in relation to prior theoretical work. Overall, this work adds a very interesting view to the broader conversation about the role and origin of grid cells by offering a theoretical alternative grounded in trajectory coding.</p>
<p>Weaknesses:</p>
<p>The model depends on assumptions that, while plausible, should be treated as chosen assumptions. These include the premise that (1) grid function is trajectory coding, (2) that trajectory coding is implemented through sequences of neural activity, and (3) that such sequences are largely independent of spatial position. In the revised manuscript, the authors provide more literature to support these assumptions.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96627.2.sa2</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this work, the authors consider the required functional properties of neurons that trajectories in 2D space using cell sequences, ultimately linking the required properties to those found in grid cells. In their argument, the authors first introduce a set of definitions and axioms, which then lead to their conclusion that a hexagonal pattern is the most efficient or parsimonious pattern one could use to uniquely label different 2D trajectories using sequences of cells. The authors then go through a set of classic experimental results in the grid cell literature - e.g. that the grid modules exhibit a multiplicative scaling, that the grid pattern expands with novelty or is warped by reward, etc. - and describe how these results are either consistent with or predicted by their theory. Overall, this paper asks a very interesting question and provides an intriguing answer.</p>
<p>Major strengths:</p>
<p>The general idea behind the paper is very interesting - why *does* the grid pattern take the form of a hexagonal grid? This is a question that has been raised many times; finding a truly satisfying answer is difficult but of great interest. The authors' main assertion that the answer to this question has to do with the ability of a hexagonal arrangement of neurons to uniquely encode 2D trajectories is an intriguing suggestion. It is also impressive that the authors considered such a wide range of experimental results in relation to their theory.</p>
<p>Major weaknesses:</p>
<p>One weakness I perceive is that the paper overstates what it delivers. In the introduction, the authors claim to provide &quot;mathematical proof that ... the nature of the problem being solved by grid cells is coding of trajectories in 2-D space using cell sequences. By doing so, we offer a specific answer to the question of why grid cell firing patterns are observed in the mammalian brain.&quot; By virtue of the fact that the authors make assumptions about biological function in their claims, this paper does not provide proof of what grid cells are doing to support behavior nor provide the true answer as to why grid patterns are found in the brain. Although I find this study both intriguing and important - and I respect the authors' perspective - as an experimentalist guided by the principle that biological theories are never proven but instead continually supported by data, suggestions of a proof of grid cell function are hard for me to get behind. Regardless, the paper presents a compelling line of reasoning that enhance our understanding of grid cells.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96627.2.sa1</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Concerning the revised manuscript, the authors are to be commended for carefully addressing the reviewers' comments and updating the references cited.</p>
<p>I will differ with the authors' argument that Gardner et al's paper supports the idea of sequences, except in the most trivial sense, namely that topology implies continuity, and hence movement along the manifold will be continuous, and if one discretizes this movement, one would get a sequence.</p>
<p>This has very little to do with the idea that the authors propose in their manuscript. If the authors were to so choose, their idea will produce an embedded graph, and they could study the topology of this construct---but this would mean going off on a tangent.</p>
<p>Let us not hold up the authors to an impossible standard, namely that their theory should explain everything in the grid cell field. Not every finding under the sun needs be addressed in the discussion.</p>
<p>My own take on the manuscript had been that the authors' interesting idea might be fairly straightforwardly provable. The authors have decided to put another student on this particular project. That is perfectly OK. Just one final note: mathematically, the main focus ought to be on sequences of prime length (many other results will likely follow).</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96627.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>RG</surname>
<given-names>Rebecca</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7700-4312</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Ascoli</surname>
<given-names>Giorgio A</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0964-676X</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Sutton</surname>
<given-names>Nate M</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Dannenberg</surname>
<given-names>Holger</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0340-0128</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews</p>
<disp-quote content-type="editor-comment">
<p><bold>eLife assessment</bold></p>
<p>This valuable study aims to present a mathematical theory for why the periodicity of the hexagonal pattern of grid cell firing would be helpful for encoding 2D spatial trajectories. The idea is supported by solid evidence, but some of the comparisons of theory to the experimental data seem incomplete, and the reasoning supporting some of the assumptions made should be strengthened. The work would be of interest to neuroscientists studying neural mechanisms of spatial navigation.</p>
</disp-quote>
<p>We thank the reviewers for this assessment. We have addressed the comments made by reviewers and believe that the revised manuscript has theoretical and practical implications beyond the subfield of neuroscience concerned with mechanisms underpinning spatial memory and spatial navigation. Specifically, the demonstration that four simple axioms beget the spatial firing pattern of grid cells is highly relevant for the field of artificial intelligence and neuromorphic computing. This relevance stems from the fact that the four axioms define a set of four simple computational algorithms that can be implemented in future work in grid cell-inspired computational algorithms. Such algorithms will be impactful because they can perform path integration, a function that is independent of an animal’s or agent’s location and therefore generalizable. Moreover, because of the functional organization of grid cells into modules, the algorithm is also scalable. Generalizability and scalability are two highly sought-after properties of brain-inspired computational frameworks. We also believe that the question why grid cells emerge in the brain is a fundamental one. This manuscript is, to our knowledge, the first one that provides an interpretable and intuitive answer to why grid cells are observed in the brain.</p>
<p>Before addressing each comment, we would like to point out that the first sentence of the assessment appears misphrased. The study does not aim to present a theory for why the periodicity in grid cell firing would be helpful for encoding 2D spatial trajectories. To present a theory “for why grid cell firing would be helpful for encoding 2D trajectories”, one assumes the existence of grid cells a priori. Instead of assuming the existence of grid cells and deriving a computational function from grid cells, our study derives grid cells from a computational function, as correctly summarized by reviewers #1 and #3 in their individual statements. In contrast to previous normative models, we prove mathematically that spatial periodicity in grid cell firing is implied by a sequence code of trajectories. If the brain uses cell sequences to code for trajectories, spatially periodic firing must emerge. As correctly pointed out by reviewer #1, the underlying assumptions of this study are that the brain codes for trajectories and that it does so using cell sequences. In response to comments by reviewer #1, we now discuss these two assumptions more rigorously.</p>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>Rebecca R.G. et al. set to determine the function of grid cells. They present an interesting case claiming that the spatial periodicity seen in the grid pattern provides a parsimonious solution to the task of coding 2D trajectories using sequential cell activation. Thus, this work defines a probable function grid cells may serve (here, the function is coding 2D trajectories), and proves that the grid pattern is a solution to that function. This approach is somewhat reminiscent in concept to previous works that defined a probable function of grid cells (e.g., path integration) and constructed normative models for that function that yield a grid pattern. However, the model presented here gives clear geometric reasoning to its case.</p>
<p>Stemming from 4 axioms, the authors present a concise demonstration of the mathematical reasoning underlying their case. The argument is interesting and the reasoning is valid, and this work is a valuable addition to the ongoing body of work discussing the function of grid cells.</p>
<p>However, the case uses several assumptions that need to be clearly stated as assumptions, clarified, and elaborated on: Most importantly, the choice of grid function is grounded in two assumptions:</p>
<p>(1) that the grid function relies on the activation of cell sequences, and</p>
<p>(2) that the grid function is related to the coding of trajectories. While these are interesting and valid suggestions, since they are used as the basis of the argument, the current justification could be strengthened (references 28-30 deal with the hippocampus, reference 31 is interesting but cannot hold the whole case).</p>
</disp-quote>
<p>We thank this reviewer for the overall positive and constructive criticism. We agree with this reviewer that our study rests on two premises, namely that 1) a code for trajectories exist, and 2) this code is implemented by cell sequences. We now discuss and elaborate on the data in the literature supporting the two premises.</p>
<p>In addition to the work by Zutshi et al. (reference 31 in the original manuscript), we have now cited additional work presenting experimental evidence for sequential activity of neurons in the medial entorhinal cortex, including sequential activity of grid cells.</p>
<p>We have added the following paragraph to the Discussion section:</p>
<p>“Recent studies provided compelling evidence for sequential activity of neurons representing spatial trajectories. In particular, Gardner et al. (2022) demonstrated that the sequential activity of hundreds of simultaneously recorded grid cells in freely foraging rats represented spatial trajectories. Complementary preliminary results indicate that grid cells exhibit left-rightalternating “theta sweeps,” characterized by temporally compressed sequences of spiking activity that encode outwardly oriented trajectories from the current location (Vollan et al., 2024).</p>
<p>The concept of sequential grid cell activity extends beyond spatial coding. In various experimental contexts, grid cells have been shown to encode non-spatial variables. For instance, in a stationary auditory task, grid cells fired at specific sounds along a continuous frequency axis (Aronov et al., 2017). Further studies revealed that grid cell sequences also represent elapsed time and distance traversed, such as during a delay period in a spatial alternation task (Kraus et al., 2015). Similar findings were reported for elapsed time encoded by grid cell sequences in mice performing a virtual “Door Stop” task (Heys and Dombeck, 2018).</p>
<p>Additionally, spatial trajectories represented by temporally compressed grid cell sequences have been observed during sleep as replay events (Ólafsdóttir et al., 2016; O’Neill et al., 2017). Collectively, these studies demonstrate that sequential activity of neurons within the MEC, particularly grid cells, consistently encodes ordered experiences, suggesting a fundamental role for temporal structure in neuronal representations.</p>
<p>The theoretical underpinnings of grid cell activity coding for ordered experiences have been explored previously by Rueckemann et al. (2021) who argued that the temporal order in grid cell activation allows for the construction of topologically meaningful representations, or neural codes, grounded in the sequential experience of events or spatial locations. However, while Rueckemann et al. argue that the MEC supports temporally ordered representations through grid cell activity, our findings suggest an inverse relationship: namely, that grid cell activity emerges from temporally ordered spatial experiences. Additional studies demonstrate that hippocampal place cells may derive their spatial coding properties from higher-order sequence learning that integrates sensory and motor inputs (Raju et al., 2024) and that hexagonal grids, if assumed a priori, optimally encode transitions in spatiotemporal sequences (Waniek, 2018).</p>
<p>Together, experimental and theoretical evidence demonstrate the significance of sequential neuronal activity within the hippocampus and entorhinal cortex as a core mechanism for representing both spatial and temporal information and experiences.”</p>
<disp-quote content-type="editor-comment">
<p>The work further leans on the assumption that sequences in the same direction should be similar regardless of their position in space, it is not clear why that should necessarily be the case, and how the position is extracted for similar sequences in different positions.</p>
</disp-quote>
<p>We thank this reviewer for giving us the opportunity to clarify this point. We define a trajectory as a path taken in space (Definition 6). By this definition, a code for trajectories is independent of the animal’s spatial location. This is consistent with the definition of path integration, which is also independent of an animal’s spatial location. If the number of neurons is finite (Axiom #4) and the space is large, sequences must eventually repeat in different locations. This results in neural sequences coding for the same directions being identical at different locations. We have clarified this point under new Remark 6.1. in the Results section of the revised:</p>
<p>“Remark 6.1. Note that a code for trajectories is independent of the animal’s spatial location, consistent with the definition of path integration. This implies that, if the number of neurons is finite (Axiom #4) and the space is large, sequences must eventually repeat in different location, resulting in neural sequences coding for the same trajectories at different locations.”</p>
<p>The formal proof was already included in the original manuscript: “Generally speaking, starting in a firing field of element i and going along any set of firing fields, some element must eventually become active again since the total number of elements is finite by axiom 4. Once there is a repeat of one element’s firing field, the whole sequence of firing fields of all elements must repeat by axiom 1. More specifically, if we had a sequence 1,2, … , k, 1, t of elements, then 1,2 and 1, t both would code for traveling in the same direction from element 1, contradicting axiom 1.”</p>
<p>Further: “More explicitly, assuming axioms 1 and 4, the firing fields of trajectory-coding elements must be spatially periodic, in the sense that starting at any point and continuing in a single direction, the initial sequence of locally active elements must eventually repeat with a repeat length of at least 3”.</p>
<p>Regarding the question how an animal’s position is extracted for similar sequences in different positions, we agree with this reviewer that this is an important question when investigating the contributions of grid cells to the coding of space. However, since a code for trajectories is independent of spatial location, the question of how to extract an animal’s position from a trajectory code is irrelevant for this study.</p>
<p>While a trajectory code by neural sequences begets grid cells, a spatial code by neural sequences does not. Nevertheless, grid cells could contribute to the coding of space (in addition to providing a trajectory code). However, while experimental evidence from studies with rodents and human subjects and theoretical work demonstrated the importance of grid cells for path integration (Fuhs and Touretzky, 2006; McNaughton et al., 2006; Moser et al., 2017), experimental studies have shown that grid cells contribute little to the coding of space by place cells (Hales et al., 2014). Yet, theoretical work (Mathis et al., 2012) showed that coherent activity of grid cells across different modules can provide a code for spatial location that is more accurate than spatial coding by place cells in the hippocampus. Importantly, such a spatial code by coherent activity across grid cell modules does not require location-dependent differences in neural sequences.</p>
<disp-quote content-type="editor-comment">
<p>The authors also strengthen their model with the requirement that grid cells should code for infinite space. However, the grid pattern anchors to borders and might be used to code navigated areas locally. Finally, referencing ref. 14, the authors claim that no existing theory for the emergence of grid cell firing that unifies the experimental observations on periodic firing patterns and their distortions under a single framework. However, that same reference presents exactly that - a mathematical model of pairwise interactions that unifies experimental observations. The authors should clarify this point.</p>
</disp-quote>
<p>We thank this reviewer for this valuable feedback. We agree that grid cells anchor to borders and may be used to code navigated areas locally. In fact, the trajectory code performs a local function, namely path integration, and the global grid pattern can only emerge from performing this local computation if the activity of at least one grid unit or element (we changed the wording from unit to element based on feedback from reviewer #3) is anchored to either a spatial location or a border. Yet, the trajectory code itself does not require anchoring to a reference frame to perform local path integration. Because of the local nature of the trajectory code, path integration can be performed locally without the emergence of a global grid pattern. This has been shown experimentally in mice performing a path integration task where changes in the location of a task-relevant object resulted in translations of grid patterns in single trials. Although no global grid pattern was observed, grid cells performed path integration locally within the multiple reference frames defined by the task-relevant object, and grid patterns were visible when the changes in the references frames were accounted for in computing the rate maps (Peng et al., 2023). The data by Peng et al. (2023) confirm that the anchoring of the grid pattern to borders and the emergence of the global pattern are not required for local coding of trajectories. The global pattern emerges only when the reference frame does not change. However, this global pattern itself might not serve any function. According to the trajectory code model, the beguiling grid pattern is merely a byproduct of a local path integration function that is independent of the animal’s current location (which makes the code generalizable across space). The reviewer is correct that, if the reference frame used to anchor the grid pattern did not change in infinite space, the trajectory code model of grid cell firing would predict an infinite global pattern. But does the proof implicitly assume that space is infinite? The trajectory code model makes the quantitative prediction that the field size increases linearly with an increase in grid spacing (the distance between two fields). If the field size remains fixed, periodicity will emerge in finite spaces that are larger than the grid spacing. We have clarified these points in the revised manuscript:</p>
<p>“Notably, the trajectory code itself does not require anchoring to a reference frame to perform local path integration. Because of the local nature of the trajectory code, path integration can be performed locally without the emergence of a global grid pattern. This has been shown experimentally in mice performing a path integration task where changes in the location of a task-relevant object resulted in translations of grid patterns in single trials (Peng et al., 2023). Although no global grid pattern was observed because the reference frame was not fixed in space, grid cells performed path integration locally within the reference frame defined by the moving task-relevant object, and grid patterns were visible when the changes in the references frames were accounted for in computing the rate maps”.</p>
<p>Regarding how the emergence of grid cells from a trajectory code relates to the theory of a local code by grid cells brought forward by Ginosar et al. (ref. 14), we argue that the local computational function suggested by Ginosar et al. is to provide a code for trajectories. The perspective article by Ginosar et al. provides an excellent review of the experimental data on grid cells that point to grid cells performing a local function (see also Kate Jeffery’s excellent review article (Jeffery, 2024) on the mosaic structure of the mammalian cognitive map.) Assuming the existence of grid cells a priori, Ginosar et al. then propose three possible functions of grid cells, all of which are consistent with the trajectory code model of grid cell firing. Yet, the perspective article remains agnostic, in our opinion, on the exact nature of the local computation that is carried out by grid cells. But without knowing the local computation underlying grid cell function, a unifying theory explaining the emergence of grid cells cannot be considered complete. In contrast, our manuscript identifies the local computational function as a trajectory code by cell sequences. We have clarified these points in the revised manuscript:</p>
<p>“The influential hypothesis that grid cells provide a universal map for space is challenged by experimental data suggesting a yet to be identified local computational function of grid cells (Ginosar et al., 2023; Jeffery, 2024). Here, we identify this local computational function as a trajectory code.”</p>
<p>The mathematical model of pairwise interactions described by Ginosar et al. is fundamentally different from the mathematical framework developed in our manuscript. The mathematical model by Ginosar et al. describes how pairwise interactions between already existent grid fields can explain distortions in the grid pattern caused by the environment’s geometry, reward zones, and dimensionality. However, the model does not explain why there is a grid pattern in the first place. In contrast, our trajectory model provides an explanation for why grid cells may exist by demonstrating that a grid pattern emerges from a trajectory code by cell sequences. We stand by our assessment that a unifying theory of grid cells is not complete if it takes the existence of the grid pattern for granted.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>Summary:</p>
<p>In this work, the authors consider why grid cells might exhibit hexagonal symmetry - i.e., for what behavioral function might this hexagonal pattern be uniquely suited? The authors propose that this function is the encoding of spatial trajectories in 2D space. To support their argument, the authors first introduce a set of definitions and axioms, which then lead to their conclusion that a hexagonal pattern is the most efficient or parsimonious pattern one could use to uniquely label different 2D trajectories using sequences of cells. The authors then go through a set of classic experimental results in the grid cell literature - e.g. that the grid modules exhibit a multiplicative scaling, that the grid pattern expands with novelty or is warped by reward, etc. - and describe how these results are either consistent with or predicted by their theory. Overall, this paper asks a very interesting question and provides an intriguing answer. However, the theory appears to be extremely flexible and very similar to ideas that have been previously proposed regarding grid cell function.</p>
</disp-quote>
<p>We thank this reviewer for carefully reading the manuscript and their valuable feedback which helps us clarify major points of the study. One major clarification is that the theoretical/axiomatic framework we put forward does not assume grid cells a priori. In contrast, we start by hypothesizing a computational function that a brain region shown to be important for path integration likely needs to solve, namely coding for spatial trajectories. We go on to show that this computational function begets spatially periodic firing (grid maps). By doing so, we provide mathematical proof that grid maps emerge from solving a local computational function, namely spatial coding of trajectories. Showing the emergence of grid maps from solving a local computational function is fundamentally different from many previous studies on grid cell function, which assign potential functions to the existing grid pattern. As we discuss in the manuscript, our work is similar to using normative models of grid cell function. However, in contrast to normative models, we provide a rigorous and interpretable mathematical framework which provides geometric reasoning to its case.</p>
<disp-quote content-type="editor-comment">
<p>Major strengths:</p>
<p>The general idea behind the paper is very interesting - why *does* the grid pattern take the form of a hexagonal grid? This is a question that has been raised many times; finding a truly satisfying answer is difficult but of great interest to many in the field. The authors' main assertion that the answer to this question has to do with the ability of a hexagonal arrangement of neurons to uniquely encode 2D trajectories is an intriguing suggestion. It is also impressive that the authors considered such a wide range of experimental results in relation to their theory.</p>
</disp-quote>
<p>We thank this reviewer for pointing out the significance of the question addressed by our manuscript.</p>
<disp-quote content-type="editor-comment">
<p>Major weaknesses:</p>
<p>One major weakness I perceive is that the paper overstates what it delivers, to an extent that I think it can be a bit confusing to determine what the contributions of the paper are. In the introduction, the authors claim to provide &quot;mathematical proof that ... the nature of the problem being solved by grid cells is coding of trajectories in 2-D space using cell sequences. By doing so, we offer a specific answer to the question of why grid cell firing patterns are observed in the mammalian brain.&quot; This paper does not provide proof of what grid cells are doing to support behavior or provide the true answer as to why grid patterns are found in the brain. The authors offer some intriguing suggestions or proposals as to why this might be based on what hexagonal patterns could be good for, but I believe that the language should be clarified to be more in line with what the authors present and what the strength of their evidence is.</p>
</disp-quote>
<p>We thank this reviewer for this assessment. While there is ample experimental evidence demonstrating the importance of grid cells for path integration, we agree with this reviewer that there may be other computational functions that may require or largely benefit from the existence of grid cells. We now acknowledge the fact that we have provided a likely teleological cause for the emergence of grid cells and that there might be other causes for the emergence of grid cells. We have changed the wording in the abstract and discussion sections to acknowledge that our study does provide a likely teleological cause. We choose “likely” because the computational function – trajectory coding – from which grid maps emerge is very closely associated to path integration, which numerous experimental and theoretical studies associate with grid cell function.</p>
<disp-quote content-type="editor-comment">
<p>Relatedly, the authors claim that they find a teleological reason for the existence of grid cells - that is, discover the function that they are used for. However, in the paper, they seem to instead assume a function based on what is known and generally predicted for grid cells (encode position), and then show that for this specific function, grid cells have several attractive properties.</p>
</disp-quote>
<p>We agree with this reviewer that we leveraged what is known about grid cells, in particular their importance for path integration, in finding a likely teleological cause. However, the major significance of our work is that we demonstrate that coding for spatial trajectories requires spatially periodic firing (grid cells).This is very different from assuming the existence of grid cells a priori and then showing that grid cells have attractive, if not optimal, properties for this function. If we had shown that grid cells optimized a code for trajectories, this reviewer would be correct: we would have suggested just another potential function of grid cells. Instead, we provide both proof and intuition that trajectory coding by cell sequences begets grid cells (not the other way around), thereby providing a likely teleological cause for the emergence of grid cells. As stated above, we clarified in the revised manuscript that we provide a likely teleological cause which requires additional experimental verification.</p>
<disp-quote content-type="editor-comment">
<p>There is also some other work that seems very relevant, as it discusses specific computational advantages of a grid cell code but was not cited here: <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nn.2901">https://www.nature.com/articles/nn.2901</ext-link>.</p>
</disp-quote>
<p>We thank this reviewer for pointing us toward this article by (Sreenivasan and Fiete, 2011). The revised manuscript now cites this article in the Introduction and Discussion sections. We agree that the article by (Sreenivasan and Fiete, 2011) discusses a specific computational advantage of a population code by grid cells, namely unprecedented robustness to noise in estimating the location from the spiking information of noisy neurons. However, the work by (Sreenivasan and Fiete, 2011) differs from our work in that the authors assume the existence of grid cells a priori.</p>
<p>In addition, we now discuss other relevant work, namely work on the conformal isometry hypothesis  by (Schøyen et al., 2024) and (Xu et al., 2024), published as pre-prints after publication of the first version of our manuscript, as well as work on transition scale- spaces by Nicolai Waniek. (Xu et al., 2024) and (Schøyen et al., 2024) investigate conformal isometry in the coding of space by grid cells. Conformal isometry means that trajectories in neural space map trajectories in physical space. (Xu et al., 2024) show that the conformal isometry hypothesis can explain the spatially periodic firing pattern of grid cells. (Schøyen et al., 2024) further show that a module of seven grid cells emerges if space is encoded as a conformal isometry, ensuring equal representation in all directions. While the work by (Xu et al., 2024) and (Schøyen et al., 2024) arrive at very similar conclusions as stated in the current manuscript, the conformal isometry hypothesis provides only a partial answer to why grid cells exist because it doesn’t explain why conformal isometry is important or required. In contrast, a sequence code of trajectories provides an intuitive answer to why such a code is important for animal behavior. Furthermore, we included the work by Nicolai Waniek, (2018, 2020) in the Discussion, who demonstrated that the hexagonal arrangement of grid fields is optimal for coding transitions in space.</p>
<p>The paragraph added to the Discussion reads as follows:</p>
<p>“As part of the proof that a trajectory code by cell sequences begets spatially periodic firing fields, we proved that the centers of the firing fields must be arranged in a hexagonal lattice. This arrangement implies that the neural space is a conformally isometric embedding of physical space, so that local displacements in neural space are proportional to local displacements of an animal or agent in physical space, as illustrated in Figure 5. This property has recently been introduced in the grid cell literature as the conformal isometry hypothesis(Schøyen et al., 2024; Xu et al., 2024). Strikingly, Schøyen et al.(Schøyen et al., 2024) arrive at similar if not identical conclusions regarding the geometric principles in the neural representations of space by grid cells.”</p>
<disp-quote content-type="editor-comment">
<p>A second major weakness was that some of the claims in the section in which they compared their theory to data seemed either confusing or a bit weak. I am not a mathematician, so I was not able to follow all of the logic of the various axioms, remarks, or definitions to understand how the authors got to their final conclusion, so perhaps that is part of the problem. But below I list some specific examples where I could not follow why their theory predicted the experimental result, or how their theory ultimately operated any differently from the conventional understanding of grid cell coding. In some cases, it also seemed that the general idea was so flexible that it perhaps didn't hold much predictive power, as extra details seemed to be added as necessary to make the theory fit with the data.</p>
<p>I don't quite follow how, for at least some of their model predictions, the 'sequence code of trajectories' theory differs from the general attractor network theory. It seems from the introduction that these theories are meant to serve different purposes, but the section of the paper in which the authors claim that various experimental results are predicted by their theory makes this comparison difficult for me to understand. For example, in the section describing the effect of environmental manipulations in a familiar environment, the authors state that the experimental results make sense if one assumes that sequences are anchored to landmarks. But this sounds just like the classic attractornetwork interpretation of grid cell activity - that it's a spatial metric that becomes anchored to landmarks.</p>
</disp-quote>
<p>We thank this reviewer for giving us the opportunity to clarify in what aspects the ‘sequence code of trajectories’ theory of grid cell firing differs from the classic attractor network models, in particular the continuous attractor network (CAN) model. First of all, the CAN model is a mechanistic model of grid cell firing that is specifically designed to simulate spatially periodic firing of grid cells in response to velocity inputs. In contrast, the sequence code of trajectories theory of grid cell firing resembles a normative model showing that grid cells emerge from performing a specific function. However, in contrast to previous normative models, the sequence code of trajectories model grounds the emergence of grid cell firing in a mathematical proof and both geometric reasoning and intuition. The proof demonstrates that the emergence of grid cells is the only solution to coding for trajectories using cell sequences. The sequence code of trajectories model of grid cell firing is agnostic about the neural mechanisms that implements the sequence code in a population of neurons. One plausible implementation of the sequence code of trajectories is in fact a CAN. In fact, the sequence code of trajectories theory predicts conformal isometry in the CAN, i.e., a trajectory in neural space is proportional to a trajectory of an animal in physical space. However, other mechanistic implementations are possible. We have clarified how the sequence code of trajectories theory of grid cells relates to the mechanistic CAN models of grid cells.</p>
<p>We added the following text to the Discussion section:</p>
<p>“While the sequence code of trajectories-model of grid cell firing is agnostic about the neural mechanisms that implements the sequence code, one plausible implementation is a continuous attractor network (McNaughton et al., 2006; Burak and Fiete, 2009). Interestingly, a sequence code of trajectories begets conformal isometry in the attractor network, i.e., a trajectory in neural space is proportional to a trajectory of an animal in physical space.”</p>
<disp-quote content-type="editor-comment">
<p>It was not clear to me why their theory predicted the field size/spacing ratio or the orientation of the grid pattern to the wall.</p>
</disp-quote>
<p>We thank this reviewer for bringing to our attention that we lacked a proper explanation for why the sequence code of trajectories theory predicts the field size/spacing ration in grid maps. We have modified/added the following text to the Results section of the manuscript to clarify this point:</p>
<p>“Because the sequence code of trajectories model of grid cell firing implies a dense packing of firing fields, the spacing between two adjacent grid fields must change linearly with a change in field size. It follows that the ratio between grid spacing and field size is fixed. When using the distance between the centers of two adjacent grid fields to measure grid spacing and a diameter-like metric to measure grid field size, we can compute the ratio of grid spacing to grid field size as √7≈2.65 (see Methods).”</p>
<p>We are also grateful for this reviewer’s correctly pointing out that the explanation as to why the sequence code of trajectories predicts a rotation of the grid pattern relative to a set of parallel walls in a rectangular environment. We have now made explicit the underlying premise that a sequence of firing fields from multiple grid cells are aligned in parallel to a nearby wall of the environment. We cite additional experimental evidence supporting this premise. Concretely, we quote Stensola and Moser summarizing results reported in (Stensola et al. 2015): “A surprising observation, however, was that modules typically assumed one of only four distinct orientation configurations relative to the environment” (Stensola and Moser, 2016). Importantly, all of the four distinct orientations show the characteristic angular rotation. Intriguingly, this is predicted by the sequence code of trajectories-model under the premise that a sequence of firing fields aligns with one of the geometric boundaries of the environment, as shown in Author response image 1 below.</p>
<fig id="sa4fig1">
<label>Author response image 1.</label>
<caption>
<title>Under the premise that a sequence of firing fields aligns with one of the geometric boundaries (walls) of a square arena, there are precisely four possible distinct configurations of orientations.</title>
<p>This is precisely what has been observed in experiments (Stensola et al., 2015; Stensola and Moser, 2016).</p>
</caption>
<graphic mime-subtype="jpg" xlink:href="elife-96627-sa4-fig1.jpg" mimetype="image"/>
</fig>
<p>We added clarifying language to the Results section: “Under the premise that a sequence of firing fields aligns with one of the geometric boundaries of the environment, the sequence code model explains that the grid pattern typically assume one of only four distinct orientation configurations relative to the environment41,46. Concretely, the four orientation configurations arise when one row of grid fields aligns with one of the two sets of parallel walls in a rectangular environment, and each arrangement can result in two distinct orientations (Figure 3B).”</p>
<disp-quote content-type="editor-comment">
<p>I don't understand how repeated advancement of one unit to the next, as shown in Figure 4E, would cause the change in grid spacing near a reward.</p>
</disp-quote>
<p>In familiar environments, spatial firing fields of place cells in hippocampal CA1 and CA3 tend to shift backwards with experience (Mehta et al., 2000; Lee et al., 2004; Roth et al., 2012; Geiller et al., 2017; Dong et al., 2021). This implies that the center of place fields move closer to each other. A potential mechanism has been suggested, namely NMDA receptor-dependent longterm synaptic plasticity (Ekstrom et al., 2001). When we apply the same principle observed for place fields on a linear track to grid fields anchored to a reward zone, grid fields will “gravitate” towards the reward side. A similar idea has been presented by (Ginosar et al., 2023) who use the analogy of reward locations as “black holes”. In contrast to (Ginosar et al., 2023), who we cite multiple times, our idea unifies observations on place cells and grid cells in 1-D and 2-D environments and suggests a potential mechanism. We changed the wording in the revised manuscript and clarified the underlying premises.</p>
<disp-quote content-type="editor-comment">
<p>I don't follow how this theory predicts the finding that the grid pattern expands with novelty. The authors propose that this occurs because the animals are not paying attention to fine spatial details, and thus only need a low-resolution spatial map that eventually turns into a higher-resolution one. But it's not clear to me why one needs to invoke the sequence coding hypothesis to make this point.</p>
</disp-quote>
<p>We agree with this reviewer that this point needs clarification. The sequence code model adds explanatory power to the hypothesis that the grid pattern in a novel environment reflects a lowresolution mapping of space or spatial trajectories because it directly links spatial resolution to both field size and spacing of a grid map. Concretely, the spatial resolution of the trajectory code is equivalent to the spacing between two adjacent spatial fields, and the spatial resolution is directly proportional to the grid spacing and field size. If one did not evoke the sequence coding hypothesis, one would need to explain how and why both spacing and field size are related to the spatial resolution of the grid map. Lastly, as written in the manuscript text, we point out that, while the experimentally observed expansion of grid maps is consistent with the sequence code of trajectory, it is not predicted by the theory without making further assumption.</p>
<disp-quote content-type="editor-comment">
<p>The last section, which describes that the grid spacing of different modules is scaled by the square root of 2, says that this is predicted if the resolution is doubled or halved. I am not sure if this is specifically a prediction of the sequence coding theory the authors put forth though since it's unclear why the resolution should be doubled or halved across modules (as opposed to changed by another factor).</p>
</disp-quote>
<p>We agree with reviewer #2 that the exact value of the scaling factor is not predicted by the sequence coding theory. E.g., the sequence code theory does not explain why the spatial resolution doesn’t change by a factor 3 or 1.5 (resulting in changes in grid spacing by square root of 3 or square root of 1.5, respectively). We have changed the wording to reflect this important point. We further clarified in the revised manuscript that future work on multiscale representations using modules of grid cells needs to show why changing the spatial resolution across modules by a factor of 2 is optimal. Interestingly, a scale ratio of 2 is commonly used in computer vision, specifically in the context of mipmapping and Gaussian pyramids, to render images across different scales. Literature in the computer vision field describes why a scaling factor of 2 and the use of Gaussian filter kernels (compare with Gaussian firing fields) is useful in allowing a smooth and balanced transition between successive levels of an image pyramid (Burt and Adelson, 1983; Lindeberg, 2008). Briefly, larger factors (like 3) could result in excessive loss of detail between levels, while smaller factors (like 1.5) would not reduce the image size enough to justify additional levels of computation (that would come with the structural cost of having more grid cell modules in the brain). We have clarified these points in the Discussion section.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public Review):</bold></p>
<p>The manuscript presents an intriguing explanation for why grid cell firing fields do not lie on a lattice whose axes aligned to the walls of a square arena. This observation, by itself, merits the manuscript's dissemination to the eLife's audience.</p>
</disp-quote>
<p>We thank this reviewer for their positive assessment.</p>
<disp-quote content-type="editor-comment">
<p>The presentation is quirky (but keep the quirkiness!).</p>
</disp-quote>
<p>We kept the quirkiness.</p>
<disp-quote content-type="editor-comment">
<p>But let me recast the problem presented by the authors as one of combinatorics. Given repeating, spatially separated firing fields across cells, one obtains temporal sequences of grid cells firing. Label these cells by integers from $[n]$. Any two cells firing in succession should uniquely identify one of six directions (from the hexagonal lattice) in which the agent is currently moving.</p>
<p>Now, take the symmetric group $\Sigma$ of cyclic permutations on $n$ elements.  We ask whether there are cyclic permutations of $[n]$ such that</p>
<p>\left(\pi_{i+1} - \pi_i \right) \mod n \neq \pm 1 \mod n, \; \forall i.</p>
<p>So, for instance, $(4,2,3,1)$ would not be counted as a valid permutation of $(1,2,3,4)$, as $(2,3)$ and $(1,4)$ are adjacent.</p>
<p>Furthermore, given $[n]$, are there two distinct cyclic permutations such that {\em no} adjacencies are preserved when considering any pair of permutations (among the triple of the original ordered sequence and the two permutations)? In other words, if we consider the permutation required to take the first permutation into the second, that permutation should not preserve any adjacencies.</p>
<p>{\bf Key question}: is there any difference between the solution to the combinatorics problem sketched above and the result in the manuscript? Specifically, the text argues that for $n=7$ there is only {\em one} solution.</p>
<p>Ideally, one would strive to obtain a closed-form solution for the number of such permutations as a function of $n$.</p>
</disp-quote>
<p>This is a great question! We currently have a student working on describing all possible arrangements of firing fields (essentially labelings of the hexagonal lattice) that satisfy the axioms in 2D, and we expect that results on the number of such arrangements will come out of his work. We plan to publish those results separately, possibly targeting a more mathematical audience.</p>
<p>The argument above appears to only apply in the case that every row (and every diagonal) contains all of the elements 1,...,n. However, when n is not prime, there are often arrangements where rows and/or diagonals do not contain every element from 1,...,n. For example, some admissible patterns with 9 neurons have a repeat length of 3 in all directions (horizontally and both diagonals). As a result the construction listed here will not give a full count of all possible arrangements.</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations for the authors:</bold></p>
<p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p>
<p>I think the concise style of mathematical proof is both a curse and a blessing. While it delivers the message, I think the fluency and readability of the mathematical proof could be improved with longer paragraphs and some more editing.</p>
</disp-quote>
<p>We have added some clarifications in the text that we hope improve the readability.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p>
<p>A minor qualm I have with the nomenclature:</p>
<p>On page 7:</p>
<p>“To prove this statement, suppose that row A consists of units $1, \dots , k$ repeating in this order. Then any row that contains any unit from $1, \dots, k$ must contain the full repeat $1, \dots , k$ by axiom 1. So any row containing any unit from $1,\dots , k$ is a translation of row A, and any unit that does not contain them is disjoint from row A.”</p>
<p>The last use of `unit' at the end of this paragraph instead of `row' is confusing. Technically, the authors have given themselves license to use this term by defining a unit to be “either to a single cell or a cell assembly”. Yet modern algebra tends to use `unit' as meaning a ring element that has an inverse.</p>
</disp-quote>
<p>We have renamed “unit” to “element” to avoid confusion with the terminology in modern algebra.</p>
</body>
</sub-article>
</article>