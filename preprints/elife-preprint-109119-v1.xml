<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">109119</article-id>
<article-id pub-id-type="doi">10.7554/eLife.109119</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.109119.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Structural Biology and Molecular Biophysics</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Cell Biology</subject>
</subj-group>
</article-categories><title-group>
<article-title>Unbend: Correction of local beam-induced sample motion in cryo-EM images using a 3D spline model</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5808-2649</contrib-id>
<name>
<surname>Kong</surname>
<given-names>Lingli</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2344-5163</contrib-id>
<name>
<surname>Zottig</surname>
<given-names>Ximena</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9911-706X</contrib-id>
<name>
<surname>Elferich</surname>
<given-names>Johannes</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1506-909X</contrib-id>
<name>
<surname>Grigorieff</surname>
<given-names>Nikolaus</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<email>niko@grigorieff.org</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0464eyp60</institution-id><institution>RNA Therapeutics Institute, University of Massachusetts Chan Medical School</institution></institution-wrap>, <city>Worcester</city>, <country country="US">United States</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0464eyp60</institution-id><institution>Howard Hughes Medical Institute, University of Massachusetts Chan Medical School</institution></institution-wrap>, <city>Worcester</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Scheres</surname>
<given-names>Sjors HW</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/00tw3jy02</institution-id><institution>MRC Laboratory of Molecular Biology</institution>
</institution-wrap>
<city>Cambridge</city>
<country country="GB">United Kingdom</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Maduke</surname>
<given-names>Merritt</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/00f54p054</institution-id><institution>Stanford University</institution>
</institution-wrap>
<city>Stanford</city>
<country country="US">United States</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-10-31">
<day>31</day>
<month>10</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP109119</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2025-09-05">
<day>05</day>
<month>09</month>
<year>2025</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2025-09-06">
<day>06</day>
<month>09</month>
<year>2025</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2025.09.05.674398"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Kong et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Kong et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-109119-v1.pdf"/>
<abstract>
<p>The exposure of frozen biological samples to the high-energy electron beam in a cryo-electron microscope commonly leads to beam-induced sample motion and distortions. Previously, we described <italic>Unblur</italic>, which is part of our <italic>cis</italic>TEM software to correct for beam-induced motion based on the alignment of full frames in a movie collected during the beam exposure (Grant et al., 2015). However, <italic>Unblur</italic> cannot accommodate motion due to more localized sample bending and distortions. Here, we present <italic>Unbend</italic>, extending <italic>Unblur</italic> by incorporating local motion correction using a three-dimensional cubic spline model. The 3D spline model is constructed using cubic B-splines along the exposure time axis, and bicubic B-splines within movie frames. <italic>Unbend</italic> is integrated into our <italic>cis</italic>TEM software with a new local motion visualization panel within the <italic>cis</italic>TEM graphical user interface. We processed movie frames from various <italic>in-situ</italic> sample types, including whole cells, lamellae, and cell lysates, to analyze motion behavior across different specimen types. To quantify the improvement in high-resolution signal, we utilized the 2D template matching method, which operates independently of the motion correction process, to search large ribosomal subunits from the motion-corrected micrographs. Overall, the signal-to-noise ratio of detected particles improved by 3 ∼ 8% across different samples compared with full-frame aligned micrographs, while the number of detected target particles increased by up to ∼ 300%. The total and Von Mises equivalent strain shows a deformation scale of less than 1% in most of the samples, confirming that our model induces minimal additional distortion. Furthermore, we processed micrograph montages to study motion patterns across an entire sample, revealing considerable variance in distortion scale within the same sample, suggesting a complex underlying mechanism.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>

</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Cryo-electron microscopy (cryo-EM) enables structural biologists to observe diverse biomolecules in their native environment. The molecules are preserved in amorphous ice, and in the most favorable cases, their 3D structure can be reconstructed at near-atomic resolution. An important factor determining the attainable resolution are high-quality micrographs, containing high-resolution signal of the molecules. This high-resolution signal is attenuated by radiation damage and sample motion during the exposure (beam-induced motion, BIM). To minimize this attenuation, images are commonly recorded as a series of movie frames, each containing a fraction of the total electron exposure (<xref ref-type="bibr" rid="c4">Brilot et al., 2012</xref>; <xref rid="c5" ref-type="bibr">Campbell et al., 2013</xref>, <xref ref-type="bibr" rid="c15">Li et al., 2013</xref>). The frames are then filtered according to the radiation damage suffered by the sample, and averaged into a single micrograph. We have previously developed the program <italic>Unblur</italic>, which is part of <italic>cis</italic>TEM (<xref ref-type="bibr" rid="c12">Grant et al., 2018</xref>), to perform alignment of full movie frames and exposure filtering (<xref ref-type="bibr" rid="c11">Grant &amp; Grigorieff, 2015</xref>). However, as discussed in the following, full-frame alignment cannot correct for local distortions and bending of the sample under the electron beam.</p>
<p>While full-frame alignment is often sufficient to achieve 3D reconstructions at near-atomic resolution, more complicated patterns of sample deformation have been observed that cannot be corrected in this manner. A simple model describes the deformation as a drum-like motion (<xref ref-type="bibr" rid="c4">Brilot et al., 2012</xref>; <xref ref-type="bibr" rid="c32">Zheng et al., 2017</xref>; <xref ref-type="bibr" rid="c20">Naydenova et al., 2020</xref>), which leads to differential sample motion across the field of view. The primary driver of this motion and deformation is thought to be strain that develops in the sample during rapid freezing (<xref ref-type="bibr" rid="c20">Naydenova et al., 2020</xref>; <xref ref-type="bibr" rid="c6">D’Imprima &amp; Kühlbrandt, 2021</xref>).</p>
<p>Different algorithms have been developed to correct micrographs and tomograms for more complicated motion patterns (<xref ref-type="bibr" rid="c15">Li et al., 2013</xref>; <xref ref-type="bibr" rid="c27">Scheres, 2014</xref>; <xref ref-type="bibr" rid="c1">Abrishami et al., 2015</xref>; <xref ref-type="bibr" rid="c11">Grant &amp; Grigorieff, 2015</xref>; <xref ref-type="bibr" rid="c25">Rubinstein &amp; Brubaker, 2015</xref>; <xref ref-type="bibr" rid="c32">Zheng et al., 2017</xref>; <xref ref-type="bibr" rid="c33">Zivanov et al., 2019</xref>; <xref ref-type="bibr" rid="c31">Tegunov &amp; Cramer, 2019</xref>; <xref ref-type="bibr" rid="c29">Střelák et al., 2020</xref>). The widely used software <italic>MotionCor2</italic> employs polynomial equations to fit drum-like motion (<xref ref-type="bibr" rid="c32">Zheng et al., 2017</xref>). <italic>Warp</italic> (<xref ref-type="bibr" rid="c31">Tegunov &amp; Cramer, 2019</xref>) and <italic>CryoSPARC</italic> (<xref ref-type="bibr" rid="c23">Punjani et al., 2017</xref>) use a spline-based model, which provides more flexibility in representing different types of distortion. More complicated distortion models may increase the resolution of 3D reconstructions of particles extracted from the corrected micrographs or tomograms. However, 3D reconstruction requires multiple image processing steps, and often involves additional manual decisions, making it difficult to directly measure the impact of local distortion correction. Thus, it has not been quantified how great the improvements by local distortion correction are, nor how different types of samples, often exhibiting different degrees of distortion, benefit from it. To fill this gap, we set out to develop a tool to model and visualize local motion, and to quantify the improvements in the micrographs upon distortion correction.</p>
<p>In this paper, we introduce new movie alignment software, <italic>Unbend</italic>, along with a comprehensive description of a new distortion correction model based on 3D cubic splines that is designed to apply pixel-wise correction of local motion. <italic>Unbend</italic> features two alignment steps: a full-frame alignment similar to <italic>Unblur</italic> (<xref ref-type="bibr" rid="c11">Grant &amp; Grigorieff, 2015</xref>), which is part of <italic>cis</italic>TEM (<xref ref-type="bibr" rid="c12">Grant et al., 2018</xref>), and patch-based alignment to generate reference points to initialize the 3D spline model. The spline model is then refined by optimizing a summed patch-wise cross-correlation loss function. The shift amount for each pixel is computed using the refined model and applied to the micrograph to generate a corrected micrograph with improved high-resolution signal. We also wrote shift_field_generation, a program that reads the refined spline parameters generated by <italic>Unbend</italic> to plot pixel-wise shift fields for each movie frame.</p>
<p>We demonstrate the model’s effectiveness using a variety of cellular sample types, including whole cells (both bacterial and mammalian), lamellae (yeast and mammalian cells), and cell lysates, highlighting how local motion varies across specimens. By tracking the displacement of each patch from the first to the last frame, we measured the amount of motion in these different samples. Using the pixel-wise shift fields of the last frame with respect to the first frame, we quantified the amount of deformation and calculate the total equivalent strain (overall magnitude of volumetric and deviatoric deformation, <xref ref-type="bibr" rid="c18">Malvern, 1969</xref>; <xref ref-type="bibr" rid="c3">Belytschko et al., 2000</xref>) and the Von Mises equivalent strain (magnitude of deviatoric deformation, <xref ref-type="bibr" rid="c13">Hill, 1950</xref>). By integrating these metrics with 2D template matching (2DTM) (<xref ref-type="bibr" rid="c24">Rickgauer et al., 2017</xref>), we directly quantified the effects of local motion in the micrograph and assessed the improvement in the 2DTM signal-to-noise ratio (SNR) following distortion correction. Our results show that <italic>Unbend</italic> improves the 2DTM SNR by 3 ∼ 8% and increases the number of detected targets by up to 300% in a dataset, depending on the type of sample being imaged.</p>
<sec id="s2">
<title>Distortion Modeling, Correction, and Verification</title>
<sec id="s2a">
<title>Full-frame alignment</title>
<p>During the acquisition of cryo-EM data, various types of sample motion can occur, including beam-induced motion and mechanical movement of the sample due to stage instabilities. Correcting for this motion is an important step in obtaining high-resolution 3D reconstructions of the imaged molecules. In this work, we address more complicated patterns of sample motion by separately performing full-frame alignment and local distortion correction due to sample deformation.</p>
<p>For full-frame alignment, we closely follow our previous version of <italic>Unblur</italic> (<xref ref-type="bibr" rid="c11">Grant &amp; Grigorieff, 2015</xref>) using alignment in three iterations with increasing resolution. The shift for each frame is initially determined using the cross-correlation map between the current frame and the sum of all other frames. Given the low electron exposure per frame, single-frame alignment can be susceptible to noise and misalignment. A large B-factor, which can be adjusted by the user, is applied during this step to suppress high-resolution noise. Sample drift due to mechanical instabilities of the cryo stage is expected to be slowly varying in speed and mostly along a fixed direction. This allows the full-frame shifts to be smoothed using a Savitzky-Golay (SG) filter, which effectively models sample drift while preserving molecular features in the image, and without introducing potential image distortions. The full-frame alignment and trajectory smoothing are sufficient in many cases to achieve 3D reconstruction at near-atomic resolution (<xref ref-type="bibr" rid="c11">Grant &amp; Grigorieff, 2015</xref>; <xref ref-type="bibr" rid="c21">Oldham et al., 2016</xref>; <xref ref-type="bibr" rid="c30">Subramaniam et al., 2018</xref>).</p>
<p>In some cases, the shifts determined for individual frames deviates significantly from the smoothed trajectory. This could be due to noise but may also reflect properties of the sample or stage, and hence these outliers could represent real physical motion of the sample. Therefore, solely relying on the smoothed curves means that the shifts derived from cross-correlation are not directly applied in the correction, even if they represent real physical motion. To allow potential discontinuities in the motion trajectories in our new approach, we have removed this smoothing function in <italic>Unbend</italic>. Instead of using the SG-filtered shifts, we compare the raw shifts to the smoothed curve and identify those shifts that deviate my more than 1.5 times the interquartile range (IQR) from the curve. These outlier shifts are further aligned using a B-factor twice that of the initial alignment (the default B-factor for the initial alignment is 1500 Å<sup>2</sup>). If shifts remain significantly different after this adjustment, we accept them as the true shifts; otherwise, we apply the new shift values. This strategy helps us detect and correct potential misalignments caused by weak signal in individual frames while preserving the information contained in the raw shifts about real sample motion that does not fit a smooth trajectory.</p>
</sec>
<sec id="s2b">
<title>Patch alignment</title>
<p>To correct for local sample distortion, patch-based methods are widely utilized. By aligning small patches across the entire micrograph, these methods can accurately capture local motion. Increasing the number of patches and reducing the patch size can provide more accurate local information but also limits the amount of signal per patch, leading to noisier alignments. To balance these factors, we set a patch size of 1024 × 1024 pixels when the output pixel size is &lt; 0.5 Å, and 512 × 512 pixels when the output pixel size is between 0.5 and 2.0 Å. For output pixel sizes &gt; 2.0 Å, the 512 × 512 pixel patch size is scaled by a factor equal to the output pixel size and rounded up to the nearest multiple of 16 to maintain computational efficiency.</p>
<p>The default number of patches along the x and y dimensions, denoted as <italic>NP</italic><sub><italic>x</italic></sub> and <italic>NP</italic><sub><italic>y</italic></sub>, are determined by rounding up the values of image dimensions divided by patch size. This configuration minimizes overlap between neighboring patches, enabling more accurate capture of local motion. Users may specify fewer patches along each dimension, resulting in larger patches that capture more signal to ensure a complete coverage of the micrograph without gaps. Conversely, increasing the number of patches does not reduce their size; instead, it increases the percentage of overlap between adjacent patches, preserving the default patch size to ensure that each patch retains sufficient signal for robust alignment.</p>
<p>Assuming that full-frame alignment has effectively removed the average motion in each frame, the residual motion detected by patch alignment is primarily attributed to beam-induced sample distortion. We therefore approximate the shifts determined for a given patch across movie frames (a patch stack) as a smooth trajectory. For each patch stack, the alignment is firstly estimated by calculating the cross-correlation between an individual frame and the average of all other frames, after which the shift trajectory is smoothed using a SG filter.</p>
<p>To identify patches with unreasonable shift sets {(<italic>x</italic><sub><italic>pi,fi</italic></sub>, <italic>y</italic><sub><italic>pi,fi</italic></sub>) <italic>fi</italic> ∈ {1,2, · ·, <italic>NF</italic>}}, where <italic>NF</italic> is the total number of frames, <italic>pi</italic> denotes the patch stack, and <italic>x</italic><sub><italic>pi,fi</italic></sub> and <italic>y</italic><sub><italic>pi,fi</italic></sub> represent the shift amounts along the <italic>x</italic> and <italic>y</italic> axes for frame <italic>fi</italic> in patch stack <italic>pi</italic>, we calculate the standard deviation of the shift differences between neighboring frames:
<disp-formula id="eqn1">
<graphic xlink:href="674398v1_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where
<disp-formula id="eqn2">
<graphic xlink:href="674398v1_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<p>Outliers in the set <italic>σ</italic><sub><italic>fi</italic></sub>(<italic>pi</italic>) <italic>pi</italic> ∈ {1,2, …, <italic>NP</italic>}, with <italic>NP</italic> = <italic>NP</italic><sub><italic>x</italic></sub> × <italic>NP</italic><sub><italic>y</italic></sub> as the total number of patches, are detected using the 1.5 × IQR upper bound criterion. Outlier shifts are then replaced with the shift sets from their nearest-neighbor patches. This procedure effectively detects potential misalignments caused by low signal in individual patches and provides a robust initialization for the subsequent modeling of sample distortion.</p>
</sec>
<sec id="s2c">
<title>Sample distortion modeling and correction</title>
<p>Patch-wise shifts, {(<italic>x</italic><sub><italic>pi,fi</italic></sub>, <italic>y</italic><sub><italic>pi,fi</italic></sub>) | <italic>pi</italic> ∈ {1,2, …, <italic>NP</italic>}, <italic>fi</italic> ∈ {1,2, · ·, <italic>NF</italic>}}, represent motion at the patch centers. To generate a distortion-corrected micrograph, these center shifts must be interpolated to obtain the shifts of every pixel in each movie frame. This requires an interpolation model, for which we employ spline functions to describe the pixel-wise shift distribution across the frames.</p>
<sec id="s2c1">
<title>Spline model construction</title>
<p>In this study, the spline model is constructed using uniform bicubic B-splines to describe shifts in the image plane (x and y axes), and uniform cubic B-splines to constrain shifts across frames (z axis/electron exposure accumulating direction). B-spline curves and surfaces comprise sequences of low-degree polynomial segments, which help avoid high-degree global polynomials and preserve numerical stability. For both cubic and bicubic B-splines, the model guarantees <italic>C</italic><sup><italic>2</italic></sup> continuity, i.e., it is twice continuously differentiable. This property allows for smooth transitions between polynomial segments while preserving local control, since changes in a control point only affect its neighboring region. As a result, the model provides sufficient flexibility to capture a wide range of motion trajectories.</p>
<p>Each segment of the spline curve <italic>S</italic><sub><italic>c</italic></sub>(<italic>t</italic>) is a linear combination of basic B-spline functions <italic>B</italic><sub><italic>i,d</italic></sub>(<italic>t</italic>), weighted by neighboring control points <italic>Q</italic><sub><italic>i</italic></sub> (<xref ref-type="bibr" rid="c10">Farin, 2001</xref>):
<disp-formula id="eqn3">
<graphic xlink:href="674398v1_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<p>For degree <italic>d</italic>, the blending functions <inline-formula><inline-graphic xlink:href="674398v1_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula> are defined recursively by the Cox-de Boor algorithm:
<disp-formula id="eqn4">
<graphic xlink:href="674398v1_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn5">
<graphic xlink:href="674398v1_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>t</italic> ∈ [0,1] is a normalized parameter along the spline curve. For cubic B-splines, <italic>d</italic> = 3. A cubic B-spline segment can also be written in matrix formulation for better computational efficiency:
<disp-formula id="eqn6">
<graphic xlink:href="674398v1_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<p>Likewise, a bicubic B-spline surface <italic>S</italic><sub><italic>s</italic></sub>(<italic>u</italic><sub><italic>i</italic></sub>, <italic>v</italic><sub><italic>j</italic></sub>) follows an analogous matrix formulation:
<disp-formula id="eqn7">
<graphic xlink:href="674398v1_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>M</italic> is the same 4 × 4 blending-function matrix, and <italic>Q</italic><sub><italic>grid</italic></sub> is the 4 × 4 arrangement of control points <italic>Q</italic><sub><italic>i</italic>+<italic>k,j</italic>+<italic>l</italic></sub>. The indices <italic>i, j</italic> specify the segment positions along the <italic>y</italic> and <italic>x</italic> axes, while <italic>u, v</italic> ∈ [0,1] are the normalized parameters along those axes.</p>
</sec>
<sec id="s2c2">
<title>Control points and knots</title>
<p>Each cubic B-spline curve segment is defined by four control points, with each control point influencing up to four adjacent segments, whereas each bicubic B-spline surface requires sixteen control points. As shown in <xref rid="fig1" ref-type="fig">Figure 1a</xref>, control points are not located directly on the curve. The endpoints of curve segments and the four corners of the surface segments are referred to as “knots”. Adjusting the control points alters the curve’s shape, while the knots of a uniform spline are evenly distributed. To determine a B-spline curve/surface, we only need to know the knot parameters. The relationship between control points and knots for a curve or surface segment can be expressed as (<xref ref-type="bibr" rid="c2">Agrapart &amp; Batailly, 2020</xref>):
<disp-formula id="eqn8">
<graphic xlink:href="674398v1_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where Φ is the passing matrix determined by the Cox-de Boor algorithm and the chosen boundary conditions. In this work, we adopt free-end boundary conditions, allowing the spline to extend linearly beyond the boundary points (<xref rid="fig1" ref-type="fig">Figure 1b</xref>). This prevents artificial curvature at the edges, maintaining the natural flow of the surface without imposing strict derivative constraints. For a cubic spline, the free-end boundary condition is implemented as follows:
<disp-formula id="eqn9">
<graphic xlink:href="674398v1_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
and for bicubic splines, the same condition applies along the edges. At the corners, the boundary condition is:
<disp-formula id="eqn10">
<graphic xlink:href="674398v1_eqn10.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Uniform cubic spline curve.</title>
<p><bold>(a)</bold> Diagram showing the core components of a cubic B-spline curve, such as knots, control points, and the uniform knot positions <italic>t</italic><sub><italic>i</italic></sub>. <bold>(b)</bold> Diagram showing the free-end boundary condition for a cubic B-spline.</p></caption>
<graphic xlink:href="674398v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>where <italic>m</italic> and <italic>n</italic> are the number of knots along <italic>x</italic> and <italic>y</italic> axes, respectively.</p>
</sec>
<sec id="s2c3">
<title>Knot grid configuration</title>
<p>Our model assigns <italic>NK</italic><sub><italic>x</italic></sub>, <italic>NK</italic><sub><italic>y</italic></sub>, and <italic>NK</italic><sub><italic>z</italic></sub> as the number of knots along the <italic>x, y</italic>, and <italic>z</italic> axes, respectively. By default, <italic>NK</italic><sub><italic>x</italic></sub> and <italic>NK</italic><sub><italic>y</italic></sub> are set to two-thirds of the patch number in each dimension, with a minimum of four knots, and evenly distributed along <italic>x</italic> and <italic>y</italic>. Along the <italic>z</italic> axis, knots are spaced at every 4<italic>e</italic><sup>−</sup>/Å of exposure, forming a three-dimensional grid together with the knots along <italic>x</italic> and <italic>y</italic>. Since shifts occur in both <italic>x</italic> and <italic>y</italic>, we maintain two sets of knot parameters, <italic>K</italic><sub><italic>x</italic></sub> and <italic>K</italic><sub><italic>y</italic></sub>. Given these knots, we can interpolate a dense field of shifts for every pixel in each movie frame, thereby correcting local distortion in each frame.</p>
<p><xref rid="fig2" ref-type="fig">Figure 2</xref>. illustrates the knot grid and the construction of the 3D spline model. In <xref rid="fig2" ref-type="fig">Figure 2a</xref>, the spline curve for shifts along the <italic>x</italic> direction is shown along the exposure accumulation direction. In this case, for a movie with 40 frames and a total exposure of 16<italic>e</italic><sup>−</sup>/Å, a knot is assigned every 10 frames. Once the shift amounts at the knots are determined, the cubic spline model, as described above, is used to compute the shift along <italic>x</italic> for each movie frame. By combining these shifts with the shifts along the <italic>y</italic>-direction, we can obtain the full spline curve thread as shown in <xref rid="fig2" ref-type="fig">Figure 2b</xref>. For a model with <italic>NK</italic><sub><italic>x</italic></sub>, <italic>NK</italic><sub><italic>y</italic></sub> knots along <italic>x</italic> and <italic>y</italic>, we will generate<italic>NK</italic><sub><italic>x</italic></sub> × <italic>NK</italic><sub><italic>y</italic></sub> of such 3D splines. Thus, for each movie frame, we will have a 2D grid of knots for generating the bicubic spline surface, represented by the black points in <xref rid="fig2" ref-type="fig">Figure 2e</xref>. <xref rid="fig2" ref-type="fig">Figure 2c,d</xref> show the shift fields along <italic>x</italic> and <italic>y</italic>, respectively, for a single movie frame derived using the bicubic splines. <xref rid="fig2" ref-type="fig">Figure 2e</xref> displays the image before (gray grid) and after (cyan grid) warping, based on the shift fields shown in <xref rid="fig2" ref-type="fig">Figure 2c,d</xref>. For better visualization, we amplified the distortion in these figures.</p>
</sec>
<sec id="s2c4">
<title>Parameter refinement</title>
<p>The initial refinement of knot values relies on a least-squares error minimization approach. Given the parameters <italic>K</italic><sub><italic>x</italic></sub> and <italic>K</italic><sub><italic>y</italic></sub> for the <italic>x</italic>- and <italic>y</italic>-axis, respectively, the spline model can initialize the per-patch shifts for each frame (<italic>x</italic><sub><italic>spline</italic></sub>(<italic>pi, fi</italic>; <italic>K</italic><sub><italic>x</italic></sub>), <italic>y</italic><sub><italic>spline</italic></sub>(<italic>pi, fi</italic>; <italic>K</italic><sub><italic>y</italic></sub>)). We estimate <italic>K</italic><sub><italic>x</italic></sub> and <italic>K</italic><sub><italic>y</italic></sub> by minimizing the following least-square loss function:
<disp-formula id="eqn11">
<graphic xlink:href="674398v1_eqn11.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>3D spline model knot grid construction and shift field generation.</title>
<p><bold>(a)</bold> Diagram showing the position of knots along the exposure accumulation direction and the shift amount along x for each movie frame. <bold>(b)</bold> A 3D diagram showing the cubic B-spline along the exposure accumulation direction, with red arrows representing the shifts where the knots are located (black dots on the gray line), and the cyan curve showing the spline curve for interpolating the shifts for each frame. <bold>(c, d)</bold> Shift field along x and y showing the shift amount of each pixel obtained from the bicubic B-splines on a 10 × 10 pixels frame (for demonstration only). <bold>(e)</bold> Schematic image grid before (gray grids) and after (cyan grid) applying the shift fields in <bold>(c, d).</bold> The red arrows represent the shift of patches. Black dots represent knot positions.</p></caption>
<graphic xlink:href="674398v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Minimizing <italic>L</italic><sub>1</sub> aligns the spline model with the observed per-patch shifts, and yields the patch stack alignment result {(<italic>x</italic><sub><italic>pi,fi</italic></sub>, <italic>y</italic><sub><italic>pi,fi</italic></sub>) | <italic>pi</italic> ∈ {1,2, …, <italic>NP</italic>}, <italic>fi</italic> ∈ {1,2, · ·, <italic>NF</italic>}}. Because this initial fit relies solely on local per-patch information, a second round of refinement is done to incorporate global information. To this end, we define the following loss function:
<disp-formula id="eqn12">
<graphic xlink:href="674398v1_eqn12.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>CC</italic> denotes the cross-correlation function between a single frame in a patch stack <inline-formula><inline-graphic xlink:href="674398v1_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and the “leave-one-out” average of the remaining frames in the same patch stack:
<disp-formula id="eqn13">
<graphic xlink:href="674398v1_eqn13.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<p>Since patches with stronger signal yield larger cross-correlation values, they contribute more heavily to <italic>L</italic><sub>2</sub>, thereby reducing the impact of noisier patches. The optimization algorithm L-BFGS is used to update parameters <italic>K</italic><sub><italic>x</italic></sub> and <italic>K</italic><sub><italic>y</italic></sub>, producing a refined spline model that better captures the observed local movement. With these optimized parameters, pixel-wise shifts are computed, and bilinear interpolation is applied to calculate the densities at each output pixel, thereby generating the final motion-corrected movie frames. Averaging these frames produces the final corrected micrograph. As shown in <xref rid="fig2" ref-type="fig">Figure 2e</xref>, after applying the model-based shifts, areas near the edges may extend beyond or fall short of the original micrograph’s pixel grid. In such cases, we pad the under-extended area with the average density of the edge and trim the over-extended area to fit within the boundaries of the micrograph.</p>
</sec>
</sec>
<sec id="s2d">
<title>2DTM provides a one-step verification for motion correction</title>
<p>2D template matching (2DTM) has originally been developed to identify biomolecules in images of crowded cellular environments with high precision in both location and orientation.</p>
<p>The true-positive detection is based on the 2DTM SNR at each target site (<xref ref-type="bibr" rid="c24">Rickgauer et al., 2017</xref>; <xref ref-type="bibr" rid="c28">Sigworth, 2004</xref>). Because the 2DTM SNR is computed by correlating template projections with the micrograph, it provides an unbiased measure of how effective the molecular signal is preserved in the distortion-corrected micrograph. In the present study, we will use both the number of detectable particles and their 2DTM SNR as metrics for evaluating the performance of our distortion correction method.</p>
<p>We applied our model to a range of <italic>in-situ</italic> samples commonly studied in structural biology, including whole cells (bacteria and the edges of mammalian cells), lamellae (yeast and mammalian cells), and cellular lysate. Ribosomes, which can be detected with high accuracy by 2DTM using <italic>cis</italic>TEM (<xref ref-type="bibr" rid="c12">Grant et al., 2018</xref>), were chosen as the primary targets in the following experiments. Furthermore, we also tested the performance of our new algorithm on DeCo-LACE micrograph montages (<xref ref-type="bibr" rid="c9">Elferich et al., 2022</xref>).</p>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>High resolution information recovery</title>
<p>Using the new graphical user interface (GUI) for motion correction in <italic>cis</italic>TEM, users can readily visualize local motion by enabling the trajectory option. <xref rid="fig3" ref-type="fig">Figure 3</xref> illustrates an example micrograph acquired from <italic>Mycoplasma pneumoniae</italic> whole-cell samples. In this case, a vortex-shaped motion is observed in the region where two cells are closely adjacent to each other. The patch trajectories (shown in red) are magnified by a factor of 30 for clarity. <xref rid="fig3" ref-type="fig">Figure 3b, c</xref> provide zoomed-in views of the boxed area and the corresponding power spectra generated from the micrograph after local distortion-corrected alignment versus full-frame alignment, respectively. <xref rid="fig3" ref-type="fig">Figure 3d, e</xref> show the detected particles (white projections) using 2DTM in the micrograph processed with and without local distortion correction, respectively. The larger number of detected 2DTM targets demonstrates that the blurring caused by the local distortion has been significantly reduced by our <italic>Unbend</italic> program. This can also be seen in the power spectra calculated from the micrograph, exhibiting more pronounced Thon rings at higher resolution after local distortion correction (<xref rid="fig3" ref-type="fig">Figure 3b, c</xref>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>A micrograph of whole-cell Mycoplasma pneumoniae.</title>
<p><bold>(a)</bold> Motion trajectory panel in the <italic>cis</italic>TEM GUI. <bold>(b)</bold> The cropped area shown in (a) without local distortion correction, experiencing blurring due to the local distortion (upper) and the power spectrum (lower). <bold>(c)</bold> The cropped area (upper) and the power spectrum of the local distortion-corrected micrograph (lower). <bold>(d)</bold> Detected particles (white) using 2DTM on the full-frame aligned micrograph. <bold>(e)</bold> Detected particles (white) using 2DTM on the local-distortion corrected micrograph.</p></caption>
<graphic xlink:href="674398v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s3b">
<title>Local motion across different samples</title>
<p>We benchmarked our motion-correction model using three types of <italic>in-situ</italic> specimens: whole cells, lamellae, and cell lysates. For whole cells, we used a frozen-hydrated <italic>Mycoplasma pneumoniae</italic> dataset (<xref ref-type="bibr" rid="c22">O’Reilly et al., 2020</xref>) previously employed for the development of 2DTM with <italic>cis</italic>TEM (<xref ref-type="bibr" rid="c16">Lucas et al., 2021</xref>). To enable comparison across different sample types and geometries, mammalian cells were also included, specifically, immortalized <italic>Cercopithecus aethiops</italic> (African green monkey) BS-C-1 kidney epithelial cells (see Materials and Methods). Lamella datasets originated from two eukaryotic organisms: <italic>Saccharomyces cerevisiae</italic> and immortalized <italic>Mus musculus</italic> ER-HoxB8 cells, both previously analyzed by 2DTM (<xref ref-type="bibr" rid="c17">Lucas et al., 2022</xref>; <xref ref-type="bibr" rid="c9">Elferich et al., 2022</xref>). The cell lysate sample was derived from BS-C-1 cells, as described in Materials and Methods.</p>
<p>To quantify the local movement, we measure the displacement of each patch’s last frame relative to its first frame in a micrograph {<italic>sh</italic><sub><italic>pi</italic></sub>| <italic>pi</italic> ∈ {1,2, …, <italic>NP</italic>}}, where
<disp-formula id="eqn14">
<graphic xlink:href="674398v1_eqn14.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<p>Since the full-frame alignment is assumed to remove the global average motion, the patch motions/shifts (<italic>sh</italic><sub><italic>pi</italic></sub>) primarily represent the BIM that reflect the sample’s deformation, measuring how much the patch centers are displaced from their initial positions. To characterize the extent of local motion, we compute the maximum, mean, and standard deviation of these shifts for each micrograph. We find that cell lysate exhibits the least local motion, whereas the <italic>Mycoplasma pneumoniae</italic> samples demonstrate substantially larger local motions, with maximum displacements of over 55 Å. <italic>Mus musculus</italic> cell lamella and BS-C-1 cell edge samples also show considerable local motion (up to 20 Å). As indicated by the standard deviation data in <xref rid="fig4" ref-type="fig">Figure 4</xref>, samples with large average patch motion also exhibit greater variability in local motion across a micrograph. Such pronounced local motion will significantly attenuate high-resolution information in the micrograph, making its correction essential for high-resolution cryo-EM experiments.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Patch shift in different types of samples.</title>
<p><bold>(a)</bold> Box plots of the standard deviation of patch motions calculated for micrographs of different types of samples. <bold>(b)</bold> The mean patch shifts for each micrograph, colored by sample type.</p></caption>
<graphic xlink:href="674398v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To assess whether local motion correlates with specimen thickness, we estimated the sample thickness using CTFFIND5 (<xref ref-type="bibr" rid="c8">Elferich et al., 2024</xref>) and plotted the mean shift against sample thickness for each micrograph (<xref rid="fig4" ref-type="fig">Figure 4b</xref>). For consistency, all micrographs were binned to 1.5 Å/pixel during alignment and outliers shown in <xref rid="fig4" ref-type="fig">Figure 4a</xref> are excluded for better pattern visualization. BS-C-1 cell edge samples span a broad thickness range (50 ∼ 400 nm) and their mean displacements likewise cover the full range of observed shifts. <italic>Mycoplasma pneumoniae</italic> are generally thicker (150 ∼ 400 nm) and their mean displacements also distribute in the upper range (2.5 ∼ 6 Å). In contrast, cell-lysate specimens are thinner (50 ∼ 150 nm) and exhibit the least local motion, and even at the upper end (100 ∼ 150 nm) of this range exhibit mean shifts below 1 Å. However, lamellae of similar thickness show mean displacements from &lt; 1 Å to &gt; 6 Å. These results indicate no direct dependence of local motion on sample thickness; rather, motion magnitude is highly related to the sample type and preparation method.</p>
</sec>
<sec id="s3c">
<title>Pixel-wise deformation quantification using equivalent strain</title>
<p>To quantify pixel-wise shifts within each movie frame, we developed shift_field_generation, a program that reconstructs the per-pixel displacement field of any given frame by interpolating the spline parameters exported by <italic>Unbend</italic> during movie alignment. Using the first frame as a reference, we compute the displacement of the final frame and derive two complementary strain measures: Von Mises equivalent strain, which measures distortional (shape-changing) effects; and total equivalent strain, which captures both volumetric (area-changing) and distortional components (see Materials and Methods). Both measures range from 0 to infinite, with 0 designating no deformation, and provide scalar quantities that condense a multi-dimensional strain (or stress) state to equivalent single-dimensional values.</p>
<p><xref rid="fig5" ref-type="fig">Figure 5</xref>. presents strain maps for the example micrograph shown in <xref rid="fig3" ref-type="fig">Figure 3</xref>. The Von Mises (Green-Lagrange strain) map (<xref rid="fig5" ref-type="fig">Figure 5a</xref>) highlights a localized shear-dominated “vortex” region where strain exceeds 1%, indicating significant non-isotropic deformation, which is consistent with the rotation motion shown by the patch trajectories in <xref rid="fig3" ref-type="fig">Figure 3a</xref>. The total equivalent strain map (<xref rid="fig5" ref-type="fig">Figure 5b</xref>) shows that the total equivalent stain of this area is above 1.4%, with the rest of the field remaining below 1.2% deformation.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Magnitude of deformation correction of the micrograph shown in <xref ref-type="fig" rid="fig3">Figure 3a</xref>.</title>
<p>(a) Von Mises equivalent strain and (b) total equivalent strain.</p></caption>
<graphic xlink:href="674398v1_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The result in <xref rid="fig5" ref-type="fig">Figure 5</xref> is based on the alignment using a grid of 12 × 8 patches, which can track the local strain patterns with fine granularity. Reducing the number of patches can smooth small-scale fluctuations and reduce apparent peak strain values but may under-sample genuine local distortions. This trade-off between patch resolution and deformation magnitude suggests that the optimal patch density may depend on sample type and exposure rate. <italic>Unbend</italic> allows users to tailor the number of patches to their specimen and exposure-fractionation scheme, optimizing alignment fidelity and desired amount of deformation correction.</p>
</sec>
<sec id="s3d">
<title>Quantitative measurement of corrected motion using 2DTM</title>
<p>To assess improvements in preserving high-resolution signal in the motion-corrected micrographs, we searched for large ribosomal subunits (LSUs) using 2DTM, as described in the Materials and Methods section. Stronger high-resolution signal leads to both an increased number of detected targets (<xref rid="fig6" ref-type="fig">Figure 6a</xref>) and higher 2DTM SNR values (<xref rid="fig6" ref-type="fig">Figure 6b</xref>). We also compared the SNRs of the same detections present in both micrographs processed with full-frame alignment and those processed with local distortion correction. The SNR differences are shown in <xref rid="fig6" ref-type="fig">Figure 6c</xref>, sorted for better visualization.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><title>Evaluation of local motion correction using <italic>Unbend</italic> across different sample types.</title>
<p><bold>(a)</bold> Box plots displaying the distribution of the number of 2DTM detections per micrograph. <bold>(b)</bold> Histograms of the 2DTM SNR of detected 2DTM targets. <italic>Unbend</italic> improves the overall distribution of SNR values for all sample types. <bold>(c)</bold> 2DTM SNR difference between <italic>Unbend</italic> and <italic>Unblur</italic>. Across all sample types, <italic>Unbend</italic> led to improvements in either the number of detected targets or 2DTM SNR values, or both.</p></caption>
<graphic xlink:href="674398v1_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In whole-cell <italic>Mycoplasma pneumoniae</italic> samples, distortion correction resulted in a 4.2-fold increase in LSU detection (95.5 vs. 22.9 detections per image), and the mean 2DTM SNR improved by ∼3.1% (8.96 ± 0.02 vs. 8.69 ± 0.01). The low values of standard error of the mean (SEM) (0.02 and 0.01) indicate a consistent 2DTM SNR improvement. In BS-C-1 whole-cell samples, the number of LSU detections increased from 55.9 to 69.1(∼ 23.6% improvement), and the 2DTM SNR improved from 9.88 ± 0.02 to 10.42 ± 0.02 (∼5.5% improvement). For targets detected in both full-frame and local-distortion corrected micrographs, approximately 80% showed higher 2DTM SNR values after local distortion correction (<xref rid="fig6" ref-type="fig">Figure 6c</xref>). Of the 20% of detected targets that displayed lower 2DTM SNR values after local distortion correction, some showed a reduction of up to a factor of 2. This reduction can be attributed to the motion correction process, which optimizes an overall loss function <italic>L</italic><sub>2</sub>(<italic>K</italic><sub><italic>x</italic></sub>, <italic>K</italic><sub><italic>y</italic></sub>) and models motion using continuous functions to avoid patch alignments dominated by noise. This suggests that there are local areas that happen to be well aligned using full-frame alignment, and that end up with an overall worse alignment when additional degrees of freedom are added during local alignment. Nevertheless, local distortion correction resulted in a 317% increase in LSU detections in <italic>Mycoplasma pneumoniae</italic> and a 24% increase for BS-C-1, with an overall 2DTM SNR improvement by 3 ∼ 5%.</p>
<p>For lamellae prepared from <italic>Saccharomyces cerevisiae</italic> and ER-HoxB8 cells, the mean number of LSU detections per micrograph increased from 350 to 401 (∼15% increase) in yeast samples and from 8.5 to 10.0 (∼17% increase) in mammalian samples. The mean 2DTM SNR for yeast sample improved from 10.18 ± 0.01 to 10.62 ± 0.01 (∼ 4% increase), and for mammalian samples, it increased from 10.4 ± 0.1 to 11.2 ± 0.1 (∼8% increase). As noted earlier, motion in ER-HoxB8 lamellae varies from less than 1 Å to 6 Å, contributing to a relatively larger SEM value (0.1).</p>
<p>Lysates generated from BS-C-1 cells showed no substantial increase in the number of LSU detections, but a 3% improvement in the 2DTM SNR was observed (from 13.84 ± 0.04 to 14.25 ± 0.04). As shown in <xref rid="fig4" ref-type="fig">Figure 4</xref>, cell lysates exhibit minimal local motion, and full-frame alignment is sufficient to correct for most BIM in these samples. However, small amounts of local motion may remain and this may explain the improved 2DTM SNR in 70% of the detected targets (<xref rid="fig6" ref-type="fig">Figure 6c</xref>).</p>
<sec id="s3d1">
<title>DeCo-LACE montages</title>
<p>To better understand the beam-induced deformations, we analyzed a dataset of micrographs collected from lamellae of <italic>Candida albicans</italic> cells. In this dataset, lamellae of individual cells were imaged as montages (DeCo-LACE, <xref ref-type="bibr" rid="c9">Elferich et al., 2022</xref>). We performed motion correction of the individual exposures within these montages using either full-frame alignment or <italic>Unbend</italic>, and found that in 47 out of 82 montages, the number of detected targets increased by more than 10% (<xref rid="fig7" ref-type="fig">Figure 7a</xref>). This indicates that patch-based motion correction recovered signal that would otherwise have been lost to image blurring due to local deformations. In some montages, the number of detected targets was substantially higher in every exposure (<xref rid="fig7" ref-type="fig">Figure 7c</xref>), suggesting that these regions of the imaged lamella were generally prone to local deformations and the observed increase in the number of detected targets was not due to a few, heavily distorted, exposures.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7.</label>
<caption><title>Impact of patch-based motion correction on detection of 60S subunits in focused ion beam-milled lamellae analyzed in a large dataset.</title>
<p><bold>(a)</bold> Histogram showing the percentage of increase of 60S detection in montages processed using <italic>Unbend</italic>, compared to <italic>Unblur</italic>. <bold>(b)</bold> Scatterplot of the number of detected 60S per exposure in a representative montage that did not show a substantial increase of detection after processing with <italic>Unbend</italic>, compared to <italic>Unblur</italic>. <bold>(c)</bold> Similar to panel <bold>(b)</bold>, but for a representative montage with a more substantial increase of detected targets after processing with <italic>Unbend</italic>, compared to <italic>Unblur</italic>.</p></caption>
<graphic xlink:href="674398v1_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For the remaining 35 montages that showed less than a 10% increase in target detection, the number of detections remained approximately unchanged between full-frame and local-distortion correction (<xref rid="fig7" ref-type="fig">Figure 7b</xref>). While we cannot rule out that areas in these lamellae experienced local deformations that were not corrected by our algorithm, the overall similarity in the number of detections per exposure and in the 2DTM SNR of 60S targets compared to the full dataset suggests that these areas likely did not suffer from significant BIM. In fact, the mean 2DTM SNR in areas with less than a 10% increase in detections was 11.1, whereas the mean 2DTM SNR in areas with more than a 50% increase was 10.7. This suggests that patch-based motion correction recovers most, but not all signal lost to local deformation.</p>
<p>In summary, our data suggest that local deformation in lamellae is not uniform: for reasons that remain unclear, some lamellae remain rigid while others display local deformation. Together with the finding that, despite patch-based motion correction, the average 2DTM SNR is still higher in areas without deformation, we propose that future work aimed at uncovering the physical basis of this variability could lead to improvements in <italic>in-situ</italic> cryo-EM datasets.</p>
</sec>
</sec>
<sec id="s3e">
<title>Unbend runtimes</title>
<p>We benchmarked the runtimes of <italic>Unbend</italic> using the movie datasets analyzed in this study.</p>
<p>Each job was executed with 4 CPU threads on Intel Xeon Gold 5520+ processors. Table 1 summarizes the runtimes together with key parameters of the input movies and the corresponding output micrographs. The runtimes range from ∼1.5 mins to ∼12.5 mins per movie, depending primarily on the input image size and the number of frames. The most time-consuming step is the pixel-wise interpolation, which is performed on unbinned frames. This explains why larger input dimensions and higher frame numbers result in longer runtimes.</p>
</sec>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>In this work, we introduce <italic>Unbend</italic>, a cryo-EM movie alignment program that can perform local motion correction using a 3D cubic spline model. The program begins with full-frame alignment, followed by tracking of local motion via patch-based alignment. Our 3D cubic spline model is then fit to the patch motion and optimized by a summed patch-wise cross-correlation loss function, yielding refined model parameters. With this optimized model, pixel-wise shifts are calculated for each movie frame to generate the motion-corrected micrograph.</p>
<p><italic>Unbend</italic> is integrated into our <italic>cis</italic>TEM software, featuring a new GUI with real-time distortion visualization. Combined with our new program shift_field_generation, pixel-wise shift fields can be generated for calculating total and Von Mises equivalent strain. These metrics quantify the extent of deformation and can serve as a reference for adapting the number and overlap of patches to avoid introducing excessive errors in the deformation model.</p>
<sec id="s4a">
<title>Model performance</title>
<p>We validated <italic>Unbend</italic> across diverse <italic>in-situ</italic> samples, including whole cells, lamellae, and cell lysates, and used 2DTM to quantify the improvement in high-resolution signal in the motion-corrected micrographs. Across all sample types tested, <italic>Unbend</italic> boosted 2DTM SNR by 3 ∼ 8% and the number of detected targets by up to 317%, with the largest gains observed in specimens exhibiting large local motion (whole cells and lamellae). While cell lysate showed minimal local motions, a 3% improvement in 2DTM SNR was still observed.</p>
<p>Equivalent-strain analysis confirmed that, apart from some samples of the <italic>M. pneumoniae</italic> dataset, correction-induced deformations remain below 1.0%, suggesting that the model improves alignment without introducing excessive errors. The strain fields showing the maximum patch shift amounts in micrographs of different samples in <xref ref-type="fig" rid="fig4">Figure 4</xref> are presented in <xref ref-type="supplementary-material" rid="fig4s1">Figure 4—figure supplement 1 – 5</xref> and summarized in <xref ref-type="supplementary-material" rid="fig4s6">Figure 4—figure supplement 6</xref>. For the <italic>M. pneumoniae</italic> sample in <xref ref-type="supplementary-material" rid="fig4s1">Figure 4—figure supplement 1</xref>, strain analysis revealed maximum Von Mises and total equivalent values exceeding 2.2% and 3.5%, respectively, consistent with plastic deformation. Comparison of the corresponding power spectra (<xref ref-type="supplementary-material" rid="fig4s1">Figure 4— figure supplement 1a,b</xref>) showed that the micrographs corrected with <italic>Unbend</italic> displayed stronger Thon rings at high spatial frequencies, confirming that the observed plastic deformation was, at least partially, accommodated.</p>
<p>Together, these results demonstrate that local motion correction is essential for obtaining fully motion-corrected micrographs, especially when imaging whole cells and lamellae.</p>
</sec>
<sec id="s4b">
<title>Implications and limitations</title>
<p>Our results indicate that specimen type and preparation method strongly influence local sample motion. Whole cells often exhibit large thickness gradients that can potentially create areas of differential motion under the electron beam, while in lamellae, which are generally thinner and more homogeneous, some stress may still be present due to the milling process and residual sample inhomogeneity. The local distortion correction model is particularly beneficial in this context, as it can compensate for these localized motion artifacts, leading to more accurate particle detection and improved 2DTM SNR. Cell lysates typically show less localized motion, and full-frame alignment is sufficient for detecting most targets using 2DTM, although some residual local distortion remains detectable and correctable.</p>
<p>Lamellae montages collected using DeCo-LACE (<xref ref-type="bibr" rid="c9">Elferich et al., 2022</xref>) further revealed substantial spatial heterogeneity in the amount of local motion, indicated by the range of 2DTM detection gains from under 10% to over 50% within a single sample. We found that montages with less motion better preserve high-resolution signal, suggesting that further improvements in the motion correction model, perhaps based on a more detailed physical mechanism, may yield additional benefits. For single particle samples, which are generally thin and homogeneous, local motion is less pronounced, and full-frame alignment should be sufficient in most cases.</p>
<p>Therefore, they were not tested in this work.</p>
</sec>
</sec>
<sec id="s5">
<title>Materials and methods</title>
<sec id="s5a">
<title>Cell culture, cell lysate and grid preparation</title>
<p>Adherent BS-C-1 cells were cultured as previously described by (<xref ref-type="bibr" rid="c26">Salgado et al., 2018</xref>). Briefly, cells were maintained at 37°C in a humidified atmosphere with 5% CO<sub>2</sub> and grown in Dulbecco’s Modified Eagle Medium (DMEM; Invitrogen) supplemented with 10% fetal bovine serum (FBS), 1X GlutaMAX (Thermo Fisher Scientific), and 1% penicillin-streptomycin (100 U/mL penicillin and 100 µg/mL streptomycin; Thermo Fisher Scientific). For grid seeding, cells were washed twice with pre-warmed PBS and detached using trypsin-EDTA (Gibco). Cells were counted, diluted to 1 × 10<sup>5</sup> cell/ml and seeded onto fibronectin-coated (5 µg/mL in PBS) EM grids.</p>
<p>Double-side glow-discharged, 200-mesh gold grids with a silicon oxide support film containing 2 µm holes and 2 µm spacing (Quantifoil) were used. Prior to use, grids were cleaned by three washes with ethyl acetate and exposed to UV light under a laminar flow hood for 45 minutes. Grids were placed into 35 mm glass-bottom tissue culture dishes (MatTek) for cell growth. Cells were allowed to adhere and spread for 24–48 hours before vitrification. Each grid was inspected under an inverted light microscope to confirm appropriate cell density and carbon film integrity. We aimed for approximately one cell per mesh; grids with excessive cell clumping were excluded.</p>
<p>Immediately before plunge freezing, grids were washed twice with warm PBS and transferred into Minimum Essential Medium Eagle Alpha (MEMα; Sigma) supplemented with 25 mM of HEPES buffer. Grids were then rapidly moved from the incubator to a Leica GP2 cryo-plunger, excess liquid was blotted from the back side for 8 seconds, and grids were plunge-frozen into liquid ethane cooled to –184 °C.</p>
<p>Cell extracts were prepared from BSC-1 cells using digitonin-based semi-permeabilization. Briefly, cells were seeded in a 75 cm<sup>2</sup> flask and cultured to confluence. After washing twice with pre-warmed PBS, the cells were detached with Trypsin-EDTA (Gibco) and collected by centrifugation at 300 × g for 4 minutes. The cell pellet was resuspended in 100 μL of semi-permeabilization buffer (25 mM HEPES, 110 mM potassium acetate, 15 mM magnesium acetate, 1 mM DTT, 0.015% digitonin, protease inhibitor cocktail (1 tablet/ 10 ml; Roche), 40 U/mL RNase In (Promega), 1 mM EGTA) and 4 °C for 5 minutes. Following centrifugation at 1,000 × g for 5 minutes, the supernatant was collected for use in grid preparation without further modification. RNA concentration was quantified prior to grid preparation as a quality control measure, with no dilution of the extract performed. Glow-discharged Quantifoil 200-mesh gold grids with a silicon oxide support film containing 2 µm holes and 2 µm spacing were used. Plunge freezing conditions used were identical to those described for whole cells.</p>
</sec>
<sec id="s5b">
<title>Cryo-EM data acquisition</title>
<p>Cryo-EM data were collected using a Titan Krios transmission electron microscope (Thermo Fisher Scientific) operated at 300 keV, equipped with a K3 direct electron detector and an energy filter (Gatan) set to a 20 eV slit width.</p>
<p>For cell edge data collection, medium magnification montages were used to select vitrified cell areas that were transparent enough for cryo-EM. Images were acquired at a nominal magnification of 64,000× corresponding to a calibrated pixel size of 1.33 Å. A defocus range of –1.0 to –1.5 µm was targeted using SerialEM’s autofocus function (<xref ref-type="bibr" rid="c19">Mastronarde, 2005</xref>) on a sacrificial area. Movies were recorded at an exposure rate of 1.02 <italic>e</italic><sup>−</sup>/Å per frame to a total accumulated exposure of 30.6 <italic>e</italic><sup>−</sup>/Å.</p>
<p>For the cell lysate, we used a nominal magnification of 105,000× corresponding to a calibrated pixel size of 0.83 Å. We employed beam tilt to acquire multiple movies (5 per hole across nine holes) at each stage position. Zero-loss peak (ZLP) refinement was performed every 90 minutes at a unique location to avoid dark areas. Movies containing 30 frames, with an exposure of 1.0 <italic>e</italic><sup>−</sup>/Å per frame, were recorded, resulting in a total exposure of 30 <italic>e</italic><sup>−</sup>/Å.</p>
</sec>
<sec id="s5c">
<title>2D template generation and 2D template matching</title>
<p>For 2DTM, 3D templates were generated from trimmed atomic models containing only the large ribosomal subunit (50S or 60S), using the simulate program (<xref ref-type="bibr" rid="c14">Himes &amp; Grigorieff, 2021</xref>). Specifically, models derived from PDB entries 5LZV (for mammalian samples: BS-C-1 and ER-HoxB8), 6Q8Y (for <italic>Saccharomyces cerevisiae</italic>), and 3J9W (<italic>for Mycoplasma pneumoniae</italic>) were used. 2DTM was performed using the match_template program (<xref ref-type="bibr" rid="c16">Lucas et al., 2021</xref>) as implemented in <italic>cis</italic>TEM. The search was conducted with an in-plane angular step of 1.5° and an out-of-plane step of 2.5°. For whole-cell and lamella samples, and additional defocus search was conducted within ±120 nm of the estimated defocus, using 20 nm increments.</p>
<p>Template-matched coordinates, Euler angles, and defocus values were extracted using the MT module within the <italic>cis</italic>TEM GUI and exported as.star files. These files were subsequently analyzed to quantify the number of detected targets and the 2DTM SNR using custom Python scripts in Jupyter Notebook. The sample thickness was determined using CTFFIND5.</p>
</sec>
<sec id="s5d">
<title>Von Mises equivalent strain and total equivalent strain</title>
<p>The Von Mises equivalent strain derives from the Von Mises criterion, widely used in engineering and mechanics to predict yielding or failure of materials subjected to complex (multiaxial) stresses or strains. The Von Mises equivalent strain effectively measures how far a material is distorted from its original shape. In our case, with the shift field {<italic>u</italic><sub><italic>x</italic></sub>, <italic>u</italic><sub><italic>y</italic></sub>}, we can obtain the deformation gradient <bold><italic>F</italic></bold>:
<disp-formula id="eqn15">
<graphic xlink:href="674398v1_eqn15.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<p>The Green–Lagrange strain tensor <bold><italic>E</italic></bold> filters out the rigid-body rotations measures the true finite strains, and can be calculated by:
<disp-formula id="eqn16">
<graphic xlink:href="674398v1_eqn16.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<p>The total equivalent strain combines the magnitude of all deformation modes (axial + shear) and is expressed as:
<disp-formula id="eqn17">
<graphic xlink:href="674398v1_eqn17.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<p>The Von Mises equivalent strain removes the volume change and only keep the shape change:
<disp-formula id="eqn18">
<graphic xlink:href="674398v1_eqn18.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="674398v1_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the deviatoric strain:
<disp-formula id="eqn19">
<graphic xlink:href="674398v1_eqn19.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<italic>δ</italic><sub><italic>ij</italic></sub> is the Kronecker delta, and <italic>tr E</italic> is the volumetric part/trace, which represent the pure “dilation” or “compression” component that changes the area but not shape:
<disp-formula id="eqn20">
<graphic xlink:href="674398v1_eqn20.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
</sec>
</sec>
</body>
<back>
<sec id="s6" sec-type="data-availability">
<title>Data availability</title>
<p>Movies of samples not published previously have been deposited on EMPIAR: ER-HOXB8 cells (EMPIAR-12944); movies of BS-C-1 cell edges (EMPIAR-12943); movies of BS-C-1 cell lysate (EMPIAR-12942). The source code for <italic>Unbend</italic> is part of <italic>cis</italic>TEM and available at <ext-link ext-link-type="uri" xlink:href="https://github.com/timothygrant80/cisTEM/tree/unbend">https://github.com/timothygrant80/cisTEM/tree/unbend</ext-link>; binaries for most Linux distributions can be downloaded at <ext-link ext-link-type="uri" xlink:href="https://cistem.org/downloads">https://cistem.org/downloads</ext-link>.</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>The authors thank members of the Grigorieff lab for helpful discussions. We are also grateful for the use of and support from the cryo-EM facility at UMass Chan Medical School. L.K. and N.G. acknowledge funding from the Chan Zuckerberg Initiative, grant #2021-234617 (5022).</p>
</ack>
<sec id="additional-info" sec-type="additional-information">
<title>Additional information</title>
<sec id="s7">
<title>Author contributions</title>
<p>Conceptualization: L.K., J.E. and N.G.; Data curation: L.K., X.Z. and J.E.; Formal analysis: L.K., X.Z. and J.E.; Funding acquisition: N.G.; Investigation: L.K., X.Z. and J.E.; Methodology: L.K., J.E., and N.G.; Project administration: L.K. and N.G.; Resources: L.K., X.Z., J.E., and N.G.; Software: L.K., J.E. and N.G.; Supervision: N.G.; Validation: L.K., X.Z., J.E. and N.G.; Visualization: L.K., X.Z., J.E. and N.G.; Writing – original draft: L.K., X.Z., J.E. and N.G.; Writing - review &amp; editing: L.K., X.Z., J.E. and N.G.</p>
</sec>
</sec>
<sec id="add-files" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="fig4s1">
<label>Figure 4—figure supplement 1.</label>
<caption>
<title><italic>Mycoplasma pneumoniae</italic> sample.</title>
<p>(a) Screen shot of the <italic>cis</italic>TEM GUI displaying the motion-corrected micrograph and patch trajectories. (b) Micrograph based on full-frame alignment. (c) Von Mises equivalent strain field. (d) Total equivalent strain field.</p>
</caption>
<media mimetype="application" mime-subtype="pdf" xlink:href="674398v1_fig4s1.pdf"/>
</supplementary-material>
<supplementary-material id="fig4s2">
<label>Figure 4—figure supplement 2.</label>
<caption>
<title>BS-C-1 cell edge sample.</title>
<p>(a) Screen shot of the <italic>cis</italic>TEM GUI displaying the motion-corrected micrograph and patch trajectories. (b) Micrograph based on full-frame alignment. (c) Von Mises equivalent strain field. (d) Total equivalent strain field.</p>
</caption>
<media mimetype="application" mime-subtype="pdf" xlink:href="674398v1_fig4s2.pdf"/>
</supplementary-material>
<supplementary-material id="fig4s3">
<label>Figure 4—figure supplement 3.</label>
<caption>
<title><italic>Mus musculus</italic> ER-Hoxb8 cell lamella sample.</title>
<p>(a) Screen shot of the <italic>cis</italic>TEM GUI displaying the motion-corrected micrograph and patch trajectories. (b) Micrograph based on full-frame alignment. (c) Von Mises equivalent strain field. (d) Total equivalent strain field.</p>
</caption>
<media mimetype="application" mime-subtype="pdf" xlink:href="674398v1_fig4s3.pdf"/>
</supplementary-material>
<supplementary-material id="fig4s4">
<label>Figure 4—figure supplement 4.</label>
<caption>
<title><italic>Saccharomyces cerevisiae</italic> lamella sample.</title>
<p>(a) Screen shot of the <italic>cis</italic>TEM GUI displaying the motion-corrected micrograph and patch trajectories. (b) Micrograph based on full-frame alignment. (c) Von Mises equivalent strain field. (d) Total equivalent strain field.</p>
</caption>
<media mimetype="application" mime-subtype="pdf" xlink:href="674398v1_fig4s4.pdf"/>
</supplementary-material>
<supplementary-material id="fig4s5">
<label>Figure 4—figure supplement 5.</label>
<caption>
<title>BS-C-1 cell lysate sample.</title>
<p>(a) Screen shot of the <italic>cis</italic>TEM GUI displaying the motion-corrected micrograph and patch trajectories. (b) Micrograph based on full-frame alignment. (c) Von Mises equivalent strain field. (d) Total equivalent strain field.</p>
</caption>
<media mimetype="application" mime-subtype="pdf" xlink:href="674398v1_fig4s5.pdf"/>
</supplementary-material>
<supplementary-material id="fig4s6">
<label>Figure 4—figure supplement 6.</label>
<caption>
<title>Motion and equivalent strain summary table for micrographs shown in Figure 4—figure supplements 1–5.</title>
</caption>
<media mimetype="application" mime-subtype="pdf" xlink:href="674398v1_fig4s6.pdf"/>
</supplementary-material>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abrishami</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Vargas</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Cheng</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Marabini</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Sorzano</surname>, <given-names>C. Ó. S.</given-names></string-name>, &amp; <string-name><surname>Carazo</surname>, <given-names>J. M.</given-names></string-name></person-group> (<year>2015</year>). <article-title>Alignment of direct detection device micrographs using a robust Optical Flow approach</article-title>. <source>Journal of Structural Biology</source>, <volume>189</volume>(<issue>3</issue>), <fpage>163</fpage>–<lpage>176</lpage>. <pub-id pub-id-type="doi">10.1016/j.jsb.2015.02.001</pub-id></mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Agrapart</surname>, <given-names>Q.</given-names></string-name>, &amp; <string-name><surname>Batailly</surname>, <given-names>A.</given-names></string-name></person-group> (<year>2020</year>). <article-title>Cubic and bicubic spline interpolation in Python</article-title>. <source>HAL</source>. <elocation-id>hal-03017566v1</elocation-id></mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Belytschko</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>W. K.</given-names></string-name>, <string-name><surname>Moran</surname>, <given-names>B.</given-names></string-name>, &amp; <string-name><surname>Elkhodary</surname>, <given-names>K.</given-names></string-name></person-group> (<year>2000</year>). <source>Nonlinear Finite Elements for Continua and Structures</source>. <publisher-name>Wiley</publisher-name>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brilot</surname>, <given-names>A. F.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>J. Z.</given-names></string-name>, <string-name><surname>Cheng</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Pan</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Harrison</surname>, <given-names>S. C.</given-names></string-name>, <string-name><surname>Potter</surname>, <given-names>C. S.</given-names></string-name>, <string-name><surname>Carragher</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Henderson</surname>, <given-names>R.</given-names></string-name>, &amp; <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2012</year>). <article-title>Beam-induced motion of vitrified specimen on holey carbon film</article-title>. <source>Journal of Structural Biology</source>, <volume>177</volume>(<issue>3</issue>), <fpage>630</fpage>–<lpage>637</lpage>. <pub-id pub-id-type="doi">10.1016/j.jsb.2012.02.003</pub-id></mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Campbell</surname>, <given-names>M. G.</given-names></string-name>, <string-name><surname>Cheng</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Brilot</surname>, <given-names>A. F.</given-names></string-name>, <string-name><surname>Moeller</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Lyumkis</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Veesler</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Pan</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Harrison</surname>, <given-names>S. C.</given-names></string-name>, <string-name><surname>Potter</surname>, <given-names>C. S.</given-names></string-name>, <string-name><surname>Carragher</surname>, <given-names>B.</given-names></string-name>, &amp; <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2012</year>). <article-title>Movies of iceembedded particles enhance resolution in electron cryo-microscopy</article-title>. <source>Structure</source>, <volume>20</volume>(<issue>11</issue>), <fpage>1823</fpage>–<lpage>1828</lpage>. <pub-id pub-id-type="doi">10.1016/j.str.2012.08.026</pub-id></mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>D’Imprima</surname>, <given-names>E.</given-names></string-name>, &amp; <string-name><surname>Kühlbrandt</surname>, <given-names>W.</given-names></string-name></person-group> (<year>2021</year>). <article-title>Current limitations to high-resolution structure determination by single-particle cryoEM</article-title>. <source>Quarterly Reviews of Biophysics</source>, <volume>54</volume>, <fpage>e4</fpage>. <pub-id pub-id-type="doi">10.1017/S0033583521000020</pub-id></mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elferich</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Kaminek</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Kong</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Odriozola</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Kukulski</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Zuber</surname>, <given-names>B.</given-names></string-name>, &amp; <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2025</year>). <article-title>In situ high-resolution cryo-EM reconstructions from CEMOVIS</article-title>. <source>IUCrJ</source>, <volume>12</volume>(<issue>4</issue>), <fpage>502</fpage>–<lpage>510</lpage>. <pub-id pub-id-type="doi">10.1107/S2052252525005196</pub-id></mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elferich</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Kong</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Zottig</surname>, <given-names>X.</given-names></string-name>, &amp; <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2024</year>). <article-title>CTFFIND5 provides improved insight into quality, tilt, and thickness of TEM samples</article-title>. <source>eLife</source>, <volume>13</volume>, <elocation-id>RP97227</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.97227</pub-id></mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elferich</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Schiroli</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Scadden</surname>, <given-names>D. T.</given-names></string-name>, &amp; <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2022</year>). <article-title>Defocus Corrected Large Area Cryo-EM (DeCo-LACE) for label-free detection of molecules across entire cell sections</article-title>. <source>eLife</source>, <volume>11</volume>, <elocation-id>e80980</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.80980</pub-id></mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Farin</surname>, <given-names>G. E.</given-names></string-name></person-group> (<year>2001</year>). <source>Curves and surfaces for CAGD: A practical guide</source> (<edition>5th</edition> ed). <publisher-name>Morgan Kaufmann</publisher-name>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grant</surname>, <given-names>T.</given-names></string-name>, &amp; <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2015</year>). <article-title>Measuring the optimal exposure for single particle cryo-EM using a 2.6 Å reconstruction of rotavirus VP6</article-title>. <source>eLife</source>, <volume>4</volume>, <elocation-id>e06980</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.06980</pub-id></mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grant</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Rohou</surname>, <given-names>A.</given-names></string-name>, &amp; <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2018</year>). <article-title>cisTEM, user-friendly software for single-particle image processing</article-title>. <source>eLife</source>, <volume>7</volume>, <elocation-id>e35383</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.35383</pub-id></mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Hill</surname>, <given-names>R.</given-names></string-name></person-group> (<year>1950</year>). <source>Mathematical Theory of Plasticity</source>. <publisher-name>Oxford University Press</publisher-name>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Himes</surname>, <given-names>B.</given-names></string-name>, &amp; <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2021</year>). <article-title>Cryo-TEM simulations of amorphous radiation-sensitive samples using multislice wave propagation</article-title>. <source>IUCrJ</source>, <volume>8</volume>(<issue>6</issue>), <fpage>943</fpage>–<lpage>953</lpage>. <pub-id pub-id-type="doi">10.1107/S2052252521008538</pub-id></mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Mooney</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Zheng</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Booth</surname>, <given-names>C. R.</given-names></string-name>, <string-name><surname>Braunfeld</surname>, <given-names>M. B.</given-names></string-name>, <string-name><surname>Gubbens</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Agard</surname>, <given-names>D. A.</given-names></string-name>, &amp; <string-name><surname>Cheng</surname>, <given-names>Y.</given-names></string-name></person-group> (<year>2013</year>). <article-title>Electron counting and beam-induced motion correction enable nearatomic-resolution single-particle cryo-EM</article-title>. <source>Nature Methods</source>, <volume>10</volume>(<issue>6</issue>), <fpage>584</fpage>–<lpage>590</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.2472</pub-id></mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lucas</surname>, <given-names>B. A.</given-names></string-name>, <string-name><surname>Himes</surname>, <given-names>B. A.</given-names></string-name>, <string-name><surname>Xue</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Grant</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Mahamid</surname>, <given-names>J.</given-names></string-name>, &amp; <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2021</year>). <article-title>Locating macromolecular assemblies in cells by 2D template matching with cisTEM</article-title>. <source>eLife</source>, <volume>10</volume>, <elocation-id>e68946</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.68946</pub-id></mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lucas</surname>, <given-names>B. A.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Loerch</surname>, <given-names>S.</given-names></string-name>, &amp; <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name></person-group> (<year>2022</year>). <article-title>In situ single particle classification reveals distinct 60S maturation intermediates in cells</article-title>. <source>eLife</source>, <volume>11</volume>, <elocation-id>e79272</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.79272</pub-id></mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Malvern</surname>, <given-names>L. E.</given-names></string-name></person-group> (<year>1969</year>). <source>Introduction to the Mechanics of a Continuous Medium</source>. <publisher-name>Prentice-Hall</publisher-name>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mastronarde</surname>, <given-names>D. N.</given-names></string-name></person-group> (<year>2005</year>). <article-title>Automated electron microscope tomography using robust prediction of specimen movements</article-title>. <source>Journal of Structural Biology</source>, <volume>152</volume>(<issue>1</issue>), <fpage>36</fpage>–<lpage>51</lpage>. <pub-id pub-id-type="doi">10.1016/j.jsb.2005.07.007</pub-id></mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Naydenova</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Jia</surname>, <given-names>P.</given-names></string-name>, &amp; <string-name><surname>Russo</surname>, <given-names>C. J.</given-names></string-name></person-group> (<year>2020</year>). <article-title>Cryo-EM with sub–1 Å specimen movement</article-title>. <source>Science</source>, <volume>370</volume>(<issue>6513</issue>), <fpage>223</fpage>–<lpage>226</lpage>. <pub-id pub-id-type="doi">10.1126/science.abb7927</pub-id></mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oldham</surname>, <given-names>M. L.</given-names></string-name>, <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name>, &amp; <string-name><surname>Chen</surname>, <given-names>J.</given-names></string-name></person-group> (<year>2016</year>). <article-title>Structure of the transporter associated with antigen processing trapped by herpes simplex virus</article-title>. <source>eLife</source>, <volume>5</volume>, <elocation-id>e21829</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.21829</pub-id></mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Reilly</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Xue</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Graziadei</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Sinn</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lenz</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Tegunov</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Blötz</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Singh</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Hagen</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Cramer</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Stülke</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Mahamid</surname>, <given-names>J.</given-names></string-name>, &amp; <string-name><surname>Rappsilber</surname>, <given-names>J.</given-names></string-name></person-group> (<year>2020</year>). <article-title>In-cell architecture of an actively transcribing-translating expressome</article-title>. <source>Science</source>, <volume>369</volume>(<issue>6503</issue>), <fpage>554</fpage>–<lpage>557</lpage>. <pub-id pub-id-type="doi">10.1126/science.abb3758</pub-id></mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Punjani</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Rubinstein</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Fleet</surname>, <given-names>D. J.</given-names></string-name>, &amp; <string-name><surname>Brubaker</surname>, <given-names>M. A.</given-names></string-name></person-group> (<year>2017</year>). <article-title>cryoSPARC: Algorithms for rapid unsupervised cryo-EM structure determination</article-title>. <source>Nature Methods</source>, <volume>14</volume>(<issue>3</issue>), <fpage>290</fpage>–<lpage>296</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4169</pub-id></mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rickgauer</surname>, <given-names>J. P.</given-names></string-name>, <string-name><surname>Grigorieff</surname>, <given-names>N.</given-names></string-name>, &amp; <string-name><surname>Denk</surname>, <given-names>W.</given-names></string-name></person-group> (<year>2017</year>). <article-title>Single-protein detection in crowded molecular environments in cryo-EM images</article-title>. <source>eLife</source>, <volume>6</volume>, <elocation-id>e25648</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.25648</pub-id></mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rubinstein</surname>, <given-names>J. L.</given-names></string-name>, &amp; <string-name><surname>Brubaker</surname>, <given-names>M. A.</given-names></string-name></person-group> (<year>2015</year>). <article-title>Alignment of cryo-EM movies of individual particles by optimization of image translations</article-title>. <source>Journal of Structural Biology</source>, <volume>192</volume>(<issue>2</issue>), <fpage>188</fpage>–<lpage>195</lpage>. <pub-id pub-id-type="doi">10.1016/j.jsb.2015.08.007</pub-id></mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Salgado</surname>, <given-names>E. N.</given-names></string-name>, <string-name><surname>Garcia Rodriguez</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Narayanaswamy</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Krishnan</surname>, <given-names>Y.</given-names></string-name>, &amp; <string-name><surname>Harrison</surname>, <given-names>S. C.</given-names></string-name></person-group> (<year>2018</year>). <article-title>Visualization of Calcium Ion Loss from Rotavirus during Cell Entry</article-title>. <source>Journal of Virology</source>, <volume>92</volume>(<issue>24</issue>), <fpage>e01327</fpage>–<lpage>18</lpage>. <pub-id pub-id-type="doi">10.1128/JVI.01327-18</pub-id></mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Scheres</surname>, <given-names>S. H.</given-names></string-name></person-group> (<year>2014</year>). <article-title>Beam-induced motion correction for sub-megadalton cryo-EM particles</article-title>. <source>eLife</source>, <volume>3</volume>, <elocation-id>e03665</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.03665</pub-id></mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sigworth</surname>, <given-names>F.</given-names></string-name></person-group> (<year>2004</year>). <article-title>Classical detection theory and the cryo-EM particle selection problem</article-title>. <source>Journal of Structural Biology</source>, <volume>145</volume>(<issue>1–2</issue>), <fpage>111</fpage>–<lpage>122</lpage>. <pub-id pub-id-type="doi">10.1016/j.jsb.2003.10.025</pub-id></mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Střelák</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Filipovič</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Jiménez-Moreno</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Carazo</surname>, <given-names>J.</given-names></string-name>, &amp; <string-name><surname>Sánchez Sorzano</surname>, <given-names>C.</given-names></string-name></person-group> (<year>2020</year>). <article-title>FlexAlign: An Accurate and Fast Algorithm for Movie Alignment in Cryo-Electron Microscopy</article-title>. <source>Electronics</source>, <volume>9</volume>(<issue>6</issue>), <fpage>1040</fpage>. <pub-id pub-id-type="doi">10.3390/electronics9061040</pub-id></mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="data"><person-group person-group-type="author"><string-name><surname>Subramaniam</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Bartesaghi</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Banerjee</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Zhu</surname>, <given-names>X.</given-names></string-name>, &amp; <string-name><surname>Milne</surname>, <given-names>J. L. S.</given-names></string-name></person-group> (<year>2018</year>). <article-title>Atomic resolution cryo-EM structure of beta-galactosidase</article-title>. <source>Worldwide Protein Data Bank</source> <pub-id pub-id-type="doi">10.2210/pdb6cvm/pdb</pub-id></mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tegunov</surname>, <given-names>D.</given-names></string-name>, &amp; <string-name><surname>Cramer</surname>, <given-names>P.</given-names></string-name></person-group> (<year>2019</year>). <article-title>Real-time cryo-electron microscopy data preprocessing with Warp</article-title>. <source>Nature Methods</source>, <volume>16</volume>(<issue>11</issue>), <fpage>1146</fpage>–<lpage>1152</lpage>. <pub-id pub-id-type="doi">10.1038/s41592-019-0580-y</pub-id></mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zheng</surname>, <given-names>S. Q.</given-names></string-name>, <string-name><surname>Palovcak</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Armache</surname>, <given-names>J.-P.</given-names></string-name>, <string-name><surname>Verba</surname>, <given-names>K. A.</given-names></string-name>, <string-name><surname>Cheng</surname>, <given-names>Y.</given-names></string-name>, &amp; <string-name><surname>Agard</surname>, <given-names>D. A.</given-names></string-name></person-group> (<year>2017</year>). <article-title>MotionCor2: Anisotropic correction of beam-induced motion for improved cryo-electron microscopy</article-title>. <source>Nature Methods</source>, <volume>14</volume>(<issue>4</issue>), <fpage>331</fpage>–<lpage>332</lpage>. <pub-id pub-id-type="doi">10.1038/nmeth.4193</pub-id></mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zivanov</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Nakane</surname>, <given-names>T.</given-names></string-name>, &amp; <string-name><surname>Scheres</surname>, <given-names>S. H. W.</given-names></string-name></person-group> (<year>2019</year>). <article-title>A Bayesian approach to beam-induced motion correction in cryo-EM single-particle analysis</article-title>. <source>IUCrJ</source>, <volume>6</volume>(<issue>1</issue>), <fpage>5</fpage>–<lpage>17</lpage>. <pub-id pub-id-type="doi">10.1107/S205225251801463X</pub-id></mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.109119.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Scheres</surname>
<given-names>Sjors HW</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/00tw3jy02</institution-id><institution>MRC Laboratory of Molecular Biology</institution>
</institution-wrap>
<city>Cambridge</city>
<country>United Kingdom</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This paper describes Unbend - a new method for measuring and correcting motions in cryo-EM images, with a particular emphasis on more challenging in situ samples such as lamella and whole cells. The method, which fits a B-spline model using cross-correlation-based local patch alignment of micrograph frames, represents a <bold>valuable</bold> tool for the cryo-EM community. The authors elegantly use 2D template matching to provide <bold>solid</bold> evidence that Unbend outperforms the previously reported method of Unblur by the same authors. The paper would benefit from the inclusion of a similar analysis for established alternative methods, such as MotionCor2.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.109119.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Kong et al.'s work describes a new approach that does exactly what the title states: &quot;Correction of local beam-induced sample motion in cryo-EM images using a 3D spline model.&quot; I find the method appropriate, logical, and well-explained. Additionally, the work suggests using 2DTM-related measurements to quantify the improvement of the new method compared to the old one in cisTEM, Unblur. I find this part engaging; it is straightforward, accurate, and, of course, the group has a strong command of 2DTM, presenting a thorough study.</p>
<p>However, everything in the paper (except some correct general references) refers to comparisons with the full-frame approach, Unblur. Still, we have known for more than a decade that local correction approaches perform better than global ones, so I do not find anything truly novel in their proposal of using local methods (the method itself- Unbend- is new, but many others have been described previously). In fact, the use of 2DTM is perhaps a more interesting novelty of the work, and here, a more systematic study comparing different methods with these proposed well-defined metrics would be very valuable. As currently presented, there is no doubt that it is better than an older, well-established approach, and the way to measure &quot;better&quot; is very interesting, but there is no indication of how the situation stands regarding newer methods.</p>
<p>Regarding practical aspects, it seems that the current implementation of the method is significantly slower than other patch-based approaches. If its results are shown to exceed those of existing local methods, then exploring the use of Unbend, possibly optimizing its code first, could be a valuable task. However, without more recent comparisons, the impact of Unbend remains unclear.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.109119.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors present a new method, Unbend, for measuring motion in cryo-EM images, with a particular emphasis on more challenging in situ samples such as lamella and whole cells</p>
<p>
(that can be more prone to overall motion and/or variability in motion across a field of view). Building on their previous approach of full-frame alignment (Unblur), they now perform full-frame alignment followed by patch alignment, and then use these outputs to generate a 3D cubic spline model of the motion. This model allows them to estimate a continuous, per-pixel shift field for each movie frame that aims to better describe complex motions and so ultimately generate improved motion-corrected micrographs. Performance of Unbend is evaluated using the 2D template matching (2DTM) method developed previously by the lab, and results are compared to using full-frame correction alone. Several different in situ samples are used for evaluation, covering a broad range that will be of interest to the rapidly growing in situ cryo-EM community.</p>
<p>Strengths:</p>
<p>The method appears to be an elegant way of describing complex motions in cryo-EM samples, and the authors present convincing data that Unbend generally improves SNR of aligned micrographs as well as increases detection of particles matching the 60S ribosome template when compared to using full-frame correction alone. The authors also give interesting insights into how different areas of a lamella behave with respect to motion by using Unbend on a montage dataset collected previously by the group. There is growing interest in imaging larger areas of in situ samples at high resolution, and these insights contribute valuable knowledge. Additionally, the availability of data collected in this study through the EMPIAR repository will be much appreciated by the field.</p>
<p>Weaknesses:</p>
<p>While the improvements with Unbend vs. Unblur appear clear, it is less obvious whether Unbend provides substantial gains over patch motion correction alone (the current norm in the field). It might be helpful for readers if this comparison were investigated for the in situ datasets. Additionally, the authors are open that in cases where full motion correction already does a good job, the extra degrees of freedom in Unbend can perhaps overfit the motions, making the corrections ultimately worse. I wonder if an adaptive approach could be explored, for example, using the readout from full-frame or patch correction to decide whether a movie should proceed to the full Unbend pipeline, or whether correction should stop at the patch estimation stage.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.109119.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary</p>
<p>Kong and coauthors describe and implement a method to correct local deformations due to beam-induced motion in cryo-EM movie frames. This is done by fitting a 3D spline model to a stack of micrograph frames using cross-correlation-based local patch alignment to describe the deformations across the micrograph in each frame, and then computing the value of the deformed micrograph at each pixel by interpolating the undeformed micrograph at the displacement positions given by the spline model. A graphical interface in cisTEM allows the user to visualise the deformations in the sample, and the method has been proven to be successful by showing improvements in 2D template matching (2DTM) results on the corrected micrographs using five in situ samples.</p>
<p>Impact</p>
<p>This method has great potential to further streamline the cryo-EM single particle analysis pipeline by shortening the required processing time as a result of obtaining higher quality particles early in the pipeline, and is applicable to both old and new datasets, therefore being relevant to all cryo-EM users.</p>
<p>Strengths</p>
<p>(1) One key idea of the paper is that local beam induced motion affects frames continuously in space (in the image plane) as well as in time (along the frame stack), so one can obtain improvements in the image quality by correcting such deformations in a continuous way (deformations vary continuously from pixel to pixel and from frame to frame) rather than based on local discrete patches only. 3D splines are used to model the deformations: they are initialised using local patch alignments and further refined using cross-correlation between individual patch frames and the average of the other frames in the same patch stack.</p>
<p>(2) Another strength of the paper is using 2DTM to show that correcting such deformations continuously using the proposed method does indeed lead to improvements. This is shown using five in situ datasets, where local motion is quantified using statistics based on the estimated motions of ribosomes.</p>
<p>Weaknesses</p>
<p>(1) While very interesting, it is not clear how the proposed method using 3D splines for estimating local deformations compares with other existing methods that also aim to correct local beam-induced motion by approximating the deformations throughout the frames using other types of approximation, such as polynomials, as done, for example MotionCor2.</p>
<p>(2) The use of 2DTM is appropriate, and the results of the analysis are enlightening, but one shortcoming is that some relevant technical details are missing. For example, the 2DTM SNR is not defined in the article, and it is not clear how the authors ensured that no false positives were included in the particles counted before and after deformation correction. The Jupyter notebooks where this analysis was performed have not been made publicly available.</p>
<p>(3) It is also not clear how the proposed deformation correction method is affected by CTF defocus in the different samples (are the defocus values used in the different datasets similar or significantly different?) or if there is any effect at all.</p>
</body>
</sub-article>
</article>