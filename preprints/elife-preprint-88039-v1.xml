<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">88039</article-id>
<article-id pub-id-type="doi">10.7554/eLife.88039</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.88039.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Genetics and Genomics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>The Impact of Stability Considerations on Genetic Fine-Mapping</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Aw</surname>
<given-names>Alan</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Jin</surname>
<given-names>Lionel Chentian</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Ioannidis</surname>
<given-names>Nilah</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0734-9868</contrib-id>
<name>
<surname>Song</surname>
<given-names>Yun S.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Statistics, University of California</institution>, Berkeley</aff>
<aff id="a2"><label>2</label><institution>Center for Computational Biology, University of California</institution>, Berkeley</aff>
<aff id="a3"><label>3</label><institution>McKinsey &amp; Company</institution>, Seattle</aff>
<aff id="a4"><label>4</label><institution>Computer Science Division, University of California</institution>, Berkeley</aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Young</surname>
<given-names>Alexander</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of California, Los Angeles</institution>
</institution-wrap>
<city>Los Angeles</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Weigel</surname>
<given-names>Detlef</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Biology Tübingen</institution>
</institution-wrap>
<city>Tübingen</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>To whom correspondence should be addressed: <email>nilah@berkeley.edu</email>, <email>yss@berkeley.edu</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-07-18">
<day>18</day>
<month>07</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP88039</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-04-11">
<day>11</day>
<month>04</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-04-13">
<day>13</day>
<month>04</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.04.11.536456"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Aw et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Aw et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-88039-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Fine-mapping methods, which aim to identify genetic variants responsible for complex traits following genetic association studies, typically assume that sufficient adjustments for confounding within the association study cohort have been made, e.g., through regressing out the top principal components (i.e., residualization). Despite its widespread use, however, residualization may not completely remove all sources of confounding. Here, we propose a complementary stability-guided approach that does not rely on residualization, which identifies consistently fine-mapped variants across different genetic backgrounds or environments. We demonstrate the utility of this approach by applying it to fine-map eQTLs in the GEUVADIS data. Using 378 different functional annotations of the human genome, including recent deep learning-based annotations (e.g., Enformer), we compare enrichments of these annotations among variants for which the stability and traditional residualization-based fine-mapping approaches agree against those for which they disagree, and find that the stability approach enhances the power of traditional fine-mapping methods in identifying variants with functional impact. Finally, in cases where the two approaches report distinct variants, our approach identifies variants comparably enriched for functional annotations. Our findings suggest that the stability principle, as a conceptually simple device, complements existing approaches to fine-mapping, reinforcing recent advocacy of evaluating cross-population and cross-environment portability of biological findings. To support visualization and interpretation of our results, we provide a Shiny app, available at: <ext-link ext-link-type="uri" xlink:href="https://alan-aw.shinyapps.io/stability_v0/">https://alan-aw.shinyapps.io/stability_v0/</ext-link>.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
</notes>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>An important challenge faced by computational precision health research is the lack of generalizability of biological findings, which are often obtained by studying cohorts that do not include particular communities of individuals. Known as the <italic>cross-population generalizability</italic> or <italic>portability problem</italic>, the challenge persists in multiple settings, including gene expression prediction (<xref ref-type="bibr" rid="c19">Keys et al. 2020</xref>) and polygenic risk score prediction (<xref ref-type="bibr" rid="c29">Mostafavi et al. 2020</xref>). Generalizable biological signals, such as the functional impact of a variant, are important, as they ensure that general conclusions drawn from cohort-specific analyses are not based on spurious discoveries. Portability problems are potentially attributable to cohort-biased discoveries being treated as generalizable true signals. Efforts to address such problems have included the use of diverse cohorts typically representing multiple population ancestries (<xref ref-type="bibr" rid="c26">Márquez-Luna et al. 2017</xref>), meta-analyses of earlier studies across diverse cohorts (<xref ref-type="bibr" rid="c36">Turley et al. 2021</xref>; <xref ref-type="bibr" rid="c16">Han and Eskin 2012</xref>; <xref ref-type="bibr" rid="c28">Morris 2011</xref>; <xref ref-type="bibr" rid="c39">Willer et al. 2010</xref>), or focusing on biological markers that are more likely <italic>a priori</italic> to play a causal role, e.g., rare variants (<xref ref-type="bibr" rid="c41">Zaidi and Mathieson 2020</xref>) or the transcriptome (<xref ref-type="bibr" rid="c23">Liang et al. 2022</xref>).</p>
<p>In this paper, we consider an approach based on the notion of <italic>stability</italic> to improve generalizability. Being a pillar of veridical data science (<xref ref-type="bibr" rid="c40">Yu and Kumbier 2020</xref>), stability refers to the robustness of statistical conclusions to <italic>perturbations</italic> of the data. Perturbations are not arbitrary, but instead they encode the practitioner’s beliefs about the quality of the data and the nature of relationship between variables. Well-chosen perturbation schemes will help the practitioner obtain statistical conclusions that are robust, in the sense that they are generalizable rather than spurious findings, and therefore more likely to capture the true signal. For example, in sparse linear models, prioritizing the stability of effect sizes to cross-validation “perturbations” leads to a much smaller set of selected features without reducing predictive performance (<xref ref-type="bibr" rid="c24">Lim and Yu 2016</xref>). In another example involving the application of random forests to detect higher-order interactions between gene regulation features (<xref ref-type="bibr" rid="c6">Basu et al. 2018</xref>), interactions stable to bootstrap perturbations are also largely consistent with known physical interactions between the associated transcription factor binding or enhancer sites.</p>
<p>To further investigate the utility of the stability approach, we focus on a procedure known as (genetic) fine-mapping (<xref ref-type="bibr" rid="c34">Schaid et al. 2018</xref>). Fine-mapping is the task of identifying genetic variants that causally affect some trait of interest. From the viewpoint of stability, previous works focusing on cross-population stability of fine-mapped variants typically use Bayesian linear models. The linear model has allowed modeling of heterogeneous effect sizes across different user-defined populations (e.g., ethnic groups, ancestrally distinct populations, or study cohorts), and it is common to assume that causal variants share correlated effects across populations (see, e.g., eq. (24) of <xref ref-type="bibr" rid="c20">LaPierre et al. 2021</xref> or eq. (9) of <xref ref-type="bibr" rid="c38">Wen et al. 2015</xref>).</p>
<p>Unlike the parametric approaches described above, we here apply a <italic>non-parametric</italic> fine-mapping method to GEUVADIS (<xref ref-type="bibr" rid="c21">Lappalainen et al. 2013</xref>), a database of gene expression traits measured across individuals of diverse genetic ancestries and from different geographical environments, whose accompanying genotypes are available through the 1000 Genomes Project (<xref ref-type="bibr" rid="c1">1000 Genomes Project Consortium et al. 2015</xref>). We apply fine-mapping through two approaches, one that is commonly used in practice and another that is guided by stability. We evaluate the agreement of fine-mapped variants between the two approaches, and then measure the functional significance of variants picked by both approaches using a much wider range of functional annotations than considered in previous studies. By performing various statistical tests on the functional annotations, we evaluate the advantages brought about by the incorporation of stability. Finally, to support visualization of results at both the single gene and genome-wide levels, we provide an interactive Shiny app which is available at: <ext-link ext-link-type="uri" xlink:href="https://alan-aw.shinyapps.io/stability_v0/">https://alan-aw.shinyapps.io/stability_v0/</ext-link>. Our app is open-source and designed to support geneticists in interpreting our results, thereby also addressing a growing demand for accessible, <italic>integrative</italic> software to interpret genetic findings in the age of big data and variant annotation databases.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Results</title>
<sec id="s2a">
<label>2.1</label>
<title>Experimental Design</title>
<p>We apply the fine-mapping method PICS (<xref ref-type="bibr" rid="c35">Taylor et al. 2021</xref>; <xref ref-type="bibr" rid="c13">Farh et al. 2015</xref>; see <xref ref-type="fig" rid="alg1">Algorithm 1</xref> in <xref ref-type="sec" rid="s4a">Subsection 4.1</xref>) to the GEUVADIS data (<xref ref-type="bibr" rid="c21">Lappalainen et al. 2013</xref>), which consists of <italic>T</italic> = 22, 720 gene expression traits measured across <italic>N</italic> = 445 individuals, with their accompanying genotypes obtained from the 1000 Genomes Project (<xref ref-type="bibr" rid="c1">1000 Genomes Project Consortium et al. 2015</xref>). These individuals are of either European or African ancestry, with about four fifths of the cohort made up of individuals of (self-identified) European descent. In particular, these ancestrally different subpopulations have distinct linkage disequilibrium patterns and environmental exposures, which constitute potential confounders that we wish to stabilize the fine-mapping procedure against.</p>
<p>PICS, like many eQTL analysis methods, requires the lead variant at a locus to compute posterior probabilities, so we perform marginal regressions of each gene expression trait against variants within the fine-mapping locus. Our implementation of PICS generates three sets of variants, which represent putatively causal variants that are (marginally) highly associated, moderately associated and weakly associated with the gene expression phenotype. (See <xref ref-type="sec" rid="s4">Section 4</xref>, Materials and Methods for details.) We compare two versions of the fine-mapping procedure — one that is typically performed in practice, and another that is motivated by the stability approach. See <xref ref-type="fig" rid="fig1">Figure 1A</xref>.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><p>An overview of our study of the impact of stability considerations on genetic fine-mapping. <bold>A.</bold> The two ways in which we perform fine-mapping, the first of which (colored in green) prioritizes the stability of variant discoveries to subpopulation perturbations. The data illustrates the case where there are two distinct environments, or subpopulations (denoted <italic>E</italic><sub>1</sub> and <italic>E</italic><sub>2</sub>), that split the observations. <bold>B.</bold> Key steps in our comparison of the stability-guided approach with the popular residualization approach.</p></caption>
<graphic xlink:href="536456v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s2a1">
<title>Stable variant</title>
<p>Specifically, to incorporate stability into fine-mapping and obtain what we call the <italic>stable variant</italic> or stable SNP, we encode into the algorithm our belief that for a gene expression trait, a causal variant would presumably act through the same mechanism regardless of the population from which they originate. Indeed, if a set of genetic variants were causal, the same algorithm should report it, if run on subsets of the data corresponding to heterogeneous populations. This belief is consistent with recent simulation studies showing that the inclusion of GWAS variants discovered in diverse populations both mitigates false discoveries driven by linkage disequilibrium differences (<xref ref-type="bibr" rid="c22">Li et al. 2022</xref>) and improves generalizability of polygenic score construction (<xref ref-type="bibr" rid="c9">Cavazos and Witte 2021</xref>). Hence, the stable variant is the variant with the highest probability of being causal, conditioned on being reported by PICS in the most number of subpopulations. <xref ref-type="sec" rid="s4b">Section 4.2</xref> provides a formal definition of the stable variant.</p>
</sec>
<sec id="s2a2">
<title>Top variant</title>
<p>The stability consideration we have described is closely related to a popular procedure known as correction for population structure, which residualizes the trait using measured confounders (e.g., top principal components computed from the genotype matrix). We call the variant returned by the residualization approach the <italic>top variant</italic> or top SNP. The residualization approach removes the effects of genetic ancestry and environental exposures on a trait, and is used to avoid the risk of low statistical power borne by stratified analyses. The top variant is formally defined towards the end of <xref ref-type="sec" rid="s4a">Section 4.1</xref>. We remark that the top variant is a function of the residualized trait, as opposed to the stable variant, which is a function of the unresidualized trait (see <xref ref-type="fig" rid="fig1">Figure 1A</xref>).</p>
</sec>
<sec id="s2a3">
<title>Comparison</title>
<p>We compare the results obtained by using each approach, across a range of categories of functional annotations including conservation, pathogenicity, chromatin accessibility, transcription factor binding and histone modification, and across biological assays and computational predictions. See <xref ref-type="table" rid="tbl1">Table 1</xref> for full list of annotations covered. (Supplementary Material <xref ref-type="sec" rid="s5b">Section S2</xref> contains a full description of each quantity and its interpretation.)</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>A list of 378 functional annotations across which the biological significances of stable and top fine-mapped single nucleotide polymorphisms are compared. Annotations that report multiple scores have the total number of scores reported shown in parentheses. Scores mined from the FAVOR database (<xref ref-type="bibr" rid="c42">Zhou et al. 2022</xref>) are indicated by an asterisk. (<italic>TSS</italic> = Transcription Start Site, <italic>b<sub>p</sub></italic> = base pair)</p></caption>
<graphic xlink:href="536456v1_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p><xref ref-type="fig" rid="fig1">Figure 1B</xref> summarizes the key steps of our investigation. To be clear, a first comparison is between the set of genes for which the top and stable variants match and the set of genes for which the top and stable variants disagree; comparisons are made between matching variants and one of the non-matching sets of variants (top or stable). A second comparison is restricted to the set of genes with non-matching top and stable variants, i.e., between <italic>paired</italic> sets of variants fine-mapped to a gene, where one set of a pair corresponds to the output of the residualization approach whereas the other corresponds to the output of the stability-guided approach. We additionally compare across three fine-mapping output sets, corresponding to variants that have a high, moderate or weak marginal association with the expression phenotype. For brevity, we term these three sets Potential Set 1, Potential Set 2 and Potential Set 3, respectively. (See <xref ref-type="fig" rid="alg1">Algorithm 1</xref> for details.) For each Potential Set, we find the top and stable variants as described in <xref ref-type="sec" rid="s4b">Section 4.2</xref>.</p>
</sec>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Stability-guided variants frequently do not match residualization variants</title>
<p>As a preliminary analysis, when interrogating if the residualization and stability-guided approaches produce the same candidate causal variants, we find that for Potential Set 1, which corresponds to the set typically reported in fine-mapping studies, 56.2% of genes had matching top and stable variants (see <xref ref-type="fig" rid="fig2">Figure 2</xref>). Moving down potential sets, we find less agreement (Potential Set 2: 36.2%, Potential Set 3: 25.6%), providing evidence that as the marginal association of a variant with the expression phenotype decreases, the two approaches prioritize different signals when searching for putatively causal variants.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><p>Venn diagram showing the number of matching and non-matching variants for Potential Set 1.</p></caption>
<graphic xlink:href="536456v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For the rest of this Section, we report only results for Potential Set 1, given that it corresponds to the set typically reported in fine-mapping. Results for the other potential sets are provided in Supplementary Material <xref ref-type="sec" rid="s5d">Sections S4</xref> and <xref ref-type="sec" rid="s5e">S5</xref>.</p>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Matching versus Non-Matching Variants</title>
<p>For each gene, our algorithm finds the top eQTL variant and the stable eQTL variant, which may not coincide. We thus run (one-sided) unpaired Wilcoxon tests on matching and non-matching sets of variants, to detect significant functional enrichment of one set of variants over the other. We find that the top variants that are also stable for the corresponding gene (<italic>N</italic><sub>match</sub> = 12, 743 maximum annotatable) score significantly higher in functional annotations than the top variants that are not stable (<italic>N</italic><sub>non-match</sub> = 9, 921 maximum annotatable). Notably, 361 out of 378 functional annotations report one-sided greater <italic>p</italic>-values &lt; 0.05 for the matching (i.e., both top and stable) variants after correcting for multiple testing using the Benjamini-Hochberg (BH) procedure, with many of these annotations measuring magnitudes of functional impact or functional enrichment (e.g., Enformer perturbation scores, FATHMM.XF score). Amongst the 17 remaining functional annotations, none has significantly lower scores for the matching variants. (Supplementary Material <xref ref-type="sec" rid="s5d">Section S4</xref> lists these functional annotations in detail.) We also find that empirically, the matching variants tend to have greater agreement in posterior probabilities than non-matching variants (<xref ref-type="fig" rid="figS1">Supplementary Figures S1</xref> and <xref ref-type="fig" rid="figS2">S2</xref>).</p>
<p>As an example of a significant functional annotation, consider raw CADD scores (<xref ref-type="bibr" rid="c32">Rentzsch et al. 2019</xref>) — a higher value of which indicates a greater likelihood of deleterious effects. Out of the 22, 559 genes for which both the top and the stable variant are annotatable, looking at the distribution of top variant scores, the one corresponding to the 12, 685 genes with matching top and stable variants stochastically dominates the one corresponding to the remaining 9, 874 genes (<xref ref-type="fig" rid="fig3">Figure 3A</xref>). This relationship is more pronounced when we inspect PHRED-scaled CADD scores, where we apply a sliding cutoff threshold for calling variant deleteriousness (i.e., potential pathogenicity — see <xref ref-type="bibr" rid="c32">Rentzsch et al. 2019</xref>). We find that a greater proportion of matching variants than of either non-matching variant is classified as deleterious under the typical range of deleteriousness cutoffs (<xref ref-type="fig" rid="fig3">Figure 3B</xref>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><p><italic>Top Row</italic>. CADD scores. <bold>A.</bold> Empirical cumulative distribution functions of raw CADD scores of matching and non-matching variants across all genes, for Potential Set 1. Non-matching variants are further divided into stable and top variants, with a score lower threshold of 1.0 and upper threshold of 5.0 used to improve visualization. <bold>B.</bold> For a deleteriousness cutoff, the percent of (i) all matching variants, (ii) all nonmatching top variants, and (iii) all non-matching stable variants, which are classified as deleterious. We use a sliding cutoff threshold ranging from 10 to 20 as recommended by CADD authors. <italic>Bottom Row</italic>. Empirical cumulative distribution functions of perturbation scores of Enformer-predicted H3K27me3 ChIP-seq track. Score upper threshold of 0.015 and empirical CDF lower threshold of 0.5 used to improve visualization. <bold>C.</bold> Perturbation scores computed from predictions based on centering input sequences on the gene TSS as well as its two flanking positions. <bold>D.</bold> Perturbation scores computed from predictions based on centering input sequences on the gene TSS only.</p></caption>
<graphic xlink:href="536456v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Another example demonstrating significant functional enrichment of matching variants over non-matching variants is the perturbation scores on H3K9me3 ChIP-seq peaks, as predicted by the Enformer (<xref ref-type="bibr" rid="c4">Avsec et al. 2021</xref>). Out of the 6, 364 genes for which the distance of both the top and the stable variant to the TSS are within the Enformer input sequence length constraint, looking at the the distribution of top variant scores, the one corresponding to the 4, 491 genes with matching top and stable variants stochastically dominates the one corresponding to the remaining 1, 873 genes (<xref ref-type="fig" rid="fig3">Figure 3C,D</xref>). This relationship is true regardless of whether perturbation scores are calculated from an average of input sequences centered on the gene TSS and its two flanking positions (<xref ref-type="fig" rid="fig3">Figure 3C</xref>), or from input sequences centered on the gene TSS only (<xref ref-type="fig" rid="fig3">Figure 3D</xref>). (See Supplementary Material <xref ref-type="sec" rid="s5c">Section S3</xref> for details on Enformer annotation calculation.)</p>
<p>Similarly, amongst all stable variants, those variants that match the top variant are significantly more enriched in functional annotations: 363 functional annotations report one-sided greater BH-adjusted <italic>p</italic>-values &lt; 0.05 for the matching variants, and none of the remaining 15 annotations present significant depletion for the matching variants set.</p>
</sec>
<sec id="s2d">
<label>2.4</label>
<title>Top versus Stable variants when they do not match</title>
<p>Focusing on the genes for which the top and stable variants are different, we run (one-sided) paired Wilcoxon tests to detect significant functional enrichment of one set of variants over the other. We find in general that for some genes stable variants can carry more functional impact than top variants, and for other genes top variants carry more functional impact — although neither of these patterns is statistically significant genome-wide after multiple testing correction using the BH procedure. For example, for raw CADD scores, out of the 9, 874 genes for which the top and the stable variants do not match, 4, 906 genes have higher scoring stable variants than top variants, whereas 4, 968 genes have higher scoring top variants than stable variants (<xref ref-type="fig" rid="fig4">Figure 4A</xref>). Looking at the accompanying PHRED-scaled CADD scores (CADD PHRED) for Potential Set 1, when applying a sliding cutoff threshold for calling variant deleteriousness, we find that even though a higher fraction of genes have top but not stable variant classified as deleterious, the difference is usually not significant (<xref ref-type="fig" rid="fig4">Figure 4B</xref>). <xref ref-type="fig" rid="fig4">Figure 4B</xref> also demonstrates that no matter how the cutoff is chosen, there are genes for which the top variant is not classified deleterious while the stable variant is. Taken together, these observations suggest that the stability-guided approach can sometimes be more useful at identifying variants of functional significance, and in a broad sense both fine-mapped variants should be equally prioritized for potential of carrying functional impact.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><p><bold>A.</bold> Paired scatterplot of raw CADD scores of both top and stable variant for each gene, for Potential Set 1. <bold>B.</bold> Percent of genes that are classified as (i) having deleterious top variant only, (ii) having deleterious stable variant only, and (iii) having both top and stable variant deleterious, using a sliding cutoff threshold ranging from 10 to 20 as recommended by CADD authors.</p></caption>
<graphic xlink:href="536456v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Because our comparison between the top and stable variants yielded no significant functional enrichment of one over the other, we investigate whether external factors — for example, the posterior probability of the variants — might moderate the relative enrichment of one variant over the other (i.e., we perform <italic>trend analysis —</italic> see <xref ref-type="sec" rid="s4c">Section 4.3</xref> for a list of all moderators). Here, we find that all but one of the moderators considered — namely, the Posterior Probability of Top Variant (see <xref ref-type="table" rid="tbl2">Table 2</xref>) — did not produce any significant trends for Potential Set 1. There is a small but significant positive correlation (Pearson’s <italic>r</italic> = 0.05) between the posterior probability of the top variant and the difference between the stable variant and top variant FIRE scores (<xref ref-type="bibr" rid="c18">Ioannidis et al. 2017</xref>), and a small but significant negative correlation (Pearson’s <italic>r</italic> = −0.07) between the posterior probability of the top variant and the difference between the stable variant and top variant Absolute Distance to Canonical TSS. (Details are reported in Supplementary Material <xref ref-type="sec" rid="s5e">Section S5</xref>.)</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><p>List of 6 moderating factors considered.</p></caption>
<graphic xlink:href="536456v1_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<sec id="s2d1">
<title>Additional comparisons</title>
<p>We perform various <italic>conditional analyses</italic> to evaluate whether additional restrictions to characteristics of fine-mapping outputs may boost the power of either approach over the other. Such characteristics include (i) the positive posterior probability support (i.e., how many variants reported a positive posterior probability from fine-mapping), and (ii) the posterior probability of the top or stable variant. Results from our conditional analysis of (i) are reported in Supplementary Material <xref ref-type="sec" rid="s5f">Section S6</xref>. As an example, for (ii) we further perform a comparison between top and stable variants, by restricting to genes where the posterior probability of the top variant or the stable variant exceeds 0.9. Such restriction of valid fine-mapped variant-gene pairs is useful in training variant effect prediction models requiring reliable positive and negative examples, as seen in <xref ref-type="bibr" rid="c37">Wang et al. (2021)</xref>. We find that for genes where the top variant posterior probability exceeds 0.9, there is no significant enrichment of the top variant over the stable variant across the 378 annotations considered (all BH-adjusted <italic>p</italic>-values exceed 0.05). Interestingly, when focusing on genes where the stable variant posterior probability exceeds 0.9, FIRE scores of the top variant are significantly larger than the stable variant (BH-adjusted <italic>p</italic>-value = 1 × 10<sup>-6</sup>). Detailed results are reported in Supplementary Material <xref ref-type="sec" rid="s5g">Section S7</xref>.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Discussion</title>
<p>Our present work has shown that a stability-guided approach complements existing approaches to detect biologically meaningful variants in genetic fine-mapping. Through various statistical comparisons, we have found that prioritizing the agreement between existing approaches and a stability-guided approach enhances the functional impact of the fine-mapped variant. Incorporating stability into fine-mapping also provides an adjuvant approach that helps discover variants of potential functional impact in case standard approaches fail to pick up variants of functional significance. Our findings are consistent with earlier reports of stable discoveries having the tendency to capture actual physical or mechanistic relationships, potentially making such discoveries generalizable or portable (<xref ref-type="bibr" rid="c6">Basu et al. 2018</xref>).</p>
<p>The link between stability and generalizability is not new. In the machine learning and statistics literature, it has been shown that stable algorithms provably lead to generalization errors that are well-controlled (<xref ref-type="bibr" rid="c7">Bousquet and Elisseeff 2002</xref>, Theorem 17, p. 510). Furthermore, in certain classes of algorithms (e.g., sparse regression), it has been demonstrated empirically that this mathematical relationship is explained precisely by the stable algorithm removing spurious discoveries (<xref ref-type="bibr" rid="c24">Lim and Yu 2016</xref>).</p>
<p>The stability-guided approach is also distinct from other subsampling approaches, such as the bootstrap (<xref ref-type="bibr" rid="c12">Efron and Tibshirani 1994</xref>). First, the bootstrap is more often deployed as a method for calibrating uncertainty surrounding a prediction, which is not the objective of our method. Next, in settings where the bootstrap is deployed as a type of perturbation against which a prediction or estimand is expected to be stable (<xref ref-type="bibr" rid="c6">Basu et al. 2018</xref>), a stability threshold is implicitly needed and would require tuning to be chosen (e.g., in <xref ref-type="bibr" rid="c6">Basu et al. 2018</xref> this threshold was chosen to be 50%). Here, we leverage interpretable existing external annotations to define the perturbation against which we expect the fine-mapped variant to be stable — in other words, the user relates what is meant by the fine-mapped variant being stable to a biologically meaningful concept like “portable across environmentally and LD pattern-wise heterogeneous populations.”</p>
<p>The last sentence in the preceding paragraph suggests there are teleological similarities between the stability-guided approach and meta-analysis approaches (<xref ref-type="bibr" rid="c36">Turley et al. 2021</xref>). We emphasize that meta-analyses rely on already analyzed cohorts, thereby implicitly assuming that <italic>within-cohort</italic> heterogeneities have been sufficiently accounted for prior to the reporting of findings for that cohort. The stability-guided approach, however, is relevant to the <italic>cohort-specific analysis itself</italic>, where existing approaches may present methodological insufficiencies resulting in inflated false discoveries. In other words, whereas the goal of meta-analysis may be stated as identifying consistent hits across cohorts while also assuming that findings specific to each cohort are reliable, the goal of a stability-guided approach is to search for consistent signals despite the presence of potential confounders within a single cohort. Our analysis has focused on comparing the stability-guided approach against residualization, a convenient and popular approach to account for population structure, which reflects this difference in purpose.</p>
<p>In investigating the impact of stability considerations on the fine-mapping algorithm, our analyses integrated multiple families of functional annotations. These include biological assays and tracks (Ensembl gene regulatory regions, percent GC, etc.), classical variant interpretation scores and statistics (CADD, FIRE, etc.), and modern deep learning-based annotations (Enformer). We further summarize our findings using open-source interactive software, enabling the broader biological community to interpret our results across 378 annotations and all genes, or at the single gene level. Altogether, our work not only provides pristine ways to synthesize new findings from the expanding suite of in-silico mutagenesis models with biological quantities reported from mathematical models in biology and classical statistical principles, but also presents the results in a format accessible to biologists seeking to benefit from computational insights.</p>
<p>Our present work is not without limitations. First, we have chosen to focus on a non-parametric approach to fine-mapping, but multiple parametric fine-mapping approaches have been extended to incorporate cross-population heterogeneity (e.g., <xref ref-type="bibr" rid="c38">Wen et al. 2015</xref>; <xref ref-type="bibr" rid="c20">LaPierre et al. 2021</xref>; <xref ref-type="bibr" rid="c25">Lu et al. 2022</xref>). While our present work is a proof-of-concept of the applicability of the stability to genetic fine-mapping, we believe that future work focusing on comparing functional impact of variants prioritized by our stability-driven approach or these parametric methods will shed more light on the efficacy of the stability principle at detecting generalizable biological signals. Second, our analysis implicitly assumes that there is exactly one cis-eQTL that is prioritized by PICS. It is possible to modify the algorithm to return multiple variants, but this would require a more theoretical investigation, so we defer such technical explorations to future work. Third, while we have relied on numerous computational and experimental annotations to evaluate the functional impact of our fine-mapped variants, there is a possibility that some of the computationally predicted variant annotations (e.g., CADD, Enformer, FIRE) are themselves biased owing to the lack of diversity of training data. Although recent work has evaluated the performance of these computational annotation tools on different tissues and cell types, to our knowledge, there are currently no benchmarks for evaluating the performance of computational annotations on diverse human cohorts. We believe such studies will be important for ensuring that our findings support the theory that stable variants carry generalizable biological signal.</p>
<p>In closing, while our work explores stability to subpopulation perturbations where subpopulations are defined by ancestry, we emphasize that our stability-guided slicing methodology is applicable to all settings where meaningful external labels are available to the data analyst. For instance, environmental or geographical variables, which are well-recognized determinants of some health outcomes (<xref ref-type="bibr" rid="c14">Favé et al. 2018</xref>; <xref ref-type="bibr" rid="c2">Abdellaoui et al. 2022</xref>) and arguably better measure potential confounders than ancestral population labels, can be the basis on which slices are defined in the stability-guided approach. As the barriers to access larger biobank-scale datasets, which contain such aforementioned variables, continue to be lowered, we expect stability-driven analyses conducted on such data and relying on carefully defined slices will help users better understand genetic drivers of complex traits. Given its utility in our present work, we believe that the stability approach in precision medicine may find uses beyond genetic fine-mapping and few other biological tasks previously studied, ultimately empowering the discovery of veridical effects not previously known.</p>
</sec>
<sec id="s4">
<label>4</label>
<title>Materials and Methods</title>
<p>We use publicly available GEUVADIS B-lymphocyte RNA-seq measurements from 445 individuals (<xref ref-type="bibr" rid="c21">Lappalainen et al. 2013</xref>), whose genotypes are also available from the 1000 Genomes Project (<xref ref-type="bibr" rid="c1">1000 Genomes Project Consortium et al. 2015</xref>). The 445 individuals come from five populations: Tuscany Italian (TSI, <italic>N</italic> = 91), Great British (GBR, <italic>N</italic> = 86), Finnish (FIN, <italic>N</italic> = 92), Utah White American (CEU, <italic>N</italic> = 89) and Yoruban (YRI, <italic>N</italic> = 87). The mRNA measurements are normalized for library depth, expression frequency across individuals as well as PEER factors, as reported in the GEUVADIS databank<xref ref-type="fn" rid="fn1"><sup>1</sup></xref>. Of the available normalized gene expression phenotypes, only those with non-empty sets of variants lying within 1Mb upstream or downstream of the canonical transcription start site were kept for (cis) fine-mapping. This process yielded 22,664 genes used in all subsequent analyses involving the PICS fine-mapping algorithm.</p>
<sec id="s4a">
<label>4.1</label>
<title>Probabilistic Identification of Causal SNPs</title>
<p>We implement Probabilistic Identification of Causal SNPs (PICS) (<xref ref-type="bibr" rid="c13">Farh et al. 2015</xref>), which is based on an earlier genome-wide analysis identifying genetic and epigenetic maps of causal autoimmune disease variants (<xref ref-type="bibr" rid="c13">Farh et al. 2015</xref>).</p>
<p>We assume that <bold>X</bold> and <bold>y</bold> are the <italic>N</italic> × <italic>P</italic> locus haplotype (or genotype) matrix and the <italic>N</italic> × 1 vector of phenotype values respectively, with <bold>y</bold> possibly already adjusted by relevant covariates. For consistency of exposition, let the SNPs be named <italic>A</italic><sub>1</sub>,…, <italic>A<sub>P</sub></italic>. Recall the goal of fine-mapping is to return information about which SNP(s) in the set {<italic>A</italic><sub>1</sub>,…, <italic>A<sub>P</sub></italic>} is (are) causal, given the input pair {<bold>X, y</bold>} and possibly other external information such as functional annotations or, more generally, prior biological knowledge.</p>
<sec id="s4a1">
<title>Overview</title>
<p>Probabilistic Identification of Causal SNPs (PICS) is a Bayesian, non-parametric approach to fine-mapping. Given the observed patterns of association at a locus, and furthermore not assuming a parametric model relating the causal variants to the trait itself, one can estimate the probability that any SNP is causal by performing permutations that preserve its marginal association with the trait as well as the LD patterns at the locus.</p>
<p>To see how this is accomplished, suppose that <italic>A</italic><sub>1</sub> is the lead SNP. We are interested in <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline1.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, the probability that A¿ is causal, for each <italic>i</italic> ∈ [<italic>P</italic>]. By Bayes’ theorem,
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="536456v1_eqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>Focusing on the focal SNP <italic>i</italic>, permute the rows of <bold>X</bold> such that the association between the focal SNP and the trait <bold>y</bold> is invariant; see Supplementary Material <xref ref-type="sec" rid="s5a">Section S1</xref> for a concrete mathematical description of this set of constrained permutations. Then the first term on RHS of <xref ref-type="disp-formula" rid="eqn1">eq. (1)</xref>, <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline2.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, is estimated by the proportion of all permutations where <italic>A</italic><sub>1</sub> emerges as the lead SNP. The second term, <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline3.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, is the prior probability of the focal SNP being causal, which the user can choose based on prior knowledge. The default setting in PICS is <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline4.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. <xref ref-type="fig" rid="fig5">Figure 5</xref> provides a visual summary of the method.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><p>Visual summary of the PICS algorithm described in <xref ref-type="sec" rid="s5a">Subsection 4.1</xref>. <bold>A.</bold> Breakdown of the calculation of the probability of a focal SNP <italic>A</italic><sub>1</sub> being causal. <bold>B.</bold> Illustration of the permutation procedure used to generate the null distribution. An example <italic>N</italic> × <italic>P</italic> genotype array with <italic>N</italic> = <italic>P</italic> = 6 is used, with two valid row shuffles, or permutations, of the original array shown. Entries affected by the shuffle are highlighted, as is the focal SNP (<italic>A</italic><sub>3</sub>).</p></caption>
<graphic xlink:href="536456v1_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>By running the permutation procedure across all SNPs in the locus, one obtains <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline5.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> for each <italic>i</italic>. These posterior probabilities are then normalized so that <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline6.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>.</p>
<p>Finally, the above procedure is performed after restricting the set of all SNPs to only those with correlation magnitude |<italic>r</italic>| &gt; 0.5 to the lead SNP.</p>
</sec>
<sec id="s4a2">
<title>Algorithm</title>
<p>Based on the computation of posterior probabilities described above (<xref ref-type="disp-formula" rid="eqn1">eq. (1)</xref>), the full PICS algorithm returns putatively causal variants as follows.</p>
<statement id="alg1">
<label>Algorithm 1</label>
<title>PICS</title>
<p><fig id="alg1a" position="float" fig-type="figure">
<graphic xlink:href="536456v1_ufig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig></p>
</statement>
<p>The last line of <xref ref-type="fig" rid="alg1">Algorithm 1</xref> returns a list of posterior probability vectors corresponding to each potential set. For our work, we set |<italic>r</italic>| = 0.5, <italic>C</italic> = 3, <italic>R</italic> = 500 and <bold>p</bold><sub>0</sub> = (1/<italic>P</italic>,…, 1/<italic>P</italic>) throughout implementations of <xref ref-type="fig" rid="alg1">Algorithm 1</xref>.</p>
<p>As mentioned in the Introduction (<xref ref-type="sec" rid="s1">Section 1</xref>), we apply two different approaches to implementing <xref ref-type="fig" rid="alg1">Algorithm 1</xref>. One is guided by stability and will be introduced shortly in <xref ref-type="sec" rid="s4b">Subsection 4.2</xref>. The other, which we now describe, is based on regressing out confounders, i.e., residualization. In implementing the residualization approach, we regress the top five principal components, obtained from the genotype matrix <bold>X</bold>, from the gene expression phenotype, <bold>y</bold>. We choose five principal components based on the elbow method, an approach described in <xref ref-type="bibr" rid="c8">Brown et al. (2018)</xref>. This yields residuals <bold>y</bold><italic><sup>r</sup></italic> (<xref ref-type="fig" rid="fig1">Figure 1A</xref>), which we use as the input phenotype array in <xref ref-type="fig" rid="alg1">Algorithm 1</xref>. We subsequently report the variant with highest posterior probability in each potential set as the putatively causal variant for that potential set. This variant is referred to as the top variant.</p>
<p>We remark that there are other ways of using potential confounders in variable selection, such as inclusion as covariates in a linear model. Because our algorithm explicitly avoids assuming a linear model, we have chosen the residualization approach just described.</p>
</sec>
</sec>
<sec id="s4b">
<label>4.2</label>
<title>Incorporating Stability</title>
<p>Our stability-guided approach to implementing PICS follows the steps outlined below. Let (<bold>X, y</bold>) be the genotype array and gene expression array. Assume that there are <italic>K</italic> subpopulations making up the dataset, and let <italic>E<sub>k</sub></italic> denote the set of row indices of <bold>X</bold> corresponding to individuals from subpopulation k. (In our present work, <italic>K</italic> = 5. The five subpopulations are Utahns (<italic>N</italic><sub>CEU</sub> = 89), Finns (<italic>N</italic><sub>FIN</sub> = 92), British (<italic>N</italic><sub>GBR</sub> = 86), Toscani (<italic>N</italic><sub>TSI</sub> = 91) and Yoruban (<italic>N</italic><sub>YRI</sub> = 87).)
<list list-type="order">
<list-item><p>Run <xref ref-type="fig" rid="alg1">Algorithm 1</xref> on the pair (<bold>X, y</bold>). Obtain list of posterior probability vectors, <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline7.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>.</p></list-item>
<list-item><p>For each subpopulation <italic>K</italic> = 1,…, <italic>K</italic>, run <xref ref-type="fig" rid="alg1">Algorithm 1</xref> on the pair (<bold>X</bold>|<italic><sub>E<sub>k</sub></sub></italic>, <bold>y</bold>|<italic><sub>E<sub>k</sub></sub></italic>). Obtain <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline8.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> for each <italic>k</italic>.</p></list-item>
<list-item><p>(Stability-guided choice of putatively causal variants) Collect the probability vectors in lists <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline9.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline10.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> (<italic>k</italic> ∈ [<italic>K</italic>]). Operationalizing the principle that a stable variant has positive probability across multiple slices, we pick causal variants as follows. For potential set c, pick the variants that have (i) positive probability in <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline11.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> in Step 1, and moreover (ii) have positive probability in the most number of probability vectors; call this set of variants <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline12.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> (note <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline13.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is a subset of <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline14.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>). Among members of <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline15.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, select the variant that had the highest posterior probability in <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline16.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>.</p></list-item>
</list></p>
<p>In other words, the stability-guided approach reports the variant that not only appears with positive probability in the most number of subsets including the pooled sample, but also has the largest probability in the pooled sample. This variant is referred to as the stable variant.</p>
<p>To illustrate the last step, suppose there are <italic>K</italic> = 2 subpopulations, <italic>C</italic> = 1 potential set, and <italic>P</italic> = 5 SNPs. Let the outputs from Steps 1 and 2 be
<disp-formula>
<alternatives><graphic xlink:href="536456v1_ueqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula></p>
<p>In this example, the second and fourth variants have positive probability in the most number of probability vectors <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline17.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. Among <italic>A</italic><sub>2</sub> and <italic>A</italic><sub>4</sub>, <italic>A</italic><sub>2</sub> has a higher posterior probability (i.e., 0.43) in <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline18.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, so the stable variant reported is <italic>A</italic><sub>2</sub>. As a side remark, the posterior probability vector <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline19.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> does not generally agree with the posterior probability vector computed using the residualization approach, because the latter is computed by running <xref ref-type="fig" rid="alg1">Algorithm 1</xref> on the pair (<bold>X, y</bold><italic><sup>r</sup></italic>) rather than (<bold>X, y</bold>), as described earlier.</p>
</sec>
<sec id="s4c">
<label>4.3</label>
<title>Statistical Comparison Methodology</title>
<p>We rely on 378 external functional annotations to interpret biological significance of our variants, summarized in <xref ref-type="table" rid="tbl1">Table 1</xref>. Supplementary Material <xref ref-type="sec" rid="s5b">Section S2</xref> provides interpretation for the functional annotations, while Supplementary Material <xref ref-type="sec" rid="s5c">Section S3</xref> describes in greater detail how we generate annotations from Enformer predictions.</p>
<p>Our comparison of the top and stable variants is two-fold. First, we evaluate the relative significance of the stable variant against the top variant, by running paired Wilcoxon two-sample tests across all pairs of top and stable variants across all GEUVADIS gene expression phenotypes. We compute one-directional <italic>p</italic>-values in either direction to check for significant depletion or enrichment of the stable variant with respect to a particular annotation. Raw <italic>p</italic>-values are adjusted for false discovery rate control by applying the standard Benjamini-Hochberg (BH) procedure (R command <monospace>p.adjust(.,.,method=‘BH’)</monospace>) to <italic>p</italic>-values across all 378 annotations and all potential sets.</p>
<p>To investigate whether various external factors might moderate the differences in functional annotations, we next perform trend tests. Basically, for some external factor <italic>F</italic>, we run a trend test to see if values of F are associated with attenuation or augmentation of differences in functional annotation of the top and stable variants. The list of all external factors F is provided in <xref ref-type="table" rid="tbl2">Table 2</xref>.</p>
<p>For (1) Degree of Stability, we perform a Jonckheere-Terpstra test (R command <monospace>clinfun:: jonckheere.test(…,nperm=5000)</monospace>). For (2) Population Diversity, (3) Population Differentiation and (6) Degree of Certainty of Causality Using Residualization Approach, we perform a correlation test (R command <monospace>cor.test(…)</monospace>). For (4) Inclusion of Distal Subpopulations (Top) and (5) Inclusion of Distal Subpopulations (Stable), we perform an unpaired Wilcoxon test (R command <monospace>wilcox.test(…)</monospace>). Finally, for each moderator, we again compute one-directional <italic>p</italic>-values in either direction, before applying the BH procedure to all <italic>p</italic>-values across annotations and potential sets for that moderator only.</p>
</sec>
</sec>
</body>
<back>
<sec id="d1e1277">
<title>Data Availability</title>
<p>We provide the following data and scripts on the Github repository <ext-link ext-link-type="uri" xlink:href="https://github.com/songlab-cal/">https://github.com/songlab-cal/</ext-link> StableFM: fine-mapped variants with their functional annotations and moderator variable quantities, code for reproducing figures in this manuscript and building our visualization app.</p>
</sec>
<sec id="d1e1288">
<title>Author Contributions</title>
<p>AA, NI, and YSS designed the study. AA performed data analyses and developed the interactive visualization app. LJ developed the interactive visualization app. NI and YSS supervised the research.</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>This research is supported in part by an NIH grant R35-GM134922 and grant number CZF2019-002449 from the Chan Zuckerberg Initiative Foundation. We thank Carlos Albors, Gonzalo Benegas, Ryan Chung, Ziyue Gao, Iain Mathieson and Yutong Wang for helpful discussions, members of the Yu Group at Berkeley for feedback on the work, and Aniketh Reddy for help with data processing.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><collab>1000 Genomes Project Consortium</collab> <etal>et al.</etal> <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source>, <volume>526</volume>(<issue>7571</issue>):<fpage>68</fpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><given-names>Abdel</given-names> <surname>Abdellaoui</surname></string-name>, <string-name><given-names>Conor V</given-names> <surname>Dolan</surname></string-name>, <string-name><given-names>Karin JH</given-names> <surname>Verweij</surname></string-name>, and <string-name><given-names>Michel G</given-names> <surname>Nivard</surname></string-name>. <article-title>Gene–environment correlations across geographic regions affect genome-wide association studies</article-title>. <source>Nature Genetics</source>, <volume>54</volume>(<issue>9</issue>):<fpage>1345</fpage>–<lpage>1354</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><given-names>Ivan A</given-names> <surname>Adzhubei</surname></string-name>, <string-name><given-names>Steffen</given-names> <surname>Schmidt</surname></string-name>, <string-name><given-names>Leonid</given-names> <surname>Peshkin</surname></string-name>, <string-name><given-names>Vasily E</given-names> <surname>Ramensky</surname></string-name>, <string-name><given-names>Anna</given-names> <surname>Gerasimova</surname></string-name>, <string-name><given-names>Peer</given-names> <surname>Bork</surname></string-name>, <string-name><given-names>Alexey S</given-names> <surname>Kondrashov</surname></string-name>, and <string-name><given-names>Shamil R</given-names> <surname>Sunyaev</surname></string-name>. <article-title>A method and server for predicting damaging missense mutations</article-title>. <source>Nature Methods</source>, <volume>7</volume>(<issue>4</issue>):<fpage>248</fpage>–<lpage>249</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><given-names>Ziga</given-names> <surname>Avsec</surname></string-name>, <string-name><given-names>Vikram</given-names> <surname>Agarwal</surname></string-name>, <string-name><given-names>Daniel</given-names> <surname>Visentin</surname></string-name>, <string-name><given-names>Joseph R</given-names> <surname>Ledsam</surname></string-name>, <string-name><given-names>Agnieszka</given-names> <surname>Grabska-Barwinska</surname></string-name>, <string-name><given-names>Kyle R</given-names> <surname>Taylor</surname></string-name>, <string-name><given-names>Yannis</given-names> <surname>Assael</surname></string-name>, <string-name><given-names>John</given-names> <surname>Jumper</surname></string-name>, <string-name><given-names>Pushmeet</given-names> <surname>Kohli</surname></string-name>, and <string-name><given-names>David R</given-names> <surname>Kelley</surname></string-name>. <article-title>Effective gene expression prediction from sequence by integrating long-range interactions</article-title>. <source>Nature Methods</source>, <volume>18</volume>(<issue>10</issue>):<fpage>1196</fpage>–<lpage>1203</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><given-names>Suganthi</given-names> <surname>Balasubramanian</surname></string-name>, <string-name><given-names>Yao</given-names> <surname>Fu</surname></string-name>, <string-name><given-names>Mayur</given-names> <surname>Pawashe</surname></string-name>, <string-name><given-names>Patrick</given-names> <surname>McGillivray</surname></string-name>, <string-name><given-names>Mike</given-names> <surname>Jin</surname></string-name>, <string-name><given-names>Jeremy</given-names> <surname>Liu</surname></string-name>, <string-name><given-names>Konrad J</given-names> <surname>Karczewski</surname></string-name>, <string-name><given-names>Daniel G</given-names> <surname>MacArthur</surname></string-name>, and <string-name><given-names>Mark</given-names> <surname>Gerstein</surname></string-name>. <article-title>Using ALoFT to determine the impact of putative loss-of-function variants in protein-coding genes</article-title>. <source>Nature Communications</source>, <volume>8</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><given-names>Sumanta</given-names> <surname>Basu</surname></string-name>, <string-name><given-names>Karl</given-names> <surname>Kumbier</surname></string-name>, <string-name><given-names>James B</given-names> <surname>Brown</surname></string-name>, and <string-name><given-names>Bin</given-names> <surname>Yu</surname></string-name>. <article-title>Iterative random forests to discover predictive and stable high-order interactions</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>115</volume>(<issue>8</issue>):<fpage>1943</fpage>–<lpage>1948</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><given-names>Olivier</given-names> <surname>Bousquet</surname></string-name> and <string-name><given-names>André</given-names> <surname>Elisseeff</surname></string-name>. <article-title>Stability and generalization</article-title>. <source>The Journal of Machine Learning Research</source>, <volume>2</volume>:<fpage>499</fpage>–<lpage>526</lpage>, <year>2002</year>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><given-names>Brielin C</given-names> <surname>Brown</surname></string-name>, <string-name><given-names>Nicolas L</given-names> <surname>Bray</surname></string-name>, and <string-name><given-names>Lior</given-names> <surname>Pachter</surname></string-name>. <article-title>Expression reflects population structure</article-title>. <source>PLoS Genetics</source>, <volume>14</volume>(<issue>12</issue>):<fpage>e1007841</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><given-names>Taylor B</given-names> <surname>Cavazos</surname></string-name> and <string-name><given-names>John S</given-names> <surname>Witte</surname></string-name>. <article-title>Inclusion of variants discovered from diverse populations improves polygenic risk score transferability</article-title>. <source>Human Genetics and Genomics Advances</source>, <volume>2</volume>(<issue>1</issue>):<fpage>100017</fpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><given-names>Fiona</given-names> <surname>Cunningham</surname></string-name>, <string-name><given-names>James E</given-names> <surname>Allen</surname></string-name>, <string-name><given-names>Jamie</given-names> <surname>Allen</surname></string-name>, <string-name><given-names>Jorge</given-names> <surname>Alvarez-Jarreta</surname></string-name>, <string-name><given-names>M Ridwan</given-names> <surname>Amode</surname></string-name>, <string-name><given-names>Irina M</given-names> <surname>Armean</surname></string-name>, <string-name><given-names>Olanrewaju</given-names> <surname>Austine-Orimoloye</surname></string-name>, <string-name><given-names>Andrey G</given-names> <surname>Azov</surname></string-name>, <string-name><given-names>If</given-names> <surname>Barnes</surname></string-name>, <string-name><given-names>Ruth</given-names> <surname>Bennett</surname></string-name>, <etal>et al.</etal> <article-title>Ensembl 2022</article-title>. <source>Nucleic Acids Research</source>, <volume>50</volume>(<issue>D1</issue>):<fpage>D988</fpage>–<lpage>D995</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><given-names>Eugene V</given-names> <surname>Davydov</surname></string-name>, <string-name><given-names>David L</given-names> <surname>Goode</surname></string-name>, <string-name><given-names>Marina</given-names> <surname>Sirota</surname></string-name>, <string-name><given-names>Gregory M</given-names> <surname>Cooper</surname></string-name>, <string-name><given-names>Arend</given-names> <surname>Sidow</surname></string-name>, and <string-name><given-names>Serafim</given-names> <surname>Batzoglou</surname></string-name>. <article-title>Identifying a high fraction of the human genome to be under selective constraint using GERP++</article-title>. <source>PLoS Computational Biology</source>, <volume>6</volume>(<issue>12</issue>):<fpage>e1001025</fpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="book"><string-name><given-names>Bradley</given-names> <surname>Efron</surname></string-name> and <string-name><given-names>Robert J</given-names> <surname>Tibshirani</surname></string-name>. <source>An Introduction to the Bootstrap</source>. <publisher-name>CRC press</publisher-name>, <year>1994</year>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><given-names>Kyle Kai-How</given-names> <surname>Farh</surname></string-name>, <string-name><given-names>Alexander</given-names> <surname>Marson</surname></string-name>, <string-name><given-names>Jiang</given-names> <surname>Zhu</surname></string-name>, <string-name><given-names>Markus</given-names> <surname>Kleinewietfeld</surname></string-name>, <string-name><given-names>William J</given-names> <surname>Housley</surname></string-name>, <string-name><given-names>Samantha</given-names> <surname>Beik</surname></string-name>, <string-name><given-names>Noam</given-names> <surname>Shoresh</surname></string-name>, <string-name><given-names>Holly</given-names> <surname>Whitton</surname></string-name>, <string-name><given-names>Russell JH</given-names> <surname>Ryan</surname></string-name>, <string-name><given-names>Alexander A</given-names> <surname>Shishkin</surname></string-name>, <etal>et al.</etal> <article-title>Genetic and epigenetic fine mapping of causal autoimmune disease variants</article-title>. <source>Nature</source>, <volume>518</volume>(<issue>7539</issue>):<fpage>337</fpage>–<lpage>343</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><given-names>Marie-Julie</given-names> <surname>Favé</surname></string-name>, <string-name><given-names>Fabien C</given-names> <surname>Lamaze</surname></string-name>, <string-name><given-names>David</given-names> <surname>Soave</surname></string-name>, <string-name><given-names>Alan</given-names> <surname>Hodgkinson</surname></string-name>, <string-name><given-names>Héloïse</given-names> <surname>Gauvin</surname></string-name>, <string-name><given-names>Vanessa</given-names> <surname>Bruat</surname></string-name>, <string-name><given-names>Jean-Christophe</given-names> <surname>Grenier</surname></string-name>, <string-name><given-names>Elias</given-names> <surname>Gbeha</surname></string-name>, <string-name><given-names>Kimberly</given-names> <surname>Skead</surname></string-name>, <string-name><given-names>Audrey</given-names> <surname>Smargiassi</surname></string-name>, <etal>et al.</etal> <article-title>Gene-by-environment interactions in urban populations modulate risk phenotypes</article-title>. <source>Nature Communi-cations</source>, <volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><given-names>Yao</given-names> <surname>Fu</surname></string-name>, <string-name><given-names>Zhu</given-names> <surname>Liu</surname></string-name>, <string-name><given-names>Shaoke</given-names> <surname>Lou</surname></string-name>, <string-name><given-names>Jason</given-names> <surname>Bedford</surname></string-name>, <string-name><given-names>Xinmeng Jasmine</given-names> <surname>Mu</surname></string-name>, <string-name><given-names>Kevin Y</given-names> <surname>Yip</surname></string-name>, <string-name><given-names>Ekta</given-names> <surname>Khurana</surname></string-name>, and <string-name><given-names>Mark</given-names> <surname>Gerstein</surname></string-name>. <article-title>FunSeq2: a framework for prioritizing noncoding regulatory variants in cancer</article-title>. <source>Genome Biology</source>, <volume>15</volume>(<issue>10</issue>):<fpage>1</fpage>–<lpage>15</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><given-names>Buhm</given-names> <surname>Han</surname></string-name> and <string-name><given-names>Eleazar</given-names> <surname>Eskin</surname></string-name>. <article-title>Interpreting meta-analyses of genome-wide association studies</article-title>. <source>PLoS Genetics</source>, <volume>8</volume>(<issue>3</issue>):<fpage>e1002555</fpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><given-names>Yi-Fei</given-names> <surname>Huang</surname></string-name>, <string-name><given-names>Brad</given-names> <surname>Gulko</surname></string-name>, and <string-name><given-names>Adam</given-names> <surname>Siepel</surname></string-name>. <article-title>Fast, scalable prediction of deleterious noncoding variants from functional and population genomic data</article-title>. <source>Nature genetics</source>, <volume>49</volume>(<issue>4</issue>):<fpage>618</fpage>–<lpage>624</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><given-names>Nilah M</given-names> <surname>Ioannidis</surname></string-name>, <string-name><given-names>Joe R</given-names> <surname>Davis</surname></string-name>, <string-name><given-names>Marianne K</given-names> <surname>DeGorter</surname></string-name>, <string-name><given-names>Nicholas B</given-names> <surname>Larson</surname></string-name>, <string-name><given-names>Shannon K</given-names> <surname>McDonnell</surname></string-name>, <string-name><given-names>Amy J</given-names> <surname>French</surname></string-name>, <string-name><given-names>Alexis J</given-names> <surname>Battle</surname></string-name>, <string-name><given-names>Trevor J</given-names> <surname>Hastie</surname></string-name>, <string-name><given-names>Stephen N</given-names> <surname>Thibodeau</surname></string-name>, <string-name><given-names>Stephen B</given-names> <surname>Montgomery</surname></string-name>, <etal>et al.</etal> <article-title>FIRE: Functional inference of genetic variants that regulate gene expression</article-title>. <source>Bioinformat</source>ics, <volume>33</volume>(<issue>24</issue>):<fpage>3895</fpage>–<lpage>3901</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><given-names>Kevin L</given-names> <surname>Keys</surname></string-name>, <string-name><given-names>Angel CY</given-names> <surname>Mak</surname></string-name>, <string-name><given-names>Marquitta J</given-names> <surname>White</surname></string-name>, <string-name><given-names>Walter L</given-names> <surname>Eckalbar</surname></string-name>, <string-name><given-names>Andrew W</given-names> <surname>Dahl</surname></string-name>, <string-name><given-names>Joel</given-names> <surname>Mefford</surname></string-name>, <string-name><given-names>Anna V</given-names> <surname>Mikhaylova</surname></string-name>, <string-name><given-names>María G</given-names> <surname>Contreras</surname></string-name>, <string-name><given-names>Jennifer R</given-names> <surname>Elhawary</surname></string-name>, <string-name><given-names>Celeste</given-names> <surname>Eng</surname></string-name>, <etal>et al.</etal> <article-title>On the cross-population generalizability of gene expression prediction models</article-title>. <source>PLoS Genetics</source>, <volume>16</volume>(<issue>8</issue>):<fpage>e1008927</fpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><given-names>Nathan</given-names> <surname>LaPierre</surname></string-name>, <string-name><given-names>Kodi</given-names> <surname>Taraszka</surname></string-name>, <string-name><given-names>Helen</given-names> <surname>Huang</surname></string-name>, <string-name><given-names>Rosemary</given-names> <surname>He</surname></string-name>, <string-name><given-names>Farhad</given-names> <surname>Hormozdiari</surname></string-name>, and <string-name><given-names>Eleazar</given-names> <surname>Eskin</surname></string-name>. <article-title>Identifying causal variants by fine mapping across multiple studies</article-title>. <source>PLoS Genetics</source>, <volume>17</volume>(<issue>9</issue>):<fpage>e1009733</fpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><given-names>Tuuli</given-names> <surname>Lappalainen</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Sammeth</surname></string-name>, <string-name><given-names>Marc R</given-names> <surname>Friedländer</surname></string-name>, <string-name><given-names>Peter AC t</given-names> <surname>Hoen</surname></string-name>, <string-name><given-names>Jean</given-names> <surname>Monlong</surname></string-name>, <string-name><given-names>Manuel A</given-names> <surname>Rivas</surname></string-name>, <string-name><given-names>Mar</given-names> <surname>Gonzalez-Porta</surname></string-name>, <string-name><given-names>Natalja</given-names> <surname>Kurbatova</surname></string-name>, <string-name><given-names>Thasso</given-names> <surname>Griebel</surname></string-name>, <string-name><given-names>Pedro G</given-names> <surname>Ferreira</surname></string-name>, <etal>et al.</etal> <article-title>Transcriptome and genome sequencing uncovers functional variation in humans</article-title>. <source>Nature</source>, <volume>501</volume>(<issue>7468</issue>):<fpage>506</fpage>–<lpage>511</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><given-names>S</given-names> <surname>Li</surname></string-name>, <string-name><given-names>M</given-names> <surname>Sesia</surname></string-name>, <string-name><given-names>Y</given-names> <surname>Romano</surname></string-name>, <string-name><given-names>E</given-names> <surname>Candès</surname></string-name>, and <string-name><given-names>C</given-names> <surname>Sabatti</surname></string-name>. <article-title>Searching for robust associations with a multi-environment knockoff filter</article-title>. <source>Biometrika</source>, <volume>109</volume>(<issue>3</issue>):<fpage>611</fpage>–<lpage>629</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><given-names>Yanyu</given-names> <surname>Liang</surname></string-name>, <string-name><given-names>Milton</given-names> <surname>Pividori</surname></string-name>, <string-name><given-names>Ani</given-names> <surname>Manichaikul</surname></string-name>, <string-name><given-names>Abraham A</given-names> <surname>Palmer</surname></string-name>, <string-name><given-names>Nancy J</given-names> <surname>Cox</surname></string-name>, <string-name><given-names>Heather E</given-names> <surname>Wheeler</surname></string-name>, and <string-name><given-names>Hae Kyung</given-names> <surname>Im</surname></string-name>. <article-title>Polygenic transcriptome risk scores (PTRS) can improve portability of polygenic risk scores across ancestries</article-title>. <source>Genome Biology</source>, <volume>23</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>18</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><given-names>Chinghway</given-names> <surname>Lim</surname></string-name> and <string-name><given-names>Bin</given-names> <surname>Yu</surname></string-name>. <article-title>Estimation stability with cross-validation (ESCV)</article-title>. <source>Journal of Computational and Graphical Statistics</source>, <volume>25</volume>(<issue>2</issue>):<fpage>464</fpage>–<lpage>492</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><given-names>Zeyun</given-names> <surname>Lu</surname></string-name>, <string-name><given-names>Shyamalika</given-names> <surname>Gopalan</surname></string-name>, <string-name><given-names>Dong</given-names> <surname>Yuan</surname></string-name>, <string-name><given-names>David V</given-names> <surname>Conti</surname></string-name>, <string-name><given-names>Bogdan</given-names> <surname>Pasaniuc</surname></string-name>, <string-name><given-names>Alexander</given-names> <surname>Gusev</surname></string-name>, and <string-name><given-names>Nicholas</given-names> <surname>Mancuso</surname></string-name>. <article-title>Multi-ancestry fine-mapping improves precision to identify causal genes in transcriptome-wide association studies</article-title>. <source>The American Journal of Human Genetics</source>, <volume>109</volume>(<issue>8</issue>): <fpage>1388</fpage>–<lpage>1404</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><given-names>Carla</given-names> <surname>Márquez-Luna</surname></string-name>, <string-name><given-names>Po-Ru</given-names> <surname>Loh</surname></string-name>, <collab>South Asian Type 2 Diabetes (SAT2D) Consortium, SIGMA Type 2 Diabetes Consortium</collab>, and <string-name><given-names>Alkes L</given-names> <surname>Price</surname></string-name>. <article-title>Multiethnic polygenic risk scores improve risk prediction in diverse populations</article-title>. <source>Genetic Epidemiology</source>, <volume>41</volume>(<issue>8</issue>):<fpage>811</fpage>–<lpage>823</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><given-names>Graham</given-names> <surname>McVicker</surname></string-name>, <string-name><given-names>David</given-names> <surname>Gordon</surname></string-name>, <string-name><given-names>Colleen</given-names> <surname>Davis</surname></string-name>, and <string-name><given-names>Phil</given-names> <surname>Green</surname></string-name>. <article-title>Widespread genomic signatures of natural selection in hominid evolution</article-title>. <source>PLoS Genetics</source>, <volume>5</volume>(<issue>5</issue>):<fpage>e1000471</fpage>, <year>2009</year>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><given-names>Andrew P</given-names> <surname>Morris</surname></string-name>. <article-title>Transethnic meta-analysis of genomewide association studies</article-title>. <source>Genetic Epidemilogy</source>, <volume>35</volume>(<issue>8</issue>):<fpage>809</fpage>–<lpage>822</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><given-names>Hakhamanesh</given-names> <surname>Mostafavi</surname></string-name>, <string-name><given-names>Arbel</given-names> <surname>Harpak</surname></string-name>, <string-name><given-names>Ipsita</given-names> <surname>Agarwal</surname></string-name>, <string-name><given-names>Dalton</given-names> <surname>Conley</surname></string-name>, <string-name><given-names>Jonathan K</given-names> <surname>Pritchard</surname></string-name>, and <string-name><given-names>Molly</given-names> <surname>Przeworski</surname></string-name>. <article-title>Variable prediction accuracy of polygenic scores within an ancestry group</article-title>. <source>Elife</source>, <volume>9</volume>:<fpage>e48376</fpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><given-names>Pauline C</given-names> <surname>Ng</surname></string-name> and <string-name><given-names>Steven</given-names> <surname>Henikoff</surname></string-name>. <article-title>Sift: Predicting amino acid changes that affect protein function</article-title>. <source>Nucleic Acids Research</source>, <volume>31</volume>(<issue>13</issue>):<fpage>3812</fpage>–<lpage>3814</lpage>, <year>2003</year>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><given-names>Katherine S</given-names> <surname>Pollard</surname></string-name>, <string-name><given-names>Melissa J</given-names> <surname>Hubisz</surname></string-name>, <string-name><given-names>Kate R</given-names> <surname>Rosenbloom</surname></string-name>, and <string-name><given-names>Adam</given-names> <surname>Siepel</surname></string-name>. <article-title>Detection of nonneutral substitution rates on mammalian phylogenies</article-title>. <source>Genome Research</source>, <volume>20</volume>(<issue>1</issue>):<fpage>110</fpage>–<lpage>121</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><given-names>Philipp</given-names> <surname>Rentzsch</surname></string-name>, <string-name><given-names>Daniela</given-names> <surname>Witten</surname></string-name>, <string-name><given-names>Gregory M</given-names> <surname>Cooper</surname></string-name>, <string-name><given-names>Jay</given-names> <surname>Shendure</surname></string-name>, and <string-name><given-names>Martin</given-names> <surname>Kircher</surname></string-name>. <article-title>Cadd: predicting the deleteriousness of variants throughout the human genome</article-title>. <source>Nucleic Acids Research</source>, <volume>47</volume>(<issue>D1</issue>):<fpage>D886</fpage>–<lpage>D894</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><given-names>Mark F</given-names> <surname>Rogers</surname></string-name>, <string-name><given-names>Hashem A</given-names> <surname>Shihab</surname></string-name>, <string-name><given-names>Matthew</given-names> <surname>Mort</surname></string-name>, <string-name><given-names>David N</given-names> <surname>Cooper</surname></string-name>, <string-name><given-names>Tom R</given-names> <surname>Gaunt</surname></string-name>, and <string-name><given-names>Colin</given-names> <surname>Campbell</surname></string-name>. <article-title>FATHMM-XF: accurate prediction of pathogenic point mutations via extended features</article-title>. <source>Bioinformatics</source>, <volume>34</volume>(<issue>3</issue>):<fpage>511</fpage>–<lpage>513</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><given-names>Daniel J</given-names> <surname>Schaid</surname></string-name>, <string-name><given-names>Wenan</given-names> <surname>Chen</surname></string-name>, and <string-name><given-names>Nicholas B</given-names> <surname>Larson</surname></string-name>. <article-title>From genome-wide associations to candidate causal variants by statistical fine-mapping</article-title>. <source>Nature Reviews Genetics</source>, <volume>19</volume>(<issue>8</issue>):<fpage>491</fpage>–<lpage>504</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><given-names>Kimberly E</given-names> <surname>Taylor</surname></string-name>, <string-name><given-names>K Mark</given-names> <surname>Ansel</surname></string-name>, <string-name><given-names>Alexander</given-names> <surname>Marson</surname></string-name>, <string-name><given-names>Lindsey A</given-names> <surname>Criswell</surname></string-name>, and <string-name><given-names>Kyle</given-names> <surname>Kai-How Farh.</surname></string-name> <article-title>PICS2: next-generation fine mapping via probabilistic identification of causal SNPs</article-title>. <source>Bioinformatics</source>, <volume>37</volume>(<issue>18</issue>):<fpage>3004</fpage>–<lpage>3007</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="other"><string-name><given-names>Patrick</given-names> <surname>Turley</surname></string-name>, <string-name><given-names>Alicia R</given-names> <surname>Martin</surname></string-name>, <string-name><given-names>Grant</given-names> <surname>Goldman</surname></string-name>, <string-name><given-names>Hui</given-names> <surname>Li</surname></string-name>, <string-name><given-names>Masahiro</given-names> <surname>Kanai</surname></string-name>, <string-name><given-names>Raymond K</given-names> <surname>Walters</surname></string-name>, <string-name><given-names>Jonathan B</given-names> <surname>Jala</surname></string-name>, <string-name><given-names>Kuang</given-names> <surname>Lin</surname></string-name>, <string-name><given-names>Iona Y</given-names> <surname>Millwood</surname></string-name>, <string-name><given-names>Caitlin E</given-names> <surname>Carey</surname></string-name>, <etal>et al.</etal> <article-title>Multi-ancestry metaanalysis yields novel genetic discoveries and ancestry-specific associations</article-title>. <source>BioRxiv</source>, pages <fpage>2021</fpage>–<lpage>04</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><given-names>Qingbo S</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>David R</given-names> <surname>Kelley</surname></string-name>, <string-name><given-names>Jacob</given-names> <surname>Ulirsch</surname></string-name>, <string-name><given-names>Masahiro</given-names> <surname>Kanai</surname></string-name>, <string-name><given-names>Shuvom</given-names> <surname>Sadhuka</surname></string-name>, <string-name><given-names>Ran</given-names> <surname>Cui</surname></string-name>, <string-name><given-names>Carlos</given-names> <surname>Albors</surname></string-name>, <string-name><given-names>Nathan</given-names> <surname>Cheng</surname></string-name>, <string-name><given-names>Yukinori</given-names> <surname>Okada</surname></string-name>, <string-name><given-names>Francois</given-names> <surname>Aguet</surname></string-name>, <etal>et al.</etal> <article-title>Leveraging supervised learning for functionally informed fine-mapping of cis-eQTLs identifies an additional 20,913 putative causal eQTLs</article-title>. <source>Nature Communications</source>, <volume>12</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>11</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><given-names>Xiaoquan</given-names> <surname>Wen</surname></string-name>, <string-name><given-names>Francesca</given-names> <surname>Luca</surname></string-name>, and <string-name><given-names>Roger</given-names> <surname>Pique-Regi</surname></string-name>. <article-title>Cross-population joint analysis of eQTLs: fine mapping and functional annotation</article-title>. <source>PLoS Genetics</source>, <volume>11</volume>(<issue>4</issue>):<fpage>e1005176</fpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><given-names>Cristen J</given-names> <surname>Willer</surname></string-name>, <string-name><given-names>Yun</given-names> <surname>Li</surname></string-name>, and <string-name><given-names>Gonçalo R</given-names> <surname>Abecasis</surname></string-name>. <article-title>Metal: fast and efficient meta-analysis of genomewide association scans</article-title>. <source>Bioinformatics</source>, <volume>26</volume>(<issue>17</issue>):<fpage>2190</fpage>–<lpage>2191</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><given-names>Bin</given-names> <surname>Yu</surname></string-name> and <string-name><given-names>Karl</given-names> <surname>Kumbier</surname></string-name>. <article-title>Veridical data science</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>117</volume>(<issue>8</issue>):<fpage>3920</fpage>–<lpage>3929</lpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><given-names>Arslan A</given-names> <surname>Zaidi</surname></string-name> and <string-name><given-names>Iain</given-names> <surname>Mathieson</surname></string-name>. <article-title>Demographic history mediates the effect of stratification on polygenic scores</article-title>. <source>Elife</source>, <volume>9</volume>:<fpage>e61548</fpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="other"><string-name><given-names>Hufeng</given-names> <surname>Zhou</surname></string-name>, <string-name><given-names>Theodore</given-names> <surname>Arapoglou</surname></string-name>, <string-name><given-names>Xihao</given-names> <surname>Li</surname></string-name>, <string-name><given-names>Zilin</given-names> <surname>Li</surname></string-name>, <string-name><given-names>Xiuwen</given-names> <surname>Zheng</surname></string-name>, <string-name><given-names>Jill E</given-names> <surname>Moore</surname></string-name>, <string-name><given-names>Abhijith</given-names> <surname>Asok</surname></string-name>, <string-name><given-names>Sushant</given-names> <surname>Kumar</surname></string-name>, <string-name><given-names>Elizabeth E</given-names> <surname>Blue</surname></string-name>, <string-name><given-names>Steve</given-names> <surname>Buyske</surname></string-name>, <etal>et al.</etal> <article-title>FAVOR: Functional annotation of variants online resource and annotator for variation across the human genome</article-title>. <source>bioRxiv</source>, <year>2022</year>.</mixed-citation></ref>
</ref-list>
<sec id="s5">
<title>Supplementary Material</title>
<sec id="s5a">
<label>S1</label>
<title>Permuting while preserving marginal correlation and LD: a Formal Description</title>
<p>For a focal SNP <italic>i</italic>, its <italic>N</italic> entries (<italic>x</italic><sub>1<italic>i</italic></sub>,…, <italic>x<sub>Ni</sub></italic>) take on only <italic>D</italic> values, where <italic>D</italic> is the ploidy of the data (for human genotypes <italic>D</italic> = 2 and for human haplotypes <italic>D</italic> = 1). Suppose <italic>D</italic> = 2 for exposition. For <italic>d</italic> = 0, 1, 2, let <italic>I<sub>d</sub></italic> ⊂ [<italic>N</italic>] denote the indices of those elements of the allelic dosage vector (<italic>x</italic><sub>1<italic>i</italic></sub>,…, <italic>x<sub>Ni</sub></italic>) taking on value <italic>d</italic>. Then, any permutation <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline20.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> of the rows of <bold>X</bold> that preserves marginal correlation with the phenotype and LD maps indices from <italic>I<sub>d</sub></italic> to <italic>I<sub>d</sub></italic>, because
<list list-type="bullet">
<list-item><p>Each distinct entry in the allelic dosage vector of the focal SNP is still assigned the the same phenotype entry;</p></list-item>
<list-item><p>Row shuffles do not change column-column covariances, the latter of which determines LD.</p></list-item>
</list></p>
<p>To be precise, <inline-formula><alternatives><inline-graphic xlink:href="536456v1_inline21.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, a direct product of the three permutation groups corresponding to the different allelic dosages.</p>
<p>In practice, we approximate the permutation distribution by sampling permutations uniformly at random from the group defined above. We set the sampling number to 500 for all our fine-mapping experiments.</p>
</sec>
<sec id="s5b">
<label>S2</label>
<title>List of Annotations</title>
<p>We measure the biological significance of a variant using a wide range of available functional annotations (<xref ref-type="table" rid="tblS1">Table S1</xref>). The annotations cover potential biological activity in the local vicinity of the variant position along the genome, estimated model-based biological quantities (e.g., selection and conservation scores), and predicted effects of mutagenesis from the reference to the alternate allele at the variant.</p>
<table-wrap id="tblS1" orientation="portrait" position="float">
<label>Table S1:</label>
<caption><p>List of annotations used in our study, alongside their interpretations.</p></caption>
<graphic xlink:href="536456v1_tblS1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s5c">
<label>S3</label>
<title>Generating Annotations from Enformer Predictions</title>
<p>The Enformer (<xref ref-type="bibr" rid="sc1">Avsec et al., 2021</xref>) is a sequence-based prediction model, which leverages the attention mechanism in a transformer neural network to capture long-range effects on gene regulation.</p>
<p>For Enformer predictions, we subset the 5,313 ChlP-seq, DNase-seq, ATAC-seq and CAGE tracks to only those relevant to the lymphoblastoid cell line (GM12878), the cell line with respect to which GEUVADIS gene expression phenotypes are measured. We also restrict to genes whose top and stable variants are within the 196, 608 bp input length limit of the Enformer from the corresponding GEUVADIS gene’s TSS. This restriction allows us to obtain Enformer predictions on three sequences: a <italic>null sequence</italic>, a sequence where the REF allele is replaced with the ALT allele at the top variant (<italic>top sequence</italic>), and a sequence where the REF allele is replaced with the ALT allele at the stable variant (<italic>stable sequence</italic>).</p>
<p>To compare the top and the stable variants with respect to a particular track, we take the predictions obtained from the three input sequences (null prediction, top prediction, stable prediction — a <italic>triplet</italic>), and compute the magnitude of change in predictions between both the top and null and the stable and null. We use the magnitude of change here, rather than the change itself, to capture the impact the mutation associated with the variant has on the track. Our Enformer functional annotations can thus be interpreted as measures of mutagenic impact on a track’s prediction, without considering the directionality of the impact. We refer to these annotations as <italic>perturbation scores</italic>.</p>
<p>We compute perturbation scores in two ways. The first way is to center all input sequences on the transcription start site of the gene (occasionally referred to as ‘TSS’ in our work), thus allowing the model to measure the impact of mutagenesis at the (top or stable) variant on predicted gene expression profile for the sequence. The second way is to average the perturbation scores over three triplets, one centered on the gene TSS, and two centered on the flanking positions of the gene TSS (i.e., the two neighbouring bins). The second way (occasionally referred to as ‘AVE’ in our work) accounts for errors arising from imprecise TSS positioning and the instability of the model to small changes in input — a technique used in <xref ref-type="bibr" rid="sc2">Karollus et al. (2022)</xref> and by the Enformer team (<xref ref-type="bibr" rid="sc1">Avsec et al., 2021</xref>).</p>
</sec>
<sec id="s5d">
<label>S4</label>
<title>Matching versus Non-matching Variant Results</title>
<p>As described in the main text, we compare between one set of genes where the top and stable variants match and another set of genes where the top and stable variants disagree; comparisons are made between matching variants and one of the non-matching sets of variants (top or stable).</p>
<p>Concretely, for Potential Set 1 we compare between <italic>N</italic><sub>match</sub> = 12, 743 genes with matching variants and <italic>N</italic><sub>non-match</sub> = 9, 921 genes with non-matching variants; for Potential Set 2 we compare between <italic>N</italic><sub>match</sub> = 8,197 genes with matching variants and <italic>N</italic><sub>non-match</sub> = 14, 452 genes with non-matching variants; and for Potential Set 3 we compare between <italic>N</italic><sub>match</sub> = 5,807 genes with matching variants and <italic>N</italic><sub>non-match</sub> = 16, 812 genes with non-matching variants. Below, we summarize our findings.</p>
<sec id="s5d1">
<title>Matching Variants vs Non-matching Top Variants</title>
<p>We observe the following significant trends: as mentioned in the main text, for Potential Set 1 361 functional annotations reported significantly higher scores for the matching variants, with all BH-adjusted <italic>p</italic>-values less than 0.05. The remaining 17 = 378–361 annotations <italic>not</italic> exhibiting significantly higher scores are: Distance to Canonical TSS, CTCF Binding Enrichment, Enhancer Enrichment, Open Chromatin Enrichment, TF Binding Enrichment, Promoter Flanking Enrichment, CADD raw score, PHRED-normmalized CADD score, SIFTVal, priPhyloP, mamPhyloP, verPhyloP, GerpS, LINSIGHT, Funseq2, ALoft, and FIRE.</p>
<p>For Potential Set 2, 132 functional annotations reported significantly higher scores for the matching variants. For Potential Set 3, 9 functional annotations reported significantly higher scores for the matching variants: B Statistic, percent GC content, and Enformer tracks <monospace>ENCFF776DPQ, ENCFF831ZHL, ENCFF601YET, ENCFF945XXY, ENCFF676UXN, ENCFF151LGF, ENCFF876DXW</monospace>. For all three potential sets, there were no functional annotations reporting significantly lower scores for the matching variants, even for annotations where a low score implies greater biological functionality (e.g., B Statistic).</p>
</sec>
<sec id="s5d2">
<title>Matching Variants vs Non-matching Stable Variants</title>
<p>We observe the following significant trends: as mentioned in the main text, for Potential Set 1 363 functional annotations reported significantly higher scores for the matching variants, with all BH-adjusted <italic>p</italic>-values less than 0.05. The remaining 15 annotations <italic>not</italic> exhibiting significantly higher scores are: Distance to Canonical TSS, CTCF Binding Enrichment, Enhancer Enrichment, Open Chromatin Enrichment, TF Binding Enrichment, Promoter Flanking Enrichment, CADD raw score, PHRED-normmalized CADD score, SIFTVal, mamPhyloP, verPhyloP, GerpS, LINSIGHT, ALoft, and FIRE.</p>
<p>For Potential Set 2, 359 functional annotations reported significantly higher scores for the matching variants (all BH-adjusted <italic>p</italic>-values &lt; 0.05), while only one functional annotation — Distance to Canonical TSS — reported significantly lower scores for the matching variants (BH-adjusted <italic>p</italic>-value = 8 × 10<sup>-4</sup>). For Potential Set 3, 259 functional annotations reported significantly higher scores for the matching variants (all BH-adjusted <italic>p</italic>-values &lt; 0.05), while only one functional annotation — Distance to Canonical TSS — reported significantly lower scores for the matching variants (BH-adjusted <italic>p</italic>-value = 8 × 10<sup>-4</sup>).</p>
</sec>
</sec>
<sec id="s5e">
<label>S5</label>
<title>Top Variant versus Stable Variant Results</title>
<p>As described in the main text, we compare, across all genes, the annotations of the top and the stable variant. We reported no significant differences in enrichment or trends in enrichment differences driven by moderators for Potential Set 1. For completeness, we report here significant results for all three potential sets.</p>
<sec id="s5e1">
<title>Paired analysis</title>
<p>After BH-adjustment, there are no significant differences across all three potential sets using a threshold of α = 0.05.</p>
</sec>
<sec id="s5e2">
<title>Trend analysis</title>
<p>For the following moderators, we observe some significant trends.
<list list-type="bullet">
<list-item><p>Inclusion of Distal Subpopulations (Top)</p>
<p>For Potential Set 3, FIRE scores exhibited a greater difference between stable and top variant scores (i.e., stable score — top score) for genes with top variants not discovered in YRI than those with top variants discovered in YRI (one-sided BH-adjusted <italic>p</italic> = 0.03). So did TSS-centered perturbation scores for 121 Enformer tracks and AVE perturbation scores for 121 Enformer tracks. (These tracks and their corresponding BH-adjusted <italic>p</italic>-values are available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/songlab-cal/StableFM/blob/master/data/results_with_moderators/p_values/mod_Top%20SNV%20Discovered%20in%20YRI.csv">https://github.com/songlab-cal/StableFM/blob/master/data/results_with_moderators/p_values/mod_Top%20SNV%20Discovered%20in%20YRI.csv</ext-link>.)</p></list-item>
<list-item><p>Posterior Probability of Top Variant</p>
<p>For all potential sets, there are small but significant positive correlations between the posterior probability of the top variant and the difference between the stable variant FIRE score and the top variant FIRE score (Potential Set 1: Pearson’s <italic>r</italic> = 0.05, BH-adjusted <italic>p</italic> = 3 × 10<sup>-5</sup>; Potential Set 2: Pearson’s <italic>r</italic> = 0.07, BH-adjusted <italic>p</italic> = 3 × 10<sup>-14</sup>; Potential Set 3: Pearson’s <italic>r</italic> = 0.05, BH-adjusted <italic>p</italic> = 1 × 10<sup>-7</sup>). For all potential sets, there are small but significant negative correlations between the posterior probability of the top variant and the difference between the stable variant Absolute Distance to TSS and the top variant Absolute Distance to TSS (Potential Set 1: Pearson’s <italic>r</italic> = −0.07, BH-adjusted <italic>p</italic> = 1 × 10<sup>-10</sup>; Potential Set 2: Pearson’s <italic>r</italic> = −0.05, BH-adjusted <italic>p</italic> = 9 × 10<sup>-7</sup>; Potential Set 3: Pearson’s <italic>r</italic> = −0.06, BH-adjusted <italic>p</italic> = 2 × 10<sup>-12</sup>). For Potential Set 2, there are significant negative correlations between the posterior probability of the top variant and the difference between the stable variant and top variant Percent GC (Pearson’s <italic>r</italic> = −0.04, BH-adjusted <italic>p</italic> = 5 × 10<sup>-5</sup>) and FATHMM-XF scores (Pearson’s <italic>r</italic> = −0.04, BH-adjusted <italic>p</italic> = 7 × 10<sup>-4</sup>). For Potential Set 3, there is a significant negative correlation between the posterior probability of the top variant and the difference between the stable variant and top variant FATHMM-XF scores (Pearson’s <italic>r</italic> = −0.04, BH-adjusted <italic>p</italic> = 2 × 10<sup>-5</sup>).</p></list-item>
</list></p>
</sec>
</sec>
<sec id="s5f">
<label>S6</label>
<title>Impact of Positive Posterior Probability Support on Results</title>
<p>One key consideration in statistical fine-mapping is the number of variants possessing positive posterior probability, which we refer to as the <italic>positive posterior probability support</italic> (or <italic>support</italic>, for short). Indeed, a larger support may indicate greater uncertainty in the assignment of causal variant to the allele with largest posterior probability. To evaluate the potential utility of the stability-guided approach in settings where the residualization approach leads to large support, we repeat our analysis on two restricted sets of genes, namely (1) those genes where the top variant has support greater than 10; or (2) those genes where the top variant has support greater than 50.</p>
<sec id="s5f1">
<title>Paired analysis</title>
<sec id="s5f1a">
<title>Gene Set (1)</title>
<p>For all Potential Sets, Distance to TSS is significantly smaller for top variant (all three BH-adjusted <italic>p</italic>-values &lt; 10<sup>-6</sup>). For Potential Set 3, FATHMM-XF score is significantly larger for stable variant (BH-adjusted <italic>p</italic> &lt; 10<sup>-6</sup>). For all Potential Sets, FIRE score is significantly larger for top variant (BH-adjusted <italic>p</italic>-values: Potential Set 1 = 0.02, Potential Set 2=2 × 10<sup>-10</sup>, Potential Set 3 = 1.7 × 10<sup>-4</sup>). <italic>Gene Set (2)</italic>. For all Potential Sets 2 and 3, FIRE score is significantly larger for top variant (both BH-adjusted <italic>p</italic>-values are 0.04).</p>
</sec>
</sec>
<sec id="s5f2">
<title>Trend analysis</title>
<sec id="s5f2a">
<title>Gene Set (1)</title>
<p>For the following moderators, we observe some significant trends.
<list list-type="bullet">
<list-item><p>Posterior Probability of Top Variant</p>
<p>For Potential Sets 2 and 3, there is a significant negative correlation between the posterior probability of the top variant and the difference between the stable variant FIRE score and the top variant FIRE score (Potential Set 2: Pearson’s <italic>r</italic> = 0.08, BH-adjusted <italic>p</italic> = 1.9 × 10<sup>-5</sup>; Potential Set 3: Pearson’s <italic>r</italic> = 0.06, BH-adjusted <italic>p</italic> = 0.003). For Potential Set 2, there is a significant positive correlation between the posterior probability of the top variant and the difference between the stable variant’s FATHMM-XF score and the top variant’s FATHMM-XF score (Pearson’s <italic>r</italic> = −0.06, BH-adjusted <italic>p</italic> = 0.01).</p></list-item>
</list></p>
</sec>
<sec id="s5f2b">
<title>Gene Set (2)</title>
<p>For the following moderators, we observe some significant trends.
<list list-type="bullet">
<list-item><p>Posterior Probability of Top Variant</p>
<p>For Potential Set 2, TSS-centered perturbation scores for 8 Enformer tracks exhibited a positive correlation between the posterior probability of the top variant and the difference between stable and top variant perturbation scores. Track names (with empirical Pearson’s r) are <monospace>ENCFF915DFR</monospace> (−0.40), <monospace>ENCFF107LDM</monospace> (−0.41), <monospace>ENCFF821PRO</monospace> (−0.42), <monospace>ENCFF171MDW</monospace> (−0.43), <monospace>ENCFF170NTY</monospace> (−0.43), <monospace>ENCFF935KTD</monospace> (−0.41), <monospace>ENCFF676GTP</monospace> (−0.41), <monospace>ENCFF013Z0I</monospace> (−0.42). Averaged perturbation scores for two Enformer tracks also exhibited negative correlation; these two tracks are <monospace>ENCFF107LDM</monospace> (−0.40) and <monospace>ENCFF170NTY</monospace> (−0.40). All BH-adjusted <italic>p</italic>-values are 0.0495.</p></list-item>
</list></p>
</sec>
</sec>
</sec>
<sec id="s5g">
<label>S7</label>
<title>Impact of Posterior Probability on Results</title>
<p>We perform a comparison between top and stable variants, by restricting to genes where the posterior probability of the top variant or the stable variant exceeds 0.9. Specifically, we repeat our analysis on two restricted sets of genes, namely (1) those genes where the top variant reported a posterior probability exceeding 0.9; or (2) those genes where the stable variant reported a posterior probability exceeding 0.9. For reference, we plot in <xref ref-type="fig" rid="figS2">Figure S2</xref> the joint distribution of posterior probabilities of top and stable variants, across all genes for which the two fine-mapping approaches returned distinct variants.</p>
<sec id="s5g1">
<title>Paired analysis</title>
<sec id="s5g1a">
<title>Gene Set (1)</title>
<p>For Potential Set 3, Distance to TSS is significantly smaller for stable variant (BH-adjusted <italic>p</italic> = 0.01). <italic>Gene Set (2)</italic>. For Potential Sets 1 and 2, FIRE scores of the top variant are significantly larger than the stable variant (BH-adjusted <italic>p</italic>-values: Potential Set 1 = 1 × 10<sup>-6</sup>, Potential Set 2 = 0.02). For Potential Set 2, Distance to TSS of the top variant is significantly smaller (BH-adjusted <italic>p</italic> = 3 × 10<sup>-4</sup>). For Potential Set 3, FATHMM-XF scores of the stable variant are significantly larger (BH-adjusted <italic>p</italic> = 0.006).</p>
</sec>
</sec>
<sec id="s5g2">
<title>Trend analysis</title>
<sec id="s5g2a">
<title>Gene Set (1)</title>
<p>For the following moderators, we observe some significant trends.
<list list-type="bullet">
<list-item><p>Inclusion of Distal Subpopulations (Top)</p>
<p>For Potential Set 3, TSS-centered perturbation scores for 9 Enformer tracks exhibited a higher difference between stable and top variant perturbation score for genes with top variants not discovered in YRI versus those discovered in YRI. Track names (with BH-adjusted unpaired Wilcoxon test <italic>p</italic>-values) are <monospace>ENCFF279CYY</monospace> (0.03), <monospace>ENCFF417WYL</monospace> (0.04), <monospace>ENCFF782WWH</monospace> (0.03), <monospace>ENCFF629RRF</monospace> (0.03), <monospace>ENCFF676GTP</monospace> (0.03), <monospace>ENCFF984HLU</monospace> (0.03), <monospace>ENCFF700YOH</monospace> (0.03), <monospace>ENCFF848LJL</monospace> (0.0477), <monospace>ENCFF038IYA</monospace> (0.03). Averaged perturbation scores for 10 Enformer tracks also a higher difference; these are <monospace>ENCFF776DPQ</monospace> (0.02), <monospace>ENCFF279CYY</monospace> (0.02), <monospace>ENCFF629RRF</monospace> (0.03), <monospace>ENCFF319YAI</monospace> (0.04), <monospace>ENCFF676GTP</monospace> (0.046), <monospace>ENCFF367WTF</monospace> (0.04), <monospace>ENCFF984HLU</monospace> (0.04), <monospace>ENCFF917YSR</monospace> (0.03), <monospace>ENCFF613CYH</monospace> (0.04) and <monospace>ENCFF700YOH</monospace> (0.04).</p></list-item>
</list></p>
</sec>
<sec id="s5g2b">
<title>Gene Set (2)</title>
<p>For the following moderators, we observe some significant trends.
<list list-type="bullet">
<list-item><p>Posterior Probability of Top Variant</p>
<p>For Potential Set 3, there is a significant negative correlation between the posterior probability of the top variant and the difference between the stable variant Distance to TSS and the top variant Distance to TSS (Pearson’s <italic>r</italic> = −0.09, BH-adjusted <italic>p</italic> = 0.004).</p></list-item>
</list></p>
</sec>
</sec>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="sc1"><mixed-citation publication-type="journal"><string-name><given-names>Ziga</given-names> <surname>Avsec</surname></string-name>, <string-name><given-names>Vikram</given-names> <surname>Agarwal</surname></string-name>, <string-name><given-names>Daniel</given-names> <surname>Visentin</surname></string-name>, <string-name><given-names>Joseph R</given-names> <surname>Ledsam</surname></string-name>, <string-name><given-names>Agnieszka</given-names> <surname>Grabska-Barwinska</surname></string-name>, <string-name><given-names>Kyle R</given-names> <surname>Taylor</surname></string-name>, <string-name><given-names>Yannis</given-names> <surname>Assael</surname></string-name>, <string-name><given-names>John</given-names> <surname>Jumper</surname></string-name>, <string-name><given-names>Pushmeet</given-names> <surname>Kohli</surname></string-name>, and <string-name><given-names>David R</given-names> <surname>Kelley</surname></string-name>. <article-title>Effective gene expression prediction from sequence by integrating long-range interactions</article-title>. <source>Nature Methods</source>, <volume>18</volume> (<issue>10</issue>):<fpage>1196</fpage>–<lpage>1203</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="sc2"><mixed-citation publication-type="other"><string-name><given-names>Alexander</given-names> <surname>Karollus</surname></string-name>, <string-name><given-names>Thomas</given-names> <surname>Mauermeier</surname></string-name>, and <string-name><given-names>Julien</given-names> <surname>Gagneur</surname></string-name>. <article-title>Current sequence-based models capture gene expression determinants in promoters but mostly ignore distal enhancers</article-title>. <source>bioRxiv</source>, <year>2022</year>.</mixed-citation></ref>
</ref-list>
<sec id="d1e3885">
<title>Supplementary Figures</title>
<fig id="figS1" position="float" orientation="portrait" fig-type="figure">
<label>Figure S1:</label>
<caption><p>Pair density plot of posterior probabilities of the top variant and the stable variant, in case they match.</p></caption>
<graphic xlink:href="536456v1_figS1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS2" position="float" orientation="portrait" fig-type="figure">
<label>Figure S2:</label>
<caption><p>Pair density plot of posterior probabilities of the top variant and the stable variant, in case they do not match.</p></caption>
<graphic xlink:href="536456v1_figS2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<fn-group>
<fn id="fn1"><label>1</label><p><ext-link ext-link-type="uri" xlink:href="https://www.ebi.ac.uk/biostudies/files/E-GEUV-1/E-GEUV-1/analysis_results/GeuvadisRNASeqAnalysisFiles_README.txt">https://www.ebi.ac.uk/biostudies/files/E-GEUV-1/E-GEUV-1/analysis_results/GeuvadisRNASeqAnalysisFiles_README.txt</ext-link></p></fn>
</fn-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88039.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Young</surname>
<given-names>Alexander</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of California, Los Angeles</institution>
</institution-wrap>
<city>Los Angeles</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This work is a <bold>valuable</bold> exploration of a new stability-guided fine-mapping method, which aims to identify causal genetic variations, by extending the previously proposed PICS method. While the results are empirically validated using functional annotations, their evaluation is <bold>incomplete</bold> and lacks extensive simulations where true causal variants are known. The approach to improving fine-mapping of causal variants presented will be of interest to geneticists and biomedical researchers using genetic data to guide their investigations.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88039.1.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Aw et al. have proposed that utilizing stability analysis can be useful for fine-mapping of cross populations. In addition, the authors have performed extensive analyses to understand the cases where the top eQTL and stable eQTL are the same or different via functional data.</p>
<p>Major comments:</p>
<p>1. It would be interesting to see how much fine-mapping stability can improve the fine-mapping results in cross-population. One can simulate data using true genotype data and quantify the amount the fine-mapping methods improve utilizing stability idea.</p>
<p>2. I would be very interested to see how other fine-mapping methods (FINEMAPE, SusiE, and CAVIAR) perform via the stability idea.</p>
<p>3. I am a little bit concerned about the PICS's assumption about one causal variant. The authors mentioned this assumption as one of their method limitations. However, given the utility of existing fine-mapping methods (FINEMAPE and SusiE), it is worth exploring this domain.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88039.1.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Aw et al presents a new stability-guided fine-mapping method by extending the previously proposed PICS method. They applied their stability-based method to fine-map cis-eQTLs in the GEUVADIS dataset and compared it against what they call residualization-based method. They evaluated the performance of the proposed method using publicly available functional annotations and claimed the variants identified by their proposed stability-based method are more enriched for these functional annotations.</p>
<p>While the reviewer acknowledges the contribution of the present work, there are a couple of major concerns as described below.</p>
<p>Major:</p>
<p>1. It is critical to evaluate the proposed method in simulation settings, where we know which variants are truly causal. While I acknowledge their empirical approach using the functional annotations, a more unbiased, comprehensive evaluation in simulations would be necessary to assess its performance against the existing methods.</p>
<p>2. Also, simulations would be required to assess how the method is sensitive to different parameters, e.g., LD threshold, resampling number, or number of potential sets.</p>
<p>3. Given the previous studies have identified multiple putative causal variants in both GWAS and eQTL, I think it's better to model multiple causal variants in any modern fine-mapping methods. At least, a simulation to assess its impact would be appreciated.</p>
<p>4. Relatedly, I wonder what fraction of non-matching variants are due to the lack of multiple causal variant modeling.</p>
<p>5. I wonder if you can combine the stability-based and the residualization-based approach, i.e., using the residualized phenotypes for the stability-based approach. Would that further improve the accuracy or not?</p>
<p>6. The authors state that confounding in cohorts with diverse ancestries poses potential difficulties in identifying the correct causal variants. However, I don't see that they directly address whether the stability approach is mitigating this. It is hard to say whether the stability approach is helping beyond what simpler post-hoc QC (e.g., thresholding) can do.</p>
<p>7. For non-matching variants, I wonder what the difference of posterior probabilities is between the stable and top variants in each method. If the difference is small, maybe it is due to noise rather than signal.</p>
<p>8. It's a bit surprising that you observed matching variants with (stable) posterior probability ~ 0 (SFig. 1). What are the interpretations for these variants? Do you observe functional enrichment even for low posterior probability matching variants?</p>
</body>
</sub-article>
</article>