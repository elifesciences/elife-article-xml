<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">106183</article-id>
<article-id pub-id-type="doi">10.7554/eLife.106183</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.106183.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Genetics and Genomics</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories><title-group>
<article-title>Integrating bulk and single cell RNA-seq refines transcriptomic profiles of individual <italic>C. elegans</italic> neurons</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Barrett</surname>
<given-names>Alec</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Varol</surname>
<given-names>Erdem</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Weinreb</surname>
<given-names>Alexis</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2227-1050</contrib-id>
<name>
<surname>Taylor</surname>
<given-names>Seth R</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>McWhirter</surname>
<given-names>Rebecca M</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Cros</surname>
<given-names>Cyril</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Vidal</surname>
<given-names>Berta</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Basaravaju</surname>
<given-names>Manasa</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Poff</surname>
<given-names>Abigail</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tipps</surname>
<given-names>John A</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Majeed</surname>
<given-names>Maryam</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wang</surname>
<given-names>Chen</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5254-9199</contrib-id>
<name>
<surname>Bayer</surname>
<given-names>Emily A</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Reilly</surname>
<given-names>Molly</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1977-0761</contrib-id>
<name>
<surname>Yemini</surname>
<given-names>Eviatar</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sun</surname>
<given-names>HaoSheng</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7634-2854</contrib-id>
<name>
<surname>Hobert</surname>
<given-names>Oliver</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a8">8</xref>
<email>or38@columbia.edu</email>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Miller</surname>
<given-names>David M</given-names>
<suffix>III</suffix></name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a8">8</xref>
<email>david.miller@vanderbilt.edu</email>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3068-068X</contrib-id>
<name>
<surname>Hammarlund</surname>
<given-names>Marc</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
<email>marc.hammarlund@yale.edu</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v76x132</institution-id><institution>Department of Genetics, Yale University School of Medicine</institution></institution-wrap>, <city>New Haven</city>, <country country="US">United States</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj8s172</institution-id><institution>Department of Statistics, Columbia University</institution></institution-wrap>, <city>New York</city>, <country country="US">United States</country></aff>
<aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/03v76x132</institution-id><institution>Department of Neuroscience, Yale University School of Medicine</institution></institution-wrap>, <city>New Haven</city>, <country country="US">United States</country></aff>
<aff id="a4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02vm5rt34</institution-id><institution>Department of Cell and Developmental Biology, Vanderbilt University School of Medicine</institution></institution-wrap>, <city>Nashville</city>, <country country="US">United States</country></aff>
<aff id="a5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj8s172</institution-id><institution>Department of Biological Sciences, Howard Hughes Medical Institute Columbia University</institution></institution-wrap>, <city>New York</city>, <country country="US">United States</country></aff>
<aff id="a6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/0464eyp60</institution-id><institution>Department of Neurobiology, University of Massachusetts Chan Medical School</institution></institution-wrap>, <city>Worcester</city>, <country country="US">United States</country></aff>
<aff id="a7"><label>7</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/008s83205</institution-id><institution>Department of Cell, Developmental, and Integrative Biology, University of Alabama Birmingham</institution></institution-wrap>, <city>Birmingham</city>, <country country="US">United States</country></aff>
<aff id="a8"><label>8</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02vm5rt34</institution-id><institution>Program in Neuroscience, Vanderbilt University School of Medicine</institution></institution-wrap>, <city>Nashville</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Portman</surname>
<given-names>Douglas</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/022kthw22</institution-id><institution>University of Rochester</institution>
</institution-wrap>
<city>Rochester</city>
<country country="US">United States</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Desplan</surname>
<given-names>Claude</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/0190ak572</institution-id><institution>New York University</institution>
</institution-wrap>
<city>New York</city>
<country country="US">United States</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-04-11">
<day>11</day>
<month>04</month>
<year>2025</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2026-01-05">
<day>05</day>
<month>01</month>
<year>2026</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP106183</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2025-02-03">
<day>03</day>
<month>02</month>
<year>2025</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2025-01-30">
<day>30</day>
<month>01</month>
<year>2025</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.04.05.487209"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2025-04-11">
<day>11</day>
<month>04</month>
<year>2025</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.106183.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.106183.1.sa3">eLife Assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.106183.1.sa2">Reviewer #1 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.106183.1.sa1">Reviewer #2 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.106183.1.sa0">Reviewer #3 (Public review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Barrett et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Barrett et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-106183-v2.pdf"/>
<abstract><p>Neuron-specific morphology and function are fundamentally tied to differences in gene expression across the nervous system. We previously generated a single cell RNA-seq (scRNA-Seq) dataset for every anatomical neuron class in the <italic>C. elegans</italic> hermaphrodite. Here we present a complementary set of bulk RNA-seq samples for 52 of the 118 canonical neuron classes in <italic>C. elegans</italic>. We show that the bulk RNA-seq dataset captures both lowly expressed and noncoding RNAs that are not detected in the scRNA-Seq profile, but also includes false positives due to contamination by other cell types. We present an analytical strategy that integrates the two datasets, preserving both the specificity of scRNA-Seq data and the sensitivity of bulk RNA-Seq. We show that this integrated dataset enhances the sensitivity and accuracy of transcript detection and differential gene analysis. In addition, we show that the bulk RNA-Seq data set detects differentially expressed non-coding RNAs across neuron types, including multiple families of non-polyadenylated transcripts. We propose that our approach provides a new strategy for interrogating gene expression by bridging the gap between bulk and single cell methodologies for transcriptomic studies. We suggest that these datasets advance the goal of delineating the mechanisms that define morphology and connectivity in the nervous system.</p>
</abstract>
<funding-group>
<award-group id="par-1">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/01cwqze88</institution-id>
<institution>NIH</institution>
</institution-wrap>
</funding-source>
<award-id>R01NS100547</award-id>
<principal-award-recipient>
<name>
<surname>Wang</surname>
<given-names>Chen</given-names>
</name>
<name>
<surname>Weinreb</surname>
<given-names>Alexis</given-names>
</name>
<name>
<surname>Hammarlund</surname>
<given-names>Marc</given-names>
</name>
<name>
<surname>Poff</surname>
<given-names>Abigail</given-names>
</name>
<name>
<surname>Yemini</surname>
<given-names>Eviatar</given-names>
</name>
<name>
<surname>Bayer</surname>
<given-names>Emily A</given-names>
</name>
<name>
<surname>Vidal</surname>
<given-names>Berta</given-names>
</name>
<name>
<surname>Tipps</surname>
<given-names>John A</given-names>
</name>
<name>
<surname>Taylor</surname>
<given-names>Seth R</given-names>
</name>
<name>
<surname>McWhirter</surname>
<given-names>Rebecca D</given-names>
</name>
<name>
<surname>Basaravaju</surname>
<given-names>Manasa</given-names>
</name>
<name>
<surname>Cros</surname>
<given-names>Cyril C</given-names>
</name>
<name>
<surname>Varol</surname>
<given-names>Erdem</given-names>
</name>
<name>
<surname>Sun</surname>
<given-names>HaoSheng</given-names>
</name>
<name>
<surname>Hobert</surname>
<given-names>Oliver</given-names>
</name>
<name>
<surname>Barrett</surname>
<given-names>Alec</given-names>
</name>
<name>
<surname>Majeed</surname>
<given-names>Maryam</given-names>
</name>
<name>
<surname>Miller</surname>
<given-names>David M</given-names>
</name>
</principal-award-recipient>
</award-group>
<award-group id="par-2">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/006w34k90</institution-id>
<institution>HHMI</institution>
</institution-wrap>
</funding-source>
<principal-award-recipient>
<name>
<surname>Hobert</surname>
<given-names>Oliver</given-names>
</name>
<name>
<surname>Vidal</surname>
<given-names>Berta</given-names>
</name>
<name>
<surname>Bayer</surname>
<given-names>Emily A</given-names>
</name>
<name>
<surname>Majeed</surname>
<given-names>Maryam</given-names>
</name>
<name>
<surname>Sun</surname>
<given-names>HaoSheng</given-names>
</name>
<name>
<surname>Cros</surname>
<given-names>Cyril C</given-names>
</name>
<name>
<surname>Reilly</surname>
<given-names>Molly B</given-names>
</name>
<name>
<surname>Yemini</surname>
<given-names>Eviatar</given-names>
</name>
<name>
<surname>Wang</surname>
<given-names>Chen</given-names>
</name>
</principal-award-recipient>
</award-group>
</funding-group>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>This version of the manuscript has been revised to address reviewer comments from our eLife submission. Additional analyses have been done, figures have been altered and merged, and the text has been rewritten.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Neurons exhibit an extraordinary range of morphological forms and physiological functions. Because this diversity is largely driven by underlying differences in gene expression, a key goal of neuroscience is to identify the transcripts expressed in each neuron type.</p>
<p>The adult <italic>C. elegans</italic> hermaphrodite contains 302 neurons divided into 118 anatomically distinct neuron types. The structure, connectivity, and lineage are known for each of these neurons (<xref ref-type="bibr" rid="c1">1</xref>–<xref ref-type="bibr" rid="c6">6</xref>). Recently, the <italic>C. elegans</italic> Neuronal Gene Expression Map &amp; Network project (CeNGEN) (<xref ref-type="bibr" rid="c7">7</xref>) used single cell RNA sequencing (scRNA-seq) technology to generate a gene expression atlas that matches the single neuron resolution of the structural map of the mature <italic>C. elegans</italic> nervous system (<xref ref-type="bibr" rid="c8">8</xref>).</p>
<p>The CeNGEN scRNA-seq dataset was acquired with 10x Genomics technology and is largely comprised of reads from poly-adenylated transcripts. Thus, major classes of non-poly-adenylated transcripts, especially noncoding RNAs, are under-represented in the CeNGEN scRNA-seq data. In addition, low abundance transcripts may be sparsely detected in scRNA-seq data, particularly in clusters with relatively few cells (<xref ref-type="bibr" rid="c8">8</xref>). Both noncoding RNAs and low abundance transcripts are potentially important mediators of neuronal fate. A description of their expression is therefore needed to complement the CeNGEN scRNA-seq map of neuronal poly-adenylated transcripts.</p>
<p>Here, we use FACS to isolate single neuron types for bulk RNA sequencing with the goal of describing neuronal gene expression with high sensitivity and specificity. We generated profiles for 53 individual neuron types from the mature <italic>C. elegans</italic> hermaphrodite nervous system. These 53 types include 52 of the canonical 118 types, with separate data for the subclasses ASEL and ASER. This data set samples a wide range of neuron types including motor neurons, interneurons, and sensory neurons. We built sequencing libraries with random primers for robust detection of both poly-adenylated and non-coding RNAs (<xref ref-type="bibr" rid="c9">9</xref>). We developed computational approaches that exploit the bulk dataset to enhance accurate detection of gene expression, including integration with the existing CeNGEN scRNA-seq dataset and methods for measuring non-coding RNAs. The resulting data sets refine quantitative measures of gene expression and improve detection of low-abundance and non-poly-adenylated transcripts. These data provide a unique opportunity for future studies that link gene expression to neuron function, structure, and connectivity.</p>
</sec>
<sec id="s2">
<title>Methods</title>
<sec id="s2a">
<title>Strains</title>
<p>Strains used for FACS isolation of individual neuron classes are listed in Table 1. Strains were either generated by us or are kind gifts of the <italic>C. elegans</italic> community. The lab origin of individual transgenic arrays can be inferred from the allele designation, as detailed at Lab List at the CGC (<ext-link ext-link-type="uri" xlink:href="https://cgc.umn.edu/laboratories">https://cgc.umn.edu/laboratories</ext-link>). All strains used in this study are available at the CGC.</p>
</sec>
<sec id="s2b">
<title>FACS isolation for RNA-seq</title>
<p>Labeled neuron types were isolated for RNA-seq as previously described (<xref ref-type="bibr" rid="c10">10</xref>–<xref ref-type="bibr" rid="c12">12</xref>). Populations of synchronized L1s were grown at 23 C until reaching the L4 stage on 150 mM 8P plates inoculated with Na22. The time in culture to reach the L4 stage varied (40.5-49 h) and was determined for each strain. 50-100 animals were inspected with a 40X DIC objective to determine developmental stage as scored by vulval morphology (Mok et al., 2025). Cultures were predominantly composed of L4 larvae but also typically included varying fractions of L3 larvae and adults.Cells were dissociated from a sample of ∼300 ul of packed L4 larvae and labeled neuron types isolated by Fluorescence Activated Cell Sorting (FACS) on a BD FACSAria III equipped with a 70-micron diameter nozzle. DAPI was added to the sample (final concentration of 1 mg/mL) to label dead and dying cells. For bulk RNA-sequencing of individual cell types, sorted cells were collected directly into TRIzol LS. At ∼15-minute intervals during the sort, the sort was paused, and the collection tube with TRIzol was inverted 3-4 times to ensure mixing. Cells in TRIzol LS were stored at -80C for RNA extractions. See <xref ref-type="supplementary-material" rid="supp1">Table S1</xref> for list of samples and associated metadata.</p>
</sec>
<sec id="s2c">
<title>RNA extraction</title>
<p>RNA extractions were performed as previously described (<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c12">12</xref>). Briefly, cell suspensions in TRIzol LS (stored at -80°C) were thawed at room temperature. Chloroform extraction was performed using Phase Lock Gel-Heavy tubes (Quantabio) according to the manufacturer’s protocol. The aqueous layer from the chloroform extraction was combined with an equal volume of 100% ethanol and transferred to a Zymo-Spin IC column (Zymo Research). Columns were centrifuged for 30 s at 16,000 RCF, washed with 400 mL of Zymo RNA Prep Buffer, and centrifuged for 16,000 RCF for 30 s. Columns were washed twice with Zymo RNA Wash Buffer (700 mL, centrifuged for 30 s, followed by 400 mL, centrifuged for 2 minutes). RNA was eluted by adding 15 mL of DNase/RNase-Free water to the column filter and centrifuging for 30 s. A 2 μL aliquot was submitted for analysis using the Agilent 2100 Bioanalyzer Picochip to estimate yield and RNA integrity, and the remainder was stored at -80°C. See <xref ref-type="supplementary-material" rid="supp1">Table S1</xref> for list of samples and associated metadata.</p>
</sec>
<sec id="s2d">
<title>Bulk sequencing and mapping</title>
<p>Each bulk RNA sample was processed for sequencing using the SoLo Ovation Ultra-Low Input RNaseq kit from Tecan Genomics according to manufacturer instruction, modified to optimize rRNA depletion for <italic>C. elegans</italic> (<xref ref-type="bibr" rid="c9">9</xref>). Libraries were sequenced on the Illumina Hiseq 2500 or Novaseq6000 with 150 bp paired end reads. Reads were mapped to the <italic>C. elegans</italic> reference genome from WormBase (version WS289) using STAR (version2.7.7a) with the option --outFilterMatchNminOverLread 0.3. Duplicate reads were removed using UMI-tools (v1.1.4), and a counts matrix was generated using the featureCounts tool of SubRead (v2.0.3). FASTQC was used for quality control before alignment, and four samples were removed for failing QC or for a low number of reads. Samples were excluded after sequencing and mapping if they had: fewer than 1 million read pairs, &lt;1% of uniquely mapping reads to the <italic>C. elegans</italic> genome, &gt; 50% duplicate reads (low UMI diversity), or failed deduplication steps in the nudup package.</p>
<p>Each biological sample contains one or more transgenes, and each transgene generally consists of many copies of a promoter sequence driving expression of a fluorophore (Table 1). To avoid artifacts stemming from spurious transcription of high-copy number transgenes, we masked 5kb of all genes whose promoters were used in transgenes, starting 4kb upstream of the start ATG and extending 1kb past the ATG. This approach removed 231 genes from our analysis (<xref ref-type="supplementary-material" rid="supp2">Table S2</xref>).</p>
</sec>
<sec id="s2e">
<title>Sample Normalization</title>
<p>Intra-sample normalization (gene length normalization for bulk samples) was performed before integration (see below). Inter-sample normalization (library size normalization) was performed after integration. Library size normalizations were performed using a TMM (trimmed mean of M-values) correction in edgeR (version 4.0.1).</p>
</sec>
<sec id="s2f">
<title>Ground-truth genes</title>
<p>As an independent measure of gene expression, we used a “ground truth” dataset of 160 genes for which expression in individual neuron types is known with high precision across the entire nervous system (<xref ref-type="supplementary-material" rid="supp3">Table S3</xref>). This expression matrix is based on high confidence fosmid fluorescent reporters, CRISPR strains or other methods (<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c13">13</xref>–<xref ref-type="bibr" rid="c17">17</xref>).</p>
<p>We also curated a list of 445 genes that are exclusively expressed outside the nervous system to assess potential non-neuronal contamination in each sample (<xref ref-type="supplementary-material" rid="supp4">Table S4</xref>). This list was curated from published datasets of fluorescent reporters, tissue specific RT-PCR, and transcriptomic studies available on WormBase (<xref ref-type="bibr" rid="c15">15</xref>). Genes were included if two types of evidence documented expression in the same non-neuronal tissue (non-identical expression in other tissues was allowed so long as at least one tissue overlapped), and for which there was no evidence for neuronal expression.</p>
<p>An additional 936 ubiquitously expressed genes were used to evaluate gene expression accuracy in the bulk RNA-Seq samples (<xref ref-type="supplementary-material" rid="supp5">Table S5</xref>). To compile this list, we used the scRNA-Seq data (<xref ref-type="bibr" rid="c11">11</xref>), and defined the expression level of a gene in a given cluster as the proportion of cells in that cluster in which at least one UMI was detected. We then defined a gene as ubiquitous if at least 10 clusters displayed an expression level of ≥0.5%, excluding neuron-specific genes.</p>
</sec>
<sec id="s2g">
<title>Comparing datasets to ground-truth</title>
<p>When comparing data to “ground truth” gene expression, a static threshold was applied to the average normalized cell profile (i.e., arithmetic mean across all cells, or samples). Single cells were normalized to library size prior to averaging to calculate TPM counts (<xref ref-type="bibr" rid="c18">18</xref>). Bulk samples were normalized with the TMM method using edgeR (version 4.0.1), noncoding RNA analysis was performed with length normalized TMM counts using the GeTMM method (<xref ref-type="bibr" rid="c19">19</xref>).</p>
</sec>
<sec id="s2h">
<title>LittleBites Subtraction algorithm</title>
<p>LittleBites is an iterative algorithm for bulk RNA-seq datasets. LittleBites improves the accuracy of cell-type specific bulk RNA-seq sample profiles by removing counts from non-target contaminants (e.g. ambient RNA from dead cells, carry-over non-target cells from FACS enrichment due to imperfect gating). This method leverages single cell reference datasets and ground truth expression information to guide iterative and conservative subtraction to enrich for true target cell-type expression. LittleBites optimizes subtraction by using both a single-cell reference and an orthogonal ground truth reference, moderating potential biases in either reference.</p>
<p>This algorithm first calculates gene level specificity weights in a single cell reference dataset using SPM (Specificity Preservation Method) (<xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c23">23</xref>). SPM assigns high weights (approaching 1) to genes expressed in single cell types while applying conservative weights to genes with broader expression patterns, which helps to reduce inappropriate subtraction.</p>
<p>The algorithm proceeds in a loop of three steps.</p>
<sec id="s2h1">
<title>Step 1: Estimate Contamination</title>
<p>Each bulk sample is modeled as the sum of a linear combination of single-cell profiles (target cell type and likely contaminants) using non-negative least squares (NNLS). The resulting coefficients provide an estimate of how many of the sample’s counts come from the target cell type, and how many come from each contaminant cell type.</p>
</sec>
<sec id="s2h2">
<title>Step 2: Weighted Subtraction</title>
<p>Each bulk sample is cleaned by subtracting the weighted sum of contaminant single-cell profiles. This subtraction is attempted multiple times (separately) across a series of learning rate weights (usually ranging from 0-1) which moderate the size of the subtraction step (<xref rid="eqn1" ref-type="disp-formula">Equation 1</xref>). This produces a range of possible “cleaned” sample options for evaluation.</p>
</sec>
<sec id="s2h3">
<title>Step 3: Performance Optimization</title>
<p>For each learning rate, the cleaned result is evaluated against a set of ground truth genes by calculating the area under the receiver operating characteristic curve (AUROC). The learning rate that optimizes the AUROC is then selected. When multiple learning rates yield equivalent AUROC values, the lowest learning rate value is chosen to minimize subtraction.</p>
</sec>
<sec id="s2h4">
<title>If the optimal learning rate at Step 3 is 0</title>
<p>(no subtraction option beats the baseline) then the loop is halted. Else, the cleaned bulk profile is returned to Step 1, and the loop continues until the AUROC cannot be improved upon using the single-cell reference modeling.
<disp-formula id="eqn1">
<graphic xlink:href="487209v3_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
B = bulk sample, A = estimated composition coefficient, S = Single cell reference, L = learning rate, i = sample, j = cell-type.</p>
</sec>
</sec>
<sec id="s2i">
<title>Subtraction</title>
<p>bMIND (<xref ref-type="bibr" rid="c20">20</xref>) was run by first excluding genes that are invariant in all cell types. Normalized aggregate tissue level scRNA-seq profiles for each cell type were used as the prior reference. Cell-type proportions were estimated using the NNLS option.</p>
<p>ENIGMA (<xref ref-type="bibr" rid="c21">21</xref>) was run by first excluding genes that are invariant in all cell types. Normalized aggregate tissue-replicate level scRNA-seq profiles for each cell-type were used as the reference, meaning that each tissue was represented in multiple columns, with different columns for each experimental replicate in the scRNA-seq dataset. Cell-type proportions were estimated using the robust linear regression (RLR) option. ENIGMA was run using the L2 norm, with a log transformation preprocessing step. Trace norm runs did not improve performance on ground truth gene detection (data not shown).</p>
<p>LittleBites (this work) was run by first calculating gene level specificity weights in a single cell reference dataset using the SPM method (<xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c23">23</xref>). The SPM method weights genes highly (values close to 1) only if they are present exclusively in one cell type, and the method is robust to different numbers of cell types. SPM specificity scores are conservative, and result in less subtraction for any gene that is expressed even in just a few cell types. The LittleBites algorithm runs in 4 steps: 1) Model each bulk sample as a linear combination of single cell reference profiles of target and putative contaminant tissues, using a non-negative least squares approach. The coefficients are used as estimates of the bulk sample composition. 2) Subtract the non-target single cell reference profiles from the bulk sample, using the modeled coefficients as weights for each corresponding profile (<xref rid="eqn1" ref-type="disp-formula">Equation 1</xref>). For each subtraction, set a range of learning rates from 0 to 1, and perform the subtraction for each learning rate supplied. 3) For each learning rate, compare the resulting subtracted values against known ground truth genes, and calculate the AUROC, and return the subtracted sample that maximizes the AUROC value. If more than one learning rate returns the same AUROC value, return the subtracted dataset with the lowest learning rate. 4) If there is no learning rate that produces a higher AUROC than a learning rate of 0, halt subtraction. Else, return to step 1 using the subtracted bulk sample as the input.</p>
<p>LittleBites (this work) was run using cell-type level aggregate data from the scRNA-seq dataset were as a reference, with just the neuron of interest (e.g. ADL) and putative non-neuronal comtaminants (e.g. muscle, intestine, germline) used to model each sample. Ground truth genes were taken from a list of ubiquitously expressed genes, and non-neuronal genes (see “Ground Truth Genes” methods second above). LittleBites was run with a log transformation preprocessing step for bulk and single cell references. LittleBites code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/alecbarrett/LittleBites">https://github.com/alecbarrett/LittleBites</ext-link>.</p>
</sec>
<sec id="s2j">
<title>Bulk sample composition estimates</title>
<p>Contamination estimates were performed for each bulk sample by using non-negative least squares (NNLS) modeling on down-sampled and log transformed counts, averaging across 100 estimates per sample. Down-sampling was performed to reduce bias against neuron types with small cluster sizes. For each bulk sample (ex: AFD replicate 1), proportions were estimated using only neuronal cells for the corresponding single cell cluster (ex: AFD), and 7 identified non-neuronal clusters (Glia, Excretory, Hypodermis, Intestine, Muscle-mesoderm, Pharynx, and Reproductive). For each iteration, all 8 single cell clusters were down-sampled to 30 cells each, and average TPM counts were calculated using the arithmetic mean for each gene in the 30 cells. Gene level variance was calculated using the averaged TPM values, and low variance genes were removed. Bulk sample counts and single cell TPMs were log transformed before the NNLS calculation with a pseudocount of one. NNLS estimates across all 100 iterations were averaged for the final estimate. NNLS calculations were performed using the nnls package in R (version 1.5).</p>
</sec>
<sec id="s2k">
<title>Correlating gene expression to non-neuronal contaminants</title>
<p>Each gene was correlated to non-neuronal contamination across all samples using Spearman’s correlation test. High correlation to any contaminant was used to indicate that the gene is likely detected because of contamination, and not due to expression in the target neuron. For genes passing an expression threshold &gt; 2 normalized counts in at least 2 samples, their highest correlation value to any contaminant tissue was collected, and cutoffs were determined by fitting a gaussian mixture model using the normalmixEM2comp function in mixtools (version 2.0.0), fitting 2 gaussian distributions to the distribution of highest contaminant correlations. Cutoffs were selected to exclude 95% of the predicted contaminant distribution.</p>
</sec>
<sec id="s2l">
<title>Defining new gene expression for lowly expressed genes and for noncoding genes</title>
<p>For protein coding genes that are under the detection threshold for specific single cell clusters, but are detectable elsewhere in the single cell dataset, we identified expanded gene expression profiles using the Integrated dataset. These genes were thresholded to match the FDR (14%) for the published single cell analysis (<xref ref-type="bibr" rid="c8">8</xref>). For protein coding genes that are never detected in the single cell dataset and for noncoding RNAs, genes with high correlation to non-neuronal contaminant estimates were removed, and for the remaining genes the threshold was set at 5 normalized counts, and genes were called expressed if they passed that threshold in &gt;65% of samples.</p>
</sec>
<sec id="s2m">
<title>Pseudobulk aggregation of single-cell data</title>
<p>We downloaded the CeNGEN scRNA-seq dataset as a Seurat object from the CeNGEN website (<ext-link ext-link-type="uri" xlink:href="https://www.cengen.org">www.cengen.org</ext-link>). Cells from the same cell type and experiment (e.g. AFD cluster) were aggregated together by summation into a single pseudobulk sample. For this work, single cell clusters of neuron subtypes were collapsed to the resolution of the bulk replicates (example: VB and VB1 clusters in the single cell data were treated as one VB cluster). Pseudobulk samples from cluster-replicates with fewer than 10 cells were excluded.</p>
</sec>
<sec id="s2n">
<title>Modeling Single Cell cluster proportions and counts</title>
<p>To simulate a single cell pseudobulk-cluster, we sampled from a negative binomial distribution for each gene using the rnbinom function from the stats package in R (Version 4.3.2). We then modeled the number of counts per gene as the sum of the log odds-ratio and the log of the total cells in the simulated cluster (<xref rid="eqn2" ref-type="disp-formula">equation 2</xref>). For a given cluster k and gene g, C<sub>k,g</sub> = total counts for the gene in the cluster, P<sub>k,g</sub> = proportion of cells with at least 1 count for a given gene, and n<sub>k</sub> = the total cells in the cluster
<disp-formula id="eqn2">
<graphic xlink:href="487209v3_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
We applied this formula to our real single cell dataset and used this equation to transform proportion measures of gene expression into a count space to generate the Prop2Count dataset for downstream analysis and integration with bulk datasets. This procedure allows for proportions data to be used in downstream analyses that work with counts datasets. However, it does limit the range of potential values that each gene can have, with the potential values set as:
<disp-formula id="disp-eqn-3">
<graphic xlink:href="487209v3_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
As n approaches 0, the number of potential values decreases, which can be incompatible with some downstream models. Thus, caution should be used when applying this transformation to datasets with few cells.</p>
<p>Prop2Count code is available at <ext-link ext-link-type="uri" xlink:href="https://github.com/alecbarrett/Prop2Count">https://github.com/alecbarrett/Prop2Count</ext-link>.</p>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Bulk sequencing of individual neuron types</title>
<p>The model organism <italic>C. elegans</italic> is uniquely suitable for the task of defining gene expression in the nervous system at high resolution and genome scale. <italic>C. elegans</italic> is the first metazoan with a completely sequenced genome (<xref ref-type="bibr" rid="c24">24</xref>) and the only animal for which we know every cell division that gives rise to the adult body plan (<italic>i.e.,</italic> “cell lineage”) (<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>), as well as the anatomy of each neuron and all of its connections with other cells (<xref ref-type="bibr" rid="c3">3</xref>–<xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c25">25</xref>). The entire <italic>C. elegans</italic> hermaphrodite nervous system contains 302 neurons with 118 canonical anatomically-defined neuron classes, each comprised of relatively few cells, ranging from 1 to 13 neurons (<xref ref-type="bibr" rid="c3">3</xref>). Most of these neuron classes are either a bilateral pair of anatomically similar cells (70 classes) or single neurons (26 classes) with unique morphological and functional characteristics. The rich array of distinct neuron classes in <italic>C. elegans,</italic> combined with the fact that these types are invariant among individuals, means that each neuron class can be analyzed in depth to reveal the genetic programs that define neuronal diversity.</p>
<p>We previously generated a gene expression atlas for the entire <italic>C. elegans</italic> nervous system at the resolution of single neuron types (<xref ref-type="bibr" rid="c8">8</xref>). We completed this atlas with single-cell techniques by adopting the strategy of using FACS to enrich for specific groups of neurons for a series of scRNA-seq experiments. The single-cell atlas provides a detailed description of gene expression across the <italic>C. elegans</italic> nervous system. However, the single-cell atlas may fail to detect lowly-expressed genes, particularly in clusters with few cells. Also, due to its reliance on poly-dT priming for reverse transcription, the single-cell atlas excludes non-coding transcripts that are not poly adenylated (<xref ref-type="bibr" rid="c11">11</xref>). Finally, because the scRNA-seq data is biased toward the 3’ ends of transcripts, it does not contain information about most splicing events (<xref ref-type="bibr" rid="c26">26</xref>, <xref ref-type="bibr" rid="c27">27</xref>).</p>
<p>To address these limitations and to provide a broader description of gene expression across the nervous system, we developed a bulk RNA sequencing strategy to profile individual neuron types (<xref ref-type="bibr" rid="c10">10</xref>). We hypothesized that bulk RNA-seq and scRNA-seq datasets might have complementary strengths and weaknesses. Bulk RNA-seq can enhance sequencing depth and gene detection, capture non-polyadenylated transcripts, and provide uniform coverage of the transcript body (<xref ref-type="bibr" rid="c9">9</xref>). However, bulk RNA-seq data are typically contaminated with transcripts from non-target cell types which can limit specificity for some genes. By contrast, scRNA-seq datasets allows for high specificity in gene detection, as contaminating cells can be identified post-hoc, but can show reduced transcript sensitivity, especially for low abundance cell types (<xref ref-type="bibr" rid="c8">8</xref>).</p>
<p>Our bulk sequencing strategy uses a series of <italic>C. elegans</italic> strains, each of which contains one or more fluorescent markers that label an individual neuron type for isolation by FACS. For example, we used <italic>flp-22</italic>::GFP and <italic>unc-47</italic>::mCherry, which together uniquely mark mark the single neuron AVL, for FACS (<xref rid="fig1" ref-type="fig">Fig. 1A</xref>). We selected strains based on the following criteria: 1) In the desired neuron type, the fluorophore(s) is expressed brightly enough to be clearly visible under a stereo scope. 2) The fluorophore, or combination of fluorophores, is uniquely expressed in the desired neuron type. These strains thus represent a rich resource for studying individual neuron types in <italic>C. elegans</italic>; all are deposited at the CGC (Table 1).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Single neuron bulk RNA-seq via targeted marker expression and FACS isolation.</title>
<p>A) Labeling, tissue dissociation, and FACS-enrichment schemes for capturing individual neuron types. Intersecting <italic>flp-22</italic>::GFP and <italic>unc-47</italic>::mCherry markers uniquely label AVL for isolation by FACS from dissociated L4 stage larval cells. RNA from this pool of AVL-enriched cells was used for bulk RNA sequencing (see Methods). B) PCA plot showing all bulk RNA-seq data labeled by cell type and colored according to functional modality; Sensory neurons (blue), motor neurons (green), interneurons (red), and CAN neurons (purple).</p></caption>
<graphic xlink:href="487209v3_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For each strain, we used FACS to isolate neurons from synchronized populations of hermaphrodites at the L4 stage, by which time all neurons have been born and are differentiated. Labeled cells were collected in TRIzol LS for RNA extraction. We isolated a wide range of cells (∼700 – 90,000) in each sample across neuron types. Multiple biological replicates (e.g., separately grown cultures that were then dissociated and sorted separately) were generated for each neuron class. In total, we sequenced 206 samples across 53 neuron types (<xref ref-type="supplementary-material" rid="supp1">Table S1</xref>). The 53 neurons that we profiled sample a wide range of anatomical locations (head ganglia, ventral cord, mid-body and tail neurons, pharyngeal neurons) functional modalities (sensory, inter- and motor neurons), neurotransmitter usage (glutamatergic, GABAergic, cholinergic, aminergic) and lineage history (<xref rid="figs1" ref-type="fig">Fig. S1A</xref>). A few of these bulk neuron profiles have been previously described (<xref ref-type="bibr" rid="c11">11</xref>).</p>
<p>We used a ribodepletion strategy combined with random priming for cDNA synthesis. This approach optimized whole transcript coverage for each gene and also captured non-polyadenylated RNAs (see Methods) (<xref ref-type="bibr" rid="c9">9</xref>). The resultant datasets comprise a high-resolution view of RNA expression across the <italic>C. elegans</italic> nervous system. A distribution of neuron-specific data sets for the first two principal components shows separation between sensory neurons (especially ciliated sensory neurons, e.g. ASK, ADL, AFD, AWA) vs motor and interneurons, a result consistent with patterns observed for scRNA-seq data on the same neuron classes (<xref rid="fig1" ref-type="fig">Fig. 1B</xref>) (<xref ref-type="bibr" rid="c8">8</xref>). The average bulk data for each neuron type also correlates with the single-cell data for that neuron type, with the exception of the OLL neuron, which is an outlier in the single cell dataset with few sampled cells, and may therefore be less accurate (<xref rid="figs1" ref-type="fig">Fig. S1B</xref>). Overall, these new bulk datasets enable new studies of neuronal gene expression in individual neuron types in <italic>C. elegans</italic>.</p>
</sec>
<sec id="s3b">
<title>A novel subtraction approach to clean bulk data using information from single-cell data</title>
<p>Our bulk datasets rely on FACS for enrichment of each specific neuron type. Although FACS-isolated cell populations are highly enriched for the target cell type, these samples are also typically contaminated with additional RNA from other cell types— either from errant cells or from ambient RNA in the cell suspension (<xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c29">29</xref>). To address this problem, we developed an approach, ‘LittleBites’, that uses pre-existing and reliable information on gene expression to remove contamination from bulk sample data.</p>
<p>LittleBites performs iterative linear subtraction on bulk RNA-Seq data using an scRNA-seq reference and a set of ground truth genes. In brief, LittleBites models each bulk sample as a mix of single cell expression profiles, estimates the cell-type proportions, and then subtracts the non-target profiles. The subtraction is compared to a set of ground truth genes, and repeated iteratively until no further improvements can be made (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>; see Methods). To evaluate the post-subtraction datasets we used the area under the Receiver-Operator Characteristic (AUROC) score. In brief, we set a wide range of thresholds to call genes expressed or unexpressed. For each threshold within that range, we compared the resulting gene expression calls to expected expression from a set of ground truth genes. This comparison produces a true positive rate (TPR, the percentage of truly expressed genes that are called expressed), a false positive rate (FPR, the percentage of truly not expressed genes that are called expressed), and a false discovery rate (FDR, the percentage of genes called expressed that are truly not expressed) for each threshold. The Receiver-Operator Characteristic (ROC) is the graph of the line produced by the TPR and FPR values across the range of thresholds tested, and the AUROC is calculated as the sum of the area under that line. A “random” model of gene expression is expected to have an AUROC value of 0.5, and a “perfect” model is expected to have an AUROC value of 1. Thus, AUROCs below 0.5 are worse than a random guess, and values closer to 1 indicate higher accuracy.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Identifying and removing contamination from bulk data with LittleBites.</title>
<p>A) Schematic representation of the LittleBites algorithm. Each iteration of the LittleBites algorithm contains 3 steps: 1) Use an NNLS regression to estimate the cell-type proportions of each bulk sample with aggregated single cell data as a reference. 2) Subtract the estimated contamination profiles, constrained by the proportion estimates, a gene level specificity weight, and a variable learning rate. 3) Compare the result of every tested learning rate against ground truth, and select the learning rate with the highest area under the receiver operator characteristic (AUROC). This loop repeats until further subtraction cannot improve the AUROC. B) Line plots of the receiver operator characteristic (ROC) curve for the unaltered bulk data and corrected datasets, as well as bMIND and ENIGMA analyses, assessed against ubiquitous genes and genes exclusively expressed in non-neuronal cells. C) Line plots of the ROC for the unaltered bulk data and corrected datasets, as well as bMIND and ENIGMA analyses, assessed against 160 genes expressed within the nervous system. D) Violin plot of AUROC values for bulk samples after LittleBites cleaning using a random subset of target cells in the single cell reference. X-axis indicates the number of target cells used in the reference. Each subsampling rate was run 500 times. e.g. for a VB sample, it was modeled using 10, 50, 100, or 500 VB neurons in the reference. E) Violin plot of the average coefficient of variation (CV) per gene after LittleBites cleanup. The Y-axis indicates the average CV across all genes in a single sample, and the the X-axis indicates the number of target cells used in the single-cell reference.</p></caption>
<graphic xlink:href="487209v3_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For example, the bulk VB sample VBr31 had an initial composition estimate of: 21% neuronal, 0% excretory, 7% glia, 11% hypodermis, 17% intestine, 5% pharynx, 5% muscle, and 33% reproductive, and its AUROC for ubiquitous and non-neuronal testing genes was 0.87. After LittleBites subtraction, the composition estimates were: 97% neuronal, 0% excretory, 0% glia, 0% hypodermis, 0% intestine, &lt;1% pharynx, 2% muscle, and &lt;1% reproductive, and the AUROC score for the testing gene set increased to 0.92. On average, the neuronal estimate for each sample increased 2.8-fold, and the testing gene AUROC increased by 0.064 (7.7% increase in mean AUROC).</p>
<p>To assess the performance of LittleBites on our bulk data, we compared it to two recently described tools designed to extract cell-type specific expression from bulk RNA-Seq data sets. bMIND uses a Bayesian approach to model cell type-specific expression profiles with a pre-calculated proportion matrix, leveraging averaged single cell profiles for each cell type as an informative prior for a gaussian distribution, estimating parameters using a Markov Chain Monte Carlo (MCMC) (<xref ref-type="bibr" rid="c30">30</xref>). ENIGMA uses a regularized matrix completion approach (using either an L2 regularization or a Trace Norm regularization to estimate a low matrix rank constraint) to estimate expression profiles for each sample (<xref ref-type="bibr" rid="c21">21</xref>).</p>
<p>Two types of ground truth genes were used for assessment. 1) We used a set of 160 ground truth genes with individual cell-type resolution in the nervous system so that we could also assess how well each technique can distinguish signals expressed in some, but not all, neurons (see Methods; <xref ref-type="supplementary-material" rid="supp3">Table S3</xref>). 2) We used negative ground truth genes that are expressed exclusively outside of the nervous system (‘non-neuronal’), paired with positive ground truth genes that are expressed in all neuron types (‘ubiquitous’), to assess each method’s ability to accurately remove non-neuronal counts without removing genes expressed in all neuron types (see Methods; <xref ref-type="supplementary-material" rid="supp4">Table S4</xref> and S5). LittleBites was run with a testing subset of ubiquitous and non-neuronal genes as a ground truth comparison in the algorithm, and all assessments between methods were performed using a reserved set of testing genes.</p>
<p>We assessed the performance of LittleBites, ENIGMA, and bMIND against these ground truth genes using the AUROC for the average resulting bulk profiles as the primary metric (<xref rid="fig2" ref-type="fig">Fig. 2B,C</xref>; <xref rid="figs2" ref-type="fig">S2A,B</xref>). We found that LittleBites improved the ubiquitous and non-neuronal AUROC by 7.0%, ENIGMA improved the neuronal AUROC by 6.89%, and bMIND improved the AUROC by 3.2% (p &lt; 0.0001). Further, LittleBites improved the neuronal AUROC by 7.5%, while ENIGMA and bMIND had a lesser effect. LittleBites is the only method that uses ground truth genes to guide cleanup, and we observed that training and testing gene splits have similar AUROC improvement, suggesting that LittleBites is not overfitting to the training genes (<xref rid="figs2" ref-type="fig">Fig. S2C</xref>). Comparing results on all individual RNA samples showed consistent improvements across samples from LittleBites (<xref rid="figs2" ref-type="fig">Fig. S2D,E</xref>). After LittleBites cleanup, all samples have higher AUROC scores for ubiquitous and non-neuronal testing genes, and all but one sample have higher AUROC scores for the neuronal testing genes compared to unaltered bulk samples. ENIGMA cleanup improves ubiquitous and non-neuronal AUROC for all samples but has little effect on neuronal AUROC for each sample. bMIND improves ubiquitous and non-neuronal AUROC for most samples, but some samples show little effect, and bMIND has a mixed effect on neuronal AUROC, improving some samples while reducing the score for others. We conclude that, for cases where robust ground truth data are available, LittleBites improves the accuracy of cell type expression data in bulk RNA samples.</p>
<p>To test the stability of LittleBites cleanup across different single-cell reference dataset qualities, we ran the algorithm on a set of bulk samples by first subsetting the corresponding single-cell cluster’s population to 10, 50, 100, or 500 cells. We performed this process 500 times for each subsampling rate for each sample (2000 total runs per sample). We found that testing gene AUROC values are stable across reference cluster sizes (<xref rid="fig2" ref-type="fig">Fig. 2D</xref>), suggesting that even if the target cell type is rarely represented in a single cell reference, accurate cleaning is still possible. However, comparing gene level stability across target cluster population levels reveals that low abundance references have higher gene level variance (<xref rid="fig2" ref-type="fig">Fig. 2E</xref>), lower purity estimates (<xref rid="figs2" ref-type="fig">Fig. S2F</xref>), higher variance in the mean expression across genes (<xref rid="figs2" ref-type="fig">Fig. S2G</xref>), and they tend to have lower overall expression (suggesting more aggressive subtraction) (<xref rid="figs2" ref-type="fig">Fig. S2H</xref>). This indicates that while binary gene calling is improved even if the reference cluster is small, users should be cautious when using fewer than 100 cells in their single cell reference cluster as the resulting cleanup is less stable.</p>
</sec>
<sec id="s3c">
<title>A model for the relationship between gene counts and proportions in pseudobulk single-cell RNAseq data</title>
<p>To integrate our previous scRNAseq data (<xref ref-type="bibr" rid="c11">11</xref>) with our bulk data, we first considered how to analyze the single cell data in each cluster. Gene expression in single cell data can be measured in two ways: as <italic>counts,</italic> averaging or aggregating across all cells in each cluster, or as <italic>proportions,</italic> assessing the proportion of cells in the cluster that detect the gene (<xref rid="fig3" ref-type="fig">Fig. 3A</xref>) (<xref ref-type="bibr" rid="c31">31</xref>–<xref ref-type="bibr" rid="c33">33</xref>). Comparing these two measurement systems against a set of ground truth genes in the <italic>C. elegans</italic> nervous system, we found that using the proportion yields a more accurate measurement of gene expression than the alternative of relying on counts (<xref rid="fig3" ref-type="fig">Fig. 3B</xref>) (<xref ref-type="bibr" rid="c11">11</xref>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><title>A model for the relationship between cell proportions and gene counts in sc-RNAseq data.</title>
<p>A) Aggregate count and proportion measures of scRNA-seq data. UMAP representations of AFD neurons captured in the scRNA-seq dataset (<xref ref-type="bibr" rid="c11">11</xref>). A) Left, log scale representation of <italic>ttx-1</italic> counts in all AFD neurons. Right, binarized representation of <italic>ttx-1</italic> expression in all AFD neurons. B) ROC for <italic>C. elegans</italic> neuronal ground-truth genes in scRNA-seq counts and proportions. The teal line indicates the proportion of non-zero cells, and the red line indicates the normalized counts. C) Scatter plot of fitted log-counts for simulated data, with log-counts on the Y-axis, and the sum of the log likelihood ratio of the proportion of non-zero cells and the log of the number of cells in the cluster on the X-axis. Red line indicates Y = X. D) Scatter plot of fitted log-counts for one SIA neuron replicate from the <italic>C. elegans</italic> neuronal scRNA-seq dataset (<xref ref-type="bibr" rid="c11">11</xref>), with log-counts on the Y-axis, and the sum of the log likelihood ratio of the proportion of non-zero cells and the log of the number of cells in the cluster on the X-axis. Red line indicates Y = X.</p></caption>
<graphic xlink:href="487209v3_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To exploit the improved accuracy that proportion measures provide, we aimed to transform these proportion values into units of counts for comparison to our bulk data. Building on previous work (<xref ref-type="bibr" rid="c32">32</xref>), we simulated a single cell dataset, using a negative binomial distribution to model counts for individual cells in a cluster. We found that this simulated dataset could be well-modeled using the log-likelihood ratio (logit) of the non-zero proportion of cells, scaled by the total number of cells in the dataset (<xref rid="fig3" ref-type="fig">Fig. 3C</xref>). Using our real dataset, we observed a similar fit, with the exception that some genes with low non-zero proportions values showed very high counts (<xref rid="fig3" ref-type="fig">Fig. 3D</xref>). These exceptions may be caused by high ambient RNA background in some droplets, misassigned cells in the clustering step, doublets that escaped early filtering steps, or rare bursts of expression for lowly expressed genes. The presence of these outliers suggests why the non-zero proportion value may be a more robust measure for gene expression in single-cell clusters than counts: it may be more resistant to rare occurrences of contaminating information.</p>
<p>We used the logit model to generate a denoised counts estimate for each single cell cluster, which we call the scProp2Count dataset. As a final test, we compared the accuracy of the scProp2Count dataset to a standard approach using counts on pseudobulk data, performing pairwise differential expression analysis using edgeR, and then comparing the differentially expressed genes to ground truth expression patterns. We found that the scProp2Count dataset slightly outperforms standard single-cell counts in detection sensitivity and correlation to ground truth, while matching the single-cell counts in precision (<xref rid="figs3" ref-type="fig">Fig. S3</xref>). However, caution should be taken when using this approach in scRNAseq cases where all replicates of a cell type contain few cells. scProp2Count values are limited to the space of possible proportion values, and so replicates with low numbers of cells will have fewer potential expression “levels” which may break some model assumptions in downstream applications (see Methods).</p>
</sec>
<sec id="s3d">
<title>Integrating bulk and single-cell data improves gene detection accuracy</title>
<p>To integrate the bulk and single-cell data sets, for each neuron type in the bulk data set (Table 1) we computed the arithmetic mean of normalized gene counts across all biological replicates (‘Bulk’ dataset). Next, we integrated the Bulk data set with the scProps2Counts dataset by taking the geometric mean for each gene. The result of this analysis was three data sets, each containing normalized gene count data for <italic>C. elegans</italic> neuron classes: Bulk, scProps2Counts, and Integrated. Finally, for each of these three data sets we thresholded the gene counts to call every gene as either expressed or not expressed in each cell type. For this purpose, a single threshold was used for each data set, consisting of the average gene count value for all cells and all genes in each data set. Genes with count values above this threshold were defined as expressed.</p>
<p>To assess whether integration improved the accuracy of expression, we compared expression calls to ground-truth data for both individual neuron types and non-neuronal cell types (see Methods; <xref ref-type="supplementary-material" rid="supp3">Table S3</xref>,4,5) (<xref ref-type="bibr" rid="c8">8</xref>). We found that the Integrated dataset generally outperforms the LittleBites-processed Bulk and scProps2Counts scRNA datasets (<xref rid="fig4" ref-type="fig">Fig. 4</xref>). Like the LittleBites-processed Bulk dataset, the Integrated dataset approaches a True Positive Rate (TPR) of 100% at relatively low precision (or high FPR), whereas the scProp2Count scRNA dataset has a maximum TPR of 91.9%. The Integrated dataset improves the overall AUROC value by 3.8% compared to the scProp2Count scRNA data, and 2.4% compared to the LittleBites-processed Bulk data (P &lt; 0.0001) (<xref rid="fig4" ref-type="fig">Fig. 4A,B</xref>). Like the scProp2Count scRNA dataset, the Integrated dataset has a relatively low False Positive Rate (FPR) for neuronal ground truth genes (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>). At a false discovery rate (FDR) of 5%, the Integrated dataset shows substantially better sensitivity than the LittleBites-cleaned Bulk and scProps2Counts scRNA datasets (<xref rid="fig4" ref-type="fig">Fig. 4D</xref>). At the level of individual ground truth homeobox and neurotransmitter genes expressed in neurons (<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c35">35</xref>), specific and broad improvements can be seen across the Integrated dataset, compared to all other dataset versions (<xref rid="figs4" ref-type="fig">Fig. S4A,B</xref>).</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><title>Integrating bulk RNA-seq and scRNA-seq data sets improves gene detection accuracy.</title>
<p>A) Receiver Operator Characteristic (ROC) curve for bulk, single-cell, and integrated datasets compared to neuronal ground-truth genes. The x-axis shows the False Positive Rate (FPR), and the y-axis shows the true positive rate (TPR). B) Area under the receiver operator characteristic (AUROC). Error bars represent bootstrap 95% confidence intervals of the AUROC value. Pairwise statistical testing was performed using the deLong method for AUROC scores. *** = p &lt; 0.0001. C) Precision-Recall (PR) curve for bulk, single-cell, and integrated datasets compared to neuronal ground-truth genes. The x-axis shows the Precision (1 – False Discovery Rate/FDR), and the y-axis shows the TPR (Recall). D) Boxplot of bootstrapped sensitivity scores for each dataset at a 5% FDR cutoff. E) Bar chart of the number of genes detected at the medium threshold (FDR = 0.14) for the integrated dataset (red) and the dynamic proportions single cell dataset (blue). Bars are ordered by the number of cells in the corresponding single cell cluster from lowest to highest. F,G) Bar plots of significant terms in Tissue enrichment analyses for genes detected only in the single-cell and integrated datasets in ADL neurons. Dynamic thresholding was used for single cell data, and medium thresholds were used to binarize both datasets.</p></caption>
<graphic xlink:href="487209v3_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In addition to using ground truth genes to assess the accuracy of the Integrated dataset, we also evaluated gene expression differences with the original sc-RNAseq dataset (<xref ref-type="bibr" rid="c11">11</xref>). We thresholded (see Methods) both datasets and determined that the integration strategy results in fewer expressed genes—for some neuron types, over 1,000 fewer genes (<xref rid="fig4" ref-type="fig">Fig. 4E</xref>). To further investigate the difference between the Integrated dataset and the original sc-RNAseq dataset, we examined the ‘unique’ genes for each neuron type: i.e., genes called expressed in that neuron type in one dataset but not the other.</p>
<p>We analyzed these ‘unique’ genes using Tissue Enrichment Analysis and Gene Ontology (GO) for two representative neuron types, ADL and VB, both of which are well-represented in the sc-RNAseq dataset (<xref ref-type="bibr" rid="c11">11</xref>). Importantly, Tissue Enrichment Analysis maps genes to specific <italic>C. elegans</italic> cell types. We found that overall, contamination by other cell types was much lower in the Integrated dataset. Further, the ‘unique’ genes in the sc-RNAseq dataset were more enriched in non-neuronal cell types, such as germline, and for non-neuronal GO terms. By contrast, the ‘unique’ genes in the Integrated dataset were more enriched for other neuronal cell types and neuronal functions (<xref rid="fig4" ref-type="fig">Fig. 4F,G</xref>, <xref rid="figs4" ref-type="fig">S4C</xref>). Testing against a curated list of non-neuronal genes from fluorescent reporters and genomic enrichment studies, we found that of 445 non-neuronal markers, each gene was detected in an average of 12.5 cells or a median of 3 cells in the single-cell dataset, and an average of 8.7 cells or a median of 1 cell in the integrated dataset, at a 14% FDR threshold. Thus, integration appears to successfully remove most contaminating transcripts.</p>
<p>Together, these results show that geometric mean integration of bulk RNA-seq and scRNA-seq datasets combines the strengths of both approaches, providing high sensitivity (bulk RNA-Seq) and high specificity (scRNA-Seq) across a wide range of thresholds. For most purposes, we propose that the Integrated dataset will give the best results. However, for certain applications (such as genes not detected in scRNA-seq data, or non-polyadenylated transcripts, see below) other approaches are needed. To make the Integrated data easily accessible to the community, we provide tables of gene expression for each neuron type based on the Integrated data set, both the values for all genes (<xref ref-type="supplementary-material" rid="supp6">Table S6</xref>) and values binarized at four thresholds (Tables S7-10).</p>
</sec>
<sec id="s3e">
<title>Bulk RNA-seq reveals both broadly expressed and neuron-specific noncoding RNAs</title>
<p>A significant benefit of our bulk RNA-seq approach is its sensitivity to non-poly-adenylated transcripts, which include many species of non-coding RNA (<xref ref-type="bibr" rid="c9">9</xref>). However, similar to coding genes not found in the scRNA-seq dataset (see above), the scRNA-seq dataset is largely uninformative about these transcripts. Further, we do not have a ground-truth data set of non-coding genes to evaluate accuracy of expression calling for these transcripts. Finally, most non-coding RNAs are expressed at lower levels than protein coding genes (<xref rid="figs5" ref-type="fig">Fig. S5A</xref>). We therefore applied a generous, uniform threshold for calling gene expression, consisting of &gt; 5 normalized counts in 2/3 or more of the samples within a cell type. As we did for our analysis of coding genes not found in scRNA-seq, we used gene level correlation to contamination estimates as a procedure to eliminate non-coding genes that were likely detected due to contamination from other tissues in the bulk samples. First, we estimated contamination for each sample using a bootstrapped NNLS regression (<xref rid="figs5" ref-type="fig">Fig. S5B</xref>; see Methods), and then calculated per-gene Spearman correlations to each contaminant type. We applied a threshold on the gene level correlation to contamination estimates for each sample by fitting a Gaussian mixture model to the maximum correlation score for each gene. We selected a cutoff of 0.23, which excludes 98% of the estimated contamination distribution (<xref rid="figs5" ref-type="fig">Fig. S5B</xref>). With these thresholds, an average of 512 noncoding RNAs were identified as “expressed” per cell type (95 CI ± 40.6) (<xref ref-type="supplementary-material" rid="supp11">Table S11</xref>). By RNA type, we detected 16.2 ± 1.2 lincRNAs, 39.0 ± 5.3 pseudogenes, 54.8 ± 9.7 tRNAs, 41.8 ± 2.0 snRNAs, 131.5 ± 1.8 snoRNAs, and 228.9 ± 29.0 uncategorized ncRNAs per cell type (<xref ref-type="supplementary-material" rid="supp12">Table S12</xref>).</p>
<p>Next, we sought to identify noncoding RNAs with broad expression across multiple neuron types. We defined broad expression as genes expressed in &gt; 80% of neuron classes in our dataset (<xref rid="figs5" ref-type="fig">Fig. S5C</xref>). This approach defined 247 non-coding genes as broadly expressed, or “pan-neuronal”. These pan-neuronal noncoding RNAs include 108 (43.8%) snoRNAs and 33 (13.4%) snRNAs, both tenfold greater than the expected proportion assuming a random distribution (Fisher’s exact test, P-value &lt; 0.01) (<xref rid="fig5" ref-type="fig">Fig. 5A</xref>). By contrast, pseudogenes and otherwise uncategorized ncRNAs were significantly depleted from the list of pan-neuronal noncoding RNAs (P-value &lt; 0.001). These results indicate that snoRNAs and snRNAs are widely expressed, which matches studies showing broad expression of many snoRNAs and snRNAs in other systems (<xref ref-type="bibr" rid="c39">39</xref>, <xref ref-type="bibr" rid="c40">40</xref>), and is consistent with their key roles in rRNA processing and splicing (<xref ref-type="bibr" rid="c41">41</xref>–<xref ref-type="bibr" rid="c43">43</xref>).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><title>Bulk analysis reveals noncoding RNA expression patterns.</title>
<p>A) Proportions of classes of pan-neuronal noncoding RNAs. B) Proportions of classes of cell type specific noncoding RNAs C) Heatmap of average normalized counts per cell type for ncRNA genes considered cell type specific, rows are grouped by RNA class. Note that genes within individual neuron types are clustered by expression patterns, not similar gene function. D) Number of GPCR pseudogenes with specific expression per neuron type, grouped by neuron function. E) Number of GPCR genes per neuron type, grouped by neuron function.</p></caption>
<graphic xlink:href="487209v3_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We also sought to identify neuron-type-specific noncoding RNAs. We calculated tissue specificity scores for each noncoding RNA called expressed in at least one neuron type using the Preferential Expression Measure (PEM) score (<xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c44">44</xref>). We called these genes neuron-type specific according to three criteria: (<xref ref-type="bibr" rid="c1">1</xref>) Called expressed in ≥ one neuron type (see above); (<xref ref-type="bibr" rid="c2">2</xref>) PEM score &gt; 0.65; (<xref ref-type="bibr" rid="c3">3</xref>) &gt; 2 normalized counts in a maximum of 10/53 neuron types. Using these thresholds, we identified 523 cell-type-specific noncoding RNAs (<xref rid="fig5" ref-type="fig">Fig. 5B</xref>). By RNA type, 293 (56.0%) of cell type-specific noncoding RNA genes are uncategorized ncRNAs, 93 (17.8%) are general pseudogenes 112 (21.4%) are GPCR pseudogenes, 14 (2.7%) are tRNAs, 10 (1.9%) are lincRNAs, 1 (0.2%) is a snoRNA, and none are snRNAs. We observed significant enrichment of pseudogenes, and a small but significant depletion of ncRNAs, snoRNAs, and tRNAs (P-value &lt; 0.01). Clustering by genes and cell type modalities revealed clear enrichment for specific noncoding RNAs in individual neuron types (<xref rid="fig5" ref-type="fig">Fig. 5C</xref>), although the overall proportions of noncoding RNA types were similar between individual neuron classes (<xref rid="figs5" ref-type="fig">Fig. S5D</xref>). The number of specific noncoding RNAs per cell type ranged from 0 (PVC) to 139 (ADL), with a mean of 10.2 (± 5.8).</p>
<p>Interestingly, we observed that in ADL—the neuron that expresses the highest number of specific ncRNAs—many of these specific ncRNAs are GPCR pseudogenes (<xref rid="fig5" ref-type="fig">Fig. 5C,D</xref>, <xref ref-type="supplementary-material" rid="supp13">Table S13</xref>). ADL also expresses the highest number of bona fide GPCRs among neurons in our dataset (<xref rid="fig5" ref-type="fig">Fig. 5E</xref>, <xref ref-type="supplementary-material" rid="supp14">Table S14</xref>). Looking across neuron types, we observe a rough correspondence between expression of specific GPCR pseudogenes and expression of bona fide GPCRs (<xref rid="fig5" ref-type="fig">Fig. 5D,E</xref>). This analysis suggests that pseudogenes retain their regulatory information, despite losing their coding potential. Overall, our data on expression of non-coding genes reveal a wide diversity of noncoding RNA expression across the nervous system and open the door to in depth studies of noncoding RNA contributions to individual neuron function.</p>
</sec>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>In this work, we present bulk RNA-seq data for 53 neuron classes in the <italic>C. elegans</italic> nervous system. We describe new methods for integrating these bulk RNA-seq data with previously obtained single-cell RNA-seq data (<xref ref-type="bibr" rid="c11">11</xref>). We find that this approach improves gene detection accuracy in comparison to each individual data set. We use the bulk data sets to detect two important classes of genes that were underrepresented in the previous single-cell atlas: (<xref ref-type="bibr" rid="c1">1</xref>) lowly expressed genes, and (<xref ref-type="bibr" rid="c2">2</xref>) non-poly-adenylated transcripts, chiefly non-coding RNAs. Overall, our results provide a rich resource for studies of gene expression in the <italic>C. elegans</italic> nervous system.</p>
<p>The rapid growth of scRNA-seq and bulk RNA-seq datasets create opportunities to combine these two data types to address diverse goals. For example, recent studies have combined data from bulk RNA sequencing and scRNA-seq to address the problem of deconvolution. The goal of deconvolution is to infer cell-type expression profiles from tissue level bulk samples, using scRNA-seq references as a guide (<xref ref-type="bibr" rid="c30">30</xref>, <xref ref-type="bibr" rid="c45">45</xref>–<xref ref-type="bibr" rid="c47">47</xref>). In this study we combine these two types of data, both collected from the <italic>C. elegans</italic> nervous system, for a different purpose: to improve the accuracy of cell and tissue-specific transcriptional profiles. We developed three approaches: a subtraction approach, LittleBites, that uses information from scRNA-seq data, combined with ground truth gene expression data, to identify and remove contaminating counts from bulk RNAseq data; Prop2Count, that expands on the theoretical link between gene expression and single-cell dropout rates to provide a denoising approach for pseudobulk scRNA-seq; and an integration approach that directly combines information from bulk and single-cell approaches to improve sensitivity and specificity. Our computational approaches may be useful in other cases where scRNA-seq and bulk RNA-seq datasets are available to improve information on gene expression.</p>
<p>In addition to enhancing the accuracy of gene expression, the integrated bulk RNA-seq dataset detects lowly expressed protein coding genes that were not detected by scRNA-seq. Further, because our library construction methods were designed to capture non-polyadenylated transcripts, our bulk RNA-seq data set detects noncoding RNAs that were not revealed by previous scRNA-seq results (<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>). Some of these noncoding RNAs are broadly expressed in the nervous system, suggestive of shared functions across different types of neurons. Other non-coding RNAs are expressed in a limited number of neuron types, suggesting neuron type-specific functions. In addition, the bulk RNA-seq dataset contains transcript information across the gene body, which parallel efforts have used to identify mRNA splicing patterns that are not found in the scRNA-seq dataset (<xref ref-type="bibr" rid="c26">26</xref>, <xref ref-type="bibr" rid="c27">27</xref>).</p>
<p>Overall, our approach achieves a comprehensive representation of all classes of transcripts expressed in individual neuron types. These data can now drive analysis of mechanisms that control gene expression across the genome in individual neuron types, and support identification of differentially expressed genes that define neuron-type specific differences in morphology and function. Public access to these data (described below) will enable further analysis into the regulation and function of differential gene expression in <italic>C. elegans</italic> neurons.</p>
</sec>

</body>
<back>
<sec id="s7" sec-type="supplementary">
<title>Supplementary figures</title>
<fig id="figs1" position="float" orientation="portrait" fig-type="figure">
<label>Supplementary Figure 1.</label>
<caption><p>A) Number of cell types sequenced per functional modality. B) Heatmap of Spearman Correlations between average single cell RNA-seq (row) and Bulk RNA-seq (column) profiles for each neuron type. For each row, correlations were calculated for genes called expressed in that single cell cluster (from single cell thresholding) (<xref ref-type="bibr" rid="c11">11</xref>). The single cell data did not separate the DD and VD GABA motor neuron types (<xref ref-type="bibr" rid="c11">11</xref>); these rows are identical.</p></caption>
<graphic xlink:href="487209v3_figs1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs2" position="float" orientation="portrait" fig-type="figure">
<label>Supplementary Figure 2.</label>
<caption><p>A) Bar graph showing the AUROC values for each dataset assessed against ubiquitous genes and genes exclusively expressed in non-neuronal cells. Error bars represent bootstrap estimated confidence intervals. B) Bar graph showing the AUROC values for each dataset, assessed against 160 genes expressed within the nervous system. Error bars represent bootstrap estimated confidence intervals. C) Scatterplot of the training and testing AUROC improvement after LittleBites cleanup. Each dot represents one sample. Red line indicates x=y. D, E) Scatter plots of pairwise comparisons of sample-level AUROC values for unaltered and corrected bulk datasets. Ubiquitous and non-neuronal AUROCs are represented in panel C, and neuronal AUROCs are represented in panel D. F) Violin plot of unaltered bulk sample estimates for the proportion of the counts that come from neurons, vs the number of target cells used in the single cell reference. G) Violin plot in the coefficient of variation (CV) in the mean value of LittleBites cleaned samples, vs the number of target cells used in the single cell reference. H) Violin plot of the mean gene expression value after LittleBites cleanup, vs the number of target cells used in the single cell reference. Model was fit with slopes calculated for each neuron type separately.</p></caption>
<graphic xlink:href="487209v3_figs2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs3" position="float" orientation="portrait" fig-type="figure">
<label>Supplementary Figure 3.</label>
<caption><title>Box plots of edgeR differential expression metrics for single-cell counts and Prop2Count inputs.</title>
<p>1176 neuron-neuron pairs were compared in edgeR, and differentially expressed genes were called as any gene with a p.adj value &lt; 0.05, and a log2 effect size &gt; 2. Metrics were generated by comparing differentially expressed genes with 160 differentially expressed ground truth genes. A) Box plots of TPR values for neuron-neuron edgeR comparisons. B) Box plots of FPR values for neuron-neuron edgeR comparisons. C) Box plots of FDR values for neuron-neuron edgeR comparisons. D) Box plots of MCC values for neuron-neuron edgeR comparisons. Red box plots represent single-cell counts edgeR comparisons, and teal box plots represent Prop2Count edgeR comparisons. All comparisons were made with a two-way permutation test (* = p &lt; 0.05, ** = p &lt; 0.01).</p></caption>
<graphic xlink:href="487209v3_figs3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs4" position="float" orientation="portrait" fig-type="figure">
<label>Supplementary Figure 4.</label>
<caption><p>A) Comparison between ‘ground truth’ fluorescent reporters and RNAseq gene expression for all datasets, shown for a set of homeobox genes (<xref ref-type="bibr" rid="c34">34</xref>). Fluorescent reporter expression is binarized and is shown as small central squares, with black = expressed and white = not expressed. RNA transcripts shown as natural log transformed TPM counts, color-mapped according to the scale. B) Comparison between ‘ground truth’ fluorescent reporters and RNAseq gene expression for the Integrated dataset, shown for a set of genes encoding neurotransmitter machinery (<xref ref-type="bibr" rid="c35">35</xref>). Fluorescent reporter expression is binarized and is shown as small central squares, with black = expressed and white = not expressed. RNA transcripts shown as natural log transformed TPM counts, color-mapped according to the scale. C) Bar plots of significant terms in GO and Tissue enrichment analyses for genes detected only in the single-cell and integrated datasets in ADL and VB neuron types. D) scatterplot of newly detected genes in the Integrated dataset that were previously undetected in all tissues using the single cell reference. Y-axis is the number of genes detected, X-axis is the number of cells in the single cell reference. Red line indicates the line of best fit (log model), and blue lines indicate 95% confidence intervals of the model. E) Boxplot of the number neurons that each ground truth non-neuronal gene was called expressed in at the 14% or 8.4% FDR threshold. Integrated data is filled red, single cell data is filled teal. Notches indicate 95% confidence intervals. Dots represent outliers.</p></caption>
<graphic xlink:href="487209v3_figs4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs5" position="float" orientation="portrait" fig-type="figure">
<label>Supplementary Figure 5.</label>
<caption><p>A) Log-scaled expression distribution of protein coding genes (blue) and non-coding genes (pink). B) Density plot showing the distribution of gene level correlation to contaminant estimates (purple); values plotted are the highest correlation per gene. Genes plotted were called expressed in at least one cell type. Blue and black dashed lines represent a gaussian mixture model, used to threshold against contaminant genes. All noncoding genes with a maximum correlation above 0.22 (vertical red line) were removed from analysis. C) Histogram of ncRNA genes binned by number of neuron types in which they are expressed; genes to the right of the red line are expressed in &gt;90% of neuron types in this study. D) Barplot of the number of noncoding RNAs detected in each neuron type, colored by noncoding RNA class.</p></caption>
<graphic xlink:href="487209v3_figs5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="das" sec-type="data-availability">
<title>Data availability</title>
<p>Bulk raw data and single cell raw data are available at Gene Expression Omnibus (GEO, <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo">https://www.ncbi.nlm.nih.gov/geo</ext-link>). Bulk data identifier: GSE229078. Single cell data identifier: GSE136049. Counts data and additional supporting files can be downloaded from the CeNGEN website (<ext-link ext-link-type="uri" xlink:href="https://www.cengen.org">https://www.cengen.org</ext-link>). Code is available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://www.github.com/cengenproject">https://www.github.com/cengenproject</ext-link>).</p>
</sec>
<sec id="additional-files" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="supp1">
<label>Supplementary Table 1.</label>
<caption>
<title>Replicate metadata for bulk RNA-seq experiments, with replicate names, strain names, and the number of cells collected.</title>
</caption>
<media xlink:href="supplements/487209_file12.csv"/>
</supplementary-material>
<supplementary-material id="supp2">
<label>Supplementary Table 2.</label>
<caption>
<title>List of genes that were removed from analysis because they overlap with promoter regions used in the construction of transgenic markers for FACS sorting.</title>
</caption>
<media xlink:href="supplements/487209_file13.csv"/>
</supplementary-material>
<supplementary-material id="supp3">
<label>Supplementary Table 3.</label>
<caption>
<title>Ground Truth expression matrix for 160 genes in the <italic>C. elegans</italic> nervous system using fosmid and CRISPR/Cas reporter lines (see Methods).</title>
</caption>
<media xlink:href="supplements/487209_file14.csv"/>
</supplementary-material>
<supplementary-material id="supp4">
<label>Supplementary Table 4.</label>
<caption>
<title>List of 445 genes that are expressed exclusively outside the <italic>C. elegans</italic> nervous system (see Methods).</title>
</caption>
<media xlink:href="supplements/487209_file15.csv"/>
</supplementary-material>
<supplementary-material id="supp5">
<label>Supplementary Table 5.</label>
<caption>
<title>List of 936 ubiquitous genes (see Methods).</title>
</caption>
<media xlink:href="supplements/487209_file16.csv"/>
</supplementary-material>
<supplementary-material id="supp6">
<label>Supplementary Table 6.</label>
<caption>
<title>Integrated gene expression matrix.</title>
</caption>
<media xlink:href="supplements/487209_file17.csv"/>
</supplementary-material>
<supplementary-material id="supp7">
<label>Supplementary Table 7.</label>
<caption>
<title>Thresholded gene-by-cell expression matrices using the Integrated data set, computed at four thresholds, values below the threshold are set to 0.</title>
</caption>
<media xlink:href="supplements/487209_file18.csv"/>
</supplementary-material>
<supplementary-material id="supp8">
<label>Supplementary Table 8.</label>
<caption>
<title>Thresholded gene-by-cell expression matrices using the Integrated data set, computed at four thresholds, values below the threshold are set to 0.</title>
</caption>
<media xlink:href="supplements/487209_file19.csv"/>
</supplementary-material>
<supplementary-material id="supp9">
<label>Supplementary Table 9.</label>
<caption>
<title>Thresholded gene-by-cell expression matrices using the Integrated data set, computed at four thresholds, values below the threshold are set to 0.</title>
</caption>
<media xlink:href="supplements/487209_file20.csv"/>
</supplementary-material>
<supplementary-material id="supp10">
<label>Supplementary Table 10.</label>
<caption>
<title>Thresholded gene-by-cell expression matrices using the Integrated data set, computed at four thresholds, values below the threshold are set to 0.</title>
</caption>
<media xlink:href="supplements/487209_file21.csv"/>
</supplementary-material>
<supplementary-material id="supp11">
<label>Supplementary Table 11.</label>
<caption>
<title>List of ncRNA genes expressed in individual neuron types.</title>
</caption>
<media xlink:href="supplements/487209_file22.csv"/>
</supplementary-material>
<supplementary-material id="supp12">
<label>Supplementary Table 12.</label>
<caption>
<title>List of ncRNA gene types expressed in individual neuron types.</title>
</caption>
<media xlink:href="supplements/487209_file23.csv"/>
</supplementary-material>
<supplementary-material id="supp13">
<label>Supplementary Table 13.</label>
<caption>
<title>List of GPCR pseudogenes included in this analysis.</title>
</caption>
<media xlink:href="supplements/487209_file24.csv"/>
</supplementary-material>
<supplementary-material id="supp14">
<label>Supplementary Table 14.</label>
<caption>
<title>List of protein coding GPCR genes included in this analysis.</title>
</caption>
<media xlink:href="supplements/487209_file25.csv"/>
</supplementary-material>
<supplementary-material id="supp15">
<label>Supplementary Table 15.</label>
<media xlink:href="supplements/487209_file26.csv"/>
</supplementary-material>
<supplementary-material id="supp16">
<label>Supplementary Table 16.</label>
<media xlink:href="supplements/487209_file27.csv"/>
</supplementary-material>
<supplementary-material id="supp17">
<label>Supplementary Table 17.</label>
<media xlink:href="supplements/487209_file28.csv"/>
</supplementary-material>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. E.</given-names> <surname>Sulston</surname></string-name>, <string-name><given-names>H. R.</given-names> <surname>Horvitz</surname></string-name></person-group>, <article-title>Post-embryonic cell lineages of the nematode, Caenorhabditis elegans</article-title>. <source>Dev Biol</source> <volume>56</volume>, <fpage>110</fpage>–<lpage>156</lpage> (<year>1977</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. E.</given-names> <surname>Sulston</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Schierenberg</surname></string-name>, <string-name><given-names>J. G.</given-names> <surname>White</surname></string-name>, <string-name><given-names>J. N.</given-names> <surname>Thomson</surname></string-name></person-group>, <article-title>The embryonic cell lineage of the nematode Caenorhabditis elegans</article-title>. <source>Dev Biol</source> <volume>100</volume>, <fpage>64</fpage>–<lpage>119</lpage> (<year>1983</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. G.</given-names> <surname>White</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Southgate</surname></string-name>, <string-name><given-names>J. N.</given-names> <surname>Thomson</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Brenner</surname></string-name></person-group>, <article-title>The structure of the nervous system of the nematode Caenorhabditis elegans</article-title>. <source>Philos Trans R Soc Lond B Biol Sci</source> <volume>314</volume>, <fpage>1</fpage>–<lpage>340</lpage> (<year>1986</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. J.</given-names> <surname>Cook</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Whole-animal connectomes of both Caenorhabditis elegans sexes</article-title>. <source>Nature</source> <volume>571</volume>, <fpage>63</fpage>–<lpage>71</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C. A.</given-names> <surname>Brittin</surname></string-name>, <string-name><given-names>S. J.</given-names> <surname>Cook</surname></string-name>, <string-name><given-names>D. H.</given-names> <surname>Hall</surname></string-name>, <string-name><given-names>S. W.</given-names> <surname>Emmons</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Cohen</surname></string-name></person-group>, <article-title>A multi-scale brain map derived from whole-brain volumetric reconstructions</article-title>. <source>Nature</source> <volume>591</volume>, <fpage>105</fpage>–<lpage>110</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. W.</given-names> <surname>Moyle</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Structural and developmental principles of neuropil assembly in C. elegans</article-title>. <source>Nature</source> <volume>591</volume>, <fpage>99</fpage>–<lpage>104</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M.</given-names> <surname>Hammarlund</surname></string-name>, <string-name><given-names>O.</given-names> <surname>Hobert</surname></string-name>, <string-name><given-names>D. M.</given-names> <surname>Miller</surname></string-name></person-group>, <article-title>3rd, N. Sestan, The CeNGEN Project: The Complete Gene Expression Map of an Entire Nervous System</article-title>. <source>Neuron</source> <volume>99</volume>, <fpage>430</fpage>–<lpage>433</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. R.</given-names> <surname>Taylor</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Molecular topography of an entire nervous system</article-title>. <source>Cell</source> <volume>184</volume>, <fpage>4329</fpage>–<lpage>4347.e4323</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Barrett</surname></string-name> <etal>et al.</etal></person-group>, <article-title>A head-to-head comparison of ribodepletion and polyA selection approaches for Caenorhabditis elegans low input RNA-sequencing libraries</article-title>. <source>G3 Genes|Genomes|Genetics</source> <volume>11</volume>, (<year>2021</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>W. C.</given-names> <surname>Spencer</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Isolation of specific neurons from C. elegans larvae for gene expression profiling</article-title>. <source>PLoS One</source> <volume>9</volume>, <fpage>e112102</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. R.</given-names> <surname>Taylor</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Molecular topography of an entire nervous system</article-title>. <source>Cell</source> <volume>184</volume>, <fpage>4329</fpage>–<lpage>4347 e4323</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. R.</given-names> <surname>Taylor</surname></string-name>, <string-name><given-names>R. D.</given-names> <surname>McWhirter</surname></string-name>, <string-name><given-names>B. K.</given-names> <surname>Matlock</surname></string-name>, <string-name><given-names>D. K.</given-names> <surname>Flaherty</surname></string-name>, <string-name><given-names>D. M.</given-names> <surname>Miller</surname>, <suffix>3rd</suffix></string-name></person-group>, <article-title>Protocol for isolating specific C. elegans neuron types for bulk and single-cell RNA sequencing</article-title><source>. STAR Protoc</source> <volume>5</volume>, <fpage>103439</fpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>N.</given-names> <surname>Stefanakis</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Carrera</surname></string-name>, <string-name><given-names>O.</given-names> <surname>Hobert</surname></string-name></person-group>, <article-title>Regulatory Logic of Pan-Neuronal Gene Expression in C. elegans</article-title>. <source>Neuron</source> <volume>87</volume>, <fpage>733</fpage>–<lpage>750</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Bhattacharya</surname></string-name>, <string-name><given-names>U.</given-names> <surname>Aghayeva</surname></string-name>, <string-name><given-names>E. G.</given-names> <surname>Berghoff</surname></string-name>, <string-name><given-names>O.</given-names> <surname>Hobert</surname></string-name></person-group>, <article-title>Plasticity of the Electrical Connectome of C. elegans</article-title>. <source>Cell</source> <volume>176</volume>, <fpage>1174</fpage>–<lpage>1189.e1116</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T. W.</given-names> <surname>Harris</surname></string-name> <etal>et al.</etal></person-group>, <article-title>WormBase: a modern Model Organism Information Resource</article-title>. <source>Nucleic Acids Research</source> <volume>48</volume>, <fpage>D762</fpage>–<lpage>D767</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. B.</given-names> <surname>Reilly</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Cros</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Varol</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Yemini</surname></string-name>, <string-name><given-names>O.</given-names> <surname>Hobert</surname></string-name></person-group>, <article-title>Unique homeobox codes delineate all the neuron classes of C. elegans</article-title>. <source>Nature</source> <volume>584</volume>, <fpage>595</fpage>–<lpage>601</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>E.</given-names> <surname>Yemini</surname></string-name> <etal>et al.</etal></person-group>, <article-title>NeuroPAL: A Multicolor Atlas for Whole-Brain Neuronal Identification in C. elegans</article-title>. <source>Cell</source> <volume>184</volume>, <fpage>272</fpage>–<lpage>288 e211</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. S.</given-names> <surname>Packer</surname></string-name> <etal>et al.</etal></person-group>, <article-title>A lineage-resolved molecular atlas of C. elegans embryogenesis at single-cell resolution</article-title>. <source>Science</source> <volume>365</volume>, (<year>2019</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M.</given-names> <surname>Smid</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Gene length corrected trimmed mean of M-values (GeTMM) processing of RNA-seq data performs similarly in intersample analyses while improving intrasample comparisons</article-title>. <source>BMC Bioinformatics</source> <volume>19</volume>, <fpage>236</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Roeder</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Devlin</surname></string-name></person-group>, <article-title>Bayesian estimation of cell type-specific gene expression with prior derived from single-cell data</article-title>. <source>Genome Res</source> <volume>31</volume>, <fpage>1807</fpage>–<lpage>1818</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>W.</given-names> <surname>Wang</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Approximate estimation of cell-type resolution transcriptome in bulk tissue through matrix completion</article-title>. <source>Brief Bioinform</source> <volume>24</volume>, (<year>2023</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. J.</given-names> <surname>Xiao</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Zhang</surname></string-name>, <string-name><given-names>Q.</given-names> <surname>Zou</surname></string-name>, <string-name><given-names>Z. L.</given-names> <surname>Ji</surname></string-name></person-group>, <article-title>TiSGeD: a database for tissue-specific genes</article-title>. <source>Bioinformatics</source> <volume>26</volume>, <fpage>1273</fpage>–<lpage>1275</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>N.</given-names> <surname>Kryuchkova-Mostacci</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Robinson-Rechavi</surname></string-name></person-group>, <article-title>A benchmark of gene expression tissue-specificity metrics</article-title>. <source>Briefings in Bioinformatics</source> <volume>18</volume>, <fpage>205</fpage>–<lpage>214</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T. C.</given-names> <surname>e</surname></string-name>. <string-name><given-names>S.</given-names> <surname>Consortium</surname></string-name></person-group>, <article-title>Genome sequence of the nematode C. elegans: a platform for investigating biology</article-title>. <source>Science</source> <volume>282</volume>, <fpage>2012</fpage>–<lpage>2018</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L. R.</given-names> <surname>Varshney</surname></string-name>, <string-name><given-names>B. L.</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Paniagua</surname></string-name>, <string-name><given-names>D. H.</given-names> <surname>Hall</surname></string-name>, <string-name><given-names>D. B.</given-names> <surname>Chklovskii</surname></string-name></person-group>, <article-title>Structural properties of the Caenorhabditis elegans neuronal network</article-title>. <source>PLoS Comput Biol</source> <volume>7</volume>, <fpage>e1001066</fpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Weinreb</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Alternative splicing across the &lt;em&gt;C. elegans&lt;/em&gt; nervous system</article-title>. <source>bioRxiv</source>, <fpage>2024.2005.2016.594567</fpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Z.</given-names> <surname>Wolfe</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Liska</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Norris</surname></string-name></person-group>, <article-title>Deep Transcriptomics Reveals Cell-Specific Isoforms of Pan-Neuronal Genes</article-title>. <source>bioRxiv</source>, <fpage>2024.2005.2016.594572</fpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>H.</given-names> <surname>Tripathi</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Isolation Methods for Human CD34 Subsets Using Fluorescent and Magnetic Activated Cell Sorting: an In Vivo Comparative Study</article-title>. <source>Stem Cell Rev Rep</source> <volume>16</volume>, <fpage>413</fpage>-<lpage>423</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. R.</given-names> <surname>Ocanas</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Minimizing the Ex Vivo Confounds of Cell-Isolation Techniques on Transcriptomic and Translatomic Profiles of Purified Microglia</article-title>. <source>eNeuro</source> <volume>9</volume>, (<year>2022</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Roeder</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Devlin</surname></string-name></person-group>, <article-title>Bayesian estimation of cell type–specific gene expression with prior derived from single-cell data</article-title>. <source>Genome Research</source> <volume>31</volume>, <fpage>1807</fpage>–<lpage>1818</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T. H.</given-names> <surname>Kim</surname></string-name>, <string-name><given-names>X.</given-names> <surname>Zhou</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Chen</surname></string-name></person-group>, <article-title>Demystifying &quot;drop-outs&quot; in single-cell UMI data</article-title>. <source>Genome Biol</source> <volume>21</volume>, <fpage>196</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A. S.</given-names> <surname>Booeshaghi</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Pachter</surname></string-name></person-group>, <article-title>Normalization of single-cell RNA-seq counts by log(x + 1)dagger or log(1 + x)dagger</article-title>. <source>Bioinformatics</source> <volume>37</volume>, <fpage>2223</fpage>–<lpage>2224</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G. A.</given-names> <surname>Bouland</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Mahfouz</surname></string-name>, <string-name><given-names>M. J. T.</given-names> <surname>Reinders</surname></string-name></person-group>, <article-title>Differential analysis of binarized single-cell RNA sequencing data captures biological variation</article-title>. <source>NAR Genom Bioinform</source> <volume>3</volume>, <fpage>lqab118</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. B.</given-names> <surname>Reilly</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Widespread employment of conserved C. elegans homeobox genes in neuronal identity specification</article-title>. <source>PLoS Genet</source> <volume>18</volume>, <fpage>e1010372</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>C.</given-names> <surname>Wang</surname></string-name> <etal>et al.</etal></person-group>, <article-title>A neurotransmitter atlas of C. elegans males and hermaphrodites</article-title>. <source>bioRxiv</source>, <fpage>2023.2012.2024.573258</fpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>E.</given-names> <surname>Mereu</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Benchmarking single-cell RNA-sequencing protocols for cell atlas projects</article-title>. <source>Nature Biotechnology</source> <volume>38</volume>, <fpage>747</fpage>–<lpage>755</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>D.</given-names> <surname>Angeles-Albores</surname></string-name>, <string-name><given-names>R. Y. N.</given-names> <surname>Lee</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Chan</surname></string-name>, <string-name><given-names>P. W.</given-names> <surname>Sternberg</surname></string-name></person-group>, <article-title>Tissue enrichment analysis for C. elegans genomics</article-title>. <source>BMC Bioinformatics</source> <volume>17</volume>, <fpage>366</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P. N.</given-names> <surname>Inglis</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Ou</surname></string-name>, <string-name><given-names>M. R.</given-names> <surname>Leroux</surname></string-name>, <string-name><given-names>J. M.</given-names> <surname>Scholey</surname></string-name></person-group>, <article-title>The sensory cilia of Caenorhabditis elegans</article-title>. <source>WormBook</source>, <fpage>1</fpage>–<lpage>22</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Isakova</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Fehlmann</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Keller</surname></string-name>, <string-name><given-names>S. R.</given-names> <surname>Quake</surname></string-name></person-group>, <article-title>A mouse tissue atlas of small noncoding RNA</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>117</volume>, <fpage>25634</fpage>–<lpage>25645</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>É.</given-names> <surname>Fafard-Couture</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Bergeron</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Couture</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Abou-Elela</surname></string-name>, <string-name><given-names>M. S.</given-names> <surname>Scott</surname></string-name></person-group>, <article-title>Annotation of snoRNA abundance across human tissues reveals complex snoRNA-host gene relationships</article-title>. <source>Genome Biology</source> <volume>22</volume>, <fpage>172</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>D. A.</given-names> <surname>Wassarman</surname></string-name>, <string-name><given-names>J. A.</given-names> <surname>Steitz</surname></string-name></person-group>, <article-title>Interactions of small nuclear RNAs with precursor messenger-RNA during invitro splicing</article-title>. <source>Science</source> <volume>257</volume>, <fpage>1918</fpage>–<lpage>1925</lpage> (<year>1992</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>S.</given-names> <surname>Valadkhan</surname></string-name></person-group>, <chapter-title>Chapter Six - The Role of snRNAs in Spliceosomal Catalysis</chapter-title> in <source>Progress in Molecular Biology and Translational Science</source>, <person-group person-group-type="editor"><string-name><given-names>G. A.</given-names> <surname>Soukup</surname></string-name></person-group>, Ed. (<publisher-name>Academic Press</publisher-name>, <year>2013</year>), vol. <volume>120</volume>, pp. <fpage>195</fpage>–<lpage>228</lpage>.</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T.</given-names> <surname>Bratkovič</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Božič</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Rogelj</surname></string-name></person-group>, <article-title>Functional diversity of small nucleolar RNAs</article-title>. <source>Nucleic Acids Research</source> <volume>48</volume>, <fpage>1627</fpage>–<lpage>1651</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Huminiecki</surname></string-name>, <string-name><given-names>A. T.</given-names> <surname>Lloyd</surname></string-name>, <string-name><given-names>K. H.</given-names> <surname>Wolfe</surname></string-name></person-group>, <article-title>Congruence of tissue expression profiles from Gene Expression Atlas, SAGEmap and TissueInfo databases</article-title>. <source>BMC Genomics</source> <volume>4</volume>, <fpage>31</fpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Zhu</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Lei</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Devlin</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Roeder</surname></string-name></person-group>, <article-title>A unified statistical framework for single cell and bulk RNA sequencing data</article-title>. <source>Ann Appl Stat</source> <volume>12</volume>, <fpage>609</fpage>–<lpage>632</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A. M.</given-names> <surname>Newman</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Determining cell type abundance and expression from bulk tissues with digital cytometry</article-title>. <source>Nature Biotechnology</source> <volume>37</volume>, <fpage>773</fpage>–<lpage>782</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>W.</given-names> <surname>Wang</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Improved estimation of cell type-specific gene expression through deconvolution of bulk tissues with matrix completion</article-title>. <source>bioRxiv</source>, <fpage>2021.2006.2030.450493</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="dataref1"><mixed-citation publication-type="data" specific-use="generated"><person-group person-group-type="author"><string-name><surname>Barrett et al</surname></string-name></person-group> (<year iso-8601-date="2023">2023</year>) <article-title>Bulk RNA seq of sorted C. elegans neurons</article-title>. <source>NCBI Gene Expression Omnibus</source>. <pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE229078">GSE229078</pub-id></mixed-citation></ref>
<ref id="dataref2"><mixed-citation publication-type="data" specific-use="analyzed"><person-group person-group-type="author"><string-name><surname>Taylor et al</surname></string-name></person-group> (<year iso-8601-date="2021">2021</year>) <article-title>Molecular topography of an entire nervous system</article-title>. <source>NCBI Gene Expression Omnibus</source>. <pub-id pub-id-type="accession" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE136049">GSE136049</pub-id></mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.106183.2.sa4</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Portman</surname>
<given-names>Douglas</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/022kthw22</institution-id><institution>University of Rochester</institution>
</institution-wrap>
<city>Rochester</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This paper uses a new computational method that integrates bulk sequencing and single-cell sequencing data to provide refined gene expression datasets for 52 neuron classes in C. elegans. The paper's findings are <bold>convincing</bold>, presenting an approach that alleviates a key shortcoming of single-cell RNA sequencing. While the datasets have some limitations that the authors acknowledge, the new methodology and refined datasets will be <bold>important</bold> resources for those interested in understanding how gene expression shapes neuronal morphology and physiology.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.106183.2.sa3</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This is an interesting manuscript aimed at improving the transcriptome characterization of 52 C. elegans neuron classes. Previous single-cell RNA seq studies already uncovered transcriptomes for these, but the data are incomplete, with a bias against genes with lower expression levels. Here, the authors use cell-specific reporter combinations to FACS purify neurons and use bulk RNA sequencing to obtain better sequencing depth. This reveals more rare transcripts, as well as non-coding RNAs, pseudo genes, etc. The authors develop computational approaches to combine the bulk and scRNA transcriptome results to obtain more definitive gene lists for the neurons examined.</p>
<p>To ultimately understand features of any cell, from morphology to function, an understanding of the full complement of the genes it expresses is a pre-requisite. This paper gets us a step closer to this goal, assembling a current &quot;definitive list&quot; of genes for a large proportion of C. elegans neurons. The computational approaches used to generate the list are based on reasonable assumptions, the data appear to have been treated appropriately statistically, and the conclusions are generally warranted. I have a few issues that the authors may chose to address:</p>
<p>(1) As part of getting rid of cross contamination in the bulk data, the authors model the scRNA data, extrapolate it to the bulk data and subtract out &quot;contaminant&quot; cell types. One wonders, however, given that low expressed genes are not represented in the scRNA data, whether the assignment of a gene to one or another cell type can really be made definitve. Indeed, it's possible that a gene is expressed at low levels in one cell, and in high levels in another, and would therefore be considered a contaminant. The result would be to throw out genes that actually are expressed in a given cell type. The definitive list would therefore be a conservative estimate, and not necessarily the correct estimate.</p>
<p>(2) It would be quite useful to have tested some genes with lower expression levels using in vivo gene-fusion reporters to assess whether the expression assignments hold up as predicted. i.e. provide another avenue of experimentation, non-computational, to confirm that the decontamination algorithm works.</p>
<p>(3) In many cases, each cell class would be composed of at least 2 if not more neurons. Is it possible that differences between members of a single class would be missed by applying the cleanup algorithms? Such transcripts would be represented only in a fraction of the cells isolated by scRNAseq, and might then be considered not real?</p>
<p>(4) I didn't quite catch whether the precise staging of animals was matched between the bulk and scRNAseq datasets. Importantly, there are many genes whose expression is highly stage specific or age specific so that even slight temporal difference might yield different sets of gene expression.</p>
<p>(5) To what extent does FACS sorting affect gene expression? Can the authors provide some controls?</p>
<p>Comments on revisions:</p>
<p>The authors have made reasonable arguments in response to my questions, and have done some additional experiments. I believe that although they did not do so, they could have generated additional reporters for the lower expressed genes, that would have validated their method of data integration. Nonetheless, I think the paper is rigorous and will be of use to the community.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.106183.2.sa2</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This study from the CenGEN consortium addresses several limitations of single-cell RNA (scRNA) and bulk RNA sequencing in C. elegans with a focus on cells in the nervous system. scRNA datasets can give very specific expression profiles, but detecting rare and non-polyA transcripts is difficult. In contrast, bulk RNA sequencing on isolated cells can be sequenced to high depth to identify rare and non-polyA transcripts but frequently suffers from RNA contamination from other cell types. In this study, the authors generate a comprehensive set of bulk RNA datasets from 53 individual neurons isolated by fluorescence activated cell sorting (FACS). The authors combine these datasets with a previously published scRNA dataset (Taylor et al., 2021) to develop a novel method, called LittleBites, to estimate and subtract contamination from the bulk RNA data. The authors validate the method by comparing detected transcripts against gold-standard datasets on neuron-specific and non-neuronal transcripts. The authors generate an &quot;integrated&quot; list of protein-coding expression profiles for the 53 neuron sub-types, with fewer but higher confidence genes compared to expression profiles based only on scRNA. Also, the authors identify putative novel pan-neuronal and cell-type specific non-coding RNAs based on the bulk RNA data. LittleBites should be generally useful for extracting higher confidence data from bulk RNA-seq data in organisms where extensive scRNA datasets are available. The additional confidence in neuron-specific expression and non-coding RNA expands the already great utility of the neuronal expression reference atlas generated by the CenGEN consortium.</p>
<p>Strengths:</p>
<p>The study generates and analyzes a very comprehensive set of bulk RNA datasets from individual fluorescently tagged transgenic strains. These datasets are technically challenging to generate and significantly expand our knowledge of gene expression, particularly in cells that were poorly represented in the initial scRNA-seq datasets. Additionally, all transgenic strains are made available as a resource from the Caenorhabditis Elegans Genetics Center (CGC).</p>
<p>The study uses the authors' extensive experience with neuronal expression to benchmark their method for reducing contamination utilizing a set of gold-standard validated neuronal and non-neuronal genes. These gold-standard genes will be helpful for benchmarking any C. elegans gene expression study.</p>
<p>Weaknesses:</p>
<p>The bulk RNA-seq data collected by the authors has high levels of contamination and, in some cases, is based on very few cells. The methodology to remove contamination partly makes up for this shortcoming, but the high background levels of contaminating RNA in the FACS-isolated neurons limit the confidence in cell-specific transcripts.</p>
<p>The study does not experimentally validate any of the refined gene expression predictions, which was one of the main strengths of the initial CenGEN publication (Taylor et al, 2021). No validation experiments (e.g., fluorescence reporters or single molecule FISH) were performed for protein-coding or non-coding genes, which makes it difficult for the reader to assess how much gene predictions are improved, other than for the gold standard set, which may have specific characteristics (e.g., bias toward high expression as they were primarily identified in fluorescence reporter experiments).</p>
<p>The study notes that bulk RNA-seq data, in contrast to scRNA-seq data, can be used to identify which isoforms are expressed in a given cell. Although not included in this manuscript, two bioRxiv papers have used the generous openness of the CenGEN consortium to study alternative splicing in C. elegans neurons [bioRxiv, 2024.2005.2016.594567 (2024) and bioRxiv, 2024.2005.2016.594572 (2024)], nicely showing the strengths of the data.</p>
<p>Comments on revisions: I agree that the paper is improved.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.106183.2.sa1</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary</p>
<p>This study aims to overcome key limitations of single-cell RNA-seq in C. elegans neurons-especially the under-detection of lowly expressed and non-polyadenylated transcripts and residual contamination-by integrating bulk RNA-seq from FACS-isolated neuron types with an existing scRNA-seq atlas. The authors introduce LittleBites, an iterative, reference-guided decontamination algorithm that uses a single-cell reference together with ground-truth reporter datasets to optimize subtraction of contaminating signal from bulk profiles. They then generate an &quot;Integrated&quot; dataset that combines the sensitivity of bulk data with the specificity of scRNA-seq and use it to call neuron-specific expression for protein-coding genes, &quot;rescued&quot; genes not detected in scRNA-seq, and multiple classes of non-coding RNAs across 53 neuron classes. All data, code, and thresholded matrices are made publicly available to enable community reuse.</p>
<p>Strengths</p>
<p>(1) Conceptual advance and useful resource. The work demonstrates in a concrete way how bulk and single-cell datasets can be combined to overcome the weaknesses of each approach, and delivers a high-resolution transcriptomic resource for a substantial fraction of C. elegans neuron classes . The integrated matrices, thresholded expression calls, and non-coding RNA catalog will be useful both for basic neurobiology and for method developers.</p>
<p>(2) Careful benchmarking and transparency. The revised manuscript includes extensive benchmarking of LittleBites and the Integrated dataset against multiple independent &quot;ground-truth&quot; sets: neuron-specific reporter lines, curated non-neuronal markers, and ubiquitous genes. The authors evaluate AUROCs over a wide range of thresholds, explain ROC/AUROC metrics for non-specialists, and quantify how integration affects both sensitivity and specificity relative to scRNA-seq alone.</p>
<p>(3) Improved methodological clarity. In response to review, the authors now provide a much more intuitive description of the LittleBites algorithm, including a stepwise explanation of (1) contamination estimation via NNLS using single-cell references, (2) weighted subtraction tuned by a learning-rate parameter, and (3) performance optimization based on AUROC against ground-truth genes. this makes the approach accessible to readers who are not computational specialists and will facilitate re-implementation.</p>
<p>(4) Systematic analysis of reference dependence. The authors explicitly address the concern that LittleBites depends on the completeness and accuracy of the scRNA-seq reference. They examine how performance varies with cluster size and by simulated degradation of the reference (e.g., reducing the number of cells per cluster), and show that AUROCs remain robust, but that gene-level assignments are more variable for clusters represented by fewer cells. This is an important and honest characterization of when the method is reliable and when users should be cautious.</p>
<p>(5) Additional biological context. The manuscript now more clearly situates the dataset in the context of previous and ongoing work. In particular, the authors highlight that other groups have already used these bulk data to discover and validate cell-type-specific alternative splicing events, strengthening the case that the data are biologically meaningful beyond the immediate analyses presented here. The expanded analysis of non-coding RNAs and GPCR pseudogenes also adds biological interest.</p>
<p>(6) Improved handling and documentation of &quot;unexpressed&quot; genes. The authors have trimmed the original list of 4,440 genes called &quot;unexpressed&quot; in scRNA-seq to a higher-confidence subset and provide new supplementary tables that include gene identities and tissue annotations. They also use a curated set of non-neuronal markers to estimate residual contamination and show that most such markers are not detected in the integrated data, with only a small number of apparent false positives remaining.</p>
<p>Weaknesses</p>
<p>(1) Novel assignments remain predictive rather than experimentally validated. Although the authors have strengthened their benchmarking and refer to external work that validates some splicing patterns from these data, the large sets of newly assigned lowly expressed genes and non-coding RNAs-particularly those rescued from the &quot;unexpressed&quot; gene pool-are still inferred from computational criteria (thresholding plus correlation-based decontamination) rather than direct orthogonal assays (e.g., smFISH, in situ hybridization, or reporter lines). This is understandable given scale and cost, but it means that many of these calls should be interpreted as well-supported predictions, not definitive expression maps. The revised manuscript acknowledges this, and a dedicated &quot;Limitations of this study&quot; subsection will further clarify this point for readers.</p>
<p>(2) Reduced stability for neuron types with sparse single-cell representation. The authors' new analyses show that while integration improves overall correlation and AUROC across a wide range of neuron types, gene-level assignments are less stable for neuron classes represented by relatively few cells in the scRNA-seq reference. For such neuron types, both false negatives and false positives are more likely, and users should be cautious when interpreting cell-type-specific expression differences based solely on these calls.</p>
<p>(3) Residual contamination and misclassification are not completely eliminated. Despite the careful design of LittleBites and the additional correlation-based decontamination of &quot;unexpressed&quot; genes, the authors' benchmarking against curated non-neuronal markers shows that a small fraction of putative non-neuronal genes remains detectable even at stricter thresholds, and some bona fide neuronal genes are removed as likely contaminants. The new supplementary tables documenting &quot;unexpressed&quot; genes and their tissue annotations, together with explicit statements about residual error rates and the predictive nature of these classifications, help users to judge the reliability of specific genes, but they also underscore that the dataset is not a perfect ground truth.</p>
<p>(4) Scope and coverage remain incomplete. As the authors note, the dataset covers 53 neuron classes and does not fully represent all 302 neurons or all known neuron subtypes. In addition, bulk samples represent pools of neurons, and so the approach cannot resolve within-class heterogeneity or subtype-specific expression within those pools. These are inherent limitations of the current experimental design rather than flaws in the analysis, but they are important for readers to keep in mind when using the resource.</p>
<p>Overall, the revised manuscript presents solid evidence for the main methodological and resource claims, with clearly articulated limitations. The work is likely to have valuable impact on the C. elegans community and provides a template for integrating bulk and single-cell data in other systems.</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.106183.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Barrett</surname>
<given-names>Alec</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Varol</surname>
<given-names>Erdem</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Weinreb</surname>
<given-names>Alexis</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Taylor</surname>
<given-names>Seth R</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-2227-1050</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>McWhirter</surname>
<given-names>Rebecca M</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Cros</surname>
<given-names>Cyril</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Vidal</surname>
<given-names>Berta</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Basaravaju</surname>
<given-names>Manasa</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Poff</surname>
<given-names>Abigail</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tipps</surname>
<given-names>John A</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Majeed</surname>
<given-names>Maryam</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wang</surname>
<given-names>Chen</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bayer</surname>
<given-names>Emily A</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-5254-9199</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Reilly</surname>
<given-names>Molly</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Yemini</surname>
<given-names>Eviatar</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-1977-0761</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Sun</surname>
<given-names>HaoSheng</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hobert</surname>
<given-names>Oliver</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-7634-2854</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Miller</surname>
<given-names>David M</given-names>
<suffix>III</suffix></name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hammarlund</surname>
<given-names>Marc</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0002-3068-068X</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews</p>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #1 (Public review):</bold></p>
<p>(1) As part of getting rid of cross-contamination in the bulk data, the authors model the scRNA data, extrapolate it to the bulk data and subtract out &quot;contaminant&quot; cell types. One wonders, however, given that low expressed genes are not represented in the scRNA data, whether the assignment of a gene to one or another cell type can really be made definitive. Indeed, it's possible that a gene is expressed at low levels in one cell, and high levels in another, and would therefore be considered a contaminant. The result would be to throw out genes that actually are expressed in a given cell type. The definitive list would therefore be a conservative estimate, and not necessarily the correct estimate.</p>
</disp-quote>
<p>We agree that the various strategies we employ do not result in perfect annotation of gene expression. However, despite their limitations, they are significantly better than either the single cell or the bulk data alone. We represent these strengths and shortcomings throughout the manuscript (for example, in ROC curves).</p>
<disp-quote content-type="editor-comment">
<p>(2) It would be quite useful to have tested some genes with lower expression levels using in vivo gene-fusion reporters to assess whether the expression assignments hold up as predicted. i.e. provide another avenue of experimentation, non-computational, to confirm that the decontamination algorithm works.</p>
</disp-quote>
<p>We agree that evaluating only highly-expressed genes might introduce bias. We used a large battery of in vivo reporters, made with best-available technology (CRISPR insertion of the fluorophore into the endogenous locus) to evaluate our approaches. These reporters were constructed without bias in terms of gene expression and therefore represent both high and low expression levels. These data are represented throughout the manuscript (for example, in ROC curves). Details about the battery of reporters may be found in Taylor et al 2021. In addition to these reporters, this manuscript also generates and analyzes two other types of gene sets: non-neuronal and ubiquitous genes. Again, these genes are selected without bias toward gene expression, and the techniques presented here are benchmarked against them as well, with positive results.</p>
<disp-quote content-type="editor-comment">
<p>(3) In many cases, each cell class would be composed of at least 2 if not more neurons. Is it possible that differences between members of a single class would be missed by applying the cleanup algorithms? Such transcripts would be represented only in a fraction of the cells isolated by scRNAseq, and might then be considered not real.</p>
</disp-quote>
<p>For the data set presented in this manuscript, all cells of a single neuron type were labeled and isolated together by FACS, and sequencing libraries were constructed from this pool of cells. Thus, potential subtypes within a particular type (when that type includes more than one cell) cannot be resolved by this method. By contrast, such subtypes were in some cases resolved in the single cell approach. To make the two data sets compatible with each other, for the single cell data we combined any subtypes together. We state in the Methods:</p>
<p>“For this work, single cell clusters of neuron subtypes were collapsed to the resolution of the bulk replicates (example: VB and VB1 clusters in the single cell data were treated as one VB cluster).”</p>
<disp-quote content-type="editor-comment">
<p>(4) I didn't quite catch whether the precise staging of animals was matched between the bulk and scRNAseq datasets. Importantly, there are many genes whose expression is highly stage-specific or age-specific so even slight temporal differences might yield different sets of gene expression.</p>
</disp-quote>
<p>We agree that accurate staging is critically important for valid comparisons between data sets and have included an additional supplemental table with staging metadata for each sample. The staging protocol used for the bulk data set was initially employed to generate scRNA seq data and should be comparable. An additional description of our approach is now included in Methods:</p>
<p>“Populations of synchronized L1s were grown at 23 C until reaching the L4 stage on 150 mM 8P plates inoculated with Na22. The time in culture to reach the L4 stage varied (40.5-49 h) and was determined for each strain. 50-100 animals were inspected with a 40X DIC objective to determine developmental stage as scored by vulval morphology (Mok et al., 2025). Cultures were predominantly composed of L4 larvae but also typically included varying fractions of L3 larvae and adults.”</p>
<p>We have also updated supplementary table 1 to include additional information about each sort including the observed developmental stages and their proportions when available, the temperature the worms were grown at, the genotype of each experiment, and the number of cells collected in FACS.</p>
<disp-quote content-type="editor-comment">
<p>(5) To what extent does FACS sorting affect gene expression? Can the authors provide some controls?</p>
</disp-quote>
<p>We appreciate this suggestion. We agree that FACS sorting (and also dissociation of the animals prior to sorting) might affect gene expression, particularly of stress-related transcripts. We note that dissociation and FACS sorting was also used to collect cells for our single cell data set (Taylor et al 2021). We would note that clean controls for this approach can be prohibitively difficult to collect, as the process of dissociation and FACS will inevitably change the proportion of cell types present in the sample, and for bulk sequencing efforts it is difficult even with deconvolution approaches to accurately account for changes in gene expression that result from dissociation and FACS, versus changes in gene expression that result from differences in cell type composition. We regrettably omitted a discussion of these issues in the manuscript. We now write in the Results:</p>
<p>“The dissociation and FACS steps used to isolate neuron types induce cellular stress responsive pathways (van den Brink et al., 2017; Kaletsky et al., 2016, Taylor 2021). Genes associated with this stress response (Taylor 2021) were not removed from downstream analyses, but should be viewed with caution.”</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public review):</bold></p>
<p>The bulk RNA-seq data collected by the authors has high levels of contamination and, in some cases, is based on very few cells. The methodology to remove contamination partly makes up for this shortcoming, but the high background levels of contaminating RNA in the FACS-isolated neurons limit the confidence in cell-specific transcripts.</p>
</disp-quote>
<p>We agree that these are the limitations of the source data. One of the manuscript’s main goals is to analyze and refine these source data, reducing these limitations and quantifying the results.</p>
<disp-quote content-type="editor-comment">
<p>The study does not experimentally validate any of the refined gene expression predictions, which was one of the main strengths of the initial CenGEN publication (Taylor et al, 2021). No validation experiments (e.g., fluorescence reporters or single molecule FISH) were performed for protein-coding or non-coding genes, which makes it difficult for the reader to assess how much gene predictions are improved, other than for the gold standard set, which may have specific characteristics (e.g., bias toward high expression as they were primarily identified in fluorescence reporter experiments).</p>
</disp-quote>
<p>We agree that evaluating only highly-expressed genes might introduce bias. We used a large battery of in vivo reporters, made with best-available technology (CRISPR insertion of the fluorophore into the endogenous locus) to evaluate our approaches. These reporters were constructed without bias in terms of gene expression and therefore represent both high and low expression levels. These data are represented throughout the manuscript (for example, in ROC curves). Details about the battery of reporters may be found in Taylor et al 2021. In addition to these reporters, this manuscript also generates and analyzes two other types of gene sets: non-neuronal and ubiquitous genes. Again, these genes are selected without bias toward gene expression, and the techniques presented here are benchmarked against them as well, with positive results.</p>
<disp-quote content-type="editor-comment">
<p>The study notes that bulk RNA-seq data, in contrast to scRNA-seq data, can be used to identify which isoforms are expressed in a given cell. However, no analysis or genome browser tracks were supplied in the study to take advantage of this important information. For the community, isoform-specific expression could guide the design of cell-specific expression constructs or for predictive modeling of gene expression based on machine learning.</p>
</disp-quote>
<p>We strongly agree that these datasets allow for new discoveries in neuronal splicing patterns and regulators, which is explored further in other publications from our group and other research groups in the field. We did not sufficiently highlight these works in the body of our text, and have added a reference in the discussion. “In addition, the bulk RNA-seq dataset contains transcript information across the gene body, which parallel efforts have used to identify mRNA splicing patterns that are not found in the scRNA-seq dataset.” These works can be found in references 26 and 27.</p>
<disp-quote content-type="editor-comment">
<p>(1) The study relies on thresholding to determine whether a gene is expressed or not. While this is a common practice, the choice of threshold is not thoroughly justified. In particular, the choice of two uniform cutoffs across protein-encoding RNAs and of one distinct threshold for non-coding RNAs is somewhat arbitrary and has several limitations. This reviewer recommends the authors attempt to use adaptive threshold-methods that define gene expression thresholds on a per-gene basis. Some of these methods include GiniClust2, Brennecke's variance modeling, HVG in Seurat, BASiCS, and/or MAST Hurdle model for dropout correction.</p>
</disp-quote>
<p>We appreciate the reviewer’s suggestion, and would note that the integrated data currently incorporates some gene-specific weighting to identify gene expression patterns, as the single-cell data are weighted by maximum expression for each gene prior to integration with the LittleBites cleaned data. This gene level normalization markedly improved gene detection accuracy, and is discussed in depth in our 2021 Paper “Molecular topography of an entire nervous system”. We previously explored several methods for setting gene specific thresholds for identifying gene expression patterns in the integrated dataset. Unfortunately we found that none of the tested methods out performed setting “static” thresholds across all genes in the integrated dataset, and tended to increase false positive rates for some low abundance genes, where gene-specific thresholding can tend towards calling a gene expressed in at least one cell type when it is actually not expressed in any cell types present. These methods are likely to provide better results for expanded datasets that cover all tissue types (where one might reasonably expect that a gene is likely to be expressed in at least one sample).</p>
<disp-quote content-type="editor-comment">
<p>(2) Most importantly, the study lacks independent experimental validation (e.g., qPCR, smFISH, or in situ hybridization) to confirm the expression of newly detected lowly expressed genes and non-coding RNAs. This is particularly important for validating novel neuronal non-coding RNAs, which are primarily inferred from computational approaches.</p>
</disp-quote>
<p>We agree that smFISH and related <italic>in situ</italic> validation methods would be an asset in this analysis. Unfortunately because most ncRNAs are very short, they are prohibitively difficult to accurately measure with smFISH. Many ncRNAs we attempted to assay with smFISH methods can bind at most 3 fluorescent probes, which unfortunately was not reliably distinguishable from background autofluorescence in the worm. Many published methods for smFISH signal amplification have not been optimized for <italic>C. elegans</italic>, and the tough cuticle is a major barrier for those efforts.</p>
<disp-quote content-type="editor-comment">
<p>(3) The novel biology is somewhat limited. One potential area of exploration would be to look at cell-type specific alternative splicing events.</p>
</disp-quote>
<p>We appreciate this suggestion. Indeed, as we put our source data online prior to publishing this manuscript, two published papers already use this source data set to analyze alternative splicing. Further, these works include validation of splicing patterns observed in this source data, indicating the biological relevance of these data sets.</p>
<disp-quote content-type="editor-comment">
<p>(4) The integration method disproportionately benefits neuron types with limited representation in scRNA-seq, meaning well-sampled neuron types may not show significant improvement. The authors should quantify the impact of this bias on the final dataset.</p>
</disp-quote>
<p>We agree that cell-types that are well represented in the single-cell dataset tend to have fewer new genes identified in the Integrated dataset than “rare” cell-types in the single cell data. However we would note that cell-types that are highly abundant in the single-cell data appear to become increasingly vulnerable to non-neuronal false positives, and that integration’s primary effect in high abundance cell-types appears to be reducing the false positive rate for non-neuronal genes. Thus we suggest that integration benefits all cell-types across the spectrum of single-cell abundance. The false positives are likely caused by a side-effect of normalization steps in the single-cell dataset, which is moderated by using the LittleBites cleaned bulk samples as an orthogonal measurement. The benefit of integration for cell-types with low abundance in the single-cell dataset is now quantified, and the benefits of integration for low and high abundance cell-types from the single cell data are described in the following section (p.13):</p>
<p>“To test the stability of LittleBites cleanup across different single-cell reference dataset qualities, we ran the algorithm on a set of bulk samples by first subsetting the corresponding single-cell cluster’s population to 10, 50, 100, or 500 cells. We performed this process 500 times for each subsampling rate for each sample (2000 total runs per sample). We found that testing gene AUROC values are stable across reference cluster sizes (Fig. 2D), suggesting that even if the target cell type is rarely represented in a single cell reference, accurate cleaning is still possible. However, comparing gene level stability across target cluster population levels reveals that low abundance references have higher gene level variance (Fig. 2E), lower purity estimates (Fig. S2F), higher variance in the mean expression across genes (Fig. S2G), and they tend to have lower overall expression (suggesting more aggressive subtraction) (Fig. S2H). This indicates that while binary gene calling is improved even if the reference cluster is small, users should be cautious when using fewer than 100 cells in their single cell reference cluster as the resulting cleanup is less stable.”</p>
<disp-quote content-type="editor-comment">
<p>(5) The authors employ a logit transformation to model single-cell proportions into count space, but they need to clarify its assumptions and potential pitfalls (e.g., how it handles rare cell types).</p>
</disp-quote>
<p>We agree that the assumptions and pitfalls of the logit model are key for evaluating its usefulness, especially for cell types that are rarely captured in the single-cell dataset. The assumptions and pitfalls are described in the methods section, but we regretfully omitted any mention of those pitfalls in the results, which we have now rectified.</p>
<p>The description in the methods section is: “We applied this formula to our real single cell dataset and used this equation to transform proportion measures of gene expression into a count space to generate the Prop2Count dataset for downstream analysis and integration with bulk datasets. This procedure allows for proportions data to be used in downstream analyses that work with counts datasets. However, it does limit the range of potential values that each gene can have, with the potential values set as: <inline-formula id="sa4equ1"><inline-graphic xlink:href="elife-106183-sa4-equ1.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula></p>
<p>As n approaches 0, the number of potential values decreases, which can be incompatible with some downstream models. Thus, caution should be used when applying this transformation to datasets with few cells.”</p>
<p>The new mention in the results is: “However, caution should be taken when using this approach in scRNAseq cases where all replicates of a cell type contain few cells. scProp2Count values are limited to the space of possible proportion values, and so replicates with low numbers of cells will have fewer potential expression “levels” which may break some model assumptions in downstream applications (see Methods).”</p>
<disp-quote content-type="editor-comment">
<p>(6) The LittleBites approach is highly dependent on the accuracy of existing single-cell references. If the scRNA-seq dataset is incomplete or contains classification biases, this could propagate errors into the bulk RNA-seq data. The authors may want to discuss potential limitations and sensitivity to errors in the single-cell dataset, and it is critical to define minimum quality parameters (e.g. via modeling) for the scRNAseq dataset used as reference.</p>
</disp-quote>
<p>We appreciate this suggestion, and agree that manuscript would benefit from a description of where the LittleBites method can give poor results. To this end, we subset our single cell reference for individual neurons of interest to the level of 10, 50, 100, or 500 cells (500 iterations per sample rate), and then ran Littlebites, and compared metrics of gene expression stability, sample composition estimates, and AUROC performance on test genes. We found that when fewer than 100 cells for the target cell type are included in the single cell reference, gene expression stability drops (variance between subsampling iterations was much higher when fewer reference cells were used). However, we found that AUROC values were consistently high regardless of how many reference cells were included, but that this stability in AUROC values was paired with lower overall counts in samples with &lt;100 reference cells after cleanup. This indicates that in cases where few reference cells are present, higher AUROC values might be achieved by more aggressive subtraction, which is attenuated when the reference model is more complete. This analysis is shown in figure 2 and figure S2, and described in the results section, recreated here.</p>
<p>“To test the stability of Littlebites cleanup across different single-cell reference dataset qualities, we ran the algorithm on a set of bulk samples by first subsetting the corresponding single-cell cluster’s population to 10, 50, 100, or 500 cells. We performed this process 500 times for each subsampling rate for each sample (2000 total runs per sample). We found that testing gene AUROC values are stable across reference cluster sizes (Fig. 2D), suggesting that even if the target cell type is rarely represented in a single cell reference, accurate cleaning is still possible. However, comparing gene level stability across target cluster population levels reveals that low population references have higher gene level variance (Fig. 2E), lower purity estimates (Fig. S2F), higher variance in the mean expression across genes (Fig. S2G), and they tend to have lower overall expression (suggesting more aggressive subtraction) (Fig. S2H). This suggests that while binary gene calling is improved similarly even if the reference cluster is small, users should be cautious when using less than 100 cells in their single cell reference cluster as the resulting cleanup is less stable.”</p>
<disp-quote content-type="editor-comment">
<p>(7) Also very important, the LittleBites method could benefit from a more intuitive explanation and schematic to improve accessibility for non-computational readers. A supplementary step-by-step breakdown of the subtraction process would be useful.</p>
</disp-quote>
<p>We appreciate this suggestion and implemented a step-by-steo breakdown of the subtraction process in the methods section, also copied below. We also updated the graphic representation in figure 2A.</p>
<p>“LittleBites Subtraction algorithm</p>
<p>LittleBites is an iterative algorithm for bulk RNA-seq datasets, that improves the accuracy of cell-type specific bulk RNA-seq sample profiles by removing counts from non-target contaminants (e.g. ambient RNA from dead cells, carry-over non-target cells from FACS enrichment due to imperfect gating). This method leverages single cell reference datasets and ground truth expression information to guide iterative and conservative subtraction to enrich for true target cell-type expression. Using this approach, LittleBites balances subtraction by optimizing using both a single-cell reference, and an orthogonal ground truth reference, moderating biases inherent to either reference.</p>
<p>This algorithm first calculates gene level specificity weights in a single cell reference dataset using SPM (Specificity Preservation Method) (re-add 22, re-add 23). SPM assigns high weights (approaching 1) to genes expressed in single cell types while applying conservative weights to genes with broader expression patterns, which helps to reduce inappropriate subtraction.</p>
<p>The algorithm proceeds in a loop of three steps:</p>
<p>Step 1: Estimate Contamination. Each bulk sample is modeled as the sum of a linear combination of single-cell profiles (target cell type and likely contaminants) using non-negative least squares (NNLS). The resulting coefficients provide the estimate of how much of the sample’s counts come from the target cell-type, and how much comes from each contaminant cell-type.</p>
<p>Step 2: Weighted Subtraction. Each bulk sample is cleaned by subtracting the weighted sum of contaminant single-cell profiles. This subtraction is attempted multiple times (separately) across a series of learning rate weights (usually ranging from 0-1) which moderate the size of the subtraction step (Equation 1). This produces a range of possible “cleaned” sample options for evaluation.</p>
<p>Step 3: Performance Optimization. For each learning rate, the cleaned result is evaluated against a set of ground truth genes by calculating the area under the receiver operating characteristic curve (AUROC). The learning rate that optimizes the AUROC is then selected. When multiple learning rates yielded equivalent AUROC values, the lowest learning rate value is chosen to minimize subtraction.</p>
<p>If the optimal learning rate at Step 3 is 0 (no subtraction option beats the baseline) then the loop is halted. Else, the cleaned bulk profile is returned to Step 1, and the loop continues until the AUROC cannot be improved upon using the single-cell reference modeling.“</p>
<disp-quote content-type="editor-comment">
<p>(8) In the same vein, the ROC curves and AUROC comparisons should have clearer annotations to make results more interpretable for readers unfamiliar with these metrics.</p>
</disp-quote>
<p>We agree that the ROC and AUROC metrics need a clearer explanation to make their use and interpretations clearer. We included a description of both metrics, and a suggestion for how to interpret them in the results section, copied below.</p>
<p>“To evaluate the post-subtraction datasets accuracy we used the area under the Receiver-Operator Characteristic (AUROC) score. In brief, we set a wide range of thresholds to call genes expressed or unexpressed, and then compared it to expected expression from a set of ground truth genes. This comparison produces a true positive rate (TPR, the percentage of truly expressed genes that are called expressed), and false positive rate (FPR, the percentage of truly not expressed genes that are called expressed), and a false discovery rate (FDR, the percentage of genes called expressed that are truly not expressed). The Receiver-Operator Characteristic (ROC) is the graph of the line produced by the TPR and FPR values across the range of thresholds tested, and the AUROC is calculated as the sum of the area under that line. A “random” model of gene expression is expected to have an AUROC value of 0.5, and a “perfect” model is expected to have an AUROC value of 1. Thus, AUROCs below 0.5 are worse than a random guess, and values closer to 1 indicate higher accuracy.”</p>
<disp-quote content-type="editor-comment">
<p>(9) Finally, after the correlation-based decontamination of the 4,440 'unexpressed' genes, how many were ultimately discarded as non-neuronal?</p>
<p>a) Among these non-neuronal genes, how many were actually known neuronal genes or components of neuronal pathways (e.g., genes involved in serotonin synthesis, synaptic function, or axon guidance)?</p>
<p>b) Conversely, among the &quot;unexpressed&quot; genes classified as neuronal, how many were likely not neuron-specific (e.g., housekeeping genes) or even clearly non-neuronal (e.g., myosin or other muscle-specific markers)?</p>
</disp-quote>
<p>Combined with point 10, see below.</p>
<disp-quote content-type="editor-comment">
<p>(10) To increase transparency and allow readers to probe false positives and false negatives, I suggest the inclusion of:</p>
<p>a) The full list of all 4,440 'unexpressed' genes and their classification at each refinement step. In that list flag the subsets of genes potentially misclassified, including:</p>
<p>- Neuronal genes wrongly discarded as non-neuronal.</p>
<p>- Non-neuronal genes wrongly retained as neuronal.</p>
<p>b) Add a certainty or likelihood ranking that quantifies confidence in each classification decision, helping readers validate neuronal vs. non-neuronal RNA assignments.</p>
<p>This addition would enhance transparency, reproducibility, and community engagement, ensuring that key neuronal genes are not erroneously discarded while minimizing false positives from contaminant-derived transcripts.</p>
</disp-quote>
<p>We agree that the genes called “unexpressed” in the single-cell data need more context and clarity. First, we trimmed the list to only include 2,333 genes of highest confidence. Second, for those genes we identified any with published neuronal expression patterns. Identifying genes that were retained as neuronal but are likely non-neuronal in origin is difficult as many markers are expressed in a mixture of neuronal and non-neuronal cell-types, however we used a curated list of putative non-neuronal markers to assess the accuracy of the integrated data (see supplementary table 4), and established that most non-neuronal markers are undetected in the integrated data, with the number of detected genes decreasing as our threshold stringency increases. Of note, a few putative non-neuronal genes remain detected even at high thresholds, indicating that our dataset still retains a small percentage of neuronal false positives. This result has been collected in the new supplementary figure 4F, and addressed in the following text in the results section “Testing against a curated list of non-neuronal genes from fluorescent reporters and genomic enrichment studies, we found that of 445 non-neuronal markers, each gene was detected in an average of 12.5 cells or a median of 3 cells in the single-cell dataset, and an average of 8.7 cells or a median of 1 cell in the integrated dataset, at a 14% FDR threshold.”</p>
<p>We also included a list of “unexpressed” gene identities and tissue annotations as new supplementary tables 16 and 17.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Recommendations for the authors):</bold></p>
<p>The utility of the bulk RNA-seq data would be significantly increased if the authors were to analyze which isoforms are expressed in individual neurons. Also, it would be very useful to know if there are instances where a gene is expressed in several neurons, but different isoforms are specific to individual neurons.</p>
</disp-quote>
<p>We appreciate this suggestion. Indeed, as we put our source data online prior to publishing this manuscript, two published papers already use this source data set to analyze alternative splicing. Further, these works include validation of splicing patterns observed in this source data, indicating the biological relevance of these data sets. This is now noted in our discussion section “In addition, the bulk RNA-seq dataset contains transcript information across the gene body, which parallel efforts have used to identify mRNA splicing patterns that are not found in the scRNA-seq dataset.” These works can be found in references 26 and 27.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Recommendations for the authors):</bold></p>
<p>(1) Describe the number of L4 animals processed to obtain good-quality bulk RNAseq libraries from the different neuronal types. If the number of worms would be different for different neuronal types, then please make a supplementary table listing the minimum number of worms needed for each neuronal type.</p>
</disp-quote>
<p>We appreciate the reviewer’s recommendation, and agree that it would be a useful resource to provide suggestions for how many worms are needed per experiment. Unfortunately We did not track the total number of animals for each sample. We aimed to start with 200-300 ul of packed worms for each strain, generally equating to &gt;500,000 worms, but yields of FACS-isolated cells varied among cell types. Because replicates for specific neuron types were also variable in some instances (See additions to supplemental Table 1), yields likely depend on multiple factors. We have previously noted (Taylor et al., 2021), for example, that some cell types were under-represented in scRNA-seq data (e.g, pharyngeal neurons) based on in vivo abundance presumptively due to the difficulty of isolation or sub-viability in the cell dissociation-FACS protocol.</p>
<disp-quote content-type="editor-comment">
<p>(2) List the thresholds for the parameters used during the FASTQC quality control and the threshold number of reads that would make a sample not useful.</p>
</disp-quote>
<p>We now include parameters for sample exclusion in the methods section. “Samples were excluded after sequencing if they had: fewer than 1 million read pairs, &lt;1% of uniquely mapping reads to the C. elegans genome, &gt; 50% duplicate reads (low umi diversity), or failed deduplication steps in the nudup package.”</p>
<disp-quote content-type="editor-comment">
<p>(3) In Figure 5C, include an overlapping bar that shows the total number of genes in each cell type. You may need to use a log scale to see both (new and all) numbers of genes in the same graph. Add supplementary tables with the names of all new genes assigned to each neuronal type.</p>
</disp-quote>
<p>We agree that this figure panel needed additional context. On further reflection we concluded that figure 5 was not sufficiently distinct from figure 4 to warrant separation, and incorporated some key findings from figure 5 into figure S4.</p>
</body>
</sub-article>
</article>