<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">95127</article-id>
<article-id pub-id-type="doi">10.7554/eLife.95127</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.95127.3</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.7</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Uncertainty-modulated prediction errors in cortical microcircuits</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4948-1864</contrib-id>
<name>
<surname>Wilmes</surname>
<given-names>Katharina A</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>katharina.wilmes@unibe.ch</email>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Petrovici</surname>
<given-names>Mihai A</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sachidhanandam</surname>
<given-names>Shankar</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Senn</surname>
<given-names>Walter</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02k7v4d05</institution-id><institution>Department of Physiology, University of Bern</institution></institution-wrap>, <city>Bern</city>, <country>Switzerland</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Keller</surname>
<given-names>Georg B</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Friedrich Miescher Institute</institution>
</institution-wrap>
<city>Basel</city>
<country>Switzerland</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Poirazi</surname>
<given-names>Panayiota</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>FORTH Institute of Molecular Biology and Biotechnology</institution>
</institution-wrap>
<city>Heraklion</city>
<country>Greece</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing Interest Statement: The authors have declared no competing interest.</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-02-27">
<day>27</day>
<month>02</month>
<year>2024</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-01-22">
<day>22</day>
<month>01</month>
<year>2025</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP95127</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-12-20">
<day>20</day>
<month>12</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-12-06">
<day>06</day>
<month>12</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.05.11.540393"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-02-27">
<day>27</day>
<month>02</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.95127.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.95127.1.sa3">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.95127.1.sa2">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.95127.1.sa1">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.95127.1.sa0">Reviewer #3 (Public Review):</self-uri>
</event>
<event>
<event-desc>Reviewed preprint v2</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-09-27">
<day>27</day>
<month>09</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.95127.2"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.95127.2.sa3">eLife Assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.95127.2.sa2">Reviewer #2 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.95127.2.sa1">Reviewer #4 (Public review):</self-uri>
<self-uri content-type="author-comment" xlink:href="https://doi.org/10.7554/eLife.95127.2.sa0">Author response:</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>¬© 2024, Wilmes et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Wilmes et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-95127-v3.pdf"/>
<abstract>
<title>Abstract</title>
<p>Understanding the variability of the environment is essential to function in everyday life. The brain must hence take uncertainty into account when updating its internal model of the world. The basis for updating the model are prediction errors that arise from a difference between the current model and new sensory experiences. Although prediction error neurons have been identified in layer 2/3 of diverse brain areas, how uncertainty modulates these errors and hence learning is, however, unclear. Here, we use a normative approach to derive how uncertainty should modulate prediction errors and postulate that layer 2/3 neurons represent uncertainty-modulated prediction errors (UPE). We further hypothesise that the layer 2/3 circuit calculates the UPE through the subtractive and divisive inhibition by different inhibitory cell types. By implementing the calculation of UPEs in a microcircuit model, we show that different cell types can compute the means and variances of the stimulus distribution. With local activity-dependent plasticity rules, these computations can be learned context-dependently, and allow the prediction of upcoming stimuli and their distribution. Finally, the mechanism enables an organism to optimise its learning strategy via adaptive learning rates.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>A few changes to the text.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Decades of cognitive research indicate that our brain maintains a model of the world, based on which it can make pre-dictions about upcoming stimuli [<xref ref-type="bibr" rid="c48">48</xref>, <xref ref-type="bibr" rid="c11">11</xref>]. Predicting the sensory experience is useful for both perception and learning: Perception becomes more tolerant to uncertainty and noise when sensory information and predictions are integrated [<xref ref-type="bibr" rid="c58">58</xref>]. Learning can happen when predictions are compared to sensory information, as the resulting prediction error indicates how to improve the internal model. In both cases, the uncertainties (associated with both the sensory information and the internal model) should determine how much weight we give to the sensory information relative to the predictions, according to theoretical accounts. Behavioural and electrophysiological studies indicate that humans indeed estimate uncertainty and adjust their behaviour accordingly [<xref ref-type="bibr" rid="c58">58</xref>, <xref ref-type="bibr" rid="c76">76</xref>, <xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c46">46</xref>]. The neural mechanisms underlying uncertainty and prediction error computation are, however, less well understood. Recently, the activity of individual neurons of layer 2/3 cortical circuits in diverse cortical areas of mouse brains has been linked to prediction errors (visual, [<xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c82">82</xref>, <xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c26">26</xref>], auditory [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c43">43</xref>], somatosensory [<xref ref-type="bibr" rid="c5">5</xref>], and posterior parietal [<xref ref-type="bibr" rid="c65">65</xref>]). Importantly, prediction errors could be associated with learning [<xref ref-type="bibr" rid="c40">40</xref>]. Prediction error neurons are embedded in neural circuits that consist of heterogeneous cell types, most of which are inhibitory. It has been suggested that prediction error activity results from an imbalance of excitatory and inhibitory inputs [<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c32">32</xref>], and that the prediction is subtracted from the sensory input [see e.g. <xref ref-type="bibr" rid="c66">66</xref>, <xref ref-type="bibr" rid="c4">4</xref>], possibly mediated by so-called somatostatin-positive interneurons (SSTs) [<xref ref-type="bibr" rid="c4">4</xref>]. How uncertainty is influencing these computations has not yet been investigated. Prediction error neurons receive inputs from a diversity of inhibitory cell types, the role of which is not completely understood. Here, we hypothesise that one role of inhibition is to modulate the prediction error neuron activity by uncertainty.</p>
<p>In this study, we use both analytical calculations and numerical simulations of rate-based circuit models with different inhibitory cell types to study circuit mechanisms leading to uncertainty-modulated prediction errors. First, we derive that uncertainty should divisively modulate prediction error activity and introduce uncertainty-modulated prediction errors (UPEs). We hypothesise that, first, layer 2/3 prediction error neurons reflect such UPEs. Second, we hypothesise that different inhibitory cell types are involved in calculating the difference between predictions and stimuli, and in the uncertainty modulation, respectively. Based on experimental findings, we suggest that SSTs and PVs play the respective roles. We then derive biologically plausible plasticity rules that enable those cell types to learn the means and variances from their inputs. Notably, because the information about the stimulus distribution is stored in the connectivity, single inhibitory cells encode the means and variances of their inputs in a context-dependent manner. Layer 2/3 pyramidal cells in this model hence encode uncertainty-modulated prediction errors context-dependently. We show that error neurons can additionally implement out-of-distribution detection by amplifying large errors and reducing small errors with a nonlinear fI-curve (activation function). Finally, we demonstrate that UPEs effectively mediate an adjustable learning rate, which allows fast learning in high-certainty contexts and reduces the learning rate, thus suppressing fluctuations in uncertain contexts.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Normative theories suggest uncertainty-modulated prediction errors (UPEs)</title>
<p>In a complex, uncertain, and hence partly unpredictable world, it is impossible to avoid prediction errors. Some pre-diction errors will be the result of this variability or noise, other prediction errors will be the result of a change in the environment or new information. Ideally, only the latter should be used for learning, i.e., updating the current model of the world. The challenge our brain faces is to learn from prediction errors that result from new information, and less from prediction errors that result from noise. Hence, intuitively, if we learned that a kind of stimulus or context is very variable (high uncertainty), then a prediction error should have only little influence on our model. Consider a situation in which a person waits for a bus to arrive. If they learned that the bus is not reliable, another late arrival of the bus does not surprise them and does not change their model of the bus (<xref rid="fig1" ref-type="fig">Fig. 1A</xref>). If, on the contrary, they learned that the kind of stimulus or context is not very variable (low uncertainty), a prediction error should have a larger impact on their model. For example, if they learned that buses are reliable, they will notice that the bus is late and may use this information to update their model of the bus (<xref rid="fig1" ref-type="fig">Fig. 1A</xref>). This intuition of modulating prediction errors by the uncertainty associated with the stimulus or context is supported by both behavioural studies and normative theories of learning. Here we take the view that uncertainty is computed and represented on each level of the cortical hierarchy, from early sensory areas to higher level brain areas, as opposed to a task-specific uncertainty estimate at the level of decision-making in higher level brain areas (<xref rid="fig1" ref-type="fig">Fig. 1B</xref>) [see this review for a comparison of these two accounts: <xref ref-type="bibr" rid="c84">84</xref>].</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Distributed uncertainty-modulated prediction error computation in cortical circuits</title>
<p>A: A person who learned that buses are unreliable has a prior expectation, which can be described by a wide Gaussian distribution of expected bus arrival times. When the bus does not arrive at the scheduled time, this person is not surprised and remains calm, as everything happens according to their model of the world. On the other hand, a person who learned that buses are punctual, which can be described by a narrow distribution of arrival times, may notice that the bus is late and get nervous, as they expected the bus to be punctual. This person can learn from this experience. If they always took this particular bus, and their uncertainty estimate is accurate, the prediction error could indicate that the bus schedule changed. B: Models of uncertainty representation in cortex. Some models suggest that uncertainty is only represented in higher-level areas concerned with decision-making (left). In contrast, we propose that uncertainty is represented at each level of the cortical hierarchy (right, shown is the visual hierarchy as an example). C: a mouse learns the association between a sound (<italic>a</italic>) and a whisker deflection (<italic>s</italic>). The posterior parietal cortex (PPC) receives inputs from both somatosensory and auditory cortex. D: The whisker stimulus intensities are drawn from a Gaussian distribution with mean <italic>¬µ</italic> and standard deviation <italic>œÉ</italic>. E: Negative (left) and positive (right) prediction error circuit consisting of three cell types: layer 2/3 pyramidal cells (triangle), somatostatin-positive interneurons (SST, circle) and parvalbumin-positive interneurons (PV). SSTs represent the mean prediction in the postive circuit and the stimulus in the negative circuit, and PVs represent the variance.</p></caption>
<graphic xlink:href="540393v7_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Before we suggest how cortical circuits compute such uncertainty-modulated prediction errors, we consider the normative solution to a simple association that a mouse can learn. The setting we consider is to predict a somatosensory stimulus based on an auditory stimulus. The auditory stimulus <italic>a</italic> is fixed, and the subsequent somatosensory stimulus <italic>s</italic> is variable and sampled from a Gaussian distribution (s ‚àº ùí© (<italic>¬µ, œÉ</italic>), <xref rid="fig1" ref-type="fig">Fig. 1C,D</xref>). The optimal (maximum-likelihood) prediction is given by the mean of the stimulus distribution. Framed as an optimisation problem, the goal is to adapt the internal model of the mean <inline-formula><inline-graphic xlink:href="540393v7_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> such that the probability of observing samples <italic>s</italic> from the true distribution of whisker deflections is maximised given this model.</p>
<p>Hence, stochastic gradient ascent learning on the log-likelihood suggests that with each observation <italic>s</italic>, the prediction (corresponding to the internal model of the mean) should be updated as follows to approach the maximum likelihood solution:
<disp-formula id="eqn1">
<graphic xlink:href="540393v7_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where L is the likelihood.</p>
<p>According to this formulation, the update for the internal model should be the prediction error scaled inversely by the variance <italic>œÉ</italic><sup>2</sup>. Therefore, we propose that prediction errors should be modulated by uncertainty.</p>
</sec>
<sec id="s2b">
<title>Computation of UPEs in cortical microcircuits</title>
<p>How can cortical microcircuits achieve uncertainty modulation? Prediction errors can be positive or negative, but neuronal firing rates are always positive. Because baseline firing rates are low in layer 2/3 pyramidal cells [e.g., <xref ref-type="bibr" rid="c57">57</xref>], positive and negative prediction errors were suggested to be represented by distinct neuronal populations [<xref ref-type="bibr" rid="c44">44</xref>, <xref ref-type="bibr" rid="c66">66</xref>], which is in line with experimental data [<xref ref-type="bibr" rid="c39">39</xref>]. We, therefore, decompose the UPE into a positive UPE<sup>+</sup> and a negative UPE<sup>‚àí</sup> component (<xref rid="fig1" ref-type="fig">Fig. 1C,D</xref>):
<disp-formula id="eqn2">
<graphic xlink:href="540393v7_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where ‚åä‚Ä¶‚åã <sup>+</sup> denotes rectification at 0.</p>
<p>It has been suggested that error neurons compute prediction errors by subtracting the prediction from the stimulus input (or vice versa) [<xref ref-type="bibr" rid="c4">4</xref>]. The stimulus input can come from local stimulus-encoding layer 2/3 cells [<xref ref-type="bibr" rid="c65">65</xref>]. Inhibitory interneurons provide the subtraction, resulting in an excitation-inhibition balance when they match [<xref ref-type="bibr" rid="c34">34</xref>]. To represent a UPE, error neurons need additionally be divisively modulated by the uncertainty. Depending on synaptic properties, such as reversal potentials, inhibitory neurons can have subtractive or divisive influences on their postsynaptic targets. Therefore, we propose that an inhibitory cell type that divisively modulates prediction error activity represents the uncertainty. We hypothesise, first, that in positive prediction error circuits, inhibitory interneurons with subtractive inhibitory effects represent the mean <italic>¬µ</italic> of the prediction. They probably either inherit the mean prediction or calculate it locally. Second, we hypothesise that inhibitory interneurons with divisive inhibitory effects represent the uncertainty <italic>œÉ</italic><sup>2</sup> of the prediction (<xref rid="fig1" ref-type="fig">Fig. 1C,D</xref>), which they calculate locally. A layer 2/3 pyramidal cell that receives these sources of inhibition then reflects the uncertainty-modulated prediction error (<xref rid="fig1" ref-type="fig">Fig. 1E,F</xref>).</p>
<p>More specifically, we propose, first, that the SSTs are involved in the computation of the difference between predictions and stimuli, as suggested before [<xref ref-type="bibr" rid="c4">4</xref>]. This subtraction could happen on the apical dendrite. Second, we propose that the PVs provide the uncertainty modulation. In line with this, prediction error neurons in layer 2/3 receive subtractive inhibition from somatostatin (SST) and divisive inhibition from parvalbumin (PV) interneurons [<xref ref-type="bibr" rid="c81">81</xref>]. However, SSTs can also have divisive effects, and PVs can have subtractive effects, dependent on circuit and postsynaptic properties [<xref ref-type="bibr" rid="c71">71</xref>, <xref ref-type="bibr" rid="c51">51</xref>, <xref ref-type="bibr" rid="c15">15</xref>].</p>
<p>In the following, we investigate circuits of prediction error neurons and different inhibitory cell types. We start by investigating in local positive and negative prediction error circuits whether the inhibitory cell types can locally learn to predict means and variances, before combining both subcircuits into a recurrent circuit consisting of both positive and negative prediction error neurons.</p>
</sec>
<sec id="s2c">
<title>Local inhibitory cells learn to represent the mean and the variance given an associative cue</title>
<p>As discussed above, how much an individual sensory input contributes to updating the internal model should depend on the uncertainty associated with the sensory stimulus in its current context. Uncertainty estimation requires multiple stimulus samples. Therefore, our brain needs to have a context-dependent mechanism to estimate uncertainty from multiple past instances of the sensory input. Let us consider the simple example from above, in which a sound stimulus represents a context with a particular amount of uncertainty. In terms of neural activity, the context could be encoded in a higher-level representation of the sound. Here, we investigate whether the context representation can elicit activity in the PVs that reflects the expected uncertainty of the situation. To investigate whether the context provided by the sound can cause activity in SSTs and PVs that reflects the mean and the variance of the whisker stimulus distribution, respectively, we simulated a rate-based circuit model consisting of pyramidal cells and the relevant inhibitory cell types. This circuit receives both the sound and the whisker stimuli as inputs.</p>
</sec>
<sec id="s2d">
<title>SSTs learn to estimate the mean</title>
<p>With our circuit model, we first investigate whether SSTs can learn to represent the mean of the stimulus distribution. In this model, SSTs receive whisker stimulus inputs <italic>s</italic>, drawn from Gaussian distributions (<xref rid="fig2" ref-type="fig">Fig. 2B</xref>), and an input from a higher level representation of the sound <italic>a</italic> (which is either on or off, see <xref ref-type="disp-formula" rid="eqn9">Eq. 9</xref> in Methods). The connection weight from the sound representation to the SSTs is plastic according to a local activity-dependent plasticity rule (see <xref ref-type="disp-formula" rid="eqn10">Eq. 10</xref>). The aim of this rule is to minimise the difference between the activation of the SSTs caused by the sound input (which has to be learned) and the activation of the SSTs by the whisker stimulus (which nudges the SST activity in the right direction). The learning rule ensures that the auditory input itself causes SSTs to fire at the desired rate. After learning, the weight and the average SST firing rate reflect the mean of the presented whisker stimulus intensities (<xref rid="fig2" ref-type="fig">Fig. 2C-F</xref>).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><title>SSTs learn to represent the mean context-dependently.</title>
<p>Illustration of the changes in the positive prediction error circuit. Thicker lines denote stronger weights. B: Two different tones (red, orange) are associated with two somatosensory stimulus distributions with different means (red: high, orange: low). C: SST firing rates (mean and std) during stimulus input. D: SST firing rates over time for low (orange) and high (red) stimulus means. E: Weights (mean and std) from sound <italic>a</italic> to SST for different values of <italic>¬µ</italic>. F: SST firing rates (mean and std) for different values of <italic>¬µ</italic>. Mean and std were computed over 1000 data points from timestep 9000 to 10000.</p></caption>
<graphic xlink:href="540393v7_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2e">
<title>PVs learn to estimate the variance context-dependently</title>
<p>We next addressed whether PVs can estimate and learn the variance locally. To estimate the variance of the whisker deflections <italic>s</italic>, the PVs have to estimate <italic>œÉ</italic><sup>2</sup>[<italic>s</italic>] = ùîº<sub><italic>s</italic></sub>[(<italic>s</italic> ‚àí ùîº[<italic>s</italic>])<sup>2</sup>] = ùîº<sub><italic>s</italic></sub>[(<italic>s</italic> ‚àí <italic>¬µ</italic>)<sup>2</sup>]. To do so, they need to have access to both the whisker stimulus <italic>s</italic> and the mean <italic>¬µ</italic>. PVs in PPC respond to sensory inputs in diverse cortical areas [S1: 69] and are inhibited by SSTs in layer 2/3, which we assumed to represent the mean. Finally, for calculating the variance, these inputs need to be squared. PVs were shown to integrate their inputs supralinearly [<xref ref-type="bibr" rid="c12">12</xref>], which could help PVs to approximately estimate the variance.</p>
<p>In our circuit model, we next tested whether the PVs can learn to represent the variance of an upcoming whisker stimulus based on a context provided by an auditory input (<xref rid="fig3" ref-type="fig">Fig. 3A</xref>). Two different auditory inputs (<xref rid="fig3" ref-type="fig">Fig. 3B</xref> purple, green) are paired with two whisker stimulus distributions that differ in their variances (green: low, purple: high). PVs receive both the stimulus input as well as the inhibition from the SSTs, which subtracts the prediction of the mean (<xref ref-type="disp-formula" rid="eqn11">Eq. 11</xref>). The synaptic connection from the auditory input to the PVs is plastic according to the same local activity-dependent plasticity rule as the connection to the SSTs (<xref ref-type="disp-formula" rid="eqn13">Eq. 13</xref>). With this learning rule, the weight onto the PV becomes proportional to <italic>œÉ</italic> (<xref rid="fig3" ref-type="fig">Fig. 3C</xref>), such that the PV firing rate becomes proportional to <italic>œÉ</italic><sup>2</sup> on average (<xref rid="fig3" ref-type="fig">Fig. 3D</xref>). The average PV firing rate is exactly proportional to <italic>œÉ</italic><sup>2</sup> assuming a quadratic activation function <italic>œï</italic><sub><italic>P V</italic></sub> (<italic>x</italic>) (<xref rid="fig3" ref-type="fig">Fig. 3D-F,H</xref>) and monotonically increasing with <italic>œÉ</italic><sup>2</sup> with other choices of activation functions (Suppl. Fig. 10), both when the sound input is presented alone (<xref rid="fig3" ref-type="fig">Fig. 3D,E,H</xref>) or when paired with whisker stimulation (<xref rid="fig3" ref-type="fig">Fig. 3F</xref>). Notably, a single PV neuron is sufficient for encoding variances of different contexts because the context-dependent <italic>œÉ</italic> is stored in the connection weights.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><title>PVs learn to estimate the variance context-dependently.</title>
<p>A: Illustration of the changes in the positive prediction error circuit. Thicker lines denote stronger weights. B: Two different tones (purple, green) are associated with two somatosensory stimulus distributions with different variances (purple: high, green: low). C: Weights from sound <italic>a</italic> to PV over time for two different values of stimulus variance (high: <italic>œÉ</italic> = 0.8 (purple), low: <italic>œÉ</italic> = 0.4 (green)). D: PV firing rates over time given sound input (without whisker stimulus input) for low (green) and high (purple) stimulus variance. E: PV firing rates (mean and std) given sound input and whisker stimuli for low and high stimulus variance. F: PV firing rates (mean and std) during sound and stimulus input. G: Weights (mean and std) from sound <italic>a</italic> to PV for different values of <italic>œÉ</italic>. H: PV firing rates (mean and std) given sound input for different values of <italic>œÉ</italic><sup>2</sup>. Mean and std were computed from 150000 data points from timestep 450000 to 600000.</p></caption>
<graphic xlink:href="540393v7_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To estimate the variance, the mean needs to be subtracted from the stimulus samples. A faithful mean subtraction is only ensured if the weights from the SSTs to the PVs (<italic>w</italic><sub>PV,SST</sub>) match the weights from the stimuli <italic>s</italic> to the PVs (<italic>w</italic><sub>PV,<italic>s</italic></sub>). The weight <italic>w</italic><sub>PV,SST</sub> can be learned to match the weight <italic>w</italic><sub>PV,<italic>s</italic></sub> with a local activity-dependent plasticity rule (see Suppl. Fig. 11 and Suppl. Methods).</p>
<p>The PVs can similarly estimate the uncertainty in negative prediction error circuits (Suppl. Fig. 12). In these circuits, SSTs represent the current sensory stimulus, and the mean prediction is an excitatory input to both negative prediction error neurons and PVs.</p>
</sec>
<sec id="s2f">
<title>Calculation of the UPE in Layer 2/3 error neurons</title>
<p>Embedded in a circuit with subtractive and divisive interneuron types, layer 2/3 pyramidal cells could first compute the difference between the prediction and the stimulus in their dendrites, before their firing rate is divisively modulated by inhibition close to their soma. Layer 2/3 pyramidal cell dendrites can generate NMDA and calcium spikes, which cause a nonlinear integration of inputs. Hence, we took this into account and modelled the integration of dendritic activity as ‚åä <italic>I</italic><sub>dend</sub> = <italic>w</italic><sub>UPE,<italic>s</italic></sub> <italic>s ‚àí w</italic><sub>UPE,SST</sub> <italic>r</italic><sub>SST</sub>‚åã <sup><italic>k</italic></sup> with <italic>k</italic> determining the non-linearity. The total activity of prediction error neurons was modelled by
<disp-formula id="eqn3">
<graphic xlink:href="540393v7_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The nonlinear integration of inputs is beneficial when the mean input changes and the current prediction differs strongly from the new mean of the stimulus distribution. For example, if the mean input increases strongly, the PV firing rate will increase for larger errors and inhibit error neurons more strongly than indicated by the learned variance estimate. The pyramidal nonlinearity compensates for this increased inhibition by PVs, such that in the end, layer 2/3 cell activity reflects an uncertainty-modulated prediction error (<xref rid="fig4" ref-type="fig">Fig. 4D-F</xref>) in both negative (<xref rid="fig4" ref-type="fig">Fig. 4A</xref>) and positive (<xref rid="fig4" ref-type="fig">Fig. 4B</xref>) prediction error circuits. A stronger nonlinearity (<xref rid="fig4" ref-type="fig">Fig. 4G-I</xref>) has the effect that error neurons elicit larger responses to larger prediction errors.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><title>Calculation of the UPE in layer 2/3 error neurons</title>
<p>A: Illustration of the negative prediction error circuit. B: Distributions with different standard deviations <italic>œÉ</italic>. C: Illustration of the positive prediction error circuit. D: Firing rate of the error neuron in the negative prediction error circuit (UPE<sup>‚àí</sup>) as a function of <italic>œÉ</italic> for two values of |<italic>s</italic> ‚àí <italic>¬µ</italic>| after learning <italic>¬µ</italic> and <italic>œÉ</italic>. E: Rates of both UPE<sup>+</sup> and UPE<sup>‚àí</sup>-representing error neurons with a nonlinear activation function, where <italic>k</italic> = 2.0, as a function of the difference between the stimulus and the mean (<italic>s</italic> ‚àí <italic>¬µ</italic>). F: Firing rate of the error neuron in the positive prediction error circuit (UPE<sup>+</sup>) as a function of <italic>œÉ</italic> for two values of |<italic>s</italic> ‚àí <italic>¬µ</italic> | after learning <italic>¬µ</italic> and <italic>œÉ</italic>. G-I: same as D-F for error neurons with <italic>k</italic> = 2.5 with the same legend as in D-F.</p></caption>
<graphic xlink:href="540393v7_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To ensure a comparison between the stimulus and the prediction, the inhibition from the SSTs needs to match the excitation, which it is compared to, in the UPE neurons: In the positive PE circuit, the weights from the SSTs representing the prediction to the UPE neurons need to match the weights from the stimulus <italic>s</italic> to the UPE neurons. In the negative PE circuit, the weights from SSTs representing the stimulus to the negative UPE neurons need to match the weights from the mean representation to the UPE neurons, respectively. In line with previous proposals, error neuron activity signals the breaking of EI balance [<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c7">7</xref>]. With inhibitory plasticity (target-based, see Suppl. Methods), the weights from the SSTs can learn to match the incoming excitatory weights (Suppl. Fig. 13).</p>
</sec>
<sec id="s2g">
<title>Interactions between representation neurons and error neurons</title>
<p>The theoretical framework of predictive processing includes both prediction error neurons and representation neurons, the activity of which reflects the internal representation and should hence be compared to the sensory information. To make predictions for the activity of representation neurons, we expand our circuit model with this additional cell type. We first show that a representation neuron R can learn a representation of the stimulus mean given inputs from L2/3 error neurons. The representation neuron receives inputs from positive and negative prediction error neurons and from a higher level representation of the sound <italic>a</italic> (<xref rid="fig5" ref-type="fig">Fig. 5A</xref>). It sends its current mean estimate to the error circuits by either targeting the SSTs (in the positive circuit) or the pyramidal cells directly (in the negative circuit). Hence in this recurrent circuit, the SSTs inherit the mean representation instead of learning it. After learning, the weights <italic>w</italic><sub><italic>R,a</italic></sub> from the sound representation to the representation neuron and the average firing rate of this representation neuron reflects the mean of the stimulus distribution (<xref rid="fig5" ref-type="fig">Fig.5B,C</xref>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><title>Learning the mean representation with UPEs</title>
<p>A: Illustration of the circuit. A representation neuron (turquoise) receives input from both positive and negative prediction error circuits (UPE<sup>+</sup> and UPE<sup>‚àí</sup>) and projects back to them. The UPE<sup>‚àí</sup> has a negative impact on the firing rate of the representation neuron (<italic>r</italic><sub><italic>R</italic></sub>). A weight <italic>w</italic><sub><italic>R,a</italic></sub> from the higher level representation of the context given by sound <italic>a</italic> is learned. B: Weights <italic>w</italic><sub><italic>R,a</italic></sub> over time for different values of <italic>¬µ</italic> ‚àà (<italic>¬µ</italic> [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c5">5</xref>]). C: R firing rates given sound input for different values of <italic>¬µ</italic> (mean and std over 50000 data points from timestep 50000 to 100000, the end of the simulation). D: Activity of the different cell types (PV: light green, R: turquiose, UPE: black) and whisker stimulus samples (grey dots) over time. Learning the mean representation with PVs (light green) reflecting the MSE at the beginning, which is compensated by nonlinear activation of L2/3 neurons (black). The evolution of the mean rate of neuron <italic>R</italic> (turquoise) is similar to the perfect case in E. E: Same colour code as in D. Inset shows comparison to D. Learning the mean representation assuming PVs (light green) perfectly represent the variance.</p></caption>
<graphic xlink:href="540393v7_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>As discussed earlier, pyramidal cells tend to integrate their dendritic inputs nonlinearly due to NMDA spikes. We here show that a circuit with prediction error neurons with a dendritic nonlinearity (as in <xref rid="fig4" ref-type="fig">Fig. 4</xref>) approximates an idealised circuit, in which the PV rate perfectly represents the variance (<xref rid="fig5" ref-type="fig">Fig. 5D,E</xref>, see inset for comparison of the two models). The dendritic nonlinearity can hence compensate for PV neuron dynamics. Also in this recurrent circuit, PVs learn to reflect the variance, as the weight from the sound representation <italic>a</italic> is learned to be proportional to <italic>œÉ</italic> (Suppl. Fig. 14).</p>
</sec>
<sec id="s2h">
<title>Predictions for different cell types</title>
<p>Our model makes predictions for the activity of different cell types for positive and negative prediction errors (e.g. when a mouse receives whisker stimuli that are larger (<xref rid="fig6" ref-type="fig">Fig. 6A</xref>, black) or smaller (<xref rid="fig6" ref-type="fig">Fig. 6G</xref>, grey) than expected) in contexts associated with different amounts of uncertainty (e.g., the high-uncertainty (purple) versus the low-uncertainty (green) context are associated with different sounds). Our model suggests that there are two types of interneurons that pro-vide subtractive inhibition to the prediction error neurons (presumably SST subtypes): in the positive prediction error circuit (SST<sup>+</sup>), they signal the expected value of the whisker stimulus intensity (<xref rid="fig6" ref-type="fig">Fig. 6B,H</xref>). in the negative prediction error circuit (SST<sup>‚àí</sup>) they signal the whisker stimulus intensity (<xref rid="fig6" ref-type="fig">Fig. 6C,I</xref>). We further predict that interneurons that divisively modulate prediction error neuron activity represent the uncertainty (presumably PVs). Those do not differ in their activity between positive and negative circuits and may even be shared across the two circuits: in both positive and negative prediction error circuits, these cells signal the variance (<xref rid="fig6" ref-type="fig">Fig. 6D,J</xref>). L2/3 pyramidal cells that encode prediction errors signal uncertainty-modulated positive prediction errors (<xref rid="fig6" ref-type="fig">Fig. 6E</xref>) and uncertainty-modulated negative prediction errors (<xref rid="fig6" ref-type="fig">Fig. 6L</xref>), respectively. Finally, the existence of so-called internal representation neurons has been proposed [<xref ref-type="bibr" rid="c44">44</xref>]. In our case, those neurons represent the predicted mean of the associated whisker deflections. Our model predicts that upon presentation of an unexpected whisker stimulus, those internal representation neurons adjust their activity to represent the new whisker deflection depending on the variability of the associated whisker deflections: they adjust their activity more (given equal deviations from the mean) if the associated whisker deflections are less variable (see the next section and <xref rid="fig7" ref-type="fig">Fig. 7</xref>).</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><title>Cell-type specific experimentally testable predictions</title>
<p>A: Illustration of the two experienced stimulus distributions with different variances that are associated with two different sounds (green, purple). The presented mismatch (MM) stimulus (black) is larger than expected (positive prediction error). B-F: Simulated firing rates of different cell types to positive prediction errors when a sound associated with high (purple) or low (green) uncertainty is presented. G: As in A. The presented mismatch stimulus (grey) is smaller than expected (negative prediction error). H-L: Firing rates of different cell types to the negative mismatch when a sound associated with high (purple) or low (green) uncertainty is presented. Because the firing rate predictions are equal for PV<sup>+</sup> and PV<sup>‚àí</sup>, we only show the results for PV<sup>+</sup> in the figure.</p></caption>
<graphic xlink:href="540393v7_fig6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7:</label>
<caption><title>Effective learning rate is automatically adjusted with UPEs</title>
<p>A,B: Firing rate over time of the representation neuron in a circuit with uncertainty-modulated prediction errors (gold) and in a circuit with unmodulated errors (black) in a low uncertainty setting and a high uncertainty setting (B), C: standard deviation of the firing rate of the representation neuron in the low uncertainty setting (inset has a different scale, outer axis scale matches the one in D), D: standard deviation of the firing rate of the representation neuron in the high uncertainty setting. E: Standard deviation of the firing rate <italic>r</italic><sub><italic>R</italic></sub> as a function of the standard deviation of the presented stimulus distribution <italic>œÉ</italic><sub><italic>s</italic></sub>. Standard deviations were computed over 100000 data points from timestep 100000 to 200000</p></caption>
<graphic xlink:href="540393v7_fig7.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>The following experimental results are compatible with our predictions: First, putative inhibitory neurons (narrow spiking units) in the macaque anterior cingulate cortex increased their firing rates in periods of high uncertainty [<xref ref-type="bibr" rid="c6">6</xref>]. These inhibitory neurons could correspond to the PVs in our model. Second, prediction error activity seems to decrease in less predictable, and hence more uncertain, contexts: in mice reared in a predictable environment [where locomotion and visual flow match 42], error neuron responses to mismatches in locomotion and visual flow decreased with each day of experiencing these unpredictable mismatches. Third, the responses of SSTs and PVs to mismatches between locomotion and visual flow [<xref ref-type="bibr" rid="c4">4</xref>] are in line with our model (note that in this experiment the mismatches are negative prediction errors as visual flow was halted despite ongoing locomotion): In this study, SST responses decreased during mismatch, i.e. when the visual flow was halted, and there was no difference between mice reared in a predictable or unpredictable environment. In line with these observations, the authors concluded that SST responses reflected the actual visual input. In our model negative PE circuit, SSTs also reflect the actual stimulus input, which in our case was a whisker stimulus (SST rates in <xref rid="fig6" ref-type="fig">Fig. 6C</xref> and <xref rid="fig6" ref-type="fig">I</xref> reflect the stimuli (black and grey bar) in A and G, respectively) and SST rates are the same for high and low uncertainty (corresponding to mice reared in a predictable or unpredictable environment). In the same study, PV responses were absent towards mismatches in animals reared in an unpredictable environment [<xref ref-type="bibr" rid="c4">4</xref>]. The authors argued that mice reared in an unpredictable environment did not learn to form a prediction. In our model, the missing prediction corresponds to missing predictive input from the auditory domain (e.g. due to undeveloped synapses from the predictive auditory input). If we removed the predictive input in our model, PVs in the negative PE circuit would also be silent as they would not receive any of the excitatory predictive inputs.</p>
</sec>
<sec id="s2i">
<title>The effective learning rate is automatically adjusted with UPEs</title>
<p>To test whether UPEs can automatically adjust the effective learning rate of a downstream neural population, we looked at two contexts that differed in uncertainty and compared how the mean representation evolves with and without UPEs. Indeed, in a low-uncertainty setting, a new mean representation can be learned faster with UPEs (in comparison to unmodulated, <xref rid="fig7" ref-type="fig">Fig. 7A,C</xref>). In a high-uncertainty setting, the effective learning rate is smaller, and the mean representation is less variable than in the unmodulated case (<xref rid="fig7" ref-type="fig">Fig. 7B,D</xref>). The standard deviation of the firing rate increases only sublinearly with the standard deviation of the inputs (<xref rid="fig7" ref-type="fig">Fig. 7E</xref>). In summary, uncertainty-modulation of prediction errors enables an adaptive learning rate modulation.</p>
</sec>
<sec id="s2j">
<title>UPEs ensure uncertainty-based weighting of prior and sensory information</title>
<p>Behavioural studies suggest that during perception humans integrate priors or predictions (<italic>p</italic>) and sensory information (<italic>s</italic>) in a Bayes-optimal manner [<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c60">60</xref>]. This entails that an internal neural representation (<italic>r</italic>), which determines perception, is achieved by weighting the two according to their uncertainties:
<disp-formula id="eqn4">
<graphic xlink:href="540393v7_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="540393v7_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, <inline-formula><inline-graphic xlink:href="540393v7_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the uncertainty of the sensory information, and <inline-formula><inline-graphic xlink:href="540393v7_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the uncertainty of the prior.</p>
<p>To obtain this weighting in the steady state, prediction errors from the lower area, the sensory prediction error (<italic>s</italic> ‚àí <italic>r</italic>), and from the local area, the representation prediction error (<italic>r</italic> ‚àí <italic>p</italic>), can be used to update the current representation [as in 66]. Maximising the log-likelihood (c.f. <xref ref-type="disp-formula" rid="eqn22">Eq. 22</xref> in Methods and <xref ref-type="disp-formula" rid="eqn36">Eq. 36</xref> in SI) yields an update of the representation by the difference between the bottom-up and top-down prediction errors.
<disp-formula id="eqn5">
<graphic xlink:href="540393v7_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>From this we obtain <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> by setting <inline-formula><inline-graphic xlink:href="540393v7_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Translating the update in <xref ref-type="disp-formula" rid="eqn5">Eq. 5</xref> into our framework of UPE circuits reads as
<disp-formula id="eqn6">
<graphic xlink:href="540393v7_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
illustrated in <xref rid="fig8" ref-type="fig">Fig. 8A</xref>.</p>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8:</label>
<caption><title>UPEs ensure uncertainty-based weighting of prior and sensory information.</title>
<p>A: Illustration of the hierarchical two-area model. A representation neuron (<italic>r</italic>) in area ùìÅ receives positive and negative UPEs from the area ùìÅ ‚àí 1 below (sensory prediction error, as in <xref rid="fig5" ref-type="fig">Fig. 5</xref>), and positive and negative UPEs from the same area (representation prediction error) with different signs, see <xref ref-type="disp-formula" rid="eqn5">Eq. 5</xref>. In this example, the uncertainty in area ùìÅ ‚àí 1 corresponds to the sensory uncertainty <inline-formula><inline-graphic xlink:href="540393v7_inline42.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and the uncertainty in the area ùìÅ above, corresponds to the prior uncertainty <inline-formula><inline-graphic xlink:href="540393v7_inline43.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Both uncertainties are represented by PV activity in the respective area. B,C: The simulation results from the hierarchical circuit model yield an uncertainty-based weighting of prior and sensory information as in <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref>. B: The activity <italic>r</italic> of the representation neuron as a function of the stimulus <italic>s</italic> for different amounts of prior uncertainty <inline-formula><inline-graphic xlink:href="540393v7_inline44.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, when the sensory uncertainty is fixed <inline-formula><inline-graphic xlink:href="540393v7_inline45.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The histograms show the distribution of the sensory stimulus samples (grey) and the distribution of the activity of the representation neuron (green). C: The activity of the representation neuron as a function of the stimulus for different amounts of sensory uncertainty <inline-formula><inline-graphic xlink:href="540393v7_inline46.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, when the prior uncertainty is fixed <inline-formula><inline-graphic xlink:href="540393v7_inline47.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p></caption>
<graphic xlink:href="540393v7_fig8.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>In our circuit, the representation neuron (green) receives the bottom-up errors, which are modulated by sensory un-certainty <inline-formula><inline-graphic xlink:href="540393v7_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, as in the recurrent circuit model from the previous section. In addition, it receives errors between its current activity and a prior (a higher level expectation of the representation). The prior is set to the learned mean of the stimulus distribution and the errors are modulated by the learned prior uncertainty <inline-formula><inline-graphic xlink:href="540393v7_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We simulated this circuit, to which we presented stimuli drawn from Gaussian distributions as before. We varied the PV activity reflecting the sensory and prior uncertainty, and measured the activity of the representation neuron <italic>r</italic> to each stimulus. The higher the uncertainty of the prior information <italic>œÉ</italic><sub><italic>s</italic></sub>, the more the representation reflects the current stimulus (<xref rid="fig8" ref-type="fig">Fig. 8B</xref>, see also <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref>). The higher the uncertainty of the sensory information <italic>œÉ</italic><sub><italic>s</italic></sub>, the more the representation reflects the prior mean (<xref rid="fig8" ref-type="fig">Fig. 8C</xref>). This is a common behavioural effect, which is often referred to as central tendency effect or contraction bias [<xref ref-type="bibr" rid="c35">35</xref>, <xref ref-type="bibr" rid="c37">37</xref>, <xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c56">56</xref>].</p>
<p>To give a simple example how the prior uncertainty could come about in a dynamical environment, imagine noisy Gaussian sensory inputs with a fixed variance <inline-formula><inline-graphic xlink:href="540393v7_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and step changes in the mean, as in <xref rid="fig7" ref-type="fig">Fig. 7</xref>. On the lowest level 0, after faithful learning, the learned variance <inline-formula><inline-graphic xlink:href="540393v7_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula> will represent the variance of the sensory input <inline-formula><inline-graphic xlink:href="540393v7_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for a given mean. If in addition, the mean of the sensory input varies (as in <xref rid="fig7" ref-type="fig">Fig. 7</xref>), then on the level above <inline-formula><inline-graphic xlink:href="540393v7_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula> will reflect how much the mean varies. The former corresponds to the sensory uncertainty, the latter to the environmental volatility, which increases the uncertainty about the prediction for the mean <inline-formula><inline-graphic xlink:href="540393v7_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Based on normative theories, we propose that the brain uses uncertainty-modulated prediction errors. In particular, we hypothesise that layer 2/3 prediction error neurons represent prediction errors that are inversely modulated by uncer-tainty. Here we showed that different inhibitory cell types in layer 2/3 cortical circuits can compute means and variances and thereby enable pyramidal cells to represent uncertainty-modulated prediction errors. We further showed that the cells in the circuit are able to learn to predict the means and variances of their inputs with local activity-dependent plasticity rules. Our study makes experimentally testable predictions for the activity of different cell types, PV and SST interneurons, in particular, prediction error neurons and representation neurons. Finally, we showed that circuits with uncertainty-modulated prediction errors enable adaptive learning rates, resulting in fast learning when uncertainty is low and slow learning to avoid detrimental fluctuations when uncertainty is high.</p>
<p>Our theory has the following notable implications: The first implication concerns the hierarchical organisation of the brain. At each level of the hierarchy, we find similar canonical circuit motifs that receive both feedforward (from a lower level) and feedback (from a higher level, predictive) inputs that need to be integrated. We propose that uncertainty is computed on each level of the hierarchy. This enables uncertainty estimates specific to the processing level of a particular area. Experimental evidence is so far insufficient to favour distributed uncertainty representation over the idea that uncertainty is only computed on the level of decisions in higher level brain areas such as the parietal cortex [<xref ref-type="bibr" rid="c45">45</xref>], orbitofrontal cortex [<xref ref-type="bibr" rid="c55">55</xref>], or prefrontal cortex [<xref ref-type="bibr" rid="c68">68</xref>]. Our study provides a concrete suggestion for a canonical circuit implementation and, therefore, experimentally testable predictions. The distributed account has clear computational advantages for task-flexibility, information integration, active sensing, and learning (see [<xref ref-type="bibr" rid="c84">84</xref>] for a recent review of the two accounts). Additionally, adding uncertainty-modulated prediction errors from different hierarchical levels according to the predictive coding model [<xref ref-type="bibr" rid="c66">66</xref>, <xref ref-type="bibr" rid="c77">77</xref>] yields an uncertainty-based weighting of feedback and feedforward information, similar to a Bayes-optimal weighting, which can be reconciled with human behaviour [<xref ref-type="bibr" rid="c58">58</xref>]. Two further important implications result from storing uncertainty in the afferent connections to the PVs. First, this implies that the same PV cell can store different uncertainties depending on the context, which is encoded in the pre-synaptic activation. Second, fewer PVs than pyramidal cells are required for the mechanism, which is compatible with the 80/20 ratio of excitatory to inhibitory cells in the brain. The lower selectivity of interneurons in comparison to pyramidal cells could be a feature in prediction error circuits. Error neurons selective to similar stimuli are more likely to receive similar stimulus information, and hence similar predictions. Therefore, a circuit structure may have developed such that prediction error neurons with similar selectivity may receive inputs from the same inhibitory interneurons.</p>
<p>We claim that the uncertainty represented by PVs in our theoretical framework corresponds to <italic>expected uncertainty</italic> that results from noise or irreducible uncertainty in the stimuli and should therefore decrease the learning rate. Another common source of uncertainty are changes in the environment, also referred to as the <italic>unexpected uncertainty</italic>. In volatile environments with high unexpected uncertainty, the learning rate should increase. We suggest that vasointestinal-peptide-positive interneurons (VIPs) could be responsible for signalling the unexpected uncertainty, as they respond to reward, punishment and surprise [<xref ref-type="bibr" rid="c63">63</xref>], which can be indicators of high unexpected uncertainty. They provide potent disinhibition of pyramidal cells [<xref ref-type="bibr" rid="c61">61</xref>], and also inhibit PVs in layer 2/3 [<xref ref-type="bibr" rid="c62">62</xref>]. Hence, they could increase error activity resulting in a larger learning signal. In general, interneurons are innervated by different kinds of neuromodulators [<xref ref-type="bibr" rid="c52">52</xref>, <xref ref-type="bibr" rid="c64">64</xref>] and control pyramidal cell‚Äôs activity and plasticity [<xref ref-type="bibr" rid="c36">36</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c80">80</xref>, <xref ref-type="bibr" rid="c79">79</xref>, <xref ref-type="bibr" rid="c78">78</xref>]. Therefore, neuromodulators could have powerful control over error neuron activity and hence perception and learning.</p>
<p>A diversity of proposals about the neural representation of uncertainty exist. For example, it has been suggested that uncertainty is represented in single neurons by the width [<xref ref-type="bibr" rid="c21">21</xref>], or amplitude of their responses [<xref ref-type="bibr" rid="c54">54</xref>], or implicitly via sampling [neural sampling hypothesis; [<xref ref-type="bibr" rid="c59">59</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c8">8</xref>], or rather than being represented by a single feature, can be decoded from the activity of an entire population [<xref ref-type="bibr" rid="c14">14</xref>]. While we suggest that PVs represent uncertainty to modulate prediction error responses, we do not claim that this is the sole representation of uncertainty in neuronal circuits.</p>
<p>Uncertainty estimation is relevant for Bayes-optimal integration of different sources of information, e.g., different modal-ities [multi-sensory integration; 18, <xref ref-type="bibr" rid="c19">19</xref>] or priors and sensory information. Here, we present a circuit implementation for weighting sensory information versus priors according to their uncertainties by integrating uncertainty-modulated prediction errors. An alternative solution is to estimate uncertainty from the activity of prediction error neurons and use it to weight priors and sensory information [<xref ref-type="bibr" rid="c33">33</xref>], leading to contraction bias Hert√§g and Clopath. [<xref ref-type="bibr" rid="c32">32</xref>] previously showed that the integration of prediction errors with sensory information in representation neurons can also lead to contraction bias, but without being dependent on uncertainty. Instead of modulating the error on each level by the uncertainty on that level as in our suggestion, one can also obtain a Bayes-optimal weighting by combining an unweighted top-down error with a bottom-error that is multiplicatively modulated by the prior uncertainty, and divisively modulated by the bottom-up uncertainty [<xref ref-type="bibr" rid="c29">29</xref>]. It has also been suggested that Bayes-optimal multi-sensory integration could be achieved in single neurons [<xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c38">38</xref>]. Our proposal is complementary to these solutions in that uncertainty-modulated errors can be forwarded to other cortical and subcortical circuits at different levels of the hierarchy, where they can be used for inference and learning. It further allows for a context-dependent integration of sensory inputs.</p>
<p>Multiple neurological disorders, such as autism spectrum disorder or schizophrenia, are associated with maladaptive contextual uncertainty-weighting of sensory and prior information [<xref ref-type="bibr" rid="c27">27</xref>, <xref ref-type="bibr" rid="c50">50</xref>, <xref ref-type="bibr" rid="c75">75</xref>, <xref ref-type="bibr" rid="c49">49</xref>, <xref ref-type="bibr" rid="c72">72</xref>]. These disorders are also associ-ated with aberrant inhibition, e.g. ASD is associated with an excitation-inhibition imbalance [<xref ref-type="bibr" rid="c67">67</xref>] and reduced inhibition [<xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c24">24</xref>]. Interestingly, PV cells, in particular chandelier PV cells, were shown to be reduced in number and synaptic strength in ASD [<xref ref-type="bibr" rid="c41">41</xref>]. Our theory provides one possible explanation of how deficits in uncertainty-weighting on the behavioural level could be linked to altered PVs on the circuit level.</p>
<p>Finally, uncertainty-modulated errors could advance deep hierarchical neural networks. In addition to propagating gra-dients, propagating uncertainty may have advantages for learning. The additional information on uncertainty could enable calculating distances between distributions, which can provide an informative and parameter-independent metric for learning [e.g. natural gradient learning, <xref ref-type="bibr" rid="c47">47</xref>].</p>
<p>To provide experimental predictions that are immediately testable, we suggested specific roles for SSTs and PVs, as they can subtractively and divisively modulate pyramidal cell activity, respectively. In principle, our theory more generally posits that any subtractive or divisive inhibition could implement the suggested computations. With the emerging data on inhibitory cell types, subtypes of SSTs and PVs or other cell types may turn out to play the proposed role.</p>
<p>The model predicts that the divisive interneuron type, which we here suggest to be the PVs, receives a representation of the stimulus as an input. PVs could be pooling the inputs from stimulus-responsive layer 2/3 neurons to estimate uncertainty. The more the stimulus varies, the larger the variability of the pyramidal neuron responses and, hence, the variability of the PV activity. The broader sensory tuning of PVs [<xref ref-type="bibr" rid="c13">13</xref>] is in line with the model insofar as uncertainty modulation could be more general than the specific feature, which is more likely for low-level features processed in primary sensory cortices. PVs were shown to connect more to pyramidal cells with similar feature tuning [<xref ref-type="bibr" rid="c83">83</xref>]; this would be in line with the model, as uncertainty modulation should be feature-related. In our model, some SSTs deliver the prediction to the positive prediction error neurons. SSTs are already known to be involved in spatial prediction, as they underlie the effect of surround suppression [<xref ref-type="bibr" rid="c1">1</xref>], in which SSTs suppress the local activity dependent on a predictive surround.</p>
<p>In the model we propose, SSTs should be subtractive and PVs divisive. However, SSTs can also be divisive, and PVs subtractive dependent on circuit and postsynaptic properties [<xref ref-type="bibr" rid="c71">71</xref>, <xref ref-type="bibr" rid="c51">51</xref>, <xref ref-type="bibr" rid="c15">15</xref>]. This does not necessarily contradict our model, as circuits in which SSTs are divisive and PVs subtractive could implement a different function, as not all pyramidal cells are error neurons. Hence, our model suggests that error neurons which can calculate UPEs should have similar physiological properties to the layer 2/3 cells observed in the study by [<xref ref-type="bibr" rid="c81">81</xref>].</p>
<p>Our model further posits the existence of two distinct subtypes of SSTs in positive and negative error circuits. Indeed, there are many different subtypes of SSTs [<xref ref-type="bibr" rid="c70">70</xref>]. SST is expressed by a large population of interneurons, which can be further subdivided. There is, for example, a type called SST44, which was shown to specifically respond when the animal corrects a movement [<xref ref-type="bibr" rid="c30">30</xref>]. Our proposal is hence aligned with the observation of functionally specialised subtypes of SSTs. Importantly, the comparison between stimulus and prediction needs to happen before the divisive modulation. Although our model does not make assumptions about the precise dendritic location of this comparison, we suggest this to happen on the apical dendrite, as top-down inputs and SST synapses arrive there. SSTs receive top-down inputs [<xref ref-type="bibr" rid="c53">53</xref>], which could provide the prediction to be subtracted in negative prediction error circuits.</p>
<p>To compare predictions and stimuli in a subtractive manner, the encoded prediction/stimulus needs to be translated into a direct variable code. In this framework, we assume that this can be achieved by the weight matrix defining the synaptic connections from the neural populations representing predictions and stimuli (possibly in a population code).</p>
<p>To enable the comparison between predictions and sensory information via subtractive inhibition, we pointed out that the weights of those inputs on the postsynaptic neuron need to match. This essentially means that there needs to be a balance of excitatory and inhibitory inputs. Such an EI balance has been observed experimentally [<xref ref-type="bibr" rid="c73">73</xref>]. And it has previously been suggested that error responses are the result of breaking this EI balance [<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c7">7</xref>]. Heterosynaptic plasticity is a possible mechanism to achieve EI balance [<xref ref-type="bibr" rid="c20">20</xref>]. For example, spike pairing in pre- and postsynaptic neurons induces long-term potentiation at co-activated excitatory and inhibitory synapses with the degree of inhibitory potentiation depending on the evoked excitation [<xref ref-type="bibr" rid="c16">16</xref>], which can normalise EI balance [<xref ref-type="bibr" rid="c20">20</xref>].</p>
<sec id="s4">
<title>Conclusion</title>
<p>To conclude, we proposed that prediction error activity in layer 2/3 circuits is modulated by uncertainty and that the diversity of cell types in these circuits achieves the appropriate scaling of the prediction error activity. The proposed model is compatible with Bayes-optimal behaviour and makes predictions for future experiments.</p>
</sec>
</sec>
<sec id="s4a">
<title>Methods</title>
<sec id="s4b">
<title>Derivation of the UPE</title>
<p>The goal is to learn <inline-formula><inline-graphic xlink:href="540393v7_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to maximise the log-likelihood:
<disp-formula id="ueqn1">
<graphic xlink:href="540393v7_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>We consider the log-likelihood for one sample <italic>s</italic> of the stimulus distribution:
<disp-formula id="ueqn2">
<graphic xlink:href="540393v7_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Stochastic gradient ascent on the log-likelihood gives the update for <inline-formula><inline-graphic xlink:href="540393v7_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula>:
<disp-formula id="ueqn3">
<graphic xlink:href="540393v7_ueqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s4c">
<title>Circuit model</title>
<sec id="s4c1">
<title>Prediction error circuit</title>
<p>We modelled a circuit consisting of excitatory prediction error neurons in layer 2/3, and two inhibitory populations, corresponding to PV and SST interneurons.</p>
<p>Layer 2/3 pyramidal cells receive divisive inhibition from PVs [<xref ref-type="bibr" rid="c81">81</xref>]. We, hence, modelled the activity of prediction error neurons as
<disp-formula id="eqn7">
<graphic xlink:href="540393v7_eqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>œï</italic>(<italic>x</italic>) is the activation function defined as:
<disp-formula id="eqn8">
<graphic xlink:href="540393v7_eqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p><italic>I</italic><sub>dend</sub> = ‚åä<italic>w</italic><sub>UPE,s</sub> s ‚àí <italic>w</italic><sub>UPE,SST</sub> <italic>r</italic><sub>SST</sub>‚åã<sup><italic>k</italic></sup> is the dendritic input current to the positive prediction error neuron (see section Neuronal dynamics below for <italic>r</italic><sub><italic>x</italic></sub> and for the negative prediction error neuron, and <xref rid="tbl1" ref-type="table">Table 1</xref> for <italic>w</italic><sub><italic>x</italic></sub>). The nonlinearity in the dendrite is determined by the exponent <italic>k</italic>, which is by default <italic>k</italic> = 2, unless otherwise specified as in <xref rid="fig4" ref-type="fig">Fig. 4G-J</xref>. <italic>I</italic><sub>0</sub> <italic>&gt;</italic> 1 is a constant ensuring that the divisive inhibition does not become excitatory, when <italic>œÉ &lt;</italic> 1.0. All firing rates are rectified to ensure that they remain positive.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><title>Parameters of the network.</title></caption>
<graphic xlink:href="540393v7_tbl1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>In the positive prediction error circuit, in which the SSTs learn to represent the mean, the SST activity is determined by
<disp-formula id="eqn9">
<graphic xlink:href="540393v7_eqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The SST activity is influenced (nudged with a factor <italic>Œ≤</italic>) by the somatosensory stimuli <italic>s</italic>, which provide targets for the desired SST activity. The connection weight from the sound representation to the SSTs <italic>w</italic><sub>SST,a</sub> is plastic according to the following local activity-dependent plasticity rule [<xref ref-type="bibr" rid="c74">74</xref>]:
<disp-formula id="eqn10">
<graphic xlink:href="540393v7_eqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>Œ∑</italic> is the learning rate, <italic>r</italic><sub>a</sub> is the pre-synaptic firing rate, <italic>r</italic><sub>SST</sub> is the post-synaptic firing rate of the SSTs, <italic>œï</italic>(<italic>x</italic>) is a rectified linear activation function of the SSTs.</p>
<p>The learning rule ensures that the auditory input alone causes SSTs to fire at their target activity. As in the original proposal [<xref ref-type="bibr" rid="c74">74</xref>], the terms in the learning rule can be mapped to local neuronal variables, which could be represented by dendritic (<italic>w</italic><sub>SST,a</sub> <italic>r</italic><sub>a</sub>) and somatic (<italic>r</italic><sub>SST</sub>) activity.</p>
<p>The PV firing rate is determined by the input from the sound representation (<italic>w</italic><sub>PV</sub>+<sub>,a</sub> <italic>r</italic><sub>a</sub>) and the whisker stimuli, from which their mean is subtracted (<italic>w</italic><sub>PV</sub>+<sub>,s</sub> s ‚àí <italic>w</italic><sub>PV</sub>+<sub>,SST</sub>+ <italic>r</italic><sub>SST</sub>+, where the mean is given by <italic>r</italic><sub>SST</sub>+). The mean-subtracted whisker stimuli serve as a target for learning the weight from the sound representation to the PV <italic>w</italic><sub>PV</sub>+<sub>,a</sub>. The PV firing rate evoles over time according to:
<disp-formula id="eqn11">
<graphic xlink:href="540393v7_eqn11.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>œï</italic><sub>PV</sub>(<italic>x</italic>) is a rectified quadratic activation function, defined as follows:
<disp-formula id="eqn12">
<graphic xlink:href="540393v7_eqn12.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The connection weight from the sound representation to the PVs <italic>w</italic><sub>PV,a</sub> is plastic according to the same local activity-dependent plasticity rule as the SSTs [<xref ref-type="bibr" rid="c74">74</xref>]:
<disp-formula id="eqn13">
<graphic xlink:href="540393v7_eqn13.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The weight from the sound representation to the PV <italic>w</italic><sub>PV</sub>+<sub>,a</sub> approaches <italic>œÉ</italic> (instead of <italic>¬µ</italic> as the weight to the SSTs), because the PV activity is a function of the mean-subtracted whisker stimuli (instead of the whisker stimuli as the SST activity), and for a Gaussian-distributed stimulus <italic>s</italic> ‚àº ùí© (<italic>s</italic>|<italic>¬µ, œÉ</italic>), it holds that ùîº[‚åä <italic>s</italic> ‚àí <italic>¬µ</italic>‚åã<sup>+</sup>] ‚àù <italic>œÉ</italic>.</p>
</sec>
<sec id="s4c2">
<title>Recurrent circuit model</title>
<p>In the recurrent circuit, shown in <xref rid="fig5" ref-type="fig">Fig. 5</xref>, we added an internal representation neuron to the circuit with firing rate <italic>r</italic><sub>R</sub>. In this circuit, the SSTs in the positive PE circuit inherit the mean representation from the representation neuron instead of learning it themselves, that is why they receive an input <italic>w</italic><sub>SST</sub>+<sub>,R</sub><italic>r</italic><sub>R</sub>. The SSTs in the negative circuit inherit the stimulus representation and hence receive an input <italic>w</italic><sub>SST</sub>‚àí<sub>,s</sub> s In this recurrent circuit, the firing rate of each population <italic>r</italic><sub><italic>i</italic></sub> where <italic>i</italic> ‚àà [SST<sup>+</sup>, SST<sup>‚àí</sup>, PV<sup>+</sup>, PV<sup>‚àí</sup>, UPE<sup>+</sup>, UPE<sup>‚àí</sup>, R] evolves over time according to the following neuronal dynamics. <italic>œï</italic> denotes a rectified linear activation function with saturation, <italic>œï</italic><sub><italic>PV</italic></sub> denotes a rectified quadratic activation function with saturation, defined in the section below. All firing rates are rectified to ensure that they remain positive.
<disp-formula id="eqn14">
<graphic xlink:href="540393v7_eqn14.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn15">
<graphic xlink:href="540393v7_eqn15.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn16">
<graphic xlink:href="540393v7_eqn16.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn17">
<graphic xlink:href="540393v7_eqn17.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn18">
<graphic xlink:href="540393v7_eqn18.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn19">
<graphic xlink:href="540393v7_eqn19.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn20">
<graphic xlink:href="540393v7_eqn20.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s4c3">
<title>Hierarchical predictive coding</title>
<p>The idea behind hierarchical predictive coding is that the brain infers or represents the causes of its sensory inputs using a hierarchical generative model [<xref ref-type="bibr" rid="c23">23</xref>]. Each level of the cortical hierarchy provides a prior for the mean of the lower level representation, with the top level representation <italic>r</italic><sub><italic>L</italic></sub> being determined by the context. Noise enters in the sensory area by sampling a stimulus <italic>s</italic> = <italic>r</italic><sub>0</sub>. In the sensory area, the variance <inline-formula><inline-graphic xlink:href="540393v7_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is learned to match the variability of the external stimulus <inline-formula><inline-graphic xlink:href="540393v7_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The goal is to infer the set of latent representations <bold>r</bold> = (<italic>r</italic><sub>1</sub>, .., <italic>r</italic><sub><italic>L</italic>‚àí1</sub>), given the synaptic weights <italic>w</italic>ùìÅ of the internal model and the top activity <italic>r</italic><sub><italic>L</italic></sub>, that best reproduces the sensory inputs <italic>s</italic>. To this end, we minimise the following energy:
<disp-formula id="eqn21">
<graphic xlink:href="540393v7_eqn21.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>œÅ</italic> is a transfer function.</p>
<p>We obtain the update for <italic>r</italic> with gradient descent on the energy with respect to <italic>r</italic>ùìÅ :
<disp-formula id="eqn22">
<graphic xlink:href="540393v7_eqn22.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>In our model, <italic>w</italic>ùìÅ are scalars as they denote single weights.</p>
<p>We obtain the steady-state representation <italic>r</italic> by setting its derivative in <xref ref-type="disp-formula" rid="eqn21">Eq. 21</xref> to 0:
<disp-formula id="eqn23">
<graphic xlink:href="540393v7_eqn23.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>We next consider, for simplicity, a threshold-linear transfer function <italic>œÅ</italic>(<italic>w</italic><sub>ùìÅ‚àí1</sub><italic>r</italic><sub>ùìÅ</sub>) such that if <italic>w</italic><sub>ùìÅ‚àí1</sub><italic>r</italic><sub>ùìÅ</sub> <italic>&lt;</italic> 0, then <italic>œÅ</italic>(<italic>w</italic><sub>ùìÅ‚àí1</sub><italic>r</italic><sub>ùìÅ</sub>) = 0 and its derivative <italic>œÅ</italic>‚Ä≤ = 0 or if <italic>w</italic><sub>ùìÅ ‚àí1</sub><italic>r</italic><sub>ùìÅ</sub> ‚â• 0 then <italic>œÅ</italic>(<italic>w</italic><sub>ùìÅ ‚àí1</sub><italic>r</italic><sub>ùìÅ</sub>) = <italic>w</italic><sub>ùìÅ ‚àí1</sub><italic>r</italic><sub>ùìÅ</sub> and <italic>œÅ</italic>‚Ä≤ = 1.</p>
<p>Solving <xref ref-type="disp-formula" rid="eqn24">Eq. 24</xref> for <italic>r</italic><sub>ùìÅ</sub> and assuming <italic>r</italic><sub>ùìÅ</sub> ‚â• 0, we get:
<disp-formula id="eqn24">
<graphic xlink:href="540393v7_eqn24.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>See appendix for the general case with any transfer function and weight matrix.</p>
</sec>
<sec id="s4c4">
<title>Hierarchical circuit model</title>
<p>In the hierarchical circuit model, the representation neuron does not only receive UPEs from the area below, but also from the current area.
<disp-formula id="eqn25">
<graphic xlink:href="540393v7_eqn25.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The UPEs from the area below are as defined in the recurrent circuit model, and the UPEs from the current area are defined accordingly as:
<disp-formula id="eqn26">
<graphic xlink:href="540393v7_eqn26.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn27">
<graphic xlink:href="540393v7_eqn27.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The computations and parameters in each area are the same as for the recurrent circuit model above and in <xref rid="fig5" ref-type="fig">Fig. 5</xref>.</p>
<p>Synapses from the higher level representation of the sound <italic>a</italic> to R were plastic according to the following activity-dependent plasticity rules [<xref ref-type="bibr" rid="c74">74</xref>].
<disp-formula id="eqn28">
<graphic xlink:href="540393v7_eqn28.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>Œ∑</italic><sub>PV</sub> = 0.01<italic>Œ∑</italic><sub><italic>R</italic></sub>.</p>
</sec>
<sec id="s4c5">
<title>Estimating the variance correctly</title>
<p>The PVs estimate the variance of the sensory input from the variance of the teaching input (<italic>s</italic> ‚àí <italic>¬µ</italic>), which nudges the membrane potential of the PVs with a nudging factor <italic>Œ≤</italic>. The nudging factor reduces the effective variance of the teaching input, such that in order to correctly estimate the variance, this reduction needs to be compensated by larger weights from the SSTs to the PVs (<italic>w</italic><sub>PV,SST</sub>) and from the sensory input to the PVs (<italic>w</italic><sub>PV,<italic>s</italic></sub>). To determine how strong the weights <italic>w</italic><sub><italic>s</italic></sub> = <italic>w</italic><sub>PV,SST</sub> = <italic>w</italic><sub>PV,<italic>s</italic></sub> need to be to compensate for the downscaling of the input variance by <italic>Œ≤</italic>, we require that ùîº[<italic>wa</italic>]<sup>2</sup> = <italic>œÉ</italic><sup>2</sup> when the average weight change ùîº[Œî<italic>w</italic>] = 0. The learning rule for <italic>w</italic> is as follows:
<disp-formula id="ueqn4">
<graphic xlink:href="540393v7_ueqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="540393v7_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="540393v7_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
<p>Using that <italic>œï</italic>(<italic>u</italic>) = <italic>u</italic><sup>2</sup>, the average weight change becomes:
<disp-formula id="ueqn5">
<graphic xlink:href="540393v7_ueqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Given our objective ùîº[(<italic>wa</italic>)<sup>2</sup>] = <italic>œÉ</italic><sup>2</sup>, we can write:
<disp-formula id="ueqn6">
<graphic xlink:href="540393v7_ueqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Then for ùîº[Œî<italic>w</italic>] = 0:
<disp-formula id="ueqn7">
<graphic xlink:href="540393v7_ueqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Here, we assumed that <italic>œï</italic>(<italic>u</italic>) = <italic>u</italic><sup>2</sup> instead of <italic>œï</italic>(<italic>u</italic>) = ‚åä<italic>u</italic>‚åã<sup>2</sup>. To test how well this approximation holds, we simulated the circuit for different values of <italic>Œ≤</italic> and hence <italic>w</italic><sub><italic>s</italic></sub>, and plotted the PV firing rate <italic>r</italic><sub>PV</sub>(<italic>a</italic>) given the sound input <italic>a</italic> and the weight from <italic>a</italic> to PV, <italic>w</italic><sub>PV,<italic>a</italic></sub>, for different values of <italic>Œ≤</italic> (<xref rid="fig9" ref-type="fig">Fig. 9</xref>). This analysis shows that the approximation holds for small <italic>Œ≤</italic> up to a value of <italic>Œ≤</italic> = 0.2.</p>
<fig id="fig9" position="float" fig-type="figure">
<label>Figure 9:</label>
<caption><p>For small <italic>Œ≤</italic>, and <inline-formula><inline-graphic xlink:href="540393v7_inline48.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, the weight from <italic>a</italic> to PV approaches <italic>œÉ</italic> and the PV firing rate approaches <italic>œÉ</italic><sup>2</sup>.</p></caption>
<graphic xlink:href="540393v7_fig9.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>We initialised the circuit with the initial weight configuration in <xref rid="tbl1" ref-type="table">Tables 1</xref> and <xref rid="tbl3" ref-type="table">3</xref> and neural firing rates were initialised to be 0 (<italic>r</italic><sub><italic>i</italic></sub>(0) = 0 with <italic>i</italic> ‚àà [SST<sup>+</sup>, SST<sup>‚àí</sup>, PV<sup>+</sup>, PV<sup>‚àí</sup>, UPE<sup>+</sup>, UPE<sup>‚àí</sup>, R]). We then paired a constant tone input with N samples from the whisker stimulus distribution, the parameters of which we varied and are indicated in each Figure. Each whisker stimulus intensity was presented for <italic>D</italic> timesteps (see <xref rid="tbl2" ref-type="table">Table 2</xref>). All simulations were written in Python. Differential equations were numerically integrated with a time step of <italic>dt</italic> = 0.1.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><title>Additional Parameters of the hierarchical network.</title></caption>
<graphic xlink:href="540393v7_tbl2.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3:</label>
<caption><title>Inputs.</title></caption>
<graphic xlink:href="540393v7_tbl3.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
</sec>
<sec id="s4c6">
<title>Eliciting responses to mismatches (<xref rid="fig4" ref-type="fig">Fig. 4</xref> and <xref rid="fig6" ref-type="fig">Fig. 6</xref>)</title>
<p>We first trained the circuit with 10000 stimulus samples to learn the variances in the a-to-PV weights. Then we presented different mismatch stimuli to calculate the error magnitude for each mismatch of magnitude <italic>s</italic> ‚àí <italic>¬µ</italic>.</p>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Table 4:</label>
<caption><title>Parameters of the plasticity rules.</title></caption>
<graphic xlink:href="540393v7_tbl4.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<table-wrap id="tbl5" orientation="portrait" position="float">
<label>Table 5:</label>
<caption><title>Parameters of simulations in <xref rid="fig2" ref-type="fig">Figs. 2</xref>-<xref rid="fig5" ref-type="fig">5</xref>.</title></caption>
<graphic xlink:href="540393v7_tbl5.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<table-wrap id="tbl6" orientation="portrait" position="float">
<label>Table 6:</label>
<caption><title>Parameters of the simulation in <xref rid="fig6" ref-type="fig">Fig. 6</xref>.</title></caption>
<graphic xlink:href="540393v7_tbl6.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
</sec>
<sec id="s4c7">
<title>Comparing the UPE circuit with an unmodulated circuit (<xref rid="fig7" ref-type="fig">Fig. 7</xref>)</title>
<p>To ensure a fair comparison, the unmodu-lated control has an effective learning rate that is the mean of the two effective learning rates in the uncertainty-modulated case.</p>
</sec>
</sec>
</sec>
</body>
<back>
<sec id="s7">
<title>Supplementary information</title>
<sec id="s7a">
<title>Supplementary methods</title>
<sec id="s7a1">
<title>Synaptic dynamics/plasticity rules</title>
<p>
<disp-formula id="eqn29">
<graphic xlink:href="540393v7_eqn29.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn30">
<graphic xlink:href="540393v7_eqn30.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn31">
<graphic xlink:href="540393v7_eqn31.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn32">
<graphic xlink:href="540393v7_eqn32.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn33">
<graphic xlink:href="540393v7_eqn33.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<sec id="s7a1a">
<title>Different choice of supralinear activation function for PV</title>
<fig id="fig10" position="float" fig-type="figure">
<label>Figure 10:</label>
<caption><p>Learning the variance in the positive prediction error circuit with PVs with a power activation function (exponent = 3.0). A and B are analogous to <xref rid="fig3" ref-type="fig">Fig. 3G</xref> and <xref rid="fig3" ref-type="fig">H</xref>, and the circuit is the same except that the activation function of the PVs (<italic>œï</italic><sub><italic>P V</italic></sub> (<italic>x</italic>)) has an exponent of 3.0 instead of 2.0. C and D are zoomed-out versions of A and B.</p></caption>
<graphic xlink:href="540393v7_fig10.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7a1b">
<title>Plastic weights from SST to PV learn to match weights from <italic>s</italic> to PV</title>
<fig id="fig11" position="float" fig-type="figure">
<label>Figure 11:</label>
<caption><p>With inhibitory plasticity, weights from SST to PV can be learned. This figure shows that the weight from SST to PV (<italic>w</italic><sub>PV,SST</sub>) is equal to the weight from <italic>s</italic> to PV (<italic>w</italic><sub>PV,<italic>s</italic></sub>). The inhibitory plasticity rule is described in the Supplementary Methods.</p></caption>
<graphic xlink:href="540393v7_fig11.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7a1c">
<title>PVs learn the variance in the negative prediction error circuit</title>
<fig id="fig12" position="float" fig-type="figure">
<label>Figure 12:</label>
<caption><title>PVs learn to represent the variance given an associative cue in the negative prediction error circuit.</title>
<p>A: Illustration of the changes in the negative prediction error circuit. Thicker lines denote stronger weights. B: Two different tones (purple, green) are associated with two somatosensory stimulus distributions with different variances (purple: high, green: low). C: Weights from sound <italic>a</italic> to PV over time for two different values of stimulus variance (high: <italic>œÉ</italic> = 0.8 (purple), low: <italic>œÉ</italic> = 0.4 (green)). D: PV firing rates over time given sound input (without stimulus input) for low (green) and high (purple) stimulus variance. E: PV firing rates (mean and std) given sound input for low and high stimulus variance. F: PV firing rates (mean and std) during sound and stimulus input. G: Weights from sound <italic>a</italic> to PV for different values of <italic>œÉ</italic> (mean and std). H: PV firing rates given sound input for different values of <italic>œÉ</italic><sup>2</sup> (mean and std).</p></caption>
<graphic xlink:href="540393v7_fig12.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7a1d">
<title>Learning the weights from the SSTs to the prediction error neurons</title>
<fig id="fig13" position="float" fig-type="figure">
<label>Figure 13:</label>
<caption><p>Learning the weights from the SSTs to the UPE neurons. This figure shows that the weights from the SSTs to the UPEs in both the positive (left) and the negative (right) prediction error circuit can be learned with inhibitory plasticity to match the weights from the stimulus representation <italic>s</italic> to the UPEs. The inhibitory plasticity rule is described in the supplementary methods.</p></caption>
<graphic xlink:href="540393v7_fig13.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7a1e">
<title>PV activity is proportional to the variance in the recurrent circuit</title>
<fig id="fig14" position="float" fig-type="figure">
<label>Figure 14:</label>
<caption><p>PV firing rates are proportional to the variance in the recurrent circuit model. Weights from <italic>a</italic> to PV as a function of <italic>œÉ</italic> in the positive (A) and negative (C) prediction error subcircuit. PV firing rates as a function of <italic>œÉ</italic><sup>2</sup> in the positive (B) and negative (D) prediction error circuit.</p></caption>
<graphic xlink:href="540393v7_fig14.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7a1f">
<title>Hierarchical predictive coding with uncertainties</title>
<p>The total energy across the <italic>L</italic> layers is
<disp-formula id="eqn34">
<graphic xlink:href="540393v7_eqn34.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>œÉ</italic><sub>ùìÅ</sub> and <italic>e</italic><sub>ùìÅ</sub> are vectors, and the division is taken component-wise. The error at layer ùìÅ is
<disp-formula id="eqn35">
<graphic xlink:href="540393v7_eqn35.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where, <italic>r</italic><sub>0</sub> = <italic>s</italic> is the stochastic sensory input vector, and <italic>r</italic><sub><italic>L</italic></sub> represents a given context vector at the very top layer <italic>L</italic>. The only source of stochasticity is the stimulus <italic>s</italic>, for which the top-down input, <italic>œÅ</italic>(<italic>W</italic><sub>0</sub><italic>r</italic><sub>1</sub>), is an estimate of its mean.</p>
</sec>
<sec id="s7a1g">
<title>Dynamics for uncertainty-weighted prediction errors</title>
<p>We first consider the gradient dynamics <inline-formula><inline-graphic xlink:href="540393v7_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for a fixed stimulus <italic>s</italic>, and assume that this converges to a critical point of <italic>E</italic> given by <inline-formula><inline-graphic xlink:href="540393v7_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. In our simulations, <italic>s</italic> is sampled from a Gaussian with constant mean, or a mean that changes in steps across time. We calculate (assuming that the variances <inline-formula><inline-graphic xlink:href="540393v7_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are constant),
<disp-formula id="eqn36">
<graphic xlink:href="540393v7_eqn36.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where ¬∑ denotes the component-wise product. To reveal the relation to our uncertainty-weighted prediction errors UPEs, we rewrite this equation as
<disp-formula id="eqn37">
<graphic xlink:href="540393v7_eqn37.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
with matrix <italic>M</italic><sub>ùìÅ</sub> mapping from the lower layer ùìÅ ‚àí 1 to layer ùìÅ,
<disp-formula id="eqn38">
<graphic xlink:href="540393v7_eqn38.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p><xref ref-type="disp-formula" rid="eqn37">Eq. 37</xref> is the general rate dynamics in a hierarchical predictive network. It represents a reformulation of the classical predictive coding model by Rao &amp; Ballard [<xref ref-type="bibr" rid="c66">66</xref>], but with a noise model that is restricted to Gaussian noise only in the stimulus <italic>s</italic>. Upper layer representations <italic>r</italic> will inherit the noise from the sensory input by a propagation of the stochastic error <italic>e</italic><sub>0</sub> = <italic>s</italic> ‚àí <italic>œÅ</italic>(<italic>W</italic><sub>0</sub><italic>r</italic><sub>1</sub>) to higher layers ùìÅ. We also consider a fixed prior on the context rate <italic>r</italic><sub><italic>L</italic></sub> at the top layer <italic>L</italic> that is not included in the energy.</p>
<p>Going beyond [<xref ref-type="bibr" rid="c66">66</xref>], we show how a microcircuit can explicitly learn the uncertainties <inline-formula><inline-graphic xlink:href="540393v7_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and how they can scale the error representations. Notice that the dynamics of <xref ref-type="disp-formula" rid="eqn37">Eq. 37</xref> only contains divisions by <italic>œÉ</italic><sup>2</sup> in the UPEs, and hence will lead to a simple neuronal implementation as shown in <xref rid="fig8" ref-type="fig">Fig. 8</xref> for two layers.</p>
<p>From <xref ref-type="disp-formula" rid="eqn37">Eq. 37</xref> we obtain the special case of <xref ref-type="disp-formula" rid="eqn6">Eq. 6</xref> in the main text, i.e. <inline-formula><inline-graphic xlink:href="540393v7_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, by choosing ùìÅ = 1, <italic>M</italic><sub>ùìÅ</sub> the identity, and decomposing the uncertainty-modulated prediction error into the positive and negative part, <inline-formula><inline-graphic xlink:href="540393v7_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
</sec>
<sec id="s7a1h">
<title>TODOOpposite of <italic>r</italic><sub>ùìÅ</sub> scaling by upper and lower uncertainties</title>
<p>We next give two expressions for the steady state rate reached at <inline-formula><inline-graphic xlink:href="540393v7_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with a given stimulus <italic>s</italic>. The steady state condition <inline-formula><inline-graphic xlink:href="540393v7_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula> writes according to <xref ref-type="disp-formula" rid="eqn37">Eq. 37</xref> as
<disp-formula id="eqn39">
<graphic xlink:href="540393v7_eqn39.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>M</italic><sub>ùìÅ</sub> is defined in <xref ref-type="disp-formula" rid="eqn38">Eq. 38</xref>. To lighten the notation, we abbreviate
<disp-formula id="eqn40">
<graphic xlink:href="540393v7_eqn40.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p><inline-formula><inline-graphic xlink:href="540393v7_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the top-down estimate of the representation <italic>r</italic><sub>ùìÅ</sub>, based on the prior <italic>r</italic><sub>ùìÅ +1</sub> in the upper layer. The error defined in <xref ref-type="disp-formula" rid="eqn35">Eq. 35</xref> then writes as <inline-formula><inline-graphic xlink:href="540393v7_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Plugging this into <xref ref-type="disp-formula" rid="eqn39">Eq. 39</xref>, yields a self-consistency equation for <italic>r</italic><sub>ùìÅ</sub>
<disp-formula id="eqn41">
<graphic xlink:href="540393v7_eqn41.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Here, the divisive modulation of the error by the lower-layer uncertainty <inline-formula><inline-graphic xlink:href="540393v7_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and the multiplicative modulation by the upper-layer uncertainty <inline-formula><inline-graphic xlink:href="540393v7_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula> becomes visible. This feature is shared by the full model of uncertainty-coding that considers independent Gaussian noise at each layer, and that takes the rate-dependency of <inline-formula><inline-graphic xlink:href="540393v7_inline31.gif" mime-subtype="gif" mimetype="image"/></inline-formula> into account (resulting in second-order error driving the dynamics of <italic>r</italic><sub>ùìÅ</sub>, see [<xref ref-type="bibr" rid="c29">29</xref>]). Crucially, again, the neuronal implementation of the dynamics in <xref ref-type="disp-formula" rid="eqn37">Eq. 37</xref> only requires the division by <inline-formula><inline-graphic xlink:href="540393v7_inline32.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="540393v7_inline33.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, see also <xref rid="fig8" ref-type="fig">Fig. 8</xref>.</p>
</sec>
<sec id="s7a1i">
<title>Uncertainty representation as a convex combinations of rates</title>
<p>According to the dynamics in <xref ref-type="disp-formula" rid="eqn37">Eq. 37</xref>, the dynamics of the representation is given by a combination of bottom-up and top-down errors. The steady state is characterised by balanced errors, <italic>M</italic><sub>ùìÅ</sub> UPE<sub>ùìÅ‚àí1</sub> = UPE<sub>ùìÅ</sub>. We next show that also on the level of the rates, the steady state can be written as a combination of bottom-up and top-down rates.</p>
<p>For this, we introduce the bottom-up error-corrected representation <italic>≈ô</italic><sub>ùìÅ</sub>, which is the representation <italic>r</italic><sub>ùìÅ</sub> updated by the uncertainty-weighted error from the lower layer,
<disp-formula id="eqn42">
<graphic xlink:href="540393v7_eqn42.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>From this we obtain <inline-formula><inline-graphic xlink:href="540393v7_inline34.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, while <inline-formula><inline-graphic xlink:href="540393v7_inline35.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the error from <xref ref-type="disp-formula" rid="eqn35">Eq. 35</xref>. Plugging these two expressions into the dynamics underlying <xref ref-type="disp-formula" rid="eqn39">Eq. 39</xref> yields
<disp-formula id="eqn43">
<graphic xlink:href="540393v7_eqn43.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>This <xref ref-type="disp-formula" rid="eqn43">Eq. 43</xref> now yields a self-consistency equation for <italic>r</italic><sub>ùìÅ</sub>, where the representation <italic>r</italic><sub>ùìÅ</sub> is a convex combination of the top-down prior <inline-formula><inline-graphic xlink:href="540393v7_inline36.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and the bottom-up update <italic>≈ô</italic><sub>ùìÅ</sub>,
<disp-formula id="eqn44">
<graphic xlink:href="540393v7_eqn44.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Here, <inline-formula><inline-graphic xlink:href="540393v7_inline37.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the sum of the certainty vector <inline-formula><inline-graphic xlink:href="540393v7_inline38.gif" mime-subtype="gif" mimetype="image"/></inline-formula> at layer ùìÅ and the vector <bold>1</bold> of dim(<italic>r</italic><sub>ùìÅ</sub>) filled by 1‚Äôs. Hence, the integration of the UPEs according to <xref ref-type="disp-formula" rid="eqn37">Eq. 37</xref> converges to the convex combination of <inline-formula><inline-graphic xlink:href="540393v7_inline39.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>≈ô</italic> <sub>ùìÅ</sub> given by <xref ref-type="disp-formula" rid="eqn44">Eq. 44</xref>. This is the generalization of <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> in the main text.</p>
</sec>
<sec id="s7a1j">
<title>Interpretation of the convex combination</title>
<p><xref ref-type="disp-formula" rid="eqn44">Eq. 44</xref> can be interpreted in different ways: It gives</p>
<list list-type="bullet">
<list-item><p>the posterior rate <italic>r</italic><sub>ùìÅ</sub> as convex combination of the top-down prior <inline-formula><inline-graphic xlink:href="540393v7_inline40.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqn42">Eq. 42</xref>) and the bottom-up error-corrected representation <italic>≈ô</italic><sub>ùìÅ</sub> (<xref ref-type="disp-formula" rid="eqn40">Eq. 40</xref>). Notice that ‚Äòprior‚Äô and ‚Äòposterior‚Äô here do not imply the classical Bayesian inversion since the noise at the various layers ùìÅ, inherited from the stochastic stimulus <italic>s</italic>, is not independent.</p></list-item>
<list-item><p>a self-consistency equation for the stationary rate <italic>r</italic><sub>ùìÅ</sub> satisfying <inline-formula><inline-graphic xlink:href="540393v7_inline41.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, with <italic>r</italic><sub>ùìÅ</sub> appearing also on the right-hand side of <xref ref-type="disp-formula" rid="eqn44">Eq. 44</xref> via <xref ref-type="disp-formula" rid="eqn42">Eqs 42</xref> and <xref ref-type="disp-formula" rid="eqn38">38</xref>.</p></list-item>
<list-item><p>an iterative scheme to calculate the steady-state representation <italic>r</italic><sub>ùìÅ</sub>, starting from the old value of <italic>r</italic><sub>ùìÅ</sub> on the right-hand side, and obtaining the new value on the left-hand side, if the iteration converges. The iteration typically converges due to the gradient descent construction.</p></list-item>
</list>
</sec>
</sec>
</sec>
</sec>
<ack>
<title>Acknowledgements</title>
<p>We would like to thank Loreen Hert√§g and Jakob Jordan for helpful discussions and Loreen Hert√§g and Sadra Sadeh for feedback on the manuscript. This work has received funding from the European Union 7th Framework Programme under grant agreement 604102 (HBP), the Horizon 2020 Framework Programme under grant agreements 720270, 785907 and 945539 (HBP) and the Manfred St√§rk Foundation.</p>
</ack>
<sec id="d1e2388" sec-type="additional-information">
<title>Additional information</title>
<sec id="s6" sec-type="code-availability">
<title>Code availability</title>
<p>All simulation code used for this paper will be made available on GitHub upon publication (<ext-link ext-link-type="uri" xlink:href="https://github.com/k47h4/UPE">https://github.com/k47h4/UPE</ext-link>) and is attached to the submission as supplementary file for the reviewers.</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>H.</given-names> <surname>Adesnik</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Bruns</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Taniguchi</surname></string-name>, <string-name><given-names>Z. J.</given-names> <surname>Huang</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Scanziani</surname></string-name></person-group>, <article-title>A Neural Circuit for Spatial Summation in Visual Cortex</article-title> <source>Nature</source> <volume>490</volume>, <fpage>226</fpage> (<month>Oct</month>. <year>2012</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Akrami</surname></string-name>, <string-name><given-names>C. D.</given-names> <surname>Kopec</surname></string-name>, <string-name><given-names>M. E.</given-names> <surname>Diamond</surname></string-name>, <string-name><given-names>C. D.</given-names> <surname>Brody</surname></string-name></person-group>, <article-title>Posterior parietal cortex represents sensory history and mediates its effects on behaviour</article-title>, <source>Nature</source> <volume>554</volume>, <fpage>368</fpage>‚Äì<lpage>372</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>Ashourian</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Loewenstein</surname></string-name></person-group>, <article-title>Bayesian Inference Underlies the Contraction Bias in Delayed Comparison Tasks</article-title> <source>PLOS ONE</source> <volume>6</volume>, <fpage>1</fpage>‚Äì<lpage>8</lpage>, (<pub-id pub-id-type="doi">10.1371/journal.pone.0019551</pub-id>) (<month>May</month> <year>2011</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Attinger</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>G. B.</given-names> <surname>Keller</surname></string-name></person-group>, <article-title>Visuomotor Coupling Shapes the Functional Development of Mouse Visual Cortex</article-title> <source>Cell</source> <volume>169</volume>, <fpage>1291</fpage>‚Äì<lpage>1302.e14</lpage>, (<pub-id pub-id-type="doi">10.1016/j.cell.2017.05.023</pub-id>) (<year>2017</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Ayaz</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Layer-specific integration of locomotion and sensory information in mouse barrel cortex</article-title> <source>Nature Communications</source> <volume>10</volume>, <fpage>2585</fpage>, (<pub-id pub-id-type="doi">10.1038/s41467-019-10564-8</pub-id>) (<year>2019</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K. Banaie</given-names> <surname>Boroujeni</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Tiesinga</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Womelsdorf</surname></string-name></person-group>, <article-title>Interneuron-specific gamma synchronization indexes cue uncertainty and prediction errors in lateral prefrontal and anterior cingulate cortex</article-title> <source>eLife</source> <volume>10</volume>, <fpage>e69111</fpage>, (<pub-id pub-id-type="doi">10.7554/eLife.69111</pub-id>) (<year>2021</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. L. L. R.</given-names> <surname>Barry</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Gerstner</surname></string-name></person-group>, <article-title>Fast adaptation to rule switching using neuronal surprise</article-title> <source>PLOS Computational Biology</source> <volume>20</volume>, <fpage>1</fpage>‚Äì<lpage>41</lpage>, (<pub-id pub-id-type="doi">10.1371/journal.pcbi.1011839</pub-id>) (<month>Feb</month>. <year>2024</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>Berkes</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Orb√°n</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Lengyel</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Fiser</surname></string-name></person-group>, <article-title>Spontaneous Cortical Activity Reveals Hallmarks of an Optimal Internal Model of the Environment</article-title> <source>Science</source> <volume>331</volume>, <fpage>83</fpage>‚Äì<lpage>87</lpage>, <pub-id pub-id-type="doi">10.1126/science.1195870</pub-id>, (<ext-link ext-link-type="uri" xlink:href="https://www.science.org/doi/abs/10.1126/science.1195870">https://www.science.org/doi/abs/10.1126/science.1195870</ext-link>) (<year>2011</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Buesing</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Bill</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Nessler</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Maass</surname></string-name></person-group>, <article-title>Neural Dynamics as Sampling: A Model for Stochastic Computation in Recurrent Networks of Spiking Neurons</article-title>, <source>PLoS Comput Biol</source> <volume>7</volume>, <fpage>e1002211</fpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Cannon</surname></string-name>, <string-name><given-names>A. M.</given-names> <surname>O‚ÄôBrien</surname></string-name>, <string-name><given-names>L.</given-names> <surname>Bungert</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Sinha</surname></string-name></person-group>, <article-title>Prediction in Autism Spectrum Disorder: A Systematic Review of Empirical Evidence</article-title>, <source>Autism Res</source> <volume>14</volume> (<year>2021</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. X.</given-names> <surname>Cohen</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Wilmes</surname></string-name>, <string-name><given-names>I. v. d.</given-names> <surname>Vijver</surname></string-name></person-group>, <article-title>Cortical electrophysiological network dynamics of feedback learning</article-title>, <source>Trends Cogn Sci</source> <volume>15</volume>, <fpage>558</fpage>‚Äì<lpage>566</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. H.</given-names> <surname>Cornford</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Dendritic NMDA receptors in parvalbumin neurons enable strong and stable neuronal assemblies</article-title> <source>eLife</source> <volume>8</volume>, <fpage>e49872</fpage>, (<pub-id pub-id-type="doi">10.7554/eLife.49872</pub-id>) (<year>2019</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. C. H.</given-names> <surname>Cottam</surname></string-name>, <string-name><given-names>S. L.</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>M.</given-names> <surname>H√§usser</surname></string-name></person-group>, <article-title>Target-specific effects of somatostatin-expressing interneurons on neocortical visual processing</article-title> <source>Journal of Neuroscience</source> <volume>33</volume>, <fpage>19567</fpage>‚Äì<lpage>19578</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G. P.</given-names> <surname>Dehaene</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Coen-Cagli</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Pouget</surname></string-name></person-group>, <article-title>Investigating the representation of uncertainty in neuronal circuits</article-title> <source>PLOS Computational Biology</source> <volume>17</volume>, <fpage>1</fpage>‚Äì<lpage>30</lpage>, (<pub-id pub-id-type="doi">10.1371/journal.pcbi.1008138</pub-id>) (<month>Feb</month>. <year>2021</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C.</given-names> <surname>Dorsett</surname></string-name>, <string-name><given-names>B. D.</given-names> <surname>Philpot</surname></string-name>, <string-name><given-names>S. L.</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>I. T.</given-names> <surname>Smith</surname></string-name></person-group>, <article-title>The Impact of SST and PV Interneurons on Nonlinear Synaptic Integration in the Neocortex</article-title>, <source>eNeuro</source> <volume>8</volume> (<year>2021</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. A.</given-names> <surname>D‚Äôamour</surname></string-name>, <string-name><given-names>R. C.</given-names> <surname>Froemke</surname></string-name></person-group>, <article-title>Inhibitory and Excitatory Spike-Timing-Dependent Plasticity in the Auditory Cortex</article-title> <source>Neuron</source> <volume>86</volume>, <fpage>514</fpage>‚Äì<lpage>528</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S089662731500210X">https://www.sciencedirect.com/science/article/pii/S089662731500210X</ext-link>) (<year>2015</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. J.</given-names> <surname>Eliades</surname></string-name>, <string-name><given-names>X.</given-names> <surname>Wang</surname></string-name></person-group>, <article-title>Neural substrates of vocalization feedback monitoring in primate auditory cortex</article-title> <source>Nature</source> <volume>453</volume>, <fpage>1102</fpage>‚Äì<lpage>1106</lpage>, (<pub-id pub-id-type="doi">10.1038/nature06910</pub-id>) (<year>2008</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. O.</given-names> <surname>Ernst</surname></string-name>, <string-name><given-names>M. S.</given-names> <surname>Banks</surname></string-name></person-group>, <article-title>Humans integrate visual and haptic information in a statistically optimal fashion</article-title> <source>Nature</source> <volume>415</volume>, <fpage>429</fpage>‚Äì<lpage>433</lpage>, (<pub-id pub-id-type="doi">10.1038/415429a</pub-id>) (<year>2002</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C. R.</given-names> <surname>Fetsch</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Pouget</surname></string-name>, <string-name><given-names>G. C.</given-names> <surname>DeAngelis</surname></string-name>, <string-name><given-names>D. E.</given-names> <surname>Angelaki</surname></string-name></person-group>, <article-title>Neural correlates of reliability-based cue weighting during multisensory integration</article-title> <source>Nature Neuroscience</source> <volume>15</volume>, <fpage>146</fpage>‚Äì<lpage>154</lpage>, (<pub-id pub-id-type="doi">10.1038/nn.2983</pub-id>) (<year>2012</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R. E.</given-names> <surname>Field</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Heterosynaptic Plasticity Determines the Set Point for Cortical Excitatory-Inhibitory Balance</article-title>, <source>Neuron</source> <volume>106</volume>, <fpage>842</fpage>‚Äì<lpage>854</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>B. J.</given-names> <surname>Fischer</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Pe√±a</surname></string-name></person-group>, <article-title>Owl's behavior and neural representation predicted by Bayesian inference</article-title> <source>Nature Neuroscience</source> <volume>14</volume>, <fpage>1061</fpage>‚Äì<lpage>1066</lpage>, (<pub-id pub-id-type="doi">10.1038/nn.2872</pub-id>) (<year>2011</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Fiser</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Experience-dependent spatial expectations in mouse visual cortex</article-title> <source>Nature Neuroscience</source> <volume>19</volume>, <fpage>1658</fpage>, (<pub-id pub-id-type="doi">10.1038/nn.4385</pub-id>) (<month>Sept</month>. <year>2016</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K.</given-names> <surname>Friston</surname></string-name></person-group>, <article-title>A theory of cortical responses</article-title>, <source>Philos Trans R Soc Lond B Biol Sci</source> <volume>360</volume>, <fpage>815</fpage>‚Äì<lpage>836</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>W</given-names> <surname>Gaetz</surname></string-name> <etal>et al.</etal></person-group>, <article-title>GABA estimation in the brains of children on the autism spectrum: Measurement precision and regional cortical variation</article-title>, <source>Neuroimage</source> <volume>86</volume>, <fpage>1</fpage>‚Äì<lpage>9</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Gidon</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Segev</surname></string-name></person-group>, <article-title>Principles Governing the Operation of Synaptic Inhibition in Dendrites</article-title> <source>Neuron</source> <volume>75</volume>, <fpage>330</fpage>‚Äì<lpage>341</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0896627312004813">https://www.sciencedirect.com/science/article/pii/S0896627312004813</ext-link>) (<year>2012</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>C. J.</given-names> <surname>Gillon</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Learning from unexpected events in the neocortical microcircuit</article-title> <source>bioRxiv</source>, <pub-id pub-id-type="doi">10.1101/2021.01.15.426915</pub-id>, (<year>2021</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Goris</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Autistic traits are related to worse performance in a volatile reward learning task despite adaptive learning rates</article-title> <source>Autism</source> <volume>25</volume>, PMID: <pub-id pub-id-type="pmid">33030041</pub-id>, <fpage>440</fpage>‚Äì<lpage>451</lpage>, <pub-id pub-id-type="doi">10.1177/1362361320962237</pub-id>, (<pub-id pub-id-type="doi">10.1177/1362361320962237</pub-id>) (<year>2021</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Goris</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Interoception and Mental Health: A Roadmap</article-title>, <source>Biol Psychiatry Cogn Neurosci Neuroimaging</source> <volume>3</volume>, <fpage>667</fpage>‚Äì<lpage>674</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Granier</surname></string-name>, <string-name><given-names>M. A.</given-names> <surname>Petrovici</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Senn</surname></string-name>, <string-name><given-names>K. A.</given-names> <surname>Wilmes</surname></string-name></person-group> <article-title>Confidence and second-order errors in cortical circuits</article-title>, <source>arXiv</source> <year>2024</year>, <pub-id pub-id-type="arxiv">2309.16046</pub-id></mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Green</surname></string-name> <etal>et al.</etal></person-group>, <article-title>A cell-type-specific error-correction signal in the posterior parietal cortex</article-title> <source>Nature</source> <volume>620</volume>, <fpage>366</fpage>‚Äì<lpage>373</lpage>, (<pub-id pub-id-type="doi">10.1038/s41586-023-06357-1</pub-id>) (<year>2023</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M.</given-names> <surname>Harada</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Non-Invasive Evaluation of the GABAergic/Glutamatergic System in Autistic Patients Observed by MEGA-Editing Proton MR Spectroscopy Using a Clinical 3 Tesla Instrument</article-title>, <source>J Autism Dev Disord</source> <volume>41</volume>, <fpage>447</fpage>‚Äì<lpage>454</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Hert√§g</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Clopath</surname></string-name></person-group>, <article-title>Prediction-error neurons in circuits with multiple neuron types: Formation, refinement, and functional implications</article-title>, <source>Proc Natl Acad Sci U S A</source> <volume>119</volume>, <fpage>e2115699119</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Hert√§g</surname></string-name>, <string-name><given-names>K. A.</given-names> <surname>Wilmes</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Clopath</surname></string-name></person-group>, <article-title>Knowing what you don‚Äôt know: Estimating the uncertainty of feedforward and feedback inputs with prediction-error circuits</article-title> <source>bioRxiv</source>, <pub-id pub-id-type="doi">10.1101/2023.12.13.571410</pub-id> (<year>2023</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L.</given-names> <surname>Hert√§g</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Sprekeler</surname></string-name></person-group>, <article-title>Learning prediction error neurons in a canonical interneuron circuit</article-title> <source>eLife</source> <volume>9</volume>, <fpage>e57541</fpage>, (<pub-id pub-id-type="doi">10.7554/eLife.57541</pub-id>) (<year>2020</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>H. L.</given-names> <surname>Hollingworth</surname></string-name></person-group>, <article-title>The Central Tendency of Judgment</article-title> <source>The Journal of Philosophy, Psychology and Scientific Methods</source> <volume>7</volume>, <fpage>461</fpage>‚Äì<lpage>469</lpage>, (2024; <ext-link ext-link-type="uri" xlink:href="http://www.jstor.org/stable/2012819">http://www.jstor.org/stable/2012819</ext-link>) (<year>1910</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. S.</given-names> <surname>Isaacson</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Scanziani</surname></string-name></person-group>, <article-title>How Inhibition Shapes Cortical Activity</article-title> <source>Neuron</source> <volume>72</volume>, <fpage>231</fpage>‚Äì<lpage>243</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0896627311008798">https://www.sciencedirect.com/science/article/pii/S0896627311008798</ext-link>) (<year>2011</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M.</given-names> <surname>Jazayeri</surname></string-name>, <string-name><given-names>M. N.</given-names> <surname>Shadlen</surname></string-name></person-group>, <article-title>Temporal context calibrates interval timing</article-title>, <source>Nat Neurosci</source> <volume>13</volume>, <fpage>1020</fpage>‚Äì<lpage>1026</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>L. P.</given-names> <surname>Jiang</surname></string-name>, <string-name><given-names>R. P.</given-names> <surname>Rao</surname></string-name></person-group>, <article-title>Predictive Coding Theories of Cortical Function</article-title>, <source>Oxford Research Encyclopedia of Neuroscience</source>. <year>2022</year>, (<pub-id pub-id-type="doi">10.1093/acrefore/9780190264086.013.328</pub-id>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>J.</given-names> <surname>Jordan</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Sacramento</surname></string-name>, <string-name><given-names>W. A. M.</given-names> <surname>Wybo</surname></string-name>, <string-name><given-names>M. A.</given-names> <surname>Petrovici</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Senn</surname></string-name></person-group>, <article-title>Learning Bayes-optimal dendritic opinion pooling</article-title>, <source>arXiv</source> <year>2022</year>, <pub-id pub-id-type="arxiv">2104.13238</pub-id>.</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R.</given-names> <surname>Jordan</surname></string-name>, <string-name><given-names>G. B.</given-names> <surname>Keller</surname></string-name></person-group>, <article-title>Opposing Influence of Top-down and Bottom-up Input on Excitatory Layer 2/3 Neurons in Mouse Primary Visual Cortex</article-title> <source>Neuron</source> <volume>108</volume>, <fpage>1194</fpage>‚Äì<lpage>1206.e5,</lpage> (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0896627320307480">https://www.sciencedirect.com/science/article/pii/S0896627320307480</ext-link>) (<year>2020</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R.</given-names> <surname>Jordan</surname></string-name>, <string-name><given-names>G. B.</given-names> <surname>Keller</surname></string-name></person-group>, <article-title>The locus coeruleus broadcasts prediction errors across the cortex to promote sensorimotor plasticity</article-title> <source>eLife</source> (<pub-id pub-id-type="doi">10.7554/elife.85111.2</pub-id>) (<year>2023</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>Juarez</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Mart‚Äôsnez</surname></string-name> <string-name><surname>Cerde√±o</surname>, <given-names>eng</given-names></string-name></person-group>, <article-title>Parvalbumin and parvalbumin chandelier interneurons in autism and other psychiatric disorders</article-title> <source>Front Psychiatry</source> <volume>13</volume>, <fpage>913550</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G. B.</given-names> <surname>Keller</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Bonhoeffer</surname></string-name>, <string-name><given-names>M.</given-names> <surname>H√ºbener</surname></string-name></person-group>, <article-title>Sensorimotor Mismatch Signals in Primary Visual Cortex of the Behaving Mouse</article-title> <source>Neuron</source> <volume>74</volume>, <fpage>809</fpage> ‚Äì<lpage>815</lpage>, (<ext-link ext-link-type="uri" xlink:href="http://www.sciencedirect.com/science/article/pii/S0896627312003844">http://www.sciencedirect.com/science/article/pii/S0896627312003844</ext-link>) (<year>2012</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G. B.</given-names> <surname>Keller</surname></string-name>, <string-name><given-names>R. H. R.</given-names> <surname>Hahnloser</surname></string-name></person-group>, <article-title>Neural processing of auditory feedback during vocal practice in a songbird</article-title> <source>Nature</source> <volume>457</volume>, <fpage>187</fpage>‚Äì<lpage>190</lpage>, (<pub-id pub-id-type="doi">10.1038/nature07467</pub-id>) (<year>2009</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G. B.</given-names> <surname>Keller</surname></string-name>, <string-name><given-names>T. D.</given-names> <surname>Mrsic-Flogel</surname></string-name></person-group>, <article-title>Predictive Processing: A Canonical Cortical Computation</article-title> <source>Neuron</source> <volume>100</volume>, <fpage>424</fpage> ‚Äì<lpage>435</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R.</given-names> <surname>Kiani</surname></string-name>, <string-name><given-names>M. N.</given-names> <surname>Shadlen</surname></string-name></person-group>, <article-title>Representation of confidence associated with a decision by neurons in the parietal cortex</article-title>, <source>Science</source> <volume>324</volume>, <fpage>759</fpage>‚Äì<lpage>764</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K. P.</given-names> <surname>K√∂rding</surname></string-name>, <string-name><given-names>D. M.</given-names> <surname>Wolpert</surname></string-name></person-group>, <article-title>Bayesian integration in sensorimotor learning</article-title> <source>Nature</source> <volume>427</volume>, <fpage>244</fpage>‚Äì<lpage>247</lpage>, (<pub-id pub-id-type="doi">10.1038/nature02169</pub-id>) (<year>2004</year>).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>E.</given-names> <surname>Kreutzer</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Senn</surname></string-name>, <string-name><given-names>M. A.</given-names> <surname>Petrovici</surname></string-name></person-group>, <article-title>Natural-gradient learning for spiking neurons</article-title> <source>eLife</source> <volume>11</volume>, <fpage>e66526</fpage>, (<pub-id pub-id-type="doi">10.7554/eLife.66526</pub-id>) (<year>2022</year>).</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K.</given-names> <surname>Kveraga</surname></string-name>, <string-name><given-names>A. S.</given-names> <surname>Ghuman</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Bar</surname></string-name></person-group>, <article-title>Top-down predictions in the cognitive brain</article-title> <source>Brain and cognition</source> <volume>65</volume>, <fpage>145</fpage>‚Äì<lpage>168</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://pubmed.ncbi.nlm.nih.gov/17923222">https://pubmed.ncbi.nlm.nih.gov/17923222</ext-link>) (<month>Nov</month>. <year>2007</year>).</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R. P.</given-names> <surname>Lawson</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Mathys</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Rees</surname></string-name></person-group>, <article-title>Adults with autism overestimate the volatility of the sensory environment</article-title> <source>Nature Neuroscience</source> <volume>20</volume>, <fpage>1293</fpage>‚Äì<lpage>1299</lpage>, (<pub-id pub-id-type="doi">10.1038/nn.4615</pub-id>) (<year>2017</year>).</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R. P.</given-names> <surname>Lawson</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Rees</surname></string-name>, <string-name><given-names>K. J.</given-names> <surname>Friston</surname></string-name></person-group>, <article-title>An aberrant precision account of autism</article-title> <source>Frontiers in human neuroscience</source> <volume>8</volume>, <fpage>302</fpage>‚Äì<lpage>302</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://pubmed.ncbi.nlm.nih.gov/24860482">https://pubmed.ncbi.nlm.nih.gov/24860482</ext-link>) (<year>2014</year>).</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.-H.</given-names> <surname>Lee</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Activation of specific interneurons improves V1 feature selectivity and visual perception</article-title> <source>Nature</source> <volume>488</volume>, <fpage>379</fpage>‚Äì<lpage>383</lpage>, (<pub-id pub-id-type="doi">10.1038/nature11312</pub-id>) (<year>2012</year>).</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.</given-names> <surname>Lee</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Kruglikov</surname></string-name>, <string-name><given-names>Z. J.</given-names> <surname>Huang</surname></string-name>, <string-name><given-names>G.</given-names> <surname>Fishell</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Rudy</surname></string-name></person-group>, <article-title>A disinhibitory circuit mediates motor integration in the somatosensory cortex</article-title> <source>Nature Neuroscience</source> <volume>16</volume>, <fpage>1662</fpage>‚Äì<lpage>1670</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>D.</given-names> <surname>Liu</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Orbitofrontal control of visual cortex gain promotes visual associative learning</article-title> <source>Nature Communications</source> <volume>11</volume>, <fpage>2784</fpage>, (<pub-id pub-id-type="doi">10.1038/s41467-020-16609-7</pub-id>) (<year>2020</year>).</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>W. J.</given-names> <surname>Ma</surname></string-name>, <string-name><given-names>J. M.</given-names> <surname>Beck</surname></string-name>, <string-name><given-names>P. E.</given-names> <surname>Latham</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Pouget</surname></string-name></person-group>, <article-title>Bayesian inference with probabilistic population codes</article-title> <source>Nature Neuroscience</source> <volume>9</volume>, <fpage>1432</fpage>‚Äì<lpage>1438</lpage>, (<pub-id pub-id-type="doi">10.1038/nn1790</pub-id>) (<year>2006</year>).</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>Masset</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Ott</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Lak</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Hirokawa</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Kepecs</surname></string-name></person-group>, <article-title>Behavior- and Modality-General Representation of Confidence in Orbitofrontal Cortex</article-title> <source>Cell</source> <volume>182</volume>, <fpage>112</fpage>‚Äì<lpage>126.e18,</lpage> (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0092867420306176">https://www.sciencedirect.com/science/article/pii/S0092867420306176</ext-link>) (<year>2020</year>).</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>N.</given-names> <surname>Meirhaeghe</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Sohn</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Jazayeri</surname></string-name></person-group>, <article-title>A precise and adaptive neural mechanism for predictive temporal processing in the frontal cortex</article-title> <source>Neuron</source> <volume>109</volume>, <fpage>2995</fpage>‚Äì<lpage>3011.e5,</lpage> (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S089662732100622X">https://www.sciencedirect.com/science/article/pii/S089662732100622X</ext-link>) (<year>2021</year>).</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C. M.</given-names> <surname>Niell</surname></string-name>, <string-name><given-names>M. P.</given-names> <surname>Stryker</surname></string-name></person-group>, <article-title>Highly Selective Receptive Fields in Mouse Visual Cortex</article-title> <source>Journal of Neuroscience</source> <volume>28</volume>, <fpage>7520</fpage>‚Äì<lpage>7536</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>E.</given-names> <surname>Payzan-LeNestour</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Bossaerts</surname></string-name></person-group>, <article-title>Risk, Unexpected Uncertainty, and Estimation Uncertainty: Bayesian Learning in Unstable Settings</article-title> <source>PLOS Computational Biology</source> <volume>7</volume>, <fpage>1</fpage>‚Äì<lpage>14</lpage>, (<pub-id pub-id-type="doi">10.1371/journal.pcbi.1001048</pub-id>) (<month>Jan</month>. <year>2011</year>).</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>M. A.</given-names> <surname>Petrovici</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Bill</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Bytschok</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Schemmel</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Meier</surname></string-name></person-group>, <article-title>Stochastic inference with deterministic spiking neurons</article-title>, <source>arXiv</source> <year>2013</year>, <pub-id pub-id-type="arxiv">1311.3211</pub-id>.</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>F. H.</given-names> <surname>Petzschner</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Glasauer</surname></string-name></person-group>, <article-title>Iterative Bayesian Estimation as an Explanation for Range and Regression Effects: A Study on Human Path Integration</article-title> <source>Journal of Neuroscience</source> <volume>31</volume>, <fpage>17220</fpage>‚Äì<lpage>17229</lpage>, <ext-link ext-link-type="uri" xlink:href="https://www.jneurosci.org/content/31/47/17220.full.pdf">https://www.jneurosci.org/content/31/47/17220.full.pdf</ext-link>, (<ext-link ext-link-type="uri" xlink:href="https://www.jneurosci.org/content/31/47/17220">https://www.jneurosci.org/content/31/47/17220</ext-link>) (<year>2011</year>).</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C. K.</given-names> <surname>Pfeffer</surname></string-name></person-group>, <article-title>Inhibitory Neurons: Vip Cells Hit the Brake on Inhibition</article-title> <source>Current Biology</source> <volume>24</volume>, <fpage>18</fpage>‚Äì<lpage>20</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C. K.</given-names> <surname>Pfeffer</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Xue</surname></string-name>, <string-name><given-names>M.</given-names> <surname>He</surname></string-name>, <string-name><given-names>Z. J.</given-names> <surname>Huang</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Scanziani</surname></string-name></person-group>, <article-title>Inhibition of inhibition in visual cortex: the logic of connections between molecularly distinct interneurons</article-title> <source>Nature neuroscience</source> <volume>16</volume>, <fpage>1068</fpage>‚Äì<lpage>1076</lpage> (<month>Aug</month>. <year>2013</year>).</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>H.-J.</given-names> <surname>Pi</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Cortical interneurons that specialize in disinhibitory control</article-title> <source>Nature</source> <volume>503</volume>, <fpage>521</fpage>‚Äì<lpage>524</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Pr√∂nneke</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Characterizing VIP Neurons in the Barrel Cortex of VIPcre/tdTomato Mice Reveals Layer-Specific Differences</article-title> <source>Cerebral Cortex</source> <volume>25</volume>, <fpage>4854</fpage>‚Äì<lpage>4868</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c66"><label>66.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>C.</given-names> <surname>Raltschev</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Kasavica</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Leonardon</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Nevian</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Sachidhanandam</surname></string-name></person-group>, <article-title>Top-down modulation of sensory processing and mismatch in the mouse posterior parietal cortex</article-title> <source>bioRxiv</source>, <pub-id pub-id-type="doi">10.1101/2023.05.11.540431</pub-id> (<year>2023</year>).</mixed-citation></ref>
<ref id="c67"><label>67.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R. P. N.</given-names> <surname>Rao</surname></string-name>, <string-name><given-names>D. H.</given-names> <surname>Ballard</surname></string-name></person-group>, <article-title>Predictive coding in the visual cortex: a functional interpretation of some extra-classical receptive-field effects</article-title> <source>Nature Neuroscience</source> <volume>2</volume>, <fpage>79</fpage>‚Äì<lpage>87</lpage>, (<pub-id pub-id-type="doi">10.1038/4580</pub-id>) (<year>1999</year>).</mixed-citation></ref>
<ref id="c68"><label>68.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. L. R.</given-names> <surname>Rubenstein</surname></string-name>, <string-name><given-names>M. M.</given-names> <surname>Merzenich</surname></string-name></person-group>, <article-title>Model of autism: increased ratio of excitation/inhibition in key neural systems</article-title>, <source>Genes, brain, and behavior</source> <volume>2</volume>, <fpage>255</fpage>‚Äì<lpage>267</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://pubmed.ncbi.nlm.nih.gov/14606691">https://pubmed.ncbi.nlm.nih.gov/14606691</ext-link> <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6748642/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6748642/</ext-link>) (<year>2003</year>).</mixed-citation></ref>
<ref id="c69"><label>69.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. F. S.</given-names> <surname>Rushworth</surname></string-name>, <string-name><given-names>T. E. J.</given-names> <surname>Behrens</surname></string-name></person-group>, <article-title>Choice, uncertainty and value in prefrontal and cingulate cortex</article-title> <source>Nature Neuroscience</source> <volume>11</volume>, <fpage>389</fpage>‚Äì<lpage>397</lpage>, (<pub-id pub-id-type="doi">10.1038/nn2066</pub-id>) (<year>2008</year>).</mixed-citation></ref>
<ref id="c70"><label>70.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.</given-names> <surname>Sachidhanandam</surname></string-name>, <string-name><given-names>B. S.</given-names> <surname>Sermet</surname></string-name>, <string-name><given-names>C. C.</given-names> <surname>Petersen</surname></string-name></person-group>, <article-title>Parvalbumin-Expressing GABAergic Neurons in Mouse Barrel Cortex Contribute to Gating a Goal-Directed Sensorimotor Transformation</article-title> <source>Cell Reports</source> <volume>15</volume>, <fpage>700</fpage>‚Äì<lpage>706</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S2211124716303345">https://www.sciencedirect.com/science/article/pii/S2211124716303345</ext-link>) (<year>2016</year>).</mixed-citation></ref>
<ref id="c71"><label>71.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>B. A.</given-names> <surname>Seybold</surname></string-name>, <string-name><given-names>E. A.</given-names> <surname>Phillips</surname></string-name>, <string-name><given-names>C. E.</given-names> <surname>Schreiner</surname></string-name>, <string-name><given-names>A. R.</given-names> <surname>Hasenstaub</surname></string-name></person-group>, <article-title>Inhibitory Actions Unified by Network Integration</article-title> <source>Neuron</source> <volume>87</volume>, <fpage>1181</fpage>‚Äì<lpage>1192</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0896627315007709">https://www.sciencedirect.com/science/article/pii/S0896627315007709</ext-link>) (<year>2015</year>).</mixed-citation></ref>
<ref id="c72"><label>72.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Z.</given-names> <surname>Shi</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Predictive coding in ASD: inflexible weighting of prediction errors when switching from stable to volatile environments</article-title> <source>bioRxiv</source>, <pub-id pub-id-type="doi">10.1101/2022.01.21.477218</pub-id> (<year>2022</year>).</mixed-citation></ref>
<ref id="c73"><label>73.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A.</given-names> <surname>Tan</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Wehr</surname></string-name></person-group>, <article-title>Balanced tone-evoked synaptic excitation and inhibition in mouse auditory cortex</article-title> <source>Neuroscience</source> <volume>163</volume>, <fpage>1302</fpage>‚Äì<lpage>1315</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0306452209012093">https://www.sciencedirect.com/science/article/pii/S0306452209012093</ext-link>) (<year>2009</year>).</mixed-citation></ref>
<ref id="c74"><label>74.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R.</given-names> <surname>Urbanczik</surname></string-name>, <string-name><given-names>W.</given-names> <surname>Senn</surname></string-name></person-group>, <article-title>Learning by the Dendritic Prediction of Somatic Spiking</article-title> <source>Neuron</source> <volume>81</volume>, <fpage>521</fpage>‚Äì<lpage>528</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S0896627313011276">https://www.sciencedirect.com/science/article/pii/S0896627313011276</ext-link>) (<year>2014</year>).</mixed-citation></ref>
<ref id="c75"><label>75.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S.</given-names> <surname>Van de Cruys</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Precise minds in uncertain worlds: predictive coding in autism</article-title>, <source>Psychol Rev</source> <volume>121</volume>, <fpage>649</fpage>‚Äì<lpage>675</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c76"><label>76.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>A. R.</given-names> <surname>Walker</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Luque</surname></string-name>, <string-name><given-names>M. E.</given-names> <surname>Le Pelley</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Beesley</surname></string-name></person-group>, <article-title>The role of uncertainty in attentional and choice exploration</article-title> <source>Psychonomic Bulletin &amp; Review</source> <volume>26</volume>, <fpage>1911</fpage>‚Äì<lpage>1916</lpage>, (<pub-id pub-id-type="doi">10.3758/s13423-019-01653-2</pub-id>) (<year>2019</year>).</mixed-citation></ref>
<ref id="c77"><label>77.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. C. R.</given-names> <surname>Whittington</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Bogacz</surname></string-name></person-group>, <article-title>An Approximation of the Error Backpropagation Algorithm in a Predictive Coding Network with Local Hebbian Synaptic Plasticity</article-title>, <source>Neural Comput</source> <volume>29</volume>, <fpage>1229</fpage>‚Äì<lpage>1262</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c78"><label>78.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K. A.</given-names> <surname>Wilmes</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Clopath</surname></string-name></person-group>, <article-title>Inhibitory microcircuits for top-down plasticity of sensory representations</article-title> <source>Nature Communications</source> <volume>10</volume>, <fpage>5055</fpage>, (<pub-id pub-id-type="doi">10.1038/s41467-019-12972-2</pub-id>) (<year>2019</year>).</mixed-citation></ref>
<ref id="c79"><label>79.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K. A.</given-names> <surname>Wilmes</surname></string-name>, <string-name><given-names>J.-H.</given-names> <surname>Schleimer</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Schreiber</surname></string-name></person-group>, <article-title>Spike-timing dependent inhibitory plasticity to learn a selective gating of backpropagating action potentials</article-title> <source>European Journal of Neuroscience</source> <volume>45</volume>, <fpage>1032</fpage>‚Äì<lpage>1043</lpage>, <pub-id pub-id-type="doi">10.1111/ejn.13326</pub-id> (<year>2017</year>).</mixed-citation></ref>
<ref id="c80"><label>80.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K. A.</given-names> <surname>Wilmes</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Sprekeler</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Schreiber</surname></string-name></person-group>, <article-title>Inhibition as a Binary Switch for Excitatory Plasticity in Pyramidal Neurons</article-title> <source>PLoS Computational Biology</source> <volume>12</volume>, <fpage>e1004768</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c81"><label>81.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>N. R.</given-names> <surname>Wilson</surname></string-name>, <string-name><given-names>C. A.</given-names> <surname>Runyan</surname></string-name>, <string-name><given-names>F. L.</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Sur</surname></string-name></person-group>, <article-title>Division and subtraction by distinct cortical inhibitory networks in vivo</article-title>, <source>Nature</source> <volume>488</volume>, <fpage>343</fpage>‚Äì<lpage>348</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c82"><label>82.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>Zmarz</surname></string-name>, <string-name><given-names>G. B.</given-names> <surname>Keller</surname></string-name></person-group>, <article-title>Mismatch Receptive Fields in Mouse Visual Cortex</article-title>, <source>Neuron</source> <volume>92</volume>, <fpage>766</fpage>‚Äì<lpage>772</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c83"><label>83.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>Znamenskiy</surname></string-name> <etal>et al.</etal></person-group>, <article-title>Functional specificity of recurrent inhibition in visual cortex</article-title>, <source>Neuron</source> <volume>112</volume>, <fpage>991</fpage>‚Äì<lpage>1000</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c84"><label>84.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>√Åd√°m</given-names> <surname>Koblinger</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Fiser</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Lengyel</surname></string-name></person-group> <article-title>Representations of uncertainty: where art thou?</article-title> <source>Current Opinion in Behavioral Sciences</source> <volume>38</volume>, <fpage>150</fpage>-<lpage>162</lpage>, (<ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S2352154621000577">https://www.sciencedirect.com/science/article/pii/S2352154621000577</ext-link>) (<year>2021</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95127.3.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Keller</surname>
<given-names>Georg B</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Friedrich Miescher Institute</institution>
</institution-wrap>
<city>Basel</city>
<country>Switzerland</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Compelling</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>important</bold> study introduces a new cortical circuit model for predictive processing. Simulations effectively illustrate that, with appropriate synaptic plasticity, a canonical layer 2/3 cortical circuit - comprising two classes of interneurons providing subtractive and divisive inhibition - can generate uncertainty-modulated prediction errors by pyramidal neurons. The model is <bold>compelling</bold>; although it relies on many assumptions and has not yet been compared directly to data, the model does align with empirical observations and yields a range of testable predictions. The study is expected to be of great interest to those involved in cortical and predictive processing research.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95127.3.sa2</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This computational modeling study addresses the observation that variable observations are interpreted differently depending on how much uncertainty an agent expects from its environment. That is, the same mismatch between a stimulus and an expected stimulus would be less significant, and specifically would represent a smaller prediction error, in an environment with a high degree of variability than in one where observations have historically been similar to each other. The authors show that if two different classes of inhibitory interneurons, the PV and SST cells, (1) encode different aspects of a stimulus distribution and (2) act in different (divisive vs. subtractive) ways, and if (3) synaptic weights evolve in a way that causes the impact of certain inputs to balance the firing rates of the targets of those inputs, then pyramidal neurons in layer 2/3 of canonical cortical circuits can indeed encode uncertainty-modulated prediction errors. To achieve this result, SST neurons learn to represent the mean of a stimulus distribution and PV neurons its variance.</p>
<p>The impact of uncertainty on prediction errors in an understudied topic, and this study provides an intriguing and elegant new framework for how this impact could be achieved and what effects it could produce. The ideas here differ from past proposals about how neuronal firing represents uncertainty. The developed theory is accompanied by several predictions for future experimental testing, including the existence of different forms of coding by different subclasses of PV interneurons, which target different sets of SST interneurons (as well as pyramidal cells). The authors are able to point to some experimental observations that are at least consistent with their computational results. The simulations shown demonstrate that if we accept its assumptions, then the authors' theory works very well: SSTs learn to represent the mean of a stimulus distribution, PVs learn to estimate its variance, firing rates of other model neurons scale as they should, and the level of uncertainty automatically tunes the learning rate, so that variable observations are less impactful in a high uncertainty setting.</p>
<p>Strengths:</p>
<p>The ideas in this work are novel and elegant, and they are instantiated in a progression of simulations that demonstrate the behavior of the circuit. The framework used by the authors is biologically plausible and matches some known biological data. The results attained, as well as the assumptions that go into the theory, provide several predictions for future experimental testing. The authors have taken into account earlier review comments to revise their paper in ways that enhance its clarity.</p>
<p>Weaknesses:</p>
<p>One weakness could be that the proposed theory does rely on a fairly large number of assumptions. However, there is at least some biological support for these. Importantly, the authors do lay out and discuss their key assumptions in the Discussion section, so readers can assess their validity and implications for themselves.</p>
<p>Comments on revisions:</p>
<p>I have no further suggestions for the authors.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95127.3.sa1</article-id>
<title-group>
<article-title>Reviewer #4 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>Wilmes and colleagues develop a model for the computation of uncertainty modulated prediction errors based on an experimentally inspired cortical circuit model for predictive processing. Predictive processing is a promising theory of cortical function. An essential aspect of the model is the idea of precision weighting of prediction errors. There is ample experimental evidence for prediction error responses in cortex. However, a central prediction of the theory is that these prediction error responses are regulated by the uncertainty of the input. Testing this idea experimentally has been difficult due to a lack of concrete models. This work provides one such model and makes experimentally testable predictions.</p>
<p>Strengths:</p>
<p>The model proposed is novel and well-implemented. It has sufficient biological accuracy to make useful and testable predictions.</p>
<p>Weaknesses:</p>
<p>One key idea the model hinges on is that stimulus uncertainty is encoded in the firing rate of parvalbumin positive interneurons. While this assumption is rather speculative, the model also here makes experimentally testable predictions.</p>
<p>Comments on revisions:</p>
<p>Congratulations on a very nice paper.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.95127.3.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Wilmes</surname>
<given-names>Katharina A</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4948-1864</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Petrovici</surname>
<given-names>Mihai A</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sachidhanandam</surname>
<given-names>Shankar</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Senn</surname>
<given-names>Walter</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors‚Äô response to the previous reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>Summary:</p>
<p>This computational modeling study addresses the observation that variable observations are interpreted differently depending on how much uncertainty an agent expects from its environment. That is, the same mismatch between a stimulus and an expected stimulus would be less significant, and specifically would represent a smaller prediction error, in an environment with a high degree of variability than in one where observations have historically been similar to each other. The authors show that if two different classes of inhibitory interneurons, the PV and SST cells, (1) encode different aspects of a stimulus distribution and (2) act in different (divisive vs. subtractive) ways, and if (3) synaptic weights evolve in a way that causes the impact of certain inputs to balance the firing rates of the targets of those inputs, then pyramidal neurons in layer 2/3 of canonical cortical circuits can indeed encode uncertainty-modulated prediction errors. To achieve this result, SST neurons learn to represent the mean of a stimulus distribution and PV neurons its variance.</p>
<p>The impact of uncertainty on prediction errors in an understudied topic, and this study provides an intriguing and elegant new framework for how this impact could be achieved and what effects it could produce. The ideas here differ from past proposals about how neuronal firing represents uncertainty. The developed theory is accompanied by several predictions for future experimental testing, including the existence of different forms of coding by different subclasses of PV interneurons, which target different sets of SST interneurons (as well as pyramidal cells). The authors are able to point to some experimental observations that are at least consistent with their computational results. The simulations shown demonstrate that if we accept its assumptions, then the authors‚Äô theory works very well: SSTs learn to represent the mean of a stimulus distribution, PVs learn to estimate its variance, firing rates of other model neurons scale as they should, and the level of uncertainty automatically tunes the learning rate, so that variable observations are less impactful in a high uncertainty setting.</p>
<p>Strengths:</p>
<p>The ideas in this work are novel and elegant, and they are instantiated in a progression of simulations that demonstrate the behavior of the circuit. The framework used by the authors is biologically plausible and matches some known biological data. The results attained, as well as the assumptions that go into the theory, provide several predictions for future experimental testing. The authors have taken into account earlier review comments to revise their paper in ways that enhance its clarity.</p>
<p>Weaknesses:</p>
<p>One weakness could be that the proposed theory does rely on a fairly large number of assumptions. However, there is at least some biological support for these. Importantly, the authors do lay out and discuss their key assumptions in the Discussion section, so readers can assess their validity and implications for themselves.</p>
</disp-quote>
<p>Thank you very much, we are very satisfied with this public review.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #4 (Public Review):</bold></p>
<p>Summary:</p>
<p>Wilmes and colleagues develop a model for the computation of uncertainty modulated prediction errors based on an experimentally inspired cortical circuit model for predictive processing. Predictive processing is a promising theory of cortical function. An essential aspect of the model is the idea of precision weighting of prediction errors. There is ample experimental evidence for prediction error responses in cortex. However, a central prediction of the theory is that these prediction error responses are regulated by the uncertainty of the input. Testing this idea experimentally has been difficult due to a lack of concrete models. This work provides one such model and makes experimentally testable predictions.</p>
<p>Strengths:</p>
<p>The model proposed is novel and well-implemented. It has sufficient biological accuracy to make useful and testable predictions.</p>
<p>Weaknesses:</p>
<p>One key idea the model hinges on is that stimulus uncertainty is encoded in the firing rate of parvalbumin positive interneurons. This assumption, however, is rather speculative and there is no direct evidence for this.</p>
</disp-quote>
<p>Thank you very much for this nice description. With regard to the weakness: it is true that the key idea hinges on uncertainty being encoded in the firing of inhibitory neurons. If it turns out that these inhibitory neurons are not PV neurons, however, the theory does not break down. The suggestion of PV neurons is fueled by the observation that PV neurons implement shunting and hence divisive inhibition and by the connectivity of PVs in the circuit. We discuss this in the discussion section: &quot;To provide experimental predictions that are immediately testable, we suggested specific roles for SSTs and PVs, as they can subtractively and divisively modulate pyramidal cell activity, respectively. In principle, our theory more generally posits that any subtractive or divisive inhibition could implement the suggested computations. With the emerging data on inhibitory cell types, subtypes of SSTs and PVs or other cell types may turn out to play the proposed role.&quot;</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations for the authors:</bold></p>
<p><bold>Reviewer #4 (Recommendations For The Authors):</bold></p>
<p>(1) Line numbers would simplify reviewing.</p>
</disp-quote>
<p>We will add line numbers to our next submission.</p>
<disp-quote content-type="editor-comment">
<p>(2) The existence of positive and negative PE was already suggested by Rao &amp; Ballard.</p>
</disp-quote>
<p>We added the citation to the sentence &quot;Because baseline firing rates are low in layer 2/3 pyramidal cells () positive and negative prediction errors were suggested to be represented by distinct neuronal populations [44,66],[...]&quot; in the section &quot;Computation of UPEs in cortical microcircuits&quot;.</p>
<disp-quote content-type="editor-comment">
<p>(3) wekk should probably read well.</p>
</disp-quote>
<p>Indeed, thank you. We fixed it.</p>
<disp-quote content-type="editor-comment">
<p>(4) Figure 4. legends A-C are mixed up. What are the two values of ¬¶s-u¬¶ in F and I - the same as in D and F.</p>
</disp-quote>
<p>Thank you, we fixed this.</p>
<disp-quote content-type="editor-comment">
<p>(5) &quot;representation neurons, the activity of which reflects the internal model&quot;. For consistency with the original definitions this should read &quot;the activity of which reflects the internal representation&quot;. The internal &quot;model&quot; is the synaptic weights (or transformation between areas) - the activity of representation neurons (as the name implies) is the internal &quot;representation&quot;.</p>
</disp-quote>
<p>Thank you, we changed it.</p>
<disp-quote content-type="editor-comment">
<p>(6) &quot;Mice trained in a predictable environment [...] [4].&quot; This should read &quot;reared&quot; in an unpredictable environment, etc. Relatedly, the problem with this argument is that, the referenced paper argues that the mice never learned to predict and the reduced PE responses are a consequence of a reduction in prediction strength (these mice never - in life - had experience of visuomotor coupling). Better evidence might be the acute changes observed in normal mice (see e.g. Figure 3B in <ext-link ext-link-type="uri" xlink:href="https://pubmed.ncbi.nlm.nih.gov/22681686/">https://pubmed.ncbi.nlm.nih.gov/22681686/</ext-link> However, another finding from the paper referenced is that in mice reared without visuomotor coupling, MM responses of SST interneurons are unchanged, while those in PV interneurons are completely absent. Would the authors model come to similar results if trained in an environment with (very) high uncertainty and then tested in a low uncertainty environment?</p>
</disp-quote>
<p>Thank you for pointing us to Figure 3B of Keller et al. 2012. We are now citing this result as it is indeed better evidence.</p>
<p>Thank you very much for your illuminating question and for pointing out that a mouse that never experienced a predictable visual flow may not have formed a model of the visual flow, and hence may not have any prediction about its visual experience. We haven‚Äôt considered this scenario in our paper before. So far, we only considered scenarios, in which it is possible to learn a prediction, i.e. to infer the mean from the sensory input. We now consider this other scenario in which the mouse that was reared in an unpredictable environment did not form a prediction and compare SST (1) and PV (2) activity in this mouse to one that learned to form a prediction, and added it to the section &quot;Predictions for different cell types&quot;:</p>
<p>&quot;Second, prediction error activity seems to decrease in less predictable, and hence more uncertain, contexts: in mice reared in a predictable environment [where locomotion and visual flow match, 42], error neuron responses to mismatches in locomotion and visual flow decreased with each day of experiencing these unpredictable mismatches. Third, the responses of SSTs and PVs to mismatches between locomotion and visual flow [4] are in line with our model (note that in this experiment the mismatches are negative prediction errors as visual flow was halted despite ongoing locomotion): In this study, SST responses decreased during mismatch, i.e. when the visual flow was halted, and there was no difference between mice reared in a predictable or unpredictable environment. In line with these observations, the authors concluded that SST responses reflected the actual visual input. In our model negative PE circuit, SSTs also reflect the actual stimulus input, which in our case was a whisker stimulus (SST rates in Fig. 6C and I reflect the stimuli (black and grey bar) in A and G, respectively) and SST rates are the same for high and low uncertainty (corresponding to mice reared in a predictable or unpredictable environment). In the same study, PV responses were absent towards mismatches in animals reared in an unpredictable environment [4]. The authors argued that mice reared in an unpredictable environment did not learn to form a prediction. In our model, the missing prediction corresponds to missing predictive input from the auditory domain (e.g. due to undeveloped synapses from the predictive auditory input). If we removed the predictive input in our model, PVs in the negative PE circuit would also be silent as they would not receive any of the excitatory predictive inputs.&quot;</p>
<disp-quote content-type="editor-comment">
<p>(7) &quot;Our model further posits the existence of two distinct subtypes of SSTs in positive and negative error circuits.&quot; There is some evidence for this: Figure 5a in <ext-link ext-link-type="uri" xlink:href="https://pubmed.ncbi.nlm.nih.gov/36747710/">https://pubmed.ncbi.nlm.nih.gov/36747710/</ext-link></p>
</disp-quote>
<p>Thank you, we added this citation to the corresponding section.</p>
</body>
</sub-article>
</article>