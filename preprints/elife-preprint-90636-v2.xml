<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">90636</article-id>
<article-id pub-id-type="doi">10.7554/eLife.90636</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.90636.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Genetics and Genomics</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Efficient estimation for large-scale linkage disequilibrium patterns of the human genome</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Huang</surname>
<given-names>Xin</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">6</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Zhu</surname>
<given-names>Tian-Neng</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">6</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Liu</surname>
<given-names>Ying-Chao</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2412-3932</contrib-id>
<name>
<surname>Qi</surname>
<given-names>Guo-An</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhang</surname>
<given-names>Jian-Nan</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5475-8237</contrib-id>
<name>
<surname>Chen</surname>
<given-names>Guo-Bo</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Institute of Bioinformatics, Zhejiang University</institution>, Hangzhou, Zhejiang Province, <country>China</country></aff>
<aff id="a2"><label>2</label><institution>Center for General Practice Medicine, Department of General Practice Medicine; Center for Reproductive Medicine, Department of Genetic and Genomic Medicine, and Clinical Research Institute, Zhejiang Provincial People‚Äôs Hospital, People‚Äôs Hospital of Hangzhou Medical College</institution>, Hangzhou, Zhejiang, <country>China</country></aff>
<aff id="a3"><label>3</label><institution>Alibaba Group</institution>, Hangzhou, Zhejiang, <country>China</country></aff>
<aff id="a4"><label>4</label><institution>Key Laboratory of Endocrine Gland Diseases of Zhejiang Province</institution>, Hangzhou, Zhejiang, <country>China</country></aff>
<aff id="a5"><label>5</label><institution>Hainan Institute of Zhejiang University</institution>, Sanya, Hainan, <country>China</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Young</surname>
<given-names>Alexander</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of California, Los Angeles</institution>
</institution-wrap>
<city>Los Angeles</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Weigel</surname>
<given-names>Detlef</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Biology T√ºbingen</institution>
</institution-wrap>
<city>T√ºbingen</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>Correspondence (GBC): <email>chenguobo@gmail.com</email>,</corresp>
<fn fn-type="others"><p>(<email>huangxin0221@zju.edu.cn</email>)</p></fn>
<fn fn-type="others"><p>(<email>zhutianneng@zju.edu.cn</email>)</p></fn>
<fn fn-type="others"><p>(<email>22016031@zju.edu.cn</email>)</p></fn>
<fn fn-type="others"><p>(<email>guoan.qi@foxmail.com</email>)</p></fn>
<fn fn-type="others"><p>(<email>zjn364739@alibaba-inc.com</email>)</p></fn>
<fn fn-type="others"><p>(<email>chenguobo@gmail.com</email>)</p></fn>
<fn id="n1" fn-type="equal"><label>6</label><p>Equal contribution</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-10-05">
<day>05</day>
<month>10</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2023-11-10">
<day>10</day>
<month>11</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP90636</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-08-07">
<day>07</day>
<month>08</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-08-07">
<day>07</day>
<month>08</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.06.18.545475"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-10-05">
<day>05</day>
<month>10</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.90636.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.90636.1.sa2">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.90636.1.sa1">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.90636.1.sa0">Reviewer #2 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>¬© 2023, Huang et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Huang et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-90636-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>In this study, we proposed an efficient algorithm (X-LD) for estimating LD patterns for a genomic grid, which can be of inter-chromosomal scale or of small segments. Compared with conventional methods, the proposed method was significantly faster, dropped from ùí™ (<italic>nm</italic><sup>2</sup>) to ùí™ (<italic>n</italic><sup><italic>2</italic></sup><italic>m</italic>)‚Äî<italic>n</italic> the sample size and <italic>m</italic> the number of SNPs, and consequently we were permitted to explore in depth unknown or reveal long-anticipated LD features of the human genome. Having applied the algorithm for 1000 Genome Project (1KG), we found: <bold>I</bold>) The extended LD, driven by population structure, was universally existed, and the strength of inter-chromosomal LD was about 10% of their respective intra-chromosomal LD in relatively homogeneous cohorts, such as FIN and to nearly 56% in admixed cohort, such as ASW. <bold>II</bold>) After splitting each chromosome into upmost more than a half million grids, we elucidated the LD of the HLA region was nearly 42 folders higher than chromosome 6 in CEU and 11.58 in ASW; on chromosome 11, we observed that the LD of its centromere was nearly 94.05 folders higher than chromosome 11 in YRI and 42.73 in ASW. <bold>III</bold>) We uncovered the long-anticipated inversely proportional linear relationship between the length of a chromosome and the strength of chromosomal LD, and their Pearson‚Äôs correlation was on average over 0.80 for 26 1KG cohorts. However, this linear norm was so far perturbed by chromosome 11 given its more completely sequenced centromere region. Uniquely chromosome 8 of ASW was found most deviated from the linear norm than any other autosomes. The proposed algorithm has been realized in C++ (called X-LD) and available at <ext-link ext-link-type="uri" xlink:href="https://github.com/gc5k/gear2">https://github.com/gc5k/gear2</ext-link>, and can be applied to explore LD features in any sequenced populations.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>revised for eLife</p></fn>
</fn-group>
<fn-group content-type="external-links">
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://wwwdev.ebi.ac.uk/eva/?eva-study=PRJEB30460">https://wwwdev.ebi.ac.uk/eva/?eva-study=PRJEB30460</ext-link>
</p></fn>
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://wwwdev.ebi.ac.uk/eva/?eva-study=PRJNA289433">https://wwwdev.ebi.ac.uk/eva/?eva-study=PRJNA289433</ext-link>
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Linkage disequilibrium (LD) is the association for a pair of loci and the metric of LD serves as the basis for developing genetic applications in agriculture, evolutionary biology, and biomedical researches (<xref ref-type="bibr" rid="c28">Weir, 2008</xref>; <xref ref-type="bibr" rid="c13">Hill and Robertson, 1966</xref>). The structure of LD of the human genome is shaped by many factors, mutation, recombination, population demography, epistatic fitness, and completeness of genomic data itself (<xref ref-type="bibr" rid="c21">Myers <italic>et al</italic>., 2005</xref>; <xref ref-type="bibr" rid="c22">Nei and Li, 1973</xref>; <xref ref-type="bibr" rid="c1">Ardlie <italic>et al</italic>., 2002</xref>). Due to its overwhelming cost, LD structure investigation is often compromised to a small genomic region (<xref ref-type="bibr" rid="c7">Chang <italic>et al</italic>., 2015</xref>; <xref ref-type="bibr" rid="c25">Theodoris <italic>et al</italic>., 2021</xref>), and their typical LD structure is as illustrated for a small segment (<xref ref-type="bibr" rid="c3">Barrett <italic>et al</italic>., 2005</xref>). Now, given the availability of large-scale genomic data, such as millions of single nucleotide polymorphisms (SNPs), the large-scale LD patterns of the human genome play crucial roles in determining genomics studies, and many theories and useful algorithms upon large-scale LD structure, from genome-wide association studies, polygenic risk prediction for complex diseases, and choice for reference panels for genotype imputation (<xref ref-type="bibr" rid="c26">Vilhj√°lmsson <italic>et al</italic>., 2015</xref>; <xref ref-type="bibr" rid="c31">Yang and Zhou, 2020</xref>; <xref ref-type="bibr" rid="c4">Bulik-Sullivan <italic>et al</italic>., 2015</xref>; <xref ref-type="bibr" rid="c30">Yang <italic>et al</italic>., 2011</xref>; <xref ref-type="bibr" rid="c10">Das <italic>et al</italic>., 2016</xref>).</p>
<p>However, there are impediments, largely due to intensified computational cost, in both investigating large-scale LD and providing high-resolution illustration for their details. If we consider a genomic grid that is consisted of <italic>m</italic><sup><italic>2</italic></sup> SNP pairs, given a sample of <italic>n</italic> individuals and <italic>m</italic> SNPs (<italic>n ¬´m)</italic> ‚Äì typically as observed in 1000 Genomes Project (1KG) (<xref ref-type="bibr" rid="c19">Lowy-Gallego <italic>et al</italic>., 2019</xref>), its benchmark computational time cost for calculating all pairwise LD is ùí™ (<italic>nm</italic><sup>2</sup>), a burden that quickly drains computational resources given the volume of the genomic data. In practice, it is of interest to know the mean LD of the <inline-formula><inline-graphic xlink:href="545475v3_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula> SNP pairs for a genomic grid, which covers <italic>m</italic><sub><italic>i</italic></sub> <italic>√óm</italic><sub><italic>j</italic></sub> SNP pairs. Upon how a genomic grid is defined, a genomic grid consequently can be consisted of : <bold>i</bold>) the whole genome-wide <italic>m</italic><sup><italic>2</italic></sup> SNP pairs, and we denote their mean LD as <italic>‚Ñìg</italic> ; <bold>ii</bold>) the intra-chromosomal mean LD for the <italic>ith</italic> chromosome of <inline-formula><inline-graphic xlink:href="545475v3_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula> SNP pairs, and denote as <italic>‚Ñìi</italic> ; <bold>iii</bold>) the inter-chromosomal mean LD and chromosomal <italic>m</italic><sub><italic>i</italic></sub> <italic>m</italic><sub><italic>j</italic></sub> SNP pairs, and denoted as <italic>‚Ñìi¬∑ j</italic> .</p>
<p>In this study we propose an efficient algorithm that can estimate <italic>‚Ñìg, ‚Ñìi</italic>, and <italic>‚Ñì i¬∑ j</italic> ¬∑, the computational time of which can be reduced from <inline-formula><inline-graphic xlink:href="545475v3_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula> to ùí™ (<italic>n</italic><sup><italic>2</italic></sup><italic>m</italic><sub><italic>i</italic></sub>) for <italic>‚Ñìi</italic> and ùí™ (<italic>nm</italic><sub><italic>i</italic></sub> <italic>m</italic><sub><italic>j</italic></sub>) to ùí™ (<italic>n</italic><sup><italic>2</italic></sup><italic>m</italic><sub><italic>i</italic></sub><italic>+n</italic><sup><italic>2</italic></sup><italic>m</italic><sub><italic>j</italic></sub> <italic>)</italic> for <italic>‚Ñìi¬∑ j</italic>. The rationale of the proposed method relies on the connection between the genetic relationship matrix (GRM) and LD (<xref ref-type="bibr" rid="c8">Chen, 2014</xref>; <xref ref-type="bibr" rid="c12">Goddard, 2009</xref>), and in this study a more general transformation from GRM to LD can be established via Isserlis‚Äôs theorem (<xref ref-type="bibr" rid="c16">Isserlis, 1918</xref>; <xref ref-type="bibr" rid="c33">Zhou, 2017</xref>). The statistical properties, such as sampling variance, of the estimated LD have been derived too.</p>
<p>The proposed method can be analogously considered a more powerful realization for Haploview (<xref ref-type="bibr" rid="c3">Barrett <italic>et al</italic>., 2005</xref>), but additional utility can be derived to bring out unprecedented survey of LD patterns of the human genome. As demonstrated in 1KG, we consequently investigate how biological factors such as population structure, admixture, or variable local recombination rates can shape large-scale LD patterns of the human genomes.</p>
<list list-type="order">
<list-item><p>The proposed method provides statistically unbiased estimates for large-scale LD patterns and shows computational merits compared with the conventional methods <bold>(<xref rid="fig2" ref-type="fig">Figure 2</xref>)</bold>.</p></list-item>
<list-item><p>We estimated <italic>‚Ñìg</italic>, and 22 autosomal <italic>‚Ñìi</italic>. and 231 inter-autosomal <italic>‚Ñìi¬∑ j</italic> for the 1KG cohorts. There were ubiquitously existence of extended LD, which was associated with population structure or admixture <bold>(<xref rid="fig3" ref-type="fig">Figure 3</xref>)</bold>.</p></list-item>
<list-item><p>We provided high-resolution illustration that decomposed a chromosome into upmost nearly a million grids, each of which was consisted of 250√ó250 SNP pairs, the highest resolution that has been realized so far at autosomal level <bold>(<xref rid="fig4" ref-type="fig">Figure 4</xref>)</bold>; tremendous variable recombination rates led to regional strong LD as highlighted for the HLA region of chromosomes 6 and the centromere region of chromosome 11.</p></list-item>
<list-item><p>Furthermore, a consequently linear regression constructed could quantify LD decay score genome-widely, and in contrast LD decay was previously surrogated in a computational expensive method. There was strong ethnicity effect that was associated with extended LD <bold>(<xref rid="fig5" ref-type="fig">Figure 5</xref>)</bold>.</p></list-item>
<list-item><p>We demonstrate that the strength of autosomal <italic>‚Ñìi</italic>. was inversely proportional to the SNP number, an anticipated relationship that is consistent to genome-wide spread of recombination hotspots. However, the chromosome 8 of ASW showed substantial deviation from the fitted linear relationship <bold>(<xref rid="fig6" ref-type="fig">Figure 6</xref>)</bold>.</p></list-item>
</list>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Schematic illustration for large-scale LD analysis as exampled for CONVERGE cohort.</title>
<p><bold>A)</bold> The 22 human autosomes have consequently 22 <inline-formula><inline-graphic xlink:href="545475v3_inline93.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and 231 <inline-formula><inline-graphic xlink:href="545475v3_inline94.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, ut (left) and with (right) scaling transformation; Scaling transformation is given in <bold><xref ref-type="disp-formula" rid="eqn8">Eq 8</xref>. B</bold>) If zoom into chromosome 2 of 420,946 SNPs, a chromosome of relative lity is expected to have self-similarity structure that harbors many approximately strong <inline-formula><inline-graphic xlink:href="545475v3_inline95.gif" mimetype="image" mime-subtype="gif"/></inline-formula> along the diagonal, and relatively weak <inline-formula><inline-graphic xlink:href="545475v3_inline96.gif" mimetype="image" mime-subtype="gif"/></inline-formula> off-diagonally. Here osome 2 of CONVERGE has been split into 1,000 blocks and yielded 1000 <inline-formula><inline-graphic xlink:href="545475v3_inline97.gif" mimetype="image" mime-subtype="gif"/></inline-formula> LD grids, and 499,500 <inline-formula><inline-graphic xlink:href="545475v3_inline98.gif" mimetype="image" mime-subtype="gif"/></inline-formula> LD grids. <bold>C</bold>) An illustration of the construction process for D-decay regression model</p></caption>
<graphic xlink:href="545475v3_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Reconciliation for LD estimators in the 26 cohorts of 1KG.</title>
<p><bold>A)</bold> Consistency examination for the 26 1KG cohorts for their <inline-formula><inline-graphic xlink:href="545475v3_inline99.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545475v3_inline100.gif" mimetype="image" mime-subtype="gif"/></inline-formula> estimated by X-LD and PLINK (--r2). In each figure, the 22 <inline-formula><inline-graphic xlink:href="545475v3_inline101.gif" mimetype="image" mime-subtype="gif"/></inline-formula> fitting line is in purple, whereas the 231 <inline-formula><inline-graphic xlink:href="545475v3_inline102.gif" mimetype="image" mime-subtype="gif"/></inline-formula> fitting line is in green. The gray solid line,<inline-formula><inline-graphic xlink:href="545475v3_inline103.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, in which <italic>n</italic> the sample size of each cohort, represents the expected fit between PLINK and X-LD estimates, and the two estimated regression models at the top-right corner of each plot shown this consistency. The sample size of each cohort is in parentheses. <bold>B)</bold> Distribution of <italic>R</italic><sup>2</sup> of <inline-formula><inline-graphic xlink:href="545475v3_inline104.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545475v3_inline105.gif" mimetype="image" mime-subtype="gif"/></inline-formula> fitting lines is based on X-LD and PLINK algorithms in the 26 cohorts; <italic>R</italic><sup>2</sup> represents variation explained by the fitted model. 26 1KG cohorts: MSL (Mende in Sierra Leone), GWD (Gambian in Western Division, The Gambia), YRI (Yoruba in Ibadan, Nigeria), ESN (Esan in Nigeria), ACB (African Caribbean in Barbados), LWK (Luhya in Webuye, Kenya), ASW (African Ancestry in Southwest US); CHS (Han Chinese South), CDX (Chinese Dai in Xishuangbanna, China), KHV (Kinh in Ho Chi Minh City, Vietnam), CHB (Han Chinese in Beijing, China), JPT (Japanese in Tokyo, Japan); BEB (Bengali in Bangladesh), ITU (Indian Telugu in the UK), STU (Sri Lankan Tamil in the UK), PJL (Punjabi in Lahore, Pakistan), GIH (Gujarati Indian in Houston, TX); TSI (Toscani in Italia), IBS (Iberian populations in Spain), CEU (Utah residents (CEPH) with Northern and Western European ancestry), GBR (British in England and Scotland), FIN (Finnish in Finland); MXL (Mexican Ancestry in Los Angeles, California), PUR (Puerto Rican in Puerto Rico), CLM (Colombian in Medellin, Colombia), PEL (Peruvian in Lima, Peru).</p></caption>
<graphic xlink:href="545475v3_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Various LD components for the 26 1KG cohorts.</title>
<p><bold>A)</bold> Chromosomal scale LD components for 5 representative cohorts (CEU, CHB, YRI, ASW, and 1KG). The upper parts of each figure represent <inline-formula><inline-graphic xlink:href="545475v3_inline106.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (along the diagonal) and <inline-formula><inline-graphic xlink:href="545475v3_inline107.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (off-diagonal), and the lower part <inline-formula><inline-graphic xlink:href="545475v3_inline108.gif" mimetype="image" mime-subtype="gif"/></inline-formula> as in <bold><xref ref-type="disp-formula" rid="eqn8">Eq 8</xref></bold>. For visualization purposes, the quantity of LD before scaling is transformed to a -log10 scale, with smaller values (red hues) representing larger LD, and a value of 0 representing that all SNPs are in LD. <bold>B)</bold> The relationship between the degree of population structure (approximated by <inline-formula><inline-graphic xlink:href="545475v3_inline109.gif" mimetype="image" mime-subtype="gif"/></inline-formula>) and <inline-formula><inline-graphic xlink:href="545475v3_inline110.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="545475v3_inline111.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in the 26 1KG cohorts.</p></caption>
<graphic xlink:href="545475v3_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>High-resolution illustration for LD grids for CEU, CHB, YRI, and ASW (m 250).</title>
<p>For each cohort, we partition chromosomes 6 and 11 into high-resolution LD grids (each LD grid contains 250 X 250 SNP pairs). The bottom half of each figure shows the LD grids for the entire chromosome. Further zooming into HLA on chromosome 6 and the centromere region on chromosome 11, and their detailed LD in the relevant regions are also provided in the upper half of each figure. For visualization purposes, LD is transformed to a -log10-scale, with smaller values (red hues) representing larger LD, and a value of 0 representing that all SNPs are in LD.</p></caption>
<graphic xlink:href="545475v3_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><title>LD decay analysis for 26 1KG cohorts.</title>
<p><bold>A)</bold> Conventional LD decay analysis in PLINK for 26 cohorts. To eliminate the influence of sample size, the inverse of sample size has been subtracted from the original LD values. The YRI cohort, represented by the orange dotted line, is chosen as the reference cohort in each plot. The top-down arrow shows the order of LDdecay values according to <bold><xref rid="tbl5" ref-type="table">Table 5</xref>. B)</bold> Model-based LD decay analysis for the 26 1KG cohorts. We regressed each autosomal against its corresponding inversion of the SNP number for each cohort. Regression coefficient quantifies the averaged LD decay of the genome and intercept provides a direct estimate of possible existence of long-distance LD. The values in the first three plot indicate the correlation between and LD decay score in three different physical distance and the correlation between <inline-formula><inline-graphic xlink:href="545475v3_inline112.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (left-side vertical axis) and LD decay score (right-side vertical axis) and the correlation between <inline-formula><inline-graphic xlink:href="545475v3_inline113.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (left-side vertical axis) and <inline-formula><inline-graphic xlink:href="545475v3_inline114.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (right-side vertical axis), respectively. The last plot assessed the impact of centromere region of chromosome 11 on the linear relationship between chromosomal LD and the inverse of the SNP number. The dark and light gray dashed lines represent the mean of the ‚Ñõwith and without the presence of centromere region of chromosome 11.</p></caption>
<graphic xlink:href="545475v3_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><title>The correlation between the inversion of the SNP number and <inline-formula><inline-graphic xlink:href="545475v3_inline115.gif" mimetype="image" mime-subtype="gif"/></inline-formula></title>
<p><bold>A)</bold> The correlation between the inversion of the SNP number and <inline-formula><inline-graphic xlink:href="545475v3_inline116.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in CEU, CHB, YRI, and ASW. <bold>B)</bold> Leave-one-chromosome-out strategy is adopted to evaluate the contribution of a certain chromosome on the correlation between the inverse of the SNP number and <inline-formula><inline-graphic xlink:href="545475v3_inline117.gif" mimetype="image" mime-subtype="gif"/></inline-formula> <bold>C)</bold> The correlation between the inversion of the SNP number and chromosomal LD in CEU, CHB, YRI, and ASW after removing the centromere region of chromosome 11. <bold>D)</bold> High-resolution illustration for LD grids for chromosome 8 in CEU, CHB, YRI, and ASW. For each cohort, we partition chromosome 8 into consecutive LD grids (each LD grid contains 250 X 250 SNP pairs). For visualization purposes, LD is transformed to a -log10-scale, with smaller values (red hues) representing larger LD, and a value of 0 representing that all SNPs are in LD.</p></caption>
<graphic xlink:href="545475v3_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The proposed algorithm has been realized in C++ and is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/gc5k/gear2">https://github.com/gc5k/gear2</ext-link>. As tested the software could handle sample size as large as 10,000 individuals.</p>
</sec>
<sec id="s2">
<title>Methods and Materials</title>
<sec id="s2a">
<title>The overall rationale for large-scale LD analysis</title>
<p>We assume LD for a pair of biallelic loci is measured by squared Pearson‚Äôs correlation, <inline-formula><inline-graphic xlink:href="545475v3_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in which <inline-formula><inline-graphic xlink:href="545475v3_inline5.gif" mimetype="image" mime-subtype="gif"/></inline-formula> the LD of loci <italic>l</italic><sub>1</sub> and <italic>l</italic><sub>2</sub>, <italic>p</italic> and <italic>q</italic> the reference and the alternative allele frequencies. If we consider the averaged LD for a genomic grid over <inline-formula><inline-graphic xlink:href="545475v3_inline6.gif" mimetype="image" mime-subtype="gif"/></inline-formula> SNP pairs, the conventional estimator is <inline-formula><inline-graphic xlink:href="545475v3_inline7.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and, if we consider the averaged LD for <italic>m</italic><sub><italic>i</italic></sub> <italic>and m</italic><sub><italic>j</italic></sub> SNP pairs between two genomic segments, then <inline-formula><inline-graphic xlink:href="545475v3_inline8.gif" mimetype="image" mime-subtype="gif"/></inline-formula> . Now let us consider the 22 human autosomes (<bold><xref rid="fig1" ref-type="fig">Figure 1A</xref></bold>). We naturally partition the genome into ùíû=22 blocks, and its genomic LD, denoted as <italic>‚Ñìg</italic> can be expressed as
<disp-formula id="eqn1">
<graphic xlink:href="545475v3_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
So we can decompose <italic>‚Ñìg</italic> into ùíû <italic>‚Ñìi</italic>. and <inline-formula><inline-graphic xlink:href="545475v3_inline9.gif" mimetype="image" mime-subtype="gif"/></inline-formula> unique <italic>‚Ñìi</italic>¬∑ <italic>j</italic> . Obviously, <bold><xref ref-type="disp-formula" rid="eqn1">Eq 1</xref></bold> can be also expressed in the context for a single chromosome <inline-formula><inline-graphic xlink:href="545475v3_inline10.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, in which <inline-formula><inline-graphic xlink:href="545475v3_inline11.gif" mimetype="image" mime-subtype="gif"/></inline-formula> the number of SNP segments, each of which has <italic>m</italic> SNPs. Geometrically it leads to Œ≤<sub><italic>i</italic></sub> diagonal grids and <inline-formula><inline-graphic xlink:href="545475v3_inline12.gif" mimetype="image" mime-subtype="gif"/></inline-formula> unique off-diagonal grids <bold>(<xref rid="fig1" ref-type="fig">Figure 1B</xref>)</bold>.</p>
</sec>
<sec id="s2b">
<title>LD-decay regression</title>
<p>As human genome can be boiled down to small LD blocks by genome-widely spread recombination hotspots (<xref ref-type="bibr" rid="c14">Hinch <italic>et al</italic>., 2019</xref>; <xref ref-type="bibr" rid="c17">Li <italic>et al</italic>., 2022</xref>), mechanically there is self-similarity for each chromosome that the relatively strong <italic>‚Ñìi</italic>. for juxtaposed grids along the diagonal but weak <italic>‚Ñìi¬∑ j</italic> for grids slightly off-diagonal. So, for a chromosomal <italic>‚Ñìi</italic>., we can further express it as
<disp-formula id="eqn2">
<graphic xlink:href="545475v3_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
in which <italic>‚Ñìu</italic> is the mean LD for a diagonal grid, <italic>‚Ñìuv</italic> the mean LD for off-diagonal grids, and <italic>m</italic><sub><italic>i</italic></sub> the number of SNPs on the <italic>i</italic><sup>th</sup> chromosome. Consider a linear model below (<bold><xref rid="fig1" ref-type="fig">Figure 1C</xref></bold> for its illustration),
<disp-formula id="eqn3">
<graphic xlink:href="545475v3_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
in which <bold><italic>‚Ñì</italic></bold> represents a vector composed of ùíû <italic>‚Ñìi</italic>., <bold><italic>x</italic></bold> represents a vector composed of ùíû <italic>x</italic><sub><italic>i</italic></sub> and <inline-formula><inline-graphic xlink:href="545475v3_inline13.gif" mimetype="image" mime-subtype="gif"/></inline-formula> the inversion of the SNP number of the chromosome. The regression coefficient and intercept can be estimated as below
<disp-formula id="ueqn1">
<graphic xlink:href="545475v3_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
And
<disp-formula id="ueqn2">
<graphic xlink:href="545475v3_ueqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
There are some technical details in order to find the interpretation for <italic>b</italic><sub>0</sub> and <italic>b</italic><sub>1</sub> .We itemize them briefly. For the mean and variance of <italic>x</italic>:
<disp-formula id="ueqn3">
<graphic xlink:href="545475v3_ueqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
For <italic>E</italic>(<italic>x‚Ñì)</italic>
<disp-formula id="ueqn4">
<graphic xlink:href="545475v3_ueqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
For <italic>E</italic>(<italic>x)</italic> For <italic>E</italic>(<italic>‚Ñì)</italic>
<disp-formula id="ueqn5">
<graphic xlink:href="545475v3_ueqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Then we integrate these items to have the expectation for <italic>b</italic><sub>1</sub>:
<disp-formula id="ueqn6">
<graphic xlink:href="545475v3_ueqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
d</p>
<p>Similarly, we plug in <italic>E</italic>(<italic>b</italic><sub>1</sub>) so as to derive <italic>b</italic><sub>0</sub> :
<disp-formula id="ueqn7">
<graphic xlink:href="545475v3_ueqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
After some algebra, if <italic>E</italic>(<italic>‚Ñì</italic><sub><italic>u</italic></sub>) <italic>‚â´ E</italic> (<italic>‚Ñì</italic><sub><italic>uv</italic></sub>) ‚Äì say if the former is far greater than the latter, the interpretation of <italic>b</italic><sub>1</sub> and <italic>b</italic><sub>0</sub> can be
<disp-formula id="eqn4">
<graphic xlink:href="545475v3_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
It should be noticed that <italic>E</italic>(<italic>b</italic><sub><italic>1</italic></sub>) ‚âà <italic>E</italic>(<italic>‚Ñì</italic><sub><italic>u</italic></sub>)<italic>m</italic> quantifies the averaged LD decay of the genome. Conventional LD decay is analysed via the well-known LD decay analysis, but <bold><xref ref-type="disp-formula" rid="eqn4">Eq 4</xref></bold> provides a direct estimate of both LD decay and possible existence of extended LD. We will see the application of the model in <bold><xref rid="fig5" ref-type="fig">Figure 5</xref></bold> that the strength of the long-distance LD is associated with population structure. of note, the underlying assumption of <bold><xref ref-type="disp-formula" rid="eqn3">Eq 3</xref></bold> and <bold><xref ref-type="disp-formula" rid="eqn4">Eq 4</xref></bold> is genome-wide spread of recombination hotspots, an established result that has been revealed and confirmed (<xref ref-type="bibr" rid="c14">Hinch <italic>et al</italic>., 2019</xref>).</p>
</sec>
<sec id="s2c">
<title>Efficient estimation for ‚Ñì<sub><italic>g</italic></sub>, ‚Ñì<sub><italic>i</italic></sub>, and ‚Ñì<sub><italic>i ¬∑j</italic></sub></title>
<p>For the aforementioned analyses, the bottleneck obviously lies in the computational cost in estimating <italic>‚Ñì</italic><sub><italic>i</italic></sub> and <italic>‚Ñì</italic><sub><italic>i¬∑j¬∑</italic></sub> <italic>‚Ñì</italic><sub><italic>i</italic></sub> and <italic>‚Ñì</italic><sub><italic>i¬∑j</italic></sub> are used to be estimated via the current benchmark algorithm as implemented in PLINK (<xref ref-type="bibr" rid="c7">Chang <italic>et al</italic>., 2015</xref>), and the computational time complex is proportional to <italic>O</italic>(<italic>nm</italic><sup><italic>2</italic></sup>). We present a novel approach to estimate <italic>‚Ñì</italic><sub><italic>i</italic></sub> and <italic>‚Ñì</italic><sub><italic>i¬∑j¬∑</italic></sub> Given a genotypic matrix X, a <italic>n √ó m</italic> mmatrix, if we assume that there are <italic>m</italic><sub><italic>i</italic></sub> and <italic>m</italic><sub><italic>j</italic></sub> SNPs on chromosomes <italic>i</italic> and <italic>j</italic>, respectively, we can construct <italic>n √ó n</italic> genetic relatedness matrices as below
<disp-formula id="eqn5">
<graphic xlink:href="545475v3_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
in which <inline-formula><inline-graphic xlink:href="545475v3_inline14.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the standardized <bold><italic>X</italic></bold><sub><italic>i</italic></sub> and <inline-formula><inline-graphic xlink:href="545475v3_inline15.gif" mimetype="image" mime-subtype="gif"/></inline-formula> where <italic>x</italic><sub><italic>kl</italic></sub> is the genotype for the <italic>K</italic><sup><italic>th</italic></sup> individual at the <italic>l</italic><sup><italic>th</italic></sup> biallelic locus, <italic>F</italic> is the inbreeding coefficient having the value of 0 for random mating population and 1 for an inbred population, <italic>p</italic><sub><italic>l</italic></sub> and <italic>q</italic><sub><italic>l</italic></sub> are the frequencies of the reference and the alternative alleles (<italic>p</italic><sub><italic>l</italic></sub> + <italic>q</italic><sub><italic>l</italic></sub> =1)respectively. When GRM is given, we can obtain some statistical characters of <bold><italic>K</italic></bold><sub><italic>i</italic></sub>. We extract two vectors <inline-formula><inline-graphic xlink:href="545475v3_inline16.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, which stacks the off-diagonal elements of <bold><italic>K</italic></bold><sub><italic>i</italic></sub>, and <inline-formula><inline-graphic xlink:href="545475v3_inline17.gif" mimetype="image" mime-subtype="gif"/></inline-formula> which takes the diagonal elements of <bold><italic>K</italic></bold><sub><italic>i</italic></sub>. The mathematical expectation of <inline-formula><inline-graphic xlink:href="545475v3_inline18.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in which <inline-formula><inline-graphic xlink:href="545475v3_inline19.gif" mimetype="image" mime-subtype="gif"/></inline-formula> can be established according to Isserlis‚Äôs theorem in terms of the four-order moment (<xref ref-type="bibr" rid="c16">Isserlis, 1918</xref>),
<disp-formula id="eqn6">
<graphic xlink:href="545475v3_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
in which <inline-formula><inline-graphic xlink:href="545475v3_inline20.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the expected relatedness score and <italic>r</italic> indicates the <italic>r</italic><sup><italic>th</italic></sup> degree relatives. <italic>r</italic>=0 for the same individual, and <italic>r</italic>=1 for the first degree relatives. Similarly, we can derive for <inline-formula><inline-graphic xlink:href="545475v3_inline21.gif" mimetype="image" mime-subtype="gif"/></inline-formula> <bold><xref ref-type="disp-formula" rid="eqn6">Eq 6</xref></bold> establishes the connection between GRM and the aggregated LD estimation that <inline-formula><inline-graphic xlink:href="545475v3_inline22.gif" mimetype="image" mime-subtype="gif"/></inline-formula> .According to Delta method as exampled in Appendix I of Lynch and Walsh‚Äôs book (<xref ref-type="bibr" rid="c20">Lynch and Walsh, 1998</xref>), the means and the sampling variances for <italic>‚Ñì</italic><sub><italic>i</italic></sub> and <italic>‚Ñì</italic><sub><italic>i¬∑j</italic></sub> are,
<disp-formula id="eqn7">
<graphic xlink:href="545475v3_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
in which <inline-formula><inline-graphic xlink:href="545475v3_inline23.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545475v3_inline24.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, respectively. Of note, the properties of <italic>‚Ñì</italic><sub><italic>g</italic></sub> can be derived similarly if we replace <italic>‚Ñì</italic><sub><italic>i</italic></sub> with <italic>‚Ñì</italic><sub><italic>g</italic></sub> in <bold><xref ref-type="disp-formula" rid="eqn7">Eq 7</xref></bold>. We can develop <inline-formula><inline-graphic xlink:href="545475v3_inline25.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, a scaled version of <italic>‚Ñì</italic><sub><italic>i¬∑j¬∑</italic></sub> as below
<disp-formula id="eqn8">
<graphic xlink:href="545475v3_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
in which <inline-formula><inline-graphic xlink:href="545475v3_inline26.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, a modification that removed the LD with itself. According to Delta method, the sampling variance of <inline-formula><inline-graphic xlink:href="545475v3_inline27.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is
<disp-formula id="eqn9">
<graphic xlink:href="545475v3_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Of note, when there is no LD between a pair of loci, <italic>‚Ñì</italic> yields zero and its counterpart PLINK estimate yields <inline-formula><inline-graphic xlink:href="545475v3_inline28.gif" mimetype="image" mime-subtype="gif"/></inline-formula>,a difference that can be reconciled in practice <bold>(see <xref rid="fig2" ref-type="fig">Figure 2</xref>)</bold>.</p>
</sec>
<sec id="s2d">
<title>Raise of LD due to population structure</title>
<p>In this study, the connection between LD and population structure is bridged via two pathways below, in terms of a pair of loci and of the aggregated LD for all pair of loci. For a pair of loci, their LD is often simplified as <inline-formula><inline-graphic xlink:href="545475v3_inline29.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, but will be inflated if there are subgroups (<xref ref-type="bibr" rid="c22">Nei and Li, 1973</xref>). In addition, it is well established the connection between population structure and eigenvalues, and in particular the largest eigenvalue is associated with divergence of subgroups (<xref ref-type="bibr" rid="c24">Patterson <italic>et al</italic>., 2006</xref>). In this study, the existence of subgroups of cohort is surrogated by the largest eigenvalue <inline-formula><inline-graphic xlink:href="545475v3_inline30.gif" mimetype="image" mime-subtype="gif"/></inline-formula>.</p>
</sec>
<sec id="s2e">
<title>Data description and quality control</title>
<p>The 1KG (<xref ref-type="bibr" rid="c2">Auton <italic>et al</italic>., 2015</xref>), which is launched to produce a deep catalogue of human genomic variation by whole genome sequencing (WGS) or whole exome sequencing (WES), and 2,503 strategically selected individuals of global diversity are included (containing 26 cohorts). We used the following criteria for SNP inclusion for each of the 26 1KG cohorts: i) autosomal SNPs only; ii) SNPs with missing genotype rates higher than 0.2 were removed, and missing genotypes were imputed; iii) Only SNPs with minor allele frequencies higher than 0¬∑05 were retained. Then 2,997,635 consensus SNPs that were present in each of the 26 cohorts were retained. According to their origins, the 26 cohorts are grouped as African (AFR: MSL, GWD, YRI, ESN, ACB, LWK, and ASW), European (EUR: TSI, IBS, CEU, GBR, and FIN), East Asian (EA: CHS, CDX, KHV, CHB, and JPT), South Asian (SA: BEB, ITU, STU, PJL, and GIH), and American (AMR: MXL, PUR, CLM, and PEL), respectively.</p>
<p>In addition, to test the capacity of the developed software (X-LD), we also included CONVERGE cohort (<italic>n</italic>=10,640), which was used to investigate Major Depressive Disorder (MDD) in the Han Chinese population (<xref ref-type="bibr" rid="c6">Cai <italic>et al</italic>., 2015</xref>). We performed the same criteria for SNP inclusion as that of the 1KG cohorts, and <italic>m=</italic>5,215,820 SNPs were remained for analyses.</p>
</sec>
<sec id="s2f">
<title>X-LD software implementation</title>
<p>The proposed algorithm has been realized in our X-LD software, which is written in C++ and reads in binary genotype data as often used in PLINK. As multi-thread programming is adopted, the efficiency of X-LD can be improved upon the availability of computational resources. We have tested X-LD in various independent datasets for its reliability and robustness. Certain data management options, such as flexible inclusion or exclusion of chromosomes, have been built into the commands of X-LD. In X-LD, missing genotypes are naively imputed according to Hardy-Weinberg proportions; however, when missing rate is high, we suggest the genotype matrix should be imputed by other advanced imputation tools.</p>
<p>The most time-consuming part of X-LD was the construction of GRM <inline-formula><inline-graphic xlink:href="545475v3_inline31.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and the established computational time complex was <italic>ùí™</italic> (<italic>n</italic><sup>2</sup><italic>m</italic>). However, if <inline-formula><inline-graphic xlink:href="545475v3_inline32.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is decomposed into <inline-formula><inline-graphic xlink:href="545475v3_inline33.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, in which <inline-formula><inline-graphic xlink:href="545475v3_inline34.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, has dimension of <italic>n</italic> √ó <italic>B</italic>, using Mailman algorithm the computational time complex for building <bold>K</bold> can be reduced to <inline-formula><inline-graphic xlink:href="545475v3_inline35.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (<xref ref-type="bibr" rid="c18">Liberty and Zucker, 2009</xref>). This idea of embedding Mailman algorithm into certain high throughput genomic studies has been successful, and our X-LD software is also leveraged by absorbing its recent practice in genetic application (<xref ref-type="bibr" rid="c29">Wu and Sankararaman, 2018</xref>).</p>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Statistical properties of the proposed method</title>
<p><bold><xref rid="tbl1" ref-type="table">Table 1</xref></bold> introduced symbols frequently cited in this study. As schematically illustrated in <bold><xref rid="fig1" ref-type="fig">Figure 1</xref></bold>, <italic>‚Ñì</italic><sub><italic>g</italic></sub> could be decomposed into <italic>ùíû ‚Ñì</italic><sub><italic>i</italic></sub> and <inline-formula><inline-graphic xlink:href="545475v3_inline36.gif" mimetype="image" mime-subtype="gif"/></inline-formula> unique <italic>‚Ñì</italic><sub><italic>i,j</italic></sub> components. We compared the estimated <italic>‚Ñì;</italic><sub><italic>i</italic></sub> and <italic>‚Ñì</italic><sub><italic>i,j</italic></sub> in X-LD with those being estimated in PLINK (known as ‚Äú--r2‚Äù, and the estimated squared Pearson‚Äôs correlation LD is denoted as <italic>r</italic><sup>2</sup>). Considering the 212 substantial computational cost of PLINK, only 100,000 randomly selected autosome SNPs were used for each 1KG cohort, and 22 <inline-formula><inline-graphic xlink:href="545475v3_inline37.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and 231 <inline-formula><inline-graphic xlink:href="545475v3_inline38.gif" mimetype="image" mime-subtype="gif"/></inline-formula> were estimated. After regressing 22 <inline-formula><inline-graphic xlink:href="545475v3_inline39.gif" mimetype="image" mime-subtype="gif"/></inline-formula> against those of PLINK, we found that the regression slope was close to unity and bore an anticipated intercept a quantity of approximately <inline-formula><inline-graphic xlink:href="545475v3_inline40.gif" mimetype="image" mime-subtype="gif"/></inline-formula> <bold>(<xref rid="fig2" ref-type="fig">Figure 2A</xref> and <xref rid="fig2" ref-type="fig">Figure 2B</xref>)</bold>.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>Notation definitions</title></caption>
<graphic xlink:href="545475v3_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>In other words, PLINK gave <inline-formula><inline-graphic xlink:href="545475v3_inline41.gif" mimetype="image" mime-subtype="gif"/></inline-formula> even for SNPs of no LD. However, when regressing 231 <inline-formula><inline-graphic xlink:href="545475v3_inline42.gif" mimetype="image" mime-subtype="gif"/></inline-formula> estimates against those of PLINK, it was found that largely because of tiny quantity of <inline-formula><inline-graphic xlink:href="545475v3_inline43.gif" mimetype="image" mime-subtype="gif"/></inline-formula> it was slightly smaller than 1 but statistically insignificant from 1 in these 26 1KG cohorts (mean of 0.86 and s.d. of 0.10, and its 95 % confidence interval was (0.664, 1.056)); when the entire 1KG samples were used, its much larger LD due to subgroups, nearly no estimation bias was found <bold>(<xref rid="fig2" ref-type="fig">Figure 2A</xref> and <xref rid="fig2" ref-type="fig">Figure 2B</xref>)</bold>. In contrast, because of their much larger values, <inline-formula><inline-graphic xlink:href="545475v3_inline44.gif" mimetype="image" mime-subtype="gif"/></inline-formula> components were always consistent with their corresponding estimates from PLINK (mean of 1.03 and s.d. of 0.012, 95% confidence interval was (1.006, 1.053), bearing an ignorable bias). Furthermore, we also combined the African cohorts together (MSL, GWD, YRI, ESN, LWK, totaling 599 individuals), the East Asian cohorts together (CHS, CDX, KHV, CHB, and JPT, totaling 504 individuals), and the European cohorts together (TSI, IBS, CEU, GBR, and FIN, totaling 503 individuals), the resemblance pattern between X-LD and PLINK was similar as observed in each cohort alone <bold>(<xref rid="figS1" ref-type="fig">Figure S1</xref>)</bold>. The empirical data in 1KG verified that the proposed method was sufficiently accurate.</p>
<p>To fairly evaluate the computational efficiency of the proposed method, the benchmark comparison was conducted on the first chromosome of the entire 1KG dataset (<italic>n</italic> =2.503) and <italic>m</italic> =(225,967), and 10 CPUs were used for multi-thread computing. Compared with PLINK, the calculation efficiency of X-LD was nearly 30‚àº40 times faster for the tested chromosome, and its computational time of X-LD was proportional to <inline-formula><inline-graphic xlink:href="545475v3_inline45.gif" mimetype="image" mime-subtype="gif"/></inline-formula> <bold>(<xref rid="figS2" ref-type="fig">Figure S2</xref>)</bold>. So, X-LD provided a feasible and reliable estimation of large-scale complex LD patterns. More detailed computational time of the tested tasks would be reported in their corresponding sections below; since each 1KG cohort had sample size around 100, otherwise specified the computational time was reported for CHB (<italic>n</italic> = 103) as a reference <bold>(<xref rid="tbl2" ref-type="table">Table 2</xref>)</bold>. In order to test the capability of the software, the largest dataset tested was CONVERGE (<italic>n</italic> =10,640, and (<italic>n</italic> =5,215,820), and it took 77,508.00 seconds, about 22 hours, to estimate 22 autosomal <inline-formula><inline-graphic xlink:href="545475v3_inline46.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and 231 <inline-formula><inline-graphic xlink:href="545475v3_inline47.gif" mimetype="image" mime-subtype="gif"/></inline-formula> <bold>(<xref rid="fig1" ref-type="fig">Figure 1A</xref>)</bold>;</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><title>Computational time for the demonstrated estimation tasks</title></caption>
<graphic xlink:href="545475v3_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>When zooming into chromosome 2 of CONVERGE, on which 420,949 SNP had been evenly split into 1,000 blocks and yielded 1,000 <inline-formula><inline-graphic xlink:href="545475v3_inline48.gif" mimetype="image" mime-subtype="gif"/></inline-formula> grids, and 499,500 <inline-formula><inline-graphic xlink:href="545475v3_inline49.gif" mimetype="image" mime-subtype="gif"/></inline-formula> LD grids, it took 45,125.00 seconds, about 12.6 hours, to finished the task <bold>(<xref rid="fig1" ref-type="fig">Figure 1B</xref>)</bold>.</p>
</sec>
<sec id="s3b">
<title>Ubiquitously extended LD and population structure/admixture</title>
<p>We partitioned the 2,997,635 SNPs into 22 autosomes <bold>(<xref rid="fig3" ref-type="fig">Figure 3A</xref> and <xref rid="figS3" ref-type="fig">Figure S3</xref>)</bold>, and the general LD patterns were as illustrated for CEU, CHB, YRI, ASW, and 1KG. As expected, <inline-formula><inline-graphic xlink:href="545475v3_inline50.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for each cohort <bold>(<xref rid="fig3" ref-type="fig">Figure 3B</xref>)</bold>. As observed in these 1KG cohorts, all these three LD measures were associated with population structure, which was surrogated by <inline-formula><inline-graphic xlink:href="545475v3_inline51.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and their squared correlation <italic>R</italic><sup>2</sup> were greater than 0.8. ACB, ASW, PEL, and MXL, which all showed certain admixture, tended to have much greater <inline-formula><inline-graphic xlink:href="545475v3_inline52.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="545475v3_inline53.gif" mimetype="image" mime-subtype="gif"/></inline-formula> <bold>(<xref rid="tbl3" ref-type="table">Table 3</xref> and <xref rid="fig3" ref-type="fig">Figure 3B</xref>)</bold>. In contrast, East Asian (EA) and European (EUR) orientated cohorts, which showed little within cohort genetic differentiation ‚Äì as their largest eigenvalues were slightly greater than 1, had their aggregated LD relatively low and resembled each other <bold>(<xref rid="tbl3" ref-type="table">Table 3</xref>)</bold>. Furthermore, for several European (TSI, IBS, and FIN) and East Asian (JPT) cohorts, the ratio between <inline-formula><inline-graphic xlink:href="545475v3_inline54.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545475v3_inline55.gif" mimetype="image" mime-subtype="gif"/></inline-formula> components could be smaller than 0.1, and the smallest ratio was found to be about 0.091 in FIN. The largest ratio was found in 1KG that <inline-formula><inline-graphic xlink:href="545475v3_inline56.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545475v3_inline57.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and the ratio was 0.877 because of the inflated LD due to population structure. A more concise statistic to describe the ratio between <italic>‚Ñì</italic><sub><italic>i,j</italic></sub>and <italic>‚Ñì;</italic><sub><italic>i</italic></sub> was <inline-formula><inline-graphic xlink:href="545475v3_inline58.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, <bold><xref ref-type="disp-formula" rid="eqn8">Eq 8</xref></bold>, and the corresponding values for 231 scaled <inline-formula><inline-graphic xlink:href="545475v3_inline59.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for FIN was <inline-formula><inline-graphic xlink:href="545475v3_inline60.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (s.d. of 0.027) and for 1KG was <inline-formula><inline-graphic xlink:href="545475v3_inline61.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (s.d. of 0.028).</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3.</label>
<caption><title>X-LD estimation for complex LD components (2,997,635 SNPs)</title></caption>
<graphic xlink:href="545475v3_tbl3.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>In terms of computational time, for 103 CHB samples, it took about 101.34 seconds to estimate 22 autosomal <inline-formula><inline-graphic xlink:href="545475v3_inline62.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and 231 <inline-formula><inline-graphic xlink:href="545475v3_inline63.gif" mimetype="image" mime-subtype="gif"/></inline-formula> ; for all 1KG 2,503 samples, X-LD took about 3,008.29 seconds <bold>(<xref rid="tbl1" ref-type="table">Table 1</xref>)</bold>. Conventional methods took too long to complete the analyses in this section, so no comparable computational time was provided. For detailed 22 <inline-formula><inline-graphic xlink:href="545475v3_inline64.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and 231 <inline-formula><inline-graphic xlink:href="545475v3_inline65.gif" mimetype="image" mime-subtype="gif"/></inline-formula> estimates for each 1KG cohort, please refer to <bold>Extended Data 1 (Excel Sheet 1-27)</bold>.</p>
</sec>
<sec id="s3c">
<title>Detecting exceedingly high LD grids shaped by variable recombination rates</title>
<p>We further explored each autosome with high-resolution grid LD visualization. We set <italic>m</italic> =250, so each grid had the <italic>‚Ñì;</italic><sub><italic>uv</italic></sub> for 250 √ó 250 SNP pairs. The computational time complex was <inline-formula><inline-graphic xlink:href="545475v3_inline66.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, in which <inline-formula><inline-graphic xlink:href="545475v3_inline67.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and with our proposed method in CHB it costed 66.86 seconds for chromosome 2, which had 241,241 SNPs and was totaled 466,095 unique grids, and 3.22 seconds only for chromosome 22, which had 40,378 SNPs and was totaled 13,203 unique grids <bold>(<xref rid="tbl1" ref-type="table">Table 1</xref>)</bold>. In contrast, under conventional methods those LD grids were not very likely to be exhaustively surveyed because of its computational cost was <inline-formula><inline-graphic xlink:href="545475v3_inline68.gif" mimetype="image" mime-subtype="gif"/></inline-formula>: for CHB chromosome 2, it would have taken about 40 hours as estimated. As the result was very similar for <italic>m</italic> =500 <bold>(<xref rid="figS4" ref-type="fig">Figure S4</xref>)</bold>, we only reported the results under <italic>m</italic> =250 below.</p>
<p>As expected, chromosome 6 (206,165 SNPs, totaling 340,725 unique grids) had its HLA cluster showing much higher LD than the rest of chromosome 6. In addition, we found very dramatic variation of the HLA cluster LD <inline-formula><inline-graphic xlink:href="545475v3_inline69.gif" mimetype="image" mime-subtype="gif"/></inline-formula> HLA (28,477,797-33,448,354 bp, totaling 3,160 unique grids) across ethnicities. For CEU, CHB, YRI, and ASW, their <inline-formula><inline-graphic xlink:href="545475v3_inline70.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and 0.0019, respectively, but their corresponding HLA cluster grids had <inline-formula><inline-graphic xlink:href="545475v3_inline71.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and 0.022, respectively <bold>(<xref rid="fig4" ref-type="fig">Figure 4</xref>)</bold>.</p>
<p>Consequently, the largest ratio for <inline-formula><inline-graphic xlink:href="545475v3_inline72.gif" mimetype="image" mime-subtype="gif"/></inline-formula> was of 42.00 in CEU, 39.06 in YRI, and 32.22 in CHB, but was reduced to 11.58 in ASW. Before the release of CHM13 (<xref ref-type="bibr" rid="c15">Hoyt <italic>et al</italic>., 2022</xref>), chromosome 11 had the most completely sequenced centromere region, which had much rarer recombination events, all four cohorts showed an strong LD <inline-formula><inline-graphic xlink:href="545475v3_inline73.gif" mimetype="image" mime-subtype="gif"/></inline-formula> around the centromere (46,061,947-59,413,484 bp, totaling 1,035 unique grids) regardless of their ethnicities <bold>(<xref rid="fig4" ref-type="fig">Figure 4</xref>)</bold>. <inline-formula><inline-graphic xlink:href="545475v3_inline74.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and 0.0022, respectively, and <inline-formula><inline-graphic xlink:href="545475v3_inline75.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and 0.094, respectively; the ratio for <inline-formula><inline-graphic xlink:href="545475v3_inline76.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and 94,05, for CEU, CHB, and YRI, respectively; the lowest ratio was found in ASW of 42.73. In addition, removing the HLA region of chromosome 6 or the centromere region of chromosome 11 would significantly reduce <inline-formula><inline-graphic xlink:href="545475v3_inline77.gif" mimetype="image" mime-subtype="gif"/></inline-formula> or <inline-formula><inline-graphic xlink:href="545475v3_inline78.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in comparison with the randomly removal of other regions <bold>(<xref rid="figS5" ref-type="fig">Figure S5</xref>)</bold>.</p>
</sec>
<sec id="s3d">
<title>Model-based LD decay regression revealed LD composition</title>
<p>The real LD block size was not exact of <italic>m</italic> =250 or <italic>m</italic> =500, but an unknown parameter that should be inferred in computational intensive ‚ÄúLD decay‚Äù analysis (<xref ref-type="bibr" rid="c32">Zhang <italic>et al</italic>., 2019</xref>; <xref ref-type="bibr" rid="c7">Chang <italic>et al</italic>., 2015</xref>). We conducted the conventional LD decay for the 26 1KG cohorts <bold>(<xref rid="fig5" ref-type="fig">Figure 5A</xref>)</bold>, and the time cost was 1,491.94 seconds for CHB. For each cohort, we took the area under the LD decay curve in the LD decay plot, and it quantified approximately the LD decay score for each cohort. The smallest score was 0.0421 for MSL and the largest was 0.0598 for PEL (<bold><xref rid="tbl5" ref-type="table">Table 5</xref></bold>). However, this estimation was not taken into account the real extent of LD, so it was not precise enough to reflect the LD decay score. For example, for admixture population, such as American cohorts, the extent of LD would be longer.</p>
<p>In contrast, we proposed a model-based method, as given in <bold><xref ref-type="disp-formula" rid="eqn3">Eq 3</xref></bold>, which could estimate LD decay score (regression coefficient <italic>b</italic><sub>1</sub>) and long-distance LD score (intercept <italic>b</italic><sub>0</sub>) jointly. Given the estimated 22 <inline-formula><inline-graphic xlink:href="545475v3_inline79.gif" mimetype="image" mime-subtype="gif"/></inline-formula> <bold>(Extended data 1; <xref rid="tbl4" ref-type="table">Table 4</xref> for four representative cohorts and Supplementary R code)</bold>, we regressed each autosomal <inline-formula><inline-graphic xlink:href="545475v3_inline80.gif" mimetype="image" mime-subtype="gif"/></inline-formula> against its correspondingly inversion of SNP number, and all yielded positive slopes <bold>(</bold>Pearson‚Äôs correlation ‚Ñõ &gt; 0.80, <bold><xref rid="tbl5" ref-type="table">Table 5</xref>; <xref rid="fig5" ref-type="fig">Figure 5B</xref>)</bold>, an observation that was consistent with genome-wide spread of recombination hotspots. This linear relationship could consequently be considered the norm for a relative homogenous population as observed in most 1KG cohorts <bold>(<xref rid="figS6" ref-type="fig">Figure S6</xref>)</bold>, while for the all 2,503 1KG samples ‚Ñõ =0.55 only <bold>(<xref rid="tbl5" ref-type="table">Table 5</xref>)</bold>, indicating that the population structure and possible differentiated recombination hotspots across ethnicities disturbed the assumption underlying <bold><xref ref-type="disp-formula" rid="eqn3">Eq 3</xref></bold> and smeared the linearity. We extracted <inline-formula><inline-graphic xlink:href="545475v3_inline81.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545475v3_inline82.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for the 26 1KG cohorts for further analysis. The rates of LD decay score, as indicated by <inline-formula><inline-graphic xlink:href="545475v3_inline83.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, within the African cohorts (AFR) were significantly faster than other continents, consistent with previous observation that African population had relative shorter LD (<xref ref-type="bibr" rid="c11">Gabriel <italic>et al</italic>., 2002</xref>); while subgroups within the American continent (AMR) tended to have extended LD range due to their admixed genetic composition <bold>(<xref rid="tbl5" ref-type="table">Table 5</xref></bold> and <bold><xref rid="fig5" ref-type="fig">Figure 5B</xref>)</bold>. Notably, the correlation between <inline-formula><inline-graphic xlink:href="545475v3_inline84.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and the approximated LD decay score was ‚Ñõ &gt; 0.88. The estimated <inline-formula><inline-graphic xlink:href="545475v3_inline85.gif" mimetype="image" mime-subtype="gif"/></inline-formula> were highly correlated with <inline-formula><inline-graphic xlink:href="545475v3_inline86.gif" mimetype="image" mime-subtype="gif"/></inline-formula>.</p>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Table 4.</label>
<caption><title>Estimates for 22 autosomal <inline-formula><inline-graphic xlink:href="545475v3_inline123.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in CEU, CHB, YRI, and ASW, respectively</title></caption>
<graphic xlink:href="545475v3_tbl4.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<table-wrap id="tbl5" orientation="portrait" position="float">
<label>Table 5.</label>
<caption><title>LD decay regression analysis for 26 cohorts</title></caption>
<graphic xlink:href="545475v3_tbl5.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>A common feature was universally relative high LD of chromosome 6 and 11 in the 26 1KG cohorts <bold>(<xref rid="figS6" ref-type="fig">Figure S6</xref>)</bold>. We quantified the impact of chromosome 6 and 11 by leave-one-chromosome-out test in CEU, CHB, YRI, and ASW for details <bold>(<xref rid="fig6" ref-type="fig">Figure 6A</xref></bold> and <bold>6B)</bold>, and found that dropping chromosome 6 off could lift ‚Ñõ on average by 0.017, and chromosome 11 by 0.046. One possible explanation was that the centromere regions of chromosomes 6 and 11 have been assembled more completely than other chromosomes before the completion of CHM13 (<xref ref-type="bibr" rid="c15">Hoyt <italic>et al</italic>., 2022</xref>), whereas meiotic recombination tended to be reduced around the centromeres (<xref ref-type="bibr" rid="c14">Hinch <italic>et al</italic>., 2019</xref>). We estimated <italic>‚Ñì;</italic><sub><italic>i</italic></sub> after having knocked out the centromere region (46,061,947-59,413,484 bp, chr 11) in CEU, CHB, YRI, and ASW, and chromosome 11 then did not deviate much from their respective fitted lines <bold>(<xref rid="fig6" ref-type="fig">Figure 6C</xref>)</bold>. A notable exceptional pattern was found in ASW, the chromosome 8 of which had even more deviation than chromosome 11 (‚Ñõ was 0.83 and 0.87 with and without chromosome 8 in leave-one-chromosome out test) <bold>(<xref rid="fig6" ref-type="fig">Figure 6B</xref>)</bold>. The deviation of chromosome 8 of ASW was consistent even more SNPs were added <bold>(<xref rid="figS7" ref-type="fig">Figure S7</xref>)</bold>. We also provided high-resolution LD grids illustration for chromosome 8 (163,436 SNPs, totaling 214,185 grids) of the four representative cohorts for more detailed virtualization <bold>(<xref rid="fig6" ref-type="fig">Figure 6D</xref>)</bold>. ASW had <inline-formula><inline-graphic xlink:href="545475v3_inline87.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, but 0.00075, 0.00069 and 0.00043 for CEU, CHB, and YRI, respectively.</p>
</sec>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>In this study, we present a computationally efficient method to estimate mean LD of genomic grids of many SNP pairs. Our LD analysis framework is based on GRM, which has been embedded in variance component analysis for complex traits and genomic selection (<xref ref-type="bibr" rid="c12">Goddard, 2009</xref>; <xref ref-type="bibr" rid="c27">Visscher <italic>et al</italic>., 2014</xref>; <xref ref-type="bibr" rid="c8">Chen, 2014</xref>). The key connection from GRM to LD is bridged via the transformation between <italic>n</italic> √ó <italic>n</italic> matrix and <italic>m</italic> √ó <italic>m</italic> matrix, in particular here via Isserlis‚Äôs theorem under the fourth-order moment (<xref ref-type="bibr" rid="c16">Isserlis, 1918</xref>). With this connection, the computational cost for estimating the mean LD of <italic>m</italic> √ó <italic>m</italic> SNP pairs is reduced from ùí™(<italic>nm</italic><sup>2</sup>) to ùí™(<italic>n</italic><sup>2</sup><italic>m</italic>), and the statistical properties of the proposed method are derived in theory and validated in 1KG datasets. In addition, as the genotype matrix <bold>X</bold> is of limited entries {0, 1, 2}, assuming missing genotypes are imputed first, using Mailman algorithm the computational cost of GRM can be further reduced to <inline-formula><inline-graphic xlink:href="545475v3_inline88.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (<xref ref-type="bibr" rid="c18">Liberty and Zucker, 2009</xref>). The largest data tested so far for the proposed method has the sample size of 10,640 and of more than 5 million SNPs, it can complete genomic LD analysis in 77,508.00 seconds <bold>(<xref rid="tbl1" ref-type="table">Table 1</xref>)</bold>. The weakness of the proposed method is obvious that the algorithm remains slow when the sample size is large or the grid resolution is increased. With the availability of such as UK Biobank data (<xref ref-type="bibr" rid="c5">Bycroft <italic>et al</italic>., 2018</xref>), the proposed method may not be adequate, and much advanced methods, such as randomizated implementation for the proposed methods, are needed.</p>
<p>We also applied the proposed method into 1KG and revealed certain characteristics of the human genomes. Firstly, we found the ubiquitously existence of extended LD, which was likely emerged because of population structure, even very slightly, and admixture history. We quantified the <inline-formula><inline-graphic xlink:href="545475v3_inline89.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545475v3_inline90.gif" mimetype="image" mime-subtype="gif"/></inline-formula> in 1KG, and as indicated by <inline-formula><inline-graphic xlink:href="545475v3_inline91.gif" mimetype="image" mime-subtype="gif"/></inline-formula> we found the inter-chromosomal LD was nearly an order lower than intra-chromosomal LD; for admixed cohorts, the ratio was much higher, even very close to each other such as in all 1KG samples. Secondly, variable recombination rates shaped peak of local LD. For example, the HLA region showed high LD in European and East Asian cohorts, but relatively low LD in such as YRI, consistent with their much longer population history. Thirdly, it existed general linear correlation between <italic>‚Ñì;</italic><sub><italic>i</italic></sub> and the inversion of the SNP number, a long-anticipated result that is as predicted with genome-wide spread of recombination hotspots (<xref ref-type="bibr" rid="c14">Hinch <italic>et al</italic>., 2019</xref>). One outlier of this linear norm was chromosome 11, which had so far most completely genotyped centromere and consequently had more elevated LD compared with other autosomes. We anticipate that with the release of CHM13 the linear correlation should be much closer to unity (<xref ref-type="bibr" rid="c15">Hoyt <italic>et al</italic>., 2022</xref>). Of note, under the variance component analysis for complex traits, it is often a positive correlation between the length of a chromosome (as surrogated by the number of SNPs) and the proportion of heritability explained (<xref ref-type="bibr" rid="c9">Chen <italic>et al</italic>., 2014</xref>).</p>
<p>In contrast, throughout the study recurrent outstanding observations were found in ASW. For example, in ASW the ratio of <inline-formula><inline-graphic xlink:href="545475v3_inline92.gif" mimetype="image" mime-subtype="gif"/></inline-formula> was substantially dropped down compared with that of CEU, CHB, or YRI as illustrated in <bold><xref rid="fig4" ref-type="fig">Figure 4</xref></bold>. Furthermore, chromosome 8 in ASW fluctuated upwards most from the linear correlation (<bold><xref rid="fig6" ref-type="fig">Figure 6</xref></bold>), and even after various analyses, such as expanding SNP numbers. One possible explanation may lay under the complex demographic history of ASW, which can be investigated and tested in additional African American samples or possible existence for epistatic fitness (<xref ref-type="bibr" rid="c23">Ni <italic>et al</italic>., 2020</xref>).</p>
</sec>
<sec id="d1e2179" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e2299">
<label>ExtendData1</label>
<media xlink:href="supplements/545475_file02.xlsx"/>
</supplementary-material>
<supplementary-material id="d1e2306">
<label>R code for Figure 6C</label>
<media xlink:href="supplements/545475_file03.zip"/>
</supplementary-material>
</sec>
</body>
<back>
<sec id="s5">
<title>Data availability</title>
<p>Public genetic datasets used in this study can be freely downloaded from the following URLs.</p>
<p><bold>1000 Genomes Project:</bold> <ext-link ext-link-type="uri" xlink:href="https://wwwdev.ebi.ac.uk/eva/?eva-study=PRJEB30460">https://wwwdev.ebi.ac.uk/eva/?eva-study=PRJEB30460</ext-link></p>
<p><bold>CONVERGE:</bold> <ext-link ext-link-type="uri" xlink:href="https://wwwdev.ebi.ac.uk/eva/?eva-study=PRJNA289433">https://wwwdev.ebi.ac.uk/eva/?eva-study=PRJNA289433</ext-link></p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>GBC conceived and initiated the study. XH, TNZ, and YL conducted simulation and analyzed data. GBC, XH, TNZ, GAQ, and JZ developed the software. GBC wrote the first draft of the paper. All authors contributed to the writing, discussion of the paper, and validation of the results. This work was supported by National Natural Science Foundation of China (31771392), 110202101032(JY-09), and GZY-ZJ-KJ-23001. The funders played no role in designing, preparation, and submission of the paper.</p>
</ack>
<sec id="s6">
<title>Conflict of Interests</title>
<p>None.</p>
</sec>
<ref-list>
<title>Reference</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Ardlie</surname> <given-names>KG</given-names></string-name>, <string-name><surname>Kruglyak</surname> <given-names>L</given-names></string-name>, <string-name><surname>Seielstad</surname> <given-names>M.</given-names></string-name> <article-title>Patterns of linkage disequilibrium in the human genome</article-title>. <source>Nat Rev Genet</source> <year>2002</year>;<volume>3</volume>:<fpage>299</fpage>‚Äì<lpage>309</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Auton</surname> <given-names>A</given-names></string-name>, <string-name><surname>Brooks</surname> <given-names>LD</given-names></string-name>, <string-name><surname>Durbin</surname> <given-names>RM</given-names></string-name> <etal>et al.</etal> <article-title>A global reference for human genetic variation</article-title>. <source>Nature</source> <year>2015</year>;<volume>526</volume>:<fpage>68</fpage>‚Äì<lpage>74</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Barrett</surname> <given-names>JC</given-names></string-name>, <string-name><surname>Fry</surname> <given-names>B</given-names></string-name>, <string-name><surname>Maller</surname> <given-names>J</given-names></string-name> <etal>et al.</etal> <article-title>Haploview: Analysis and visualization of LD and haplotype maps</article-title>. <source>Bioinformatics</source> <year>2005</year>;<volume>21</volume>:<fpage>263</fpage>‚Äì<lpage>5</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Bulik-Sullivan</surname> <given-names>BK</given-names></string-name>, <string-name><surname>Loh</surname> <given-names>P-R</given-names></string-name>, <string-name><surname>Finucane</surname> <given-names>HK</given-names></string-name> <etal>et al.</etal> <article-title>LD Score regression distinguishes confounding from polygenicity in genome-wide association studies</article-title>. <source>Nat Genet</source> <year>2015</year>;<volume>47</volume>:<fpage>291</fpage>‚Äì<lpage>5</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Bycroft</surname> <given-names>C</given-names></string-name>, <string-name><surname>Freeman</surname> <given-names>C</given-names></string-name>, <string-name><surname>Petkova</surname> <given-names>D</given-names></string-name> <etal>et al.</etal> <article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>. <source>Nature</source> <year>2018</year>;<volume>562</volume>:<fpage>203</fpage>‚Äì<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Cai</surname> <given-names>N</given-names></string-name>, <string-name><surname>Bigdeli</surname> <given-names>T</given-names></string-name>, <string-name><surname>Kretzschmar</surname> <given-names>W</given-names></string-name> <etal>et al.</etal> <article-title>Sparse whole-genome sequencing identifies two loci for major depressive disorder</article-title>. <source>Nature</source> <year>2015</year>;<volume>523</volume>:<fpage>588</fpage>‚Äì<lpage>91</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Chang</surname> <given-names>CC</given-names></string-name>, <string-name><surname>Chow</surname> <given-names>CC</given-names></string-name>, <string-name><surname>Tellier</surname> <given-names>LC</given-names></string-name> <etal>et al.</etal> <article-title>Second-generation PLINK: rising to the challenge of larger and richer datasets</article-title>. <source>Gigascience</source> <year>2015</year>;<volume>4</volume>:<fpage>7</fpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Chen</surname> <given-names>GB</given-names></string-name>. <article-title>Estimating heritability of complex traits from genome-wide association studies using IBS-based Haseman‚ÄìElston regression</article-title>. <source>Front Genet</source> <year>2014</year>;<volume>5</volume>:<fpage>107</fpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Chen</surname> <given-names>GB</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>SH</given-names></string-name>, <string-name><surname>Brion</surname> <given-names>MJA</given-names></string-name> <etal>et al.</etal> <article-title>Estimation and partitioning of (co)heritability of inflammatory bowel disease from GWAS and immunochip data</article-title>. <source>Hum Mol Genet</source> <year>2014</year>;<volume>23</volume>:<fpage>4710</fpage>‚Äì<lpage>20</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Das</surname> <given-names>S</given-names></string-name>, <string-name><surname>Forer</surname> <given-names>L</given-names></string-name>, <string-name><surname>Sch√∂nherr</surname> <given-names>S</given-names></string-name> <etal>et al.</etal> <article-title>Next-generation genotype imputation service and methods</article-title>. <source>Nat Genet</source> <year>2016</year>;<volume>48</volume>:<fpage>1284</fpage>‚Äì<lpage>7</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Gabriel</surname> <given-names>SB</given-names></string-name>, <string-name><surname>Schaffner</surname> <given-names>SF</given-names></string-name>, <string-name><surname>Nguyen</surname> <given-names>H</given-names></string-name> <etal>et al.</etal> <article-title>The structure of haplotype blocks in the human genome</article-title>. <source>Science</source> <year>2002</year>;<volume>296</volume>:<fpage>2225</fpage>‚Äì<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Goddard</surname> <given-names>M.</given-names></string-name> <article-title>Genomic selection: prediction of accuracy and maximisation of long term response</article-title>. <source>Genetica</source> <year>2009</year>;<volume>136</volume>:<fpage>245</fpage>‚Äì<lpage>57</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Hill</surname> <given-names>WG</given-names></string-name>, <string-name><surname>Robertson</surname> <given-names>A.</given-names></string-name> <article-title>The effect of linkage on limits to artificial selection</article-title>. <source>Genet Res</source> <year>1966</year>;<volume>8</volume>:<fpage>269</fpage>‚Äì<lpage>94</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Hinch</surname> <given-names>AG</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>G</given-names></string-name>, <string-name><surname>Becker</surname> <given-names>PW</given-names></string-name> <etal>et al.</etal> <article-title>Factors influencing meiotic recombination revealed by whole-genome sequencing of single sperm</article-title>. <source>Science</source> <year>2019</year>;<volume>363</volume>:<fpage>eaau8861</fpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Hoyt</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Storer</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Hartley</surname> <given-names>GA</given-names></string-name> <etal>et al.</etal> <article-title>From telomere to telomere: The transcriptional and epigenetic state of human repeat elements</article-title>. <source>Science</source> <year>2022</year>;<volume>376</volume>:<fpage>eabk3112</fpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Isserlis</surname> <given-names>L.</given-names></string-name> <article-title>On a formula for the product-moment coefficient of any order of a normal frequency distribution in any number of variables</article-title>. <source>Biometrika</source> <year>1918</year>;<volume>12</volume>:<fpage>134</fpage>‚Äì<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Li</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>SY</given-names></string-name>, <string-name><surname>Rapakoulia</surname> <given-names>T</given-names></string-name> <etal>et al.</etal> <article-title>Deep learning identifies and quantifies recombination hotspot determinants</article-title>. <source>Bioinformatics</source> <year>2022</year>;<volume>38</volume>:<fpage>2683</fpage>‚Äì<lpage>91</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Liberty</surname> <given-names>E</given-names></string-name>, <string-name><surname>Zucker</surname> <given-names>SW</given-names></string-name>. <article-title>The Mailman algorithm: A note on matrix-vector multiplication</article-title>. <source>Inf Process Lett</source> <year>2009</year>;<volume>109</volume>:<fpage>179</fpage>‚Äì<lpage>82</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Lowy-Gallego</surname> <given-names>E</given-names></string-name>, <string-name><surname>Fairley</surname> <given-names>S</given-names></string-name>, <string-name><surname>Zheng-Bradley</surname> <given-names>X</given-names></string-name> <etal>et al.</etal> <article-title>Variant calling on the GRCh38 assembly with the data from phase three of the 1000 Genomes Project</article-title>. <source>Wellcome Open Res</source> <year>2019</year>;<volume>4</volume>:<fpage>50</fpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="book"><string-name><surname>Lynch</surname> <given-names>M</given-names></string-name>, <string-name><surname>Walsh</surname> <given-names>B.</given-names></string-name> <source>Genetics and analysis of quantitative traits</source>. <publisher-loc>Sunderland, MA</publisher-loc>: <publisher-name>Sinauer</publisher-name>, <year>1998</year>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Myers</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bottolo</surname> <given-names>L</given-names></string-name>, <string-name><surname>Freeman</surname> <given-names>C</given-names></string-name> <etal>et al.</etal> <article-title>A fine-scale map of recombination rates and hotspots across the human genome</article-title>. <source>Science</source> <year>2005</year>;<volume>310</volume>:<fpage>321</fpage>‚Äì<lpage>4</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Nei</surname> <given-names>M</given-names></string-name>, <string-name><surname>Li</surname> <given-names>W-H.</given-names></string-name> <article-title>Linkage disequilibrium in subdivided populations</article-title>. <source>Genetics</source> <year>1973</year>;<volume>75</volume>:<fpage>213</fpage>‚Äì<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Ni</surname> <given-names>XM</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>HM</given-names></string-name> <etal>et al.</etal> <article-title>Detecting fitness epistasis in recently admixed populations with genome-wide data</article-title>. <source>BMC Genomics</source> <year>2020</year>;<volume>21</volume>:<fpage>476</fpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Patterson</surname> <given-names>N</given-names></string-name>, <string-name><surname>Price</surname> <given-names>AL</given-names></string-name>, <string-name><surname>Reich</surname> <given-names>D.</given-names></string-name> <article-title>Population structure and eigenanalysis</article-title>. <source>PLoS Genet</source> <year>2006</year>;<volume>2</volume>:<fpage>e190</fpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Theodoris</surname> <given-names>C</given-names></string-name>, <string-name><surname>Low</surname> <given-names>MT</given-names></string-name>, <string-name><surname>Pavlidis</surname> <given-names>P</given-names></string-name> <etal>et al.</etal> <article-title>quickLD: An efficient software for linkage disequilibrium analyses</article-title>. <source>Mol Ecol Resour</source> <year>2021</year>;<volume>21</volume>:<fpage>2580</fpage>‚Äì<lpage>7</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Vilhj√°lmsson</surname> <given-names>BJ</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Finucane</surname> <given-names>HK</given-names></string-name> <etal>et al.</etal> <article-title>Modeling linkage disequilibrium increases accuracy of polygenic risk scores</article-title>. <source>Am J Hum Genet</source> <year>2015</year>;<volume>97</volume>:<fpage>576</fpage>‚Äì<lpage>92</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Visscher</surname> <given-names>PM</given-names></string-name>, <string-name><surname>Hemani</surname> <given-names>G</given-names></string-name>, <string-name><surname>Vinkhuyzen</surname> <given-names>AAE</given-names></string-name> <etal>et al.</etal> <article-title>Statistical power to detect genetic (co) variance of complex traits using SNP data in unrelated samples</article-title>. <source>PLoS Genet</source> <year>2014</year>;<volume>10</volume>:<fpage>e1004269</fpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Weir</surname> <given-names>BS</given-names></string-name>. <article-title>Linkage disequilibrium and association mapping</article-title>. <source>Annu Rev Genomics Hum Genet</source> <year>2008</year>;<volume>9</volume>:<fpage>129</fpage>‚Äì<lpage>42</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Wu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Sankararaman</surname> <given-names>S.</given-names></string-name> <article-title>A scalable estimator of SNP heritability for biobank-scale data</article-title>. <source>Bioinformatics</source> <year>2018</year>;<volume>34</volume>:<fpage>187</fpage>‚Äì<lpage>94</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Yang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Weedon</surname> <given-names>MN</given-names></string-name>, <string-name><surname>Purcell</surname> <given-names>S</given-names></string-name> <etal>et al.</etal> <article-title>Genomic inflation factors under polygenic inheritance</article-title>. <source>Eur J Hum Genet</source> <year>2011</year>;<volume>19</volume>:<fpage>807</fpage>‚Äì<lpage>12</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Yang</surname> <given-names>S</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>X.</given-names></string-name> <article-title>Accurate and scalable construction of polygenic scores in large Biobank data sets</article-title>. <source>Am J Hum Genet</source> <year>2020</year>;<volume>106</volume>:<fpage>679</fpage>‚Äì<lpage>93</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Zhang</surname> <given-names>C</given-names></string-name>, <string-name><surname>Dong</surname> <given-names>SS</given-names></string-name>, <string-name><surname>Xu</surname> <given-names>JY</given-names></string-name> <etal>et al.</etal> <article-title>PopLDdecay: A fast and effective tool for linkage disequilibrium decay analysis based on variant call format files</article-title>. <source>Bioinformatics</source> <year>2019</year>;<volume>35</volume>:<fpage>1786</fpage>‚Äì<lpage>8</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Zhou</surname> <given-names>X.</given-names></string-name> <article-title>A unified framework for variance component estimation with summary statistics in genome-wide association studies</article-title>. <source>Ann Appl Stat</source> <year>2017</year>;<volume>11</volume>:<fpage>2027</fpage>‚Äì<lpage>51</lpage>.</mixed-citation></ref>
</ref-list>
<sec>
<fig id="figS1" position="float" fig-type="figure">
<label>Figure S1.</label>
<caption><title>Reconciliation for LD estimators in AFR, EAS, and EUR.</title>
<p>In each figure, the 22 <inline-formula><inline-graphic xlink:href="545475v3_inline118.gif" mimetype="image" mime-subtype="gif"/></inline-formula> fit line is in purple, whereas the 231 <inline-formula><inline-graphic xlink:href="545475v3_inline119.gif" mimetype="image" mime-subtype="gif"/></inline-formula> fit line is in green. The gray solid line, <inline-formula><inline-graphic xlink:href="545475v3_inline120.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, in which <italic>n</italic> the sample size, represents the expected fit between PLINK and X-LD, and the two estimated regression models at the top-right corner shown this consistency.</p></caption>
<graphic xlink:href="545475v3_figS1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Figure S2.</label>
<caption><title>The computational efficiency of X-LD algorithm.</title>
<p>Considering the high computational cost of PLINK, only the first chromosome was chosen. In the process of evaluating computational efficiency, we kept adding SNPs until the inclusion of entire chromosome. The bar chart and line chart show the actual calculation time and theoretical calculation complexity, respectively.</p></caption>
<graphic xlink:href="545475v3_figS2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Figure S3.</label>
<caption><title>Chromosomal scale LD components for 26 cohorts in 1KG.</title>
<p>The upper and lower parts of each figure represent the LD before and after scaling according to <bold><xref ref-type="disp-formula" rid="eqn8">Eq 8</xref></bold>. <inline-formula><inline-graphic xlink:href="545475v3_inline121.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545475v3_inline122.gif" mimetype="image" mime-subtype="gif"/></inline-formula> are represented by the diagonal and the off-diagonal elements, respectively. For visualization purposes, LD before scaling is transformed to a -log10-scale, with smaller values (red hues) representing larger LD, and a value of 0 representing that all SNPs are in LD.</p></caption>
<graphic xlink:href="545475v3_figS3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Figure S4.</label>
<caption><title>High-resolution illustration for LD grids for CEU, CHB, YRI, and ASW (m = 500).</title>
<p>For each cohort, we partitioned each chromosome into consecutive LD grids (each LD grid containing 500 SNPs). For visualization purposes, LD is transformed to a -log10-scale, with smaller values (red hues) representing larger LD, and a value of 0 representing that all SNPs are in LD.</p></caption>
<graphic xlink:href="545475v3_figS4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Figure S5.</label>
<caption><title>Influence of HLA region on chromosome 6 and centromere region on chromosome 11 on chromosomal LD in CEU, CHB, YRI, and ASW.</title>
<p>When other region was removed, to avoid chance, the same number of consecutive SNPs as HLA region or centromere region were randomly removed from the genomic region, and this operation was repeated 100 times.</p></caption>
<graphic xlink:href="545475v3_figS5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Figure S6.</label>
<caption><title>The correlation between the inverse of the SNP number and chromosomal LD in 26 cohorts of 1KG.</title></caption>
<graphic xlink:href="545475v3_figS6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS7" position="float" fig-type="figure">
<label>Figure S7.</label>
<caption><title>Influence of expanding of SNP numbers on the correlation between the inverse of the SNP number and chromosomal LD in ASW.</title>
<p>Randomly selected SNPs that were presented in ASW but were not 2,997,635 consensus SNPs were added to the ASW cohort to demonstrate the stable pattern of chromosome 8.</p></caption>
<graphic xlink:href="545475v3_figS7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90636.2.sa1</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Young</surname>
<given-names>Alexander</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of California, Los Angeles</institution>
</institution-wrap>
<city>Los Angeles</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Useful</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study presents a <bold>useful</bold> new approach for efficient computation of statistics on correlations between genetic variants (linkage disequilibrium, or LD), which the authors apply to quantify the extent of LD across chromosomes. The method and its derivation are <bold>solid</bold>. The authors document that cross-chromosome LD can be substantial, which has implications for geneticists who are interested in population structure and its impact on genetic association studies.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90636.2.sa0</article-id>
<title-group>
<article-title>Joint Public Review:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this paper, the authors point out that the standard approach of estimating LD is inefficient for datasets with large numbers of SNPs, with a computational cost of O(nm^2), where n is the number of individuals and m is the number of SNPs. Using the known relationship between the LD matrix and the genomic-relatedness matrix, they can calculate the mean level of LD within the genome or across genomic segments with a computational cost of O(n^2m). Since in most datasets, n&lt;</p>
<p>
Strengths:</p>
<p>Generally, for computational papers like this, the proof is in the pudding, and the authors have been successful at their aim of producing an efficient computational tool. The most compelling evidence of this in the paper are Figure 2 and Supplementary Figure S2. In Figure 2, they report how well their X-LD estimates of LD compare to estimates based on the standard approach using PLINK. They appear to have very good agreement. In Figure S2, they report the computational runtime of X-LD vs PLINK, and as expected X-LD is faster than PLINK as long as it is evaluating LD for more than 8000 SNPs.</p>
<p>Weakness:</p>
<p>This method seems to be limited to calculating average levels of LD in broad regions of the genome. While it would be possible to make the regions more fine-grained, doing so appears to make this approach much less efficient. As such, applications of this method may be limited to those proposed in the paper, for questions where average LD of large chromosomal segments is informative.</p>
<p>Impact:</p>
<p>This approach seems to produce real gains for settings where broad average levels of LD are useful to know, but it will likely have less of an impact in settings where fine-grained levels are LD are necessary (e.g., accounting for LD in GWAS summary statistics).</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90636.2.sa2</article-id>
<title-group>
<article-title>Author Response</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Huang</surname>
<given-names>Xin</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhu</surname>
<given-names>Tian-Neng</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Liu</surname>
<given-names>Ying-Chao</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Qi</surname>
<given-names>Guo-An</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2412-3932</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Zhang</surname>
<given-names>Jian-Nan</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Chen</surname>
<given-names>Guo-Bo</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5475-8237</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors‚Äô response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Public Review)</bold></p>
<p>Summary:</p>
<p>Huang and colleagues present a method for approximation of linkage disequilibrium (LD) matrices. The problem of computing LD matrices is the problem of computing a correlation matrix. In the cases considered by the authors, the number of rows (n), corresponding to individuals, is small compared to the number of columns (m), corresponding to the number of variants. Computing the correlation matrix has cubic time complexity <inline-graphic xlink:href="elife-90636-inf1.jpg" mimetype="image" mime-subtype="jpeg"/>, which is prohibitive for large samples. The authors approach this using three main strategies:</p>
<p>1. they compute a coarsened approximation of the LD matrix by dividing the genome into variant-wise blocks which statistics are effectively averaged over;</p>
<p>1. they use a trick to get the coarsened LD matrix from a coarsened genomic relatedness matrix (GRM), which, with <inline-graphic xlink:href="elife-90636-inf2.jpg" mimetype="image" mime-subtype="jpeg"/> time complexity, is faster when n &lt;&lt; m;</p>
<p>1. they use the Mailman algorithm to improve the speed of basic linear algebra operations by a factor of log(max(m,n)). The authors apply this approach to several datasets.</p>
<p>Strengths:</p>
<p>The authors demonstrate that their proposed method performs in line with theoretical explanations.</p>
<p>The coarsened LD matrix is useful for describing global patterns of LD, which do not necessarily require variant-level resolution.</p>
<p>They provide an open-source implementation of their software.</p>
<p>Weaknesses:</p>
<p>The coarsened LD matrix is of limited utility outside of analyzing macroscale LD characteristics.
The method still essentially has cubic complexity--albeit the factors are smaller and Mailman reduces this appreciably. It would be interesting if the authors were able to apply randomized or iterative approaches to achieve more fundamental gains. The algorithm remains slow when n is large and/or the grid resolution is increased.</p>
</disp-quote>
<p>Thanks for your positive and accurate evaluation! We acknowledge the weakness and include some sentences in Discussion.</p>
<p>‚ÄúThe weakness of the proposed method is obvious that the algorithm remains slow when the sample size is large or the grid resolution is increased. With the availability of such as UK Biobank data (Bycroft et al., 2018), the proposed method may not be adequate, and much advanced methods, such as randomized implementation for the proposed methods, are needed.‚Äù</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review)</bold></p>
<p>Summary:</p>
<p>In this paper, the authors point out that the standard approach of estimating LD is inefficient for datasets with large numbers of SNPs, with a computational cost of <inline-graphic xlink:href="elife-90636-inf1.jpg" mimetype="image" mime-subtype="jpeg"/>, where n is the number of individuals and m is the number of SNPs. Using the known relationship between the LD matrix and the genomic- relatedness matrix, they can calculate the mean level of LD within the genome or across genomic segments with a computational cost of <inline-graphic xlink:href="elife-90636-inf2.jpg" mimetype="image" mime-subtype="jpeg"/>. Since in most datasets, n&lt;&lt;m, this can lead to major computational improvements. They have produced software written in C++ to implement this algorithm, which they call X-LD. Using the output of their method, they estimate the LD decay and the mean extended LD for various subpopulations from the 1000 Genomes Project data.</p>
<p>Strengths:</p>
<p>Generally, for computational papers like this, the proof is in the pudding, and the authors appear to have been successful at their aim of producing an efficient computational tool. The most compelling evidence of this in the paper is Figure 2 and Supplementary Figure S2. In Figure 2, they report how well their X- LD estimates of LD compare to estimates based on the standard approach using PLINK. They appear to have very good agreement. In Figure S2, they report the computational runtime of X-LD vs PLINK, and as expected X-LD is faster than PLINK as long as it is evaluating LD for more than 8000 SNPs.</p>
<p>Weakness:</p>
<p>While the X-LD software appears to work well, I had a hard time following the manuscript enough to make a very good assessment of the work. This is partly because many parameters used are not defined clearly or at all in some cases. My best effort to intuit what the parameters meant often led me to find what appeared to be errors in their derivation. As a result, I am left worrying if the performance of X-LD is due to errors cancelling out in the particular setting they consider, making it potentially prone to errors when taken to different contexts.</p>
</disp-quote>
<p>Thanks for you critical reading and evaluation. We do feel apologize for typos, which have been corrected and clearly defined now (see Eq 1 and Table 1). In addition, we include more detailed mathematical steps, which explain how LD decay regression is constructed and consequently finds its interpretation (see the detailed derivation steps between Eq 3 and Eq 4).</p>
<disp-quote content-type="editor-comment">
<p>Impact:</p>
<p>I feel like there is value in the work that has been done here if there were more clarity in the writing. Currently, LD calculations are a costly step in tools like LD score regression and Bayesian prediction algorithms, so a more efficient way to conduct these calculations would be useful broadly. However, given the difficulty I had following the manuscript, I was not able to assess when the authors‚Äô approach would be appropriate for an extension such as that.</p>
</disp-quote>
<p>See our replies below in responding to your more detailed questions.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Recommendations For The Authors)</bold></p>
<p>There are numerous linguistic errors throughout, making it challenging to read.</p>
<p>It is unclear how the intercepts were chosen in Figure S2. Since theory only gives you the slopes, it seems like it would make more sense to choose the intercept such that it aligns with the empirical results in some way.</p>
</disp-quote>
<p>Thanks for your critical evaluation. We do feel apologize some typos, and we have read it through and clarify the text as much as possible. In addition, we included Table 1, which introduces mathematical symbols of the paper.</p>
<p>In Figure S2, the two algorithms being compared have different software implementations, PLINK vs X-LD. Their real performance not only depended on the time complexity of the algorithms (right-side y-axis), but also how the software was coded. PLINK is known for its excellent programming. If we could have programmed as well as Chris Chang, the performance of X-LD should have been even better and approach the ratio m/n. However, even under less skilled programming, X-LD outperformed plink.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p>
<p>Thank you for the chance to review your manuscript. It looks like compelling work that could be improved by greater detail. Providing the level of detail necessary may require creating a Supplementary Note that does a lot of hand-holding for readers like me who are mathematically literate but who don‚Äôt have the background that you do. Then you can refer readers to the Supplement if they can‚Äôt follow your work.</p>
</disp-quote>
<p>We fix the problems and style issues as possible as we can.</p>
<disp-quote content-type="editor-comment">
<p>Regarding the weakness section in the public review, here are a few examples of where I got confused, though this list is not exhaustive.</p>
<p>1. Consider Equation 1 (line 100), which I believe must be incorrect. Imagine that g consists of two SNPs on different chromosomes with correlation rho. Then ell_g (which is defined as the average squared elements of the correlation matrix) would be</p>
</disp-quote>
<p>ell_g = 1/4 (1 + 1 + rho^2 + rho^2) = (1+rho^2)/2.</p>
<disp-quote content-type="editor-comment">
<p>But ell_1=1 and ell_2=1 and ell_12=rho^2 (The average squared elements of the chromosome-specific correlation matrices and the cross-chromosome correlation matrix, respectively). So</p>
</disp-quote>
<p>sum(ell_i)+sum(ell_ij) = 1 + 1 + rho^2 + rho^2 = (1+rho^2)*2.</p>
<disp-quote content-type="editor-comment">
<p>I believe your formulas would hold if you defined your LD values as the sum of squared correlations instead of the mean, but then I don‚Äôt know if the math in the subsequent sections holds. I think this problem also holds for Eq 2 and therefore makes Eqs 3 and 4 difficult to interpret.</p>
</disp-quote>
<p>Thanks for your attentive review and invaluable suggestions. We acknowledge the typo in calculating the mean in Eq 1, resulting in difficulties in understanding the equations. We sincerely apologize for this oversight. To address this issue and ensure clarity in the interpretation of Eq 3 and Eq 4, we have provided more detailed explanations (see the derivation between Eq 3 and Eq 4).</p>
<disp-quote content-type="editor-comment">
<p>1. I didn‚Äôt know what the parameters are in Equation 3. The vector ell needs to be defined. Is it the vector of ell_i for each chromosomal segment i? I‚Äôm also confused by the definition of m_i, which is defined on line 113 as the ‚ÄúSNP number of the i-th chromosome.‚Äù Do the authors mean the number of SNPs on the i-th chromosomal segment? If so, it wasn‚Äôt clear to me how Eq 2 and Eq 3 imply Eq 4. Further, it wasn‚Äôt clear to me why E(b1) quantifies the average LD decay of the genome. I‚Äôm used to seeing plots of average LD as a function of distance between SNPs to calculate this, though I‚Äôm admittedly not a population geneticist, so maybe this is standard. Standard or not, readers deserve to have their hands held a bit more through this either in the text or in a Supplementary Note.</p>
</disp-quote>
<p>Thanks for your insightful feedback. When we were writing this paper, our actually focus was Eq 3 and to establish the relationship between chromosomal LD and the reciprocal of the length of chromosome (Fig 6A) ‚Äì which was surrogated by the number of SNPs, the correlation between ell_i and 1/m_i.</p>
<p>We asked around our friends who are population geneticists, who anticipated the correlation between chromosomal LD (ell) and 1/m. The rationale simple if one knows the very basis of population genetics. A long chromosome experiences more recombination, which weakens LD for a pair of loci. In particular, for a pair of loci D_t=D_0 (1-c)^t. D_t the LD at the t generation, D_0 at the 0 generation, and c the recombination fraction. As recombination hotspots are nearly even distributed along the genome, such as reported by Science 2019;363:eaau8861, the chromosome will be broken into the shape in Author response image 1 (Fig 1C, newly added). Along the diagonal you see tight LD block, which will be vanished in the further as predicted by D_t equation, and any loci far away from each other will not be in LD otherwise raised by such as population structure. Ideally, we assume the diagonal block of aveage size of m√óm and average LD of a SNP with other SNPs inside the diagonal block (red) is l_u; and, in contrast, off-diagonal average LD (light red) to be l_uv. This logic is hidden but employed in such as ld score regression and prs refinement using LD structure.</p>
<fig id="sa2fig1">
<label>Author response image 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-90636-sa2-fig1.jpg" mimetype="image"/>
</fig>
<p>But, how to estimate chromosomal LD (ell), which is overwhelming <inline-formula id="sa2equ1"><inline-graphic xlink:href="elife-90636-sa2-equ1.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> as our friends said!
So, the Figure 6A is logically anticipated by a seasoned population geneticist, but has never been realized because of <inline-formula id="sa2equ2"><inline-graphic xlink:href="elife-90636-sa2-equ2.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> is nightmare. Often, those signature patterns should have been employed as showcases in releasing new reference data, such as HapMap. However, to our knowledge, this signature linear relationship has never been illustrated in those reference data.</p>
<p>If you further test a population geneticist, if any chromosome will deviate from this line (Fig 6A)? The answer most likely will be chromosome 6 because of the LD tight HLA region. However, it is chromosome 11 because of its most completed sequenced centromere. Chr 11 is a surprise! With T2T sequenced population, Chr 11 will not deviate much. We predict!</p>
<p>However, we suspect whether people appreciate this point, we shift our focus to efficient computation of LD‚Äîwhich is more likely understood. We acknowledge the lack of clarity in notation definitions and the absence of the derivation for the interpretation of b1 and b0 for LD decay regression. So, we have added a table to provide an explanation of the notation (see the Table 1) and provided additional derivations, which explained how LD decay regression was derived (see the derivation between Eq 3 and Eq 4). Figure 1C provides illustration for the underlying assumption under LD.</p>
<p>The technique to bridge Eq 2~3 to Eq 4 is called ‚Äúbuilding interpretation‚Äù. It once was one of the kernel tasks for population genetics or statistical genetics, and a classical example is Haseman-Elston regression (Behavior Genetics, 1972, 2:3-19). When it is moving towards a data-driven style, the culture becomes ‚Äúshut up, calculate‚Äù. Finding interpretation for a regression is a vanishing craftmanship, and people often end up with unclear results!</p>
<disp-quote content-type="editor-comment">
<p>1. In line 135, it‚Äôs not clear to me what is meant by <inline-graphic xlink:href="elife-90636-inf4.jpg" mimetype="image" mime-subtype="jpeg"/>. If it is <inline-graphic xlink:href="elife-90636-inf5.jpg" mimetype="image" mime-subtype="jpeg"/>, then wouldn‚Äôt the resulting matrix be a matrix of zeros since <inline-graphic xlink:href="elife-90636-inf6.jpg" mimetype="image" mime-subtype="jpeg"/> is zero everywhere except the lower off-diagonal? So maybe it is <inline-graphic xlink:href="elife-90636-inf7.jpg" mimetype="image" mime-subtype="jpeg"/>? But then later in that line, you say that the square of this matrix is the sum of several terms of the form <inline-graphic xlink:href="elife-90636-inf8.jpg" mimetype="image" mime-subtype="jpeg"/>. Are these the scalar elements of the G matrix? But then the sum is a scalar, which can‚Äôt be true since <inline-graphic xlink:href="elife-90636-inf9.jpg" mimetype="image" mime-subtype="jpeg"/> is a matrix.</p>
</disp-quote>
<p>Thanks for your attentive review. We indeed confused the definition of matrices and their elements, and <inline-formula id="sa2equ3"><inline-graphic xlink:href="elife-90636-sa2-equ3.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> should refer to the stacked off-diagonal elements of matrix <inline-formula id="sa2equ4"><inline-graphic xlink:href="elife-90636-sa2-equ4.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. So, <inline-formula id="sa2equ5"><inline-graphic xlink:href="elife-90636-sa2-equ5.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> is a vector for variable <inline-formula id="sa2equ6"><inline-graphic xlink:href="elife-90636-sa2-equ6.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> ‚Äì the relationship between sample i and j. We assume the reviewer use R software, then <inline-formula id="sa2equ7"><inline-graphic xlink:href="elife-90636-sa2-equ7.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> corresponds to mean <inline-formula id="sa2equ8"><inline-graphic xlink:href="elife-90636-sa2-equ8.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>.</p>
<p>See the text between Eq 5 and Eq 6.</p>
<p>‚ÄúWe extract two vectors <inline-formula id="sa2equ9"><inline-graphic xlink:href="elife-90636-sa2-equ9.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, which stacks the off-diagonal elements of <inline-formula id="sa2equ10"><inline-graphic xlink:href="elife-90636-sa2-equ10.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, and <inline-formula id="sa2equ11"><inline-graphic xlink:href="elife-90636-sa2-equ11.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, which takes the diagonal elements of <inline-formula id="sa2equ12"><inline-graphic xlink:href="elife-90636-sa2-equ12.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>.‚Äù</p>
<p>In addition, <inline-formula id="sa2equ13"><inline-graphic xlink:href="elife-90636-sa2-equ13.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, so the ground truth is that <inline-formula id="sa2equ14"><inline-graphic xlink:href="elife-90636-sa2-equ14.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, but not zero.</p>
<p>To clarify these math symbols, we replace G with K, so as to be consistent with our other works (see Table 1).</p>
<p>To derive the means and the sampling variances for <inline-formula id="sa2equ15"><inline-graphic xlink:href="elife-90636-sa2-equ15.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> and <inline-formula id="sa2equ16"><inline-graphic xlink:href="elife-90636-sa2-equ16.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, the Eq 7 can be established by some modifications on the Delta method as exampled in Appendix I of Lynch and Walsh‚Äôs book (Lynch and Walsh, 1998). We added this sentence near Eq 7 in the main text.</p>
</body>
</sub-article>
</article>