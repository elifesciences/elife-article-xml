<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">88670</article-id>
<article-id pub-id-type="doi">10.7554/eLife.88670</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.88670.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>I-Spin live: An open-source software based on blind-source separation for decoding the activity of spinal alpha motor neurons in real-time</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4680-2933</contrib-id>
<name>
<surname>Rossato</surname>
<given-names>Julien</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6432-558X</contrib-id>
<name>
<surname>Hug</surname>
<given-names>François</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-4976-7483</contrib-id>
<name>
<surname>Tucker</surname>
<given-names>Kylie</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9664-8121</contrib-id>
<name>
<surname>Lacourpaille</surname>
<given-names>Lilian</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Farina</surname>
<given-names>Dario</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2226-3528</contrib-id>
<name>
<surname>Avrillon</surname>
<given-names>Simon</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Nantes Université, Laboratory “Movement</institution>, Interactions, Performance” (UR 4334), Nantes, <country>France</country></aff>
<aff id="a2"><label>2</label><institution>Université Côte d’Azur</institution>, LAMHESS, Nice, <country>France</country></aff>
<aff id="a3"><label>3</label><institution>The University of Queensland, School of Biomedical Sciences</institution>, Brisbane, QLD, <country>Australia</country></aff>
<aff id="a4"><label>4</label><institution>Department of Bioengineering, Faculty of Engineering, Imperial College London</institution>, London, <country>United Kingdom</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Pruszynski</surname>
<given-names>J Andrew</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Western University</institution>
</institution-wrap>
<city>London</city>
<country>Canada</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Büchel</surname>
<given-names>Christian</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University Medical Center Hamburg-Eppendorf</institution>
</institution-wrap>
<city>Hamburg</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>Corresponding author Dr. Simon Avrillon Sir Michael Uren Hub Imperial College London 86 Wood Ln London W12 0BZ E-mail address: <email>s.avrillon@imperial.ac.uk</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-07-12">
<day>12</day>
<month>07</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP88670</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-04-28">
<day>28</day>
<month>04</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-04-15">
<day>15</day>
<month>04</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.04.14.536933"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Rossato et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Rossato et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-88670-v1.pdf"/>
<abstract>
<title>Abstract</title><p>Decoding the activity of individual neural cells during natural behaviours allows neuroscientists to study how the nervous system generates and controls movements. Contrary to other neural cells, the activity of spinal motor neurons can be determined non-invasively (or minimally invasively) from the decomposition of electromyographic (EMG) signals into motor unit discharge activities. For some interfacing and neuro-feedback investigations, EMG decomposition needs to be performed in real-time. Here, we introduce an open-source software that performs real-time decoding of spinal motor neurons using a blind-source separation approach for multichannel EMG signal processing. Separation vectors (motor unit filters) are identified for each motor unit from a baseline contraction and then re-applied in real-time during test contractions. In this way, the discharge activity of multiple motor units can be provided as visual feedback in real-time. We provide a complete framework with guidelines and examples of recordings to guide researchers who aim to study movement control at the motor neuron level. We tested the software on data collected using either grids of surface electrodes or intramuscular electrode arrays from five lower limb muscles (gastrocnemius lateralis and medialis, vastus lateralis and medialis, and tibialis anterior). We assessed how the muscle, or variation of contraction intensity between the baseline contraction and the test contraction impacted the accuracy of the real-time decomposition. This open-source interface provides a set of tools for neuroscientists to design experimental paradigms where participants can receive real-time feedback on the output of the spinal cord circuits.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>electromyography</kwd>
<kwd>neural drive</kwd>
<kwd>motor units</kwd>
<kwd>real-time decomposition</kwd>
</kwd-group>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>DF is inventor of a patent (Neural Interface. UK Patent application no. GB1813762.0. August 23, 2018) and of a patent application (Neural interface. UK Patent application no. GB2014671.8. September 17, 2020), which are partly related to the methods and applications of this work. All other authors have no financial or other relationships that might lead to a conflict of interest.</p></notes>
<fn-group content-type="external-links">
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://github.com/simonavrillon/I-Spin">https://github.com/simonavrillon/I-Spin</ext-link>
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Motor units transduce the neural signals that originate from supraspinal centres, spinal circuits, and sensory systems into force (<xref ref-type="bibr" rid="c1">1</xref>). Each action potential propagating along the axon of an alpha motor neuron elicits action potentials in all its innervated muscle fibres. As such, the hundreds of muscles fibres that belong to each motor unit amplify the discharge activity of spinal motor neurons. The unique spatial location of these muscle fibres facilitates the identification of separate motor unit spike trains from complex electromyographic (EMG) recordings. Decoding the discharge characteristics of a population of motor units provides direct information about the neural control of movement (<xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c3">3</xref>). Researchers classically identify a few motor units during relatively weak contractions using concentric needle or fine wire recording electrodes (<xref ref-type="bibr" rid="c4">4</xref>) and separate the overlapping spike trains with a template-matching algorithm (e.g., (<xref ref-type="bibr" rid="c5">5</xref>)). Recent developments of intramuscular (<xref ref-type="bibr" rid="c6">6</xref>–<xref ref-type="bibr" rid="c9">9</xref>) and surface (<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c10">10</xref>) EMG electrode arrays facilitate both a larger recording zone (i.e., the area from which motor unit action potentials will be recorded), and the recording of the same motor unit action potential across multiple channels. In conjunction with this hardware advance, the development of novel EMG decomposition software/programs, such as spike-sorting (<xref ref-type="bibr" rid="c11">11</xref>–<xref ref-type="bibr" rid="c14">14</xref>) and blind source separation (<xref ref-type="bibr" rid="c15">15</xref>–<xref ref-type="bibr" rid="c19">19</xref>) algorithms, enables a relatively large number of individual motor units to be decoded from each recording (<xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c10">10</xref>).</p>
<p>Blind source separation algorithms invert the generative model of EMG signals and identify motor unit spike trains from the interference EMG (<xref ref-type="bibr" rid="c15">15</xref>–<xref ref-type="bibr" rid="c19">19</xref>). In short, this class of algorithms retrieves the spike trains by optimizing a set of separation vectors, i.e., motor unit filters based on the action potentials of each motor unit recorded across an array of electrodes, which maximizes the sparseness of the spike trains (<xref ref-type="bibr" rid="c15">15</xref>–<xref ref-type="bibr" rid="c19">19</xref>). However, most of the current implementations of this approach rely on offline processing, which restricts its ability to be used for neurofeedback and human interfacing technologies.</p>
<p>Recent studies have reported real-time capabilities of motor unit identification by adapting the offline blind source separation algorithm (<xref ref-type="bibr" rid="c20">20</xref>–<xref ref-type="bibr" rid="c24">24</xref>). These studies used a two-step approach: 1) the separation vector for each motor unit is identified with offline decomposition during the training phase; and 2) the same vectors are applied in real-time to new EMG recordings. The real-time identification of motor units is only used by a few specialized research teams and there are no publicly available algorithms for this task. In addition, the accuracy and boundary capabilities of online decomposition have not been systematically tested. Such information is necessary to better design experimental paradigms demonstrating, for example, the neural constrains on human movement generation and control (<xref ref-type="bibr" rid="c21">21</xref>).</p>
<p>Here, we provide an open-source software that can be used to visualise and track motor unit discharge activities in real-time. We document the software capability boundaries on data collected during isometric contractions of varying force levels, using either grids of surface electrodes or intramuscular electrode arrays from five lower limb muscles (gastrocnemius lateralis and medialis, vastus lateralis and medialis, and tibialis anterior). The accuracy of real-time identification of motor neuron discharge activity was determined from the rate of agreement calculated between the motor neuron spike trains identified in real-time and those identified offline after manual editing. Of note, we did not assess the capabilities of the software with simulated signals because the approach we used for identifying motor neurons has previously been validated for offline analysis (<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c20">20</xref>). Data, codes, and a user manual are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/simonavrillon/I-Spin">https://github.com/simonavrillon/I-Spin</ext-link>.</p>
</sec>
<sec id="s2">
<title>Materials and methods</title>
<sec id="s2a">
<title>Overview of the approach</title>
<p>An EMG signal represents the sum of trains of action potentials from all the active motor units within the recorded muscle volume (<xref rid="fig1" ref-type="fig">Figure 1A</xref>). During stationary conditions, e.g., isometric contractions, the train of motor unit action potentials can be modelled as the convolution of series of discrete delta functions, representing the discharge times, and motor unit action potentials (<xref rid="fig1" ref-type="fig">Figure 1A</xref>). The EMG decomposition with blind source separation consists of inversing the generative model of EMG signals by estimating the series of discharge times for each active motor unit (<xref ref-type="bibr" rid="c15">15</xref>–<xref ref-type="bibr" rid="c17">17</xref>). When EMG signals are recorded with an array of electrodes, the shape of the recorded potential of each motor unit differs across electrodes. This is due to the varying conduction velocity of action potentials among the muscle fibres, and 2) the location/depth of the muscle fibres that belong to each motor unit relatively to the electrodes, which impact the low pass filtering effect of the tissue on the recorded potential. Therefore, the EMG signals recorded with an array of electrodes can be considered as an instantaneous mixture of the original motor unit spike trains and their delayed versions.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Overview of the approach.</title><p>During isometric contractions, electromyographic (EMG) signals can be considered as the sum of all action potentials that originate from the muscle fibres of all the active motor units that lie within the electrodes recording zone. Each of these spike trains are the convolution of a series of discharge times with the recorded profile of motor unit action potentials (MUAP). (A) The shape of the recorded action potentials differs across electrodes when recorded with an array of surface or intramuscular electrodes. The EMG signal and each individual MUAP profile depends on the position of the electrode, as highlighted by the different colours. (B) Decomposing EMG signals consists of solving the inverse problem, that is to estimate the discharge times of the active motor units from the EMG signals. Our software uses a fast independent component analysis (fasICA) to optimize a set of separation vectors (i.e., filters) for each motor unit. To this end, each separation vector is iteratively optimized to maximize the sparseness of the source. At the end of this step, the source is refined, and a K-mean classification is applied to separate the high peaks, which represent the targeted motor unit spikes, from the low peaks (other motor units and noise).</p></caption>
<graphic xlink:href="536933v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Increasing the number and spatial distribution of recording electrodes increases the likelihood that each motor unit will have a unique motor unit action potential profile (shape), i.e., a temporal and spatial profile that differs from all the other active motor unit within the recorded volume (<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c25">25</xref>). The uniqueness of motor unit action potential profiles is necessary for the blind source separation to accurately estimate the motor unit discharge times. Our software uses a fast independent component analysis (fastICA) to optimize the separation vector (i.e., the motor unit filter) for each motor unit (<xref rid="fig1" ref-type="fig">Figure 1B</xref>; (<xref ref-type="bibr" rid="c18">18</xref>–<xref ref-type="bibr" rid="c20">20</xref>)).</p>
</sec>
<sec id="s2b">
<title>Overview of the software</title>
<p>The software was coded as a MATLAB app (version 2021a, The MathWorks, Inc, USA). It allows researchers to record and process signals from one to four grids of surface electrodes or intramuscular arrays with up to 64 channels. Of note, the current version has been developed to interface with only one commercialised multichannel EMG system (EMG-Quattrocento, 400 channel EMG amplifier; OT Bioelettronica, Italy). However, the blind source separation algorithm in the code can be used with all systems that record EMG signals with grids of surface electrodes or intramuscular arrays of electrodes. As the accuracy of the algorithm relies on the consistency of motor unit filters, it is recommended to record these EMG signals during stationary conditions - e.g., isometric contractions – to limit changes in muscle geometry or position/orientation of the active muscle fibres relative to the electrodes (<xref ref-type="bibr" rid="c26">26</xref>, <xref ref-type="bibr" rid="c27">27</xref>). The framework to perform real-time identification of motor neuron activity has four steps. First, the EMG signal is recorded while participants perform a contraction at the requested intensity such that an <italic>electrode mask</italic> is manually generated to remove channels with artifacts or low signal-to-noise ratio. This <italic>electrode mask</italic> is then used for the rest of the experimental session. Second, the force offset is measured and removed before performing MVC. The measured MVC is used to standardize all the submaximal isometric contractions. Third, a baseline contraction is performed at a force level close to the intensity of the testing task and the separation vectors (motor unit filters) are identified using offline blind source separation of the EMG signals. Fourth, the separation vectors are applied over incoming segments of EMG signals during a test contraction to identify motor unit discharge activity in real-time. The algorithm used to identify motor units discharge activity is based on that proposed by Negro et al. (<xref ref-type="bibr" rid="c18">18</xref>) and Barsakcioglu et al. (<xref ref-type="bibr" rid="c20">20</xref>).</p>
<p>Four forms of feedback can be displayed to the participant: a raster plot of the discharge times for each motor unit of a given muscle, a quadrant displaying the cumulative spike trains (CST) of two groups of motor units for a given muscle, a quadrant displaying the firing rate of two motor units, and the smoothed discharge rates of all the identified motor units for a given muscle (<xref rid="fig2" ref-type="fig">Figure 2</xref>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Overview of the online electromyographic (EMG) decomposition approach.</title><p>(A1) The participants performed submaximal isometric contractions while tracking a visual target that displayed the level of force/torque exerted upon the dynamometer. During this contraction, EMG signals were recorded with either high-density grids of surface electrodes (as shown for quadriceps) or arrays of intramuscular electrodes (not shown). (A2) Offline EMG decomposition was performed to optimize a separation vector for each motor unit and estimate the centroids of the ‘spikes’ and ‘noise’ classes using K-mean classification. (B) During the online EMG decomposition, the extended EMG signals recorded over 125-ms segments were projected on the separation vectors (motor unit filters), and the peaks were detected using the function ‘islocalmax’. Each peak is classified as a spike or as noise depending on the distance separating them from each centroid. At the end of this process, the motor unit firing activity is translated as visual feedback to the participant, in the form of a raster plot of the discharge times for each motor unit of a given muscle, a quadrant displaying the cumulative spike trains (CST) of two groups of motor units for a given muscle, a quadrant displaying the firing rate of two motor units (not shown), and the smoothed discharge rates of all the identified motor units for a given muscle.</p></caption>
<graphic xlink:href="536933v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2c">
<title>Electromyographic Recordings</title>
<p>The accuracy and boundary capabilities of the online EMG decomposition algorithm was tested on a series of experimental data collected with either a high-density grid or an intramuscular array of electrodes from five different muscles.</p>
<p>Surface EMG signals were recorded from the gastrocnemius medialis and lateralis (GM and GL; triceps surae protocol) or the vastus medialis and lateralis (VM and VL; quadriceps protocol) with two-dimensional adhesive grids of 64 electrodes [13 × 5 electrodes with one electrode absent on a corner, gold-coated, interelectrode distance: 8 mm; (GR08MM1305, OT Bioelettronica, Italy)]. Surface EMG signals were recorded from the tibialis anterior with a two-dimensional adhesive grid of 64 electrodes [13 × 5 electrodes with one electrode absent on a corner, gold-coated, interelectrode distance: 4 mm; (GR04MM1305, OT Bioelettronica, Italy)]. Before the placement of the grids, the skin was shaved and cleaned with an abrasive gel (Nuprep, Weaver and company, USA). Each adhesive grid was held on the skin using a semidisposable biadhesive foam layer. The cavities within the adhesive layer were filled with conductive paste (SpesMedica, Italy) to facilitate the skin-electrode contact. A 10-cm wide elastic band was placed over the electrodes to ensure good contact between the electrodes and the skin throughout the experiment.</p>
<p>An intramuscular linear array of 16 electrodes on a thin-film (platinum coated, interelectrode distance: 1mm) was inserted into the tibialis anterior in one participant at an approximate angle of 30°. The insertion was guided with a portable ultrasound probe (Butterfly IQ+, Butterfly Network, USA).</p>
<p>A reference electrode was positioned over the tibia of the right limb (triceps surae protocol), over the patella of the right limb (quadriceps protocol), or over the medial malleolus (tibialis anterior protocol). A strap electrode dampened with water was placed around the ankle (ground electrode) for each data collection. The EMG signals were recorded in monopolar mode and digitized together with the torque signal at a sampling rate of 2048 Hz for the grids of surface electrodes and 10240 Hz for the intramuscular array of electrodes (EMG-Quattrocento, 400 channel EMG amplifier; OT Bioelettronica, Italy).</p>
</sec>
<sec id="s2d">
<title>Experimental procedure</title>
<p>Eight physically active male volunteers (mean ± standard deviation; age: 28 ± 5 yr, height: 181 ± 5 cm, body mass: 77 ± 18 kg) participated in the triceps surae protocol, and eight physically active male volunteers (age: 31 ± 6 yr, height; 181 ± 5 cm; body mass: 78 ± 16 kg) participated in the quadriceps protocol; with data recorded using a pair of surface grid electrode. Two individuals participated in both the triceps surae and quadriceps protocols. Five physically active male volunteers (age: 26 ± 4 yr; height: 174 ± 7 cm; body mass: 66 ± 15 kg) participated in the tibialis anterior protocol, with data recorded using a surface grid electrode; and one physically active volunteer (age: 30 yr, height: 176 cm, body mass: 70 kg) participated in the tibialis anterior protocol with an intramuscular array of electrodes.</p>
<p>We specifically recruited males as: i) it is well known within the field that a greater number of motor units can be decomposed from the signals of males compared to females (although the reasons for this discrepancy are yet to be well established (<xref ref-type="bibr" rid="c28">28</xref>); and ii) we required a large number of motor units to test the accuracy of real-time identification. None of the participants reported lower limb injury or pain in the 6 months prior to testing. Ethical committees approved the study (triceps surae and quadriceps protocols: CERNI – Nantes Université, n°04022022; tibialis anterior protocol: Imperial College London, no. 18IC4685). All participants provided their informed written consent before the beginning of the experiment.</p>
<p>The right side of the body was tested for all participants and for all protocols. For the triceps surae protocol, participants sat on a dynamometer (Biodex System 3 Pro, Biodex Medical, USA) with their hip flexed at 80°, 0° being the neutral position, and their right leg fully extended. Their ankle angle was set to 10° of plantarflexion, 0° being the foot perpendicular to the shank. For the quadriceps protocol, participants sat on the dynamometer with their hips flexed at 80° and the knee of their right leg flexed at 80°, 0° being the full extension. Inextensible straps were tightened during both tasks to immobilize the torso, pelvis, and thigh on the test side. For the tibialis anterior protocol, participants sat on a chair while their foot was fixed onto the pedal of a dynamometer (OT Bioelettronica, Italy) coupled with a load cell (CCT Transducer, Italy) and positioned at 30° in the plantarflexion direction (0° being the foot perpendicular to the shank). The foot was fixed to the pedal with inextensible straps positioned around the proximal phalanx, metatarsal and cuneiform. Force signals were recorded using the same acquisition system as for the HD-EMG recordings (EMG-Quattrocento; OT Bioelettronica, Italy).</p>
<p>All experiments began with a standardized warm up, which included five 3-s isometric plantar flexion or knee extension contractions at 50%, 60%, 70%, and 80%, and three 3-s contractions at 90% of the participants’ subjective maximal torque. Then, after 2 min of rest, participants performed three maximal voluntary contractions (MVC) for 3–4 s, with 60-s of rest in between. Peak MVC torque was considered as the maximal value obtained from a moving average window of 250 ms.</p>
<p>For the triceps surae and quadriceps protocols, participants performed three trapezoid isometric contractions at 40% of the MVC (referred to as baseline contractions) to identify motor unit filters offline. Each of these contractions involved a 5-s ramp-up, a 20-s plateau, and a 5-s ramp-down phase and was separated by 60 s of rest. The separation vectors (motor unit filters) were identified offline from these contractions and then applied in real-time to estimate the firing activity of each identified motor unit during three additional trapezoid contractions (referred to as the online task). Each of these online tasks involved a 5-s ramp-up, a 30-s plateau and a 5-s ramp-down phase and was separated by 60 s of rest. To test the effect of variations in contraction intensity between the online task and the baseline contraction used to identify the separation vectors (motor unit filters), each plateau consisted of three successive 10-s targets at 35%, 40%, or 45% of the MVC performed in a random order. During these online tasks, feedback of motor unit discharge times and torque output was displayed in real-time on a monitor to the participants.</p>
<p>To test the effect of the baseline contraction intensity on the accuracy of real-time identification of motor unit discharge activity; the procedure was repeated with a baseline intensity of 20% MVC. During the last three trapezoidal contractions, each plateau consisted of three successive 10-s targets at 15%, 20%, or 25% of the MVC performed in a random order.</p>
<p>For the tibialis anterior protocol with grids of surface electrodes, participants performed a trapezoid contraction at 20% of the MVC, involving a 10-s ramp up, a 60-s plateau, and a 10-s ramp down phase (baseline contraction). The separation vectors (motor unit filters) were identified from this contraction and then applied in real-time over a second identical contraction (online task). The same procedure was repeated for the tibialis anterior protocol with an intramuscular array of electrodes, with contractions involving a ramp up phase of 2-s, a plateau of 20-s, and a ramp down phase of 2-s.</p>
</sec>
<sec id="s2e">
<title>Data processing</title>
<sec id="s2e1">
<title>Identification of separation vectors (motor unit filters) with offline EMG decomposition</title>
<p>The monopolar EMG signals collected during the baseline contractions were extended with an extension factor of <inline-formula><alternatives><inline-graphic xlink:href="536933v1_inline1.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, where <italic>m</italic> is the number of channels free of any noise or artifact. The signals were then demeaned and whitened. A fixed-point algorithm was applied to identify the sources of the EMG signals, i.e., the motor unit spike trains (<xref rid="fig1" ref-type="fig">Figure 1B</xref>). Motor unit spike trains can be considered as sparse sources with most samples being 0 (i.e., absence of spikes) and a few samples being 1 (i.e., spikes). In this algorithm, a contrast function was iteratively applied to estimate a separation vector (the motor unit filter) that maximized the level of sparseness of the identified source. Convergence was reached when the level of sparseness did not vary when compared to the previous iteration, with a tolerance fixed at 10<sup>-4</sup>. At this stage, the estimated source contained high peaks (i.e., the spikes from the identified motor unit) and low peaks from other motor units and noise. High peaks were separated from low peaks and noise using peak detection and K-mean classification with two classes: ’spikes’ and ’noise’ (<xref rid="fig1" ref-type="fig">Figure 1B</xref>). The peaks from the class with the highest centroid were considered as spikes of the identified motor unit. A second algorithm refined the estimation of the discharge times by iteratively recalculating the separation vector and repeating the steps with peak detection and K-mean classification until the coefficient of variation of the inter-spike intervals was minimized. The accuracy of each estimated spike train was assessed by computing the silhouette (SIL) value between the two classes of spikes identified with K-mean classification (<xref ref-type="bibr" rid="c18">18</xref>). When the SIL exceeded a predetermined threshold (see below), the motor unit filter was saved for the real-time decomposition, together with the centroids of the ‘spikes’ and ‘noise’ classes (<xref rid="fig2" ref-type="fig">Figure 2A</xref>).</p>
<p>Even though a SIL value of 0.9 is generally used for offline decomposition (<xref ref-type="bibr" rid="c18">18</xref>), we purposely decreased this threshold to 0.8 for the triceps surae and quadriceps experiments. We made this choice such that we maximised the number of motor units for testing the online decomposition capabilities. It is important to note that the spike trains from all of these retained units were visually checked for false positives and false negatives. The spike trains with no clear separation between the spikes and the noise were removed by the investigator. For the remaining motor units, manual editing was then performed by the investigator. Manual editing requires: i) identifying and removing the spikes of low quality (i.e., those with peaks close in amplitude to the level of noise), ii) re-calculating the motor-unit filter and re-applying it over a portion of the signal, and iii) adding the new spikes recognized as motor unit firings.</p>
<p>For the tibialis anterior experiments, the SIL value was set at 0.9. Visual checking and manual edition of the spike trains were performed using the same process as for the triceps surae and quadriceps experiments.</p>
</sec>
<sec id="s2e2">
<title>Real-time identification of motor neuron activities</title>
<p>EMG signals were transmitted by packages of 256 data points for the surface grid recordings (125 ms with a sampling frequency of 2048 Hz) or 1280 data points for the intramuscular array recordings (125 ms with a sampling frequency of 10240 Hz). The <italic>electrode mask</italic> determined from the baseline contractions was applied to remove the channels with noise or artifacts and the data was extended using the same extension factor as for the baseline contraction (see the section on EMG decomposition above). The matrix of separation vectors (motor unit filters) identified during the baseline contraction was applied over the extended EMG signal. Local peaks were identified for each motor unit using the MATLAB function “islocalmax” with a minimal separation of 25 ms between peaks to limit the number of false positives (<xref rid="fig2" ref-type="fig">Figure 2B</xref>). These peaks were considered as spikes when their distance from the centroid of the ‘spike’ class was shorter than the distance from the centroid of the ‘noise’ class (<xref rid="fig2" ref-type="fig">Figure 2B</xref>). Both centroids were identified from the offline decomposition made on the baseline contraction.</p>
<p>We calculated the CST of each muscle as the sum of the spikes of all the identified motor units over a moving window of eight consecutive epochs of 125 ms (total duration = 1s; units: spikes per second). Similarly, we calculated the discharge rate (i.e., spikes per second) of individual motor units as the sum of the spikes over a moving window of eight consecutive epochs of 125 ms). We chose this approach to facilitate the smoothness of the visual feedback, in contrast to the instantaneous discharge rate, which is calculated as the instantaneous inversed interspike interval, which oscillates more due to the presence of synaptic noise. While this approach introduces a delay of 500 ms in the estimation of the discharge rate, we identified in pilot testing that this also facilitates the control of motor unit discharge activities by the participant. To further increase the smoothness of the online biofeedback, we added the option in the software to average CSTs or individual discharge rates using a moving window. For the data reported in this paper, we selected a value of four consecutive values, corresponding to a window of 500 ms. Note that researchers who aim to minimize the delay of the visual feedback can disable this option, change its value, or use the real-time raster plots that displays the instantaneous discharge times of each motor unit.</p>
</sec>
<sec id="s2e3">
<title>Computational time</title>
<p>The computational time depends on the number of identified motor units during the baseline contraction, the number of peaks sorted during each epoch, and the number of EMG channels retained for the analysis. We considered the computational time for the decomposition as the time between the reception of the EMG signals by the computer and the estimation of the discharge times of all the identified motor units. We considered the computational time for the feedback as the time between the decomposition of the EMG signals and the update of the online feedback. The computational times were calculated on a laptop equipped with an Apple M1 Max chip and 64 GB of RAM.</p>
</sec>
<sec id="s2e4">
<title>Accuracy of the real-time identification of motor unit firing activity</title>
<p>To assess the accuracy of the real-time identification of motor unit spike trains, we compared the motor unit spike trains identified in real-time with those obtained after manual edition. The manual edition was performed offline as described above (<xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c29">29</xref>).</p>
<p>The accuracy of the real-time decomposition was assessed for each motor unit by computing the sensitivity, the precision, the false negative rate, and the rate of agreement between the manually edited spike train (offline) and the spike train identified in real-time, as follows:</p>
<p>Where TP (true positive) is the number of spikes identified in both the real-time and edited spike trains, FP (false positive) is the number of spikes only identified in the real-time spike train and FN (false negative) is the number of spikes only identified in the edited spike train.</p>
<p>To assess the accuracy of the biofeedback provided by the software, we measured the root mean square error (RMSE) between the path drawn by the smoothed discharge rate of motor units estimated in real-time and the path estimated from the manually edited motor unit spike trains.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Offline EMG decomposition of the baseline contraction and manual editing</title>
<p>After the completion of the isometric baseline contractions, the recorded EMG signals were decomposed over 150 iterations, which took approximately 5 min per grid of electrodes. When considering the baseline contractions performed at 20% MVC, on average 20 ± 9 (VL), 14 ± 5 (VM), 25 ± 11 (GL), and 19 ± 9 (GM) motor units per participant were identified with a SIL&gt;0.8. Their SIL values calculated before any manual editing were 0.89 ± 0.05 for VL, 0.83</p>
<p>± 0.04 for VM, 0.82 ± 0.03 for GL, and 0.87 ± 0.04 for GM. After manual editing, a significant number of motor units was removed as their spike train showed no clear separation between the spikes and the noise. The number of motor units removed was: 6 ± 5 for VL, 10 ± 5 for VM, 21 ± 12 for GL, and 6 ± 5 for GM (<xref rid="fig3" ref-type="fig">Figure 3</xref>). The remaining motor units exhibited a SIL value of 0.91 ± 0.04, 0.89 ± 0.06, 0.89 ± 0.03, and 0.90 ± 0.02 for VL, VM, GL, and GM, respectively (<xref rid="fig3" ref-type="fig">Figure 3</xref>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Effect of the manual editing on the quality of motor unit (MU) filters.</title><p>Once the participants completed the baseline contraction, we ran an automatic offline decomposition over 150 iterations. As described in the method section, we set a threshold for the silhouette value (SIL) at 0.8 to maximize the number of identified motor units for the vastus lateralis (VL), vastus medialis (VM), gastrocnemius lateralis (GL) and gastrocnemius medialis (GM). Then, the operator removed all the motor units for which the spikes were not clearly separated from the noise (red scatters in A). The remaining motor units were manually edited by the operator (black scatters in A). For the tibialis anterior, the SIL value was set at 0.9. (B) The manual editing consisted of removing false positives and adding the false negatives, before updating the motor unit filter. The effect of this step on the SIL value and the coefficient of variation of the inter-spike intervals (CoV of ISI, without units) is shown on the right panel. The red scatters are the motor units before editing and the green scatters are the motor units after editing. These scatters are connected with a grey vector to show the changes in SIL value and CoV of ISI.</p></caption>
<graphic xlink:href="536933v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>When considering the baseline contraction performed at 40% of MVC, on average 17 ± 6 (VL), 15 ± 5 (VM), 29 ± 13 (GL), and 13 ± 4 (GM) motor units were identified by automatic decomposition, with 12 ± 8 (VL), 3 ± 3 (VM), 5 ± 6 (GL), and 4 ± 3 (GM) motor units remaining after manual editing (<xref rid="fig3" ref-type="fig">Figure 3</xref>). The SIL value of the selected motor units reached 0.91 ± 0.03 for VL, 0.89 ± 0.05 for VM, 0.87 ± 0.02 for GL, and 0.88 ± 0.03 for GM (<xref rid="fig3" ref-type="fig">Figure 3</xref>).</p>
<p>The above results highlight that the motor units kept for the online EMG exhibit a SIL value well above 0.8. For the TA experiments, we chose to set a threshold at 0.9 for the minimal SIL for the offline decomposition to significantly decrease the burden of visual checking and manual editing. On average, we identified 15 ± 4 motor units with a SIL value of 0.94 ± 0.01 during the baseline contraction performed with grids of surface electrodes placed over the TA muscle. We identified 10 motor units with an average SIL value of 0.95 ± 0.02 during the baseline contraction performed with the intramuscular array of electrodes inserted into the TA (<xref rid="fig3" ref-type="fig">Figure 3A</xref>). Only one motor unit was removed from each dataset after manual editing. It is noteworthy that manual editing did not change the SIL value for any of the motor unit, either recorded with the grid of surface electrodes or the intramuscular array (<xref rid="fig3" ref-type="fig">Figure 3B</xref>).</p>
</sec>
<sec id="s3b">
<title>Computational time of online EMG decomposition and visual feedback</title>
<p>On average, the time between the reception of an epoch of EMG signals and the identification of the spikes was 4.9 ± 3.0 ms for data collected with high-density grids of surface electrodes.</p>
<p>To estimate the computational time per motor unit, we performed a linear regression between the number of identified motor units and the computational time per epoch using data from all the experiments made with high-density surface electrodes. The slope of the linear fit, i.e., the computational time per motor unit, was 0.37 ms (<xref rid="fig4" ref-type="fig">Figure 4A</xref>). Across all the experiments, the maximal computational time was 13.1 ms for 26 identified motor units. Of note, when considering the experiment made with intramuscular arrays of electrodes, the computational time reached 32.0 ms for 9 identified motor units. This was longer than observed for the same number of identified motor units using high-density surface electrodes (5.2 ms; <xref rid="fig4" ref-type="fig">Figure 4B</xref>) and was due to the greater sampling frequency used for the intramuscular recordings.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Computational time of the online EMG decomposition.</title><p>(A) We considered the computational time for the decomposition as the time between the reception of the EMG signals and the identification of the spikes for all the motor units. We computed the linear regression between the number of identified motor units and the computational time and considered the slope as the computational time per motor unit. Each scatter represents one decomposition, and the colour scheme depends on the muscle. (B) As the sampling frequency differed between recordings with high-density grids and intramuscular arrays of electrodes, we compared the computational times for both techniques with the same number of identified motor units (i.e., 9). (C) and (D) After the decomposition, the motor unit discharge activity was translated into visual feedback, either in the form of a raster plot or the smoothed discharge rates (DR) for all the identified motor units. As for the decomposition, we normalized the computational time per motor unit using a linear regression.</p></caption>
<graphic xlink:href="536933v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We then calculated the additional computational time to display visual feedback in the form of a raster plot or smoothed discharge rates of all the identified motor units. On average, we observed computational times of 8.6 ± 5.7 ms and 11.2 ± 7.6 ms for raster plots and smoothed discharge rates, respectively. The computational time per motor unit was 0.74 ms and 0.99 ms for raster plots and smoothed discharge rates, respectively (<xref rid="fig4" ref-type="fig">Figure 4C</xref> and <xref rid="fig4" ref-type="fig">4D</xref>). Of note, the computational time for the quadrant plot made from the activity of two motor units reached 14.8 ± 0.0 ms on average. It is noteworthy that the computational times for experiments with grids of electrodes or intramuscular arrays of electrodes was similar regardless of the type of visual feedback (<xref rid="fig4" ref-type="fig">Figure 4B</xref>). Overall, as the total computational time was constantly shorter than the duration of an epoch of EMG signals, the visual feedback was always updated during the recording of the next epoch of EMG signals. Therefore, the only delay was the incompressible recording time per epoch of signals, i.e., 125 ms.</p>
</sec>
<sec id="s3c">
<title>Accuracy of the real-time identification of motor unit firing activity</title>
<p>We assessed the accuracy of the motor unit spike trains identified in real time using their manually edited version as reference (<xref rid="fig5" ref-type="fig">Figure 5</xref>). It is noteworthy that some motor units present in the baseline contractions were not identified during the online contractions, either because they were not recruited, or because they were merged with newly recruited motor unit(s), i.e., their separation vector was no longer unique to other vectors. At 20% of MVC, the number of missed units was between 0 (TA intramuscular array) and 4 ± 4 (GM), and at 40% of MVC between 1 ± 1 (GM) and 4 ± 5 (GL).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Accuracy of the online EMG decomposition.</title>
<p>We compared the motor unit spike trains automatically identified in real-time with their manually edited version. We calculated the sensitivity, the precision, the false negative rate, and the rate of agreement for each motor unit. Each scatter is an individual motor unit, each box represents the 25<sup>th</sup> and 75<sup>th</sup> percentiles of the distribution of values, each bar represents the 5<sup>th</sup> and 95<sup>th</sup> percentiles of the distribution of values, and each line is the median. VL: vastus lateralis, VM: vastus medialis, GL: gastrocnemius lateralis, GM: gastrocnemius medialis, TAg: tibialis anterior recorded with a high-density grid of electrodes, and TAi: tibialis anterior recorded with an intramuscular array of electrodes.</p></caption>
<graphic xlink:href="536933v1_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For the sake of clarity, we only report in this section the rates of agreement for each intensity and muscle. Values of sensitivity, precision, and rates of false negatives are reported in <xref rid="fig5" ref-type="fig">Figure 5</xref>. The highest rate of agreement was observed for the TA (0.94 ± 0.09 with the grid and 0.97 ± 0.05 with the intramuscular array). Those values were lower for the vastii (VL: 0.82 ± 0.20; VM: 0.75 ± 0.18) and gastrocnemii muscles (GL: 0.88 ± 0.08; GM: 0.81 ± 0.18). When considering the contractions performed at 40% of MVC, the rate of agreement was 0.84 ± 0.16 for VL, 0.75 ± 0.21 for VM, 0.82 ± 0.08 for GL, and 0.88 ± 0.09 for GM (<xref rid="fig5" ref-type="fig">Figure 5</xref>).</p>
<p>For the triceps surae and quadriceps experiments, we also asked the participants to match force targets set at -5% (i.e., 15% and 35% of MVC for 20% and 40% of MVC conditions) and at +5% (i.e., 25% and 45% of MVC for 20% and 40% of MVC conditions). These contractions aimed to test the robustness of the separation vectors (motor unit filters) to changes in contraction intensity, i.e., in the number of active motor units generating the EMG signal. Results in terms of sensitivity, precision, false negative rate and rate of agreements are displayed on <xref rid="fig6" ref-type="fig">Figure 6</xref>.</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6.</label>
<caption><title>Accuracy of the online EMG decomposition with variations of contraction intensity.</title>
<p>We compared the motor unit spike trains automatically identified in real-time with their manually edited version while the contraction intensity was 5% below the level of the target (-5), at the level of the target (0) and 5% above the level of the target (+5). We calculated the sensitivity, the precision, the false negative rate, and the rate of agreement for each motor unit. Each scatter is an individual motor unit, each box represents the 25<sup>th</sup> and 75<sup>th</sup> percentiles of the distribution of values, each bar represents the 5<sup>th</sup> and 95<sup>th</sup> percentiles of the distribution of values, and each line is the median. VL: Vastus Lateralis, VM: Vastus Medialis, GL: Gastrocnemius Lateralis, GM: Gastrocnemius Medialis.</p></caption>
<graphic xlink:href="536933v1_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s3d">
<title>Accuracy of the real-time biofeedback</title>
<p>Because the accuracy of the raster plot feedback is directly related to the accuracy of the estimation of the discharge times reported in the previous section, here we only focus on the accuracy of the smoothed discharge rates (<xref rid="fig2" ref-type="fig">Figure 2</xref>). It can either be displayed in a quadrant, with a cursor moving within a two-dimensional space according to the discharge rates of two motor units, or with one cursor for each identified motor units moving in the vertical direction and following a scrolling path.</p>
<p>At 20% of MVC, the root mean squared error (RMSE) between the real time smoothed discharge rate and its edited version was consistently below two pulses per second for all the motor units (<xref rid="fig7" ref-type="fig">Figure 7</xref>). The lowest RMSE was observed with the TA muscle (0.64 ± 0.77 pps and 0.44 ± 0.43 with grids and intramuscular arrays of electrodes). RMSE was 1.4 ± 1.5 for VL, 1.8 ± 1.5 for VM, 1.7 ± 1.1 for GL, and 1.1 ± 1.1 pps for GM. At 40% of MVC, the RMSE reached 1.1 ± 1.2 for VL, 1.8 ± 1.1 for VM, 0.8 ± 0.5 for GL, and 0.6 ± 0.4 pps for GM. Overall, these RMSE provides strong evidence that the biofeedback accurately reflects the motor unit discharge activity.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7.</label>
<caption><title>Accuracy of the biofeedback based on the motor unit smoothed discharge rates.</title>
<p>After completing the online EMG decomposition, we converted the motor unit discharge times into biofeedback based on the firing activity of individual motor units. We estimated the accuracy of the biofeedback by calculating the root mean squared error (RMSE) between the smoothed discharge rates estimated from the motor unit spike trains identified in real-time and from their manually edited version at 20% of MVC and 40% of MVC. Each scatter is an individual motor unit, each box represents the 25<sup>th</sup> and 75<sup>th</sup> percentiles of the distribution of values, each bar represents the 5<sup>th</sup> and 95<sup>th</sup> percentiles of the distribution of values, and each line is the median. VL: vastus lateralis, VM: vastus medialis, GL: gastrocnemius lateralis, GM: gastrocnemius medialis, TAg: tibialis anterior recorded with a high-density grid of surface electrodes, and TAi: tibialis anterior recorded with an intramuscular array of electrodes.</p></caption>
<graphic xlink:href="536933v1_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>We have introduced an open-source software based on blind source separation for decoding the activity of alpha motor neurons in real-time. We first presented the full framework, from the initialisation of the real time decoding using an offline decomposition of EMG signals with fastICA, to the real-time feedback. We demonstrated that: i) the computational time to decompose the EMG signals in real-time is low, i.e., 0.37 ms per motor unit when high-density EMG electrodes are used, ii) the highest accuracy of the real time decoding is observed with intramuscular array comparing to grids of surface electrodes, iii) the highest accuracy of the real time decoding is observed for the tibialis anterior relatively to the other muscles, iv) the smoothed motor unit discharge rates displayed to the participant is accurately estimated from real time EMG decomposition, with a RMSE value lower than 2 pulses per second. Overall, this open-source software provides a set of tools for neuroscientists to design experimental paradigms where participants can receive neurofeedback in real-time on the output of the spinal cord circuits.</p>
<p>There are processing assumptions for the blind-source separation algorithm to accurately identify motor unit discharge times from multichannel EMG signals. Among them, the most important is the uniqueness of the distribution of motor unit action potentials across electrodes (that defines the separation vector) among all the other active motor units within the recording volume (<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c25">25</xref>). One way to satisfy this condition is to increase the selectivity of the electrodes to record the discharge activity of only a few motor units from a small volume of muscle (<xref ref-type="bibr" rid="c4">4</xref>). For example, <xref rid="fig1" ref-type="fig">Figure 1A</xref> shows a motor unit action potential detected only over three to four electrode sites along the array of intramuscular electrodes, while a motor unit action potential can be observed across many more electrodes with grids of surface electrodes. Therefore, the likelihood of having spatially overlapping motor unit action potentials is lower, which explains why the rate of agreement of motor units identified from intramuscular arrays of electrodes is much higher than with single channel wire electrodes or grids of surface electrodes (<xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c8">8</xref>). A second way to increase the percentage of discriminable motor units among all the active motor units in the recording volume is to increase the spatial sampling of their activity using multiple electrodes (<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c25">25</xref>). This has led to the growth of EMG recording systems with high-density grids of surface electrodes (<xref ref-type="bibr" rid="c3">3</xref>), which compensate for the lack of specificity of motor unit action potential profiles that are recorded when using a pair of traditional bipolar EMG electrodes (<xref ref-type="bibr" rid="c30">30</xref>).</p>
<p>Another necessary condition for EMG decomposition using the blind-source separation algorithm is the consistency of the motor unit filters across time. An obvious reason inducing changes in motor unit filters would be the displacement of the electrodes relatively to the source. Such drifts also exist with intracortical arrays and can be corrected with appropriate methods that track waveforms across electrodes (<xref ref-type="bibr" rid="c13">13</xref>). However, the geometry of the muscle tissue is much more variable than that of the cortical tissue, especially during movements. For example, muscle bellies become bulkier while shortening (<xref ref-type="bibr" rid="c31">31</xref>), increasing the distance between the surface electrodes and the deep sources. In addition, the pennation angle of muscle fibres can change with contraction intensity (<xref ref-type="bibr" rid="c32">32</xref>), modifying the direction of the propagation of motor unit action potentials along the fibres relatively to the position of the electrodes. All these factors impact the recorded motor unit action potential profiles across electrodes, which in turn will reduce the capacity to discriminate the same motor unit from the EMG signal (<xref ref-type="bibr" rid="c27">27</xref>, <xref ref-type="bibr" rid="c33">33</xref>, <xref ref-type="bibr" rid="c34">34</xref>). For these reasons, we recommend applying our approach during isometric contractions with a stable level of force, as even large changes in force during isometric contractions can impact the orientation of the muscle fibres relatively to the skin within muscles (<xref ref-type="bibr" rid="c35">35</xref>).</p>
<p>The first step of the algorithm consists of identifying motor unit separation vectors (motor unit filters) from EMG signals with fastICA (<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c36">36</xref>). Classically, metrics such as the Pulse to Noise ratio (<xref ref-type="bibr" rid="c37">37</xref>) or the silhouette value (<xref ref-type="bibr" rid="c18">18</xref>) are used to assess the reliability of the identified motor units by estimating the distance between the spikes and the noise. Here, we purposely lowered the threshold classically recommended for offline decomposition (i.e., 0.9 in (<xref ref-type="bibr" rid="c18">18</xref>)) to maximize the number of identified units (<xref rid="fig3" ref-type="fig">Figure 3A</xref>). It is noteworthy that such approach must be associated with extensive manual editing to remove the discharge times incorrectly selected and to add missing spikes (<xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c29">29</xref>). This necessary step precedes the update of the motor unit filter with all the detected spikes (<xref ref-type="bibr" rid="c38">38</xref>), leading to an increase in the silhouette value and a decrease in the coefficient of variation of the interspike intervals (<xref rid="fig3" ref-type="fig">Figure 3B</xref>). Alternatively, one could speed up the processing flow by setting a higher threshold for the silhouette value. This would decrease the burden of manual editing at the cost of decreasing the number of identified motor units. However, it is important to note that using more stringent criteria does not preclude the manual editing, even for motor units with a high silhouette value (see motor units 1 and 2 with missed spikes in <xref rid="fig2" ref-type="fig">Figure 2</xref>).</p>
<p>The second step of the algorithm consists of identifying motor units discharge times in real time by projecting extended segments of EMG signals into separation vectors (motor unit filters) to estimate motor unit pulse trains (<xref rid="fig2" ref-type="fig">Figure 2B</xref>; (<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c22">22</xref>)). This method was effective at identifying motor unit discharge times, with rates of agreement &gt;0.75, regardless of the contraction intensity and muscle (<xref rid="fig5" ref-type="fig">Figure 5</xref>). It is noteworthy that the performance was particularly high for the recordings made with an intramuscular array of electrodes (rate of agreement of 0.97 ± 0.05, <xref rid="fig5" ref-type="fig">Figure 5</xref>). As mentioned above, the better performance of blind source separation on multichannel intramuscular EMG has already been reported with offline analyses (<xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c19">19</xref>). This is explained by the higher spatial selectivity of the electrodes (<xref ref-type="bibr" rid="c4">4</xref>), the larger bandwidth of the signal (<xref ref-type="bibr" rid="c30">30</xref>), and the higher robustness of the motor unit filter as the signal is less affected by the geometric changes of the volume conductor. In contrast, precision and rates of agreements were lower for motor units identified over the vastii and gastrocnemii muscles when compared to the TA muscle (<xref rid="fig5" ref-type="fig">Figure 5</xref>). Even though the reason for this between-muscle difference is unclear, it is possible that the specific activation level of the vastii and gastrocnemii muscles varied more than that of TA between the baseline and test contractions, because of muscle redundancy leading to multiple coordination strategies possible to perform knee flexion or plantarflexion. For example, a decrease in activation would decrease the height of the peaks of the estimated sources, potentially classified in the noise class during the online decomposition (<xref ref-type="bibr" rid="c22">22</xref>). Conversely, an increase in activation may activate motor units spatially close to those observed during the baseline contraction, corrupting their pulse train with merged sources (<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c17">17</xref>). This explanation is in line with the lower rate of agreement observed when participants tracked a force target 5% of the MVC higher than the level of the baseline contraction (<xref rid="fig6" ref-type="fig">Figure 6</xref>). One way to overcome these challenges would be to dynamically updating the motor unit filters and the centroids of the ‘spikes’ and ‘noise’ classes (<xref ref-type="bibr" rid="c22">22</xref>). While appealing, this approach is also computationally demanding, with computational times significantly higher than those observed in this study (<xref ref-type="bibr" rid="c22">22</xref>). We propose in our software to update the motor unit filters and the centroids of the ‘spikes’ and ‘noise’ classes during the resting periods. In addition, it is recommended that the operator displays the motor unit pulse trains and identified discharge times between contractions to check for decomposition accuracy across the session.</p>
<p>Overall, the main purpose of our software is to display to the participant a real-time visual feedback based on the activity of individual motor units or populations of motor units. The root-mean square error of the smoothed discharge rates was constantly below two pulses per second, with values as low as 0.44 ± 0.43 pps for the TA muscle recorded with intramuscular electrode arrays. Thus, the movement of the cursors accurately represented the variations in motor unit discharge activity to the participant. In this study we have presented results of control of smoothed CST over a relatively large smoothing window, but the duration of the smoothing filter when computing the CST can be chosen by the user according to the needs and applications. Operators could use the provided software to interact with a virtual environment, such as typing on a keyboard with a cursor moved by modulating motor unit discharge rates (<xref ref-type="bibr" rid="c24">24</xref>). In the field of motor control, neuroscientists may train participants to selectively activate individual motor units (<xref ref-type="bibr" rid="c21">21</xref>), testing the concept of rigid versus flexible motor control (<xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c39">39</xref>), or movement augmentation (<xref ref-type="bibr" rid="c40">40</xref>). Generally, we hope that this open-source software will open perspectives for neuroscientists to design experimental paradigms that takes advantage of online EMG decomposition to study the neural control of movements at the motor neuron level.</p>
</sec>
</body>
<back>
<sec id="s5aaa">
<title>Supplemental data availability</title>
<p>The entire data set (raw and processed data) codes, and a user manual of the software are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/simonavrillon/I-Spin">https://github.com/simonavrillon/I-Spin</ext-link></p>
</sec>
<sec id="s5">
<title>Disclosures</title>
<p>DF is inventor of a patent (Neural Interface. UK Patent application no. GB1813762.0. August 23, 2018) and of a patent application (Neural interface. UK Patent application no. GB2014671.8. September 17, 2020), which are partly related to the methods and applications of this work. All other authors have no financial or other relationships that might lead to a conflict of interest.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><given-names>C. S.</given-names> <surname>Sherrington</surname></string-name>, <article-title>Remarks on some aspects of reflex inhibition. Proceedings of the Royal Society of London. Series B</article-title>, <source>Containing Papers of a Biological Character</source> <volume>97</volume>, <fpage>519</fpage>–<lpage>545</lpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><given-names>R. M.</given-names> <surname>Enoka</surname></string-name>, <article-title>Physiological validation of the decomposition of surface EMG signals</article-title>. <source>J Electromyogr Kinesiol</source> <volume>46</volume>, <fpage>70</fpage>–<lpage>83</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Negro</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Muceli</surname></string-name>, <string-name><given-names>R. M.</given-names> <surname>Enoka</surname></string-name>, <article-title>Principles of Motor Unit Physiology Evolve With Advances in Technology</article-title>. <source>Physiology (Bethesda</source><italic>)</italic> <volume>31</volume>, <fpage>83</fpage>–<lpage>94</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><given-names>R. S.</given-names> <surname>LeFever</surname></string-name>, <string-name><given-names>C. J.</given-names> <surname>De Luca</surname></string-name>, <article-title>A procedure for decomposing the myoelectric signal into its constituent action potentials--Part I: Technique, theory, and implementation</article-title>. <source>IEEE Trans Biomed Eng</source> <volume>29</volume>, <fpage>149</fpage>–<lpage>157</lpage> (<year>1982</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><given-names>K. C.</given-names> <surname>McGill</surname></string-name>, <string-name><given-names>Z. C.</given-names> <surname>Lateva</surname></string-name>, <string-name><given-names>H. R.</given-names> <surname>Marateb</surname></string-name>, <article-title>EMGLAB: an interactive EMG decomposition program</article-title>. <source>J Neurosci Methods</source> <volume>149</volume>, <fpage>121</fpage>–<lpage>133</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Yoshida</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Stieglitz</surname></string-name>, <string-name><given-names>K. P.</given-names> <surname>Koch</surname></string-name>, <article-title>Multichannel thin-film electrode for intramuscular electromyographic recordings</article-title>. <source>J Appl Physiol (1985)</source> <volume>104</volume>, <fpage>821</fpage>–<lpage>827</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><given-names>S.</given-names> <surname>Muceli</surname></string-name> <etal>et al.</etal>, <article-title>Accurate and representative decoding of the neural drive to muscles in humans with multi-channel intramuscular thin-film electrodes</article-title>. <source>J Physiol</source> <volume>593</volume>, <fpage>3789</fpage>–<lpage>3804</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><given-names>S.</given-names> <surname>Muceli</surname></string-name> <etal>et al.</etal>, <article-title>Blind identification of the spinal cord output in humans with high-density electrode arrays implanted in muscles</article-title>. <source>Science advances</source> <volume>8</volume>, <fpage>eabo5040</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><given-names>B.</given-names> <surname>Chung</surname></string-name> <etal>et al.</etal>, <article-title>Myomatrix arrays for high-definition muscle recording</article-title>. <source>bioRxiv</source> 10.1101/2023.02.21.529200, 2023.2002.2021.529200 (<year>2023</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><given-names>A. H.</given-names> <surname>Caillet</surname></string-name> <etal>et al.</etal>, <article-title>Larger and denser: an optimal design for surface grids of EMG electrodes to identify greater and more representative samples of motor units</article-title>. <source>bioRxiv</source> 10.1101/2023.02.18.529050, 2023.2002.2018.529050 (<year>2023</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><given-names>H. G.</given-names> <surname>Rey</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Pedreira</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Quian Quiroga</surname></string-name>, <article-title>Past, present and future of spike sorting techniques</article-title>. <source>Brain Res Bull</source> <volume>119</volume>, <fpage>106</fpage>–<lpage>117</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><given-names>A. P.</given-names> <surname>Buccino</surname></string-name> <etal>et al.</etal>, <article-title>SpikeInterface, a unified framework for spike sorting</article-title>. <source>Elife</source> <volume>9</volume> (<year>2020</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><given-names>N. A.</given-names> <surname>Steinmetz</surname></string-name> <etal>et al.</etal>, <article-title>Neuropixels 2.0: A miniaturized high-density probe for stable, long-term brain recordings</article-title>. <source>Science</source> <volume>372</volume> (<year>2021</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Pachitariu</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Sridhar</surname></string-name>, <string-name><given-names>C.</given-names> <surname>Stringer</surname></string-name>, <article-title>Solving the spike sorting problem with Kilosort</article-title>. <source>bioRxiv</source> <volume>10</volume>.<year>1101/2023.01.07.523036, 2023.2001.2007.523036 (2023</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Holobar</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Zazula</surname></string-name>, <article-title>Multichannel Blind Source Separation Using Convolution Kernel Compensation</article-title>. <source>IEEE Transactions on Signal Processing</source> <volume>55</volume>, <fpage>4487</fpage>–<lpage>4496</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Holobar</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <article-title>Blind source identification from the multichannel surface electromyogram</article-title>. <source>Physiol Meas</source> <volume>35</volume>, <fpage>R143</fpage>–<lpage>165</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Holobar</surname></string-name>, <article-title>Characterization of Human Motor Units From Surface EMG Decomposition</article-title>. <source>Proceedings of the IEEE</source> <volume>104</volume>, <fpage>353</fpage>–<lpage>373</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><given-names>F.</given-names> <surname>Negro</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Muceli</surname></string-name>, <string-name><given-names>A. M.</given-names> <surname>Castronovo</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Holobar</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <article-title>Multi-channel intramuscular and surface EMG decomposition by convolutive blind source separation</article-title>. <source>J Neural Eng</source> <volume>13</volume>, <issue>026027</issue> (<year>2016</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>X.</given-names> <surname>Zhang</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Zhou</surname></string-name>, <article-title>Automatic Multichannel Intramuscular Electromyogram Decomposition: Progressive FastICA Peel-Off and Performance Validation</article-title>. <source>IEEE Trans Neural Syst Rehabil Eng</source> <volume>27</volume>, <fpage>76</fpage>–<lpage>84</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><given-names>D. Y.</given-names> <surname>Barsakcioglu</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Bracklein</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Holobar</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <article-title>Control of Spinal Motoneurons by Feedback From a Non-Invasive Real-Time Interface</article-title>. <source>IEEE Trans Biomed Eng</source> <volume>68</volume>, <fpage>926</fpage>–<lpage>935</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Bracklein</surname></string-name> <etal>et al.</etal>, <article-title>The control and training of single motor units in isometric tasks are constrained by a common input signal</article-title>. <source>Elife</source> <volume>11</volume> (<year>2022</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><given-names>C.</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Ma</surname></string-name>, <string-name><given-names>X.</given-names> <surname>Sheng</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <string-name><given-names>X.</given-names> <surname>Zhu</surname></string-name>, <article-title>Adaptive Real-Time Identification of Motor Unit Discharges From Non-Stationary High-Density Surface Electromyographic Signals</article-title>. <source>IEEE Trans Biomed Eng</source> <volume>67</volume>, <fpage>3501</fpage>–<lpage>3509</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><given-names>Y.</given-names> <surname>Zheng</surname></string-name>, <string-name><given-names>X.</given-names> <surname>Hu</surname></string-name>, <article-title>Real-time isometric finger extension force estimation based on motor unit discharge information</article-title>. <source>J Neural Eng</source> <volume>16</volume>, <issue>066006</issue> (<year>2019</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><given-names>E.</given-names> <surname>Formento</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Botros</surname></string-name>, <string-name><given-names>J. M.</given-names> <surname>Carmena</surname></string-name>, <article-title>Skilled independent control of individual motor units via a non-invasive neuromuscular-machine interface</article-title>. <source>J Neural Eng</source> <volume>18</volume> (<year>2021</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Negro</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Gazzoni</surname></string-name>, <string-name><given-names>R. M.</given-names> <surname>Enoka</surname></string-name>, <article-title>Detecting the unique representation of motor-unit action potentials in the surface electromyogram</article-title>. <source>J Neurophysiol</source> <volume>100</volume>, <fpage>1223</fpage>–<lpage>1233</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><given-names>V.</given-names> <surname>Glaser</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Holobar</surname></string-name>, <article-title>Motor Unit Identification From High-Density Surface Electromyograms in Repeated Dynamic Muscle Contractions</article-title>. <source>IEEE Trans Neural Syst Rehabil Eng</source> <volume>27</volume>, <fpage>66</fpage>–<lpage>75</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><string-name><given-names>A. S.</given-names> <surname>Oliveira</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Negro</surname></string-name>, <article-title>Neural control of matched motor units during muscle shortening and lengthening at increasing velocities</article-title>. <source>J Appl Physiol (1985)</source> <volume>130</volume>, <fpage>1798</fpage>–<lpage>1813</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Del Vecchio</surname></string-name> <etal>et al.</etal>, <article-title>Tutorial: Analysis of motor unit discharge characteristics from high-density surface EMG signals</article-title>. <source>J Electromyogr Kinesiol</source> <volume>53</volume>, <issue>102426</issue> (<year>2020</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><given-names>F.</given-names> <surname>Hug</surname></string-name> <etal>et al.</etal>, <article-title>Analysis of motor unit spike trains estimated from high-density surface electromyography is highly reliable across operators</article-title>. <source>J Electromyogr Kinesiol</source> <volume>58</volume>, <issue>102548</issue> (<year>2021</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><given-names>L. H.</given-names> <surname>Lindstrom</surname></string-name>, <string-name><given-names>R. I.</given-names> <surname>Magnusson</surname></string-name>, <article-title>Interpretation of myoelectric power spectra: A model and its applications</article-title>. <source>Proceedings of the IEEE</source> <volume>65</volume>, <fpage>653</fpage>–<lpage>662</lpage> (<year>1977</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><given-names>R. D.</given-names> <surname>Herbert</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Bolsterlee</surname></string-name>, <string-name><given-names>S. C.</given-names> <surname>Gandevia</surname></string-name>, <article-title>Passive changes in muscle length</article-title>. <source>J Appl Physiol (1985)</source> <volume>126</volume>, <fpage>1445</fpage>–<lpage>1453</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><given-names>T.</given-names> <surname>Fukunaga</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Kawakami</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Kuno</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Funato</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Fukashiro</surname></string-name>, <article-title>Muscle architecture and function in humans</article-title>. <source>J Biomech</source> <volume>30</volume>, <fpage>457</fpage>–<lpage>463</lpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Merletti</surname></string-name>, <string-name><given-names>R. M.</given-names> <surname>Enoka</surname></string-name>, <article-title>The extraction of neural strategies from the surface EMG</article-title>. <source>J Appl Physiol (1985)</source> <volume>96</volume>, <fpage>1486</fpage>-<lpage>1495</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><given-names>V.</given-names> <surname>Glaser</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Holobar</surname></string-name>, <article-title>Simulations of high-density surface electromyograms in dynamic muscle contractions</article-title>. <source>Annu Int Conf IEEE Eng Med Biol Soc 2017</source>, <fpage>3453</fpage>–<lpage>3456</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Ito</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Kawakami</surname></string-name>, <string-name><given-names>Y.</given-names> <surname>Ichinose</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Fukashiro</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Fukunaga</surname></string-name>, <article-title>Nonisometric behavior of fascicles during isometric contractions of a human muscle</article-title>. <source>J Appl Physiol (1985)</source> <volume>85</volume>, <fpage>1230</fpage>–<lpage>1235</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><given-names>M.</given-names> <surname>Chen</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Zhou</surname></string-name>, <article-title>A Novel Framework Based on FastICA for High Density Surface EMG Decomposition</article-title>. <source>IEEE Trans Neural Syst Rehabil Eng</source> <volume>24</volume>, <fpage>117</fpage>–<lpage>127</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Holobar</surname></string-name>, <string-name><given-names>M. A.</given-names> <surname>Minetto</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <article-title>Accurate identification of motor unit discharge patterns from high-density surface EMG and validation with a novel signal-based performance metric</article-title>. <source>J Neural Eng</source> <volume>11</volume>, <issue>016008</issue> (<year>2014</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><given-names>A.</given-names> <surname>Holobar</surname></string-name>, <string-name><given-names>M. A.</given-names> <surname>Minetto</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Botter</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Negro</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Farina</surname></string-name>, <article-title>Experimental analysis of accuracy in the identification of motor unit spike trains from high-density surface EMG</article-title>. <source>IEEE Trans Neural Syst Rehabil Eng</source> <volume>18</volume>, <fpage>221</fpage>–<lpage>229</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><given-names>N. J.</given-names> <surname>Marshall</surname></string-name> <etal>et al.</etal>, <article-title>Flexible neural control of motor units</article-title>. <source>Nat Neurosci</source> <volume>25</volume>, <fpage>1492</fpage>–<lpage>1504</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><given-names>J.</given-names> <surname>Eden</surname></string-name> <etal>et al.</etal>, <article-title>Principles of human movement augmentation and the challenges in making it a reality</article-title>. <source>Nat Commun</source> <volume>13</volume>, <fpage>1345</fpage> (<year>2022</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88670.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Pruszynski</surname>
<given-names>J Andrew</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Western University</institution>
</institution-wrap>
<city>London</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This manuscript compiles existing algorithms into an open-source software package that enables real-time motor unit decomposition from muscle activity collected via grids of surface electrodes and indwelling electrode arrays. The software package is <bold>valuable</bold> given that many motor neuroscience labs are using such algorithms and that there exist a host of potential real-time applications for such data. Validation of the software package is generally <bold>solid</bold> but <bold>incomplete</bold> in some significant areas: the primary data is narrow in scope and only from male participants, and there is a lack of ground truth tests on synthetic data. The impact of the software package could be strengthened by making it less tied to specific electrode hardware and by expanding it to easily permit offline analysis.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88670.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Many labs worldwide now use the blind source deconvolution technique to identify the firing patterns of multiple motor units simultaneously in human subjects. This technique has had a truly transformative effect on our understanding of the structure of motor output in both normal subjects and, increasingly, in persons with neurological disorders. The key advance presented here is that the software provides real-time identification of these firing patterns.</p>
<p>The main strengths are the clarity of the presentation and the great potential that real-time decoding will provide. Figures are especially effective and statistical analyses are excellent.</p>
<p>The main limitation of the work is that only male subjects were included in the validation of the software. The reason given - that yield of number of motor units identified is generally larger in males than females - is reasonable in the sense that this is the first systematic test of this real-time approach. At a minimum, however, the authors should clearly commit to future work with female subjects and emphasize the importance of considering sex differences.</p>
<p>A second weakness is that the Introduction does a poor job of establishing the potential importance of the real-time approach.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88670.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Rossato et al present I-spin live, a software package to perform real-time blind-source separation-based sorting of motor unit activity. The core contribution of this manuscript is the development and validation of a software package to perform motor unit sorting, apply the resulting motor unit filters in real-time during muscle contractions, and provide real-time visual feedback of the motor unit activity.</p>
<p>I have a few concerns with the work as presented:</p>
<p>- I found it challenging to specifically understand the technical contributions of this manuscript. The authors do not appear to be claiming anything novel algorithmically (with respect to spike sorting) or methodologically (with respect to manual editing of spikes before the use of the algorithms in real-time). My takeaway is that the key contributions are C1) development of an open-source implementation of the Negro algorithm, C2) validating it for real-time application (evaluating its sorting efficacy, and closed-loop performance, etc), and developing a software package to run in closed-loop with visual feedback. I will comment on each of these items separately below. It would be great if the authors could more explicitly lay out the key contributions of this manuscript in the text.</p>
<p>- Related to the above, much of the validation of the algorithms in this manuscript has a &quot;trust me&quot; feel - the authors note that the Negro et al. algorithm has already been validated, so very few details or presentations of primary data showing the algorithm's performance are shown. Similarly, the efficacy of the decomposition approach is evaluated using manual editing of the sorting output as a reference, which is a subjective process, and users would greatly benefit from explicit guidance. There are very few details of manual editing shown in this manuscript (I believe the authors reference the Hug et al. 2021 paper for these details), and little discussion of the core challenges and variability of that process, even though it seems to be a critical step in the proposed workflow. So this is very hard to evaluate and would be challenging for readers to replicate.</p>
<p>- I found the User Guide in the Github package to be easy to follow. Importantly, it seems heavily tied to the specific hardware (Quattrocento). I understand it may be difficult to make the full software package work with different hardware, but it seems important to at least make an offline analysis of recorded data possible for this package to be useful more broadly.</p>
<p>- While this may be a powerful platform, it is also very possible that without more details and careful guidance for users on potential pitfalls, many non-experts in sorting could use this as a platform for somewhat sloppy science.</p>
<p>- The authors mention that data is included with the Github software package. I could not find any included data, or instructions on how to run the software offline on example data.</p>
<p>- Given the centrality of the real-time visual feedback to their system, the authors should show some examples of the actual display etc. so readers can understand what the system in action actually looks like (I believe there is no presentation of the actual system in the manuscript, just in the User Guide). Similarly, it would be helpful to have a schematic figure outlining the full workflow that a user goes through when using this system.</p>
<p>- The authors note all data was collected with male subjects because more motor units can be decomposed from male subjects relative to females. But what is the long-term outlook for the field if studies avoid female subjects because their motor units may be harder to decompose? This should at least be discussed - it is an important challenge for the field to solve, and it is unacceptable if new methods just avoid this problem and are only tested on male subjects.</p>
<p>Specific comments on the core contributions of this paper:</p>
<p>C1. Development of an open-source implementation of the Negro algorithm</p>
<p>
This seems an important contribution and useful for the community. There are very few figures showing any primary data, the efficacy of sorting, raw traces showing the waveforms that are identified, cluster shapes, etc. I realize the high-level algorithm has been outlined elsewhere, but the implementation in this package, and its efficacy, is a core component of the system and the claims being made in this paper. Much more presentation of data is needed to evaluate this.</p>
<p>Similarly, more information on the offline manual editing process (e.g. showing before/after examples with primary data) would be important to gain confidence in the method. The current paper shows application to both surface EMG and intramuscular EMG, but I could not find IM EMG examples in the Hug paper (apologies if I missed them). Surface and IM data are very, very different, so one would imagine the considerations when working with them should also be different.</p>
<p>All descriptions of math/algorithms are presented in text, without any actual math, variable definitions, etc. This presentation makes it difficult to understand what is done. I would strongly recommend writing out equations and defining variables where possible.</p>
<p>More details on how the level of sparseness is controlled during optimization would be helpful. And how this sparseness penalty is weighed against other optimization costs.</p>
<p>Overall the paper is not very rigorous about the accuracy of motor unit identification. For example, the authors note that SIL of 0.9 is generally used for offline evaluation (why is this acceptable?), but it was lowered to 0.8 for particular muscles in this study. But overall, it is unclear how sorting accuracy/inaccuracy affects performance in the target applications of this work.</p>
<p>C2. For real-time experiments, variability/jitter is important to characterize. Fig. 4 seems to be presenting mean computational times, etc, but no presentation of variability is shown. It would be helpful to depict data distributions somehow, rather than just mean values.</p>
<p>There is some description about the difference between units identified during baseline contractions, and how they might be misidentified during online contractions (&quot;Accuracy of the real-time identification...&quot;). This should be described in more detail.</p>
<p>Fig. 6: Given that a key challenge in sorting should be that collisions occur during large contractions, much more primary data should be presented/visualized to show how the accuracy of sorting changes during larger contractions in online experiments.</p>
<p>Fig.7: In presenting the accuracy of biofeedback, it is very hard to gain any intuition for performance by just looking at RMSE values. Showing the online decoded and edited trajectories would help readers understand the magnitude of errors.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88670.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>In this manuscript, Rossato and colleagues present a method for real-time decoding of EMG into putative single motor units. Their manuscript details a variety of decision points in their code and data collection pipeline that lead to a final result of recording on the order of ~10 putative motor units per muscle in human males. Overall the manuscript is highly restricted in its potential utility but may be of interest to aficionados. For those outside the field of human or nonhuman primate EMG, these methods will be of limited interest.</p>
<p>Notes</p>
<p>
1. Artificial data should be used with this method to provide ground truth performance evaluations. Without it, the study assumptions are unchallenged and could be seriously flawed.</p>
<p>2. From the point of view of a motor control neuroscientist studying movement in animals other than humans or non-human primates, the title was misleadingly hopeful. The use case presented in this study requires human participants to perform isometric contractions, facilitating spatially redundant recordings across the muscle for the algorithm to work. It is unclear whether these methods will be of utility to use cases under more physiological conditions (ie. dynamic movement).</p>
<p>3. The text states that &quot;EMG signals recorded with an array of electrodes can be considered and instantaneous mixture of the original motor unit spike trains and their delayed versions.&quot; While this may be a true statement, it is not a complete statement, since motor units at distal sites may be shared, not shared, or novel. It was not clear to me whether the diversity of these scenarios would affect the performance of the software or introduce artifacts. In other words, if at site 1 you can pick up the bulk signal of units 1,2,3,4; at site two you pick up the signals of units 2,3,4,5 and site three you pick up the signal of units 3,4,5,6, what does the algorithm assume is happening and what does it report and why?</p>
<p>4. I could not fully appreciate the performance gap solved by the current methods. What was not achievable before that is now achievable? The 125 ms speed of deconvolution? What was achievable before? Intro text around ln 85 states that 'most of the current implementations of this approach rely on offline processing, which restricts its ability to be used...&quot; but no reference is provided here about what the non 'most' of can achieve.</p>
<p>5. Relatedly, it would have been nice to see a proof of concept using real-time feedback for some kind of biofeedback signal. If that is the objective here, why not show us this? I found the actual readout metrics of performance rather esoteric. They may be of interest to very close experts so I will defer to them for input.</p>
<p>6. I was disappointed to see that only male participants are used because of some vague statement that 'it is widely known in the field' that more motor units can be resolved in males, without thorough referencing. It seems that the objective of the algorithm is the speed of analysis, not the number of units, which makes the elimination of female participants not justified.</p>
<p>7. Human curation is often used in spike sorting, but the description of criteria used in this step or how the human curation choices are documented is missing.</p>
<p>8. The authors might try to add text to be more circumspect about the contributions of this method. I would recommend emphasizing the conceptual advances over the specifics of the performance of the algorithm since processor speed and implementation of the ideas in a faster environment (Matlab can be slow) will change those outcomes in a trivial way. Yet, much of the results section is very focused on these metrics.</p>
<p>
Minor</p>
<p>
Ln 115, &quot;inversing&quot; is not a word. &quot;inverse&quot; is not a verb</p>
<p>
Ln 186, typo, bioadhesive</p>
<p>
MVC should be defined on first use. It is currently defined on 3rd use or so.</p>
<p>
The term rate is used in a variety of places without units. Eg line 465 but not limited to that</p>
</body>
</sub-article>
</article>