<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">88591</article-id>
<article-id pub-id-type="doi">10.7554/eLife.88591</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.88591.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>MotorNet: a Python toolbox for controlling differentiable biomechanical effectors with artificial neural networks</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0796-5457</contrib-id>
<name>
<surname>Codol</surname>
<given-names>Olivier</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">6</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5179-3181</contrib-id>
<name>
<surname>Michaels</surname>
<given-names>Jonathan A.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kashefi</surname>
<given-names>Mehrdad</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0786-0081</contrib-id>
<name>
<surname>Pruszynski</surname>
<given-names>J. Andrew</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1368-032X</contrib-id>
<name>
<surname>Gribble</surname>
<given-names>Paul L.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Western Institute for Neuroscience, University of Western Ontario</institution>, Ontario, <country>Canada</country></aff>
<aff id="a2"><label>2</label><institution>Department of Psychology, University of Western Ontario</institution>, Ontario, <country>Canada</country></aff>
<aff id="a3"><label>3</label><institution>Department of Physiology &amp; Pharmacology, Schulich School of Medicine &amp; Dentistry, University of Western Ontario</institution>, Ontario, <country>Canada</country></aff>
<aff id="a4"><label>4</label><institution>Robarts Research Institute, University of Western Ontario</institution>, Ontario, <country>Canada</country></aff>
<aff id="a5"><label>5</label><institution>Haskins Laboratories</institution>, New Haven CT, <country>USA</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Gallego</surname>
<given-names>Juan Alvaro</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Imperial College London</institution>
</institution-wrap>
<city>London</city>
<country>United Kingdom</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Makin</surname>
<given-names>Tamar R</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Cambridge</institution>
</institution-wrap>
<city>Cambridge</city>
<country>United Kingdom</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>6</label>Correspondence should be addressed to Olivier Codol at <email>codol.olivier@gmail.com</email>.</corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-06-23">
<day>23</day>
<month>06</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP88591</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-04-27">
<day>27</day>
<month>04</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-02-23">
<day>23</day>
<month>02</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.02.17.528969"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Codol et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Codol et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-88591-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Artificial neural networks (ANNs) are a powerful class of computational models for unravelling neural mechanisms of brain function. However, for neural control of movement, they currently must be integrated with software simulating biomechanical effectors, leading to limiting impracticalities: (1) researchers must rely on two different platforms and (2) biomechanical effectors are not generally differentiable, constraining researchers to reinforcement learning algorithms despite the existence and potential biological relevance of faster training methods. To address these limitations, we developed MotorNet, an open-source Python toolbox for creating arbitrarily complex, differentiable, and biomechanically realistic effectors that can be trained on user-defined motor tasks using ANNs. MotorNet is designed to meet several goals: ease of installation, ease of use, a high-level user-friendly API, and a modular architecture to allow for flexibility in model building. MotorNet requires no dependencies outside Python, making it easy to get started with. For instance, it allows training ANNs on typically used motor control models such as a two joint, six muscle, planar arm within minutes on a typical desktop computer. MotorNet is built on TensorFlow and therefore can implement any network architecture that is possible using the TensorFlow framework. Consequently, it will immediately benefit from advances in artificial intelligence through TensorFlow updates. Finally, it is open source, enabling users to create and share their own improvements, such as new effector and network architectures or custom task designs. MotorNet’s focus on higher order model and task design will alleviate overhead cost to initiate computational projects for new researchers by providing a standalone, ready-to-go framework, and speed up efforts of established computational teams by enabling a focus on concepts and ideas over implementation.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Fixed a typo on author name.</p></fn>
</fn-group>
<fn-group content-type="external-links">
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://oliviercodol.github.io/MotorNet/build/html/index.html">https://oliviercodol.github.io/MotorNet/build/html/index.html</ext-link>
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<label>1.</label>
<title>Introduction</title>
<p>Research on the neural control of movement has a long and fruitful history of complementing empirical studies with theoretical work (<xref ref-type="bibr" rid="c31">Lindsay, 2021</xref>). Consequently, a wide variety of computational model classes have been proposed to explain empirical observations, such as equilibrium point control (<xref ref-type="bibr" rid="c13">Feldman &amp; Levin, 1995</xref>; <xref ref-type="bibr" rid="c15">Flanagan et al., 1993</xref>; <xref ref-type="bibr" rid="c21">Gribble &amp; Ostry, 2000</xref>; <xref ref-type="bibr" rid="c61">Won &amp; Hogan, 1995</xref>), optimal control (<xref ref-type="bibr" rid="c51">Shadmehr &amp; Krakauer, 2008</xref>; <xref ref-type="bibr" rid="c55">Todorov, 2004</xref>), and parallel distributed processing models (<xref ref-type="bibr" rid="c14">Fetz, 1993</xref>; <xref ref-type="bibr" rid="c19">Gomi &amp; Kawato, 1993</xref>; <xref ref-type="bibr" rid="c23">Jordan &amp; Rumelhart, 1992</xref>; <xref ref-type="bibr" rid="c30">Lillicrap &amp; Scott, 2013</xref>), commonly known as artificial neural networks (ANNs). Although ANNs were formalized many decades ago, they gained in popularity only recently following their rise to prominence in machine learning (ML; <xref ref-type="bibr" rid="c27">LeCun et al., 2015</xref>), as their greater explanatory power and biological realism provide significant advantages against alternative model classes (<xref ref-type="bibr" rid="c17">Gershman &amp; Ölveczky, 2020</xref>; <xref ref-type="bibr" rid="c28">Lillicrap et al., 2019</xref>; <xref ref-type="bibr" rid="c43">Richards et al., 2019</xref>; <xref ref-type="bibr" rid="c45">Saxe et al., 2021</xref>).</p>
<p>For neural control of movement, production of theoretical work using ANN models may be viewed as a two-step effort: (1) building a realistic simulation environment that mimics the behaviour of bodily effectors – often called the “physical plant” – and (2) implement the ANN controllers themselves to train on the environment. Many open-source platforms achieve each of these steps individually, such as MuJoCo (<xref ref-type="bibr" rid="c56">Todorov et al., 2012</xref>) or OpenSim (<xref ref-type="bibr" rid="c10">Delp et al., 2007</xref>; <xref ref-type="bibr" rid="c49">Seth et al., 2018</xref>) for building effectors, and JAX, PyTorch or TensorFlow for building and training controller ANNs. However, approaches using these platforms lead to two important impracticalities.</p>
<p>First, the user must rely on two different software platforms, one for the effector and one for the controller. Communication between platforms is not built-in, requiring users to produce custom code to link the ANN controller software with the software implementing the simulation of the physical plant. This forces significant overhead cost to initiate computational projects and creates barriers to research teams who lack the technical background to build those custom pipelines. A current remedy to this issue is <italic>gym</italic> (<xref ref-type="bibr" rid="c4">Brockman et al., 2016</xref>), a Python toolbox that provides an interface between controllers and environments.</p>
<p>However, <italic>gym</italic> constrains the user to reinforcement learning algorithms (<xref ref-type="bibr" rid="c16">Fujimoto et al., 2018</xref>; <xref ref-type="bibr" rid="c28">Lillicrap et al., 2019</xref>; <xref ref-type="bibr" rid="c36">Mnih et al., 2015</xref>) despite the existence and potential biological relevance of faster training methods such as backpropagation (<xref ref-type="bibr" rid="c29">Lillicrap et al., 2020</xref>; <xref ref-type="bibr" rid="c58">Whittington &amp; Bogacz, 2017</xref>). The inability to use backpropagation to train controllers represents the second impracticality. To date, this has been circumvented by training separate ANNs such as multi-layer perceptrons or recurrent neural networks (RNNs) as “forward models” approximating the behaviour of effectors that are normally implemented in a separate software package (e.g., <xref ref-type="bibr" rid="c30">Lillicrap &amp; Scott, 2013</xref>; <xref ref-type="bibr" rid="c60">Willett et al., 2021</xref>). This approach does not address the need for custom pipelines, and remains a slow, cumbersome process when iterating over many different controllers and effectors, because new approximator ANNs must be trained each time.</p>
<p>Solving the issues described above requires both the controller and effector to rely on the same software (no-dependency requirement), and for the effector to allow for backpropagation through itself (differentiability requirement) so that typical gradient-based algorithms may be employed. Ideally, the solution would also be open source, modular for flexibility of coding and focus on ideas, and have reasonable training speeds on commercially available computers.</p>
<p>We developed MotorNet with these principles in mind. MotorNet is a freely available open-source Python toolbox (<ext-link ext-link-type="uri" xlink:href="https://github.com/OlivierCodol/MotorNet">https://github.com/OlivierCodol/MotorNet</ext-link>) that allows for the training of ANNs to control arbitrarily complex and biomechanically realistic effectors to perform user-defined motor tasks. The toolbox requires no dependency besides standard Python toolboxes available on <italic>pip</italic> or Anaconda libraries. This greatly facilitates its use on remote computing servers as no third-party software needs to be installed. The effectors are fully differentiable, enabling fast and efficient training of ANNs using standard gradient-based methods. It is designed with ease of installation and ease of use in mind, with a high-level, documented, and user-friendly application programming interface (API). Its programming architecture is modular to allow for flexibility in model building and task design. Finally, MotorNet is built on TensorFlow, which makes innovation in machine learning readily available for use by MotorNet as they are implemented and released by TensorFlow.</p>
</sec>
<sec id="s2">
<label>2.</label>
<title>Results</title>
<sec id="s2a">
<label>2.1.</label>
<title>Training an ANN to perform a centre-out reaching task against a curl field</title>
<p>A canonical experimental paradigm in the study of neural control of movement is the centre-out reaching task with a “curl field” applied at the arm’s end point by a robot arm (<xref ref-type="bibr" rid="c9">Conditt et al., 1997</xref>; <xref ref-type="bibr" rid="c52">Shadmehr &amp; Mussa-Ivaldi, 1994</xref>). In this paradigm, visual targets are placed around a central starting position in a horizontal plane. Participants must move the handle of a robot arm from the starting position to the target that appears on a given trial. During the reaching movement, the robot applies forces at the handle that scale linearly with the velocity of the hand and push in a lateral direction. This leads the central nervous system to adapt by modifying neural control signals to muscles to apply opposite forces to counter-act and nullify the lateral forces produced by the robot. Finally, removal of the curl field leaves an opposite after-effect (<xref ref-type="bibr" rid="c52">Shadmehr &amp; Mussa-Ivaldi, 1994</xref>). This paradigm is well suited to assess the functionality of MotorNet because it is well understood and extensively documented, and highlights physical, biomechanical, and control properties of human behaviour.</p>
<p>We specified a one-layer RNN composed of 50 gated recurrent units (GRUs; <xref ref-type="bibr" rid="c6">Cho et al., 2014</xref>) to control a two degrees of freedom, six muscle planar arm model (<italic>arm26</italic>; <xref rid="fig1" ref-type="fig">Figure 1a</xref>; <xref ref-type="bibr" rid="c25">Kistemaker et al., 2006</xref>, <xref ref-type="bibr" rid="c26">2010</xref>). The muscles were rigid-tendon, Hill-type muscle models, with “shoulder” mono-articular flexors/extensors, “elbow” mono-articular flexors/extensors, and a bi-articular pair of muscles producing flexion or extension at both joints (see Methods <xref ref-type="sec" rid="s4a1">section 4.1.1</xref> and <xref ref-type="sec" rid="s4b1">4.2.1</xref>.).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Controlling an arm-like effector in a centre-out reaching task with a curl field.</title>
<p><bold>(a)</bold> Schematic of the effector and controller. <bold>(b)</bold> Endpoint trajectories of centre-out reaching movements in a null and curl field, for an RNN controller that is untrained (naive) and then trained to reach in that curl field. The effector was as defined in <xref ref-type="bibr" rid="c26">Kistemaker et al. (2010)</xref> <bold>(c)</bold> Different variables over time during a rightward reaching movement.</p></caption>
<graphic xlink:href="528969v3_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Training the model above took about 13 minutes on a 2022 Mac Studio with an M1 Max central processing unit (Apple Inc., Cupertino CA, USA). Because the <italic>arm26</italic> effector and the centre-out reaching task are particularly common in the motor control literature, they are included in the toolbox as pre-built objects. Consequently, one can recreate the effector instance and task instance in one line of code for each. Note however that users can easily declare their own custom-made effector and task objects if desired by subclassing the base <italic>Plant</italic> and <italic>Task</italic> class, respectively (see below for more details on base classes and subclassing).</p>
<p>Including the implementation of the controller RNN and training routine, the above example can be reproduced in 10 lines of code, illustrating the ease of use of MotorNet’s API. Once the model is trained, it can produce validation results via a forward pass (<xref rid="fig1" ref-type="fig">Figure 1b-c</xref>), which can then be saved and analysed afterwards. The results the model produces include joint and cartesian states (positions, velocities), muscle states (lengths, velocities, activations, contributing forces), musculo-tendon states (lengths, velocities), efferent motor commands (time-varying muscle stimulation) and afferent feedback responses (proprioceptive, visual), as well as any activity states from the network if applicable (<xref rid="fig1" ref-type="fig">Figure 1c</xref>). Note that motor commands are different from muscle activations, in that they are input signals to the Ordinary Differential Equation that produces muscle activation (see Methods; <xref ref-type="bibr" rid="c35">Millard et al., 2013</xref>; <xref ref-type="bibr" rid="c54">Thelen, 2003</xref>).</p>
</sec>
<sec id="s2b">
<label>2.2.</label>
<title>Structure of MotorNet</title>
<p>Functionally, a MotorNet model can be viewed as an ANN acting as a controller, that sends motor commands to an effector (the plant), which is actuated accordingly and in turn sends feedback information back to the ANN (<xref rid="fig2" ref-type="fig">Figure 2</xref>). This closed-loop cycle repeats for each timestep. By default, “visual” feedback consists of a vector indicating endpoint cartesian coordinates, while “proprioceptive” feedback consists of a 2<italic>m</italic>-elements vector of muscle length and velocity, with <italic>m</italic> the number of muscles of the effector. Noise may be added in various parts of the model, such as on network activity, on descending motor commands, or on feedback signals. Finally, time delays may be added to feedback signals before they reach the controller ANN.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Conceptual organization of a MotorNet model.</title>
<p>An ANN receives arbitrary input as well as recurrent connections from itself, and sends motor command outputs to an effector, which in turn sends sensory feedback information. Typically, this feedback will be visual and proprioceptive, and can contain feedback-specific time delays Δ<sub>p</sub> and Δ<sub>v</sub>. Gaussian noise can be added to the recurrent connection, motor commands, and proprioceptive and visual feedback, with specific standard deviation σ<sub>h</sub>, σ <sub>u</sub>, σ <sub>p</sub>, and σ <sub>v</sub>.</p></caption>
<graphic xlink:href="528969v3_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s2b1">
<label>2.2.1.</label>
<title>Running flow</title>
<p>At runtime, a more detailed representation of the information flow best describes how a MotorNet model behaves (<xref rid="fig3" ref-type="fig">Figure 3a</xref>). Models are based on five object classes: <italic>Skeleton, Muscle, Plant, Network</italic>, and <italic>Task</italic> objects (<xref rid="tbl1" ref-type="table">Table 1</xref>). Each object has its own base class, from which the user can create a custom subclass if desired. MotorNet comes with a set of pre-built subclasses for each, which implement commonly used computational model formalizations (<xref rid="tbl1" ref-type="table">table 1</xref>).</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>Overview of Python base classes and their respective pre-built subclasses in MotorNet. GRU: Gated Recurrent Unit.</p></caption>
<graphic xlink:href="528969v3_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><title>Implementation of MotorNet.</title>
<p><bold>(a)</bold> Information flow of a MotorNet model during runtime.</p>
<p><bold>(b)</bold> Declarative structure of a MotorNet object. Each object instance is held in memory as an attribute of another according to this hierarchical representation, except for the Muscle, and Skeleton instances.</p></caption>
<graphic xlink:href="528969v3_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p><italic>Network</italic> objects are the entry point of the model (<xref rid="fig3" ref-type="fig">Figure 3a</xref>). They take arbitrary initial inputs, which may then be recomputed at each timestep to adjust for dynamic information via crosstalk with the <italic>Task</italic> object. This step is optional, and can be used for changes that occur online, such as a cursor or a target jump, or a new target appearing in a sequential task. The (potentially recomputed) inputs are then passed to the ANN to perform a forward pass, producing motor commands that are sent down to the <italic>Plant</italic> object.</p>
<p><italic>Plant</italic> objects are essentially wrapper objects that hold the <italic>Muscle</italic> and <italic>Skeleton</italic> objects and handle coordination of information flow between them (<xref rid="fig3" ref-type="fig">Figure 3a-b</xref>), as well as concomitant numerical integration to ensure numerical stability. They pass the motor commands to the <italic>Muscle</italic> object, which produces forces in return. The <italic>Plant</italic> will adjust those forces using geometry-dependent moment arms (see <xref ref-type="sec" rid="s2c">section 2.3</xref> for details) and send the resulting generalized forces to the <italic>Skeleton</italic> object. These generalized forces will actualize the <italic>Skeleton</italic>’s joint state, which the <italic>Skeleton</italic> will return to the <italic>Plant</italic> object alongside the equivalent cartesian state. Finally, the <italic>Plant</italic> object will return proprioceptive and visual feedback signals to the <italic>Network</italic>.</p>
</sec>
<sec id="s2b2">
<label>2.2.2.</label>
<title>Object structure</title>
<p>The classes presented above rely on each other to function correctly. Consequently, they must be declared in a sensible order, so that each object instance retains as attribute the object instances on which they rely. This leads to a hierarchical class structure, where each instance lives in the computer memory in a nested fashion with other instances, as laid out in <xref rid="fig3" ref-type="fig">Figure 3b</xref>. Note that this does not mean that each class is a subclass of the class that contains it, but that each contained class is saved as an attribute of the container class. The outermost class is a MotorNetModel, which itself is a subclass of TensorFlow’s Model class.</p>
</sec>
</sec>
<sec id="s2c">
<label>2.3.</label>
<title>Biomechanical properties of the plant</title>
<p>The modular structure detailed above allows MotorNet to flexibly compute detailed biomechanical properties of <italic>Plant</italic> objects, such as arbitrary muscle paths (<xref ref-type="bibr" rid="c38">Nijhof &amp; Kouwenhoven, 2000</xref>), geometry-dependent moment arms (<xref ref-type="bibr" rid="c37">Murray et al., 1995</xref>; <xref ref-type="bibr" rid="c53">Sherman et al., 2013</xref>), non-linear muscle activations and passive force production from muscle stretch (<xref ref-type="bibr" rid="c5">Cheng &amp; Scott, 2000</xref>; <xref ref-type="bibr" rid="c35">Millard et al., 2013</xref>; <xref ref-type="bibr" rid="c54">Thelen, 2003</xref>). This enables training ANNs on motor tasks whose dynamics are highly non-linear and close to biological reality. In this section we outline some examples of biomechanical properties displayed by MotorNet effectors.</p>
<sec id="s2c1">
<label>2.3.1.</label>
<title>Assessing moment arms with a simple point-mass plant</title>
<p>The geometrical path – fixation body(s) and fixation point(s) on that body – of each Muscle object can be declared by the user, allowing for arbitrary linkage between muscles and bones (see Methods <xref ref-type="sec" rid="s4c">section 4.3</xref>, <xref ref-type="bibr" rid="c38">Nijhof &amp; Kouwenhoven, 2000</xref>). Using geometric first principles (<xref ref-type="bibr" rid="c53">Sherman et al., 2013</xref>), the <italic>Plant</italic> object can then calculate the moment arm of forces produced, which is defined for each muscle as the change in value of the degrees of freedom (DoF) of the skeleton for a given change in the muscle’s length (<xref ref-type="bibr" rid="c37">Murray et al., 1995</xref>; <xref ref-type="bibr" rid="c53">Sherman et al., 2013</xref>). In lay terms, this is the capacity of a muscle to produce a torque on a joint based on the muscle’s pulling angle on the bones forming that joint. The relationship between pull angle and torque can intuitively be understood using a door as an example: it is easier to push a door when pushing with an angle orthogonal to that door than in a near-parallel angle to that door.</p>
<p>Moment arms generally vary depending on the positional configuration of the Plant. To illustrate this, let us consider a simple case of a point-mass skeleton (one fixation body) with four muscles attached to it in a “X” configuration (<xref rid="fig4" ref-type="fig">Figure 4a</xref>). When the point-mass is positioned in the centre of the workspace space (red position in <xref rid="fig4" ref-type="fig">Figure 4a-b</xref>), any muscle pulling will change the position of the point-mass equally in the <italic>x</italic> dimension and in the <italic>y</italic> dimension. Note that <italic>x</italic> and <italic>y</italic> are the DoFs of the point-mass skeleton since they do not have hinge joints. In contrast, if the point-mass is positioned below the central position (<italic>x</italic> = 0, <italic>y</italic> = −0.9; black position in <xref rid="fig4" ref-type="fig">Figure 4a</xref>), a pull from e.g., the lower left muscle will produce a greater change in the <italic>x</italic> dimension than in the <italic>y</italic> dimension because of the different muscle alignment (<xref rid="fig4" ref-type="fig">Figure 4b</xref>).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><title>Geometrical properties of a Plant object.</title>
<p><bold>(a)</bold> Schematic of a point-mass in two positional configurations within a square workspace. The point-mass Skeleton was linked to four muscles in a “X” configuration. <bold>(b)</bold> Moment arm values for each of the positional configurations represented in (a), with respect to x and y. <bold>(c)</bold> Complete moment arm function over the position space for each muscle (columns) and with respect to each DoF. The upper and lower row indicate the moment arm with respect to the x and y position, respectively. <bold>(d)</bold> Moment arms of a mono-articular extensor muscle on an arm26. <bold>(e)</bold> Moment arms of a bi-articular flexor muscle on an arm26. <bold>(f)</bold> Passive drift in endpoint position of an arm26 similar to Figure 1c due to passive force developed by overstretch Hill-type muscles.</p></caption>
<graphic xlink:href="528969v3_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The moment arm can then be calculated for all possible positions in the workspace, as represented by the solid black square in <xref rid="fig4" ref-type="fig">Figure 4a</xref>. This can be done for each of the four muscles, and each of the two DoFs, resulting in 8 moment arms (<xref rid="fig4" ref-type="fig">Figure 4c</xref>). We can see that each moment arm forms a slightly bent hyperplane. Importantly, for each hyperplane the diagonal with constant moment arm lines up with the path formed by the muscle when the point mass is at the centre of the workspace. For instance, the moment arm of the upper right muscle is identical when the point-mass is in position (<italic>x</italic> = 1, <italic>y</italic> = 1) and in position (−1, −1). This is true both with respect to the <italic>x</italic> DoF (<xref rid="fig4" ref-type="fig">Figure 4c</xref>, upper row, leftmost axis) and with respect to the <italic>y</italic> DoF (<xref rid="fig4" ref-type="fig">Figure 4c</xref>, lower row, leftmost axis). Note also that muscles whose shortening leads to an increase in the DoF considered – or inversely whose lengthening leads to a decrease in the DoF – express negative moment arms. For instance, a shortening of the lower right muscle would lead to an increase in the <italic>x</italic> DoF and a decrease in the <italic>y</italic> DoF. Or more plainly, a pull from the lower right muscle would bring the point-mass closer to the lower right corner of the workspace. This leads to the negative moment arm of that muscle with respect to <italic>x</italic> (<xref rid="fig4" ref-type="fig">Figure 4c</xref>, upper row) and positive moment arm with respect to <italic>y</italic> (lower row).</p>
</sec>
<sec id="s2c2">
<label>2.3.2.</label>
<title>Moment arms with a two-joint arm</title>
<p>To consider a more complex plant, we assessed the moment arm of two muscles wrapping around a two-joint arm skeleton. We first assessed a mono-articular muscle, that is, a muscle that spans only one joint – here, the elbow. As expected, the moment arm of that muscle with respect to the shoulder joint is always null (black arrows, <xref rid="fig4" ref-type="fig">Figure 4d</xref>) regardless of the joint configuration since the muscle does not span that joint. In contrast, the moment arm with respect to the elbow joint varies as the elbow joint angle changes. Finally, as expected from an extensor muscle, the moment arm is positive, indicating that the elbow angle would decrease as the muscle shortens.</p>
<p>In comparison, a bi-articular muscle’s moment arm is non-zero with respect to both joints (<xref rid="fig4" ref-type="fig">Figure 4e</xref>). This also leads the moment arms with respect to each joint to show a small interaction as the other joint’s angle changes, as indicated by a slight “bend” in the hyperplane (black arrows, <xref rid="fig4" ref-type="fig">Figure 4e</xref>). Finally, as expected for a bi-articular flexor muscle, the moment arms are negative with respect to both joints, indicating that muscle shortening would result in an increase in joint angle.</p>
</sec>
<sec id="s2c3">
<label>2.3.3.</label>
<title>Passive drift with Hill-type muscles</title>
<p>Finally, we assessed the positional drift induced by passive forces of Hill-type muscle models (<xref ref-type="bibr" rid="c35">Millard et al., 2013</xref>; <xref ref-type="bibr" rid="c54">Thelen, 2003</xref>) in an <italic>arm26</italic> plant model. We initialized the model’s starting position at fixed intervals across the range of possible joint angles, resulting in a grid of 21-by-21 possible starts. We then simulated the plant with null inputs for 200 ms and plotted the drift in the arm’s endpoint position from its original position. Because the model received no input, all forces produced are due to the passive component of the Hill-type muscles, which occurs when the muscle is stretched beyond its slack length (<xref ref-type="bibr" rid="c5">Cheng &amp; Scott, 2000</xref>; <xref ref-type="bibr" rid="c35">Millard et al., 2013</xref>; <xref ref-type="bibr" rid="c54">Thelen, 2003</xref>). We can see that drift is negligible at the centre of the joint space but starts to increase toward the edge (<xref rid="fig4" ref-type="fig">Figure 4f</xref>), indicating that the associated joint configurations lead to overstretched muscle lengths and resulting in passive force production. Note that since this phenomenon is dependent on the slack length value of each muscle, which is user-defined, the presence of passive drift is dependent on the user’s modelling choices.</p>
</sec>
</sec>
<sec id="s2d">
<label>2.4.</label>
<title>Training ANNs to produce naturalistic behaviour</title>
<p>Now that we can implement biomechanically complex plants, we next assessed whether a controller ANN can learn a control policy to move those plants using backpropagation (<xref ref-type="bibr" rid="c23">Jordan &amp; Rumelhart, 1992</xref>; <xref ref-type="bibr" rid="c44">Rumelhart et al., 1986</xref>). A typical way to ensure the computation learnt by an ANN is functionally meaningful is to test its out-of-distribution generalization. To assess this, we trained a 1-layer RNN with <italic>n</italic> = 110 GRUs controlling an <italic>arm26</italic> model to perform reaching movements in 0.8 sec simulations using the following paradigm. Starting positions and targets were randomly drawn from a uniform distribution across the full joint space. Movements were to be delayed until the occurrence of a visual “go” cue randomly drawn from a uniform distribution spanning the full simulation window. The appearance of the go cue reached the RNN as input after a delay corresponding to the visual feedback delay, which was set at Δ<sub><italic>v</italic></sub> = 50 ms (<xref rid="fig2" ref-type="fig">Figure 2</xref>; <xref ref-type="bibr" rid="c11">Dimitriou et al., 2013</xref>; <xref ref-type="bibr" rid="c40">Pruszynski et al., 2010</xref>). In half of trials, no go cue was provided (catch trial), in which case the task effectively reduced to a postural control task. A 100 ms endpoint mechanical perturbation, whose orientation, magnitude, and time were also randomly drawn occurred in half of trials, independently of whether the trial was a catch trial or not. Importantly, the perturbation magnitude was drawn from a uniform distribution ranging between 0 and 4 N. If the perturbation occurred during a catch trial, the distribution ranged between 0 and 8 N.</p>
<p>The network was trained using the following loss:
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="528969v3_eqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
With <italic>L</italic> the global loss including a kernel regularization term with penalty coefficient λ = 10<italic>e</italic><sup>−6</sup>, and <bold><italic>W</italic></bold> the kernel weight matrix of the RNN’s hidden layer. The operators ‖ · ‖<sub>1</sub> and ‖ · ‖<sub>2</sub> indicate the L1 and L2 vector norm, respectively. <italic>L</italic><sub><italic>t</italic></sub> is the instantaneous loss at time <italic>t</italic>, with coefficients <italic>α</italic> = 2, <italic>β</italic> = 5, <italic>γ</italic> = 0.1. <inline-formula><alternatives><inline-graphic xlink:href="528969v3_inline1.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is the positional penalty at time <italic>t</italic>, with <bold><italic>x</italic></bold><sub><italic>t</italic></sub>, <inline-formula><alternatives><inline-graphic xlink:href="528969v3_inline2.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> the position and desired position (target) vector, respectively, and <italic>r</italic> = 0.01 the target radius. <inline-formula><alternatives><inline-graphic xlink:href="528969v3_inline3.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>is the muscle activation penalty at time <italic>t</italic>, with <bold><italic>u</italic></bold><sub><italic>t</italic></sub>, <bold><italic>f</italic></bold> two vectors representing muscle activations at time <italic>t</italic> and maximum isometric force, respectively. Finally, <inline-formula><alternatives><inline-graphic xlink:href="528969v3_inline4.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is the network hidden activity penalty at time <italic>t</italic>, with <bold><italic>h</italic></bold><sub><italic>t</italic></sub> the <italic>n</italic>-elements vector of GRU hidden activity, <inline-formula><alternatives><inline-graphic xlink:href="528969v3_inline5.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> its time derivative, and <italic>k</italic> = 0.05. While superficially this loss appears complex, a direct relationship to biology can be drawn for all terms. Essentially, this loss enforces the control policy to be learned using a simple, straightforward rule (“get to the target”), while promoting low metabolic cost from network input connectivity (cost on kernel norm), from the muscles (cost on activation, scaled by muscle strength), and from network activity (cost on hidden activity and its derivative to discourage oscillatory regimes).</p>
<p>Behavioural performance on a training set can be seen in <xref rid="fig5" ref-type="fig">Figure 5a</xref>, with trials with a large perturbation (&gt; 3 <italic>N</italic>) highlighted in blue. This illustrates the rich variability of the training set, encouraging the RNN to learn computationally potent and generalizable solutions to the control problem given the sensorimotor feedback provided (<xref rid="fig2" ref-type="fig">Figure 2</xref>). Despite this variability, the loss value decreased smoothly (<xref rid="fig5" ref-type="fig">Figure 5b</xref>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><title>A MotorNet model can learn a control policy that generalizes to out-of-distribution perturbations.</title>
<p><bold>(a)</bold> Behavioural outputs to a training set input sample after training. <bold>(b)</bold> Loss function over training iterations, with a batch size of 1024. <bold>(c)</bold> Trajectories in a centre-out reaching task with mechanical perturbations applied at the arm’s endpoint 120 ms after the “go” cue. The perturbations were orthogonal to the reaching axis passing from the starting position to the target. o.o.d.: out of distribution. <bold>(d)</bold> Same as (c) for a postural control task. In this task, the network was not provided with a target and therefore only had to remain in the starting position against the perturbations. Mechanical perturbations were in the vertical (left) or horizontal (right) axis. <bold>(e)</bold> Muscle activation over time for two trajectories in (c) (black and blue lines) and a trajectory in (g) (green line). BE: bi-articular extensor. BF: bi-articular flexor. EE: elbow extensor. EF: elbow flexor. SE: shoulder extensor. SF: shoulder flexor. <bold>(f)</bold> Reaching task as in (c) for a network never exposed to mechanical perturbations during training. <bold>(g)</bold> Postural task as in (d) for the same network as in (f). Perturbations were in the vertical (top) or horizontal (bottom) axis.</p></caption>
<graphic xlink:href="528969v3_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We tested the model’s behavioural output in 0.8 sec simulations with a centre-out reaching task. Eight targets were positioned in 45 degrees increments and 10 cm away from a starting position corresponding to a shoulder and elbow angle of 45 and 90 degrees, respectively (<xref rid="fig5" ref-type="fig">Figure 5c</xref>). The RNN reached to each of these targets following a visual go cue at 100 ms. 70 ms after the “go” cue was “perceived” (i.e., 70 ms plus the visual feedback delay), a mechanical perturbation was applied at the arm’s endpoint and orthogonally to the reaching direction. This perturbation could be either within-distribution (±3 N) or out-of-distribution (±6 N) or null (no perturbation). In all cases, the RNN could correct for the mechanical perturbation, reach to the target, and stabilize (<xref rid="fig5" ref-type="fig">Figure 5c</xref>).</p>
<p>Next, we tested the RNN in a postural control task, where it had to bring the arm’s endpoint back to the target following a mechanical perturbation (<xref ref-type="bibr" rid="c41">Pruszynski et al., 2014</xref>). No go cue was provided. We applied perturbations in either of the four cardinal directions (0°, 90°, 180°, 270°) at 170 ms plus visual delay after the trial started. Again, the set of perturbations for testing outputs included within-distribution magnitudes (±6 N) and out-of-distribution magnitudes (±12 N). In all cases, the RNN could integrate the sensorimotor information to bring the arm’s endpoint back into the target (<xref rid="fig5" ref-type="fig">Figure 5d</xref>). Interestingly, in some cases this led to an oscillatory trajectory (e.g., for a rightward +12 N perturbation, <xref rid="fig5" ref-type="fig">Figure 5d</xref>), indicating that perturbations beyond a given magnitude remain increasingly challenging to control for.</p>
<p>Finally, we compared muscle activations for an upward reach with no perturbation to that of an identical reach with a -6 N perturbation (<xref rid="fig5" ref-type="fig">Figure 5e</xref>). We can see that muscle activations are similar before the occurrence of the perturbation, and remain similar immediately after, indicating a time delay in the response. The fastest responses occurred for the bi-articular muscles and the shoulder extensor muscle. Other muscles, particularly the shoulder flexor, showed very delayed or non-existent changes in muscle activation. This illustrates that the RNN’s response to a perturbation is not a mere stimulus-driven reactive response, but an integrated response that can delay or withhold the production of counteracting forces if necessary. Note that for the non-perturbed movement (black line in <xref rid="fig5" ref-type="fig">Figure 5e</xref>), we can observe the canonical tri-phasic muscle activation pattern reported in empirical studies (<xref ref-type="bibr" rid="c59">Wierzbicka et al., 1986</xref>).</p>
<p>To assess how the existence of sensorimotor feedback impacted the control policy acquired by the controller network, we trained a second, identical network to perform the same task but with no mechanical perturbation during training (perturbation-free). Interestingly, following the same amount of training, the model with a perturbation-free network can handle perturbations during reaching relatively well, even up to ±6 N (<xref rid="fig5" ref-type="fig">Figure 5f</xref>). We can compare muscle activations for an upward reach with a -6 N perturbation to that of the same movement in the network trained with perturbations (<xref rid="fig5" ref-type="fig">Figure 5f</xref>, green versus blue lines). Even though kinematics appeared superficially similar (<xref rid="fig5" ref-type="fig">Figure 5c, f</xref>), this comparison shows that muscle activations tend to differ in response to a perturbation (<xref rid="fig5" ref-type="fig">Figure 5e</xref>), suggesting that the perturbation-free network might learn a slightly different control policy. Testing the perturbation-free network on the postural task shown in <xref rid="fig5" ref-type="fig">Figure 5d</xref> emphasizes this difference (<xref rid="fig5" ref-type="fig">Figure 5g</xref>). The perturbation-free network is much less capable of stabilizing against the forces than its perturbation-trained counterpart.</p>
<p>Therefore, even though the mere existence of a sensorimotor feedback input can help handle simple perturbations (<xref rid="fig5" ref-type="fig">Figure 5f</xref>), exposing the model to perturbations during training does provide the network with additional information to learn a more robust control policy. Overall, these simulations show that MotorNet can train ANNs to reliably find a control policy for the plant. Importantly, the resulting networks learn generalizable control policies that integrate sensorimotor feedback into its computation. This also illustrates the importance of the training procedure to which the network is exposed to produce these control policies (<xref ref-type="bibr" rid="c12">Driscoll et al., 2022</xref>).</p>
</sec>
<sec id="s2e">
<label>2.5.</label>
<title>Plant Geometry Defines Preference Distribution of Firing Rates: A Replication Study</title>
<p>Finally, to assess MotorNet’s capacity to replicate established results in the literature, we sought to reproduce key observations from <xref ref-type="bibr" rid="c30">Lillicrap and Scott (2013)</xref>. In that study, the authors show that training an RNN to perform a simple centre-out reaching task using an arm model similar to the arm26 in <xref rid="fig1" ref-type="fig">Figure 1a</xref> results in the RNN neurons displaying a preferential movement direction (PMD) where they are more likely to fire. The distribution of PMDs was asymmetrical, with a greater proportion of neurons firing for reaches around 135 degrees and 325 degrees, matching empirical observations from non-human primate electrophysiological recordings in the primary motor cortex (<xref ref-type="bibr" rid="c46">Scott et al., 2001</xref>). Next, they showed that this asymmetrical representation of PMDs during reaching movements did not occur when RNNs were trained to control a plant that lacked the geometrical properties of an arm. Specifically, they compared the PMD distribution of RNN neurons controlling a point-mass (no geometry) against that of an arm26 (geometry present).</p>
<p>We sought to reproduce the two results outlined above. First, we trained an RNN composed of 90 GRUs in a single layer to control for an arm26 (<xref rid="fig6" ref-type="fig">Figure 6a</xref> see Methods <xref ref-type="sec" rid="s4e">section 4.5</xref>.).Because our RNN employs GRUs instead of a multi-layer perceptron, 90 units were sufficient to efficiently train the network to perform the task, as opposed to up to 1000 perceptron nodes in the original study. We also increased the number of targets from 8 to 24 to obtain a finer resolution over movement direction in our analyses (<xref rid="fig6" ref-type="fig">Figure 6b</xref>).</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><title>The distribution of preferential movement direction tuning is sensitive to the geometry of the plant.</title>
<p><bold>(a)</bold> Schematic of the two models compared. The RNNs and their architecture were identical, but the plant differed, with one RNN controlling a two-joint arm26 (left) and the other controlling a point-mass (right). <bold>(b)</bold> Centre-out reaching trajectories to 24 targets for the arm26 (left) and point-mass (right) model. <bold>(c)</bold> Distribution of preferential movement directions (PMDs) for the arm26 (left) and point-mass (right) model. The PMDs were determined by regression of each GRU’s hidden activity averaged over time against reach angle (see Methods for details). <bold>(d)</bold> Normalized muscle activations across reaching angles and for the 300 ms following the “go” cue for the arm26 model. <bold>(e)</bold> Normalized β coefficients of the regression models used for (c). The GRUs were ordered according to the angle of their maximum β value. Note that the “ridge” of maximum β yields roughly a straight line for the point-mass model, while it yields a crooked line for the arm26, indicative of a representation bias. <bold>(f)</bold> Hidden activity over time and across reaching angles for a random sample of GRUs in the arm26 model.</p></caption>
<graphic xlink:href="528969v3_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Following training, we first ensured that muscle activation patterns in the arm26 plant were like those reported in the original study (<xref rid="fig6" ref-type="fig">Figure 6d</xref>). Regarding network activity, we observed a great variety of activation patterns over movement direction (<xref rid="fig6" ref-type="fig">Figure 6f</xref>). Some GRUs showed a preference for timing (e.g., neuron A4, C5), while others showed a strong preference for reaching direction that was sustained over time (neuron C3, A2). Finally, most neurons showed a mixed preference for encoding time and reaching direction (neuron C8, A8). This heterogeneous set of responses matches empirical observations in non-human primate primary motor cortex recordings (<xref ref-type="bibr" rid="c7">Churchland &amp; Shenoy, 2007</xref>; <xref ref-type="bibr" rid="c33">Michaels et al., 2016</xref>).</p>
<p>We then assessed each GRU’s PMD using linear regression (see methods) and sorted them based on their PMD before plotting the tuning curve of each neuron. The resulting colormap (<xref rid="fig6" ref-type="fig">Figure 6e</xref>, left panel) yields a “ridge” of maximal activity whose peak varies across reach angle, forming a crooked line, illustrating a representational bias. This crooked ridge line was not observed in an RNN trained to control for a point-mass plant instead using an identical training procedure and analysis (<xref rid="fig6" ref-type="fig">Figure 6e</xref>, right panel). We replicated this procedure with 7 more RNNs for each model, resulting in a total of 8 RNNs trained on an arm26 and 8 RNNs trained on a point-mass. We determined each GRU’s PMD and averaged the resulting polar histogram across each RNN (<xref rid="fig6" ref-type="fig">Figure 6c</xref>). The same bias was reproduced invariably for the RNNs controlling an arm26 plant, while it failed to arise for those controlling a point-mass. Therefore, these results mimic the observations made in the original study (<xref ref-type="bibr" rid="c30">Lillicrap &amp; Scott, 2013</xref>), specifically, that RNNs controlling a plant with no arm-like geometrical properties will not result in the biased PMD representation during reaching movements commonly observed in non-human primate electrophysiological studies (<xref ref-type="bibr" rid="c47">Scott &amp; Kalaska, 1997</xref>).</p>
</sec>
</sec>
<sec id="s3">
<label>3.</label>
<title>Discussion</title>
<sec id="s3a">
<label>3.1.</label>
<title>Iterating quickly through the model development cycle</title>
<p>In the field of machine learning, an established best practice is to iterate quickly around a cycle of (1) formulating an idea, (2) implementing that idea in functionally efficient code, and (3) testing the idea through running the simulations. The results of the simulations can then be leveraged to adjust the idea, thus closing the loop, and enabling iterative refinement of a model. This [idea → code → test → idea] cycle is reminiscent of the [hypothesis → design task → test → hypothesis] cycle in empirical work, also known as the hypothetico-deductive method. An important practice in ML is to ensure that one iteration of that cycle is quick enough, because producing an efficient model may require many such iterations. Based on this framework, a way to view MotorNet is as a means to improve iteration speed through this cycle. The modular architecture of MotorNet enables users to alter aspects of the plant model while keeping everything else identical, and TensorFlow’s ability to do the same at the controller level is preserved. Therefore, user capacity to proceed through the “implementation” step is enhanced.</p>
</sec>
<sec id="s3b">
<label>3.2.</label>
<title>Advantages</title>
<sec id="s3b1">
<label>3.2.1.</label>
<title>Expandability</title>
<p>MotorNet naturally allows users to create and tune objects to fit individual requirements. This makes the toolbox easily expandable to add novel models that are not pre-built in the original distribution. This flexibility will likely vary depending on the goal (<xref rid="fig7" ref-type="fig">Figure 7</xref>). Some extensions only require adjusting parameter values of existing object classes, such as editing the Arm26 Skeleton class to match the arm of a non-human primate. Other extensions will require subclassing, such as creating a Plant for an eyeball, which might require special geometric properties building on the point-mass Skeleton object (<xref rid="tbl1" ref-type="table">Table 1</xref>). Conversely, Plants that stray away from typical vertebrate effectors will likely prove more challenging, such as an octopus arm, because they do not rely on bones. Importantly, while all these extensions vary in the difficulty of their implementation, each has the capacity to fit and work harmoniously within the framework of the MotorNet architecture.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7:</label>
<caption><title>MotorNet is expandable.</title>
<p>MotorNet allows for new features to be implemented through subclassing.</p></caption>
<graphic xlink:href="528969v3_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s3b2">
<label>3.2.2.</label>
<title>Open source</title>
<p>Typically, when motor control researchers want to create canonical models, they must implement their own version of said model based on methodological descriptions of previously published scientific articles. However, because MotorNet is open source, individual contributions can easily be shared online for the benefit of others. For instance, if a researcher creates a muscle class with a parametrizable pennation angle (<xref ref-type="bibr" rid="c35">Millard et al., 2013</xref>; <xref ref-type="bibr" rid="c54">Thelen, 2003</xref>), future researchers and team will not have to re-create their own implementation of the same object anymore. This also allows more dynamical peer-checking, avoiding dissemination of errors and improving consistency of model implementations. In other words, MotorNet will be able to benefit from community driven incremental work through open-source practices.</p>
</sec>
<sec id="s3b3">
<label>3.2.3.</label>
<title>Innovation scalability</title>
<p>For the past several years, ML has been standing out as one of the most dynamic research fields, achieving breakthroughs and successfully scaling innovative work toward solving everyday problems. It would be challenging for MotorNet to keep up with the pace of ML innovation to provide users with implementations of the latest architectures and algorithms. Rather, we rely on Google’s TensorFlow to build our own controllers. This ensures that any innovation in model design quickly finds its way to a viable MotorNet implementation, because TensorFlow capabilities allow for fast adaptation aligned with progress in ML. Generally, MotorNet is built with the following logic in mind: anything TensorFlow can build, MotorNet should be able to use as a controller.</p>
</sec>
</sec>
<sec id="s3c">
<label>3.3.</label>
<title>Limitations</title>
<sec id="s3c1">
<label>3.3.1.</label>
<title>Collision physics</title>
<p>Typical biomechanical software distributions implement some form of collision physics in their physics engine (<xref ref-type="bibr" rid="c10">Delp et al., 2007</xref>; <xref ref-type="bibr" rid="c49">Seth et al., 2018</xref>; <xref ref-type="bibr" rid="c56">Todorov et al., 2012</xref>). This is not the case for MotorNet.</p>
</sec>
<sec id="s3c2">
<label>3.3.2.</label>
<title>Complex biomechanical features</title>
<p>Some biomechanical software distributions such as OpenSim propose a large array of joint types such as hinge joints or rotational joints, and complex muscle paths such as wrap points that trigger only when the muscle collides with them (<xref ref-type="bibr" rid="c10">Delp et al., 2007</xref>; <xref ref-type="bibr" rid="c50">Seth et al., 2010</xref>, <xref rid="c49" ref-type="bibr">2018</xref>). While these features increase the realism of a biomechanical model, MotorNet does not yet implement these types of features. In practice, this constrains what types of Plants MotorNet can realistically implement and adding some of these features is under consideration.</p>
</sec>
</sec>
<sec id="s3d">
<label>3.4.</label>
<title>Future considerations</title>
<p>As an open-source, freely available Python toolbox, MotorNet is subject to change over time. Some of the limitations outlined above are considered as future routes for improvement. Additionally, we hope that individual contributions will help refine and extend the capabilities of the toolbox as well. In this section we outline prospective improvements for implementation and release in the main distribution.</p>
<sec id="s3d1">
<label>3.4.1.</label>
<title>Spinal Compartment</title>
<p>It is becoming increasingly evident that spinal contribution plays a prominent role in motor control beyond the typically considered spinal reflex (<xref ref-type="bibr" rid="c42">Reschechtko &amp; Pruszynski, 2020</xref>; <xref ref-type="bibr" rid="c57">Weiler et al., 2019</xref>). To an extent, one may consider that supraspinal control integrates the spinal contribution to define a motor control policy (<xref ref-type="bibr" rid="c32">Loeb, 2021</xref>). Within MotorNet, this suggests that a controller’s dynamics will be significantly impacted by the presence of a spinal compartment acting as an interface with the Plant. Consequently, it may be worthwhile to implement one such spinal compartment to explore the consequences of such biological design (<xref ref-type="bibr" rid="c8">Cisek, 2019</xref>).</p>
</sec>
<sec id="s3d2">
<label>3.4.2.</label>
<title>Modular controllers</title>
<p>A deeply established idea in neuroscience is that distinct regions will perform different computations, and thus that a complex system may not be considered as a uniform, fully connected network (<xref ref-type="bibr" rid="c1">Abbott &amp; Svoboda, 2020</xref>; <xref ref-type="bibr" rid="c24">Keeley et al., 2020</xref>; <xref ref-type="bibr" rid="c39">Pesaran et al., 2021</xref>; <xref ref-type="bibr" rid="c48">Semedo et al., 2020</xref>). This is also true for the motor control system, where using a modular network architecture with controlled communication between each module has been shown to have more explanatory power than a non-modular system (<xref ref-type="bibr" rid="c34">Michaels et al., 2020</xref>). Therefore, a potential development for MotorNet is to include a model class with a modular architecture to study how cross-regions networks work to enable neural control of the body.</p>
</sec>
<sec id="s3d3">
<label>3.4.3.</label>
<title>Muscle models</title>
<p>Most published work in motor control relies either on Hill-type muscle models (<xref ref-type="bibr" rid="c2">Bhushan &amp; Shadmehr, 1999</xref>; <xref ref-type="bibr" rid="c25">Kistemaker et al., 2006</xref>, <xref ref-type="bibr" rid="c26">2010</xref>; <xref ref-type="bibr" rid="c38">Nijhof &amp; Kouwenhoven, 2000</xref>) or direct torque actuators (<xref ref-type="bibr" rid="c30">Lillicrap &amp; Scott, 2013</xref>) similar to the ReLu muscle that MotorNet provides. However, despite its popularity, even the more-detailed Hill-type muscle remains a phenomenological model of real muscle behaviour, which can easily show its limits when trying to understand how the brain controls movement (<xref ref-type="bibr" rid="c3">Blum et al., 2020</xref>). Alternative muscle model formalizations exist, such as the Distribution-Moment muscle model (<xref ref-type="bibr" rid="c62">Zahalak, 1981</xref>), which may be worth implementing within MotorNet as well.</p>
</sec>
</sec>
</sec>
<sec id="s4">
<label>4.</label>
<title>Methods</title>
<sec id="s4a">
<label>4.1.</label>
<title>General modelling design</title>
<p>This section describes modelling elements that were used for several models in this study. For all models, the timestep size was 0.01 sec, and a proprioceptive delay of Δ<sub><italic>p</italic></sub> = 20 ms and visual delay of Δ<sub><italic>v</italic></sub> = 50 ms were used (<xref rid="fig2" ref-type="fig">Figure 2</xref>). Plants were actuated using numerical integration with the Euler method.</p>
<sec id="s4a1">
<label>4.1.1.</label>
<title>Arm26 model</title>
<p>The arm26 model used in this study is available online on the open-source toolbox code under the <italic>RigidTendonArm26</italic> plant class. It is briefly described below for convenience.</p>
<p>The skeleton of the arm26 models are according to the formalization proposed in <xref ref-type="bibr" rid="c20">Gomi &amp; Kawato (1997)</xref>, equations 1, 3, 5-7. Parameter values are as in <xref rid="tbl2" ref-type="table">table 2</xref>.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2:</label>
<caption><p>skeleton parameters for the arm26 model, taken from <xref ref-type="bibr" rid="c38">Nijhof &amp; Kouwenhoven (2000)</xref>.</p></caption>
<graphic xlink:href="528969v3_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>The skeleton was actuated by six rigid-tendon versions of Hill-type muscle actuators: a shoulder flexor, a shoulder extensor, an elbow flexor, an elbow extensor, a bi-articular flexor, and a bi-articular extensor. Their parameter values are defined in <xref rid="tbl3" ref-type="table">table 3</xref>.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3:</label>
<caption><p>parameters for the Hill-type muscle actuators used in the arm26, taken from <xref ref-type="bibr" rid="c26">Kistemaker et al. (2010)</xref>.</p></caption>
<graphic xlink:href="528969v3_tbl3.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>The full formalization of the Hill-type muscles can be found in <xref ref-type="bibr" rid="c54">Thelen (2003)</xref> equations 1-7, and with the parameter values used in that study. When different parameters were provided for young and old subjects, the values for young subjects were used (<xref ref-type="bibr" rid="c54">Thelen, 2003</xref>, <xref rid="tbl1" ref-type="table">table 1</xref>)</p>
<p>While in custom-made <italic>Plant</italic> objects the moment arms of each muscle are computed based on geometric first principles (<xref rid="fig4" ref-type="fig">Figure 4d-f</xref>; <xref ref-type="bibr" rid="c53">Sherman et al., 2013</xref>), in the <italic>RigidTendonArm26</italic> class the moment arms are approximated as described in <xref ref-type="bibr" rid="c26">Kistemaker et al. (2010)</xref>, equations A10-A12, with parameters for this study defined in <xref rid="tbl4" ref-type="table">table 4</xref>.</p>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Table 4:</label>
<caption><p>parameters used to compute moment arms in the arm26 models with moment arm approximation, taken from <xref ref-type="bibr" rid="c26">Kistemaker et al. (2010)</xref>.</p></caption>
<graphic xlink:href="528969v3_tbl4.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s4a2">
<label>4.1.2.</label>
<title>Point-mass model</title>
<p>The point-mass model used in this study is available online on the open-source toolbox code under the <italic>ReluPointMass24</italic> plant class. It is briefly described below for convenience.</p>
<p>The point-mass had a mass of <italic>m</italic> = 1 kg. Its actuation followed an ordinary differential equation such that <inline-formula><alternatives><inline-graphic xlink:href="528969v3_inline6.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> = <bold><italic>f</italic></bold>/<italic>m</italic> with <inline-formula><alternatives><inline-graphic xlink:href="528969v3_inline7.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>, <bold><italic>f</italic></bold> the 2-elements cartesian acceleration vector at time <italic>t</italic> and the 2-elements force vector applied at time <italic>t</italic>, respectively.</p>
<p>The forces were produced by four linear muscle actuators, whose formalization is available online on the open-source toolbox code under the <italic>ReluMuscle</italic> muscle class. Each muscle’s force production <italic>f</italic> is a linear piecewise function of its activation <italic>a</italic>, scaled by its maximum isometric force <italic>f</italic><sub><italic>max</italic></sub> = 500 N:
<disp-formula id="ueqn1">
<alternatives><graphic xlink:href="528969v3_ueqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
The activation function was the same as for the Hill-type muscles used in the arm26 model, and can be found in <xref ref-type="bibr" rid="c54">Thelen (2003)</xref>, <xref ref-type="disp-formula" rid="eqn1">equations 1-2</xref>.</p>
<p>The four muscles were fixed to the point-mass in a “X” configuration (<xref rid="fig4" ref-type="fig">Figures 4a</xref>, <xref ref-type="fig" rid="fig6">6a</xref>) with the first fixation point for the upper right, lower right, lower left, and upper left muscle being respectively (<italic>x</italic> = 2, <italic>y</italic> = 2), (2, −2), (−2, −2), (−2, 2). The second fixation point of each muscle was on the point-mass, therefore moving in general coordinates alongside the point-mass (<xref rid="fig4" ref-type="fig">Figure 4a</xref>).</p>
</sec>
<sec id="s4a3">
<label>4.1.3.</label>
<title>Network architecture</title>
<p>All network controllers used in this study consisted of one layer of GRUs with a sigmoid recurrent activation function and a <italic>tanh</italic> activation function. Kernel and recurrent weights were initialized using Glorot initialization (<xref ref-type="bibr" rid="c18">Glorot &amp; Bengio, 2010</xref>) and orthogonal initialization (<xref ref-type="bibr" rid="c22">Hu et al., 2020</xref>), respectively. Biases were initialized at 0.</p>
<p>The GRU layer was fully connected to an output layer of perceptron nodes with a sigmoid activation function. The output layer contains one node per descending motor command, or equivalently one node per muscle in the plant. The output layer’s kernel weights were initialized using a random normal distribution with a standard deviation of 0.003, and its bias was initialized at a constant value of -5. Because the output activation function is a sigmoid, this initial bias forces the output of the controller to be close to 0 at the start of initialization, ensuring a stable initialization state.</p>
<p>For all networks used in this study, a 2-elements vector of (<italic>x, y</italic>) cartesian coordinates for the start position and target position were provided as input, alongside a go-cue, resulting in a 5-element input vector. The go-cue was a “step” signal whose value changed from 1 to 0 when the movement should be initiated.</p>
</sec>
<sec id="s4a4">
<label>4.1.4.</label>
<title>General training design</title>
<p>During training, the models reached from a starting position drawn from a random uniform distribution across the full joint space to a target position drawn from a random uniform distribution as well. The occurrence time of the go-cue was drawn from a random uniform distribution across the full simulation duration. In 50% of simulations, no go-cue was provided (i.e., a catch trial) to ensure the network learnt to wait for the go-cue and avoided any anticipatory activity. The desired position <bold><italic>x</italic></bold><sup>∗</sup> was set to be the start position until the go cue was provided, at which point <bold><italic>x</italic></bold><sup>∗</sup> was defined as the target position. Note that the go-cue was treated as a visual signal. Therefore, while the desired position <bold><italic>x</italic></bold><sup>∗</sup> was updated immediately as the go-cue was provided (with no time delay), the network was informed of the go-cue occurrence via a change in the target position input and go-cue input only following the visual feedback delay Δ<sub><italic>v</italic></sub>. Depending on the models, additional training manipulations were also applied, as described in the sections below.</p>
</sec>
</sec>
<sec id="s4b">
<label>4.2.</label>
<title>Centre-out reaches task against a curl field</title>
<sec id="s4b1">
<label>4.2.1.</label>
<title>Model</title>
<p>The plant used to learn to reach against a curl field was an arm26 model as described in <xref ref-type="sec" rid="s4a1">section 4.1.1</xref>. The controller was as described in <xref ref-type="sec" rid="s4a3">section 4.1.3</xref>., with the GRU layer containing <italic>n</italic> = 50 units.</p>
</sec>
<sec id="s4b2">
<label>4.2.2.</label>
<title>Training</title>
<p>The model was trained according to the procedure in <xref ref-type="sec" rid="s4a4">section 4.1.4</xref>. with the loss described in <xref ref-type="disp-formula" rid="eqn1">eq. 1</xref>, using a kernel regularization λ = 10<italic>e</italic><sup>−6</sup>, coefficients <italic>α</italic> = 2, <italic>β</italic> = 5, <italic>γ</italic> = 0.1, <italic>k</italic> = 0.05, and target radius <italic>r</italic> = 0.01 m. The model was trained on 7680 batches with a batch size of 64, on simulations of 1 sec.</p>
<p>The model was trained according to <xref ref-type="sec" rid="s4a4">section 4.1.4</xref>., except that the go-cue time was fixed at 100 ms from the start of the simulation. Following initial training, the model was then tested as described in the next section to produce the “naïve” behaviour shown in <xref rid="fig1" ref-type="fig">Figure 1b-c</xref>.</p>
<p>Following testing, training was then resumed, but employing the curl-field, fixed starting position, and set of 8 targets used in testing. 50% simulations were still catch trials, as in the initial training session. This second training session lasted 768 batches with a batch size of Finally, following this second training session, the model was tested again, to produce the “adapted” behaviour of <xref rid="fig1" ref-type="fig">Figure 1b</xref>.</p>
</sec>
<sec id="s4b3">
<label>4.2.3.</label>
<title>Testing</title>
<p>The model was tested in 1 sec simulations against a null field, and against external forces applied at the arm’s endpoint that produced a counter-clockwise curl field:
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="528969v3_eqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
With <inline-formula><alternatives><inline-graphic xlink:href="528969v3_inline8.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> the 2-elements cartesian velocity vector at time <italic>t</italic>, and <italic>b</italic> = 8 a scalar defining the strength of the curl field. In the null field, we have <italic>b</italic> = 0.</p>
<p>The testing procedure consisted of 8 centre-out reaches from a fixed starting position at a shoulder and elbow angle of 45° and 90°, respectively, to 8 target positions 10 cm away and distributed in increments of 45° around the starting position (<xref rid="fig1" ref-type="fig">Figure 1b</xref>). This set of simulations were repeated against a null field and against the curl field in <xref ref-type="disp-formula" rid="eqn2">eq. 2</xref>, resulting in a total of 16 reaches. For all testing simulations, the go-cue time was fixed at 100 ms from the start of the simulation and no catch trials were employed.</p>
</sec>
</sec>
<sec id="s4c">
<label>4.3.</label>
<title>Biomechanical properties of the plant</title>
<p>The point-mass model used was as described in <xref ref-type="sec" rid="s4a2">section 4.1.2</xref>. The arm26 model used was as described in <xref ref-type="sec" rid="s4a1">section 4.1.1</xref>., except that the moment arms were not approximated based on the parameters of <xref rid="tbl4" ref-type="table">table 4</xref>, but computed based on the geometry of the muscle paths (<xref ref-type="bibr" rid="c38">Nijhof &amp; Kouwenhoven, 2000</xref>; <xref ref-type="bibr" rid="c50">Seth et al., 2010</xref>; <xref ref-type="bibr" rid="c53">Sherman et al., 2013</xref>). Accordingly, the muscle paths were manually declared by defining how many fixation points each muscle has, and on which bone and where on each bone each point fixes.</p>
<p>MotorNet handles declaration of these paths using a relative reference frame for each fixation point (<xref ref-type="bibr" rid="c50">Seth et al., 2010</xref>). Specifically, a fixation point on a bone will have two coordinates. The first coordinate defines how far along the bone the point is, from the bone’s origin, e.g., the shoulder for the upper arm (<xref rid="fig8" ref-type="fig">Figure 8</xref>). The second coordinate defines how far the point deviates from the bone orthogonally. If the fixation point is an anchor point, that is, it is not fixed on a bone but on the world space, then general coordinates (<italic>x, y</italic>) are used (color-coded in green in <xref rid="fig8" ref-type="fig">Figure 8</xref>). These anchor points are important to ensure that the plant can be actuated with respect to the environment. The full set of coordinates defining the model’s muscle paths are indicated in <xref rid="tbl5" ref-type="table">table 5</xref> and are derived from <xref ref-type="bibr" rid="c38">Nijhof &amp; Kouwenhoven (2000)</xref>.</p>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8:</label>
<caption><title>Coordinate frames for declaring muscle paths in MotorNet.</title>
<p><bold>(a)</bold> MotorNet handle muscle paths using coordinate frames relative to the bone on which a fixation point is. The world space is indexed as the fixation body “0” and its coordinate frame is the general coordinate system. <bold>(b)</bold> Schematic illustration of the muscle paths used for the arm26 arm26 model with no moment arm approximation described in <xref ref-type="sec" rid="s4c">section 4.3</xref> and <xref rid="tbl5" ref-type="table">table 5</xref>, for a shoulder and elbow angle of 45° and 90°, respectively.</p></caption>
<graphic xlink:href="528969v3_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<table-wrap id="tbl5" orientation="portrait" position="float">
<label>Table 5:</label>
<caption><p>Muscle paths for the arm26 model with no moment arm approximation.</p></caption>
<graphic xlink:href="528969v3_tbl5.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s4d">
<label>4.4.</label>
<title>Training ANNs to produce naturalistic behaviour</title>
<sec id="s4d1">
<label>4.4.1.</label>
<title>Model</title>
<p>The two models used to produce <xref rid="fig5" ref-type="fig">Figure 5</xref> were arm26 models as described in <xref ref-type="sec" rid="s4a1">section 4.1.1</xref>. For both models, the controller was as described in <xref ref-type="sec" rid="s4a3">section 4.1.3</xref>., with the GRU layer containing <italic>n</italic> = 110 units. In addition, excitation and GRU hidden activity noise were added, with values σ<sub><italic>u</italic></sub> = 10<italic>e</italic><sup>−3</sup>, σ<sub><italic>h</italic></sub> = 10<italic>e</italic><sup>−4</sup>, respectively.</p>
</sec>
<sec id="s4d2">
<label>4.4.2.</label>
<title>Training</title>
<p>The models were trained with the loss described in <xref ref-type="disp-formula" rid="eqn1">eq. 1</xref>, using a kernel regularization λ = 10<italic>e</italic><sup>−6</sup>, coefficients <italic>α</italic> = 2, <italic>β</italic> = 5, <italic>γ</italic> = 0.1, <italic>k</italic> = 0.05, and target radius <italic>r</italic> = 0.01 cm. The model was trained on 27,000 batches of size 1024, on simulations of 800 ms.</p>
<p>In one of the two models, which we refer to as the “perturbation-free” model, the training procedure was as described in <xref ref-type="sec" rid="s4a4">section 4.1.4</xref>. In the second model, which we refer to as the “perturbation-trained” model, a 100 ms endpoint mechanical perturbation was added to the training procedure. The perturbation occurred in 50% of trials, independently of whether the trial was a catch trial or not, and its orientation and time were randomly drawn as well. The magnitude of the perturbation was drawn from a uniform distribution ranging between 0 and 4 N. If the perturbation occurred during a catch trial, the distribution ranged between 0 and 8 N.</p>
</sec>
<sec id="s4d3">
<label>4.4.3.</label>
<title>Testing</title>
<p>Both the perturbation-trained and perturbation-free models were tested in 800 ms simulations in two distinct tasks, a centre-out reaching task and a postural task.</p>
<p>In the centre-out reaching task, 8 targets were positioned in 45 degrees increments and 10 cm away from a starting position corresponding to a shoulder and elbow angle of 45° and 90°, respectively (<xref rid="fig5" ref-type="fig">Figure 5c, g</xref>). The visual go cue was provided at 100 ms following the simulation start. 70 ms after the go-cue was “perceived” (i.e., 70 ms plus the visual feedback delay Δ<sub><italic>v</italic></sub>), a mechanical perturbation was applied at the arm’s endpoint and orthogonally to the reaching direction. This perturbation could be either within-distribution (±3 N) or out-of-distribution (±6 N) or null (no perturbation).</p>
<p>In the postural control task, no go cue was provided, and the arm’s endpoint was pushed away from the start position by the mechanical perturbation at 170 ms plus visual delay Δ<sub><italic>v</italic></sub> after the simulation started. We applied perturbations in either of the four cardinal directions (0°, 90°, 180°, 270°). Again, the set of perturbations for testing outputs included within-distribution magnitudes (±6 N) and out-of-distribution magnitudes (±12 N).</p>
</sec>
</sec>
<sec id="s4e">
<label>4.5.</label>
<title>Plant Geometry Defines Preference Distribution of Firing Rates: A Replication Study</title>
<sec id="s4e1">
<label>4.5.1.</label>
<title>Models</title>
<p>All arm26 and point-mass plants used to produce <xref rid="fig5" ref-type="fig">Figure 5</xref> were as described in <xref ref-type="sec" rid="s4a1">section 4.1.1</xref>. and <xref ref-type="sec" rid="s4a2">4.1.2</xref>., respectively. For all models, the controller was as described in <xref ref-type="sec" rid="s4a3">section 4.1.3</xref>., with the GRU layer containing <italic>n</italic> = 90 units.</p>
</sec>
<sec id="s4e2">
<label>4.5.2.</label>
<title>Training</title>
<p>All models were trained with the loss described in <xref ref-type="disp-formula" rid="eqn1">eq. 1</xref>, using a kernel regularization λ = 10<italic>e</italic><sup>−6</sup>, coefficients <italic>α</italic> = 2, <italic>β</italic> = 5, <italic>γ</italic> = 0.1, <italic>k</italic> = 0.05, and target radius <italic>r</italic> = 0. The models were trained on 38,400 batches of size 64, on simulations of 800 ms. The training procedure was as described in <xref ref-type="sec" rid="s4a4">section 4.1.4</xref>.</p>
</sec>
<sec id="s4e3">
<label>4.5.3.</label>
<title>Testing</title>
<p>The testing procedure consisted of 8 centre-out reaches in 800 ms simulations. Simulations started from a fixed position at a shoulder and elbow angle of 45° and 90° for the arm26 models, and at an (<italic>x</italic> = 0, <italic>y</italic> = 0) cartesian position for the point-mass models. Reaches were to 24 target positions 10 cm away and distributed in increments of 15° around the starting position (<xref rid="fig6" ref-type="fig">Figure 6b</xref>). For all testing simulations, the go-cue time was fixed at 100 ms into the simulation and no catch trials were employed.</p>
</sec>
<sec id="s4e4">
<label>4.5.4.</label>
<title>Analysis</title>
<p>To obtain the preferential movement direction of each GRU, we averaged each unit’s hidden activity in a 150 ms time window starting when the go cue was input to the network (i.e., following visual feedback delay Δ<sub><italic>v</italic></sub>) for each reaching direction independently, and regressed that average to a diagonal design matrix encoding the reach direction. The absolute value of the resulting regression coefficients was then normalized between 0 and 1, and neurons were sorted according to these normalized coefficients to produce <xref rid="fig6" ref-type="fig">Figure 6e</xref>.</p>
<p>As mentioned in the results section, we trained 8 networks to control an arm26 and 8 networks to control a point-mass. For each network, we took the count of GRUs whose normalized regression coefficient is maximal for each target considered and averaged that count across all 8 networks to produce <xref rid="fig6" ref-type="fig">Figure 6c</xref>.</p>
</sec>
</sec>
</sec>
</body>
<back>
<sec id="s5">
<label>5.</label>
<title>Contributions</title>
<p>OC, JAM, and PLG conceptualized the toolbox; OC implemented the toolbox; OC, JAM, MK, JAP, and PLG tested the toolbox and designed the simulation paradigms; OC and PLG performed the simulations; OC, JAM, MK, JAP, and PLG interpreted the results; OC made the figures, wrote the first draft, and wrote the online documentation; OC, JAM, MK, JAP, and PLG edited and approved the final version of the manuscript.</p>
</sec>
<ack>
<label>6.</label>
<title>Acknowledgements</title>
<p>This work was supported by the Natural Science and Engineering Council of Canada (RGPIN-2018-05458 to PLG and RGPIN-2022-04421 to JAP) and the Canadian Institutes of Health Research (PJT-156241 to PLG, PJT-175010 to JAP). JAM was supported by a Banting Postdoctoral Fellowship, a BrainsCAN Postdoctoral Fellowship, and a Vector Institute Postgraduate Affiliate Program Stipend.</p>
</ack>
<sec id="s6">
<label>7.</label>
<title>Competing interests</title>
<p>The authors declare no competing financial or non-financial interests.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Abbott</surname>, <given-names>L.</given-names></string-name>, &amp; <string-name><surname>Svoboda</surname>, <given-names>K.</given-names></string-name> (<year>2020</year>). <article-title>Brain-wide interactions between neural circuits</article-title>. <source>Current Opinion in Neurobiology</source>, <volume>65</volume>, <fpage>iii</fpage>–<lpage>v</lpage>. <pub-id pub-id-type="doi">10.1016/j.conb.2020.12.012</pub-id></mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Bhushan</surname>, <given-names>N.</given-names></string-name>, &amp; <string-name><surname>Shadmehr</surname>, <given-names>R.</given-names></string-name> (<year>1999</year>). <article-title>Computational nature of human adaptive control during learning of reaching movements in force fields</article-title>. <source>Biological Cybernetics</source>, <volume>81</volume>(<issue>1</issue>), <fpage>39</fpage>–<lpage>60</lpage>. <pub-id pub-id-type="doi">10.1007/s004220050543</pub-id></mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Blum</surname>, <given-names>K. P.</given-names></string-name>, <string-name><surname>Campbell</surname>, <given-names>K. S.</given-names></string-name>, <string-name><surname>Horslen</surname>, <given-names>B. C.</given-names></string-name>, <string-name><surname>Nardelli</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Housley</surname>, <given-names>S. N.</given-names></string-name>, <string-name><surname>Cope</surname>, <given-names>T. C.</given-names></string-name>, &amp; <string-name><surname>Ting</surname>, <given-names>L. H.</given-names></string-name> (<year>2020</year>). <article-title>Diverse and complex muscle spindle afferent firing properties emerge from multiscale muscle mechanics</article-title>. <source>ELife</source>, <volume>9</volume>, <fpage>e55177</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.55177</pub-id></mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="web"><string-name><surname>Brockman</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Cheung</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Pettersson</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Schneider</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Schulman</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Tang</surname>, <given-names>J.</given-names></string-name>, &amp; <string-name><surname>Zaremba</surname>, <given-names>W.</given-names></string-name> (<year>2016</year>). <source>OpenAI Gym</source> (arXiv:<pub-id pub-id-type="arxiv">1606.01540</pub-id>). arXiv. <pub-id pub-id-type="doi">10.48550/arXiv.1606.01540</pub-id></mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Cheng</surname>, <given-names>E. J.</given-names></string-name>, &amp; <string-name><surname>Scott</surname>, <given-names>S. H.</given-names></string-name> (<year>2000</year>). <article-title>Morphometry of Macaca mulatta forelimb. I. Shoulder and elbow muscles and segment inertial parameters</article-title>. <source>Journal of Morphology</source>, <volume>245</volume>(<issue>3</issue>), <fpage>206</fpage>–<lpage>224</lpage>. <pub-id pub-id-type="doi">10.1002/1097-4687(200009)245:3&lt;206::AID-JMOR3&gt;3.0.CO;2-U</pub-id></mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="web"><string-name><surname>Cho</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>van Merrienboer</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Gulcehre</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Bahdanau</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Bougares</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Schwenk</surname>, <given-names>H.</given-names></string-name>, &amp; <string-name><surname>Bengio</surname>, <given-names>Y.</given-names></string-name> (<year>2014</year>). <source>Learning Phrase Representations using RNN Encoder-Decoder for Statistical Machine Translation</source> (arXiv:<pub-id pub-id-type="arxiv">1406.1078</pub-id>). arXiv. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1406.1078">http://arxiv.org/abs/1406.1078</ext-link></mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Churchland</surname>, <given-names>M. M.</given-names></string-name>, &amp; <string-name><surname>Shenoy</surname>, <given-names>K. V.</given-names></string-name> (<year>2007</year>). <article-title>Temporal Complexity and Heterogeneity of Single-Neuron Activity in Premotor and Motor Cortex</article-title>. <source>Journal of Neurophysiology</source>, <volume>97</volume>(<issue>6</issue>), <fpage>4235</fpage>–<lpage>4257</lpage>. <pub-id pub-id-type="doi">10.1152/jn.00095.2007</pub-id></mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Cisek</surname>, <given-names>P.</given-names></string-name> (<year>2019</year>). <article-title>Resynthesizing behavior through phylogenetic refinement</article-title>. <source>Attention, Perception, &amp; Psychophysics</source>, <volume>81</volume>(<issue>7</issue>), <fpage>2265</fpage>–<lpage>2287</lpage>. <pub-id pub-id-type="doi">10.3758/s13414-019-01760-1</pub-id></mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Conditt</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Gandolfo</surname>, <given-names>F.</given-names></string-name>, &amp; <string-name><surname>Mussa-Ivaldi</surname>, <given-names>F. A.</given-names></string-name> (<year>1997</year>). <article-title>The motor system does not learn the dynamics of the arm by rote memorization of past experience</article-title>. <source>Journal of Neurophysiology</source>, <volume>78</volume>(<issue>1</issue>), <fpage>554</fpage>–<lpage>560</lpage>. <pub-id pub-id-type="doi">10.1152/jn.1997.78.1.554</pub-id></mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Delp</surname>, <given-names>S. L.</given-names></string-name>, <string-name><surname>Anderson</surname>, <given-names>F. C.</given-names></string-name>, <string-name><surname>Arnold</surname>, <given-names>A. S.</given-names></string-name>, <string-name><surname>Loan</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Habib</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>John</surname>, <given-names>C. T.</given-names></string-name>, <string-name><surname>Guendelman</surname>, <given-names>E.</given-names></string-name>, &amp; <string-name><surname>Thelen</surname>, <given-names>D. G.</given-names></string-name> (<year>2007</year>). <article-title>OpenSim: Open-Source Software to Create and Analyze Dynamic Simulations of Movement</article-title>. <source>IEEE Transactions on Biomedical Engineering</source>, <volume>54</volume>(<issue>11</issue>), <fpage>1940</fpage>–<lpage>1950</lpage>. <pub-id pub-id-type="doi">10.1109/TBME.2007.901024</pub-id></mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Dimitriou</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Wolpert</surname>, <given-names>D. M.</given-names></string-name>, &amp; <string-name><surname>Franklin</surname>, <given-names>D. W.</given-names></string-name> (<year>2013</year>). <article-title>The Temporal Evolution of Feedback Gains Rapidly Update to Task Demands</article-title>. <source>Journal of Neuroscience</source>, <volume>33</volume>(<issue>26</issue>), <fpage>10898</fpage>–<lpage>10909</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.5669-12.2013</pub-id></mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="web"><string-name><surname>Driscoll</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Shenoy</surname>, <given-names>K.</given-names></string-name>, &amp; <string-name><surname>Sussillo</surname>, <given-names>D.</given-names></string-name> (<year>2022</year>). <article-title>Flexible multitask computation in recurrent networks utilizes shared dynamical motifs [Preprint]</article-title>. <source>Neuroscience</source>. <pub-id pub-id-type="doi">10.1101/2022.08.15.503870</pub-id></mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>Feldman</surname>, <given-names>A. G.</given-names></string-name>, &amp; <string-name><surname>Levin</surname>, <given-names>M. F.</given-names></string-name> (<year>1995</year>). <article-title>The origin and use of positional frames of reference in motor control</article-title>. <source>Behavioral and Brain Sciences</source>, <volume>18</volume>(<issue>4</issue>), <fpage>723</fpage>–<lpage>744</lpage>. <pub-id pub-id-type="doi">10.1017/S0140525X0004070X</pub-id></mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="book"><string-name><surname>Fetz</surname>, <given-names>E. E.</given-names></string-name> (<year>1993</year>). <chapter-title>Dynamic recurrent neural network models of sensorimotor behavior</chapter-title>. <source>In The neurobiology of Neural Networks</source> (<publisher-loc>Cambridge MA</publisher-loc>, pp. <fpage>165</fpage>–<lpage>190</lpage>). <publisher-name>MIT Press</publisher-name>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Flanagan</surname>, <given-names>J. R.</given-names></string-name>, <string-name><surname>Ostry</surname>, <given-names>D. J.</given-names></string-name>, &amp; <string-name><surname>Feldman</surname>, <given-names>A. G.</given-names></string-name> (<year>1993</year>). <article-title>Control of Trajectory Modifications in Target-Directed Reaching</article-title>. <source>Journal of Motor Behavior</source>, <volume>25</volume>(<issue>3</issue>), <fpage>140</fpage>–<lpage>152</lpage>. <pub-id pub-id-type="doi">10.1080/00222895.1993.9942045</pub-id></mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="web"><string-name><surname>Fujimoto</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Hoof</surname>, <given-names>H.</given-names></string-name>, &amp; <string-name><surname>Meger</surname>, <given-names>D.</given-names></string-name> (<year>2018</year>). <article-title>Addressing Function Approximation Error in Actor-Critic Methods</article-title>. <source>Proceedings of the 35th International Conference on Machine Learning</source>, <fpage>1587</fpage>–<lpage>1596</lpage>. <ext-link ext-link-type="uri" xlink:href="https://proceedings.mlr.press/v80/fujimoto18a.html">https://proceedings.mlr.press/v80/fujimoto18a.html</ext-link></mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Gershman</surname>, <given-names>S. J.</given-names></string-name>, &amp; <string-name><surname>Ölveczky</surname>, <given-names>B. P.</given-names></string-name> (<year>2020</year>). <article-title>The neurobiology of deep reinforcement learning</article-title>. <source>Current Biology</source>, <volume>30</volume>(<issue>11</issue>), <fpage>R629</fpage>–<lpage>R632</lpage>. <pub-id pub-id-type="doi">10.1016/j.cub.2020.04.021</pub-id></mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="web"><string-name><surname>Glorot</surname>, <given-names>X.</given-names></string-name>, &amp; <string-name><surname>Bengio</surname>, <given-names>Y.</given-names></string-name> (<year>2010</year>). <article-title>Understanding the difficulty of training deep feedforward neural networks</article-title>. <source>Proceedings of the Thirteenth International Conference on Artificial Intelligence and Statistics</source>, <fpage>249</fpage>–<lpage>256</lpage>. <ext-link ext-link-type="uri" xlink:href="https://proceedings.mlr.press/v9/glorot10a.html">https://proceedings.mlr.press/v9/glorot10a.html</ext-link></mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Gomi</surname>, <given-names>H.</given-names></string-name>, &amp; <string-name><surname>Kawato</surname>, <given-names>M.</given-names></string-name> (<year>1993</year>). <article-title>Neural network control for a closed-loop System using Feedback-error-learning</article-title>. <source>Neural Networks</source>, <volume>6</volume>(<issue>7</issue>), <fpage>933</fpage>–<lpage>946</lpage>. <pub-id pub-id-type="doi">10.1016/S0893-6080(09)80004-X</pub-id></mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Gomi</surname>, <given-names>H.</given-names></string-name>, &amp; <string-name><surname>Kawato</surname>, <given-names>M.</given-names></string-name> (<year>1997</year>). <article-title>Human arm stiffness and equilibrium-point trajectory during multi-joint movement</article-title>. <source>Biological Cybernetics</source>, <volume>76</volume>(<issue>3</issue>), <fpage>163</fpage>–<lpage>171</lpage>. <pub-id pub-id-type="doi">10.1007/s004220050329</pub-id></mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Gribble</surname>, <given-names>P. L.</given-names></string-name>, &amp; <string-name><surname>Ostry</surname>, <given-names>D. J.</given-names></string-name> (<year>2000</year>). <article-title>Compensation for loads during arm movements using equilibrium-point control</article-title>. <source>Experimental Brain Research</source>, <volume>135</volume>(<issue>4</issue>), <fpage>474</fpage>–<lpage>482</lpage>. <pub-id pub-id-type="doi">10.1007/s002210000547</pub-id></mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="web"><string-name><surname>Hu</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Xiao</surname>, <given-names>L.</given-names></string-name>, &amp; <string-name><surname>Pennington</surname>, <given-names>J.</given-names></string-name> (<year>2020</year>). <source>Provable Benefit of Orthogonal Initialization in Optimizing Deep Linear Networks</source> (arXiv:<pub-id pub-id-type="arxiv">2001.05992</pub-id>). arXiv. <pub-id pub-id-type="doi">10.48550/arXiv.2001.05992</pub-id></mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Jordan</surname>, <given-names>M. I.</given-names></string-name>, &amp; <string-name><surname>Rumelhart</surname>, <given-names>D. E.</given-names></string-name> (<year>1992</year>). <article-title>Forward Models: Supervised Learning with a Distal Teacher</article-title>. <source>Cognitive Science</source>, <volume>16</volume>(<issue>3</issue>), <fpage>307</fpage>–<lpage>354</lpage>. <pub-id pub-id-type="doi">10.1207/s15516709cog1603_1</pub-id></mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Keeley</surname>, <given-names>S. L.</given-names></string-name>, <string-name><surname>Zoltowski</surname>, <given-names>D. M.</given-names></string-name>, <string-name><surname>Aoi</surname>, <given-names>M. C.</given-names></string-name>, &amp; <string-name><surname>Pillow</surname>, <given-names>J. W.</given-names></string-name> (<year>2020</year>). <article-title>Modeling statistical dependencies in multi-region spike train data</article-title>. <source>Current Opinion in Neurobiology</source>, <volume>65</volume>, <fpage>194</fpage>–<lpage>202</lpage>. <pub-id pub-id-type="doi">10.1016/j.conb.2020.11.005</pub-id></mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Kistemaker</surname>, <given-names>D. A.</given-names></string-name>, <string-name><surname>Van Soest</surname>, <given-names>A. (Knoek) J.</given-names></string-name>, &amp; <string-name><surname>Bobbert</surname>, <given-names>M. F.</given-names></string-name> (<year>2006</year>). <article-title>Is Equilibrium Point Control Feasible for Fast Goal-Directed Single-Joint Movements?</article-title> <source>Journal of Neurophysiology</source>, <volume>95</volume>(<issue>5</issue>), <fpage>2898</fpage>–<lpage>2912</lpage>. <pub-id pub-id-type="doi">10.1152/jn.00983.2005</pub-id></mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Kistemaker</surname>, <given-names>D. A.</given-names></string-name>, <string-name><surname>Wong</surname>, <given-names>J. D.</given-names></string-name>, &amp; <string-name><surname>Gribble</surname>, <given-names>P. L.</given-names></string-name> (<year>2010</year>). <article-title>The Central Nervous System Does Not Minimize Energy Cost in Arm Movements</article-title>. <source>Journal of Neurophysiology</source>, <volume>104</volume>(<issue>6</issue>), <fpage>2985</fpage>–<lpage>2994</lpage>. <pub-id pub-id-type="doi">10.1152/jn.00483.2010</pub-id></mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>LeCun</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Bengio</surname>, <given-names>Y.</given-names></string-name>, &amp; <string-name><surname>Hinton</surname>, <given-names>G.</given-names></string-name> (<year>2015</year>). <article-title>Deep learning</article-title>. <source>Nature</source>, <volume>521</volume>(<issue>7553</issue>), Article 7553. <pub-id pub-id-type="doi">10.1038/nature14539</pub-id></mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="web"><string-name><surname>Lillicrap</surname>, <given-names>T. P.</given-names></string-name>, <string-name><surname>Hunt</surname>, <given-names>J. J.</given-names></string-name>, <string-name><surname>Pritzel</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Heess</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Erez</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Tassa</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Silver</surname>, <given-names>D.</given-names></string-name>, &amp; <string-name><surname>Wierstra</surname>, <given-names>D.</given-names></string-name> (<year>2019</year>). <article-title>Continuous control with deep reinforcement learning</article-title>. <source>ArXiv</source>. <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1509.02971">http://arxiv.org/abs/1509.02971</ext-link></mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Lillicrap</surname>, <given-names>T. P.</given-names></string-name>, <string-name><surname>Santoro</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Marris</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Akerman</surname>, <given-names>C. J.</given-names></string-name>, &amp; <string-name><surname>Hinton</surname>, <given-names>G.</given-names></string-name> (<year>2020</year>). <article-title>Backpropagation and the brain</article-title>. <source>Nature Reviews Neuroscience</source>, <volume>21</volume>(<issue>6</issue>), <fpage>335</fpage>–<lpage>346</lpage>. <pub-id pub-id-type="doi">10.1038/s41583-020-0277-3</pub-id></mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Lillicrap</surname>, <given-names>T. P.</given-names></string-name>, &amp; <string-name><surname>Scott</surname>, <given-names>S. H.</given-names></string-name> (<year>2013</year>). <article-title>Preference Distributions of Primary Motor Cortex Neurons Reflect Control Solutions Optimized for Limb Biomechanics</article-title>. <source>Neuron</source>, <volume>77</volume>(<issue>1</issue>), <fpage>168</fpage>–<lpage>179</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2012.10.041</pub-id></mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="book"><string-name><surname>Lindsay</surname>, <given-names>G. W.</given-names></string-name> (<year>2021</year>). <source>Models of the Mind: How Physics, Engineering and Mathematics Have Shaped Our Understanding of the Brain</source>. <publisher-name>Bloomsbury Sigma</publisher-name>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Loeb</surname>, <given-names>G. E.</given-names></string-name> (<year>2021</year>). <article-title>Learning to Use Muscles</article-title>. <source>Journal of Human Kinetics</source>, <volume>76</volume>(<issue>1</issue>), <fpage>9</fpage>–<lpage>33</lpage>. <pub-id pub-id-type="doi">10.2478/hukin-2020-0084</pub-id></mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Michaels</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Dann</surname>, <given-names>B.</given-names></string-name>, &amp; <string-name><surname>Scherberger</surname>, <given-names>H.</given-names></string-name> (<year>2016</year>). <article-title>Neural Population Dynamics during Reaching Are Better Explained by a Dynamical System than Representational Tuning</article-title>. <source>PLOS Computational Biology</source>, <volume>12</volume>(<issue>11</issue>), <fpage>e1005175</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005175</pub-id></mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Michaels</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Schaffelhofer</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Agudelo-Toro</surname>, <given-names>A.</given-names></string-name>, &amp; <string-name><surname>Scherberger</surname>, <given-names>H.</given-names></string-name> (<year>2020</year>). <article-title>A goal-driven modular neural network predicts parietofrontal neural dynamics during grasping</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>117</volume>(<issue>50</issue>), <fpage>32124</fpage>–<lpage>32135</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.2005087117</pub-id></mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>Millard</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Uchida</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Seth</surname>, <given-names>A.</given-names></string-name>, &amp; <string-name><surname>Delp</surname>, <given-names>S. L.</given-names></string-name> (<year>2013</year>). <article-title>Flexing Computational Muscle: Modeling and Simulation of Musculotendon Dynamics</article-title>. <source>Journal of Biomechanical Engineering</source>, <volume>135</volume>(<issue>2</issue>), <fpage>021005</fpage>. <pub-id pub-id-type="doi">10.1115/1.4023390</pub-id></mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>Mnih</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Kavukcuoglu</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Silver</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Rusu</surname>, <given-names>A. A.</given-names></string-name>, <string-name><surname>Veness</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Bellemare</surname>, <given-names>M. G.</given-names></string-name>, <string-name><surname>Graves</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Riedmiller</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Fidjeland</surname>, <given-names>A. K.</given-names></string-name>, <string-name><surname>Ostrovski</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Petersen</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Beattie</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Sadik</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Antonoglou</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>King</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Kumaran</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Wierstra</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Legg</surname>, <given-names>S.</given-names></string-name>, &amp; <string-name><surname>Hassabis</surname>, <given-names>D.</given-names></string-name> (<year>2015</year>). <article-title>Human-level control through deep reinforcement learning</article-title>. <source>Nature</source>, <volume>518</volume>(<issue>7540</issue>), <fpage>529</fpage>–<lpage>533</lpage>. <pub-id pub-id-type="doi">10.1038/nature14236</pub-id></mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Murray</surname>, <given-names>W. M.</given-names></string-name>, <string-name><surname>Delp</surname>, <given-names>S. L.</given-names></string-name>, &amp; <string-name><surname>Buchanan</surname>, <given-names>T. S.</given-names></string-name> (<year>1995</year>). <article-title>Variation of muscle moment arms with elbow and forearm position</article-title>. <source>Journal of Biomechanics</source>, <volume>28</volume>(<issue>5</issue>), <fpage>513</fpage>–<lpage>525</lpage>. <pub-id pub-id-type="doi">10.1016/0021-9290(94)00114-J</pub-id></mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="book"><string-name><surname>Nijhof</surname>, <given-names>E.-J.</given-names></string-name>, &amp; <string-name><surname>Kouwenhoven</surname>, <given-names>E.</given-names></string-name> (<year>2000</year>). <chapter-title>Simulation of Multijoint Arm Movements</chapter-title>. In <person-group person-group-type="editor"><string-name><given-names>J. M.</given-names> <surname>Winters</surname></string-name> &amp; <string-name><given-names>P. E.</given-names> <surname>Crago</surname></string-name></person-group> (Eds.), <source>Biomechanics and Neural Control of Posture and Movement</source> (pp. <fpage>363</fpage>–<lpage>372</lpage>). <publisher-name>Springer</publisher-name> <publisher-loc>New York</publisher-loc>. <pub-id pub-id-type="doi">10.1007/978-1-4612-2104-3_29</pub-id></mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Pesaran</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Hagan</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Qiao</surname>, <given-names>S.</given-names></string-name>, &amp; <string-name><surname>Shewcraft</surname>, <given-names>R.</given-names></string-name> (<year>2021</year>). <article-title>Multiregional communication and the channel modulation hypothesis</article-title>. <source>Current Opinion in Neurobiology</source>, <volume>66</volume>, <fpage>250</fpage>–<lpage>257</lpage>. <pub-id pub-id-type="doi">10.1016/j.conb.2020.11.016</pub-id></mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Pruszynski</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>King</surname>, <given-names>G. L.</given-names></string-name>, <string-name><surname>Boisse</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Scott</surname>, <given-names>S. H.</given-names></string-name>, <string-name><surname>Flanagan</surname>, <given-names>J. R.</given-names></string-name>, &amp; <string-name><surname>Munoz</surname>, <given-names>D. P.</given-names></string-name> (<year>2010</year>). <article-title>Stimulus-locked responses on human arm muscles reveal a rapid neural pathway linking visual input to arm motor output</article-title>. <source>The European Journal of Neuroscience</source>, <volume>32</volume>(<issue>6</issue>), <fpage>1049</fpage>–<lpage>1057</lpage>. <pub-id pub-id-type="doi">10.1111/j.1460-9568.2010.07380.x</pub-id></mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Pruszynski</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Omrani</surname>, <given-names>M.</given-names></string-name>, &amp; <string-name><surname>Scott</surname>, <given-names>S. H.</given-names></string-name> (<year>2014</year>). <article-title>Goal-Dependent Modulation of Fast Feedback Responses in Primary Motor Cortex</article-title>. <source>Journal of Neuroscience</source>, <volume>34</volume>(<issue>13</issue>), <fpage>4608</fpage>–<lpage>4617</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.4520-13.2014</pub-id></mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Reschechtko</surname>, <given-names>S.</given-names></string-name>, &amp; <string-name><surname>Pruszynski</surname>, <given-names>J. A.</given-names></string-name> (<year>2020</year>). <article-title>Stretch reflexes</article-title>. <source>Current Biology</source>, <volume>30</volume>(<issue>18</issue>), <fpage>R1025</fpage>–<lpage>R1030</lpage>. <pub-id pub-id-type="doi">10.1016/j.cub.2020.07.092</pub-id></mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Richards</surname>, <given-names>B. A.</given-names></string-name>, <string-name><surname>Lillicrap</surname>, <given-names>T. P.</given-names></string-name>, <string-name><surname>Beaudoin</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Bengio</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Bogacz</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Christensen</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Clopath</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Costa</surname>, <given-names>R. P.</given-names></string-name>, <string-name><surname>de Berker</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Ganguli</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Gillon</surname>, <given-names>C. J.</given-names></string-name>, <string-name><surname>Hafner</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Kepecs</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Kriegeskorte</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Latham</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Lindsay</surname>, <given-names>G. W.</given-names></string-name>, <string-name><surname>Miller</surname>, <given-names>K. D.</given-names></string-name>, <string-name><surname>Naud</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Pack</surname>, <given-names>C. C.</given-names></string-name>, … <string-name><surname>Kording</surname>, <given-names>K. P.</given-names></string-name> (<year>2019</year>). <article-title>A deep learning framework for neuroscience</article-title>. <source>Nature Neuroscience</source>, <volume>22</volume>(<issue>11</issue>), Article 11. <pub-id pub-id-type="doi">10.1038/s41593-019-0520-2</pub-id></mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Rumelhart</surname>, <given-names>D. E.</given-names></string-name>, <string-name><surname>Hintont</surname>, <given-names>G. E.</given-names></string-name>, &amp; <string-name><surname>Williams</surname>, <given-names>R. J.</given-names></string-name> (<year>1986</year>). <source>Learning representations by back-propagating errors</source>. <volume>4</volume>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Saxe</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Nelli</surname>, <given-names>S.</given-names></string-name>, &amp; <string-name><surname>Summerfield</surname>, <given-names>C.</given-names></string-name> (<year>2021</year>). <article-title>If deep learning is the answer, what is the question?</article-title> <source>Nature Reviews Neuroscience</source>, <volume>22</volume>(<issue>1</issue>), <fpage>55</fpage>–<lpage>67</lpage>. <pub-id pub-id-type="doi">10.1038/s41583-020-00395-8</pub-id></mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Scott</surname>, <given-names>S. H.</given-names></string-name>, <string-name><surname>Gribble</surname>, <given-names>P. L.</given-names></string-name>, <string-name><surname>Graham</surname>, <given-names>K. M.</given-names></string-name>, &amp; <string-name><surname>Cabel</surname>, <given-names>D. W.</given-names></string-name> (<year>2001</year>). <article-title>Dissociation between hand motion and population vectors from neural activity in motor cortex</article-title>. <source>Nature</source>, <volume>413</volume>(<issue>6852</issue>), Article 6852. <pub-id pub-id-type="doi">10.1038/35093102</pub-id></mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Scott</surname>, <given-names>S. H.</given-names></string-name>, &amp; <string-name><surname>Kalaska</surname>, <given-names>J. F.</given-names></string-name> (<year>1997</year>). <article-title>Reaching Movements With Similar Hand Paths But Different Arm Orientations. I. Activity of Individual Cells in Motor Cortex</article-title>. <source>Journal of Neurophysiology</source>, <volume>77</volume>(<issue>2</issue>), <fpage>826</fpage>–<lpage>852</lpage>. <pub-id pub-id-type="doi">10.1152/jn.1997.77.2.826</pub-id></mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Semedo</surname>, <given-names>J. D.</given-names></string-name>, <string-name><surname>Gokcen</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Machens</surname>, <given-names>C. K.</given-names></string-name>, <string-name><surname>Kohn</surname>, <given-names>A.</given-names></string-name>, &amp; <string-name><surname>Yu</surname>, <given-names>B. M.</given-names></string-name> (<year>2020</year>). <article-title>Statistical methods for dissecting interactions between brain areas</article-title>. <source>Current Opinion in Neurobiology</source>, <volume>65</volume>, <fpage>59</fpage>–<lpage>69</lpage>. <pub-id pub-id-type="doi">10.1016/j.conb.2020.09.009</pub-id></mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Seth</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Hicks</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Uchida</surname>, <given-names>T. K.</given-names></string-name>, <string-name><surname>Habib</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Dembia</surname>, <given-names>C. L.</given-names></string-name>, <string-name><surname>Dunne</surname>, <given-names>J. J.</given-names></string-name>, <string-name><surname>Ong</surname>, <given-names>C. F.</given-names></string-name>, <string-name><surname>DeMers</surname>, <given-names>M. S.</given-names></string-name>, <string-name><surname>Rajagopal</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Millard</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Hamner</surname>, <given-names>S. R.</given-names></string-name>, <string-name><surname>Arnold</surname>, <given-names>E. M.</given-names></string-name>, <string-name><surname>Yong</surname>, <given-names>J. R.</given-names></string-name>, <string-name><surname>Lakshmikanth</surname>, <given-names>S. K.</given-names></string-name>, <string-name><surname>Sherman</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Ku</surname>, <given-names>J. P.</given-names></string-name>, &amp; <string-name><surname>Delp</surname>, <given-names>S. L.</given-names></string-name> (<year>2018</year>). <article-title>OpenSim: Simulating musculoskeletal dynamics and neuromuscular control to study human and animal movement</article-title>. <source>PLOS Computational Biology</source>, <volume>14</volume>(<issue>7</issue>), <fpage>e1006223</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006223</pub-id></mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Seth</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Sherman</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Eastman</surname>, <given-names>P.</given-names></string-name>, &amp; <string-name><surname>Delp</surname>, <given-names>S.</given-names></string-name> (<year>2010</year>). <article-title>Minimal formulation of joint motion for biomechanisms</article-title>. <source>Nonlinear Dynamics</source>, <volume>62</volume>(<issue>1–2</issue>), <fpage>291</fpage>–<lpage>303</lpage>. <pub-id pub-id-type="doi">10.1007/s11071-010-9717-3</pub-id></mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Shadmehr</surname>, <given-names>R.</given-names></string-name>, &amp; <string-name><surname>Krakauer</surname>, <given-names>J. W.</given-names></string-name> (<year>2008</year>). <article-title>A computational neuroanatomy for motor control</article-title>. <source>Experimental Brain Research</source>, <volume>185</volume>(<issue>3</issue>), <fpage>359</fpage>–<lpage>381</lpage>. <pub-id pub-id-type="doi">10.1007/s00221-008-1280-5</pub-id></mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Shadmehr</surname>, <given-names>R.</given-names></string-name>, &amp; <string-name><surname>Mussa-Ivaldi</surname>, <given-names>F. A.</given-names></string-name> (<year>1994</year>). <article-title>Adaptive representation of dynamics during learning of a motor task</article-title>. <source>Journal of Neuroscience</source>, <volume>14</volume>(<issue>5</issue>), <fpage>3208</fpage>–<lpage>3224</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.14-05-03208.1994</pub-id></mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="web"><string-name><surname>Sherman</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Seth</surname>, <given-names>A.</given-names></string-name>, &amp; <string-name><surname>Delp</surname>, <given-names>S. L.</given-names></string-name> (<year>2013</year>). <article-title>What is a Moment Arm? Calculating Muscle Effectiveness in Biomechanical Models Using Generalized Coordinates</article-title>. <source>Volume 7B: 9th International Conference on Multibody Systems, Nonlinear Dynamics, and Control</source>, V07BT10A052. <pub-id pub-id-type="doi">10.1115/DETC2013-13633</pub-id></mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>Thelen</surname>, <given-names>D. G.</given-names></string-name> (<year>2003</year>). <article-title>Adjustment of Muscle Mechanics Model Parameters to Simulate Dynamic Contractions in Older Adults</article-title>. <source>Journal of Biomechanical Engineering</source>, <volume>125</volume>(<issue>1</issue>), <fpage>70</fpage>–<lpage>77</lpage>. <pub-id pub-id-type="doi">10.1115/1.1531112</pub-id></mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><surname>Todorov</surname>, <given-names>E.</given-names></string-name> (<year>2004</year>). <article-title>Optimality principles in sensorimotor control</article-title>. <source>Nature Neuroscience</source>, <volume>7</volume>(<issue>9</issue>), <fpage>907</fpage>–<lpage>915</lpage>. <pub-id pub-id-type="doi">10.1038/nn1309</pub-id></mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="web"><string-name><surname>Todorov</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Erez</surname>, <given-names>T.</given-names></string-name>, &amp; <string-name><surname>Tassa</surname>, <given-names>Y.</given-names></string-name> (<year>2012</year>). <article-title>MuJoCo: A physics engine for model-based control</article-title>. <source>2012 IEEE/RSJ International Conference on Intelligent Robots and Systems</source>, <fpage>5026</fpage>–<lpage>5033</lpage>. <pub-id pub-id-type="doi">10.1109/IROS.2012.6386109</pub-id></mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Weiler</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Gribble</surname>, <given-names>P. L.</given-names></string-name>, &amp; <string-name><surname>Pruszynski</surname>, <given-names>J. A.</given-names></string-name> (<year>2019</year>). <article-title>Spinal stretch reflexes support efficient hand control</article-title>. <source>Nature Neuroscience</source>, <volume>22</volume>(<issue>4</issue>), <fpage>529</fpage>–<lpage>533</lpage>. <pub-id pub-id-type="doi">10.1038/s41593-019-0336-0</pub-id></mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><surname>Whittington</surname>, <given-names>J. C. R.</given-names></string-name>, &amp; <string-name><surname>Bogacz</surname>, <given-names>R.</given-names></string-name> (<year>2017</year>). <article-title>An Approximation of the Error Backpropagation Algorithm in a Predictive Coding Network with Local Hebbian Synaptic Plasticity</article-title>. <source>Neural Computation</source>, <volume>29</volume>(<issue>5</issue>), <fpage>1229</fpage>–<lpage>1262</lpage>. <pub-id pub-id-type="doi">10.1162/NECO_a_00949</pub-id></mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><surname>Wierzbicka</surname>, <given-names>M. M.</given-names></string-name>, <string-name><surname>Wiegner</surname>, <given-names>A. W.</given-names></string-name>, &amp; <string-name><surname>Shahani</surname>, <given-names>B. T.</given-names></string-name> (<year>1986</year>). <article-title>Role of agonist and antagonist muscles in fast arm movements in man</article-title>. <source>Experimental Brain Research</source>, <volume>63</volume>(<issue>2</issue>), <fpage>331</fpage>–<lpage>340</lpage>. <pub-id pub-id-type="doi">10.1007/BF00236850</pub-id></mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="web"><string-name><surname>Willett</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Vyas</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Michaels</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Henderson</surname>, <given-names>J. M.</given-names></string-name>, &amp; <string-name><surname>Shenoy</surname>, <given-names>K. V.</given-names></string-name> (<year>2021</year>, <month>November</month> 9). <article-title>Feedback control dynamics explain motor cortical activity</article-title>. <source>50th Annual Meeting of the Society for Neuroscience</source>. <ext-link ext-link-type="uri" xlink:href="https://www.abstractsonline.com/pp8/#!/10485/presentation/willett/1">https://www.abstractsonline.com/pp8/#!/10485/presentation/willett/1</ext-link></mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><surname>Won</surname>, <given-names>J.</given-names></string-name>, &amp; <string-name><surname>Hogan</surname>, <given-names>N.</given-names></string-name> (<year>1995</year>). <article-title>Stability properties of human reaching movements</article-title>. <source>Experimental Brain Research</source>, <volume>107</volume>(<issue>1</issue>). <pub-id pub-id-type="doi">10.1007/BF00228024</pub-id></mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><surname>Zahalak</surname>, <given-names>G. I.</given-names></string-name> (<year>1981</year>). <article-title>A distribution-moment approximation for kinetic theories of muscular contraction</article-title>. <source>Mathematical Biosciences</source>, <volume>55</volume>(<issue>1</issue>), <fpage>89</fpage>–<lpage>114</lpage>. <pub-id pub-id-type="doi">10.1016/0025-5564(81)90014-6</pub-id></mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88591.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Gallego</surname>
<given-names>Juan Alvaro</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Imperial College London</institution>
</institution-wrap>
<city>London</city>
<country>United Kingdom</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Useful</kwd>
</kwd-group>
</front-stub>
<body>
<p>The authors present &quot;MotorNet&quot;, a <bold>useful</bold> software package to train artificial neural networks to control a biomechanical model of an effector. The manuscript provides <bold>solid</bold> evidence that MotorNet is easy to use and can reproduce past results in the field, both at the neural and behavioural levels. Validation is limited to planar arm-like plants or point-masses, so future work exploring three-dimensional movements and other types of plants would strengthen the impact of the tool.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88591.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
Codol et al. present a toolbox that allows simulating biomechanically realistic effectors and training Artificial Neural Networks (ANNs) to control them. The paper provides a detailed explanation of how the toolbox is structured and several examples that demonstrate its usefulness.</p>
<p>Main comments:</p>
<p>
1. The paper is well written and easy to follow. The schematics help in understanding how the toolbox works and the examples provide an idea of the results that the user can obtain.</p>
<p>2. As I understand it, the main purpose of the paper should be to facilitate the usage of the toolbox. For this reason, I have missed a more explicit link to the actual code. As I see it, researchers will read this paper to figure out whether they can use MotorNet to simulate their experiments, and how they should proceed if they decide to use it. I'd say the paper provides an answer to the first question and assures that the toolbox is very easy to install and use. Maybe the authors could support this claim by adding &quot;snippets&quot; of code that show the key steps in building an actual example.</p>
<p>3. The results provided in Figures 1, 4, 5 and 6 are useful, because they provide examples of the type of things one can do with the toolbox. I have a few comments that might help improving them:</p>
<p>
a. The examples in Figures 1 and 5 seem a bit redundant (same effector, similar task). Maybe the authors could show an example with a different effector or task? (see point 4).</p>
<p>
b. I missed a discussion on the relevance of the results shown in Figure 4. The moment arms are barely mentioned outside section 2.3. Are these results new? How can they help with motor control research?</p>
<p>
c. The results in Figure 6 are important, since one key asset of ANNs is that they provide access to the activity of the whole population of units that produces a given behavior. For this reason, I think it would be interesting to show the actual &quot;empirical observations&quot; that the results shown in Fig. 6 are replicating, hence allowing a direct comparison between the results obtained for biological and simulated neurons.</p>
<p>4. All examples in the paper use the arm26 plant as effector. Although the authors say that &quot;users can easily declare their own custom-made effector and task objects if desired by subclassing the base Plant and Task class, respectively&quot;, this does not sound straightforward. Table 1 does not really clarify how to do it. Maybe an example that shows the actual code (see point 2) that creates a new plant (e.g. the 3-joint arm in Figure 7) would be useful.</p>
<p>5. One potential limitation of the toolbox is that it is based on Tensorflow, when the field of Computational Neuroscience seems to be, or at least that's my impression, transitioning to pyTorch. How easy would it be to translate MotorNet to pyTorch? Maybe the authors could comment on this in the discussion.</p>
<p>6. Supervised learning (SL) is widely used in Systems Neuroscience, especially because it is faster than reinforcement learning (RL). Thus providing the possibility of training the ANNs with SL is an important asset of the toolbox. However, SL is not always ideal, especially when the optimal strategy is not known or when there are different alternative strategies and we want to know which is the one preferred by the subject. For instance, would it be possible to implement a setup in which the ANN has to choose between 2 different paths to reach a target? (e.g. Kaufman et al. 2015 eLife). In such a scenario, RL seems to be a more natural option Would it be easy to extend MotorNet so it allows training with RL? Maybe the authors could comment on this in the discussion.</p>
<p>Impact:</p>
<p>
MotorNet aims at simplifying the process of simulating complex experimental setups to rapidly test hypotheses about how the brain produces a specific movement. By providing an end-to-end pipeline to train ANNs on the simulated setup, it can greatly help guide experimenters to decide where to focus their experimental efforts.</p>
<p>Additional context:</p>
<p>
Being the main result a toolbox, the paper is complemented by a GitHub repository and a documentation webpage. Both the repository and the webpage are well organized and easy to navigate. The webpage walks the user through the installation of the toolbox and the building of the effectors and the ANNs.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88591.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>MotorNet aims to provide a unified interface where the trained RNN controller exists within the same TensorFlow environment as the end effectors being controlled. This architecture provides a much simpler interface for the researcher to develop and iterate through computational hypotheses. In addition, the authors have built a set of biomechanically realistic end effectors (e.g., an 2 joint arm model with realistic muscles) within TensorFlow that are fully differentiable.</p>
<p>MotorNet will prove a highly useful starting point for researchers interested in exploring the challenges of controlling movement with realistic muscle and joint dynamics. The architecture features a conveniently modular design and the inclusion of simpler arm models provides an approachable learning curve. Other state-of-the-art simulation engines offer realistic models of muscles and multi-joint arms and afford more complex object manipulation and contact dynamics than MotorNet. However, MotorNet's approach allows for direct optimization of the controller network via gradient descent rather than reinforcement learning, which is a compromise currently required when other simulation engines (as these engines' code cannot be differentiated through).</p>
<p>The paper could be reorganized to provide clearer signposts as to what role each section plays (e.g., that the explanation of the moment arms of different joint models serves to illustrate the complexity of realistic biomechanics, rather than a novel discovery/exposition of this manuscript). Also, if possible, it would be valuable if the authors could provide more insight into whether gradient descent finds qualitatively different solutions to RL or other non gradient-based methods. This would strengthen the argument that a fully differentiable plant is useful beyond improving training time / computational power required (although this is a sufficiently important rationale per se).</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.88591.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Artificial neural networks have developed into a new research tool across various disciplines of neuroscience. However, specifically for studying neural control of movement it was extremely difficult to train those models, as they require not only simulating the neural network, but also the body parts one is interested in studying. The authors provide a solution to this problem which is built upon one of the main software packages used for deep learning (Tensorflow). This allows them to make use of state-of-the-art tools for training neural networks.</p>
<p>They show that their toolbox is able to (re-)produce several commonly studied experiments e.g., planar reaching with and without loads. The toolbox is described in sufficient detail to get an overview of the functionality and the current state of what can be done with it. Although the authors state that only a few lines of code can reproduce such an experiment, they unfortunately don't provide any source code to reproduce their results (nor is it given in the respective repository).</p>
<p>The modularity of the presented toolbox makes it easy to exchange or modify single parts of an experiment e.g., the task or the neural network used as a controller. Together with the open-source nature of the toolbox, this will facilitate sharing and reproducibility across research labs.</p>
<p>I can see how this paper can enable a whole set of new studies on neural control of movement and accelerate the turnover time for new ideas or hypotheses, as stated in the first paragraph of the Discussion section. Having such a low effort to run computational experiments will be definitely beneficial for the field of neural control of movement.</p>
</body>
</sub-article>
</article>