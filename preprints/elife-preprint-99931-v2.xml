<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">99931</article-id>
<article-id pub-id-type="doi">10.7554/eLife.99931</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.99931.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.4</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories><title-group>
<article-title>A unifying account of replay as context-driven memory reactivation</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4003-7214</contrib-id>
<name>
<surname>Zhou</surname>
<given-names>Zhenglong</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>zzhou34@sas.upenn.edu</email>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8122-9525</contrib-id>
<name>
<surname>Kahana</surname>
<given-names>Michael J</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8086-0331</contrib-id>
<name>
<surname>Schapiro</surname>
<given-names>Anna C</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">†</xref>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00b30xv10</institution-id><institution>Department of Psychology, University of Pennsylvania</institution></institution-wrap>, <city>Philadelphia</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Liljeholm</surname>
<given-names>Mimi</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/04gyf1771</institution-id><institution>University of California, Irvine</institution>
</institution-wrap>
<city>Irvine</city>
<country country="US">United States</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Colgin</surname>
<given-names>Laura L</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Texas at Austin</institution>
</institution-wrap>
<city>Austin</city>
<country country="US">United States</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>†</label><p>Equal contribution</p></fn>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-09-11">
<day>11</day>
<month>09</month>
<year>2024</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-12-23">
<day>23</day>
<month>12</month>
<year>2025</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP99931</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-05-29">
<day>29</day>
<month>05</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-05-30">
<day>30</day>
<month>05</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.03.22.533833"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-09-11">
<day>11</day>
<month>09</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.99931.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.99931.1.sa4">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99931.1.sa3">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99931.1.sa2">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99931.1.sa1">Reviewer #3 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99931.1.sa0">Reviewer #4 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Zhou et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Zhou et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-99931-v2.pdf"/>
<abstract><p>During rest and sleep, sequential neural activation patterns corresponding to awake experience re-emerge, and this replay has been shown to benefit subsequent behavior and memory. Whereas some studies show that replay directly recapitulates recent experience, others demonstrate that replay systematically deviates from the temporal structure, the statistics, and even the content of recent experience. Given these disparate characteristics, what is the nature and purpose of replay? Here, we offer a theoretical framework in which replay reflects simple context-guided processes that facilitate memory. We suggest that during awake learning, the brain associates experiences with the contexts in which they are encoded, at encoding rates that vary according to the salience of each experience. During quiescence, replay emerges as the result of a cascade of autonomous bidirectional interactions between contexts and their associated experiences, which in turn facilitates memory consolidation. A computational model instantiating this proposal explains numerous replay phenomena, including findings that existing models fail to account for and observations that have been predominantly construed through the lens of reinforcement learning. Our theory provides a unified, mechanistic framework of how the brain initially encodes and subsequently replays experiences in the service of memory consolidation.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>This version clarifies the model scope and its relation to other replay and learning models; expands links to empirical findings including sleep dependent consolidation and semantic influences on replay; improves the presentation of the model implementation and simulations with updated figures; and includes the full simulation code to support replication.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Sleep and rest are crucial for learning and memory [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c3">3</xref>]. A candidate mechanism facilitating these benefits is replay — the offline re-emergence of neural activity associated with awake experience. Over the past several decades, the field of neuroscience has accumulated extensive evidence of replay [<xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c7">7</xref>] and increasing evidence of its utility to behavior [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c12">12</xref>]. It is challenging, however, to characterize the principles and functions of replay, because it exhibits disparate characteristics across states and task contexts that are difficult to synthesize under one framework. Early studies showed that replay preserves the correlational structure and the temporal structure of multi-cell spiking patterns that underlie awake experiences [<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c15">15</xref>]. Most canonically, the firing of sequences of hippocampal place cells corresponding to traversals through an environment re-emerge with the same sequential firing during rest and sleep. Subsequent studies, however, demonstrated that replay deviates from the temporal structure, statistics, and content of recent experience in myriad ways: Replay activates never-experienced novel trajectories [<xref ref-type="bibr" rid="c16">16</xref>], over-represents salient experiences [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>], unrolls in the reverse order of a behavioral sequence when an animal consumes reward [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c23">23</xref>], and sometimes exhibits a bias away from recently experienced trajectories [<xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c16">16</xref>]. These observations illustrate that replay is not a simple, direct recapitulation of awake experience.</p>
<p>An influential explanation for why replay exhibits distinctive properties, especially in the presence of reward, is that replay is for learning value predictions in the manner of reinforcement learning (RL) models [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c26">26</xref>]. According to this perspective, adaptive behavior depends on identifying actions that lead to rewarding outcomes, which requires predicting the downstream value of actions (i.e., eventual punishment or reward). This perspective argues that replay reactivates memories to update these predictions. For example, many speculate that reverse replay implements a classic method for updating value predictions, which is to propagate information backward from a reward through experienced trajectories to update upstream actions’ value predictions [<xref ref-type="bibr" rid="c27">27</xref>]. A recent theory extending this perspective [<xref ref-type="bibr" rid="c25">25</xref>] argues that a range of other replay characteristics [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c18">18</xref>] can be explained by assuming that replay prioritizes updates that will most improve future behavior. The model assumes that replay knows in advance which updates will best improve behavior, defined by a quantity called the expected value of backup (EVB). When replay progresses from updates that improve future behavior the most to the least (i.e., highest to lowest EVB), it produces patterns that match a number of empirically-observed phenomena. However, knowing the behavioral consequence of replay before it is performed is implausible, and the model makes predictions that are inconsistent with empirical data, including the prediction that replay always prioritizes updates relevant to the present goal [<xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c30">30</xref>, <xref ref-type="bibr" rid="c16">16</xref>] and that learning reduces the rate of backward more than forward replay [<xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c32">32</xref>]. Thus, this RL perspective is unlikely to provide a complete account of the characteristics of replay.</p>
<p>We offer an alternative theoretical account in which replay reflects simple context-guided memory processes. We hypothesize that, during awake learning, the brain sequentially associates experiences with the contexts in which they are encoded, in a manner modulated by the salience of each experience (more rapid association for more salient experiences). During quiescence — both awake rest periods and sleep, replay arises as the result of a cascade of bidirectional interactions between contexts and their associated experiences. The offline brain continues to learn from this replay, updating associations between reactivated memories and contexts. In this account, replay does not compute the utility of memories for learning value predictions nor does it track value predictions. Instead, replay arises naturally from a memory-based mechanism operating bidirectionally between contexts and their associated experiences.</p>
<p>We show that an instantiation of this account — a computational model that builds on established context-based memory encoding and retrieval mechanisms [<xref ref-type="bibr" rid="c33">33</xref>, <xref ref-type="bibr" rid="c34">34</xref>] — unifies numerous replay phenomena. These include replay patterns often presumed to involve RL computations and findings that existing models do not account for. We focus on the model as a formulation of hippocampal replay, capturing how the hippocampus may replay past experiences through simple and interpretable mechanisms. First, the content and structure of replay sequences in the model vary according to states and task contexts in ways that mirror empirical observations [<xref ref-type="bibr" rid="c35">35</xref>, <xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c36">36</xref>]. Second, the model captures prominent effects of reward on replay [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>] despite not tracking value predictions. Third, in line with a number of findings [<xref ref-type="bibr" rid="c37">37</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c38">38</xref>, <xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c39">39</xref>], replay is not restricted to direct recent experience: The model reactivates non-local and never-experienced novel trajectories. Moreover, the model captures a range of experience-dependent replay characteristics [<xref ref-type="bibr" rid="c40">40</xref>, <xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c38">38</xref>, <xref ref-type="bibr" rid="c32">32</xref>]. Finally, replay benefits memory consolidation in ways that align with prior observations and theories [<xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c43">43</xref>, <xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c44">44</xref>, <xref ref-type="bibr" rid="c45">45</xref>]. As a whole, our framework provides a general, mechanistic account of how the hippocampus initially encodes and subsequently reactivates experiences in the service of memory consolidation.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>A context model of memory replay</title>
<p>Our proposed model builds on memory encoding and retrieval mechanisms established in retrieved-context models of memory, as exemplified in the context-maintenance and retrieval model (CMR; [<xref ref-type="bibr" rid="c33">33</xref>, <xref ref-type="bibr" rid="c34">34</xref>]). We refer to the model as CMR-replay (<xref rid="fig1" ref-type="fig">Figure 1b</xref>). We begin with an overview of the model architecture, followed by illustrations of awake learning and replay in the model by considering how it encodes and reactivates sequences of items (<xref rid="fig1" ref-type="fig">Figure 1a</xref>). We provide a detailed walk-through of operations in the model in Methods.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1:</label>
<caption><title>CMR-replay.</title>
<p><bold>a</bold>. Consider a task of encoding a sequence consisting of four items, each denoted by a shade of blue. <bold>b</bold>. We propose a model of replay that builds on the context-maintenance and retrieval model (CMR), which we refer to as CMR-replay. The model consists of four components: item (<italic>f</italic>), context (<italic>c</italic>), item-to-context associations (<italic>M <sup>fc</sup></italic>), and context-to-item associations (<italic>M <sup>cf</sup></italic>). At each timestep during awake encoding, <italic>f</italic> represents the current item and <italic>c</italic> is a recency-weighted average of associated contexts of past and present items. CMR-replay associates <italic>f</italic> and <italic>c</italic> at each timestep, updating <italic>M <sup>fc</sup></italic> and <italic>M <sup>cf</sup></italic> according to a Hebbian learning rule. <italic>M <sup>fc</sup></italic> and <italic>M <sup>cf</sup></italic> respectively support the retrieval of an item’s associated context and a context’s associated items. During replay, <italic>f</italic> represents the current reactivated item, and <italic>c</italic> is a drifting context representing a recency-weighted average of associated contexts of past and present reactivated items. Here, too, the model updates <italic>M <sup>fc</sup></italic> and <italic>M <sup>cf</sup></italic> to associate reactivated <italic>f</italic> and <italic>c</italic>. The figure illustrates the representations of <italic>f</italic>, <italic>c</italic>, <italic>M <sup>fc</sup></italic>, and <italic>M <sup>cf</sup></italic> as the model encodes the third item during learning. Lengths of color bars in <italic>f</italic> and <italic>c</italic> represent relative magnitudes of different features. Shades of grey illustrate the weights in <italic>M <sup>fc</sup></italic> and <italic>M <sup>cf</sup></italic>. Orange features represent task-irrelevant items, which do not appear as inputs during awake encoding but compete with task-relevant items for reactivation during replay. <bold>c</bold>. During both awake encoding and replay, context <italic>c</italic> drifts by incorporating the current item <italic>f</italic> ‘s associated context <inline-formula id="inline-eqn-1"><inline-graphic xlink:href="533833v4_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and downweighting previous items’ associated contexts. The figure illustrates how context drifts during the first time the model encodes the example sequence. <bold>d</bold>. The figure illustrates <italic>M <sup>fc</sup></italic> and <italic>M <sup>cf</sup></italic> updates as the model encodes the third item during the first presentation of the sequence. <bold>e</bold>. Consider the activation of items at the onset of sleep and awake rest across sessions of learning. At replay onset, an initial probability distribution across items <italic>a</italic><sub>0</sub> varies according to the behavioral state (i.e., awake rest or sleep). Compared to sleep, during awake rest, <italic>a</italic><sub>0</sub> is strongly biased toward features associated with external inputs during awake rest. For awake rest, the figure shows an example of <italic>a</italic><sub>0</sub> when the model receives a context cue related to the fourth item. Through repeated exposure to the same task sequence across sessions of learning, activities of the four task-related items (i.e., blue items) become suppressed in <italic>a</italic><sub>0</sub> relative to task-irrelevant items (i.e., orange items). <bold>f</bold>. Each replay period begins by sampling an item <italic>f<sub>t</sub></italic><sub>=0</sub> according to <italic>a</italic><sub>0</sub>, where <italic>t</italic> denotes the current timestep. If <italic>f<sub>t</sub></italic><sub>=0</sub> is a task-related item, its associated context <inline-formula id="inline-eqn-2"><inline-graphic xlink:href="533833v4_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is reinstated as <italic>c</italic><sub>0</sub> to enter a recursive process. During this process, at each timestep <italic>t ≥</italic> 1, <italic>c<sub>t−</sub></italic><sub>1</sub> evokes a probability distribution <italic>at</italic> that excludes previously reactivated items. Given <italic>at</italic>, the model samples an item <italic>ft</italic> and reinstates <italic>f<sub>t</sub></italic>’s associated context <inline-formula id="inline-eqn-3"><inline-graphic xlink:href="533833v4_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, which is combined with <italic>c<sub>t−</sub></italic><sub>1</sub> to form a new context <italic>c<sub>t</sub></italic> to guide the ensuing reactivation. The dashed arrow indicates that <italic>c<sub>t</sub></italic> becomes <italic>c<sub>t−</sub></italic><sub>1</sub> for the next time step. At any <italic>t</italic>, the replay period ends with a probability of 0.1 or if a task-irrelevant item is reactivated.</p></caption>
<graphic xlink:href="533833v4_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>CMR-replay comprises four elements (<xref rid="fig1" ref-type="fig">Figure 1b</xref>): item (<italic>f</italic>), context (<italic>c</italic>), item-to-context associations (<italic>M<sup>fc</sup></italic>), and context-to-item associations (<italic>M<sup>cf</sup></italic>). The values of the elements of the <italic>f</italic> and <italic>c</italic> vectors can be considered to correspond abstractly to the firing rate of a neuron or population of neurons, and the values of <italic>M<sup>cf</sup></italic> and <italic>M<sup>fc</sup></italic> to the strength of synaptic connections between those neurons. Prior to learning, distinct items (<italic>f</italic>) are associated with orthogonal context features. As CMR-replay encodes (during awake learning) or reactivates (during replay) a sequence of items, <italic>f</italic> represents the current item, whereas a drifting context (<italic>c</italic>) maintains a receding history of present and past items’ associated contexts (<xref rid="fig1" ref-type="fig">Figure 1c</xref>), which resets before the model encodes each sequence. We represent the drifting context during learning and replay with <italic>c</italic> and an item’s associated context with <italic>c<sub>f</sub></italic>. During both awake learning and replay, CMR-replay associates each item with the current drifting context by updating bidirectional associations between them — item-to-context associations (<italic>M<sup>fc</sup></italic>), which map each item to its associated context, and context-to-item associations (<italic>M<sup>cf</sup></italic>), which map each context to associated items. Prior to learning, these associations are fully orthogonal: <italic>M<sup>fc</sup></italic> maps each item to a distinct context and <italic>M<sup>cf</sup></italic> maps each context feature to a distinct item.</p>
<p>During awake encoding of a sequence of items, for each item <italic>f</italic>, the model retrieves its associated context <italic>c<sub>f</sub></italic> via <italic>M<sup>fc</sup></italic>. The drifting context <italic>c</italic> incorporates the item’s associated context <italic>c<sub>f</sub></italic> and downweights its representation of previous items’ associated contexts (<xref rid="fig1" ref-type="fig">Figure 1c</xref>). Thus, the context layer maintains a recency weighted sum of past and present items’ associated contexts. To perform encoding, CMR-replay updates <italic>M<sup>fc</sup></italic>and <italic>M<sup>cf</sup></italic> to strengthen associations between the current item and context (<xref rid="fig1" ref-type="fig">Figure 1d</xref>). The <italic>M<sup>fc</sup></italic> update adds the current context to the context associated with the item. Because the current context contains contexts associated with previous items, through the <italic>M<sup>fc</sup></italic>update, the context associated with the item starts to reflect contexts of prior items. For the same reason, through the <italic>M<sup>cf</sup></italic> update, <italic>M<sup>cf</sup></italic> learns to map contexts associated with previous items to the current item.</p>
<p>Building on prior work [<xref ref-type="bibr" rid="c46">46</xref>, <xref ref-type="bibr" rid="c47">47</xref>], CMR-replay embraces the simplifying assumption that the salience of each item influences its rate of encoding (i.e., the learning rates at which the model updates <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic>). In particular, the model updates <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic> at faster rates for salient items, including those that are novel and rewarding (see Methods), than for others. Higher encoding rates allow salient items to form associa\tions with their encoding contexts more rapidly. In CMR-replay, salience modifies encoding rates only for the current item and context; it does not modify encoding rates for the items that lead up to the salient item.</p>
<p>During replay, the model generates a cascade of item and context reactivations by operating bidirectionally on <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic>. This process begins with an initial item reactivation. At the onset of each replay period, the model selects this item from an activity distribution that reflects spontaneous activity during awake rest or sleep (<xref rid="fig1" ref-type="fig">Figure 1e</xref>). To capture the near-absence of external sensory information during sleep, we initialized this distribution with random activity across all items at sleep onset. In simulations of awake rest, in contrast, we present a cue that represents the external sensory context of where the model is “resting.” This cue evokes activities that bias the distribution toward this resting location. As a result, awake replay exhibits an initiation bias — a tendency to initiate at the item most strongly associated with the cue.</p>
<p>Once CMR-replay reactivates an initial item, this triggers a sequence of autonomous reactivation (<xref rid="fig1" ref-type="fig">Figure 1f</xref>). As in awake encoding, during replay, the model maintains a drifting context — a recency-weighted average of past and present reactivated items’ associated contexts. At each timestep, using the current context as a cue, the model evokes a distribution of activities across items via <italic>M<sup>cf</sup></italic>. The model converts these activities into a probability distribution and samples another item without replacement (i.e., by excluding previously reactivated items). This mechanism of sampling without replacement, akin to response suppression in established context memory models [<xref ref-type="bibr" rid="c33">33</xref>], could be implemented by neuronal fatigue or refractory dynamics [<xref ref-type="bibr" rid="c48">48</xref>, <xref ref-type="bibr" rid="c49">49</xref>]. Non-repetition during reactivation is also a common assumption in replay models that regulate reactivation through inhibition or prioritization [<xref ref-type="bibr" rid="c50">50</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c51">51</xref>]. In accordance with awake encoding, the model updates context by incorporating the newly reactivated item’s associated context, and updates <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic> to associate the reactivated item with the updated context, albeit at much slower rates. The updated context then guides item reactivation at the next timestep. At each timestep, a replay event ends with a constant probability or if a task-irrelevant item becomes reactivated.</p>
<p>In the model, replay tends to preserve the temporal contiguity of awake experience, such that each reactivated item tends to be followed by the item that was encoded immediately after or before it (<xref rid="fig6" ref-type="fig">Fig. 6d</xref> left). During awake encoding, because of the way context incrementally drifts, the encoding contexts for adjacent items are more similar than for items that are far apart, except when a distractor intervenes between two adjacent items to demarcate an event boundary. During replay, when the model retrieves a reactivated item’s associated context to guide the next reactivation, it will then favor the reactivation of items that immediately preceded or followed the current item during awake encoding (<xref rid="fig6" ref-type="fig">Fig. 6d</xref> left). This behavior is referred to as the model’s contiguity bias, which allows replay to generate coherent sequences despite its stochasticity. Its contiguity bias stems from its use of shared, temporally autocorrelated context to link successive items, despite the orthogonal nature of individual item representations. This bias would be even stronger if items had overlapping representations, as observed in place fields. Following prior work [<xref ref-type="bibr" rid="c25">25</xref>], we consider replay events to be replayed sequences (one per replay period) with consecutive segments of length five or greater that preserve the contiguity of the awake sequence.</p>
<p>In memory models that reactivate memories for offline learning [<xref ref-type="bibr" rid="c52">52</xref>, <xref ref-type="bibr" rid="c53">53</xref>, <xref ref-type="bibr" rid="c54">54</xref>], a common issue is that the most well-learned items are rehearsed most often, leading to additional strengthening of these items, leading in turn to even more rehearsal, and so on. CMR models can exhibit this same rich-get-richer phenomenon. The solution in prior models has been to incorporate a mechanism that balances rehearsal across items [<xref ref-type="bibr" rid="c53">53</xref>, <xref ref-type="bibr" rid="c54">54</xref>, <xref ref-type="bibr" rid="c51">51</xref>]. CMR-replay has such a mechanism as well, which increasingly downweights task-related items at the onset of replay through repetition in the same task. This process downweights items according to the activity of their retrieved contexts in the preceding awake encoding period. As CMR-replay repeatedly strengthens weights for a sequence of items, the probability that replay begins with its constituent items decreases, allowing alternative items that received less exposure to participate in replay (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>). The proposal that a suppression mechanism plays a role in replay aligns with models that regulate place cell reactivation via inhibition [<xref ref-type="bibr" rid="c55">55</xref>] and with empirical observations of increased hippocampal inhibitory interneuron activity with experience [<xref ref-type="bibr" rid="c40">40</xref>]. Our model assumes the presence of such inhibitory mechanisms but does not explicitly model them. There are multiple possibilities for how a biological process may implement something like our suppression mechanism [<xref ref-type="bibr" rid="c56">56</xref>]. Though more empirical investigation is needed to determine the implementation, the need across theoretical perspectives for some form of balancing mechanism motivates the strong prediction that some biological mechanism like this must be at work.</p>
<p>We simulate awake learning in a number of tasks [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c35">35</xref>, <xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c18">18</xref>] by exposing the model to sequences of items that correspond to trajectories of spatial locations or visual stimuli as experienced by animals in the experiments. In between sessions of wake learning, we simulate quiescence (both awake rest and sleep) as periods of autonomous reactivation. Our objective is to examine whether CMR-replay can capture qualitative aspects of existing replay phenomena, rather than to provide a quantitative fit to the data. Unlike prior work that finds different best-fitting parameters across simulations [<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c57">57</xref>, <xref ref-type="bibr" rid="c46">46</xref>], CMR-replay employs one set of model parameters across all simulations. In the following sections, we show that the model accounts for a diverse range of empirical phenomena, including context-dependent variations of replay (<xref rid="fig2" ref-type="fig">Fig. 2</xref>), effects of reward on replay (<xref rid="fig3" ref-type="fig">Fig. 3</xref>), replay patterns that go beyond direct recent experience (<xref rid="fig4" ref-type="fig">Fig. 4</xref>), experience-dependent variations of replay (<xref rid="fig5" ref-type="fig">Fig. 5</xref>), and ways in which replay facilitates memory (<xref rid="fig6" ref-type="fig">Fig. 6</xref>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Context-dependent variations in memory replay.</title>
<p><bold>a</bold>. As observed in rodents (left), replay in CMR-replay (right) is predominantly forward at the start of a run and backward at the end of a run on a linear track. <bold>b</bold>. Consistent with rodent data (left), in CMR-replay (right), the proportion of forward replay is higher during sleep than during awake rest. <bold>c</bold>. The presence of external cues during sleep biases replay toward their associated memories both in animals (left) and in CMR-replay (right). Error bars represent <italic>±</italic>1 standard error of the mean. *p<italic>&lt;</italic>0.05; **p<italic>&lt;</italic>0.01; ***p<italic>&lt;</italic>0.001. Left image in <bold>a</bold> adapted from ref [<xref ref-type="bibr" rid="c29">29</xref>], Nature Publishing Group; left image in <bold>b</bold> adapted from ref [<xref ref-type="bibr" rid="c36">36</xref>], Wiley.</p></caption>
<graphic xlink:href="533833v4_fig2.tif" mimetype="image" mime-subtype="tiff"/>
<permissions>
<copyright-statement>© 2007, Diba and Buzsaki</copyright-statement>
<copyright-year>2007</copyright-year>
<copyright-holder>Diba and Buzsaki</copyright-holder>
<license><license-p>Panel A was reprinted from Figure 1 in <xref ref-type="bibr" rid="c29">Diba and Buzsaki (2007)</xref> which was published under a <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by-nc/4.0/deed.en">CC BY-NC 4.0</ext-link> license. Reproduction of this panel must abide by the terms of this license.</license-p></license>
</permissions>
</fig>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3:</label>
<caption><title>Reward leads to over-representation in sleep and modulates the rate of backward replay.</title>
<p><bold>a</bold>. Sleep over-represents items associated with reward in animals (left) and in CMR-replay (right). Error bars represent <italic>±</italic>1 standard error of the mean. <bold>b</bold>. Varying the magnitude of reward outcome leads to differences in the frequency of backward but not forward replay in animals (left) and CMR-replay (right). In the animal data (left), error bars show 95% confidence intervals. For simulation results (right), error bars show <italic>±</italic>1 standard error of the mean. Left image in <bold>a</bold> adapted from ref [<xref ref-type="bibr" rid="c18">18</xref>], eLife; images in the left column adapted from ref [<xref ref-type="bibr" rid="c20">20</xref>], Elsevier.</p></caption>
<graphic xlink:href="533833v4_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4:</label>
<caption><title>Replay activates remote experiences and links temporally-separated experiences.</title>
<p><bold>a</bold>. The two panels show examples of remote and novel (shortcut) replay sequences observed in animals. The colored items indicate the temporal order of the sequences (light blue, early; purple, late). The red item denotes the resting position. <bold>b</bold>. CMR-replay also generates remote and shortcut rest replay, as illustrated in the two predicted sequences of neural firing in the two panels. <bold>c</bold>. Proportion of replay events that contain remote sequences in animals (left) and in CMR-replay (right). Error bars show <italic>±</italic> 1 standard error of the mean in the data and model. <bold>d</bold>. In Liu et al. (2019), participants encoded scrambled versions of two true sequences <italic>X</italic><sub>1</sub><italic>X</italic><sub>2</sub><italic>X</italic><sub>3</sub><italic>X</italic><sub>4</sub> and <italic>Y</italic><sub>1</sub><italic>Y</italic><sub>2</sub><italic>Y</italic><sub>3</sub><italic>Y</italic><sub>4</sub>: <italic>X</italic><sub>1</sub><italic>X</italic><sub>2</sub><italic>Y</italic><sub>1</sub><italic>Y</italic><sub>2</sub>, <italic>X</italic><sub>2</sub><italic>X</italic><sub>3</sub><italic>Y</italic><sub>2</sub><italic>Y</italic><sub>3</sub>, and <italic>X</italic><sub>3</sub><italic>X</italic><sub>4</sub><italic>Y</italic><sub>3</sub><italic>Y</italic><sub>4</sub> (<xref rid="fig7" ref-type="fig">Fig. 7g</xref>). After learning, human spontaneous neural activity showed stronger evidence of sequential reactivation of the true sequences (left). CMR-replay encoded scrambled sequences as in the experiment. Consistent with empirical observation, subsequent replay in CMR-replay over-represents the true sequences (right). Error bars show <italic>±</italic> 1 standard error of the mean in the model. Images in <bold>a</bold> adapted from ref [<xref ref-type="bibr" rid="c16">16</xref>], Elsevier; left image in <bold>c</bold> adapted from ref [<xref ref-type="bibr" rid="c16">16</xref>], Elsevier; left image in <bold>d</bold> adapted from ref [<xref ref-type="bibr" rid="c22">22</xref>], Elsevier.</p></caption>
<graphic xlink:href="533833v4_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5:</label>
<caption><title>Variations in replay as a function of experience.</title>
<p><bold>a</bold>. In CMR-replay, through repeated exposure to the same task, the frequency of replay events decreases (left), the average length of replay events increases (middle), and the proportion of replay events that are backward remains stable (after a slight initial uptick; right). <bold>b</bold>. With repeated experience in the same task, animals exhibit lower rates of replay (left) and longer replay sequences (middle), while the proportion of replay events that are backward stays relatively stable (right). <bold>c</bold>. In a T-maze task, where animals display a preference for traversing a particular arm of the maze, replay more frequently reflects the opposite arm [<xref ref-type="bibr" rid="c24">24</xref>] (left). CMR-replay preferentially replays the right arm after exposure to the left arm and vice versa (right). Error bars show <italic>±</italic> 1 SEM in all panels. Images in <bold>b</bold> adapted from ref [<xref ref-type="bibr" rid="c32">32</xref>], Elsevier; left image in <bold>c</bold> adapted from [<xref ref-type="bibr" rid="c24">24</xref>], Nature Publishing Group.</p></caption>
<graphic xlink:href="533833v4_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2b">
<title>The context-dependency of memory replay</title>
<p>During quiescence, sequential neural firing during sharp-wave ripples (SWRs) recapitulates the temporal pattern of previous waking experience [<xref ref-type="bibr" rid="c4">4</xref>]. We distinguish between forward and backward replay, defined as neural activity that either preserves the order of a prior experience (forward replay) or reverses it (backward replay). In animals and humans, the content and directionality of replay systematically vary according to task contexts and behavioral states [<xref ref-type="bibr" rid="c35">35</xref>, <xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c36">36</xref>]. For example, animals tend to shift from forward to backward replay from the beginning to the end of a run [<xref ref-type="bibr" rid="c29">29</xref>], exhibit more forward replay during sleep [<xref ref-type="bibr" rid="c36">36</xref>], and show biased replay of memories associated with external cues during sleep [<xref ref-type="bibr" rid="c35">35</xref>]. Some of these observations have led investigators to posit distinct processes underlying forward and backward replay [<xref ref-type="bibr" rid="c58">58</xref>, <xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c59">59</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c32">32</xref>], with forward replay supporting planning at choice points [<xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c32">32</xref>] and backward replay encoding value expectations from reward outcomes [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c21">21</xref>]. Here we evaluate whether CMR-replay can account for these differential patterns under one framework, with replay always reflecting associations between items and contexts.</p>
<p>Animals first acquire experience with a linear track by traversing it to collect a reward. Then, during the pre-run rest recording, forward replay predominates [<xref ref-type="bibr" rid="c29">29</xref>]. In contrast, backward replay predominates during post-run rest, when the animal consumes its reward (see <xref rid="fig2" ref-type="fig">Fig. 2a</xref> left; [<xref ref-type="bibr" rid="c29">29</xref>]). We simulated this task by presenting CMR-replay with a sequence of items (<xref rid="fig7" ref-type="fig">Fig. 7a</xref>), each representing a distinct location. These item representations can be considered to correspond to place cells in rodents, whose activity is typically used to track replay. During post-run rest, we use the final item’s encoding context as an external cue for rest replay. For pre-run rest, the first item’s encoding context serves as the external cue for rest replay. Because of the external cue, awake rest replay initiates disproportionately at the item most strongly associated with the cue (<xref rid="fig1" ref-type="fig">Fig. 1e</xref>), which is consistent with a bias of awake replay to initiate at the resting location [<xref ref-type="bibr" rid="c60">60</xref>]. The conjunction of this initiation bias and the model’s contiguity bias entails that replay tends to unroll successively forward from the first item in pre-run rest and backward from the final item in post-run rest (<xref rid="fig2" ref-type="fig">Fig. 2a</xref> right) as in the data [<xref ref-type="bibr" rid="c29">29</xref>]. In our model, these patterns are identical to those in our simulation of Ambrose et al. [<xref ref-type="bibr" rid="c20">20</xref>], which uses two independent sequences to mimic the two run directions. This is because the drifting context resets before each run sequence is encoded, with the pause between runs acting as an event boundary that prevents the final item of one traversal from associating with the first item of the next, thereby keeping learning in each direction independent. In contrast to the EVB model [<xref ref-type="bibr" rid="c25">25</xref>], CMR-replay captures the graded nature of this phenomenon (<xref rid="fig2" ref-type="fig">Fig. 2a</xref> right): Forward and backward replay appear in both conditions [<xref ref-type="bibr" rid="c29">29</xref>]. All of the differences between conditions observed here, and across all simulations in the paper, are highly reliable (<italic>p &lt;</italic> 0.001 based on two-tailed t-tests, with runs of the model as random effects factor). Levels of significance are indicated in figures.</p>
<p>As with prior retrieved context models [<xref ref-type="bibr" rid="c33">33</xref>, <xref ref-type="bibr" rid="c34">34</xref>], CMR-replay encodes stronger forward than backward associations. This asymmetry exists because, during the first encoding of a sequence, an item’s associated context contributes only to its ensuing items’ encoding contexts. Therefore, after encoding, bringing back an item’s associated context is more likely to reactivate its ensuing than preceding items, leading to forward asymmetric replay (<xref rid="fig6" ref-type="fig">Fig. 6d</xref> left). Absent external cues, sleep replay is less likely to initiate at the final item than rest replay (<xref rid="fig1" ref-type="fig">Fig. 1e</xref>), allowing for more forward transitions. This leads to more forward replay during sleep than awake rest (<xref rid="fig2" ref-type="fig">Fig. 2b</xref> right), matching empirical observations [<xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c61">61</xref>, <xref ref-type="bibr" rid="c36">36</xref>] (<xref rid="fig2" ref-type="fig">Fig. 2b</xref> left). In contrast, the EVB model predicts a predominance of reverse replay before behavior stabilizes [<xref ref-type="bibr" rid="c25">25</xref>]. Note that the overall proportion of forward replay is higher in the model than these data, but consistent with that found in <xref ref-type="bibr" rid="c29">Diba and Buzsaki (2007)</xref>. Our model also predicts that deliberation on a specific memory, such as during planning, could serve to elicit an internal context cue that biases replay: actively recalling the first item of a sequence may favor forward replay, while thinking about the last item may promote backward replay, even when the individual is physically distant from the track. While not explored here, this mechanism presents a potential avenue for future modeling and empirical work.</p>
<p>We next asked whether CMR-replay can simulate Targeted Memory Reactivation (TMR) — the re-presentation of learning-related cues during sleep to encourage reactivation of the associated information. One study employed the TMR paradigm in rodents, associating distinct auditory cues (<italic>L</italic> and <italic>R</italic>) with left and right traversal of a linear track [<xref ref-type="bibr" rid="c35">35</xref>]. Playing each auditory cue during sleep elicited biased replay of place cell activity in the cued direction. We simulate these findings by encoding two sequences that share a start item. To simulate TMR, we presented a distinct cue item after each sequence’s start item during learning (<xref rid="fig7" ref-type="fig">Fig. 7e</xref>), and re-present each cue item (through its associated context) as an external cue in sleep. Matching Bendor and Wilson [<xref ref-type="bibr" rid="c35">35</xref>], CMR-replay preferentially replayed each cue’s associated sequence (<xref rid="fig2" ref-type="fig">Fig. 2c</xref> right). Bendor and Wilson [<xref ref-type="bibr" rid="c35">35</xref>] found that sound cues during sleep did not trigger immediate replay, but instead biased reactivation toward the cued sequence over an extended period of time. While the model does exhibit some replay triggered immediately by the cue, it also captures the sustained bias toward the cued sequence over an extended period.</p>
</sec>
<sec id="s2c">
<title>Effects of reward</title>
<p>At first glance, our proposal may seem at odds with extensive evidence of the influence of reward on replay [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>] because CMR-replay neither maintains nor updates value representations during replay. For example, studies suggest that replay over-represents experiences with rewarded or aversive outcomes [<xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c62">62</xref>, <xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c18">18</xref>] and awake reverse replay occurs primarily during reward receipt [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c21">21</xref>]. Reverse replay’s unique sensitivity to reward [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c23">23</xref>] appears to indicate a functional distinction between forward and backward replay, with backward replay specialized for learning value-based predictions [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c10">10</xref>].</p>
<p>We suggest that salience governs encoding rates, which aligns with evidence that salient stimuli bind more strongly to their context [<xref ref-type="bibr" rid="c63">63</xref>, <xref ref-type="bibr" rid="c64">64</xref>, <xref ref-type="bibr" rid="c65">65</xref>, <xref ref-type="bibr" rid="c66">66</xref>]. Building on models that adopt this assumption [<xref ref-type="bibr" rid="c46">46</xref>, <xref ref-type="bibr" rid="c47">47</xref>], CMR-replay updates <italic>M<sup>fc</sup></italic>and <italic>M<sup>cf</sup></italic> at higher rates for salient items, including those with high valence (reward or punishment) or novelty. In CMR-replay, increasing encoding rates strengthens replay in two distinct ways: Enhancing the <italic>M<sup>cf</sup></italic> encoding rate facilitates the reactivation of an item given features of its encoding context as cue, while enhancing the <italic>M<sup>fc</sup></italic> encoding rate facilitates the faithful retrieval of an item’s encoding context. Here, we explore whether these mechanisms allow CMR-replay to account for reward-related phenomena.</p>
<p>After visually exploring a T-maze with one arm containing reward, animals preferentially activated sequences representing the rewarded arm during sleep [<xref ref-type="bibr" rid="c18">18</xref>] (<xref rid="fig3" ref-type="fig">Fig. 3a</xref> left). We simulated this task by presenting CMR-replay with two sequences, one with a rewarded final item and the other with a neutral final item (<xref rid="fig7" ref-type="fig">Fig. 7d</xref>). Due to the influence of encoding rates, replay over-represents the rewarded item compared to the matched neutral item (<xref rid="fig3" ref-type="fig">Fig. 3a</xref> right) as in empirical observations [<xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>]. CMR-replay exhibits this property without the assumption that reward-associated items receive more exposure during encoding [<xref ref-type="bibr" rid="c50">50</xref>].</p>
<p>Varying the magnitude of reward at the end of a linear track significantly alters the number of backward but not forward replay events [<xref ref-type="bibr" rid="c20">20</xref>] (<xref rid="fig3" ref-type="fig">Fig. 3b</xref> left). Following Mattar and Daw [<xref ref-type="bibr" rid="c25">25</xref>], to disambiguate each location and the direction of a run, we simulated the task with two distinct input sequences, each with a final rewarded item. We manipulated the encoding rate of one rewarded item to be higher (i.e., high reward), lower (i.e., low reward), or identical to that of the reward item in the other sequence (i.e., normal reward). Since the encoding of the rewarded item primarily influences backward replay in post-run rest, we observed differences in the rate of backward but not forward replay between different reward conditions (<xref rid="fig3" ref-type="fig">Fig. 3b</xref> right), matching empirical observations [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c23">23</xref>].</p>
<p>CMR-replay’s ability to account for the effects of reward supports our proposal that reward modulates the initial encoding of memories to shape subsequent replay. After reward exerts its influence during encoding, prioritized replay of rewarded memories can occur even if reward-related activity is absent. Consistent with our proposal that replay itself does not require value-based computations, sleep’s preferential consolidation of reward memories does not seem to require dopaminergic activity [<xref ref-type="bibr" rid="c67">67</xref>], and the coordination between reward responsive neurons and replay-related events is absent in sleep [<xref ref-type="bibr" rid="c68">68</xref>]. Our model treats reward as simply the salient feature of an item, generating the prediction that non-reward-related salient items should exhibit similar characteristics.</p>
</sec>
<sec id="s2d">
<title>Replay goes beyond direct recent experience</title>
<p>We next asked whether CMR-replay can account for findings in which animals replay sequences learned outside of their present context. Several studies have established this so-called “remote replay” phenomenon [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c38">38</xref>]. Here we describe one such experiment and show how CMR-replay provides an account of its findings. In Gupta et al. [<xref ref-type="bibr" rid="c16">16</xref>], animals explored both arms of a T-maze during pre-training. During each subsequent recording session, animals traversed only the left or right arm (L- or R-only conditions) or alternated between them (alternation condition). During reward receipt on the just-explored arm, awake rest exhibited remote replay of the opposite, non-local arm (<xref rid="fig4" ref-type="fig">Fig. 4a</xref> left: remote replay) across all conditions [<xref ref-type="bibr" rid="c16">16</xref>]. This observation challenges models that prioritize items near the resting location [<xref ref-type="bibr" rid="c25">25</xref>] and recently active neurons [<xref ref-type="bibr" rid="c69">69</xref>, <xref ref-type="bibr" rid="c70">70</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c71">71</xref>] throughout replay. To determine whether CMR-replay can reproduce these results, we presented the model with sequences that overlap for the first few items (representing the central arm of the T-maze; <xref rid="fig7" ref-type="fig">Fig. 7c</xref>). During each of two simulated “pre-training” sessions, the model encoded both sequences. We then ran the model through two conditions in an ensuing “experimental” session, where it encoded either only one (L or R -only conditions) or both sequences (alternation condition). After encoding the sequences, we simulated reward receipt by presenting CMR-replay with the encoding context of a rewarded item as an external context cue. As in Gupta et al. [<xref ref-type="bibr" rid="c16">16</xref>], CMR-replay is able to generate remote replay of the non-local sequence (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>, left; <xref rid="fig4" ref-type="fig">Fig. 4c</xref>, right). When CMR-reactivates a non-local item by chance, replay context dramatically shifts by incorporating the non-local item’s associated context, thereby triggering a cascade of non-local item reactivation to generate remote replay. Due to its suppression mechanism, CMR-replay is able to capture the higher prevalence of remote replay in L and R -only conditions (<xref rid="fig4" ref-type="fig">Fig. 4c</xref>, right), which we will unpack in a subsequent section. The occurrence of remote replay, however, does not rely on the suppression mechanism, as the model generates remote replay in the alternation condition where suppression is matched across local and non-local items.</p>
<p>We next examined whether replay in CMR-replay can link temporally-separated experiences to form novel sequences that go beyond direct experience [<xref ref-type="bibr" rid="c37">37</xref>, <xref ref-type="bibr" rid="c50">50</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c72">72</xref>, <xref ref-type="bibr" rid="c22">22</xref>]. Gupta et al. [<xref ref-type="bibr" rid="c16">16</xref>] showed the occurrence of novel, shortcut replay sequences. These shortcut sequences cut directly across the choice point and link segments of the two arms of a T-maze during rest (<xref rid="fig4" ref-type="fig">Fig. 4a</xref> right: shortcut replay), even though animals never directly experienced such trajectories [<xref ref-type="bibr" rid="c16">16</xref>]. In our simulation of the study [<xref ref-type="bibr" rid="c16">16</xref>], CMR-replay also generates novel rest replay that links segments of the two sequences (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>, right): The reactivation of the juncture of the two sequences (the top middle item of <xref rid="fig7" ref-type="fig">Fig. 7c</xref>) brings back context common to the two sequences, allowing replay to stitch together segments of the two sequences. In line with Gupta et al. [<xref ref-type="bibr" rid="c16">16</xref>], shortcut replay appeared at very low rates in CMR-replay (the alternation condition: mean proportion of replay events that contain shortcut sequence = 0.0046; L or R conditions: mean proportion = 0.0062).</p>
<p>Liu et al. [<xref ref-type="bibr" rid="c22">22</xref>] showed that replay in humans reorganizes temporally-separated wake inputs. In their first experiment, participants encoded sequences that scrambled pairwise transitions of two true sequences <italic>X</italic><sub>1</sub><italic>X</italic><sub>2</sub><italic>X</italic><sub>3</sub><italic>X</italic><sub>4</sub> and <italic>Y</italic><sub>1</sub><italic>Y</italic><sub>2</sub><italic>Y</italic><sub>3</sub><italic>Y</italic><sub>4</sub>: <italic>X</italic><sub>1</sub><italic>X</italic><sub>2</sub><italic>Y</italic><sub>1</sub><italic>Y</italic><sub>2</sub>, <italic>X</italic><sub>2</sub><italic>X</italic><sub>3</sub><italic>Y</italic><sub>2</sub><italic>Y</italic><sub>3</sub>, and <italic>X</italic><sub>3</sub><italic>X</italic><sub>4</sub><italic>Y</italic><sub>3</sub><italic>Y</italic><sub>4</sub>. To highlight transitions from the true sequences, the time lag between those transitions (e.g., <italic>X</italic><sub>2</sub><italic>X</italic><sub>3</sub>) was shorter than others (e.g., <italic>X</italic><sub>3</sub><italic>Y</italic><sub>2</sub>) during presentation. Analyses revealed preferential replay of the true as opposed to the scrambled sequences [<xref ref-type="bibr" rid="c22">22</xref>] (<xref rid="fig4" ref-type="fig">Fig. 4d</xref>, left). We simulated the experiment by presenting CMR-replay with sequences of the same structure (<xref rid="fig7" ref-type="fig">Fig. 7g</xref>), where context drifted more for longer interstimulus intervals. After learning, the model performed replay in the absence of external context cues. The quantification of replay in Liu et al. [<xref ref-type="bibr" rid="c22">22</xref>], which reflects statistical evidence of replay decoding based on magnetoencephalography (MEG) data, differs from our measure, where we have direct access to replay without measurement noise. However, qualitatively matching Liu et al. [<xref ref-type="bibr" rid="c22">22</xref>], CMR-replay preferentially replays true sequences relative to scrambled sequences (<xref rid="fig4" ref-type="fig">Fig. 4d</xref>, right).</p>
</sec>
<sec id="s2e">
<title>The influence of experience</title>
<p>Task exposure influences replay, with replay appearing less frequently in familiar as compared with novel environments [<xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c73">73</xref>, <xref ref-type="bibr" rid="c74">74</xref>, <xref ref-type="bibr" rid="c71">71</xref>]. Task repetition similarly reduces replay [<xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c32">32</xref>]. After gaining experience along multiple trajectories, animals and humans can exhibit enhanced replay of non-recently explored trajectories [<xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c30">30</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c39">39</xref>]. Overall, these findings demonstrate a negative relationship between the degree and recency of experience and the frequency of replay. This pattern challenges models in which experience monotonically enhances the reactivation of items [<xref ref-type="bibr" rid="c69">69</xref>, <xref ref-type="bibr" rid="c70">70</xref>, <xref ref-type="bibr" rid="c50">50</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c71">71</xref>].</p>
<p>In CMR-replay, experience shapes replay in two opposing ways. First, repetition strengthens <italic>M<sup>fc</sup></italic>and <italic>M<sup>cf</sup></italic>, allowing replay to better preserve the temporal structure of waking inputs. Second, by enhancing <italic>M<sup>fc</sup></italic>, repetition increases the activity of contexts associated with items. Since CMR-replay suppresses the activity of items at the onset of replay as a function of their activity during learning, repetition increases the downweighting of the activity of task items, reducing their probability of reactivation. Such a suppression mechanism may be adaptive, allowing replay to benefit not only the most recently or strongly encoded items but also to provide opportunities for the consolidation of weaker or older memories, consistent with empirical evidence [<xref ref-type="bibr" rid="c75">75</xref>, <xref ref-type="bibr" rid="c76">76</xref>].</p>
<p>The next set of simulations illustrates CMR-replay’s account of experience-dependent changes in replay [<xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c32">32</xref>]. We first examined how replay changes through repeated encoding of the same inputs following our linear track simulation illustrated in <xref rid="fig7" ref-type="fig">Fig. 7a</xref>. Here, CMR-replay encodes the same sequence across learning sessions, with awake rest after each session. Initially, experience increases the prevalence of replay (<xref rid="fig5" ref-type="fig">Fig. 5a</xref>: left). As repetition enhances the suppression of task-related items at the onset of replay, replay frequency subsequently decreases in CMR-replay (<xref rid="fig5" ref-type="fig">Fig. 5a</xref>: left). Through experience, the average length of replay increases (<xref rid="fig5" ref-type="fig">Fig. 5a</xref>: middle), suggesting that repetition strengthens sequence memory in the model. In contrast to the EVB model [<xref ref-type="bibr" rid="c25">25</xref>], which predicts a differential drop in the rate of backward relative to forward replay, the proportion of replay events that are backward does not decrease (<xref rid="fig5" ref-type="fig">Fig. 5a</xref> right) in CMR-replay. This result highlights that, unlike the EVB model, CMR-replay does not employ distinct variables to drive forward versus backward replay.</p>
<p>In an experiment where animals learned the same task across eight behavioral sessions, Shin et al. [<xref ref-type="bibr" rid="c32">32</xref>] observed a similar pattern of results. As shown in <xref rid="fig5" ref-type="fig">Figure 5b</xref>, animals exhibited lower rates of replay but longer replay sequences in later sessions (left, middle). As in our CMR-replay simulations, as the rates of forward and backward replay both decrease, the proportion of forward relative to backward replay events remains relatively stable across sessions (right). Furthermore, consistent with reduced reactivation of task-related units in CMR-replay, the study observed decreased reactivation of task-related place cells through experience. In contrast, item reactivation increases monotonically through repetition in other models [<xref ref-type="bibr" rid="c50">50</xref>, <xref ref-type="bibr" rid="c25">25</xref>]. Shin et al. [<xref ref-type="bibr" rid="c32">32</xref>] performed Bayesian decoding to statistically quantify evidence of replay, whereas our analyses directly compare segments of a behavioral sequence with replay sequences. Despite differences between these measures, the patterns of results in the data and in the model match qualitatively. Several other studies using varied experimental procedures have reported similar effects of repeated experience on replay, including a reduction in the prevalence of replay [<xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c29">29</xref>], an increase in replay length [<xref ref-type="bibr" rid="c40">40</xref>], and no reduction in the proportion of replay events that are backward [<xref ref-type="bibr" rid="c31">31</xref>].</p>
<p>In CMR-replay, the activity of retrieved contexts associated with items in a learning session modulates the level of item suppression during ensuing quiescence. As a result, items that get more exposure in a session may receive more suppression than others at the onset of replay, facilitating the reactivation of their competitors. In our simulation of [<xref ref-type="bibr" rid="c16">16</xref>] (<xref rid="fig7" ref-type="fig">Fig. 7c</xref>), in the L and R -only conditions, since the sequence presented during learning receives more suppression, remote replay is more prevalent than in the alternation condition, where both sequences appear during learning (<xref rid="fig4" ref-type="fig">Fig. 4c</xref>). In the L or R -only conditions, when CMR-replay performs post-learning replay in the absence of external context cues, replay over-represents the alternative sequence (<xref rid="fig5" ref-type="fig">Fig. 5c</xref>), which aligns with the observation that replay exhibits a bias away from the arm of a T-maze that animals preferred during behavior [<xref ref-type="bibr" rid="c24">24</xref>]. This property is also consonant with recent findings that replay preferentially activates non-recent trajectories [<xref ref-type="bibr" rid="c30">30</xref>].</p>
</sec>
<sec id="s2f">
<title>The function of replay</title>
<p>Many have proposed adaptive functions for replay, including for memory consolidation [<xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c77">77</xref>], retrieval [<xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c78">78</xref>], credit assignment [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c26">26</xref>], and planning [<xref ref-type="bibr" rid="c79">79</xref>, <xref ref-type="bibr" rid="c80">80</xref>, <xref ref-type="bibr" rid="c81">81</xref>]. Growing causal evidence suggests that replay benefits memory: TMR enhances memory [<xref ref-type="bibr" rid="c82">82</xref>], and disrupting SWRs impairs memory [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c12">12</xref>]. Replay facilitates offline learning in our model by updating <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic> according to the internally-reactivated items and contexts during replay. In the following set of simulations, we characterize ways in which replay facilitates memory in the model.</p>
<p>One of the most robust benefits of sleep is on sequence memory, often studied with motor sequence paradigms [<xref ref-type="bibr" rid="c43">43</xref>]. To simulate the impacts of sleep replay on sequence memory, we presented CMR-replay with a five-item sequence and examined whether sleep enhanced memory of the sequence. Before and after sleep, we assessed the proportion of replay sequences that matched the input sequence. The assessment occurred in “test” periods, where learning rates were set to zero and external cues were absent. In post-sleep test, CMR-replay generated a higher proportion of sequences matching the correct sequence than in pre-sleep test (<xref rid="fig6" ref-type="fig">Fig. 6a</xref>), indicating that sleep enhances sequence memory in the model. This motor memory simulation using a model of hippocampal replay is consistent with evidence that hippocampal replay can contribute to consolidating memories that are not hippocampally dependent at encoding [<xref ref-type="bibr" rid="c83">83</xref>, <xref ref-type="bibr" rid="c84">84</xref>]. It is possible that replay in other, more domain-specific areas could also contribute [<xref ref-type="bibr" rid="c85">85</xref>].</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6:</label>
<caption><title>Learning from replay.</title>
<p><bold>a</bold>. Sleep increased the likelihood of reactivating the learned sequence in the correct temporal order in CMR-replay, as seen in an increase in the proportion of replay for learned sequences post-sleep. <bold>b</bold>. Sleep leads to greater reactivation of rewarded than non-rewarded items, indicating that sleep preferentially strengthens rewarded memories in CMR-replay. <bold>c</bold>. In the simulation of Liu et al. [<xref ref-type="bibr" rid="c10">10</xref>], CMR-replay encoded six sequences, each of which transitioned from one of three start items to one of two end items. After receiving a reward outcome for the end item of a sequence, we simulated a period of rest. After but not before rest, CMR-replay exhibited a preference for non-local sequences that led to the rewarded item. This preference emerged through rest despite the fact that the model never observed reward in conjunction with those non-local sequences, suggesting that rest replay facilitates non-local learning in the model. <bold>d</bold>. We trained a “teacher” CMR-replay model on a sequence of items. After encoding the sequence, the teacher generated replay sequences during sleep. We then trained a separate blank-slate “student” CMR-replay model exclusively on the teacher’s sleep replay sequences. To assess knowledge of the original sequence, we collected sleep replay sequences from both models, and assessed the probability that each model reactivates the item at position <italic>i</italic> + lag of the sequence immediately following the reactivation of the i-th item of the sequence, conditioned on the availability of the i-th item for reactivation. Both models demonstrated a tendency to reactivate the item that immediately follows or precedes the just-reactivated item on the original sequence. This result suggests that the student acquired knowledge of the temporal structure of original sequence by encoding only the teacher’s replay sequences. Error bars show <italic>±</italic> 1 SEM.</p></caption>
<graphic xlink:href="533833v4_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Replay preferentially enhances rewarded memories [<xref ref-type="bibr" rid="c23">23</xref>], and sleep preferentially consolidates salient experiences [<xref ref-type="bibr" rid="c44">44</xref>, <xref ref-type="bibr" rid="c45">45</xref>]. In our simulation of a T-maze with reward in one of the two arms [<xref ref-type="bibr" rid="c18">18</xref>], we also included pre- and post-sleep test periods to assess how sleep in CMR-replay shapes rewarded versus non-rewarded memory. Through sleep, CMR-replay exhibited a greater increase in its reactivation of the rewarded item compared to a matched neutral item (<xref rid="fig6" ref-type="fig">Fig. 6b</xref>), suggesting that sleep preferentially enhances memory associations for rewarded items in CMR-replay.</p>
<p>A recent study [<xref ref-type="bibr" rid="c10">10</xref>] presented evidence that replay facilitates non-local value learning. Human participants first learned about the structure of six sequences, each of which begins with one of three start items and terminates with one of two end items. Then, for two sequences that share a start state, participants learned that only one of them leads to reward. After a period of rest during which replay was measured with MEG, among the other four sequences (i.e., the non-local sequences), participants exhibited a behavioral preference for sequences that terminate in the end item associated with reward, despite no direct recent experience with reward in that sequence. The authors suggested that, in accordance with the RL perspective, replay propagates value to associated items, allowing participants to select non-local sequences associated with reward without direct experience. In our simulation of this paradigm, CMR-replay encoded six sequences of the same structure (<xref rid="fig7" ref-type="fig">Fig. 7b</xref>), with increased encoding rates to simulate reward receipt, as in the simulations above. To simulate awake rest after reward receipt, we presented the encoding context of the rewarded item as an external cue. Before and after rest, we examined the model’s preference among the four non-local sequences, by assessing how much the model activated each non-local start item’s two ensuing items given the start item’s associated context as a cue. After but not before rest, CMR-replay preferentially activated the item that leads to the rewarded end item (<xref rid="fig6" ref-type="fig">Fig. 6c</xref>). This is because the presence of the rewarded item as an external cue evokes the reactivation of its associated non-local items. In CMR-replay, this preference emerged without value updates, suggesting that replay can facilitate non-local learning by re-organizing memory associations.</p>
<p>There has been much interest in the memory literature in the possibility that hippocampal replay serves to train neocortical systems to represent recent memories [<xref ref-type="bibr" rid="c86">86</xref>, <xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c69">69</xref>, <xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c56">56</xref>, <xref ref-type="bibr" rid="c77">77</xref>, <xref ref-type="bibr" rid="c51">51</xref>, <xref ref-type="bibr" rid="c87">87</xref>]. We explored whether replay in CMR-replay can serve to transfer one model’s knowledge to another. After a “teacher” CMR-replay encodes a sequence, we collected its sleep replay sequences to train a blank-slate “student” CMR-replay at replay’s learning rates. Through this process, the student inherited the contiguity bias of the teacher (<xref rid="fig6" ref-type="fig">Fig. 6d</xref>), suggesting it acquired knowledge of the structure of the teacher’s training sequence. This simulation provides a proof of concept that replay in CMR-replay can serve to facilitate memory transfer across systems, in addition to promoting local learning. More broadly, these results resonate with ideas from the Complementary Learning Systems framework, which proposes that replay allows the neocortex to learn from hippocampal activity by integrating related experiences. We speculate that the offline learning observed in these simulations corresponds to consolidation processes that operate specifically during sleep, when hippocampal-neocortical dynamics are especially tightly coupled [<xref ref-type="bibr" rid="c1">1</xref>].</p>
<p>The results outlined above arise from the model’s assumption that replay strengthens bidirectional associations between items and contexts to benefit memory. This assumption leads to several predictions about differences across replay types. First, the model predicts that sleep yields different memory benefits compared to rest in the task environment: Sleep is less biased toward initiating replay at specific items, resulting in a more uniform benefit across all memories. Second, the model predicts that forward and backward replay contribute to memory in qualitatively similar ways but tend to benefit different memories. This divergence arises because forward and backward replay exhibit distinct item preferences, with backward replay being more likely to include rewarded items, thereby preferentially benefiting those memories.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>What is the nature and function of neural replay? We suggest a simple memory-focused framework that explains a wide array of replay phenomena. First, the brain associates experiences with their encoding contexts at rates that vary according to the salience of each experience. Then, in quiescence, the brain replays by spontaneously reactivating a memory and retrieving its associated context to guide subsequent reactivation. Learning continues to occur during these endogenously generated reactivation events. A model embodying these ideas — CMR-replay — explains many qualitative empirical characteristics of replay and its impacts, including patterns previously interpreted as features of reinforcement learning computations, and observations that prior models do not explain.</p>
<p>First, CMR-replay demonstrates basic properties of replay that other models exhibit (or could easily accommodate) [<xref ref-type="bibr" rid="c50">50</xref>, <xref ref-type="bibr" rid="c59">59</xref>, <xref ref-type="bibr" rid="c72">72</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c88">88</xref>], including replay’s recapitulation of the temporal pattern of past experience during rest and sleep [<xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c36">36</xref>], bias toward memories associated with external cues [<xref ref-type="bibr" rid="c35">35</xref>], and ability to stitch together temporally-separated experiences to form novel sequences [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c22">22</xref>]. Second, CMR-replay captures findings that have been interpreted as evidence that replay serves value-based reinforcement learning, including over-representation of memories associated with reward [<xref ref-type="bibr" rid="c18">18</xref>], reverse replay upon reward receipt [<xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c21">21</xref>], and the unique sensitivity of reverse replay to reward magnitude [<xref ref-type="bibr" rid="c20">20</xref>]. Third, CMR-replay accounts for observations that are not naturally accounted for by prior models, including a stable proportion of backward replay through learning [<xref ref-type="bibr" rid="c32">32</xref>], reduced item reactivation and sequential replay with experience [<xref ref-type="bibr" rid="c32">32</xref>, <xref ref-type="bibr" rid="c28">28</xref>], increased prevalence of forward replay in sleep [<xref ref-type="bibr" rid="c36">36</xref>], enhanced replay outside of the current context [<xref ref-type="bibr" rid="c16">16</xref>], and a tendency for replay to cover non-behaviorally-preferred experiences [<xref ref-type="bibr" rid="c24">24</xref>]. Finally, replay facilitates memory in CMR-replay in ways that align with empirical findings [<xref ref-type="bibr" rid="c43">43</xref>, <xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c45">45</xref>, <xref ref-type="bibr" rid="c44">44</xref>, <xref ref-type="bibr" rid="c89">89</xref>]. These include the improvement of sequence memory, preferential strengthening of rewarded memories, facilitation of non-local learning, and endogenous training of a separate memory system in the absence of external inputs.</p>
<p>The EVB model and CMR-replay offer different types of explanation for why replay exhibits its disparate characteristics: The EVB model provides an explicitly normative explanation, whereas CMR-replay offers a mechanistic account. The different levels of explanation raises the possibility that CMR-replay could be considered a mechanistic implementation of EVB. Indeed, there are several shared properties between the models [<xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c20">20</xref>]. However, as discussed above, CMR-replay captures observations that appear inconsistent with the EVB model, including the prevalence of non-local replay, the decoupling of replay from behavioral preference, and similar proportions of forward and backward replay over time. In addition to these existing observations, the two models make distinct predictions that can be tested experimentally. For example, in tasks where the goal is positioned in the middle of an arm rather than at its end, CMR-replay predicts a more balanced ratio of forward and reverse replay, whereas the EVB model still predicts a dominance of reverse replay due to backward gain propagation from the reward. This contrast aligns with empirical findings showing that when the goal is located in the middle of an arm, replay events are more evenly split between forward and reverse directions [<xref ref-type="bibr" rid="c16">16</xref>], whereas placing the goal at the end of a track produces a stronger bias toward reverse replay [<xref ref-type="bibr" rid="c29">29</xref>]. Moreover, the EVB model predicts that reward only modulates the rate of replay when it informs potential change in behavior, whereas CMR-replay considers reward as a salient feature that enhances replay by facilitating associations between item and context. Thus, in scenarios where animals cannot choose between competing actions (e.g., when there are only deterministic paths), CMR-replay but not the EVB model predicts that reward manipulation would lead to changes in the rate of replay. CMR-replay also predicts that salient non-rewarding events should lead to similar patterns of replay as rewarded events. While not explicitly normative, CMR-replay does offer an explanation of the goal of replay, which is to improve memory through offline local learning and systems interactions. CMR-replay posits that replay may facilitate building a stable, unbiased understanding of the environment useful for many different possible future tasks, some of which may be difficult for an animal to predict and therefore optimize in advance [<xref ref-type="bibr" rid="c90">90</xref>].</p>
<p>An ongoing debate concerns to what extent awake replay reflects a process of planning that simulates future scenarios in support of immediate decision-making [<xref ref-type="bibr" rid="c81">81</xref>, <xref ref-type="bibr" rid="c79">79</xref>, <xref ref-type="bibr" rid="c80">80</xref>], versus to what extent it serves to store, update, and maintain memory without directly guiding behavior [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c91">91</xref>, <xref ref-type="bibr" rid="c92">92</xref>]. Evidence supporting the planning hypothesis comes from studies that demonstrate enhanced replay of upcoming behavioral trajectories [<xref ref-type="bibr" rid="c81">81</xref>, <xref ref-type="bibr" rid="c93">93</xref>]. However, in tasks that track representations of multiple temporally- and spatially-separated experiences, animals exhibit replay that appears to be decoupled from their behavioral preference [<xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c30">30</xref>, <xref ref-type="bibr" rid="c16">16</xref>]. Our model aligns more with the memory perspective, as it is able to capture existing findings without positing that replay serves to optimize behavioral outcome. However, replay of this kind could at times be read out and used by downstream decision-making systems. For example, recent work argues that the dynamics of the retrieval processes in this class of models could support adaptive choice in sequential decision tasks [<xref ref-type="bibr" rid="c94">94</xref>]. Overall, our framework argues that replay characteristics are primarily driven by memory principles, and that replay serves to strengthen and reorganize memories, which benefits subsequent — but not necessarily immediate — behavior [<xref ref-type="bibr" rid="c30">30</xref>, <xref ref-type="bibr" rid="c91">91</xref>].</p>
<p>Many memory consolidation theories are aligned with CMR-replay in suggesting that replay actively strengthens and re-organizes memories [<xref ref-type="bibr" rid="c95">95</xref>, <xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c69">69</xref>, <xref ref-type="bibr" rid="c96">96</xref>, <xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c77">77</xref>, <xref ref-type="bibr" rid="c51">51</xref>]. Contextual binding theory [<xref ref-type="bibr" rid="c97">97</xref>], however, takes a different approach, suggesting that residual encoding-related activity elicits merely epiphenomenal replay as context drifts during quiescence. Our theory echoes this perspective in characterizing replay as an outcome of context-guided processes. However, we diverge from the perspective in suggesting that the emergent replay does significantly benefit memory by strengthening learned associations between items and contexts. Our proposal aligns with a recent TMR study showing that the recapitulation of items’ associated contexts during sleep drives changes in memory in humans [<xref ref-type="bibr" rid="c98">98</xref>]. Our model also captures observations of enhanced replay of infrequent and remote experiences, which are in tension with the perspective that replay is primarily guided by recent activity [<xref ref-type="bibr" rid="c95">95</xref>].</p>
<p>Several recent studies have argued for dominance of semantic associations over temporal associations in the process of human sleep-dependent consolidation [<xref ref-type="bibr" rid="c99">99</xref>, <xref ref-type="bibr" rid="c100">100</xref>, <xref ref-type="bibr" rid="c101">101</xref>], with one study observing no role at all for temporal associations [<xref ref-type="bibr" rid="c99">99</xref>]. At first glance, these findings appear in tension with our model, where temporal associations drive offline consolidation. Indeed, prior models have accounted for these findings by suppressing temporal context during sleep [<xref ref-type="bibr" rid="c102">102</xref>, <xref ref-type="bibr" rid="c101">101</xref>]. However, earlier models in the CMR lineage have successfully captured the joint contributions of semantic and temporal associations to encoding and retrieval [<xref ref-type="bibr" rid="c34">34</xref>], and these processes could extend naturally to offline replay. In a paradigm where semantic associations are especially salient during awake learning, the model could weight these associations more and account for greater co-reactivation and sleep-dependent memory benefits for semantically related than temporally related items. Consistent with this idea, Schechtman et al. [<xref ref-type="bibr" rid="c99">99</xref>] speculated that their null temporal effects likely reflected the task’s emphasis on semantic associations. When temporal associations are more salient and task-relevant, sleep-related benefits for temporally contiguous items are more likely to emerge [<xref ref-type="bibr" rid="c103">103</xref>, <xref ref-type="bibr" rid="c43">43</xref>].</p>
<p>Our model has mainly considered replay occurring during sharp wave ripples [<xref ref-type="bibr" rid="c15">15</xref>]. During active behavior in rodents, ordered place cell sequences also activate during the theta oscillation (theta sequences) [<xref ref-type="bibr" rid="c104">104</xref>]. Similar to ripple-based replay, theta sequences manifest in both forward- and reverse-order [<xref ref-type="bibr" rid="c105">105</xref>], initiate at the animal’s location, extend further into upcoming locations through experience [<xref ref-type="bibr" rid="c106">106</xref>, <xref ref-type="bibr" rid="c107">107</xref>, <xref ref-type="bibr" rid="c108">108</xref>, <xref ref-type="bibr" rid="c109">109</xref>], cluster around behaviorally-relevant items [<xref ref-type="bibr" rid="c110">110</xref>], and have been proposed to correspond to cued memory retrieval [<xref ref-type="bibr" rid="c111">111</xref>]. These parallels lead us to speculate that the context-driven mechanisms we have laid out for findings of replay mainly during sharp wave ripples may also be relevant in understanding theta sequences, though future work will be needed to extend the model into this domain.</p>
<p>Our model implements an activity-dependent suppression mechanism that, at the onset of each offline replay event, assigns each item a selection probability inversely proportional to its activation during preceding wakefulness. The brain could implement this by tagging each memory trace in proportion to its recent activation; during consolidation, that tag would then regulate starting replay probability, making highly active items less likely to be reactivated. A recent paper found that replay avoids recently traversed trajectories through awake spike-frequency adaptation [<xref ref-type="bibr" rid="c112">112</xref>], which could implement this kind of mechanism. In our simulations, this suppression is essential for capturing the inverse relationship between replay frequency and prior experience. Note that, unlike the synaptic homeostasis hypothesis [<xref ref-type="bibr" rid="c113">113</xref>], which proposes that the brain globally downscales synaptic weights during sleep, this mechanism leaves synaptic weights unchanged and instead biases the selection process during replay.</p>
<p>Another important area for future work is to investigate how components of CMR-replay map onto map onto brain areas and their interactions. First, our model employs a series of bidirectional operations between context and item representations to generate replay. These operations might be implemented within the recurrent connections of CA3 in the case of temporally-compressed sharp wave ripple replay. It is possible that these interactions could also play out across the “big loop” of the hippocampus [<xref ref-type="bibr" rid="c72">72</xref>] or within cortical circuits [<xref ref-type="bibr" rid="c114">114</xref>, <xref ref-type="bibr" rid="c115">115</xref>, <xref ref-type="bibr" rid="c116">116</xref>, <xref ref-type="bibr" rid="c117">117</xref>], which could correspond to slower forms of replay [<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c118">118</xref>]. Second, in CMR-replay, the key distinction between awake rest and sleep is whether external inputs bias the initial activation state <italic>a</italic><sub>0</sub> of the replay process. This simple distinction allows the model to account for key empirical differences between awake and sleep replay. The distinction aligns with the observation that disrupting entorhinal cortex input to the hippocampus affects only awake replay whereas manipulating hippocampal subfield CA3 activity affects both awake and sleep replay [<xref ref-type="bibr" rid="c119">119</xref>]. Our view aligns with the theory proposed by Hasselmo [<xref ref-type="bibr" rid="c120">120</xref>], which suggests that the degree of hippocampal activity driven by external inputs differs between waking and sleep states: High acetylcholine levels during wakefulness bias activity into the hippocampus, while low acetylcholine levels during slow-wave sleep allow hippocampal activity to influence other brain regions. Other factors, such as task engagement, may also modulate the influence of external inputs on replay [<xref ref-type="bibr" rid="c121">121</xref>]. Third, in quiescence, we posit that the hippocampus can serve as a “teacher” that endogenously samples memory sequences to help establish these associations in neocortical areas, with local context-item loops within the teacher and student areas. This process may be most likely to take place during NREM sleep, when ripples, spindles, and slow oscillations may coordinate replay between the hippocampus and neocortical areas [<xref ref-type="bibr" rid="c1">1</xref>].</p>
<p>Our current simulations have focused on NREM, since the vast majority of electrophysiological studies of sleep replay have identified replay events in this stage. We have proposed in other work that replay during REM sleep may provide a complementary role to NREM sleep, allowing neocortical areas to reinstate remote, already-consolidated memories that need to be integrated with the memories that were recently encoded in the hippocampus and replayed during NREM [<xref ref-type="bibr" rid="c51">51</xref>]. An extension of our model could undertake this kind of continual learning setup, where the student but not teacher network retains remote memories, and the driver of replay alternates between hippocampus (NREM) and cortex (REM) over the course of a night of simulated sleep. Other differences between stages of sleep and between sleep and wake states are likely to become important for a full account of how replay impacts memory. Our current model parsimoniously explains a range of differences between awake and sleep replay by assuming simple differences in initial conditions, but we expect many more characteristics of these states (e.g., neural activity levels, oscillatory profiles, neurotransmitter levels, etc.) will be useful to incorporate in the future.</p>
<p>There exists a range of computational models of replay that vary in biological plausibility, from biologically detailed frameworks capturing synaptic and spiking dynamics to more abstract, algorithmic approaches [<xref ref-type="bibr" rid="c122">122</xref>, <xref ref-type="bibr" rid="c58">58</xref>, <xref ref-type="bibr" rid="c123">123</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c124">124</xref>, <xref ref-type="bibr" rid="c125">125</xref>, <xref ref-type="bibr" rid="c126">126</xref>, <xref ref-type="bibr" rid="c50">50</xref>, <xref ref-type="bibr" rid="c127">127</xref>, <xref ref-type="bibr" rid="c59">59</xref>, <xref ref-type="bibr" rid="c72">72</xref>, <xref ref-type="bibr" rid="c80">80</xref>, <xref ref-type="bibr" rid="c128">128</xref>, <xref ref-type="bibr" rid="c129">129</xref>, <xref ref-type="bibr" rid="c77">77</xref>, <xref ref-type="bibr" rid="c130">130</xref>, <xref ref-type="bibr" rid="c51">51</xref>, <xref ref-type="bibr" rid="c90">90</xref>]. CMR-replay falls toward the latter end of the spectrum, providing a high-level description of a mechanism that accounts for replay phenomena without simulating realistic spiking, synaptic, or membrane potential mechanisms. Aspects of the model, such as its lack of regulation of the cumulative positive weight changes that can accrue through repeated replay, are biologically implausible (as biological learning results in both increases and decreases in synaptic weights) and limit the ability to engage with certain forms of low level neural data (e.g., changes in spine density over sleep periods; [<xref ref-type="bibr" rid="c131">131</xref>, <xref ref-type="bibr" rid="c132">132</xref>]). It will be useful for future work to explore model variants with more elements of biological plausibility to help span across these styles of model and levels of analysis.</p>
<p>Our theory builds on a lineage of memory-focused models, demonstrating the power of this perspective in explaining phenomena that have often been attributed to the optimization of value-based predictions. In this work, we focus on CMR-replay, which exemplifies the memory-centric approach through a set of simple and interpretable mechanisms that we believe are broadly applicable across memory domains. Elements of CMR-replay share similarities with other models that adopt a memory-focused perspective. The model learns distributed context representations whose overlaps encodes associations among items, echoing associative learning theories in which overlapping patterns capture stimulus similarity and learned associations [<xref ref-type="bibr" rid="c133">133</xref>]. Context evolves through bidirectional interactions between items and their contextual representations, mirroring the dynamics found in recurrent neural networks [<xref ref-type="bibr" rid="c127">127</xref>, <xref ref-type="bibr" rid="c124">124</xref>]. These related approaches have not been shown to account for the present set of replay findings and lack mechanisms — such as reward-modulated encoding and experience-dependent suppression — that our simulations suggest are essential for capturing these phenomena, but we believe these mechanisms could be integrated into architectures like recurrent neural networks [<xref ref-type="bibr" rid="c124">124</xref>] in the future to support a broader range of replay dynamics. Furthermore, by building on established models of memory retrieval, CMR-replay naturally aligns with recent theories suggesting that offline reactivation and online retrieval may have similar underlying mechanisms and utility for behavior [<xref ref-type="bibr" rid="c134">134</xref>]. In sum, our theory unifies a wide range of empirical findings under a memory-focused account, offering an integrative and mechanistic framework for how the brain initially encodes and later replays memories to support behavior.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Representation and Initialization</title>
<p>CMR-replay comprises four components as in previous retrieved-context models [<xref ref-type="bibr" rid="c33">33</xref>, <xref ref-type="bibr" rid="c34">34</xref>]: item (<italic>f</italic>), context (<italic>c</italic>), item-to-context associations (<italic>M<sup>fc</sup></italic>), and context-to-item associations (<italic>M<sup>cf</sup></italic>). During both awake encoding and replay, <italic>f</italic> represents the current item (i.e., an external input presented during awake learning or a reactivated item during replay). <italic>c</italic> represents a recency-weighted sum of contexts associated with past and present items. During both awake encoding and replay, CMR-replay associates each item with its current encoding context by updating two sets of weights <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic>. <italic>M<sup>fc</sup></italic> represents item-to-context associations that support the retrieval of an item’s associated context. <italic>M<sup>cf</sup></italic> represents context-to-item associations that enable the retrieval of a context’s associated items.</p>
<p>CMR-replay employs a one-hot representation of <italic>f</italic> (i.e., a localist item representation): Each item is represented by a vector of length <italic>n</italic> in which only the unit representing the item is on (i.e., has an activity of 1) and all other units are off. As illustrated in <xref rid="fig1" ref-type="fig">Fig. 1</xref>, in addition to task-related items shown as inputs during learning, we include task-irrelevant items that do not appear as inputs during awake encoding, but compete with task-relevant items for reactivation during replay, thereby introducing competition during retrieval and reactivation and mimicking memories of items that do not belong to an ongoing experiment. We use <italic>n<sub>task</sub></italic>, <italic>n<sub>non</sub></italic><sub>−</sub><italic><sub>task</sub></italic>, and <italic>n</italic> to respectively denote the number of task-related items, the number of task-irrelevant items, and the total number of items (i.e., the sum of <italic>n<sub>task</sub></italic>and <italic>n<sub>non</sub></italic><sub>−</sub><italic><sub>task</sub></italic>). To allow for sufficient competition between task-related and task-irrelevant items, we set <italic>n<sub>non</sub></italic><sub>−</sub><italic><sub>task</sub></italic> to be roughly one half of <italic>n<sub>task</sub></italic> (i.e., rounded up when <italic>n<sub>task</sub></italic> is odd). We note that the particular ratio of <italic>n<sub>non</sub></italic><sub>−</sub><italic><sub>task</sub></italic> to <italic>n<sub>task</sub></italic> is not critical to the pattern of results in our simulations.</p>
<p>In each simulation, <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic> are initialized as identity matrices of rank <italic>n</italic>, which are scaled respectively by 1.0 and 0.7. These scaling factors were chosen to qualitatively match the empirically observed proportions of forward and backward replay in different conditions (though the forward/backward asymmetry is always observed in the model). Our initialization of these two matrices as identity matrices differs from the initialization strategy in prior work [<xref ref-type="bibr" rid="c46">46</xref>, <xref ref-type="bibr" rid="c33">33</xref>, <xref ref-type="bibr" rid="c57">57</xref>, <xref ref-type="bibr" rid="c34">34</xref>], where <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic> are initialized to reflect pre-experimental similarity among items. Given such initializations, prior to learning, <italic>M<sup>fc</sup></italic> maps distinct items onto orthogonal context features, and <italic>M<sup>cf</sup></italic> maps each context feature to a different item. Before the model encodes each input sequence, <italic>c</italic> is reset as a zero vector of length <italic>n</italic>. Resetting contexts in between sequence presentations demarcates boundaries between discrete events as in prior work [<xref ref-type="bibr" rid="c135">135</xref>].</p>
</sec>
<sec id="s4b">
<title>Awake encoding</title>
<sec id="s4b1">
<title>Context drift</title>
<p>During awake encoding, the model encodes a sequence of distinct items by associating them with a drifting context. At each timestep <italic>t</italic>, CMR-replay retrieves the current item <italic>f<sub>t</sub></italic>’s associated context <italic>c<sub>f</sub><sub>t</sub></italic> via item-to-context matrix <inline-formula id="inline-eqn-4"><inline-graphic xlink:href="533833v4_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (i.e., the <italic>M<sup>fc</sup></italic> matrix after the previous timestep) according to:
<disp-formula id="eqn1">
<graphic xlink:href="533833v4_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Given <inline-formula id="inline-eqn-5"><inline-graphic xlink:href="533833v4_inline5.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, the context layer incorporates <inline-formula id="inline-eqn-6"><inline-graphic xlink:href="533833v4_inline6.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and downweights previous items’ associated contexts according to:
<disp-formula id="eqn2">
<graphic xlink:href="533833v4_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>c<sub>t</sub></italic><sub>−1</sub> represents the context before <italic>f<sub>t</sub></italic> is presented. <italic>ρ</italic> and <italic>β</italic> determine the relative contribution of <italic>c<sub>t</sub></italic><sub>−1</sub> and <italic>c<sub>f</sub><sub>t</sub></italic> to <italic>c<sub>t</sub></italic>. To ensure that <italic>c<sub>t</sub></italic> has a unit length, <italic>ρ</italic> is computed according to:
<disp-formula id="eqn3">
<graphic xlink:href="533833v4_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Therefore, the context layer is a drifting, recency-weighted average of contexts associated with items presented up to timestep <italic>t</italic>. Operations that drive context drift in our simulations, including those specified by <xref rid="eqn1" ref-type="disp-formula">Eqs. 1</xref>, <xref rid="eqn2" ref-type="disp-formula">2</xref>, and <xref rid="eqn3" ref-type="disp-formula">3</xref>, are identical to those in prior work [<xref ref-type="bibr" rid="c46">46</xref>, <xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c57">57</xref>]. In all simulations, <italic>β</italic> is 0.75 (similar to drift rates for temporal context features reported in Polyn et al. [<xref ref-type="bibr" rid="c34">34</xref>]), except when distractors cause context drift in the simulation of Liu et al [<xref ref-type="bibr" rid="c22">22</xref>].</p>
</sec>
<sec id="s4b2">
<title>Updating <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic></title>
<p>Each time the context drifts, CMR-replay updates <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic> to strengthen associations between the current item (<italic>f<sub>t</sub></italic>) and context (<italic>c<sub>t</sub></italic>). The model updates <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic> using a standard Hebbian learning rule according to
<disp-formula id="eqn4">
<graphic xlink:href="533833v4_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
<disp-formula id="eqn5">
<graphic xlink:href="533833v4_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<p>in which <italic>γ<sub>fc</sub></italic>and <italic>γ<sub>cf</sub></italic> control the rates at which <italic>M<sup>fc</sup></italic>and <italic>M<sup>cf</sup></italic> are updated.</p>
</sec>
<sec id="s4b3">
<title>Varying awake encoding rates according to salience</title>
<p>CMR-replay assumes that salience modulates the magnitude of <italic>γ<sub>fc</sub></italic> and <italic>γ<sub>cf</sub></italic>. Building on prior work [<xref ref-type="bibr" rid="c46">46</xref>, <xref ref-type="bibr" rid="c47">47</xref>], the model assumes that <italic>γ<sub>fc</sub></italic> and <italic>γ<sub>cf</sub></italic> for awake encoding are higher for salient items, including those that are rewarding (i.e., directly associated with a reward) or novel (i.e., received less exposure), than for other items. Salience modulates <italic>γ<sub>fc</sub></italic>and <italic>γ<sub>cf</sub></italic> only for the current item and context: It does not modify <italic>γ<sub>fc</sub></italic> and <italic>γ<sub>cf</sub></italic> for items that precede the salient item. Higher encoding rates allow salient items to associate with their encoding contexts more quickly than other items. This shapes subsequent replay in two distinct ways. First, with higher <italic>M<sup>cf</sup></italic> encoding rate for a salient item, the model will more strongly activate the item given its encoding context as a cue after awake encoding. Second, with higher <italic>M<sup>fc</sup></italic>encoding rate, the model will be better able to faithfully retrieve the item’s encoding context after awake encoding. For all simulations, the base learning rates <italic>γ<sub>fc</sub></italic> and <italic>γ<sub>cf</sub></italic> are 1.0. For rewarded items, learning rates vary according to the magnitude of reward: Learning rates <italic>γ<sub>fc</sub></italic><sub>low</sub> and <italic>γ<sub>cf</sub></italic><sub>low</sub> are 1.0 for items associated with low reward, <italic>γ<sub>fc</sub></italic><sub>normal</sub> and <italic>γ<sub>cf</sub></italic><sub>normal</sub> are 1.5 for those with standard reward, and <italic>γ<sub>fc</sub></italic><sub>high</sub> and <italic>γ<sub>cf</sub></italic><sub>high</sub> are 2.0 for those with high reward. These values are chosen to align with prior work [<xref ref-type="bibr" rid="c46">46</xref>, <xref ref-type="bibr" rid="c47">47</xref>], in which these scaling factors are 1.0 for items that evoke no arousal [<xref ref-type="bibr" rid="c46">46</xref>] and greater than 1.0 for those assumed to evoke emotional arousal [<xref ref-type="bibr" rid="c46">46</xref>, <xref ref-type="bibr" rid="c47">47</xref>]. When an input becomes less novel as it is repeated across sessions, its learning rate in the present session is <inline-formula id="inline-eqn-7"><inline-graphic xlink:href="533833v4_inline7.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, where <italic>i</italic> is the index of the current session and <italic>γ</italic> is its initial learning rate. The reduction in learning rates with repetition is important for maintaining a degree of stochasticity in the model’s replay during task repetition, since linearly increasing weights would, through the softmax choice rule, exponentially amplify differences in item reactivation probabilities, sharply reducing variability in replay.</p>
</sec>
</sec>
<sec id="s4c">
<title>Replay</title>
<p>After each session of awake encoding, CMR-replay autonomously reactivates items during a number of replay periods. For simplicity, we assumed that the number of replay periods is fixed, rather than determined by task-related variables.</p>
<sec id="s4c1">
<title>Initial item reactivation</title>
<p>At the onset (i.e., <italic>t</italic> = 0) of each replay period, CMR-replay selects an item from a probability distribution <italic>a</italic><sub>0</sub>, which represents spontaneous activities across items during awake rest or sleep (<xref rid="fig1" ref-type="fig">Fig. 1e</xref>). To simulate the relative lack of external sensory input in sleep, we fill <italic>a</italic><sub>0</sub> with random activities across all items. By contrast, for awake rest simulations, we make available an external context cue <italic>c<sub>external</sub></italic> (e.g., the task context of the animal’s current location) representing where the model is “resting,” which evokes additional activities that bias <italic>a</italic><sub>0</sub> toward the item most strongly associated with the context cue. Concretely, in <italic>a</italic><sub>0</sub>, the activity of <italic>i</italic>-th unit is:
<disp-formula id="eqn6">
<graphic xlink:href="533833v4_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>a</italic><sub>0</sub><italic><sup>random</sup></italic> represents internal activity that we simulated as random noise, <italic>a</italic><sub>0</sub><italic><sup>evoked</sup></italic> is activity that <italic>c<sub>external</sub></italic> evokes according to <xref rid="eqn7" ref-type="disp-formula">Eq. 7</xref>, and <italic>n</italic> is the total number of items in a simulation. <italic>a</italic><sub>0</sub><italic><sup>random</sup></italic> is a vector of size <italic>n</italic> whose elements are independently and uniformly drawn from the interval [0, 0.001]. CMR-replay samples an item <italic>f</italic><sub>0</sub> from <italic>a</italic><sub>0</sub> for the initial item reactivation.</p>
</sec>
<sec id="s4c2">
<title>Subsequent reactivations</title>
<p>Given <italic>f</italic><sub>0</sub>, the model reinstates its associated context as <italic>c</italic><sub>0</sub> according to <xref rid="eqn1" ref-type="disp-formula">Eq. 1</xref> (<xref rid="fig1" ref-type="fig">Figure 1f</xref>). This allows the model to engage in a series of autonomous reactivations (<xref rid="fig1" ref-type="fig">Figure 1f</xref>).</p>
<p>At each timestep <italic>t</italic> ≥ 1, CMR-replay reactivates another item without replacement (i.e., by excluding items reactivated at previous timesteps). In particular, the model uses the previous context <italic>c<sub>t</sub></italic><sub>−1</sub> as a context cue to evoke a probability distribution <italic>a<sub>t</sub></italic> that excludes items reactivated prior to <italic>t</italic>. Let <italic>U<sub>t</sub></italic> denote the set of items that have not yet been reactivated. The probability of each item in <italic>U<sub>t</sub></italic> is:
<disp-formula id="eqn7">
<graphic xlink:href="533833v4_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>T<sub>t</sub></italic> is a temperature parameter that scales the relative difference of activities in <italic>a<sub>t</sub><sup>evoked</sup></italic>. <italic>T</italic><sub>0</sub> is 0.1 and <italic>T<sub>t</sub></italic> is 0.14 for all <italic>t</italic> ≥ 1. For <italic>t</italic> ≥ 1, <italic>c<sub>cue</sub></italic> = <italic>c<sub>t</sub></italic><sub>−1</sub> and <italic>a<sub>t</sub></italic> = <italic>a<sub>t</sub><sup>evoked</sup></italic>. In contrast, at <italic>t</italic> = 0, <italic>c<sub>cue</sub></italic> = <italic>c<sub>external</sub></italic> and <italic>a</italic><sub>0</sub> is a combination of <italic>a</italic><sub>0</sub><italic><sup>random</sup></italic> and <italic>a</italic><sub>0</sub><italic><sup>evoked</sup></italic>. Based on <xref rid="eqn7" ref-type="disp-formula">Eq. 7</xref>, all <italic>U<sub>t</sub></italic> items have non-zero activity in <italic>a<sub>t</sub></italic>. From <italic>a<sub>t</sub></italic>, the model samples an item <italic>f<sub>t</sub></italic>.</p>
<p>Given <italic>f<sub>t</sub></italic>, the model performs three operations that parallel the operations performed during awake encoding. First, it reinstates <italic>f<sub>t</sub></italic>’s associated context <inline-formula id="inline-eqn-8"><inline-graphic xlink:href="533833v4_inline8.gif" mimetype="image" mime-subtype="gif"/></inline-formula> via <italic>M<sup>fc</sup></italic> according to <xref rid="eqn1" ref-type="disp-formula">Eq. 1</xref>. Then, <inline-formula id="inline-eqn-9"><inline-graphic xlink:href="533833v4_inline9.gif" mimetype="image" mime-subtype="gif"/></inline-formula> induces a drift in context according to <xref rid="eqn2" ref-type="disp-formula">Eq. 2</xref>, forming a new context <italic>c<sub>t</sub></italic>, which will guide the reactivation at the next timestep. Finally, the model strengthens the association between <italic>f<sub>t</sub></italic> and the current context <italic>c<sub>t</sub></italic> by updating <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic>according to <xref rid="eqn4" ref-type="disp-formula">Eq. 4</xref> and <xref rid="eqn5" ref-type="disp-formula">Eq. 5</xref>. Compared to awake encoding, the model performs these updates at a slower learning rate <italic>γ<sub>replay</sub></italic> of 0.001 during replay. This slower learning rate allows replay to preserve and strengthen memories despite the noisy nature of replay sequences.</p>
<p>At each timestep, the replay period ends either with a stop probability of 0.1, an arbitrary choice made to constrain replay episode length probabilistically, or if a task-irrelevant item becomes reactivated. Future work could explore the implications of varying this parameter more systematically. Following prior work [<xref ref-type="bibr" rid="c25">25</xref>], we consider replayed sequences (one per replay period) with consecutive segments of length five or greater that preserve the contiguity of wake inputs as replay events.</p>
</sec>
<sec id="s4c3">
<title>An experience-dependent suppression mechanism</title>
<p>CMR-replay employs a mechanism that suppresses the activity of items in <italic>a</italic><sub>0</sub> according to the magnitude of context activity in the preceding awake encoding period. This mechanism differs from related mechanisms in prior work [<xref ref-type="bibr" rid="c57">57</xref>, <xref ref-type="bibr" rid="c34">34</xref>], which scale the degree of competition among items during recall. This experience-dependent suppression mechanism is distinct from the reduction of learning rates through repetition; it does not modulate the update of memory associations but exclusively governs which items are most likely to initiate replay. For each item <italic>f</italic> presented in a wake learning session, its activity in <italic>a</italic><sub>0</sub> is multiplied by:
<disp-formula id="eqn8">
<graphic xlink:href="533833v4_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where ||<italic>c<sub>f</sub></italic>|| is the Euclidean norm of the item’s retrieved context vector <italic>c<sub>f</sub></italic> in the recent wake learning session given by:
<disp-formula id="eqn9">
<graphic xlink:href="533833v4_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>m</italic> is the number of units in <italic>c<sub>f</sub></italic>. For items not shown in the wake session, <italic>C</italic> is 0.0 and thus <italic>ω</italic> is 1.0.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7:</label>
<caption><title>Task simulations.</title>
<p>Each enclosed box corresponds to a unique item. Each arrow represents a valid transition between two items. Each dashed arrow represents a distractor that causes a drift in context between two items. Task sequences initiate at light grey boxes. Dark grey boxes represent salient items in each task. For tasks with multiple valid sequences, the order in which sequences are presented is randomized. <bold>a</bold>. Simulation of a linear track. <bold>b</bold>. Simulation of the task in Liu et al. [<xref ref-type="bibr" rid="c10">10</xref>]. <bold>c</bold>. Simulation of a two-choice T-maze. <bold>d</bold>. Simulation of a T-maze. <bold>e</bold>. Simulation of the task in Bendor and Wilson [<xref ref-type="bibr" rid="c35">35</xref>]. <bold>f</bold>. Simulation of a linear track task with distinct directions of travel. <bold>g</bold>. Simulation of input sequences in Liu et al. [<xref ref-type="bibr" rid="c22">22</xref>]. <bold>h</bold>. Simulation of a fix-item sequence.</p></caption>
<graphic xlink:href="533833v4_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s4d">
<title>Task Simulations</title>
<p>During awake learning, CMR-replay encodes sequences of items, representing spatial trajectories or other stimulus sequences (<xref rid="fig7" ref-type="fig">Fig. 7</xref>). After awake encoding, the model participates in a number of awake rest or sleep replay periods. In each simulation, for each condition, we ran 100 instantiations of the model with the same initialization. Across these replay periods, each of which produces one reactivated sequence, we compute the proportion of sequences that qualify as significant replay events. As described above, a significant replay event is defined as a reactivated sequence that includes a consecutive segment of five or more items that preserves the contiguity of the wake inputs. For simulations assessing forward versus backward replay sequences, we further report the proportion of significant replay events occurring in the forward direction (i.e., in the same order as the wake inputs), and the backward direction, where the order is reversed. Variability in replay sequences across models arises from the stochastic nature of the replay process. Due to the variability in replay sequences, different models develop distinct <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic> as they learn from replay. Unlike prior work that identified the best-fitting parameters for each simulation [<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c57">57</xref>, <xref ref-type="bibr" rid="c46">46</xref>], CMR-replay employs the same set of model parameters across simulations with varying input structures.</p>
<p>In the simulation that examines context-dependent forward and backward replay through experience (<xref rid="fig2" ref-type="fig">Figs. 2a</xref> and <xref rid="fig5" ref-type="fig">5a</xref>), CMR-replay encodes an input sequence shown in <xref rid="fig7" ref-type="fig">Fig. 7a</xref>, which simulates a linear track run with no ambiguity in the direction of inputs, over eight awake learning sessions (as in Shin et al. [<xref ref-type="bibr" rid="c32">32</xref>]). In this simulation, learning rates for the rewarded item are <italic>γ<sub>fc</sub></italic><sub>normal</sub> and <italic>γ<sub>cf</sub></italic><sub>normal</sub>. After each wake learning session, we simulate 500 awake rest replay periods at the end of a run followed by another 500 periods at the start of a run. For rest at the end of a run, <italic>c<sub>external</sub></italic>is the context associated with the final item in the sequence. For rest at the start of a run, <italic>c<sub>external</sub></italic> is the context associated with the start item. In this simulation, the learning rates progressively decrease across sessions, as described above. The proportion of replay shown in <xref rid="fig2" ref-type="fig">Fig. 2a</xref> represents the proportion of reactivated sequences categorized as significant forward versus backward replay sequences. <xref rid="fig5" ref-type="fig">Fig 5a</xref> depicts the mean number of significant replay sequences per replay period.</p>
<p>In the simulation that contrasts forward and backward replay between rest and sleep (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>), the model encodes the input sequence shown in <xref rid="fig7" ref-type="fig">Fig. 7a</xref> for a single session. After encoding, each model either participates in 1000 awake rest or sleep replay periods, with 100 models in each condition (i.e., awake rest or sleep). <xref rid="fig2" ref-type="fig">Fig. 2b</xref> reports the proportion of significant replay sequences categorized as forward replay.</p>
<p>In the simulation of TMR (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>), each model encodes two sequences shown in <xref rid="fig7" ref-type="fig">Fig. 7e</xref> in a randomized order in a session of wake learning. During input presentation, for each sequence, a separate cue item (cue L or cue R) is presented immediately after the start item. The models encode the goal item at rates <italic>γ<sub>fc</sub></italic><sub>normal</sub> and <italic>γ<sub>cf</sub></italic><sub>normal</sub>. After wake learning, each model engages in 500 sleep replay periods. In each replay period, the context associated with cue L or cue R is randomly presented as <italic>c<sub>external</sub></italic>. <xref rid="fig2" ref-type="fig">Fig. 2c</xref> presents the proportion of significant replay sequences corresponding to the sequence associated with cue L versus that associated with cue R.</p>
<p>In the simulation that contrasts replay of rewarded versus non-rewarded items (<xref rid="fig3" ref-type="fig">Fig. 3a</xref> and <xref rid="fig6" ref-type="fig">6b</xref>), each model encodes two sequences shown in <xref rid="fig7" ref-type="fig">Fig. 7d</xref> in a randomized order in a session of wake learning. The models encode the goal item at rates <italic>γ<sub>fc</sub></italic><sub>normal</sub> and <italic>γ<sub>cf</sub></italic><sub>normal</sub>. After wake learning, each model engages in an extended phase with 5000 sleep replay periods. To quantify changes in memory through sleep, in each model, we additionally simulated 5000 replay periods before and after extended sleep with no learning (i.e., <italic>M<sup>fc</sup></italic>and <italic>M<sup>cf</sup></italic> are not updated) and no <italic>c<sub>external</sub></italic>. <xref rid="fig3" ref-type="fig">Fig. 3a</xref> presents the proportion of replay periods reactivating the rewarded goal versus the non-rewarded goal.</p>
<p>In the simulation of forward and backward replay with different levels of reward (<xref rid="fig3" ref-type="fig">Fig. 3b</xref>), the model encodes two sequences (<xref rid="fig7" ref-type="fig">Fig. 7f</xref>) in a randomized order in a single session. The inclusion of two disjoint sequences follows the approach in [<xref ref-type="bibr" rid="c25">25</xref>], which simulates different directions of travel to distinguish place cells with directional preference for replay decoding in animal studies. The simulation consists of three conditions: normal vs. normal reward, low vs. normal reward, and high vs. normal reward. In the normal vs. normal condition, each model encodes goal locations in both sequences at rates <italic>γ<sub>fc</sub></italic><sub>normal</sub> and <italic>γ<sub>cf</sub></italic><sub>normal</sub>. In the low vs. normal condition, each model encodes the goal location at rates <italic>γ<sub>fc</sub></italic><sub>low</sub> and <italic>γ<sub>cf</sub></italic><sub>low</sub> for one sequence and at rates <italic>γ<sub>fc</sub></italic><sub>normal</sub> and <italic>γ<sub>cf</sub></italic><sub>normal</sub> for the other. Finally, in the high vs. normal condition, each model encodes the goal location at rates <italic>γ<sub>fc</sub></italic><sub>high</sub> and <italic>γ<sub>cf</sub></italic><sub>high</sub> for one sequence and at rates <italic>γ<sub>fc</sub></italic><sub>normal</sub> and <italic>γ<sub>cf</sub></italic><sub>normal</sub> for the other. After encoding a sequence, we simulate 500 awake rest replay periods at the end of a run followed by another 500 at the start of a run. <xref rid="fig3" ref-type="fig">Fig. 3b</xref> presents relative differences in the proportion of significant replay sequences that are categorized as forward versus backward.</p>
<p>In the simulation of remote replay, shortcut replay, and the over-representation of non-behaviorally-preferred experiences in replay (<xref rid="fig4" ref-type="fig">Figs. 4b</xref>, <xref rid="fig4" ref-type="fig">4c</xref>, and <xref rid="fig5" ref-type="fig">5c</xref>), each model encodes two sequences (<xref rid="fig7" ref-type="fig">Fig. 7c</xref>) in a randomized order in a total of three sessions. Learning rates for each goal location are <italic>γ<sub>fc</sub></italic><sub>normal</sub> and <italic>γ<sub>cf</sub></italic><sub>normal</sub>. In these simulations, we treat the first two sessions as the period in which an animal is pre-trained extensively on the task. After wake learning in the third session, for the results shown in <xref rid="fig4" ref-type="fig">Figs. 4a and b</xref>, each model engages in 500 awake rest replay periods at each of the four goal locations in a randomized order. For the results shown in <xref rid="fig5" ref-type="fig">Figs. 5c</xref>, to simulate replay away from the task environment, each model engages in 500 replay periods with no external context cue. <xref rid="fig4" ref-type="fig">Fig. 4c</xref> presents the proportion of significant replay sequences that are categorized as remote replay.</p>
<p>In the simulation of Liu et al. [<xref ref-type="bibr" rid="c22">22</xref>] (<xref rid="fig4" ref-type="fig">Fig. 4d</xref>), each model encodes three sequences (<xref rid="fig7" ref-type="fig">Fig. 7g</xref>) shown in a randomized order. These three sequences <italic>X</italic><sub>1</sub><italic>X</italic><sub>2</sub><italic>Y</italic><sub>1</sub><italic>Y</italic><sub>2</sub>, <italic>X</italic><sub>2</sub><italic>X</italic><sub>3</sub><italic>Y</italic><sub>2</sub><italic>Y</italic><sub>3</sub>, and <italic>X</italic><sub>3</sub><italic>X</italic><sub>4</sub><italic>Y</italic><sub>3</sub><italic>Y</italic><sub>4</sub> are scrambled versions of pairwise transitions from true sequences <italic>X</italic><sub>1</sub><italic>X</italic><sub>2</sub><italic>X</italic><sub>3</sub><italic>X</italic><sub>4</sub> and <italic>Y</italic><sub>1</sub><italic>Y</italic><sub>2</sub><italic>Y</italic><sub>3</sub><italic>Y</italic><sub>4</sub>. A distractor item, which is a distinct item that does not participate in replay, induces context drift between successive items. The item induces context drift at a <italic>β</italic> of 0.3 for transitions that exist in the true sequences and at a <italic>β</italic> of 0.99 for transitions that do not exist in the true sequences (simulating the longer interstimulus interval between these transitions in the experiment). <xref rid="fig4" ref-type="fig">Fig. 4d</xref> shows the proportion of replay sequences categorized as significant replay sequences matching the true versus scrambled sequences.</p>
<p>In the simulation that examines sequence memory through sleep (<xref rid="fig6" ref-type="fig">Fig. 6a</xref>), each model encodes a five-item sequence (<xref rid="fig7" ref-type="fig">Fig. 7h</xref>) in a session. After wake learning, each model participates in an extended period of sleep with 5000 replay periods. In each model, we additionally simulated 5000 replay periods before and after extended sleep with no learning (i.e., <italic>M<sup>fc</sup></italic> and <italic>M<sup>cf</sup></italic> are not updated) and no <italic>c<sub>external</sub></italic>. <xref rid="fig6" ref-type="fig">Fig. 6a</xref> shows the proportion of replay sequences categorized as significant replay sequences matching the five-item sequence both prior to and following sleep.</p>
<p>In the simulation that examines replay’s role in non-local learning (<xref rid="fig6" ref-type="fig">Fig. 6c</xref>), each model encodes six sequences (<xref rid="fig7" ref-type="fig">Fig. 7b</xref>) in a randomized order in a session. Sequences in this simulation consist of three start states and two end states. Each start state has a unique sequence that connects it to each of the two end states. The model encodes the final item in the final sequence at rates <italic>γ<sub>fc</sub></italic><sub>high</sub> and <italic>γ<sub>cf</sub></italic><sub>high</sub> and encodes all other items at base learning rates <italic>γ<sub>fc</sub></italic> and <italic>γ<sub>cf</sub></italic>. After the encoding of all six sequences, each model participates in 5000 awake rest replay periods with the final item’s associated context as <italic>c<sub>external</sub></italic>. Before and after the rest period, we evaluated the model’s preference for non-local sequence trajectories associated with rewarded items. Specifically, we assessed the model’s activation of each non-local start item’s two ensuing items given the start item’s associated context as a cue. These activations were then normalized into a probability distribution using a softmax transformation, providing a measure of the model’s choice preference between the reward-associated path and the non-rewarded path. <xref rid="fig6" ref-type="fig">Fig 6c</xref> illustrates how these probabilities change through rest.</p>
<p>In the simulation of teacher and student CMR-replay (<xref rid="fig6" ref-type="fig">Fig. 6d</xref>), each teacher model encodes a sequence (<xref rid="fig7" ref-type="fig">Fig. 7a</xref>) in a session. Teacher models encode the goal location at learning rates <italic>γ<sub>fc</sub></italic><sub>normal</sub> and <italic>γ<sub>cf</sub></italic><sub>normal</sub>. After wake learning, we simulate an extended period of sleep with 5000 replay periods in each model. We then present each teacher model’s 5000 replayed sequences as inputs to train a different blank-slate student model with learning rates <italic>γ<sub>replay</sub></italic>. As described in <xref rid="fig6" ref-type="fig">Fig. 6d</xref>, we computed the conditional probability that, following the reactivation of the <italic>i</italic>-th item, the model immediately reactivates the item at position <italic>i</italic> + lag, given that the <italic>i</italic>-th item was available for reactivation.</p>
</sec>
</sec>
</body>
<back>
<sec id="das" sec-type="data-availability">
<title>Data availability</title>
<p>This work is a computational modeling study, so no data were generated for this manuscript. The modeling code is included as Source code.</p>
<sec id="s5">
<title>Code availability</title>
<p>The code used to run simulations in this study is available at: <ext-link ext-link-type="uri" xlink:href="https://github.com/schapirolab/CMR-replay">https://github.com/schapirolab/CMR-replay</ext-link>.</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Klinzing</surname>, <given-names>J. G.</given-names></string-name>, <string-name><surname>Niethard</surname>, <given-names>N.</given-names></string-name>, and <string-name><surname>Born</surname>, <given-names>J</given-names></string-name></person-group>. (<year>2019</year>). <article-title>Mechanisms of systems memory consolidation during sleep</article-title>. <source>Nature neuroscience</source>, <volume>22</volume>(<issue>10</issue>):<fpage>1598</fpage>–<lpage>1610</lpage>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Walker</surname>, <given-names>M. P.</given-names></string-name> and <string-name><surname>Stickgold</surname>, <given-names>R</given-names></string-name></person-group>. (<year>2004</year>). <article-title>Sleep-dependent learning and memory consolidation</article-title>. <source>Neuron</source>, <volume>44</volume>(<issue>1</issue>):<fpage>121</fpage>–<lpage>133</lpage>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wamsley</surname>, <given-names>E. J</given-names></string-name></person-group>. (<year>2019</year>). <article-title>Memory consolidation during waking rest</article-title>. <source>Trends in cognitive sciences</source>, <volume>23</volume>(<issue>3</issue>):<fpage>171</fpage>– <lpage>173</lpage>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Foster</surname>, <given-names>D. J</given-names></string-name></person-group>. (<year>2017</year>). <article-title>Replay comes of age</article-title>. <source>Annual review of neuroscience</source>, <volume>40</volume>:<fpage>581</fpage>–<lpage>602</lpage>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Nour</surname>, <given-names>M. M.</given-names></string-name>, <string-name><surname>Schuck</surname>, <given-names>N. W.</given-names></string-name>, <string-name><surname>Behrens</surname>, <given-names>T. E.</given-names></string-name>, and <string-name><surname>Dolan</surname>, <given-names>R. J</given-names></string-name></person-group>. (<year>2022</year>). <article-title>Decoding cognition from spontaneous neural activity</article-title>. <source>Nature Reviews Neuroscience</source>, <volume>23</volume>(<issue>4</issue>):<fpage>204</fpage>–<lpage>214</lpage>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ólafsdóttir</surname>, <given-names>H. F.</given-names></string-name>, <string-name><surname>Bush</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name></person-group> (<year>2018</year>). <article-title>The role of hippocampal replay in memory and planning</article-title>. <source>Current Biology</source>, <volume>28</volume>(<issue>1</issue>):<fpage>R37</fpage>–<lpage>R50</lpage>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sheridan</surname>, <given-names>C. L.</given-names></string-name>, <string-name><surname>Lang</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Knappenberger</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Albers</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Loper</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Tillett</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Sanchez</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Crystal</surname>, <given-names>J. D</given-names></string-name></person-group>. (<year>2024</year>). <article-title>Replay of incidentally encoded episodic memories in the rat</article-title>. <source>Current Biology</source>, <volume>34</volume>(<issue>3</issue>):<fpage>641</fpage>–<lpage>647</lpage>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dupret</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>O’Neill</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Pleydell-Bouverie</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Csicsvari</surname>, <given-names>J</given-names></string-name></person-group>. (<year>2010</year>). <article-title>The reorganization and reactivation of hippocampal maps predict spatial memory performance</article-title>. <source>Nature neuroscience</source>, <volume>13</volume>(<issue>8</issue>):<fpage>995</fpage>–<lpage>1002</lpage>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ego-Stengel</surname>, <given-names>V.</given-names></string-name> and <string-name><surname>Wilson</surname>, <given-names>M. A</given-names></string-name></person-group>. (<year>2010</year>). <article-title>Disruption of ripple-associated hippocampal activity during rest impairs spatial learning in the rat</article-title>. <source>Hippocampus</source>, <volume>20</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>10</lpage>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Mattar</surname>, <given-names>M. G.</given-names></string-name>, <string-name><surname>Behrens</surname>, <given-names>T. E.</given-names></string-name>, <string-name><surname>Daw</surname>, <given-names>N. D.</given-names></string-name>, and <string-name><surname>Dolan</surname>, <given-names>R. J</given-names></string-name></person-group>. (<year>2021</year>). <article-title>Experience replay is associated with efficient nonlocal learning</article-title>. <source>Science</source>, <volume>372</volume>(<issue>6544</issue>):<fpage>eabf1357</fpage>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Girardeau</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Benchenane</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Wiener</surname>, <given-names>S. I.</given-names></string-name>, <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Zugaro</surname>, <given-names>M. B.</given-names></string-name></person-group> (<year>2009</year>). <article-title>Selective suppression of hippocampal ripples impairs spatial memory</article-title>. <source>Nature neuroscience</source>, <volume>12</volume>(<issue>10</issue>):<fpage>1222</fpage>–<lpage>1223</lpage>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jadhav</surname>, <given-names>S. P.</given-names></string-name>, <string-name><surname>Kemere</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>German</surname>, <given-names>P. W.</given-names></string-name>, and <string-name><surname>Frank</surname>, <given-names>L. M</given-names></string-name></person-group>. (<year>2012</year>). <article-title>Awake hippocampal sharp-wave ripples support spatial memory</article-title>. <source>Science</source>, <volume>336</volume>(<issue>6087</issue>):<fpage>1454</fpage>–<lpage>1458</lpage>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wilson</surname>, <given-names>M. A.</given-names></string-name> and <string-name><surname>McNaughton</surname>, <given-names>B. L</given-names></string-name></person-group>. (<year>1994</year>). <article-title>Reactivation of hippocampal ensemble memories during sleep</article-title>. <source>Science</source>, <volume>265</volume>(<issue>5172</issue>):<fpage>676</fpage>–<lpage>679</lpage>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Skaggs</surname>, <given-names>W. E.</given-names></string-name> and <string-name><surname>McNaughton</surname>, <given-names>B. L</given-names></string-name></person-group>. (<year>1996</year>). <article-title>Replay of neuronal firing sequences in rat hippocampus during sleep following spatial experience</article-title>. <source>Science</source>, <volume>271</volume>(<issue>5257</issue>):<fpage>1870</fpage>–<lpage>1873</lpage>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nádasdy</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Hirase</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Czurkó</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Csicsvari</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name></person-group> (<year>1999</year>). <article-title>Replay and time compression of recurring spike sequences in the hippocampus</article-title>. <source>Journal of Neuroscience</source>, <volume>19</volume>(<issue>21</issue>):<fpage>9497</fpage>–<lpage>9507</lpage>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gupta</surname>, <given-names>A. S.</given-names></string-name>, <string-name><surname>van der Meer</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Touretzky</surname>, <given-names>D. S.</given-names></string-name>, and <string-name><surname>Redish</surname>, <given-names>A. D.</given-names></string-name></person-group> (<year>2010</year>). <article-title>Hippocampal replay is not a simple function of experience</article-title>. <source>Neuron</source>, <volume>65</volume>(<issue>5</issue>):<fpage>695</fpage>–<lpage>705</lpage>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singer</surname>, <given-names>A. C.</given-names></string-name> and <string-name><surname>Frank</surname>, <given-names>L. M</given-names></string-name></person-group>. (<year>2009</year>). <article-title>Rewarded outcomes enhance reactivation of experience in the hippocampus</article-title>. <source>Neuron</source>, <volume>64</volume>(<issue>6</issue>):<fpage>910</fpage>–<lpage>921</lpage>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ólafsdóttir</surname>, <given-names>H. F.</given-names></string-name>, <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Saleem</surname>, <given-names>A. B.</given-names></string-name>, <string-name><surname>Hassabis</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Spiers</surname>, <given-names>H. J.</given-names></string-name></person-group> (<year>2015</year>). <article-title>Hippocampal place cells construct reward related sequences through unexplored space</article-title>. <source>eLife</source>, <volume>4</volume>:<elocation-id>e06063</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.06063</pub-id></mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wu</surname>, <given-names>C.-T.</given-names></string-name>, <string-name><surname>Haggerty</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Kemere</surname>, <given-names>C.</given-names></string-name>, and <string-name><surname>Ji</surname>, <given-names>D</given-names></string-name></person-group>. (<year>2017</year>). <article-title>Hippocampal awake replay in fear memory retrieval</article-title>. <source>Nature neuroscience</source>, <volume>20</volume>(<issue>4</issue>):<fpage>571</fpage>–<lpage>580</lpage>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ambrose</surname>, <given-names>R. E.</given-names></string-name>, <string-name><surname>Pfeiffer</surname>, <given-names>B. E.</given-names></string-name>, and <string-name><surname>Foster</surname>, <given-names>D. J</given-names></string-name></person-group>. (<year>2016</year>). <article-title>Reverse replay of hippocampal place cells is uniquely modulated by changing reward</article-title>. <source>Neuron</source>, <volume>91</volume>(<issue>5</issue>):<fpage>1124</fpage>–<lpage>1136</lpage>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Foster</surname>, <given-names>D. J.</given-names></string-name> and <string-name><surname>Wilson</surname>, <given-names>M. A</given-names></string-name></person-group>. (<year>2006</year>). <article-title>Reverse replay of behavioural sequences in hippocampal place cells during the awake state</article-title>. <source>Nature</source>, <volume>440</volume>(<issue>7084</issue>):<fpage>680</fpage>–<lpage>683</lpage>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Dolan</surname>, <given-names>R. J.</given-names></string-name>, <string-name><surname>Kurth-Nelson</surname>, <given-names>Z.</given-names></string-name>, and <string-name><surname>Behrens</surname>, <given-names>T. E</given-names></string-name></person-group>. (<year>2019</year>). <article-title>Human replay spontaneously reorganizes experience</article-title>. <source>Cell</source>, <volume>178</volume>(<issue>3</issue>):<fpage>640</fpage>–<lpage>652</lpage>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Michon</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Sun</surname>, <given-names>J.-J.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>C. Y.</given-names></string-name>, <string-name><surname>Ciliberti</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Kloosterman</surname>, <given-names>F</given-names></string-name></person-group>. (<year>2019</year>). <article-title>Post-learning hippocampal replay selectively reinforces spatial memory for highly rewarded locations</article-title>. <source>Current Biology</source>, <volume>29</volume>(<issue>9</issue>):<fpage>1436</fpage>– <lpage>1444</lpage>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carey</surname>, <given-names>A. A.</given-names></string-name>, <string-name><surname>Tanaka</surname>, <given-names>Y.</given-names></string-name>, and <string-name><surname>van Der Meer</surname>, <given-names>M. A.</given-names></string-name></person-group> (<year>2019</year>). <article-title>Reward revaluation biases hippocampal replay content away from the preferred outcome</article-title>. <source>Nature neuroscience</source>, <volume>22</volume>(<issue>9</issue>):<fpage>1450</fpage>–<lpage>1459</lpage>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mattar</surname>, <given-names>M. G.</given-names></string-name> and <string-name><surname>Daw</surname>, <given-names>N. D</given-names></string-name></person-group>. (<year>2018</year>). <article-title>Prioritized memory access explains planning and hippocampal replay</article-title>. <source>Nature neuroscience</source>, <volume>21</volume>(<issue>11</issue>):<fpage>1609</fpage>–<lpage>1617</lpage>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Momennejad</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Otto</surname>, <given-names>A. R.</given-names></string-name>, <string-name><surname>Daw</surname>, <given-names>N. D.</given-names></string-name>, and <string-name><surname>Norman</surname>, <given-names>K. A</given-names></string-name></person-group>. (<year>2018</year>). <article-title>Offline replay supports planning in human reinforcement learning</article-title>. <source>eLife</source>, <volume>7</volume>:<elocation-id>e32548</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.32548</pub-id></mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sutton</surname>, <given-names>R. S</given-names></string-name></person-group>. (<year>1988</year>). <article-title>Learning to predict by the methods of temporal differences</article-title>. <source>Machine learning</source>, <volume>3</volume>:<fpage>9</fpage>–<lpage>44</lpage>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cheng</surname>, <given-names>S.</given-names></string-name> and <string-name><surname>Frank</surname>, <given-names>L. M</given-names></string-name></person-group>. (<year>2008</year>). <article-title>New experiences enhance coordinated neural activity in the hippocampus</article-title>. <source>Neuron</source>, <volume>57</volume>(<issue>2</issue>):<fpage>303</fpage>–<lpage>313</lpage>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diba</surname>, <given-names>K.</given-names></string-name> and <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name></person-group> (<year>2007</year>). <article-title>Forward and reverse hippocampal place-cell sequences during ripples</article-title>. <source>Nature neuroscience</source>, <volume>10</volume>(<issue>10</issue>):<fpage>1241</fpage>–<lpage>1242</lpage>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gillespie</surname>, <given-names>A. K.</given-names></string-name>, <string-name><surname>Maya</surname>, <given-names>D. A. A.</given-names></string-name>, <string-name><surname>Denovellis</surname>, <given-names>E. L.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>D. F.</given-names></string-name>, <string-name><surname>Kastner</surname>, <given-names>D. B.</given-names></string-name>, <string-name><surname>Coulter</surname>, <given-names>M. E.</given-names></string-name>, <string-name><surname>Roumis</surname>, <given-names>D. K.</given-names></string-name>, <string-name><surname>Eden</surname>, <given-names>U. T.</given-names></string-name>, and <string-name><surname>Frank</surname>, <given-names>L. M</given-names></string-name></person-group>. (<year>2021</year>). <article-title>Hippocampal replay reflects specific past experiences rather than a plan for subsequent choice</article-title>. <source>Neuron</source>, <volume>109</volume>(<issue>19</issue>):<fpage>3149</fpage>–<lpage>3163</lpage>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Igata</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Ikegaya</surname>, <given-names>Y.</given-names></string-name>, and <string-name><surname>Sasaki</surname>, <given-names>T</given-names></string-name></person-group>. (<year>2021</year>). <article-title>Prioritized experience replays on a hippocampal predictive map for learning</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>118</volume>(<issue>1</issue>):<fpage>e2011266118</fpage>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shin</surname>, <given-names>J. D.</given-names></string-name>, <string-name><surname>Tang</surname>, <given-names>W.</given-names></string-name>, and <string-name><surname>Jadhav</surname>, <given-names>S. P</given-names></string-name></person-group>. (<year>2019</year>). <article-title>Dynamics of awake hippocampal-prefrontal replay for spatial learning and memory-guided decision making</article-title>. <source>Neuron</source>, <volume>104</volume>(<issue>6</issue>):<fpage>1110</fpage>–<lpage>1125</lpage>.</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Howard</surname>, <given-names>M. W.</given-names></string-name> and <string-name><surname>Kahana</surname>, <given-names>M. J</given-names></string-name></person-group>. (<year>2002</year>). <article-title>A distributed representation of temporal context</article-title>. <source>Journal of mathematical psychology</source>, <volume>46</volume>(<issue>3</issue>):<fpage>269</fpage>–<lpage>299</lpage>.</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Polyn</surname>, <given-names>S. M.</given-names></string-name>, <string-name><surname>Norman</surname>, <given-names>K. A.</given-names></string-name>, and <string-name><surname>Kahana</surname>, <given-names>M. J</given-names></string-name></person-group>. (<year>2009</year>). <article-title>A context maintenance and retrieval model of organizational processes in free recall</article-title>. <source>Psychological review</source>, <volume>116</volume>(<issue>1</issue>):<fpage>129</fpage>.</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bendor</surname>, <given-names>D.</given-names></string-name> and <string-name><surname>Wilson</surname>, <given-names>M. A</given-names></string-name></person-group>. (<year>2012</year>). <article-title>Biasing the content of hippocampal replay during sleep</article-title>. <source>Nature neuroscience</source>, <volume>15</volume>(<issue>10</issue>):<fpage>1439</fpage>–<lpage>1444</lpage>.</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wikenheiser</surname>, <given-names>A. M.</given-names></string-name> and <string-name><surname>Redish</surname>, <given-names>A. D</given-names></string-name></person-group>. (<year>2013</year>). <article-title>The balance of forward and backward hippocampal sequences shifts across behavioral states</article-title>. <source>Hippocampus</source>, <volume>23</volume>(<issue>1</issue>):<fpage>22</fpage>–<lpage>29</lpage>.</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barron</surname>, <given-names>H. C.</given-names></string-name>, <string-name><surname>Reeve</surname>, <given-names>H. M.</given-names></string-name>, <string-name><surname>Koolschijn</surname>, <given-names>R. S.</given-names></string-name>, <string-name><surname>Perestenko</surname>, <given-names>P. V.</given-names></string-name>, <string-name><surname>Shpektor</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Nili</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Rothaermel</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Campo-Urriza</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>O’Reilly</surname>, <given-names>J. X.</given-names></string-name>, <string-name><surname>Bannerman</surname>, <given-names>D. M.</given-names></string-name>, <string-name><surname>Behrens</surname>, <given-names>T. E.</given-names></string-name>, and <string-name><surname>Dupret</surname>, <given-names>D</given-names></string-name></person-group>. (<year>2020</year>). <article-title>Neuronal computation underlying inferential reasoning in humans and mice</article-title>. <source>Cell</source>, <volume>183</volume>(<issue>1</issue>):<fpage>228</fpage>–<lpage>243</lpage>.</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karlsson</surname>, <given-names>M. P.</given-names></string-name> and <string-name><surname>Frank</surname>, <given-names>L. M</given-names></string-name></person-group>. (<year>2009</year>). <article-title>Awake replay of remote experiences in the hippocampus</article-title>. <source>Nature neuroscience</source>, <volume>12</volume>(<issue>7</issue>):<fpage>913</fpage>–<lpage>918</lpage>.</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wimmer</surname>, <given-names>G. E.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>McNamee</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Dolan</surname>, <given-names>R. J</given-names></string-name></person-group>. (<year>2023</year>). <article-title>Distinct replay signatures for prospective decision-making and memory preservation</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>120</volume>(<issue>6</issue>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Berners-Lee</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Feng</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Silva</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Wu</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Ambrose</surname>, <given-names>E. R.</given-names></string-name>, <string-name><surname>Pfeiffer</surname>, <given-names>B. E.</given-names></string-name>, and <string-name><surname>Foster</surname>, <given-names>D. J</given-names></string-name></person-group>. (<year>2022</year>). <article-title>Hippocampal replays appear after a single experience and incorporate greater detail with more experience</article-title>. <source>Neuron</source>, <volume>110</volume>(<issue>11</issue>):<fpage>1829</fpage>–<lpage>1842</lpage>.</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Born</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Wilhelm</surname>, <given-names>I</given-names></string-name></person-group>. (<year>2012</year>). <article-title>System consolidation of memory during sleep</article-title>. <source>Psychological research</source>, <volume>76</volume>(<issue>2</issue>):<fpage>192</fpage>–<lpage>203</lpage>.</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carr</surname>, <given-names>M. F.</given-names></string-name>, <string-name><surname>Jadhav</surname>, <given-names>S. P.</given-names></string-name>, and <string-name><surname>Frank</surname>, <given-names>L. M</given-names></string-name></person-group>. (<year>2011</year>). <article-title>Hippocampal replay in the awake state: a potential substrate for memory consolidation and retrieval</article-title>. <source>Nature neuroscience</source>, <volume>14</volume>(<issue>2</issue>):<fpage>147</fpage>–<lpage>153</lpage>.</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>King</surname>, <given-names>B. R.</given-names></string-name>, <string-name><surname>Hoedlmoser</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Hirschauer</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Dolfen</surname>, <given-names>N.</given-names></string-name>, and <string-name><surname>Albouy</surname>, <given-names>G</given-names></string-name></person-group>. (<year>2017</year>). <article-title>Sleeping on the motor engram: the multifaceted nature of sleep-related motor memory consolidation</article-title>. <source>Neuroscience &amp; Biobehavioral Reviews</source>, <volume>80</volume>:<fpage>1</fpage>–<lpage>22</lpage>.</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Payne</surname>, <given-names>J. D.</given-names></string-name> and <string-name><surname>Kensinger</surname>, <given-names>E. A</given-names></string-name></person-group>. (<year>2010</year>). <article-title>Sleep’s role in the consolidation of emotional episodic memories</article-title>. <source>Current Directions in Psychological Science</source>, <volume>19</volume>(<issue>5</issue>):<fpage>290</fpage>–<lpage>295</lpage>.</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Payne</surname>, <given-names>J. D.</given-names></string-name>, <string-name><surname>Stickgold</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Swanberg</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Kensinger</surname>, <given-names>E. A</given-names></string-name></person-group>. (<year>2008</year>). <article-title>Sleep preferentially enhances memory for emotional components of scenes</article-title>. <source>Psychological science</source>, <volume>19</volume>(<issue>8</issue>):<fpage>781</fpage>–<lpage>788</lpage>.</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cohen</surname>, <given-names>R. T.</given-names></string-name> and <string-name><surname>Kahana</surname>, <given-names>M. J</given-names></string-name></person-group>. (<year>2022</year>). <article-title>A memory-based theory of emotional disorders</article-title>. <source>Psychological Review</source>, <volume>129</volume>(<issue>4</issue>):<fpage>742</fpage>.</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Talmi</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Lohnas</surname>, <given-names>L. J.</given-names></string-name>, and <string-name><surname>Daw</surname>, <given-names>N. D</given-names></string-name></person-group>. (<year>2019</year>). <article-title>A retrieved context model of the emotional modulation of memory</article-title>. <source>Psychological Review</source>, <volume>126</volume>(<issue>4</issue>):<fpage>455</fpage>.</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name></person-group>. (<year>1992</year>). <article-title>Toward a network model of the articulatory loop</article-title>. <source>Journal of Memory and Language</source>, <volume>31</volume>(<issue>4</issue>):<fpage>429</fpage>–<lpage>460</lpage>.</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grossberg</surname>, <given-names>S</given-names></string-name></person-group>. (<year>1978</year>). <article-title>Behavioral contrast in short term memory: Serial binary memory models or parallel continuous memory models?</article-title> <source>Journal of Mathematical Psychology</source>, <volume>17</volume>(<issue>3</issue>):<fpage>199</fpage>–<lpage>219</lpage>.</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Diekmann</surname>, <given-names>N.</given-names></string-name> and <string-name><surname>Cheng</surname>, <given-names>S.</given-names></string-name></person-group> (<year>2023</year>). <article-title>A model of hippocampal replay driven by experience and environmental structure facilitates spatial learning</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Singh</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Norman</surname>, <given-names>K. A.</given-names></string-name>,, and <string-name><surname>Schapiro</surname>, <given-names>A. C.</given-names></string-name></person-group> (<year>2022</year>). <article-title>A model of autonomous interactions between hippocampus and neocortex driving sleep-dependent memory consolidation</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>119</volume>(<issue>44</issue>):<fpage>e2123432119</fpage>.</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ans</surname>, <given-names>B.</given-names></string-name> and <string-name><surname>Rousset</surname>, <given-names>S</given-names></string-name></person-group>. (<year>2000</year>). <article-title>Neural networks with a self-refreshing memory: knowledge transfer in sequential learning tasks without catastrophic forgetting</article-title>. <source>Connection science</source>, <volume>12</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>19</lpage>.</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meeter</surname>, <given-names>M</given-names></string-name></person-group>. (<year>2003</year>). <article-title>Control of consolidation in neural networks: Avoiding runaway effects</article-title>. <source>Connection Science</source>, <volume>15</volume>(<issue>1</issue>):<fpage>45</fpage>–<lpage>61</lpage>.</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Norman</surname>, <given-names>K. A.</given-names></string-name>, <string-name><surname>Newman</surname>, <given-names>E. L.</given-names></string-name>, and <string-name><surname>Perotte</surname>, <given-names>A. J</given-names></string-name></person-group>. (<year>2005</year>). <article-title>Methods for reducing interference in the complementary learning systems model: oscillating inhibition and autonomous memory rehearsal</article-title>. <source>Neural Networks</source>, <volume>18</volume>(<issue>9</issue>):<fpage>1212</fpage>–<lpage>1228</lpage>.</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malerba</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Krishnan</surname>, <given-names>G. P.</given-names></string-name>, <string-name><surname>Fellous</surname>, <given-names>J.-M.</given-names></string-name>, and <string-name><surname>Bazhenov</surname>, <given-names>M</given-names></string-name></person-group>. (<year>2016</year>). <article-title>Hippocampal CA1 ripples as inhibitory transients</article-title>. <source>PLoS computational biology</source>, <volume>12</volume>(<issue>4</issue>):<fpage>e1004880</fpage>.</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hasselmo</surname>, <given-names>M. E.</given-names></string-name>, <string-name><surname>Wyble</surname>, <given-names>B. P.</given-names></string-name>,, and <string-name><surname>Wallenstein</surname>, <given-names>G. V.</given-names></string-name></person-group> (<year>1996</year>). <article-title>Encoding and retrieval of episodic memories: role of cholinergic and gabaergic modulation in the hippocampus</article-title>. <source>Hippocampus</source>, <volume>6</volume>(<issue>6</issue>):<fpage>693</fpage>–<lpage>708</lpage>.</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lohnas</surname>, <given-names>L. J.</given-names></string-name>, <string-name><surname>Polyn</surname>, <given-names>S. M.</given-names></string-name>, and <string-name><surname>Kahana</surname>, <given-names>M. J</given-names></string-name></person-group>. (<year>2015</year>). <article-title>Expanding the scope of memory search: Modeling intralist and interlist effects in free recall</article-title>. <source>Psychological review</source>, <volume>122</volume>(<issue>2</issue>):<fpage>337</fpage>.</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Koene</surname>, <given-names>R. A.</given-names></string-name> and <string-name><surname>Hasselmo</surname>, <given-names>M. E</given-names></string-name></person-group>. (<year>2008</year>). <article-title>Reversed and forward buffering of behavioral spike sequences enables retrospective and prospective retrieval in hippocampal regions ca3 and ca1</article-title>. <source>Neural Networks</source>, <volume>21</volume>(<issue>2-3</issue>):<fpage>276</fpage>–<lpage>288</lpage>.</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khamassi</surname>, <given-names>M.</given-names></string-name> and <string-name><surname>Girard</surname>, <given-names>B</given-names></string-name></person-group>. (<year>2020</year>). <article-title>Modeling awake hippocampal reactivations with model-based bidirectional search</article-title>. <source>Biological Cybernetics</source>, <volume>114</volume>(<issue>2</issue>):<fpage>231</fpage>–<lpage>248</lpage>.</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Davidson</surname>, <given-names>T. J.</given-names></string-name>, <string-name><surname>Kloosterman</surname>, <given-names>F.</given-names></string-name>, and <string-name><surname>Wilson</surname>, <given-names>M. A</given-names></string-name></person-group>. (<year>2009</year>). <article-title>Hippocampal replay of extended experience</article-title>. <source>Neuron</source>, <volume>63</volume>(<issue>4</issue>):<fpage>497</fpage>–<lpage>507</lpage>.</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname>, <given-names>A. K.</given-names></string-name> and <string-name><surname>Wilson</surname>, <given-names>M. A</given-names></string-name></person-group>. (<year>2002</year>). <article-title>Memory of sequential experience in the hippocampus during slow wave sleep</article-title>. <source>Neuron</source>, <volume>36</volume>(<issue>6</issue>):<fpage>1183</fpage>–<lpage>1194</lpage>.</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sterpenich</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>van Schie</surname>, <given-names>M. K. M.</given-names></string-name>, <string-name><surname>Catsiyannis</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Ramyead</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Perrig</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>H.-D.</given-names></string-name>, <string-name><surname>Ville</surname>, <given-names>D. V. D.</given-names></string-name>, and <string-name><surname>Schwartz</surname>, <given-names>S.</given-names></string-name></person-group> (<year>2021</year>). <article-title>Reward biases spontaneous neural reactivation during sleep</article-title>. <source>Nature communications</source>, <volume>12</volume>(<issue>1</issue>):<fpage>4162</fpage>.</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Anderson</surname>, <given-names>A. K</given-names></string-name></person-group>. (<year>2005</year>). <article-title>Affective influences on the attentional dynamics supporting awareness</article-title>. <source>Journal of experimental psychology: General</source>, <volume>134</volume>(<issue>2</issue>):<fpage>258</fpage>.</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>MacKay</surname>, <given-names>D. G.</given-names></string-name>, <string-name><surname>Hadley</surname>, <given-names>C. B.</given-names></string-name>, and <string-name><surname>Schwartz</surname>, <given-names>J. H</given-names></string-name></person-group>. (<year>2005</year>). <article-title>Relations between emotion, illusory word perception, and orthographic repetition blindness: Tests of binding theory</article-title>. <source>The Quarterly Journal of Experimental Psychology Section A</source>, <volume>58</volume>(<issue>8</issue>):<fpage>1514</fpage>–<lpage>1533</lpage>.</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>MacKay</surname>, <given-names>D. G.</given-names></string-name>, <string-name><surname>Shafto</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Taylor</surname>, <given-names>J. K.</given-names></string-name>, <string-name><surname>Marian</surname>, <given-names>D. E.</given-names></string-name>, <string-name><surname>Abrams</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Dyer</surname>, <given-names>J. R</given-names></string-name></person-group>. (<year>2004</year>). <article-title>Relations between emotion, memory, and attention: Evidence from taboo Stroop, lexical decision, and immediate memory tasks</article-title>. <source>Memory &amp; cognition</source>, <volume>32</volume>(<issue>3</issue>):<fpage>474</fpage>–<lpage>488</lpage>.</mixed-citation></ref>
<ref id="c66"><label>66.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mather</surname>, <given-names>M</given-names></string-name></person-group>. (<year>2007</year>). <article-title>Emotional arousal and memory binding: An object-based framework</article-title>. <source>Perspectives on Psychological Science</source>, <volume>2</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>52</lpage>.</mixed-citation></ref>
<ref id="c67"><label>67.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Asfestani</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Brechtmann</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Santiago</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Peter</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Born</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Feld</surname>, <given-names>G. B</given-names></string-name></person-group>. (<year>2020</year>). <article-title>Consolidation of reward memory during sleep does not require dopaminergic activation</article-title>. <source>Journal of Cognitive Neuroscience</source>, <volume>32</volume>(<issue>9</issue>):<fpage>1688</fpage>–<lpage>1703</lpage>.</mixed-citation></ref>
<ref id="c68"><label>68.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gomperts</surname>, <given-names>S. N.</given-names></string-name>, <string-name><surname>Kloosterman</surname>, <given-names>F.</given-names></string-name>, and <string-name><surname>Wilson</surname>, <given-names>M. A</given-names></string-name></person-group>. (<year>2015</year>). <article-title>VTA neurons coordinate with the hippocampal reactivation of spatial experience</article-title>. <source>eLife</source>, <volume>4</volume>:<elocation-id>e05360</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.05360</pub-id></mixed-citation></ref>
<ref id="c69"><label>69.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buzsáki</surname>, <given-names>G</given-names></string-name></person-group>. (<year>1989</year>). <article-title>Two-stage model of memory trace formation: a role for “noisy” brain states</article-title>. <source>Neuroscience</source>, <volume>31</volume>(<issue>3</issue>):<fpage>551</fpage>–<lpage>570</lpage>.</mixed-citation></ref>
<ref id="c70"><label>70.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Csicsvari</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>O’Neill</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Allen</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Senior</surname>, <given-names>T</given-names></string-name></person-group>. (<year>2007</year>). <article-title>Place-selective firing contributes to the reverse-order reactivation of CA1 pyramidal cells during sharp waves in open-field exploration</article-title>. <source>European Journal of Neuroscience</source>, <volume>26</volume>(<issue>3</issue>):<fpage>704</fpage>–<lpage>716</lpage>.</mixed-citation></ref>
<ref id="c71"><label>71.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Neill</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Senior</surname>, <given-names>T. J.</given-names></string-name>, <string-name><surname>Allen</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Huxter</surname>, <given-names>J. R.</given-names></string-name>, and <string-name><surname>Csicsvari</surname>, <given-names>J</given-names></string-name></person-group>. (<year>2008</year>). <article-title>Reactivation of experience-dependent cell assembly patterns in the hippocampus</article-title>. <source>Nature neuroscience</source>, <volume>11</volume>(<issue>2</issue>):<fpage>209</fpage>–<lpage>215</lpage>.</mixed-citation></ref>
<ref id="c72"><label>72.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumaran</surname>, <given-names>D.</given-names></string-name> and <string-name><surname>McClelland</surname>, <given-names>J. L</given-names></string-name></person-group>. (<year>2012</year>). <article-title>Generalization through the recurrent interaction of episodic memories: a model of the hippocampal system</article-title>. <source>Psychological review</source>, <volume>119</volume>(<issue>3</issue>):<fpage>573</fpage>.</mixed-citation></ref>
<ref id="c73"><label>73.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Giri</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Miyawaki</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Mizuseki</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Cheng</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Diba</surname>, <given-names>K</given-names></string-name></person-group>. (<year>2019</year>). <article-title>Hippocampal reactivation extends for several hours following novel experience</article-title>. <source>Journal of Neuroscience</source>, <volume>39</volume>(<issue>5</issue>):<fpage>866</fpage>–<lpage>875</lpage>.</mixed-citation></ref>
<ref id="c74"><label>74.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gorriz</surname>, <given-names>M. H.</given-names></string-name>, <string-name><surname>Takigawa</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Bendor</surname>, <given-names>D</given-names></string-name></person-group>. (<year>2023</year>). <article-title>The role of experience in prioritizing hippocampal replay. nature communications</article-title>. <source>Nature Communications</source>, <volume>14</volume>(<issue>1</issue>):<fpage>8157</fpage>.</mixed-citation></ref>
<ref id="c75"><label>75.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schapiro</surname>, <given-names>A. C.</given-names></string-name>, <string-name><surname>McDevitt</surname>, <given-names>E. A.</given-names></string-name>, <string-name><surname>Rogers</surname>, <given-names>T. T.</given-names></string-name>, <string-name><surname>Mednick</surname>, <given-names>S. C.</given-names></string-name>, and <string-name><surname>Norman</surname>, <given-names>K. A</given-names></string-name></person-group>. (<year>2018</year>). <article-title>Human hippocampal replay during rest prioritizes weakly learned information and predicts memory performance</article-title>. <source>Nature Communications</source>, <volume>9</volume>(<issue>1</issue>):<fpage>3920</fpage>.</mixed-citation></ref>
<ref id="c76"><label>76.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yu</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Zadbood</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Chanales</surname>, <given-names>A. J.</given-names></string-name>, and <string-name><surname>Davachi</surname>, <given-names>L</given-names></string-name></person-group>. (<year>2024</year>). <article-title>Repetition dynamically and rapidly increases cortical, but not hippocampal, offline reactivation</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>121</volume>(<issue>40</issue>):<fpage>e2405929121</fpage>.</mixed-citation></ref>
<ref id="c77"><label>77.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McClelland</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>McNaughton</surname>, <given-names>B. L.</given-names></string-name>, and <string-name><surname>O’Reilly</surname>, <given-names>R. C</given-names></string-name></person-group>. (<year>1995</year>). <article-title>Why there are complementary learning systems in the hippocampus and neocortex: insights from the successes and failures of connectionist models of learning and memory</article-title>. <source>Psychological review</source>, <volume>102</volume>(<issue>3</issue>):<fpage>419</fpage>.</mixed-citation></ref>
<ref id="c78"><label>78.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wimmer</surname>, <given-names>G. E.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Vehar</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Behrens</surname>, <given-names>T. E.</given-names></string-name>, and <string-name><surname>Dolan</surname>, <given-names>R. J</given-names></string-name></person-group>. (<year>2020</year>). <article-title>Episodic memory retrieval success is associated with rapid replay of episode content</article-title>. <source>Nature neuroscience</source>, <volume>23</volume>(<issue>8</issue>):<fpage>1025</fpage>–<lpage>1033</lpage>.</mixed-citation></ref>
<ref id="c79"><label>79.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mattar</surname>, <given-names>M. G.</given-names></string-name> and <string-name><surname>Lengyel</surname>, <given-names>M</given-names></string-name></person-group>. (<year>2022</year>). <article-title>Planning in the brain</article-title>. <source>Neuron</source>.</mixed-citation></ref>
<ref id="c80"><label>80.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Jensen</surname>, <given-names>K. T.</given-names></string-name>, <string-name><surname>Hennequin</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Mattar</surname>, <given-names>M. G.</given-names></string-name></person-group> (<year>2023</year>). <article-title>A recurrent network model of planning explains hippocampal replay and human behavior</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c81"><label>81.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pfeiffer</surname>, <given-names>B. E.</given-names></string-name> and <string-name><surname>Foster</surname>, <given-names>D. J</given-names></string-name></person-group>. (<year>2013</year>). <article-title>Hippocampal place-cell sequences depict future paths to remembered goals</article-title>. <source>Nature</source>, <volume>497</volume>(<issue>7447</issue>):<fpage>74</fpage>–<lpage>79</lpage>.</mixed-citation></ref>
<ref id="c82"><label>82.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oudiette</surname>, <given-names>D.</given-names></string-name> and <string-name><surname>Paller</surname>, <given-names>K. A</given-names></string-name></person-group>. (<year>2013</year>). <article-title>Upgrading the sleeping brain with targeted memory reactivation</article-title>. <source>Trends in cognitive sciences</source>, <volume>17</volume>(<issue>3</issue>):<fpage>142</fpage>–<lpage>149</lpage>.</mixed-citation></ref>
<ref id="c83"><label>83.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schapiro</surname>, <given-names>A. C.</given-names></string-name>, <string-name><surname>Reid</surname>, <given-names>A. G.</given-names></string-name>, <string-name><surname>Morgan</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Manoach</surname>, <given-names>D. S.</given-names></string-name>, <string-name><surname>Verfaellie</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Stickgold</surname>, <given-names>R</given-names></string-name></person-group>. (<year>2019</year>). <article-title>The hippocampus is necessary for the consolidation of a task that does not require the hippocampus for initial learning</article-title>. <source>Hippocampus</source>, <volume>29</volume>(<issue>11</issue>):<fpage>1091</fpage>–<lpage>1100</lpage>.</mixed-citation></ref>
<ref id="c84"><label>84.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sawangjit</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Oyanedel</surname>, <given-names>C. N.</given-names></string-name>, <string-name><surname>Niethard</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Salazar</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Born</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Inostroza</surname>, <given-names>M</given-names></string-name></person-group>. (<year>2018</year>). <article-title>The hippocampus is crucial for forming non-hippocampal long-term memory during sleep</article-title>. <source>Nature</source>, <volume>564</volume>(<issue>7734</issue>):<fpage>109</fpage>– <lpage>113</lpage>.</mixed-citation></ref>
<ref id="c85"><label>85.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eichenlaub</surname>, <given-names>J.-B.</given-names></string-name>, <string-name><surname>Jarosiewicz</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Saab</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Franco</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Kelemen</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Halgren</surname>, <given-names>E.</given-names></string-name>, and <string-name><surname>Cash</surname>, <given-names>S. S</given-names></string-name></person-group>. (<year>2020</year>). <article-title>Replay of learned neural firing sequences during rest in human motor cortex</article-title>. <source>Cell Reports</source>, <volume>31</volume>(<issue>5</issue>):<fpage>107581</fpage>.</mixed-citation></ref>
<ref id="c86"><label>86.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alvarez</surname>, <given-names>P.</given-names></string-name> and <string-name><surname>Squire</surname>, <given-names>L. R</given-names></string-name></person-group>. (<year>1994</year>). <article-title>Memory consolidation and the medial temporal lobe: a simple network model</article-title>. <source>Proceedings of the national academy of sciences</source>, <volume>91</volume>(<issue>15</issue>):<fpage>7041</fpage>–<lpage>7045</lpage>.</mixed-citation></ref>
<ref id="c87"><label>87.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Advani</surname>, <given-names>M. S.</given-names></string-name>, <string-name><surname>Spruston</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Saxe</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Fitzgerald</surname>, <given-names>J. E</given-names></string-name></person-group>. (<year>2023</year>). <article-title>Organizing memories for generalization in complementary learning systems</article-title>. <source>Nature Neuroscience</source>, <volume>26</volume>(<issue>8</issue>):<fpage>1438</fpage>–<lpage>1448</lpage>.</mixed-citation></ref>
<ref id="c88"><label>88.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McNamee</surname>, <given-names>D. C.</given-names></string-name>, <string-name><surname>Stachenfeld</surname>, <given-names>K. L.</given-names></string-name>, <string-name><surname>Botvinick</surname>, <given-names>M. M.</given-names></string-name>, and <string-name><surname>Gershman</surname>, <given-names>S. J</given-names></string-name></person-group>. (<year>2021</year>). <article-title>Flexible modulation of sequence generation in the entorhinal–hippocampal system</article-title>. <source>Nature neuroscience</source>, <volume>24</volume>(<issue>6</issue>):<fpage>851</fpage>–<lpage>862</lpage>.</mixed-citation></ref>
<ref id="c89"><label>89.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Diamond</surname>, <given-names>N. B.</given-names></string-name>, <string-name><surname>Simpson</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Baena Pérez</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Murray</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Fogel</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Levine</surname>, <given-names>B.</given-names></string-name></person-group> (<year>2024</year>). <article-title>Sleep selectively and durably enhances real-world sequence memory</article-title>. <source>bioRxiv</source>.</mixed-citation></ref>
<ref id="c90"><label>90.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sagiv</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Akam</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Witten</surname>, <given-names>I. B.</given-names></string-name>, and <string-name><surname>Daw</surname>, <given-names>N. D.</given-names></string-name></person-group> (<year>2025</year>). <article-title>Between planning and map building: Prioritizing replay when future goals are uncertain</article-title>. <source>Neuron</source>. <comment>In press</comment>.</mixed-citation></ref>
<ref id="c91"><label>91.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Joo</surname>, <given-names>H. R.</given-names></string-name> and <string-name><surname>Frank</surname>, <given-names>L. M</given-names></string-name></person-group>. (<year>2018</year>). <article-title>The hippocampal sharp wave–ripple in memory retrieval for immediate use and consolidation</article-title>. <source>Nature Reviews Neuroscience</source>, <volume>19</volume>(<issue>12</issue>):<fpage>744</fpage>–<lpage>757</lpage>.</mixed-citation></ref>
<ref id="c92"><label>92.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diba</surname>, <given-names>K</given-names></string-name></person-group>. (<year>2021</year>). <article-title>Hippocampal sharp-wave ripples in cognitive map maintenance versus episodic simulation</article-title>. <source>Neuron</source>, <volume>109</volume>(<issue>19</issue>):<fpage>3071</fpage>–<lpage>3074</lpage>.</mixed-citation></ref>
<ref id="c93"><label>93.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xu</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Baracskay</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>O’Neill</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Csicsvari</surname>, <given-names>J</given-names></string-name></person-group>. (<year>2019</year>). <article-title>Assembly responses of hippocampal CA1 place cells predict learned behavior in goal-directed spatial tasks on the radial eight-arm maze</article-title>. <source>Neuron</source>, <volume>101</volume>(<issue>1</issue>):<fpage>119</fpage>–<lpage>132</lpage>.</mixed-citation></ref>
<ref id="c94"><label>94.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhou</surname>, <given-names>C. Y.</given-names></string-name>, <string-name><surname>Talmi</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Daw</surname>, <given-names>N. D.</given-names></string-name>, and <string-name><surname>Mattar</surname>, <given-names>M. G</given-names></string-name></person-group>. (<year>2024</year>). <article-title>Episodic retrieval for model-based evaluation in sequential decision tasks</article-title>. <source>Psychological Review</source>.</mixed-citation></ref>
<ref id="c95"><label>95.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Antony</surname>, <given-names>J. W.</given-names></string-name> and <string-name><surname>Schapiro</surname>, <given-names>A. C</given-names></string-name></person-group>. (<year>2019</year>). <article-title>Active and effective replay: systems consolidation reconsidered again</article-title>. <source>Nature Reviews Neuroscience</source>, <volume>20</volume>(<issue>8</issue>):<fpage>506</fpage>–<lpage>507</lpage>.</mixed-citation></ref>
<ref id="c96"><label>96.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cowan</surname>, <given-names>E. T.</given-names></string-name>, <string-name><surname>Schapiro</surname>, <given-names>A. C.</given-names></string-name>, <string-name><surname>Dunsmoor</surname>, <given-names>J. E.</given-names></string-name>, and <string-name><surname>Murty</surname>, <given-names>V. P</given-names></string-name></person-group>. (<year>2021</year>). <article-title>Memory consolidation as an adaptive process</article-title>. <source>Psychonomic Bulletin &amp; Review</source>, <volume>28</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation></ref>
<ref id="c97"><label>97.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yonelinas</surname>, <given-names>A. P.</given-names></string-name>, <string-name><surname>Ranganath</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Ekstrom</surname>, <given-names>A. D.</given-names></string-name>, and <string-name><surname>Wiltgen</surname>, <given-names>B. J</given-names></string-name></person-group>. (<year>2019</year>). <article-title>A contextual binding theory of episodic memory: systems consolidation reconsidered</article-title>. <source>Nature Reviews Neuroscience</source>, <volume>20</volume>(<issue>6</issue>):<fpage>364</fpage>–<lpage>375</lpage>.</mixed-citation></ref>
<ref id="c98"><label>98.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schechtman</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Heilberg</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Paller</surname>, <given-names>K. A</given-names></string-name></person-group>. (<year>2023a</year>). <article-title>Memory consolidation during sleep involves context reinstatement in humans</article-title>. <source>Cell reports</source>, <volume>42</volume>(<issue>4</issue>).</mixed-citation></ref>
<ref id="c99"><label>99.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schechtman</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Heilberg</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Paller</surname>, <given-names>K. A</given-names></string-name></person-group>. (<year>2023b</year>). <article-title>Context matters: changes in memory over a period of sleep are driven by encoding context</article-title>. <source>Learning &amp; Memory</source>, <volume>30</volume>(<issue>2</issue>):<fpage>36</fpage>–<lpage>42</lpage>.</mixed-citation></ref>
<ref id="c100"><label>100.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>X.</given-names></string-name> and <string-name><surname>Ranganath</surname>, <given-names>C</given-names></string-name></person-group>. (<year>2021</year>). <article-title>Resurrected memories: Sleep-dependent memory consolidation saves memories from competition induced by retrieval practice</article-title>. <source>Psychonomic Bulletin &amp; Review</source>, <volume>28</volume>(<issue>6</issue>):<fpage>2035</fpage>– <lpage>2044</lpage>.</mixed-citation></ref>
<ref id="c101"><label>101.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Sherman</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Gonciulea</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Siefert</surname>, <given-names>E.</given-names></string-name>, and <string-name><surname>Schapiro</surname>, <given-names>A.</given-names></string-name></person-group> (<year>2025</year>). <article-title>Prior knowledge scaffolds acquisition of new memories but only sleep supports integration</article-title>. <source>PsyArXiv</source>.</mixed-citation></ref>
<ref id="c102"><label>102.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>X. L.</given-names></string-name>, <string-name><surname>Ranganath</surname>, <given-names>C.</given-names></string-name>, and <string-name><surname>O’Reilly</surname>, <given-names>R. C</given-names></string-name></person-group>. (<year>2024</year>). <article-title>A complementary learning systems model of how sleep moderates retrieval practice effects</article-title>. <source>Psychonomic Bulletin &amp; Review</source>, <volume>31</volume>(<issue>5</issue>):<fpage>2022</fpage>–<lpage>2035</lpage>.</mixed-citation></ref>
<ref id="c103"><label>103.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drosopoulos</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Windau</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Wagner</surname>, <given-names>U.</given-names></string-name>, and <string-name><surname>Born</surname>, <given-names>J</given-names></string-name></person-group>. (<year>2007</year>). <article-title>Sleep enforces the temporal order in memory</article-title>. <source>PLoS One</source>, <volume>2</volume>(<issue>4</issue>):<fpage>e376</fpage>.</mixed-citation></ref>
<ref id="c104"><label>104.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Johnson</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>Redish</surname>, <given-names>A. D</given-names></string-name></person-group>. (<year>2007</year>). <article-title>Neural ensembles in CA3 transiently encode paths forward of the animal at a decision point</article-title>. <source>Journal of Neuroscience</source>, <volume>27</volume>(<issue>45</issue>):<fpage>12176</fpage>–<lpage>12189</lpage>.</mixed-citation></ref>
<ref id="c105"><label>105.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Foster</surname>, <given-names>D. J.</given-names></string-name>, and <string-name><surname>Pfeiffer</surname>, <given-names>B. E</given-names></string-name></person-group>. (<year>2020</year>). <article-title>Alternating sequences of future and past behavior encoded within hippocampal theta oscillations</article-title>. <source>Science</source>, <volume>370</volume>(<issue>6513</issue>):<fpage>247</fpage>–<lpage>250</lpage>.</mixed-citation></ref>
<ref id="c106"><label>106.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Blum</surname>, <given-names>K. I.</given-names></string-name> and <string-name><surname>Abbott</surname>, <given-names>L. F</given-names></string-name></person-group>. (<year>1996</year>). <article-title>A model of spatial map formation in the hippocampus of the rat</article-title>. <source>Neural computation</source>, <volume>8</volume>(<issue>1</issue>):<fpage>85</fpage>–<lpage>93</lpage>.</mixed-citation></ref>
<ref id="c107"><label>107.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jensen</surname>, <given-names>O.</given-names></string-name> and <string-name><surname>Lisman</surname>, <given-names>J. E</given-names></string-name></person-group>. (<year>2005</year>). <article-title>Hippocampal sequence-encoding driven by a cortical multi-item working memory buffer</article-title>. <source>Trends in neurosciences</source>, <volume>28</volume>(<issue>2</issue>):<fpage>67</fpage>–<lpage>72</lpage>.</mixed-citation></ref>
<ref id="c108"><label>108.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mehta</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>Barnes</surname>, <given-names>C. A.</given-names></string-name>, and <string-name><surname>McNaughton</surname>, <given-names>B. L</given-names></string-name></person-group>. (<year>1997</year>). <article-title>Experience-dependent, asymmetric expansion of hippocampal place fields</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>94</volume>(<issue>16</issue>):<fpage>8918</fpage>– <lpage>8921</lpage>.</mixed-citation></ref>
<ref id="c109"><label>109.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Redish</surname>, <given-names>A. D.</given-names></string-name> and <string-name><surname>Touretzky</surname>, <given-names>D. S</given-names></string-name></person-group>. (<year>1998</year>). <article-title>The role of the hippocampus in solving the Morris water maze</article-title>. <source>Neural computation</source>, <volume>10</volume>(<issue>1</issue>):<fpage>73</fpage>–<lpage>111</lpage>.</mixed-citation></ref>
<ref id="c110"><label>110.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wikenheiser</surname>, <given-names>A. M.</given-names></string-name> and <string-name><surname>Redish</surname>, <given-names>A. D</given-names></string-name></person-group>. (<year>2015</year>). <article-title>Hippocampal theta sequences reflect current goals</article-title>. <source>Nature neuroscience</source>, <volume>18</volume>(<issue>2</issue>):<fpage>289</fpage>–<lpage>294</lpage>.</mixed-citation></ref>
<ref id="c111"><label>111.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lisman</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Redish</surname>, <given-names>A. D</given-names></string-name></person-group>. (<year>2009</year>). <article-title>Prediction, sequences and the hippocampus</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source>, <volume>364</volume>(<issue>1521</issue>):<fpage>1193</fpage>–<lpage>1201</lpage>.</mixed-citation></ref>
<ref id="c112"><label>112.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mallory</surname>, <given-names>C. S.</given-names></string-name>, <string-name><surname>Widloski</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Foster</surname>, <given-names>D. J</given-names></string-name></person-group>. (<year>2025</year>). <article-title>The time course and organization of hippocampal replay</article-title>. <source>Science</source>, <volume>387</volume>(<issue>6733</issue>):<fpage>541</fpage>–<lpage>548</lpage>.</mixed-citation></ref>
<ref id="c113"><label>113.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tononi</surname>, <given-names>G.</given-names></string-name> and <string-name><surname>Cirelli</surname>, <given-names>C</given-names></string-name></person-group>. (<year>2006</year>). <article-title>Sleep function and synaptic homeostasis</article-title>. <source>Sleep Medicine Reviews</source>, <volume>10</volume>(<issue>1</issue>):<fpage>49</fpage>–<lpage>62</lpage>.</mixed-citation></ref>
<ref id="c114"><label>114.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Euston</surname>, <given-names>D. R.</given-names></string-name>, <string-name><surname>Tatsuno</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>McNaughton</surname>, <given-names>B. L</given-names></string-name></person-group>. (<year>2007</year>). <article-title>Fast-forward playback of recent memory sequences in prefrontal cortex during sleep</article-title>. <source>Science</source>, <volume>318</volume>(<issue>5853</issue>):<fpage>1147</fpage>–<lpage>1150</lpage>.</mixed-citation></ref>
<ref id="c115"><label>115.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Neill</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Boccara</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Stella</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Schoenenberger</surname>, <given-names>P.</given-names></string-name>, and <string-name><surname>Csicsvari</surname>, <given-names>J</given-names></string-name></person-group>. (<year>2017</year>). <article-title>Superficial layers of the medial entorhinal cortex replay independently of the hippocampus</article-title>. <source>Science</source>, <volume>355</volume>(<issue>6321</issue>):<fpage>184</fpage>–<lpage>188</lpage>.</mixed-citation></ref>
<ref id="c116"><label>116.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vaz</surname>, <given-names>A. P.</given-names></string-name>, <string-name><surname>Wittig Jr</surname>, <given-names>J. H.</given-names></string-name>, <string-name><surname>Inati</surname>, <given-names>S. K.</given-names></string-name>, and <string-name><surname>Zaghloul</surname>, <given-names>K. A</given-names></string-name></person-group>. (<year>2020</year>). <article-title>Replay of cortical spiking sequences during human memory retrieval</article-title>. <source>Science</source>, <volume>367</volume>(<issue>6482</issue>):<fpage>1131</fpage>–<lpage>1134</lpage>.</mixed-citation></ref>
<ref id="c117"><label>117.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wittkuhn</surname>, <given-names>L.</given-names></string-name> and <string-name><surname>Schuck</surname>, <given-names>N. W</given-names></string-name></person-group>. (<year>2021</year>). <article-title>Dynamics of fmri patterns reflect sub-second activation sequences and reveal replay in human visual cortex</article-title>. <source>Nature communications</source>, <volume>12</volume>(<issue>1</issue>):<fpage>1795</fpage>.</mixed-citation></ref>
<ref id="c118"><label>118.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Denovellis</surname>, <given-names>E. L.</given-names></string-name>, <string-name><surname>Gillespie</surname>, <given-names>A. K.</given-names></string-name>, <string-name><surname>Coulter</surname>, <given-names>M. E.</given-names></string-name>, <string-name><surname>Sosa</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Chung</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>Eden</surname>, <given-names>U. T.</given-names></string-name>, and <string-name><surname>Frank</surname>, <given-names>L. M</given-names></string-name></person-group>. (<year>2021</year>). <article-title>Hippocampal replay of experience at real-world speeds</article-title>. <source>eLife</source>, <volume>10</volume>:<elocation-id>e64505</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.64505</pub-id></mixed-citation></ref>
<ref id="c119"><label>119.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yamamoto</surname>, <given-names>J.</given-names></string-name> and <string-name><surname>Tonegawa</surname>, <given-names>S</given-names></string-name></person-group>. (<year>2017</year>). <article-title>Direct medial entorhinal cortex input to hippocampal CA1 is crucial for extended quiet awake replay</article-title>. <source>Neuron</source>, <volume>96</volume>(<issue>1</issue>):<fpage>217</fpage>–<lpage>227</lpage>.</mixed-citation></ref>
<ref id="c120"><label>120.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hasselmo</surname>, <given-names>M. E</given-names></string-name></person-group>. (<year>1999</year>). <article-title>Neuromodulation: acetylcholine and memory consolidation</article-title>. <source>Trends in Cognitive Sciences</source>, <volume>3</volume>(<issue>9</issue>):<fpage>351</fpage>–<lpage>359</lpage>.</mixed-citation></ref>
<ref id="c121"><label>121.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ólafsdóttir</surname>, <given-names>H. F.</given-names></string-name>, <string-name><surname>Carpenter</surname>, <given-names>F.</given-names></string-name>, and <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name></person-group> (<year>2017</year>). <article-title>Task demands predict a dynamic switch in the content of awake hippocampal replay</article-title>. <source>Neuron</source>, <volume>96</volume>(<issue>4</issue>):<fpage>925</fpage>–<lpage>935</lpage>.</mixed-citation></ref>
<ref id="c122"><label>122.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ecker</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Bagi</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Vértes</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Steinbach-Németh</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Karlócai</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>Papp</surname>, <given-names>O. I.</given-names></string-name>, <string-name><surname>Miklós</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Norbert Hájos</surname>, <given-names>T. F. F.</given-names></string-name>, <string-name><surname>Gulyás</surname>, <given-names>A. I.</given-names></string-name>, and <string-name><surname>Káli</surname>, <given-names>S.</given-names></string-name></person-group> (<year>2022</year>). <article-title>Hippocampal sharp wave-ripples and the associated sequence replay emerge from structured synaptic interactions in a network model of area ca3</article-title>. <source>eLife</source>, <volume>11</volume>:<elocation-id>e71850</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.71850</pub-id></mixed-citation></ref>
<ref id="c123"><label>123.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hasselmo</surname>, <given-names>M. E</given-names></string-name></person-group>. (<year>2008</year>). <article-title>Temporally structured replay of neural activity in a model of entorhinal cortex, hippocampus and postsubiculum</article-title>. <source>European Journal of Neuroscience</source>, <volume>28</volume>(<issue>7</issue>):<fpage>1301</fpage>–<lpage>1315</lpage>.</mixed-citation></ref>
<ref id="c124"><label>124.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Levenstein</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Efremov</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Eyono</surname>, <given-names>R. H.</given-names></string-name>, <string-name><surname>Peyrache</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Richards</surname>, <given-names>B</given-names></string-name></person-group>. (<year>2024</year>). <article-title>Sequential predictive learning is a unifying theory for hippocampal representation and replay</article-title>. <source>bioRxiv</source>, 2024-04.</mixed-citation></ref>
<ref id="c125"><label>125.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname>, <given-names>B.</given-names></string-name> and <string-name><surname>McNaughton</surname>, <given-names>B. L</given-names></string-name></person-group>. (<year>1996</year>). <article-title>Modeling the spontaneous reactivation of experience-specific hippocampal cell assembles during sleep</article-title>. <source>Hippocampus</source>, <volume>6</volume>(<issue>6</issue>):<fpage>685</fpage>–<lpage>692</lpage>.</mixed-citation></ref>
<ref id="c126"><label>126.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spens</surname>, <given-names>E.</given-names></string-name> and <string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name></person-group>. (<year>2024</year>). <article-title>A generative model of memory construction and consolidation</article-title>. <source>Nature Human Behaviour</source>, <volume>8</volume>(<issue>3</issue>):<fpage>526</fpage>–<lpage>543</lpage>.</mixed-citation></ref>
<ref id="c127"><label>127.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haga</surname>, <given-names>T.</given-names></string-name> and <string-name><surname>Fukai</surname>, <given-names>T</given-names></string-name></person-group>. (<year>2018</year>). <article-title>Recurrent network model for learning goal-directed sequences through reverse replay</article-title>. <source>eLife</source>, <volume>7</volume>:<elocation-id>e34171</elocation-id>. <pub-id pub-id-type="doi">10.7554/eLife.34171</pub-id></mixed-citation></ref>
<ref id="c128"><label>128.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barry</surname>, <given-names>D. N.</given-names></string-name> and <string-name><surname>Love</surname>, <given-names>B. C</given-names></string-name></person-group>. (<year>2023</year>). <article-title>A neural network account of memory replay and knowledge consolidation</article-title>. <source>Cerebral Cortex</source>, <volume>33</volume>(<issue>1</issue>):<fpage>83</fpage>–<lpage>95</lpage>.</mixed-citation></ref>
<ref id="c129"><label>129.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Káli</surname>, <given-names>S.</given-names></string-name> and <string-name><surname>Dayan</surname>, <given-names>P</given-names></string-name></person-group>. (<year>2004</year>). <article-title>Off-line replay maintains declarative memories in a model of hippocampal-neocortical interactions</article-title>. <source>Nature neuroscience</source>, <volume>7</volume>(<issue>3</issue>):<fpage>286</fpage>–<lpage>294</lpage>.</mixed-citation></ref>
<ref id="c130"><label>130.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Santoro</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Frankland</surname>, <given-names>P. W.</given-names></string-name>, and <string-name><surname>Richards</surname>, <given-names>B. A</given-names></string-name></person-group>. (<year>2016</year>). <article-title>Memory transformation enhances reinforcement learning in dynamic environments</article-title>. <source>Journal of Neuroscience</source>, <volume>36</volume>(<issue>48</issue>):<fpage>12228</fpage>–<lpage>12242</lpage>.</mixed-citation></ref>
<ref id="c131"><label>131.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>De Vivo</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Bellesi</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Marshall</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Bushong</surname>, <given-names>E. A.</given-names></string-name>, <string-name><surname>Ellisman</surname>, <given-names>M. H.</given-names></string-name>, <string-name><surname>Tononi</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Cirelli</surname>, <given-names>C.</given-names></string-name></person-group> (<year>2017</year>). <article-title>Ultrastructural evidence for synaptic scaling across the wake/sleep cycle</article-title>. <source>Science</source>, <volume>355</volume>(<issue>6324</issue>):<fpage>507</fpage>– <lpage>510</lpage>.</mixed-citation></ref>
<ref id="c132"><label>132.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maret</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Faraguna</surname>, <given-names>U.</given-names></string-name>, <string-name><surname>Nelson</surname>, <given-names>A. B.</given-names></string-name>, <string-name><surname>Cirelli</surname>, <given-names>C.</given-names></string-name>, and <string-name><surname>Tononi</surname>, <given-names>G</given-names></string-name></person-group>. (<year>2011</year>). <article-title>Sleep and waking modulate spine turnover in the adolescent mouse cortex</article-title>. <source>Nature Neuroscience</source>, <volume>14</volume>(<issue>11</issue>):<fpage>1418</fpage>–<lpage>1420</lpage>.</mixed-citation></ref>
<ref id="c133"><label>133.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McLaren</surname>, <given-names>I. P. L.</given-names></string-name> and <string-name><surname>Mackintosh</surname>, <given-names>N. J</given-names></string-name></person-group>. (<year>2002</year>). <article-title>Associative learning and elemental representation: Ii. generalization and discrimination</article-title>. <source>Animal Learning &amp; Behavior</source>, <volume>30</volume>(<issue>3</issue>):<fpage>177</fpage>–<lpage>200</lpage>.</mixed-citation></ref>
<ref id="c134"><label>134.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Antony</surname>, <given-names>J. W.</given-names></string-name>, <string-name><surname>Ferreira</surname>, <given-names>C. S.</given-names></string-name>, <string-name><surname>Norman</surname>, <given-names>K. A.</given-names></string-name>, and <string-name><surname>Wimber</surname>, <given-names>M</given-names></string-name></person-group>. (<year>2017</year>). <article-title>Retrieval as a fast route to memory consolidation</article-title>. <source>Trends in cognitive sciences</source>, <volume>21</volume>(<issue>8</issue>):<fpage>573</fpage>–<lpage>576</lpage>.</mixed-citation></ref>
<ref id="c135"><label>135.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Kong</surname>, <given-names>X.-Z.</given-names></string-name>, <string-name><surname>Ranganath</surname>, <given-names>C.</given-names></string-name>, and <string-name><surname>Melloni</surname>, <given-names>L</given-names></string-name></person-group>. (<year>2022</year>). <article-title>Event boundaries shape temporal organization of memory by resetting temporal context</article-title>. <source>Nature communications</source>, <volume>13</volume>(<issue>1</issue>):<fpage>622</fpage>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99931.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Liljeholm</surname>
<given-names>Mimi</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/04gyf1771</institution-id><institution>University of California, Irvine</institution>
</institution-wrap>
<city>Irvine</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Compelling</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This is an <bold>important</bold> account of replay as recency-weighted context-guided memory reactivation that explains a number of empirical findings across human and rodent memory literatures. The evidence is <bold>compelling</bold> and the work is likely to inspire further adaptions to incorporate additional biological and cognitive features.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99931.2.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>Zhou and colleagues developed a computational model of replay that heavily builds on cognitive models of memory in context (e.g., the context-maintenance and retrieval model), which have been successfully used to explain memory phenomena in the past. Their model produces results that mirror previous empirical findings in rodents and offers a new computational framework for thinking about replay.</p>
<p>Strengths:</p>
<p>The model is compelling and seems to explain a number of findings from the rodent literature. It is commendable that the authors implement commonly used algorithms from wakefulness to model sleep/rest, thereby linking wake and sleep phenomena in a parsimonious way. Additionally, the manuscript's comprehensive perspective on replay, bridging humans and non-human animals, enhanced its theoretical contribution.</p>
<p>Weaknesses:</p>
<p>This reviewer is not a computational neuroscientist by training, so some comments may stem from misunderstandings. I hope the authors would see those instances as opportunities to clarify their findings for broader audiences.</p>
<p>(1) The model predicts that temporally close items will be co-reactivated, yet evidence from humans suggests that temporal context doesn't guide sleep benefits (instead, semantic connections seem to be of more importance; Liu and Ranganath 2021, Schechtman et al 2023). Could these findings be reconciled with the model or is this a limitation of the current framework?</p>
<p>(2) During replay, the model is set so that the next reactivated item is sampled without replacement (i.e., the model cannot get &quot;stuck&quot; on a single item). I'm not sure what the biological backing behind this is and why the brain can't reactivate the same item consistently. Furthermore, I'm afraid that such a rule may artificially generate sequential reactivation of items regardless of wake training. Could the authors explain this better or show that this isn't the case?</p>
<p>(3) If I understand correctly, there are two ways in which novelty (i.e., less exposure) is accounted for in the model. The first and more talked about is the suppression mechanism (lines 639-646). The second is a change in learning rates (lines 593-595). It's unclear to me why both procedures are needed, how they differ, and whether these are two different mechanisms that the model implements. Also, since the authors controlled the extent to which each item was experienced during wakefulness, it's not entirely clear to me which of the simulations manipulated novelty on an individual item level, as described in lines 593-595 (if any).</p>
<p>As to the first mechanism - experience-based suppression - I find it challenging to think of a biological mechanism that would achieve this and is selectively activated immediately before sleep (somehow anticipating its onset). In fact, the prominent synaptic homeostasis hypothesis suggests that such suppression, at least on a synaptic level, is exactly what sleep itself does (i.e., prune or weaken synapses that were enhanced due to learning during the day). This begs the question of whether certain sleep stages (or ultradian cycles) may be involved in pruning, whereas others leverage its results for reactivation (e.g., a sequential hypothesis; Rasch &amp; Born, 2013). That could be a compelling synthesis of this literature. Regardless of whether the authors agree, I believe that this point is a major caveat to the current model. It is addressed in the discussion, but perhaps it would be beneficial to explicitly state to what extent the results rely on the assumption of a pre-sleep suppression mechanism.</p>
<p>(4) As the manuscript mentions, the only difference between sleep and wake in the model is the initial conditions (a0). This is an obvious simplification, especially given the last author's recent models discussing the very different roles of REM vs NREM. Could the authors suggest how different sleep stages may relate to the model or how it could be developed to interact with other successful models such as the ones the last author has developed (e.g., C-HORSE)? Finally, I wonder how the model would explain findings (including the authors') showing a preference for reactivation of weaker memories. The literature seems to suggest that it isn't just a matter of novelty or exposure, but encoding strength. Can the model explain this? Or would it require additional assumptions or some mechanism for selective endogenous reactivation during sleep and rest?</p>
<p>(5) Lines 186-200 - Perhaps I'm misunderstanding, but wouldn't it be trivial that an external cue at the end-item of Figure 7a would result in backward replay, simply because there is no potential for forward replay for sequences starting at the last item (there simply aren't any subsequent items)? The opposite is true, of course, for the first-item replay, which can't go backward. More generally, my understanding of the literature on forward vs backward replay is that neither is linked to the rodent's location. Both commonly happen at a resting station that is further away from the track. It seems as though the model's result may not hold if replay occurs away from the track (i.e. if a0 would be equal for both pre- and post-run).</p>
<p>(6) The manuscript describes a study by Bendor &amp; Wilson (2012) and tightly mimics their results. However, notably, that study did not find triggered replay immediately following sound presentation, but rather a general bias toward reactivation of the cued sequence over longer stretches of time. In other words, it seems that the model's results don't fully mirror the empirical results. One idea that came to mind is that perhaps it is the R/L context - not the first R/L item - that is cued in this study. This is in line with other TMR studies showing what may be seen as contextual reactivation. If the authors think that such a simulation may better mirror the empirical results, I encourage them to try. If not, however, this limitation should be discussed.</p>
<p>(7) There is some discussion about replay's benefit to memory. One point of interest could be whether this benefit changes between wake and sleep. Relatedly, it would be interesting to see whether the proportion of forward replay, backward replay, or both correlated with memory benefits. I encourage the authors to extend the section on the function of replay and explore these questions.</p>
<p>(8) Replay has been mostly studied in rodents, with few exceptions, whereas CMR and similar models have mostly been used in humans. Although replay is considered a good model of episodic memory, it is still limited due to limited findings of sequential replay in humans and its reliance on very structured and inherently autocorrelated items (i.e., place fields). I'm wondering if the authors could speak to the implications of those limitations on the generalizability of their model. Relatedly, I wonder if the model could or does lead to generalization to some extent in a way that would align with the complementary learning systems framework.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99931.2.sa1</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>In this manuscript, Zhou et al. present a computational model of memory replay. Their model (CMR-replay) draws from temporal context models of human memory (e.g., TCM, CMR) and claims replay may be another instance of a context-guided memory process. During awake learning, CMR-replay (like its predecessors) encodes items alongside a drifting mental context that maintains a recency-weighted history of recently encoded contexts/items. In this way, the presently encoded item becomes associated with other recently learned items via their shared context representation - giving rise to typical effects in recall such as primacy, recency and contiguity. Unlike its predecessors, CMR-replay has built in replay periods. These replay periods are designed to approximate sleep or wakeful quiescence, in which an item is spontaneously reactivated, causing a subsequent cascade of item-context reactivations that further update the model's items-context associations.</p>
<p>Using this model of replay, Zhou et al. were able to reproduce a variety of empirical findings in the replay literature: e.g., greater forward replay at the beginning of a track and more backwards replay at the end; more replay for rewarded events; the occurrence of remote replay; reduced replay for repeated items, etc. Furthermore, the model diverges considerably (in implementation and predictions) from other prominent models of replay that, instead, emphasize replay as a way of predicting value from a reinforcement learning framing (i.e., EVB, expected value backup).</p>
<p>Overall, I found the manuscript clear and easy to follow, despite not being a computational modeller myself. (Which is pretty commendable, I'd say). The model also was effective at capturing several important empirical results from the replay literature while relying on a concise set of mechanisms - which will have implications for subsequent theory building in the field.</p>
<p>The authors addressed my concerns with respect to adding methodological detail. I am satisfied with the changes.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99931.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Zhou</surname>
<given-names>Zhenglong</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0003-4003-7214</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Kahana</surname>
<given-names>Michael J</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8122-9525</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Schapiro</surname>
<given-names>Anna C</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">https://orcid.org/0000-0001-8086-0331</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>Summary:</p>
<p>Zhou and colleagues developed a computational model of replay that heavily builds on cognitive models of memory in context (e.g., the context-maintenance and retrieval model), which have been successfully used to explain memory phenomena in the past. Their model produces results that mirror previous empirical findings in rodents and offers a new computational framework for thinking about replay.</p>
<p>Strengths:</p>
<p>The model is compelling and seems to explain a number of findings from the rodent literature. It is commendable that the authors implement commonly used algorithms from wakefulness to model sleep/rest, thereby linking wake and sleep phenomena in a parsimonious way. Additionally, the manuscript's comprehensive perspective on replay, bridging humans and non-human animals, enhanced its theoretical contribution.</p>
<p>Weaknesses:</p>
<p>This reviewer is not a computational neuroscientist by training, so some comments may stem from misunderstandings. I hope the authors would see those instances as opportunities to clarify their findings for broader audiences.</p>
<p>(1) The model predicts that temporally close items will be co-reactivated, yet evidence from humans suggests that temporal context doesn't guide sleep benefits (instead, semantic connections seem to be of more importance; Liu and Ranganath 2021, Schechtman et al 2023). Could these findings be reconciled with the model or is this a limitation of the current framework?</p>
</disp-quote>
<p>We appreciate the encouragement to discuss this connection. Our framework can accommodate semantic associations as determinants of sleep-dependent consolidation, which can in principle outweigh temporal associations. Indeed, prior models in this lineage have extensively simulated how semantic associations support encoding and retrieval alongside temporal associations. It would therefore be straightforward to extend our model to simulate how semantic associations guide sleep benefits, and to compare their contribution against that conferred by temporal associations across different experimental paradigms. In the revised manuscript, we have added a discussion of how our framework may simulate the role of semantic associations in sleep-dependent consolidation.</p>
<p>“Several recent studies have argued for dominance of semantic associations over temporal associations in the process of human sleep-dependent consolidation (Schechtman et al., 2023; Liu and Ranganath 2021; Sherman et al., 2025), with one study observing no role at all for temporal associations (Schechtman et al., 2023). At first glance, these findings appear in tension with our model, where temporal associations drive offline consolidation. Indeed, prior models have accounted for these findings by suppressing temporal context during sleep (Liu and Ranganath 2024; Sherman et al., 2025). However, earlier models in the CMR lineage have successfully captured the joint contributions of semantic and temporal associations to encoding and retrieval (Polyn et al., 2009), and these processes could extend naturally to offline replay. In a paradigm where semantic associations are especially salient during awake learning, the model could weight these associations more and account for greater co-reactivation and sleep-dependent memory benefits for semantically related than temporally related items. Consistent with this idea, Schechtman et al. (2023) speculated that their null temporal effects likely reflected the task’s emphasis on semantic associations. When temporal associations are more salient and task-relevant, sleep-related benefits for temporally contiguous items are more likely to emerge (e.g., Drosopoulos et al., 2007; King et al., 2017).”</p>
<p>The reviewer’s comment points to fruitful directions for future work that could employ our framework to dissect the relative contributions of semantic and temporal associations to memory consolidation.</p>
<disp-quote content-type="editor-comment">
<p>(2) During replay, the model is set so that the next reactivated item is sampled without replacement (i.e., the model cannot get &quot;stuck&quot; on a single item). I'm not sure what the biological backing behind this is and why the brain can't reactivate the same item consistently.</p>
</disp-quote>
<p>Furthermore, I'm afraid that such a rule may artificially generate sequential reactivation of items regardless of wake training. Could the authors explain this better or show that this isn't the case?</p>
<p>We appreciate the opportunity to clarify this aspect of the model. We first note that this mechanism has long been a fundamental component of this class of models (Howard &amp; Kahana 2002). Many classic memory models (Brown et al., 2000; Burgess &amp; Hitch, 1991; Lewandowsky &amp; Murdock 1989) incorporate response suppression, in which activated items are temporarily inhibited. The simplest implementation, which we use here, removes activated items from the pool of candidate items. Alternative implementations achieve this through transient inhibition, often conceptualized as neuronal fatigue (Burgess &amp; Hitch, 1991; Grossberg 1978). Our model adopts a similar perspective, interpreting this mechanism as mimicking a brief refractory period that renders reactivated neurons unlikely to fire again within a short physiological event such as a sharp-wave ripple. Importantly, this approach does not generate spurious sequences. Instead, the model’s ability to preserve the structure of wake experience during replay depends entirely on the learned associations between items (without these associations, item order would be random). Similar assumptions are also common in models of replay. For example, reinforcement learning models of replay incorporate mechanisms such as inhibition to prevent repeated reactivations (e.g., Diekmann &amp; Cheng, 2023) or prioritize reactivation based on ranking to limit items to a single replay (e.g., Mattar &amp; Daw, 2018). We now discuss these points in the section titled “A context model of memory replay”</p>
<p>“This mechanism of sampling without replacement, akin to response suppression in established context memory models (Howard &amp; Kahana 2002), could be implemented by neuronal fatigue or refractory dynamics (Burgess &amp; Hitch, 1991; Grossberg 1978). Non-repetition during reactivation is also a common assumption in replay models that regulate reactivation through inhibition or prioritization (Diekmann &amp; Cheng 2023; Mattar &amp; Daw 2018; Singh et al., 2022).”</p>
<disp-quote content-type="editor-comment">
<p>(3) If I understand correctly, there are two ways in which novelty (i.e., less exposure) is accounted for in the model. The first and more talked about is the suppression mechanism (lines 639-646). The second is a change in learning rates (lines 593-595). It's unclear to me why both procedures are needed, how they differ, and whether these are two different mechanisms that the model implements. Also, since the authors controlled the extent to which each item was experienced during wakefulness, it's not entirely clear to me which of the simulations manipulated novelty on an individual item level, as described in lines 593-595 (if any).</p>
</disp-quote>
<p>We agree that these mechanisms and their relationships would benefit from clarification. As noted, novelty influences learning through two distinct mechanisms. First, the suppression mechanism is essential for capturing the inverse relationship between the amount of wake experience and the frequency of replay, as observed in several studies. This mechanism ensures that items with high wake activity are less likely to dominate replay. Second, the decrease in learning rates with repetition is crucial for preserving the stochasticity of replay. Without this mechanism, the model would increase weights linearly, leading to an exponential increase in the probability of successive wake items being reactivated back-to-back due to the use of a softmax choice rule. This would result in deterministic replay patterns, which are inconsistent with experimental observations.</p>
<p>We have revised the Methods section to explicitly distinguish these two mechanisms:</p>
<p>“This experience-dependent suppression mechanism is distinct from the reduction of learning rates through repetition; it does not modulate the update of memory associations but exclusively governs which items are most likely to initiate replay.”</p>
<p>We have also clarified our rationale for including a learning rate reduction mechanism:</p>
<p>“The reduction in learning rates with repetition is important for maintaining a degree of stochasticity in the model’s replay during task repetition, since linearly increasing weights would, through the softmax choice rule, exponentially amplify differences in item reactivation probabilities, sharply reducing variability in replay.”</p>
<p>Finally, we now specify exactly where the learning-rate reduction applied, namely in simulations where sequences are repeated across multiple sessions:</p>
<p>“In this simulation, the learning rates progressively decrease across sessions, as described above.“</p>
<disp-quote content-type="editor-comment">
<p>As to the first mechanism - experience-based suppression - I find it challenging to think of a biological mechanism that would achieve this and is selectively activated immediately before sleep (somehow anticipating its onset). In fact, the prominent synaptic homeostasis hypothesis suggests that such suppression, at least on a synaptic level, is exactly what sleep itself does (i.e., prune or weaken synapses that were enhanced due to learning during the day). This begs the question of whether certain sleep stages (or ultradian cycles) may be involved in pruning, whereas others leverage its results for reactivation (e.g., a sequential hypothesis; Rasch &amp; Born, 2013). That could be a compelling synthesis of this literature. Regardless of whether the authors agree, I believe that this point is a major caveat to the current model. It is addressed in the discussion, but perhaps it would be beneficial to explicitly state to what extent the results rely on the assumption of a pre-sleep suppression mechanism.</p>
</disp-quote>
<p>We appreciate the reviewer raising this important point. Unlike the mechanism proposed by the synaptic homeostasis hypothesis, the suppression mechanism in our model does not suppress items based on synapse strength, nor does it modify synaptic weights. Instead, it determines the level of suppression for each item based on activity during awake experience. The brain could implement such a mechanism by tagging each item according to its activity level during wakefulness. During subsequent consolidation, the initial reactivation of an item during replay would reflect this tag, influencing how easily it can be reactivated.</p>
<p>A related hypothesis has been proposed in recent work, suggesting that replay avoids recently active trajectories due to spike frequency adaptation in neurons (Mallory et al., 2024). Similarly, the suppression mechanism in our model is critical for explaining the observed negative relationship between the amount of recent wake experience and the degree of replay.</p>
<p>We discuss the biological plausibility of this mechanism and its relationship with existing models in the Introduction. In the section titled “The influence of experience”, we have added the following:</p>
<p>“Our model implements an activity‑dependent suppression mechanism that, at the onset of each offline replay event, assigns each item a selection probability inversely proportional to its activation during preceding wakefulness. The brain could implement this by tagging each memory trace in proportion to its recent activation; during consolidation, that tag would then regulate starting replay probability, making highly active items less likely to be reactivated. A recent paper found that replay avoids recently traversed trajectories through awake spike‑frequency adaptation (Mallory et al., 2025), which could implement this kind of mechanism. In our simulations, this suppression is essential for capturing the inverse relationship between replay frequency and prior experience. Note that, unlike the synaptic homeostasis hypothesis (Tononi &amp; Cirelli 2006), which proposes that the brain globally downscales synaptic weights during sleep, this mechanism leaves synaptic weights unchanged and instead biases the selection process during replay.”</p>
<disp-quote content-type="editor-comment">
<p>(4) As the manuscript mentions, the only difference between sleep and wake in the model is the initial conditions (a0). This is an obvious simplification, especially given the last author's recent models discussing the very different roles of REM vs NREM. Could the authors suggest how different sleep stages may relate to the model or how it could be developed to interact with other successful models such as the ones the last author has developed (e.g., C-HORSE)?</p>
</disp-quote>
<p>We appreciate the encouragement to comment on the roles of different sleep stages in the manuscript, especially since, as noted, the lab is very interested in this and has explored it in other work. We chose to focus on NREM in this work because the vast majority of electrophysiological studies of sleep replay have identified these events during NREM. In addition, our lab’s theory of the role of REM (Singh et al., 2022, PNAS) is that it is a time for the neocortex to replay remote memories, in complement to the more recent memories replayed during NREM. The experiments we simulate all involve recent memories. Indeed, our view is that part of the reason that there is so little data on REM replay may be that experimenters are almost always looking for traces of recent memories (for good practical and technical reasons).</p>
<p>Regarding the simplicity of the distinction between simulated wake and sleep replay, we view it as an asset of the model that it can account for many of the different characteristics of awake and NREM replay with very simple assumptions about differences in the initial conditions. There are of course many other differences between the states that could be relevant to the impact of replay, but the current target empirical data did not necessitate us taking those into account. This allows us to argue that differences in initial conditions should play a substantial role in an account of the differences between wake and sleep replay.</p>
<p>We have added discussion of these ideas and how they might be incorporated into future versions of the model in the Discussion section:</p>
<p>“Our current simulations have focused on NREM, since the vast majority of electrophysiological studies of sleep replay have identified replay events in this stage. We have proposed in other work that replay during REM sleep may provide a complementary role to NREM sleep, allowing neocortical areas to reinstate remote, already-consolidated memories that need to be integrated with the memories that were recently encoded in the hippocampus and replayed during NREM (Singh et al., 2022). An extension of our model could undertake this kind of continual learning setup, where the student but not teacher network retains remote memories, and the driver of replay alternates between hippocampus (NREM) and cortex (REM) over the course of a night of simulated sleep. Other differences between stages of sleep and between sleep and wake states are likely to become important for a full account of how replay impacts memory. Our current model parsimoniously explains a range of differences between awake and sleep replay by assuming simple differences in initial conditions, but we expect many more characteristics of these states (e.g., neural activity levels, oscillatory profiles, neurotransmitter levels, etc.) will be useful to incorporate in the future.”</p>
<disp-quote content-type="editor-comment">
<p>Finally, I wonder how the model would explain findings (including the authors') showing a preference for reactivation of weaker memories. The literature seems to suggest that it isn't just a matter of novelty or exposure, but encoding strength. Can the model explain this? Or would it require additional assumptions or some mechanism for selective endogenous reactivation during sleep and rest?</p>
</disp-quote>
<p>We appreciate the encouragement to discuss this, as we do think the model could explain findings showing a preference for reactivation of weaker memories, as in Schapiro et al. (2018). In our framework, memory strength is reflected in the magnitude of each memory’s associated synaptic weights, so that stronger memories yield higher retrieved‑context activity during wake encoding than weaker ones. Because the model’s suppression mechanism reduces an item’s replay probability in proportion to its retrieved‑context activity, items with larger weights (strong memories) are more heavily suppressed at the onset of replay, while those with smaller weights (weaker memories) receive less suppression. When items have matched reward exposure, this dynamic would bias offline replay toward weaker memories, therefore preferentially reactivating weak memories.</p>
<p>In the section titled “The influence of experience”, we updated a sentence to discuss this idea more explicitly:</p>
<p>“Such a suppression mechanism may be adaptive, allowing replay to benefit not only the most recently or strongly encoded items but also to provide opportunities for the consolidation of weaker or older memories, consistent with empirical evidence (e.g., Schapiro et al. 2018; Yu et al., 2024).”</p>
<disp-quote content-type="editor-comment">
<p>(5) Lines 186-200 - Perhaps I'm misunderstanding, but wouldn't it be trivial that an external cue at the end-item of Figure 7a would result in backward replay, simply because there is no potential for forward replay for sequences starting at the last item (there simply aren't any subsequent items)? The opposite is true, of course, for the first-item replay, which can't go backward. More generally, my understanding of the literature on forward vs backward replay is that neither is linked to the rodent's location. Both commonly happen at a resting station that is further away from the track. It seems as though the model's result may not hold if replay occurs away from the track (i.e. if a0 would be equal for both pre- and post-run).</p>
</disp-quote>
<p>In studies where animals run back and forth on a linear track, replay events are decoded separately for left and right runs, identifying both forward and reverse sequences for each direction, for example using direction-specific place cell sequence templates. Accordingly, in our simulation of, e.g., Ambrose et al. (2016), we use two independent sequences, one for left runs and one for right runs (an approach that has been taken in prior replay modeling work). Crucially, our model assumes a context reset between running episodes, preventing the final item of one traversal from acquiring contextual associations with the first item of the next. As a result, learning in the two sequences remains independent, and when an external cue is presented at the track’s end, replay predominantly unfolds in the backward direction, only occasionally producing forward segments when the cue briefly reactivates an earlier sequence item before proceeding forward.</p>
<p>We added a note to the section titled “The context-dependency of memory replay” to clarify this:</p>
<p>“In our model, these patterns are identical to those in our simulation of Ambrose et al. (2016), which uses two independent sequences to mimic the two run directions. This is because the drifting context resets before each run sequence is encoded, with the pause between runs acting as an event boundary that prevents the final item of one traversal from associating with the first item of the next, thereby keeping learning in each direction independent.”</p>
<p>To our knowledge, no study has observed a similar asymmetry when animals are fully removed from the track, although both types of replay can be observed when animals are away from the track. For example, Gupta et al. (2010) demonstrated that when animals replay trajectories far from their current location, the ratio of forward vs. backward replay appears more balanced. We now highlight this result in the manuscript and explain how it aligns with the predictions of our model:</p>
<p>“For example, in tasks where the goal is positioned in the middle of an arm rather than at its end, CMR-replay predicts a more balanced ratio of forward and reverse replay, whereas the EVB model still predicts a dominance of reverse replay due to backward gain propagation from the reward. This contrast aligns with empirical findings showing that when the goal is located in the middle of an arm, replay events are more evenly split between forward and reverse directions (Gupta et al., 2010), whereas placing the goal at the end of a track produces a stronger bias toward reverse replay (Diba &amp; Buzsaki 2007).”</p>
<p>Although no studies, to our knowledge, have observed a context-dependent asymmetry between forward and backward replay when the animal is away from the track, our model does posit conditions under which it could. Specifically, it predicts that deliberation on a specific memory, such as during planning, could generate an internal context input that biases replay: actively recalling the first item of a sequence may favor forward replay, while thinking about the last item may promote backward replay, even when the individual is physically distant from the track.</p>
<p>We now discuss this prediction in the section titled “The context-dependency of memory replay”:</p>
<p>“Our model also predicts that deliberation on a specific memory, such as during planning, could serve to elicit an internal context cue that biases replay: actively recalling the first item of a sequence may favor forward replay, while thinking about the last item may promote backward replay, even when the individual is physically distant from the track. While not explored here, this mechanism presents a potential avenue for future modeling and empirical work.”</p>
<disp-quote content-type="editor-comment">
<p>(6) The manuscript describes a study by Bendor &amp; Wilson (2012) and tightly mimics their results. However, notably, that study did not find triggered replay immediately following sound presentation, but rather a general bias toward reactivation of the cued sequence over longer stretches of time. In other words, it seems that the model's results don't fully mirror the empirical results. One idea that came to mind is that perhaps it is the R/L context - not the first R/L item - that is cued in this study. This is in line with other TMR studies showing what may be seen as contextual reactivation. If the authors think that such a simulation may better mirror the empirical results, I encourage them to try. If not, however, this limitation should be discussed.</p>
</disp-quote>
<p>Although our model predicts that replay is triggered immediately by the sound cue, it also predicts a sustained bias toward the cued sequence. Replay in our model unfolds across the rest phase as multiple successive events, so the bias observed in our sleep simulations indeed reflects a prolonged preference for the cued sequence.</p>
<p>We now discuss this issue, acknowledging the discrepancy:</p>
<p>“Bendor and Wilson (2012) found that sound cues during sleep did not trigger immediate replay, but instead biased reactivation toward the cued sequence over an extended period of time. While the model does exhibit some replay triggered immediately by the cue, it also captures the sustained bias toward the cued sequence over an extended period.”</p>
<p>Second, within this framework, context is modeled as a weighted average of the features associated with items. As a result, cueing the model with the first R/L item produces qualitatively similar outcomes as cueing it with a more extended R/L cue that incorporates features of additional items. This is because both approaches ultimately use context features unique to the two sides.</p>
<disp-quote content-type="editor-comment">
<p>(7) There is some discussion about replay's benefit to memory. One point of interest could be whether this benefit changes between wake and sleep. Relatedly, it would be interesting to see whether the proportion of forward replay, backward replay, or both correlated with memory benefits. I encourage the authors to extend the section on the function of replay and explore these questions.</p>
</disp-quote>
<p>We thank the reviewer for this suggestion. Regarding differences in the contribution of wake and sleep to memory, our current simulations predict that compared to rest in the task environment, sleep is less biased toward initiating replay at specific items, leading to a more uniform benefit across all memories. Regarding the contributions of forward and backward replay, our model predicts that both strengthen bidirectional associations between items and contexts, benefiting memory in qualitatively similar ways. Furthermore, we suggest that the offline learning captured  by our teacher-student simulations reflects consolidation processes that are specific to sleep.</p>
<p>We have expanded the section titled “The influence of experience” to discuss these predictions of the model:</p>
<p>“The results outlined above arise from the model's assumption that replay strengthens bidirectional associations between items and contexts to benefit memory. This assumption leads to several predictions about differences across replay types. First, the model predicts that sleep yields different memory benefits compared to rest in the task environment: Sleep is less biased toward initiating replay at specific items, resulting in a more uniform benefit across all memories. Second, the model predicts that forward and backward replay contribute to memory in qualitatively similar ways but tend to benefit different memories. This divergence arises because forward and backward replay exhibit distinct item preferences, with backward replay being more likely to include rewarded items, thereby preferentially benefiting those memories.”</p>
<p>We also updated the “The function of replay” section to include our teacher-student speculation:</p>
<p>“We speculate that the offline learning observed in these simulations corresponds to consolidation processes that operate specifically during sleep, when hippocampal-neocortical dynamics are especially tightly coupled (Klinzing et al., 2019).”</p>
<disp-quote content-type="editor-comment">
<p>(8) Replay has been mostly studied in rodents, with few exceptions, whereas CMR and similar models have mostly been used in humans. Although replay is considered a good model of episodic memory, it is still limited due to limited findings of sequential replay in humans and its reliance on very structured and inherently autocorrelated items (i.e., place fields). I'm wondering if the authors could speak to the implications of those limitations on the generalizability of their model. Relatedly, I wonder if the model could or does lead to generalization to some extent in a way that would align with the complementary learning systems framework.</p>
</disp-quote>
<p>We appreciate these insightful comments. Traditionally, replay studies have focused on spatial tasks with autocorrelated item representations (e.g., place fields). However, an increasing number of human studies have demonstrated sequential replay using stimuli with distinct, unrelated representations. Our model is designed to accommodate both scenarios. In our current simulations, we employ orthogonal item representations while leveraging a shared, temporally autocorrelated context to link successive items. We anticipate that incorporating autocorrelated item representations would further enhance sequence memory by increasing the similarity between successive contexts. Overall, we believe that the model generalizes across a broad range of experimental settings, regardless of the degree of autocorrelation between items. Moreover, the underlying framework has been successfully applied to explain sequential memory in both spatial domains, explaining place cell firing properties (e.g., Howard et al., 2004), and in non-spatial domains, such as free recall experiments where items are arbitrarily related.</p>
<p>In the section titled “A context model of memory replay”, we added this comment to address this point:</p>
<p>“Its contiguity bias stems from its use of shared, temporally autocorrelated context to link successive items, despite the orthogonal nature of individual item representations. This bias would be even stronger if items had overlapping representations, as observed in place fields.”</p>
<p>Since CMR-replay learns distributed context representations where overlap across context vectors captures associative structure, and replay helps strengthen that overlap, this could indeed be viewed as consonant with complementary learning systems integration processes.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>This manuscript proposes a model of replay that focuses on the relation between an item and its context, without considering the value of the item. The model simulates awake learning, awake replay, and sleep replay, and demonstrates parallels between memory phenomenon driven by encoding strength, replay of sequence learning, and activation of nearest neighbor to infer causality. There is some discussion of the importance of suppression/inhibition to reduce activation of only dominant memories to be replayed, potentially boosting memories that are weakly encoded. Very nice replications of several key replay findings including the effect of reward and remote replay, demonstrating the equally salient cue of context for offline memory consolidation.</p>
<p>I have no suggestions for the main body of the study, including methods and simulations, as the work is comprehensive, transparent, and well-described. However, I would like to understand how the CMRreplay model fits with the current understanding of the importance of excitation vs inhibition, remembering vs forgetting, activation vs deactivation, strengthening vs elimination of synapses, and even NREM vs REM as Schapiro has modeled. There seems to be a strong association with the efforts of the model to instantiate a memory as well as how that reinstantiation changes across time. But that is not all this is to consolidation. The specific roles of different brain states and how they might change replay is also an important consideration.</p>
</disp-quote>
<p>We are gratified that the reviewer appreciated the work, and we agree that the paper would benefit from comment on the connections to these other features of consolidation.</p>
<p>Excitation vs. inhibition: CMR-replay does not model variations in the excitation-inhibition balance across brain states (as in other models, e.g., Chenkov et al., 2017), since it does not include inhibitory connections. However, we posit that the experience-dependent suppression mechanism in the model might, in the brain, involve inhibitory processes. Supporting this idea, studies have observed increased inhibition with task repetition (Berners-Lee et al., 2022). We hypothesize that such mechanisms may underlie the observed inverse relationship between task experience and replay frequency in many studies. We discuss this in the section titled “A context model of memory replay”:</p>
<p>“The proposal that a suppression mechanism plays a role in replay aligns with models that regulate place cell reactivation via inhibition (Malerba et al., 2016) and with empirical observations of increased hippocampal inhibitory interneuron activity with experience (Berners-Lee et al., 2022). Our model assumes the presence of such inhibitory mechanisms but does not explicitly model them.”</p>
<p>Remembering/forgetting, activation/deactivation, and strengthening/elimination of synapses: The model does not simulate synaptic weight reduction or pruning, so it does not forget memories through the weakening of associated weights. However, forgetting can occur when a memory is replayed less frequently than others, leading to reduced activation of that memory compared to its competitors during context-driven retrieval. In the Discussion section, we acknowledge that a biologically implausible aspect of our model is that it implements only synaptic strengthening:</p>
<p>“Aspects of the model, such as its lack of regulation of the cumulative positive weight changes that can accrue through repeated replay, are biologically implausible (as biological learning results in both increases and decreases in synaptic weights) and limit the ability to engage with certain forms of low level neural data (e.g., changes in spine density over sleep periods; de Vivo et al., 2017; Maret et al., 2011). It will be useful for future work to explore model variants with more elements of biological plausibility.” Different brain states and NREM vs REM: Reviewer 1 also raised this important issue (see above). We have added the following thoughts on differences between these states and the relationship to our prior work to the Discussion section:</p>
<p>“Our current simulations have focused on NREM, since the vast majority of electrophysiological studies of sleep replay have identified replay events in this stage. We have proposed in other work that replay during REM sleep may provide a complementary role to NREM sleep, allowing neocortical areas to reinstate remote, already-consolidated memories that need to be integrated with the memories that were recently encoded in the hippocampus and replayed during NREM (Singh et al., 2022). An extension of our model could undertake this kind of continual learning setup, where the student but not teacher network retains remote memories, and the driver of replay alternates between hippocampus (NREM) and cortex (REM) over the course of a night of simulated sleep. Other differences between stages of sleep and between sleep and wake states are likely to become important for a full account of how replay impacts memory. Our current model parsimoniously explains a range of differences between awake and sleep replay by assuming simple differences in initial conditions, but we expect many more characteristics of these states (e.g., neural activity levels, oscillatory profiles, neurotransmitter levels, etc.) will be useful to incorporate in the future.”</p>
<p>We hope these points clarify the model’s scope and its potential for future extensions.</p>
<disp-quote content-type="editor-comment">
<p>Do the authors suggest that these replay systems are more universal to offline processes beyond episodic memory? What about procedural memories and working memory?</p>
</disp-quote>
<p>We thank the reviewer for raising this important question. We have clarified in the manuscript:</p>
<p>“We focus on the model as a formulation of hippocampal replay, capturing how the hippocampus may replay past experiences through simple and interpretable mechanisms.”</p>
<p>With respect to other forms of memory, we now note that:</p>
<p>“This motor memory simulation using a model of hippocampal replay is consistent with evidence that hippocampal replay can contribute to consolidating memories that are not hippocampally dependent at encoding (Schapiro et al., 2019; Sawangjit et al., 2018). It is possible that replay in other, more domain-specific areas could also contribute (Eichenlaub et al., 2020).”</p>
<disp-quote content-type="editor-comment">
<p>Though this is not a biophysical model per se, can the authors speak to the neuromodulatory milieus that give rise to the different types of replay?</p>
</disp-quote>
<p>Our work aligns with the perspective proposed by Hasselmo (1999), which suggests that waking and sleep states differ in the degree to which hippocampal activity is driven by external inputs. Specifically, high acetylcholine levels during waking bias activity to flow into the hippocampus, while low acetylcholine levels during sleep allow hippocampal activity to influence other brain regions. Consistent with this view, our model posits that wake replay is more biased toward items associated with the current resting location due to the presence of external input during waking states. In the Discussion section, we have added a comment on this point:</p>
<p>“Our view aligns with the theory proposed by Hasselmo (1999), which suggests that the degree of hippocampal activity driven by external inputs differs between waking and sleep states: High acetylcholine levels during wakefulness bias activity into the hippocampus, while low acetylcholine levels during slow-wave sleep allow hippocampal activity to influence other brain regions.”</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public Review):</bold></p>
<p>In this manuscript, Zhou et al. present a computational model of memory replay. Their model (CMR-replay) draws from temporal context models of human memory (e.g., TCM, CMR) and claims replay may be another instance of a context-guided memory process. During awake learning, CMR replay (like its predecessors) encodes items alongside a drifting mental context that maintains a recency-weighted history of recently encoded contexts/items. In this way, the presently encoded item becomes associated with other recently learned items via their shared context representation - giving rise to typical effects in recall such as primacy, recency, and contiguity. Unlike its predecessors, CMR-replay has built-in replay periods. These replay periods are designed to approximate sleep or wakeful quiescence, in which an item is spontaneously reactivated, causing a subsequent cascade of item-context reactivations that further update the model's item-context associations.</p>
<p>Using this model of replay, Zhou et al. were able to reproduce a variety of empirical findings in the replay literature: e.g., greater forward replay at the beginning of a track and more backward replay at the end; more replay for rewarded events; the occurrence of remote replay; reduced replay for repeated items, etc. Furthermore, the model diverges considerably (in implementation and predictions) from other prominent models of replay that, instead, emphasize replay as a way of predicting value from a reinforcement learning framing (i.e., EVB, expected value backup).</p>
<p>Overall, I found the manuscript clear and easy to follow, despite not being a computational modeller myself. (Which is pretty commendable, I'd say). The model also was effective at capturing several important empirical results from the replay literature while relying on a concise set of mechanisms - which will have implications for subsequent theory-building in the field.</p>
<p>With respect to weaknesses, additional details for some of the methods and results would help the readers better evaluate the data presented here (e.g., explicitly defining how the various 'proportion of replay' DVs were calculated).</p>
<p>For example, for many of the simulations, the y-axis scale differs from the empirical data despite using comparable units, like the proportion of replay events (e.g., Figures 1B and C). Presumably, this was done to emphasize the similarity between the empirical and model data. But, as a reader, I often found myself doing the mental manipulation myself anyway to better evaluate how the model compared to the empirical data. Please consider using comparable y-axis ranges across empirical and simulated data wherever possible.</p>
</disp-quote>
<p>We appreciate this point. As in many replay modeling studies, our primary goal is to provide a qualitative fit that demonstrates the general direction of differences between our model and empirical data, without engaging in detailed parameter fitting for a precise quantitative fit. Still, we agree that where possible, it is useful to better match the axes. We have updated figures 2B and 2C so that the y-axis scales are more directly comparable between the empirical and simulated data.</p>
<disp-quote content-type="editor-comment">
<p>In a similar vein to the above point, while the DVs in the simulations/empirical data made intuitive sense, I wasn't always sure precisely how they were calculated. Consider the &quot;proportion of replay&quot; in Figure 1A. In the Methods (perhaps under Task Simulations), it should specify exactly how this proportion was calculated (e.g., proportions of all replay events, both forwards and backwards, combining across all simulations from Pre- and Post-run rest periods). In many of the examples, the proportions seem to possibly sum to 1 (e.g., Figure 1A), but in other cases, this doesn't seem to be true (e.g., Figure 3A). More clarity here is critical to help readers evaluate these data. Furthermore, sometimes the labels themselves are not the most informative. For example, in Figure 1A, the y-axis is &quot;Proportion of replay&quot; and in 1C it is the &quot;Proportion of events&quot;. I presumed those were the same thing - the proportion of replay events - but it would be best if the axis labels were consistent across figures in this manuscript when they reflect the same DV.</p>
</disp-quote>
<p>We appreciate these useful suggestions. We have revised the Methods section to explain in detail how DVs are calculated for each simulation. The revisions clarify the differences between related measures, such as those shown in Figures 1A and 1C, so that readers can more easily see how the DVs are defined and interpreted in each case.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #4/Reviewing Editor (Public Review):</bold></p>
<p>Summary:</p>
<p>With their 'CMR-replay' model, Zhou et al. demonstrate that the use of spontaneous neural cascades in a context-maintenance and retrieval (CMR) model significantly expands the range of captured memory phenomena.</p>
<p>Strengths:</p>
<p>The proposed model compellingly outperforms its CMR predecessor and, thus, makes important strides towards understanding the empirical memory literature, as well as highlighting a cognitive function of replay.</p>
<p>Weaknesses:</p>
<p>Competing accounts of replay are acknowledged but there are no formal comparisons and only CMR-replay predictions are visualized. Indeed, other than the CMR model, only one alternative account is given serious consideration: A variant of the 'Dyna-replay' architecture, originally developed in the machine learning literature (Sutton, 1990; Moore &amp; Atkeson, 1993) and modified by Mattar et al (2018) such that previously experienced event-sequences get replayed based on their relevance to future gain. Mattar et al acknowledged that a realistic Dyna-replay mechanism would require a learned representation of transitions between perceptual and motor events, i.e., a 'cognitive map'. While Zhou et al. note that the CMR-replay model might provide such a complementary mechanism, they emphasize that their account captures replay characteristics that Dyna-replay does not (though it is unclear to what extent the reverse is also true).</p>
</disp-quote>
<p>We thank the reviewer for these thoughtful comments and appreciate the opportunity to clarify our approach. Our goal in this work is to contrast two dominant perspectives in replay research: replay as a mechanism for learning reward predictions and replay as a process for memory consolidation. These models were chosen as representatives of their classes of models because they use simple and interpretable mechanisms that can simulate a wide range of replay phenomena, making them ideal for contrasting these two perspectives.</p>
<p>Although we implemented CMR-replay as a straightforward example of the memory-focused view, we believe the proposed mechanisms could be extended to other architectures, such as recurrent neural networks, to produce similar results. We now discuss this possibility in the revised manuscript (see below). However, given our primary goal of providing a broad and qualitative contrast of these two broad perspectives, we decided not to undertake simulations with additional individual models for this paper.</p>
<p>Regarding the Mattar &amp; Daw model, it is true that a mechanistic implementation would require a mechanism that avoids precomputing priorities before replay. However, the &quot;need&quot; component of their model already incorporates learned expectations of transitions between actions and events. Thus, the model's limitations are not due to the absence of a cognitive map.</p>
<p>In contrast, while CMR-replay also accumulates memory associations that reflect experienced transitions among events, it generates several qualitatively distinct predictions compared to the Mattar &amp; Daw model. As we note in the manuscript, these distinctions make CMR-replay a contrasting rather than complementary perspective.</p>
<disp-quote content-type="editor-comment">
<p>Another important consideration, however, is how CMR replay compares to alternative mechanistic accounts of cognitive maps. For example, Recurrent Neural Networks are adept at detecting spatial and temporal dependencies in sequential input; these networks are being increasingly used to capture psychological and neuroscientific data (e.g., Zhang et al, 2020; Spoerer et al, 2020), including hippocampal replay specifically (Haga &amp; Fukai, 2018). Another relevant framework is provided by Associative Learning Theory, in which bidirectional associations between static and transient stimulus elements are commonly used to explain contextual and cue-based phenomena, including associative retrieval of absent events (McLaren et al, 1989; Harris, 2006; Kokkola et al, 2019). Without proper integration with these modeling approaches, it is difficult to gauge the innovation and significance of CMR-replay, particularly since the model is applied post hoc to the relatively narrow domain of rodent maze navigation.</p>
</disp-quote>
<p>First, we would like to clarify our principal aim in this work is to characterize the nature of replay, rather than to model cognitive maps per se. Accordingly, CMR‑replay is not designed to simulate head‐direction signals, perform path integration, or explain the spatial firing properties of neurons during navigation. Instead, it focuses squarely on sequential replay phenomena, simulating classic rodent maze reactivation studies and human sequence‐learning tasks. These simulations span a broad array of replay experimental paradigms to ensure extensive coverage of the replay findings reported across the literature. As such, the contribution of this work is in explaining the mechanisms and functional roles of replay, and demonstrating that a model that employs simple and interpretable memory mechanisms not only explains replay phenomena traditionally interpreted through a value-based lens but also accounts for findings not addressed by other memory-focused models.</p>
<p>As the reviewer notes, CMR-replay shares features with other memory-focused models. However, to our knowledge, none of these related approaches have yet captured the full suite of empirical replay phenomena, suggesting the combination of mechanisms employed in CMR-replay is essential for explaining these phenomena. In the Discussion section, we now discuss the similarities between CMR-replay and related memory models and the possibility of integrating these approaches:</p>
<p>“Our theory builds on a lineage of memory-focused models, demonstrating the power of this perspective in explaining phenomena that have often been attributed to the optimization of value-based predictions. In this work, we focus on CMR-replay, which exemplifies the memory-centric approach through a set of simple and interpretable mechanisms that we believe are broadly applicable across memory domains. Elements of CMR-replay share similarities with other models that adopt a memory-focused perspective. The model learns distributed context representations whose overlaps encodes associations among items, echoing associative learning theories in which overlapping patterns capture stimulus similarity and learned associations (McLaren &amp; Mackintosh 2002). Context evolves through bidirectional interactions between items and their contextual representations, mirroring the dynamics found in recurrent neural networks (Haga &amp; Futai 2018; Levenstein et al., 2024). However, these related approaches have not been shown to account for the present set of replay findings and lack mechanisms—such as reward-modulated encoding and experience-dependent suppression—that our simulations suggest are essential for capturing these phenomena. While not explored here, we believe these mechanisms could be integrated into architectures like recurrent neural networks (Levenstein et al., 2024) to support a broader range of replay dynamics.”</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations For The Authors</bold></p>
<p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p>
<p>(1) Lines 94-96: These lines may be better positioned earlier in the paragraph.</p>
</disp-quote>
<p>We now introduce these lines earlier in the paragraph.</p>
<disp-quote content-type="editor-comment">
<p>(2) Line 103 - It's unclear to me what is meant by the statement that &quot;the current context contains contexts associated with previous items&quot;. I understand why a slowly drifting context will coincide and therefore link with multiple items that progress rapidly in time, so multiple items will be linked to the same context and each item will be linked to multiple contexts. Is that the idea conveyed here or am I missing something? I'm similarly confused by line 129, which mentions that a context is updated by incorporating other items' contexts. How could a context contain other contexts?</p>
</disp-quote>
<p>In the model, each item has an associated context that can be retrieved via Mfc. This is true even before learning, since Mfc is initialized as an identity matrix. During learning and replay, we have a drifting context c that is updated each time an item is presented. At each timestep, the model first retrieves the current item’s associated context cf by Mfc, and incorporates it into c. Equation #2 in the Methods section illustrates this procedure in detail. Because of this procedure, the drifting context c is a weighted sum of past items’ associated contexts.</p>
<p>We recognize that these descriptions can be confusing. We have updated the Results section to better distinguish the drifting context from items’ associated context. For example, we note that:</p>
<p>“We represent the drifting context during learning and replay with c and an item's associated context with cf.”</p>
<p>We have also updated our description of the context drift procedure to distinguish these two quantities:</p>
<p>“During awake encoding of a sequence of items, for each item f, the model retrieves its associated context cf via Mfc. The drifting context c incorporates the item's associated context cf and downweights its representation of previous items' associated contexts (Figure 1c). Thus, the context layer maintains a recency weighted sum of past and present items' associated contexts.”</p>
<disp-quote content-type="editor-comment">
<p>(3) Figure 1b and 1d - please clarify which axis in the association matrices represents the item and the context.</p>
</disp-quote>
<p>We have added labels to show what the axes represent in Figure 1.</p>
<disp-quote content-type="editor-comment">
<p>(4) The terms &quot;experience&quot; and &quot;item&quot; are used interchangeably and it may be best to stick to one term.</p>
</disp-quote>
<p>We now use the term “item” wherever we describe the model results.</p>
<disp-quote content-type="editor-comment">
<p>(5) The manuscript describes Figure 6 ahead of earlier figures - the authors may want to reorder their figures to improve readability.</p>
</disp-quote>
<p>We appreciate this suggestion. We decided to keep the current figure organization since it allows us to group results into different themes and avoid redundancy.</p>
<disp-quote content-type="editor-comment">
<p>(6) Lines 662-664 are repeated with a different ending, this is likely an error.</p>
</disp-quote>
<p>We have fixed this error.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p>
<p>Below, I have outlined some additional points that came to mind in reviewing the manuscript - in no particular order.</p>
<p>(1) Figure 1: I found the ordering of panels a bit confusing in this figure, as the reading direction changes a couple of times in going from A to F. Would perhaps putting panel C in the bottom left corner and then D at the top right, with E and F below (also on the right) work?</p>
</disp-quote>
<p>We agree that this improves the figure. We have restructured the ordering of panels in this figure.</p>
<disp-quote content-type="editor-comment">
<p>(2) Simulation 1: When reading the intro/results for the first simulation (Figure 2a; Diba &amp; Buszaki, 2007; &quot;When animals traverse a linear track...&quot;, page 6, line 186). It wasn't clear to me why pre-run rest would have any forward replay, particularly if pre-run implied that the animal had no experience with the track yet. But in the Methods this becomes clearer, as the model encodes the track eight times prior to the rest periods. Making this explicit in the text would make it easier to follow. Also, was there any reason why specifically eight sessions of awake learning, in particular, were used?</p>
</disp-quote>
<p>We now make more explicit that the animals have experience with the track before pre-run rest recording:</p>
<p>“Animals first acquire experience with a linear track by traversing it to collect a reward. Then, during the pre-run rest recording, forward replay predominates.”</p>
<p>We included eight sessions of awake learning to match with the number of sessions in Shin et al. (2017), since this simulation attempts to explain data from that study. After each repetition, the model engages in rest. We have revised the Methods section to indicate the motivation for this choice:</p>
<p>“In the simulation that examines context-dependent forward and backward replay through experience (Figs. 2a and 5a), CMR-replay encodes an input sequence shown in Fig. 7a, which simulates a linear track run with no ambiguity in the direction of inputs, over eight awake learning sessions (as in Shin et al. 2019)”</p>
<disp-quote content-type="editor-comment">
<p>(3) Frequency of remote replay events: In the simulation based on Gupta et al, how frequently overall does remote replay occur? In the main text, the authors mention the mean frequency with which shortcut replay occurs (i.e., the mean proportion of replay events that contain a shortcut sequence = 0.0046), which was helpful. But, it also made me wonder about the likelihood of remote replay events. I would imagine that remote replay events are infrequent as well - given that it is considerably more likely to replay sequences from the local track, given the recency-weighted mental context. Reporting the above mean proportion for remote and local replay events would be helpful context for the reader.</p>
</disp-quote>
<p>In Figure 4c, we report the proportion of remote replay in the two experimental conditions of Gupta et al. that we simulate.</p>
<disp-quote content-type="editor-comment">
<p>(4) Point of clarification re: backwards replay: Is backwards replay less likely to occur than forward replay overall because of the forward asymmetry associated with these models? For example, for a backwards replay event to occur, the context would need to drift backwards at least five times in a row, in spite of a higher probability of moving one step forward at each of those steps. Am I getting that right?</p>
</disp-quote>
<p>The reviewer’s interpretation is correct: CMR-replay is more likely to produce forward than backward replay in sleep because of its forward asymmetry. We note that this forward asymmetry leads to high likelihood of forward replay in the section titled “The context-dependency of memory replay”:</p>
<p>“As with prior retrieved context models (Howard &amp; Kahana 2002; Polyn et al., 2009), CMR-replay encodes stronger forward than backward associations. This asymmetry exists because, during the first encoding of a sequence, an item's associated context contributes only to its ensuing items' encoding contexts. Therefore, after encoding, bringing back an item's associated context is more likely to reactivate its ensuing than preceding items, leading to forward asymmetric replay (Fig. 6d left).”</p>
<disp-quote content-type="editor-comment">
<p>(5) On terminating a replay period: &quot;At any t, the replay period ends with a probability of 0.1 or if a task-irrelevant item is reactivated.&quot; (Figure 1 caption; see also pg 18, line 635). How was the 0.1 decided upon? Also, could you please add some detail as to what a 'task-irrelevant item' would be? From what I understood, the model only learns sequences that represent the points in a track - wouldn't all the points in the track be task-relevant?</p>
</disp-quote>
<p>This value was arbitrarily chosen as a small value that allows probabilistic stopping. It was not motivated by prior modeling or a systematic search. We have added: “At each timestep, the replay period ends either with a stop probability of 0.1 or if a task-irrelevant item becomes reactivated. (The choice of the value 0.1 was arbitrary; future work could explore the implications of varying this parameter).”</p>
<p>In addition, we now explain in the paper that task irrelevant items “do not appear as inputs during awake encoding, but compete with task-relevant items for reactivation during replay, simulating the idea that other experiences likely compete with current experiences during periods of retrieval and reactivation.”</p>
<disp-quote content-type="editor-comment">
<p>(6) Minor typos:</p>
<p>Turn all instances of &quot;nonlocal&quot; into &quot;non-local&quot;, or vice versa</p>
<p>&quot;For rest at the end of a run, cexternal is the context associated with the final item in the sequence. For rest at the end of a run, cexternal is the context associated with the start item.&quot; (pg 20, line 663) - I believe this is a typo and that the second sentence should begin with &quot;For rest at the START of a run&quot;.</p>
</disp-quote>
<p>We have updated the manuscript to correct these typos.</p>
<disp-quote content-type="editor-comment">
<p>(7) Code availability: I may have missed it, but it doesn't seem like the code is currently available for these simulations. Including the commented code in a public repository (Github, OSF) would be very useful in this case.</p>
</disp-quote>
<p>We now include a Github link to our simulation code: <ext-link ext-link-type="uri" xlink:href="https://github.com/schapirolab/CMR-replay">https://github.com/schapirolab/CMR-replay</ext-link>.</p>
</body>
</sub-article>
</article>