<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">106365</article-id>
<article-id pub-id-type="doi">10.7554/eLife.106365</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.106365.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Forecasting protein evolution by integrating birth-death population models with structurally constrained substitution models</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ferreiro</surname>
<given-names>David</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>González-Vázquez</surname>
<given-names>Luis Daniel</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Prado-Comesaña</surname>
<given-names>Ana</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0516-2717</contrib-id>
<name>
<surname>Arenas</surname>
<given-names>Miguel</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<email>marenas@uvigo.es</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05rdf8595</institution-id><institution>CINBIO, Universidade de Vigo</institution></institution-wrap>, <city>Vigo</city>, <country country="ES">Spain</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05rdf8595</institution-id><institution>Department of Biochemistry, Genetics and Immunology, Universidade de Vigo</institution></institution-wrap>, <city>Vigo</city>, <country country="ES">Spain</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Bitbol</surname>
<given-names>Anne-Florence</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution>
</institution-wrap>
<city>Lausanne</city>
<country>Switzerland</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Walczak</surname>
<given-names>Aleksandra M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>CNRS</institution>
</institution-wrap>
<city>Paris</city>
<country>France</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-05-22">
<day>22</day>
<month>05</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP106365</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2025-02-21">
<day>21</day>
<month>02</month>
<year>2025</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2025-04-02">
<day>02</day>
<month>04</month>
<year>2025</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2025.02.21.639428"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Ferreiro et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Ferreiro et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-106365-v1.pdf"/>
<abstract>
<title>Abstract</title><p>Evolutionary studies in population genetics and ecology were mainly focused on predicting and understanding past evolutionary events. Recently, however, a growing trend explores the prediction of evolutionary trajectories toward the future promoted by its wide variety of applications. In this context, we introduce a forecasting protein evolution method that integrates birth-death population models with substitution models that consider selection on protein folding stability. In contrast to traditional population genetics methods that usually make the unrealistic assumption of simulating molecular evolution separately from the evolutionary history, the present method combines both processes to simultaneously model forward-in-time birth-death evolutionary trajectories and protein evolution under structurally constrained substitution models that outperformed traditional empirical substitution models. We implemented the method into a freely available computer framework. We evaluated the accuracy of the predictions with several monitored viral proteins of broad interest. Overall, the method showed acceptable errors in predicting the folding stability of the forecasted protein variants but, expectedly, the errors grew up in the prediction of the corresponding sequences. We conclude that forecasting protein evolution is feasible in certain evolutionary scenarios and provide suggestions to enhance its accuracy by improving the underlying models of evolution.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>Molecular evolution</kwd>
<kwd>Forecasting evolution</kwd>
<kwd>Birth-death process</kwd>
<kwd>Substitution model</kwd>
<kwd>Protein folding stability</kwd>
<kwd>Phylogenetics</kwd>
<kwd>Molecular adaptation</kwd>
</kwd-group>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Update of the Acknowledgments section. We updated information in the Acknowledgments section that was required.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Molecular evolution is traditionally investigated through inferences about past evolutionary events, such as phylogenetic tree and ancestral sequence reconstructions, and predictions about the future were considered as inaccessible for a long time because they can be affected by complex processes such as environmental change. Nevertheless, a variety of biological systems display a Darwinian evolutionary process where selection operates toward a limited set of adapted variants. These variants, and in extension the evolutionary trajectories to reach them, would be positively selected and could present a certain degree of predictability (<xref ref-type="bibr" rid="c60">Lässig <italic>et al</italic>, 2017</xref>; <xref ref-type="bibr" rid="c101">Wortel <italic>et al</italic>, 2023</xref>). The progress made in developing more accurate models of evolution (<xref ref-type="bibr" rid="c5">Arenas, 2015b</xref>) and the benefits from predicting the outcome of evolution (i.e., to understand the course of evolution or to prepare for the future (<xref ref-type="bibr" rid="c101">Wortel <italic>et al</italic>., 2023</xref>)) motivated a variety of investigations on forecasting evolution in diverse fields including medicine, agriculture, biotechnology, and conservation biology, among others (e.g., <xref ref-type="bibr" rid="c12">Barton <italic>et al</italic>, 2016</xref>; <xref ref-type="bibr" rid="c19">Bull &amp; Molineux, 2008</xref>; <xref ref-type="bibr" rid="c24">de Visser <italic>et al</italic>, 2018</xref>; <xref ref-type="bibr" rid="c30">Diaz-Uriarte &amp; Vasallo, 2019</xref>; <xref ref-type="bibr" rid="c38">Fischer <italic>et al</italic>, 2015</xref>; <xref ref-type="bibr" rid="c42">Gerrish &amp; Sniegowski, 2012</xref>; <xref ref-type="bibr" rid="c59">Lassig &amp; Luksza, 2014</xref>; <xref ref-type="bibr" rid="c65">Lind <italic>et al</italic>, 2019</xref>; <xref ref-type="bibr" rid="c66">Luksza &amp; Lassig, 2014</xref>; <xref ref-type="bibr" rid="c72">Morris <italic>et al</italic>, 2018</xref>; <xref ref-type="bibr" rid="c73">Munck <italic>et al</italic>, 2014</xref>; <xref ref-type="bibr" rid="c76">Neher <italic>et al</italic>, 2014</xref>; <xref ref-type="bibr" rid="c101">Wortel <italic>et al</italic>., 2023</xref>).</p>
<p>Unfortunately, forecasting evolution not always is achievable. Under neutral evolution, all the molecular variants are equally likely to be present in the population, showing lack of repeatability and disallowing accurate prediction of future variants. Thus, forecasting evolution requires a system with measurable selection pressures, and where certain positively selected variants could produce more descendants than other variants and expand in the population (<xref ref-type="bibr" rid="c29">Desai &amp; Fisher, 2007</xref>; <xref ref-type="bibr" rid="c47">Goyal <italic>et al</italic>, 2012</xref>; <xref ref-type="bibr" rid="c75">Neher &amp; Hallatschek, 2013</xref>; <xref ref-type="bibr" rid="c76">Neher <italic>et al</italic>., 2014</xref>). Actually, a rougher fitness landscape resulting from selection can lead to greater accuracy in evolutionary predictions (<xref ref-type="bibr" rid="c78">Papkou <italic>et al</italic>, 2023</xref>; <xref ref-type="bibr" rid="c86">Rubin <italic>et al</italic>, 2023</xref>; <xref ref-type="bibr" rid="c98">Van Cleve &amp; Weissman, 2015</xref>). Overall, an evolutionary process could be predictable to some extent (prediction errors are inevitable with any method and in any evolutionary scenario) depending on the strength of selection driving evolution and the heterogeneity in fitness among different variants.</p>
<p>Here, we focus on forecasting protein evolution because it involves molecular evolutionary processes driven by selection pressures and where the fitness of each variant can be parameterized and predicted (<xref ref-type="bibr" rid="c20">Carneiro &amp; Hartl, 2010</xref>; <xref ref-type="bibr" rid="c43">Gilson <italic>et al</italic>, 2017</xref>). Traditionally, evolutionary histories and ancestral sequences of proteins are inferred using probabilistic methods based on advanced substitution models of protein evolution (e.g., <xref ref-type="bibr" rid="c5">Arenas, 2015b</xref>; <xref ref-type="bibr" rid="c6">Arenas &amp; Bastolla, 2020</xref>; <xref ref-type="bibr" rid="c36">Ferreiro <italic>et al</italic>, 2022</xref>; <xref ref-type="bibr" rid="c67">Malcom <italic>et al</italic>, 1990</xref>; <xref ref-type="bibr" rid="c71">Moreira <italic>et al</italic>, 2023</xref>; <xref ref-type="bibr" rid="c92">Stackhouse <italic>et al</italic>, 1990</xref>; <xref ref-type="bibr" rid="c96">Thornton <italic>et al</italic>, 2003</xref>; <xref ref-type="bibr" rid="c97">Ugalde <italic>et al</italic>, 2004</xref>). The accuracy of these inferences is affected by the accuracy of the applied substitution model, where substitution models that better fit with the study data usually produce more accurate phylogenetic trees and ancestral sequences (<xref ref-type="bibr" rid="c6">Arenas &amp; Bastolla, 2020</xref>; <xref ref-type="bibr" rid="c25">Del Amparo &amp; Arenas, 2022a</xref>, 2023; <xref ref-type="bibr" rid="c63">Lemmon &amp; Moriarty, 2004</xref>). These findings suggest that accurate substitution models of evolution are also convenient for forecasting protein evolution. In this regard, a variety of studies showed that structurally constrained substitution (SCS) models of protein evolution provide more accurate evolutionary inferences than the traditional empirical substitution models of protein evolution, in terms of phylogenetic likelihood, distribution of amino acid frequencies among protein sites, rates of molecular evolution and folding stability of reconstructed proteins, among other aspects (e.g., <xref ref-type="bibr" rid="c6">Arenas &amp; Bastolla, 2020</xref>; <xref ref-type="bibr" rid="c10">Arenas <italic>et al</italic>, 2015</xref>; <xref ref-type="bibr" rid="c14">Bastolla <italic>et al</italic>, 2006</xref>; <xref ref-type="bibr" rid="c18">Bordner &amp; Mittelmann, 2013</xref>; <xref ref-type="bibr" rid="c28">Del Amparo <italic>et al</italic>, 2023</xref>; <xref ref-type="bibr" rid="c34">Echave &amp; Wilke, 2017</xref>; <xref ref-type="bibr" rid="c35">Ferreiro <italic>et al</italic>, 2024a</xref>; <xref ref-type="bibr" rid="c37">Ferreiro <italic>et al</italic>, 2024b</xref>; <xref ref-type="bibr" rid="c40">Fornasari <italic>et al</italic>, 2002</xref>; <xref ref-type="bibr" rid="c79">Parisi &amp; Echave, 2001</xref>; <xref ref-type="bibr" rid="c82">Pascual-Garcia <italic>et al</italic>, 2019</xref>; <xref ref-type="bibr" rid="c84">Rodrigue <italic>et al</italic>, 2005</xref>), although SCS models usually demand more computational resources than substitution models that only include information from the protein sequence. Notice that the protein structure provides information about the location and molecular interactions of amino acids at different protein sites, which could be far from each other in the sequence but close in the three-dimensional structure and interact affecting their evolution (<xref ref-type="bibr" rid="c70">Morcos <italic>et al</italic>, 2011</xref>; <xref ref-type="bibr" rid="c87">Ruiz-Gonzalez &amp; Fares, 2013</xref>). Indeed, selection from the protein folding stability is relevant in the evolution of multiple proteins, including those in microbial and viral systems (e.g., <xref ref-type="bibr" rid="c36">Ferreiro <italic>et al</italic>., 2022</xref>; <xref ref-type="bibr" rid="c46">Gong <italic>et al</italic>, 2013</xref>; <xref ref-type="bibr" rid="c55">Jacquier <italic>et al</italic>, 2013</xref>; <xref ref-type="bibr" rid="c85">Rodrigues <italic>et al</italic>, 2016</xref>; <xref ref-type="bibr" rid="c103">Wylie &amp; Shakhnovich, 2011</xref>; <xref ref-type="bibr" rid="c108">Zeldovich <italic>et al</italic>, 2007</xref>). Therefore, we believe that it should be taken into account for forecasting protein evolution in such systems.</p>
<p>Predictions about future evolutionary events can be performed with simulation-based methods (e.g., <xref ref-type="bibr" rid="c32">Eccleston <italic>et al</italic>, 2023</xref>; <xref ref-type="bibr" rid="c76">Neher <italic>et al</italic>., 2014</xref>; <xref ref-type="bibr" rid="c107">Yoshida <italic>et al</italic>, 2023</xref>). In order to simulate molecular evolution, traditional population genetics methods apply two separate steps (<xref ref-type="bibr" rid="c3">Arenas, 2012</xref>; <xref ref-type="bibr" rid="c50">Hoban <italic>et al</italic>, 2012</xref>). First, the simulation of the evolutionary history (i.e., a phylogenetic tree) using approaches such as the coalescent and birth-death population processes (<xref ref-type="bibr" rid="c41">Gernhard, 2008</xref>; <xref ref-type="bibr" rid="c52">Hudson, 1990</xref>; <xref ref-type="bibr" rid="c57">Kingman, 1982</xref>; <xref ref-type="bibr" rid="c93">Stadler, 2010</xref>). Afterward, the forward-in-time simulation of molecular evolution is performed, from the root node to the tip nodes, upon the previously simulated evolutionary history (<xref ref-type="bibr" rid="c105">Yang, 2006</xref>). This methodology was implemented into a variety of population genetics frameworks that simulate molecular evolution (<xref ref-type="bibr" rid="c3">Arenas, 2012</xref>; <xref ref-type="bibr" rid="c50">Hoban <italic>et al</italic>., 2012</xref>). However, for technical and computational simplicity, it assumes that the simulation of the evolutionary history is independent from the simulation of molecular evolution, which can produce biological incoherences (i.e., the evolutionary history is usually simulated under neutral evolution while molecular evolution is usually simulated with substitution models that consider selection). To enhance the realism of this modeling, here we merged both processes into a single one where evolutionary history influences molecular evolution and <italic>vice versa</italic>. In particular, we adopted a birth-death population genetics method to simulate the forward-in-time evolutionary history (already used for forecasting evolution (<xref ref-type="bibr" rid="c59">Lassig &amp; Luksza, 2014</xref>; <xref ref-type="bibr" rid="c76">Neher <italic>et al</italic>., 2014</xref>)), taking into account the fitness of the molecular variant (through evolutionary constraints from the protein folding stability (<xref ref-type="bibr" rid="c13">Bastolla &amp; Demetrius, 2005</xref>; <xref ref-type="bibr" rid="c46">Gong <italic>et al</italic>., 2013</xref>; <xref ref-type="bibr" rid="c64">Liberles <italic>et al</italic>, 2012</xref>; <xref ref-type="bibr" rid="c108">Zeldovich <italic>et al</italic>., 2007</xref>)) at the corresponding node, to determine its subsequent birth or death event, and we integrated this process with SCS models to model protein evolution along the derived phylogenetic branches. The method is detailed below, and we implemented it into a new version of our computer framework <italic>ProteinEvolver</italic> (<xref ref-type="bibr" rid="c7">Arenas <italic>et al</italic>, 2013</xref>), which is freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/MiguelArenas/proteinevolver">https://github.com/MiguelArenas/proteinevolver</ext-link>. <italic>ProteinEvolver2</italic> includes detailed documentation and a variety of ready-to-use examples. Next, considering the potential applications of forecasting evolution to design vaccines and therapies against pathogens, we evaluated and applied the method to forecasting protein evolution in several real protein data of viruses monitored over time.</p>
</sec>
<sec id="s2">
<title>Materials and methods</title>
<sec id="s2a">
<title>A method for forecasting protein evolution by combining birth-death population genetics with structurally constrained substitution models of protein evolution</title>
<p>Following previous methods for forecasting evolution based on simulations (<xref ref-type="bibr" rid="c59">Lassig &amp; Luksza, 2014</xref>; <xref ref-type="bibr" rid="c76">Neher <italic>et al</italic>., 2014</xref>), we developed a method to simulate the forward-in-time evolutionary history of a protein sample with a birth-death process that considers the fitness of the protein variant (based on folding stability) at every temporal node. The method derives the birth and death rates for a protein variant based on the fitness of that variant, where a high fitness results in a high birth rate and a low death rate, which can lead to a large number of descendants, and the opposite leading to a few or none (extinction) descendants. Thus, the fitness of the molecular variant at every node drives its corresponding forward in time birth-death evolutionary history. The details of this simulation process are outlined below.</p>
<p>First, similarly to common simulators of molecular evolution (<xref ref-type="bibr" rid="c3">Arenas, 2012</xref>; <xref ref-type="bibr" rid="c50">Hoban <italic>et al</italic>., 2012</xref>; <xref ref-type="bibr" rid="c105">Yang, 2006</xref>), a given protein sequence and structure (hereafter, protein variant) is assigned to the root node. The fitness (<italic>f</italic>) of the protein variant (<italic>A</italic>) is calculated from its folding stability (free energy, <italic>ΔG</italic>) following the Boltzmann distribution (<xref ref-type="bibr" rid="c45">Goldstein, 2013</xref>) (I, which takes values from 0 to 1),
<disp-formula id="eqn1">
<graphic xlink:href="639428v2_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The user can alternatively choose whether the fitness of the protein variant is based only on its folding stability or whether it is based on similarity with the stability of a real protein variant (i.e., a protein structure from the Protein Data Bank, PDB). We believe that the latter can be convenient since, in nature, a high folding stability does not necessarily indicate a high fitness but a stability close to real stability may suggest a proper fitness because the real stability is the result of a selection process. If the fitness is derived from only the folding stability of the protein variant, the birth rate (<italic>b</italic>) is considered equal to the fitness. Alternatively, if the fitness is determined based on the similarity in folding stability between the modeled variant and a real variant, the birth rate is assumed to be 1 minus the root mean square deviation (RMSD) in folding stability. Notice that the smaller this difference, the higher the birth rate. In both cases, the death rate (<italic>d</italic>) is considered as <italic>1-b</italic> to allow a constant global (birth-death) rate. The birth-death process is simulated forward in time deciding whether every next event is a birth or a death event (<xref ref-type="bibr" rid="c49">Harmon, 2019</xref>; <xref ref-type="bibr" rid="c93">Stadler, 2010</xref>; <xref ref-type="bibr" rid="c94">Stadler, 2011</xref>) according to the fitness of the corresponding molecular variant, and it ends when a user-specified criterion, such as a particular sample size (considering or ignoring extinction nodes) or a certain evolutionary time (<italic>t<sub>e</sub></italic>), is reached. Starting from an “active” node (i.e., the root node) at current time <italic>t<sub>c</sub></italic>, the time to the next event (birth to produce two descendants or death to produce the extinction of the node) can be calculated (details below). In contrast to standard birth-death processes where birth and death rates are constant over time and among lineages, the present method considers heterogeneity where each protein variant at a node has specific birth and death rates according to its corresponding fitness. The method is described below and summarized in <xref rid="fig1" ref-type="fig">Figure 1</xref>.
<list list-type="order">
<list-item><p>The process starts at the root node, assigning a user-specified protein sequence and corresponding protein structure (i.e., obtained from the PDB) to that node. In general, for every protein variant assigned to an active node, the corresponding birth and death rates are calculated following the indications presented above.</p></list-item>
<list-item><p>Calculation of the time to the next birth or death event. Following common birth-death methods, the time to the next event <italic>t<sub>n</sub></italic> is calculated through an exponential distribution with rate based on the number of active nodes (<italic>s</italic>) and the sum of the birth and death rates (<xref ref-type="bibr" rid="c49">Harmon, 2019</xref>) (II),</p></list-item>
</list>
</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Illustrative example of forward in time simulation of protein evolution integrating a birth-death population evolutionary process with fitness from the protein folding stability and the modeling of protein evolution with a structurally constrained substitution model.</title><p>Given a protein variant assigned to a node at time <italic>t</italic> (blue node), its fitness is calculated considering its protein folding stability. Then, the fitness is used to determine the birth and death rates for that variant, which provide the time to the next birth or death event (horizontal dashed line) that corresponds to the forward-in-time branch length. Next, the variant is evolved forward in time toward each descendant, upon the previously determined branch length, under a SCS model of protein evolution. The process is repeated, forward in time, starting at each new variant. If a death event occurs, the variant of the extinct node (pink node) is obtained but it does have descendants. The process finishes when a particular sample size or simulation time is reached (i.e., <italic>t+n</italic>).</p></caption>
<graphic xlink:href="639428v2_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<disp-formula id="eqn2">
<graphic xlink:href="639428v2_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<p>As a consequence, since <italic>b+d=1</italic> at each node, <italic>t<sub>n</sub></italic> is consistent across all nodes, according to (<xref ref-type="bibr" rid="c49">Harmon, 2019</xref>).
<list list-type="order">
<list-item><p>Evaluate whether the simulation concludes before the next event occurs <italic>(t<sub>c</sub> + t<sub>n</sub>)</italic>.</p></list-item>
<list-item><p>If it does conclude (i.e., <italic>t<sub>c</sub> + t<sub>n</sub></italic> higher than <italic>t<sub>e</sub></italic>), the simulation of the evolutionary history finishes.</p></list-item>
<list-item><p>If it does not conclude, a random active node is selected, and its protein variant is analyzed to determine its type of next event (birth or death). The probability of a birth event is <italic>P<sub>b</sub> = b/(b + d)</italic> and the probability of a death event is <italic>P<sub>d</sub> = d/(b + d)</italic>. A random sample from those probabilities is taken to determine the type of evolutionary event.</p></list-item>
<list-item><p>If a birth event is selected. Two descendant active nodes from the study node are incorporated with branch lengths <italic>t<sub>n</sub></italic>, and the study node is then considered inactive. Next, molecular evolution is simulated from the original node to each descendant node based on the specified SCS model of protein evolution (<xref ref-type="bibr" rid="c7">Arenas <italic>et al</italic>., 2013</xref>). Thus, the process results in a protein variant for every descendant node. Finally, the folding stability and subsequent fitness of these descendant protein variants are calculated.</p></list-item>
<list-item><p>If a death event is selected. Then, the study node is considered inactive.</p></list-item>
<list-item><p>Return to step 1 while the user-specified criterion for ending the birth-death process is not satisfied and at least one active node exists in the evolutionary history. Otherwise, the simulation ends.</p></list-item>
</list>
This process simultaneously simulates, forward in time, evolutionary history and protein evolution, with protein evolution influencing the evolutionary history through selection from the folding stability. Indeed, selection can vary among protein variants at their corresponding nodes of the evolutionary history. The process produces a forward in time birth-death phylogenetic history, that encompasses nodes that reached the ending time, internal nodes and nodes that were extinct at some time, along with the protein variant associated with each node.</p>
<p>The method includes several optional capabilities listed in Table S1 (Supplementary Material) and in the software documentation, with some summarized below.
<list list-type="bullet">
<list-item><p>The user can fix the birth and death rates along the evolutionary history or specify that they are based on the fitness of the corresponding protein variant as described before. For the latter, the fitness can be based on the folding stability of the analyzed protein variant or on the similarity in folding stability between the analyzed and real protein variants.</p></list-item>
<list-item><p>The birth-death simulation can finish any of the following criteria are met: (a) A specified sample size, including extinction nodes derived from death events. (b) A specified sample size, excluding extinction nodes. (c) A specified evolutionary time, measured from the root to a tip node.</p></list-item>
<list-item><p>Extinction nodes can either be preserved or removed from the evolutionary history.</p></list-item>
<list-item><p>Evaluation of the simulated birth-death evolutionary history in terms of tree balance using the Colless index (<xref ref-type="bibr" rid="c21">Colless, 1982</xref>; <xref ref-type="bibr" rid="c62">Lemant <italic>et al</italic>, 2022</xref>).</p></list-item>
<list-item><p>Possible variation of the site-specific substitution rate according to user specifications.</p></list-item>
<list-item><p>Customizable substitution model featuring site-specific exchangeability matrices (relative rates of change among amino acids and their frequencies at the equilibrium).</p></list-item>
<list-item><p>Implementation of several SCS models and a variety of empirical substitution models of protein evolution. The implemented SCS models were evaluated in our previous work (<xref ref-type="bibr" rid="c7">Arenas <italic>et al</italic>., 2013</xref>) and, the implemented empirical substitution models were properly identified using simulated data with <italic>ProtTest3</italic> (<xref ref-type="bibr" rid="c23">Darriba <italic>et al</italic>, 2011</xref>).</p></list-item>
</list>
The implemented SCS models consider molecular energy functions based on amino acid contact matrices and configurational entropies per residue in unfolded and misfolded proteins (<xref ref-type="bibr" rid="c7">Arenas <italic>et al</italic>., 2013</xref>; <xref ref-type="bibr" rid="c15">Bastolla <italic>et al</italic>, 2007</xref>; <xref ref-type="bibr" rid="c68">Mendez <italic>et al</italic>, 2010</xref>). Technical details about these SCS models are presented in our previous study (<xref ref-type="bibr" rid="c7">Arenas <italic>et al</italic>., 2013</xref>). The method also implements common empirical substitution models of protein evolution (i.e., <italic>Blosum62</italic>, <italic>CpRev</italic>, <italic>Dayhoff</italic>, <italic>DayhoffDCMUT</italic>, <italic>FLU</italic>, <italic>HIVb</italic>, <italic>HIVw</italic>, <italic>JTT</italic>, <italic>JonesDCMUT</italic>, <italic>LG</italic>, <italic>Mtart</italic>, <italic>Mtmam</italic>, <italic>Mtrev24</italic>, <italic>RtRev</italic>, <italic>VT</italic> and <italic>WAG</italic>; Table S1) and the user can specify any particular exchangeability matrix for all sites or for each site, allowing for heterogeneity of the substitution process among sites (details in Table S1 and in the software documentation). In addition, the framework implements heterogeneous substitution rates among sites by the traditional Gamma distribution (+G) (<xref ref-type="bibr" rid="c104">Yang, 1996</xref>) and proportion of invariable sites (+I) (<xref ref-type="bibr" rid="c39">Fitch &amp; Margoliash, 1967</xref>), and also the user can directly alter the substitution rate at each site for any empirical or SCS model (Table S1). Regarding the evolutionary history, in addition to the birth-death process presented before, the user can specify a particular phylogenetic tree or simulate a coalescent evolutionary history (<xref ref-type="bibr" rid="c51">Hudson, 1983</xref>; <xref ref-type="bibr" rid="c57">Kingman, 1982</xref>) (Table S1). In this regard, we maintained the capabilities of the previous version, including the coalescent with recombination (<xref ref-type="bibr" rid="c51">Hudson, 1983</xref>) [which can be homogeneous or heterogeneous along the sequence (according to <xref ref-type="bibr" rid="c100">Wiuf &amp; Posada, 2003</xref>)], variable population size over time (growth rate or demographic periods), several migration models [i.e., island (<xref ref-type="bibr" rid="c53">Hudson, 1998</xref>), stepping-stone (<xref ref-type="bibr" rid="c56">Kimura &amp; Weiss, 1964</xref>) and continent-island (<xref ref-type="bibr" rid="c102">Wright, 1931</xref>)] with temporal variation of migration rates and convergence of demes or subpopulations, simulation of haploid or diploid data, and longitudinal sampling (<xref ref-type="bibr" rid="c74">Navascues <italic>et al</italic>, 2010</xref>) (details in Table S1 and in the software documentation). The framework outputs a simulated multiple sequence alignment with the protein sequences of the internal and tip nodes, as well as their folding stabilities, and the evolutionary history, among other information (Table S1 and software documentation).</p>
</sec>
<sec id="s2b">
<title>Study data for evaluating the method for forecasting protein evolution</title>
<p>We evaluated the accuracy of the method for forecasting protein evolution using viral proteins sampled over time (longitudinal sampling). Specifically, we used protein sequences from previous experiments of virus evolution monitored over time, which contain consensus molecular data (avoiding rare variants) that belong to different evolutionary time points.
<list list-type="bullet">
<list-item><p>The matrix (MA) protein of HIV-1, with data obtained from an <italic>in vitro</italic> cell culture experiment where samples were collected at different times (<xref ref-type="bibr" rid="c8">Arenas <italic>et al</italic>, 2016</xref>). This data included 21 MA protein consensus sequences collected at times (population passages, <italic>T</italic>) <italic>T1</italic> (initial time and includes an initial sequence) and <italic>T31</italic> (time after 31 passages and includes 20 sequences), which accumulated 48 amino acid substitutions (sequence identity 0.973; Figure S1, Supplementary Material).</p></list-item>
<list-item><p>The main protease (Mpro) and papain-like protease (PLpro) proteins of SARS-CoV-2. For each protein, the data includes the first sequenced variant (Wuhan) and a sequence built with all the substitutions observed in a dataset of 384 genomes of the Omicron variant of concern collected from the GISAID database. The resulting Mpro and PLpro sequences presented 10 and 22 substitutions (sequence identity 0.967 and 0.930), respectively.</p></list-item>
<list-item><p>The protease (PR) of HIV-1 with data sampled from patients monitored over time, from 2008 to 2017, available from the Specialized Assistance Services in Sexually Transmissible Diseases and HIV/AIDS in Brazil (<xref ref-type="bibr" rid="c36">Ferreiro <italic>et al</italic>., 2022</xref>; <xref ref-type="bibr" rid="c89">Santos-Pereira <italic>et al</italic>, 2021</xref>; <xref ref-type="bibr" rid="c90">Souto <italic>et al</italic>, 2021</xref>). These evolutionary scenarios are complex due to the diverse antiretroviral therapies administrated to the patients (Table S2; Supplementary Material), which could vary during the studied time periods and that could promote the fixation of specific mutations (i.e., associated with resistance) (<xref ref-type="bibr" rid="c36">Ferreiro <italic>et al</italic>., 2022</xref>; <xref ref-type="bibr" rid="c89">Santos-Pereira <italic>et al</italic>., 2021</xref>; <xref ref-type="bibr" rid="c90">Souto <italic>et al</italic>., 2021</xref>). For each viral population (patient), the data included a consensus sequence for each of the four or five samples collected at different time points. These consensus sequences exhibited between one and 22 amino acid substitutions respect to the consensus sequence of the corresponding first sample (Table S2).</p></list-item>
</list>
We identified a representative protein structure for each data, which was used to predict the folding stability and to inform the SCS model. In particular, we obtained the protein structures of the sequences at the initial time (<italic>T1</italic>) by homology modelling. We used <italic>SWISS-MODEL</italic> (<xref ref-type="bibr" rid="c11">Arnold <italic>et al</italic>, 2006</xref>) to identify the best-fitting templates of PDB structures (Table S3, Supplementary Material). Next, we predicted the protein structures by homology modelling with <italic>Modeller</italic> (<xref ref-type="bibr" rid="c88">Sali &amp; Blundell, 1993</xref>) using the protein sequences and corresponding structural templates.</p>
</sec>
<sec id="s2c">
<title>Forward in time prediction of viral protein variants</title>
<p>The evaluation was performed with the previously presented real data, which includes a real protein variant present at the initial time (<italic>T1</italic>) and subsequent protein variants present at a later time (<italic>Tn</italic>). We applied the method for forecasting protein evolution to predict the most likely protein variants at <italic>Tn</italic> derived from the real protein variant observed at the initial time (<italic>T1</italic>).</p>
<p>The prediction error was determined by measuring the distance between the real protein variants and the predicted variants corresponding to time <italic>Tn</italic>.</p>
<p>Thus, we assigned to the initial node (<italic>T1</italic>) the corresponding real protein variant (including its sequence and structure), and its evolution was simulated forward in time until it reached the number of substitutions observed in the real data at time <italic>Tn</italic>. Thus, we considered the number of observed substitutions as a measure of evolutionary time to allow proper comparisons between real and predicted variants. We simulated 100 alignments of protein sequences, each containing the same number of sequences as the real data at <italic>Tn</italic>. This included 20 HIV-1 MA protein sequences, a consensus sequence for the SARS-CoV-2 Mpro, a consensus sequence for the SARS-CoV-2 PLpro and, a consensus sequence of HIV-1 PR for every viral population. To avoid rare variants, each sequence of the simulated multiple sequence alignments was obtained as the consensus of 100 linked simulated sequences.</p>
<p>To investigate the effect of selection on the predictions, we compared the accuracy of forecasting protein evolution when selection from the protein structure is considered and, when it is ignored (neutral evolution). If selection is considered, as previously presented, the probability of birth and death events was based on the fitness of the protein variants, and protein evolution was modeled using an SCS model (<xref ref-type="bibr" rid="c7">Arenas <italic>et al</italic>., 2013</xref>). For the case of neutral evolution, all protein variants equally fit and are allowed, leading to only birth events, and we modeled protein evolution using an exchangeability matrix with the same relative rates of change for any pair of amino acids.</p>
</sec>
<sec id="s2d">
<title>Accuracy of the predicted protein variants</title>
<p>We assessed the accuracy of the method for forecasting protein evolution by comparing the predicted and real protein variants present at time <italic>Tn</italic>, both at the protein sequence and structure levels.</p>
<p>For data containing multiple sequences at time <italic>Tn</italic>, we calculated the Kullback-Leibler (KL) divergence, which provides a distance between two multiple sequence alignments (the real and predicted data) based on the distribution of amino acid frequencies along the sequences (Equation III, where factors <italic>P</italic> and <italic>Q</italic> denote the distribution of amino acid frequencies in the real and predicted protein sequences at time <italic>Tn</italic>, respectively, <italic>i</italic> refers to protein site) (<xref ref-type="bibr" rid="c58">Kullback &amp; Leibler, 1951</xref>). This distance was only calculated for data with a set of sequences at time <italic>Tn</italic> (HIV-1 MA) because a single sequence does not provide site-specific variability.
<disp-formula id="eqn3">
<graphic xlink:href="639428v2_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We also compared the real and predicted evolutionary trajectories of protein variants using the Grantham distance, which measures the differences between amino acids based on their physicochemical properties (<xref ref-type="bibr" rid="c48">Grantham, 1974</xref>). In particular, for both real and predicted protein variants, we calculated the Grantham distance at each protein site that differs between the two datasets, considering its evolution from <italic>T1</italic> to the subsequent multiple sequence alignment at <italic>Tn</italic>. We examined sites that varied over time, thus the general site-specific Grantham distance <italic>Gi</italic> was calculated as the frequency of each amino acid <italic>f</italic> at site <italic>i</italic> multiplied by the specific Grantham distance between amino acid <italic>m</italic> at time <italic>Tn</italic> and amino acid <italic>n</italic> at time <italic>T1</italic>, normalized with the largest Grantham distance <italic>G<sub>max</sub></italic> to obtain values between 0 and 1 (Equation IV). Next, to compare the real and predicted data, we calculated the site-specific difference of Grantham distance <italic>Gb<sub>i</sub></italic> between the real <italic>P</italic> and predicted <italic>Q</italic> protein variants (Equation V),
<disp-formula id="eqn4">
<graphic xlink:href="639428v2_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn5">
<graphic xlink:href="639428v2_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
In addition, we obtained and compared the protein folding stability (ΔG) of the predicted and real protein variants observed at time <italic>Tn</italic>, using their corresponding protein structures, with <italic>DeltaGREM</italic> (<xref ref-type="bibr" rid="c10">Arenas <italic>et al</italic>., 2015</xref>; <xref ref-type="bibr" rid="c69">Minning <italic>et al</italic>, 2013</xref>).</p>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Implementation of the forecasting protein evolution method</title>
<p>We extended the previous version of our framework <italic>ProteinEvolver</italic> (<xref ref-type="bibr" rid="c7">Arenas <italic>et al</italic>., 2013</xref>), maintaining its previous capabilities (i.e., simulation of protein evolution upon user-specified phylogenetic trees and upon phylogenetic trees simulated with the coalescent with or without recombination, migration, demographics and longitudinal sampling, empirical and SCS models, among others; Table S1), by adding, among others (Table S1), the forward in time modeling of protein evolution that combines a birth-death process based on the fitness of every protein variant (folding stability) at each node to determine its birth and death rates, as well as SCS models of protein evolution. The framework <italic>ProteinEvolver2</italic> is written in C and distributed with a detailed documentation and a variety of illustrative practical examples. The framework is freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/MiguelArenas/proteinevolver">https://github.com/MiguelArenas/proteinevolver</ext-link>.</p>
</sec>
<sec id="s3b">
<title>Evaluation of predictions of HIV-1 MA evolution</title>
<p>Regarding the evolution of the HIV-1 MA protein, the Grantham distance and the KL divergence between the real variants at time <italic>Tn</italic> and the corresponding predicted variants were low (around 5% and 6%, respectively; <xref rid="tbl1" ref-type="table">Table 1</xref>), and they did not differ comparing predictions that consider selection on the folding stability and predictions that ignore it (<xref rid="tbl1" ref-type="table">Table 1</xref>). On the other hand, we found that the folding stability of the protein variants predicted considering selection on the folding stability was closer to the folding stability of the real protein variants than that of the protein variants predicted under neutral evolution (<xref rid="tbl1" ref-type="table">Table 1</xref>). In particular, the protein variants predicted ignoring selection were less stable than those predicted considering selection and also less stable than the real protein variants.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>Comparison of real and predicted sequences of the HIV-1 MA protein considering predictions based on the SCS and neutral models.</title><p>For the data simulated under the SCS and neutral models, the table shows the Grantham distance between the amino acids that changed during the real and predicted evolutionary trajectories and, the Kullback-Leibler (KL) divergence between the real and predicted multiple sequence alignments. Next, it shows the folding stability (ΔG) of the real protein variants at times <italic>T1</italic> and <italic>T31</italic>, and the folding stability of the predicted protein variants at time <italic>T31.</italic> The error corresponds to the 95% confidence interval from the mean of predictions of folding stability.</p></caption>
<graphic xlink:href="639428v2_tbl1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
</sec>
<sec id="s3c">
<title>Evaluation of predictions of SARS-CoV-2 Mpro and PLpro evolution</title>
<p>The analyses of the SARS-CoV-2 Mpro and PLpro data the Grantham distance between the real and predicted sequences was around 25% and 36%, respectively (<xref rid="fig2" ref-type="fig">Figure 2A</xref>). Again, this distance was similar when comparing predictions based on a model that considers selection on the protein folding stability and a model of neutral evolution. Regarding comparisons based on the protein folding stability, we found again that the model that considers selection from the folding stability produces variants closer to the stability of the real protein variants than the model that ignores selection (<xref rid="fig2" ref-type="fig">Figure 2B</xref>). Indeed, the protein sequences derived from the model that considers selection were more stable than those derived from the model of neutral evolution.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Prediction error of SARS-CoV-2 Mpro and PLpro evolution regarding physicochemical properties of the amino acid changes accumulated during the evolutionary trajectories and protein folding stability.</title>
<p>(A) Grantham distance calculated from the amino acid changes that occurred during the real and predicted evolutionary trajectories based on SCS and neutral models of protein evolution. (B) Variation of protein folding stability (ΔΔG) between real and predicted protein variants based on SCS and neutral models of protein evolution. Notice that positive ΔΔG indicates that the real protein variants are more stable than the predicted protein variants and <italic>vice versa</italic>. Error bars correspond to the 95% confidence interval of the mean of prediction error from 100 multiple sequence alignments simulated for the corresponding population and time.</p></caption>
<graphic xlink:href="639428v2_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s3d">
<title>Evaluation of predictions of HIV-1 PR evolution</title>
<p>In general, the Grantham distance, which compared the evolutionary trajectories of the real and predicted protein variants from time <italic>T1</italic> to later times, varied among viral populations (patients) (<xref rid="fig3" ref-type="fig">Figure 3A</xref>). However, for the majority of these populations, the distance remained below 30% and exhibited minor fluctuations over time. One particular population exhibited a notable trend, with the distance increasing from 10% to nearly 60% over time. Considering that the length of the evolutionary trajectories of the protein can differ among the studied populations, we explored whether the accumulated number of amino acid substitutions could affect the accuracy of the predictions, and we found that the number of substitutions varied among populations and this variability did not correlate with the Grantham distance between the real and predicted data (R<sup>2</sup>=0.0001, <xref rid="fig3" ref-type="fig">Figure 3B</xref>). In general, the folding stability of the predicted protein variants was similar or slightly less stable than that of the real protein variants [with a difference ranging from 0 to 9 kcal/mol and a mean of 3.1 ± 0.9 (95% CI) kcal/mol; <xref rid="fig3" ref-type="fig">Figure 3C</xref>]. Indeed, the folding stability exhibited small fluctuations, increasing and decreasing, over time.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Prediction error of HIV-1 PR evolution at diverse populations regarding physicochemical properties of the amino acid changes accumulated during the evolutionary trajectories and protein folding stability.</title><p>(A) For each viral population (patient, represented with a particular color) and time, Grantham distance calculated from the amino acid changes that occurred during the real and predicted evolutionary trajectories. For each population, the mean of distances obtained over time is shown on the right. (B) Relationship between Grantham distances and accumulated number of substitution events (R<sup>2</sup> = 0.0001, which indicates a lack of correlation between these parameters). (C) Variation of protein folding stability (ΔΔG) between real and predicted protein variants at each viral population and time. For each population, the mean of distances obtained over time is shown on the right. Notice that positive ΔΔG indicates that the real protein variants are more stable than the predicted protein variants and <italic>vice versa</italic>. Error bars correspond to the 95% confidence interval of the mean of prediction error from 100 multiple sequence alignments simulated for the corresponding viral population and time.</p></caption>
<graphic xlink:href="639428v2_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
</sec>
<sec id="s4">
<title>Discussion</title>
<p>While reconstructing evolutionary histories and ancestral sequences, among other inferences about the past, was popular in the field, predictions about evolution toward the future were traditionally ignored due to potential high prediction errors. However, in the last decade, forecasting evolution has gained attention because of its wide variety of applications and advancements in models of evolution (see the reviews <xref ref-type="bibr" rid="c60">Lässig <italic>et al</italic>., 2017</xref>; <xref ref-type="bibr" rid="c101">Wortel <italic>et al</italic>., 2023</xref>). Several studies showed that forecasting evolution can be feasible in some systems, including virus evolution (<xref ref-type="bibr" rid="c66">Luksza &amp; Lassig, 2014</xref>; <xref ref-type="bibr" rid="c95">Thadani <italic>et al</italic>, 2023</xref>). Here, we also investigated forecasting evolution in viruses but at the molecular level, considering the relevance of the substitution process to produce molecular variants that affect the viral fitness (<xref ref-type="bibr" rid="c4">Arenas, 2015a</xref>; <xref ref-type="bibr" rid="c8">Arenas <italic>et al</italic>., 2016</xref>; <xref ref-type="bibr" rid="c17">Bloom &amp; Neher, 2023</xref>; <xref ref-type="bibr" rid="c83">Poon <italic>et al</italic>, 2007</xref>; <xref ref-type="bibr" rid="c99">Watabe &amp; Kishino, 2010</xref>). We believe that forecasting genome evolution remains challenging due to the complexity of its evolutionary processes [i.e., including epistatic interactions, chromosomal rearrangements and heterogeneous substitution patterns among genomic regions (<xref ref-type="bibr" rid="c2">Arbiza <italic>et al</italic>, 2011</xref>), among others] that complicate the parameterization and prediction of accurate fitness landscapes. However, we believe that it could be more feasible in structural proteins because of their relatively simpler evolutionary processes that usually include selection on folding stability (<xref ref-type="bibr" rid="c16">Bloom <italic>et al</italic>, 2006</xref>; <xref ref-type="bibr" rid="c44">Goldstein, 2011</xref>).</p>
<p>To make evolutionary predictions over time, either toward the past or toward the future, considering a substitution model of molecular evolution can be convenient. Actually, a variety of traditional studies showed that the substitution model influences the phylogenetic likelihood generated by probabilistic approaches used for evolutionary inference (<xref ref-type="bibr" rid="c63">Lemmon &amp; Moriarty, 2004</xref>; <xref ref-type="bibr" rid="c106">Yang <italic>et al</italic>, 1994</xref>; <xref ref-type="bibr" rid="c109">Zhang &amp; Nei, 1997</xref>). To study protein evolution, empirical substitution models of protein evolution are routinely used because they allow rapid calculations based on the assumption of site-independent evolution and typically apply the same exchangeability matrix for all the protein sites, which is highly unrealistic (<xref ref-type="bibr" rid="c33">Echave <italic>et al</italic>, 2016</xref>). Besides, a small set of empirical substitution models was developed for modeling the evolution of the diverse range of viral proteins (<xref ref-type="bibr" rid="c22">Dang <italic>et al</italic>, 2010</xref>; <xref ref-type="bibr" rid="c26">Del Amparo &amp; Arenas, 2022b</xref>; <xref ref-type="bibr" rid="c31">Dimmic <italic>et al</italic>, 2002</xref>; <xref ref-type="bibr" rid="c61">Le &amp; Vinh, 2020</xref>; <xref ref-type="bibr" rid="c77">Nickle <italic>et al</italic>, 2007</xref>). As an alternative, some substitution models that consider evolutionary constraints on the protein structure incorporated site-dependent evolution, which allows a more accurate modeling of protein evolution compared to the empirical substitution models (<xref ref-type="bibr" rid="c7">Arenas <italic>et al</italic>., 2013</xref>; <xref ref-type="bibr" rid="c10">Arenas <italic>et al</italic>., 2015</xref>; <xref ref-type="bibr" rid="c18">Bordner &amp; Mittelmann, 2013</xref>; <xref ref-type="bibr" rid="c35">Ferreiro <italic>et al</italic>., 2024a</xref>; <xref ref-type="bibr" rid="c80">Parisi &amp; Echave, 2005</xref>).</p>
<p>According to previous methods for forecasting evolution based on computer simulations (<xref ref-type="bibr" rid="c59">Lassig &amp; Luksza, 2014</xref>; <xref ref-type="bibr" rid="c76">Neher <italic>et al</italic>., 2014</xref>), we also adopted the birth-death population genetics process to allow a forward-in-time evolutionary process where the birth and death rates can differ among nodes (<xref ref-type="bibr" rid="c93">Stadler, 2010</xref>; <xref ref-type="bibr" rid="c94">Stadler, 2011</xref>). Traditional population genetics methods to simulate the evolution of molecular data implement a two-step simulation process, where first the evolutionary history is simulated [i.e., with the coalescent theory or a forward-in-time simulation approach (<xref ref-type="bibr" rid="c3">Arenas, 2012</xref>; <xref ref-type="bibr" rid="c50">Hoban <italic>et al</italic>., 2012</xref>), often assuming neutral evolution] and, in a subsequent step, molecular evolution is simulated upon the previously obtained evolutionary history (<xref ref-type="bibr" rid="c105">Yang, 2006</xref>). However, this methodology is unrealistic because the fitness of the data can affect its evolutionary history (i.e., a variant with high fitness is likely to have more descendants than a variant with low fitness). Thus, we designed and implemented a method for forecasting protein evolution that integrates a birth-death population genetics process with a SCS model of protein evolution, where the folding stability of each protein variant is evaluated to predict its future trajectory in terms of both evolutionary history and molecular evolution. We implemented this forward-in-time simulation of protein evolution in a new version of our previous framework <italic>ProteinEvolver</italic> (<xref ref-type="bibr" rid="c7">Arenas <italic>et al</italic>., 2013</xref>), while maintaining its previous capabilities and extending some of them (i.e., incorporation of site-specific exchangeability matrices and additional substitution models of protein evolution, among others; see Table S1 and software documentation).</p>
<p>Next, we evaluated the forward-in-time evolutionary predictions with real data of HIV-1 and SARS-CoV-2 proteins. We determined the prediction errors between the real and the predicted protein variants by examining dissimilarity in evolutionary trajectory (Grantham distance based on physicochemical properties among the differing amino acids during the evolutionary trajectories), sequence divergence (distribution of amino acid frequencies among sites using the KL divergence), and protein structure (protein folding stability). Additionally, we analyzed the influence of accounting for selection, based on the protein folding stability, on the predictions.</p>
<p>In general, the sequence and evolutionary trajectory dissimilarities between the real and predicted protein variants were relatively small. For the HIV-1 MA protein, the SARS-CoV-2 Mpro and the SARS-CoV-2 PLpro, the sequence dissimilarity was below 10%, 26% and 36%, respectively. The low prediction errors for the HIV-1 MA protein were expected because the data was derived from an <italic>in vitro</italic> cell culture experiment that is not influenced by a variety of external factors that could affect the predictions in <italic>in vivo</italic> experiments. As a rough reference, in traditional ancestral sequence reconstruction (ASR) of protein data with high sequence identity the error was approximately 2% (<xref ref-type="bibr" rid="c9">Arenas &amp; Posada, 2010</xref>). Notice that ASR methods can exhibit lower prediction errors due to their statistical evaluation based on a set of original sequences, rather than relying on a single original sequence used in the case of forecasting evolution. The contrasting scenario regarding evolutionary complexity was the HIV-1 PR data, which was sampled from populations (patients) undergoing various antiretroviral treatments (<xref ref-type="bibr" rid="c36">Ferreiro <italic>et al</italic>., 2022</xref>). There, the sequence dissimilarity varied among viral populations, although most were below 30%. A viral population exhibited higher dissimilarities (near 60%) that we believe could be caused by molecular adaptations promoted by the therapies, although this needs formal investigation.</p>
<p>An unexpected result was that the model of neutral evolution produced sequence dissimilarities between the real and predicted protein variants that were similar to those obtained with the SCS model (<xref rid="tbl1" ref-type="table">Table 1</xref> and <xref rid="fig2" ref-type="fig">Figure 2</xref>). A few studies indicated that the substitution model has negligible effects on the reconstructed phylogenetic trees (<xref ref-type="bibr" rid="c1">Abadi <italic>et al</italic>, 2019</xref>; <xref ref-type="bibr" rid="c91">Spielman, 2020</xref>). Subsequent studies found that the influence of the substitution model on phylogenetic reconstructions is dependent on the diversity of the data, where data with high diversity is more sensible to the applied substitution model due to containing more evolutionary information to be modeled (<xref ref-type="bibr" rid="c25">Del Amparo &amp; Arenas, 2022a</xref>, 2023). Considering that the data studied here has overall low diversity (i.e., sequence identity of 0.973, 0.967 and 0.930 for the HIV MA data, SARS-CoV-2 Mpro data and SARS-CoV-2 PLpro data, respectively; it is important to note that, in general, longitudinal data derived from monitored evolutionary processes usually show a low diversity because involve relatively short evolutionary histories, among other factors), we believe that the influence of the applied substitution models on the prediction of the sequences was small because of the small number of modeled substitution events, as found in phylogenetic reconstructions (<xref ref-type="bibr" rid="c25">Del Amparo &amp; Arenas, 2022a</xref>, 2023). In all, the prediction error related to sequence dissimilarity varied among the studied evolutionary scenarios; as expected, it was higher for the more complex scenarios.</p>
<p>We also evaluated the prediction error between the real and predicted protein variants regarding their folding stability, again comparing the predictions made under a model that considers structural constraints and a model of neutral evolution. In general, the protein variants predicted under the SCS model presented a folding stability close to the folding stability of the respective real protein variants, with differences below 1, 2 and 7 kcal/mol for the HIV MA data, SARS-CoV-2 Mpro data and SARS-CoV-2 PLpro data, respectively. The higher differences (around 9 kcal/mol) were again observed for the HIV-1 PR data. In contrast to the prediction error based on sequence dissimilarity, the prediction error based on folding stability varies between predictions obtained under the SCS model and those obtained under the neutral model. In the studied evolutionary scenarios, the protein variants predicted under the neutral model were less stable and farther from the stability of the real protein variants compared to those predicted under the SCS model. These results were expected because, under SCS models, protein stability can be modeled with greater accuracy than sequence similarity due to selection for maintaining stability in the protein structure despite amino acid changes (<xref ref-type="bibr" rid="c6">Arenas &amp; Bastolla, 2020</xref>; <xref ref-type="bibr" rid="c54">Illergard <italic>et al</italic>, 2009</xref>; <xref ref-type="bibr" rid="c81">Pascual-Garcia <italic>et al</italic>, 2010</xref>). Indeed, previous studies showed that models that ignore structural constraints often produce proteins with unrealistic folding instability (<xref ref-type="bibr" rid="c6">Arenas &amp; Bastolla, 2020</xref>; <xref ref-type="bibr" rid="c28">Del Amparo <italic>et al</italic>., 2023</xref>), which suggests that accounting for protein folding stability in the modeling of protein evolution is recommended for predicting protein variants with appropriate structural properties.</p>
<p>We present a method to simulate forward-in-time protein evolution accounting for evolutionary constraints from the protein structure and a birth-death population process, and where the evolutionary history is influenced by the protein evolution and <italic>vice versa</italic>. The method is implemented in the computer framework <italic>ProteinEvolver2</italic>, which is freely distributed with several practical examples and detailed documentation. We believe that implementing methods into freely available phylogenetic frameworks is important to facilitate practical applications, as well as future improvements and evaluations. We applied the method to forecast protein evolution in some viral proteins. We found that the method provides acceptable approximations to the real evolution, especially in terms of protein folding stability, suggesting that combining structural constraints with birth-death population processes in the modeling of protein evolution is convenient. Still, to advance in methods for forecasting protein evolution, we believe that further efforts should be made in the field to improve the modeling of protein evolution, such as the incorporation of site-dependent evolutionary constraints from the protein activity.</p>
</sec>
</body>
<back>
<sec id="s6" sec-type="data-availability">
<title>Data Availability</title>
<p>The computer framework <italic>ProteinEvolver2</italic> is freely available from <ext-link ext-link-type="uri" xlink:href="https://github.com/MiguelArenas/proteinevolver">https://github.com/MiguelArenas/proteinevolver</ext-link>. The SARS-CoV-2 data is available from GISAID database with DOI <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.55876/gis8.250206gt">https://doi.org/10.55876/gis8.250206gt</ext-link>. The real and predicted protein variants are available from Zenodo repository at the URL <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.5281/zenodo.14767475">https://doi.org/10.5281/zenodo.14767475</ext-link>.</p>
</sec>
<ack>
<title>Acknowledgments</title>
<p>This work was supported by the Project PID2023-151032NB-C22 funded by MCIU/AEI/10.13039/501100011033 and by FEDER, UE. D.F. was funded by a fellowship from Xunta de Galicia [ED481A-2020/192]. We thank the “Centro de Supercomputación de Galicia (CESGA)” for the computer resources. The funders had no role in study design, data collection and analysis, decision to publish, or preparation of the manuscript.</p>
</ack>
<sec id="suppd1e1631" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="d1e1622">
<label>Supplementary Material</label>
<media xlink:href="supplements/639428_file02.pdf"/>
</supplementary-material>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abadi</surname> <given-names>S</given-names></string-name>, <string-name><surname>Azouri</surname> <given-names>D</given-names></string-name>, <string-name><surname>Pupko</surname> <given-names>T</given-names></string-name>, <string-name><surname>Mayrose</surname> <given-names>I</given-names></string-name></person-group> (<year>2019</year>) <article-title>Model selection may not be a mandatory step for phylogeny reconstruction</article-title>. <source>Nat Commun</source> <volume>10</volume>: <fpage>934</fpage></mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arbiza</surname> <given-names>L</given-names></string-name>, <string-name><surname>Patricio</surname> <given-names>M</given-names></string-name>, <string-name><surname>Dopazo</surname> <given-names>H</given-names></string-name>, <string-name><surname>Posada</surname> <given-names>D</given-names></string-name></person-group> (<year>2011</year>) <article-title>Genome-wide heterogeneity of nucleotide substitution model fit</article-title>. <source>Genome Biol Evol</source> <volume>3</volume>: <fpage>896</fpage>–<lpage>908</lpage></mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arenas</surname> <given-names>M</given-names></string-name></person-group> (<year>2012</year>) <article-title>Simulation of Molecular Data under Diverse Evolutionary Scenarios</article-title>. <source>PLoS Comput Biol</source> <volume>8</volume>: <fpage>e1002495</fpage></mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arenas</surname> <given-names>M</given-names></string-name></person-group> (<year>2015a</year>) <article-title>Genetic Consequences of Antiviral Therapy on HIV-1</article-title>. <source>Comput Math Methods Med</source> <volume>2015</volume>: <fpage>9</fpage></mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arenas</surname> <given-names>M</given-names></string-name></person-group> (<year>2015b</year>) <article-title>Trends in substitution models of molecular evolution</article-title>. <source>Front Genet</source> <volume>6</volume>: <fpage>319</fpage></mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arenas</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name></person-group> (<year>2020</year>) <article-title>ProtASR2: Ancestral reconstruction of protein sequences accounting for folding stability</article-title>. <source>Methods Ecol Evol</source> <volume>11</volume>: <fpage>248</fpage>–<lpage>257</lpage></mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arenas</surname> <given-names>M</given-names></string-name>, <string-name><surname>Dos Santos</surname> <given-names>HG</given-names></string-name>, <string-name><surname>Posada</surname> <given-names>D</given-names></string-name>, <string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name></person-group> (<year>2013</year>) <article-title>Protein evolution along phylogenetic histories under structurally constrained substitution models</article-title>. <source>Bioinformatics</source> <volume>29</volume>: <fpage>3020</fpage>–<lpage>3028</lpage></mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arenas</surname> <given-names>M</given-names></string-name>, <string-name><surname>Lorenzo-Redondo</surname> <given-names>R</given-names></string-name>, <string-name><surname>Lopez-Galindez</surname> <given-names>C</given-names></string-name></person-group> (<year>2016</year>) <article-title>Influence of mutation and recombination on HIV-1 in vitro fitness recovery</article-title>. <source>Mol Phylogenet Evol</source> <volume>94</volume>: <fpage>264</fpage>–<lpage>270</lpage></mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arenas</surname> <given-names>M</given-names></string-name>, <string-name><surname>Posada</surname> <given-names>D</given-names></string-name></person-group> (<year>2010</year>) <article-title>The effect of recombination on the reconstruction of ancestral sequences</article-title>. <source>Genetics</source> <volume>184</volume>: <fpage>1133</fpage>–<lpage>1139</lpage></mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arenas</surname> <given-names>M</given-names></string-name>, <string-name><surname>Sanchez-Cobos</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name></person-group> (<year>2015</year>) <article-title>Maximum likelihood phylogenetic inference with selection on protein folding stability</article-title>. <source>Mol Biol Evol</source> <volume>32</volume>: <fpage>2195</fpage>–<lpage>2207</lpage></mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arnold</surname> <given-names>K</given-names></string-name>, <string-name><surname>Bordoli</surname> <given-names>L</given-names></string-name>, <string-name><surname>Kopp</surname> <given-names>J</given-names></string-name>, <string-name><surname>Schwede</surname> <given-names>T</given-names></string-name></person-group> (<year>2006</year>) <article-title>The SWISS-MODEL workspace: a web-based environment for protein structure homology modelling</article-title>. <source>Bioinformatics</source> <volume>22</volume>: <fpage>195</fpage>–<lpage>201</lpage></mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barton</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Goonetilleke</surname> <given-names>N</given-names></string-name>, <string-name><surname>Butler</surname> <given-names>TC</given-names></string-name>, <string-name><surname>Walker</surname> <given-names>BD</given-names></string-name>, <string-name><surname>McMichael</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Chakraborty</surname> <given-names>AK</given-names></string-name></person-group> (<year>2016</year>) <article-title>Relative rate and location of intra-host HIV evolution to evade cellular immunity are predictable</article-title>. <source>Nature Communications</source> <volume>7</volume>: <fpage>11660</fpage></mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name>, <string-name><surname>Demetrius</surname> <given-names>L</given-names></string-name></person-group> (<year>2005</year>) <article-title>Stability constraints and protein evolution: the role of chain length, composition and disulfide bonds</article-title>. <source>Protein Eng Des Sel</source> <volume>18</volume>: <fpage>405</fpage>–<lpage>415</lpage></mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name>, <string-name><surname>Porto</surname> <given-names>M</given-names></string-name>, <string-name><surname>Roman</surname> <given-names>HE</given-names></string-name>, <string-name><surname>Vendruscolo</surname> <given-names>M</given-names></string-name></person-group> (<year>2006</year>) <article-title>A protein evolution model with independent sites that reproduces site-specific amino acid distributions from the Protein Data Bank</article-title>. <source>BMC Evol Biol</source> <volume>6</volume>: <fpage>43</fpage></mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name>, <string-name><surname>Porto</surname> <given-names>M</given-names></string-name>, <string-name><surname>Roman</surname> <given-names>HE</given-names></string-name>, <string-name><surname>Vendruscolo</surname> <given-names>M</given-names></string-name></person-group> (<year>2007</year>) <article-title><italic>Structural approaches to sequence evolution</italic>. Springer, Berlin</article-title>, <source>Heidelberg</source></mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bloom</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Labthavikul</surname> <given-names>ST</given-names></string-name>, <string-name><surname>Otey</surname> <given-names>CR</given-names></string-name>, <string-name><surname>Arnold</surname> <given-names>FH</given-names></string-name></person-group> (<year>2006</year>) <article-title>Protein stability promotes evolvability</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>103</volume>: <fpage>5869</fpage>–<lpage>5874</lpage></mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bloom</surname> <given-names>JD</given-names></string-name>, <string-name><surname>Neher</surname> <given-names>RA</given-names></string-name></person-group> (<year>2023</year>) <article-title>Fitness effects of mutations to SARS-CoV-2 proteins</article-title>. <source>Virus Evol</source> <volume>9</volume>: <elocation-id>vead055</elocation-id></mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bordner</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Mittelmann</surname> <given-names>HD</given-names></string-name></person-group> (<year>2013</year>) <article-title>A new formulation of protein evolutionary models that account for structural constraints</article-title>. <source>Mol Biol Evol</source> <volume>31</volume>: <fpage>736</fpage>–<lpage>749</lpage></mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bull</surname> <given-names>JJ</given-names></string-name>, <string-name><surname>Molineux</surname> <given-names>IJ</given-names></string-name></person-group> (<year>2008</year>) <article-title>Predicting evolution from genomics: experimental evolution of bacteriophage T7</article-title>. <source>Heredity</source> <volume>100</volume>: <fpage>453</fpage>–<lpage>463</lpage></mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carneiro</surname> <given-names>M</given-names></string-name>, <string-name><surname>Hartl</surname> <given-names>DL</given-names></string-name></person-group> (<year>2010</year>) <article-title>Colloquium papers: Adaptive landscapes and protein evolution</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>107</volume> <issue>Suppl 1</issue>: <fpage>1747</fpage>–<lpage>1751</lpage></mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Colless</surname> <given-names>DH</given-names></string-name></person-group> (<year>1982</year>) <article-title>Review of Phylogenetics: The Theory and Practice of Phylogenetic Systematics</article-title>. <source>Systematic Zoology</source> <volume>31</volume>: <fpage>100</fpage>–<lpage>104</lpage></mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dang</surname> <given-names>CC</given-names></string-name>, <string-name><surname>Le</surname> <given-names>QS</given-names></string-name>, <string-name><surname>Gascuel</surname> <given-names>O</given-names></string-name>, <string-name><surname>Le</surname> <given-names>VS</given-names></string-name></person-group> (<year>2010</year>) <article-title>FLU, an amino acid substitution model for influenza proteins</article-title>. <source>BMC Evol Biol</source> <volume>10</volume>: <fpage>99</fpage></mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Darriba</surname> <given-names>D</given-names></string-name>, <string-name><surname>Taboada</surname> <given-names>GL</given-names></string-name>, <string-name><surname>Doallo</surname> <given-names>R</given-names></string-name>, <string-name><surname>Posada</surname> <given-names>D</given-names></string-name></person-group> (<year>2011</year>) <article-title>ProtTest 3: fast selection of best-fit models of protein evolution</article-title>. <source>Bioinformatics</source> <volume>27</volume>: <fpage>1164</fpage>–<lpage>1165</lpage></mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>de Visser</surname> <given-names>J</given-names></string-name>, <string-name><surname>Elena</surname> <given-names>SF</given-names></string-name>, <string-name><surname>Fragata</surname> <given-names>I</given-names></string-name>, <string-name><surname>Matuszewski</surname> <given-names>S</given-names></string-name></person-group> (<year>2018</year>) <article-title>The utility of fitness landscapes and big data for predicting evolution</article-title>. <source>Heredity (Edinb)</source> <volume>121</volume>: <fpage>401</fpage>–<lpage>405</lpage></mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Del Amparo</surname> <given-names>R</given-names></string-name>, <string-name><surname>Arenas</surname> <given-names>M</given-names></string-name></person-group> (<year>2022a</year>) <article-title>Consequences of Substitution Model Selection on Protein Ancestral Sequence Reconstruction</article-title>. <source>Molecular Biology and Evolution</source> <volume>39</volume>: <elocation-id>msac144</elocation-id></mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Del Amparo</surname> <given-names>R</given-names></string-name>, <string-name><surname>Arenas</surname> <given-names>M</given-names></string-name></person-group> (<year>2022b</year>) <article-title>HIV Protease and Integrase Empirical Substitution Models of Evolution: Protein-Specific Models Outperform Generalist Models</article-title>. <source>Genes</source> <fpage>13</fpage></mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Del Amparo</surname> <given-names>R</given-names></string-name>, <string-name><surname>Arenas</surname> <given-names>M</given-names></string-name></person-group> (<year>2023</year>) <article-title>Influence of substitution model selection on protein phylogenetic tree reconstruction</article-title>. <source>Gene</source> <volume>865</volume>: <fpage>147336</fpage></mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Del Amparo</surname> <given-names>R</given-names></string-name>, <string-name><surname>González-Vázquez</surname> <given-names>LD</given-names></string-name>, <string-name><surname>Rodríguez-Moure</surname> <given-names>L</given-names></string-name>, <string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name>, <string-name><surname>Arenas</surname> <given-names>M</given-names></string-name></person-group> (<year>2023</year>) <article-title>Consequences of Genetic Recombination on Protein Folding Stability</article-title>. <source>Journal of Molecular Evolution</source> <volume>91</volume>: <fpage>33</fpage>–<lpage>45</lpage></mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Desai</surname> <given-names>MM</given-names></string-name>, <string-name><surname>Fisher</surname> <given-names>DS</given-names></string-name></person-group> (<year>2007</year>) <article-title>Beneficial Mutation–Selection Balance and the Effect of Linkage on Positive Selection</article-title>. <source>Genetics</source> <volume>176</volume>: <fpage>1759</fpage>–<lpage>1798</lpage></mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Diaz-Uriarte</surname> <given-names>R</given-names></string-name>, <string-name><surname>Vasallo</surname> <given-names>C</given-names></string-name></person-group> (<year>2019</year>) <article-title>Every which way? On predicting tumor evolution using cancer progression models</article-title>. <source>PLoS Comput Biol</source> <volume>15</volume>: <fpage>e1007246</fpage></mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimmic</surname> <given-names>MW</given-names></string-name>, <string-name><surname>Rest</surname> <given-names>JS</given-names></string-name>, <string-name><surname>Mindell</surname> <given-names>DP</given-names></string-name>, <string-name><surname>Goldstein</surname> <given-names>RA</given-names></string-name></person-group> (<year>2002</year>) <article-title>rtREV: an amino acid substitution matrix for inference of retrovirus and reverse transcriptase phylogeny</article-title>. <source>J Mol Evol</source> <volume>55</volume>: <fpage>65</fpage>–<lpage>73</lpage></mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Eccleston</surname> <given-names>RC</given-names></string-name>, <string-name><surname>Manko</surname> <given-names>E</given-names></string-name>, <string-name><surname>Campino</surname> <given-names>S</given-names></string-name>, <string-name><surname>Clark</surname> <given-names>TG</given-names></string-name>, <string-name><surname>Furnham</surname> <given-names>N</given-names></string-name></person-group> (<year>2023</year>) <article-title>A computational method for predicting the most likely evolutionary trajectories in the stepwise accumulation of resistance mutations</article-title>. <source>eLife</source> <volume>12</volume>: <elocation-id>e84756</elocation-id> <pub-id pub-id-type="doi">10.7554/eLife.84756</pub-id></mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Echave</surname> <given-names>J</given-names></string-name>, <string-name><surname>Spielman</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>Wilke</surname> <given-names>CO</given-names></string-name></person-group> (<year>2016</year>) <article-title>Causes of evolutionary rate variation among protein sites</article-title>. <source>Nat Rev Genet</source> <volume>17</volume>: <fpage>109</fpage>–<lpage>121</lpage></mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Echave</surname> <given-names>J</given-names></string-name>, <string-name><surname>Wilke</surname> <given-names>CO</given-names></string-name></person-group> (<year>2017</year>) <article-title>Biophysical Models of Protein Evolution: Understanding the Patterns of Evolutionary Sequence Divergence</article-title>. <source>Annu Rev Biophys</source> <volume>46</volume>: <fpage>85</fpage>–<lpage>103</lpage></mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ferreiro</surname> <given-names>D</given-names></string-name>, <string-name><surname>Branco</surname> <given-names>C</given-names></string-name>, <string-name><surname>Arenas</surname> <given-names>M</given-names></string-name></person-group> (<year>2024a</year>) <article-title>Selection among site-dependent structurally constrained substitution models of protein evolution by approximate Bayesian computation</article-title>. <source>Bioinformatics</source> <volume>40</volume>: <elocation-id>btae096</elocation-id></mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ferreiro</surname> <given-names>D</given-names></string-name>, <string-name><surname>Khalil</surname> <given-names>R</given-names></string-name>, <string-name><surname>Gallego</surname> <given-names>MJ</given-names></string-name>, <string-name><surname>Osorio</surname> <given-names>NS</given-names></string-name>, <string-name><surname>Arenas</surname> <given-names>M</given-names></string-name></person-group> (<year>2022</year>) <article-title>The evolution of the HIV-1 protease folding stability</article-title>. <source>Virus Evol</source> <volume>8</volume>: <elocation-id>veac115</elocation-id></mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ferreiro</surname> <given-names>D</given-names></string-name>, <string-name><surname>Khalil</surname> <given-names>R</given-names></string-name>, <string-name><surname>Sousa</surname> <given-names>SF</given-names></string-name>, <string-name><surname>Arenas</surname> <given-names>M</given-names></string-name></person-group> (<year>2024b</year>) <article-title>Substitution Models of Protein Evolution with Selection on Enzymatic Activity</article-title>. <source>Molecular Biology and Evolution</source> <volume>41</volume>: <elocation-id>msae026</elocation-id></mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fischer</surname> <given-names>A</given-names></string-name>, <string-name><surname>Vazquez-Garcia</surname> <given-names>I</given-names></string-name>, <string-name><surname>Mustonen</surname> <given-names>V</given-names></string-name></person-group> (<year>2015</year>) <article-title>The value of monitoring to control evolving populations</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>112</volume>: <fpage>1007</fpage>–<lpage>1012</lpage></mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fitch</surname> <given-names>WM</given-names></string-name>, <string-name><surname>Margoliash</surname> <given-names>E</given-names></string-name></person-group> (<year>1967</year>) <article-title>A method for estimating the number of invariant amino acid coding positions in a gene using cytochrome c as a model case</article-title>. <source>Biochem Genet</source> <volume>1</volume>: <fpage>65</fpage>–<lpage>71</lpage></mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fornasari</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Parisi</surname> <given-names>G</given-names></string-name>, <string-name><surname>Echave</surname> <given-names>J</given-names></string-name></person-group> (<year>2002</year>) <article-title>Site-specific amino acid replacement matrices from structurally constrained protein evolution simulations</article-title>. <source>Mol Biol Evol</source> <volume>19</volume>: <fpage>352</fpage>–<lpage>356</lpage></mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gernhard</surname> <given-names>T</given-names></string-name></person-group> (<year>2008</year>) <article-title>The conditioned reconstructed process</article-title>. <source>J Theor Biol</source> <volume>253</volume>: <fpage>769</fpage>–<lpage>778</lpage></mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gerrish</surname> <given-names>PJ</given-names></string-name>, <string-name><surname>Sniegowski</surname> <given-names>PD</given-names></string-name></person-group> (<year>2012</year>) <article-title>Real time forecasting of near-future evolution</article-title>. <source>J R Soc Interface</source> <volume>9</volume>: 2268-2278</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilson</surname> <given-names>AI</given-names></string-name>, <string-name><surname>Marshall-Christensen</surname> <given-names>A</given-names></string-name>, <string-name><surname>Choi</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Shakhnovich</surname> <given-names>EI</given-names></string-name></person-group> (<year>2017</year>) <article-title>The Role of Evolutionary Selection in the Dynamics of Protein Structure Evolution</article-title>. <source>Biophys J</source> <volume>112</volume>: <fpage>1350</fpage>–<lpage>1365</lpage></mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goldstein</surname> <given-names>RA</given-names></string-name></person-group> (<year>2011</year>) <article-title>The evolution and evolutionary consequences of marginal thermostability in proteins</article-title>. <source>Proteins</source> <volume>79</volume>: <fpage>1396</fpage>–<lpage>1407</lpage></mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goldstein</surname> <given-names>RA</given-names></string-name></person-group> (<year>2013</year>) <article-title>Population Size Dependence of Fitness Effect Distribution and Substitution Rate Probed by Biophysical Model of Protein Thermostability</article-title>. <source>Genome Biol Evol</source> <volume>5</volume>: <fpage>1584</fpage>–<lpage>1593</lpage></mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gong</surname> <given-names>LI</given-names></string-name>, <string-name><surname>Suchard</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Bloom</surname> <given-names>JD</given-names></string-name></person-group> (<year>2013</year>) <article-title>Stability-mediated epistasis constrains the evolution of an influenza protein</article-title>. <source>eLife</source> <volume>2</volume>: <elocation-id>e00631</elocation-id> <pub-id pub-id-type="doi">10.7554/eLife.00631</pub-id></mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Goyal</surname> <given-names>S</given-names></string-name>, <string-name><surname>Balick</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Jerison</surname> <given-names>ER</given-names></string-name>, <string-name><surname>Neher</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Shraiman</surname> <given-names>BI</given-names></string-name>, <string-name><surname>Desai</surname> <given-names>MM</given-names></string-name></person-group> (<year>2012</year>) <article-title>Dynamic Mutation–Selection Balance as an Evolutionary Attractor</article-title>. <source>Genetics</source> <volume>191</volume>: <fpage>1309</fpage>–<lpage>1319</lpage></mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grantham</surname> <given-names>R</given-names></string-name></person-group> (<year>1974</year>) <article-title>Amino acid difference formula to help explain protein evolution</article-title>. <source>Science</source> <volume>185</volume>: <fpage>862</fpage>–<lpage>864</lpage></mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Harmon</surname> <given-names>LJ</given-names></string-name></person-group> (<year>2019</year>) <chapter-title>Introduction to birth-death models</chapter-title>. In: <source>Phylogenetic Comparative Methods</source>, p. <ext-link ext-link-type="uri" xlink:href="https://lukejharmon.github.io/pcm/chapter10_birthdeath/">https://lukejharmon.github.io/pcm/chapter10_birthdeath/</ext-link>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoban</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bertorelle</surname> <given-names>G</given-names></string-name>, <string-name><surname>Gaggiotti</surname> <given-names>OE</given-names></string-name></person-group> (<year>2012</year>) <article-title>Computer simulations: tools for population and evolutionary genetics</article-title>. <source>Nat Rev Genet</source> <volume>13</volume>: <fpage>110</fpage>–<lpage>122</lpage></mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hudson</surname> <given-names>RR</given-names></string-name></person-group> (<year>1983</year>) <article-title>Properties of a neutral allele model with intragenic recombination</article-title>. <source>Theoretical Population Biology</source> <volume>23</volume>: <fpage>183</fpage>–<lpage>201</lpage></mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hudson</surname> <given-names>RR</given-names></string-name></person-group> (<year>1990</year>) <article-title>Gene genealogies and the coalescent process</article-title>. <source>Oxford Surveys in Evolutionary Biology</source> <volume>7</volume>: <fpage>1</fpage>–<lpage>44</lpage></mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hudson</surname> <given-names>RR</given-names></string-name></person-group> (<year>1998</year>) <article-title>Island models and the coalescent process</article-title>. <source>Mol Ecol</source> <volume>7</volume>: <fpage>413</fpage>–<lpage>418</lpage></mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Illergard</surname> <given-names>K</given-names></string-name>, <string-name><surname>Ardell</surname> <given-names>DH</given-names></string-name>, <string-name><surname>Elofsson</surname> <given-names>A</given-names></string-name></person-group> (<year>2009</year>) <article-title>Structure is three to ten times more conserved than sequence--a study of structural response in protein cores</article-title>. <source>Proteins</source> <volume>77</volume>: <fpage>499</fpage>–<lpage>508</lpage></mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jacquier</surname> <given-names>H</given-names></string-name>, <string-name><surname>Birgy</surname> <given-names>A</given-names></string-name>, <string-name><surname>Le Nagard</surname> <given-names>H</given-names></string-name>, <string-name><surname>Mechulam</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Schmitt</surname> <given-names>E</given-names></string-name>, <string-name><surname>Glodt</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bercot</surname> <given-names>B</given-names></string-name>, <string-name><surname>Petit</surname> <given-names>E</given-names></string-name>, <string-name><surname>Poulain</surname> <given-names>J</given-names></string-name>, <string-name><surname>Barnaud</surname> <given-names>G</given-names></string-name> <etal>et al.</etal></person-group> (<year>2013</year>) <article-title>Capturing the mutational landscape of the beta-lactamase TEM-1</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>110</volume>: <fpage>13067</fpage>–<lpage>13072</lpage></mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kimura</surname> <given-names>M</given-names></string-name>, <string-name><surname>Weiss</surname> <given-names>GH</given-names></string-name></person-group> (<year>1964</year>) <article-title>The Stepping Stone Model of Population Structure and the Decrease of Genetic Correlation with Distance</article-title>. <source>Genetics</source> <volume>49</volume>: <fpage>561</fpage>–<lpage>576</lpage></mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kingman</surname> <given-names>JFC</given-names></string-name></person-group> (<year>1982</year>) <article-title>The coalescent</article-title>. <source>Stochastic Processes and their Applications</source> <volume>13</volume>: <fpage>235</fpage>–<lpage>248</lpage></mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kullback</surname> <given-names>S</given-names></string-name>, <string-name><surname>Leibler</surname> <given-names>RA</given-names></string-name></person-group> (<year>1951</year>) <article-title>On information and sufficiency</article-title>. <source>Ann Math Stat</source> <volume>22</volume>: <fpage>79</fpage>–<lpage>86</lpage></mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lassig</surname> <given-names>M</given-names></string-name>, <string-name><surname>Luksza</surname> <given-names>M</given-names></string-name></person-group> (<year>2014</year>) <article-title>Can we read the future from a tree</article-title>? <source>eLife</source> <volume>3</volume></mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lässig</surname> <given-names>M</given-names></string-name>, <string-name><surname>Mustonen</surname> <given-names>V</given-names></string-name>, <string-name><surname>Walczak</surname> <given-names>AM</given-names></string-name></person-group> (<year>2017</year>) <article-title>Predicting evolution</article-title>. <source>Nature Ecology &amp; Evolution</source> <volume>1</volume>: <fpage>0077</fpage></mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Le</surname> <given-names>TK</given-names></string-name>, <string-name><surname>Vinh</surname> <given-names>LS</given-names></string-name></person-group> (<year>2020</year>) <article-title>FLAVI: An amino acid substitution model for flaviviruses</article-title>. <source>J Mol Evol</source> In press</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemant</surname> <given-names>J</given-names></string-name>, <string-name><surname>Le Sueur</surname> <given-names>C</given-names></string-name>, <string-name><surname>Manojlović</surname> <given-names>V</given-names></string-name>, <string-name><surname>Noble</surname> <given-names>R</given-names></string-name></person-group> (<year>2022</year>) <article-title>Robust, Universal Tree Balance Indices</article-title>. <source>Systematic Biology</source> <volume>71</volume>: <fpage>1210</fpage>–<lpage>1224</lpage></mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lemmon</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Moriarty</surname> <given-names>EC</given-names></string-name></person-group> (<year>2004</year>) <article-title>The importance of proper model assumption in bayesian phylogenetics</article-title>. <source>Syst Biol</source> <volume>53</volume>: <fpage>265</fpage>–<lpage>277</lpage></mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liberles</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Teichmann</surname> <given-names>SA</given-names></string-name>, <string-name><surname>Bahar</surname> <given-names>I</given-names></string-name>, <string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name>, <string-name><surname>Bloom</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bornberg-Bauer</surname> <given-names>E</given-names></string-name>, <string-name><surname>Colwell</surname> <given-names>LJ</given-names></string-name>, <string-name><surname>de Koning</surname> <given-names>AP</given-names></string-name>, <string-name><surname>Dokholyan</surname> <given-names>NV</given-names></string-name>, <string-name><surname>Echave</surname> <given-names>J</given-names></string-name> <etal>et al.</etal></person-group> (<year>2012</year>) <article-title>The interface of protein structure, protein biophysics, and molecular evolution</article-title>. <source>Protein Sci</source> <volume>21</volume>: <fpage>769</fpage>–<lpage>785</lpage></mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lind</surname> <given-names>PA</given-names></string-name>, <string-name><surname>Libby</surname> <given-names>E</given-names></string-name>, <string-name><surname>Herzog</surname> <given-names>J</given-names></string-name>, <string-name><surname>Rainey</surname> <given-names>PB</given-names></string-name></person-group> (<year>2019</year>) <article-title>Predicting mutational routes to new adaptive phenotypes</article-title>. <source>eLife</source> <elocation-id>8</elocation-id></mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luksza</surname> <given-names>M</given-names></string-name>, <string-name><surname>Lassig</surname> <given-names>M</given-names></string-name></person-group> (<year>2014</year>) <article-title>A predictive fitness model for influenza</article-title>. <source>Nature</source> <volume>507</volume>: <fpage>57</fpage>–<lpage>61</lpage></mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Malcom</surname> <given-names>BA</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>KP</given-names></string-name>, <string-name><surname>Matthews</surname> <given-names>BW</given-names></string-name>, <string-name><surname>Kirsch</surname> <given-names>JF</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>AC</given-names></string-name></person-group> (<year>1990</year>) <article-title>Ancestral lysozymes reconstructed, neutrality tested, and thermostability linked to hydrocarbon packing</article-title>. <source>Nature</source> <volume>345</volume>: <fpage>86</fpage>–<lpage>89</lpage></mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mendez</surname> <given-names>R</given-names></string-name>, <string-name><surname>Fritsche</surname> <given-names>M</given-names></string-name>, <string-name><surname>Porto</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name></person-group> (<year>2010</year>) <article-title>Mutation bias favors protein folding stability in the evolution of small populations</article-title>. <source>PLoS Comput Biol</source> <volume>6</volume>: <fpage>e1000767</fpage></mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Minning</surname> <given-names>J</given-names></string-name>, <string-name><surname>Porto</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name></person-group> (<year>2013</year>) <article-title>Detecting selection for negative design in proteins through an improved model of the misfolded state</article-title>. <source>Proteins</source> <volume>81</volume>: <fpage>1102</fpage>–<lpage>1112</lpage></mixed-citation></ref>
<ref id="c70"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morcos</surname> <given-names>F</given-names></string-name>, <string-name><surname>Pagnani</surname> <given-names>A</given-names></string-name>, <string-name><surname>Lunt</surname> <given-names>B</given-names></string-name>, <string-name><surname>Bertolino</surname> <given-names>A</given-names></string-name>, <string-name><surname>Marks</surname> <given-names>DS</given-names></string-name>, <string-name><surname>Sander</surname> <given-names>C</given-names></string-name>, <string-name><surname>Zecchina</surname> <given-names>R</given-names></string-name>, <string-name><surname>Onuchic</surname> <given-names>JN</given-names></string-name>, <string-name><surname>Hwa</surname> <given-names>T</given-names></string-name>, <string-name><surname>Weigt</surname> <given-names>M</given-names></string-name></person-group> (<year>2011</year>) <article-title>Direct-coupling analysis of residue coevolution captures native contacts across many protein families</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>: <fpage>E1293</fpage>–<lpage>1301</lpage></mixed-citation></ref>
<ref id="c71"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moreira</surname> <given-names>F</given-names></string-name>, <string-name><surname>Arenas</surname> <given-names>M</given-names></string-name>, <string-name><surname>Videira</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pereira</surname> <given-names>F</given-names></string-name></person-group> (<year>2023</year>) <article-title>Evolution of TOP1 and TOP1MT Topoisomerases in Chordata</article-title>. <source>Journal of Molecular Evolution</source> <volume>91</volume>: <fpage>192</fpage>–<lpage>203</lpage></mixed-citation></ref>
<ref id="c72"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morris</surname> <given-names>DH</given-names></string-name>, <string-name><surname>Gostic</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Pompei</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bedford</surname> <given-names>T</given-names></string-name>, <string-name><surname>Łuksza</surname> <given-names>M</given-names></string-name>, <string-name><surname>Neher</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Grenfell</surname> <given-names>BT</given-names></string-name>, <string-name><surname>Lässig</surname> <given-names>M</given-names></string-name>, <string-name><surname>McCauley</surname> <given-names>JW</given-names></string-name></person-group> (<year>2018</year>) <article-title>Predictive Modeling of Influenza Shows the Promise of Applied Evolutionary Biology</article-title>. <source>Trends Microbiol</source> <volume>26</volume>: <fpage>102</fpage>–<lpage>118</lpage></mixed-citation></ref>
<ref id="c73"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Munck</surname> <given-names>C</given-names></string-name>, <string-name><surname>Gumpert</surname> <given-names>HK</given-names></string-name>, <string-name><surname>Wallin</surname> <given-names>AI</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>HH</given-names></string-name>, <string-name><surname>Sommer</surname> <given-names>MO</given-names></string-name></person-group> (<year>2014</year>) <article-title>Prediction of resistance development against drug combinations by collateral responses to component drugs</article-title>. <source>Science translational medicine</source> <volume>6</volume>: <elocation-id>262ra156</elocation-id></mixed-citation></ref>
<ref id="c74"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Navascues</surname> <given-names>M</given-names></string-name>, <string-name><surname>Depaulis</surname> <given-names>F</given-names></string-name>, <string-name><surname>Emerson</surname> <given-names>BC</given-names></string-name></person-group> (<year>2010</year>) <article-title>Combining contemporary and ancient DNA in population genetic and phylogeographical studies</article-title>. <source>Mol Ecol Resour</source> <volume>10</volume>: <fpage>760</fpage>–<lpage>772</lpage></mixed-citation></ref>
<ref id="c75"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Neher</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Hallatschek</surname> <given-names>O</given-names></string-name></person-group> (<year>2013</year>) <article-title>Genealogies of rapidly adapting populations</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>110</volume>: <fpage>437</fpage>–<lpage>442</lpage></mixed-citation></ref>
<ref id="c76"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Neher</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Russell</surname> <given-names>CA</given-names></string-name>, <string-name><surname>Shraiman</surname> <given-names>BI</given-names></string-name></person-group> (<year>2014</year>) <article-title>Predicting evolution from the shape of genealogical trees</article-title>. <source>eLife</source> <elocation-id>3</elocation-id></mixed-citation></ref>
<ref id="c77"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nickle</surname> <given-names>DC</given-names></string-name>, <string-name><surname>Heath</surname> <given-names>L</given-names></string-name>, <string-name><surname>Jensen</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Gilbert</surname> <given-names>PB</given-names></string-name>, <string-name><surname>Mullins</surname> <given-names>JI</given-names></string-name>, <string-name><surname>Kosakovsky Pond</surname> <given-names>SL</given-names></string-name></person-group> (<year>2007</year>) <article-title>HIV-specific probabilistic models of protein evolution</article-title>. <source>PLoS One</source> <volume>2</volume>: <fpage>e503</fpage></mixed-citation></ref>
<ref id="c78"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Papkou</surname> <given-names>A</given-names></string-name>, <string-name><surname>Garcia-Pastor</surname> <given-names>L</given-names></string-name>, <string-name><surname>Escudero</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Wagner</surname> <given-names>A</given-names></string-name></person-group> (<year>2023</year>) <article-title>A rugged yet easily navigable fitness landscape</article-title>. <source>Science</source> <volume>382</volume>: <elocation-id>eadh3860</elocation-id></mixed-citation></ref>
<ref id="c79"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parisi</surname> <given-names>G</given-names></string-name>, <string-name><surname>Echave</surname> <given-names>J</given-names></string-name></person-group> (<year>2001</year>) <article-title>Structural constraints and emergence of sequence patterns in protein evolution</article-title>. <source>Mol Biol Evol</source> <volume>18</volume>: <fpage>750</fpage>–<lpage>756</lpage></mixed-citation></ref>
<ref id="c80"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Parisi</surname> <given-names>G</given-names></string-name>, <string-name><surname>Echave</surname> <given-names>J</given-names></string-name></person-group> (<year>2005</year>) <article-title>Generality of the structurally constrained protein evolution model: assessment on representatives of the four main fold classes</article-title>. <source>Gene</source> <volume>345</volume>: <fpage>45</fpage>–<lpage>53</lpage></mixed-citation></ref>
<ref id="c81"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pascual-Garcia</surname> <given-names>A</given-names></string-name>, <string-name><surname>Abia</surname> <given-names>D</given-names></string-name>, <string-name><surname>Mendez</surname> <given-names>R</given-names></string-name>, <string-name><surname>Nido</surname> <given-names>GS</given-names></string-name>, <string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name></person-group> (<year>2010</year>) <article-title>Quantifying the evolutionary divergence of protein structures: the role of function change and function conservation</article-title>. <source>Proteins</source> <volume>78</volume>: <fpage>181</fpage>–<lpage>196</lpage></mixed-citation></ref>
<ref id="c82"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pascual-Garcia</surname> <given-names>A</given-names></string-name>, <string-name><surname>Arenas</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bastolla</surname> <given-names>U</given-names></string-name></person-group> (<year>2019</year>) <article-title>The Molecular Clock in the Evolution of Protein Structures</article-title>. <source>Syst Biol</source> <volume>68</volume>: <fpage>987</fpage>–<lpage>1002</lpage></mixed-citation></ref>
<ref id="c83"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poon</surname> <given-names>AF</given-names></string-name>, <string-name><surname>Kosakovsky Pond</surname> <given-names>SL</given-names></string-name>, <string-name><surname>Richman</surname> <given-names>DD</given-names></string-name>, <string-name><surname>Frost</surname> <given-names>SD</given-names></string-name></person-group> (<year>2007</year>) <article-title>Mapping protease inhibitor resistance to human immunodeficiency virus type 1 sequence polymorphisms within patients</article-title>. <source>J Virol</source> <volume>81</volume>: <fpage>13598</fpage>–<lpage>13607</lpage></mixed-citation></ref>
<ref id="c84"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rodrigue</surname> <given-names>N</given-names></string-name>, <string-name><surname>Lartillot</surname> <given-names>N</given-names></string-name>, <string-name><surname>Bryant</surname> <given-names>D</given-names></string-name>, <string-name><surname>Philippe</surname> <given-names>H</given-names></string-name></person-group> (<year>2005</year>) <article-title>Site interdependence attributed to tertiary structure in amino acid sequence evolution</article-title>. <source>Gene</source> <volume>347</volume>: <fpage>207</fpage>–<lpage>217</lpage></mixed-citation></ref>
<ref id="c85"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rodrigues</surname> <given-names>JV</given-names></string-name>, <string-name><surname>Bershtein</surname> <given-names>S</given-names></string-name>, <string-name><surname>Li</surname> <given-names>A</given-names></string-name>, <string-name><surname>Lozovsky</surname> <given-names>ER</given-names></string-name>, <string-name><surname>Hartl</surname> <given-names>DL</given-names></string-name>, <string-name><surname>Shakhnovich</surname> <given-names>EI</given-names></string-name></person-group> (<year>2016</year>) <article-title>Biophysical principles predict fitness landscapes of drug resistance</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>113</volume>: <fpage>E1470</fpage>–<lpage>E1478</lpage></mixed-citation></ref>
<ref id="c86"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rubin</surname> <given-names>IN</given-names></string-name>, <string-name><surname>Ispolatov</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Doebeli</surname> <given-names>M</given-names></string-name></person-group> (<year>2023</year>) <article-title>Adaptive diversification and niche packing on rugged fitness landscapes</article-title>. <source>J Theor Biol</source> <volume>562</volume>: <fpage>111421</fpage></mixed-citation></ref>
<ref id="c87"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ruiz-Gonzalez</surname> <given-names>MX</given-names></string-name>, <string-name><surname>Fares</surname> <given-names>MA</given-names></string-name></person-group> (<year>2013</year>) <article-title>Coevolution analyses illuminate the dependencies between amino acid sites in the chaperonin system GroES-L</article-title>. <source>BMC Evol Biol</source> <volume>13</volume>: <fpage>156</fpage></mixed-citation></ref>
<ref id="c88"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sali</surname> <given-names>A</given-names></string-name>, <string-name><surname>Blundell</surname> <given-names>TL</given-names></string-name></person-group> (<year>1993</year>) <article-title>Comparative protein modelling by satisfaction of spatial restraints</article-title>. <source>J Mol Biol</source> <volume>234</volume>: <fpage>779</fpage>–<lpage>815</lpage></mixed-citation></ref>
<ref id="c89"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Santos-Pereira</surname> <given-names>A</given-names></string-name>, <string-name><surname>Triunfante</surname> <given-names>V</given-names></string-name>, <string-name><surname>Araujo</surname> <given-names>PMM</given-names></string-name>, <string-name><surname>Martins</surname> <given-names>J</given-names></string-name>, <string-name><surname>Soares</surname> <given-names>H</given-names></string-name>, <string-name><surname>Poveda</surname> <given-names>E</given-names></string-name>, <string-name><surname>Souto</surname> <given-names>B</given-names></string-name>, <string-name><surname>Osorio</surname> <given-names>NS</given-names></string-name></person-group> (<year>2021</year>) <article-title>Nationwide Study of Drug Resistance Mutations in HIV-1 Infected Individuals under Antiretroviral Therapy in Brazil</article-title>. <source>Int J Mol Sci</source> <fpage>22</fpage></mixed-citation></ref>
<ref id="c90"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Souto</surname> <given-names>B</given-names></string-name>, <string-name><surname>Triunfante</surname> <given-names>V</given-names></string-name>, <string-name><surname>Santos-Pereira</surname> <given-names>A</given-names></string-name>, <string-name><surname>Martins</surname> <given-names>J</given-names></string-name>, <string-name><surname>Araujo</surname> <given-names>PMM</given-names></string-name>, <string-name><surname>Osorio</surname> <given-names>NS</given-names></string-name></person-group> (<year>2021</year>) <article-title>Evolutionary dynamics of HIV-1 subtype C in Brazil</article-title>. <source>Sci Rep</source> <volume>11</volume>: <fpage>23060</fpage></mixed-citation></ref>
<ref id="c91"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spielman</surname> <given-names>SJ</given-names></string-name></person-group> (<year>2020</year>) <article-title>Relative Model Fit Does Not Predict Topological Accuracy in Single-Gene Protein Phylogenetics</article-title>. <source>Molecular Biology and Evolution</source> <volume>37</volume>: <fpage>2110</fpage>–<lpage>2123</lpage></mixed-citation></ref>
<ref id="c92"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stackhouse</surname> <given-names>J</given-names></string-name>, <string-name><surname>Presnell</surname> <given-names>SR</given-names></string-name>, <string-name><surname>McGeehan</surname> <given-names>GM</given-names></string-name>, <string-name><surname>Nambiar</surname> <given-names>KP</given-names></string-name>, <string-name><surname>Benner</surname> <given-names>SA</given-names></string-name></person-group> (<year>1990</year>) <article-title>The ribonuclease from an extinct bovid ruminant</article-title>. <source>FEBS Lett</source> <volume>262</volume>: <fpage>104</fpage>–<lpage>106</lpage></mixed-citation></ref>
<ref id="c93"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stadler</surname> <given-names>T</given-names></string-name></person-group> (<year>2010</year>) <article-title>Sampling-through-time in birth–death trees</article-title>. <source>Journal of Theoretical Biology</source> <volume>267</volume>: <fpage>396</fpage>–<lpage>404</lpage></mixed-citation></ref>
<ref id="c94"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stadler</surname> <given-names>T</given-names></string-name></person-group> (<year>2011</year>) <article-title>Simulating trees with a fixed number of extant species</article-title>. <source>Syst Biol</source> <volume>60</volume>: <fpage>676</fpage>–<lpage>684</lpage></mixed-citation></ref>
<ref id="c95"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thadani</surname> <given-names>NN</given-names></string-name>, <string-name><surname>Gurev</surname> <given-names>S</given-names></string-name>, <string-name><surname>Notin</surname> <given-names>P</given-names></string-name>, <string-name><surname>Youssef</surname> <given-names>N</given-names></string-name>, <string-name><surname>Rollins</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Ritter</surname> <given-names>D</given-names></string-name>, <string-name><surname>Sander</surname> <given-names>C</given-names></string-name>, <string-name><surname>Gal</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Marks</surname> <given-names>DS</given-names></string-name></person-group> (<year>2023</year>) <article-title>Learning from prepandemic data to forecast viral escape</article-title>. <source>Nature</source> <volume>622</volume>: <fpage>818</fpage>–<lpage>825</lpage></mixed-citation></ref>
<ref id="c96"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Thornton</surname> <given-names>JW</given-names></string-name>, <string-name><surname>Need</surname> <given-names>E</given-names></string-name>, <string-name><surname>Crews</surname> <given-names>D</given-names></string-name></person-group> (<year>2003</year>) <article-title>Resurrecting the ancestral steroid receptor: ancient origin of estrogen signaling</article-title>. <source>Science</source> <volume>301</volume>: <fpage>1714</fpage>–<lpage>1717</lpage></mixed-citation></ref>
<ref id="c97"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ugalde</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Chang</surname> <given-names>BSW</given-names></string-name>, <string-name><surname>Matz</surname> <given-names>MV</given-names></string-name></person-group> (<year>2004</year>) <article-title>Evolution of Coral Pigments Recreated</article-title>. <source>Science</source> <volume>305</volume>: <fpage>1433</fpage>–<lpage>1433</lpage></mixed-citation></ref>
<ref id="c98"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Van Cleve</surname> <given-names>J</given-names></string-name>, <string-name><surname>Weissman</surname> <given-names>DB</given-names></string-name></person-group> (<year>2015</year>) <article-title>Measuring ruggedness in fitness landscapes</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>112</volume>: <fpage>7345</fpage>–<lpage>7346</lpage></mixed-citation></ref>
<ref id="c99"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watabe</surname> <given-names>T</given-names></string-name>, <string-name><surname>Kishino</surname> <given-names>H</given-names></string-name></person-group> (<year>2010</year>) <article-title>Structural considerations in the fitness landscape of a virus</article-title>. <source>Mol Biol Evol</source> <volume>27</volume>: <fpage>1782</fpage>–<lpage>1791</lpage></mixed-citation></ref>
<ref id="c100"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wiuf</surname> <given-names>C</given-names></string-name>, <string-name><surname>Posada</surname> <given-names>D</given-names></string-name></person-group> (<year>2003</year>) <article-title>A coalescent model of recombination hotspots</article-title>. <source>Genetics</source> <volume>164</volume>: <fpage>407</fpage>–<lpage>417</lpage></mixed-citation></ref>
<ref id="c101"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wortel</surname> <given-names>MT</given-names></string-name>, <string-name><surname>Agashe</surname> <given-names>D</given-names></string-name>, <string-name><surname>Bailey</surname> <given-names>SF</given-names></string-name>, <string-name><surname>Bank</surname> <given-names>C</given-names></string-name>, <string-name><surname>Bisschop</surname> <given-names>K</given-names></string-name>, <string-name><surname>Blankers</surname> <given-names>T</given-names></string-name>, <string-name><surname>Cairns</surname> <given-names>J</given-names></string-name>, <string-name><surname>Colizzi</surname> <given-names>ES</given-names></string-name>, <string-name><surname>Cusseddu</surname> <given-names>D</given-names></string-name>, <string-name><surname>Desai</surname> <given-names>MM</given-names></string-name> <etal>et al.</etal></person-group> (<year>2023</year>) <article-title>Towards evolutionary predictions: Current promises and challenges</article-title>. <source>Evolutionary Applications</source> <volume>16</volume>: <fpage>3</fpage>–<lpage>21</lpage></mixed-citation></ref>
<ref id="c102"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname> <given-names>S</given-names></string-name></person-group> (<year>1931</year>) <article-title>Evolution in Mendelian populations</article-title>. <source>Genetics</source> <volume>16</volume>: <fpage>97</fpage>–<lpage>159</lpage></mixed-citation></ref>
<ref id="c103"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wylie</surname> <given-names>CS</given-names></string-name>, <string-name><surname>Shakhnovich</surname> <given-names>EI</given-names></string-name></person-group> (<year>2011</year>) <article-title>A biophysical protein folding model accounts for most mutational fitness effects in viruses</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>108</volume>: <fpage>9916</fpage>–<lpage>9921</lpage></mixed-citation></ref>
<ref id="c104"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname> <given-names>Z</given-names></string-name></person-group> (<year>1996</year>) <article-title>Among-site rate variation and its impact on phylogenetic analysis</article-title>. <source>Trends Ecol Evol</source> <volume>11</volume>: <fpage>367</fpage>–<lpage>372</lpage></mixed-citation></ref>
<ref id="c105"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Yang</surname> <given-names>Z</given-names></string-name></person-group> (<year>2006</year>) <source>Computational Molecular Evolution</source>. <publisher-name>Oxford University Press</publisher-name>, <publisher-loc>Oxford, England</publisher-loc>.</mixed-citation></ref>
<ref id="c106"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Goldman</surname> <given-names>N</given-names></string-name>, <string-name><surname>Friday</surname> <given-names>A</given-names></string-name></person-group> (<year>1994</year>) <article-title>Comparison of models for nucleotide substitution used in maximum-likelihood phylogenetic estimation</article-title>. <source>Molecular Biology and Evolution</source> <volume>11</volume>: <fpage>316</fpage>–<lpage>324</lpage></mixed-citation></ref>
<ref id="c107"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yoshida</surname> <given-names>K</given-names></string-name>, <string-name><surname>Hata</surname> <given-names>K</given-names></string-name>, <string-name><surname>Kawakami</surname> <given-names>K</given-names></string-name>, <string-name><surname>Hiradate</surname> <given-names>S</given-names></string-name>, <string-name><surname>Osawa</surname> <given-names>T</given-names></string-name>, <string-name><surname>Kachi</surname> <given-names>N</given-names></string-name></person-group> (<year>2023</year>) <article-title>Predicting ecosystem changes by a new model of ecosystem evolution</article-title>. <source>Scientific Reports</source> <volume>13</volume>: <fpage>15353</fpage></mixed-citation></ref>
<ref id="c108"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zeldovich</surname> <given-names>KB</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>P</given-names></string-name>, <string-name><surname>Shakhnovich</surname> <given-names>EI</given-names></string-name></person-group> (<year>2007</year>) <article-title>Protein stability imposes limits on organism complexity and speed of molecular evolution</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>104</volume>: <fpage>16152</fpage>–<lpage>16157</lpage></mixed-citation></ref>
<ref id="c109"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Nei</surname> <given-names>M</given-names></string-name></person-group> (<year>1997</year>) <article-title>Accuracies of ancestral amino acid sequences inferred by the parsimony, likelihood, and distance methods</article-title>. <source>J Mol Evol</source> <volume>44</volume> <issue>Suppl 1</issue>: <fpage>S139</fpage>–<lpage>146</lpage></mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.106365.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Bitbol</surname>
<given-names>Anne-Florence</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Ecole Polytechnique Federale de Lausanne (EPFL)</institution>
</institution-wrap>
<city>Lausanne</city>
<country>Switzerland</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Useful</kwd>
</kwd-group>
</front-stub>
<body>
<p>This manuscript introduces a <bold>useful</bold> protein-stability-based fitness model for simulating protein evolution and unifying non-neutral models of molecular evolution with phylogenetic models. The model is applied to four viral proteins that are of structural and functional importance. The justification of some hypotheses regarding fitness is <bold>incomplete</bold>, as well as the evidence for the model's predictive power, since it shows little improvement over neutral models in predicting protein evolution.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.106365.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>Ferreiro et al. present a method to simulate protein sequence evolution under a birth-death model where sequence evolution is constrained by structural constraints on protein stability. The authors then use this model to explore the predictability of sequence evolution in several viral structural proteins. In principle, this work is of great interest to molecular evolution and phylodynamics, which have struggled to couple non-neutral models of sequence evolution to phylodynamic models like birth-death. Unfortunately, though, the model shows little improvement over neutral models in predicting protein evolution, and this ultimately appears to be due to fundamental conceptual problems with how fitness is modeled and linked to the phylodynamic birth-death model.</p>
<p>Major concerns:</p>
<p>(1) Fitness model: All lineages have the same growth rate r = b-d because the authors assume b+d=1. But under a birth-death model, the growth r is equivalent to fitness, so this is essentially assuming all lineages have the same absolute fitness since increases in reproductive fitness (b) will simply trade off with decreases in survival (d). Thus, even if the SCS model constrains sequence evolution, the birth-death model does not really allow for non-neutral evolution such that mutations can feed back and alter the structure of the phylogeny.</p>
<p>(2) Predictive performance: Similar performance in predicting amino acid frequencies is observed under both the SCS model and the neutral model. I suspect that this rather disappointing result owes to the fact that the absolute fitness of different viral variants could not actually change during the simulations (see comment #1).</p>
<p>(3) Model assessment: It would be interesting to know how much the predictions were informed by the structurally constrained sequence evolution model versus the birth-death model. To explore this, the authors could consider three different models: 1) neutral, 2) SCS, and 3) SCS + BD. Simulations under the SCS model could be performed by simulating molecular evolution along just one hypothetical lineage. Seeing if the SCS + BD model improves over the SCS model alone would be another way of testing whether mutations could actually impact the evolutionary dynamics of lineages in the phylogeny.</p>
<p>(4) Background fitness effects: The model ignores background genetic variation in fitness. I think this is particularly important as the fitness effects of mutations in any one protein may be overshadowed by the fitness effects of mutations elsewhere in the genome. The model also ignores background changes in fitness due to the environment, but I acknowledge that might be beyond the scope of the current work.</p>
<p>(5) In contrast to the model explored here, recent work on multi-type birth-death processes has considered models where lineages have type-specific birth and/or death rates and therefore also type-specific growth rates and fitness (Stadler and Bonhoeffer, 2013; Kunhert et al., 2017; Barido-Sottani, 2023). Rasmussen &amp; Stadler (eLife, 2019) even consider a multi-type birth-death model where the fitness effects of multiple mutations in a protein or viral genome collectively determine the overall fitness of a lineage. The key difference with this work presented here is that these models allow lineages to have different growth rates and fitness, so these models truly allow for non-neutral evolutionary dynamics. It would appear the authors might need to adopt a similar approach to successfully predict protein evolution.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.106365.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this study, &quot;Forecasting protein evolution by integrating birth-death population models with structurally constrained substitution models&quot;, David Ferreiro and co-authors present a forward-in-time evolutionary simulation framework that integrates a birth-death population model with a fitness function based on protein folding stability. By incorporating structurally constrained substitution models and estimating fitness from ΔG values using homology-modeled structures, the authors aim to capture biophysically realistic evolutionary dynamics. The approach is implemented in a new version of their open-source software, ProteinEvolver2, and is applied to four viral proteins from HIV-1 and SARS-CoV-2.</p>
<p>Overall, the study presents a compelling rationale for using folding stability as a constraint in evolutionary simulations and offers a novel framework and software to explore such dynamics. While the results are promising, particularly for predicting biophysical properties, the current analysis provides only partial evidence for true evolutionary forecasting, especially at the sequence level. The work offers a meaningful conceptual advance and a useful simulation tool, and sets the stage for more extensive validation in future studies.</p>
<p>Strengths:</p>
<p>The results demonstrate that fitness constraints based on protein stability can prevent the emergence of unrealistic, destabilized variants - a limitation of traditional, neutral substitution models. In particular, the predicted folding stabilities of simulated protein variants closely match those observed in real variants, suggesting that the model captures relevant biophysical constraints.</p>
<p>Weaknesses:</p>
<p>The predictive scope of the method remains limited. While the model effectively preserves folding stability, its ability to forecast specific sequence content is not well supported. Only one dataset (HIV-1 MA) is evaluated for sequence-level divergence using KL divergence; this analysis is absent for the other proteins. The authors use a consensus Omicron sequence as a representative endpoint for SARS-CoV-2, which overlooks the rich longitudinal sequence data available from GISAID. The use of just one consensus from a single time point is not fully justified, given the extensive temporal and geographical sampling available. Extending the analysis to include multiple timepoints, particularly for SARS-CoV-2, would strengthen the predictive claims. Similarly, applying the model to other well-sampled viral proteins, such as those from influenza or RSV, would broaden its relevance and test its generalizability.</p>
<p>It would also be informative to include a retrospective analysis of the evolution of protein stability along known historical trajectories. This would allow the authors to assess whether folding stability is indeed preserved in real-world evolution, as assumed in their model.</p>
<p>Finally, a discussion on the impact of structural templates - and whether the fixed template remains valid across divergent sequences - would be valuable. Addressing the possibility of structural remodeling or template switching during evolution would improve confidence in the model's applicability to more divergent evolutionary scenarios.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.106365.1.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ferreiro</surname>
<given-names>David</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>González-Vázquez</surname>
<given-names>Luis Daniel</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Prado-Comesaña</surname>
<given-names>Ana</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Arenas</surname>
<given-names>Miguel</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0516-2717</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<disp-quote content-type="editor-comment">
<p><bold>eLife Assessment</bold></p>
<p>This manuscript introduces a useful protein-stability-based fitness model for simulating protein evolution and unifying non-neutral models of molecular evolution with phylogenetic models. The model is applied to four viral proteins that are of structural and functional importance. The justification of some hypotheses regarding fitness is incomplete, as well as the evidence for the model's predictive power, since it shows little improvement over neutral models in predicting protein evolution.</p>
</disp-quote>
<p>We thank for the constructive comments that helped improve our study. Regarding the comment about justification of fitness, we will include in the revised manuscript additional information to support the relevance of modeling protein evolution accounting for protein folding stability. We agree that increasing the parameterization of the developed birth-death model is interesting, if it does not lead to overfitting. The model presented considers the fitness of protein variants to determine their reproductive success through the corresponding birth and death rates, varying among lineages, and it is biologically meaningful and technically correct (Harmon 2019). Following a suggestion of the first reviewer to allow variation of the global birth-death rate among lineages, we will additionally incorporate this aspect into the model and evaluate its performance with the data for the evaluation of the models. The integration of structurally constrained substitution models of protein evolution, as Markov models, into the birth-death process was made following standards approaches of molecular evolution in population genetics (Yang 2006; Carvajal-Rodriguez 2010; Arenas 2012; Hoban, et al. 2012) and we will provide more information about it in the revised manuscript. Regarding the predictive power, our study showed good accuracy in predicting the real folding stability of forecasted protein variants. On the other hand, predicting the exact sequences proved to be more challenging, indicating needs in the field of substitution models of molecular evolution. Altogether, we believe our findings provide a significant contribution to the field, as accurately forecasting the folding stability of future real proteins is fundamental for predicting their protein function and enabling a variety of applications. Additionally, we implemented the models into a freely available computer framework, with detailed documentation and diverse practical examples.</p>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #1 (Public review):</bold></p>
<p>Summary:</p>
<p>Ferreiro et al. present a method to simulate protein sequence evolution under a birth-death model where sequence evolution is constrained by structural constraints on protein stability. The authors then use this model to explore the predictability of sequence evolution in several viral structural proteins. In principle, this work is of great interest to molecular evolution and phylodynamics, which have struggled to couple non-neutral models of sequence evolution to phylodynamic models like birth-death. Unfortunately, though, the model shows little improvement over neutral models in predicting protein evolution, and this ultimately appears to be due to fundamental conceptual problems with how fitness is modeled and linked to the phylodynamic birth-death model.</p>
</disp-quote>
<p>We thank the reviewer for the positive comments about our work.</p>
<p>Regarding predictive power, the study showed a good accuracy in predicting the real folding stability of forecasted protein variants under a selection model, but not under a neutral model. However, predicting the exact sequences was more challenging. For example, amino acids with similar physicochemical properties can result in similar folding stability while differ in the specific sequence, more accurate substitution models of molecular evolution are required in the field. We consider that forecasting the folding stability of future real proteins is an important advancement in forecasting protein evolution, given the essential role of folding stability in protein function and its variety of applications. Regarding the conceptual concerns related to fitness modeling, we clarify this issue in detail in our responses to the specific comments below.</p>
<disp-quote content-type="editor-comment">
<p>Major concerns:</p>
<p>(1) Fitness model: All lineages have the same growth rate r = b-d because the authors assume b+d=1. But under a birth-death model, the growth r is equivalent to fitness, so this is essentially assuming all lineages have the same absolute fitness since increases in reproductive fitness (b) will simply trade off with decreases in survival (d). Thus, even if the SCS model constrains sequence evolution, the birth-death model does not really allow for non-neutral evolution such that mutations can feed back and alter the structure of the phylogeny.</p>
</disp-quote>
<p>We thank the reviewer for this comment that aims to improve the realism of our model. In the model presented (but see later for another model derived from the proposal of the reviewer and that we are now implementing into the framework and applying to the data used for the evaluation of the models), the fitness predicted from a protein variant is used to obtain the corresponding birth rate of that variant. In this way, protein variants with high fitness have high birth rates leading to overall more birth events, while protein variants with low fitness have low birth rates resulting in overall more extinction events, which has biological meaning for the study system. The statement “All lineages have the same growth rate r = b-d” in our model is incorrect because, in our model, b and d can vary among lineages according to the fitness. For example, a lineage might have b=0.9, d=0.1, r=0.8, while another lineage could have b=0.6, d=0.4, r=0.2. Indeed, the statement “this is essentially assuming all lineages have the same absolute fitness” is incorrect. Clearly, assuming that all lineages have the same fitness would not make sense, in that situation the folding stability of the forecasted protein variants would be similar under any model, which is not the case as shown in the results. In our model, the fitness affects the reproductive success, where protein variants with a high fitness have higher birth rates leading to more birth events, while those with lower fitness have higher death rates leading to more extinction events. This parameterization is meaningful for protein evolution because the fitness of a protein variant can affect its survival (birth or extinction) without necessarily affecting its rate of evolution. While faster growth rate can sometimes be associated with higher fitness, a variant with high fitness does not necessarily accumulate substitutions at a faster rate. Regarding the phylogenetic structure, the model presented considers variable birth and death events across different lineages according to the fitness of the corresponding protein variants, and this alters the derived phylogeny (i.e., protein variants selected against can go extinct while others with high fitness can produce descendants). We are not sure about the meaning of the term “mutations can feed back” in the context of our system. Note that we use Markov models of evolution, which are well-stablished in the field (despite their limitations), and substitutions are fixed mutations, which still could be reverted later if selected by the substitution model (Yang 2006). Altogether, we find that the presented birth-death model is technically correct and appropriate for modeling our biological system. Its integration with structurally constrained substitution (SCS) models of protein evolution, as Markov models, is correct following general approaches of molecular evolution in population genetics (Yang 2006; Carvajal-Rodriguez 2010; Arenas 2012; Hoban, et al. 2012). We will provide a more detailed description of the model in the revised manuscript.</p>
<p>Apart from these clarifications about the birth-death model used, we understand the point of the reviewer and following the suggestion we are now incorporating an additional birth-death model that accounts for variable global birth-death rate among lineages. Specifically, we are following the model proposed by Neher et al (2014), where the death rate is considered as 1 and the birth rate is modeled as 1 + fitness. In this model, the global birth-death rate varies among lineages. We are now implementing this model into the computer framework and applying it to the data used for the evaluation of the models. Preliminary results, which will be finally presented in the revised manuscript, indicate that this model yields similar predictive accuracy compared to the previous birth-death model. If this is confirmed, accounting for variability in the global birth-death rate does not appear to play a major role in the studied systems of protein evolution. We will present this additional birth-death model and its results in the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p>(2) Predictive performance: Similar performance in predicting amino acid frequencies is observed under both the SCS model and the neutral model. I suspect that this rather disappointing result owes to the fact that the absolute fitness of different viral variants could not actually change during the simulations (see comment #1).</p>
</disp-quote>
<p>The study shows similar performance in predicting the sequences of the forecasted proteins under both the SCS model and the neutral model, but shows differences in predicting the folding stability of the forecasted proteins between these models. Indeed, as explained in the previous answer, the birth-death model accounts for variation in fitness among lineages, leading to differences among lineages in reproductive success. The new birth-death model that we are now implementing, which incorporates variation of the global birth-death rate among lineages, is producing similar preliminary results. In addition to these considerations, it is known that SCS models applied to phylogenetics (such as ancestral molecular reconstruction) can model protein evolution with high accuracy in terms of folding stability. However, inferring sequences (i.e., ancestral sequences) is considerably more challenging even for ancestral molecular reconstruction (Arenas, et al. 2017; Arenas and Bastolla 2020). The observed sequence diversity is much greater than the observed structural diversity (Illergard, et al. 2009; Pascual-Garcia, et al. 2010), and substitutions among amino acids with similar physicochemical properties can result in protein variants with similar folding stability but different specific amino acid sequences; further work is demanded in the field of substitution models of molecular evolution. We will expand the discussion of this aspect in the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p>(3) Model assessment: It would be interesting to know how much the predictions were informed by the structurally constrained sequence evolution model versus the birth-death model. To explore this, the authors could consider three different models: 1) neutral, 2) SCS, and 3) SCS + BD. Simulations under the SCS model could be performed by simulating molecular evolution along just one hypothetical lineage. Seeing if the SCS + BD model improves over the SCS model alone would be another way of testing whether mutations could actually impact the evolutionary dynamics of lineages in the phylogeny.</p>
</disp-quote>
<p>In the present study, we compare the neutral model + birth-death (BD) with the SCS model + BD. Markov substitution models Q are applied upon an evolutionary time (i.e., branch length, t) and this allows to determine the probability of substitution events during that time period [P(t) = exp (Qt)]. This approach is traditionally used in phylogenetics to model the incorporation of substitutions over time. Therefore, to compare the neutral and SCS models, an evolutionary time is required, in this case it is provided by the birth-death process. The suggestions 1) and 2) cannot be compared without an underlined evolutionary history. However, comparisons in terms of likelihood, and other aspects, between models that ignore the protein structure and the implemented SCS models are already available in our previous studies based on coalescent simulations or given phylogenetic trees (Arenas, et al. 2013; Arenas, et al. 2015). There, SCS models produced proteins with more realistic folding stability than models that ignore evolutionary constraints from the protein structure, and those findings are consistent with the results from the present study where we explore the application of these models to forecasting protein evolution. We would like to emphasize that forecasting the folding stability of future real proteins is a significant and novel finding, folding stability is fundamental to protein function and has diverse implications. While accurately forecasting the exact sequences would indeed be ideal, this remains a challenging task with current substitution models. In this regard, we will discuss in the revised manuscript the need of developing more accurate substitution models.</p>
<disp-quote content-type="editor-comment">
<p>(4) Background fitness effects: The model ignores background genetic variation in fitness. I think this is particularly important as the fitness effects of mutations in any one protein may be overshadowed by the fitness effects of mutations elsewhere in the genome. The model also ignores background changes in fitness due to the environment, but I acknowledge that might be beyond the scope of the current work.</p>
</disp-quote>
<p>This comment made us realize that more information about the features of the implemented SCS models should be included in the manuscript. In particular, the implemented SCS models consider a negative design based on the observed residue contacts in nearly all proteins available in the Protein Data Bank (Arenas, et al. 2013; Arenas, et al. 2015). This data is provided as an input file and it can be updated to incorporate new structures (see the framework documentation and the practical examples). Therefore, the prediction of folding stability is a combination of positive design (direct analysis of the target protein) and negative design (consideration of background proteins to reduce biases), thus incorporating background molecular diversity. This important feature was not sufficiently described in the manuscript, and we will add more details in the revised version. Regarding the fitness caused by the environment, we agree with the reviewer. This is a challenge for any method aiming to forecast evolution, as future environmental shifts are inherently unpredictable and may impact the accuracy of the predictions. Although one might attempt to incorporate such effects into the model, doing so risks overparameterization, especially when the additional factors are uncertain or speculative. We will include a discussion in the revised manuscript about our perspective on the potential effects of environmental changes on forecasting evolution.</p>
<disp-quote content-type="editor-comment">
<p>(5) In contrast to the model explored here, recent work on multi-type birth-death processes has considered models where lineages have type-specific birth and/or death rates and therefore also type-specific growth rates and fitness (Stadler and Bonhoeffer, 2013; Kunhert et al., 2017; Barido-Sottani, 2023). Rasmussen &amp; Stadler (eLife, 2019) even consider a multi-type birth-death model where the fitness effects of multiple mutations in a protein or viral genome collectively determine the overall fitness of a lineage. The key difference with this work presented here is that these models allow lineages to have different growth rates and fitness, so these models truly allow for non-neutral evolutionary dynamics. It would appear the authors might need to adopt a similar approach to successfully predict protein evolution.</p>
</disp-quote>
<p>We agree with the reviewer that robust birth-death models have been developed applying statistics and, in many cases, the primary aim of those studies is the development and refinement of the model itself. Regarding the study by Rasmussen and Stadler 2019, it incorporates an external evaluation of mutation events where the used fitness is specific for the proteins investigated in that study, which may pose challenges for users interested in analyzing other proteins. In contrast, our study takes a different approach. We implement a fitness function that can be predicted and evaluated for any type of protein (Goldstein 2013), making it broadly applicable. In addition, we provide a freely available and well-documented computational framework to facilitate its use. The primary aim of our study is not the development of novel or complex birth-death models. Rather, we aim to explore the integration of a standard birth-death model with structurally constrained substitution models for the purpose of predicting protein evolution. In the context of protein evolution, substitution models are a critical factor (Liberles, et al. 2012; Wilke 2012; Bordner and Mittelmann 2013; Echave, et al. 2016; Arenas, et al. 2017; Echave and Wilke 2017), and their combination with a birth-death model constitutes a first approximation upon which next studies can build to better understand this biological system. We will include these considerations in the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public review):</bold></p>
<p>Summary:</p>
<p>In this study, &quot;Forecasting protein evolution by integrating birth-death population models with structurally constrained substitution models&quot;, David Ferreiro and co-authors present a forward-in-time evolutionary simulation framework that integrates a birth-death population model with a fitness function based on protein folding stability. By incorporating structurally constrained substitution models and estimating fitness from ΔG values using homology-modeled structures, the authors aim to capture biophysically realistic evolutionary dynamics. The approach is implemented in a new version of their open-source software, ProteinEvolver2, and is applied to four viral proteins from HIV-1 and SARS-CoV-2.</p>
<p>Overall, the study presents a compelling rationale for using folding stability as a constraint in evolutionary simulations and offers a novel framework and software to explore such dynamics. While the results are promising, particularly for predicting biophysical properties, the current analysis provides only partial evidence for true evolutionary forecasting, especially at the sequence level. The work offers a meaningful conceptual advance and a useful simulation tool, and sets the stage for more extensive validation in future studies.</p>
</disp-quote>
<p>We also thank this reviewer for the positive comments on our study. Regarding the predictive power, our results showed good accuracy in predicting the folding stability of the forecasted protein variants. However, predicting the specific sequences of these variants is more challenging. For example, forecasting in amino acids with similar physicochemical properties can result in different sequences but in similar folding stability. We believe that these findings are realistic and interesting as they indicate that while forecasting folding stability is feasible, forecasting the specific sequence evolution is more complex that one could anticipate.</p>
<disp-quote content-type="editor-comment">
<p>Strengths:</p>
<p>The results demonstrate that fitness constraints based on protein stability can prevent the emergence of unrealistic, destabilized variants - a limitation of traditional, neutral substitution models. In particular, the predicted folding stabilities of simulated protein variants closely match those observed in real variants, suggesting that the model captures relevant biophysical constraints.</p>
</disp-quote>
<p>We agree with the reviewer and appreciate the consideration that forecasting the folding stability of future real proteins is a relevant finding. For instance, folding stability is fundamental for protein function and affects several other molecular properties.</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses:</p>
<p>The predictive scope of the method remains limited. While the model effectively preserves folding stability, its ability to forecast specific sequence content is not well supported.</p>
</disp-quote>
<p>It is known that structurally constrained substitution (SCS) models applied to phylogenetics (such as ancestral molecular reconstruction) can model protein evolution with high accuracy in terms of folding stability, while inferring sequences (i.e., ancestral sequences) remains considerably more challenging (Arenas, et al. 2017; Arenas and Bastolla 2020). The observed sequence diversity is much higher than the observed structural diversity (Illergard, et al. 2009; Pascual-Garcia, et al. 2010), and substitutions between amino acids with similar physicochemical properties can result in protein variants with similar folding stability but with different specific amino acid composition. We will expand the discussion of this aspect in the manuscript.</p>
<disp-quote content-type="editor-comment">
<p>Only one dataset (HIV-1 MA) is evaluated for sequence-level divergence using KL divergence; this analysis is absent for the other proteins. The authors use a consensus Omicron sequence as a representative endpoint for SARS-CoV-2, which overlooks the rich longitudinal sequence data available from GISAID. The use of just one consensus from a single time point is not fully justified, given the extensive temporal and geographical sampling available. Extending the analysis to include multiple timepoints, particularly for SARS-CoV-2, would strengthen the predictive claims. Similarly, applying the model to other well-sampled viral proteins, such as those from influenza or RSV, would broaden its relevance and test its generalizability.</p>
</disp-quote>
<p>The evaluation of forecasting evolution using real datasets is complex due to several conceptual and practical aspects. In contrast to traditional phylogenetic reconstruction of past evolutionary events and ancestral sequences, forecasting evolution often begins with a variant that is evolved forward in time and requires a rough fitness landscape to select among possible future variants (Lässig, et al. 2017). Another concern for validating the method is the need to know the initial variant that gives rise to the corresponding forecasted variants, and it is not always known. Thus, we investigated systems where the initial variant, or a close approximation, is known, such as scenarios of <italic>in vitro</italic> monitored evolution. In the case of SARS-CoV-2, the Wuhan variant is commonly used as the starting variant of the pandemic. Next, since forecasting evolution is highly dependent on the used model of evolution, unexpected external factors can be dramatic for the predictions. For this reason, systems with minimal external influences provide a more controlled context for evaluating forecasting evolution. For instance, scenarios of <italic>in vitro</italic> monitored virus evolution avoid some external factors such as host immune response. Another important aspect is the availability of data at two (i.e., present and future) or more time points along the evolutionary trajectory, with sufficient genetic divergence between them to identify clear evolutionary signatures. Additionally, using consensus sequences can help mitigate effects from unfixed mutations, which should not be modeled by a substitution model of evolution. Altogether, not all datasets are appropriate to properly evaluate forecasting evolution. We will include these considerations in the revised manuscript.</p>
<p>Sequence comparisons based on the KL divergence require, at the studied time point, an observed distribution of amino acid frequencies among sites and an estimated distribution of amino acid frequencies among sites. In the study datasets, this is only the case for the HIV-1 MA dataset, which belongs to a previous study from one of us and collaborators where we obtained at least 20 independent sequences at each sampling point (Arenas, et al. 2016). We will provide additional information on this aspect in the manuscript.</p>
<p>Regarding the Omicron dataset, we used 384 curated sequences of the Omicron variant of concern to construct the study dataset and we believe that it is a representative sample. The sequence used for the initial time point was the Wuhan variant (Wu, et al. 2020), which is commonly assumed to be the origin of the pandemic in SARS-CoV-2 studies. As previously indicated, the use of consensus sequences is convenient to avoid variants with unfixed mutations. Regarding extending the analysis to other timepoints (other variants of concern), we kindly disagree because Omicron is the variant of concern with the highest genetic distance to the Wuhan variant, and a high genetic distance is required to properly evaluate the prediction method. We noted that earlier variants of concern show a small number of fixed mutations in the study proteins, despite the availability of large numbers of sequences in databases such as GISAID.</p>
<p>Additionally, we investigated the evolutionary trajectories of HIV-1 protease (PR) in 12 intra-host viral populations.</p>
<p>Next, following the proposal of the reviewer, we will incorporate the analysis of an additional viral dataset (probably influenza following the suggestion of the reviewer) to further assess the generalizability of the method. Still, as previously indicated, not all datasets are suitable for a proper evaluation of forecasting evolution. Factors such as the shape of the fitness landscape and the amount of genetic variation over time can influence the accuracy of predictions. We will present the results of the analysis of the new data in the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p>It would also be informative to include a retrospective analysis of the evolution of protein stability along known historical trajectories. This would allow the authors to assess whether folding stability is indeed preserved in real-world evolution, as assumed in their model.</p>
</disp-quote>
<p>Our present study is not focused on investigating the evolution of the folding stability over time, although it provides this information indirectly at the studied time points. Instead, the present study shows that the folding stability of the forecasted protein variants is similar to the folding stability of the corresponding real protein variants for diverse viral proteins, which is an important evaluation of the method. Next, the folding stability can indeed vary over time in both real and modeled evolutionary scenarios, and our present study is not in conflict with this. In that regard, which is not the aim of our present study, some previous phylogenetic-based studies have reported temporal fluctuations in folding stability for diverse data (Arenas, et al. 2017; Olabode, et al. 2017; Arenas and Bastolla 2020; Ferreiro, et al. 2022).</p>
<disp-quote content-type="editor-comment">
<p>Finally, a discussion on the impact of structural templates - and whether the fixed template remains valid across divergent sequences - would be valuable. Addressing the possibility of structural remodeling or template switching during evolution would improve confidence in the model's applicability to more divergent evolutionary scenarios.</p>
</disp-quote>
<p>This is an important point. For the datasets that required homology modeling (in several cases it was not necessary because the sequence was present in a protein structure of the PDB), the structural templates were selected using SWISS-MODEL, and we applied the best-fitting template. We will include additional details about the parameters of the homology modeling in the revised version. Indeed, our method assumes that the protein structure is maintained over the studied evolutionary time, which can be generally reasonable for short timescales where the structure is conserved (Illergard, et al. 2009; Pascual-Garcia, et al. 2010). Over longer evolutionary timescales, structural changes may occur, and in such cases, modeling the evolution of the protein structure would be necessary. To our knowledge, modeling the evolution of the protein structure remains a challenging task that requires substantial methodological developments. Recent advances in artificial intelligence, particularly in protein structure prediction from sequence, may offer promising tools for addressing this challenge. However, we believe that evaluating such approaches in the context of structural evolution would be difficult, especially given the limited availability of real data with known evolutionary trajectories involving structural change. In any case, this is probably an important direction for future research. We will include this discussion in the revised manuscript.</p>
<p>Cited references</p>
<p>Arenas M. 2012. Simulation of Molecular Data under Diverse Evolutionary Scenarios. PLoS Comput Biol 8:e1002495.</p>
<p>Arenas M, Bastolla U. 2020. ProtASR2: Ancestral reconstruction of protein sequences accounting for folding stability. Methods Ecol Evol 11:248-257.</p>
<p>Arenas M, Dos Santos HG, Posada D, Bastolla U. 2013. Protein evolution along phylogenetic histories under structurally constrained substitution models. Bioinformatics 29:3020-3028.</p>
<p>Arenas M, Lorenzo-Redondo R, Lopez-Galindez C. 2016. Influence of mutation and recombination on HIV-1 in vitro fitness recovery. Molecular Phylogenetics and Evolution 94:264-270.</p>
<p>Arenas M, Sanchez-Cobos A, Bastolla U. 2015. Maximum likelihood phylogenetic inference with selection on protein folding stability. Molecular Biology and Evolution 32:2195-2207.</p>
<p>Arenas M, Weber CC, Liberles DA, Bastolla U. 2017. ProtASR: An Evolutionary Framework for Ancestral Protein Reconstruction with Selection on Folding Stability. Systematic Biology 66:1054-1064.</p>
<p>Bordner AJ, Mittelmann HD. 2013. A new formulation of protein evolutionary models that account for structural constraints. Molecular Biology and Evolution 31:736-749.</p>
<p>Carvajal-Rodriguez A. 2010. Simulation of genes and genomes forward in time. Current Genomics 11:58-61.</p>
<p>Echave J, Spielman SJ, Wilke CO. 2016. Causes of evolutionary rate variation among protein sites. Nature Reviews Genetics 17:109-121.</p>
<p>Echave J, Wilke CO. 2017. Biophysical Models of Protein Evolution: Understanding the Patterns of Evolutionary Sequence Divergence. Annu Rev Biophys 46:85-103.</p>
<p>Ferreiro D, Khalil R, Gallego MJ, Osorio NS, Arenas M. 2022. The evolution of the HIV-1 protease folding stability. Virus Evol 8:veac115.</p>
<p>Goldstein RA. 2013. Population Size Dependence of Fitness Effect Distribution and Substitution Rate Probed by Biophysical Model of Protein Thermostability. Genome Biol Evol 5:1584-1593.</p>
<p>Harmon LJ. 2019. Introduction to birth-death models. In. Phylogenetic Comparative Methods. p. <ext-link ext-link-type="uri" xlink:href="https://lukejharmon.github.io/pcm/chapter10_birthdeath/">https://lukejharmon.github.io/pcm/chapter10_birthdeath/</ext-link>.</p>
<p>Hoban S, Bertorelle G, Gaggiotti OE. 2012. Computer simulations: tools for population and evolutionary genetics. Nature Reviews Genetics 13:110-122.</p>
<p>Illergard K, Ardell DH, Elofsson A. 2009. Structure is three to ten times more conserved than sequence--a study of structural response in protein cores. Proteins 77:499-508.</p>
<p>Lässig M, Mustonen V, Walczak AM. 2017. Predicting evolution. Nature Ecology &amp; Evolution 1:0077.</p>
<p>Liberles DA, Teichmann SA, Bahar I, Bastolla U, Bloom J, Bornberg-Bauer E, Colwell LJ, de Koning AP, Dokholyan NV, Echave J, et al. 2012. The interface of protein structure, protein biophysics, and molecular evolution. Protein Science 21:769-785.</p>
<p>Neher RA, Russell CA, Shraiman BI. 2014. Predicting evolution from the shape of genealogical trees. Elife 3.</p>
<p>Olabode AS, Kandathil SM, Lovell SC, Robertson DL. 2017. Adaptive HIV-1 evolutionary trajectories are constrained by protein stability. Virus Evol 3:vex019.</p>
<p>Pascual-Garcia A, Abia D, Mendez R, Nido GS, Bastolla U. 2010. Quantifying the evolutionary divergence of protein structures: the role of function change and function conservation. Proteins 78:181-196.</p>
<p>Wilke CO. 2012. Bringing molecules back into molecular evolution. PLoS Comput Biol 8:e1002572.</p>
<p>Wu F, Zhao S, Yu B, Chen YM, Wang W, Song ZG, Hu Y, Tao ZW, Tian JH, Pei YY, et al. 2020. A new coronavirus associated with human respiratory disease in China. Nature 579:265-269.</p>
<p>Yang Z. 2006. Computational Molecular Evolution. Oxford, England.: Oxford University Press.</p>
</body>
</sub-article>
</article>