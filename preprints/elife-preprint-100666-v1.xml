<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">100666</article-id>
<article-id pub-id-type="doi">10.7554/eLife.100666</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.100666.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.4</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Physics of Living Systems</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>The Geometry and Dimensionality of Brain-wide Activity</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0006-1401-9871</contrib-id>
<name>
<surname>Wang</surname>
<given-names>Zezhen</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2320-2276</contrib-id>
<name>
<surname>Mai</surname>
<given-names>Weihao</given-names>
</name>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0184-1824</contrib-id>
<name>
<surname>Chai</surname>
<given-names>Yuming</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Qi</surname>
<given-names>Kexin</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ren</surname>
<given-names>Hongtai</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Shen</surname>
<given-names>Chen</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhang</surname>
<given-names>Shiwu</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tan</surname>
<given-names>Guodong</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0790-1605</contrib-id>
<name>
<surname>Hu</surname>
<given-names>Yu</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a6">6</xref>
<email>mahy@ust.hk</email>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0268-8403</contrib-id>
<name>
<surname>Wen</surname>
<given-names>Quan</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<email>qwen@ustc.edu.cn</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04c4dkn09</institution-id><institution>School of Data Science, University of Science and Technology of China</institution></institution-wrap>, <city>Hefei</city>, <country>China</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04c4dkn09</institution-id><institution>Division of Life Sciences and Medicine, University of Science and Technology of China</institution></institution-wrap>, <city>Hefei</city>, <country>China</country></aff>
<aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04c4dkn09</institution-id><institution>Hefei National Laboratory for Physical Sciences at the Microscale, Center for Integrative Imaging, University of Science and Technology of China</institution></institution-wrap>, <city>Hefei</city>, <country>China</country></aff>
<aff id="a4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04c4dkn09</institution-id><institution>Department of Precision Machinery and Precision Instrumentation, University of Science and Technology of China</institution></institution-wrap>, <city>Hefei,</city> <country>China</country></aff>
<aff id="a5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00q4vv597</institution-id><institution>Department of Mathematics, The Hong Kong University of Science and Technology</institution></institution-wrap>, <city>Hong Kong SAR</city>, <country>China</country></aff>
<aff id="a6"><label>6</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00q4vv597</institution-id><institution>Division of Life Science, The Hong Kong University of Science and Technology</institution></institution-wrap>, <city>Hong Kong SAR</city>, <country>China</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Latham</surname>
<given-names>Peter</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University College London</institution>
</institution-wrap>
<city>London</city>
<country>United Kingdom</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Poirazi</surname>
<given-names>Panayiota</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>FORTH Institute of Molecular Biology and Biotechnology</institution>
</institution-wrap>
<city>Heraklion</city>
<country>Greece</country>
</aff>
</contrib>
</contrib-group>
<pub-date date-type="original-publication" iso-8601-date="2025-01-08">
<day>08</day>
<month>01</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP100666</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-07-03">
<day>03</day>
<month>07</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-07-04">
<day>04</day>
<month>07</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.02.23.529673"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Wang et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Wang et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-100666-v1.pdf"/>
<abstract>
<p>Understanding neural activity organization is vital for deciphering brain function. By recording whole-brain calcium activity in larval zebrafish during hunting and spontaneous behaviors, we find that the shape of the neural activity space, described by the neural covariance spectrum, is scale-invariant: a smaller, <italic>randomly sampled</italic> cell assembly resembles the entire brain. This phenomenon can be explained by Euclidean Random Matrix theory, where neurons are reorganized from anatomical to functional positions based on their correlations. Three factors contribute to the observed scale invariance: slow neural correlation decay, higher functional space dimension, and neural activity heterogeneity. In addition to matching data from zebrafish and mice, our theory and analysis demonstrate how the geometry of neural activity space evolves with population sizes and sampling methods, thus revealing an organizing principle of brain-wide activity.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>First, with new theoretical analysis and experimental verification, we uncover a fundamental principle underlying the brain's information processing capabilities: the invariant geometry and dimensionality of the neural activity space. This principle suggests a universal strategy employed by the brain to efficiently encode and process information across various scales of brain organization. To reflect these substantial improvements and new insights, we have revised our manuscript with a new title: &quot; The Geometry and Dimensionality of Brain-wide Activity&quot;.
Second, in an effort to bridge theoretical insights and experimental applications, we show that the configuration of neural activity space can evolve distinctly across scales under different recording techniques commonly used in neuroscience. This revision aims to enhance the accessibility of our work for experimentalists.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>Geometric analysis of neuronal population activity has revealed the fundamental structures of neural representations and brain dynamics (<xref ref-type="bibr" rid="c1">1</xref>–<xref ref-type="bibr" rid="c4">4</xref>). Dimensionality reduction methods, which identify collective or latent variables in neural populations, simplify our view of high-dimensional neural data (<xref ref-type="bibr" rid="c5">5</xref>). Their applications to optical and multi-electrode recordings have begun to reveal important mechanisms by which neural cell assemblies process sensory information (<xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c7">7</xref>), make decisions (<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>), maintain working memory (<xref ref-type="bibr" rid="c10">10</xref>) and generate motor behaviors (<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c11">11</xref>–<xref ref-type="bibr" rid="c13">13</xref>).</p>
<p>In the past decade, the number of neurons that can be simultaneously recorded <italic>in vivo</italic> has grown exponentially (<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c14">14</xref>–<xref ref-type="bibr" rid="c21">21</xref>). This increase spans various brain regions (<xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c22">22</xref>) and the entire mammalian brain (<xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c24">24</xref>). As more neurons are recorded, the multidimensional neural activity space, with each axis representing a neuron’s activity level (<xref rid="fig1" ref-type="fig">Fig. 1A</xref>), becomes more complex. The changing size of observed cell assemblies raises a number of basic questions. How does this space’s geometry evolve and what structures remain invariant with increasing number of neurons recorded? A key measure, the <italic>effective dimension</italic> or <italic>participation ratio</italic> (denoted as <italic>D</italic><sub>PR</sub>, <xref rid="fig1" ref-type="fig">Fig. 1B</xref>), captures a major part of variability in neural activity (<xref ref-type="bibr" rid="c25">25</xref>–<xref ref-type="bibr" rid="c29">29</xref>). How does <italic>D</italic><sub>PR</sub> vary with the number of sampled neurons (<xref rid="fig1" ref-type="fig">Fig. 1A</xref>)? Two scenarios are possible: <italic>D</italic><sub>PR</sub> grows continuously with more sampled neurons; <italic>D</italic><sub>PR</sub> saturates as the sample size increases. Which scenario fits the brain? Furthermore, even if two cell assemblies have the same <italic>D</italic><sub>PR</sub>, they can have different shapes (<xref rid="fig1" ref-type="fig">Fig. 1C</xref>). How does the shape vary with the number of neurons sampled? Lastly, are we going to observe the same picture of neural activity space when using different recording methods such as two-photon microscopy, which records all neurons in a brain region, versus Neuropixels (<xref ref-type="bibr" rid="c16">16</xref>), which conducts a broad random sampling of neurons?</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>The relationship between the geometric properties of the neural activity space and the size of neural assemblies.</title>
<p><bold>A</bold>. Illustration of how dimensionality of neural activity (<italic>D</italic><sub>PR</sub>) changes with the number of recorded neurons. <bold>B</bold>. The eigenvalues of the neural covariance matrix dictate the geometrical configuration of the neural activity space with <inline-formula><inline-graphic xlink:href="529673v4_inline184.gif" mime-subtype="gif" mimetype="image"/></inline-formula> being the distribution width along a principal axis. <bold>C</bold>. Examples of two neural populations with identical dimensionality (<italic>D</italic><sub>PR</sub> = 25<italic>/</italic>11 ≈ 2.27) but different spatial configurations, as revealed by the eigenvalue spectrum (green: <italic>{</italic>λ<sub><italic>i</italic></sub><italic>}</italic> = <italic>{</italic>7, 7, 1<italic>}</italic>, blue: <italic>{</italic>λ<sub><italic>i</italic></sub><italic>}</italic> = <italic>{</italic>9, 3, 3<italic>}</italic>).</p></caption>
<graphic xlink:href="529673v4_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Here, we aim to address these questions by analyzing brain-wide Ca<sup>2+</sup> activity in larval zebrafish during hunting or spontaneous behavior (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>) recorded by Fourier light-field microscopy (<xref ref-type="bibr" rid="c30">30</xref>). The small size of this vertebrate brain, together with the volumetric imaging method, enables us to capture a significant amount of neural activity across the entire brain simultaneously. To characterize the geometry of neural activity beyond its dimensionality <italic>D</italic><sub>PR</sub>, we examine the eigenvalues or spectrum of neural covariance (<xref ref-type="bibr" rid="c31">31</xref>) (<xref rid="fig1" ref-type="fig">Fig. 1C</xref>). The covariance spectrum has been instrumental in offering mechanistic insights into neural circuit structure and function, such as the effective strength of local recurrent interactions and the depiction of network motifs (<xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c32">32</xref>). Intriguingly, we find that both the dimensionality and covariance spectrum remain invariant for cell assemblies that are randomly selected from various regions of the zebrafish brain. We also verify this observation in datasets recorded by different experimental methods, including light-sheet imaging of larval zebrafish (<xref ref-type="bibr" rid="c33">33</xref>), two-photon imaging of mouse visual cortex (<xref ref-type="bibr" rid="c23">23</xref>), and multi-area Neuropixels recording in the mouse (<xref ref-type="bibr" rid="c23">23</xref>). To explain the observed phenomenon, we model the covariance matrix of brain-wide activity by generalizing the Euclidean Random Matrix (ERM) (<xref ref-type="bibr" rid="c34">34</xref>) such that neurons correspond to points distributed in a <italic>d</italic>-dimensional functional or feature space, with pairwise correlation decaying with distance. The ERM theory, studied in theoretical physics (<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c35">35</xref>), provides extensive analytical tools for a deep understanding of the neural covariance matrix model, allowing us to unequivocally identify three crucial factors for the observed scale invariance.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Whole-brain calcium imaging of zebrafish neural activity and the phenomenon of its scale-invariant covariance eigenspectrum.</title>
<p><bold>A</bold>. Rapid light-field Ca<sup>2+</sup> imaging system for whole brain neural activity in larval zebrafish. <bold>B</bold>. Inferred firing rate activity from the brain-wide calcium imaging. The ROIs are sorted by their weights in the first principal component (<xref ref-type="bibr" rid="c23">23</xref>). <bold>C</bold>. Procedure of calculating the covariance spectrum on the full and sampled neural activity matrices. <bold>D</bold>. Dimensionality (circles, average across 8 samplings (dots)), as a function of the sampling fraction. The curve is the predicted dimensionality using <xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>. <bold>E</bold>. Iteratively sampled covariance matrices. Neurons are sorted in each matrix to maximize values near the diagonal. <bold>F</bold>. The covariance spectra, i.e., eigenvalue vs. rank/N, for randomly sampled neurons of different sizes (colors). The gray dots represent the sorted variances <italic>C</italic><sub><italic>ii</italic></sub> of all neurons. <bold>G to I</bold>. Same as <bold>F</bold> but from three models of covariance (see details in Methods): (G) a Wishart random matrix calculated from a random activity matrix of the same size as the experimental data; (H) replacing the eigenvectors by a random orthogonal set; (I) covariance generated from a randomly connected recurrent network.</p></caption>
<graphic xlink:href="529673v4_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Building upon our theoretical results, we further explore the connection between the spatial arrangement of neurons and their locations in functional space, which allows us to distinguish among three sampling approaches: random sampling, anatomical sampling (akin to optical recording of all neurons within a specific region of the brain) and functional sampling (<xref ref-type="bibr" rid="c20">20</xref>). Our ERM theory makes distinct predictions regarding the scaling relationship between dimensionality and the size of cell assembly, as well as the shape of covariance eigenspetrum under various sampling methods. Taken together, our results offer a new perspective for interpreting brain-wide activity and unambiguously show its organizing principles, with unexplored consequences for neural computation.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Results</title>
<sec id="s2a">
<label>2.1</label>
<title>Geometry of neural activity across random cell assemblies in zebrafish brain</title>
<p>We recorded brain-wide Ca<sup>2+</sup> activity at a volume rate of 10 Hz in head-fixed larval zebrafish (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>) during hunting attempts (Methods) and spontaneous behavior using a Fourier light field microscopy (<xref ref-type="bibr" rid="c30">30</xref>). Approximately 2000 ROIs (1977.3 ± 677.1, mean ± SD) with a diameter of 16.84 ± 8.51 µm were analyzed per fish based on voxel activity (Methods). These ROIs likely correspond to multiple nearby neurons with correlated activity. Henceforth, we refer to the ROIs as “neurons” for simplicity.</p>
<p>We first investigate the dimensionality of neural activity <italic>D</italic><sub>PR</sub> (<xref rid="fig1" ref-type="fig">Fig. 1B</xref>) in a randomly chosen cell assembly in zebrafish, similar to multi-area Neuropixels recording in a mammalian brain. We focus on how <italic>D</italic><sub>PR</sub> changes with a large sample size <italic>N</italic>. We find that if the mean squared covariance remains finite instead of vanishing with <italic>N</italic>, the dimensionality <italic>D</italic><sub>PR</sub> (<xref rid="fig1" ref-type="fig">Fig. 1B</xref>) becomes sample size independent and depends only on the variance <inline-formula><inline-graphic xlink:href="529673v4_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and the covariance <italic>C</italic><sub><italic>ij</italic></sub> between neurons <italic>i</italic> and <italic>j</italic>:
<disp-formula id="eqn1">
<graphic xlink:href="529673v4_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where E(…) denotes average across neurons (Methods and (<xref ref-type="bibr" rid="c29">29</xref>)). The finite mean squared covariance condition is supported by the observation that the neural activity covariance <italic>C</italic><sub><italic>ij</italic></sub> is positively biased and widely distributed with a long tail (Fig. S2A). As predicted, the data dimensionality grows with sample size and reaches the maximum value specified by <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> (<xref rid="fig2" ref-type="fig">Fig. 2D</xref>).</p>
<p>Next, we investigate the shape of the neural activity space described by the eigenspectrum of the covariance matrix derived from the activity of <italic>N</italic> randomly selected neurons (<xref rid="fig2" ref-type="fig">Fig. 2C</xref>). When the eigenvalues are arranged in descending order and plotted against the normalized rank <italic>r/N</italic>, where <italic>r</italic> = 1,…,<italic>N</italic>, (we refer to it as the <italic>rank plot</italic>), this curve shows an approximate power law that spans 10 folds. Interestingly, as the size of the covariance matrices decreases (<italic>N</italic> decreases), the eigenspectrum curves nearly collapse over a wide range of eigenvalues. This pattern holds across diverse datasets and experimental techniques (<xref rid="fig2" ref-type="fig">Fig. 2F</xref>, Fig. S2E-L). The similarity of the covariance matrices of randomly sampled neural populations can be intuitively visualized (<xref rid="fig2" ref-type="fig">Fig. 2E</xref>), after properly sorting the neurons (Methods).</p>
<p>The scale invariance in the neural covariance matrix is non-trivial. The spectrum is not scale-invariant in a common covariance matrix model based on independent noise (<xref rid="fig2" ref-type="fig">Fig. 2G</xref>). It is also absent when replacing the neural covariance matrix eigenvectors with random ones, keeping the eigenvalues identical (<xref rid="fig2" ref-type="fig">Fig. 2H</xref>). A recurrent neural network with random connectivity (<xref ref-type="bibr" rid="c31">31</xref>) also fails to produce the scale-invariant covariance spectrum (<xref rid="fig2" ref-type="fig">Fig. 2I</xref>). Thus, a new model for the covariance matrix of neural activity is needed.</p>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Modeling covariance by organizing neurons in functional space</title>
<p>Dimension reduction methods simplify and visualize complex neuron interactions by embedding them into a low-dimensional map, within which nearby neurons have similar activities. Inspired by these ideas, we use the Euclidean Random Matrix (ERM (<xref ref-type="bibr" rid="c34">34</xref>)) to model neural covariance. Imagine sprinkling neurons uniformly distributed on a <italic>d</italic>-dimensional <italic>functional space</italic> of size <italic>L</italic> (<xref rid="fig3" ref-type="fig">Fig. 3A</xref>), where the distance between neurons <italic>i</italic> and <italic>j</italic> affects their correlation. Let <inline-formula><inline-graphic xlink:href="529673v4_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula> represent the functional coordinate of the neuron <italic>i</italic>. The distance-correlation dependency is described by <italic>kernel function</italic> <inline-formula><inline-graphic xlink:href="529673v4_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with <italic>f</italic> (0) = 1, indicating closer neurons have stronger correlations, and decreases as distance <inline-formula><inline-graphic xlink:href="529673v4_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula> increases (<xref rid="fig3" ref-type="fig">Fig. 3A</xref> and Methods). To model the covariance, we extend the ERM by incorporating heterogeneity of neuron activity levels (shown as the size of the neuron in the functional space in <xref rid="fig3" ref-type="fig">Fig. 3A</xref>)</p>
<p>
<disp-formula id="eqn2">
<graphic xlink:href="529673v4_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The variance of neural activity <inline-formula><inline-graphic xlink:href="529673v4_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is drawn i.i.d. from a given distribution and is independent of neurons’ position.</p>
    <fig id="fig3" position="float" fig-type="figure">
        <label>Figure 3.</label>
        <caption><title>ERM model of covariance and its eigenspectrum.</title>
            <p><bold>A</bold>. Schematic of the Euclidean Random Matrix (ERM) model, which reorganizes neurons (circles) from the anatomical space to the functional space (here <italic>d</italic> =2 is a two-dimensional box). The correlation between a pair of neurons decreases with their distance in the functional space according to a kernel function <inline-formula><inline-graphic xlink:href="529673v4_inline185.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. This correlation is then scaled by neurons’ variance <inline-formula><inline-graphic xlink:href="529673v4_inline186.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (circle size) to obtain the covariance <italic>C</italic><sub><italic>ij</italic></sub>. <bold>B</bold>. An example ERM correlation matrix (i.e., when <inline-formula><inline-graphic xlink:href="529673v4_inline187.gif" mime-subtype="gif" mimetype="image"/></inline-formula>). <bold>C</bold>. Spectrum (same as <xref rid="fig2" ref-type="fig">Fig. 2F</xref>) for the ERM correlation matrix in B. <bold>D</bold>. Visualizing the distribution of the same ERM eigenvalues in <bold>C</bold> by plotting the probability density function (pdf).</p></caption>
        <graphic xlink:href="529673v4_fig3.tif" mime-subtype="tiff" mimetype="image"/>
    </fig>
<p>This multidimensional functional space may represent attributes to which neurons are tuned, such as sensory features (e.g., visual orientation (<xref ref-type="bibr" rid="c36">36</xref>), auditory frequency) and movement characteristics (e.g., direction, speed (<xref ref-type="bibr" rid="c37">37</xref>, <xref ref-type="bibr" rid="c38">38</xref>)). In sensory systems, it represents stimuli as neural activity patterns, with proximity indicating similarity in features. For motor control, it encodes movement parameters and trajectories. In the hippocampus, it represents the place field of a place cell, acting as a cognitive map of physical space (<xref ref-type="bibr" rid="c39">39</xref>–<xref ref-type="bibr" rid="c41">41</xref>).</p>
<p>We first explore the ERM with various forms of <inline-formula><inline-graphic xlink:href="529673v4_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and find that fast-decaying functions like Gaussian and exponential functions do not produce eigenspectra similar to the data and no scale invariance over random sampling (Fig. S4A-H and Supp. Note). Thus, we turn to slow-decaying functions including the power law, which produce spectra similar to the data (<xref rid="fig3" ref-type="fig">Fig. 3C,D</xref>; see also Fig. S5). We adopt a particular kernel function because of its closed-form and analytical properties: <inline-formula><inline-graphic xlink:href="529673v4_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (Methods). For large distance <inline-formula><inline-graphic xlink:href="529673v4_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, it approximates a power law <inline-formula><inline-graphic xlink:href="529673v4_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and smoothly transitions at small distance to satisfy the correlation requirement <italic>f</italic> (0) = 1 (Fig. S7I, J).</p>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Analytical theory on the conditions of scale invariance in ERM</title>
<p>To determine the conditions for scale invariance in ERM, we analytically calculate the eigenspectrum of covariance matrix <italic>C</italic> (<xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>) for large <italic>N, L</italic> using the replica method (<xref ref-type="bibr" rid="c34">34</xref>). A key order parameter emerging from this calculation is the neuron density <italic>ρ</italic>:= <italic>N/L</italic><sup><italic>d</italic></sup>. In the high-density regime <italic>ρ ϵ</italic><sup><italic>d</italic></sup> ≈ 1, the covariance spectrum can be approximated in a closed form (Methods). For the slow-decaying kernel function <inline-formula><inline-graphic xlink:href="529673v4_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula> defined above, the spectrum for large eigenvalues follows a power law (Supp. Note):
<disp-formula id="eqn3">
<graphic xlink:href="529673v4_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>r</italic> is the rank of the eigenvalues in descending order and <italic>p</italic>(λ) is their probability density function. <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> intuitively explains the scale invariance over random sampling. Sampling in the ERM reduces the neuron density <italic>ρ</italic>. The eigenspectrum is <italic>ρ</italic>-independent whenever <italic>µ/d</italic> ≈ 0. This indicates two factors contributing to the scale invariance of the eigenspectrum. First, a small exponent <italic>µ</italic> in the kernel function <inline-formula><inline-graphic xlink:href="529673v4_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula> means that pairwise correlations slowly decay with functional distance and can be significantly positive across various functional modules and throughout the brain. For a given <italic>µ</italic>, an increase in dimension <italic>d</italic> improves the scale invariance. The dimension <italic>d</italic> could represent the number of independent features or latent variables describing neural activity or cognitive states.</p>
<p>We verify our theoretical predictions by comparing sampled eigenspectra in finite-size simulated ERMs across different <italic>µ</italic> and <italic>d</italic> (<xref rid="fig4" ref-type="fig">Fig. 4A</xref>). We first consider the case of homogeneous neurons (<inline-formula><inline-graphic xlink:href="529673v4_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>, revisited later) in these simulations (<xref rid="fig3" ref-type="fig">Fig. 3C, D</xref> and <xref rid="fig4" ref-type="fig">Fig. 4A</xref>), making <italic>C</italic>’s entries correlation coefficients. To quantitatively assess the level of scale invariance, we introduce a <italic>collapse index</italic> (CI) motivated by <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>. In the log-log scale rank plot, <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> shows the spectrum shifts vertically with <italic>ρ</italic>. Thus, we define CI as this average displacement (<xref rid="fig4" ref-type="fig">Fig. 4A</xref> upper right, Methods), and a smaller CI means more scale-invariant. Using CI, <xref rid="fig4" ref-type="fig">Fig. 4A</xref> shows that scale invariance improves with slower correlation decay as <italic>µ</italic> decreases and the functional dimension <italic>d</italic> increases. Conversely, with large <italic>µ</italic> and small <italic>d</italic>, the covariance eigenspectrum varies significantly with scale (<xref rid="fig4" ref-type="fig">Fig. 4A</xref>).</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Three factors contributing to scale invariance.</title>
<p><bold>A</bold>. Impact of <italic>µ</italic> and <italic>d</italic> (see text) on the scale invariance of ERM spectrum (same plots as <xref rid="fig3" ref-type="fig">Fig. 3C</xref>) with<inline-formula><inline-graphic xlink:href="529673v4_inline188.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The degree of scale invariance is quantified by the collapse index (CI), which essentially measures the area between different spectrum curves (upper right inset). For comparison, we fix the same coordinate range across panels hence some plots are cropped. <bold>B</bold>. Top: sampled correlation matrix spectrum in an example animal (fish 1). Bottom: Same as top but for the covariance matrix that incorporates heterogeneous <inline-formula><inline-graphic xlink:href="529673v4_inline189.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (gray dots). <bold>C</bold>. The CI of the correlation matrix (filled squares) is found to be larger than that for the covariance matrix (opened squares) across different datasets: f1 to f6: six light-field zebrafish data (10 Hz per volume, this paper); fl: light-sheet zebrafish data (2 Hz per volume, (<xref ref-type="bibr" rid="c33">33</xref>)); mn: mouse Neuropixels data (downsampled to 10 Hz per volume); mp: mouse two-photon data, (3 Hz per volume, (<xref ref-type="bibr" rid="c23">23</xref>)).</p></caption>
<graphic xlink:href="529673v4_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Next, we consider the general case of unequal neural activity levels <inline-formula><inline-graphic xlink:href="529673v4_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and check for differences between the correlation (equivalent to<inline-formula><inline-graphic xlink:href="529673v4_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula>) and covariance matrix spectra. Using the collapsed index (CI), we compare the scale invariance of the two spectra in experimental data. Intriguingly, the CI of the covariance matrix is consistently smaller (more scale-invariant) across all datasets (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>, Fig. S6C, open vs. closed squares), indicating that the heterogeneity of neuronal activity variances significantly affects the eigenspectrum and the geometry of neural activity space (<xref ref-type="bibr" rid="c42">42</xref>). By extending our spectrum calculation to the intermediate density regime <italic>ρ ϵ</italic><sup><italic>d</italic></sup> ≪ 1 (Methods), we show that the ERM model can quantitatively explain the improved scale invariance in the covariance matrix compared to the correlation matrix (Fig. S6B).</p>
<p>Lastly, we examine factors that turn out to have minimal impact on the scale invariance of the covariance spectrum. First, the shape of the kernel function <inline-formula><inline-graphic xlink:href="529673v4_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula> over a small distance does not affect the distribution of large eigenvalues (Fig. S7, <xref ref-type="table" rid="tblS3">table S3</xref>, Fig. S9A). This supports our use of a specific <inline-formula><inline-graphic xlink:href="529673v4_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to represent a class of slow-decaying kernels. Second, altering the spatial distribution of neurons in the functional space, whether using a Gaussian, uniform, or clustered distribution, does not affect large covariance eigenvalues, except possibly the leading ones (Fig. S9B, Methods). Third, different geometries of the functional space, such as a flat square, a sphere, or a hemisphere, result in eigenspectra similar to the original ERM model (Fig. S9C). These findings indicate that our theory for the covariance spectrum’s scale invariance is robust to various modeling details.</p>
</sec>
<sec id="s2d">
<label>2.4</label>
<title>Connection among random sampling, functional sampling, and anatomical sampling</title>
<p>So far, we have focused on random sampling of neurons, but how does the neural activity space change with different sampling methods? To this end, we consider three methods (<xref rid="fig5" ref-type="fig">Fig. 5A1</xref>): random sampling (RSap), anatomical sampling (ASap) where neurons in a brain region are captured by optical imaging (<xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c43">43</xref>, <xref ref-type="bibr" rid="c44">44</xref>), and functional sampling (FSap) where neurons are selected based on activity similarity (<xref ref-type="bibr" rid="c20">20</xref>). The difference among sampling methods depends on the neuron organization throughout the brain. If anatomically localized neurons also cluster functionally (<xref rid="fig5" ref-type="fig">Fig. 5A4</xref>), ASap FSap; if they are spread in the functional space (<xref rid="fig5" ref-type="fig">Fig. 5A2</xref>), ASap ≈ RSap. Generally, the anatomical-functional relationship is in-between and can be quantified using the Canonical Correlation Analysis (CCA). This technique finds axes (CCA vectors <inline-formula><inline-graphic xlink:href="529673v4_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and<inline-formula><inline-graphic xlink:href="529673v4_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>) in anatomical and functional spaces such that the neurons’ projection along these axes has the maximum correlation, <italic>R</italic><sub>CCA</sub>. The extreme scenarios described above correspond to <italic>R</italic><sub>CCA</sub> =1 and <italic>R</italic><sub>CCA</sub> = 0.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><title>The relationship between the functional and anatomical space and theoretical predictions.</title>
<p><bold>A</bold>. Three sampling methods (A1) and <italic>R</italic><sub>CCA</sub> (see text). When <italic>R</italic><sub>CCA</sub> ≈ 0 (A2), the anatomical sampling (ASap) resembles the random sampling (RSap), and while when <italic>R</italic><sub>CCA</sub> ≈ 1 (A4), ASap is similar to the functional sampling (FSap). <bold>B</bold>. Distribution of neurons in the functional space inferred by MDS. Each neuron is color-coded by its projection along the first canonical direction <inline-formula><inline-graphic xlink:href="529673v4_inline190.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in the anatomical space (see text). Data based on fish 6, same for C to E. <bold>C</bold>. Similar to B. but plotting neurons in the anatomical space with color based on their projection along <inline-formula><inline-graphic xlink:href="529673v4_inline191.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in the functional space (see text). <bold>D</bold>. Dimensionality (<italic>D</italic><sub>PR</sub>) across sampling methods: average <italic>D</italic><sub>PR</sub> under RSap (circles), average and individual brain region <italic>D</italic><sub>PR</sub> under ASap (squares and dots), and <italic>D</italic><sub>PR</sub> under FSap for the most correlated neuron cluster (triangles; Methods). Dashed and solid lines are theoretical predictions for <italic>D</italic><sub>PR</sub> under RSap and FSap, respectively (Methods). <bold>E</bold>. The CI of correlation matrices under three sampling methods in 6 animals (colors). **p<italic>&lt;</italic>0.01; ***p<italic>&lt;</italic>0.001; one-sided paired t tests: RSap vs. ASap, p = 0.0010; RSap vs. FSap, p = 0.0004; ASap vs. FSap, p = 0.0014.</p></caption>
<graphic xlink:href="529673v4_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To determine the anatomical-functional relationship in neural data, we infer the functional coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula> of each neuron by fitting the ERM using multidimensional scaling (MDS) (<xref ref-type="bibr" rid="c45">45</xref>) (Methods). For simplicity and better visualization, we use a low-dimensional functional space where <italic>d</italic> = 2. The fitted functional coordinates confirm the slow decay kernel function in ERM except for a small distance (Fig. S12). The ERM with inferred coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula> also reproduces the experimental covariance matrix, including cluster structures (Fig. S11) and its sampling eigenspectra (Fig. S10).</p>
<p>Equipped with the functional and anatomical coordinates, we next use CCA to determine which scenarios illustrated in <xref rid="fig5" ref-type="fig">Fig. 5A</xref> align better with the neural data. <xref rid="fig5" ref-type="fig">Fig. 5B,C</xref> shows a representative fish with a significant <italic>R</italic><sub>CCA</sub> = 0.327 (p-value=0.0042, Anderson–Darling test). Notably, the CCA vector in the anatomical space, <inline-formula><inline-graphic xlink:href="529673v4_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, aligns with the rostrocaudal axis. Coloring each neuron in the functional space by its projection along <inline-formula><inline-graphic xlink:href="529673v4_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula> shows a correspondence between clustering and anatomical coordinates (<xref rid="fig5" ref-type="fig">Fig. 5B</xref>). Similarly, coloring neurons in the anatomical space (<xref rid="fig5" ref-type="fig">Fig. 5C</xref>) by their projection along <inline-formula><inline-graphic xlink:href="529673v4_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula> reveals distinct localizations in regions like the forebrain and optic tectum. Across animals, functionally clustered neurons show anatomical segregation (<xref ref-type="bibr" rid="c33">33</xref>), with an average <italic>R</italic><sub>CCA</sub> of 0.335<italic>±</italic>0.054 (mean<italic>±</italic>SD).</p>
<p>Next, we investigate the effects of different sampling methods (<xref rid="fig5" ref-type="fig">Fig. 5A1</xref>) on the geometry of the neural activity space when there is a significant but moderate anatomical-functional correlation as in the experimental data. Interestingly, dimensionality <inline-formula><inline-graphic xlink:href="529673v4_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in data under anatomical sampling consistently falls between random and functional sampling values (<xref rid="fig5" ref-type="fig">Fig. 5D</xref>). This phenomenon can be intuitively explained by the ERM theory. Recall that for large <italic>N</italic>, the key term in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref> is<inline-formula><inline-graphic xlink:href="529673v4_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For a fixed number of sampled neurons, this average squared covariance is maximized when neurons are selected closely in the functional space (FSap) and minimized when distributed randomly (RSap). Thus, RSap and FSap <italic>D</italic><sub>PR</sub> set the upper and lower bounds of dimensionality, with ASap expected to fall in between. This reasoning can be precisely formulated to obtain quantitative predictions of the bounds (Methods). We predict the ASap dimension at large <italic>N</italic> as
<disp-formula id="eqn4">
<graphic xlink:href="529673v4_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here <italic>D</italic><sub>PR</sub> is the dimensionality under RSap (<xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>), <italic>k</italic> represents the fraction of sampled neurons. <italic>R</italic><sub>ASap</sub> is the correlation between anatomical and functional coordinates along the direction where the anatomical subregions are divided (Methods), and it is bounded by the canonical correlation <italic>R</italic><sub>ASap</sub> ≤ <italic>R</italic><sub>CCA</sub>. When <italic>R</italic><sub>ASap</sub> = 0, we get the upper bound <inline-formula><inline-graphic xlink:href="529673v4_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref rid="fig5" ref-type="fig">Fig. 5D</xref> dashed line). The lower bound is reached when <italic>R</italic><sub>ASap</sub> = <italic>R</italic><sub>CCA</sub> =1 (<xref rid="fig5" ref-type="fig">Fig. 5A4</xref>), where <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref> shows a scaling relationship <inline-formula><inline-graphic xlink:href="529673v4_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula> that depends on the sampling fraction <italic>k</italic> (<xref rid="fig5" ref-type="fig">Fig. 5D</xref> solid line). This contrasts with the <italic>k</italic>-independent dimensionality of RSap in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>. Furthermore, if <italic>R</italic><sub>ASap</sub> and its upper bound is not close to 1 (precisely <italic>R</italic><sub>ASap</sub> ≤ 0.84 for the ERM model in <xref rid="fig5" ref-type="fig">Fig. 5D</xref>), <inline-formula><inline-graphic xlink:href="529673v4_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula> align closer to the upper bound of RSap. This prediction agrees well with our observations in data across animals (<xref rid="fig5" ref-type="fig">Fig. 5D</xref>, Fig. S20 and Fig. S21).</p>
<p>Beyond dimensionality, our theory predicts the difference in the covariance spectrum between sampling methods based on the neuronal density <italic>ρ</italic> in the functional space (<xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>). This density <italic>ρ</italic> remains constant during Fsap (<xref rid="fig5" ref-type="fig">Fig. 5A1</xref>) and decreases under RSap; the average density across anatomical regions ⟨ <italic>ρ</italic> ⟩in ASap lies between those of FSap and RSap. Analogous to <xref ref-type="disp-formula" rid="eqn4">Eq. (4)</xref>, the relationship in <italic>ρ</italic> orders the spectra: ASap’s spectrum lies between those of FSap and RSap (Methods). This further implies that the level of scale invariance under ASap should fall between that of RSap and FSap, which is confirmed by our experimental data (<xref rid="fig5" ref-type="fig">Fig. 5E</xref>).</p>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Discussion</title>
<sec id="s3a">
<title>Impact of hunting behavior on scale invariance and functional space organization</title>
<p>How does task-related neural activity shape the covariance spectrum and brain-wide functional organization? We examine the hunting behavior in larval zebrafish, marked by eye convergence (both eyes move inward to focus on the central visual field) (<xref ref-type="bibr" rid="c46">46</xref>). We find that scale invariance of the eigenspectra persists when the hunting frames from the Ca<sup>2+</sup> imaging data are removed (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>, Fig. S15AB, Methods). This is consistent with the scale-invariant spectrum found in other data sets during spontaneous behaviors (Fig. S10F, Fig. S2GH), suggesting scale invariance is a general phenomenon.</p>
<p>Interestingly, in the inferred functional space, we observe reorganizations of neurons after removing hunting behavior (Fig. S15C, D). Neurons in one cluster disperse from their center of mass (Fig. S15D) and decreases the local neuronal density <italic>ρ</italic> (Methods and Fig. S15E). The neurons in this dispersed cluster have a consistent anatomical distribution from the midbrain to the hindbrain in 4 out of 5 fish (Fig. S17). During hunting, the cluster has robust activations that are widespread in the anatomical space but localized in the functional space(Movie. S1).</p>
<p>Our findings suggest that the functional space could be defined by latent variables that represent cognitive factors such as decision-making, memory, and attention. These variables set the space’s dimensions, with neural activity patterns reflecting cognitive state dynamics. Functionally related neurons – through sensory tuning, movement parameters, internal conditions, or cognitive factors – become closer in this space, leading to stronger activity correlations.</p>
</sec>
<sec id="s3b">
<title>Criticality and power law</title>
<p>What drives brain dynamics with a slow-decaying distance-correlation function <inline-formula><inline-graphic xlink:href="529673v4_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in functional space? Long-range connections and a slow decline in projection strength over distance (<xref ref-type="bibr" rid="c47">47</xref>) may cause extensive correlations, enhancing global activity patterns. This behavior is also reminiscent of phase transitions in statistical mechanics (<xref ref-type="bibr" rid="c48">48</xref>), where local interactions lead to expansive correlated behaviors. Studies suggest that critical brains optimize information processing (<xref ref-type="bibr" rid="c49">49</xref>, <xref ref-type="bibr" rid="c50">50</xref>). The link between neural correlation structures and neuronal connectivity topology is an exciting area for future exploration.</p>
<p>In the high-density regime of the ERM model, the eigenvalue rank plot (<xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>) follows a power law λ ∼<italic>r</italic><sup>−<italic>α</italic></sup>, with α <italic>&lt;</italic> 1. The scale invariant spectrum occurs when <italic>–</italic> is close to 1. Experimental data, however, align more closely with the model in the intermediate-density regime, where the power-law spectrum is an approximation and the decay is slower (for ERM model Fig. S3BC, and for data <italic>–</italic> = 0.47 ± 0.08, mean ± SD, <italic>n</italic> =6 fish). Stringer et al. (<xref ref-type="bibr" rid="c6">6</xref>) found an α ≈ 1 decay in the mouse visual cortex’s stimulus trial averaged covariance spectrum, suggesting this decay optimizes visual code efficiency and smoothness. Our study differs as we recorded brain-wide activity during spontaneous or hunting behavior, calculating neural covariance from single-trial activity. Much of the neural activity was not driven by sensory stimulus and unrelated to specific tasks, requiring a different interpretation of the neural covariance spectrum.</p>
<p>We draw inspiration from the renormalization group (RG) approach to navigate neural covariance across scales, which has also been explored in the recent literature. Following Kadanoff’s block spin transformation (<xref ref-type="bibr" rid="c48">48</xref>), Meshulam et al. (<xref ref-type="bibr" rid="c20">20</xref>) formed size-dependent neuron clusters and their covariance matrices by iteratively pairing the most correlated neurons and placing them adjacent on a lattice. The groups expanded until the largest reached the system size. The RG process, akin to spatial sampling in functional space (FSap), maintains constant neuron density <italic>ρ</italic>. Thus, for any kernel function<inline-formula><inline-graphic xlink:href="529673v4_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, including the power law and exponential, the covariance eigenspectrum remains invariant across scales (Fig. S19A,B,D,E).</p>
</sec>
<sec id="s3c">
<title>Bounded dimensionality under random sampling</title>
<p>The saturation of the dimensionality <italic>D</italic><sub>PR</sub> at large sample sizes indicates a limit to neural assembly complexity, evidenced by the finite mean square covariance. This is in contrast with neural dynamics models such as the balanced excitatory-inhibitory (E-I) neural network (<xref ref-type="bibr" rid="c51">51</xref>), where <inline-formula><inline-graphic xlink:href="529673v4_inline31.gif" mime-subtype="gif" mimetype="image"/></inline-formula> resulting in an unbounded dimensionality (see Supp. Note). Our results suggest that the brain encodes experiences, sensations, and thoughts using a finite set of dimensions instead of an infinitely complex neural activity space.</p>
<p>We found that the relationship between dimensionality and the number of recorded neurons depends on the sampling method. For functional sampling, the dimensionality scales with the sampling fraction<inline-formula><inline-graphic xlink:href="529673v4_inline32.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. This suggests that if anatomically sampled neurons are functionally clustered, as with cortical neurons forming functional maps, the increase in dimensionality with neuron number may seem unbounded. This offers new insights for interpreting large-scale neural activity data recorded under various techniques.</p>
</sec>
<sec id="s3d">
<title>Computational benefits of a scale-invariant covariance spectrum</title>
<p>The scale invariance of neural activity across different neuron assembly sizes could support efficient multiscale information encoding and processing. It indicates that the neural code is robust and requires minimal adjustments despite changes in population size. One recent study shows that randomly sampled and coarse-grained macrovoxels can predict population neural activity (<xref ref-type="bibr" rid="c52">52</xref>), reinforcing that a random neuron subset may capture overall activity patterns. This enables downstream circuits to readout and process information through random projections (<xref ref-type="bibr" rid="c27">27</xref>).</p>
<p>Understanding how dimensionality and spectrum change with sample size also suggests the possibility of extrapolating from small samples to overcome experimental limitations. This is particularly feasible when <italic>µ/d</italic> → 0, where the dimensionality and spectrum under anatomical, random, and functional sampling coincide (<xref ref-type="disp-formula" rid="eqn3">Equations (3)</xref> and <xref ref-type="disp-formula" rid="eqn4">(4)</xref>). Developing extrapolation methods and exploring the benefits of scale-invariant neural code are promising future research directions.</p>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Materials and Methods</title>
<sec id="s4a">
<label>4.1</label>
<title>Experimental methods</title>
<p>The handling and care of the zebrafish complied with the guidelines and regulations of the Animal Resources Center of the University of Science and Technology of China (USTC). All larval zebrafish (huc:h2b -GCaMP6f) were raised in E2 embryo medium (comprising 7.5 mM NaCl, 0.25 mM KCl, 0.5 mM MgSO<sub>4</sub>, 0.075 mM KH<sub>2</sub>PO<sub>4</sub>, 0.025 mM Na<sub>2</sub>HPO<sub>4</sub>, 0.5 mM CaCl<sub>2</sub>, and 0.35 mM NaHCO<sub>3</sub>; containing 0.5 mg/L methylene blue) at 28.5 °C and with a 14-h light and 10-h dark cycle.</p>
<p>To induce hunting behavior (composed of motor sequences like eye convergence and J turn) in larval zebrafish, we fed them a large amount of paramecia over a period of 4-5 days post-fertilization (dpf). The animals were then subjected to a 24-hour starvation period, after which they were transferred to a specialized experimental chamber. The experimental chamber was 20mm in diameter and 1mm in depth, and the head of each zebrafish was immobilized by applying 2% low melting point agarose. The careful removal of the agarose from the eyes and tail of the fish ensured that these body regions remained free to move during hunting behavior. Thus, characteristic behavioral features such as J-turns and eye convergence could be observed and analyzed. Subsequently, the zebrafish were transferred to an incubator and stayed overnight. At 7 dpf, several paramecia were introduced in front of the previously immobilized animals, each of which was monitored by a stereomicroscope. Those displaying binocular convergence were selected for subsequent Ca<sup>2+</sup> imaging experiments.</p>
<p>We developed a novel optomagnetic system that allows (<xref ref-type="bibr" rid="c1">1</xref>) precise control of the trajectory of the paramecium and (<xref ref-type="bibr" rid="c2">2</xref>) imaging brain-wide Ca<sup>2+</sup> activity during the hunting behavior of zebrafish. To control the movement of the paramecium, we treated these microorganisms with a suspension of ferric tetroxide for 30 minutes and selected those that responded to its magnetic attraction. A magnetic paramecium was then placed in front of a selected larva, and its movement was controlled by changing the magnetic field generated by Helmholtz coils that were integrated into the imaging system. The real-time position of the paramecium, captured by an infrared camera, was identified by online image processing. The positional vector relative to a predetermined target position was calculated. The magnitude and direction of the current in the Helmholtz coils were adjusted accordingly, allowing for precise control of the magnetic field and hence the movement of the paramecium. Multiple target positions could be set to drive the paramecium back and forth between multiple locations.</p>
<table-wrap id="tblS1" orientation="portrait" position="float">
<label>Table S1.</label>
<caption><title>Table of notations.</title></caption>
<graphic xlink:href="529673v4_tblS1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>The experimental setup consisted of head-fixed larval zebrafish undergoing two different types of behavior: induced hunting behavior by a moving paramecium in front of a fish (fish 1-5), and spontaneous behavior without any visual stimulus as a control (fish 6). Experiments were carried out at ambient temperature (ranging from 23°C to 25°C). The behavior of the zebrafish was monitored by a high-speed infrared camera (Basler acA2000-165umNIR, 0.66x) behind a 4F optical system and recorded at 50 Hz. Brain-wide Ca<sup>2+</sup> imaging was achieved using XLFM. Light-field images were acquired at 10 Hz, using customized LabVIEW software (National Instruments, USA) or Solis software (Oxford Instruments, UK), with the help of a high-speed data acquisition card (PCIe-6321, National Instruments, USA) to synchronize the fluorescence with behavioral imaging.</p>
<sec id="s4a1">
<label>4.1.1</label>
<title>Behavior analysis</title>
<p>The background of each behavior video was removed using the clone stamp tool in Adobe Photoshop CS6. Individual images were then processed by an adaptive thresholding algorithm, and fish head and yolk were selected manually to determine the head orientation. The entire body centerline, extending from head to tail, was divided into 20 segments. The amplitude of a bending segment was defined as the angle between the segment and the head orientation. To identify the paramecium in a noisy environment, we subtracted a background image, averaged over a time window of 100 s, from all the frames. The major axis of the left or right eye was identified using DeepLabCut (<xref ref-type="bibr" rid="c53">53</xref>). The eye orientation was defined as the angle between the rostrocaudal axis and the major axis of an eye; The convergence angle was defined as the angle between the major axes of the left and right eyes. An eye-convergence event was defined as a period of time where the angle between the long axis of the eyes stayed above 50 degrees (<xref ref-type="bibr" rid="c46">46</xref>).</p>
</sec>
<sec id="s4a2">
<label>4.1.2</label>
<title>Imaging data acquisition and processing</title>
<p>We used a fast eXtended light field microscope (XLFM, with a volume rate of 10 Hz) to record Ca<sup>2+</sup> activity throughout the brain of head-fixed larval zebrafish. Fish were ordered by the dates of experiments. As previously described (<xref ref-type="bibr" rid="c30">30</xref>), we adopted the Richardson-Lucy deconvolution method to iteratively reconstruct 3D fluorescence stacks (600 × 600 × 250) from the acquired 2D images (2048 × 2048). This algorithm requires an experimentally measured point spread function (PSF) of the XLFM system. The entire recording for each fish is 15.3<italic>±</italic>4.3 min (mean<italic>±</italic>SD).</p>
<p>To perform image registration and segmentation, we first cropped and resized the original image stack to 400 × 308 × 210, which corresponded to the size of a standard zebrafish brain (zbb) atlas (<xref ref-type="bibr" rid="c54">54</xref>). This step aimed to reduce substantial memory requirements and computational costs in subsequent operations. Next, we picked a typical volume frame and aligned it with the zbb atlas using a basic 3D affine transformation. This transformed frame was used as a template. We aligned each volume with the template using rigid 3D intensity-based registration (<xref ref-type="bibr" rid="c55">55</xref>) and non-rigid pairwise registration (<xref ref-type="bibr" rid="c56">56</xref>) in the Computational Morphometry Toolkit (CMTK) (<ext-link ext-link-type="uri" xlink:href="https://www.nitrc.org/projects/cmtk/">https://www.nitrc.org/projects/cmtk/</ext-link>). After voxel registration, we computed the pairwise correlation between nearby voxel intensities and performed the watershed algorithm on the correlation map to cluster and segment voxels into consistent ROIs across all volumes. We defined the diameter of each ROI using the maximum Feret diameter (the longest distance between any two voxels within a single ROI).</p>
<p>Finally, we adopted the “OASIS” deconvolution method to denoise and infer neural activity from the fluorescence time sequence (<xref ref-type="bibr" rid="c57">57</xref>). The deconvolved Δ <italic>F/F</italic> of each ROI was used to infer firing rates for subsequent analysis.</p>
</sec>
</sec>
<sec id="s4b">
<label>4.2</label>
<title>Other experimental datasets analyzed</title>
<table-wrap id="tblS2" orientation="portrait" position="float">
<label>Table S2.</label>
<caption><p>Resources for additional experimental datasets</p></caption>
<graphic xlink:href="529673v4_tblS2.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>To validate our findings across different recording methods and animal models, we also analyzed three additional datasets. We include a brief description below for completeness. Further details can be found in the respective reference. The first dataset includes whole-brain light-sheet Ca<sup>2+</sup> imaging of immobilized larval zebrafish in the presence of visual stimuli as well as in a spontaneous state (<xref ref-type="bibr" rid="c33">33</xref>). Each volume of the brain was scanned through 2.11 ± 0.21 planes per sec, providing a near-simultaneous readout of neuronal Ca<sup>2+</sup> signals. We analyzed fish 8 (69,207 neurons × 7,890 frames), 9 (79,704 neurons × 7,720 frames) and 11 (101,729 neurons × 8,528 frames), which are the first three fish data with more than 7,200 frames. For simplicity, we labeled them l2, l3, and l1(fl). The second dataset consists of Neuropixels recordings from approximately ten different brain areas in mice during spontaneous behavior (<xref ref-type="bibr" rid="c23">23</xref>). Data from the three mice, <italic>Kerbs, Robbins</italic>, and <italic>Waksman</italic>, include the firing rate matrices of 1,462 neurons × 39,053 frames, 2,296 neurons × 66,409 frames, and 2,688 neurons × 74,368 frames, respectively. The last dataset comprises two-photon Ca<sup>2+</sup> imaging data (2-3 Hz) obtained from the visual cortex of mice during spontaneous behavior. While this dataset includes numerous animals, we focused on the first three animals that exhibited spontaneous behavior:spont_M150824_MP019_2016-04-05 (11,983 neurons × 21,055 frames), spont_M160825_MP027_2016-12-12 (11,624 neurons × 23,259 frames), and spont_M160907_MP028_2016-09-26 (9,392 neurons × 10,301 frames) (<xref ref-type="bibr" rid="c23">23</xref>).</p>
</sec>
<sec id="s4c">
<label>4.3</label>
<title>Covariance matrix, eigenspectrum and sampling procedures</title>
<p>To begin, we multiplied the inferred firing rate of each neuron (see <xref ref-type="sec" rid="s4a2">section 4.1.2</xref>) by a constant such that in the resulting activity trace <italic>x</italic><sub><italic>i</italic></sub>, the mean of <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>) <italic>over the nonzero time frames</italic> equaled one (<xref ref-type="bibr" rid="c20">20</xref>). Consistent with the literature (<xref ref-type="bibr" rid="c20">20</xref>), this step aimed to eliminate possible confounding factors in the raw activity traces, such as the heterogeneous expression level of the fluorescence protein within neurons and the non-linear conversion of the electrical signal to Ca<sup>2+</sup> concentration. Note that after this scaling, neurons could still have different activity levels characterized by the variance of <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>) over time, due to differences in the sparsity of activity (proportion of nonzero frames) and the distribution of nonzero <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>) values. The scale-invariant nature of the eigenspectrum (<xref rid="fig2" ref-type="fig">Fig. 2F</xref>) was unaffected by this imposed scaling of the mean activity, as the phenomenon of scale invariance persisted in the absence of such normalization. The three models of covariance in <xref rid="fig2" ref-type="fig">Fig. 2G-I</xref> were constructed as follows. For model in <xref rid="fig2" ref-type="fig">Fig. 2G</xref>, the entries of matrix <italic>G</italic> (with dimensions <italic>N</italic> × <italic>T</italic>) were sampled from an i.i.d. Gaussian distribution with zero mean and standard deviation σ = 1. In <xref rid="fig2" ref-type="fig">Fig. 2H</xref>, we constructed the composite covariance matrix for fish 1 achieved by maintaining the eigenvalues from the fish 1 data covariance matrix and replacing the eigenvectors <italic>U</italic> with a set of random orthonormal basis. Lastly, the covariance matrix in <xref rid="fig2" ref-type="fig">Fig. 2I</xref> was generated from a randomly connected recurrent network of linear rate neurons. The entries in the synaptic weight matrix are normally distributed with <italic>J</italic><sub><italic>ij</italic></sub> ∼ 𝒩 (0,<italic>g</italic><sup>2</sup><italic>/N</italic>), with a coupling strength <italic>g</italic> = 0.95 (<xref ref-type="bibr" rid="c31">31</xref>, <xref ref-type="bibr" rid="c32">32</xref>). For consistency, we used the same number of time frames <italic>T</italic> = 7, 200 when comparing CI across all the datasets (<xref rid="fig4" ref-type="fig">Fig. 4BC</xref>, <xref rid="fig5" ref-type="fig">Fig. 5DE</xref>, Fig. S6C). For other cases, we analyzed the full length of the data (number of time frames: fish 1 - 7495, fish 2 - 9774, fish 3 - 13904, fish 4 - 7318, fish 5 - 7200, fish 6 - 9388). Next, the covariance matrix was calculated as <inline-formula><inline-graphic xlink:href="529673v4_inline33.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="529673v4_inline34.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the mean of <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>) over time. Finally, to visualize covariance matrices on a common scale, we multiplied matrix <italic>C</italic> by a constant such that the average of its diagonal entries equaled one, that is, Tr(<italic>C</italic>)<italic>/N</italic> = 1. This scaling did not alter the shape of covariance eigenvalue distribution, but set the mean at 1 (see also <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>).</p>
<p>To maintain consistency across data sets, we fixed the same initial number of neurons at <italic>N</italic><sub>0</sub> = 1, 024. These <italic>N</italic><sub>0</sub> neurons were randomly chosen once for each zebrafish dataset and then used throughout the subsequent analyses. We adopted this setting for all analyses except in two particular instances: (<xref ref-type="bibr" rid="c1">1</xref>) for comparisons among the three sampling methods (RSap, ASap, and FSap), we specifically chose 1,024 neurons centered along the anterior-posterior axis, mainly from the midbrain to the anterior hindbrain regions (<xref rid="fig5" ref-type="fig">Fig. 5DE</xref>, Fig. S20). (<xref ref-type="bibr" rid="c2">2</xref>) When investigating the impact of hunting behavior on scale invariance, we included the entire neuronal population (<xref ref-type="sec" rid="s4k">section 4.11</xref>).</p>
<p>We used an iterative procedure to sample the covariance matrix <italic>C</italic> (calculated from data or as simulated ERMs). For RSap, in the first iteration, we randomly selected half of the neurons. The covariance matrix for these selected neurons was a <italic>N/</italic>2 × <italic>N/</italic>2 diagonal block of <italic>C</italic>. Similarly, the covariance matrix of the unselected neurons was another diagonal block of the same size. In the next iteration, we similarly created two new sampled blocks with half the number of neurons for each of the blocks we had. Repeating this process for <italic>n</italic> iterations resulted in 2<sup><italic>n</italic></sup> blocks, each containing <italic>N</italic> := <italic>N</italic><sub>0</sub><italic>/</italic>2<sup><italic>n</italic></sup> neurons. At each iteration, the eigenvalues of each block were calculated and averaged across the blocks after being sorted in descending order. Finally, the averaged eigenvalues were plotted against rank/<italic>N</italic> on a log-log scale.</p>
<p>In the case of ASap and FSap, the process of selecting neurons was different, although the remaining procedures followed the RSap protocol. In ASap, the selection of neurons was based on a spatial criterion: neurons close to the anterior end on the anterior-posterior axis were grouped to create a diagonal block of size<inline-formula><inline-graphic xlink:href="529673v4_inline35.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, with the remaining neurons forming a separate block. FSap, on the other hand, used the Renormalization Group (RG) framework (<xref ref-type="bibr" rid="c20">20</xref>) to define the blocks (details in <xref ref-type="sec" rid="s4l">section 4.12</xref>). In each iteration, the cluster of neurons within a block that showed the highest average correlation <inline-formula><inline-graphic xlink:href="529673v4_inline36.gif" mime-subtype="gif" mimetype="image"/></inline-formula> was identified and labeled as the most correlated cluster (refer to <xref rid="fig5" ref-type="fig">Fig. 5D</xref>, Figures S20 and S21).</p>
<p>In the ERM model, as part of implementing ASap, we generated anatomical and functional coordinates for neurons with a specified CCA properties as described in <xref ref-type="sec" rid="s4i">section 4.9</xref>. Mirroring the approach taken with our data, ASap segmented neurons into groups based on the first dimension of their anatomical coordinates, akin to the anterier-posterior axis. FSap employed the same RG procedures outlined earlier (<xref ref-type="sec" rid="s4l">section 4.12</xref>).</p>
<p>To determine the overall power-law coefficient of the eigenspectra, <italic>α</italic>, throughout sampling, we fitted a straight line in the log-log rank plot to the large eigenvalues that combined the original and three iterations of sampled covariance matrices (selecting the top 10% eigenvalues for each matrix and excluding the first four largest ones for each matrix). We averaged the estimated <italic>α</italic> over 10 repetitions of the entire sampling procedure. <italic>R</italic><sup>2</sup> of the power-law fit was computed in a similar way. To visualize the statistical structures of the original and sampled covariance matrices, the orders of the neurons (i.e. columns and rows) are determined by the following algorithm. We first construct a symmetric Toeplitz matrix 𝒯, with entries 𝒯<sub><italic>i,j</italic></sub> = <italic>t</italic><sub><italic>i</italic>−<italic>j</italic></sub> and <italic>t</italic><sub><italic>i</italic>−<italic>j</italic></sub> <italic>t</italic><sub><italic>j</italic>−<italic>i</italic></sub>. The vector <inline-formula><inline-graphic xlink:href="529673v4_inline37.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is equal to the mean covariance vector of each neuron calculated below. Let <inline-formula><inline-graphic xlink:href="529673v4_inline38.gif" mime-subtype="gif" mimetype="image"/></inline-formula> be a row vector of the data covariance matrix; we identify<inline-formula><inline-graphic xlink:href="529673v4_inline39.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where <italic>D</italic>(·) denotes a numerical ordering operator, namely rearranging the elements in a vector <inline-formula><inline-graphic xlink:href="529673v4_inline40.gif" mime-subtype="gif" mimetype="image"/></inline-formula> such that <italic>c</italic><sub>0</sub> ≥ <italic>c</italic><sub>1</sub> ≥ … ≥ <italic>c</italic><sub><italic>N</italic>−1</sub>. The second step is to find a permutation matrix <italic>P</italic> such that ∥ 𝒯 − <italic>PCP</italic><sup><italic>T</italic></sup> ∥<sub><italic>F</italic></sub> is minimized, where ∥ ∥<sub><italic>F</italic></sub> denotes the Frobenius norm. This quadratic assignment problem is solved by simulated annealing. Note that after sampling, the smaller matrix will appear different from the larger one. We need to perform the above reordering algorithm for every sampled matrix so that matrices of different sizes become similar in <xref rid="fig2" ref-type="fig">Fig. 2E</xref>.</p>
<p>The composite covariance matrix with substituted eigenvectors in (<xref rid="fig2" ref-type="fig">Fig. 2H</xref>) was created as described in the following steps. First, we generated a random orthogonal matrix <italic>U</italic><sub><italic>r</italic></sub> (based on the Haar measure) for the new eigenvectors. This was achieved by QR decomposition <italic>A</italic> = <italic>U</italic><sub><italic>r</italic></sub><italic>R</italic> of a random matrix <italic>A</italic> with i.i.d. entries <italic>A</italic><sub><italic>ij</italic></sub> ∼ 𝒩 (0, 1<italic>/N</italic>). The composite covariance matrix <italic>C</italic><sub><italic>r</italic></sub> was then defined as<inline-formula><inline-graphic xlink:href="529673v4_inline41.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where Λ is a diagonal matrix that contains the eigenvalues of <italic>C</italic>. Note that since all the eigenvalues are real and <italic>U</italic><sub><italic>r</italic></sub> is orthogonal, the resulting <italic>C</italic><sub><italic>r</italic></sub> is a real and symmetric matrix. By construction, <italic>C</italic><sub><italic>r</italic></sub> and <italic>C</italic> have the same eigenvalues, but their <italic>sampled</italic> eigenspectra can differ.</p>
</sec>
<sec id="s4d">
<label>4.4</label>
<title>Dimensionality</title>
<p>In this section, we introduce the Participation Ratio (<italic>D</italic><sub>PR</sub>) as a metric for effective dimensionality of a system, based on (<xref ref-type="bibr" rid="c25">25</xref>–<xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c58">58</xref>). <italic>D</italic><sub>PR</sub> is defined as:
<disp-formula id="eqn5">
<graphic xlink:href="529673v4_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here, λ<sub><italic>i</italic></sub> are the eigenvalues of the covariance matrix <italic>C</italic>, representing variances of neural activities. Tr(·) denotes the trace of the matrix. The term <inline-formula><inline-graphic xlink:href="529673v4_inline42.gif" mime-subtype="gif" mimetype="image"/></inline-formula> denotes the expected value of the squared elements that lie off the main diagonal of <italic>C</italic>. This represents the average squared covariance between the activities of distinct pairs of neurons.</p>
<p>With these definitions, we explore the asymptotic behavior of <italic>D</italic><sub>PR</sub> as the number of neurons <italic>N</italic> approaches infinity:
<disp-formula id="ueqn1">
<graphic xlink:href="529673v4_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
This limit highlights the relationship between the PR dimension and the average squared covariance among different pairs of neurons. It is worth mentioning that a similar theoretical finding is established by Dahmen et. al. (<xref ref-type="bibr" rid="c29">29</xref>). The transition from increasing <italic>D</italic><sub>PR</sub> with <italic>N</italic> to approaching the saturation point occurs when <italic>N</italic> is significantly larger than <italic>D</italic><sub>PR</sub>.</p>
</sec>
<sec id="s4e">
<label>4.5</label>
<title>ERM model</title>
<p>We consider the eigenvalue distribution or spectrum of the matrix <italic>C</italic> at the limit of <italic>N</italic> ≫ 1 and <italic>L</italic> ≫ 1. This spectrum can be analytically calculated in both high-density and intermediate-density scenarios using the replica method (<xref ref-type="bibr" rid="c34">34</xref>). The following sketch shows our approach, and detailed derivations can be found in Supp. Note. To calculate the probability density function of the eigenvalues (or eigendensity), we first compute the resolvent or Stieltjes transform<inline-formula><inline-graphic xlink:href="529673v4_inline43.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Here ⟨…⟩ is the average across the realizations of <italic>C</italic> (that is, random <inline-formula><inline-graphic xlink:href="529673v4_inline44.gif" mime-subtype="gif" mimetype="image"/></inline-formula> s and <inline-formula><inline-graphic xlink:href="529673v4_inline45.gif" mime-subtype="gif" mimetype="image"/></inline-formula> s). The relationship between the resolvent and the eigendensity is given by the Sokhotski-Plemelj formula:
<disp-formula id="eqn6">
<graphic xlink:href="529673v4_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <bold>Im</bold> means imaginary part.</p>
<p>Here we follow the field-theoretic approach (<xref ref-type="bibr" rid="c34">34</xref>), which turns the problem of calculating the resolvent to a calculation of the partition function in statistical physics by using the replica method. In the limit <italic>N</italic> → ∞, <italic>L</italic><sup><italic>d</italic></sup> → ∞, <italic>ρ</italic> being finite, by performing a leading order expansion of the canonical partition function at large <italic>z</italic> (Supp. Note), we find the resolvent is given by
<disp-formula id="eqn7">
<graphic xlink:href="529673v4_eqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
In the <italic>high-density</italic> regime, the probability density function (pdf) of the covariance eigenvalues can be approximated and expressed from <xref ref-type="disp-formula" rid="eqn6">Equations (6)</xref> and <xref ref-type="disp-formula" rid="eqn7">(7)</xref> using the Fourier transform of the kernel function<inline-formula><inline-graphic xlink:href="529673v4_inline46.gif" mime-subtype="gif" mimetype="image"/></inline-formula>:
<disp-formula id="eqn8">
<graphic xlink:href="529673v4_eqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>δ</italic> (<italic>x</italic>) is the Dirac delta function and E(<italic>σ</italic><sup>2</sup>) is the expected value of the variances of neural activity. Intuitively, <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref> means that λ <italic>/ ρ</italic> are distributed with a density proportional to the area of <inline-formula><inline-graphic xlink:href="529673v4_inline47.gif" mime-subtype="gif" mimetype="image"/></inline-formula> level sets (i.e., isosurfaces).</p>
<p>In <xref ref-type="sec" rid="s2c">section 2.3</xref>, we found that the covariance matrix consistently shows greater scale invariance compared to the correlation matrix across all datasets. This suggests that the variability in neuronal activity significantly influences the eigenspectrum. This finding, however, cannot be explained by the high-density theory, which predicts that the eigenspectrum of the covariance matrix is simply a rescaling of the correlation eigenspectrum by<inline-formula><inline-graphic xlink:href="529673v4_inline48.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, the expected value of the variances of neural activity. Without loss of generality, we can always standardize the fluctuation level of neural activity by setting E(<italic>σ</italic><sup>2</sup>)= 1. This is equivalent to multiplying the covariance matrix <italic>C</italic> by a constant such that Tr(<italic>C</italic>)<italic>/N</italic> = 1, which in turn scales all the eigenvalues of <italic>C</italic> by the same factor. Consequently, the heterogeneity of <inline-formula><inline-graphic xlink:href="529673v4_inline49.gif" mime-subtype="gif" mimetype="image"/></inline-formula> has no effect on the scale invariance of the eigenspectrum (see <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>). This theoretical prediction is indeed correct and is confirmed by direct numerical simulations and quantifying the scale invariance using the CI (Fig. S6A).</p>
<p>Fortunately, the inconsistency between theory and experimental results can be resolved by focusing the ERM within the intermediate density regime <italic>ρ ϵ</italic><sup><italic>d</italic></sup> ≪ 1, where neurons are positioned at a moderate distance from each other. As mentioned above, we set E(<italic>σ</italic><sup>2</sup>)=1 in our model and vary the diversity of activity fluctuations among neurons represented by E(<italic>σ</italic><sup>4</sup>). Consistent with the experimental observations, we find that the CI decreases with E(<italic>σ</italic><sup>4</sup>) (see Fig. S6B). This agreement indicates that the neural data are better explained by the ERM in the intermediate density regime.</p>
<p>To gain a deeper understanding of this behavior, we use the Gaussian variational method (<xref ref-type="bibr" rid="c34">34</xref>) to calculate the eigenspectrum. Unlike the high-density theory where the eigendensity has an explicit expression, in the intermediate density the resolvent <italic>g</italic>(<italic>z</italic>) no longer has an explicit expression and is given by the following equation
<disp-formula id="eqn9">
<graphic xlink:href="529673v4_eqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where ⟨…⟩<sub><italic>σ</italic></sub> computes the expectation value of the term within the bracket with respect to <italic>σ</italic>, namely ⟨…⟩<sub><italic>σ</italic></sub> ≡ <italic>∫</italic> …<italic>p</italic>(<italic>σ</italic>)d<italic>σ</italic>. Here and in the following, we denote <inline-formula><inline-graphic xlink:href="529673v4_inline50.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The function <inline-formula><inline-graphic xlink:href="529673v4_inline51.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is determined by a self-consistent equation,
<disp-formula id="eqn10">
<graphic xlink:href="529673v4_eqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We can solve <inline-formula><inline-graphic xlink:href="529673v4_inline52.gif" mime-subtype="gif" mimetype="image"/></inline-formula> from <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> numerically and below is an outline, and the details are explained in Supp. Note. Let us define the integral <inline-formula><inline-graphic xlink:href="529673v4_inline53.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. First, we substitute <italic>z</italic> ≡ λ + <italic>iη</italic> into <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> and write 𝒢 = <bold>Re𝒢</bold> + <italic>i</italic><bold>Im𝒢</bold>. <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> can thus be decomposed into its real part and imaginary part, and a set of nonlinear and integral equations, each of which involves both <bold>Re𝒢</bold> and <bold>Im𝒢</bold>. We solve these equations at the limit <italic>η</italic> → 0 using a fixed-point iteration that alternates between updating <bold>Re𝒢</bold> and <bold>Im𝒢</bold> until convergence.</p>
<p>We find that the variational approximations exhibit excellent agreement with the numerical simulation for both large and intermediate <italic>ρ</italic> where the high-density theory starts to deviate significantly (for <italic>ρ</italic> = 256 and <italic>ρ</italic> = 10.24, <italic>ϵ</italic> = 0.03125, Fig. S3). Note that the departure of the leading eigenvalues in these plots is expected, since the power-law kernel function we use is not integrable (see <xref ref-type="sec" rid="s4f">section 4.6</xref>).</p>
<p>To elucidate the connection between the two different methods, we estimate the condition when the result of the high-density theory (<xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>) matches that of the variational method (Equations (<xref ref-type="bibr" rid="c9">9</xref>) and (<xref ref-type="bibr" rid="c10">10</xref>)) (Supp. Note). The transition between these two density regimes can also be understood (see <xref ref-type="sec" rid="s4h1">section 4.8.1</xref> and Supp. Note).</p>
<p>Importantly, the scale invariance of the spectrum at <italic>µ/d</italic> → 0 previously derived using the high-density result (<xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>) can be extended to the intermediate-density regime by proving the <italic>ρ</italic> -independence using the variational method (Supp. Note).</p>
<p>Finally, using the variational method and the integration limit estimated by simulation (see <xref ref-type="sec" rid="s4g2">section 4.7.2</xref>), we show that the heterogeneity of the variance of neural activity, quantified by E(<italic>σ</italic><sup>4</sup>), indeed improves the collapse of the eigenspectra for intermediate <italic>ρ</italic> (Supp. Note). Our theoretical results agree excellently with the ERM simulation (Fig. S6A, B).</p>
</sec>
<sec id="s4f">
<label>4.6</label>
<title>Kernel function</title>
<p>Throughout the paper, we have mainly considered a particular approximate power-law kernel function inspired by the Student’s t distribution (<xref ref-type="sec" rid="s2b">section 2.2</xref>)
<disp-formula id="eqn11">
<graphic xlink:href="529673v4_eqn11.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
To understand how to choose <italic>ϵ</italic> and <italic>µ</italic>, see <xref ref-type="sec" rid="s4h1">section 4.8.1</xref>. Variations of <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref> near <italic>x</italic> =0 have also been explored; see a summary in <xref ref-type="table" rid="tblS3">table S3</xref>.</p>
<table-wrap id="tblS3" orientation="portrait" position="float">
<label>Table S3.</label>
<caption><title>Modifications of the shape of <inline-formula><inline-graphic xlink:href="529673v4_inline192.gif" mime-subtype="gif" mimetype="image"/></inline-formula> near <inline-formula><inline-graphic xlink:href="529673v4_inline193.gif" mime-subtype="gif" mimetype="image"/></inline-formula> used in Fig. S7, Fig. S8 and Fig. S9.</title>
<p>Flat: when <inline-formula><inline-graphic xlink:href="529673v4_inline194.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Tangent: when <inline-formula><inline-graphic xlink:href="529673v4_inline195.gif" mime-subtype="gif" mimetype="image"/></inline-formula> follows a tangent line of the exact power law <inline-formula><inline-graphic xlink:href="529673v4_inline196.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="529673v4_inline197.gif" mime-subtype="gif" mimetype="image"/></inline-formula> have a same first-order derivative when <inline-formula><inline-graphic xlink:href="529673v4_inline198.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. <italic>c</italic> is a constant. Tent: when <inline-formula><inline-graphic xlink:href="529673v4_inline199.gif" mime-subtype="gif" mimetype="image"/></inline-formula> follows a straight line while the slope is not the same as the tangent case. Parabola: when <inline-formula><inline-graphic xlink:href="529673v4_inline200.gif" mime-subtype="gif" mimetype="image"/></inline-formula> follows a quadratic function (<italic>ax</italic><sup>2</sup> +1 and <inline-formula><inline-graphic xlink:href="529673v4_inline201.gif" mime-subtype="gif" mimetype="image"/></inline-formula> have same first-order derivative). t pdf: mimic the smoothing treatment like the t distribution. All the constant parameters are set such that <italic>f</italic> (0) = 1.</p></caption>
<graphic xlink:href="529673v4_tblS3.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>It is worth mentioning that a power law is not the only slow decaying function that can produce a scale-invariant covariance spectrum (Fig. S5). We choose it for its analytical tractability in calculating the eigenspectrum. Importantly, we find numerically that the two contributing factors to scale invariance – namely, slow spatial decay and higher functional space – can be generalized to other <italic>nonpower-law</italic> functions. An example is the stretched exponential function <inline-formula><inline-graphic xlink:href="529673v4_inline54.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with 0 <italic>&lt; η &lt;</italic> 1. When <italic>η</italic> is small and <italic>d</italic> is large, the covariance eigenspectra also display a similar collapse upon random sampling (Fig. S5).</p>
<p>This approximate power-law <inline-formula><inline-graphic xlink:href="529673v4_inline55.gif" mime-subtype="gif" mimetype="image"/></inline-formula> has the advantage of having an analytical expression for its Fourier transform, which is crucial for the high-density theory (<xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>),
<disp-formula id="eqn12">
<graphic xlink:href="529673v4_eqn12.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here <italic>K</italic><sub><italic>α</italic></sub> (<italic>x</italic>) is the modified Bessel function of the second kind, and r(<italic>x</italic>) is the Gamma function. We calculated the above formulas analytically for <italic>d</italic> = 1, 2, 3 with the assistance of Mathematica and conjectured the case for general dimension <italic>d</italic>, which we confirmed numerically for <italic>d</italic> ≤ 10.</p>
<p>We want to explain two technical points relevant to the interpretation of our numerical results and the choice of<inline-formula><inline-graphic xlink:href="529673v4_inline56.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Unlike the case in the usual ERM, here we allow <inline-formula><inline-graphic xlink:href="529673v4_inline57.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to be non-integrable (over ℝ<sup><italic>d</italic></sup>), which is crucial to allow power law<inline-formula><inline-graphic xlink:href="529673v4_inline58.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The nonintegrability violates a condition in the classical convergence results of the ERM spectrum (<xref ref-type="bibr" rid="c59">59</xref>) as <italic>N</italic> → ∞. We believe that this is exactly the reason for the departure of the first few eigenvalues from our theoretical spectrum (e.g., in <xref rid="fig3" ref-type="fig">Fig. 3</xref>). Our hypothesis is also supported by ERM simulations with integrable <inline-formula><inline-graphic xlink:href="529673v4_inline59.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (Fig. S4), where the numerical eigenspectrum matches closely with our theoretical one, including the leading eigenvalues. For ERM to be a legitimate model for covariance matrices, we need to ensure that the resulting matrix <italic>C</italic> is positive semidefinite. According to the Bochner theorem (<xref ref-type="bibr" rid="c60">60</xref>), this is equivalent to the Fourier transform (FT) of the kernel function <inline-formula><inline-graphic xlink:href="529673v4_inline60.gif" mime-subtype="gif" mimetype="image"/></inline-formula> being nonnegative for all frequencies. For example, in 1D, a rectangle function <inline-formula><inline-graphic xlink:href="529673v4_inline61.gif" mime-subtype="gif" mimetype="image"/></inline-formula> does not meet the condition <inline-formula><inline-graphic xlink:href="529673v4_inline62.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, but a tent function <inline-formula><inline-graphic xlink:href="529673v4_inline63.gif" mime-subtype="gif" mimetype="image"/></inline-formula> does (its FT is sinc<sup>2</sup>(<italic>x</italic>)). For the particular kernel function <inline-formula><inline-graphic xlink:href="529673v4_inline64.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref>, this condition can be easily verified using the analytical expressions of its Fourier transform (<xref ref-type="disp-formula" rid="eqn12">Eq. (12)</xref>). The integral expression for <italic>K</italic><sub><italic>α</italic></sub> (<italic>x</italic>), given as<inline-formula><inline-graphic xlink:href="529673v4_inline65.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, shows that <italic>K</italic><sub><italic>α</italic></sub> (<italic>x</italic>) is positive for all <italic>x&gt;</italic> 0. Likewise, the Gamma function Γ (<italic>x</italic>) <italic>&gt;</italic> 0. Therefore, the Fourier transform of <xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref> is positive and the resulting matrix <italic>C</italic> (of any size and values of <inline-formula><inline-graphic xlink:href="529673v4_inline66.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is guaranteed to be positive definite.</p>
<p>Building upon the theory outlined above, numerical simulations further validated the empirical robustness of our ERM model, as showcased in <xref rid="fig3" ref-type="fig">Fig. 3B-D</xref> and <xref rid="fig4" ref-type="fig">Fig. 4A</xref>. In <xref rid="fig3" ref-type="fig">Fig. 3B-D</xref>, the ERM was characterized by the parameters <italic>N</italic> = 1024, <italic>d</italic> = 2, <italic>L</italic> = 10, <italic>ρ</italic> = 10.24 and <italic>µ</italic> = 0.5 and <italic>ϵ</italic> = 0.03125 for<inline-formula><inline-graphic xlink:href="529673v4_inline67.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. To numerically compute the eigenvalue probability density function, we generated the ERM 100 times, each sampled using the method described in <xref ref-type="sec" rid="s4c">section 4.3</xref>. The probability density function (pdf) was computed by calculating the pdf of each ERM realization and averaging these across the instances. The curves in <xref rid="fig3" ref-type="fig">Fig. 3D</xref> showed the average of over 100 ERM simulations. The shaded area (most of which is smaller than the marker size) represented the SEM. For <xref rid="fig4" ref-type="fig">Fig. 4A</xref>, the columns from left to right were corresponded to <italic>µ</italic> = 0.5, 0.9, 1.3, and the rows from top to bottom were corresponded to <italic>d</italic> = 1, 2, 3. Other ERM simulation parameters: <italic>N</italic> = 4096, <italic>ρ</italic> = 256, <italic>L</italic> = (<italic>N/ρ</italic>)<sup>1<italic>/d</italic></sup>, <italic>ϵ</italic> = 0.03125 and <inline-formula><inline-graphic xlink:href="529673v4_inline68.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. It should be noted that for <xref rid="fig4" ref-type="fig">Fig. 4A</xref>, the presented data pertain to a single ERM realization.</p>
</sec>
<sec id="s4g">
<label>4.7</label>
<title>Collapse index (CI)</title>
<p>Motivated by the high-density theory in the ERM (<xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>), we quantify the extent of scale invariance using CI defined as the area between two spectrum curves (<xref rid="fig4" ref-type="fig">Fig. 4A</xref> upper right):
<disp-formula id="eqn13">
<graphic xlink:href="529673v4_eqn13.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
we set <italic>q</italic><sub>1</sub> such that λ (<italic>q</italic><sub>1</sub>)= 1, which is the mean of the eigenvalues of a normalized covariance matrix. The other integration limit <italic>q</italic><sub>0</sub> is set to 0.01 such that λ (<italic>q</italic><sub>0</sub>) is the 1% largest eigenvalue.</p>
<p>Here we provide numerical details on calculating CI for the ERM simulations and experimental data.</p>
<sec id="s4g1">
<label>4.7.1</label>
<title>A calculation of collapse index for experimental datasets/ERM model</title>
<p>To calculate CI for a covariance matrix <italic>C</italic> of size <italic>N</italic><sub>0</sub>, we first computed its eigenvalues <inline-formula><inline-graphic xlink:href="529673v4_inline69.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and those of the sampled block <italic>C</italic><sub><italic>s</italic></sub> of size <italic>N</italic><sub><italic>s</italic></sub> = <italic>N</italic><sub>0</sub><italic>/</italic>2, denoted as <inline-formula><inline-graphic xlink:href="529673v4_inline70.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (averaged over 20 times for the ERM simulation and 2000 times in experimental data). Next, we estimated log λ (<italic>q</italic>) using the eigenvalues of <italic>C</italic><sub>0</sub> and <italic>C</italic><sub><italic>s</italic></sub> at <italic>q</italic> = <italic>i/N</italic><sub><italic>s</italic></sub>, <italic>i</italic> = 1, 2,…, <italic>N</italic><sub><italic>s</italic></sub>. For the sampled <italic>C</italic><sub><italic>s</italic></sub>, we simply had<inline-formula><inline-graphic xlink:href="529673v4_inline71.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, its <italic>i</italic>-th largest eigenvalue. For the original <italic>C</italic><sub>0</sub>, log λ (<italic>q</italic> = <italic>i/N</italic><sub><italic>s</italic></sub>) was estimated by a linear interpolation, <italic>on the</italic> log λ<italic>-</italic>log <italic>q scale</italic>, using the value of log λ (<italic>q</italic>) in the nearest neighboring <italic>q</italic> = <italic>i/N</italic><sub>0</sub>’s (which again are simply log<inline-formula><inline-graphic xlink:href="529673v4_inline72.gif" mime-subtype="gif" mimetype="image"/></inline-formula>). Finally, the integral (<xref ref-type="disp-formula" rid="eqn13">Eq. (13)</xref>) was computed using the trapezoidal rule, discretized at <italic>q</italic> = <italic>i/N</italic><sub><italic>s</italic></sub>’ s, using the finite difference<inline-formula><inline-graphic xlink:href="529673v4_inline73.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where Δ denotes the difference between the original eigenvalues of <italic>C</italic><sub>0</sub> and those of sampled <italic>C</italic><sub><italic>s</italic></sub>.</p>
</sec>
<sec id="s4g2">
<label>4.7.2</label>
<title>Estimating CI using the variational method</title>
<p>In the definition of CI (<xref ref-type="disp-formula" rid="eqn13">Eq. (13)</xref>, calculating λ (<italic>q</italic>) and <inline-formula><inline-graphic xlink:href="529673v4_inline74.gif" mime-subtype="gif" mimetype="image"/></inline-formula> directly using the variational method is difficult, but we can make use of an implicit differentiation
<disp-formula id="eqn14">
<graphic xlink:href="529673v4_eqn14.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="529673v4_inline75.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the complementary cdf (the inverse function of λ (<italic>q</italic>) in <xref ref-type="sec" rid="s4g1">section 4.7.1</xref>). Using this, the integral in CI (<xref ref-type="disp-formula" rid="eqn13">Eq. (13)</xref>) can be rewritten as
<disp-formula id="eqn15">
<graphic xlink:href="529673v4_eqn15.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Since<inline-formula><inline-graphic xlink:href="529673v4_inline76.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, we switch the order of the integration interval in the final expression of <xref ref-type="disp-formula" rid="eqn15">Eq. (15)</xref>.</p>
<p>First, we explain how to compute the complementary cdf <italic>q</italic>(λ) numerically using the variational method. The key is to integrate the probability density function <italic>p</italic>(λ) from λ to a finite λ (<italic>q</italic><sub><italic>s</italic></sub>) rather than to infinity,
<disp-formula id="eqn16">
<graphic xlink:href="529673v4_eqn16.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The integration limit λ (<italic>q</italic><sub><italic>s</italic></sub>) cannot be calculated directly using the variational method. We thus used the value of λ<sup><italic>s</italic></sup>(<italic>q</italic><sub><italic>s</italic></sub> ≈ <italic>q</italic><sub>0</sub>) (<xref ref-type="sec" rid="s4g">section 4.7</xref>) from simulations of the ERM with a large <italic>N</italic> = 1024 as an approximation. Furthermore, we employed a smoothing technique to reduce bias in the estimation of λ<sup><italic>s</italic></sup>(<italic>q</italic><sub><italic>s</italic></sub>) due to the leading zigzag eigenvalues (i.e., the largest eigenvalues) of the eigenspectrum. Specifically, we determined the nearest rank <italic>j &lt; Nq</italic><sub>0</sub> and then smoothed the eigenvalue log λ<sup><italic>s</italic></sup>(<italic>q</italic><sub><italic>s</italic></sub>) on the log-log scale using the formula <inline-formula><inline-graphic xlink:href="529673v4_inline77.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="529673v4_inline78.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, averaging over 100 ERM simulations.</p>
<p>Note that we can alternatively use the high-density theory (Supp. Note) to compute the integration limit λ (<italic>q</italic><sub><italic>s</italic></sub> = 1<italic>/N</italic>) instead of resorting to simulations. However, since the true value deviates from the λ<sup><italic>h</italic></sup>(<italic>q</italic><sub><italic>s</italic></sub> = 1<italic>/N</italic>) derived from high-density theory, this approach introduces a constant bias (Fig. S6) when computing the integral in <xref ref-type="disp-formula" rid="eqn16">Eq. (16)</xref>. Therefore we used the simulation value λ<sup><italic>s</italic></sup>(<italic>q</italic><sub><italic>s</italic></sub> ≈ <italic>q</italic><sub>0</sub>) when producing Fig. S6AB.</p>
<p>Next, we describe how each term within the integral of <xref ref-type="disp-formula" rid="eqn15">Eq. (15)</xref> was numerically estimated. First, we calculated <inline-formula><inline-graphic xlink:href="529673v4_inline79.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with a similar method described in <xref ref-type="sec" rid="s4g1">section 4.7.1</xref>. Briefly, we calculated <italic>q</italic><sub>0</sub>(λ) for density <inline-formula><inline-graphic xlink:href="529673v4_inline80.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>q</italic><sub><italic>s</italic></sub>(λ) for density <inline-formula><inline-graphic xlink:href="529673v4_inline80a.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and then used the finite difference <inline-formula><inline-graphic xlink:href="529673v4_inline81.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Second, <inline-formula><inline-graphic xlink:href="529673v4_inline82.gif" mime-subtype="gif" mimetype="image"/></inline-formula> was evaluated at<inline-formula><inline-graphic xlink:href="529673v4_inline83.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where <italic>i</italic> = 0, 1, 2,…,<italic>k</italic> − 1, and we used <italic>k</italic> = 20. Finally, we performed a cubic spline interpolation of the term<inline-formula><inline-graphic xlink:href="529673v4_inline84.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and obtained the theoretical CI by an integration of <xref ref-type="disp-formula" rid="eqn15">Eq. (15)</xref>. Fig. S6A,B shows a comparison between theoretical CI and that obtained by numerical simulations of ERM (<xref ref-type="sec" rid="s4g1">section 4.7.1</xref>).</p>
</sec>
</sec>
<sec id="s4h">
<label>4.8</label>
<title>Fitting ERM to data</title>
<sec id="s4h1">
<label>4.8.1</label>
<title>Estimating the ERM parameters</title>
<p>Our ERM model has 4 parameters: <italic>µ</italic> and <italic>ϵ</italic> dictate the kernel function<inline-formula><inline-graphic xlink:href="529673v4_inline85.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, whereas the box size <italic>L</italic> and the embedding dimension <italic>d</italic> determine the neuronal density <italic>ρ</italic>. In the following, we describe an approximate method to estimate these parameters from pairwise correlations measured experimentally <inline-formula><inline-graphic xlink:href="529673v4_inline86.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We proceed by deriving a relationship between the correlation probability density distribution <italic>h</italic>(<italic>R</italic>) and the pairwise distance probability density distribution <inline-formula><inline-graphic xlink:href="529673v4_inline87.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in the functional space, from which the parameters of the ERM can be estimated.</p>
<p>Consider a distribution of neurons in the functional space with a coordinate distribution<inline-formula><inline-graphic xlink:href="529673v4_inline88.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The pairwise distance density function <italic>g</italic>(<italic>u</italic>) is related to the spatial point density by the following formula:
<disp-formula id="eqn17">
<graphic xlink:href="529673v4_eqn17.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
For ease of notation, we subsequently omit the region of integration, which is the same as here. In the case of a uniform distribution,<inline-formula><inline-graphic xlink:href="529673v4_inline89.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For other spatial distributions, <xref ref-type="disp-formula" rid="eqn17">Eq. (17)</xref> cannot be explicitly evaluated. We therefore make a similar approximation by focusing on a small pairwise distance (i.e., large correlation):
<disp-formula id="eqn18">
<graphic xlink:href="529673v4_eqn18.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
By a change of variables:
<disp-formula id="ueqn2">
<graphic xlink:href="529673v4_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<xref ref-type="disp-formula" rid="eqn17">Eq. (17)</xref> can be rewritten as
<disp-formula id="eqn19">
<graphic xlink:href="529673v4_eqn19.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>S</italic><sub><italic>d</italic>−1</sub>(<italic>u</italic>) is the surface area of <italic>d</italic> − 1 sphere with radius <italic>u</italic>.</p>
<p>With the approximate power-law kernel function<inline-formula><inline-graphic xlink:href="529673v4_inline90.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, the probability density function of pairwise correlation <italic>h</italic>(<italic>R</italic>) is given by:
<disp-formula id="eqn20">
<graphic xlink:href="529673v4_eqn20.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Taking the logarithm on both sides
<disp-formula id="eqn21">
<graphic xlink:href="529673v4_eqn21.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<xref ref-type="disp-formula" rid="eqn21">Eq. (21)</xref> is the key formula for ERM parameters estimation. In the case of a uniform spatial distribution,<inline-formula><inline-graphic xlink:href="529673v4_inline91.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For a given dimension <italic>d</italic>, we can therefore estimate <italic>µ</italic> and (<italic>ϵ/L</italic>)<sup><italic>d</italic></sup> separately by fitting <italic>h</italic>(<italic>R</italic>) on the log-log scale using the linear least squares. Lastly, we fit the distribution of <italic>σ</italic><sup>2</sup> (the diagonal entries of the covariance matrix <italic>C</italic>) to a log-normal distribution by estimating the maximum likelihood.</p>
<p>There is a redundancy between the unit of the functional space (using a rescaled <italic>ϵ</italic><sub><italic>δ</italic></sub> <italic>ϵ/δ</italic>) and the unit of <inline-formula><inline-graphic xlink:href="529673v4_inline92.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (using a rescaled<inline-formula><inline-graphic xlink:href="529673v4_inline93.gif" mime-subtype="gif" mimetype="image"/></inline-formula>), thus <italic>ϵ</italic> and <italic>L</italic> are a pair of redundant parameters: once <italic>ϵ</italic> is given, <italic>L</italic> is also determined. We set <italic>ϵ</italic> = 0.03125 throughout the article. In summary, for a given dimension <italic>d</italic> and <italic>ϵ, µ</italic> of <inline-formula><inline-graphic xlink:href="529673v4_inline94.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqn11">Eq. (11)</xref>), the distribution of <italic>σ</italic><sup>2</sup> (<xref ref-type="sec" rid="s2b">section 2.2</xref>) and <italic>ρ</italic> (or equivalently <italic>L</italic>) (<xref ref-type="sec" rid="s2b">section 2.2</xref>) can be fitted by comparing the distribution of pairwise correlations in experimental data and ERM. Furthermore, knowing (<italic>ϵ/L</italic>)<sup><italic>d</italic></sup> enables us to determine <italic>a fundamental dimensionless parameter</italic>
<disp-formula id="ueqn3">
<graphic xlink:href="529673v4_ueqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
which tells us whether the experimental data are better described by the high-density theory or the Gaussian variational method (Supp. Note). Indeed, the fitted <italic>ρ ϵ</italic> ∼<sup><italic>d</italic></sup> 10<sup>−3</sup> − 10<sup>0</sup> is much smaller than 1, consistent with our earlier conclusion that neural data are better described by an ERM model in the intermediate-density regime.</p>
<p>Notably, we found that a smaller embedding dimension <italic>d</italic> ≤5 gave a better fit to the overall pairwise correlation distribution. The following is an empirical explanation. As <italic>d</italic> grows, to best fit the slope of log <italic>h</italic>(<italic>R</italic>) − log <italic>R, µ</italic> will also grow. However, for very high dimensions <italic>d</italic>, the y-intercept would become very negative, or equivalently, the fitted correlation would become extremely small. This can be verified by examining the leading order log <italic>R</italic> independent term in <xref ref-type="disp-formula" rid="eqn21">Eq. (21)</xref>, which can be approximated as<inline-formula><inline-graphic xlink:href="529673v4_inline95.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. It becomes very negative for large <italic>d</italic> since <italic>ϵ</italic> ≪ <italic>L</italic> by construction. Throughout this article, we use <italic>d</italic> =2 when fitting the experimental data with our ERM model.</p>
<p>The above calculation can be extended to the cases where the coordinate distribution <inline-formula><inline-graphic xlink:href="529673v4_inline96.gif" mime-subtype="gif" mimetype="image"/></inline-formula> becomes dependent on other parameters. To estimate the parameters in coordinate distributions that can generate ERMs with a similar pairwise correlation distribution (Fig. S9), we fixed the integral value <inline-formula><inline-graphic xlink:href="529673v4_inline97.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Consider, for example, a transformation of the uniform coordinate distribution to the normal distribution <inline-formula><inline-graphic xlink:href="529673v4_inline98.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in ℝ<sup>2</sup>. We imposed<inline-formula><inline-graphic xlink:href="529673v4_inline99.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For the log-normal distribution, a similar calculation led to <inline-formula><inline-graphic xlink:href="529673v4_inline100.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The numerical values for these parameters are shown in <xref ref-type="sec" rid="s4j">section 4.10</xref>. However, note that due to the approximation we used (<xref ref-type="disp-formula" rid="eqn18">Eq. (18)</xref>), our estimate of the ERM parameters becomes less accurate if the density function <inline-formula><inline-graphic xlink:href="529673v4_inline101.gif" mime-subtype="gif" mimetype="image"/></inline-formula> changes rapidly over a short distance in the functional space. More sophisticated methods, such as grid search, may be needed to tackle such a scenario.</p>
<p>After determining the parameters of the ERM, we first examine the spectrum of the ERM with uniformly distributed random functional coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline102.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (Fig. S10M-R). Second, we use <inline-formula><inline-graphic xlink:href="529673v4_inline103.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to translate experimental pairwise correlations into pairwise distances for all neurons in the functional space (Fig. S11, Fig. S10G-L). The embedding coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline104.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in the functional space can then be solved through Multidimensional Scaling (MDS) by minimizing the Sammon error (<xref ref-type="sec" rid="s4h3">section 4.8.3</xref>). The similarity between the spectra of the uniformly distributed coordinates (Fig. S10M-R) and those of the embedding coordinates (Fig. S10G-L) is also consistent with the notion that specific coordinate distributions in the functional space have little impact on the shape of the eigenspectrum (Fig. S9).</p>
</sec>
<sec id="s4h2">
<label>4.8.2</label>
<title>Nonnegativity of data covariance</title>
<p>To use ERM to model the covariance matrix, the pairwise correlation is given by a <italic>non-negative</italic> kernel function <inline-formula><inline-graphic xlink:href="529673v4_inline105.gif" mime-subtype="gif" mimetype="image"/></inline-formula> that monotonically decreases with the distance between neurons in the functional space. This nonnegativeness brings about a potential issue when applied to experimental data, where, in fact, a small fraction of pairwise correlations/covariances are negative. We have verified that the spectrum of the data covariance matrix (Fig. S18) remains virtually unchanged when replacing these negative covariances with zero (Fig. S18). This confirms that the ERM remains a good model when the neural dynamics is in a regime where pairwise covariances are mostly positive (<xref ref-type="bibr" rid="c50">50</xref>) (see also Fig. S2B, Fig. S2B-D).</p>
</sec>
<sec id="s4h3">
<label>4.8.3</label>
<title>Multidimensional Scaling (MDS)</title>
<p>With the estimated ERM parameters (<italic>μ</italic> in <inline-formula><inline-graphic xlink:href="529673v4_inline106.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and the box size <italic>L</italic> for given <italic>ϵ</italic> and <italic>d</italic>, see <xref ref-type="sec" rid="s4h1">section 4.8.1</xref>), we performed MDS to infer neuronal coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline107.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in functional space. First, we computed a pairwise correlation <inline-formula><inline-graphic xlink:href="529673v4_inline108.gif" mime-subtype="gif" mimetype="image"/></inline-formula> from the data covariances. Next, we calculated the pairwise distance, denoted by <inline-formula><inline-graphic xlink:href="529673v4_inline109.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, by computing the inverse function of <inline-formula><inline-graphic xlink:href="529673v4_inline110.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with respect to the absolute value of<inline-formula><inline-graphic xlink:href="529673v4_inline111.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We used the absolute value |<italic>R</italic><sub><italic>ij</italic></sub> | instead of <italic>R</italic><sub><italic>ij</italic></sub> as a small percentage of <italic>R</italic><sub><italic>ij</italic></sub> are negative (Fig. S2A-D) where the distance is undefined. This substitution by the absolute value serves as a simple workaround for the issue and is only used here in the analysis to infer the neuronal coordinates by MDS. Finally, we estimated the embedding coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline112.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for each neuron by the SMACOF algorithm (Scaling by MAjorizing a COmplicated Function), which minimizes the Sammon error
<disp-formula id="eqn22">
<graphic xlink:href="529673v4_eqn22.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="529673v4_inline113.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the pairwise distance in the embedding space calculated above.</p>
<p>To reduce errors at large distances (i.e., small correlations with <italic>R</italic><sub><italic>ij</italic></sub> <italic>&lt; f</italic>(<italic>L</italic>), where <italic>L</italic> is the estimated box size), we performed a soft cut-off at a large distance:
<disp-formula id="eqn23">
<graphic xlink:href="529673v4_eqn23.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
During the optimization process, we started at the embedding coordinates estimated by the classical MDS (<xref ref-type="bibr" rid="c45">45</xref>), with an initial sum of squares distance error that can be calculated directly, and ended with an error or its gradient smaller than 10<sup>−4</sup>.</p>
<p>The fitted ERM with the embedding coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline114.gif" mime-subtype="gif" mimetype="image"/></inline-formula> reproduced the experimental covariance matrix including the cluster structures (Fig. S11) and its sampling eigenspectra (Fig. S10).</p>
</sec>
</sec>
<sec id="s4i">
<label>4.9</label>
<title>Canonical-Correlation Analysis (CCA)</title>
<p>Here we briefly explain the CCA method (<xref ref-type="bibr" rid="c61">61</xref>) for completeness. The basis vectors <inline-formula><inline-graphic xlink:href="529673v4_inline115.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="529673v4_inline116.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, in functional and anatomical space, respectively, were found by maximizing the correlation <inline-formula><inline-graphic xlink:href="529673v4_inline117.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. These basis vectors satisfy the condition that the projections of the neuron coordinates along them, <inline-formula><inline-graphic xlink:href="529673v4_inline118.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="529673v4_inline119.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, are maximally correlated among all possible choices of <inline-formula><inline-graphic xlink:href="529673v4_inline120.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="529673v4_inline121.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Here <inline-formula><inline-graphic xlink:href="529673v4_inline122.gif" mime-subtype="gif" mimetype="image"/></inline-formula> represent the coordinates in functional and anatomical spaces, respectively. The resulting maximum correlation is <italic>R</italic><sub>CCA</sub>. To check the significance of the canonical correlation, we shuffled the functional space coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline123.gif" mime-subtype="gif" mimetype="image"/></inline-formula> across neurons’ identity and re-calculated the canonical correlation with the anatomical coordinates, as shown in Fig. S13.</p>
<p>To study the effect of functional-anatomical relation described by <italic>R</italic><sub>CCA</sub> in the ERM model, we generated three dimensional anatomical coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline124.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and two dimensional functional coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline125.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for each neuron which are jointly five-dimensional zero-mean multivariate Gaussian random variables. The coordinates are independent among each other, except for the first dimension <inline-formula><inline-graphic xlink:href="529673v4_inline126.gif" mime-subtype="gif" mimetype="image"/></inline-formula> of the functional coordinates and the first dimension <inline-formula><inline-graphic xlink:href="529673v4_inline127.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, which are assigned to have a correlation coefficient equals to <italic>R</italic><sub>CCA</sub>. The variances of the coordinates are <inline-formula><inline-graphic xlink:href="529673v4_inline128.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="529673v4_inline129.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for the numerics in Fig. S21. Under this construction, the first canonical correlation between the anatomical and functional coordinates equals <italic>R</italic><sub>CCA</sub>, and the first canonical direction <inline-formula><inline-graphic xlink:href="529673v4_inline130.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in the anatomical space is (1, 0, 0)<sup><italic>T</italic></sup> and the first canonical direction <inline-formula><inline-graphic xlink:href="529673v4_inline131.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in the functional space is (1, 0)<sup><italic>T</italic></sup>.</p>
</sec>
<sec id="s4j">
<label>4.10</label>
<title>Extensions of ERM and factors not affecting the scale invariance</title>
<p>In Fig. S9 we considered five additional types of spatial density distributions (coordinate distributions) in functional space and two additional functional space geometries. We examined the points distributed according to the uniform distribution<inline-formula><inline-graphic xlink:href="529673v4_inline132.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, the normal distribution <inline-formula><inline-graphic xlink:href="529673v4_inline133.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and the log-normal distribution <inline-formula><inline-graphic xlink:href="529673v4_inline134.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We used the method described in Methods <xref ref-type="sec" rid="s4h1">section 4.8.1</xref> to adjust the parameters of the coordinate distributions based on the uniform distribution case, so that they all generate similar pairwise correlation distributions. The relationships between these parameters are described in Methods <xref ref-type="sec" rid="s4h1">section 4.8.1</xref>. In Fig. S9B, we used the following parameters: <italic>d</italic> = 2; <italic>L</italic> = 10 for the uniform distribution; <italic>µ</italic><sub><italic>p</italic></sub> = 0, <italic>σ</italic><sub><italic>p</italic></sub> = 2.82 for the normal distribution; and <italic>µ</italic><sub><italic>p</italic></sub> = 2, <italic>σ</italic><sub><italic>p</italic></sub> = 0.39 for the log-normal distribution.</p>
<p>Second, we introduced multiple clusters of neurons in the functional space, with each cluster uniformly distributed in a box. We considered three arrangements: (<xref ref-type="bibr" rid="c1">1</xref>) two closely situated clusters (with a box size of <inline-formula><inline-graphic xlink:href="529673v4_inline135.gif" mime-subtype="gif" mimetype="image"/></inline-formula> the distance between two cluster centers being <italic>L</italic><sub><italic>c</italic></sub> = <italic>L</italic>), (<xref ref-type="bibr" rid="c2">2</xref>) two distantly situated clusters (with a box size of <inline-formula><inline-graphic xlink:href="529673v4_inline136.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and the distance between clusters <italic>L</italic><sub><italic>c</italic></sub> = 4<italic>L</italic>), and three clusters arranged symmetrically in an equilateral triangle (with a box size of <inline-formula><inline-graphic xlink:href="529673v4_inline137.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and the distance between clusters <italic>L</italic><sub><italic>c</italic></sub> = <italic>L</italic>).</p>
<p>Finally, we examined the scenario in which the points were uniformly distributed on the surface of a sphere (4<italic>πl</italic><sup>2</sup> = <italic>L</italic><sup>2</sup>, <italic>l</italic> being the radius of the sphere) or a hemisphere (2<italic>πl</italic><sup>2</sup> = <italic>L</italic><sup>2</sup>) embedded in ℝ<sup>3</sup> (the pairwise distance is that in ℝ<sup>3</sup>). It should be noted that both cases have the same surface area as the 2D box.</p>
</sec>
<sec id="s4k">
<label>4.11</label>
<title>Analyzing the effects of removing neural activity data during hunting</title>
<p>To identify and remove the time frames corresponding to putative hunting behaviors, the following procedure was used. The hunting interval was defined as 10 frames (1 sec) preceding the onset of an eye convergence (see Methods <xref ref-type="sec" rid="s4a1">section 4.1.1</xref>) to 10 frames after the offset of this eye convergence. These frames were then excluded from the data before recalculating the covariance matrix (see Methods <xref ref-type="sec" rid="s4c">section 4.3</xref>) and subsequently the sampled eigenspectra (Fig. S15B, Fig. S16B,D,F,H). As a control to the removal of the hunting frame, an equal number of time frames that are not within those hunting intervals were randomly selected and then removed and analyzed (Fig. S15C, Fig. S16A,C,E,G). The number of hunting interval frames and total recording frames for five fish exhibiting hunting behaviors are as follows: fish 1 - 268/7495, fish 2 - 565/9774, fish 3 - 2734/13904, fish 4 - 843/7318 and fish 5 - 1066/7200. Fish 6 (number of time frames: 9388) was not exposed to a prey stimulus and, therefore, was excluded from the analysis.</p>
<p>To assess the impact of hunting removal on CI, we calculated the CI of the covariance matrix using all neurons recorded in each fish (without sampling to 1024 neurons). For the control case, we repeated the removal of the nonhunting frame 10 times to generate 10 covariance matrices and computed their CIs. We used a one-sample t-test to determine the level of statistical significance between the control CIs and the CI obtained after removal of the hunting frame.</p>
<p>Using fitted ERM parameters by full data, we performed a MDS on the control data and hunting-removed data to infer the functional coordinates. Note that the functional coordinates inferred by MDS are not unique: rotations and translations give equivalent solutions. For visualization purposes (not needed for analysis), we first used the Umeyama algorithm to optimally align the functional coordinates of control and hunting-removed data.</p>
<p>To identify distinct clusters within the functional coordinates, we fit Gaussian Mixture Models (GMMs) using the “GaussianMixtures” package in Julia. We chose the number of clusters <italic>K</italic> based on giving the smallest Bayesian Information Criterion (BIC) score. After fitting the GMMs, a list of probabilities <italic>p</italic><sub><italic>ik</italic></sub>, <italic>k</italic> = 1, 2,…,<italic>K</italic> was given for each neuron <italic>i</italic> specifying the probability of the neuron belonging to the cluster <italic>k</italic>. The mean and covariance parameters were estimated for each Gaussian distributed cluster. For visualization (but not for analysis), a neuron was colored according to cluster <italic>k</italic><sup>*</sup> where <italic>k</italic><sup>*</sup> = argmax<sub>1≤<italic>k</italic>≤<italic>K</italic></sub> <italic>p</italic><sub><italic>ik</italic></sub>.</p>
<p>We used the following method to measure the size of the cluster and its fold change. For a 2D (recall <italic>d</italic> =2 in our ERM) Gaussian distributed cluster, let us consider an ellipse centered on its mean, and its axes are aligned with the eigenvectors of its covariance matrix <italic>C</italic><sub>2×2</sub>. Let the eigenvalues of <italic>C</italic> be λ<sub>1</sub>, λ<sub>2</sub>. Then we set the length of the half-axis of the ellipse to be<inline-formula><inline-graphic xlink:href="529673v4_inline138.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, respectively. Here <italic>c&gt;</italic> 0 is a constant determined below. Note that the ellipse axes correspond to linear combinations of 2D Gaussian random variables that are independent and λ<sub><italic>i</italic></sub>’s are the variance of these linear combinations. From this fact, it is straightforward to show that the probability that a sample from the Gaussian cluster lies in the above ellipse depends only on <italic>c</italic>, that is, <inline-formula><inline-graphic xlink:href="529673v4_inline139.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and not on the shape of the cluster. So, the ellipse represents a region that covers a fixed proportion of neurons for any cluster, and its area can be used as a measure for the size of the Gaussian cluster. Note that the area of the ellipse is<inline-formula><inline-graphic xlink:href="529673v4_inline140.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. In Fig. S17, we plot the ellipses to help visualize the clusters and their changes. We choose <italic>c</italic> such that the ellipse covers 95% of the probability (that is, the fraction of neurons belonging to the cluster).</p>
<p>In the control functional map where we fit the GMMs, we directly calculated the size measure <inline-formula><inline-graphic xlink:href="529673v4_inline141.gif" mime-subtype="gif" mimetype="image"/></inline-formula> from the estimated covariance <italic>C</italic> for each Gaussian cluster. In the hunting-removed functional map, we needed to estimate the covariance <italic>C</italic>′ for neurons belonging to a cluster <italic>k</italic> under the new coordinates (we assume that the new distribution can still be approximated by a Gaussian distribution). We performed this estimation in a probabilistic manner to avoid issues of highly overlapping clusters where the cluster membership could be ambiguous for some neurons. First, we estimated the center/mean of the new Gaussian distribution by
<disp-formula id="ueqn4">
<graphic xlink:href="529673v4_ueqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here the summation goes over all the <italic>N</italic> neurons in the functional space and <italic>p</italic><sub><italic>ik</italic></sub> is the membership probability defined above, and (<italic>x</italic><sub><italic>i</italic></sub>, <italic>y</italic><sub><italic>i</italic></sub>) is the coordinate of neuron <italic>i</italic> in the hunting-removed map. Similarly, we can use a weighted average to estimate the entries in the covariance matrix<inline-formula><inline-graphic xlink:href="529673v4_inline142.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For example,
<disp-formula id="ueqn5">
<graphic xlink:href="529673v4_ueqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Then we calculated the size of the cluster on the new map as<inline-formula><inline-graphic xlink:href="529673v4_inline143.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Finally, we computed the fold change in size as <inline-formula><inline-graphic xlink:href="529673v4_inline144.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
</sec>
<sec id="s4l">
<label>4.12</label>
<title>Renormalization-Group (RG) Approach</title>
<p>Here we briefly summarize the RG approach used in (<xref ref-type="bibr" rid="c20">20</xref>) and elucidate the adjustments required when applying the RG approach to ERM. The method consists of two stages: (i) iterative agglomerate clustering of neurons, and (ii) computing the spectrum of a block of the <italic>original</italic> covariance matrix corresponding to a cluster of the desired size based on the previous clustering result.</p>
<p>During each iterative coarse-graining procedure denoted <italic>k</italic>, Pearson’s correlation coefficients for each pair of neurons are calculated. This yields the maximum correlated pair, designated as <italic>a</italic> and <italic>b</italic>. These pairs are combined according to the following equation:
<disp-formula id="eqn24">
<graphic xlink:href="529673v4_eqn24.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<inline-formula><inline-graphic xlink:href="529673v4_inline145.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is used to normalize the average to ensure that the nonzero activity of the new variables <inline-formula><inline-graphic xlink:href="529673v4_inline146.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is equal to one.</p>
<p>When the RG approach is applied directly to the ERM, the process differs slightly. Instead of combining neural activity, we merge correlation matrices to traverse different scales. During the <italic>k</italic>th iteration, we compute the coarse-grained covariance as
<disp-formula id="eqn25">
<graphic xlink:href="529673v4_eqn25.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
and the variance as
<disp-formula id="eqn26">
<graphic xlink:href="529673v4_eqn26.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Following these calculations, we normalize the coarse-grained covariance matrix to ensure that all variances are equal to one. Note these coarse-grained covariances are only used in stage (i) and note used to calculate the spectrum.</p>
<p>In stage (ii), we calculate the eigenspectra of the sub-covariance matrices across different cluster sizes as described in (<xref ref-type="bibr" rid="c20">20</xref>). Let <italic>N</italic><sub>0</sub> = 2<sup><italic>n</italic></sup> be the original number of neurons. To reduce it to size <italic>N</italic> = <italic>N</italic><sub>0</sub><italic>/</italic>2<sup><italic>k</italic></sup> = 2<sup><italic>n</italic>−<italic>k</italic></sup>, consider the coarse-grained neurons in step <italic>n − k</italic> in stage (i). Each coarse-grained neuron is a cluster of 2<sup><italic>n</italic>−<italic>k</italic></sup> neurons. We then calculate spectrum of the block of the original covariance matrix corresponding to neurons of each cluster (there are 2<sup><italic>k</italic></sup> such blocks). Lastly, an average of these 2<sup><italic>k</italic></sup> spectra is computed.</p>
<p>To illustrate the RG approach, consider a hypothetical scenario where a set of eight neurons, labeled 1, 2, 3, …, 7, 8, are subjected to a two-step clustering procedure. In the first step, neurons are grouped based on their maximum correlation pairs, resulting in the formation of four pairs: <italic>{</italic>1, 2 <italic>}, {</italic>3, 4 <italic>}, {</italic>5, 6 <italic>}</italic>, and <italic>{</italic>7, 8 <italic>}</italic>. Subsequently, the neurons are further grouped into two clusters based on the results of the RG step mentioned above. Specifically, if the correlation between the coarse-grained variables of the pair <italic>{</italic>1, 2 <italic>}</italic> and the pair <italic>{</italic>3, 4 <italic>}</italic> is found to be the largest among all other pairs of coarse-grained variables, the first group consists of neurons <italic>{</italic>1, 2, 3, 4 <italic>}</italic>, while the second group contains neurons <italic>{</italic>5, 6, 7, 8 <italic>}</italic>. Next, take the size of the cluster <italic>N</italic> =4 for example. The eigenspectra of the covariance matrices of the four neurons within each cluster are computed. This results in two eigenspectra, one for each cluster. The correlation matrices used to compute the eigenspectra of different sizes do not involve coarse-grained neurons. It is the real neurons 1, 2, 3, …, 7, 8, but with expanding cluster sizes. Finally, the average of the eigenspectra of the two clusters is calculated.</p>
</sec>
<sec id="s4m">
<label>4.13</label>
<title>Spectrum of three types of sampling procedures in ERM model</title>
<p>In <xref ref-type="sec" rid="s2d">section 2.4</xref> we have considered three types of sampling procedures: random sampling (RSap), spatial sampling in the anatomical space (ASap, e.g., recording neurons in a brain region), and spatial sampling in the functional space (FSap), namely spatial sampling in functional space by subdividing the space into smaller regions, is equivalent to the previously reported renormalization group (RG) inspired process (<xref ref-type="bibr" rid="c62">62</xref>, <xref ref-type="bibr" rid="c63">63</xref>). Here we consider the relationship between the spectrum of three types of sampling procedures.</p>
<p>We assume a uniform random distribution of neurons in a <italic>d</italic>-dimensional functional space, [0, <italic>L</italic>]<sup><italic>d</italic></sup>. For RSap procedures, the resulting neuronal density <italic>ρ</italic><sub><italic>R</italic></sub> is reduced to <italic>ρ</italic><sub><italic>R</italic></sub> = <italic>kρ</italic><sub>0</sub>, with <italic>k</italic> representing the sampling ratio (<italic>k</italic> = <italic>N/N</italic><sub>0</sub>) and <italic>ρ</italic><sub>0</sub> being the initial density. In contrast, FSap maintains the original density, <italic>ρ</italic><sub><italic>F</italic></sub> = <italic>ρ</italic><sub>0</sub>. This constancy in neuronal density under FSap ensures that the covariance eigenspectrum remains invariant across scales for any spatial correlation functions<inline-formula><inline-graphic xlink:href="529673v4_inline147.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, such as power law and exponential, as shown in Fig. S19A,B,D,E. In contrast, RSap reduces <italic>ρ</italic>, thus demanding more rigorous conditions to achieve a scale-invariant covariance spectrum (e.g., compare Fig. S19A and C).</p>
<p>Under ASap, sampled neurons are not spread out evenly in functional space, whereas our theoretical framework assumes a uniform distribution. To reconcile this discrepancy, we employ a uniform approximation of the neural distribution. This approach involves introducing an effective density, <italic>ρ</italic> ′, defined as the spatial average of the density function<inline-formula><inline-graphic xlink:href="529673v4_inline148.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. This adjustment allows our theoretical model to accommodate non-uniform distributions encountered in anatomically spatial sampling.
<disp-formula id="eqn27">
<graphic xlink:href="529673v4_eqn27.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="529673v4_inline149.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the normalized density distribution (see Methods <xref ref-type="sec" rid="s4h1">section 4.8.1</xref>).</p>
<p>using the Cauchy-Schwarz inequality, we have
<disp-formula id="eqn28">
<graphic xlink:href="529673v4_eqn28.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
thus <italic>ρ</italic>′ ≥ <italic>kρ</italic><sub>0</sub>.</p>
<p>According to the condition<inline-formula><inline-graphic xlink:href="529673v4_inline150.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, we have <italic>ρ</italic>′ ≤ <italic>ρ</italic><sub>0</sub>, intuitively, sampling within a uniformly distributed neuron population does not increase the density.</p>
<p>So we have <italic>ρ</italic><sub>0</sub> ≥ <italic>ρ</italic>′ <sub><italic>A</italic></sub> ≥ <italic>kρ</italic><sub>0</sub>, i.e., <italic>ρ</italic><sub><italic>F</italic></sub> ≥ <italic>ρ</italic>′ <sub><italic>A</italic></sub> ≥ <italic>ρ</italic><sub><italic>R</italic></sub>. Thus the spectrum ASap should be between FSap and RSap.</p>
</sec>
<sec id="s4n">
<label>4.14</label>
<title>Dimensions of three types of sampling procedures in ERM model</title>
<sec id="s4n1">
<label>4.14.1</label>
<title>Scaling of Dimensions through Random Sampling</title>
<p>Let us revisit the definition of the Participation Ratio (PR) dimension as defined in Equation <xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>:
<disp-formula id="eqn29">
<graphic xlink:href="529673v4_eqn29.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
During the random sampling process, the expected values <italic>E</italic>(<italic>σ</italic><sup>2</sup>), <italic>E</italic>(<italic>σ</italic><sup>4</sup>), and <inline-formula><inline-graphic xlink:href="529673v4_inline151.gif" mime-subtype="gif" mimetype="image"/></inline-formula> remain constant.</p>
<p>These constants allow for the estimation of the PR dimension across various scales using:
<disp-formula id="eqn30">
<graphic xlink:href="529673v4_eqn30.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here, <italic>k</italic> = <italic>N/N</italic><sub>0</sub> represents a scaling factor (fraction) associated with sampling. The key question is to understand how the dimensionality changes with <italic>k</italic>. Under random sampling, as <italic>k</italic> increases, the dimensionality will quickly approaches a saturating point defined by <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>.</p>
</sec>
<sec id="s4n2">
<label>4.14.2</label>
<title>Scaling of Dimensions through Functional Sampling</title>
<p>In this section, we leverage the uniform ERM model to estimate dimensions within the context of functional sampling, specifically focusing on the estimation of squared pairwise covariance <inline-formula><inline-graphic xlink:href="529673v4_inline152.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and dimensionality.</p>
<p>Adopting an approximation for a power-law kernel function <italic>f</italic> (<italic>x</italic>) ≈ <italic>ϵ</italic><sup><italic>μ</italic></sup> ∥<italic>x</italic>∥<sup>−<italic>µ</italic></sup> allows us to express the expected value of the squared covariance <inline-formula><inline-graphic xlink:href="529673v4_inline153.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as follows:
<disp-formula id="eqn31">
<graphic xlink:href="529673v4_eqn31.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
For a set subjected to functional sampling with a sampling fraction <italic>k</italic>, this procedure adjusts the size of the functional space in the ERM model by a factor of <italic>k</italic><sup>−1<italic>/d</italic></sup>. Consequently, the <inline-formula><inline-graphic xlink:href="529673v4_inline154.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for the sampled fraction <italic>k</italic> is given by:
<disp-formula id="eqn32">
<graphic xlink:href="529673v4_eqn32.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here we assume that <italic>E</italic>[<italic>σ</italic><sup>2</sup>] and <italic>E</italic>[<italic>σ</italic><sup>4</sup>] are constant across the sampling process. This model enables the estimation of the ratio <italic>µ/d</italic> as detailed in the Methods <xref ref-type="sec" rid="s4h1">section 4.8.1</xref>.
<disp-formula id="eqn33">
<graphic xlink:href="529673v4_eqn33.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
In the large <italic>N</italic> limit, we observe distinct behaviors in the evolution of dimensionality in both theory and data: it saturates in RSap (dashed line in <xref rid="fig5" ref-type="fig">Fig. 5D</xref>), namely <inline-formula><inline-graphic xlink:href="529673v4_inline155.gif" mime-subtype="gif" mimetype="image"/></inline-formula> defined in <xref ref-type="disp-formula" rid="eqn1">Eq. (1)</xref>, whereas it follows a different scaling relationship <inline-formula><inline-graphic xlink:href="529673v4_inline156.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in FSap (solid line in <xref rid="fig5" ref-type="fig">Fig. 5D</xref>).</p>
</sec>
<sec id="s4n3">
<label>4.14.3</label>
<title>Comparative Analysis of PR Dimension Across sampling Techniques</title>
<p>This section examines the behavior of the Participation Ratio (PR) dimension under three sampling techniques: anatomical sampling, random sampling, and functional sampling. We show that the average PR dimension following anatomical sampling occupies a middle ground between the extremes presented by random and functional sampling.</p>
<p>The PR dimension, denoted <italic>D</italic><sub>PR</sub>, reflects the sampling impact and depends on the distribution <inline-formula><inline-graphic xlink:href="529673v4_inline157.gif" mime-subtype="gif" mimetype="image"/></inline-formula> of the functional coordinates <inline-formula><inline-graphic xlink:href="529673v4_inline158.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Defining the sampling fraction as <italic>k</italic> = 1<italic>/q</italic>, the mean <italic>D</italic><sub>PR</sub> is represented as:
<disp-formula id="eqn34">
<graphic xlink:href="529673v4_eqn34.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where the neuron set 1, 2, …,<italic>N</italic> is segmented into <italic>q</italic> clusters<inline-formula><inline-graphic xlink:href="529673v4_inline159.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, each comprising <inline-formula><inline-graphic xlink:href="529673v4_inline160.gif" mime-subtype="gif" mimetype="image"/></inline-formula> neurons.</p>
<p>The probability distribution <inline-formula><inline-graphic xlink:href="529673v4_inline161.gif" mime-subtype="gif" mimetype="image"/></inline-formula> corresponds to each cluster<inline-formula><inline-graphic xlink:href="529673v4_inline162.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The probability distribution for each cluster, <inline-formula><inline-graphic xlink:href="529673v4_inline163.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, emerges naturally from the sampling process.</p>
<p>The equivalence of the mean probability density function across the sampled clusters to the original set’s probability density function leads us to the condition:
<disp-formula id="eqn35">
<graphic xlink:href="529673v4_eqn35.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
This condition is a direct consequence of the sampling process, ensuring that the aggregated probability density function of all sampled sets mirrors the overall density distribution of the neurons.</p>
<p>Applying the Lagrange multiplier method to optimize the mean <italic>D</italic><sub>PR</sub>:
<disp-formula id="eqn36">
<graphic xlink:href="529673v4_eqn36.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here <italic>L</italic>(<italic>p</italic>, λ) is the Lagrangian, <inline-formula><inline-graphic xlink:href="529673v4_inline164.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the Lagrange multiplier, we derive the optimal condition:
<disp-formula id="eqn37">
<graphic xlink:href="529673v4_eqn37.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
yielding:
<disp-formula id="eqn38">
<graphic xlink:href="529673v4_eqn38.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
At the optimal mean <italic>D</italic><sub>PR</sub>, each <inline-formula><inline-graphic xlink:href="529673v4_inline165.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is equivalent, leading to <inline-formula><inline-graphic xlink:href="529673v4_inline166.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (representative of random sampling). Hence, the mean <italic>D</italic><sub>PR</sub> post-random sampling sets the upper limit for the mean <italic>D</italic><sub>PR</sub> after anatomical sampling.</p>
<p>Let us investigate the lower bound of the mean PR dimension with the ERM model. For the minimization of mean(<italic>D</italic><sub>PR</sub>), a key requirement is the functional spatial proximity of neurons within the same cluster, in other word, the neuron set should be distinctly separated in functional space. Consequently, achieving the minimum mean PR dimension necessitates a functional sampling strategy.</p>
</sec>
<sec id="s4n4">
<label>4.14.4</label>
<title>Simulating CCA and anatomical sampling</title>
<p>In this section, we estimate the dimensions of the anatomically sampled neuron set. For simplicity, we assume that the functional coordinates of neurons, <italic>X</italic><sub><italic>i</italic></sub>, and the anatomical coordinates of neurons, <italic>Y</italic><sub><italic>i</italic></sub>, both follow a multivariate Gaussian distribution. We define anatomical sampling, which involves sampling on <italic>Y</italic><sub><italic>i</italic></sub>, along a direction chosen arbitrarily and denote this direction as <italic>Y</italic> <sup><italic>A</italic></sup>. Subsequently, we perform sampling on <italic>X</italic><sub><italic>i</italic></sub> in the direction denoted by <italic>X</italic><sup><italic>A</italic></sup>, which is determined to have the highest correlation with <italic>Y</italic> <sup><italic>A</italic></sup> according to Canonical Correlation Analysis (CCA). This process effectively mimics the scenario of functional sampling.</p>
<p>The key to calculating the PR dimension involves computing the expected value<inline-formula><inline-graphic xlink:href="529673v4_inline167.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. In the ERM model, the distribution of <italic>C</italic><sub><italic>ij</italic></sub> can be estimated by the distribution of points in the functional space. This allows for the calculation of the PR dimension across anatomical sampling by comparing the distribution of <italic>X</italic><sub><italic>i</italic></sub> after anatomical sampling with that after functional sampling.</p>
<p>To approximate, we need to calculate the functional coordinate probability distribution<inline-formula><inline-graphic xlink:href="529673v4_inline168.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, which is the distribution of the <italic>i</italic><sup>th</sup> neuron cluster after anatomical sampling. Here, <inline-formula><inline-graphic xlink:href="529673v4_inline169.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="529673v4_inline170.gif" mime-subtype="gif" mimetype="image"/></inline-formula> denote the functional and anatomical coordinates of the <italic>i</italic><sup>th</sup> neuron cluster after anatomical sampling, respectively. <italic>Y</italic> <sup><italic>C</italic></sup> represents the selected direction in anatomical space, and <inline-formula><inline-graphic xlink:href="529673v4_inline171.gif" mime-subtype="gif" mimetype="image"/></inline-formula> denotes the <italic>ik</italic><sup>th</sup> quantile of <italic>Y</italic> <sup><italic>C</italic></sup>, where <italic>k</italic> is the sampled fraction.</p>
<p>We consider only the projection of the functional coordinate onto the direction <italic>X</italic><sup><italic>A</italic></sup>, which exhibits the highest correlation, denoted by <italic>R</italic><sub>ASap</sub>, with <italic>Y</italic> <sup><italic>A</italic></sup>. Specifically, when selecting the anatomical direction as the first CCA direction, the correlation between <italic>X</italic><sup><italic>A</italic></sup> and <italic>Y</italic> <sup><italic>A</italic></sup> reaches its maximum, such that <italic>R</italic><sub>ASap</sub> = <italic>R</italic><sub>CCA</sub>. In this case, anatomical sampling results in the minimization of the dimensionality. Note the following relationships and distributions:
<disp-formula id="eqn39">
<graphic xlink:href="529673v4_eqn39.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn40">
<graphic xlink:href="529673v4_eqn40.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn41">
<graphic xlink:href="529673v4_eqn41.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The conditional probability distribution <inline-formula><inline-graphic xlink:href="529673v4_inline172.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is equivalent to the distribution of the sum of <inline-formula><inline-graphic xlink:href="529673v4_inline173.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>X</italic><sub>0</sub>, where <inline-formula><inline-graphic xlink:href="529673v4_inline174.gif" mime-subtype="gif" mimetype="image"/></inline-formula>:
<disp-formula id="eqn42">
<graphic xlink:href="529673v4_eqn42.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn43">
<graphic xlink:href="529673v4_eqn43.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The distribution of <inline-formula><inline-graphic xlink:href="529673v4_inline175.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is represented by a non-elementary function, complicating direct analysis. To facilitate approximation, we model <inline-formula><inline-graphic xlink:href="529673v4_inline176.gif" mime-subtype="gif" mimetype="image"/></inline-formula> using a normal distribution with equivalent variance. Although calculating the variance of <inline-formula><inline-graphic xlink:href="529673v4_inline177.gif" mime-subtype="gif" mimetype="image"/></inline-formula> directly presents challenges, assuming a uniform distribution for <italic>Y</italic> simplifies this task. Under this assumption, the variance of <inline-formula><inline-graphic xlink:href="529673v4_inline178.gif" mime-subtype="gif" mimetype="image"/></inline-formula> can be straightforwardly calculated as<inline-formula><inline-graphic xlink:href="529673v4_inline179.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Consequently, we approximate <inline-formula><inline-graphic xlink:href="529673v4_inline180.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="529673v4_inline181.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as follows:
<disp-formula id="eqn44">
<graphic xlink:href="529673v4_eqn44.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn45">
<graphic xlink:href="529673v4_eqn45.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Calculating the PR dimension directly from the distribution of <inline-formula><inline-graphic xlink:href="529673v4_inline182.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is difficult; thus, we approximate anatomical sampling with fraction <italic>k</italic> as functional sampling with fraction <italic>k</italic><sub><italic>f</italic></sub>, leading to:
<disp-formula id="eqn46">
<graphic xlink:href="529673v4_eqn46.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Using the equation for functional sampling <inline-formula><inline-graphic xlink:href="529673v4_inline183.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqn32">Eq. (32)</xref>):
<disp-formula id="eqn47">
<graphic xlink:href="529673v4_eqn47.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn48">
<graphic xlink:href="529673v4_eqn48.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
</sec>
</sec>
<sec id="d1e4617" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e4568">
<label>Supplementary figures comprises 21 supplementary figures. Supplementary note includes additional details of the theoretical calculations.</label>
<media xlink:href="supplements/529673_file03.pdf"/>
</supplementary-material>
<p><bold>Supplementary note</bold> includes additional details of the theoretical calculations and 3 supplementary figures.</p>
<p><bold>Supplementary video</bold> includes 1 supplementary video.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
    <p>We are grateful to Liqun Luo and Changsong Zhou for their helpful suggestions on our manuscript. QW thanks Hideaki Shimazaki for the suggestion that the functional space could be the feature space for sensory coding. QW thanks Jia Lou for improving the illustration in <xref rid="fig1" ref-type="fig">Figures 1</xref> and <xref rid="fig3" ref-type="fig">3</xref>. QW was supported by the STI2030-Major Projects 2022ZD0211900 and the NSFC-32071008 from the National Science Foundation of China. YH was supported by ECS-26303921 from the Research Grants Council of Hong Kong.</p>
</ack>
    <sec id="nt1">
        <title>Note</title>
        <p>This reviewed preprint has been updated to make minor edits in the Acknowledgements.</p>
    </sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Churchland</surname>, <given-names>M. M.</given-names></string-name>, <string-name><surname>Cunningham</surname>, <given-names>J. P.</given-names></string-name>, <string-name><surname>Kaufman</surname>, <given-names>M. T.</given-names></string-name>, <string-name><surname>Foster</surname>, <given-names>J. D.</given-names></string-name>, <string-name><surname>Nuyujukian</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Ryu</surname>, <given-names>S. I.</given-names></string-name>, and <string-name><surname>Shenoy</surname>, <given-names>K. V.</given-names></string-name></person-group> <article-title>Neural population dynamics during reaching</article-title>. <source>Nature</source>, <volume>487</volume>(<issue>7405</issue>):<fpage>51</fpage>–<lpage>56</lpage>, <month>July</month> <year>2012</year>. doi: <pub-id pub-id-type="doi">10.1038/nature11129</pub-id>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Rich</surname>, <given-names>P. D.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>A. K.</given-names></string-name>, and <string-name><surname>Sharpee</surname>, <given-names>T. O.</given-names></string-name></person-group> <article-title>Hippocampal spatial representations exhibit a hyperbolic geometry that expands with experience</article-title>. <source>Nature Neuroscience</source>, <volume>26</volume>(<issue>1</issue>):<fpage>131</fpage>–<lpage>139</lpage>, <month>Jan</month>. <year>2023</year>. doi: <pub-id pub-id-type="doi">10.1038/s41593-022-01212-4</pub-id>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kriegeskorte</surname>, <given-names>N.</given-names></string-name> and <string-name><surname>Wei</surname>, <given-names>X.-X.</given-names></string-name></person-group> <article-title>Neural tuning and representational geometry</article-title>. <source>Nature Reviews Neuroscience</source>, <volume>22</volume>(<issue>11</issue>): <fpage>703</fpage>–<lpage>718</lpage>, <year>2021</year>. doi: <pub-id pub-id-type="doi">10.1038/s41583-021-00502-3</pub-id>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chung</surname>, <given-names>S.</given-names></string-name> and <string-name><surname>Abbott</surname>, <given-names>L. F.</given-names></string-name></person-group> <article-title>Neural population geometry: An approach for understanding biological and artificial neural networks</article-title>. <source>Current opinion in neurobiology</source>, <volume>70</volume>:<fpage>137</fpage>–<lpage>144</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cunningham</surname>, <given-names>J. P.</given-names></string-name> and <string-name><surname>Yu</surname>, <given-names>B. M.</given-names></string-name></person-group> <article-title>Dimensionality reduction for large-scale neural recordings</article-title>. <source>Nature Neuroscience</source>, <volume>17</volume>(<issue>11</issue>): <fpage>1500</fpage>–<lpage>1509</lpage>, <month>Nov</month>. <year>2014</year>. doi: <pub-id pub-id-type="doi">10.1038/nn.3776</pub-id>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stringer</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Pachitariu</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Steinmetz</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Carandini</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Harris</surname>, <given-names>K. D.</given-names></string-name></person-group> <article-title>High-dimensional geometry of population responses in visual cortex</article-title>. <source>Nature</source>, <year>2019</year>. doi: <pub-id pub-id-type="doi">10.1038/s41586-019-1346-5</pub-id>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Si</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Kanwal</surname>, <given-names>J. K.</given-names></string-name>, <string-name><surname>Hu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Tabone</surname>, <given-names>C. J.</given-names></string-name>, <string-name><surname>Baron</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Berck</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Vignoud</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Samuel</surname>, <given-names>A. D.</given-names></string-name></person-group> <article-title>Structured odorant response patterns across a complete olfactory receptor neuron population</article-title>. <source>Neuron</source>, <volume>101</volume>(<issue>5</issue>):<fpage>950</fpage>–<lpage>962.e7,</lpage> <month>Mar</month>. <year>2019</year>. doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2018.12.030</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mante</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Sussillo</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Shenoy</surname>, <given-names>K. V.</given-names></string-name>, and <string-name><surname>Newsome</surname>, <given-names>W. T.</given-names></string-name></person-group> <article-title>Context-dependent computation by recurrent dynamics in prefrontal cortex</article-title>. <source>Nature</source>, <volume>503</volume>(<issue>7474</issue>):<fpage>78</fpage>–<lpage>84</lpage>, <month>Nov</month>. <year>2013</year>. doi: <pub-id pub-id-type="doi">10.1038/nature12742</pub-id>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yang</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Tipparaju</surname>, <given-names>S. L.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Li</surname>, <given-names>N.</given-names></string-name></person-group> <article-title>Thalamus-driven functional populations in frontal cortex support decision-making</article-title>. <source>Nature Neuroscience</source>, <volume>25</volume>(<issue>10</issue>):<fpage>1339</fpage>–<lpage>1352</lpage>, <month>Oct</month>. <year>2022</year>. doi: <pub-id pub-id-type="doi">10.1038/s41593-022-01171-w</pub-id>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Xie</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Hu</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Song</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>X.-J.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Dehaene</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Tang</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Min</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Wang</surname>, <given-names>L.</given-names></string-name></person-group> <article-title>Geometry of sequence working memory in macaque prefrontal cortex</article-title>. <source>Science</source>, <volume>375</volume>(<issue>6581</issue>):<fpage>632</fpage>–<lpage>639</lpage>, <month>Feb</month>. <year>2022</year>. doi: <pub-id pub-id-type="doi">10.1126/science.abm0204</pub-id>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nguyen</surname>, <given-names>J. P.</given-names></string-name>, <string-name><surname>Shipley</surname>, <given-names>F. B.</given-names></string-name>, <string-name><surname>Linder</surname>, <given-names>A. N.</given-names></string-name>, <string-name><surname>Plummer</surname>, <given-names>G. S.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Setru</surname>, <given-names>S. U.</given-names></string-name>, <string-name><surname>Shaevitz</surname>, <given-names>J. W.</given-names></string-name>, and <string-name><surname>Leifer</surname>, <given-names>A. M.</given-names></string-name></person-group> <article-title>Whole-brain calcium imaging with cellular resolution in freely behaving Caenorhabditis elegans</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>113</volume>(<issue>8</issue>):<fpage>E1074</fpage>–<lpage>E1081</lpage>, <month>Feb</month>. <year>2016</year>. doi: <pub-id pub-id-type="doi">10.1073/pnas.1507110112</pub-id>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lindén</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Petersen</surname>, <given-names>P. C.</given-names></string-name>, <string-name><surname>Vestergaard</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Berg</surname>, <given-names>R. W.</given-names></string-name></person-group> <article-title>Movement is governed by rotational neural dynamics in spinal motor networks</article-title>. <source>Nature</source>, <volume>610</volume>(<issue>7932</issue>):<fpage>526</fpage>–<lpage>531</lpage>, <month>Oct</month>. <year>2022</year>. doi: <pub-id pub-id-type="doi">10.1038/s41586-022-05293-w</pub-id>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Urai</surname>, <given-names>A. E.</given-names></string-name>, <string-name><surname>Doiron</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Leifer</surname>, <given-names>A. M.</given-names></string-name>, and <string-name><surname>Churchland</surname>, <given-names>A. K.</given-names></string-name></person-group> <article-title>Large-scale neural recordings call for new insights to link brain and behavior</article-title>. <source>Nature Neuroscience</source>, <volume>25</volume>(<issue>1</issue>):<fpage>11</fpage>–<lpage>19</lpage>, <month>Jan</month>. <year>2022</year>. doi: <pub-id pub-id-type="doi">10.1038/s41593-021-00980-9</pub-id>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name></person-group> <article-title>Large-scale recording of neuronal ensembles</article-title>. <source>Nature Neuroscience</source>, <volume>7</volume>(<issue>5</issue>):<fpage>446</fpage>–<lpage>451</lpage>, <month>May</month> <year>2004</year>. doi: <pub-id pub-id-type="doi">10.1038/nn1233</pub-id>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ahrens</surname>, <given-names>M. B.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>J. M.</given-names></string-name>, <string-name><surname>Orger</surname>, <given-names>M. B.</given-names></string-name>, <string-name><surname>Robson</surname>, <given-names>D. N.</given-names></string-name>, <string-name><surname>Schier</surname>, <given-names>A. F.</given-names></string-name>, <string-name><surname>Engert</surname>, <given-names>F.</given-names></string-name>, and <string-name><surname>Portugues</surname>, <given-names>R.</given-names></string-name></person-group> <article-title>Brain-wide neuronal dynamics during motor adaptation in zebrafish</article-title>. <source>Nature</source>, <volume>485</volume>(<issue>7399</issue>):<fpage>471</fpage>–<lpage>477</lpage>, <month>May</month> <year>2012</year>. doi: <pub-id pub-id-type="doi">10.1038/nature11057</pub-id>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jun</surname>, <given-names>J. J.</given-names></string-name>, <string-name><surname>Steinmetz</surname>, <given-names>N. A.</given-names></string-name>, <string-name><surname>Siegle</surname>, <given-names>J. H.</given-names></string-name>, <string-name><surname>Denman</surname>, <given-names>D. J.</given-names></string-name>, <string-name><surname>Bauza</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Barbarits</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>A. K.</given-names></string-name>, <string-name><surname>Anastassiou</surname>, <given-names>C. A.</given-names></string-name>, <string-name><surname>Andrei</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Aydin Barbic</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Blanche</surname>, <given-names>T. J.</given-names></string-name>, <string-name><surname>Bonin</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Couto</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Dutta</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Gratiy</surname>, <given-names>S. L.</given-names></string-name>, <string-name><surname>Gutnisky</surname>, <given-names>D. A.</given-names></string-name>, <string-name><surname>Häusser</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Karsh</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Ledochowitsch</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Lopez</surname>, <given-names>C. M.</given-names></string-name>, <string-name><surname>Mitelut</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Musa</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Okun</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Pachitariu</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Putzeys</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Rich</surname>, <given-names>P. D.</given-names></string-name>, <string-name><surname>Rossant</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Sun</surname>, <given-names>W.-l.</given-names></string-name>, <string-name><surname>Svoboda</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Carandini</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Harris</surname>, <given-names>K. D.</given-names></string-name>, <string-name><surname>Koch</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>O’Keefe</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Harris</surname>, <given-names>T. D.</given-names></string-name></person-group> <article-title>Fully integrated silicon probes for high-density recording of neural activity</article-title>. <source>Nature</source>, <volume>551</volume>(<issue>7679</issue>):<fpage>232</fpage>–<lpage>236</lpage>, <month>Nov</month>. <year>2017</year>. doi: <pub-id pub-id-type="doi">10.1038/nature24636</pub-id>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stevenson</surname>, <given-names>I. H.</given-names></string-name> and <string-name><surname>Kording</surname>, <given-names>K. P.</given-names></string-name></person-group> <article-title>How advances in neural recording affect data analysis</article-title>. <source>Nature neuroscience</source>, <volume>14</volume>(<issue>2</issue>): <fpage>139</fpage>–<lpage>142</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sofroniew</surname>, <given-names>N. J.</given-names></string-name>, <string-name><surname>Flickinger</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>King</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Svoboda</surname>, <given-names>K.</given-names></string-name></person-group> <article-title>A large field of view two-photon mesoscope with subcellular resolution for in vivo imaging</article-title>. <source>eLife</source>, <volume>5</volume>:<elocation-id>e14472</elocation-id>, <month>June</month> <year>2016</year>. doi: <pub-id pub-id-type="doi">10.7554/eLife.14472</pub-id>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lin</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Witvliet</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Hernandez-Nunez</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Linderman</surname>, <given-names>S. W.</given-names></string-name>, <string-name><surname>Samuel</surname>, <given-names>A. D.</given-names></string-name>, and <string-name><surname>Venkatachalam</surname>, <given-names>V.</given-names></string-name></person-group> <article-title>Imaging whole-brain activity to understand behaviour</article-title>. <source>Nature Reviews Physics</source>, <volume>4</volume>(<issue>5</issue>):<fpage>292</fpage>–<lpage>305</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Meshulam</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Gauthier</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Brody</surname>, <given-names>C. D.</given-names></string-name>, <string-name><surname>Tank</surname>, <given-names>D. W.</given-names></string-name>, and <string-name><surname>Bialek</surname>, <given-names>W.</given-names></string-name></person-group> <article-title>Coarse graining, fixed points, and scaling in a large population of neurons</article-title>. <source>Physical Review Letters</source>, <volume>123</volume>:<fpage>178103</fpage>, <year>2019</year>. doi: <pub-id pub-id-type="doi">10.1103/PhysRevLett.123.178103</pub-id>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Demas</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Manley</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Tejera</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Barber</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Kim</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Traub</surname>, <given-names>F. M.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>B.</given-names></string-name>, and <string-name><surname>Vaziri</surname>, <given-names>A.</given-names></string-name></person-group> <article-title>High-speed, cortex-wide volumetric recording of neuroactivity at cellular resolution using light beads microscopy</article-title>. <source>Nature Methods</source>, <volume>18</volume>(<issue>9</issue>):<fpage>1103</fpage>–<lpage>1111</lpage>, <month>Sept</month>. <year>2021</year>. doi: <pub-id pub-id-type="doi">10.1038/s41592-021-01239-8</pub-id>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Musall</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Kaufman</surname>, <given-names>M. T.</given-names></string-name>, <string-name><surname>Juavinett</surname>, <given-names>A. L.</given-names></string-name>, <string-name><surname>Gluf</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Churchland</surname>, <given-names>A. K.</given-names></string-name></person-group> <article-title>Single-trial neural dynamics are dominated by richly varied movements</article-title>. <source>Nature Neuroscience</source>, <volume>22</volume>(<issue>10</issue>):<fpage>1677</fpage>–<lpage>1686</lpage>, <month>Oct</month>. <year>2019</year>. doi: <pub-id pub-id-type="doi">10.1038/s41593-019-0502-4</pub-id>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stringer</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Pachitariu</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Steinmetz</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Reddy</surname>, <given-names>C. B.</given-names></string-name>, <string-name><surname>Carandini</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Harris</surname>, <given-names>K. D.</given-names></string-name></person-group> <article-title>Spontaneous behaviors drive multidimensional, brainwide activity</article-title>. <source>Science</source>, <volume>364</volume>(<issue>6437</issue>):<fpage>eaav7893</fpage>, <month>Apr</month>. <year>2019</year>. doi: <pub-id pub-id-type="doi">10.1126/science.aav7893</pub-id>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kleinfeld</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Luan</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Mitra</surname>, <given-names>P. P.</given-names></string-name>, <string-name><surname>Robinson</surname>, <given-names>J. T.</given-names></string-name>, <string-name><surname>Sarpeshkar</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Shepard</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Xie</surname>, <given-names>C.</given-names></string-name>, and <string-name><surname>Harris</surname>, <given-names>T. D.</given-names></string-name></person-group> <article-title>Can one concurrently record electrical spikes from every neuron in a mammalian brain?</article-title> <source>Neuron</source>, <volume>103</volume>(<issue>6</issue>):<fpage>1005</fpage>–<lpage>1015</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Recanatesi</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Ocker</surname>, <given-names>G. K.</given-names></string-name>, <string-name><surname>Buice</surname>, <given-names>M. A.</given-names></string-name>, and <string-name><surname>Shea-Brown</surname>, <given-names>E.</given-names></string-name></person-group> <article-title>Dimensionality in recurrent spiking networks: Global trends in activity and local origins in connectivity</article-title>. <source>PLoS computational biology</source>, <volume>15</volume>(<issue>7</issue>):<fpage>e1006446</fpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Litwin-Kumar</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Harris</surname>, <given-names>K. D.</given-names></string-name>, <string-name><surname>Axel</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Sompolinsky</surname>, <given-names>H.</given-names></string-name>, and <string-name><surname>Abbott</surname>, <given-names>L.</given-names></string-name></person-group> <article-title>Optimal degrees of synaptic connectivity</article-title>. <source>Neuron</source>, <volume>93</volume>(<issue>5</issue>):<fpage>1153</fpage>–<lpage>1164</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Gao</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Trautmann</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Yu</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Santhanam</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Ryu</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Shenoy</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Ganguli</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>A theory of multineuronal dimensionality, dynamics and measurement</article-title>. <source>BioRxiv</source>, page <fpage>214262</fpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Clark</surname>, <given-names>D. G.</given-names></string-name>, <string-name><surname>Abbott</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Litwin-Kumar</surname>, <given-names>A.</given-names></string-name></person-group> <article-title>Dimension of activity in random neural networks</article-title>. <source>Physical Review Letters</source>, <volume>131</volume> (<issue>11</issue>):<fpage>118401</fpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Dahmen</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Recanatesi</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Ocker</surname>, <given-names>G. K.</given-names></string-name>, <string-name><surname>Jia</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Helias</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Shea-Brown</surname>, <given-names>E.</given-names></string-name></person-group> <article-title>Strong coupling and local control of dimensionality across brain areas</article-title>. <source>Biorxiv</source>, pages <fpage>2020</fpage>–<lpage>11</lpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cong</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Chai</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Hang</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Shang</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Bai</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Du</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Wen</surname>, <given-names>Q.</given-names></string-name></person-group> <article-title>Rapid whole brain imaging of neural activity in freely behaving larval zebrafish (Danio rerio)</article-title>. <source>eLife</source>, <volume>6</volume>:<elocation-id>e28158</elocation-id>, <month>Sept</month>. <year>2017</year>. doi: <pub-id pub-id-type="doi">10.7554/eLife.28158</pub-id>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hu</surname>, <given-names>Y.</given-names></string-name> and <string-name><surname>Sompolinsky</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>The spectrum of covariance matrices of randomly connected recurrent neuronal networks with linear dynamics</article-title>. <source>PLoS Computational Biology</source>, <volume>18</volume>, 7 <year>2022</year>. doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1010327</pub-id>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morales</surname>, <given-names>G. B.</given-names></string-name>, <string-name><surname>di Santo</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Muñoz</surname>, <given-names>M. A.</given-names></string-name></person-group> <article-title>Quasiuniversal scaling in mouse-brain neuronal activity stems from edge-of-instability critical dynamics</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>120</volume>(<issue>9</issue>):<fpage>e2208998120</fpage>, <month>Feb</month>. <year>2023</year>. doi: <pub-id pub-id-type="doi">10.1073/pnas.2208998120</pub-id>.</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chen</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Mu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Hu</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Kuan</surname>, <given-names>A. T.</given-names></string-name>, <string-name><surname>Nikitchenko</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Randlett</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>A. B.</given-names></string-name>, <string-name><surname>Gavornik</surname>, <given-names>J. P.</given-names></string-name>, <string-name><surname>Sompolinsky</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Engert</surname>, <given-names>F.</given-names></string-name>, and <string-name><surname>Ahrens</surname>, <given-names>M. B.</given-names></string-name></person-group> <article-title>Brain-wide organization of neuronal activity and convergent sensorimotor transformations in larval zebrafish</article-title>. <source>Neuron</source>, <volume>100</volume>(<issue>4</issue>):<fpage>876</fpage>–<lpage>890.e5,</lpage> <month>Nov</month>. <year>2018</year>. doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2018.09.042</pub-id>.</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mézard</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Parisi</surname>, <given-names>G.</given-names></string-name>, and <string-name><surname>Zee</surname>, <given-names>A.</given-names></string-name></person-group> <article-title>Spectra of euclidean random matrices</article-title>. <source>Nuclear Physics B</source>, <volume>559</volume>(<issue>3</issue>):<fpage>689</fpage>–<lpage>701</lpage>, <month>Oct</month>. <year>1999</year>. doi: <pub-id pub-id-type="doi">10.1016/S0550-3213(99)00428-9</pub-id>.</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Goetschy</surname>, <given-names>A.</given-names></string-name> and <string-name><surname>Skipetrov</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Euclidean random matrices and their applications in physics</article-title>. <source>arXiv preprint</source>, <year>2013</year>. doi: <pub-id pub-id-type="doi">10.48550/ARXIV.1303.2880</pub-id>.</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hubel</surname>, <given-names>D. H.</given-names></string-name> and <string-name><surname>Wiesel</surname>, <given-names>T. N.</given-names></string-name></person-group> <article-title>Receptive fields of single neurones in the cat’s striate cortex</article-title>. <source>The Journal of physiology</source>, <volume>148</volume> (<issue>3</issue>):<fpage>574</fpage>, <year>1959</year>.</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stefanini</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Kushnir</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Jimenez</surname>, <given-names>J. C.</given-names></string-name>, <string-name><surname>Jennings</surname>, <given-names>J. H.</given-names></string-name>, <string-name><surname>Woods</surname>, <given-names>N. I.</given-names></string-name>, <string-name><surname>Stuber</surname>, <given-names>G. D.</given-names></string-name>, <string-name><surname>Kheirbek</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Hen</surname>, <given-names>R.</given-names></string-name>, and <string-name><surname>Fusi</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>A distributed neural code in the dentate gyrus and in CA1</article-title>. <source>Neuron</source>, <volume>107</volume>(<issue>4</issue>):<fpage>703</fpage>–<lpage>716.e4,</lpage> <month>Aug</month>. <year>2020</year>. doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2020.05.022</pub-id>.</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kropff</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Carmichael</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name></person-group> <article-title>Speed cells in the medial entorhinal cortex</article-title>. <source>Nature</source>, <volume>523</volume>(<issue>7561</issue>): <fpage>419</fpage>–<lpage>424</lpage>, <month>July</month> <year>2015</year>. doi: <pub-id pub-id-type="doi">10.1038/nature14622</pub-id>.</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Keefe</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Place units in the hippocampus of the freely moving rat</article-title>. <source>Experimental Neurology</source>, <volume>51</volume>(<issue>1</issue>):<fpage>78</fpage>–<lpage>109</lpage>, <month>Jan</month>. <year>1976</year>. doi: <pub-id pub-id-type="doi">10.1016/0014-4886(76)90055-8</pub-id>.</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name>, <string-name><surname>Kropff</surname>, <given-names>E.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name></person-group> <article-title>Place cells, grid cells, and the brain’s spatial representation system</article-title>. <source>Annual Review of Neuroscience</source>, <volume>31</volume>(<issue>1</issue>):<fpage>69</fpage>–<lpage>89</lpage>, <month>July</month> <year>2008</year>. doi: <pub-id pub-id-type="doi">10.1146/annurev.neuro.31.061307.090723</pub-id>.</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tingley</surname>, <given-names>D.</given-names></string-name> and <string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name></person-group> <article-title>Transformation of a Spatial Map across the Hippocampal-Lateral Septal Circuit</article-title>. <source>Neuron</source>, <volume>98</volume>(<issue>6</issue>): <fpage>1229</fpage>–<lpage>1242.e5,</lpage> <month>June</month> <year>2018</year>. doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2018.04.028</pub-id>.</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Zhu</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Shirhatti</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Freedman</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Doiron</surname>, <given-names>B.</given-names></string-name></person-group> <article-title>Relating network heterogeneity to the dimension of population covariability</article-title>. <source>Computational and Systems Neuroscience (COSYNE)</source>, pages <fpage>3</fpage>–<lpage>130</lpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grewe</surname>, <given-names>B. F.</given-names></string-name> and <string-name><surname>Helmchen</surname>, <given-names>F.</given-names></string-name></person-group> <article-title>Optical probing of neuronal ensemble activity</article-title>. <source>Current Opinion in Neurobiology</source>, <volume>19</volume>(<issue>5</issue>): <fpage>520</fpage>–<lpage>529</lpage>, <month>Oct</month>. <year>2009</year>. doi: <pub-id pub-id-type="doi">10.1016/j.conb.2009.09.003</pub-id>.</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gauthier</surname>, <given-names>J. L.</given-names></string-name> and <string-name><surname>Tank</surname>, <given-names>D. W.</given-names></string-name></person-group> <article-title>A dedicated population for reward coding in the hippocampus</article-title>. <source>Neuron</source>, <volume>99</volume>(<issue>1</issue>):<fpage>179</fpage>–<lpage>193.e7,</lpage> <month>July</month> <year>2018</year>. doi: <pub-id pub-id-type="doi">10.1016/j.neuron.2018.06.008</pub-id>.</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Cox</surname>, <given-names>T.</given-names></string-name> and <string-name><surname>Cox</surname>, <given-names>M.</given-names></string-name></person-group> <source>Multidimensional Scaling</source>. <publisher-name>Chapman and Hall/CRC</publisher-name>, <edition>0</edition> edition, <month>Sept</month>. <year>2000</year>. ISBN <isbn>978-0-367-80170-0</isbn>. doi: <pub-id pub-id-type="doi">10.1201/9780367801700</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.taylorfrancis.com/books/9781420036121">https://www.taylorfrancis.com/books/9781420036121</ext-link>.</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bianco</surname>, <given-names>I. H.</given-names></string-name>, <string-name><surname>Kampff</surname>, <given-names>A. R.</given-names></string-name>, and <string-name><surname>Engert</surname>, <given-names>F.</given-names></string-name></person-group> <article-title>Prey capture behavior evoked by simple visual stimuli in larval zebrafish</article-title>. <source>Frontiers in Systems Neuroscience</source>, <volume>5</volume>, <year>2011</year>. doi: <pub-id pub-id-type="doi">10.3389/fnsys.2011.00101</pub-id>.</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kunst</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Laurell</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Mokayes</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Kramer</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Kubo</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Fernandes</surname>, <given-names>A. M.</given-names></string-name>, <string-name><surname>Förster</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Dal Maschio</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Baier</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>A cellular-resolution atlas of the larval zebrafish brain</article-title>. <source>Neuron</source>, <volume>103</volume>(<issue>1</issue>):<fpage>21</fpage>–<lpage>38</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Kardar</surname>, <given-names>M.</given-names></string-name></person-group> <source>Statistical Physics of Fields</source>. <publisher-name>Cambridge University Press</publisher-name>, <publisher-loc>Cambridge</publisher-loc>, <year>2007</year>. ISBN <isbn>978-0-521-87341-3</isbn>. doi: <pub-id pub-id-type="doi">10.1017/CBO9780511815881</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.cambridge.org/core/books/statistical-physics-of-fields/06F49D11030FB3108683F413269DE945">https://www.cambridge.org/core/books/statistical-physics-of-fields/06F49D11030FB3108683F413269DE945</ext-link>.</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beggs</surname>, <given-names>J. M.</given-names></string-name> and <string-name><surname>Plenz</surname>, <given-names>D.</given-names></string-name></person-group> <article-title>Neuronal avalanches in neocortical circuits</article-title>. <source>Journal of Neuroscience</source>, <volume>23</volume>(<issue>35</issue>):<fpage>11167</fpage>–<lpage>11177</lpage>, <month>Dec</month>. <year>2003</year>. doi: <pub-id pub-id-type="doi">10.1523/JNEUROSCI.23-35-11167.2003</pub-id>.</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dahmen</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Grün</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Diesmann</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Helias</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Second type of criticality in the brain uncovers rich multiple-neuron dynamics</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>116</volume>(<issue>26</issue>):<fpage>13051</fpage>–<lpage>13060</lpage>, <month>June</month> <year>2019</year>. doi: <pub-id pub-id-type="doi">10.1073/pnas.1818972116</pub-id>.</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Renart</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>De La Rocha</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Bartho</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Hollender</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Parga</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Reyes</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Harris</surname>, <given-names>K. D.</given-names></string-name></person-group> <article-title>The asynchronous state in cortical circuits</article-title>. <source>science</source>, <volume>327</volume>(<issue>5965</issue>):<fpage>587</fpage>–<lpage>590</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoffmann</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Henninger</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Veith</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Richter</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Judkewitz</surname>, <given-names>B.</given-names></string-name></person-group> <article-title>Blazed oblique plane microscopy reveals scale-invariant inference of brain-wide population activity</article-title>. <source>Nature Communications</source>, <volume>14</volume>(<issue>1</issue>):<fpage>8019</fpage>, <month>Dec</month>. <year>2023</year>. doi: <pub-id pub-id-type="doi">10.1038/s41467-023-43741-x</pub-id>.</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mathis</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Mamidanna</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Cury</surname>, <given-names>K. M.</given-names></string-name>, <string-name><surname>Abe</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Murthy</surname>, <given-names>V. N.</given-names></string-name>, <string-name><surname>Mathis</surname>, <given-names>M. W.</given-names></string-name>, and <string-name><surname>Bethge</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>DeepLabCut: markerless pose estimation of user-defined body parts with deep learning</article-title>. <source>Nature Neuroscience</source>, <volume>21</volume>(<issue>9</issue>):<fpage>1281</fpage>–<lpage>1289</lpage>, <month>Sept</month>. <year>2018</year>. doi: <pub-id pub-id-type="doi">10.1038/s41593-018-0209-y</pub-id>.</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tabor</surname>, <given-names>K. M.</given-names></string-name>, <string-name><surname>Marquart</surname>, <given-names>G. D.</given-names></string-name>, <string-name><surname>Hurt</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Smith</surname>, <given-names>T. S.</given-names></string-name>, <string-name><surname>Geoca</surname>, <given-names>A. K.</given-names></string-name>, <string-name><surname>Bhandiwad</surname>, <given-names>A. A.</given-names></string-name>, <string-name><surname>Subedi</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Sinclair</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Rose</surname>, <given-names>H. M.</given-names></string-name>, <string-name><surname>Polys</surname>, <given-names>N. F.</given-names></string-name>, and <string-name><surname>Burgess</surname>, <given-names>H. A.</given-names></string-name></person-group> <article-title>Brain-wide cellular resolution imaging of Cre transgenic zebrafish lines for functional circuit-mapping</article-title>. <source>eLife</source>, <volume>8</volume>:<elocation-id>e42687</elocation-id>, <month>Feb</month>. <year>2019</year>. doi: <pub-id pub-id-type="doi">10.7554/eLife.42687</pub-id>.</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Studholme</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Hill</surname>, <given-names>D. L. G.</given-names></string-name>, and <string-name><surname>Hawkes</surname>, <given-names>D. J.</given-names></string-name></person-group> <article-title>Automated three-dimensional registration of magnetic resonance and positron emission tomography brain images by multiresolution optimization of voxel similarity measures</article-title>. <source>Medical Physics</source>, <volume>24</volume>(<issue>1</issue>):<fpage>25</fpage>–<lpage>35</lpage>, <year>1997</year>. doi: <pub-id pub-id-type="doi">10.1118/1.598130</pub-id>.</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rueckert</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Sonoda</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Hayes</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Hill</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Leach</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Hawkes</surname>, <given-names>D.</given-names></string-name></person-group> <article-title>Nonrigid registration using free-form deformations: application to breast MR images</article-title>. <source>IEEE Transactions on Medical Imaging</source>, <volume>18</volume>(<issue>8</issue>):<fpage>712</fpage>–<lpage>721</lpage>, <month>Aug</month>. <year>1999</year>. doi: <pub-id pub-id-type="doi">10.1109/42.796284</pub-id>.</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Friedrich</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Zhou</surname>, <given-names>P.</given-names></string-name>, and <string-name><surname>Paninski</surname>, <given-names>L.</given-names></string-name></person-group> <article-title>Fast online deconvolution of calcium imaging data</article-title>. <source>PLOS Computational Biology</source>, <volume>13</volume> (<issue>3</issue>):<fpage>e1005423</fpage>, <month>Mar</month>. <year>2017</year>. doi: <pub-id pub-id-type="doi">10.1371/journal.pcbi.1005423</pub-id>.</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gao</surname>, <given-names>P.</given-names></string-name> and <string-name><surname>Ganguli</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>On simplicity and complexity in the brave new world of large-scale neuroscience</article-title>. <source>Current opinion in neurobiology</source>, <volume>32</volume>:<fpage>148</fpage>–<lpage>155</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bordenave</surname>, <given-names>C.</given-names></string-name></person-group> <article-title>Eigenvalues of Euclidean random matrices</article-title>. <source>Random Structures and Algorithms</source>, <volume>33</volume>(<issue>4</issue>):<fpage>515</fpage>–<lpage>532</lpage>, <month>Dec</month>. <year>2008</year>. doi: <pub-id pub-id-type="doi">10.1002/rsa.20228</pub-id>.</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Rudin</surname>, <given-names>W.</given-names></string-name></person-group> <source>Fourier Analysis on Groups</source>. <publisher-name>Wiley</publisher-name>, <edition>1</edition> edition, <month>Jan</month>. <year>1990</year>. doi: <pub-id pub-id-type="doi">10.1002/9781118165621</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/book/10.1002/9781118165621">https://onlinelibrary.wiley.com/doi/book/10.1002/9781118165621</ext-link>.</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Knapp</surname>, <given-names>T. R.</given-names></string-name></person-group> <article-title>Canonical correlation analysis: a general parametric significance-testing system</article-title>. <source>Psychological Bulletin</source>, <volume>85</volume>(<issue>2</issue>): <fpage>410</fpage>, <year>1978</year>.</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bradde</surname>, <given-names>S.</given-names></string-name> and <string-name><surname>Bialek</surname>, <given-names>W.</given-names></string-name></person-group> <article-title>PCA meets RG</article-title>. <source>Journal of Statistical Physics</source>, <volume>167</volume>(<issue>3</issue>):<fpage>462</fpage>–<lpage>475</lpage>, <month>May</month> <year>2017</year>. doi: <pub-id pub-id-type="doi">10.1007/s10955-017-1770-6</pub-id>.</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Meshulam</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Gauthier</surname>, <given-names>J. L.</given-names></string-name>, <string-name><surname>Brody</surname>, <given-names>C. D.</given-names></string-name>, <string-name><surname>Tank</surname>, <given-names>D. W.</given-names></string-name>, and <string-name><surname>Bialek</surname>, <given-names>W.</given-names></string-name></person-group> <article-title>Coarse–graining and hints of scaling in a population of 1000+ neurons</article-title>. <source>arXiv preprint</source>, <year>2018</year>. doi: <pub-id pub-id-type="doi">10.48550/arXiv.1812.11904</pub-id>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.100666.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Latham</surname>
<given-names>Peter</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University College London</institution>
</institution-wrap>
<city>London</city>
<country>United Kingdom</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>valuable</bold> study shows a surprising scale-invariance of the covariance spectrum of large-scale recordings in the zebrafish brain in vivo. A <bold>solid</bold> analysis demonstrates that a Euclidean random matrix model of the covariance matrix recapitulates these properties. The results provide several new and insightful approaches for probing large-scale neural recordings.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.100666.1.sa1</article-id>
<title-group>
<article-title>Joint Public Reviews:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors examine the eigenvalue spectrum of the covariance matrix of neural recordings in the whole-brain larval zebrafish during hunting and spontaneous behavior. They find that the spectrum is approximately power law, and, more importantly, exhibits scale-invariance under random subsampling of neurons. This property is not exhibited by conventional models of covariance spectra, motivating the introduction of the Euclidean random matrix model. The authors show that this tractable model captures the scale invariance they observe. They also examine the effects of subsampling based on anatomical location or functional relationships. Finally, they briefly discuss the benefit of neural codes which can be subsampled without significant loss of information.</p>
<p>Strengths:</p>
<p>With large-scale neural recordings becoming increasingly common, neuroscientists are faced with the question: how should we analyze them? To address that question, this paper proposes the Euclidean random matrix model, which embeds neurons randomly in an abstract feature space. This model is analytically tractable and matches two nontrivial features of the covariance matrix: approximate power law scaling, and invariance under subsampling. It thus introduces an important conceptual and technical advance for understanding large-scale simultaneously recorded neural activity.</p>
<p>Weaknesses:</p>
<p>The downside of using summary statistics is that they can be hard to interpret. Often the finding of scale invariance, and approximate power law behavior, points to something interesting. But here caution is in order: for instance, most critical phenomena in neural activity have been explained by relatively simple models that have very little to do with computation (Aitchison et al., PLoS CB 12:e1005110, 2016; Morrell et al., eLife 12, RP89337, 2014). Whether the same holds for the properties found here remains an open question.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.100666.1.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Wang</surname>
<given-names>Zezhen</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0006-1401-9871</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Mai</surname>
<given-names>Weihao</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-2320-2276</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Chai</surname>
<given-names>Yuming</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0184-1824</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Qi</surname>
<given-names>Kexin</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Ren</surname>
<given-names>Hongtai</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Shen</surname>
<given-names>Chen</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhang</surname>
<given-names>Shiwu</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tan</surname>
<given-names>Guodong</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hu</surname>
<given-names>Yu</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0790-1605</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Wen</surname>
<given-names>Quan</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0268-8403</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>We are grateful for the thorough and constructive feedback provided on our manuscript.</p>
<p>Regarding the main concern about power law behavior and scale invariance, we would like to clarify that our study does not aim to establish criticality. Instead, we focus on describing and understanding a specific scale-invariant property: the collapsed eigenspectra in neural activity under random sampling. Indeed, we tested Morrell et al.’s latent-variable model (eLife 12, RP89337, 2024, [1]), where a slowly varying latent factor drives population activity. Although it produces a seemingly power-law-like spectrum, random sampling does not replicate the strict spectral collapse observed in our data (second row in Author response image 1). This highlights that simply adding latent factors does not fully recapitulate the scale invariance we measure, suggesting richer or more intricate processes may be involved in real neural recordings.</p>
<fig id="sa2fig1">
<label>Author response image 1.</label>
<caption>
<title>Morrell et al.</title>
<p>’s latent variable model [1, 2]. A-D: Functional sampled (RSap) eigenspectral of the Morrell et al. model. E-H: Random sampled (RSap) eigenspectra of the same model. Briefly, in Morrell et al.’s latent variable model [1, 2], neural activity is driven by Nf latent fields and a place fields. The latent fields are modeled as Ornstein-Uhlenbeck processes with a time constant τ . The parameters ϵ and η control the mean and variance of individual neurons’ firing rates, respectively. The following are the parameter values used. A,E: Using the same parameters as in [1]: <italic>N<sub>f</sub></italic> = 10, ϵ = −2.67, <italic>η</italic> = 6, τ = 0.1. Half of the cells are also coupled to the place field. B,C,D,F,G,H: Using parameters from [2]: <italic>N<sub>f</sub></italic> = 5, ϵ = −3, η = 4. There is no place field. The time constant τ = 0.1, 1, 10 for B,F, C,G, and D,H, respectively.</p>
</caption>
<graphic mime-subtype="jpg" xlink:href="elife-100666-sa2-fig1.jpg" mimetype="image"/>
</fig>
<p>We decided to make 5 key revisions.</p>
<list list-type="bullet">
<list-item><p>As mentioned, we have evaluated the latent variable model proposed by Morrell et al. and found that they fail to reproduce the scale-invariant eigenspectra observed in our data; these results will be presented in the Discussion section and supported by a new Supplementary Figure.</p>
</list-item>
<list-item><p>We will include a discussion on the findings of Manley et al. (2024, [2]) regarding the issue of saturating dimensionality in the Discussion section, highlighting the methodological differences and their implications.</p>
</list-item>
<list-item><p>We will add a new mathematical derivation in the Methods section, elucidating the bounded dimensionality using the spectral properties of our model.</p>
</list-item>
<list-item><p>We will elaborate in the Discussion section to further emphasize the robustness of our findings by demonstrating their consistency across diverse datasets and experimental techniques.</p>
</list-item>
<list-item><p>We will incorporate a brief discussion on the implications for neural coding. In particular, Fisher information can become unbounded when the slope of the power-law rank plot is less than one, as highlighted in the recent work by Moosavi et al. (bioRxiv 2024.08.23.608710, Aug, 2024 [3]) in the Discussion section.</p>
</list-item>
</list>
<p>We believe these revisions will address the concerns raised by you and collectively strengthen our manuscript to provide a more comprehensive and robust understanding of the geometry and dimensionality of brain-wide activity.</p>
<p>References</p>
<p>(1) M. C. Morrell, A. J. Sederberg, I. Nemenman, Latent dynamical variables produce signatures of spatiotemporal criticality in large biological systems. Physical Review Letters 126, 118302 (2021).</p>
<p>(2) M. C. Morrell, I. Nemenman, A. Sederberg, Neural criticality from effective latent variables. eLife 12, RP89337 (2024).</p>
</body>
</sub-article>
</article>