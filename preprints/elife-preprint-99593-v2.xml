<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">99593</article-id>
<article-id pub-id-type="doi">10.7554/eLife.99593</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.99593.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Physics of Living Systems</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Emergence of alternative stable states in microbial communities undergoing horizontal gene transfer</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Hong</surname>
<given-names>Juken</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Xue</surname>
<given-names>Wenzhi</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0000-5176-5095</contrib-id>
<name>
<surname>Wang</surname>
<given-names>Teng</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>t.wang1@siat.ac.cn</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04gh4er46</institution-id><institution>Key Laboratory of Quantitative Synthetic Biology, Shenzhen Institute of Synthetic Biology, Shenzhen Institutes of Advanced Technology, Chinese Academy of Sciences</institution></institution-wrap>, <city>Shenzhen</city>, <country country="CN">China</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Momeni</surname>
<given-names>Babak</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Boston College</institution>
</institution-wrap>
<city>Chestnut Hill</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Schuman</surname>
<given-names>Meredith C</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Zurich</institution>
</institution-wrap>
<city>Zürich</city>
<country>Switzerland</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing Interest Statement: The authors have declared no competing interest.</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-11-21">
<day>21</day>
<month>11</month>
<year>2024</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-02-04">
<day>04</day>
<month>02</month>
<year>2025</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP99593</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-06-18">
<day>18</day>
<month>06</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-06-22">
<day>22</day>
<month>06</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.06.18.599596"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-11-21">
<day>21</day>
<month>11</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.99593.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.99593.1.sa3">eLife Assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99593.1.sa2">Reviewer #1 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99593.1.sa1">Reviewer #2 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99593.1.sa0">Reviewer #3 (Public review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Hong et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Hong et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-99593-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>Microbial communities living in the same environment often display alternative stable states, each characterized by a unique composition of species. Understanding the origin and determinants of microbiome multistability has broad implications in environments, human health and microbiome engineering. However, despite its conceptual importance, how multistability emerges in complex communities remains largely unknown. Here, we focused on the role of horizontal gene transfer (HGT), one important aspect mostly overlooked in previous studies, on the stability landscape of microbial populations. Combining mathematical modeling and numerical simulations, we demonstrate that, when mobile genes only affect bacterial growth rates, increasing HGT rate in general promote the emergence of alternative stable states in complex microbiota. We further extend our analysis to scenarios where HGT changes interspecies interactions, microbial communities are subjected to strong environmental selections and microbes live in metacommunities consisting of multiple local habitats. We also discuss the role of different mechanisms, including interspecies interaction strength, the growth rate effects of MGEs, MGE epistasis and microbial death rates in shaping the multistability of microbial communities undergoing HGT. These results reveal how different dynamic processes collectively shape community multistability and diversity. Our results provide key insights for the predictive control and engineering of complex microbiota.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>We have performed additional simulations to provide a more thorough analysis on the impact of different parameters. In the updated manuscript, we have also provided a more in-depth description of model assumptions and the formulation structure.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Microbial communities living in similar environments often display different community types, each characterized by a unique composition of species<sup><xref ref-type="bibr" rid="c1">1</xref>-<xref ref-type="bibr" rid="c4">4</xref></sup>. Changes in environmental factors, fluctuations of species abundances, or transient invasions can trigger abrupt and irreversible transitions between two types<sup><xref ref-type="bibr" rid="c5">5</xref>-<xref ref-type="bibr" rid="c7">7</xref></sup>. Such transitions, also known as regime shifts, lead to the dramatic alterations of microbiome functions and are tightly associated with host diseases, soil fertility, marine biogeochemical flux, or bioproduction yield<sup><xref ref-type="bibr" rid="c8">8</xref>-<xref ref-type="bibr" rid="c12">12</xref></sup>. Understanding the origin of different community types has broad implications in environments, engineering and health<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c3">3</xref></sup>.</p>
<p>Multistability, a phenomenon where multiple stable states coexist for the same set of system parameters, is one of the most important mechanisms behind alternative community types and has been widely observed in a variety of natural or experimental microbiomes<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c13">13</xref>-<xref ref-type="bibr" rid="c17">17</xref></sup>. Under perturbations, a multistable system can be driven away from a former stable state, cross the tipping point and reach a new steady state. The population can persist in the new state even after the perturbations are withdrawn, exhibiting a behavior of ‘hysteresis’<sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c13">13</xref></sup>. Despite its conceptual importance, the determinants underlying microbiota multistability have been poorly understood due to the intrinsic complexity of microbial interactions<sup><xref ref-type="bibr" rid="c14">14</xref></sup>.</p>
<p>Understanding the origin and the underlying determinants of multistability in complex microbiota is an important challenge in microbial ecology and evolution. In host-associated microbiota, regime shifts between alternative stable states can trigger the critical transitions between healthy microbiome and dysbiosis<sup><xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c18">18</xref></sup>. Unravelling how different biological processes drive community multistability is important for the predictive control of complex microbiota, and can inspire novel treatments to modulate the communities towards the desired stable states or away from the unhealthy states.</p>
<p>Mathematical models are indispensable to decipher the emergent properties of complex populations<sup><xref ref-type="bibr" rid="c19">19</xref></sup>. Different ecological models have been developed to analyze the origin of multistability in microbial communities. For instance, based on the generalized Lotka-Volterra (LV) model, Gonze D <italic>et al</italic>. showed that multistability could emerge in communities where different species mutually inhibited each other<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Dubinkina V <italic>et al</italic>. applied a consumer-resource model in which microbes competed for different metabolites, and showed that multistability required microbial species to have different stoichiometries of essential nutrients<sup><xref ref-type="bibr" rid="c14">14</xref></sup>. These works provide critical insights on the determinants of community multistability, yet the roles of many other mechanisms remain to be understood. Chief among these is horizontal gene transfer (HGT), a process where microbes share mobile genetic elements (MGEs) with their neighbors<sup><xref ref-type="bibr" rid="c20">20</xref></sup>.</p>
<p>Indeed, HGT is prevalent in microbial world and mobile genes occupy a substantial proportion in microbial gene pool<sup><xref ref-type="bibr" rid="c21">21</xref>-<xref ref-type="bibr" rid="c23">23</xref></sup>. For instance, among the closely related microbial isolates in the same human body site, HGT occurs in more than 40% of the species pairs<sup><xref ref-type="bibr" rid="c24">24</xref></sup>. In the draft genomes of human gut microbes, tens of thousands of genes were mobilizable<sup><xref ref-type="bibr" rid="c22">22</xref></sup>. Depending on the encoded traits, MGEs shape microbial growth rates, host adaptability and even social interactions between microbes<sup><xref ref-type="bibr" rid="c25">25</xref></sup>. The dynamic gain and loss of MGEs are also a major source of evolutionary innovations of prokaryotic genomes<sup><xref ref-type="bibr" rid="c26">26</xref></sup>. However, despite its functional and ecological importance, the interplay between genetic exchange and community multistability has not been rigorously examined in previous studies and a general conclusion remains lacking.</p>
<p>In this work, we focus on communities of competing microbes, a model system for microbiome multistability<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c14">14</xref>,<xref ref-type="bibr" rid="c27">27</xref></sup>. By combining mathematical modelling and numerical simulations, we demonstrated that the horizontal transfer of plasmids, a major type of MGEs, could promote the emergence of alternative stable states which otherwise would not exist. We further extended our analysis to scenarios where HGT changed interspecies interactions, where microbial communities were subjected to strong environmental selections and where microbes lived in metacommunities consisting of multiple local habitats. We also analyzed the role of different mechanisms, including interspecies interaction strength, the growth rate effects of MGEs, MGE epistasis and microbial death rates in shaping the multistability of microbial communities. These results created a comprehensive framework to understand how different dynamic processes, including but not limited to HGT rates, collectively shaped community multistability and diversity. Our results provide valuable insights for microbial ecology, health and microbiome engineering.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>The role of HGT on bistability of two-species populations</title>
<p>To illustrate the basic concepts, let’s first consider a population of two competing species. Without HGT, the community dynamics can be captured by the classic LV model that accounts for species growth rates (<italic>µ</italic><sub>1</sub> and <italic>µ</italic><sub>2</sub>), interspecies interaction strengths (<italic>γ</italic><sub>1</sub> and <italic>γ</italic><sub>2</sub>) and the dilution or death rate (<italic>D</italic>). When all the parameters are given, one can simulate the system dynamics from the initial abundances of the two species. The system will reach an equilibrium, characterized by the steady-state abundances of the two species. Bistability means the coexistence of two distinct stable states (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>)<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>. Depending on the initial abundances, either one of the two species can dominate the community. With bistability, even when the model parameters are not altered, a change in initial species abundances is sufficient to drive the system to a different stable state (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>). In contrast, if monostable, the population will always rest at the same steady state regardless of the initial composition (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>). Given the simplicity of this model, the condition of the system being bistable can be analytically solved as <italic>γ</italic><sub>1</sub> &gt;<italic>ϕ</italic><sub>2</sub>/<italic>ϕ</italic><sub>1</sub> and <italic>γ</italic><sub>2</sub> &gt;<italic>ϕ</italic><sub>1</sub>/<italic>ϕ</italic><sub>2</sub> where <italic>ϕ</italic> <inline-formula><inline-graphic xlink:href="599596v2_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (see Methods for more details). This condition predicted the thresholds on the strengths of interspecies interactions in order for the system to be bistable.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1.</label>
<caption><title>Horizontal gene transfer (HGT) promotes bistability of communities consisting of two competing microbes.</title>
<p><bold>(a)</bold> Schematics of monostable and bistable systems. A monostable system will always rest at the same steady state no matter where the system starts from. In contrast, a bistable system can reach two distinct steady states, depending on the initial ratio between the two competitors. The right panel is a diagram depicting how a microbial community responds to changes on initial species abundances. The red marble stands for the system state, which will always roll “downhill” on the landscape towards stable states at the low points. The x axis represents the community composition and the valleys in the landscape are the stable states (or equilibrium points) when the community composition will stop changing. Depending on parameter values, the landscape can have one valley (called “monostable”) or two valleys (called “bistable”). When the system is bistable, the marble can reach either valley, depending on where it starts.</p>
<p><bold>(b)</bold> The phase diagram of the population with (bottom panel, <italic>η</italic> = 0.2 <italic>hr</italic><sup>−1</sup>) or without HGT (top panel). Different combinations of <italic>µ</italic><sub>1</sub> and <italic>µ</italic><sub>2</sub> between 0 and 1 <italic>hr</italic><sup>−1</sup> were tested. For each combination, the initial abundance of each species was randomized 200 times between 0 and 1 following uniform distributions. The system was monostable if all initializations led to the same steady state. Otherwise, the system was bistable. All combinations of <italic>µ</italic><sub>1</sub> and <italic>µ</italic><sub>2</sub> resulting in bistability were marked in blue in the diagram. Other parameters are <italic>γ</italic> = 1.1, <italic>κ</italic> = 0.005 <italic>hr</italic><sup>−1</sup>,<italic>D</italic> = 0.2 <italic>hr</italic><sup>−1</sup>,<inline-formula><inline-graphic xlink:href="599596v2_inline50.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Two states, <italic>P</italic> (<italic>µ</italic><sub>1</sub> = 0.3 <italic>hr</italic><sup>−1</sup>, <italic>µ</italic><sub>2</sub> = 0.8 <italic>hr</italic><sup>−1</sup>) and <italic>Q</italic> (<italic>µ</italic><sub>1</sub> = 0.4 <italic>hr</italic><sup>−1</sup>, <italic>µ</italic><sub>2</sub> = 0.6 <italic>hr</italic><sup>−1</sup>), were labeled as examples.</p>
<p><bold>(c-d)</bold> Population dynamics of <italic>P</italic> and <italic>Q</italic> under 100 different initializations. Here, the dynamic changes of species 1’s abundance were shown. Three different HGT rates (0, 0.1, 0.2 <italic>hr</italic><sup>−1</sup> from top to bottom) were tested. When gene transfer rate increases, the system at <italic>Q</italic> changed from monostable to bistable, while the system at <italic>P</italic> remained monostable.</p></caption>
<graphic xlink:href="599596v2_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To analyze the effect of HGT on bistability, we applied a mathematical model that we previously developed to describe the conjugative transfer of plasmids between competing species<sup><xref ref-type="bibr" rid="c28">28</xref></sup>. While in classic LV model <italic>µ</italic><sub>1</sub> and <italic>µ</italic><sub>2</sub> are constants, our model dissected species growth rates into two components: the basal growth rates (<inline-formula><inline-graphic xlink:href="599596v2_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula>) determined by chromosomal genes, and the growth rate effects (<italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub>) of plasmids. The two components were assumed to combine multiplicatively: <inline-formula><inline-graphic xlink:href="599596v2_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. HGT creates subpopulations (denoted as <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub>) within each species that acquire the mobilizable genes from its competitor. The dynamics of <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> were governed by cell growth, plasmid transfer (the rate denoted as <italic>η</italic>) and plasmid loss (the rate denoted as <italic>κ</italic>). The gain and loss of <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> in turn lead to the temporal change of the effective growth rates (<inline-formula><inline-graphic xlink:href="599596v2_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula>) of each species: <inline-formula><inline-graphic xlink:href="599596v2_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, (see Methods for more details). Therefore, plasmid transfer allows the two competitors to partially exchange their growth benefits or disadvantages. Here, we assumed that the species internal inhibition was independent of the acquired MGEs. We sought to understand whether the process of HGT would reshape the stability landscape of the system.</p>
<p>After HGT being introduced, analytical solution becomes infeasible due to the increase of modeling complexity. Instead, we determined whether the system was bistable by numerical simulations with randomized initial compositions<sup><xref ref-type="bibr" rid="c27">27</xref></sup>. In general, the resolution of this approach increases with the number of randomizations. Without loss of generality, here we randomly initialized the species abundances for 200 times between 0 and 1 following uniform distributions (Fig. S1a). Then we simulated the population dynamics for each initialization until steady state and obtained their species abundances. A system is called monostable if all populations starting from different compositions converge into the same state. In contrast, if two attractors exist, the system is called bistable (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>). We calculated the number of stable states for a wide range of <italic>µ</italic><sub>1</sub> and <italic>µ</italic><sub>2</sub> values and drew the phase diagram (<xref rid="fig1" ref-type="fig">Fig. 1b</xref>). Whether it is easy for the system to achieve bistability is reflected by the total area of bistability region on the phase diagram. Our numerical results suggested that increasing HGT enlarged the region, creating bistability in many systems which would otherwise be monostable (<xref rid="fig1" ref-type="fig">Fig. 1b-d</xref>). Here, the number of initializations was not critical for the conclusion (Fig. S1a). The results were not fundamentally changed when the interspecies interaction strengths or gene transfer rates were altered (Fig. S1b-d), suggesting the robustness of our conclusion.</p>
<p>Our results suggested that increasing HGT made it more feasible for the system to become bistable. However, this should not be taken as an assertion that the system will always be bistable when HGT exists (<xref rid="fig1" ref-type="fig">Fig. 1c</xref> and <xref ref-type="fig" rid="fig1">d</xref>). For two species with large growth rate difference, the system might remain monostable when gene transfer rate increases (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>). In this case, the strong competitor will always win despite the gene flow. The effect of HGT in promoting bistability is more applicable between species with smaller growth rate difference (<xref rid="fig1" ref-type="fig">Fig. 1b</xref> and <xref ref-type="fig" rid="fig1">d</xref>).</p>
<p>Previous studies showed that the cell death rate determines the bistability of two interacting species<sup><xref ref-type="bibr" rid="c29">29</xref></sup>. To evaluate the impact of death rate <italic>D</italic> on the interplay between HGT and system bistability, we performed additional analysis by calculating the bistability probability under different <italic>D</italic> values (Fig. S2). Our results suggested that varying death rate indeed changed the bistability of the system. When the death rate equaled zero, mobile genetic elements that only modified growth rates would have no effects on population bistability. These results highlighted the importance of added death rate in driving multistability.</p>
<p>The strength of interspecies interaction also shaped the community bistability. By calculating the bistability probability under different values of <italic>γ</italic> (Fig. S3), we showed that while changing <italic>γ</italic> didn’t fundamentally alter our conclusion, the influence of HGT on population bistability became weak when interspecies interaction strength got smaller than 1. These results suggested that the role of HGT was more significant in population with strong competitions.</p>
</sec>
<sec id="s2b">
<title>HGT shapes the stability landscape of multi-species communities</title>
<p>The modeling framework can be readily generalized to more complex communities consisting of multiple competing species by taking into account the gene transfer between every pair of species. Consider a community of <italic>m</italic> species. Let <italic>s</italic><sub><italic>i</italic></sub> be the abundance of the <italic>i</italic>-th species. <italic>γ</italic><sub><italic>ij</italic></sub> represents the interspecies interaction strength that the <italic>i</italic>-th species imposes on the <italic>j</italic>-th species (<italic>i, j</italic> = 1,2, …, <italic>m</italic>). <italic>η</italic><sub><italic>jki</italic></sub> is the transfer rate of the <italic>s</italic><sub><italic>j</italic></sub> -originated plasmid from species <italic>k</italic> to species <italic>i. κ</italic><sub><italic>ij</italic></sub> is the loss rate of the <italic>j</italic>-th mobile genetic element in the <italic>i</italic>-th species. The growth rate effect of the <italic>j</italic>-th plasmid on the <italic>i</italic>-th species is denoted as <italic>λ</italic><sub><italic>ij</italic></sub>. <italic>p</italic><sub><italic>ij</italic></sub> describes the abundance of the subpopulation in the <italic>i</italic>-th species that carries the plasmid from the <italic>j</italic>-th species. The effective growth rate of the <italic>i</italic>-th species can be calculated based on all the plasmids that it carries: <inline-formula><inline-graphic xlink:href="599596v2_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The population dynamics can then be simulated by <italic>m</italic> + <italic>m</italic><sup><xref ref-type="bibr" rid="c2">2</xref></sup> equations that describe the temporal change of <italic>s</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>ij</italic></sub>, respectively (see Methods for more details).</p>
<p>To understand how changing gene transfer rate affects the stability landscape of complex microbiota, we estimated the number of alternative stable states by randomly initializing the abundance of each species 500 times between 0 and 1 following uniform distributions. For each initialization, we simulated the population dynamics for 2000 hours till the systems reached equilibrium and calculated the steady-state abundances of different species (Fig. S4). Limit cycles were not observed in our simulations (Fig. S5).</p>
<p>The calculate the absolute number of stable states, we grouped the steady states into different attractors using a given threshold. Steady states with their Euclidean distances smaller than the threshold belonged to the same group (Fig. S6). However, the estimation of this number can be biased by the intrinsic limitations of the numerical approach. For instance, the limited number of initializations can underestimate this number. In contrast, the inability of a system to reach equilibrium within the limited time window of simulations can cause its overestimation. To overcome such limitations, we developed an alternative metric <italic>χ</italic> to measure the multistability of a system by borrowing the concept of ‘entropy’. Let <italic>φ</italic> be the number of stable states and <italic>x</italic><sub><italic>i</italic></sub> be the relative size of each domain of attraction (∑<sub><italic>i</italic></sub> <italic>x</italic><sub><italic>i</italic></sub> = 1, <italic>i</italic> = 1,2, …, <italic>φ</italic>). <italic>χ</italic> is calculated as <italic>χ</italic> = <italic>exp</italic> (− ∑<sub><italic>i</italic></sub> <italic>x</italic><sub><italic>i</italic></sub> <italic>logx</italic><sub><italic>i</italic></sub>), which accounts for the absolute number of stable states as well as the size of each basin. <italic>χ</italic> equals 1 in monostable systems. <italic>χ</italic> gets larger when more stable states emerge or the distribution of the basin sizes become more even. Numerical tests suggested that <italic>χ</italic> was robust to the variations of distance threshold, simulation timespan or number of initializations (Fig. S7).</p>
<p>As shown in <xref rid="fig2" ref-type="fig">Fig. 2</xref>, when HGT is absent, the number of stable states was usually small in a multi-species population. Increasing gene transfer rate reshaped the stability landscape of a microbiome by creating additional stable states (<xref rid="fig2" ref-type="fig">Fig. 2a</xref> and <xref ref-type="fig" rid="fig2">b</xref>). Each stable state is characterized by a different dominant species (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>). The number of stable states is positively associated with HGT rate (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>, Fig. S8 and S9). This prediction is generally applicable to communities consisting of different number of species (Fig. S8 and S9). For communities of two species, bistability is not possible when <italic>γ</italic><sub><italic>ij</italic></sub>’s are smaller than 1. However, for communities of multiple species, multistability becomes possible even if all <italic>γ</italic><sub><italic>ij</italic></sub> values are smaller than 1 (Fig. S10). The effects of HGT on multistability held for different strengths of interspecies interactions (Fig. S10). Initializing the <italic>p</italic><sub><italic>ij</italic></sub> subpopulations with non-zero abundances didn’t change the conclusion, either (Fig. S11).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig. 2.</label>
<caption><title>The number of alternative stable states in multi-species communities increases with HGT rate.</title>
<p><bold>(a)</bold>, A schematic of the stability landscape of a population composed of multiple competing species with or without HGT. Each alternative stable state is characterized by a different dominant species (shown in filled circles).</p>
<p><bold>(b)</bold>, The emergence of alternative stable states in a five-species community with gene transfer. We simulated the dynamics of 500 parallel communities, each with the same kinetic parameters but different initial compositions. The species compositions of these communities at three different timepoints were shown by principal component analysis from left to right. Without HGT (<italic>η</italic> = 0), all populations converged into a single stable state. In contrast, with HGT (<italic>η</italic> = 0.2 <italic>hr</italic><sup>-”</sup>), four different attractors appear. Here, populations reaching different stable states were marked with different colors. Other parameters are <inline-formula><inline-graphic xlink:href="599596v2_inline51a.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, <italic>µ</italic><sub>1</sub> = 0.52 <italic>hr</italic><sup>−1</sup>, <italic>µ</italic><sub>2</sub> = 0.48 <italic>hr</italic><sup>−1</sup>, <italic>µ</italic><sub>3</sub> = 0.44 <italic>hr</italic><sup>−1</sup>, <italic>µ</italic><sub>4</sub> = 0.60 <italic>hr</italic><sup>−1</sup>, <italic>µ</italic><sub>5</sub> = 0.31 <italic>hr</italic><sup>−1</sup>, <italic>γ</italic> = 1.05, <italic>κ</italic> = 0.005 <italic>hr</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>hr</italic><sup>−1</sup>.</p>
<p><bold>(c)</bold>, The number of stable states (top panel) and the multistability coefficient <italic>χ</italic> increase with HGT rate in communities consisting of 8 competing species. We calculated the number of stable states by randomly initializing the species abundances 500 times between 0 and 1 following uniform distributions. Then we simulated the steady states and clustered them into different attractors by applying a threshold of 0.05 on their Euclidean distances. The data were presented as mean ± standard deviation of 10 replicates. Each replicate corresponded to a different combination of randomized species growth rates.</p></caption>
<graphic xlink:href="599596v2_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Here we assumed the interactions among different species were homogeneous. To evaluate whether this assumption was critical, we extended our analysis by considering heterogenous interaction strengths in multispecies communities (Fig. S12). In particular, we randomly sampled <italic>γ</italic><sub><italic>ij</italic></sub> values from uniform distributions. Our results suggested the mean value and variance of <italic>γ</italic><sub><italic>ij</italic></sub> played a role in shaping multistability. The effects of HGT on community multistability becomes stronger when the mean value of <italic>γ</italic><sub><italic>ij</italic></sub> gets larger than 1 and the variance of <italic>γ</italic><sub><italic>ij</italic></sub> is small (Fig. S12). Nevertheless, the heterogeneous distribution of <italic>γ</italic><sub><italic>ij</italic></sub> didn’t fundamentally change our conclusion.</p>
<p>MGEs can drive large growth rate differences when they encode adaptative traits like antibiotic resistance. In many cases, however, the growth rate effects of MGEs can be small. To evaluate the influence of <italic>λ</italic><sub><italic>ij</italic></sub> magnitude, we also analyzed different ranges of growth rates effects of mobile genetic elements, by sampling <italic>λ</italic><sub><italic>ij</italic></sub> values from uniform distributions with given widths (Fig. S13). Greater width led to larger magnitude of growth rate effects. We used five-species populations as an example and tested different ranges. Our results suggested that multistability was more feasible when the growth rate effects of MGEs were small (Fig. S13b). The qualitative relationship between HGT and community was not dependent on the range of growth rate effects (Fig. S13a).</p>
<p>So far, our analysis has been focused on communities where the interaction network is fully connected, and each species competes with every other member. In each of such populations, it is highly infeasible to achieve the stable coexistence of different species. While this analysis provides the basic proof of principle, natural environments often consist of many niches<sup><xref ref-type="bibr" rid="c30">30</xref></sup>. Species living in the same niche competes while species from different niches can coexist (Fig. S14a). To understand whether our conclusion is still applicable when niche effects are considered, we extended our analysis to communities carrying a random number of niches. Each species was randomly allocated into one of the niches, and the stability landscape was analyzed in the same way by randomly initializing the systems (see Methods for more details). Our results suggested that increasing HGT rate still promoted multistability, regardless of the niche structure of the competing communities (Fig. S14b-d).</p>
</sec>
<sec id="s2c">
<title>The role of HGT on community multistability when mobile genes modify interspecies interactions</title>
<p>Our previous analysis has focused on the role of HGT in communities where MGEs only affect species growth rates and have no influences on interspecies interactions. To evaluate how this modeling structure and the underlying assumptions affected the prediction, we extended our framework by accounting for the modifications of interspecies interactions by mobile genes.</p>
<p>In nature, the horizontal transfer of some genes can change the interspecies interaction strengths between different species. For instance, the sharing of many mobile genes can promote niche overlapping, leading to an increase of competition strength<sup><xref ref-type="bibr" rid="c31">31</xref>,<xref ref-type="bibr" rid="c32">32</xref></sup>. To understand how the transfer of these genes would influence community multistability, we adapted the previous model by considering the dynamic change of competition strength during HGT (see Supplementary Materials for more details). For two-species populations, we divided the interspecies interactions into two components: the basal competition strengths (<italic>γ</italic><sub>1</sub> and <italic>γ</italic><sub>2</sub>) and the added parts by HGT (<italic>δ</italic><sub>1</sub> and <italic>δ</italic><sub>2</sub>). The overall competition strength was calculated as <inline-formula><inline-graphic xlink:href="599596v2_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, respectively. Positive <italic>δ</italic>’s mean HGT promotes the inter-species competition, while negative <italic>δ</italic>’s mean HGT reduces the strength of interspecies competition (<xref rid="fig3" ref-type="fig">Fig. 3a-b</xref>). Numerical simulations with randomized parameters suggested that when <italic>δ</italic> was positive, HGT still promoted the bistability, whereas if <italic>δ</italic> was negative, gene transfer would reduce the chance of bistability (<xref rid="fig3" ref-type="fig">Fig. 3c-d</xref>). We further extended our analysis to multispecies communities and calculated the number of stable states. As shown in <xref rid="fig3" ref-type="fig">Fig. 3e</xref> and <xref ref-type="fig" rid="fig3">f</xref>, the number of stable states increases with HGT rate when MGEs promotes competition, while decreases with HGT rate when MGEs reduces competition.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Fig. 3.</label>
<caption><title>The effects of HGT on population multistability when MGEs promote or reduce the strength of interspecies competition.</title>
<p><bold>(a-b)</bold>, The schematics of HGT promoting or reducing competition.</p>
<p><bold>(c)</bold>, For populations of two species, when MGEs promote competition, increasing HGT rate enlarges the area of bistability region in the phase diagram. Here, <italic>δ</italic> describes the effect of mobile genes on the competition strength. Positive <italic>δ</italic> represents HGT promoting competition. In numerical simulations, we tested three different <italic>δ</italic> values (marked in different colors). When calculating the area of bistability region, we randomized <italic>µ</italic><sub>1</sub> and <italic>µ</italic><sub>2</sub> 500 times between 0 and 1 hr<sup>-1</sup> following uniform distributions while keeping <inline-formula><inline-graphic xlink:href="599596v2_inline51.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline52.gif" mime-subtype="gif" mimetype="image"/></inline-formula> constants. For each pair of growth rates, we randomized the initial abundance of each species 200 times between 0 and 1 following uniform distributions. The system was monostable if all initializations led to the same steady state. Otherwise, the system was bistable. Then we calculated the fraction of growth rate combinations that generated bistability out of the 500 random combinations. Other parameters are <italic>γ</italic><sub>1</sub> = <italic>γ</italic><sub>2</sub> = 1.1, <italic>κ</italic> = 0.005 <italic>h</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>h</italic><sup>−1</sup>.</p>
<p><bold>(d)</bold>, When MGEs reduce competition, the area of bistability region decreases with HGT rate. Three negative values <italic>δ</italic> were tested and shown as examples here.</p>
<p><bold>(e)</bold>, For populations of 5 species, when MGEs promote competition, the number of stable states increases with HGT rate. We calculated the number of stable states by randomly initializing the species abundances 500 times. Then we simulated the steady states and clustered them into different attractors by applying a threshold of 0.05 on their Euclidean distances. The data were presented as mean ± standard deviation of 10 replicates. Each replicate corresponds to a different combination of randomized species growth rates. Other parameters are <italic>γ</italic><sub><italic>ij</italic></sub> = 1.1, <italic>κ</italic> = 0.005 <italic>h</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>h</italic><sup>−1</sup>, <italic>δ</italic> = 0.5.</p>
<p><bold>(f)</bold>, When MGEs reduce competition, the number of stable states decrease with HGT rate. The data were presented as mean ± standard deviation of 10 replicates. <italic>δ</italic> = −0.5 was used in the simulation.</p>
<p><bold>(g)</bold>, For populations of two species without HGT, reducing the magnitude of <italic>λ</italic> (promoting ecological neutrality) enlarges the area of bistability. When gene transfer rate equals zero, changing <italic>δ</italic> does not influence bistability. When calculating bistability probability, we randomized <italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub> 500 times between −<italic>α</italic> and <italic>α</italic> following uniform distributions. <italic>α</italic> represents the magnitude of <italic>λ</italic> variations. <italic>µ</italic><sub>1</sub> and <italic>µ</italic><sub>2</sub> were calculated as <inline-formula><inline-graphic xlink:href="599596v2_inline53.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline54.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, respectively. The overall competition strength was calculated as <inline-formula><inline-graphic xlink:href="599596v2_inline56.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline57.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We tested different combinations of <italic>α</italic> (the magnitude of <italic>λ</italic> variations) and <italic>δ</italic> values. We then calculated the fraction (<italic>f</italic><sub>0</sub>) of growth rate combinations that generated bistability out of the 500 random combinations. Other parameters are <italic>γ</italic><sub>1</sub> = <italic>γ</italic><sub>2</sub> = 1.1, <italic>κ</italic> = 0.005 <italic>h</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>h</italic><sup>−1</sup>.</p>
<p><bold>(h)</bold>, In populations of two species with HGT, reducing the magnitude of <italic>λ</italic> (promoting ecological neutrality) or promoting <italic>δ</italic> value enlarges the area of bistability (<italic>f</italic><sub>1</sub>). <italic>η</italic> being 0.4 was tested as an example here.</p>
<p><bold>(i)</bold>, The effect of HGT on community bistability depends on how mobile genes modify growth rates and competition. Compared with the population without HGT, gene transfer promotes bistability when <italic>δ</italic> is zero or positive, while reduces bistability when <italic>δ</italic> is largely negative.</p></caption>
<graphic xlink:href="599596v2_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>These results suggested that the effects of HGT on bistability depended on how mobile genes shaped species growth rates and competitions. To place these two factors in a comprehensive framework, we further generalized the model structure, by accounting for the scenario where mobile genes modified growth rates and competitions at the same time. The effect of mobile genes on growth rates was represented by the magnitude of <italic>λ</italic>’s, and the influence on competition is described by the parameter <italic>δ</italic> (<xref rid="fig3" ref-type="fig">Fig. 3g</xref> to <xref ref-type="fig" rid="fig3">i</xref>). By varying these two parameters, we can evaluate how the model structure and the underlying assumptions affected the baseline expectation. We performed additional simulations with broad ranges of <italic>λ</italic> and <italic>δ</italic> values. In particular, we analyzed whether HGT would promote the likelihood of bistability in two-species communities compared with the scenario without gene transfer. Our results suggested that: (1) With or without HGT, reducing <italic>λ</italic> (increasing ecological neutrality) promoted bistability (<xref rid="fig3" ref-type="fig">Fig. 3g</xref> and <xref ref-type="fig" rid="fig3">h</xref>); (2) With HGT, increasing <italic>δ</italic> promoted bistability (<xref rid="fig3" ref-type="fig">Fig. 3h</xref>); (2) Compared with the population without HGT, gene transfer promoted bistability when <italic>δ</italic> was zero or positive, while reduces bistability when <italic>δ</italic> was largely negative (<xref rid="fig3" ref-type="fig">Fig. 3i</xref>). These results suggested that the interplay among HGT, species growth and interactions added new insights into the fundamental question of how microbes competing for a limited number of resources stably coexisted.</p>
</sec>
<sec id="s2d">
<title>The role of HGT on community multistability when MGE epitasis effects are present</title>
<p>In previous analysis, we also assumed that the effects of MGEs on host growth (<italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub>) were independent of the host species. In nature, however, the same MGE can have different growth rate effects in different genomic backgrounds, a phenomenon called epistasis<sup><xref ref-type="bibr" rid="c33">33</xref>-<xref ref-type="bibr" rid="c36">36</xref></sup>. There are two types of epistasis: magnitude epistasis, where the host genomic background only affects the magnitude but not the sign of <italic>λ</italic> value, and sign epistasis, where the same MGE is burdensome in one species while beneficial in the other host. The model can be readily extended to account for these two types of epistasis (see Supplementary Materials for more details). In particular, we dissected the growth rates <italic>µ</italic><sub>1</sub> and <italic>µ</italic><sub>2</sub> into two components: the basal growth rate (<inline-formula><inline-graphic xlink:href="599596v2_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula>), and the growth rate effects (<italic>λ</italic><sub>11</sub> and <italic>λ</italic><sub>12</sub>) of the mobile genetic elements. The growth rates of <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> were calculated as <italic>µ</italic><sub>1</sub>(1 + <italic>λ</italic><sub>12</sub>) and <italic>µ</italic><sub>2</sub>(1 + <italic>λ</italic><sub>21</sub>), respectively. Here <italic>λ</italic><sub><italic>ij</italic></sub> (<italic>i, j</italic> = 1,2) stands for the growth rate effects of the <italic>j</italic>-th mobile genetic element in the <italic>i</italic>-th species. Without epistasis, the growth rate effects are independent of the host species (<italic>λ</italic><sub>11</sub> = <italic>λ</italic><sub>21</sub> and <italic>λ</italic><sub>22</sub> = <italic>λ</italic><sub>12</sub>). The epistasis can be quantified by two ratios: <italic>ξ</italic><sub>1</sub> = <italic>λ</italic><sub>21</sub>/<italic>λ</italic><sub>11</sub> and <italic>ξ</italic><sub>2</sub> = <italic>λ</italic><sub>12</sub>/<italic>λ</italic><sub>22</sub>. <italic>ξ</italic><sub>1</sub> &gt;0 and <italic>ξ</italic><sub>2</sub> &gt;0 represent magnitude epistasis, whereas <italic>ξ</italic><sub>1</sub> &lt; 0 or <italic>ξ</italic><sub>2</sub> &lt; 0 represent the sign epistasis. We carried out additional numerical simulations to evaluate how different epistasis types influenced the role of HGT in community stability. Our results suggested that with magnitude epistasis, HGT still enlarged the area of bistability region (<xref rid="fig4" ref-type="fig">Fig. 4a</xref> and <xref ref-type="fig" rid="fig4">b</xref>). In contrast, sign epistasis overturned HGT’s role on community stability: with sign epistasis, increasing gene transfer rate reduced the area of bistability region (<xref rid="fig4" ref-type="fig">Fig. 4c</xref> and <xref ref-type="fig" rid="fig4">d</xref>). These results suggest that MGE epistasis might add another layer of complexities into the interplay between HGT and community stability.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Fig. 4.</label>
<caption><title>The influence of epistasis on the role of HGT in mediating population bistability.</title>
<p><bold>(a-b)</bold> With magnitude epistasis, increasing HGT rate still promotes bistability in populations of two competing species.</p>
<p><bold>(c-d)</bold> With sign epistasis, increasing HGT rate reduces the area of bistability region. For each type of epistasis, we considered two scenarios. In a and c, host genetic background influences the growth rate effect of only one MGE, while in b and d, host genetic background influences both MGEs. <italic>ξ</italic><sub>1</sub> and <italic>ξ</italic><sub>2</sub> are defined as <italic>λ</italic><sub>21</sub>/<italic>λ</italic><sub>11</sub> and <italic>λ</italic><sub>12</sub>/<italic>λ</italic><sub>22</sub>, respectively. <italic>ξ</italic><sub>1</sub> &gt;0 and <italic>ξ</italic><sub>2</sub> &gt;0 represent magnitude epistasis, while <italic>ξ</italic><sub>1</sub> &lt; 0 or <italic>ξ</italic><sub>2</sub> &lt; 0 represents the sign epistasis. Other parameters are <italic>γ</italic><sub>1</sub> = <italic>γ</italic><sub>2</sub> = 1.1, <italic>κ</italic> = 0.005 <italic>h</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>h</italic><sup>−1</sup>.</p></caption>
<graphic xlink:href="599596v2_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2e">
<title>Interplay between HGT and the multistability of communities under strong selections</title>
<p>The growth rate effect of an MGE can be extreme in some cases. For instance, under strong antibiotic selection, only cells carrying the antibiotic resistance genes (ARGs) can survive. To examine whether our conclusion is still applicable in this scenario, we generalized our model by considering the transfer of an MGE in a population under strong environmental selection (see Supplementary Materials for more details). Specifically, we assumed that the MGE was initially carried by one species in the populations. Without HGT, only the donor species carrying the MGE can survive due to selection (<xref rid="fig5" ref-type="fig">Fig. 5a</xref>). In this case, the system will always be monostable regardless of the initial species compositions. With HGT, the MGE can be transferred to other species, creating chances for other species to survive (<xref rid="fig5" ref-type="fig">Fig. 5b</xref>). To understand how HGT would affect community stability under this condition, we first analyzed the phase diagram of the two-species population. Our simulation results suggested that bistability became possible when there existed gene transfer and increasing HGT rate in general enlarged the bistability area (<xref rid="fig5" ref-type="fig">Fig. 5c</xref> and <xref ref-type="fig" rid="fig5">d</xref>). Here, without loss of generality we assumed that the MGE was initially carried only by species 1.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Fig. 5.</label>
<caption><title>HGT creates chances of multistability for communities under strong environmental selection.</title>
<p><bold>(a-b)</bold>, The schematics of communities under strong selection. Without HGT, only the donor species carrying the MGE can survive. HGT allows the other species to acquire MGE from the donor, creating opportunities for the other species to survive under strong selections.</p>
<p><bold>(c)</bold>, The phase diagram of two-species populations transferring an MGE. Different combinations of <italic>µ</italic><sub>1</sub> and <italic>µ</italic><sub>2</sub> between 0 and 1 <italic>hr</italic><sup>−1</sup> were tested. All combinations of <italic>µ</italic><sub>1</sub> and <italic>µ</italic><sub>2</sub> that led to bistability were marked in blue in the diagram. Other parameters are <italic>γ</italic> = 1.1, <italic>κ</italic> = 0.005 <italic>hr</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>hr</italic><sup>−1</sup>, <inline-formula><inline-graphic xlink:href="599596v2_inline58.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Here, we assumed that the ARG was initially carried only by species 1. Bistability was more feasible when <italic>µ</italic><sub>2</sub> &gt;<italic>µ</italic><sub>1</sub>.</p>
<p><bold>(d)</bold>, Increasing HGT rate enlarges the area of bistability region in the phase diagram of two competing species transferring an MGE. Three different competition strengths were tested (marked in different colors).</p>
<p><bold>(e-f)</bold>, For communities of 5 or 8 species under strong selection, increasing HGT rate promotes the emergence of alternative stable states. We calculated the number of stable states by randomly initializing the species abundances 500 times. Then we simulated the steady states and clustered them into different attractors. The carriage of the mobile gene changed the species growth rate from 0 to a positive value <italic>µ</italic><sub><italic>i</italic></sub>. When calculating the number of stable states in multi-species communities, we randomly drew the <italic>µ</italic><sub><italic>i</italic></sub> values from a uniform distribution between 0.3 and 0.7 <italic>hr</italic><sup>−1</sup>. The data were presented as mean ± standard deviation of 10 replicates. Each replicate corresponds to a different combination of randomized species growth rates. Other parameters are <italic>γ</italic><sub><italic>i,j</italic></sub> = 1.5, <italic>κ</italic> = 0.005 <italic>h</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>h</italic><sup>−1</sup>.</p></caption>
<graphic xlink:href="599596v2_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Bistability was more feasible when <italic>µ</italic><sub>2</sub> &gt;<italic>µ</italic><sub>1</sub> (<xref rid="fig5" ref-type="fig">Fig. 5c</xref>), suggesting that the effect of HGT on promoting bistability would be stronger when the weak competitor acted as the MGE donor. We further analyzed the number of stable states in multispecies communities. As shown in <xref rid="fig5" ref-type="fig">Fig. 5e</xref> and <xref ref-type="fig" rid="fig5">f</xref>, for these populations under antibiotic selection, increasing transfer rate of the MGE also promoted the emergence of multistability. This conclusion equally held under different interaction strengths or growth rate ranges (Fig. S15), suggesting the general applicability of HGT’s role in promoting multistability for communities under strong selection.</p>
</sec>
<sec id="s2f">
<title>HGT-enabled multistability promotes the regional coexistence of competing species</title>
<p>Our results highlight the role of HGT on shaping the stability landscape of closed local communities. Natural microbiomes, however, exist at scales broader than a localized population. A set of local communities in similar environments, also known as ‘patches’, form a metacommunity<sup><xref ref-type="bibr" rid="c37">37</xref>,<xref ref-type="bibr" rid="c38">38</xref></sup>. When multiple stable states coexist, the species compositions of different patches may differ from each other due to the variability of their initial configurations. Collectively, the multistability in the local patches might give rise to the regional species diversity in the metacommunity. This intuition leads to our hypothesis that HGT allows the stable coexistence of multiple competing species at regional scale, even when species exclusively outcompete each other in every local population.</p>
<p>To examine this hypothesis, we constructed metacommunities of 100 patches connected by dispersal of microbes. Without loss of generality, we considered a 2-D array of local patches and assumed that the dispersal only occurred between adjacent patches (Fig. S16a, see Methods for more details). Each local patch carried 10 competing species that exchanged mobile gene elements with each other. The dynamics of each patch was governed by the same set of parameters but initialized with different species compositions. We then numerically simulated the dynamics of the metacommunity till it reached the steady state.</p>
<p>Without HGT, the metacommunity exhibited strong spatial homogeneity at regional scale (Fig. S16b). Different patches rested at similar species compositions. In contrast, HGT created a spatial pattern of species distributions across different patches, due to the emergent multistability (Fig. S16b). To analyze the influence of HGT on regional diversity, we pooled all local populations together and calculated the collective species diversity in the pool using Shannon index. Our results suggested that while local diversity remained low regardless of HGT rate, the regional diversity of microbial species increased with HGT rate (Fig. S16b and c). The conclusion is applicable for different dispersal rates (Figs. S17 and S18). These results highlight the fundamental role of HGT in community stability and diversity at local and regional scale.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Our work predicts that in many scenarios horizontal gene flow promotes multistability in communities of competing microbes. At the scale of local populations, the emergence of alternative stable states undermines the global stability of the community, making the system less resilient to perturbations and creating greater opportunities for regime shifts. In metacommunities, gene flow creates spatial heterogeneity of species compositions in different patches. Despite the low diversity in every local patch, HGT-driven multistability creates substantial diversity at regional scale. In microbial ecology, how microbes competing for a limited number of resources stably coexist has been a long-standing puzzle<sup><xref ref-type="bibr" rid="c39">39</xref>,<xref ref-type="bibr" rid="c40">40</xref></sup>. Our results highlight the importance of considering gene exchange when addressing this fundamental challenge.</p>
<p>While this work predicts the potential role of HGT in microbiota diversity and stability, several caveats need to be considered when applying this prediction. For MGEs with sign epistasis, or MGEs that relax interspecies competitions, HGT might reduce the number of stable states. The relative importance of gene flow in a real community might also be context dependent. The effect of HGT in promoting multistability might be stronger between species with intense competition (Fig. S3) and similar growth rates (Fig. S13). The relative importance of HGT in real environment is also dependent on the maximum carrying capacity of the population. Simulations by scanning the <italic>η</italic> value from 10<sup>−7</sup> to 1 suggested that increasing HGT rates started to promote multistability when <italic>η</italic> value exceeded 10<sup>−2</sup> per hour (Fig. S9). This corresponds to a conjugation efficiency of 10<sup>−11</sup> <italic>cell</italic><sup>−1</sup> · <italic>hr</italic><sup>−1</sup> · <italic>mL</italic> when the maximum carrying capacity equals 10<sup>9</sup> <italic>cells</italic> · <italic>mL</italic><sup>−1</sup>, or a conjugation efficiency of 10<sup>−14</sup> <italic>cell</italic><sup>−1</sup> · <italic>hr</italic><sup>−1</sup>· <italic>mL</italic> when the maximum carrying capacity equals 10<sup>12</sup> <italic>cells</italic> · <italic>mL</italic><sup>−1</sup>. Therefore, in environments with high cell density and abundant MGEs, such as mammal gut, the role of HGT will be more prominent<sup><xref ref-type="bibr" rid="c41">41</xref></sup>. In contrast, the influence of HGT on community multistability might become less important in populations with poor cell density and slow gene transfer.</p>
<p>Our work provided a comprehensive framework to explore how different parameters, including but not limited to HGT rates, collectively shaped community multistability. For instance, our simulations suggested that nonzero cell death or dilution rate was essential for the bistability of two competing species. Promoting competition strength in general enlarged multistability region. Besides, multistability was also dependent on community neutrality, <italic>i</italic>.<italic>e</italic>. the growth rate similarities among different competitors. Multistability is more feasible for communities with high neutrality. Which mechanisms contribute most to the multistability of a given community might be context-specific, depending on the values of different parameters in the population.</p>
<p>Our model allowed multiple plasmids to infect a single cell, but ignored the ecological interactions between different plasmids. These complex interactions are governed by many different processes: from systems that exclude the entry of other plasmids, incompatibility system that eliminates within-cell coexistence, to interference in the regulation of plasmid copy number<sup><xref ref-type="bibr" rid="c42">42</xref>,<xref ref-type="bibr" rid="c43">43</xref></sup>. These interactions can further change the distribution of plasmids among different species, alter the structure of gene transfer network, and reshape the stability landscape of a microbial community. However, the general conclusion regarding how these interactions shape population multistability remains to be established in future studies.</p>
<p>Previous studies documented the presence of multiple alternative community types in soil<sup><xref ref-type="bibr" rid="c15">15</xref></sup>, human vaginal, gut and oral microbiomes<sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c44">44</xref>,<xref ref-type="bibr" rid="c45">45</xref></sup>. In particular, multiple groups of bacteria in human gut exhibit robust bistable abundance distributions, resulting in over 32 different stable state combinations<sup><xref ref-type="bibr" rid="c46">46</xref></sup>. Our results provide a plausible explanation for the large number of community types in these populations, even though our interpretation doesn’t exclude other mechanisms including gradients of environmental factors<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Disentangling the contributions of HGT from the other factors in diverse natural microbiomes is a promising topic for future research.</p>
<p>Controlling the multistability of complex microbiota has important applications in human health. For instance, in gut microbiome, the development of unhealthy stable states is closely related to many diseases such as obesity, type 2 diabetes mellitus and gastrointestinal disorders<sup><xref ref-type="bibr" rid="c47">47</xref>-<xref ref-type="bibr" rid="c49">49</xref></sup>. Strategies have been developed to overcome the resilience of unhealthy states, including fecal transplantation or supplementation with probiotics<sup><xref ref-type="bibr" rid="c18">18</xref></sup>. Our work predicts that the horizontal transfer of MGEs such as plasmids might be an additional mechanism for the emergence of the unhealthy states. Indeed, human gut is a ‘hotspot’ of gene flow<sup><xref ref-type="bibr" rid="c41">41</xref></sup>. Previous studies suggested that some small molecules such as unsaturated fatty acids can inhibit the conjugative transfer of plasmids<sup><xref ref-type="bibr" rid="c50">50</xref>-<xref ref-type="bibr" rid="c52">52</xref></sup>. By binding the type IV secretion traffic ATPase TrwD, these compounds limit the pilus biogenesis and DNA translocation<sup><xref ref-type="bibr" rid="c53">53</xref></sup>. Therefore, modulating MGE spread using these molecules might offer new opportunities to reshape the stability landscape and narrow down the attraction domains of the disease states<sup><xref ref-type="bibr" rid="c51">51</xref>,<xref ref-type="bibr" rid="c54">54</xref></sup>.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Modeling framework of two competing species sharing mobile genes</title>
<p>We used a mathematical model developed in a previous work to analyze the population dynamics of two competing species transferring mobilizable plasmids with growth rate effects<sup><xref ref-type="bibr" rid="c28">28</xref></sup>. Briefly, the model includes four ordinary differential equations (ODEs):
<disp-formula id="eqn1">
<graphic xlink:href="599596v2_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn2">
<graphic xlink:href="599596v2_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn3">
<graphic xlink:href="599596v2_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn4">
<graphic xlink:href="599596v2_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> are the abundances of the two species. <italic>R</italic><sub>1</sub> and <italic>R</italic><sub>2</sub> describe the strengths of interspecies competition. <italic>N</italic><sub><italic>m</italic>,1</sub> and <italic>N</italic><sub><italic>m</italic>,2</sub> are the maximum carrying capacities for species 1 and 2, respectively. <italic>D</italic> is the dilution rate. <italic>P</italic><sub><italic>i</italic></sub> (<italic>i</italic> = 1, 2) represents the abundance of the subpopulation in the <italic>i</italic>-th species that acquires the mobilizable genes from its competitor. Here, we assumed that the populations would not lose their own native plasmids completely. The internal inhibition within each species was also assumed to be independent of the acquired MGEs. <italic>µ</italic><sub><italic>i</italic></sub> represents the maximum ‘per capita’ growth rate of the <italic>i</italic>-th species when interspecies HGT is absent. <italic>µ</italic><sub><italic>i</italic></sub> is calculated as <inline-formula><inline-graphic xlink:href="599596v2_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula> where <inline-formula><inline-graphic xlink:href="599596v2_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the basal growth rate determined by the non-mobilizable genes and <italic>λ</italic><sub><italic>i</italic></sub> is the growth rate effect of the plasmids. Interspecies gene flow allows each species to acquire plasmids from its competitor, resulting in the dynamic change of the effective species growth rates <inline-formula><inline-graphic xlink:href="599596v2_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, which is calculated as: <inline-formula><inline-graphic xlink:href="599596v2_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For instance, all cells of species 1 carry the plasmid 1. Therefore, their growth rate can be obtained as <inline-formula><inline-graphic xlink:href="599596v2_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. After HGT, the overall growth rate of species 1 changes because some of the individuals get the plasmid from the second species. Such a change is reflected by the <italic>λ</italic><sub>2</sub> term in <inline-formula><inline-graphic xlink:href="599596v2_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. <inline-formula><inline-graphic xlink:href="599596v2_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula> stand for HGT rates. Here, we described the HGT process by mass action kinetics, an assumption commonly made for plasmid transfer dynamics. We further assumed that intraspecies and interspecies transfer occurred at the same rates. <italic>κ</italic><sub>1</sub> and <italic>κ</italic><sub>2</sub> represent the loss rates of the mobile genetic elements. For plasmids, <italic>κ</italic><sub>1</sub> and <italic>κ</italic><sub>2</sub> describe the loss rate by segregation errors.</p>
<p>Let <inline-formula><inline-graphic xlink:href="599596v2_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The model can be further simplified as
<disp-formula id="eqn5">
<graphic xlink:href="599596v2_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn6">
<graphic xlink:href="599596v2_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn7">
<graphic xlink:href="599596v2_eqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn8">
<graphic xlink:href="599596v2_eqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here, <italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> are dimensionless. <italic>η</italic><sub><italic>i</italic></sub> is related with <inline-formula><inline-graphic xlink:href="599596v2_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula> describes the ratio between <italic>N</italic><sub><italic>m</italic>,2</sub> and <italic>N</italic><sub><italic>m</italic>,1</sub>: ϱ = <italic>N</italic><sub><italic>m</italic>,2/</sub><italic>N</italic><sub><italic>m</italic>,1</sub>. For simplicity, we assumed that the two species had the same carrying capacity, <italic>i</italic>.<italic>e</italic>. ϱ = 1. The unit of <italic>η</italic><sub>1</sub> and <italic>η</italic><sub>2</sub> is <italic>hour</italic><sup>−1</sup>. Without HGT, <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> become consistently 0, and the model is equivalent to the classic Lotka-Volterra (LV) framework:
<disp-formula id="eqn9">
<graphic xlink:href="599596v2_eqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn10">
<graphic xlink:href="599596v2_eqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s4b">
<title>Stability analysis of the classic LV model</title>
<p>The classic LV model has four fixed points: <inline-formula><inline-graphic xlink:href="599596v2_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The Jacobian matrix of each fixed point can be calculated as <inline-formula><inline-graphic xlink:href="599596v2_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="599596v2_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are the species abundances at each fixed point.</p>
<p>The system is bistable only when <italic>ℊ</italic><sub>2</sub> and <italic>ℊ</italic><sub>3</sub> are both stable. The Jacobian matrix of <italic>ℊ</italic><sub>2</sub> is <inline-formula><inline-graphic xlink:href="599596v2_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The eigenvalues of <italic>J</italic><sub>2</sub> can be obtained as <inline-formula><inline-graphic xlink:href="599596v2_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>D</italic> – <italic>µ</italic><sub>2</sub>. <italic>ℊ</italic><sub>2</sub> is stable when both eigenvalues are negative, which leads to <italic>γ</italic><sub>2</sub> &gt;<italic>ϕ</italic><sub>2/</sub><italic>ϕ</italic><sub>1</sub> where <inline-formula><inline-graphic xlink:href="599596v2_inline31.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline32.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Similarly, <italic>ℊ</italic><sub>3</sub> is stable when <italic>γ</italic><sub>1</sub> &gt;<italic>ϕ</italic><sub>2/</sub><italic>ϕ</italic><sub>1</sub>. Therefore, the condition for the system being bistable is <italic>γ</italic><sub>2</sub> &gt;<italic>ϕ</italic><sub>1</sub>/<italic>ϕ</italic><sub>2</sub> and <italic>γ</italic><sub>1</sub> &gt;<italic>ϕ</italic><sub>2/</sub><italic>ϕ</italic><sub>1</sub>.</p>
</sec>
<sec id="s4c">
<title>Bistability analysis of two-species populations by numerical simulations</title>
<p>We performed numerical simulations to determine the bistability of a population consisting of two competing species transferring mobile genes. Specifically, for a system with given parameters, we randomly initialized the species abundances between 0 and 1 following uniform distributions for 200 times. Then we simulated the dynamics of each population till the abundance of every species reached equilibrium, and we treated it as a steady state. We grouped the 200 steady states into different attractors by applying the threshold of 0.01. Two steady states with their Euclidean distance smaller than the threshold belonged to the same group. The Euclidean distance was calculated as <inline-formula><inline-graphic xlink:href="599596v2_inline33.gif" mime-subtype="gif" mimetype="image"/></inline-formula> where <italic>k</italic> is the species index and <italic>s</italic><sub><italic>j,k</italic></sub> represents the abundance of the <italic>k</italic>-th species in the <italic>i</italic>-th steady state.</p>
</sec>
<sec id="s4d">
<title>Theoretical framework of multiple competing species transferring mobile genes</title>
<p>For a community of <italic>m</italic> competing species that share mobile genes with each other, the modeling framework consists of two groups of ODEs:
<disp-formula id="eqn11">
<graphic xlink:href="599596v2_eqn11.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn12">
<graphic xlink:href="599596v2_eqn12.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<italic>s</italic><sub><italic>i</italic></sub> is the abundance of the <italic>i</italic>-th species. <italic>p</italic><sub><italic>ij</italic></sub> is the size of the subpopulation in the <italic>i</italic>-th species that acquires <italic>s</italic><sub><italic>i</italic></sub> -originated MGEs. <italic>γ</italic><sub><italic>ji</italic></sub> is the negative interaction that <italic>s</italic><sub><italic>j</italic></sub> imposes on the <italic>i</italic>-th species. <italic>D</italic> is the dilution rate.<inline-formula><inline-graphic xlink:href="599596v2_inline34.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, the effective growth rate of <italic>s</italic><sub><italic>i</italic></sub>, is calculated by <inline-formula><inline-graphic xlink:href="599596v2_inline35.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is defined as <inline-formula><inline-graphic xlink:href="599596v2_inline36.gif" mime-subtype="gif" mimetype="image"/></inline-formula>where <inline-formula><inline-graphic xlink:href="599596v2_inline37.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the basal growth rate, <italic>λ</italic><sub><italic>ij</italic></sub> is the growth rate effect of the <italic>s</italic><sub><italic>j</italic></sub>-originated MGEs in the <italic>i</italic>-th species. <italic>η</italic><sub><italic>jki</italic></sub> is the transfer rate of the <italic>s</italic><sub><italic>j</italic></sub>-originated plasmids from species <italic>k</italic> to species <italic>i. κ</italic><sub><italic>ij</italic></sub> is the loss rate of the <italic>j</italic>-th mobile genetic element in the <italic>i</italic>-th species.</p>
</sec>
<sec id="s4e">
<title>Analysis of multistability of complex communities</title>
<p>For a population of <italic>m</italic> species with given niches and kinetic parameters, we initialized the system 500 times in the ranges of 0 &lt; <italic>s</italic><sub><italic>i</italic></sub> &lt; 1 following uniform distributions. The initial conditions for <italic>p</italic><sub><italic>ij</italic></sub>’s are <italic>p</italic><sub><italic>ii</italic></sub> = <italic>s</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>ij</italic></sub> = 0 (<italic>i</italic> ≠ <italic>j</italic>). Then the dynamics of each population was simulated for 2000 hours till the system reached the steady state. For each steady state we obtained the corresponding species composition and grouped the 500 solutions into different stable states based on their Euclidean distances.</p>
</sec>
<sec id="s4f">
<title>Horizontal gene transfer within communities under strong environmental selection</title>
<p>Under strong antibiotic selections, only cells carrying antibiotic resistant MGEs can survive. To examine whether our conclusion is still applicable in this scenario, we generalized our model by considering the transfer of an antibiotic-resistant gene (ARG) in a population of <italic>m</italic> species under strong antibiotic selection. Within each species, only cells carrying the MGE can grow, with <italic>µ</italic><sub><italic>i</italic></sub> being their maximum growth rate. The cells without the MGE will be eventually depleted by dilution <italic>D</italic>. The community dynamics can be described by the following ODEs (<italic>i</italic> = 1,2, …, <italic>m</italic>):
<disp-formula id="eqn13">
<graphic xlink:href="599596v2_eqn13.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn14">
<graphic xlink:href="599596v2_eqn14.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<italic>s</italic><sub><italic>i</italic></sub> is the total abundance of the <italic>i</italic>-th species, and <italic>p</italic><sub><italic>i</italic></sub> is the abundance of cells carrying the MGE in <italic>s</italic><sub><italic>i</italic></sub>. In the first equation, the first term describes the overall growth of the <italic>i</italic>-th species, which is only contributed by <italic>p</italic><sub><italic>i</italic></sub> since the MGE-free cells are not able to grow. <italic>η</italic><sub><italic>ji</italic></sub> is the MGE transfer rate from the <italic>j</italic>-th to the <italic>i</italic>-th species. <italic>κ</italic><sub><italic>i</italic></sub> is MGE loss rate in the <italic>i</italic>-th species. <italic>γ</italic><sub><italic>ji</italic></sub> describes the inter-species competition strength.</p>
<p>Without loss of generality, we assumed the species 1 was the MGE donor and <italic>p</italic><sub>1</sub> was equal with <italic>s</italic><sub>1</sub>. Without HGT, the MGE only resides in the donor species, while HGT allows the MGE to be shared with other species. To understand how HGT rate influences community multistability, we calculated the phase diagram of populations of two competing species. Increasing HGT rate enlarged the bistability region. We further analyzed the number of alternative stable states in communities of 5 or 8 species. In particular, we randomly initialized the species abundances 500 times, simulated the steady states and clustered them into different attractors. When calculating the number of stable states in multi-species communities, we randomly drew the <italic>µ</italic><sub><italic>i</italic></sub> values from a uniform distribution between 0.3 and 0.7 <italic>hr</italic><sup>−1</sup>. Our results suggested that the number of stable states in general increased with HGT rate.</p>
</sec>
<sec id="s4g">
<title>Niche-based model of multi-species communities</title>
<p>For a community consisting of <italic>m</italic> competing species, let the number of niches be <italic>l</italic>. Each niche has a maximum carrying capacity <inline-formula><inline-graphic xlink:href="599596v2_inline38.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Each species lives in one of the niches. Let <italic>M</italic> be the map from species index to the index of its niche. <italic>M</italic><sub><italic>i</italic></sub> = <italic>k</italic> means that the <italic>i</italic>-th species lives in the <italic>k</italic>-th niche. For species <italic>i</italic> and <italic>j</italic>, if <italic>M</italic><sub><italic>i</italic></sub> = <italic>M</italic><sub><italic>j</italic></sub>, these two species belong to the same niche and compete with each other. Species from different niche do not directly interact. Therefore, the model becomes:
<disp-formula id="eqn15">
<graphic xlink:href="599596v2_eqn15.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn16">
<graphic xlink:href="599596v2_eqn16.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here, <italic>s</italic><sub><italic>i</italic></sub> is the abundance of the <italic>i</italic>-th species. <italic>p</italic><sub><italic>ij</italic></sub> is the size of the subpopulation in the <italic>i</italic>-th species that acquires <italic>s</italic><sub><italic>j</italic></sub>-originated mobile genes. <italic>γ</italic><sub><italic>ji</italic></sub> is the negative interaction that <italic>s</italic><sub><italic>j</italic></sub> imposes on the <italic>i</italic>-th species. <italic>η</italic><sub><italic>jki</italic></sub> is the transfer rate of the <italic>s</italic><sub><italic>j</italic></sub>-originated genes from species <italic>k</italic> to species <italic>i</italic>. In simulations, the number of niches was randomized between 2 and <italic>m</italic>/2. The maximum carrying capacity of each niche was randomized between 0 and 1 following uniform distributions. Then each species was randomly allocated into one of the niches.</p>
</sec>
<sec id="s4h">
<title>Theoretical framework of metacommunity dynamics</title>
<p>Consider a metacommunity composed of <italic>u</italic> × <italic>v</italic> local patches. We assumed a grid-like arrangement of patched connected by dispersal terms ℋ. The location of each patch can be described by two coordinates [<italic>a, b</italic>] (<italic>a</italic> = 1,2, …, <italic>u</italic> and <italic>b</italic> = 1,2, …, <italic>v</italic>). Let ω be the dispersal rate between the adjacent patches. The dynamics of the metacommunity can then be described by generalizing <xref ref-type="disp-formula" rid="eqn11">equations (11)</xref> and <xref ref-type="disp-formula" rid="eqn12">(12)</xref> to each local patch:
<disp-formula id="eqn17">
<graphic xlink:href="599596v2_eqn17.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn18">
<graphic xlink:href="599596v2_eqn18.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
For the patch located at [<italic>a, b</italic>], <italic>s</italic><sub><italic>a,b,i</italic></sub> is the abundance of the <italic>i</italic>-th species, and <italic>p</italic><sub><italic>a,b,i,j</italic></sub> is the size of the subpopulation in the <italic>i</italic>-th species that acquires <italic>s</italic><sub><italic>j</italic></sub>-originated mobile genes. The effective growth rate <inline-formula><inline-graphic xlink:href="599596v2_inline39.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is calculated as <inline-formula><inline-graphic xlink:href="599596v2_inline40.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
<p><inline-formula><inline-graphic xlink:href="599596v2_inline41.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline42.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are the gains of <italic>s</italic><sub><italic>a,b,i</italic></sub> and <italic>p</italic><sub><italic>a,b,i,j</italic></sub> by dispersal, respectively. We assumed that microbial dispersal only occurred between adjacent patches. Therefore, <inline-formula><inline-graphic xlink:href="599596v2_inline43.gif" mime-subtype="gif" mimetype="image"/></inline-formula> was calculated by summing the dispersal terms at four directions: left, right, up, and down. The left component can be calculated as
<disp-formula id="ueqn1">
<graphic xlink:href="599596v2_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Similarly, <inline-formula><inline-graphic xlink:href="599596v2_inline44.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v2_inline45.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is calculated as:
<disp-formula id="ueqn2">
<graphic xlink:href="599596v2_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<inline-formula><inline-graphic xlink:href="599596v2_inline46.gif" mime-subtype="gif" mimetype="image"/></inline-formula> can then be obtained as <inline-formula><inline-graphic xlink:href="599596v2_inline47.gif" mime-subtype="gif" mimetype="image"/></inline-formula> can be formulated in the similar way.</p>
</sec>
<sec id="s4i">
<title>The collective species diversity in a metacommunity</title>
<p>To analyze the total species diversity in a metacommunity, we first calculated the total abundance of each species across all patches: <italic>s</italic><sub><italic>i</italic></sub> = ∑<sub><italic>a</italic>=1,2,…,<italic>u</italic></sub> ∑<sub><italic>b</italic>=1,2,…,<italic>v</italic></sub> <italic>s</italic><sub><italic>a,b,j</italic></sub>. Then we measured the diversity using Shannon index, a common metric used in ecology. Shannon index can be calculated as <inline-formula><inline-graphic xlink:href="599596v2_inline48.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. <italic>s</italic><sub><italic>p</italic></sub> is the total species abundance: <inline-formula><inline-graphic xlink:href="599596v2_inline49.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
</sec>
<sec id="s4j">
<title>Biological relevance of our analysis</title>
<p>The empirically measured gene transfer rates (denoted as <italic>η</italic><sup><italic>c</italic></sup>, with the unit of <italic>cells</italic><sup>−1</sup>· <italic>mL</italic> · <italic>hour</italic><sup>−1</sup>) should be multiplied by <italic>N</italic><sub><italic>m</italic></sub>, the maximum carrying capacity of the population, before being used in our model. Therefore, the transfer rate <italic>η</italic> in our analysis are several orders of magnitude higher than the experimentally measured rates<sup><xref ref-type="bibr" rid="c55">55</xref>,<xref ref-type="bibr" rid="c56">56</xref></sup>. In this work, we focused on HGT rate in the range of 0 &lt; <italic>η</italic><sub><italic>i</italic></sub> &lt; 0.4 <italic>hour</italic><sup>−1</sup>. Whether this range is biologically relevant depends on <italic>N</italic><sub><italic>m</italic></sub> of the population. Considering the typical estimates of plasmid transfer rates cross species (10<sup>−13</sup> <italic>cells</italic><sup>−1</sup> · <italic>mL</italic> · <italic>hour</italic><sup>−1</sup>, from <italic>Klebsiella pneumoniae</italic> to <italic>Escherichia coli</italic>) and within species (10<sup>−7</sup> <italic>cells</italic><sup>−1</sup> · <italic>mL</italic> · <italic>hour</italic><sup>−1</sup>, between <italic>E. coli</italic> strains) provided by a previous study<sup><xref ref-type="bibr" rid="c55">55</xref></sup>, HGT rates in our analysis are relevant in various environments from human colon (∼10<sup>12</sup> cells per gram) <sup><xref ref-type="bibr" rid="c57">57</xref></sup> to deep oceanic subsurface (10<sup>6</sup>∼10<sup>8</sup> cells per gram)<sup><xref ref-type="bibr" rid="c58">58</xref></sup>.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>This work is supported by Shenzhen Institute of Synthetic Biology Scientific Research Program (Grant No. HSE199011086). The funder had no role in study design, data collection and analysis, the decision to publish, or the preparation of the manuscript.</p>
</ack>
<sec id="s5">
<title>Code Availability</title>
<p>All the codes and source data associated with the numerical simulations and analysis of this manuscript are available at the Github repository: (<ext-link ext-link-type="uri" xlink:href="https://github.com/twang1993/MultistabilityByHGT">https://github.com/twang1993/MultistabilityByHGT</ext-link>).</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gonze</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Lahti</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Raes</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Faust</surname>, <given-names>K.</given-names></string-name></person-group> <article-title>Multi-stability and the origin of microbial community types</article-title>. <source>The ISME Journal</source> <volume>11</volume>, <fpage>2159</fpage>–<lpage>2166</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c2"><label>2</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arumugam</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Enterotypes of the human gut microbiome</article-title>. <source>Nature</source> <volume>473</volume>, <fpage>174</fpage>–<lpage>180</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c3"><label>3</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gibson</surname>, <given-names>T. E.</given-names></string-name>, <string-name><surname>Bashan</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Cao</surname>, <given-names>H.-T.</given-names></string-name>, <string-name><surname>Weiss</surname>, <given-names>S. T.</given-names></string-name> &amp; <string-name><surname>Liu</surname>, <given-names>Y.-Y.</given-names></string-name></person-group> <article-title>On the origins and control of community types in the human microbiome</article-title>. <source>PLoS Computational Biology</source> <volume>12</volume>, <fpage>e1004688</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c4"><label>4</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Estrela</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Functional attractors in microbial community assembly</article-title>. <source>Cell Systems</source> <volume>13</volume>, <fpage>29</fpage>–<lpage>42.e27</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c5"><label>5</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaparro-Pedraza</surname>, <given-names>P. C.</given-names></string-name> &amp; <string-name><surname>de Roos</surname>, <given-names>A. M.</given-names></string-name></person-group> <article-title>Ecological changes with minor effect initiate evolution to delayed regime shifts</article-title>. <source>Nature Ecology and Evolution</source> <volume>4</volume>, <fpage>412</fpage>–<lpage>418</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c6"><label>6</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beardmore</surname>, <given-names>R. E.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Drug-mediated metabolic tipping between antibiotic resistant states in a mixed-species community</article-title>. <source>Nature Ecology and Evolution</source> <volume>2</volume>, <fpage>1312</fpage>–<lpage>1320</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c7"><label>7</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amor</surname>, <given-names>D. R.</given-names></string-name>, <string-name><surname>Ratzke</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Gore</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Transient invaders can induce shifts between alternative stable states of microbial communities</article-title>. <source>Science Advances</source> <volume>6</volume>, <fpage>eaay8676</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c8"><label>8</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Relman</surname>, <given-names>D. A.</given-names></string-name></person-group> <article-title>The human microbiome: ecosystem resilience and health</article-title>. <source>Nutrition Reviews</source> <volume>70</volume>, <fpage>S2</fpage>–<lpage>S9</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c9"><label>9</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hartmann</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Six</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Soil structure and microbiome functions in agroecosystems</article-title>. <source>Nature Reviews Earth and Environment</source> <volume>4</volume>, <fpage>4</fpage>–<lpage>18</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c10"><label>10</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The shift of soil microbial community induced by cropping sequence affect soil properties and crop yield</article-title>. <source>Frontiers in Microbiology</source> <volume>14</volume>, <fpage>1095688</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c11"><label>11</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Hasty</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Stability, robustness, and containment: preparing synthetic biology for real-world deployment</article-title>. <source>Current Opinion in Biotechnology</source> <volume>79</volume>, <fpage>102880</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c12"><label>12</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fuhrman</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Cram</surname>, <given-names>J. A.</given-names></string-name> &amp; <string-name><surname>Needham</surname>, <given-names>D. M.</given-names></string-name></person-group> <article-title>Marine microbial community dynamics and their ecological interpretation</article-title>. <source>Nature Reviews Microbiology</source> <volume>13</volume>, <fpage>133</fpage>–<lpage>146</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c13"><label>13</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khazaei</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Metabolic multistability and hysteresis in a model aerobe-anaerobe microbiome community</article-title>. <source>Science Advances</source> <volume>6</volume>, <fpage>eaba0353</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c14"><label>14</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dubinkina</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Fridman</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Pandey</surname>, <given-names>P. P.</given-names></string-name> &amp; <string-name><surname>Maslov</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Multistability and regime shifts in microbial communities explained by competition for essential nutrients</article-title>. <source>Elife</source> <volume>8</volume>, <elocation-id>e49720</elocation-id> (<year>2019</year>).</mixed-citation></ref>
<ref id="c15"><label>15</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fujita</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Alternative stable states, nonlinear behavior, and predictability of microbiome dynamics</article-title>. <source>Microbiome</source> <volume>11</volume>, <fpage>63</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c16"><label>16</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mangal</surname>, <given-names>U.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Multistability and hysteresis in states of oral microbiota: Is it impacting the dental clinical cohort studies?</article-title> <source>Journal of Periodontal Research</source> <volume>58</volume>, <fpage>381</fpage>–<lpage>391</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c17"><label>17</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zaoli</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Grilli</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>A macroecological description of alternative stable states reproduces intra-and inter-host variability of gut microbiome</article-title>. <source>Science Advances</source> <volume>7</volume>, <fpage>eabj2882</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c18"><label>18</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fassarella</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Gut microbiome stability and resilience: elucidating the response to perturbations in order to modulate gut health</article-title>. <source>Gut</source> <volume>70</volume>, <fpage>595</fpage>–<lpage>605</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c19"><label>19</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van den Berg</surname>, <given-names>N. I.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Ecological modelling approaches for predicting emergent properties in microbial communities</article-title>. <source>Nature Ecology and Evolution</source> <volume>6</volume>, <fpage>855</fpage>–<lpage>865</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c20"><label>20</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soucy</surname>, <given-names>S. M.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Gogarten</surname>, <given-names>J. P.</given-names></string-name></person-group> <article-title>Horizontal gene transfer: building the web of life</article-title>. <source>Nature Reviews Genetics</source> <volume>16</volume>, <fpage>472</fpage>–<lpage>482</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c21"><label>21</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bordenstein</surname>, <given-names>S. R.</given-names></string-name> &amp; <string-name><surname>Reznikoff</surname>, <given-names>W. S.</given-names></string-name></person-group> <article-title>Mobile DNA in obligate intracellular bacteria</article-title>. <source>Nature Reviews Microbiology</source> <volume>3</volume>, <fpage>688</fpage>–<lpage>699</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c22"><label>22</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brito</surname>, <given-names>I. L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Mobile genes in the human microbiome are structured from global to individual scales</article-title>. <source>Nature</source> <volume>535</volume>, <fpage>435</fpage>–<lpage>439</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c23"><label>23</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brockhurst</surname>, <given-names>M. A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The ecology and evolution of pangenomes</article-title>. <source>Current Biology</source> <volume>29</volume>, <fpage>R1094</fpage>–<lpage>R1103</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c24"><label>24</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smillie</surname>, <given-names>C. S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Ecology drives a global network of gene exchange connecting the human microbiome</article-title>. <source>Nature</source> <volume>480</volume>, <fpage>241</fpage>–<lpage>244</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c25"><label>25</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rankin</surname>, <given-names>D. J.</given-names></string-name>, <string-name><surname>Rocha</surname>, <given-names>E. P.</given-names></string-name> &amp; <string-name><surname>Brown</surname>, <given-names>S. P.</given-names></string-name></person-group> <article-title>What traits are carried on mobile genetic elements, and why?</article-title> <source>Heredity</source> <volume>106</volume>, <fpage>1</fpage>–<lpage>10</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c26"><label>26</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Werren</surname>, <given-names>J. H.</given-names></string-name></person-group> <article-title>Selfish genetic elements, genetic conflict, and evolutionary innovation</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>108</volume>, <fpage>10863</fpage>–<lpage>10870</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c27"><label>27</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilpin</surname>, <given-names>M. E.</given-names></string-name> &amp; <string-name><surname>Case</surname>, <given-names>T. J.</given-names></string-name></person-group> <article-title>Multiple domains of attraction in competition communities</article-title>. <source>Nature</source> <volume>261</volume>, <fpage>40</fpage>–<lpage>42</lpage> (<year>1976</year>).</mixed-citation></ref>
<ref id="c28"><label>28</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Hong</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Wang</surname>, <given-names>T.</given-names></string-name></person-group> <article-title>Horizontal gene transfer is predicted to overcome the diversity limit of competing microbial species</article-title>. <source>Nature Communications</source> <volume>15</volume>, <fpage>800</fpage>, doi:<pub-id pub-id-type="doi">10.1038/s41467-024-45154-w</pub-id> (<year>2024</year>).</mixed-citation></ref>
<ref id="c29"><label>29</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abreu</surname>, <given-names>C. I.</given-names></string-name>, <string-name><surname>Friedman</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Andersen Woltz</surname>, <given-names>V. L.</given-names></string-name> &amp; <string-name><surname>Gore</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Mortality causes universal changes in microbial community composition</article-title>. <source>Nature Communications</source> <volume>10</volume>, <fpage>2120</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c30"><label>30</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finlay</surname>, <given-names>B. B.</given-names></string-name> &amp; <string-name><surname>Medzhitov</surname>, <given-names>R.</given-names></string-name></person-group> <article-title>Host-microbe interactions: fulfilling a niche</article-title>. <source>Cell Host and Microbe</source> <volume>1</volume>, <fpage>3</fpage>–<lpage>4</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c31"><label>31</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonham</surname>, <given-names>K. S.</given-names></string-name>, <string-name><surname>Wolfe</surname>, <given-names>B. E.</given-names></string-name> &amp; <string-name><surname>Dutton</surname>, <given-names>R. J.</given-names></string-name></person-group> <article-title>Extensive horizontal gene transfer in cheese-associated bacteria</article-title>. <source>Elife</source> <volume>6</volume>, <elocation-id>e22144</elocation-id> (<year>2017</year>).</mixed-citation></ref>
<ref id="c32"><label>32</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caro-Quintero</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Konstantinidis</surname>, <given-names>K. T.</given-names></string-name></person-group> <article-title>Inter-phylum HGT has shaped the metabolism of many mesophilic and anaerobic bacteria</article-title>. <source>The ISME journal</source> <volume>9</volume>, <fpage>958</fpage>–<lpage>967</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c33"><label>33</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Acar Kirit</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lagator</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Bollback</surname>, <given-names>J. P.</given-names></string-name></person-group> <article-title>Experimental determination of evolutionary barriers to horizontal gene transfer</article-title>. <source>BMC Microbiology</source> <volume>20</volume>, <fpage>1</fpage>–<lpage>13</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c34"><label>34</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gama</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Zilhão</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Dionisio</surname>, <given-names>F.</given-names></string-name></person-group> <article-title>Plasmid interactions can improve plasmid persistence in bacterial populations</article-title>. <source>Frontiers in Microbiology</source> <volume>11</volume>, <fpage>2033</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c35"><label>35</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Silva</surname>, <given-names>R. F.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Pervasive sign epistasis between conjugative plasmids and drug-resistance chromosomal mutations</article-title>. <source>PLoS Genetics</source> <volume>7</volume>, <fpage>e1002181</fpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c36"><label>36</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>San Millan</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Heilbron</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>MacLean</surname>, <given-names>R. C.</given-names></string-name></person-group> <article-title>Positive epistasis between co-infecting plasmids promotes plasmid survival in bacterial populations</article-title>. <source>The ISME Journal</source> <volume>8</volume>, <fpage>601</fpage>–<lpage>612</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c37"><label>37</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leibold</surname>, <given-names>M. A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The metacommunity concept: a framework for multi-scale community ecology</article-title>. <source>Ecology Letters</source> <volume>7</volume>, <fpage>601</fpage>–<lpage>613</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c38"><label>38</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname>, <given-names>E. T.</given-names></string-name>, <string-name><surname>Svanbäck</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Bohannan</surname>, <given-names>B. J.</given-names></string-name></person-group> <article-title>Microbiomes as metacommunities: understanding host-associated microbes through metacommunity ecology</article-title>. <source>Trends in Ecology and Evolution</source> <volume>33</volume>, <fpage>926</fpage>–<lpage>935</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c39"><label>39</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serván</surname>, <given-names>C. A.</given-names></string-name>, <string-name><surname>Capitán</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Grilli</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Morrison</surname>, <given-names>K. E.</given-names></string-name> &amp; <string-name><surname>Allesina</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Coexistence of many species in random ecosystems</article-title>. <source>Nature Ecology and Evolution</source> <volume>2</volume>, <fpage>1237</fpage>–<lpage>1242</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c40"><label>40</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grilli</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Feasibility and coexistence of large ecological communities</article-title>. <source>Nature Communications</source> <volume>8</volume>, <fpage>14389</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c41"><label>41</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The human microbiome: a hot spot of microbial horizontal gene transfer</article-title>. <source>Genomics</source> <volume>100</volume>, <fpage>265</fpage>–<lpage>270</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c42"><label>42</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lipsitch</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Colijn</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Cohen</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Hanage</surname>, <given-names>W. P.</given-names></string-name> &amp; <string-name><surname>Fraser</surname>, <given-names>C.</given-names></string-name></person-group> <article-title>No coexistence for free: neutral null models for multistrain pathogens</article-title>. <source>Epidemics</source> <volume>1</volume>, <fpage>2</fpage>–<lpage>13</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c43"><label>43</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Igler</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Huisman</surname>, <given-names>J. S.</given-names></string-name>, <string-name><surname>Siedentop</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Bonhoeffer</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Lehtinen</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Plasmid co-infection: linking biological mechanisms to ecological and evolutionary dynamics</article-title>. <source>Philosophical Transactions of the Royal Society B</source> <volume>377</volume>, <fpage>20200478</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c44"><label>44</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ravel</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Vaginal microbiome of reproductive-age women</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>108</volume>, <fpage>4680</fpage>–<lpage>4687</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c45"><label>45</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Schloss</surname>, <given-names>P. D.</given-names></string-name></person-group> <article-title>Dynamics and associations of microbial community types across the human body</article-title>. <source>Nature</source> <volume>509</volume>, <fpage>357</fpage>–<lpage>360</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c46"><label>46</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lahti</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Salojärvi</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Salonen</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Scheffer</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>De Vos</surname>, <given-names>W. M.</given-names></string-name></person-group> <article-title>Tipping elements in the human intestinal ecosystem</article-title>. <source>Nature Communications</source> <volume>5</volume>, <fpage>4344</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c47"><label>47</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kootte</surname>, <given-names>R. S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Improvement of insulin sensitivity after lean donor feces in metabolic syndrome is driven by baseline intestinal microbiota composition</article-title>. <source>Cell Metabolism</source> <volume>26</volume>, <fpage>611</fpage>–<lpage>619.e616</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c48"><label>48</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Canfora</surname>, <given-names>E. E.</given-names></string-name>, <string-name><surname>Meex</surname>, <given-names>R. C.</given-names></string-name>, <string-name><surname>Venema</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Blaak</surname>, <given-names>E. E.</given-names></string-name></person-group> <article-title>Gut microbial metabolites in obesity, NAFLD and T2DM</article-title>. <source>Nature Reviews Endocrinology</source> <volume>15</volume>, <fpage>261</fpage>–<lpage>273</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c49"><label>49</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moustafa</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Genetic risk, dysbiosis, and treatment stratification using host genome and gut microbiome in inflammatory bowel disease</article-title>. <source>Clinical Translational Gastroenterology</source> <volume>9</volume>, <fpage>e132</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c50"><label>50</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Getino</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>de la Cruz</surname>, <given-names>F.</given-names></string-name></person-group> <article-title>Natural and artificial strategies to control the conjugative transmission of plasmids</article-title>. <source>Microbiology Spectrum</source> <volume>6</volume>, <pub-id pub-id-type="doi">10.1128/microbiolspec.mtbp-0015-2016</pub-id> (<year>2018</year>).</mixed-citation></ref>
<ref id="c51"><label>51</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fernandez-Lopez</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Unsaturated fatty acids are inhibitors of bacterial conjugation</article-title>. <source>Microbiology</source> <volume>151</volume>, <fpage>3517</fpage>–<lpage>3526</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c52"><label>52</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Getino</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Synthetic fatty acids prevent plasmid-mediated horizontal gene transfer</article-title>. <source>mBio</source> <volume>6</volume>, <pub-id pub-id-type="doi">10.1128/mbio.01032-01015</pub-id> (<year>2015</year>).</mixed-citation></ref>
<ref id="c53"><label>53</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ripoll-Rozada</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Type IV traffic ATPase TrwD as molecular target to inhibit bacterial conjugation</article-title>. <source>Molecular Microbiology</source> <volume>100</volume>, <fpage>912</fpage>–<lpage>921</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c54"><label>54</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Palencia-Gándara</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Conjugation inhibitors effectively prevent plasmid transmission in natural environments</article-title>. <source>MBio</source> <volume>12</volume>, <pub-id pub-id-type="doi">10.1128/mbio.01277-01221</pub-id> (<year>2021</year>).</mixed-citation></ref>
<ref id="c55"><label>55</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kosterlitz</surname>, <given-names>O.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Estimating the transfer rates of bacterial plasmids with an adapted Luria–Delbrück fluctuation analysis</article-title>. <source>PLoS Biology</source> <volume>20</volume>, <fpage>e3001732</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c56"><label>56</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopatkin</surname>, <given-names>A. J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Persistence and reversal of plasmid-mediated antibiotic resistance</article-title>. <source>Nature Communications</source> <volume>8</volume>, <fpage>1689</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c57"><label>57</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dieterich</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Schink</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Zopf</surname>, <given-names>Y.</given-names></string-name></person-group> <article-title>Microbiota in the gastrointestinal tract</article-title>. <source>Medical Sciences</source> <volume>6</volume>, <fpage>116</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c58"><label>58</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Flemming</surname>, <given-names>H.-C.</given-names></string-name> &amp; <string-name><surname>Wuertz</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Bacteria and archaea on Earth and their abundance in biofilms</article-title>. <source>Nature Reviews Microbiology</source> <volume>17</volume>, <fpage>247</fpage>–<lpage>260</lpage> (<year>2019</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99593.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Momeni</surname>
<given-names>Babak</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Boston College</institution>
</institution-wrap>
<city>Chestnut Hill</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This manuscript offers <bold>valuable</bold> theoretical predictions on how horizontal gene transfer (HGT) can lead to alternative stable states in microbial communities. Using a modeling framework, <bold>solid</bold> theoretical evidence is provided to support the claimed role of HGT. However, given that the model has many degrees of freedom, a more comprehensive analysis of the role of different parameters could strengthen the study. Additionally, potential interactions between plasmids that carry out HGT are not discussed in the model. This paper would be of interest to researchers in microbiology, ecology, and evolutionary biology.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99593.2.sa2</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this work, the authors use a theoretical model to study the potential impact of Horizontal Gene Transfer on the number of alternative stable states of microbial communities. For this, they use a modified version of the competitive Lotka Volterra model-which accounts for the effects of pairwise, competitive interactions on species growth-that incorporates terms for the effects of both an added death (dilution) rate acting on all species and the rates of horizontal transfer of mobile genetic elements-which can, in turn, affect species growth rates. The authors analyze the impact of horizontal gene transfer in different scenarios--such as bistability between pairs of species and multistability in communities--over an extended range of parameter values. In almost all these cases, the authors report an increase in either the number of alternative stable states or the parameter region (e.g. growth rate values) in which they occur.</p>
<p>Understanding the origin of alternative stable states in microbial communities and how often they may occur is an important challenge in microbial ecology and evolution. Shifts between these alternative stable states can drive transitions between e.g. a healthy microbiome and dysbiosis. A better understanding of how horizontal gene transfer can drive multistability could help predict alternative stable states in microbial communities, as well as inspire novel treatments to steer communities towards the most desired (e.g. healthy) stable states. In my opinion, this manuscript is a solid theoretical approach to the subject.</p>
<p>Strengths:</p>
<p>
- Generality of the model: the work is based on a phenomenological model that has been extensively used to predict the dynamics of ecological communities in many different scenarios.</p>
<p>
- The question of how horizontal gene transfer can drive alternative stable states in microbial communities is important and there are very few studies addressing it.</p>
<p>Weaknesses:</p>
<p>
- In the revised version of the manuscript, the authors significantly extended the analyzed region of parameter values. Still, the model has many parameters and the analysis is typically done by changing one or two parameters at a time. Thus, the work shows how HGT can indeed promote multistability, but it remains hard to grasp whether it consistently does so across a large region of the parameter values space.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99593.2.sa1</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Hong et al. used a model they previously developed to study the impact of plasmid transfer on microbial multispecies communities. They investigated the effect of plasmid transfer on the existence of alternative stable states in a community. The model most closely resembles plasmid conjugation, where the transferred genes confer independent growth-related fitness effects and different plasmids do not affect each other's transfer or growth effects. For this process, the authors find that increasing the rate of plasmid transfer leads to an increasing number of stable states, as long as the model includes a constant death/dilution term.</p>
<p>This is an interesting and important topic, and I welcome the authors' efforts to explore these topics with mathematical modeling. The addition of sensitivity analyses also strengthens the usefulness for quantitative microbial ecologists. However, the additional sections have made the main text harder to read. Between the effect of the dilution rate, the increase in subpopulations with HGT, and the modulation of interspecies competition, the reviewers have suggested a number of factors that may explain the way plasmid transfer modulates multistability. I think it would be helpful if the authors could summarize some of these effects/interactions between different parameters in their model more. I personally continue to find the model very unintuitive, especially in the way it averages over subpopulations carrying more than one foreign plasmid. Additional sentences that give the reader intuition for the sensitivity analyses and how these interplay with the results would be good.</p>
<p>Specific points</p>
<p>(1) The model makes strong assumptions about the biology of HGT, that could be spelled out even more. Since the model is primarily applicable to HGT driven by the exchange of plasmids, I believe the abstract (and perhaps even the title of the paper) should be updated to reflect that.</p>
<p>(2) I am not surprised that a mechanism that creates diversity will lead to more alternative stable states. Specifically, the null model for the absence of HGT is to set gamma to zero, resulting in pij=0 for all subpopulations (line 454). This means that a model with N^2 classes is effectively reduced to N classes. It seems intuitive that an LV-model with many more species would also allow for more alternative stable states. For a fair comparison one would really want to initialize these subpopulations in the model (with the same growth rates - e.g. mu1(1+lambda2)) but without gene mobility.</p>
<p>
[Update:] It is good that it seems that initializing pij with non-zero abundance did not seem to affect the conclusion that higher amounts of HGT increases multi stability. However, rather than listing it as one control for a specific condition, I would argue that this is the appropriate null model across the board (where HGT rate is varied from 0 to a high value), including figures S9 and S10.</p>
<p>(3) The possibility that the same cell may be counted in different pij runs counter to all intuition that researchers coming from a background of compartmental /epidemiological modeling may have. The associated assumption that plasmids do not affect each other's dynamics or (growth/interaction) effects at all is also a very strong assumption. This should be signaled much earlier in the manuscript, possibly already in line 106 when the model is introduced.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99593.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Hong</surname>
<given-names>Juken</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Xue</surname>
<given-names>Wenzhi</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Wang</surname>
<given-names>Teng</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0000-5176-5095</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Public review):</bold></p>
<p>Summary:</p>
<p>The authors present a modelling study to test the hypothesis that horizontal gene transfer (HGT) can modulate the outcome of interspecies competition in microbiomes, and in particular promote bistability in systems across scales. The premise is a model developed by the same authors in a previous paper where bistability happens because of a balance between growth rates and competition for a mutual resource pool (common carrying capacity). They show that introducing a transferrable element that gives a &quot;growth rate bonus&quot; expands the region of parameter space where bistability happens. The authors then investigate how often (in terms of parameter space) this bistability occurs across different scales of complexity, and finally under selection for the mobile element (framed as ABR selection).</p>
<p>Strengths:</p>
<p>The authors tackle an important, yet complex, question: how do different evolutionary processes impact the ecology of microbial ecosystems? They do a nice job at increasing the scales of heterogeneity and asking how these impact their main observable: bistability.</p>
</disp-quote>
<p>We appreciate the reviewer for agreeing with the potential value of our analysis. We are also grateful for the constructive comments and suggestions on further analyzing the influence of the model structure and the associated assumptions. We have fully addressed the raised issues in the updated manuscript and below.</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses:</p>
<p>The author's starting point is their interaction LV model and the manuscript then explores how this model behaves under different scenarios. Because the structure of the model and the underlying assumptions essentially dictate these outcomes, I would expect to see much more focus on how these two aspects relate to the specific scenarios that are discussed. For example:</p>
<p>A key assumption is that the mobile element conveys a multiplicative growth rate benefit (1+lambda). However, the competition between the species is modelled as a factor gamma that modulates the competition for overall resource and thus appears in the saturation term (1+ S1/Nm + gamma2*S2/Nm). This means that gamma changes the perceived abundance of the other species (if gamma &gt; 1, then from the point of view of S1 it looks like there are more S2 than there really are). Most importantly, the relationship between these parameters dictates whether or not there will be bistability (as the authors state).</p>
<p>This decoupling between the transferred benefit and the competition can have different consequences. One of them is that - from the point of view of the mobile element - the mobile element competes at different strengths within the same population compared to between. To what degree introducing such a mobile element modifies the baseline bistability expectation thus strongly depends on how it modifies gamma and lambda.</p>
<p>Thus, this structural aspect needs to be much more carefully presented to help the reader follow how much of the results are just trivial given the model assumptions and which have more of an emergent flavour. From my point of view, this has an important impact on helping the reader understand how the model that the authors present can contribute to the understanding of the question &quot;how microbes competing for a limited number of resources stably coexist&quot;. I do appreciate that this changes the focus of the manuscript from a presentation of simulation results to more of a discussion of mathematical modelling.</p>
</disp-quote>
<p>We thank the reviewer for the insightful suggestions. We agree with the reviewer that the model structure and the underlying assumptions need to be carefully discussed, in order to understand the generality of the theoretical predictions. In particular, the reviewer emphasized that how HGT affects bistability might depend on how mobile genetic elements modified growth rates and competition. In the main text, we have shown that when mobile genes only influence species growth rates, HGT is expected to promote multistability (Fig. 1 and 2). However, when mobile genes modify species interactions, the effect of HGT on multistability is dependent on how mobile genes change competition strength (Fig. 3a to f). When mobile genes increase competition, HGT promotes multistability (Fig. 3c and e). In contrast, when mobile genes relax competition, HGT is expected to reduce multistability (Fig. 3d and f).</p>
<p>In light of the reviewer’s comments, we have further generalized the model structure, by accounting for the scenario where mobile genes simultaneously modify growth rates and competition. The effect of mobile genes on growth rates is represented by the magnitude of 𝜆’s, and the influence on competition is described by another parameter 𝛿. By varying these two parameters, we can evaluate how the model structure and the underlying assumptions affect the baseline expectation. We performed additional simulations with broad ranges of 𝜆 and 𝛿 values. In particular, we analyzed whether HGT would promote the likelihood of bistability in two-species communities compared with the scenario without gene transfer (Fig. 3g-i). Our results suggested that: (1) With or without HGT, reducing 𝜆 (increasing neutrality) promotes bistability; (2) With HGT, increasing 𝛿 promotes bistability; (2) Compared with the population without HGT, gene transfer promotes bistability when 𝛿 is zero or positive, while reduces bistability when 𝛿 is largely negative. These results agree with the reviewer’s comment that the baseline bistability expectation depends on how HGT modifies gamma and lambda. In the updated manuscript, we have thoroughly discussed how the model structure and the underlying assumptions can influence the predictions (line 238-253).</p>
<p>We further expanded our analysis, by calculating how other parameters, including competition strength, growth rate ranges, and death/dilution rate, would affect the multistability of communities undergoing horizontal gene transfer (Fig. S2, S3, S9, S10, S11, S12, S13, S15). Together with the results presented in the first draft, these analysis enables a more comprehensive understanding of how different mechanisms, including but not limited to HGT, collectively shaped community multistability. In the updated manuscript, the reviewer can see the change of focus from exploring the effects of HGT to a more thorough discussion of the mathematical model. The revised texts highlighted in blue and the supplemented figures reflect such a change.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public review):</bold></p>
<p>Summary:</p>
<p>In this work, the authors use a theoretical model to study the potential impact of Horizontal Gene Transfer on the number of alternative stable states of microbial communities. For this, they use a modified version of the competitive Lotka Volterra model-which accounts for the effects of pairwise, competitive interactions on species growth-that incorporates terms for the effects of both an added death (dilution) rate acting on all species and the rates of horizontal transfer of mobile genetic elements-which can in turn affect species growth rates. The authors analyze the impact of horizontal gene transfer in different scenarios: bistability between pairs of species, multistability in communities, and a modular structure in the interaction matrix to simulate multiple niches. They also incorporate additional elements to the model, such as spatial structure to simulate metacommunities and modification of pairwise interactions by mobile genetic elements. In almost all these cases, the authors report an increase in either the number of alternative stable states or the parameter region (e.g. growth rate values) in which they occur.</p>
<p>In my opinion, understanding the role of horizontal gene transfer in community multistability is a</p>
<p>very important subject. This manuscript is a useful approach to the subject, but I'm afraid that a thorough analysis of the role of different parameters under different scenarios is missing in order to support the general claims of the authors. The authors have extended their analysis to increase their biological relevance, but I believe that the analysis still lacks comprehensiveness.</p>
<p>Understanding the origin of alternative stable states in microbial communities and how often they may occur is an important challenge in microbial ecology and evolution. Shifts between these alternative stable states can drive transitions between e.g. a healthy microbiome and dysbiosis. A better understanding of how horizontal gene transfer can drive multistability could help predict alternative stable states in microbial communities, as well as inspire novel treatments to steer communities towards the most desired (e.g. healthy) stable states.</p>
<p>Strengths:</p>
<p>(1) Generality of the model: the work is based on a phenomenological model that has been extensively used to predict the dynamics of ecological communities in many different scenarios.</p>
<p>(2) The question of how horizontal gene transfer can drive alternative stable states in microbial communities is important and there are very few studies addressing it.</p>
</disp-quote>
<p>We thank the reviewer for the positive comments on the potential novelty and conceptual importance of our work. We are also grateful for the constructive suggestions on the generality and comprehensiveness of our analysis. In particular, we agree with the reviewer that a thorough analysis of the role of different parameter could further improve the rigor of this work. We have fully addressed the raised issues in the updated manuscript and below.</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses:</p>
<p>(1) There is a need for a more comprehensive analysis of the relative importance of the different model parameters in driving multistability. For example, there is no analysis of the effects of the added death rate in multistability. This parameter has been shown to determine whether a given pair of interacting species exhibits bistability or not (see e.g. Abreu et al 2019 Nature Communications 10:2120). Similarly, each scenario is analyzed for a unique value of species interspecies interaction strength-with the exception of the case for mobile genetic elements affecting interaction strength, which considers three specific values. Considering heterogeneous interaction strengths (e.g. sampling from a random distribution) could also lead to more realistic scenarios - the authors generally considered that all species pairs interact with the same strength. Analyzing a larger range of growth rates effects of mobile genetic elements would also help generalize the results. In order to achieve a more generic assessment of the impact of horizontal gene transfer in driving multistability, its role should be systematically compared to the effects of the rest of the parameters of the model.</p>
</disp-quote>
<p>We appreciate the suggestions. For each of the parameters that the reviewer mentioned, we have performed additional simulations to evaluate its importance in driving multistability.</p>
<p>For the added death rate, we have calculated the bistability feasibility of two-species populations under different values of 𝐷. Our results suggested that (1) varying death rate indeed changed the bistability probability of the system; (2) when the death rate was zero, mobile genetic elements that only modify growth rates would have no effects on system’s bistability. These results highlighted the importance of added death rate in driving multistability (Fig. S2, line 136-142).</p>
<p>For the interspecies interaction strength, we first extended our analysis on two-species populations. By calculating the bistability probability under different values of 𝛾, we showed that when interspecies interaction strength was smaller than 1, the influence of HGT on population bistability became weak (Fig. S3, line 143-147). We also considered heterogenous interaction strengths in multispecies communities, by randomly sampling 𝛾<italic><sub>ij</sub></italic> values from uniform distributions. While our results suggested the heterogeneous distribution of 𝛾<italic><sub>ij</sub></italic> didn’t fundamentally change the main conclusion, the mean value and variance of 𝛾<italic><sub>ij</sub></italic> affected the influence of HGT on multistability. The effects of HGT on community multistability becomes stronger when the mean value of 𝛾<italic><sub>ij</sub></italic> gets larger than 1 and the variance of 𝛾<italic><sub>ij</sub></italic> is small (Fig. S12, line 190-196).</p>
<p>We also analyzed different ranges of growth rates effects of mobile genetic elements. In particular, we sampled 𝜆<italic><sub>ij</sub></italic> values from uniform distributions with given widths. Greater width led to larger range of growth rate effects. We used five-species populations as an example and tested different ranges. Our results suggested that multistability was more feasible when the growth rate effects of MGEs were small. The qualitative relationship between HGT and community was not dependent on the range of growth rate effects (Fig. S13, line 197-205).</p>
<disp-quote content-type="editor-comment">
<p>(2) The authors previously developed this theoretical model to study the impact of horizontal gene transfer on species coexistence. In this sense, it seems that the authors are exploring a different (stronger interspecies competition) range of parameter values of the same model, which could potentially limit novelty and generality.</p>
</disp-quote>
<p>We appreciate the comment. In a previous work (PMID: 38280843), we developed a theoretical model that incorporated horizontal gene transfer process into the classic LV framework. This model provides opportunities to investigate the role of HGT in different open questions of microbial ecology. In the previous work, we considered one fundamental question: how competing microbes coexist stably. In this work, however, we focused on a different problem: how alternative stable states emerge in complex communities. While the basic theoretical tool that we applied in the two works were similar, the scientific questions, application contexts and the implications of our analysis were largely different. The novelty of this work arose from the fact that it revealed the conceptual linkage between alternative stable states and a ubiquitous biological process, horizontal gene transfer. This linkage is largely unknown in previous studies. Exploring such a linkage naturally required us to consider stronger interspecies competitions, which in general would diminish coexistence but give rise to multistability. We believe that the analysis performed in this work provide novel and valuable insights for the field of microbial ecology.</p>
<p>With all the supplemented simulations that we carried out in light of the all the reviewer’s comments, we believe the updated manuscript also provide a unified framework to understand how different biological processes collectively shaped the multistability landscape of complex microbiota undergoing horizontal gene transfer. The comprehensive analyses performed and the diverse scenarios considered in this study also contribute to the novelty and generality of this work.</p>
<disp-quote content-type="editor-comment">
<p>(3) The authors analyze several scenarios that, in my opinion, naturally follow from the results and parameter value choices in the first sections, making their analysis not very informative. For example, after showing that horizontal gene transfer can increase multistability both between pairs of species and in a community context, the way they model different niches does not bring significantly new results. Given that the authors showed previously in the manuscript that horizontal gene transfer can impact multistability in a community in which all species interact with each other, one might expect that it will also impact multistability in a larger community made of (sub)communities that are independent of (not interacting with) each-which is the proposed way for modelling niches. A similar argument can be made regarding the analysis of (spatially structured) metacommunities. It is known that, for smaller enough dispersal rates, space can promote regional diversity by enabling each local community to remain in a different stable state. Therefore, in conditions in which the impact of horizontal gene transfer drives multistability, it will also drive regional diversity in a metacommunity.</p>
</disp-quote>
<p>Thanks. Based on the reviewer’s comments, we have move Fig. 3 and 4 to Supplementary Information. In the updated manuscript, we have focused more on analyzing the roles of different parameters in shaping community multistability.</p>
<disp-quote content-type="editor-comment">
<p>(4) In some cases, the authors consider that mobile genetic elements can lead to ~50% growth rate differences. In the presence of an added death rate, this can be a relatively strong advantage that makes the fastest grower easily take over their competitors. It would be important to discuss biologically relevant examples in which such growth advantages driven by mobile genetic elements could be expected, and how common such scenarios might be.</p>
</disp-quote>
<p>We appreciate the suggestion. Mobile genetic elements can drive large growth rate differences when they encode adaptative traits like antibiotic resistance (line 197-198).</p>
<p>We also analyzed different ranges of growth rates effects of mobile genetic elements, by sampling 𝜆<italic><sub>ij</sub></italic> values from uniform distributions with given widths. Our results suggested that multistability was more feasible when the fitness effects of MGEs were small (Fig. S13b). The qualitative relationship between HGT and community was not dependent on the range of growth rate effects (Fig. S13a and b). We discussed these results in line 197-205 of the updated main text.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public review):</bold></p>
<p>Hong et al. used a model they previously developed to study the impact of horizontal gene transfer (HGT) on microbial multispecies communities. They investigated the effect of HGT on the existence of alternative stable states in a community. The model most closely resembles HGT through the conjugation of incompatible plasmids, where the transferred genes confer independent growth-related fitness effects. For this type of HGT, the authors find that increasing the rate of HGT leads to an increasing number of stable states. This effect of HGT persists when the model is extended to include multiple competitive niches (under a shared carrying capacity) or spatially distinct patches (that interact in a grid-like fashion). Instead, if the mobile gene is assumed to reduce between-species competition, increasing HGT leads to a smaller region of multistability and fewer stable states. Similarly, if the mobile gene is deleterious an increase in HGT reduces the parameter region that supports multistability.</p>
<p>This is an interesting and important topic, and I welcome the authors' efforts to explore these topics with mathematical modeling. The manuscript is well written and the analyses seem appropriate and well-carried out. However, I believe the model is not as general as the authors imply and more discussion of the assumptions would be helpful (both to readers + to promote future theoretical work on this topic). Also, given the model, it is not clear that the conclusions hold quite so generally as the authors claim and for biologically relevant parameters. To address this, I would recommend adding sensitivity analyses to the manuscript.</p>
</disp-quote>
<p>We thank the reviewer for the agreeing that our work addressed an important topic and was wellconducted. We are also grateful for the suggestion on sensitivity analysis, which is very helpful to improve the rigor and generality of our conclusion. All the raised issues have been fully addressed in the updated manuscript and below.</p>
<disp-quote content-type="editor-comment">
<p>Specific points</p>
<p>(1) The model makes strong assumptions about the biology of HGT, that are not adequately spelled out in the main text or methods, and will not generally prove true in all biological systems. These include:</p>
<p>a) The process of HGT can be described by mass action kinetics. This is a common assumption for plasmid conjugation, but for phage transduction and natural transformation, people use other models (e.g. with free phage that adsorp to all populations and transfer in bursts).</p>
<p>b) A subpopulation will not acquire more than one mobile gene, subpopulations can not transfer multiple genes at a time, and populations do not lose their own mobilizable genes. [this may introduce bias, see below].</p>
<p>c) The species internal inhibition is independent of the acquired MGE (i.e. for p1 the self-inhibition is by s1).</p>
<p>These points are in addition to the assumptions explored in the supplementary materials, regarding epistasis, the independence of interspecies competition from the mobile genes, etc. I would appreciate it if the authors could be more explicit in the main text about the range of applicability of their model, and in the methods about the assumptions that are made.</p>
</disp-quote>
<p>We are grateful for the reviewer’s suggestions. In main text and methods of the updated manuscript, we have made clear the assumptions underlying our analysis. For point (a), we have clarified that our model primarily focused on plasmid transfer dynamics (line 74, 101, 517). Therefore, the process of HGT can be described by mass action kinetics, which is commonly assumed for plasmid transfer (line 537-538). For point (b), our model allows a cell to acquire more than one mobile genes. Please see our response to point (3) for details. We have also made it clear that we assumed the populations would not lose their own mobile gene completely (line 526-527). For (c), we have also clarified it in the updated manuscript (line 111-112, 527-528).</p>
<p>We have also performed a series of additional simulations to show the range of applicability of our model. In particular, we discuss the role of other mechanisms, including interspecies interaction strength, the growth rate effects of MGEs, MGE epistasis and microbial death rates in shaping the multistability of microbial communities undergoing HGT. These results were provided in Fig. S2, S3, S9, S10, S11, S12, S13 and S15.</p>
<disp-quote content-type="editor-comment">
<p>(2) I am not surprised that a mechanism that creates diversity will lead to more alternative stable states. Specifically, the null model for the absence of HGT is to set gamma to zero, resulting in pij=0 for all subpopulations (line 454). This means that a model with N^2 classes is effectively reduced to N classes. It seems intuitive that an LV-model with many more species would also allow for more alternative stable states. For a fair comparison, one would really want to initialize these subpopulations in the model (with the same growth rates - e.g. mu1(1+lambda2)) but without gene mobility.</p>
</disp-quote>
<p>We appreciate the insightful comments. The reviewer was right that in our model HGT created additional subpopulations in the community. However, with or without HGT, we calculated the species diversity and multistability based on the abundances of the 𝑁 species (<italic>s<sub>i</sub></italic> in our model), instead of all the <italic>p<sub>ij</sub></italic> subpopulations. Therefore, although there exist more ‘classes’ in the model with HGT, the number of ‘classes’ considered when we calculated community diversity and multistability was equal. In light of the reviewer’s suggestion, we have also performed additional simulations, where we initialized the subpopulations in the model with nonzero abundances. Our results suggested that initializing the <italic>p<sub>ij</sub></italic> subpopulations with non-zero abundances didn’t change the main conclusion (Fig. S11, line 188-189).</p>
<disp-quote content-type="editor-comment">
<p>(3) I am worried that the absence of double gene acquisitions from the model may unintentionally promote bistability. This assumption is equivalent to an implicit assumption of incompatibility between the genes transferred from different species. A highly abundant species with high HGT rates could fill up the &quot;MGE niche&quot; in a species before any other species have reached appreciable size. This would lead to greater importance of initial conditions and could thus lead to increased multistability.</p>
<p>This concern also feels reminiscent of the &quot;coexistence for free&quot; literature (first described here <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.epidem.2008.07.001">http://dx.doi.org/10.1016/j.epidem.2008.07.001</ext-link> ) which was recently discussed in the context of plasmid conjugation models in the supplementary material (section 3) of <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2020.0478">https://doi.org/10.1098/rstb.2020.0478</ext-link> .</p>
</disp-quote>
<p>We appreciate the comments. Our model didn’t assume the incompatibility between MGEs transferred from different species. Instead, it allows a cell to acquire more than one MGEs. In our model, <italic>p<sub>ij</sub></italic> described the subpopulation in the 𝑖-th species that acquired the MGE from the 𝑗th species. Here, <italic>p<sub>ij</sub></italic> can have overlaps with <italic>p<sub>ik</sub></italic> (𝑗 ≠ 𝑘). In other words, a cell can belong to <italic>p<sub>ij</sub></italic> and <italic>p<sub>ik</sub></italic> at the same time. The <italic>p<sub>ij</sub></italic> subpopulation is allowed to carry the MGEs from the other species. In the model, we used <inline-formula id="sa3equ1"><inline-graphic xlink:href="elife-99593-sa3-equ1.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> to describe the influence of the other MGEs on the growth of <italic>p<sub>ij</sub></italic>.</p>
<p>We also thank the reviewer for bringing two papers into our attention. We have cited and discussed these papers in the updated manuscript (line 355-362).</p>
<disp-quote content-type="editor-comment">
<p>(4) The parameter values tested seem to focus on very large effects, which are unlikely to occur commonly in nature. If I understand the parameters in Figure 1b correctly for instance, lambda2 leads to a 60% increase in growth rate. Such huge effects of mobile genes (here also assumed independent from genetic background) seem unlikely except for rare cases. To make this figure easier to interpret and relate to real-world systems, it could be worthwhile to plot the axes in terms of the assumed cost/benefit of the mobile genes of each species.</p>
</disp-quote>
<p>Thanks for the comments. In the main text, we presented one simulation results that assumed relatively large effects of MGE on species fitness, as the reviewer pointed out. In the updated manuscript, we have supplemented numerical simulations that considered different ranges of fitness effects, including the fitness effect as small as 10% (Fig. S13a). We have also plotted the relationship between community multistability and the assumed fitness effects of MGEs, as the reviewer suggested (Fig. S13b). Our results suggested that multistability was more feasible when the fitness effects of MGEs were small, and changing the range of MGE fitness effects didn’t fundamentally change our main conclusion. These results were discussed in line 197-205 of the updated main text.</p>
<disp-quote content-type="editor-comment">
<p>Something similar holds for the HGT rate (eta): given that the population of E. coli or Klebsiella in the gut is probably closer to 10^9 than 10^12 (they make up only a fraction of all cells in the gut), the assumed rates for eta are definitely at the high end of measured plasmid transfer rates (e.g. F plasmid transfers at a rate of 10^-9 mL/CFU h-1, but it is derepressed and considered among the fastest - <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.plasmid.2020.102489">https://doi.org/10.1016/j.plasmid.2020.102489</ext-link> ). To adequately assess the impact of the HGT rate on microbial community stability it would need to be scanned on a log (rather than a linear) scale. Considering the meta-analysis by Sheppard et al. it would make sense to scan it from 10^-7 to 1 for a community with a carrying capacity around 10^9.</p>
</disp-quote>
<p>We thank the reviewer for the constructive suggestion. We have carried out additional simulations by scanning the 𝜂 value from 10<sup>-7</sup> to 1. The results suggested that increasing HGT rates started to promote multistability when 𝜂 value exceeded 10<sup>-2</sup> per hour (Fig. S9, line 337-346). This corresponds to a conjugation efficiency of 10<sup>-11</sup> <italic>cell</italic><sup>-1</sup> ∙ <italic>mL</italic><sup>-1</sup>∙ <italic>mL</italic> when the maximum carrying capacity equals 10<sup>9</sup> <italic>cells</italic> ∙ <italic>mL</italic><sup>-1</sup>, or a conjugation efficiency of 10<sup>-14</sup> <italic>cell</italic><sup>-1</sup> ∙ <italic>hr</italic><sup>-1</sup>∙ <italic>mL</italic> when the maximum carrying capacity equals 10<sup>12</sup> <italic>cells</italic> ∙ <italic>mL</italic><sup>-1</sup>.</p>
<disp-quote content-type="editor-comment">
<p>(5) It is not clear how sensitive the results (e.g. Figure 2a on the effect of HGT) are to the assumption of the fitness effect distribution of the mobile genes. This is related to the previous point that these fitness effects seem quite large. I think some sensitivity analysis of the results to the other parameters of the simulation (also the assumed interspecies competition varies from figure to figure) would be helpful to put the results into perspective and relate them to real biological systems.</p>
</disp-quote>
<p>We appreciate the comments. In light of the reviewer’s suggestion, we have changed the range of the fitness effects and analyzed the sensitivity of our predictions to this range. As shown in Fig. S13, changing the range of MGE fitness effects didn’t alter the qualitative interplay between HGT and community multistability. We have also examined the sensitivity of the results to the strength of interspecies competition strength (Fig. S3, S10, S12). These results suggested that while the strength of interspecies interactions played an important role in shaping community multistability, the relationship between HGT rate and multistability was not fundamentally changed by varying interaction strength. In addition, we examined the role of death rates (Fig. S2). In the updated manuscript, we discussed the sensitivity of our prediction to these parameters in line 136-147, 190205, 335-354.</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations for the authors:</bold></p>
<p><bold>Reviewer #2 (Recommendations for the authors):</bold></p>
<p>Please find below a few suggestions that, in my opinion, could help improve the manuscript.</p>
<p>TITLE</p>
<p>It might not be clear what I 'gene exchange communities' are. Perhaps it could be rewritten for more specificity (e.g. '...communities undergoing horizontal gene transfer').</p>
</disp-quote>
<p>We have updated the title as the reviewer suggested.</p>
<disp-quote content-type="editor-comment">
<p>ABSTRACT</p>
<p>The abstract could also be edited to improve clarity and specificity. Terms like 'complicating factors' are vague, and enumerating specific factors would be better. The results are largely based on simulations, no analytical results are plotted, so I find that the sentence starting with 'Combining theoretical derivation and numerical simulations' can be a bit misleading.</p>
</disp-quote>
<p>We appreciate the suggestions. We have enumerated the specific factors and scenarios in the updated abstract (line 18-26). We have also replaced 'Combining theoretical derivation and numerical simulations' with ‘Combining mathematical modeling and numerical simulations’.</p>
<disp-quote content-type="editor-comment">
<p>INTRODUCTION</p>
<p>-  Line 42, please revise this paragraph. The logical flow is not so clear, it seems a bit like a list of facts, but the main message might not be clear enough. Also, it would be good to define 'hidden' states or just rewrite this sentence.</p>
</disp-quote>
<p>We appreciate the suggestion. In the updated manuscript, we have rewritten this paragraph to improve the logical flow and clarity (line 46-52).</p>
<disp-quote content-type="editor-comment">
<p>-  Line 54, there is little detail about both theoretical models and HGT in this paragraph, and mixing the two makes the paragraph less focused. I suggest to divide into two paragraphs and expand its content. For example, you could explain a bit some relevant implications of MGE.</p>
</disp-quote>
<p>We appreciate the suggestion. In the updated manuscript, we have divided this paragraph into two paragraphs, focusing on theoretical models and HGT, respectively (line 55-71). In particular, we have added explanations on the implications of MGEs (line 66-69), as the reviewer suggested.</p>
<disp-quote content-type="editor-comment">
<p>-  Line 72, as mentioned in the abstract, it would be better to explicitly mention which confounding factors are going to be discussed.</p>
</disp-quote>
<p>Thanks for the suggestion. We have rewritten this part as “We further extended our analysis to scenarios where HGT changed interspecies interactions, where microbial communities were subjected to strong environmental selections and where microbes lived in metacommunities consisting of multiple local habitats. We also analyzed the role of different mechanisms, including interspecies interaction strength, the growth rate effects of MGEs, MGE epistasis and microbial death rates in shaping the multistability of microbial communities. These results created a comprehensive framework to understand how different dynamic processes, including but not limited to HGT rates, collectively shaped community multistability and diversity” (line 75-82).</p>
<disp-quote content-type="editor-comment">
<p>RESULTS</p>
<p>-  The basic concepts (line 77) should be explained with more detail, keeping the non-familiar reader in mind. The reader might not be familiar with the concept of bistability in terms of species abundance. Also, note that mutual inhibition does not necessarily lead to positive feedback, as an interaction strength between 0 and 1 might still be considered inhibition. In any case, in Figure 1 it is not obvious how the positive feedback is represented, the caption should explain it. Note that neither the main text nor the caption explains the metaphor of the landscape and the marble that you are using in Figure 1a.</p>
</disp-quote>
<p>We have rewritten this paragraph to provide more details on the basic concepts (line 86-99). We have removed the statement about ‘mutual inhibition’ to avoid being misleading. We have also updated the caption of Fig. 1a to explain the metaphor of the landscape and the marble (line 389396).</p>
<disp-quote content-type="editor-comment">
<p>-  In the classical LV model, bistability does not depend on growth rates, but only on interaction strength. Therefore, I think that much of the results are significantly influenced by the added death rate. I believe that if the death rate is set to zero, mobile genetic elements that only modify growth rates will have no effect on the system's bistability. Because of this, I think that a thorough analysis of the role of the added death (dilution) rate and the distribution of growth rates is especially needed.</p>
</disp-quote>
<p>We are grateful for the reviewer’s insightful comments. In the updated manuscript, we have thoroughly analyzed the role of the added death (dilution) rate on the bistability of communities composed of two species (Fig. S2). Indeed, as the reviewer pointed out, if the death rate equals zero, mobile genetic elements that only modify growth rates will have no effect on the system's bistability. We have discussed the role of death rate in line 136-142 of the updated manuscript.</p>
<p>We have also expanded our analysis on the distribution of growth rates. In particular, we considered different ranges of growth rates effects of mobile genetic elements, by sampling 𝜆<sub><italic>ij</italic></sub> values from uniform distributions with given widths (Fig. S13). Greater width led to larger range of growth rate effects. We used five-species populations as an example and tested different ranges.</p>
<p>Our results suggested that multistability was more feasible when the growth rate effects of MGEs were small (Fig. S13b). The qualitative relationship between HGT and community was not dependent on the range of growth rate effects (Fig. S13a). These results are discussed in line 197205 of the updated manuscript.</p>
<disp-quote content-type="editor-comment">
<p>-  The analysis uses gamma values that, in the absence of an added death rate, render a species pair bistable. Therefore, multistability would be quite expected for a 5 species community. Note that, multistability is possible in communities of more than 2 species even if all gamma values are smaller than 1. Analyzing a wide range of interaction strength distributions would really inform on the relative role of HGT in multistability across different community scenarios.</p>
</disp-quote>
<p>We are grateful for the reviewer’s suggestion. In light of the reviewer’s comments, in the updated manuscript, we have performed additional analysis by focusing on a broader range of interaction strengths (Fig. S3, S10, S12), especially the gamma values below 1 (Fig. S10). Our results agreed with the reviewer’s notion that multistability was possible in communities of more than 2 species even if all gamma values were smaller than 1 (Fig. S10).</p>
<disp-quote content-type="editor-comment">
<p>-  I would recommend the authors extend the analysis of the model used for Figures 1 and 2. Figures 3 and 4 could be moved to the supplement (see my point in the public review), unless the authors extend the analysis to explain some non-intuitive outcomes for niches and metacommunities.</p>
</disp-quote>
<p>Thanks. In the updated manuscript we have performed additional simulations to extend the analysis in Figure 1 and 2. These results were presented in Fig. S2, S3, S9, S10, S11, S12, and S13. We have also moved Figure 3 and 4 to SI as the reviewer suggested.</p>
<disp-quote content-type="editor-comment">
<p>-  The authors seem to refer to fitness and growth rates as the same thing. This could lead to confusion - the strongest competitor in a species pair could also be interpreted as the fittest species despite being the slowest grower. I think there's no need to use fitness if they refer to growth rates. In any case, they should define fitness if they want to use this concept in the text.</p>
</disp-quote>
<p>We are grateful for the insightful suggestion. To avoid confusion, we have used ‘growth rate’ throughout the updated manuscript.</p>
<disp-quote content-type="editor-comment">
<p>-  Across the text, the language needs some revision for clarity, specificity, and scientific style. In lines 105 - 109 there are some examples, like the use of 'in a lot of systems', and ' interspecies competitions' (I believe they mean interspecies interaction strengths).</p>
</disp-quote>
<p>We appreciate the reviewer for pointing them out. We have thoroughly checked the text and made the revisions whenever applicable to improve the clarity and specificity.</p>
<disp-quote content-type="editor-comment">
<p>-  Many plots present the HGT rate on the horizontal axis. Could the authors explain why is it that the rate of HGT is relatively important for the number of alternative stable states? I understand how from zero to a small positive number there is a qualitative change. Beyond that, it shouldn't affect bistability too much, I think. If I am right, then other parameters could be more informative to plot in the horizontal axis. If I am wrong, I think that providing an explanation for this would be valuable.</p>
</disp-quote>
<p>Thanks. To address the reviewer’s comment, we have systematically analyzed the effects of HGT on community multistability, by scanning the HGT rate from 10<sup>-7</sup> to 10<sup>0</sup><italic>hr</italic><sup>-1</sup> . In communities of two or multiple species, our simulation results showed that multistability gradually increased with HGT rate when HGT rate exceeded 10<sup>2</sup><italic>hr</italic><sup>-1</sup>. These results, presented in Fig. S9 and discussed in line 337-346, provided a more quantitative relationship between multistability and HGT rate.</p>
<p>While in this work we showed the potential role of HGT in modulating community multistability, our results didn’t exclude the role of the other parameters. Motivated by the comments raised by the reviewers, in the updated manuscript, we have performed additional simulations to analyze the influence of other parameters in shaping community multistability. These parameters include death or dilution rate (Fig. S2), interaction strength (Fig. S3, S9, S10, S11, S12, S14, S15), 𝜆 range (Fig. S13, S15) and 𝛿 value (Fig. 3g, h, i). In many of the supplemented results (Fig. S2b, S3b, S13b, Fig. 3g, 3h and 3i), we have also plotted the data by using these parameters as the x axis. We believe the updated work now provided a more comprehensive framework to understand how different mechanisms, including but not limited to HGT, might shape the multistability of complex microbiota. These points were discussed in line 136-147, 190-205, 238-253, 334-354 of the updated main text.</p>
<disp-quote content-type="editor-comment">
<p>-  My overall thoughts on the case of antibiotic exposure are similar to those of previous sections. Very few of the different parameters of the model are analyzed and discussed. In this case, the authors increased the interaction strength to ~0.4 times higher compared to previous sections. Was this necessary, and why?</p>
</disp-quote>
<p>Thanks for the comments. In the previous draft, the interaction strength 𝛾=1.5 was tested as an example. Motivated by the reviewer’s comments, in the updated manuscript, we have examined different interaction strengths, including the strength ( 𝛾 = 1.1 ) commonly tested in other scenarios. The prediction equally held for different 𝛾 values (Fig. S15). We have also analyzed different 𝜆 ranges (Fig. S15). These results, together with the analyses presented in the earlier version of the manuscript, suggested the potential role of HGT in promoting multistability for communities under strong selection. The supplemented results were presented in Fig. S15 and discussed in line 293-295 of the updated manuscript.</p>
<disp-quote content-type="editor-comment">
<p>-  Line 195, if a gene encodes for the production of a public good, why would its HGT reduce interaction strength? I can think of the opposite scenario: the gene is a public good, and without HGT there is only one species that can produce it. Let's imagine that the public good is an enzyme that deactivates an antibiotic that is present in the environment, and then the species that produces has a positive interaction with another species in a pairwise coculture. If HGT happens, the second species becomes a producer and does not need the other one to survive in the presence of antibiotics anymore. The interaction can then become more competitive, as e.g. competition for resources could become the dominant interaction.</p>
</disp-quote>
<p>We are grateful for pointing it out. In the updated manuscript, we have removed this statement.</p>
<disp-quote content-type="editor-comment">
<p>DISCUSSION</p>
<p>-  L 267 &quot;by comparison with empirical estimates of plasmid conjugation rates from a previous study [42], the HGT rates in our analysis are biologically relevant in a variety of natural environments&quot;. The authors are using a normalized model and the relevance of other parameter values is not discussed. If the authors want to claim that they are using biologically relevant HGT, they should also discuss whether the rest of the parameter values are biologically relevant. I recommend relaxing this statement about HGT rates.</p>
</disp-quote>
<p>We appreciate the suggestion. We agree with the reviewer that other parameters including the death/dilution rate, interactions strength and 𝜆 ranges are also important in shaping community multistability. We have performed additional analysis to show the effects of these parameters. In light of the reviewer’s suggestion, we have relaxed this statement and thoroughly discussed the context-dependent effect of HGT as well as the roles of different parameters (line 334-354).</p>
<disp-quote content-type="editor-comment">
<p>-  Last sentence: &quot;Therefore, inhibiting the MGE spread using small molecules might offer new opportunities to reshape the stability landscape and narrow down the attraction domains of the disease states&quot;. It is not clear what procedure/technique the authors are suggesting. If they want to keep this statement, the authors should give more details on how small molecules can be/are used to inhibit MGE.</p>
</disp-quote>
<p>We appreciated the comments. Previous studies have shown some small molecules like unsaturated fatty acids can inhibit the conjugative transfer of plasmids. By binding the type IV secretion traffic ATPase TrwD, these compounds limit the pilus biogenesis and DNA translocation. We have provided more details regarding this statement in the updated manuscripts (line 376-379).</p>
<disp-quote content-type="editor-comment">
<p>METHODS</p>
<p>-  Line 439, mu_i should be presented as the maximum 'per capita' growth rate.</p>
</disp-quote>
<p>We have updated the definition of 𝜇<italic>i</italic> following the suggestion (line 529).</p>
<disp-quote content-type="editor-comment">
<p>-  Line 444, this explanation is hard to follow, please expand it to provide more details. You could provide an example, like explaining that all individuals from S1 have the MGE1 and therefore they have mu_1 = mu_01 ... After HGT, their fitness changes if they get the plasmid from S2, so a term lambda2 appears.</p>
</disp-quote>
<p>Thanks. In the updated manuscript, we have expanded the explanation by providing an example as the reviewer suggested (line 534-537).</p>
<disp-quote content-type="editor-comment">
<p>-  The normalization assumes a common carrying capacity Nm (Eqs 1-4) and then it's normalized (Eqs. 5-8). It would be better to start from a more general scenario in which each species has a different carrying capacity and then proceed with the normalization.</p>
</disp-quote>
<p>We appreciate the suggestion. In the updated manuscript, we have started our derivation from the scenario where each species has a different carrying capacity before proceeding with the normalization (section 1 of Methods, line 516-554). The same equations can be obtained after normalization.</p>
<disp-quote content-type="editor-comment">
<p>-  I think that the meaning of kappa (the plasmid loss rate) is not explained in the text.</p>
</disp-quote>
<p>Thanks for pointing it out. We have explained the meaning of kappa in the updated text (line 108, 154, 539-541, 586-587, 607).</p>
<disp-quote content-type="editor-comment">
<p>SUPPLEMENT</p>
<p>-  Figure S4, what are the different colors in panel b?</p>
</disp-quote>
<p>In panel b of Fig. S4, the different colors represent the simulation results repeated with randomized growth rates. We have made it clear in the updated SI.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Recommendations for the authors):</bold></p>
<p>(1) Please extend your description of the model, so it is easier to understand for readers who have not read the first paper. Especially the choice to describe the model as species and subpopulations, as opposed to writing it as MGE-carrying and MGE-free populations of each species makes it quite complicated to understand which parameters influence each other.</p>
</disp-quote>
<p>Thanks for the suggestion. We have extended the model description in the updated manuscript, which provides a more detailed introduction on model configurations and parameter definitions (line 86-99, 101-113, 151-159). We have also updated the Methods to extend the model description.</p>
<disp-quote content-type="editor-comment">
<p>(2) Please define gamma_ji in equation 13 and eta_jki in equation 14 (how to map the indices onto the assumed directionality of the interaction).</p>
</disp-quote>
<p>We have defined these two parameters in the updated manuscript (line 584-586, 630-632).</p>
<disp-quote content-type="editor-comment">
<p>(3)  Line 511: please add at the beginning of this paragraph that you are assuming a grid-like arrangement of patches which will be captured by dispersal term H.</p>
</disp-quote>
<p>We have updated this paragraph to make this assumption clear (line 636-637).</p>
<disp-quote content-type="editor-comment">
<p>(4)  Line 540: &quot;used in our model&quot; (missing a word).</p>
</disp-quote>
<p>We have corrected it in the updated manuscript.</p>
<disp-quote content-type="editor-comment">
<p>(5)  Currently the analyses looking at the types of growth effects HGT brings (Figures 5-7) feel very &quot;tacked on&quot;. These are not just &quot;confounding factors&quot;, but rather scenarios that are much more biologically realistic than the assumption of independent effects. I would introduce them earlier in the text, as I think many readers may not trust your results until they know this was considered (+ how it changes the conclusions).</p>
</disp-quote>
<p>We are grateful for the suggestion. We agree with the reviewer that these biologically realistic scenarios should be introduced earlier in the text. In the updated manuscript, we have moved these analyses forward, as sections 3, 4 and 5. We have also avoided the term “confounding factors”. Instead, in the updated manuscript, we have separated these analyses into different sections, and clearly described each scenario in the section title (line 217-218, 254, 275).</p>
<disp-quote content-type="editor-comment">
<p>(6)  In some places the manuscript refers to HGT, in others to MGE presence (e.g. caption of Figure 6). These are not generally the same thing, as HGT could also occur due to extracellular vesicles or natural transformation etc. Please standardize the nomenclature and make it clearer which type of processes the model describes.</p>
</disp-quote>
<p>We appreciate the comment. The model in this work primarily focused on the process of plasmid transfer. We have made it clear throughout the main text.</p>
<disp-quote content-type="editor-comment">
<p>(7)  In many figures the y-axis starts at a value other than 0. This is a bit misleading. In addition, I would recommend changing the title &quot;Area of bistability region&quot; to &quot;Area of bistability&quot; or perhaps even &quot;Area of multistability&quot; (since more than two species are considered).</p>
</disp-quote>
<p>Thanks for the suggestion. We have updated all the relevant figures to make sure that their y-axes start at 0. We have also changed the title “Area of bistability region” to “Area of multistability”, whenever it is applicable.</p>
<disp-quote content-type="editor-comment">
<p>(8)  Figure 7: what are the assumed fitness effects of the mobile genes in the simulation? Which distribution were they drawn from? Please add this info to the figure caption here and elsewhere.</p>
</disp-quote>
<p>In Figure 7, we explored an extreme scenario of the fitness effects of the mobile genes, where the population was subjected to strong environmental selection and only cells carrying the mobile gene could grow. Therefore, the carriage of the mobile gene changed the species growth rate from 0 to a positive value µ<sub>i</sub>. When calculating the number of stable states in the communities, we randomly drew the µ<sub>i</sub> values from a uniform distribution between 0.3 and 0.7 <italic>hr</italic><sup>-1</sup>. We had added this information in the figure caption (line 505-508) and method (line 615-617) of the updated manuscript.</p>
</body>
</sub-article>
</article>