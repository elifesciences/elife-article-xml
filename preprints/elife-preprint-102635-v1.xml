<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">102635</article-id>
<article-id pub-id-type="doi">10.7554/eLife.102635</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.102635.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Quantifying microbial fitness in high-throughput experiments</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1138-4009</contrib-id>
<name>
<surname>Fink</surname>
<given-names>Justus Wilhelm</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<email>justus.fink@caltech.edu</email>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3791-9056</contrib-id>
<name>
<surname>Manhart</surname>
<given-names>Michael</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
<email>mmanhart@rutgers.edu</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05a28rw58</institution-id><institution>Institute of Integrative Biology, Department of Environmental Systems Science, ETH Zurich</institution></institution-wrap>, <city>Zurich</city>, <country>Switzerland</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05vt9qd57</institution-id><institution>Center for Advanced Biotechnology and Medicine, Rutgers University</institution></institution-wrap>, <city>Piscataway</city>, <country>USA</country></aff>
<aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00pc48d59</institution-id><institution>Department of Environmental Microbiology, Swiss Federal Institute of Aquatic Science and Technology (Eawag)</institution></institution-wrap>, <city>Dübendorf</city>, <country>Switzerland</country></aff>
<aff id="a4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05vt9qd57</institution-id><institution>Department of Biochemistry and Molecular Biology, Robert Wood Johnson Medical School, Rutgers University</institution></institution-wrap>, <city>Piscataway</city>, <country>USA</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Mitri</surname>
<given-names>Sara</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Lausanne</institution>
</institution-wrap>
<city>Lausanne</city>
<country>Switzerland</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Walczak</surname>
<given-names>Aleksandra M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>CNRS</institution>
</institution-wrap>
<city>Paris</city>
<country>France</country>
</aff>
</contrib>
</contrib-group>
<pub-date date-type="original-publication" iso-8601-date="2024-12-09">
<day>09</day>
<month>12</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP102635</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-09-06">
<day>06</day>
<month>09</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-08-20">
<day>20</day>
<month>08</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.08.20.608874"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Fink &amp; Manhart</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Fink &amp; Manhart</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-102635-v1.pdf"/>
<abstract>
<p>Few concepts are as central to evolution as is fitness, and yet the quantification of fitness is often ambiguous. In particular, high-throughput experiments to measure mutant fitness in microbes are increasingly common but vary widely in their definitions of fitness, which makes their results difficult to compare. What are the consequences of these different fitness statistics, and is there a best way to quantify fitness in a given context? Here we systematize the set of possible fitness statistics according to the following three choices: 1) the encoding of relative abundance (e.g., transforming by a log or logit function), 2) the time scale over which to measure the change in relative abundance, and 3) the choice of a reference subpopulation for calculating fitness in bulk competition experiments, such as those using DNA-barcoded mutants. We show that these different choices can lead to significantly different interpretations of mutant fitness, affecting the magnitude of fitness effects, the presence of epistasis, and even the fitness ranking across mutants. This can confound predictions for evolutionary dynamics and gene functions. Altogether our results demonstrate the importance of consistent fitness definitions for reproducible results across experiments.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>fitness</kwd>
<kwd>microbial evolution</kwd>
<kwd>competition experiments</kwd>
<kwd>gene knockouts</kwd>
<kwd>growth curves</kwd>
<kwd>DNA barcodes</kwd>
</kwd-group>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="external-links">
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://github.com/justuswfink/24FitnessQuantification">https://github.com/justuswfink/24FitnessQuantification</ext-link>
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Fitness describes the fate of mutations as they arise in a population [<xref ref-type="bibr" rid="c1">1</xref>] and serves to define other core evolutionary concepts such as trade-offs [<xref ref-type="bibr" rid="c2">2</xref>]. At the same time, fitness is an often confusing term in evolutionary biology [<xref ref-type="bibr" rid="c3">3</xref>–<xref ref-type="bibr" rid="c5">5</xref>]. It is possible to classify fitness measures by their role in theory [<xref ref-type="bibr" rid="c6">6</xref>] and their scale of measurement [<xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c9">9</xref>], but these arguments offer little guidance on how to measure fitness with microorganisms in practice. In particular for the field of microbial ecology and evolution, empirical fitness measurements allow us to test general evolutionary theory with fast-growing model organisms [<xref ref-type="bibr" rid="c10">10</xref>– <xref ref-type="bibr" rid="c15">15</xref>] and can also be used to detect microbial interactions [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c17">17</xref>], annotate gene function [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>], and understand the spread of antibiotic resistance genes [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c21">21</xref>].</p>
<p>The classic approach to measuring the fitness effects of mutations uses pairwise competition experiments, where the mutant competes with a wild-type in co-culture [<xref ref-type="bibr" rid="c22">22</xref>– <xref ref-type="bibr" rid="c24">24</xref>]. This approach is ideal because it closely mimics the dynamics of spontaneous mutations, and thus is typically used in experimental evolution [<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c25">25</xref>–<xref ref-type="bibr" rid="c27">27</xref>]. For example, the Long-Term Evolution Experiment (LTEE) has evolved <italic>Escherichia coli</italic> over tens of thousand of generations and measured the fitness of each evolved lineage in competition with the ancestor [<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c26">26</xref>, <xref ref-type="bibr" rid="c28">28</xref>]. Since measuring pairwise competitions becomes infeasible for a large number of strains, a second approach is to measure properties of genotypes in monoculture, like the growth rate, and combine these measurements for a relative fitness estimate. Monoculture growth curves are straightforward to measure, even for entire libraries of single-gene knock-out mutants [<xref ref-type="bibr" rid="c29">29</xref>–<xref ref-type="bibr" rid="c31">31</xref>], but empirical tests have shown that the monoculture growth rate is insufficient to predict the mutant fitness [<xref ref-type="bibr" rid="c32">32</xref>–<xref ref-type="bibr" rid="c34">34</xref>]. Summary statistics, like the area under the curve (AUC), perform better [<xref ref-type="bibr" rid="c35">35</xref>–<xref ref-type="bibr" rid="c37">37</xref>]. However, this approach breaks down for strains that engage in cross-feeding or toxin production and any attempts to improve monoculture-based fitness estimates require additional experiments [<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c37">37</xref>] and do not go beyond qualitative fitness rankings [<xref ref-type="bibr" rid="c37">37</xref>].</p>
<p>A third and more recent approach is to measure relative fitness in bulk competition experiments, based on high-throughput barcode sequencing [<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c38">38</xref>]. For example, transposon-insertion mutagenesis generates libraries of barcoded gene knockouts that can be tracked as they grow in a single batch culture [<xref ref-type="bibr" rid="c39">39</xref>]. Estimating the fitness of each barcode allows us to identify genes that are particularly important in the growth environment [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c40">40</xref>], in the given genetic background [<xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c42">42</xref>], and in the context of an ecological community [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c43">43</xref>]. Bulk fitness estimation also plays a major role to identify beneficial lineages in experimental evolution [<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c44">44</xref>] (not unlike the tracking of viral pathogens in public health [<xref ref-type="bibr" rid="c45">45</xref>–<xref ref-type="bibr" rid="c47">47</xref>]) and to test their fitness in new environments [<xref ref-type="bibr" rid="c48">48</xref>–<xref ref-type="bibr" rid="c52">52</xref>]. Many of these studies make different choices about the design of experiments and the calculation of fitness, but without explaining why a certain fitness measure was used or how to compare between data sets.</p>
<p>The inconsistent choices for quantifying microbial fitness make it is difficult to compare fitness across experiments, especially because different groups tend to use different definitions. For example, the LTEE reports relative fitness per generation [<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c26">26</xref>], whereas other evolution experiments exclusively report relative fitness percycle [<xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c53">53</xref>]. New techniques, like barcode sequencing, often spark their own fitness metrics [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c40">40</xref>, <xref ref-type="bibr" rid="c54">54</xref>–<xref ref-type="bibr" rid="c56">56</xref>]. It is also not clear what the consequences of this choice are; a different fitness metric might lead to a different ranking of mutants in a genetic screen (and the importance we assign to those genes), besides affecting the quantitative fitness value. The probability of fixation for spontaneous mutations [<xref ref-type="bibr" rid="c57">57</xref>, <xref ref-type="bibr" rid="c58">58</xref>], the speed of adaptation [<xref ref-type="bibr" rid="c59">59</xref>], and the effect size for gene essentiality experiments [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>] all depend on our ability to estimate quantitative fitness values. This raises three key questions: How do these fitness statistics differ, or are some equivalent? Can we say which choices are optimal, in the light of first principles or some practical considerations? And does this tell us how we should design these experiments? Previous work has addressed aspects of these questions [<xref ref-type="bibr" rid="c6">6</xref>–<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c60">60</xref>] but the arguments are scattered across disciplines and based on generic models of population growth [<xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c61">61</xref>], rather than incorporating the specific dynamics of microbes in laboratory experiments. Here we address these questions from a unified framework, using realistic microbial population dynamics with empirical traits to systematically test different fitness metrics.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Predictive power varies across different relative fitness statistics</title>
<p>While there are other notions of fitness relevant in different evolutionary contexts (Sec. S1, <xref rid="figS1" ref-type="fig">Fig. S1</xref>), in this article we focus on relative fitness as this is the most common object of high-throughput laboratory experiments in microbes [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c26">26</xref>, <xref ref-type="bibr" rid="c40">40</xref>, <xref ref-type="bibr" rid="c55">55</xref>, <xref ref-type="bibr" rid="c56">56</xref>]. To generalize the wide range of relative fitness statistics used in these studies, we define a genotype’s relative fitness as any number that is sufficient to predict the genotype’s relative abundance <italic>x(t)</italic> over a short-time horizon (<xref rid="figS1" ref-type="fig">Fig. S1</xref>). The simplest approach is to take a linear expansion of <italic>x(t)</italic> and use its slope at time <italic>t</italic> to predict the change over a time-window Δ<italic>t</italic>:
<disp-formula id="eqn1">
<graphic xlink:href="608874v1_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Under this linear approximation, the slope <italic>s</italic><sup>linear</sup> = <italic>dx</italic>/<italic>dt</italic>|<sub><italic>t</italic></sub> constitutes a relative fitness statistic, since it is sufficient to predict the change in relative abundance. <xref rid="fig1" ref-type="fig">Figure 1A</xref> (top panel) shows a schematic trajectory of relative abundance <italic>x(t)</italic> with two examples of this predictive approach (dashed arrows). As we can see, the naive linear statistic of relative fitness can significantly under- or overestimate the actual change in relative abundance, because <italic>x(t)</italic> changes nonlinearly in time.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1.</label>
<caption><title>Overview of the choice of encoding and the choice of timescale for quantifying relative fitness.</title>
<p>(A) Example trajectory of relative abundance <italic>x</italic> (upper panel) for a mutant invading and eventually replacing a wild-type population. The same trajectory is plotted under the encoding log <italic>x</italic> (middle panel) and the logit-encoding log(<italic>x/</italic>(1 − <italic>x</italic>)) (lower panel). (B) The general flow-chart to predict the future relative abundance of a mutant given a relative fitness value <italic>s</italic><sup><italic>m</italic></sup> = <italic>dm/dt</italic> for some encoding <italic>m</italic>. The current relative abundance <italic>x</italic><sub><italic>t</italic></sub> is transformed into the new variable <italic>m</italic><sub><italic>t</italic></sub> = <italic>m</italic>(<italic>x</italic><sub><italic>t</italic></sub>), then projected into the future through a linear extrapolation using <italic>s</italic><sup><italic>m</italic></sup> (upper horizontal arrow) and finally converted back into a frequency <italic>x</italic><sub><italic>t</italic>+..6<italic>t</italic></sub> using the decoding function <italic>m</italic><sup>−1</sup>. (C) Four scenarios for positive mutant fitness with different underlying population dynamics. For each scenario, we show an example trajectory of absolute abundance (stacked) for the wild-type (dark grey) and mutant population (light grey). Each scenario is mapped as a single-dot onto the fold-change diagram (center plot) and colored areas indicated positive (green area) and negative relative fitness per-cycle (blue area; compare <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>). (D) Basic constellation for misranking between relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline71.gif" mime-subtype="gif" mimetype="image"/></inline-formula>and relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline72.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For a given competition (red dot), misranking occurs in a bow-tie area of the fold-change space (red shade). Any competition in the right half of this area (grey dot) will have higher mutant fitness <inline-formula><inline-graphic xlink:href="608874v1_inline73.gif" mime-subtype="gif" mimetype="image"/></inline-formula>but lower mutant fitness <inline-formula><inline-graphic xlink:href="608874v1_inline74.gif" mime-subtype="gif" mimetype="image"/></inline-formula>(right inset). As small plots on the left, we show possible population dynamics that generate this fold-change variation.</p></caption>
<graphic xlink:href="608874v1_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>As an alternative, we can transform the relative abundance <italic>x</italic> into a new variable <italic>m(x) that</italic> improves the quality of prediction (<xref rid="fig1" ref-type="fig">Fig. 1B</xref>; compare [<xref ref-type="bibr" rid="c62">62</xref>]). We define an <italic>encoding</italic> as a smooth, strictly-increasing function of relative abundance. This one-to-one mapping allows us to predict the change in relative abundance using a linear expansion of the encoded relative abundance, rather than the relative abundance itself:
<disp-formula id="eqn2">
<graphic xlink:href="608874v1_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>m</italic><sup>−1</sup> is the inverse of the encoding function and
<disp-formula id="eqn3">
<graphic xlink:href="608874v1_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
is the relative fitness under the encoding <italic>m</italic>. Note that the relative fitness of neutral mutations is always zero, independent of the encoding.</p>
<p>For example, <xref rid="fig1" ref-type="fig">Fig. 1A</xref> (middle panel) shows the relative abundance under the log-encoding <italic>m(x) = lo</italic>g <italic>x;</italic> this encoding is implicit in typical plots of relative abundance on a logarithmic scale [<xref ref-type="bibr" rid="c44">44</xref>]. This leads to an approximately linear trajectory in the beginning, where the prediction quality of the slope of the encoding <italic>s</italic><sup>log</sup> is thus higher than for the slope of relative abundance <italic>s</italic><sup>linear</sup> (compare top and middle panels of <xref rid="fig1" ref-type="fig">Fig. 1A</xref>). However, under the log-encoding the prediction quality remains poor at later stages in the trajectory. In the case of <xref rid="fig1" ref-type="fig">Fig. 1A</xref>, we see that the ideal encoding is given by <italic>m(x) = lo</italic>git <italic>x</italic> (bottom panel), where the logit function is defined as
<disp-formula id="eqn4">
<graphic xlink:href="608874v1_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>This is ideal because it transforms the nonlinear trajectory of relative abundance <italic>x(t)</italic> into a linear trajectory that can be fully predicted from the linear expansion in <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>.</p>
<p>Why is the logit function <italic>m(x) = lo</italic>git <italic>x</italic> the ideal encoding of relative abundance for a fitness statistic in this case? Since we generated the relative abundance <italic>x(t)</italic> in <xref rid="fig1" ref-type="fig">Fig. 1A</xref> using logistic dynamics, the logit function is linearly related to the inverse function of <italic>x(t)</italic> (Sec. S2). More generally, the ideal encoding for a given relative abundance dynamics <italic>x(t)</italic> is any linear function of the inverse <italic>m</italic>(<italic>x(t)</italic>) = <italic>at</italic>(<italic>x</italic>) + <italic>b</italic> of those dynamics. Note that the ambiguous scale <italic>a</italic> also includes log and logit encodings with a different base of the logarithm (discussed in Ref. [<xref ref-type="bibr" rid="c7">7</xref>]). The inversion of <italic>x(t)</italic> is equivalent to removing frequency (relative abundance) dependence from the relative fitness statistic <italic>s</italic><sup>linear</sup> [<xref ref-type="bibr" rid="c63">63</xref>]. For example, <xref rid="figS2" ref-type="fig">Fig. S2</xref> shows that if we apply the logit-encoding to a trajectory with non-logistic underlying dynamics (e.g., Gompertz model), the logit transform reduces but does not entirely remove the nonlinearity in the relative abundance trajectory (see the mathematical notes by Mallet [<xref ref-type="bibr" rid="c64">64</xref>] for more examples). We note that is possible to generalize the concept of encodings to absolute abundance as well (Sec. S3).</p>
<p>Of course, the exact dynamics of microbial populations are generally not known, and if they were known, there would be no need to make predictions using the linear expansion in <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>. In the absence of an exact model, there are mathematical and practical reasons for why the logit function is a sensible encoding for relative abundance. First, logistic dynamics can be interpreted as the lowest-order approximation to more complex dynamics of relative abundance (Sec. S2). Second, the logit encoding is particularly suited to the binomial sampling noise in experimental measurements of relative abundance (<xref rid="figS3" ref-type="fig">Fig. S3</xref>). Logit is the designated link function for binomial random variables, meaning that it normalizes the measurement variance across relative abundances (heteroscedasticity), regardless of whether the underlying dynamics are logistic [<xref ref-type="bibr" rid="c65">65</xref>–<xref ref-type="bibr" rid="c67">67</xref>]. For these reasons, we exclusively focus on the logit-based relative fitness for the remainder of this work.</p>
</sec>
<sec id="s2b">
<title>Relative fitness statistics require a choice of timescale</title>
<p>In practice, the relative abundance of a genotype is only available as a trajectory of discrete time points (see crossmarks in <xref rid="figS1" ref-type="fig">Fig. S1C</xref>). To estimate the relative fitness at a given time point, we calculate the finite difference of the encoded abundance between the current time <italic>t</italic> and the previous time point:
<disp-formula id="eqn5">
<graphic xlink:href="608874v1_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where Δt is the time difference between observations. For discretized time steps it is also possible to define a multiplicative fitness that describes the ratio, rather than the difference, of encoded relative abundance between time points (Sec. S4).</p>
<p>In the case of a single mutant competing against a wild-type strain, the estimated relative fitness of the mutant (using <xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>) under the logit encoding is
<disp-formula id="eqn6">
<graphic xlink:href="608874v1_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>x</italic><sub>mut</sub> is the relative abundance of the mutant and <italic>x</italic><sub>wt</sub> = 1 − <italic>x</italic><sub>mut</sub> is the relative abundance of the wild-type. This form of relative fitness is widely used in empirical measurements of microbial fitness [<xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c66">66</xref>]. Note that a special property of the logit encoding is that we can rewrite <xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref> in terms of the log fold-changes of the mutant and wild-type strains:
<disp-formula id="eqn7">
<graphic xlink:href="608874v1_eqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where the log fold-change of each strain is LFC = log <italic>N</italic> (<italic>t</italic>)/<italic>N</italic> (<italic>t</italic> Δ<italic>t</italic>) and <italic>N</italic> is the biomass of the strain. The LFC is sometimes also referred to as a Malthusian parameter [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c26">26</xref>, <xref ref-type="bibr" rid="c68">68</xref>].</p>
<p>A key element of this estimate of relative fitness (<xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>) is the time interval Δ<italic>t</italic>. There are three common ways to choose a time interval Δ<italic>t</italic> in empirical measurements of microbial fitness. The simplest is to use a fixed clock time between measurements (e.g., one day). However, many microbial populations, especially in laboratory experiments [<xref ref-type="bibr" rid="c26">26</xref>, <xref ref-type="bibr" rid="c69">69</xref>] but also in some natural environments [<xref ref-type="bibr" rid="c70">70</xref>–<xref ref-type="bibr" rid="c72">72</xref>], grow in discrete growth cycles dictated by pulses of nutrients (batch culture). These cycles define an intrinsic timescale of population dynamics and also determine the time point of sampling. In this case, it is convenient to quantify relative fitness <italic>per cycle</italic>
<disp-formula id="eqn8">
<graphic xlink:href="608874v1_eqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where we have chosen the logit-encoding and Δ<italic>t</italic> = 1 growth cycle in <xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>.</p>
<p>Another important timescale for microbial populations is the generation time. In general, the relative fitness per cycle (<xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>) may depend on the number of generations in the growth cycle, and it can be valuable to normalize for this dependence, especially when comparing across environments [<xref ref-type="bibr" rid="c26">26</xref>]. However, defining the number of generations for a population with multiple genotypes growing at different rates is ambiguous. In the case of a single mutant competing with a wild-type, it is common to consider only the number of generations experienced by the wild-type strain, which is estimated by the log fold-change LFC<sub>wt</sub> = log <italic>N</italic><sub>wt</sub>(<italic>t</italic>)/<italic>N</italic><sub>wt</sub>(<italic>t</italic> − Δ<italic>t</italic>). It is convenient to express the generations in base e to match the natural logarithm in the logit-encoding, but this could equivalently be done by converting all logarithms to base 2. Thus the relative fitness of a mutant <italic>per generation</italic> <inline-formula><inline-graphic xlink:href="608874v1_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula>is defined by choosing Δ<italic>t</italic> = LFC<sub>wt</sub> in <xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>. In the case of the logit-encoding, the relative fitness per-generation is
<disp-formula id="eqn9">
<graphic xlink:href="608874v1_eqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where we have replaced ratios of relative abundances with ratios of absolute abundances in <xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref> and rear-ranged to express completely in terms of log fold-changes (<xref ref-type="disp-formula" rid="eqn7">Eq. (7)</xref>). The relative fitness per generation <inline-formula><inline-graphic xlink:href="608874v1_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula>with the logit encoding is equivalent to the fitness statistic <inline-formula><inline-graphic xlink:href="608874v1_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula>used in the LTEE [<xref ref-type="bibr" rid="c26">26</xref>] and other studies [<xref ref-type="bibr" rid="c73">73</xref>–<xref ref-type="bibr" rid="c77">77</xref>]. Some authors assume a fixed number of generations per growth cycle [<xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c15">15</xref>], but since this may not be true, we use the term “per-generation” more strictly for fitness statistics where the wild-type generations are explicitly measured.</p>
</sec>
<sec id="s2c">
<title>Relative fitness per-generation ranks mutants differently than relative fitness per-cycle</title>
<p>Even though relative fitness of a mutant per growth-cycle (<xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>) and per generation (<xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref>) are both common statistics in microbial fitness measurements, they are not just equivalent quantities in different units. One major discrepancy between these fitness statistics occurs when the wild-type strain has no growth or experiences net death during the growth cycle because the number of wild-type generations is not well-defined (denominator of <xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref>) [<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c78">78</xref>]. This occurs for microbes under high drug concentrations, as well as for microbial populations under harsh environmental conditions as found in sediments or wastewater [<xref ref-type="bibr" rid="c79">79</xref>, <xref ref-type="bibr" rid="c80">80</xref>]. <xref rid="fig1" ref-type="fig">Figure 1C</xref> shows four qualitatively different scenarios for a mutant competing with a wild-type strain, parameterized according to their LFCs. A comparison between relative fitness per-generation and per-cycle only makes sense when both the wild-type and the mutant show net growth (scenario 1 in <xref rid="fig1" ref-type="fig">Fig. 1C</xref>)</p>
<p>However, even when the LFC is positive, the relative fitness per-generation can produce different rankings compared to the relative fitness percycle. For example, <xref rid="fig1" ref-type="fig">Fig. 1D</xref> shows two mutant genotypes (red and grey) that have opposite rankings under these fitness statistics: the grey mutant has higher relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, but the red mutant has higher relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The disagreement in ranking requires positive covariation in the LFCs (red bowtie area in <xref rid="fig1" ref-type="fig">Fig. 1D</xref>), such that the mutant with higher LFC also induces a higher LFC in the wild-type (Sec. S5, <xref rid="figS4" ref-type="fig">Fig. S4</xref>).</p>
</sec>
<sec id="s2d">
<title>Fitness statistics disagree over predicted ranking of single gene knockouts</title>
<p>While we have shown that relative fitnesses per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula>and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula>can lead to different mu-tant rankings in principle, we need to know whether this outcome occurs under realistic scenarios of microbial population dynamics. We thus simulate fitness rankings for gene knockout mutants using empirically measured growth traits, based on a previously published growth curve dataset for the single-gene knockout collection in <italic>Saccharomyces cerevisiae</italic> [<xref ref-type="bibr" rid="c29">29</xref>, <xref ref-type="bibr" rid="c81">81</xref>]. We estimate growth traits from growth curves (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>; Methods; Sec. S6) and find large variation in lag time, growth rate, and biomass yield for the single gene knockouts (grey dots in <xref rid="fig2" ref-type="fig">Fig. 2B,C</xref>; also see <xref rid="figS5" ref-type="fig">Fig. S5</xref>); despite the knockouts affecting multiple traits (pleiotropy), there are only weak correlations between them. To estimate relative fitness per-cycle (<xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>) and per-generation (<xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref>), we simulate a pairwise competition for each knockout against the wild-type (<xref rid="fig2" ref-type="fig">Fig. 2D</xref>) using a consumer-resource model with a single limiting nutrient (Methods) [<xref ref-type="bibr" rid="c82">82</xref>, <xref ref-type="bibr" rid="c83">83</xref>]. While the relative fitness per-cycle and per-generation are highly correlated across mutants over-all (<xref rid="figS6" ref-type="fig">Fig. S6</xref>), there are major differences in the ranks of individual mutants (<xref rid="fig2" ref-type="fig">Fig. 2E</xref>). For example, measuring the relative fitness per-generation ranks one beneficial mutant (grey dot highlighted with blue circle in <xref rid="fig2" ref-type="fig">Fig. 2E</xref>) 145 positions higher than quantifying relative fitness per-cycle (where higher rank corresponds to higher fitness). Indeed, when we plot the set of competitions in this fitness ranking on the LFC diagram, we find that there is many pairs of points that have positive covariation in the mutant and wild-type LFC and thus give rise to ranking differences (compare <xref rid="fig2" ref-type="fig">Figs. 2F</xref> and <xref rid="fig1" ref-type="fig">1D</xref>) despite a negative covariation overall (compare <xref rid="fig2" ref-type="fig">Figs. 2F</xref> and <xref rid="figS4" ref-type="fig">S4B</xref>).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig. 2.</label>
<caption><title>Comparison of mutant fitness rankings with different statistics on empirical trait variation.</title>
<p>(A) Overview of the growth curve dataset and the estimated growth traits for the knockout library of <italic>Saccharomyces cerevisiae</italic> (Methods). (B) Covariation between estimated steady-state growth rate <italic>g</italic> and lag time, λ across all mutant strains (grey dots; Pearson correlation coefficient <italic>r</italic> = −0.17, <italic>p</italic> = 7 × 10<sup>−30</sup>) as well as wild-type replicates (orange dots; <italic>r</italic> = − 0.16, <italic>p</italic> = 0.002). The reference wild-type strain for our pairwise co-culture simulations is defined by the median trait values (black cross) of all wild-type replicate. (C) Covariation between measured steady-state growth rate <italic>g</italic> and biomass yield <italic>Y</italic> across all mutant strains (grey dots; <italic>r</italic> = 0.21, <italic>p</italic> = 8 × 10<sup><italic>-</italic>44</sup>) as well as wild-type replicates (orange dots; <italic>r</italic> = − 0.06, <italic>p</italic> = 0.25). (D) Overview of pairwise co-culture simulations. For each mutant strain (orange), we simulate a competition growth cycle against a reference wild-type strain using the estimated traits (panel A) and laboratory parameters for the initial condition (<italic>N</italic><sub>0</sub> = 0.05 OD, <italic>R</italic><sub>0</sub> = 111 mM glucose, <italic>x</italic> = 0.5; Methods) and quantify relative fitness of the mutant in different statistics (<xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>,<xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref>). (E) Rank disagreement between relative-fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline75.gif" mime-subtype="gif" mimetype="image"/></inline-formula>and per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline76.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For each fitness statistic, we calculate the mutant ranking (higher rank means higher fitness and mutants with equal fitness are assigned the lowest rank in the group). The rank difference is defined as the rank in <inline-formula><inline-graphic xlink:href="608874v1_inline77.gif" mime-subtype="gif" mimetype="image"/></inline-formula>minus the rank in <inline-formula><inline-graphic xlink:href="608874v1_inline78.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. (F) Covariation between wild-type and mutant fold-change across all simulated competitions, with mutant strains (grey dots) and wild-type replicates (orange dots). For each wild-type replicate, we simulate a pairwise co-culture competition against the reference wild-type strain. We highlight the mutant with the greatest rank difference (blue halo) in panel E and F, and its corresponding bow-tie area of misranking (compare <xref rid="fig1" ref-type="fig">Fig. 1D</xref>).</p></caption>
<graphic xlink:href="608874v1_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>What features of the population dynamics are responsible for the schism between relative fitness per-cycle and per-generation? We explore this by systematically varying the mutant trait distributions and initial conditions in our simulations (<xref rid="figS7" ref-type="fig">Fig. S7</xref>). This demonstrates that the fitness statistics <inline-formula><inline-graphic xlink:href="608874v1_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula>and <inline-formula><inline-graphic xlink:href="608874v1_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula>disagree on the rank-ing if the mutants have diminished biomass yield and are competed at a high initial frequency (50%) against the wild-type (rows A and D in <xref rid="figS7" ref-type="fig">Fig. S7</xref>). Intuitively, these conditions are necessary because they allow mutants to alter the wild-type LFC. Even though the wild-type growth rate is unaffected by mutants, the wild-type LFC will change in the presence of mutants that have lower yield because they reduce the time to resource depletion (row D in <xref rid="figS7" ref-type="fig">Fig. S7</xref>). A change in wild-type LFC also requires the mutant to be present at high relative abundance initially (row A in <xref rid="figS7" ref-type="fig">Fig. S7</xref>; see Sec. S7 for detailed conditions). By this mechanism, it is possible to concoct a set of growth traits where relative fitness per-generation and per-cycle deliver completely opposite rankings (<xref rid="figS8" ref-type="fig">Fig. S8</xref>).</p>
<p>As a further example, we test how the choice of fitness statistic affects conclusions from the LTEE. We reanalyze competition data from the LTEE [<xref ref-type="bibr" rid="c11">11</xref>] using the relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula>(equivalent to the original definition used in those studies, <inline-formula><inline-graphic xlink:href="608874v1_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula>) and relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula>(Sec. S8). We see that the relative fitness statistics disagree on the rank-ing of some evolved lineages overall (<xref rid="figS9" ref-type="fig">Fig. S9</xref>) and at a given time point (<xref rid="figS10" ref-type="fig">Fig. S10</xref>). We confirm that the long-term fitness trend in the LTEE is the same for <inline-formula><inline-graphic xlink:href="608874v1_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula>and <inline-formula><inline-graphic xlink:href="608874v1_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula>(<xref rid="figS11" ref-type="fig">Fig. S11</xref>), but it is possible to construct hypo-thetical scenarios of evolution where this would not be the case (<xref rid="fig3" ref-type="fig">Fig. 3A-B</xref>). Beyond the qualitative mismatch between these fitness statistics, <inline-formula><inline-graphic xlink:href="608874v1_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula>and <inline-formula><inline-graphic xlink:href="608874v1_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula>can also lead to different conclusions for the presence of epistasis between multiple mutations (<xref rid="fig3" ref-type="fig">Fig. 3C-F</xref>,<xref rid="figS12" ref-type="fig">Fig. S12</xref>). For example, measuring relative fitness per-generation will detect negative magnitude epistasis between a mutation that only affects lag time and a mutation that only affects biomass yield (<xref rid="fig3" ref-type="fig">Fig. 3C</xref>), but measuring relative fitness per-cycle shows no epistasis (<xref rid="fig3" ref-type="fig">Fig. 3D</xref>). This is because mutations that increase biomass yield increase the wild-type LFC and, in this case, decrease the relative fitness per-generation (compare <xref rid="figS12" ref-type="fig">Fig. S12A</xref> and <xref rid="figS12" ref-type="fig">C</xref>). By the same mechanism, relative fitness per-cycle detects epistasis between mutations that affect growth rate and biomass yield (<xref rid="fig3" ref-type="fig">Fig. 3F</xref>), but no such epistasis is present in relative fitness per-generation (<xref rid="fig3" ref-type="fig">Fig. 3E</xref>). This again demonstrates that it is possible to arrive at different biological conclusions from the same experimental data de-pending on the choice of fitness statistic.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Fig. 3.</label>
<caption><title>Potential consequences of the choice of fitness statistic for the interpretation of evolutionary data.</title>
<p>(A) Hypothetical scenario for the trait evolution in a long-term evolution experiment. An evolving population decreases in lag time (orange line), increases in growth rate to a maximum (blue line) and keeps decreasing in biomass yield (green line). This trend is similar to initial observations from the LTEE [<xref ref-type="bibr" rid="c94">94</xref>] (B) Corresponding long-term trend in relative fitness based on the trait evolution in panel A. We estimate relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline79.gif" mime-subtype="gif" mimetype="image"/></inline-formula>(grey line) and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline80.gif" mime-subtype="gif" mimetype="image"/></inline-formula>(red line) every 250 generations. Dotted grey lines mark the end of trait evolution in lag time and growth rate in panel A. For the actual fitness trend in the LTEE, see <xref rid="figS11" ref-type="fig">Fig. S11</xref>. (C) Epistasis plot for lag time and yield using relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline81.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Colored dots show the fitness for a single mutant with shorter lag time (blue dot), a single mutant with higher biomass yield (red dot) and a double mutant with both mutations (purple dot). (D) Epistasis plot for lag time and yield in relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline82.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. (E) Epistasis plot for growth rate and yield in relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline83.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Colored dots show the fitness for a single mutant with higher growth rate (blue dot), a single mutant with higher biomass yield (red dot) and a double mutant with both mutations (purple dot). (F) Epistasis plot for growth rate and yield in relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline84.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. All epistais plots are based on 50:50 competition growth cycles with the wild-type (compare panels C,D and <xref rid="figS12" ref-type="fig">Fig. S12A-C</xref>, compare panels E,F and <xref rid="figS12" ref-type="fig">Fig. S12D-F</xref>).</p></caption>
<graphic xlink:href="608874v1_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2e">
<title>Higher-order effects distort relative fitness measured in bulk competitions</title>
<p>So far we have focused on measuring relative fitness in pairwise competition, but this is usually not practical for large numbers of mutants. Measuring traits of genotypes in monocultures to predict their pairwise relative fitness (Sec. S1) is convenient, but when we test this strategy using our simulation framework we find that most traits perform poorly (Sec. S9, <xref rid="figS13" ref-type="fig">Fig. S13</xref>) (with some success for the AUC, but this success depends on the choice of time scale; <xref rid="figS14" ref-type="fig">Fig. S14</xref>). Another approach to measuring relative fitness is to use bulk competition experiments, where many mutant genotypes compete simultaneously in a single culture and each genotype is tracked through DNA barcode sequencing [<xref ref-type="bibr" rid="c39">39</xref>, <xref ref-type="bibr" rid="c44">44</xref>]. However, this raises the question of how well relative fitness of a mutant in bulk competition corresponds to its relative fitness in a pairwise competition with the wild-type, since the growth in bulk might be influenced by the presence of other mutant genotypes, a phenomenon known as a higher-order interaction [<xref ref-type="bibr" rid="c83">83</xref>–<xref ref-type="bibr" rid="c85">85</xref>].</p>
<p>An important choice in bulk competition experiments is the relative abundance of the library of all mutant genotypes compared to the wild-type. The invasion of a spontaneous mutation into an existing population is best captured by pairwise competitions with low initial relative abundance of the mutant (Case I, <xref rid="fig4" ref-type="fig">Fig. 4A</xref>), and one way to recreate this scenario in a bulk competition is to use a low relative abundance for the mutant library overall (Case II, <xref rid="fig4" ref-type="fig">Fig. 4A</xref>) [<xref ref-type="bibr" rid="c40">40</xref>, <xref ref-type="bibr" rid="c48">48</xref>–<xref ref-type="bibr" rid="c52">52</xref>]. A practical problem with Case II is that individual genotypes in the library will have low absolute abundances, which leads to stochasticity in the population dynamics and the sequencing preparation [<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c86">86</xref>, <xref ref-type="bibr" rid="c87">87</xref>]. Therefore, it is common to compete the mutant library by itself (Case III, <xref rid="fig4" ref-type="fig">Fig. 4A</xref>) [<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c17">17</xref>–<xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c88">88</xref>].</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Fig. 4.</label>
<caption><title>The choice of library abundance and reference group in bulk competition experiments.</title>
<p>(A) Overview of a pairwise competition experiment (upper row) and multiple scenarios for bulk competition experiments (middle and bottom row) with different initial fraction of the mutant library (colored ovals) in the inoculum (open box). For each scenario, we show a schematic growth cycle (log absolute abundance) in the inset on the right. (B) Schematic relative abundance trajectories for a mutant compared to two alternative subpopulations. We distinguish between the total relative abundance <italic>x</italic><sub><italic>i</italic></sub> with respect to the population as a whole (height of green band in the top box) and the pairwise relative abundance <italic>x</italic><sub><italic>i</italic>wt</sub> with respect to the wild-type (height of green band in the bottom box; <xref ref-type="disp-formula" rid="eqn18">Eq. (18)</xref>. We indicate the sign of total relative fitness (<xref ref-type="disp-formula" rid="eqn22">Eq. (22)</xref>) and pairwise relative fitness (<xref ref-type="disp-formula" rid="eqn23">Eq. (23)</xref>) on the right. (C) The absolute error between bulk and pairwise competition experiments. The total relative fitness (grey dots; <xref ref-type="disp-formula" rid="eqn22">Eq. (22)</xref>) and the pairwise relative fitness (red dots; <xref ref-type="disp-formula" rid="eqn23">Eq. (23)</xref>) for empirical knockouts (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>) in bulk competition growth cycle with low mutant library abundance (panel A, case II; Methods). The absolute error is defined as the bulk fitness statistic minus the relative fitness in pairwise competition (<xref ref-type="disp-formula" rid="eqnS81">Eq. (S81)</xref>). In the inset, the absolute error for pairwise relative fitness (<xref ref-type="disp-formula" rid="eqn23">Eq. (23)</xref>) for a bulk competition growth cycle with high mutant library abundance (blue dots; case III). The x-axis and the red dots in the inset are identical to the main plot. (D) The relative error in bulk competition experiments as a function of mutant library abundance in the inoculum. Each line corresponds to a knockout in our dataset, and represents the relative error between the pairwise relative fitness in bulk competition and the relative fitness in pairwise competition (<xref ref-type="disp-formula" rid="eqnS91">Eq. (S91)</xref>). In black lines, we show the recommended mutant library abundance for our dataset based on <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> (<italic>x</italic><sub>lib</sub> ≈ 24.6%) and based on <xref ref-type="disp-formula" rid="eqnS109">Eq. (S109)</xref> (<italic>x</italic><sub>lib</sub> ≈ 0.02%, Sec. S15).</p></caption>
<graphic xlink:href="608874v1_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>A second important choice is whether to quantify fitness of a mutant relative to the whole population (“total relative fitness”; <xref rid="fig4" ref-type="fig">Fig. 4B</xref>, top panel) [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c88">88</xref>] or relative to another specific genotype, like the wild-type (“pairwise relative fitness”; <xref rid="fig4" ref-type="fig">Fig. 4B</xref>, bottom panel; Methods) [<xref ref-type="bibr" rid="c40">40</xref>, <xref ref-type="bibr" rid="c48">48</xref>–<xref ref-type="bibr" rid="c52">52</xref>]. In the case of a mutant library growing by itself (Case III, <xref rid="fig4" ref-type="fig">Fig. 4A</xref>), it is still possible to estimate a pairwise fitness by using known neutral mutants as the reference population [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c17">17</xref>] and calculating fitness relative to this group (Secs. S10 and S11).</p>
<p>To test the consequences of these choices, we simulate a bulk competition (batch culture) using the trait data for yeast single-gene knockouts and compare the es-timates of total and pairwise relative fitness to fitness measured in pairwise competition, which we use as the ground truth (Methods). <xref rid="fig4" ref-type="fig">Figure 4C</xref> shows that the total relative fitness has systematically higher error than the pairwise relative fitness does, since the total fitness measures the genotype relative not just to the wild-type but to all other mutants as well (Sec. S12). For example, a mutant that grows identically to the wild-type (neutral phenotype) has zero increase in the pairwise relative abundance, but may have a net increase in the total relative abundance due to the poor growth of other mutants (compare top and bottom panel in <xref rid="fig4" ref-type="fig">Fig. 4B</xref>). This affects the total relative fitness of all mutants in a uniform way (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>, Sec. S12), such that total and pairwise relative fitness completely agree in the ranking of genotypes (<xref rid="figS15" ref-type="fig">Fig. S15A</xref>).</p>
<p>While the pairwise relative fitness is the preferred method for estimating fitness in bulk competitions, the presence of higher-order interactions means it still deviates from the fitness in pairwise competitions. For the specific population dynamics in our simulation (Methods; Sec. S13,), we decompose the higher-order interaction into two terms, a fitness-independent term and a fitness-dependent term that acts as an amplifier for fitness values (<xref rid="figS16" ref-type="fig">Fig. S16</xref>; Sec. S14). Intuitively, the population in bulk competition consumes resources more slowly and gives more time for growth rate differences to accrue. The higher-order effects were tested by Levy et al. [<xref ref-type="bibr" rid="c13">13</xref>], who compared fitness estimates for ca. 30 beneficial lineages in bulk to the fitness estimates from pairwise competition and found that bulk fitness was typically higher, with some variation from lineage to lineage, consistent with our results here.</p>
<p>Can we reduce these deviations by changing the relative abundance of the mutant library (<xref rid="fig4" ref-type="fig">Fig. 4A</xref>)? When we repeat our simulation using a high mutant library abundance (Case III, <xref rid="fig4" ref-type="fig">Fig. 4A</xref>), we find that the absolute error for pairwise relative fitness increases proportionally (inset in <xref rid="fig4" ref-type="fig">Fig. 4C</xref>). Clearly, minimizing the abundance of the mutant library minimizes the strength of higher-order interactions (also reducing ranking disagreement (<xref rid="figS15" ref-type="fig">Fig. S15B,C</xref>).</p>
<p>As low mutant abundances create practical problems for experiments, it is valuable to identify a maximum abundance for the mutant library that keeps the error from bulk fitness estimates below a desired threshold. It is convenient to express this threshold in relative rather than absolute terms (compare <xref rid="figS17" ref-type="fig">Fig. S17</xref> to <xref rid="fig4" ref-type="fig">Fig. 4C</xref>). <xref rid="fig4" ref-type="fig">Figure 4D</xref> shows the relative error from higher-order interactions across a range of mutant library abundances and using the specific population dynamics of our model, we derive the following rule: Assuming that the mutants in the library only have variation in growth rate, the mutant library abundance should be below
<disp-formula id="eqn10">
<graphic xlink:href="608874v1_eqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>ϵ</italic> is the desired threshold on the relative error, <italic>g</italic><sub>wt</sub> is the wild-type growth rate, and g<sub>lib</sub> is the growth rate of the library as a whole (Sec. S15). In the case of our single-gene knockout library, <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> predicts a maximum library abundance of 24.6% based on the wild-type and library growth rate (<italic>g</italic><sub>wt</sub> = 0.406, <italic>g</italic><sub>lib</sub> = 0.389) for a relative error <italic>ϵ</italic> = 1%. <xref rid="fig4" ref-type="fig">Figure 4D</xref> shows that this maximum library abundance keeps the relative error below 1% for high-fitness mutants (bright yellow), because they are dominated by growth rate effects, but fails for mutants close to neutrality because they have a trade-off between growth rate and lag time, which the estimate in <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> neglects. It is possible to derive a more precise bound that keeps the relative error below 1% for all mutant genotypes (here: <italic>x</italic><sub>lib</sub> = 0.02%, see vertical line in <xref rid="fig4" ref-type="fig">Fig. 4D</xref>), but this requires prior knowledge of the trait covariation in the mutant library (Sec. S15).</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<sec id="s3a">
<title>Best practices for quantifying mutant fitness in high-throughput experiments</title>
<p>In this work, we have introduced a conceptual framework (summarized in <xref rid="fig5" ref-type="fig">Fig. 5</xref>) to derive common statistics of relative fitness from three essential choices:</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Fig. 5.</label>
<caption><title>Flow-diagram for the quantification of relative fitness from time-series data.</title>
<p>Given the relative abundance of the mutant genotype at two consecutive timepoints (e.g. the start and end of a growth cycle), the user has to choose an encoding (<xref rid="fig1" ref-type="fig">Fig. 1A-B</xref>) and the time-scale for evaluating the change in relative abundance (<xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>). In bulk competition experiments, multiple definitions of relative abundance are possible depending on the choice of the reference subpopulation (compare <xref rid="fig4" ref-type="fig">Fig. 4B</xref>; Methods). Each combination of these choices (dashed black lines) leads to a different fitness statistic and we summarize our recommendations (thick black line) in the discussion.</p></caption>
<graphic xlink:href="608874v1_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<list list-type="order">
<list-item><p>The choice of the state variable for relative abundance (encoding m; <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> and <xref rid="fig1" ref-type="fig">Fig. 1B</xref>).</p></list-item>
<list-item><p>The choice of the time scale for the change in relative abundance (Δ<italic>t</italic>; <xref ref-type="disp-formula" rid="eqn5">Eq. (5)</xref>).</p></list-item>
<list-item><p>In bulk competition experiments, the choice of sub-population that acts as the reference for relative abundance of a chosen mutant genotype (<xref rid="fig4" ref-type="fig">Fig. 4B</xref>).</p></list-item>
</list>
<p>The combination of these choices leads to a range of fitness statistics, including those commonly used in population genetics, experimental evolution, and transposon-insertion screens (<xref rid="fig5" ref-type="fig">Fig. 5</xref>). However, as we compare these statistics in simulated competition experiments, we find that the choice of time scale can lead to different mutant rankings (<xref rid="fig2" ref-type="fig">Figs. 2D</xref> and <xref rid="fig2" ref-type="fig">2E</xref>) and the choice of the reference subpopulation can lead to a systematic offset in fitness values (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>). Based on these insights, we recommend the following choices for quantifying relative fitness of a mutant:</p>
<list list-type="order">
<list-item><p>Use the logit encoding of relative abundance, because under the null model of logistic dynamics this linearizes the trajectory of relative abundance and regularizes measurement noise (<xref rid="figS3" ref-type="fig">Fig. S3</xref>).</p></list-item>
<list-item><p>Use a fixed extrinsic time scale (e.g., a single growth cycle), rather than an intrinsic time scale (e.g., the number of generations) which introduces an additional factor of variation between competitions.</p></list-item>
<list-item><p>In bulk competition experiments, use the pairwise fitness of the mutant relative to the wild-type reference subpopulation (either by including a barcoded wild-type or by grouping neutral mutants into a virtual wild-type) because this more closely matches the relative fitness in pairwise competition.</p></list-item>
<list-item><p>Since relative fitness measurements in bulk competitions inevitably carry an error from higher-order interactions, we recommend minimizing relative abundance of the mutant library as practically feasible (<xref rid="fig4" ref-type="fig">Fig. 4D</xref>). For a given error tolerance, <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> gives an estimate for the maximum library abundance.</p></list-item>
</list>
<p>If measuring direct competition is not feasible, we empirically find that the area under the growth curve (AUC) is the best approximation of the true fitness ranking (<xref rid="figS13" ref-type="fig">Fig. S13</xref>) but one must carefully choose the time scale (<xref rid="figS14" ref-type="fig">Fig. S14</xref>). Our recommendations agree with previous criticisms of relative fitness per-generation [<xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c78">78</xref>] and total relative fitness [<xref ref-type="bibr" rid="c60">60</xref>, <xref ref-type="bibr" rid="c89">89</xref>] but differ from the standard practice in high-throughput genetic screens [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c88">88</xref>] and many evolution experiments [<xref ref-type="bibr" rid="c33">33</xref>, <xref ref-type="bibr" rid="c75">75</xref>], including the LTEE [<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c26">26</xref>]. The choice of the reference group is a well recognized issue in high-throughput evolutionary studies, in which one first estimates a total relative fitness and then subtracts a correction based on the fitness of the wild-type [<xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c50">50</xref>, <xref ref-type="bibr" rid="c52">52</xref>] or a mean population fitness [<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c51">51</xref>, <xref ref-type="bibr" rid="c89">89</xref>]. In contrast, we recommend to choose the reference group at the level of relative abundance (<xref rid="fig4" ref-type="fig">Fig. 4B</xref>; <xref ref-type="disp-formula" rid="eqn18">Eq. (18)</xref>)</p>
</sec>
<sec id="s3b">
<title>Consequences of fitness quantification choices for microbial ecology and evolution</title>
<p>The quantitative differences between relative fitness statistics affects our ability to make evolutionary predictions. In particular, the fixation probability of a spontaneous mutation depends on the magnitude of relative fitness compared to other timescales like mutation and drift [<xref ref-type="bibr" rid="c57">57</xref>, <xref ref-type="bibr" rid="c58">58</xref>], and in microbial populations with clonal interference, it depends on the entire distribution of fitness effects [<xref ref-type="bibr" rid="c59">59</xref>, <xref ref-type="bibr" rid="c90">90</xref>]. For example, multiplying the mutation rate with an incompatible measure of fitness would lead to predicting the wrong speed of adaptation. In the context of multiple mutations in the same cell, different fitness statistics can lead to different conclusions about the presence of magnitude epistasis (<xref rid="fig3" ref-type="fig">Fig. 3C-F</xref>), and in the context of gene essentiality tests, they may affect the outcome of a significance test (e.g., using log or logit with the test statistic in Ref. [<xref ref-type="bibr" rid="c18">18</xref>]).</p>
<p>Using different fitness statistics can even lead to differences in mutant rankings (see <xref rid="figS8" ref-type="fig">Fig. S8</xref> for an extreme case). Since measurements often serve as a first screen to narrow down the investigation to the top set of genes [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c40">40</xref>], a difference in mutant ranking means the investigation might miss out on relevant genes because of the choice of fitness statistic.</p>
</sec>
<sec id="s3c">
<title>Other sources of discrepancy in quantifying mutant fitness</title>
<p>Besides the conceptual choices of fitness quantification discussed in this article, experimental limitations can create discrepancies between replicate fitness measurements of the same mutant [<xref ref-type="bibr" rid="c36">36</xref>, <xref ref-type="bibr" rid="c50">50</xref>, <xref ref-type="bibr" rid="c91">91</xref>]. For example, relative abundance measurements entail sampling uncertainties (when we sample liquid for colony counting or DNA sequencing) [<xref ref-type="bibr" rid="c44">44</xref>, <xref ref-type="bibr" rid="c60">60</xref>, <xref ref-type="bibr" rid="c61">61</xref>], copy number variation [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c44">44</xref>] as well as PCR jackpots and sequencing read errors [<xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c86">86</xref>, <xref ref-type="bibr" rid="c87">87</xref>]. Furthermore, there will inevitably be some variation in initial condition between replicates and fluctuations during the fitness assay [<xref ref-type="bibr" rid="c36">36</xref>, <xref ref-type="bibr" rid="c87">87</xref>, <xref ref-type="bibr" rid="c91">91</xref>]. On one hand, the conceptual choices for quantifying fitness can mitigate experimental uncertainty. For example, the logit encoding normalizes the sampling errors over the time series of relative abundance (<xref rid="figS3" ref-type="fig">Fig. S3B</xref>). On the other hand, there is sometimes a trade-off between conceptual choices and experimental precision, such as the choice of the initial mutant library abundance, which needs to be low to minimize higher-order interactions and yet high enough to minimize sampling uncertainty [<xref ref-type="bibr" rid="c44">44</xref>]. Future work will need to elucidate the interplay between conceptual and experimental sources of discrepancy in fitness measurements.</p>
</sec>
<sec id="s3d">
<title>How general is the disagreement between fitness statistics?</title>
<p>The discrepancy between relative fitness per-cycle and per-generation (<xref rid="fig1" ref-type="fig">Figs. 1D</xref> and <xref rid="fig2" ref-type="fig">2E</xref>), as well as the offset in the total relative fitness compared to pairwise fitness (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>) will hold under any form of population dynamics. However, the details of the population dynamics do matter for the higher-order interactions that cause the discrepancy between relative fitness from bulk and pairwise competitions (<xref rid="fig4" ref-type="fig">Fig. 4D</xref>). The empirical evidence for the presence and mechanisms of higher-order interactions in microbial populations is limited [<xref ref-type="bibr" rid="c83">83</xref>–<xref ref-type="bibr" rid="c85">85</xref>]. Nevertheless, the fact that we see the fact that we see higher-order interactions even under competition for a single resource suggests that these effects will be present under more complex dynamics. Indeed, a comparison of mutant fitness measurements found systematic overestimates for fitness from bulk compared to pairwise competitions [<xref ref-type="bibr" rid="c13">13</xref>]. Since this could not be explained by the offset from using total relative fitness, it is indicative of higher-order interactions. Future work should provide more comparisons between relative fitness from bulk and pairwise competitions to better understand higher-order interactions.</p>
</sec>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Inferring growth traits for the single-gene knockout collection in Yeast</title>
<p>We use a previously published dataset [<xref ref-type="bibr" rid="c29">29</xref>] for the single-gene knockout collection in <italic>Saccharomyces cerevisiae</italic> [<xref ref-type="bibr" rid="c81">81</xref>], where the authors track growth of each genotype for 47 hours in monoculture, using microwell plates with defined growth medium. We download this growth curve dataset from the PROPHECY database [<xref ref-type="bibr" rid="c92">92</xref>], choosing specifically the dataset measured in Synthetic Defined medium. We last accessed the PROPHECY website (<ext-link ext-link-type="uri" xlink:href="http://prophecy.lundberg.gu.se/">http://prophecy.lundberg.gu.se/</ext-link>) in March 30, 2020, but as of May 30, 2024, the website no longer seems accessible and included a reformatted version of the data with our code repository (<ext-link ext-link-type="uri" xlink:href="https://github.com/justuswfink/24FitnessQuantification">https://github.com/justuswfink/24FitnessQuantification</ext-link>). From the raw timeseries of optical density, the authors subtracted a background correction based on blank wells, applied another correction for nonlinearity at high optical densities and smoothed the growth curve to remove electrical noise [<xref ref-type="bibr" rid="c29">29</xref>].</p>
<p>We start with the curves in the published dataset (9951 curves) and apply further trimming and smoothing steps (Sec. S6). From this data we calculate the time series of instantaneous per-capita growth rate <italic>N</italic> <sup>−1</sup><italic>dN</italic>/<italic>dt</italic> (where <italic>N</italic> is the optical density) and identify time windows where the rate is approximately constant, which we interpret as distinct growth phases (Sec. S6). We only include curves that have a single phase of constant exponential growth followed by a stationary phase of approximately zero growth (9424 curves).</p>
<p>We quantify the biomass yield, maximum growth rate, and the lag time from each remaining curve as follows. First, we estimate the initial abundance <italic>N</italic><sub>initial</sub> (average optical density over first three time points) and the final abundance <italic>N</italic><sub>final</sub> (average optical density over stationary phase) from the growth curve. Then we calculate the biomass yield as <italic>Y</italic> = (<italic>N</italic><sub>final</sub> − <italic>N</italic><sub>initial</sub>)/<italic>R</italic>(0), where <italic>R</italic>(0) = 111 mM (20 g/L) is the initial concentration of glucose (assuming glucose is the single limiting resource). To estimate the maximum growth rate, we average the instantaneous growth rate over the exponential phase. Finally, we estimate the lag time from the intersection of the log initial abundance (log <italic>N</italic><sub>0</sub>) with the slope of the maximum growth rate during the exponential growth phase [<xref ref-type="bibr" rid="c93">93</xref>]. We excluded curves with negative initial OD, curves with negative inferred lag times, and curves with a low quality of fit between the measured time series and a simulated curve based on the inferred trait values (<italic>R</italic><sup>2</sup> &lt; 0.95; see below for the model). Our final database includes trait estimates for 9195 curves, which represents 92.4% of the original dataset [<xref ref-type="bibr" rid="c29">29</xref>].</p>
<p>Each single-gene deletion strain was measured in two technical replicate growth curves, using a second plate with identical layout in the same plate reader. Some genotypes have only one estimate of the growth traits because the other replicate did not pass our filters (273 genotypes), but for most genotypes we retain two replicate estimates in our final dataset (4163 genotypes); a few genotypes even have three (2 genotypes) or four replicate estimates (54 genotypes) because these genotypes were included multiple times by the original authors [<xref ref-type="bibr" rid="c29">29</xref>]. From these replicates we finally calculate the average yield, growth rate, and lag time for each geno-type. The dataset also contained many replicate growth curves of the wild-type strain, 374 of which passed our filters. Since wild-type traits inferred from these replicates had large variation (potentially due to measuring the wild-type across many different plates and days), we define the wild-type trait as the median, not the mean. Although the wild-type measurements included in this dataset have large trait variation (orange dots in <xref rid="fig2" ref-type="fig">Fig. 2B,C</xref>), the fact that the variation across knockouts is significantly greater for growth rate (Levene’s test <italic>p</italic> = 1.3 × 10<sup>−9</sup>) and lag time (Levene’s test <italic>p</italic> = 0.025) and that the replicate measurements of gene knockouts are correlated (<xref rid="figS5" ref-type="fig">Fig. S5</xref>) suggests that these trait measurements do capture true genetic variation. In contrast, the variation in biomass yield across knockouts is not significantly different from the variation across wild-type replicates (Levene’s test <italic>p</italic> = 0.44), suggesting that the variation in biomass yield is driven by non-genetic factors like the abundance or batch of resources used for each growth measurement.</p>
</sec>
<sec id="s4b">
<title>Simulating population dynamics in competition experiments</title>
<p>Throughout this work, we model the competition between a set of genotypes during a single batch culture growth cycle using the following model of population dynamics [<xref ref-type="bibr" rid="c82">82</xref>, <xref ref-type="bibr" rid="c83">83</xref>]:
<disp-formula id="eqn11a">
<graphic xlink:href="608874v1_eqn11a.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn11b">
<graphic xlink:href="608874v1_eqn11b.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>N</italic><sub><italic>j</italic></sub> is the absolute abundance, <italic>x</italic><sub><italic>j</italic></sub>(0) the initial relative abundance, <italic>g</italic><sub><italic>j</italic></sub>(<italic>t, R</italic>) the growth rate, and <italic>Y</italic><sub><italic>j</italic></sub> the biomass yield of genotype <italic>j</italic>, where the genotypes include a wild-type as well as one or more mutants. The initial absolute abundance of all genotypes together is <italic>N</italic><sub>0</sub>, and the concentration of the single limiting resource is <italic>R</italic> with initial value <italic>R</italic><sub>0</sub>. Note that Eq. (11b) assumes that cells consume resources only for biomass growth and not for maintenance of existing biomass.</p>
<p>To capture the sigmoidal shape of typical growth curves with a lag phase, exponential growth phase, and saturation phase (e.g., <xref rid="fig2" ref-type="fig">Fig. 2A</xref>), we model the dependence of growth rate on time and resource concentration as
<disp-formula id="eqn12">
<graphic xlink:href="608874v1_eqn12.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where Θ is the step function:
<disp-formula id="eqn13">
<graphic xlink:href="608874v1_eqn13.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>In this model, a genotype has an initial lag phase of time λ<sub><italic>j</italic></sub> where no growth occurs, followed by a phase of constant exponential growth at rate <italic>g</italic><sub><italic>j</italic></sub>, and ending when the resource concentration <italic>R</italic> reaches zero. The time to resource depletion, which we also call the saturation time, is defined by the implicit equation <italic>R</italic>(<italic>t</italic><sub>sat</sub>) = 0. The simple form of the growth response (<xref ref-type="disp-formula" rid="eqn12">Eq. (12)</xref>) means that the absolute abundance of genotype <italic>j</italic> at saturation is
<disp-formula id="eqn14">
<graphic xlink:href="608874v1_eqn14.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
and its log fold-change is
<disp-formula id="eqn15">
<graphic xlink:href="608874v1_eqn15.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>To calculate relative fitness per-generation (<xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref>) or per-cycle (<xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref> with Δ<italic>t</italic> = 1), we numerically determine the saturation time <italic>t</italic><sub>sat</sub> by integrating the biomass and resource dynamics (<xref ref-type="disp-formula" rid="eqn11a">Eq. (11)</xref>) as described in previous work [<xref ref-type="bibr" rid="c82">82</xref>, <xref ref-type="bibr" rid="c83">83</xref>]. We note that it also possible to derive an approximate expression for the saturation time <italic>t</italic><sub>sat</sub> which we use for our theoretical calculations (Sec. S7).</p>
</sec>
<sec id="s4c">
<title>Testing total and pairwise relative fitness in bulk competition experiments</title>
<p>We explore total and pairwise relative fitness as two alternative measures of fitness in bulk competition experiments, and defined as follows. Consider a population with multiple genotypes such that each genotype i has absolute abundance <italic>N</italic><sub><italic>i</italic></sub>(<italic>t</italic>) at time <italic>t</italic>. The <italic>total relative abundance</italic> of the genotype is
<disp-formula id="eqn16">
<graphic xlink:href="608874v1_eqn16.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The “total” here refers to the fact that this is the abundance of genotype <italic>i</italic> relative to all other genotypes in the population. Similarly, we can think of the definition of relative fitness discussed in the main text (<xref ref-type="disp-formula" rid="eqn3">Eq. 3</xref>) as the <italic>total relative fitness</italic> of this genotype under an encoding <italic>m</italic>:
<disp-formula id="eqn17">
<graphic xlink:href="608874v1_eqn17.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>However, sometimes we want to track the dynamics of a genotype relative to another specific genotype; for example, to follow the fate of a mutant against the wild-type in a bulk competition experiment. For a pair of genotypes <italic>i</italic> ≠ <italic>j</italic>, we thus define the <italic>pairwise relative abundance</italic>
<disp-formula id="eqn18">
<graphic xlink:href="608874v1_eqn18.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
which is the relative abundance of genotype <italic>i</italic> in a subpopulation of genotype <italic>i</italic> and <italic>j</italic>. To predict the change in the pairwise relative abundance, we can use the slope
<disp-formula id="eqn19">
<graphic xlink:href="608874v1_eqn19.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
which defines the <italic>pairwise relative fitness</italic> of genotype <italic>i</italic> with respect to genotype <italic>j</italic>. In the special case of a population with only two strains, the pairwise relative fitness and total relative fitness are identical <inline-formula><inline-graphic xlink:href="608874v1_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula>but they may differ with more than two genotypes (Sec. S12).</p>
<p>It is also possible to define the total and pairwise relative fitness statistics as finite differences over a time interval, rather than as instantaneous derivatives. For example, we can define them over a growth cycle starting at <italic>t</italic> = 0 and ending at <italic>t</italic> = <italic>t</italic><sub>sat</sub>:
<disp-formula id="eqn20">
<graphic xlink:href="608874v1_eqn20.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn21">
<graphic xlink:href="608874v1_eqn21.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>For these fitness statistics in the bulk competitions, we use the logit encoding
<disp-formula id="eqn22">
<graphic xlink:href="608874v1_eqn22.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn23">
<graphic xlink:href="608874v1_eqn23.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where we have rewritten <inline-formula><inline-graphic xlink:href="608874v1_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>in the form that it is pre-sented in bulk competition experiments [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c51">51</xref>, <xref ref-type="bibr" rid="c52">52</xref>]. The logit encoding has mathematical advantages for coarse-graining the relative fitness of genotype groups (Sec. S10) but using the log encoding is another common choice in the literature [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c50">50</xref>]. However, the relative abundances of the individual mutants in our simulated bulk competition experiments are low enough that these two encodings are approximately equivalent (logit <italic>x</italic> ≈ log <italic>x</italic> for <italic>x</italic> ≪1).</p>
<p>Unlike the comparison between per-cycle and per-generation relative fitness where we focused on rank differences (<xref rid="fig2" ref-type="fig">Fig. 2E</xref>), here we can evaluate absolute differences in fitness estimates because the total and pairwise fitness in bulk fitness are measured in the same units as the relative fitness in pairwise competition. For all mutant genotypes, we calculate the absolute error between these bulk fitness estimates (<xref ref-type="disp-formula" rid="eqn22">Eq. (22)</xref>,(23)) and the rel-ative fitness in pairwise competitions (<xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref>), which we take as the ground truth (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>). Note that the pairwise competition could depend on the initial relative abundance of the mutant; we have chosen a very low rel-ative abundance (10<sup>−6</sup>) that mimics a mutant arising de novo and where this dependence is very weak.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>JWF wishes to thank Luis-Miguel Chevin, Olivier Tenaillon, Henrique Teotónio and the participants of the 2021 ENS autumn course on Experimental Evolution for valuable discussions early on. Both authors are grateful to Benjamin Raach and Gatwa Tshinsele-Van Bellingen for a critical reading of the manuscript. JWF and MM were supported by an Ambizione grant from the Swiss National Science Foundation (PZ00P3 180147).</p>
</ack>
<ref-list>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>John H.</given-names> <surname>Gillespie</surname></string-name></person-group>. <source>Population Genetics: A Concise Guide</source>. <publisher-name>JHU Press</publisher-name>, <year>2004</year>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. C.</given-names> <surname>Stearns</surname></string-name></person-group>. <article-title>Trade-Offs in Life-History Evolution</article-title>. <source>Functional Ecology</source>, <volume>3</volume>(<issue>3</issue>):<fpage>259</fpage>–<lpage>268</lpage>, <year>1989</year>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>G.</given-names> <surname>De Jong</surname></string-name></person-group>. <article-title>The Fitness of Fitness Concepts and the Description of Natural Selection</article-title>. <source>The Quarterly Review of Biology</source>, <volume>69</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>29</lpage>, <year>1994</year>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>André</given-names> <surname>Ariew</surname></string-name> and <string-name><given-names>R. C.</given-names> <surname>Lewontin</surname></string-name></person-group>. <article-title>The Confusions of Fitness</article-title>. <source>The British Journal for the Philosophy of Science</source>, <volume>55</volume>(<issue>2</issue>):<fpage>347</fpage>–<lpage>363</lpage>, <year>2004</year>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Hanna</given-names> <surname>Kokko</surname></string-name></person-group>. <article-title>The stagnation paradox: the ever-improving but (more or less) stationary population fitness</article-title>. <source>Proceedings of the Royal Society B: Biological Sciences</source>, <volume>288</volume>(<issue>1963</issue>):<fpage>20212145</fpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Daniel Jefferson</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>Guilhem</given-names> <surname>Doulcier</surname></string-name>, <string-name><given-names>Pierrick</given-names> <surname>Bourrat</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Why there are so many definitions of fitness in models</article-title>. <source>EcoEvoRxiv</source>, <pub-id pub-id-type="doi">10.32942/X2V61T</pub-id>, <year>2024</year>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Chevin</given-names> <surname>Luis-Miguel</surname></string-name></person-group>. <article-title>On measuring selection in experimental evolution</article-title>. <source>Biology Letters</source>, <volume>7</volume>(<issue>2</issue>):<fpage>210</fpage>–<lpage>213</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>David</given-names> <surname>Houle</surname></string-name>, <string-name><given-names>Christophe</given-names> <surname>Pélabon</surname></string-name>, <string-name><given-names>Günter P.</given-names> <surname>Wagner</surname></string-name>, and <string-name><given-names>Thomas F.</given-names> <surname>Hansen</surname></string-name></person-group>. <article-title>Measurement and Meaning in Biology</article-title>. <source>The Quarterly Review of Biology</source>, <volume>86</volume>(<issue>1</issue>):<fpage>3</fpage>–<lpage>34</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Günter P.</given-names> <surname>Wagner</surname></string-name></person-group>. <article-title>The Measurement Theory of Fitness</article-title>. <source>Evolution</source>, <volume>64</volume>(<issue>5</issue>):<fpage>1358</fpage>–<lpage>1376</lpage>, <year>2010</year>.</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Charlotte E.</given-names> <surname>Paquin</surname></string-name> and <string-name><given-names>Julian</given-names> <surname>Adams</surname></string-name></person-group>. <article-title>Relative fitness can decrease in evolving asexual populations of S. cerevisiae</article-title>. <source>Nature</source>, <volume>306</volume>(<issue>5941</issue>):<fpage>368</fpage>–<lpage>371</lpage>, <year>1983</year>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. J.</given-names> <surname>Wiser</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Ribeck</surname></string-name>, and <string-name><given-names>R. E.</given-names> <surname>Lenski</surname></string-name></person-group>. <article-title>Long-Term Dynamics of Adaptation in Asexual Populations</article-title>. <source>Science</source>, <volume>342</volume>(<issue>6164</issue>):<fpage>1364</fpage>–<lpage>1367</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sergey</given-names> <surname>Kryazhimskiy</surname></string-name>, <string-name><given-names>Daniel P.</given-names> <surname>Rice</surname></string-name>, <string-name><given-names>Elizabeth R.</given-names> <surname>Jerison</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name></person-group>. <article-title>Global epistasis makes adaptation predictable despite sequence-level stochasticity</article-title>. <source>Science</source>, <volume>344</volume>(<issue>6191</issue>):<fpage>1519</fpage>–<lpage>1522</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sasha F.</given-names> <surname>Levy</surname></string-name>, <string-name><given-names>Jamie R.</given-names> <surname>Blundell</surname></string-name>, <string-name><given-names>Sandeep</given-names> <surname>Venkataram</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Quantitative evolutionary dynamics using high-resolution lineage tracking</article-title>. <source>Nature</source>, <volume>519</volume>(<issue>7542</issue>):<fpage>181</fpage>–<lpage>186</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Alex N. Nguyen</given-names> <surname>Ba</surname></string-name>, <string-name><given-names>Ivana</given-names> <surname>Cvijović</surname></string-name>, <string-name><given-names>José I. Rojas</given-names> <surname>Echenique</surname></string-name>, <etal>et al.</etal></person-group> <article-title>High-resolution lineage tracking reveals travelling wave of adaptation in laboratory yeast</article-title>. <source>Nature</source>, <volume>575</volume>(<issue>7783</issue>):<fpage>494</fpage>–<lpage>499</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Alejandro</given-names> <surname>Couce</surname></string-name>, <string-name><given-names>Anurag</given-names> <surname>Limdi</surname></string-name>, <string-name><given-names>Melanie</given-names> <surname>Magnan</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Changing fitness effects of mutations through long-term bacterial evolution</article-title>. <source>Science</source>, <volume>383</volume>(<issue>6681</issue>):<fpage>eadd1417</fpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jeremy E.</given-names> <surname>Schreier</surname></string-name>, <string-name><given-names>Christa B.</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>Thomas R.</given-names> <surname>Ioerger</surname></string-name>, and <string-name><given-names>Mary Ann</given-names> <surname>Moran</surname></string-name></person-group>. <article-title>A mutant fitness assay identifies bacterial interactions in a model ocean hot spot</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>120</volume>(<issue>12</issue>):<fpage>e2217200120</fpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Emily C.</given-names> <surname>Pierce</surname></string-name>, <string-name><given-names>Manon</given-names> <surname>Morin</surname></string-name>, <string-name><given-names>Jessica C.</given-names> <surname>Little</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Bacterial–fungal interactions revealed by genome-wide analysis of bacterial mutant fitness</article-title>. <source>Nat Microbiol</source>, <volume>6</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>102</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Kelly M.</given-names> <surname>Wetmore</surname></string-name>, <string-name><given-names>Morgan N.</given-names> <surname>Price</surname></string-name>, <string-name><given-names>Robert J.</given-names> <surname>Waters</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Rapid Quantification of Mutant Fitness in Diverse Bacteria by Sequencing Randomly Bar-Coded Transposons</article-title>. <source>mBio</source>, <volume>6</volume>(<issue>3</issue>):<fpage>e00306</fpage>–<lpage>15</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Morgan N.</given-names> <surname>Price</surname></string-name>, <string-name><given-names>Kelly M.</given-names> <surname>Wetmore</surname></string-name>, <string-name><given-names>R. Jordan</given-names> <surname>Waters</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Mutant phenotypes for thousands of bacterial genes of unknown function</article-title>. <source>Nature</source>, <volume>557</volume>(<issue>7706</issue>):<fpage>503</fpage>–<lpage>509</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Dan I</given-names> <surname>Andersson</surname></string-name></person-group>. <article-title>The biological cost of mutational antibiotic resistance: any practical conclusions?</article-title> <source>Current Opinion in Microbiology</source>, <volume>9</volume>(<issue>5</issue>):<fpage>461</fpage>–<lpage>465</lpage>, <year>2006</year>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Alvaro San</given-names> <surname>Millan</surname></string-name> and <string-name><given-names>R. Craig</given-names> <surname>MacLean</surname></string-name></person-group>. <article-title>Fitness Costs of Plasmids: a Limit to Plasmid Transmission</article-title>. <source>Microbiology Spectrum</source>, <volume>5</volume>(<issue>5</issue>):<fpage>5</fpage>.5.02, <year>2017</year>.</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Santiago F.</given-names> <surname>Elena</surname></string-name>, <string-name><given-names>Lynette</given-names> <surname>Ekunwe</surname></string-name>, <string-name><given-names>Neerja</given-names> <surname>Hajela</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Distribution of fitness effects caused by random insertion mutations in Escherichia coli</article-title>. <source>Genetica</source>, <volume>102</volume>(<issue>0</issue>):<fpage>349</fpage>, <year>1998</year>.</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Clifford</given-names> <surname>Zeyl</surname></string-name> and <string-name><given-names>J</given-names> <surname>Arjan</surname></string-name> <string-name><given-names>G M</given-names> <surname>DeVisser</surname></string-name></person-group>. <article-title>Estimates of the Rate and Distribution of Fitness Effects of Spontaneous Mutation in Saccharomyces cerevisiae</article-title>. <source>Genetics</source>, <volume>157</volume>(<issue>1</issue>):<fpage>53</fpage>–<lpage>61</lpage>, <year>2001</year>.</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Isabel</given-names> <surname>Gordo</surname></string-name>, <string-name><given-names>Lilia</given-names> <surname>Perfeito</surname></string-name>, and <string-name><given-names>Ana</given-names> <surname>Sousa</surname></string-name></person-group>. <article-title>Fitness Effects of Mutations in Bacteria</article-title>. <source>Journal of Molecular Microbiology and Biotechnology</source>, <volume>21</volume>(<issue>1-2</issue>):<fpage>20</fpage>–<lpage>35</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Daniel E.</given-names> <surname>Dykhuizen</surname></string-name></person-group>. <article-title>Experimental Studies of Natural Selection in Bacteria</article-title>. <source>Annual Review of Ecology and Systematics</source>, <volume>21</volume>(<issue>1</issue>):<fpage>373</fpage>–<lpage>398</lpage>, <year>1990</year>.</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Richard E.</given-names> <surname>Lenski</surname></string-name>, <string-name><given-names>Michael R.</given-names> <surname>Rose</surname></string-name>, <string-name><given-names>Suzanne C.</given-names> <surname>Simpson</surname></string-name>, and <string-name><given-names>Scott C.</given-names> <surname>Tadler</surname></string-name></person-group>. <article-title>Long-Term Experimental Evolution in Escherichia coli. I. Adaptation and Divergence During 2,000 Generations</article-title>. <source>The American Naturalist</source>, <volume>138</volume>(<issue>6</issue>):<fpage>1315</fpage>–<lpage>1341</lpage>, <year>1991</year>.</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Andrew J</given-names> <surname>Spiers</surname></string-name>, <string-name><given-names>Sophie G</given-names> <surname>Kahn</surname></string-name>, <string-name><given-names>John</given-names> <surname>Bohannon</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Adaptive Divergence in Experimental Populations of Pseudomonas fluorescens. I. Genetic and Phenotypic Bases of Wrinkly Spreader Fitness</article-title>. <source>Genetics</source>, <volume>161</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>46</lpage>, <year>2002</year>.</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jeffrey E.</given-names> <surname>Barrick</surname></string-name>, <string-name><given-names>Zachary D.</given-names> <surname>Blount</surname></string-name>, <string-name><given-names>Devin M.</given-names> <surname>Lake</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Daily Transfers, Archiving Populations, and Measuring Fitness in the Long-Term Evolution Experiment with Escherichia coli</article-title>. <source>JoVE (Journal of Visualized Experiments)</source>, (<volume>198</volume>):<fpage>e65342</fpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jonas</given-names> <surname>Warringer</surname></string-name>, <string-name><given-names>Elke</given-names> <surname>Ericson</surname></string-name>, <string-name><given-names>Luciano</given-names> <surname>Fernandez</surname></string-name>, <etal>et al.</etal></person-group> <article-title>High-resolution yeast phenomics resolves different physiological features in the saline response</article-title>. <source>PNAS</source>, <volume>100</volume>(<issue>26</issue>):<fpage>15724</fpage>–<lpage>15729</lpage>, <year>2003</year>.</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Guillaume</given-names> <surname>Chevereau</surname></string-name>, <string-name><given-names>Marta</given-names> <surname>Dravecká</surname></string-name>, <string-name><given-names>Tugce</given-names> <surname>Batur</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Quantifying the Determinants of Evolutionary Dynamics Leading to Drug Resistance</article-title>. <source>PLOS Biology</source>, <volume>13</volume>(<issue>11</issue>):<fpage>e1002299</fpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Manuel</given-names> <surname>Campos</surname></string-name>, <string-name><given-names>Sander K</given-names> <surname>Govers</surname></string-name>, <string-name><given-names>Irnov</given-names> <surname>Irnov</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Genomewide phenotypic analysis of growth, cell morphogenesis, and cell cycle events in Escherichia coli</article-title>. <source>Molecular Systems Biology</source>, <volume>14</volume>(<issue>6</issue>):<fpage>e7573</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jeniffer</given-names> <surname>Concepción-Acevedo</surname></string-name>, <string-name><given-names>Howard N.</given-names> <surname>Weiss</surname></string-name>, <string-name><given-names>Waqas Nasir</given-names> <surname>Chaudhry</surname></string-name>, and <string-name><given-names>Bruce R.</given-names> <surname>Levin</surname></string-name></person-group>. <article-title>Malthusian Parameters as Estimators of the Fitness of Microbes: A Cautionary Tale about the Low Side of High Throughput</article-title>. <source>PLOS One</source>, <volume>10</volume>(<issue>6</issue>):<fpage>e0126915</fpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Paulo</given-names> <surname>Durão</surname></string-name>, <string-name><given-names>Massimo</given-names> <surname>Amicone</surname></string-name>, <string-name><given-names>Lília</given-names> <surname>Perfeito</surname></string-name>, and <string-name><given-names>Isabel</given-names> <surname>Gordo</surname></string-name></person-group>. <article-title>Competition dynamics in long-term propagations of Schizosaccharomyces pombe strain communities</article-title>. <source>Ecology and Evolution</source>, <volume>11</volume>(<issue>21</issue>):<fpage>15085</fpage>–<lpage>15097</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Yoav</given-names> <surname>Ram</surname></string-name>, <string-name><given-names>Eynat</given-names> <surname>Dellus-Gur</surname></string-name>, <string-name><given-names>Maayan</given-names> <surname>Bibi</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Predicting microbial growth in a mixed culture from growth curve data</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>116</volume>(<issue>29</issue>):<fpage>14698</fpage>–<lpage>14707</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Kathleen</given-names> <surname>Sprouffske</surname></string-name> and <string-name><given-names>Andreas</given-names> <surname>Wagner</surname></string-name></person-group>. <article-title>Growthcurver: an R package for obtaining interpretable metrics from microbial growth curves</article-title>. <source>BMC Bioinformatics</source>, <volume>17</volume>(<issue>1</issue>):<fpage>172</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sarah B.</given-names> <surname>Worthan</surname></string-name>, <string-name><given-names>Robert D. P.</given-names> <surname>McCarthy</surname></string-name>, and <string-name><given-names>Megan G.</given-names> <surname>Behringer</surname></string-name></person-group>. <article-title>Case Studies in the Assessment of Microbial Fitness: Seemingly Subtle Changes Can Have Major Effects on Phenotypic Outcomes</article-title>. <source>Journal of Molecular Evolution</source>, <volume>91</volume>:<fpage>311</fpage>—-324, <year>2023</year>.</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Désirée A</given-names> <surname>Schmitz</surname></string-name>, <string-name><given-names>Tobias</given-names> <surname>Wechsler</surname></string-name>, <string-name><given-names>Ingrid</given-names> <surname>Mignot</surname></string-name>, and <string-name><given-names>Rolf</given-names> <surname>Kümmerli</surname></string-name></person-group>. <article-title>Predicting bacterial interaction outcomes from monoculture growth and supernatant assays</article-title>. <source>ISME Communications</source>, <volume>4</volume>(<issue>1</issue>):<fpage>ycae045</fpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Milo S.</given-names> <surname>Johnson</surname></string-name>, <string-name><given-names>Sandeep</given-names> <surname>Venkataram</surname></string-name>, and <string-name><given-names>Sergey</given-names> <surname>Kryazhimskiy</surname></string-name></person-group>. <article-title>Best Practices in Designing, Sequencing, and Identifying Random DNA Barcodes</article-title>. <source>Journal of Molecular Evolution</source>, <volume>91</volume>:<fpage>263</fpage>—-280, <year>2023</year>.</mixed-citation></ref>
<ref id="c39"><label>[39]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Tim</given-names> <surname>van Opijnen</surname></string-name> and <string-name><given-names>Andrew</given-names> <surname>Camilli</surname></string-name></person-group>. <article-title>Transposon insertion sequencing: a new tool for systems-level analysis of microorganisms</article-title>. <source>Nat Rev Microbiol</source>, <volume>11</volume>(<issue>7</issue>):<fpage>435</fpage>–<lpage>442</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c40"><label>[40]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Bidong D.</given-names> <surname>Nguyen</surname></string-name>, <string-name><surname>Miguelangel Cuenca</surname> <given-names>V.</given-names></string-name>, <string-name><given-names>Johannes</given-names> <surname>Hartl</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Import of Aspartate and Malate by DcuABC Drives H2/Fumarate Respiration to Promote Initial Salmonella Gut-Lumen Colonization in Mice</article-title>. <source>Cell Host &amp; Microbe</source>, <volume>27</volume>(<issue>6</issue>):<fpage>922</fpage>–<lpage>936.e6,</lpage> <year>2020</year>.</mixed-citation></ref>
<ref id="c41"><label>[41]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Milo S.</given-names> <surname>Johnson</surname></string-name>, <string-name><given-names>Alena</given-names> <surname>Martsul</surname></string-name>, <string-name><given-names>Sergey</given-names> <surname>Kryazhimskiy</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name></person-group>. <article-title>Higher-fitness yeast genotypes are less robust to deleterious mutations</article-title>. <source>Science</source>, <volume>366</volume>(<issue>6464</issue>):<fpage>490</fpage>–<lpage>493</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c42"><label>[42]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Joao A.</given-names> <surname>Ascensao</surname></string-name>, <string-name><given-names>Kelly M.</given-names> <surname>Wetmore</surname></string-name>, <string-name><given-names>Benjamin H.</given-names> <surname>Good</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Quantifying the local adaptive landscape of a nascent bacterial community</article-title>. <source>Nature Communications</source>, <volume>14</volume>(<issue>1</issue>):<fpage>248</fpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c43"><label>[43]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jonathan N V</given-names> <surname>Martinson</surname></string-name>, <string-name><given-names>Jeremy M</given-names> <surname>Chacón</surname></string-name>, <string-name><given-names>Brian A</given-names> <surname>Smith</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Mutualism reduces the severity of gene disruptions in predictable ways across microbial communities</article-title>. <source>The ISME Journal</source>, <volume>17</volume>(<issue>12</issue>):<fpage>2270</fpage>–<lpage>2278</lpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c44"><label>[44]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jamie R.</given-names> <surname>Blundell</surname></string-name> and <string-name><given-names>Sasha F.</given-names> <surname>Levy</surname></string-name></person-group>. <article-title>Beyond genome sequencing: Lineage tracking with barcodes to study the dynamics of evolution, infection, and cancer</article-title>. <source>Genomics</source>, <volume>104</volume>(<issue>6</issue>):<fpage>417</fpage>–<lpage>430</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c45"><label>[45]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Nicholas G.</given-names> <surname>Davies</surname></string-name>, <string-name><given-names>Sam</given-names> <surname>Abbott</surname></string-name>, <string-name><given-names>Rosanna C.</given-names> <surname>Barnard</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Estimated transmissibility and impact of SARS-CoV-2 lineage B.1.1.7 in England</article-title>. <source>Science</source>, <volume>372</volume>(<issue>6538</issue>):<fpage>eabg3055</fpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c46"><label>[46]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Muhammad Saqib</given-names> <surname>Sohail</surname></string-name>, <string-name><given-names>Raymond H Y</given-names> <surname>Louie</surname></string-name>, <string-name><given-names>Zhenchen</given-names> <surname>Hong</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Inferring Epistasis from Genetic Time-series Data</article-title>. <source>Molecular Biology and Evolution</source>, <volume>39</volume>(<issue>10</issue>):<fpage>msac199</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c47"><label>[47]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Matthijs</given-names> <surname>Meijers</surname></string-name>, <string-name><given-names>Denis</given-names> <surname>Ruchnewitz</surname></string-name>, <string-name><given-names>Jan</given-names> <surname>Eberhardt</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Population immunity predicts evolutionary trajectories of SARS-CoV-2</article-title>. <source>Cell</source>, <volume>186</volume>(<issue>23</issue>):<fpage>5151</fpage>–<lpage>5164.e13,</lpage> <year>2023</year>.</mixed-citation></ref>
<ref id="c48"><label>[48]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sandeep</given-names> <surname>Venkataram</surname></string-name>, <string-name><given-names>Barbara</given-names> <surname>Dunn</surname></string-name>, <string-name><given-names>Yuping</given-names> <surname>Li</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Development of a Comprehensive Genotype-to-Fitness Map of Adaptation-Driving Mutations in Yeast</article-title>. <source>Cell</source>, <volume>166</volume>(<issue>6</issue>):<fpage>1585</fpage>–<lpage>1596.e22,</lpage> <year>2016</year>.</mixed-citation></ref>
<ref id="c49"><label>[49]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Yuping</given-names> <surname>Li</surname></string-name>, <string-name><given-names>Dmitri A.</given-names> <surname>Petrov</surname></string-name>, and <string-name><given-names>Gavin</given-names> <surname>Sherlock</surname></string-name></person-group>. <article-title>Single nucleotide mapping of trait space reveals Pareto fronts that constrain adaptation</article-title>. <source>Nature Ecology &amp; Evolution</source>, <volume>3</volume>(<issue>11</issue>):<fpage>1539</fpage>–<lpage>1551</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c50"><label>[50]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Grant</given-names> <surname>Kinsler</surname></string-name>, <string-name><given-names>Kerry</given-names> <surname>Geiler-Samerotte</surname></string-name>, and <string-name><given-names>Dmitri A</given-names> <surname>Petrov</surname></string-name></person-group>. <article-title>Fitness variation across subtle environmental perturbations reveals local modularity and global pleiotropy of adaptation</article-title>. <source>eLife</source>, <volume>9</volume>:<elocation-id>e61271</elocation-id>, <year>2020</year>.</mixed-citation></ref>
<ref id="c51"><label>[51]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Christopher W</given-names> <surname>Bakerlee</surname></string-name>, <string-name><given-names>Angela M</given-names> <surname>Phillips</surname></string-name>, <string-name><given-names>Alex N Nguyen</given-names> <surname>Ba</surname></string-name>, and <string-name><given-names>Michael M</given-names> <surname>Desai</surname></string-name></person-group>. <article-title>Dynamics and variability in the pleiotropic effects of adaptation in laboratory budding yeast populations</article-title>. <source>eLife</source>, <volume>10</volume>:<elocation-id>e70918</elocation-id>, <year>2021</year>.</mixed-citation></ref>
<ref id="c52"><label>[52]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Kara</given-names> <surname>Schmidlin</surname></string-name>, <string-name><given-names>Sam</given-names> <surname>Apodaca</surname></string-name>, <string-name><given-names>Daphne</given-names> <surname>Newell</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Distinguishing mutants that resist drugs via different mechanisms by examining fitness tradeoffs</article-title>. <source>eLife</source>, <volume>13</volume>:<elocation-id>RP94144</elocation-id>, <year>2024</year>.</mixed-citation></ref>
<ref id="c53"><label>[53]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Michael J.</given-names> <surname>McDonald</surname></string-name>, <string-name><given-names>Tim F.</given-names> <surname>Cooper</surname></string-name>, <string-name><given-names>Hubertus J. E.</given-names> <surname>Beaumont</surname></string-name>, and <string-name><given-names>Paul B.</given-names> <surname>Rainey</surname></string-name></person-group>. <article-title>The distribution of fitness effects of new beneficial mutations in Pseudomonas fluorescens</article-title>. <source>Biology Letters</source>, <volume>7</volume>(<issue>1</issue>):<fpage>98</fpage>–<lpage>100</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c54"><label>[54]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Chuan</given-names> <surname>Li</surname></string-name>, <string-name><given-names>Wenfeng</given-names> <surname>Qian</surname></string-name>, <string-name><given-names>Calum J.</given-names> <surname>Maclean</surname></string-name>, and <string-name><given-names>Jianzhi</given-names> <surname>Zhang</surname></string-name></person-group>. <article-title>The fitness landscape of a tRNA gene</article-title>. <source>Science</source>, <volume>352</volume>(<issue>6287</issue>):<fpage>837</fpage>–<lpage>840</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c55"><label>[55]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Pascal M.</given-names> <surname>Frey</surname></string-name>, <string-name><given-names>Julian</given-names> <surname>Baer</surname></string-name>, <string-name><given-names>Judith</given-names> <surname>Bergada-Pijuan</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Quantifying Variation in Bacterial Reproductive Fitness: a High-Throughput Method</article-title>. <source>mSystems</source>, <volume>6</volume>(<issue>1</issue>):<fpage>e01323</fpage>–<lpage>20</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c56"><label>[56]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Tzahi</given-names> <surname>Gabzi</surname></string-name>, <string-name><given-names>Yitzhak</given-names> <surname>Pilpel</surname></string-name>, and <string-name><given-names>Tamar</given-names> <surname>Friedlander</surname></string-name></person-group>. <article-title>Fitness Landscape Analysis of a tRNA Gene Reveals that the Wild Type Allele is Sub-optimal, Yet Mutationally Robust</article-title>. <source>Molecular Biology and Evolution</source>, <volume>39</volume>(<issue>9</issue>):<fpage>msac178</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c57"><label>[57]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Motoo</given-names> <surname>Kimura</surname></string-name></person-group>. <article-title>On the probability of fixation of mutant genes in a population</article-title>. <source>Genetics</source>, <volume>47</volume>(<issue>6</issue>):<fpage>713</fpage>–<lpage>719</lpage>, <year>1962</year>.</mixed-citation></ref>
<ref id="c58"><label>[58]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Z</given-names> <surname>Patwa</surname></string-name> and <string-name><given-names>L.M</given-names> <surname>Wahl</surname></string-name></person-group>. <article-title>The fixation probability of beneficial mutations</article-title>. <source>Journal of The Royal Society Interface</source>, <volume>5</volume>(<issue>28</issue>):<fpage>1279</fpage>–<lpage>1289</lpage>, <year>2008</year>.</mixed-citation></ref>
<ref id="c59"><label>[59]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Michael M</given-names> <surname>Desai</surname></string-name> and <string-name><given-names>Daniel S</given-names> <surname>Fisher</surname></string-name></person-group>. <article-title>Beneficial Mutation–Selection Balance and the Effect of Linkage on Positive Selection</article-title>. <source>Genetics</source>, <volume>176</volume>(<issue>3</issue>):<fpage>1759</fpage>–<lpage>1798</lpage>, <year>2007</year>.</mixed-citation></ref>
<ref id="c60"><label>[60]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sebastian</given-names> <surname>Matuszewski</surname></string-name>, <string-name><given-names>Marcel E</given-names> <surname>Hildebrandt</surname></string-name>, <string-name><given-names>Ana-Hermina</given-names> <surname>Ghenu</surname></string-name>, <etal>et al.</etal></person-group> <article-title>A Statistical Guide to the Design of Deep Mutational Scanning Experiments</article-title>. <source>Genetics</source>, <volume>204</volume>(<issue>1</issue>):<fpage>77</fpage>–<lpage>87</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="c61"><label>[61]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Anurag</given-names> <surname>Limdi</surname></string-name> and <string-name><given-names>Michael</given-names> <surname>Baym</surname></string-name></person-group>. <article-title>Resolving Deleterious and Near-Neutral Effects Requires Different Pooled Fitness Assay Designs</article-title>. <source>Journal of Molecular Evolution</source>, <volume>91</volume>(<issue>3</issue>):<fpage>325</fpage>–<lpage>333</lpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c62"><label>[62]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>C</given-names> <surname>Denniston</surname></string-name> and <string-name><given-names>J F</given-names> <surname>Crow</surname></string-name></person-group>. <article-title>Alternative fitness models with the same allele frequency dynamics</article-title>. <source>Genetics</source>, <volume>125</volume>(<issue>1</issue>):<fpage>201</fpage>–<lpage>205</lpage>, <year>1990</year>.</mixed-citation></ref>
<ref id="c63"><label>[63]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>B. R.</given-names> <surname>Levin</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Antonovics</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Sharma</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Frequency-dependent selection in bacterial populations</article-title>. <source>Philosophical Transactions of the Royal Society of London. B, Biological Sciences</source>, <volume>319</volume>(<issue>1196</issue>):<fpage>459</fpage>–<lpage>472</lpage>, <year>1997</year>.</mixed-citation></ref>
<ref id="c64"><label>[64]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>James</given-names> <surname>Mallet</surname></string-name></person-group>. <article-title>The struggle for existence. how the notion of carrying capacity obscures the links between demography, darwinian evolution and speciation</article-title>, <source>Evolutionary Ecology Research</source> <volume>14</volume>:<fpage>627</fpage>–<lpage>665</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c65"><label>[65]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>P.</given-names> <surname>McCullagh</surname></string-name> and <string-name><given-names>J. A.</given-names> <surname>Nelder</surname></string-name></person-group>. <source>Generalized Linear Models</source>. <publisher-name>Routledge</publisher-name>, <publisher-loc>Boca Raton</publisher-loc>, <edition>2</edition> edition, <year>1989</year>.</mixed-citation></ref>
<ref id="c66"><label>[66]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Romain</given-names> <surname>Gallet</surname></string-name>, <string-name><given-names>Tim F.</given-names> <surname>Cooper</surname></string-name>, <string-name><given-names>Santiago F.</given-names> <surname>Elena</surname></string-name>, and <string-name><given-names>Thomas</given-names> <surname>Lenormand</surname></string-name></person-group>. <article-title>Measuring Selection Coefficients Below 10-3: Method, Questions, and Prospects</article-title>. <source>Genetics</source>, <volume>190</volume>(<issue>1</issue>):<fpage>175</fpage>–<lpage>186</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c67"><label>[67]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Jeff</given-names> <surname>Gill</surname></string-name> and <string-name><given-names>Michelle</given-names> <surname>Torres</surname></string-name></person-group>. <source>Generalized Linear Models</source>. <publisher-name>Sage Publications</publisher-name>, <publisher-loc>Thousand Oaks</publisher-loc>, <edition>2</edition> edition, <year>2020</year>.</mixed-citation></ref>
<ref id="c68"><label>[68]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Helen K.</given-names> <surname>Alexander</surname></string-name>, <string-name><given-names>Guillaume</given-names> <surname>Martin</surname></string-name>, <string-name><given-names>Oliver Y.</given-names> <surname>Martin</surname></string-name>, and <string-name><given-names>Sebastian</given-names> <surname>Bonhoeffer</surname></string-name></person-group>. <article-title>Evolutionary rescue: linking theory for conservation and medicine</article-title>. <source>Evolutionary Applications</source>, <volume>7</volume>(<issue>10</issue>):<fpage>1161</fpage>–<lpage>1179</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c69"><label>[69]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Vaughn S.</given-names> <surname>Cooper</surname></string-name></person-group>. <article-title>Experimental Evolution as a High-Throughput Screen for Genetic Adaptations</article-title>. <source>mSphere</source>, <volume>3</volume>(<issue>3</issue>):<fpage>e00121</fpage>–<lpage>18</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c70"><label>[70]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Christoph A.</given-names> <surname>Thaiss</surname></string-name>, <string-name><given-names>David</given-names> <surname>Zeevi</surname></string-name>, <string-name><given-names>Maayan</given-names> <surname>Levy</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Transkingdom Control of Microbiota Diurnal Oscillations Promotes Metabolic Homeostasis</article-title>. <source>Cell</source>, <volume>159</volume>(<issue>3</issue>):<fpage>514</fpage>–<lpage>529</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="c71"><label>[71]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Antonio M.</given-names> <surname>Martin-Platero</surname></string-name>, <string-name><given-names>Brian</given-names> <surname>Cleary</surname></string-name>, <string-name><given-names>Kathryn</given-names> <surname>Kauffman</surname></string-name>, <etal>et al.</etal></person-group> <article-title>High resolution time series reveals cohesive but short-lived communities in coastal plankton</article-title>. <source>Nature Communications</source>, <volume>9</volume>(<issue>1</issue>):<fpage>266</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c72"><label>[72]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Daniel</given-names> <surname>Muratore</surname></string-name>, <string-name><given-names>Angela K.</given-names> <surname>Boysen</surname></string-name>, <string-name><given-names>Matthew J.</given-names> <surname>Harke</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Complex marine microbial communities partition metabolism of scarce resources over the diel cycle</article-title>. <source>Nature Ecology &amp; Evolution</source>, <volume>6</volume>(<issue>2</issue>):<fpage>218</fpage>–<lpage>229</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c73"><label>[73]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Javier</given-names> <surname>DelaFuente</surname></string-name>, <string-name><given-names>Jeronimo</given-names> <surname>Rodriguez-Beltran</surname></string-name>, and <string-name><given-names>Alvaro San</given-names> <surname>Millan</surname></string-name></person-group>. <chapter-title>Methods to Study Fitness and Compensatory Adaptation in Plasmid-Carrying Bacteria</chapter-title>. In <person-group person-group-type="editor"><string-name><given-names>Fernando De La</given-names> <surname>Cruz</surname></string-name></person-group>, editor, <source>Horizontal Gene Transfer</source>, volume <volume>2075</volume>, pages <fpage>371</fpage>–<lpage>382</lpage>. <publisher-name>Springer US</publisher-name>, <publisher-loc>New York, NY</publisher-loc>, <year>2020</year>.</mixed-citation></ref>
<ref id="c74"><label>[74]</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Autumn</given-names> <surname>Peterson</surname></string-name>, <string-name><given-names>Carina</given-names> <surname>Baskett</surname></string-name>, <string-name><given-names>William C.</given-names> <surname>Ratcliff</surname></string-name>, and <string-name><given-names>Anthony</given-names> <surname>Burnetti</surname></string-name></person-group>. <article-title>Using light for energy: examining the evolution of phototrophic metabolism through synthetic construction</article-title>, <source>bioRxiv</source> <year>2022</year>.</mixed-citation></ref>
<ref id="c75"><label>[75]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>R. Z.</given-names> <surname>Moger-Reischer</surname></string-name>, <string-name><given-names>J. I.</given-names> <surname>Glass</surname></string-name>, <string-name><given-names>K. S.</given-names> <surname>Wise</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Evolution of a minimal cell</article-title>. <source>Nature</source>, <volume>620</volume>(<issue>7972</issue>):<fpage>122</fpage>–<lpage>127</lpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c76"><label>[76]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ellen</given-names> <surname>Baake</surname></string-name>, <string-name><given-names>Adrián González</given-names> <surname>Casanova</surname></string-name>, <string-name><given-names>Sebastian</given-names> <surname>Probst</surname></string-name>, and <string-name><given-names>Anton</given-names> <surname>Wakolbinger</surname></string-name></person-group>. <article-title>Modelling and simulating Lenski’s long-term evolution experiment</article-title>. <source>Theoretical Population Biology</source>, <volume>127</volume>:<fpage>58</fpage>–<lpage>74</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="c77"><label>[77]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sivan Pearl</given-names> <surname>Mizrahi</surname></string-name>, <string-name><given-names>Akshit</given-names> <surname>Goyal</surname></string-name>, and <string-name><given-names>Jeff</given-names> <surname>Gore</surname></string-name></person-group>. <article-title>Community interactions drive the evolution of antibiotic tolerance in bacteria</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>120</volume>(<issue>3</issue>):<fpage>e2209043119</fpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c78"><label>[78]</label><mixed-citation publication-type="web"><person-group person-group-type="author"><string-name><given-names>R. E.</given-names> <surname>Lenski</surname></string-name></person-group>. <source>On The Use Of Selection Rate Versus Relative Fitness</source>. <ext-link ext-link-type="uri" xlink:href="https://lenski.mmg.msu.edu/ecoli/srvsrf.html">https://lenski.mmg.msu.edu/ecoli/srvsrf.html</ext-link>. Accessed: <date-in-citation content-type="access-date">2021-06-25</date-in-citation>.</mixed-citation></ref>
<ref id="c79"><label>[79]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>B.J.</given-names> <surname>Koch</surname></string-name>, <string-name><given-names>T.A.</given-names> <surname>McHugh</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Hayer</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Estimating taxon-specific population dynamics in diverse microbial communities</article-title>. <source>Ecosphere</source>, <volume>9</volume>(<issue>1</issue>):<fpage>e02090</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c80"><label>[80]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Chunxiao</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>Yu</given-names> <surname>Yang</surname></string-name>, <string-name><given-names>Yulin</given-names> <surname>Wang</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Absolute quantification and genome-centric analyses elucidate the dynamics of microbial populations in anaerobic digesters</article-title>. <source>Water Research</source>, <volume>224</volume>:<fpage>119049</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c81"><label>[81]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Guri</given-names> <surname>Giaever</surname></string-name>, <string-name><given-names>Angela M.</given-names> <surname>Chu</surname></string-name>, <string-name><given-names>Li</given-names> <surname>Ni</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Functional profiling of the Saccharomyces cerevisiae genome</article-title>. <source>Nature</source>, <volume>418</volume>(<issue>6896</issue>):<fpage>387</fpage>–<lpage>391</lpage>, <year>2002</year>.</mixed-citation></ref>
<ref id="c82"><label>[82]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Michael</given-names> <surname>Manhart</surname></string-name>, <string-name><given-names>Bharat V.</given-names> <surname>Adkar</surname></string-name>, and <string-name><given-names>Eugene I.</given-names> <surname>Shakhnovich</surname></string-name></person-group>. <article-title>Trade-offs between microbial growth phases lead to frequency-dependent and non-transitive selection</article-title>. <source>Proceedings of the Royal Society B: Biological Sciences</source>, <volume>285</volume>(<issue>1872</issue>):<fpage>20172459</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c83"><label>[83]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Michael</given-names> <surname>Manhart</surname></string-name> and <string-name><given-names>Eugene I.</given-names> <surname>Shakhnovich</surname></string-name></person-group>. <article-title>Growth tradeoffs produce complex microbial communities on a single limiting resource</article-title>. <source>Nature Communications</source>, <volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>9</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="c84"><label>[84]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jonathan</given-names> <surname>Friedman</surname></string-name>, <string-name><given-names>Logan M.</given-names> <surname>Higgins</surname></string-name>, and <string-name><given-names>Jeff</given-names> <surname>Gore</surname></string-name></person-group>. <article-title>Community structure follows simple assembly rules in microbial microcosms</article-title>. <source>Nature Ecology &amp; Evolution</source>, <volume>1</volume>(<issue>5</issue>):<fpage>1</fpage>–<lpage>7</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c85"><label>[85]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Manon A.</given-names> <surname>Morin</surname></string-name>, <string-name><given-names>Anneliese J.</given-names> <surname>Morrison</surname></string-name>, <string-name><given-names>Michael J.</given-names> <surname>Harms</surname></string-name>, and <string-name><given-names>Rachel J.</given-names> <surname>Dutton</surname></string-name></person-group>. <article-title>Higher-order interactions shape microbial interactions as microbial community complexity increases</article-title>. <source>Scientific Reports</source>, <volume>12</volume>(<issue>1</issue>):<fpage>22640</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c86"><label>[86]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ryan Seamus</given-names> <surname>McGee</surname></string-name>, <string-name><given-names>Grant</given-names> <surname>Kinsler</surname></string-name>, <string-name><given-names>Dmitri</given-names> <surname>Petrov</surname></string-name>, and <string-name><given-names>Mikhail</given-names> <surname>Tikhonov</surname></string-name></person-group>. <article-title>Improving the Accuracy of Bulk Fitness Assays by Correcting Barcode Processing Biases</article-title>. <source>Molecular Biology and Evolution</source>, <volume>41</volume>(<issue>8</issue>):<fpage>msae152</fpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="c87"><label>[87]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Grant</given-names> <surname>Kinsler</surname></string-name>, <string-name><given-names>Kara</given-names> <surname>Schmidlin</surname></string-name>, <string-name><given-names>Daphne</given-names> <surname>Newell</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Extreme Sensitivity of Fitness to Environmental Conditions: Lessons from #1BigBatch</article-title>. <source>Journal of Molecular Evolution</source>, <volume>91</volume>(<issue>3</issue>):<fpage>293</fpage>–<lpage>310</lpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="c88"><label>[88]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Manon</given-names> <surname>Morin</surname></string-name>, <string-name><given-names>Emily C</given-names> <surname>Pierce</surname></string-name>, and <string-name><given-names>Rachel J</given-names> <surname>Dutton</surname></string-name></person-group>. <article-title>Changes in the genetic requirements for microbial interactions with increasing community complexity</article-title>. <source>eLife</source>, <volume>7</volume>:<elocation-id>e37072</elocation-id>, <year>2018</year>.</mixed-citation></ref>
<ref id="c89"><label>[89]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Fangfei</given-names> <surname>Li</surname></string-name>, <string-name><given-names>Marc L.</given-names> <surname>Salit</surname></string-name>, and <string-name><given-names>Sasha F.</given-names> <surname>Levy</surname></string-name></person-group>. <article-title>Unbiased Fitness Estimation of Pooled Barcode or Amplicon Sequencing Studies</article-title>. <source>Cell Systems</source>, <volume>7</volume>(<issue>5</issue>):<fpage>521</fpage>–<lpage>525.e4,</lpage> <year>2018</year>.</mixed-citation></ref>
<ref id="c90"><label>[90]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Benjamin H.</given-names> <surname>Good</surname></string-name>, <string-name><given-names>Michael J.</given-names> <surname>McDonald</surname></string-name>, <string-name><given-names>Jeffrey E.</given-names> <surname>Barrick</surname></string-name>, <etal>et al.</etal></person-group> <article-title>The dynamics of molecular evolution over 60,000 generations</article-title>. <source>Nature</source>, <volume>551</volume>(<issue>7678</issue>):<fpage>45</fpage>–<lpage>50</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="c91"><label>[91]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Andrew J.</given-names> <surname>Borchert</surname></string-name>, <string-name><given-names>Alissa</given-names> <surname>Bleem</surname></string-name>, and <string-name><given-names>Gregg T.</given-names> <surname>Beckham</surname></string-name></person-group>. <article-title>Experimental and Analytical Approaches for Improving the Resolution of Randomly Barcoded Transposon Insertion Sequencing (RB-TnSeq) Studies</article-title>. <source>ACS Synthetic Biology</source>, <volume>11</volume>(<issue>6</issue>):<fpage>2015</fpage>–<lpage>2021</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="c92"><label>[92]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Luciano</given-names> <surname>Fernandez-Ricaud</surname></string-name>, <string-name><given-names>Jonas</given-names> <surname>Warringer</surname></string-name>, <string-name><given-names>Elke</given-names> <surname>Ericson</surname></string-name>, <etal>et al.</etal></person-group> <article-title>PROPHECY—a database for high-resolution phenomics</article-title>. <source>Nucleic Acids Research</source>, <volume>33</volume>(<issue>Suppl 1</issue>):<fpage>D369</fpage>– <lpage>D373</lpage>, <year>2005</year>.</mixed-citation></ref>
<ref id="c93"><label>[93]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. H.</given-names> <surname>Zwietering</surname></string-name>, <string-name><given-names>I.</given-names> <surname>Jongenburger</surname></string-name>, <string-name><given-names>F. M.</given-names> <surname>Rombouts</surname></string-name>, and <string-name><given-names>K. van ‘t</given-names> <surname>Riet</surname></string-name></person-group>. <article-title>Modeling of the Bacterial Growth Curve</article-title>. <source>Applied and Environmental Microbiology</source>, <volume>56</volume>(<issue>6</issue>):<fpage>1875</fpage>–<lpage>1881</lpage>, <year>1990</year>.</mixed-citation></ref>
<ref id="c94"><label>[94]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Farida</given-names> <surname>Vasi</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Travisano</surname></string-name>, and <string-name><given-names>Richard E.</given-names> <surname>Lenski</surname></string-name></person-group>. <article-title>Long-Term Experimental Evolution in Escherichia coli. II. Changes in Life-History Traits During Adaptation to a Seasonal Environment</article-title>. <source>The American Naturalist</source>, <volume>144</volume>(<issue>3</issue>):<fpage>432</fpage>–<lpage>456</lpage>, <year>1994</year>.</mixed-citation></ref>
</ref-list>
<sec id="s5">
<title>Supplementary Information</title>
<sec id="s5a">
<label>S1.</label>
<title>Different types of fitness under example models of population dynamics</title>
<p>We distinguish between three related but distinct notions of fitness [<xref ref-type="bibr" rid="c1">1</xref>], all based on predicting dynamics of a population [<xref ref-type="bibr" rid="c2">2</xref>–<xref ref-type="bibr" rid="c5">5</xref>]. The first type of fitness is <italic>absolute fitness</italic>, which is a property of a single genotype by itself and serves to predict the change in the genotype’s absolute abundance <italic>N(t) over</italic> a future time window Δ<italic>t</italic> (<xref rid="figS1" ref-type="fig">Fig. S1A</xref>). This is important for questions about extinction and evolutionary rescue [<xref ref-type="bibr" rid="c6">6</xref>]. The second type of fitness is <italic>relative fitness</italic>, which is a property of two geno-types as it describes how the relative abundance <italic>x(t)</italic> of one genotype changes compared to the other over a time Δ<italic>t</italic> (<xref rid="figS1" ref-type="fig">Fig. S1B</xref>). This is important to determine the fixation probability of new mutations [<xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c8">8</xref>]. In general these dynamics are stochastic [<xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c10">10</xref>], but throughout this paper we focus on their average behavior across replicate cultures (as sketched in <xref rid="figS1" ref-type="fig">Fig. S1C</xref>).</p>
<p>A practical challenge of working with relative fitnesses is that they must be measured between all pairs of geno-types in co-culture competitions. Therefore it is common to infer relative fitness of two genotypes based on some individual properties of the genotypes [<xref ref-type="bibr" rid="c11">11</xref>–<xref ref-type="bibr" rid="c14">14</xref>]. We denote this third notion of fitness as the <italic>fitness potential</italic> ; it is a property of an individual genotype, but unlike the absolute fitness, it has no meaning by itself; it is the ratio or difference of fitness potentials that is used to derive relative fitness between two genotypes [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c16">16</xref>]. The collection of fitness potential values across a large set of genotypes forms a fitness landscape [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>]. We note that fitness as defined here gives information about short-time dynamics but not necessarily the long-term outcome (compare [<xref ref-type="bibr" rid="c19">19</xref>]). For example, this excludes the ratio of growth rates [<xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c20">20</xref>] or the resource concentration <italic>R</italic>* in chemostat equilibrium [<xref ref-type="bibr" rid="c21">21</xref>] since these quantities cannot tell you how fast the absolute or relative abundance is changing.</p>
<p>In this section we explicitly calculate relative fitness of a mutant under a few example models of population dynamics, using the different encodings of relative abundance as described in the main text (<xref rid="fig1" ref-type="fig">Fig. 1A</xref>). Consider a competition coculture between a wild-type genotype with absolute abundance <italic>N</italic><sub>wt</sub>(<italic>t</italic>) and a mutant genotype with absolute abundance <italic>N</italic><sub>mut</sub>(<italic>t</italic>). We can describe their dynamics according to the ordinary differential equations (ODEs)
<disp-formula id="eqnS1">
<graphic xlink:href="608874v1_eqnS1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Note that the per-capita growth rates <italic>g</italic><sub>wt</sub> and <italic>g</italic><sub>mut</sub> of each genotype can depend on both genotypes to reflect competition or other interactions. The relative abundance of the mutant genotype at time <italic>t</italic> is
<disp-formula id="eqnS2">
<graphic xlink:href="608874v1_eqnS2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The dynamics of the mutant relative abundance are therefore described by
<disp-formula id="eqnS3">
<graphic xlink:href="608874v1_eqnS3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>As defined in the main text (<xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>), the relative fitness of a mutant is <italic>s</italic><sup><italic>m</italic></sup> = <italic>dm</italic>/<italic>dt</italic> for an encoding <italic>m(x) of t</italic>he relative abundance <italic>x</italic>. Under the trivial linear encoding (<italic>m(x) = x)</italic>, the relative fitness is therefore just the right-hand side of the relative abundance ODE (<xref ref-type="disp-formula" rid="eqnS3">Eq. (S3)</xref>):
<disp-formula id="eqnS4">
<graphic xlink:href="608874v1_eqnS4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>For the log encoding <italic>m(x) = lo</italic>g x, we use the identity <italic>d</italic> log <italic>x</italic>/<italic>dt</italic> = <italic>x</italic><sup>−1</sup><italic>dx</italic>/<italic>dt</italic> to obtain the log-encoded relative fitness:
<disp-formula id="eqnS5">
<graphic xlink:href="608874v1_eqnS5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Finally, for the logit encoding <italic>m(x) = lo</italic>git <italic>x</italic> = log(<italic>x</italic>/(1 − <italic>x</italic>)), we use the identity <italic>d</italic> logit <italic>x</italic>/<italic>dt</italic> = <italic>x</italic><sup>−1</sup>(1 <italic>x</italic>)<sup>−1</sup><italic>dx</italic>/<italic>dt</italic> to obtain the logit-encoded relative fitness:
<disp-formula id="eqnS6">
<graphic xlink:href="608874v1_eqnS6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>By comparing relative fitness values under the linear encoding (<xref ref-type="disp-formula" rid="eqnS4">Eq. (S4)</xref>) and under the logit encoding (<xref ref-type="disp-formula" rid="eqnS6">Eq. (S6)</xref>), we see how the logit encoding has removed the explicit dependence on the mutant relative abundance (factors of <italic>x</italic> and 1− <italic>x</italic>), although there can be implicit dependence on the mutant relative abundance within the per-capita growth rates of each strain (<italic>g</italic><sub>wt</sub> and <italic>g</italic><sub>mut</sub>) due to density-dependent growth rates.</p>
<p>If the per-capita growth rates <italic>g</italic><sub>wt</sub> and <italic>g</italic><sub>mut</sub> (<xref ref-type="disp-formula" rid="eqnS1">Eq. (S1)</xref>) are constants, then these constant growth rates also act as fitness potentials since they each depend only on a single genotype but their difference determines relative fitness (under the logit encoding, <xref ref-type="disp-formula" rid="eqnS6">Eq. (S6)</xref>) between the genotypes. The growth rate is not a fitness potential under more complex dynamics, however. For example, consider a competition model with explicit density dependence:
<disp-formula id="eqnS7">
<graphic xlink:href="608874v1_eqnS7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where the growth rates decrease as the genotype abundances reach their carrying capacities <italic>K</italic><sub>wt</sub> and <italic>K</italic><sub>mut</sub>, and the maximum growth rates at low abundances are <italic>r</italic><sub>wt</sub> and <italic>r</italic><sub>mut</sub>. In this case, the relative fitness under the logit encoding is (from <xref ref-type="disp-formula" rid="eqnS6">Eq. (S6)</xref>)
<disp-formula id="eqnS8">
<graphic xlink:href="608874v1_eqnS8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>In this case, there is no fitness potential because it is not possible to separate <xref ref-type="disp-formula" rid="eqnS8">Eq. (S8)</xref> into a difference between terms that only depend on each genotype separately.</p>
</sec>
<sec id="s5b">
<label>S2.</label>
<title>The role of logistic population dynamics in logit-encoded relative fitness</title>
<p>Here we show how the logit encoding of relative abundance is related to the logistic model of population dynamics. For a relative abundance <italic>x</italic>, logistic dynamics are
<disp-formula id="eqnS9">
<graphic xlink:href="608874v1_eqnS9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>r</italic> is the exponential rate at which relative abundance increases from low values. This form emerges from the general dynamics of relative abundance (<xref ref-type="disp-formula" rid="eqnS3">Eq. (S3)</xref>) when the difference in per-capita growth rates <italic>g</italic><sub>mut</sub> and <italic>g</italic><sub>wt</sub> is constant. Once can also interpret the logistic model as a lowest-order approximation for more complex dynamics. That is, consider a general equation for relative abundance:
<disp-formula id="eqnS10">
<graphic xlink:href="608874v1_eqnS10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
for an arbitrary function <italic>f</italic> (<italic>x</italic>). Since this function must obey the boundary conditions <italic>f</italic> (0) = 0 and <italic>f</italic> (1) = 0 (the relative abundance must stop changing when it either goes extinct or fixes), a polynomial expansion of <italic>f</italic> (<italic>x</italic>) must have roots at these values:
<disp-formula id="eqnS11">
<graphic xlink:href="608874v1_eqnS11.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Thus the logistic model in <xref ref-type="disp-formula" rid="eqnS9">Eq. (S9)</xref> is a lowest-order approximation even when the true dynamics are more complex.</p>
<p>The logistic differential equation in <xref ref-type="disp-formula" rid="eqnS9">Eq. (S9)</xref> has the solution
<disp-formula id="eqnS12">
<graphic xlink:href="608874v1_eqnS12.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The logit encoding of the logistic relative abundance has linear dependence on time:
<disp-formula id="eqnS13">
<graphic xlink:href="608874v1_eqnS13.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>This is another way to see why the relative fitness under the logit encoding (the time derivative of <xref ref-type="disp-formula" rid="eqnS13">Eq. (S13)</xref>) is constant under logistic dynamics. Mathematically, this occurs because the logit function is the inverse of the logistic dynamics (<xref ref-type="disp-formula" rid="eqnS12">Eq. (S12)</xref>), up to a shift and rescaling. Thus if the relative abundance dynamics are different from logistic (<xref ref-type="disp-formula" rid="eqnS9">Eq. (S9)</xref>), the logit encoding no longer exactly linearizes the trajectory of relative abundance and thus is no longer the optimal encoding for relative fitness (see example in <xref rid="figS2" ref-type="fig">Fig. S2</xref>).</p>
</sec>
<sec id="s5c">
<label>S3.</label>
<title>Definition of absolute fitness for a genotype</title>
<p>Here we give an explicit definition of a genotype’s absolute fitness, analogous to the definition of relative fitness in the main text (<xref ref-type="disp-formula" rid="eqn1">Eqs. (1)</xref>–<xref ref-type="disp-formula" rid="eqn3">(3)</xref>). Conceptually, absolute fitness is any number that is sufficient to predict a geno-type’s absolute abundance <italic>N</italic> over a short time window. Let an encoding <italic>m(N) be any</italic> smooth, strictly-increasing function of the absolute abundance <italic>N</italic>. We can then predict the absolute abundance over a time window Δ<italic>t</italic> using a linear expansion of the encoded abundance (analogous to main text <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> for relative fitness):
<disp-formula id="eqnS14">
<graphic xlink:href="608874v1_eqnS14.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>m</italic><sup><italic>-</italic>1</sup> is the inverse of the encoding function and
<disp-formula id="eqnS15">
<graphic xlink:href="608874v1_eqnS15.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
is defined as the absolute fitness of the genotype under the encoding <italic>m</italic> (analogous to main text <xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref> for relative fitness; see also <xref rid="fig1" ref-type="fig">Fig. 1B</xref>). For example, the absolute fitness of a genotype under the log encoding <italic>m(N) = log N</italic> is the per-capita growth rate:
<disp-formula id="eqnS16">
<graphic xlink:href="608874v1_eqnS16.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>In general, the ideal encoding of absolute abundance is the inverse function of the absolute abundance trajectory <italic>N(t) (up t</italic>o a shift and rescaling), so that the first-order expansion in <xref ref-type="disp-formula" rid="eqnS14">Eq. (S14)</xref> is exact and the absolute fitness <italic>a</italic><sup><italic>m</italic></sup> is sufficient to determine changes in absolute abundance up to any future time. The log encoding <italic>m(N) = log N</italic> is therefore ideal when absolute abundance grows or decays exponentially, while the logit encoding <italic>m(N) = logi</italic>t <italic>N</italic> is ideal for a population that grows with logistic density dependence (<xref ref-type="disp-formula" rid="eqnS7">Eq. (S7)</xref> in case of a single genotype).</p>
<p>Absolute fitness and relative fitness are related, since the relative abundance of a genotype is determined by normalizing its absolute abundance by the absolute abundance of all genotypes in the population. Specifically, the relative fitness of a genotype is determined by the absolute fitnesses for all genotypes in the population. For example, in the case of two genotypes, the relative fitness under the logit encoding (<xref ref-type="disp-formula" rid="eqnS6">Eq. (S6)</xref>) is the difference between the genotypes’ absolute fitness under the log en-coding (<xref ref-type="disp-formula" rid="eqnS16">Eq. (S16)</xref>). In the case of constant per-capita growth rates, these log-encoded absolute fitnesses also act as fitness potentials.</p>
</sec>
<sec id="s5d">
<label>S4.</label>
<title>Relative fitness predictions in discrete time: additive vs. multiplicative form</title>
<p>In our framework, relative fitness is a statistic that predicts relative abundance in an additive equation (<xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>) but sometimes the dynamics of individual genotypes are modeled using a multiplicative form of fitness. In this section, we show how these multiplicative fitness statistics are related to the additive fitness statistics, in particular for the logit encoding.</p>
<p>We consider a population of a wild-type and a mutant genotype, where we track the mutant’s relative abundance over multiple rounds of competition (e.g. growth cycles)
<disp-formula id="eqnS17">
<graphic xlink:href="608874v1_eqnS17.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
and the variable <italic>x</italic> changes each round according to some underlying population dynamics.</p>
<p>In a modeling approach typical to many studies in population genetics [<xref ref-type="bibr" rid="c22">22</xref>], these population dynamics are captured in the genotype-specific growth factors
<disp-formula id="eqnS18">
<graphic xlink:href="608874v1_eqnS18.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
which drive the update equation for the mutant relative abundance
<disp-formula id="eqnS19">
<graphic xlink:href="608874v1_eqnS19.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
which is the discrete-time analogue to a differential equation (<xref ref-type="disp-formula" rid="eqnS1">Eq. (S1)</xref>). We divide <xref ref-type="disp-formula" rid="eqnS19">Eq. (S19)</xref> by 1 − <italic>x</italic>(<italic>r</italic> + 1) to obtain the form
<disp-formula id="eqnS20">
<graphic xlink:href="608874v1_eqnS20.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
which allows us to recognize the ratio of growth factors <italic>f</italic><sub>mut</sub>/<italic>f</italic><sub>wt</sub> as a relative fitness statistic, since it is sufficient to predict the relative abundance of the mutant genotype (under the encoding <italic>m(x) = x/</italic>1 − <italic>x</italic>). But the statistic <italic>f</italic><sub>mut</sub>/<italic>f</italic><sub>wt</sub> acts as a multiplying factor in <xref ref-type="disp-formula" rid="eqnS20">Eq. (S20)</xref>, whereas the general form of relative fitness <italic>s</italic><sup><italic>m</italic></sup> (<xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref>) acts as an additive factor. What’s the relationship between the multiplicative and the additive form of discrete-time relative fitness statistics?</p>
<p>To describe discrete rounds of population dynamics in our framework, we treat the relative abundance <italic>x</italic>(<italic>r</italic>) as samples from a continuous timeseries, separated by a time-gap Δ<italic>t</italic> = <italic>t</italic>(<italic>r</italic> + 1) − <italic>t</italic>(<italic>r</italic>). For a chosen encoding <italic>m</italic>, The relative abundance of the mutant genotype in the future round is predicted by
<disp-formula id="eqnS21">
<graphic xlink:href="608874v1_eqnS21.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
since this is how we defined relative fitness <italic>s</italic><sup><italic>m</italic></sup> in <xref ref-type="disp-formula" rid="eqn2">Eq. (2)</xref> This relative fitness acts as additive factor, but we apply the exponential function on both sides of <xref ref-type="disp-formula" rid="eqnS21">Eq. (S21)</xref> to obtain the updated equation
<disp-formula id="eqnS22">
<graphic xlink:href="608874v1_eqnS22.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where the additive fitness <inline-formula><inline-graphic xlink:href="608874v1_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula> together with the timescale Δ<italic>t</italic> acts as a multiplicative factor. Specifically for the logit encoding <italic>m(x) =</italic> logit <italic>x</italic> we have
<disp-formula id="eqnS23">
<graphic xlink:href="608874v1_eqnS23.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>We compare <xref ref-type="disp-formula" rid="eqnS23">Eq. (S23)</xref> to <xref ref-type="disp-formula" rid="eqnS20">Eq. (S20)</xref> and solve for the relative fitness of the mutant genotype
<disp-formula id="eqnS24">
<graphic xlink:href="608874v1_eqnS24.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
as a function of the growth factors <italic>f</italic><sub>mut</sub>, f<sub>wt</sub>. Using the definition of the growth factors (<xref ref-type="disp-formula" rid="eqnS18">Eq. (S18)</xref>), we see that <xref ref-type="disp-formula" rid="eqnS24">Eq. (S24)</xref> is simply the discrete-time relative fitness for the logit encoding in terms of the mutant and wild-type LFC (<xref ref-type="disp-formula" rid="eqnS30">Eq. (S30)</xref>). As a general point, we note that the growth-factor <italic>f</italic><sub>mut</sub> qualifies as an absolute fitness (since it is sufficient to predict the absolute abundance <italic>N</italic>(<italic>r</italic>+1)), but does not constitute a relative fitness statistic (since we also need to know <italic>f</italic><sub>wt</sub>, see Eq.(S20) or <xref ref-type="disp-formula" rid="eqnS24">Eq. (S24)</xref>).</p>
<p>More generally, for a given encoding function <italic>m(x)</italic> we define the mutant’s multiplicative relative fitness over a discrete growth cycle as
<disp-formula id="eqnS25">
<graphic xlink:href="608874v1_eqnS25.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>s</italic><sup><italic>m</italic></sup> is the additive relative fitness for this growth-cycle under the chosen encoding (<xref ref-type="disp-formula" rid="eqn3">Eq. (3)</xref>) and Δ<italic>t</italic> is the duration of the growth-cycle in time units that match <italic>s</italic><sup><italic>m</italic></sup>. Equation (S25) shows that the additive fitness <italic>s</italic><sup><italic>m</italic></sup> has time units, but the multiplicative fitness does not and is formally a dimensionless quantity. These dimensionless units are preserved in the approximate formula
<disp-formula id="eqnS26">
<graphic xlink:href="608874v1_eqnS26.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
which is the first-order expansion of <xref ref-type="disp-formula" rid="eqnS25">Eq. (S25)</xref> in the limit of weak selection (|<italic>s</italic><sup><italic>m</italic></sup>Δ<italic>t</italic>| ≪1). For example, if we choose to measure relative fitness with the logit encoding on the time-scale per-cycle (Δ<italic>t</italic> = 1 cycle), we get
<disp-formula id="eqnS27">
<graphic xlink:href="608874v1_eqnS27.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
which is the same multiplicative fitness as if we choose to measure the relative fitness on the time-scale pergeneration (Δ<italic>t</italic> = LFC<sup>wt</sup>):
<disp-formula id="eqnS28">
<graphic xlink:href="608874v1_eqnS28.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>In both cases, the time-units for the discrete-time additive fitness cancel in the product term.</p>
<p>So how would a mutant ranking in the multiplicative fitness <italic>w</italic><sup>logit</sup> rank a set of mutant genotypes compared to the fitness statistics <inline-formula><inline-graphic xlink:href="608874v1_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula> or <inline-formula><inline-graphic xlink:href="608874v1_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula> Equation (S27) shows that the multiplicative fitness statistic <italic>w</italic><sup>logit</sup> agrees with the relative fitness per-cycle <italic>s</italic><sup>logit</sup>, but can differ from the ranking in the relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline21a.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as both terms of the product in <xref ref-type="disp-formula" rid="eqnS28">Eq. (S28)</xref> depend on the mutant (compare <xref rid="fig2" ref-type="fig">Fig. 2F</xref> and Sec. S7).</p>
<p>Finally, we address the question how the relative fitness <inline-formula><inline-graphic xlink:href="608874v1_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula> agrees in the ranking with the multiplicative fitness <italic>w</italic><sup>logit</sup>, but disagrees with the fitness statistic defined in the Long-Term Evolution Experiment [<xref ref-type="bibr" rid="c23">23</xref>] as
<disp-formula id="eqnS29">
<graphic xlink:href="608874v1_eqnS29.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>By comparing <xref ref-type="disp-formula" rid="eqnS29">Eq. (S29)</xref> to the multiplicative fitness in <xref ref-type="disp-formula" rid="eqnS26">Eq. (S26)</xref>, we see that the LTEE fitness statistic W does not derive from the general form of the multiplicative fitness (<xref ref-type="disp-formula" rid="eqnS25">Eq. (S25)</xref>) as all statistics derived from this approximation have a multiplying factor Δ<italic>t</italic> that cancels the units of time in <italic>s</italic><sup><italic>m</italic></sup>. The fact that the LTEE fitness statistic <italic>W</italic> (<xref ref-type="disp-formula" rid="eqnS29">Eq. (S29)</xref>) misses the term LFC<sub>wt</sub> compared to the logit-based multiplicative fitness <italic>w</italic><sup>logit</sup> (<xref ref-type="disp-formula" rid="eqnS28">Eq. (S28)</xref>) means that the objects have different units of time, and different rankings.</p>
</sec>
<sec id="s5e">
<label>S5.</label>
<title>Derivation of mismatch conditions for relative fitness per-cycle and per-generation</title>
<p>In this section, we derive the conditions for a ranking mismatch between the relative fitness per-cycle and per-generation (for the logit-encoded relative abundance) across a set of competition experiments. Consider a batch culture where a competing wild-type and mutant genotype have log fold-changes LFC<sub>wt</sub> and LFC<sub>mut</sub> over a single growth cycle. The LFCs are convenient variables to describe these dynamics since we can express the mutant’s relative fitness per-cycle as (main text <xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>)
<disp-formula id="eqnS30">
<graphic xlink:href="608874v1_eqnS30.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
and the mutant’s relative fitness per-generation as (main text <xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref>)
<disp-formula id="eqnS31">
<graphic xlink:href="608874v1_eqnS31.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Here we assume both LFCs are nonzero (so that measuring fitness per-generation is meaningful; see discussion in main text).</p>
<p>To determine how these two fitness statistics lead to different rankings, we consider two competition experiments <italic>A</italic> and <italic>B</italic>, which may represent two different mu-tants competing against the same wild-type or the same mutant tested in two different environments. A mismatch in ranking occurs when the fitness per-cycle in competition is highest in <italic>B</italic>, while the fitness per-generation is highest in <italic>A</italic>:
<disp-formula id="eqnS32">
<graphic xlink:href="608874v1_eqnS32.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>We insert the expressions for relative fitness per-cycle (<xref ref-type="disp-formula" rid="eqnS30">Eq. (S30)</xref>) and per-generation (<xref ref-type="disp-formula" rid="eqnS31">Eq. (S31)</xref>) into <xref ref-type="disp-formula" rid="eqnS32">Eq. (S32)</xref> to rewrite the condition for ranking mismatch in terms of the LFCs:
<disp-formula id="eqnS33a">
<graphic xlink:href="608874v1_eqnS33a.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqnS33b">
<graphic xlink:href="608874v1_eqnS33b.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>For a given competition <italic>A</italic>, <xref ref-type="disp-formula" rid="eqnS33a">Eq. (S33)</xref> defines an area in the space of LFCs where competition <italic>B</italic> can lie such that competitions’ fitness is ranked differently per-cycle versus per-generation (<xref rid="fig1" ref-type="fig">Fig. 1D</xref> shows an example as the red-shaded area). Biologically, these constraints describe a situation where both the mutant and wild-type LFCs are higher in competition <italic>B</italic> than in competition <italic>A</italic> (i.e., so that they gray point is up and to the right of the red point in <xref rid="fig1" ref-type="fig">Fig. 1D</xref>), but the LFC increases must be sufficiently balanced between the mutant and wild-type (i.e., so that the point lies within the red area in <xref rid="fig1" ref-type="fig">Fig. 1D</xref>).</p>
<p>Typically, however, the LFCs of the wild-type and the mutant are not independent, since these LFCs are jointly constrained by the fact both strains compete for the same finite resources. For example, assume that a single limit-ing resource with concentration <italic>R</italic> is consumed in proportion to the growth of each genotype’s biomass according to
<disp-formula id="eqnS34">
<graphic xlink:href="608874v1_eqnS34.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>Y</italic><sub>wt</sub> and <italic>Y</italic><sub>mut</sub> are the wild-type and mutant biomass yields (stoichiometry of biomass to resource).</p>
<p>We can integrate <xref ref-type="disp-formula" rid="eqnS34">Eq. (S34)</xref> to obtain
<disp-formula id="eqnS35">
<graphic xlink:href="608874v1_eqnS35.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The growth cycle stops when no resource remains (<italic>R</italic>(<italic>t</italic>) = 0), such that
<disp-formula id="eqnS36">
<graphic xlink:href="608874v1_eqnS36.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where we have expressed the genotype abundances at the end of the growth cycle in terms of their LFCs. Equation (S36) thus entails a constraint between the wild-type and mutant LFCs. For a set of a mutant competitions with the same initial resource concentration <italic>R</italic>(0), initial abundances <italic>N</italic><sub>wt</sub>(0) and <italic>N</italic><sub>mut</sub>(0), and yields <italic>Y</italic><sub>wt</sub> and <italic>Y</italic><sub>mut</sub>, the mutant and wild-type LFCs are constrained by <xref ref-type="disp-formula" rid="eqnS36">Eq. (S36)</xref> to fall along a one-dimensional curve (black line in <xref rid="figS4" ref-type="fig">Fig. S4A</xref>). Geometrically, we see that this constraint on LFCs is incompatible with the requirements for a ranking mismatch between fitness per-cycle and pergeneration for a pair of mutant competitions (compare black line and red shaded areas in <xref rid="figS4" ref-type="fig">Fig. S4A</xref>). However, if some mutant competitions deviate from this constraint, for example by having different yields <italic>Y</italic><sub>mut</sub> or initial conditions <italic>N</italic><sub>wt</sub>(0) and <italic>N</italic><sub>mut</sub>(0), then ranking mismatches may be possible (<xref rid="figS4" ref-type="fig">Fig. S4B</xref>).</p>
</sec>
<sec id="s5f">
<label>S6.</label>
<title>Analysis of growth curves to identify growth phases</title>
<p>In this section, we describe in more detail how we identify growth phases from the original dataset of growth curves and use this to choose a subset of curves that matches the simplified growth dynamics of our population dynamics model (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>). As mentioned in the main text (Methods), we downloaded this original data from the PROPHECY DATABASE (<ext-link ext-link-type="uri" xlink:href="http://prophecy.lundberg.gu.se/">http://prophecy.lundberg.gu.se/</ext-link>), downloading specifically the dataset for growth in Synthetic Defined medium as first analysed and reported in [<xref ref-type="bibr" rid="c24">24</xref>]. The original growth curve data is already corrected for background and instrument non-linearities [<xref ref-type="bibr" rid="c24">24</xref>] (summarized in Methods), but we decided to apply additional corrections as follows: To begin with, we concatenate the original 51 data files (for different plate reader runs) into a single, consecutive dataframe and manually handle a duplication in one of the files (Experiment NO. 18). This file has no measurements for the first timepoint (<italic>t</italic> = 0) due to technical error in the original data export [<xref ref-type="bibr" rid="c24">24</xref>] and for curves from this experimental run, we set the initial time point to NAN value in Python, meaning that these points will be ignored for any subsequent calculations of averages. More generally, we decided to trim the first four timepoints of all growth curves (equivalent to 1h20min from 47h total) and remove OD measurement below a noise threshold (OD = 0.001) as this improves the quality of the fit later on.</p>
<p>After pre-processing, we estimate a smooth time series for the instantaneous growth rate in each growth curve, using a previously published script gaussianprocess.py by Swain et al. [<xref ref-type="bibr" rid="c25">25</xref>] that implements the Gaussian Process approach to smoothing (download from <ext-link ext-link-type="uri" xlink:href="https://swainlab.bio.ed.ac.uk/software.html">https://swainlab.bio.ed.ac.uk/software.html</ext-link>). We apply this script to the logarithmic absolute abundance log OD, and reconstruct a smoothed trajectory <italic>f</italic>(<italic>t</italic>) ≈ log OD(t) as well as the first derivative <italic>df</italic> /<italic>dt</italic> and the second derivative <italic>d</italic><sup>2</sup><italic>f</italic>/<italic>d</italic><sup>2</sup><italic>t</italic> [<xref ref-type="bibr" rid="c25">25</xref>]. Effectively, the script estimates three hyperparameters that capture the shape of each curve and we find that the estimation works best if we constrain the parameter ranges as outline in <xref ref-type="table" rid="tblS1">Table. S1</xref>.</p>
<table-wrap id="tblS1" orientation="portrait" position="float">
<label>TABLE S1.</label>
<caption><title>Parameter settings for Gaussian Process optimisation.</title></caption>
<graphic xlink:href="608874v1_tblS1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>With a smoothed time series at hand, we now identify ‘plateaus’ of constant growth rate using the functions available in Scipy [<xref ref-type="bibr" rid="c26">26</xref>]. For each growth curve, we start by identifying so-called ‘plateau seeds’, which are small intervals where the second derivative is below a chosen threshold <italic>d</italic><sup>2</sup><italic>f</italic>/<italic>d</italic><sup>2</sup><italic>t</italic>&lt; 5 · 10<sup>−6</sup>. For each ‘plateau seed’ <italic>k</italic> in the growth curve, we calculate the average growth rate ĝ<sub><italic>k</italic></sub> in the time-window of the plateau. Due to some noise in the second derivative, we find many ‘plateau seeds’ that are adjacent and need to be merged. To do so, we iterate over the ‘plateau seeds’ in the growth curve and merge the current candidate <italic>k</italic> with the previous plateau <italic>k</italic> - 1, except one of the following conditions is true:</p>
<list list-type="bullet">
<list-item><p>Both plateaus seeds have a duration that is too long (equal or greater than 100 minutes).</p></list-item>
<list-item><p>The transition time between the plateau seeds is too large (equal or greater than 200 minutes).</p></list-item>
<list-item><p>The first plateau has a significantly different growth rate that the second one, sucht that the following equation is satisfied
<disp-formula id="eqnS37">
<graphic xlink:href="608874v1_eqnS37.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>g</italic><sub><italic>k</italic></sub>, <italic>g</italic><sub><italic>k</italic>−1</sub> are the average growth rate in each plateau (per minute).</p></list-item>
</list>
<p>Empirically, we find that the duration of these merged plateaus is shorter than what one would expect from visually inspecting the growth curve. Therefore we extend the remaining plateaus in each growth curve as follows: For each plateau, we estimate the lower and upper growth rate <italic>df</italic> /<italic>dt</italic> in the time window and take this as a growth rate corridor. We extend the plateau to the left, until <italic>df</italic> /<italic>dt</italic> leaves that growth rate corridor, and similarly extend to the right. By definition, the resulting plateau is equal or larger to the original time-window and we recal the average growth rate over the time window.</p>
<p>From this analysis, we obtain a list of growth phases for each curve that allows us to choose a subset of curves that match our model of population dynamics (Methods). We only choose curves that have two plateaus, where the first plateau has significant growth (exponential phase), and the second plateau has no growth (stationary phase). Here we define significant growth as the average growth rate in the plateau time window is larger or equal to 0.0011 per minute. This forms the set of growth curves that we use to estimate growth traits (9424 curves).</p>
</sec>
<sec id="s5g">
<label>S7.</label>
<title>The saturation time in our model of population dynamics</title>
<p>In this section, we restate an explicit expression for the saturation time <italic>t</italic><sub>sat</sub> in pairwise competition that was derived in earlier work and allows us to see how mutants can influence resource depletion and the wild-type LFC (<xref ref-type="disp-formula" rid="eqn15">Eq. (15)</xref>). Using the same model of population dynamics (Methods, Eq(11)), previous work [<xref ref-type="bibr" rid="c27">27</xref>, <xref ref-type="bibr" rid="c28">28</xref>] derived an approximate formula for <italic>t</italic><sub>sat</sub> that shows how it depends on the underlying parameters:
<disp-formula id="eqnS38">
<graphic xlink:href="608874v1_eqnS38.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where
<disp-formula id="eqnS39">
<graphic xlink:href="608874v1_eqnS39.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
is the effective lag time of the population,
<disp-formula id="eqnS40">
<graphic xlink:href="608874v1_eqnS40.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
is the effective <italic>e</italic>-fold growth time (reciprocal exponential growth rate) of the population,
<disp-formula id="eqnS41">
<graphic xlink:href="608874v1_eqnS41.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
is the effective yield of the population, and
<disp-formula id="eqnS42">
<graphic xlink:href="608874v1_eqnS42.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
is the log fold-change of the total biomass, which depends on the initial absolute abundance <italic>N</italic><sub>0</sub> of all genotypes and the initial concentration of resources <italic>R</italic><sub>0</sub>.</p>
<p>Equation (S38) shows how each competing genotype influences the saturation time <italic>t</italic><sub>sat</sub> and thus the LFCs of all other genotypes via <xref ref-type="disp-formula" rid="eqn15">Eq. (15)</xref>. For example, adding a mutant with slow growth rate increases the effective doubling time (<xref ref-type="disp-formula" rid="eqnS40">Eq. (S40)</xref>), while a mutant with long lag time will increase the effective lag time (<xref ref-type="disp-formula" rid="eqnS39">Eq. (S39)</xref>). Genotypes also influence the saturation time (<xref ref-type="disp-formula" rid="eqnS38">Eq. (S38)</xref>) through the effective yield <inline-formula><inline-graphic xlink:href="608874v1_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, which is the harmonic average of yields for all genotypes (<xref ref-type="disp-formula" rid="eqnS41">Eq. (S41)</xref>). The harmonic aver-age means that adding mutants with low biomass yield <italic>Y</italic><sub><italic>j</italic></sub> can significantly shorten the saturation time, but mutants that are more efficient (high <italic>Y</italic><sub><italic>j</italic></sub>) have little influence on the duration of the growth cycle. Note that genotypes must be at sufficiently high relative abundance to significantly influence the effective population traits, since each the contribution of each genotype <italic>j</italic> is weighted by its relative abundance <italic>x</italic><sub><italic>j</italic></sub>.</p>
</sec>
<sec id="s5h">
<label>S8.</label>
<title>Analysis of fitness trajectories from the long-term evolution experiment</title>
<p>A previous analysis of the Long-Term Evolution Experiment (LTEE) performed by Wiser et al.[<xref ref-type="bibr" rid="c29">29</xref>] found that evolved populations of <italic>Escherichia coli</italic> increased in relative fitness over 50,000 generations without converging to a maximum fitness. Here we re-analyze the same data by directly comparing the relative fitness (under the logit encoding) per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to see if the choice of fitness statistic changes the conclusion. The experimental protocol of the LTEE has been described elsewhere [<xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c30">30</xref>], but we briefly summarize the main aspects: Starting with a single ancestral strain of <italic>E. coli</italic>, 12 replicate populations were inoculated in 1988 and are perpetually grown in batch cultures with serial transfers, such that 1% of the population biomass is transferred to fresh growth medium each day. Samples from each replicate population are stored every 500 generations, leading to a record of evolved populations over time [<xref ref-type="bibr" rid="c30">30</xref>].</p>
<p>Previous work performed competition experiments between the ancestral population and each evolved population (every 500-2000 generations) by combining them in equal proportions and growing them over a single batch culture growth cycle, with measurements of their initial and final absolute abundances taken by colony counting [<xref ref-type="bibr" rid="c29">29</xref>]. This data has been prepared in a convenient format by Good et al. [<xref ref-type="bibr" rid="c31">31</xref>] and is available for download at <ext-link ext-link-type="uri" xlink:href="https://github.com/benjaminhgood/LTEE-metagenomic/blob/master/additional_data/Concatenated.LTEE.data.all.csv">https://github.com/benjaminhgood/LTEE-metagenomic/blob/master/additional_data/Concatenated.LTEE.data.all.csv</ext-link>. For a few of the 12 populations, the time series is truncated: population Ara+6 has competition measurements up to generation 4000, population Ara-2 has competition measurements up to generation 30,000, and population Ara+2 has competition measurements up to generation 32,000 [<xref ref-type="bibr" rid="c29">29</xref>]. Note that the evolved population tested in these competitions is not a single genotype, but a sample of multiple genotypes that were present in that evolving population at that time. From these values of absolute abundance, we compute the log fold-change (LFC) of the evolved and ancestral populations in each competition and then calculate the evolved population’s relative fitness percycle (<xref ref-type="disp-formula" rid="eqnS30">Eq. (S30)</xref>) and per-generation (<xref ref-type="disp-formula" rid="eqnS31">Eq. (S31)</xref>). The original dataset has two to four replicate measurements for each evolved sample, corresponding to a repeat of the competition experiment at a different day [<xref ref-type="bibr" rid="c29">29</xref>]. Initially, we collect all competition experiments into a single dataset (<italic>n</italic> = 928 competitions) and find that relative fitness per-generation and per-cycle differ in the ranking of these competitions (<xref rid="figS9" ref-type="fig">Fig. S9A,B</xref>)For example, one competition is ranked 261 positions lower in relative fitness per-generation than per-cycle (where higher ranks indicate higher fitness). The scatter occurs because the biomass yield evolves downward over time [<xref ref-type="bibr" rid="c32">32</xref>, <xref ref-type="bibr" rid="c33">33</xref>]. We can understand the ranking mismatch from the underlying LFCs in the competition experiment (<xref rid="figS9" ref-type="fig">Fig. S9C</xref>), that show considerable scatter, with some mutant-wild-type pairs in a positive covariation (compare <xref rid="figS9" ref-type="fig">Fig. S9C</xref> and <xref rid="fig1" ref-type="fig">Fig. 1D</xref>). The scatter occurs because the biomass yield evolves downward over time [<xref ref-type="bibr" rid="c32">32</xref>, <xref ref-type="bibr" rid="c33">33</xref>], shifting the wild-type LFCs downward in 50:50 competitions with the evolved populations (horizontal trend across time points in <xref rid="figS9" ref-type="fig">Fig. S9C</xref>).</p>
<p>We can also construct a timeseries of relative fitness for each population and compare fitness rankings at a individual time points. For each of the 12 populations in the LTEE, we define the relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula> at time <italic>t</italic> by averaging the value <inline-formula><inline-graphic xlink:href="608874v1_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula> across all competition experiments with the frozen sample from time <italic>t</italic>. Simlarly, we define a timeseries of relative fitness percycle <inline-formula><inline-graphic xlink:href="608874v1_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for each population. In summary, we can pool all time series into a single dataset (with the truncation described above) and test how the two statistics rank the 12 populations at any point in the experiment. We find that the mismatch between relative fitness per-cycle and per-generation is consistenly low at all time points (<xref rid="figS10" ref-type="fig">Fig. S10</xref>), with a few exceptions (for example, at generation 4,000 the two statistics disagree on the top six populations).</p>
<p>A key result from previous analysis on this dataset is that the evolving populations increase indefinitely in relative fitness, rather than leveling off at some maximum fitness value. The original analysis by Wiser et al. [<xref ref-type="bibr" rid="c29">29</xref>] tested the long-term trend by fitting the statistic <inline-formula><inline-graphic xlink:href="608874v1_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to a hyperbolic model of the time series:
<disp-formula id="eqnS43">
<graphic xlink:href="608874v1_eqnS43.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>t</italic> is the evolutionary time point at which the evolved population is measured against its ancestor, and <italic>f</italic>(<italic>t</italic>) is the fitness statistic measured from that competition (here fitted to the measured values of <italic>W</italic>). The important feature of the hyperbolic model is that it assumes that relative fitness saturates at a maximum fitness over long times (lim<sub><italic>t</italic>→∞</sub> <italic>f</italic>(<italic>t</italic>) = 1 + <italic>a</italic>). To contrast this model, they also tested a power law
<disp-formula id="eqnS44">
<graphic xlink:href="608874v1_eqnS44.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
under which fitness increases without bound over long times (lim<sub><italic>t</italic>→∞</sub> <italic>f</italic>(<italic>t</italic>) = ∞). To repeat this analysis with the fitness statistics <inline-formula><inline-graphic xlink:href="608874v1_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="608874v1_inline31.gif" mime-subtype="gif" mimetype="image"/></inline-formula> used in this article, we must adjust the models to account for the fact that <italic>W</italic> takes 1 as its neutral value (occurring at <italic>t</italic> = 0 by definition) while <inline-formula><inline-graphic xlink:href="608874v1_inline32.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="608874v1_inline33.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are zero under neutrality.</p>
<p>Thus we use
<disp-formula id="eqnS45">
<graphic xlink:href="608874v1_eqnS45.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
as the hyperbolic model and
<disp-formula id="eqnS46">
<graphic xlink:href="608874v1_eqnS46.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
as the power law model.</p>
<p>As a control against the original analysis of Wiser et al. [<xref ref-type="bibr" rid="c29">29</xref>], we first perform our own fit of the time series of the relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline34.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to the hyper-bolic (<xref ref-type="disp-formula" rid="eqnS45">Eq. (S45)</xref>) and the power law (<xref ref-type="disp-formula" rid="eqnS46">Eq. (S46)</xref>) models. Wiser et al. compared their two models using the Bayesian Information Criterion [<xref ref-type="bibr" rid="c29">29</xref>], but since the models have the same number of parameters this is mathematically equivalent to comparing the values of <italic>R</italic><sup>2</sup>. <xref rid="figS11" ref-type="fig">Figure S11A</xref> shows that in our analysis, the power law model has a higher quality of fit (<italic>R</italic><sup>2</sup> = 0.701) than the hyperbolic model does (<italic>R</italic><sup>2</sup> = 0.682) for the fitness statistic <inline-formula><inline-graphic xlink:href="608874v1_inline35.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, consistent with the original result by Wiser et al. for the statistic <inline-formula><inline-graphic xlink:href="608874v1_inline36.gif" mime-subtype="gif" mimetype="image"/></inline-formula> [<xref ref-type="bibr" rid="c29">29</xref>]. Since the equations for the hyperbolic model only differ in the constant offset (compare <xref ref-type="disp-formula" rid="eqnS43">Eqs. (S43)</xref> and <xref ref-type="disp-formula" rid="eqnS45">(S45)</xref>), our fit of <inline-formula><inline-graphic xlink:href="608874v1_inline37.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to <xref ref-type="disp-formula" rid="eqnS45">Eq. (S45)</xref> is mathematically equivalent to the fit of <italic>W</italic> to <xref ref-type="disp-formula" rid="eqnS43">Eq. (S43)</xref>. Therefore, our fit should give the exact same results as the original publication [<xref ref-type="bibr" rid="c29">29</xref>] in the case of the hyperbolic model (but we couldn’t fit the fitted values <italic>a, b</italic> in [<xref ref-type="bibr" rid="c29">29</xref>] so we were unable to check it). This is not true for the power law, because the modified power law used by Wiser et al. [<xref ref-type="bibr" rid="c29">29</xref>] (<xref ref-type="disp-formula" rid="eqnS44">Eq. (S44)</xref>) includes the offset within the parentheses, rather than as an added constant outside (compare <xref ref-type="disp-formula" rid="eqnS44">Eq. (S44)</xref> to <xref ref-type="disp-formula" rid="eqnS46">Eq. (S46)</xref>). This means that the fit of <italic>W</italic> to the power law with an initial value of 1 (<xref ref-type="disp-formula" rid="eqnS44">Eq. (S44)</xref>, fitted values <italic>α</italic> = 0.00515, <italic>β</italic> = 0.0950; matching [<xref ref-type="bibr" rid="c29">29</xref>]) is different from the fit of <inline-formula><inline-graphic xlink:href="608874v1_inline38.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to the power law with an initial value of zero (<xref ref-type="disp-formula" rid="eqnS46">Eq. (S46)</xref>, fitted values <italic>α</italic> = 0.000007, <italic>β</italic> = 0.299891).</p>
<p>We next perform a new analysis by calculating the relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline39.gif" mime-subtype="gif" mimetype="image"/></inline-formula> from the same timeseries data (12 timeseries pooled together, one for each line) and fitting this fitness statistic to the same hyperbolic (<xref ref-type="disp-formula" rid="eqnS45">Eq. (S45)</xref>) and power law (<xref ref-type="disp-formula" rid="eqnS46">Eq. (S46)</xref>) models. As shown in <xref rid="figS11" ref-type="fig">Fig. S11B</xref>, we find that the power law model outperforms the hyperbolic model for the per-cycle fitness, consistent with the model performance for the per-generation fitness. This suggests that Wiser et al.’s original conclusion about fitness increasing with-out bound [<xref ref-type="bibr" rid="c29">29</xref>] is robust to the choice of fitness statistic.</p>
<p>As we previously mentioned, the fitness measurements of all replicate populations are not uniform across time (<xref rid="figS11" ref-type="fig">Fig. S11A</xref>): there are fewer fitness measurements at late time points (generation 34,000 and higher) because three populations were eventually excluded from the fitness measurements [<xref ref-type="bibr" rid="c29">29</xref>]. To further corroborate our results, we thus repeat the model fits using a single time series of the evolved fitness, rather than fitting the models to a all 12 fitness time series simultaneously. We calculate the average fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline40.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline41.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in the evolution experiment as the average across all 12 populations at each time point and fit this population-averaged time series to the hyperbolic (<xref ref-type="disp-formula" rid="eqnS45">Eq. (S45)</xref>) and power law (<xref ref-type="disp-formula" rid="eqnS46">Eq. (S46)</xref>) models (Wiser et al [<xref ref-type="bibr" rid="c29">29</xref>] refer to this as a fit to the “grand mean“). <xref rid="figS11" ref-type="fig">Figure S11C,D</xref> shows that the power law still has a better quality of fit than the hyperbolic model does, and we thus conclude that the increasing fitness trend reported by Wiser et al. [<xref ref-type="bibr" rid="c29">29</xref>] is also robust to the uneven distribution of measurements over time.</p>
<p>We note that the quality of fit <italic>R</italic> reported in the main text of Wiser et al. [<xref ref-type="bibr" rid="c29">29</xref>] differs from the quality of fit we show on our plots. While both studies performed the fits of the models on all 12 populations simultaneously, Wiser et al. [<xref ref-type="bibr" rid="c29">29</xref>] evaluated the quality of fit by calculating <italic>R</italic> for the fitted model (blue and pink lines in <xref rid="figS11" ref-type="fig">Fig. S11A</xref>) against the fitness time series averaged over replicates (grey points in <xref rid="figS11" ref-type="fig">Fig. S11C</xref>). That is, they fit the model to the data without averaging over population but calculate quality of fit using the population-averaged data. Since we believe this was inconsistent, we have followed a more standard approach of calculating the quality of fit on the same input data used for the fit (i.e., correlating the blue and pink lines in <xref rid="figS11" ref-type="fig">Fig. S11A</xref> with grey points in the same plot). As a consequence, the correlations between the fitted models and data reported in the original publication (hyperbolic <italic>R</italic> = 0.969, power law <italic>R</italic> = 0.986; see [<xref ref-type="bibr" rid="c29">29</xref>]) are systematically higher than the values we find in our re-analysis (hyperbolic <italic>R</italic> = 0.826, power law: <italic>R</italic> = 0.837; take square root of the values in <xref rid="figS11" ref-type="fig">Fig. S11A</xref>). Although the long-term fitness dynamics in the case of the LTEE are robust to the choice of fitness statistic, we note that it is possible to construct scenarios of microbial growth trait evolution where relative fitness saturates in one statistic but not in the other (<xref rid="fig3" ref-type="fig">Fig. 3</xref>). For theory work that on the long-term trend and other models than the powerlaw or hyperbolic model tested here, see [<xref ref-type="bibr" rid="c34">34</xref>–<xref ref-type="bibr" rid="c36">36</xref>].</p>
</sec>
<sec id="s5i">
<label>S9.</label>
<title>Testing AUC and other fitness potentials using simulated competition experiments</title>
<p>In this section we explain our tests of estimated fitness potentials against true relative fitness in simulated competition experiments. We first focus on the area under the growth curve (AUC), which is defined as
<disp-formula id="eqnS47">
<graphic xlink:href="608874v1_eqnS47.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>N(t) is a</italic> growth curve of absolute abundance (or a proxy such as optical density) and <italic>t</italic><sub>eval</sub> is a cut-off time for evaluating the area. Many previous studies [<xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c37">37</xref>, <xref ref-type="bibr" rid="c38">38</xref>] and growth curve analysis packages [<xref ref-type="bibr" rid="c39">39</xref>] have used this definition. The idea of AUC is that, unlike estimated fitness potentials that only account for individual traits of a genotype’s growth (e.g., growth rate or lag time; see below), the AUC literally integrates the whole growth dynamics into a single number. For example, both fast growth rate and short lag time are manifested in greater AUC. Note that while one can attempt to use the AUC as an approximate fitness potential (as we investigate here), it is not a measure of absolute fitness (Sec. S3) since it is insufficient to predict changes in absolute abundance (i.e., the area under the growth curve does not determine the change in absolute abundance from beginning to end).</p>
<p>To compute the AUC for the set of single-gene deletion genotypes in our data set, we first simulate a growth curve for each genotype under the population dynamics model in <xref ref-type="disp-formula" rid="eqn11a">Eq. (11)</xref> with the traits estimated from the original data (Methods). We use simulated growth curves, with trait values inferred from the measured growth curves, rather than the actual measured growth curves since we are comparing the AUCs to relative fitness also from simulations of competitions; we do not have actual competition data for these genotypes, so it would be an apples-to-oranges comparison if we used AUCs from the actual growth curve data. Furthermore, in empirical growth curves, the AUC is also influenced by technical variation in the initial biomass <italic>N</italic><sub>0</sub> and the initial concentration of resources <italic>R</italic><sub>0</sub>, so using simulations removes these effects.</p>
<p><xref rid="figS14" ref-type="fig">Figure S14A</xref> shows the distribution of saturation times <italic>t</italic><sub>sat</sub> (as defined for the population dynamics model in Methods) numerically calculated for all simulated growth curves of the deletion mutants. We calculate the AUC for each growth curve using <xref ref-type="disp-formula" rid="eqnS47">Eq. (S47)</xref> with an evaluation time of <italic>t</italic><sub>eval</sub> = 16 hours, since that includes the stationary phase in the vast majority of our simulated growth curves (<xref rid="figS14" ref-type="fig">Fig. S14A</xref>). From the mutant’s AUC we calculate the AUC-based estimator of the mutant’s relative fitness
<disp-formula id="eqnS48">
<graphic xlink:href="608874v1_eqnS48.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where AUC<sub>wt</sub> is the AUC for a simulated growth curve of the wild-type (using the median wild-type traits in our database; see Methods). We then simulate a single growth cycle of the mutant competing against the wild-type (<xref ref-type="disp-formula" rid="eqn11a">Eq. (11)</xref> with equal initial abundance of the mutant and wild-type) to calculate the mutant’s “true” (under the model assumptions) relative fitness per-cycle with the logit encoding <inline-formula><inline-graphic xlink:href="608874v1_inline42.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We simulate both the coculture and the monoculture growth dynamics with the same initial biomass <italic>N</italic><sub>0</sub> = 0.05 OD and resource concentration <italic>R</italic><sub>0</sub> = 111 mM [<xref ref-type="bibr" rid="c24">24</xref>]. Repeating this analysis for all mutant genotypes in the dataset, we calculate the Spearman rank correlation between the AUC-predicted relative fitness from monoculture <italic>ŝ</italic><sub>AUC</sub> and the true relative fitness in competition <inline-formula><inline-graphic xlink:href="608874v1_inline43.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref rid="figS13" ref-type="fig">Fig. S13</xref>, column C).</p>
<p>The success of the AUC depends on the evaluation time <italic>t</italic><sub>eval</sub>, which sets the time window from which information is captured from the growth curve by the integral (<xref ref-type="disp-formula" rid="eqnS47">Eq. (S47)</xref>). <xref rid="figS14" ref-type="fig">Figure S14B–D</xref> shows the correlation between the relative fitness in coculture <inline-formula><inline-graphic xlink:href="608874v1_inline44.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and the AUC estimator ŝ<sub>AUC</sub> (<xref ref-type="disp-formula" rid="eqnS48">Eq. (S48)</xref>) for three values of <italic>t</italic><sub>eval</sub>: the mean saturation time of all genotypes in monoculture (<italic>t</italic><sub>eval</sub> ≈ 13 hours), a significant longer value (<italic>t</italic><sub>eval</sub> ≈ 24 hours), and an intermediate value (<italic>t</italic><sub>eval</sub> = ≈ 16 hours; used for <xref rid="figS13" ref-type="fig">Fig. S13</xref>). For short evaluation times (<italic>t</italic><sub>eval</sub> ≈ 13 hours), the AUC underestimates the fitness of mutants with long lag but fast growth, which leads to a nonlinear relationship between the AUC estimator and the true relative fitness (compare <xref rid="figS14" ref-type="fig">Fig. S14B</xref> and <xref rid="figS14" ref-type="fig">Fig. S14C</xref>). For long evaluation times (<italic>t</italic><sub>eval</sub> = 24 hours), there is greater scatter between the AUC predictor and true relative fitness for the highest fitness mutants (compare spread in <xref rid="figS14" ref-type="fig">Fig. S14D</xref> and <xref rid="figS14" ref-type="fig">Fig. S14C</xref>). Intuitively, these mutants have short lag time or fast growth rate and saturate early in monoculture, so their AUC values are effectively set by the biomass yield, which has no predictive value on the competition outcome. In summary, <xref rid="figS14" ref-type="fig">Fig. S14B–D</xref> shows a trade-off between accurately ranking highly-deleterious mutants (which needs long <italic>t</italic><sub>eval</sub>) and ranking highly-beneficial mutants (which need short <italic>t</italic><sub>eval</sub>).</p>
<p>Besides AUC it is possible to use other features of the monoculture growth curve as approximate fitness potentials. For example, one can use the monoculture growth rates alone as fitness potentials:
<disp-formula id="eqnS49">
<graphic xlink:href="608874v1_eqnS49.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
or the monoculture lag times:
<disp-formula id="eqnS50">
<graphic xlink:href="608874v1_eqnS50.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Another possible fitness potential is the absolute abundance at saturation, which in our model of population dynamics (<xref ref-type="disp-formula" rid="eqn11a">Eq. (11)</xref>) is proportional to the biomass yield:
<disp-formula id="eqnS51">
<graphic xlink:href="608874v1_eqnS51.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Finally, one can also use the difference in the monoculture log fold-changes (LFCs):
<disp-formula id="eqnS52">
<graphic xlink:href="608874v1_eqnS52.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>This looks similar to the definition of relative fitness percycle (<xref ref-type="disp-formula" rid="eqnS30">Eq. (S30)</xref>) but is distinct because it uses the LFCs in monoculture rather than the true LFCs in coculture (which may be different).</p>
<p>We test each of these fitness potentials against the relative fitness in pairwise competition, using different input datasets of trait variation and the ‘GNU Parallel’ command to speed up the simulation process [<xref ref-type="bibr" rid="c40">40</xref>]. <xref rid="figS13" ref-type="fig">Figure S13</xref> rows B and C show that growth rate and lag time can act as perfect fitness potentials if that trait is the only trait with variation across mutants. This is because the relative fitness is proportional to differences in each of these traits when they are the only source of variation (see Sec. S13). Section S13 also shows that differences in biomass yield (<italic>Y</italic><sub>mut</sub> − <italic>Y</italic><sub>wt</sub>) have no effect on fitness by themselves, which is why the biomass yield of the strains in monoculture is a poor fitness potential to estimate relative fitness. This large but neutral variation in the biomass yield across mutants in our datasets means that the LFC is also a poor fitness potential.</p>
<p>All of these trait-based fitness potentials are outperformed by the AUC, which provides the best approximation of the mutant fitness ranking in coculture under realistic trait variation (<xref rid="figS13" ref-type="fig">Fig. S13</xref>, row A). More broadly, it is important to treat absolute and relative fitness, as well as fitness potentials, as distinct concepts, serving different purposes [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c41">41</xref>]. As we show here in simulation (<xref rid="figS13" ref-type="fig">Fig. S13</xref>), and others have shown in experiments [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c43">43</xref>], measuring fitness potentials is not enough to demonstrate that a mutant genotype will outcompete the wild-type.</p>
</sec>
<sec id="s5j">
<label>S10.</label>
<title>Coarse-graining pairwise relative fitness in multi-genotype populations</title>
<p>In this section, we point out the specific advantages of the logit-encoding for coarse-graining pairwise relative fitness in bulk competition experiments. While the pair-wise relative fitness is defined for any encoding m, the logit encoding endows it with some convenient mathematical properties not shared by other encodings (e.g., the log encoding). The logit encoding of the pairwise relative abundance has the property
<disp-formula id="eqnS53">
<graphic xlink:href="608874v1_eqnS53.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
meaning that it is antisymmetric under exchange of the indices <italic>i</italic> and <italic>j</italic> (logit <italic>x</italic><sub><italic>ij</italic></sub> = − logit <italic>x</italic><sub><italic>ji</italic></sub>) and additive across pairs of indices (logit <italic>x</italic><sub><italic>ij</italic></sub> = logit <italic>x</italic><sub><italic>ik</italic></sub> + logit <italic>x</italic><sub><italic>kj</italic></sub>). Since the logit-encoded pairwise relative fitness is just the time derivative of the logit function (<xref ref-type="disp-formula" rid="eqn19">Eq. (19)</xref>), it carries equivalent properties of antisymmetry and additivity:
<disp-formula id="eqnS54">
<graphic xlink:href="608874v1_eqnS54.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqnS55">
<graphic xlink:href="608874v1_eqnS55.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>We also note that the logit encoding of the pairwise relative abundance has the property:
<disp-formula id="eqnS56">
<graphic xlink:href="608874v1_eqnS56.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Rescaling the relative abundances of either genotype thus does not change the pairwise relative fitness (since it only shifts the logit by a constant, which does not affect its derivative). This means that pairwise relative fitness is an “intensive” property of a genotype, analogous to intensive properties in statistical mechanics (such as temperature) that do not scale with system size. For example, if we split a mutant genotype into two subgroups (e.g., differentiated by a neutral marker), the pairwise relative fitness of each mutant subgroup with respect to the wild-type will be the same as the pairwise relative fitness of the mutant genotype as a whole compared to the wild-type. In contrast, the logit-encoded total relative fitness does not satisfy this property since logit(<italic>ax</italic><sub><italic>i</italic></sub>) ≠ logit <italic>x</italic><sub><italic>i</italic></sub>+ constant.</p>
<p>When the encoding <italic>m</italic> is the logit function, the pairwise relative fitness per-cycle still satisfies the above properties (antisymmetry and additivity with respect to indices <italic>i, j</italic>, and invariance under relative abundance rescaling) since those are properties of the underlying logit encoding. This is also apparent from interpreting the per-cycle fitness statistic as an integral of the instantaneous statistic:
<disp-formula id="eqnS57">
<graphic xlink:href="608874v1_eqnS57.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s5k">
<label>S11.</label>
<title>The relative fitness between coarse-grained groups of genotypes</title>
<p>In this section, we generalize the concept of pairwise relative fitness to pairs of genotype groups rather than pairs of individual genotypes. In a multi-genotype population with non-overlapping subsets of genotypes 𝒜 and ℬ, define
<disp-formula id="eqnS58">
<graphic xlink:href="608874v1_eqnS58.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
as the relative abundance of 𝒜 genotypes compared to ℬ genotypes at time <italic>t</italic>. Analogous with <xref ref-type="disp-formula" rid="eqn19">Eq. (19)</xref>, we define the fitness of group 𝒜 relative to group ℬ as
<disp-formula id="eqnS59">
<graphic xlink:href="608874v1_eqnS59.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
for an encoding <italic>m</italic>. Under the logit encoding, it turns out that the fitness between these two groups can be conve-niently expressed as a weighted average of the pairwise fitness between the member genotypes in each group:
<disp-formula id="eqnS60">
<graphic xlink:href="608874v1_eqnS60.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>To prove <xref ref-type="disp-formula" rid="eqnS60">Eq. (S60)</xref>, we first note that
<disp-formula id="eqnS61">
<graphic xlink:href="608874v1_eqnS61.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Thus we can rewrite the logit-encoded relative pairwise fitness between 𝒜 and ℬ as
<disp-formula id="eqnS62">
<graphic xlink:href="608874v1_eqnS62.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where we have invoked <xref ref-type="disp-formula" rid="eqnS61">Eq. (S61)</xref> on the second line. We can expand each term on the right-hand side of <xref ref-type="disp-formula" rid="eqnS62">Eq. (S62)</xref> as
<disp-formula id="eqnS63">
<graphic xlink:href="608874v1_eqnS63.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
and then insert <xref ref-type="disp-formula" rid="eqnS63">Eq. (S63)</xref> into <xref ref-type="disp-formula" rid="eqnS62">Eq. (S62)</xref> to obtain
<disp-formula id="eqnS64">
<graphic xlink:href="608874v1_eqnS64.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where we have collected the normalization factors (sums over relative abundances in 𝒜 and ℬ) as a single prefactor. We then rewrite each product of sums in <xref ref-type="disp-formula" rid="eqnS64">Eq. (S64)</xref> as
<disp-formula id="eqnS65">
<graphic xlink:href="608874v1_eqnS65.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
to finally obtain
<disp-formula id="eqnS66">
<graphic xlink:href="608874v1_eqnS66.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Identifying the term in the inner parentheses as the pair-wise selection coefficient <inline-formula><inline-graphic xlink:href="608874v1_inline45.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqn19">Eq. (19)</xref>) then results in <xref ref-type="disp-formula" rid="eqnS60">Eq. (S60)</xref>.</p>
<p>Equation (S60) establishes that the relative fitness between a pair of genotype groups is a weighted sum of relative fitnesses between individual pairs of genotypes in those groups, but this holds for relative fitness defined at an instant in time (since it is based on derivatives). For relative fitness defined over a finite time interval (e.g., a growth cycle in batch culture), an analogous but approximate result holds. We first write the relative fitness over a growth cycle time interval as an integral over the instantaneous relative fitness (inserting <xref ref-type="disp-formula" rid="eqnS60">Eq. (S60)</xref> into <xref ref-type="disp-formula" rid="eqnS57">Eq. (S57)</xref>):
<disp-formula id="eqnS67">
<graphic xlink:href="608874v1_eqnS67.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>t</italic><sub>sat</sub> is the end time of the growth cycle (Methods, Sec. S7). The integral in <xref ref-type="disp-formula" rid="eqnS67">Eq. (S67)</xref> is difficult to calculate as the relative abundance trajectories <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>), <italic>x</italic><sub><italic>j</italic></sub>(<italic>t</italic>) depend on the relative fitness of the genotypes <inline-formula><inline-graphic xlink:href="608874v1_inline46.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in a non-trivial way. Instead, we make the approximation that the relative abundances do not change significantly over time of the growth cycle (<italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>) ≈ <italic>x</italic><sub><italic>j</italic></sub>(0)) and can thus pass the integral through the sums in <xref ref-type="disp-formula" rid="eqnS67">Eq. (S67)</xref> to show that the per-cycle relative fitness between a pair of genotype groups is approximately also a weighted sum of per-cycle relative fitnesses:
<disp-formula id="eqnS68">
<graphic xlink:href="608874v1_eqnS68.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Conceptually, assuming the relative abundances are approximately constant over the growth cycle is equivalent to assuming selection is weak; one can also show this mathematically by expressing the relative abundances <italic>x</italic><sub><italic>i</italic></sub>(<italic>t</italic>) in terms of the pairwise relative fitnesses <inline-formula><inline-graphic xlink:href="608874v1_inline47.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in <xref ref-type="disp-formula" rid="eqnS67">Eq. (S67)</xref> and keeping only terms to leading order in <inline-formula><inline-graphic xlink:href="608874v1_inline48.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
<p>We finally note that the total relative fitness (instantaneous <xref ref-type="disp-formula" rid="eqn17">Eq. (17)</xref> and per-cycle <xref ref-type="disp-formula" rid="eqn20">Eq. (20)</xref>) is a special case of the relative fitness between groups (<xref ref-type="disp-formula" rid="eqnS60">Eqs. (S60)</xref> and <xref ref-type="disp-formula" rid="eqnS68">(S68)</xref>) where 𝒜 is the single genotype i and ℬ is all other geno-types besides <italic>i</italic>:
<disp-formula id="eqnS69">
<graphic xlink:href="608874v1_eqnS69.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqnS70">
<graphic xlink:href="608874v1_eqnS70.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s5l">
<label>S12.</label>
<title>Fitness error from the frame of reference in bulk competition experiments</title>
<p>Here we calculate the error that arises from measuring the total relative fitness of each mutant in a bulk competition experiment of a mutant library, rather than the pairwise relative fitness between each mutant and the wild-type. We call this difference the <italic>error from the frame of reference</italic>, the frame of reference being either the whole population in total fitness or the wild-type in pairwise fitness. Note that this is an error between two different fitness quantifications of the same bulk competition experiment; Sec. S14 addresses the error (arising from higher-order interactions) between fitness quantifications in bulk versus pairwise competition experiments. Here we only consider relative fitness under the logit encoding and measured per growth cycle, so we drop these labels to simplify notation.</p>
<p>Consider a bulk competition experiment of a wild-type and a library of large number of mutants over a single batch growth cycle of time <italic>t</italic><sub>sat</sub> (Methods). The total relative fitness of mutant <italic>i</italic> is (<xref ref-type="disp-formula" rid="eqn20">Eq. (20)</xref>)
<disp-formula id="eqnS71">
<graphic xlink:href="608874v1_eqnS71.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
while its pairwise relative fitness compared to the wild-type is (<xref ref-type="disp-formula" rid="eqn21">Eq. (21)</xref>)
<disp-formula id="eqnS72">
<graphic xlink:href="608874v1_eqnS72.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Using the coarse-graining rules from Sec. S11 (namely <xref ref-type="disp-formula" rid="eqnS68">Eqs. (S68)</xref> and <xref ref-type="disp-formula" rid="eqnS70">(S70)</xref>), we can express the total relative fitness of mutant <italic>i</italic> as a weighted sum of the pairwise relative fitnesses between the mutant and the wild-type and between the mutant and the rest of the mutant library:
<disp-formula id="eqnS73">
<graphic xlink:href="608874v1_eqnS73.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where the notation lib \ <italic>i</italic> refers to the mutant library excluding the mutant <italic>i</italic>. The approximation here is due to our assumption in <xref ref-type="disp-formula" rid="eqnS68">Eq. (S68)</xref> that selection is weak enough that the relative abundances of genotypes do not change too much over the growth cycle. Since we can rewrite the pairwise relative fitness between mutant <italic>i</italic> and the rest of the library as a difference between <italic>i</italic> and the wild-type and the rest of the library and the wild-type (using <xref ref-type="disp-formula" rid="eqnS55">Eq. (S55)</xref>)
<disp-formula id="eqnS74">
<graphic xlink:href="608874v1_eqnS74.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
we insert this into <xref ref-type="disp-formula" rid="eqnS73">Eq. (S73)</xref> to obtain
<disp-formula id="eqnS75">
<graphic xlink:href="608874v1_eqnS75.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The difference between the total and pairwise relative fitness is therefore
<disp-formula id="eqnS76">
<graphic xlink:href="608874v1_eqnS76.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Since mutant libraries in these experiments typically contain hundreds or thousands of mutants, the contribution of a single mutant <italic>i</italic> is small and thus we can assume that the properties of the mutant library excluding mutant <italic>i</italic> (lib \ <italic>i</italic>) are approximately the same as the library as a whole (so that <italic>x</italic><sub>lib\<italic>i</italic></sub> ≈ <italic>x</italic><sub>lib</sub>, <italic>s</italic><sub>lib\<italic>i</italic>,wt</sub> ≈ <italic>s</italic><sub>lib,wt</sub>). This allows us to further simplify the error as
<disp-formula id="eqnS77">
<graphic xlink:href="608874v1_eqnS77.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Equation (S77) shows why this offset between the total and pairwise relative fitnesses is approximately independent of the focal mutant <italic>i</italic> (hence the constant shift for all mutant points in main text <xref rid="fig4" ref-type="fig">Fig. 4C</xref>). The sign of the error from the frame of reference depends on the mean fitness of the mutant library: a mutant library that is overall deleterious relative to the wild-type (<italic>s</italic><sub>lib,wt</sub> &lt; 0) causes the total relative fitness for a mutant <italic>σ</italic><sub><italic>i</italic></sub> to overestimate the mutant’s pairwise relative fitness <italic>s</italic><sub><italic>i</italic>,wt</sub>. Intuitively, this is because the total relative fitness is comparing the mutant to a mixed population of wild-type and other mutants, which are on average worse competitors than the wild-type, which thus makes the mutant appear to be better than if it is just compared to the wild-type alone (compare top and bottom panel in <xref rid="fig4" ref-type="fig">Fig. 4B</xref>). Equation (S77) also shows that the error from the frame of reference can be reduced if the mutant library is neutral relative to the wild-type (<italic>s</italic><sub>lib,wt</sub> = 0) or the mutant library has small relative abundance in the culture biomass (<italic>x</italic><sub>lib</sub> ≪ 1). In bulk competition experiments with barcoded mutant libraries, these assumptions are often not met since the mutant libraries tend to be overall deleterious (as in our simulated bulk competition for the yeast single-gene knockouts, see <xref rid="figS6" ref-type="fig">Fig. S6</xref>) and are inoculated at a high relative abundance [<xref ref-type="bibr" rid="c44">44</xref>–<xref ref-type="bibr" rid="c48">48</xref>] Since this makes the error in <xref ref-type="disp-formula" rid="eqnS77">Eq. (S77)</xref> significant, we instead recommend including barcoded wild-type strains as references in the bulk competition, so that pairwise fitness can be quantified relative to that (<xref ref-type="disp-formula" rid="eqnS72">Eq. (S72)</xref>) rather than using the total relative fitness. By using a mix of barcoded wild-type cells and non-barcoded wild-type cells it is further possible to optimize this protocol and save on sequencing investment [<xref ref-type="bibr" rid="c49">49</xref>].</p>
<p>Finally, we want to point out a difference between the best practice we recommend here (Discussion) and a wide-spread practice in estimating fitness estimates in bulk competition experiments. In practice, transposon-seq experiments that grow the mutant library by itself start with an estimate of total relative fitness, and then subtract the median total relative fitness of the knockouts [<xref ref-type="bibr" rid="c45">45</xref>–<xref ref-type="bibr" rid="c47">47</xref>, <xref ref-type="bibr" rid="c50">50</xref>] or a mean total relative fitness [<xref ref-type="bibr" rid="c44">44</xref>, <xref ref-type="bibr" rid="c51">51</xref>, <xref ref-type="bibr" rid="c52">52</xref>]. However, these corrections are not explicitly founded in the choice of a reference group (like a set of neutral genotypes or a wild-type), making the correction appear ad-hoc [<xref ref-type="bibr" rid="c45">45</xref>, <xref ref-type="bibr" rid="c47">47</xref>, <xref ref-type="bibr" rid="c50">50</xref>], or the reference is a strain that is not part of the culture, like in the fitness estimates for barcoded lineages that are evaluated against the initial ancestor without that ancestor actually being present [<xref ref-type="bibr" rid="c44">44</xref>, <xref ref-type="bibr" rid="c51">51</xref>, <xref ref-type="bibr" rid="c52">52</xref>]. To make things more confusing, even those studies that do include a wild-type then describe their method as an estimate of total relative fitness of the mutant under the log encoding, subtracted by the total relative fitness of the wild-type under the log-encoding [<xref ref-type="bibr" rid="c49">49</xref>, <xref ref-type="bibr" rid="c53">53</xref>, <xref ref-type="bibr" rid="c54">54</xref>]. The result is a pairwise relative fitness under the logit-encoding (<xref ref-type="disp-formula" rid="eqn23">Eq. (23)</xref>) but presenting it this way obscures that choice of encoding and the relationship to the classic, logit-based selection coefficient used in pairwise competition experiments (<xref ref-type="disp-formula" rid="eqn6">Eq. (6)</xref>). We hope that our framework can provide more clarity: The choice of the reference group happens at the level of relative abundance, by calculating a pairwise relative abundance (<xref ref-type="disp-formula" rid="eqn18">Eq. (18)</xref> or <xref ref-type="disp-formula" rid="eqnS58">Eq. (S58)</xref>), and this removes the need for any correction on the fitness values themselves.</p>
</sec>
<sec id="s5m">
<label>S13.</label>
<title>Pairwise relative fitness using an explicit model of population dynamics</title>
<p>In the model of population dynamics (Methods, <xref ref-type="disp-formula" rid="eqn11a">Eq. (11)</xref>), we can calculate the pairwise relative fitness of genotypes based on the approximation of the saturation time (Sec. S7; [<xref ref-type="bibr" rid="c27">27</xref>, <xref ref-type="bibr" rid="c28">28</xref>]). The pairwise relative fitness of genotype <italic>i</italic> relative to genotype <italic>j</italic> (per-cycle and under the logit encoding) is
<disp-formula id="eqnS78a">
<graphic xlink:href="608874v1_eqnS78a.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where
<disp-formula id="eqnS78b">
<graphic xlink:href="608874v1_eqnS78b.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqnS78c">
<graphic xlink:href="608874v1_eqnS78c.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqnS78d">
<graphic xlink:href="608874v1_eqnS78d.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The <italic>e</italic>-fold growth time for genotype <italic>j</italic> is <italic>τ</italic><sub><italic>j</italic></sub> = 1/<italic>g</italic><sub><italic>j</italic></sub>, and the terms Δλ<sub><italic>ij</italic></sub> = λ<sub><italic>i</italic></sub> − λ<sub><italic>j</italic></sub> and Δ<italic>τ</italic><sub><italic>ij</italic></sub> = <italic>τ</italic><sub><italic>i</italic></sub> − <italic>τ</italic><sub><italic>j</italic></sub> are the differences between the two genotypes lag times and growth times. Since the terms in Eq.(S78d) depend on the covariation between growth and lag, we interpret these terms as couplings between the growth and lag phases; they are zero if only two genotypes are present.</p>
</sec>
<sec id="s5n">
<label>S14.</label>
<title>Fitness error from higher-order interactions between pairwise and bulk competition experiments</title>
<p>In this section, we calculate the error in relative fitness of a mutant arising from higher-order interactions in bulk competition experiments with large mutant libraries, compared to the “true” relative fitness in pairwise competitions between just the focal mutant and wild-type alone. Here we only consider relative fitness under the logit encoding and measured per growth cycle, so we drop these labels to simplify notation. Let the pairwise relative fitness of mutant <italic>i</italic> compared to the wild-type (<xref ref-type="disp-formula" rid="eqn21">Eq. (21)</xref>) be
<disp-formula id="eqnS79">
<graphic xlink:href="608874v1_eqnS79.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
in the pairwise competition with the wild-type alone, and
<disp-formula id="eqnS80">
<graphic xlink:href="608874v1_eqnS80.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
in the bulk competition with all other mutants in the library. The superscripts pair and bulk indicate that the dynamics of <italic>x</italic><sub><italic>i</italic>,wt</sub>(<italic>t</italic>) and the saturation time <italic>t</italic><sub>sat</sub> may be different in the two competitions. The difference between these two measurements of relative fitness is
<disp-formula id="eqnS81">
<graphic xlink:href="608874v1_eqnS81.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Since the difference between the bulk and pairwise competitions is the presence of the other mutants in the library, we interpret this difference as the <italic>fitness error from higher-order interactions</italic> among the mutants.</p>
<p>We now calculate how this error depends on the underlying growth traits of the genotypes using the population dynamics model (Methods, <xref ref-type="disp-formula" rid="eqn11a">Eq. (11)</xref>); and the explicit expression for relative fitness from Sec. S13. Based on the approximate pairwise relative fitness in this model (<xref ref-type="disp-formula" rid="eqnS78a">Eq. (S78)</xref>), the relative fitness in the pairwise competition is the sum of two terms
<disp-formula id="eqnS82">
<graphic xlink:href="608874v1_eqnS82.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
while the relative fitness in the bulk competition is the sum of three terms
<disp-formula id="eqnS83">
<graphic xlink:href="608874v1_eqnS83.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where the third term represents the coupling between growth and lag phases present only in populations with more than two genotypes (Eq. (S78d)). We define the higher-order effects on the selection for lag time as
<disp-formula id="eqnS84">
<graphic xlink:href="608874v1_eqnS84.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Using Eq. (S78b), we can express this in terms of the underlying traits as
<disp-formula id="eqnS85">
<graphic xlink:href="608874v1_eqnS85.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="608874v1_inline49.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the difference in effective <italic>e</italic>-fold growth times (<xref ref-type="disp-formula" rid="eqnS40">Eq. (S40)</xref>) in the bulk competition and in the pairwise competition of mutant <italic>i</italic> and the wild-type.</p>
<p>We similarly define the higher-order effects in the selection on growth rate as
<disp-formula id="eqnS86">
<graphic xlink:href="608874v1_eqnS86.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
and calculate <inline-formula><inline-graphic xlink:href="608874v1_inline50.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="608874v1_inline51.gif" mime-subtype="gif" mimetype="image"/></inline-formula> from Eq. (S78c) to get the expression
<disp-formula id="eqnS87">
<graphic xlink:href="608874v1_eqnS87.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where LFC<sup>bulk</sup> is the log fold-change (<xref ref-type="disp-formula" rid="eqnS42">Eq. (S42)</xref>) of the total biomass in the bulk competition and LFC<sup>pair,<italic>i</italic></sup> is the log fold-change of the total biomass in the pairwise competition between mutant <italic>i</italic> and the wild-type. We note that total biomass growth in the bulk competition LFC<sup>bulk</sup> depends on the mutant library through the effective biomass yield (<xref ref-type="disp-formula" rid="eqnS41">Eq. (S41)</xref>), but this dependence is weak because the yield enters only logarithmically into <xref ref-type="disp-formula" rid="eqnS42">Eq. (S42)</xref>. We thus assume that the bulk and pairwise competition have equal biomass growth (LFC<sup>bulk</sup> ≈ LFC<sup>pair,<italic>i</italic></sup>) for all mutants <italic>i</italic> such that the higher-order effect on the growth rate selection (<xref ref-type="disp-formula" rid="eqnS87">Eq. (S87)</xref>) is proportional to the increase in the mean doubling time
<disp-formula id="eqnS88">
<graphic xlink:href="608874v1_eqnS88.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Since this has the same form as the higher-order effect on lag time selection in <xref ref-type="disp-formula" rid="eqnS85">Eq. (S85)</xref>, we can combine <xref ref-type="disp-formula" rid="eqnS88">Eq. (S88)</xref> and <xref ref-type="disp-formula" rid="eqnS85">Eq. (S85)</xref>) into
<disp-formula id="eqnS89">
<graphic xlink:href="608874v1_eqnS89.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Because the effective growth time in the pairwise competition <inline-formula><inline-graphic xlink:href="608874v1_inline52.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is approximately just the effective growth time of the wild-type alone <italic>τ</italic><sub>wt</sub> (assuming the mutant is competed against it at low initial relative abundance), this means that
<disp-formula id="eqnS90">
<graphic xlink:href="608874v1_eqnS90.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>That is, the relative error of lag and growth selection from higher-order interactions is approximately independent of the individual mutant, but rather depends on properties of the wild-type (<italic>τ</italic><sub>wt</sub>) and the whole mutant library (through <inline-formula><inline-graphic xlink:href="608874v1_inline53.gif" mime-subtype="gif" mimetype="image"/></inline-formula>). This is why we observe an approximately constant slope across all mutants in <xref rid="figS16" ref-type="fig">Fig. S16</xref> (dark orange points) when comparing the error against the pairwise relative fitness. The slight deviation from the constant slope is due to our approximation that the LFCs are the same between the bulk and pairwise competitions; this is a good approximation for the yeast deletion library but not exactly true, and hence causes a slightly different scaling between the growth Δ<italic>s</italic><sub>growth</sub> and lag Δ<italic>s</italic><sub>lag</sub> error terms compared to Eq.(S90).</p>
<p>Finally, we note that the growth-lag coupling terms <inline-formula><inline-graphic xlink:href="608874v1_inline54.gif" mime-subtype="gif" mimetype="image"/></inline-formula> do not have a simple scaling with pairwise relative fitness since they depend quadratically on trait differences; this is shown as the bright orange points in <xref rid="figS16" ref-type="fig">Fig. S16</xref>. In the main text, we therefore refer to Δ<italic>s</italic><sub><italic>i</italic>,wt,lag</sub> + Δ<italic>s</italic><sub><italic>i</italic>,wt,growth</sub> as the fitness-dependent error and the <inline-formula><inline-graphic xlink:href="608874v1_inline55.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as the fitness-independent error from higher-order interactions.</p>
</sec>
<sec id="s5o">
<label>S15.</label>
<title>Choosing the mutant library abundance in bulk competition experiments</title>
<p>Section S14 showed that measuring relative fitness of a mutant in a bulk competition (with a library of other mutants also present) entails an error due to higher-order interactions among the mutants, compared to measuring relative fitness in a pairwise competition consisting of just the mutant and wild-type. Here we show how this error depends on the relative abundance of the mutant library in the bulk competition, so that we can estimate the range of library abundances that keep the error below a desired threshold.</p>
<sec id="s5o1">
<title>Calculating the relative error on fitness</title>
<p>Let the absolute error in relative fitness from higher-order interactions for a mutant <italic>i</italic> be Δ<italic>s</italic><sub><italic>i</italic>,wt</sub> (<xref ref-type="disp-formula" rid="eqnS81">Eq. (S81)</xref>). Let the relative fitness of this mutant in a pairwise competition be <inline-formula><inline-graphic xlink:href="608874v1_inline56.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqnS79">Eq. (S79)</xref>). Since the error Δ<italic>s</italic><sub><italic>i</italic>,wt</sub> depends on the relative abundance <italic>x</italic><sub>lib</sub> of the whole mutant library, our goal is to determine what range of <italic>x</italic><sub>lib</sub> keeps the error in relative fitness (compared to the “true” relative fitness in the pairwise competition) below a chosen threshold ϵ:
<disp-formula id="eqnS91">
<graphic xlink:href="608874v1_eqnS91.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>In Sec. S14 we calculated the dependence of Δ<italic>s</italic><sub><italic>i</italic>,wt</sub> on the underlying growth traits. However, since here we are mainly concerned with the dependence on the library abundance <italic>x</italic><sub>lib</sub>, we present an alternative calculation that better captures that dependence.</p>
<p>We start by pointing out that we can express the relative fitness in pairwise (<xref ref-type="disp-formula" rid="eqnS79">Eq. (S79)</xref>) and bulk competitions (<xref ref-type="disp-formula" rid="eqnS80">Eq. (S80)</xref>) in terms of the saturation times for these competitions, using the explicit solution to the population dynamics model in <xref ref-type="disp-formula" rid="eqn14">Eq. (14)</xref>:
<disp-formula id="eqnS92">
<graphic xlink:href="608874v1_eqnS92.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqnS93">
<graphic xlink:href="608874v1_eqnS93.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>We can thus express the error from higher-order interactions (<xref ref-type="disp-formula" rid="eqnS81">Eq. (S81)</xref>) as
<disp-formula id="eqnS94">
<graphic xlink:href="608874v1_eqnS94.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where Δ<italic>g</italic><sub><italic>i</italic>,wt</sub> = <italic>g</italic><sub><italic>i</italic></sub> − <italic>g</italic><sub>wt</sub>. Equation (S94) shows that the mutant library affects the fitness of individual mutants <inline-formula><inline-graphic xlink:href="608874v1_inline57.gif" mime-subtype="gif" mimetype="image"/></inline-formula> by changing the saturation time. Mathematically, this is equivalent to the results of Sec. S14, which showed how the difference in effective <italic>e</italic>-fold growth times <inline-formula><inline-graphic xlink:href="608874v1_inline58.gif" mime-subtype="gif" mimetype="image"/></inline-formula> between bulk and pairwise competitions primarily mediated the higher-order effects, but expressed in terms of the saturation time <italic>t</italic><sub>sat</sub> (which is not identical to <inline-formula><inline-graphic xlink:href="608874v1_inline59.gif" mime-subtype="gif" mimetype="image"/></inline-formula> but related through <xref ref-type="disp-formula" rid="eqnS38">Eq. (S38)</xref>). The error in <xref ref-type="disp-formula" rid="eqnS94">Eq. (S94)</xref> is also proportional to the growth rate advantage of the mutant compared to the wild-type. In particular, mutant geno-types that only differ in lag time are not affected by the mutant library since their advantage is accrued once at the beginning of the growth cycle and therefore does not scale with the total time of competition.</p>
<p>According to <xref ref-type="disp-formula" rid="eqnS38">Eq. (S38)</xref>, the saturation time <italic>t</italic><sub>sat</sub> depends on the effective lag time <inline-formula><inline-graphic xlink:href="608874v1_inline60.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqnS39">Eq. (S39)</xref>), effective <italic>e</italic>-fold growth time <inline-formula><inline-graphic xlink:href="608874v1_inline61.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqnS40">Eq. (S40)</xref>), and the log fold-change LFC (<xref ref-type="disp-formula" rid="eqnS42">Eq. (S42)</xref>) for the competition. To simplify the calculation, we introduce a few assumptions. We assume all mutants have the same yields <italic>Y</italic><sub><italic>i</italic></sub> such that the LFCs in the bulk and pairwise competitions are identical (LFC<sup>bulk</sup> = LFC<sup>pair</sup>). We also assume that the relative abundance of the mutant in the pairwise competition is small enough that the saturation time in that case is set entirely by the wild-type traits:
<disp-formula id="eqnS95">
<graphic xlink:href="608874v1_eqnS95.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Note that this means that the difference in saturation times is independent of the specific mutant <italic>i</italic>; the only dependence of the mutant <italic>i</italic> on the overall error from higher-order interactions is through the difference in growth rates in <xref ref-type="disp-formula" rid="eqnS94">Eq. (S94)</xref>.</p>
<p>We can thus write the fitness error as
<disp-formula id="eqnS96">
<graphic xlink:href="608874v1_eqnS96.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>The dependence on the mutant library relative abundance <italic>x</italic><sub>lib</sub> is contained within the effective traits <inline-formula><inline-graphic xlink:href="608874v1_inline62.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="608874v1_inline63.gif" mime-subtype="gif" mimetype="image"/></inline-formula> of the bulk competition. Using the definitions in <xref ref-type="disp-formula" rid="eqnS39">Eqs. (S39)</xref> and <xref ref-type="disp-formula" rid="eqnS40">(S40)</xref>, we can show that
<disp-formula id="eqnS97">
<graphic xlink:href="608874v1_eqnS97.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqnS98">
<graphic xlink:href="608874v1_eqnS98.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Inserting <xref ref-type="disp-formula" rid="eqnS97">Eqs. (S97)</xref> and <xref ref-type="disp-formula" rid="eqnS98">(S98)</xref> into <xref ref-type="disp-formula" rid="eqnS96">Eq. (S96)</xref>, we obtain
<disp-formula id="eqnS99">
<graphic xlink:href="608874v1_eqnS99.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where Δλ<sub>lib,wt</sub> = λ<sub>lib</sub> − λ<sub>wt</sub> is the difference in lag times, and Δ<italic>τ</italic><sub>lib,wt</sub> = <italic>τ</italic><sub>lib</sub> − <italic>τ</italic><sub>wt</sub> the difference in <italic>e</italic>-fold growth times (reciprocal growth rates), between the library (defined according to <xref ref-type="disp-formula" rid="eqnS39">Eq. (S39)</xref>) and the wild-type. All the dependence on the library relative abundance <italic>x</italic><sub>lib</sub> is now contained in the fraction outside the square brackets in <xref ref-type="disp-formula" rid="eqnS99">Eq. (S99)</xref>.</p>
<p>Since the relative fitness of the mutant library as a whole compared to the wild-type in bulk competition is (using <xref ref-type="disp-formula" rid="eqnS78a">Eq. (S78)</xref>)
<disp-formula id="eqnS100">
<graphic xlink:href="608874v1_eqnS100.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
we can rewrite <xref ref-type="disp-formula" rid="eqnS99">Eq. (S99)</xref> as
<disp-formula id="eqnS101">
<graphic xlink:href="608874v1_eqnS101.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>This shows that a mutant library that is neutral relative to the wild-type in the bulk competition <inline-formula><inline-graphic xlink:href="608874v1_inline64.gif" mime-subtype="gif" mimetype="image"/></inline-formula> removes the error from higher-order interactions, even when that neutrality is based on a trade-off between growth rates and lag times (Δ λ <sub>lib,wt</sub> =−Δ τ<sub>lib,wt</sub> LFC <sup>bulk</sup>). We note that the error of higher-order interactions (<xref ref-type="disp-formula" rid="eqnS101">Eq. (S101)</xref>) appears similar to the error from the frame of reference (<xref ref-type="disp-formula" rid="eqnS77">Eq. (S77)</xref>, but the former includes the relative mutant growth rate Δ<italic>g</italic><sub><italic>i</italic>,wt</sub>/<italic>g</italic><sub>wt</sub> as an additional pre-factor.</p>
</sec>
<sec id="s5o2">
<title>Calculating the upper bound on relative abundance of the mutant library</title>
<p>To calculate the maximum relative library abundance that keeps the relative error below the threshold <italic>ϵ</italic>, we input the absolute error in <xref ref-type="disp-formula" rid="eqnS99">Eq. (S99)</xref> into the relative error bound of <xref ref-type="disp-formula" rid="eqnS91">Eq. (S91)</xref> and rearrange to isolate the dependence on the library abundance <italic>x</italic><sub>lib</sub>:
<disp-formula id="eqnS102">
<graphic xlink:href="608874v1_eqnS102.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where
<disp-formula id="eqnS103">
<graphic xlink:href="608874v1_eqnS103.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
depends on the focal mutant <italic>i</italic> but does not depend on the library abundance <italic>x</italic><sub>lib</sub>. The left-hand side of <xref ref-type="disp-formula" rid="eqnS102">Eq. (S102)</xref> varies between zero and one as a function of <italic>x</italic><sub>lib</sub>. This means that if <italic>ϵ A</italic><sub><italic>i</italic></sub> &gt; 1, any value of x<sub>lib</sub> will satisfy <xref ref-type="disp-formula" rid="eqnS102">Eq. (S102)</xref>, meaning that the relative error on mutant i from higher-order interactions will always be less than <italic>ϵ</italic>. For example, this holds when the mutant <italic>i</italic> has the same growth rate as the wild-type (Δ<italic>g</italic><sub><italic>i</italic>,wt</sub> = 0, which causes <italic>A</italic><sub><italic>i</italic></sub> → ∞), even if it varies in lag time and/or other mutants have variation in growth rates.</p>
<p>We thus next consider the case where <italic>ϵ A</italic><sub><italic>i</italic></sub> &lt; 1. We multiply both sides of <xref ref-type="disp-formula" rid="eqnS102">Eq. (S102)</xref> by the denominator on the left-hand side (always positive) to obtain
<disp-formula id="eqnS104">
<graphic xlink:href="608874v1_eqnS104.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
and then collect all the terms involving <italic>x</italic><sub>lib</sub> on the left hand side:
<disp-formula id="eqnS105">
<graphic xlink:href="608874v1_eqnS105.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Since <italic>ϵ A</italic><sub><italic>i</italic></sub> &lt; 1, the factor multiplying <italic>x</italic><sub>lib</sub> on the left-hand side of <xref ref-type="disp-formula" rid="eqnS105">Eq. (S105)</xref> must be positive and thus we can divide both sides to obtain an upper bound on the library abundance <italic>x</italic><sub>lib</sub> such that the relative error on fitness is less than <italic>ϵ</italic> :
<disp-formula id="eqnS106">
<graphic xlink:href="608874v1_eqnS106.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Since <italic>ϵ</italic> will typically be small, we can simplify the right-hand side of <xref ref-type="disp-formula" rid="eqnS106">Eq. (S106)</xref> by approximating it to first-order in <italic>ϵ</italic> :
<disp-formula id="eqnS107">
<graphic xlink:href="608874v1_eqnS107.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>This approximation holds as long as <italic>ϵ A</italic><sub><italic>i</italic></sub>(<italic>g</italic><sub>lib</sub> - <italic>g</italic><sub>wt</sub>)/<italic>g</italic><sub>lib ≪</sub> 1.</p>
<p>The maximum mutant library abundance determined by <xref ref-type="disp-formula" rid="eqnS106">Eq. (S106)</xref> or (S107) is specific to a single mutant genotype <italic>i</italic>, meaning that the relative fitness errors for other mutants may exceed <italic>ϵ</italic> even if the inequality for mutant <italic>i</italic> is satisfied. To keep the relative fitness errors for all mutants less than <italic>ϵ</italic>, we need to choose a library abundance <inline-formula><inline-graphic xlink:href="608874v1_inline65.gif" mime-subtype="gif" mimetype="image"/></inline-formula> such that
<disp-formula id="eqnS108">
<graphic xlink:href="608874v1_eqnS108.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>This means that <xref ref-type="disp-formula" rid="eqnS107">Eq. (S107)</xref> must be satisfied for all mutants <italic>j</italic>:
<disp-formula id="eqnS109">
<graphic xlink:href="608874v1_eqnS109.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Thus we must determine the minimum value of <italic>A</italic><sub><italic>j</italic></sub> over all mutants <italic>j</italic>. Using the definition in <xref ref-type="disp-formula" rid="eqnS103">Eq. (S103)</xref>, <italic>A</italic><sub><italic>j</italic></sub> is minimized for the mutant with minimum vale of
<disp-formula id="eqnS110">
<graphic xlink:href="608874v1_eqnS110.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where we have calculated the pairwise relative fitness in <xref ref-type="disp-formula" rid="eqnS92">Eq. (S92)</xref> using <inline-formula><inline-graphic xlink:href="608874v1_inline66.gif" mime-subtype="gif" mimetype="image"/></inline-formula> from <xref ref-type="disp-formula" rid="eqnS95">Eq. (S95)</xref>. Mutants that minimize <xref ref-type="disp-formula" rid="eqnS110">Eq. (S110)</xref> are those with tradeoffs between lag times and growth rates such that their overall pair-wise relative fitness with respect to the wild-type is zero. This makes sense, since these mutants will have a relative fitness close to zero in the pairwise competition <inline-formula><inline-graphic xlink:href="608874v1_inline67.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, but nonzero fitness relative to the wild-type in the bulk competition as the relative selection on the lag time and growth rate shifts (e.g., <inline-formula><inline-graphic xlink:href="608874v1_inline68.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in <xref ref-type="disp-formula" rid="eqnS78a">Eq. (S78)</xref>).</p>
</sec>
<sec id="s5o3">
<title>Special case of variation in growth rates only</title>
<p>To determine an even simpler estimate on the maximum mutant library abundance, we consider the special case where genotypes vary only in growth rates and not lag times. Using the definition in <xref ref-type="disp-formula" rid="eqnS103">Eq. (S103)</xref>, <italic>A</italic><sub><italic>i</italic></sub> = <italic>g</italic><sub>lib</sub>/(<italic>g</italic><sub>wt</sub> - <italic>g</italic><sub>lib</sub>) for all mutants <italic>i</italic>, and thus there is a single bound on library abundance for all mutants (using <xref ref-type="disp-formula" rid="eqnS107">Eq. (S107)</xref>):
<disp-formula id="eqnS111">
<graphic xlink:href="608874v1_eqnS111.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>This is the same as <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> in the main text.</p>
<p>We test <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> using our simulated competition data for the yeast single-gene deletion library (Methods) with variation in all three traits: lag time, growth rate, and biomass yield (<xref rid="fig2" ref-type="fig">Fig. 2B-C</xref>). We compute the growth rates of the mutant library (<italic>g</italic><sub>lib</sub> = 0.389 h<sup>−1</sup> using <xref ref-type="disp-formula" rid="eqnS40">Eq. (S40)</xref>) and the wild-type (<italic>g</italic><sub>wt</sub> = 0.406 h<sup>−1</sup>). Using a relative error threshold of <italic>ϵ</italic> = 0.01, the maximum mutant library relative abundance according to <xref ref-type="disp-formula" rid="eqn10">Eq. (10)</xref> is <italic>x</italic><sub>lib</sub> = 24.6%. <xref rid="fig4" ref-type="fig">Figure 4D</xref> shows that this mutant library abundance indeed is able to keep the relative error below the threshold for mutants with high relative fitness, but, as expected, this mutant library abundance fails for mutants close to neutrality.</p>
<p>We furthermore compute the maximum library abundance with <xref ref-type="disp-formula" rid="eqnS109">Eq. (S109)</xref>, based on the precise trait variation in our dataset. The mutant library has an effective lag time λ<sub>lib</sub> = 1.95 h (compared to wild-type lag time λ<sub>wt</sub> = 1.92 h) and an effective e-fold growth time τ<sub>lib</sub> = 2.57 h (compared to the wild-type τ<sub>wt</sub> = 2.46 h), leading to an overall negative relative fitness <inline-formula><inline-graphic xlink:href="608874v1_inline69.gif" mime-subtype="gif" mimetype="image"/></inline-formula> based on a LFC value of LFC<sup>bluk</sup> = log 100 (a typical fold-change in our dataset) and the limit of low relative abundance of the library. We insert these trait values into <xref ref-type="disp-formula" rid="eqnS109">Eq. (S109)</xref> and obtain a maximum mutant library abundance <inline-formula><inline-graphic xlink:href="608874v1_inline70.gif" mime-subtype="gif" mimetype="image"/></inline-formula> <xref rid="fig4" ref-type="fig">Figure 4D</xref> shows that this much smaller mutant library abundance is able to keep the relative error below the desired threshold for all mutant genotypes. Note, however, this is still not fully exact since we have ignored the underlying variation in biomass yield in our trait dataset.</p>
</sec>
</sec>
<ref-list>
<ref id="sc1"><label>[1]</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Daniel Jefferson</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>Guilhem</given-names> <surname>Doulcier</surname></string-name>, <string-name><given-names>Pierrick</given-names> <surname>Bourrat</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Why there are so many definitions of fitness in models</article-title>. <source>EcoEvoRxiv</source>, <pub-id pub-id-type="doi">10.32942/X2V61T</pub-id>, <year>2024</year>.</mixed-citation></ref>
<ref id="sc2"><label>[2]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Susan K.</given-names> <surname>Mills</surname></string-name> and <string-name><given-names>John H.</given-names> <surname>Beatty</surname></string-name></person-group>. <article-title>The Propensity Interpretation of Fitness</article-title>. <source>Philosophy of Science</source>, <volume>46</volume>(<issue>2</issue>):<fpage>263</fpage>–<lpage>286</lpage>, <year>1979</year>.</mixed-citation></ref>
<ref id="sc3"><label>[3]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Peter</given-names> <surname>Takacs</surname></string-name> and <string-name><given-names>Pierrick</given-names> <surname>Bourrat</surname></string-name></person-group>. <article-title>The arithmetic mean of what? A Cautionary Tale about the Use of the Geometric Mean as a Measure of Fitness</article-title>. <source>Biology &amp; Philosophy</source>, <volume>37</volume>(<issue>2</issue>):<fpage>12</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="sc4"><label>[4]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Brian</given-names> <surname>Charlesworth</surname></string-name></person-group>. <article-title>Book review: Two new books on Life-History Evolution</article-title>. <source>The Quarterly Review of Biology</source>, <volume>68</volume>(<issue>2</issue>):<fpage>262</fpage>–<lpage>264</lpage>, <year>1993</year>.</mixed-citation></ref>
<ref id="sc5"><label>[5]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Brian</given-names> <surname>Charlesworth</surname></string-name></person-group>. <source>Evolution in Age-Structured Populations</source>. <publisher-name>Cambridge University Press</publisher-name>, <year>1994</year>.</mixed-citation></ref>
<ref id="sc6"><label>[6]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Helen K.</given-names> <surname>Alexander</surname></string-name>, <string-name><given-names>Guillaume</given-names> <surname>Martin</surname></string-name>, <string-name><given-names>Oliver Y.</given-names> <surname>Martin</surname></string-name>, and <string-name><given-names>Sebastian</given-names> <surname>Bonhoeffer</surname></string-name></person-group>. <article-title>Evolutionary rescue: linking theory for conservation and medicine</article-title>. <source>Evolutionary Applications</source>, <volume>7</volume>(<issue>10</issue>):<fpage>1161</fpage>–<lpage>1179</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="sc7"><label>[7]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Motoo</given-names> <surname>Kimura</surname></string-name></person-group>. <article-title>On the probability of fixation of mutant genes in a population</article-title>. <source>Genetics</source>, <volume>47</volume>(<issue>6</issue>):<fpage>713</fpage>–<lpage>719</lpage>, <year>1962</year>.</mixed-citation></ref>
<ref id="sc8"><label>[8]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Z</given-names> <surname>Patwa</surname></string-name> and <string-name><given-names>L.M</given-names> <surname>Wahl</surname></string-name></person-group>. <article-title>The fixation probability of beneficial mutations</article-title>. <source>Journal of The Royal Society Interface</source>, <volume>5</volume>(<issue>28</issue>):<fpage>1279</fpage>–<lpage>1289</lpage>, <year>2008</year>.</mixed-citation></ref>
<ref id="sc9"><label>[9]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Thomas F.</given-names> <surname>Hansen</surname></string-name></person-group>. <article-title>On the definition and measurement of fitness in finite populations</article-title>. <source>Journal of Theoretical Biology</source>, <volume>419</volume>:<fpage>36</fpage>–<lpage>43</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="sc10"><label>[10]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Michael</given-names> <surname>Doebeli</surname></string-name>, <string-name><given-names>Yaroslav</given-names> <surname>Ispolatov</surname></string-name>, and <string-name><given-names>Burt</given-names> <surname>Simon</surname></string-name></person-group>. <article-title>Towards a mechanistic foundation of evolutionary theory</article-title>. <source>eLife</source>, <volume>6</volume>:<elocation-id>e23804</elocation-id>, <year>2017</year>.</mixed-citation></ref>
<ref id="sc11"><label>[11]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Karl</given-names> <surname>Drlica</surname></string-name></person-group>. <article-title>The mutant selection window and antimicrobial resistance</article-title>. <source>Journal of Antimicrobial Chemotherapy</source>, <volume>52</volume>(<issue>1</issue>):<fpage>11</fpage>–<lpage>17</lpage>, <year>2003</year>.</mixed-citation></ref>
<ref id="sc12"><label>[12]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Kathleen</given-names> <surname>Sprouffske</surname></string-name>, <string-name><given-names>José</given-names> <surname>Aguilar-Rodríguez</surname></string-name>, <string-name><given-names>Paul</given-names> <surname>Sniegowski</surname></string-name>, and <string-name><given-names>Andreas</given-names> <surname>Wagner</surname></string-name></person-group>. <article-title>High mutation rates limit evolutionary adaptation in Escherichia coli</article-title>. <source>PLOS Genetics</source>, <volume>14</volume>(<issue>4</issue>):<fpage>e1007324</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="sc13"><label>[13]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Fernanda</given-names> <surname>Pinheiro</surname></string-name>, <string-name><given-names>Omar</given-names> <surname>Warsi</surname></string-name>, <string-name><given-names>Dan I.</given-names> <surname>Andersson</surname></string-name>, and <string-name><given-names>Michael</given-names> <surname>Lässig</surname></string-name></person-group>. <article-title>Metabolic fitness landscapes predict the evolution of antibiotic resistance</article-title>. <source>Nature Ecology &amp; Evolution</source>, <volume>5</volume>(<issue>5</issue>):<fpage>677</fpage>–<lpage>687</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="sc14"><label>[14]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Juan</given-names> <surname>Diaz-Colunga</surname></string-name>, <string-name><given-names>Alvaro</given-names> <surname>Sanchez</surname></string-name>, and <string-name><given-names>C. Brandon</given-names> <surname>Ogbunugafor</surname></string-name></person-group>. <article-title>Environmental modulation of global epistasis in a drug resistance fitness landscape</article-title>. <source>Nature Communications</source>, <volume>14</volume>(<issue>1</issue>):<fpage>8055</fpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="sc15"><label>[15]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sarah B.</given-names> <surname>Worthan</surname></string-name>, <string-name><given-names>Robert D. P.</given-names> <surname>McCarthy</surname></string-name>, and <string-name><given-names>Megan G.</given-names> <surname>Behringer</surname></string-name></person-group>. <article-title>Case Studies in the Assessment of Microbial Fitness: Seemingly Subtle Changes Can Have Major Effects on Phenotypic Outcomes</article-title>. <source>Journal of Molecular Evolution</source>, <volume>91</volume>:<fpage>311</fpage>—-324, <year>2023</year>.</mixed-citation></ref>
<ref id="sc16"><label>[16]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Désirée A</given-names> <surname>Schmitz</surname></string-name>, <string-name><given-names>Tobias</given-names> <surname>Wechsler</surname></string-name>, <string-name><given-names>Ingrid</given-names> <surname>Mignot</surname></string-name>, and <string-name><given-names>Rolf</given-names> <surname>Kümmerli</surname></string-name></person-group>. <article-title>Predicting bacterial interaction outcomes from monoculture growth and supernatant assays</article-title>. <source>ISME Communications</source>, <volume>4</volume>(<issue>1</issue>):<fpage>ycae045</fpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="sc17"><label>[17]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J. Arjan G.M.</given-names> <surname>De Visser</surname></string-name> and <string-name><given-names>Joachim</given-names> <surname>Krug</surname></string-name></person-group>. <article-title>Empirical fitness landscapes and the predictability of evolution</article-title>. <source>Nature Reviews Genetics</source>, <volume>15</volume>(<issue>7</issue>):<fpage>480</fpage>–<lpage>490</lpage>, <year>2014</year>.</mixed-citation></ref>
<ref id="sc18"><label>[18]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Claudia</given-names> <surname>Bank</surname></string-name></person-group>. <article-title>Epistasis and Adaptation on Fitness Landscapes</article-title>. <source>Annual Review of Ecology, Evolution, and Systematics</source>, <volume>53</volume>(<issue>1</issue>):<fpage>457</fpage>–<lpage>479</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="sc19"><label>[19]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Thomas P.</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>Tom</given-names> <surname>Clegg</surname></string-name>, <string-name><given-names>Emma</given-names> <surname>Ransome</surname></string-name>, <etal>et al.</etal></person-group> <article-title>High-throughput characterization of bacterial responses to complex mixtures of chemical pollutants</article-title>. <source>Nature Microbiology</source>, <volume>9</volume>(<issue>4</issue>):<fpage>938</fpage>–<lpage>948</lpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="sc20"><label>[20]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Chevin</given-names> <surname>Luis-Miguel</surname></string-name></person-group>. <article-title>On measuring selection in experimental evolution</article-title>. <source>Biology Letters</source>, <volume>7</volume>(<issue>2</issue>):<fpage>210</fpage>–<lpage>213</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="sc21"><label>[21]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>James P.</given-names> <surname>Grover</surname></string-name></person-group>. <source>Resource Competition</source>. <publisher-name>Springer US</publisher-name>, <publisher-loc>Boston, MA</publisher-loc>, <year>1997</year>.</mixed-citation></ref>
<ref id="sc22"><label>[22]</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Joachim</given-names> <surname>Krug</surname></string-name></person-group>. <article-title>Population Genetics and Evolution</article-title>. <source>arXiv</source>:<pub-id pub-id-type="arxiv">1803.08474</pub-id> [q-bio], <year>2018</year>.</mixed-citation></ref>
<ref id="sc23"><label>[23]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Richard E.</given-names> <surname>Lenski</surname></string-name>, <string-name><given-names>Michael R.</given-names> <surname>Rose</surname></string-name>, <string-name><given-names>Suzanne C.</given-names> <surname>Simpson</surname></string-name>, and <string-name><given-names>Scott C.</given-names> <surname>Tadler</surname></string-name></person-group>. <article-title>Long-Term Experimental Evolution in Escherichia coli. I. Adaptation and Divergence During 2,000 Generations</article-title>. <source>The American Naturalist</source>, <volume>138</volume>(<issue>6</issue>):<fpage>1315</fpage>–<lpage>1341</lpage>, <year>1991</year>.</mixed-citation></ref>
<ref id="sc24"><label>[24]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jonas</given-names> <surname>Warringer</surname></string-name>, <string-name><given-names>Elke</given-names> <surname>Ericson</surname></string-name>, <string-name><given-names>Luciano</given-names> <surname>Fernandez</surname></string-name>, <etal>et al.</etal></person-group> <article-title>High-resolution yeast phenomics resolves different physiological features in the saline response</article-title>. <source>PNAS</source>, <volume>100</volume>(<issue>26</issue>):<fpage>15724</fpage>–<lpage>15729</lpage>, <year>2003</year>.</mixed-citation></ref>
<ref id="sc25"><label>[25]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Peter S.</given-names> <surname>Swain</surname></string-name>, <string-name><given-names>Keiran</given-names> <surname>Stevenson</surname></string-name>, <string-name><given-names>Allen</given-names> <surname>Leary</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Inferring time derivatives including cell growth rates using Gaussian processes</article-title>. <source>Nature Communications</source>, <volume>7</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>8</lpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="sc26"><label>[26]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Pauli</given-names> <surname>Virtanen</surname></string-name>, <string-name><given-names>Ralf</given-names> <surname>Gommers</surname></string-name>, <string-name><given-names>Travis E.</given-names> <surname>Oliphant</surname></string-name>, <etal>et al.</etal></person-group> <article-title>SciPy 1.0: fundamental algorithms for scientific computing in Python</article-title>. <source>Nature Methods</source>, <volume>17</volume>(<issue>3</issue>):<fpage>261</fpage>–<lpage>272</lpage>, <year>2020</year>.</mixed-citation></ref>
<ref id="sc27"><label>[27]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Michael</given-names> <surname>Manhart</surname></string-name>, <string-name><given-names>Bharat V.</given-names> <surname>Adkar</surname></string-name>, and <string-name><given-names>Eugene I.</given-names> <surname>Shakhnovich</surname></string-name></person-group>. <article-title>Trade-offs between microbial growth phases lead to frequency-dependent and non-transitive selection</article-title>. <source>Proceedings of the Royal Society B: Biological Sciences</source>, <volume>285</volume>(<issue>1872</issue>):<fpage>20172459</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="sc28"><label>[28]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Michael</given-names> <surname>Manhart</surname></string-name> and <string-name><given-names>Eugene I.</given-names> <surname>Shakhnovich</surname></string-name></person-group>. <article-title>Growth tradeoffs produce complex microbial communities on a single limiting resource</article-title>. <source>Nature Communications</source>, <volume>9</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>9</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="sc29"><label>[29]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. J.</given-names> <surname>Wiser</surname></string-name>, <string-name><given-names>N.</given-names> <surname>Ribeck</surname></string-name>, and <string-name><given-names>R. E.</given-names> <surname>Lenski</surname></string-name></person-group>. <article-title>Long-Term Dynamics of Adaptation in Asexual Populations</article-title>. <source>Science</source>, <volume>342</volume>(<issue>6164</issue>):<fpage>1364</fpage>–<lpage>1367</lpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="sc30"><label>[30]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jeffrey E.</given-names> <surname>Barrick</surname></string-name>, <string-name><given-names>Zachary D.</given-names> <surname>Blount</surname></string-name>, <string-name><given-names>Devin M.</given-names> <surname>Lake</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Daily Transfers, Archiving Populations, and Measuring Fitness in the Long-Term Evolution Experiment with Escherichia coli</article-title>. <source>JoVE (Journal of Visualized Experiments)</source>, (<volume>198</volume>):<fpage>e65342</fpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="sc31"><label>[31]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Benjamin H.</given-names> <surname>Good</surname></string-name>, <string-name><given-names>Michael J.</given-names> <surname>McDonald</surname></string-name>, <string-name><given-names>Jeffrey E.</given-names> <surname>Barrick</surname></string-name>, <etal>et al.</etal></person-group> <article-title>The dynamics of molecular evolution over 60,000 generations</article-title>. <source>Nature</source>, <volume>551</volume>(<issue>7678</issue>):<fpage>45</fpage>–<lpage>50</lpage>, <year>2017</year>.</mixed-citation></ref>
<ref id="sc32"><label>[32]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Farida</given-names> <surname>Vasi</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Travisano</surname></string-name>, and <string-name><given-names>Richard E.</given-names> <surname>Lenski</surname></string-name></person-group>. <article-title>Long-Term Experimental Evolution in Escherichia coli. II. Changes in Life-History Traits During Adaptation to a Seasonal Environment</article-title>. <source>The American Naturalist</source>, <volume>144</volume>(<issue>3</issue>):<fpage>432</fpage>–<lpage>456</lpage>, <year>1994</year>.</mixed-citation></ref>
<ref id="sc33"><label>[33]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Nkrumah A.</given-names> <surname>Grant</surname></string-name>, <string-name><given-names>Ali Abdel</given-names> <surname>Magid</surname></string-name>, <string-name><given-names>Joshua</given-names> <surname>Franklin</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Changes in Cell Size and Shape during 50,000 Generations of Experimental Evolution with Escherichia coli</article-title>. <source>Journal of Bacteriology</source>, <volume>203</volume>(<issue>10</issue>), <year>2021</year>.</mixed-citation></ref>
<ref id="sc34"><label>[34]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Yipei</given-names> <surname>Guo</surname></string-name>, <string-name><given-names>Marija</given-names> <surname>Vucelja</surname></string-name>, and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name></person-group>. <article-title>Stochastic tunneling across fitness valleys can give rise to a logarithmic long-term fitness trajectory</article-title>. <source>Science Advances</source>, <volume>5</volume>(<issue>7</issue>):<fpage>eaav3842</fpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="sc35"><label>[35]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Yipei</given-names> <surname>Guo</surname></string-name> and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name></person-group>. <article-title>The effect of weak clonal interference on average fitness trajectories in the presence of macroscopic epistasis</article-title>. <source>Genetics</source>, <volume>220</volume>(<issue>4</issue>):<fpage>iyac028</fpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="sc36"><label>[36]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Nicholas M</given-names> <surname>Boffi</surname></string-name>, <string-name><given-names>Yipei</given-names> <surname>Guo</surname></string-name>, <string-name><given-names>Chris H</given-names> <surname>Rycroft</surname></string-name>, and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name></person-group>. <article-title>How microscopic epistasis and clonal interference shape the fitness trajectory in a spin glass model of microbial long-term evolution</article-title>. <source>eLife</source>, <volume>12</volume>:<elocation-id>RP87895</elocation-id>, <year>2024</year>.</mixed-citation></ref>
<ref id="sc37"><label>[37]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Philippe</given-names> <surname>Piccardi</surname></string-name>, <string-name><given-names>Björn</given-names> <surname>Vessman</surname></string-name>, and <string-name><given-names>Sara</given-names> <surname>Mitri</surname></string-name></person-group>. <article-title>Toxicity drives facilitation between 4 bacterial species</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>116</volume>(<issue>32</issue>):<fpage>15979</fpage>–<lpage>15984</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="sc38"><label>[38]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Andrea R. Dos</given-names> <surname>Santos</surname></string-name>, <string-name><given-names>Rita</given-names> <surname>Di Martino</surname></string-name>, <string-name><given-names>Samuele E. A.</given-names> <surname>Testa</surname></string-name>, and <string-name><given-names>Sara</given-names> <surname>Mitri</surname></string-name></person-group>. <article-title>Classifying Interactions in a Synthetic Bacterial Community Is Hindered by Inhibitory Growth Medium</article-title>. <source>mSystems</source>, <volume>7</volume>(<issue>5</issue>):<fpage>e00239</fpage>–<lpage>22</lpage>, <year>2022</year>.</mixed-citation></ref>
<ref id="sc39"><label>[39]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Kathleen</given-names> <surname>Sprouffske</surname></string-name> and <string-name><given-names>Andreas</given-names> <surname>Wagner</surname></string-name></person-group>. <article-title>Growthcurver: an R package for obtaining interpretable metrics from microbial growth curves</article-title>. <source>BMC Bioinformatics</source>, <volume>17</volume>(<issue>1</issue>):<fpage>172</fpage>, <year>2016</year>.</mixed-citation></ref>
<ref id="sc40"><label>[40]</label><mixed-citation publication-type="other"><person-group person-group-type="author"><string-name><given-names>Ole</given-names> <surname>Tange</surname></string-name></person-group>. <source>GNU Parallel 20231122 (‘Grindavík’)</source>, <year>2023</year>.</mixed-citation></ref>
<ref id="sc41"><label>[41]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Isabel</given-names> <surname>Gordo</surname></string-name>, <string-name><given-names>Lilia</given-names> <surname>Perfeito</surname></string-name>, and <string-name><given-names>Ana</given-names> <surname>Sousa</surname></string-name></person-group>. <article-title>Fitness Effects of Mutations in Bacteria</article-title>. <source>Journal of Molecular Microbiology and Biotechnology</source>, <volume>21</volume>(<issue>1-2</issue>):<fpage>20</fpage>–<lpage>35</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="sc42"><label>[42]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jeniffer</given-names> <surname>Concepción-Acevedo</surname></string-name>, <string-name><given-names>Howard N.</given-names> <surname>Weiss</surname></string-name>, <string-name><given-names>Waqas Nasir</given-names> <surname>Chaudhry</surname></string-name>, and <string-name><given-names>Bruce R.</given-names> <surname>Levin</surname></string-name></person-group>. <article-title>Malthusian Parameters as Estimators of the Fitness of Microbes: A Cautionary Tale about the Low Side of High Throughput</article-title>. <source>PLOS One</source>, <volume>10</volume>(<issue>6</issue>):<fpage>e0126915</fpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="sc43"><label>[43]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Paulo</given-names> <surname>Durão</surname></string-name>, <string-name><given-names>Massimo</given-names> <surname>Amicone</surname></string-name>, <string-name><given-names>Lília</given-names> <surname>Perfeito</surname></string-name>, and <string-name><given-names>Isabel</given-names> <surname>Gordo</surname></string-name></person-group>. <article-title>Competition dynamics in long-term propagations of Schizosaccharomyces pombe strain communities</article-title>. <source>Ecology and Evolution</source>, <volume>11</volume>(<issue>21</issue>):<fpage>15085</fpage>–<lpage>15097</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="sc44"><label>[44]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sasha F.</given-names> <surname>Levy</surname></string-name>, <string-name><given-names>Jamie R.</given-names> <surname>Blundell</surname></string-name>, <string-name><given-names>Sandeep</given-names> <surname>Venkataram</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Quantitative evolutionary dynamics using high-resolution lineage tracking</article-title>. <source>Nature</source>, <volume>519</volume>(<issue>7542</issue>):<fpage>181</fpage>–<lpage>186</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="sc45"><label>[45]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Kelly M.</given-names> <surname>Wetmore</surname></string-name>, <string-name><given-names>Morgan N.</given-names> <surname>Price</surname></string-name>, <string-name><given-names>Robert J.</given-names> <surname>Waters</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Rapid Quantification of Mutant Fitness in Diverse Bacteria by Sequencing Randomly Bar-Coded Transposons</article-title>. <source>mBio</source>, <volume>6</volume>(<issue>3</issue>):<fpage>e00306</fpage>–<lpage>15</lpage>, <year>2015</year>.</mixed-citation></ref>
<ref id="sc46"><label>[46]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Morgan N.</given-names> <surname>Price</surname></string-name>, <string-name><given-names>Kelly M.</given-names> <surname>Wetmore</surname></string-name>, <string-name><given-names>R. Jordan</given-names> <surname>Waters</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Mutant phenotypes for thousands of bacterial genes of unknown function</article-title>. <source>Nature</source>, <volume>557</volume>(<issue>7706</issue>):<fpage>503</fpage>–<lpage>509</lpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="sc47"><label>[47]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Manon</given-names> <surname>Morin</surname></string-name>, <string-name><given-names>Emily C</given-names> <surname>Pierce</surname></string-name>, and <string-name><given-names>Rachel J</given-names> <surname>Dutton</surname></string-name></person-group>. <article-title>Changes in the genetic requirements for microbial interactions with increasing community complexity</article-title>. <source>eLife</source>, <volume>7</volume>:<elocation-id>e37072</elocation-id>, <year>2018</year>.</mixed-citation></ref>
<ref id="sc48"><label>[48]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Emily C.</given-names> <surname>Pierce</surname></string-name>, <string-name><given-names>Manon</given-names> <surname>Morin</surname></string-name>, <string-name><given-names>Jessica C.</given-names> <surname>Little</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Bacterial–fungal interactions revealed by genome-wide analysis of bacterial mutant fitness</article-title>. <source>Nat Microbiol</source>, <volume>6</volume>(<issue>1</issue>):<fpage>87</fpage>–<lpage>102</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="sc49"><label>[49]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Kara</given-names> <surname>Schmidlin</surname></string-name>, <string-name><given-names>Sam</given-names> <surname>Apodaca</surname></string-name>, <string-name><given-names>Daphne</given-names> <surname>Newell</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Distinguishing mutants that resist drugs via different mechanisms by examining fitness tradeoffs</article-title>. <source>eLife</source>, <volume>13</volume>:<elocation-id>RP94144</elocation-id>, <year>2024</year>.</mixed-citation></ref>
<ref id="sc50"><label>[50]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jonathan N V</given-names> <surname>Martinson</surname></string-name>, <string-name><given-names>Jeremy M</given-names> <surname>Chacón</surname></string-name>, <string-name><given-names>Brian A</given-names> <surname>Smith</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Mutualism reduces the severity of gene disruptions in predictable ways across microbial communities</article-title>. <source>The ISME Journal</source>, <volume>17</volume>(<issue>12</issue>):<fpage>2270</fpage>–<lpage>2278</lpage>, <year>2023</year>.</mixed-citation></ref>
<ref id="sc51"><label>[51]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Milo S.</given-names> <surname>Johnson</surname></string-name>, <string-name><given-names>Alena</given-names> <surname>Martsul</surname></string-name>, <string-name><given-names>Sergey</given-names> <surname>Kryazhimskiy</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name></person-group>. <article-title>Higher-fitness yeast genotypes are less robust to deleterious mutations</article-title>. <source>Science</source>, <volume>366</volume>(<issue>6464</issue>):<fpage>490</fpage>–<lpage>493</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="sc52"><label>[52]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Alex N. Nguyen</given-names> <surname>Ba</surname></string-name>, <string-name><given-names>Ivana</given-names> <surname>Cvijović</surname></string-name>, <string-name><given-names>José I. Rojas</given-names> <surname>Echenique</surname></string-name>, <etal>et al.</etal></person-group> <article-title>High-resolution lineage tracking reveals travelling wave of adaptation in laboratory yeast</article-title>. <source>Nature</source>, <volume>575</volume>(<issue>7783</issue>):<fpage>494</fpage>–<lpage>499</lpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="sc53"><label>[53]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Christopher W</given-names> <surname>Bakerlee</surname></string-name>, <string-name><given-names>Angela M</given-names> <surname>Phillips</surname></string-name>, <string-name><given-names>Alex N Nguyen</given-names> <surname>Ba</surname></string-name>, and <string-name><given-names>Michael M</given-names> <surname>Desai</surname></string-name></person-group>. <article-title>Dynamics and variability in the pleiotropic effects of adaptation in laboratory budding yeast populations</article-title>. <source>eLife</source>, <volume>10</volume>:<elocation-id>e70918</elocation-id>, <year>2021</year>.</mixed-citation></ref>
<ref id="sc54"><label>[54]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Alejandro</given-names> <surname>Couce</surname></string-name>, <string-name><given-names>Anurag</given-names> <surname>Limdi</surname></string-name>, <string-name><given-names>Melanie</given-names> <surname>Magnan</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Changing fitness effects of mutations through long-term bacterial evolution</article-title>. <source>Science</source>, <volume>383</volume>(<issue>6681</issue>):<fpage>eadd1417</fpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="sc55"><label>[55]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Guri</given-names> <surname>Giaever</surname></string-name>, <string-name><given-names>Angela M.</given-names> <surname>Chu</surname></string-name>, <string-name><given-names>Li</given-names> <surname>Ni</surname></string-name>, <etal>et al.</etal></person-group> <article-title>Functional profiling of the Saccharomyces cerevisiae genome</article-title>. <source>Nature</source>, <volume>418</volume>(<issue>6896</issue>):<fpage>387</fpage>–<lpage>391</lpage>, <year>2002</year>.</mixed-citation></ref>
</ref-list>
</sec>
<sec>
<fig id="figS1" position="float" fig-type="figure">
<label>Fig. S1.</label>
<caption><title>Predicting the absolute and relative abundance of microbial populations.</title>
<p><italic>A</italic>) Example timeseries of absolute abundance for a single microbial population (light grey). The observer (eye symbol) of the timeseries at time <italic>t</italic> can ask about the future trend in absolute abundance (arrows). (B) Example timeseries of absolute abundance for two microbial strains, that may represent a population of wild-type and mutant. The absolute abundance of the wild-type strain (light grey) is stacked on top of the absolute abundance of the mutant strain (dark grey). Similarly, the observer (eye symbol) can ask about the future trend for the absolute abundance of the mutant population or the wild-type population in this co-culture. (C) The relative abundance for the mutant strain corresponding to panel (B). We sketch the mean relative abundance <italic>x</italic> over time (green line) inferred from multiple replicates (rectangles). <italic>A</italic>n error band (light green) around the timeseries demonstrates the variation between replicates. The observer (eye symbol) can ask about the future trend for the relative abundance of the mutant population (arrows).</p></caption>
<graphic xlink:href="608874v1_figS1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Fig. S2.</label>
<caption><title>The effect of encodings on a non-logistic relative abundance trajectory.</title>
<p>Example rajectory of relative abundance <italic>x</italic> (top panel) for a mutant invading and eventually replacing a wild-type population, simulated with the Gompertz equation <inline-formula><inline-graphic xlink:href="608874v1_inline85.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.Below, we show the Gompertz trajectory under the encoding log <italic>x</italic> and the logit-encoding log(<italic>x/</italic>(1 - <italic>x</italic>)). Compare to <xref rid="fig1" ref-type="fig">Fig. 1<italic>A</italic></xref> for a trajectory simulated with the logistic equation.</p></caption>
<graphic xlink:href="608874v1_figS2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Fig. S3.</label>
<caption><title>The advantages of the logit-encoding for linear regression to relative abundance time-series data.</title>
<p>(A) Linear regression to the example trajectory for mutant relative abundance from <xref rid="fig1" ref-type="fig">Fig. 1<italic>A</italic></xref>. Given the true relative abundance <italic>x(t)</italic> (green line), we sample the relative abundance at a set of intermediate timepoints (grey dots; top row) assuming a binomial distribution and fit a linear regression line (red line; top row). We transform samples of raw relative abundance <italic>x</italic> (grey dots; top row) into the log-encoded abundance log <italic>x</italic> (grey dots; middle row) and fit a linear regression (red line; middle row). Similarly, we fit a regression the logit-encoded abundance logit <italic>x</italic> (bottom row). (B) Corresponding residuals plot for the regressions in panel <italic>A</italic>. The sampled relative abundance values (grey dots; panel <italic>A</italic>) are compared to the fitted regression (red line; panel <italic>A</italic>) to calculate the residuals (grey dots; this panel). <italic>A</italic> red line traces the mean value of the residuals. We observe that the residuals under the logit-encoding (bottom row) show no systematic trend in the mean residuals (red line) and have constant variation across timepoints (grey dots).</p></caption>
<graphic xlink:href="608874v1_figS3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Fig. S4.</label>
<caption><title>The variation of wild-type and mutant log fold-change under resource consumption constraints</title>
<p>(A) Schematic fold-change variation under a perfect resource consumption constraint between wild-type and mutant. Each dot corresponds to a mutant strain in a 50:50 competition growth cycle with the wild-type strain (Sec. S5). The wild-type LFC is lower in competition with mutants that have very high LFC (red dots) because more resources are consumed by mutant cells. For our model of population dynamics, we can calculate this constraint exactly (black line: <xref ref-type="disp-formula" rid="eqnS36">Eq. (S36)</xref>). We highlight the bow-tie area of misranking (red shading; compare <xref rid="fig1" ref-type="fig">Fig. 1D</xref>) for two mutants and show the correlation between relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline86.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline87.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in the inset. (B) Schematic fold-change variation that deviates from the resource consumption constraint. <italic>A</italic>dditional variation between the competition growth cycles, e.g., due to variation in the biomass yield of the mutant strains, means that the fold-change values do not fall on a single resource consumption constraint (black line; same as in panel <italic>A</italic>). This can give rise to rank differences in relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline88.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline89.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (inset) for those mutants (orange, blue and green dots) that fall in the bow-tie area of the focal strain (red dot).</p></caption>
<graphic xlink:href="608874v1_figS4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Fig. S5.</label>
<caption><title>Replicate measurements for growth rate, lag time and yield in our empirical trait dataset.</title>
<p>(<italic>A</italic>) Covariation of growth rate between replicate measurements of the knockouts (grey dots; Pearson correlation coefficient <italic>r</italic> = 0.94, <italic>p</italic> = 0.00). Each dot represents a mutant genotype from the single-gene knockout collection in <italic>Saccharomyces cerevisiae</italic> [<xref ref-type="bibr" rid="c55">55</xref>] as measured by Warringer et al. [<xref ref-type="bibr" rid="c24">24</xref>]. For the vast majority of genotypes in our dataset (<italic>n</italic> = 4163 out of <italic>n</italic> = 4492 knockouts) we are able to fit two traits from two independent growth curve measurements (<xref rid="fig2" ref-type="fig">Fig. 2<italic>A</italic></xref>; Methods). (B) Covariation of lag time between replicate measurements of the knockouts (grey dots; <italic>r</italic> = 0.90, <italic>p</italic> = 0.00) (C) Covariation of biomass yield between replicate measurements of the knockouts (grey dots; <italic>r</italic> = 0.43, <italic>p</italic> = 4.81 × 10<sup><italic>-</italic>188</sup>).</p></caption>
<graphic xlink:href="608874v1_figS5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS6" position="float" fig-type="figure">
<label>Fig. S6.</label>
<caption><title>The distribution of fitness effects under relative fitness per-cycle and per-generation.</title>
<p>(<italic>A</italic>) Distribution of relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline90.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for the knockouts (grey) and wild-type replicates (orange) in our dataset (<xref rid="fig2" ref-type="fig">Fig. 2<italic>A</italic></xref>), based on the fitness data from <xref rid="fig2" ref-type="fig">Fig. 2E</xref>. (B) Distribution of relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline91.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Based on the fitness data in <xref rid="fig2" ref-type="fig">Fig. 2E</xref>. Covariation in fitness ranks between relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline92.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline93.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For each fitness statistic, we calculate the mutant ranking (higher rank means higher fitness and mutants with equal fitness are assigned the lowest rank in the group), based on the rank data from <xref rid="fig2" ref-type="fig">Fig. 2F</xref>.</p></caption>
<graphic xlink:href="608874v1_figS6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS7" position="float" fig-type="figure">
<label>Fig. S7.</label>
<caption><title>Exploring alternative conditions for misranking between fitness statistics in yeast gene-deletion data.</title>
<p>(<italic>A</italic>: top row) Small mutant frequency <italic>x</italic> = 0.01. (B: second row) Standard mutant frequency <italic>x</italic> = 0.5, but no variation in lag time. (C: third row) Standard mutant frequency <italic>x</italic> = 0.5, but no variation in growth rate. (D: fourth row) Standard mutant frequency <italic>x</italic> = 0.5, but no variation in biomass yield. (E: bottom row) Standard mutant frequency <italic>x</italic> = 0.5, but only positive variation in biomass yield. See <xref rid="fig2" ref-type="fig">Fig. 2</xref> for the default case and panel legends.</p></caption>
<graphic xlink:href="608874v1_figS7.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS8" position="float" fig-type="figure">
<label>Fig. S8.</label>
<caption><title>Example dataset with anti-correlation between relative fitness per-cycle and per-generation.</title>
<p>(<italic>A</italic>) Covariation between growth rate and lag time for a synthetically generated dataset of mutants (grey dots) and a single wild-type (orange dots). The variation here may represent the standing variation in an evolved population with improved growth rate and lag time over the wild-type ancestor. The graphic overlap between points means they appear as a single line. (B) Covariation between growth rate and biomass yield for the mutants (grey dots) and wild-type (orange dot) in this synthetic dataset. The variation here is specifically chosen to generate anticorrelation between relative fitnes per-cycle and per-generation. (C) Covariation between relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline94.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline95.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for the mutants in panel <italic>A</italic>-B. We simulate pairwise competitions for all mutants against the wild-type with the exact same settings as for the empirical dataset (<xref rid="fig2" ref-type="fig">Fig. 2D</xref>; Methods). (D) Covariation between mutant and wild-type fold-change in the competitions. Based on the competition data in panel C (grey dots), we estimate the LFC values for all mutant-to-wild-type competitions (grey dots). We highlight the bow-tie area of misranking for the mutant with the lowest overall fold-change (red shading; compare <xref rid="fig1" ref-type="fig">Fig. 1D</xref>). <italic>A</italic> dashed black line shows the isocline for zero relative fitness per-cycle (<xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>). (E) Distribution of relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline96.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for the mutants in panel <italic>A</italic>-B. Based on the fitness data from panel C. (F) Distribution of relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline97.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for the mutants in panel <italic>A</italic>-B. Based on the fitness data from panel C.</p></caption>
<graphic xlink:href="608874v1_figS8.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS9" position="float" fig-type="figure">
<label>Fig. S9.</label>
<caption><title>Comparison of mutant fitness rankings across the complete LTEE competition dataset.</title>
<p>(<italic>A</italic>) Covariation between relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline98.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline99.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for evolved populations of the LTEE. We calculate the fitness statistics based on the competition data published by Wiser et al. [<xref ref-type="bibr" rid="c29">29</xref>], who measured the fitness every 250-500 generations (color bar). Each line of the LTEE contributes roughly two competitions per time-point due to replicate measurements [<xref ref-type="bibr" rid="c29">29</xref>] (Sec. S8). (B) Rank disagreement between relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline100.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline101.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for evolved populations of the LTEE. For each fitness statistic, we calculate a ranking (higher rank means higher fitness and mutants with equal fitness are assigned the lowest rank in the group; compare <xref rid="fig2" ref-type="fig">Fig. 2F</xref>). The rank difference is defined as the rank in <inline-formula><inline-graphic xlink:href="608874v1_inline102.gif" mime-subtype="gif" mimetype="image"/></inline-formula> minus the rank in <inline-formula><inline-graphic xlink:href="608874v1_inline103.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We highlight the evolved population with the greatest rank difference (blue halo). (C) Covariation between the wild-type and mutant fold-change for the competition data from the LTEE [<xref ref-type="bibr" rid="c29">29</xref>]. The term ’mutant’ (y-axis) refers to an evolved populations at a given time-point from one of the 12 lines of the LTEE. We highlight the evolved population with the greatest rank difference (blue halo; compare panel B) and draw its corresponding bow-tie area of misranking between <inline-formula><inline-graphic xlink:href="608874v1_inline104.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="608874v1_inline105.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (red shading; compare <xref rid="fig1" ref-type="fig">Fig. 1F</xref>). The coloring in all panels refers to the time-point at which the evolved population was sampled from the LTEE.</p></caption>
<graphic xlink:href="608874v1_figS9.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS10" position="float" fig-type="figure">
<label>Fig. S10.</label>
<caption><title>Rank difference between relative fitness per-cycle and per-generation as a function of time in the LTEE.</title>
<p>For each of the 12 lines in the LTEE, we compute the relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline106.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline107.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as a function of time, by averaging the data from the LTEE competition dataset [<xref ref-type="bibr" rid="c29">29</xref>] across replicate measurements (Sec. S8). For some lines, the time-series is truncated due to measurement difficulties [<xref ref-type="bibr" rid="c29">29</xref>]. Based on the quantitative fitness values <inline-formula><inline-graphic xlink:href="608874v1_inline108.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="608874v1_inline109.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, we compute fitness rankings between the replicate lines at any given timepoint (higher rank means higher fitness and mutants with equal fitness are assigned the lowest rank in the group; compare <xref rid="fig2" ref-type="fig">Fig. 2F</xref>). The rank difference is defined as the rank in <inline-formula><inline-graphic xlink:href="608874v1_inline110.gif" mime-subtype="gif" mimetype="image"/></inline-formula> minus the rank in <inline-formula><inline-graphic xlink:href="608874v1_inline111.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and we combine the rank difference between all pairs of evolving lines to compute the maximum rank difference at each time-point. At three chosen time-points (<italic>t</italic> = 4000, <italic>t</italic> = 15000, <italic>t</italic> = 30000 generations), we show the correlation between relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline112.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline113.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (each dot corresponds to one of the 12 lines in the LTEE). We quantify the correlation between <inline-formula><inline-graphic xlink:href="608874v1_inline114.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="608874v1_inline115.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with the Spearman rank correlation <italic>ρ</italic> (panel title). Colors indicate the time-point and correspond to the color bar in <xref rid="figS9" ref-type="fig">Fig. S9</xref>.</p></caption>
<graphic xlink:href="608874v1_figS10.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS11" position="float" fig-type="figure">
<label>Fig. S11.</label>
<caption><title>Long-term fitness trends in the LTEE under relative fitness per-cycle and per-generation.</title>
<p>(<italic>A</italic>) Fit of a hyperbolic model (pink line; <xref ref-type="disp-formula" rid="eqnS45">Eq. (S45)</xref>) and a power-law model (cyan line; <xref ref-type="disp-formula" rid="eqnS46">Eq. (S46)</xref>) to a pooled time-series of relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline116.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We pool the fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline117.gif" mime-subtype="gif" mimetype="image"/></inline-formula> from all 12 lines of the LTEE into a single dataset (grey dots) and repeat the fits of Wiser et al [<xref ref-type="bibr" rid="c29">29</xref>] (Sec. S8). We compute the fraction of variance explained <italic>R</italic><sup>2</sup> as a measure for the quality of fit (hyperbolic model: <italic>R</italic><sup>2</sup> = 0.682, power-law model: <italic>R</italic><sup>2</sup> = 0.701). (B) Fit of hyperbolic (pink) and power-law models (cyan) to a pooled time-series of relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline118.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Similar to panel <italic>A</italic>, we pool the relative fitness-per cycle <inline-formula><inline-graphic xlink:href="608874v1_inline119.gif" mime-subtype="gif" mimetype="image"/></inline-formula> from all 12 lines of the LTEE into a single dataset (grey dots) and identify a the best fit for the hyperbolic model (<italic>R</italic><sup>2</sup> = 0.756) and and the power-law model (<italic>R</italic><sup>2</sup> = 0.764). (C) Fit of hyperbolic (pink) and power-law models (cyan) to an averaged time-series of relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline120.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Following the ’grand-mean’ averaging strategy outlined in Wiser et al. [<xref ref-type="bibr" rid="c29">29</xref>], we compute the average relative fitness per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline121.gif" mime-subtype="gif" mimetype="image"/></inline-formula> across all evolving lines (grey dots; Methods) and identify a the best fit for the hyperbolic model (<italic>R</italic><sup>2</sup> = 0.938) and the power-law model (<italic>R</italic><sup>2</sup> = 0.964). Note that the fraction of variance explained in is much higher compared to panel <italic>A</italic>, because the averaged time-series has fewer points (Sec. S8). (D) Fit of hyperbolic (pink) and power-law models (cyan) to an averaged time-series of relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline122.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Simlar to panel C, we compute the average relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline123.gif" mime-subtype="gif" mimetype="image"/></inline-formula> across all evolving lines in the LTEE and identify the best fit for the hyperbolic model (<italic>R</italic><sup>2</sup> = 0.953) and the power-law model (<italic>R</italic><sup>2</sup> = 0.966). For a comparison between our results and the original fit by Wiser et al [<xref ref-type="bibr" rid="c29">29</xref>], see Sec. S8.</p></caption>
<graphic xlink:href="608874v1_figS11.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS12" position="float" fig-type="figure">
<label>Fig. S12.</label>
<caption><title>Comparing magnitude epistasis between relative fitness per-cycle and per-generation.</title>
<p>(<italic>A</italic>) Simulated competition growth cycle for a single mutant with short lag time (blue line) in co-culture with a wild-type strain (grey line). We simulate the co-culture using the same settings as for our empirical dataset (Fig. D; Methods). In the top, we show the final relative abundance of the mutant <italic>x</italic><sub><italic>f</italic></sub>, the relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline124.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (Eq.(8)) and per-generation <inline-formula><inline-graphic xlink:href="608874v1_inline125.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref ref-type="disp-formula" rid="eqn9">Eq. (9)</xref>). (B) Simulated competition growth cycle for a single mutant with higher biomass yield (red line), competing against the same wild-type as in panel <italic>A</italic> (grey line) (C) Simulated competition growth cycle for a double mutant (purple line) with shorter lag time (as in panel <italic>A</italic>) and higher biomass yield (as in panel B). Compare panel <italic>A</italic>-C to <xref rid="fig3" ref-type="fig">Fig. 3C-D</xref> for the epsistasis plot. (D) Simulated competition growth cycle for single mutant with higher growth rate (blue line). (E) Simulated competition growth cycle for a single mutant with higher biomass yield (red line), same as panel B. (F) Simulated competition growth cycle for a double mutant (purple line) with higher growth rate (as in panel D) and higher biomass yield (as in panel E). Compare panel D-F to <xref rid="fig3" ref-type="fig">Fig. 3E-F</xref> for the epistasis plot.</p></caption>
<graphic xlink:href="608874v1_figS12.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS13" position="float" fig-type="figure">
<label>Fig. S13.</label>
<caption><title>Predicting relative fitness with monoculture proxies under different scenarios of trait variation.</title>
<p>(<italic>AA</italic>) Covariation between growth rate and lag time in our empirical trait distribution (same as <xref rid="fig2" ref-type="fig">Fig. 2B</xref>). (<italic>A</italic>B) Covariation between growth rate and biomass yield in our empirical trait distribution (same as <xref rid="fig2" ref-type="fig">Fig. 2C</xref>). (<italic>A</italic>C) Quality of prediction for different monoculture proxies under the trait distribution in panel <italic>AA</italic>-<italic>A</italic>B. <italic>A</italic>s the ground truth, we estimate the relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline126.gif" mime-subtype="gif" mimetype="image"/></inline-formula> using a simulated 50:50 competition growth cycle (<xref rid="fig2" ref-type="fig">Fig. 2D</xref>; Methods). For each genotype <italic>i</italic>, we compute the growth rate difference Δ <italic>g</italic> = <italic>g</italic><sub><italic>i</italic></sub> − <italic>g</italic><sub>wt</sub>, the lag time difference Δ lag = λ<sub><italic>i</italic></sub>−λ <sub>wt</sub> and the difference in biomass yield Δ yield = <italic>Y</italic><sub><italic>i</italic></sub> − <italic>Y</italic><sub>wt</sub>. <italic>A</italic>dditionally, we compute the difference in log fold-change Δ LFC = LFC<sub><italic>i</italic></sub> − LFC<sub>wt</sub> and the difference in area under the curve Δ<italic>A</italic>UC = <italic>A</italic>UC<sub><italic>i</italic></sub> − <italic>A</italic>UC<sub>wt</sub> from simulated monoculture growth curves (Sec. S9). We quantify the agreement between the monoculture proxy and the relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline127.gif" mime-subtype="gif" mimetype="image"/></inline-formula> using theSpearman correlation coefficient <italic>ρ</italic>, which reflects the agreement in ranking. (B: second row) Modified trait distribution with no variation in lag time. (C: third row) Modified trait distribution with no variation in growth rate. (D: fourth row) Modified trait distribution with no variation in biomass yield.</p></caption>
<graphic xlink:href="608874v1_figS13.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS14" position="float" fig-type="figure">
<label>Fig. S14.</label>
<caption><title>The choice of the cut-off time for evaluating the area under the curve</title>
<p><bold>(<italic>A</italic>UC)</bold>. (<italic>A</italic>) Distribution of saturation times in mono-culture for the knockouts (grey bars) and wild-type replicates (orange bars; not visible) in our empirical dataset (<xref rid="fig2" ref-type="fig">Fig. 2<italic>A</italic></xref>). The saturation time <italic>t</italic><sub>sat</sub> is defined as the time when the limiting resource is depleted (<italic>R</italic>(<italic>t</italic><sub>sat</sub>) = 0) and can be estimated numerically from the trait data (Methods). Three vertical lines indicate example choices for the cut-off time <italic>t</italic><sub>eval</sub> of the <italic>A</italic>UC: the most frequent saturation time (<italic>t</italic><sub>eval</sub> = 13 hours; purple line), an external timescale (<italic>t</italic><sub>eval</sub> = 24 hours; blue line) and as saturation time half-way in the decay of the distribution (<italic>t</italic><sub>eval</sub> = 16 hours; black line). (B) Covariation between relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline128.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>A</italic>UC with a short cut-off time. We compute the <italic>A</italic>UC from a simulated monoculture knockouts (grey dots) and wild-type replicates (orange dots) using the cutoff time <italic>t</italic><sub>eval</sub> = 13 hours (Sec. S9). <italic>A</italic>s the ground truth, we take the relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline129.gif" mime-subtype="gif" mimetype="image"/></inline-formula> from a pairwise competition (<xref rid="fig2" ref-type="fig">Fig. 2<italic>A</italic></xref>). <italic>A</italic>s a red line, we show the best fit from a linear regression of <inline-formula><inline-graphic xlink:href="608874v1_inline130.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to the <italic>A</italic>UC. (C) Covariation between relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline131.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>A</italic>UC with an intermediate cut-off time (<italic>t</italic><sub>eval</sub> = 16 hours). (D) Covariation between relative fitness per-cycle <inline-formula><inline-graphic xlink:href="608874v1_inline132.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>A</italic>UC with a longer cut-off time (<italic>t</italic><sub>eval</sub> = 24 hours).</p></caption>
<graphic xlink:href="608874v1_figS14.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS15" position="float" fig-type="figure">
<label>Fig. S15.</label>
<caption><title>The error in mutant fitness rankings between bulk and pairwise competition experiments.</title>
<p>(<italic>A</italic>) Rank difference between total relative fitness and pairwise relative fitness in a bulk competition growth cycle with low mutant library abundance (<xref rid="fig4" ref-type="fig">Fig. 4<italic>A</italic></xref>, case II). Based on the fitness data in <xref rid="fig4" ref-type="fig">Fig. 4C</xref>, we calculate a mutant ranking for total relative fitness in bulk (<xref ref-type="disp-formula" rid="eqn22">Eq. (22)</xref>) and a ranking for pairwise relative fitness in bulk (<xref ref-type="disp-formula" rid="eqn23">Eq. (23)</xref>) (higher rank means higher fitness and mutants with equal fitness are assigned the lowest rank in the group). The rank difference is defined as the rank in total relative fitness <inline-formula><inline-graphic xlink:href="608874v1_inline133.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and minus the rank in pairwise relative fitness <inline-formula><inline-graphic xlink:href="608874v1_inline134.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. (B) Rank difference between pairwise relative fitness in bulk (<xref ref-type="disp-formula" rid="eqn23">Eq. (23)</xref>) and the relative fitness per-cycle in a pairwise competition (<xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>). Based on the pairwise relative fitness at low mutant library abundance in <xref rid="fig4" ref-type="fig">Fig. 4C</xref> (red dots; case II), we calcuate a mutant ranking for pairwise relative fitness in bulk (<xref ref-type="disp-formula" rid="eqn23">Eq. (23)</xref>) and a mutant ranking for the relative fitness per-cycle in pairwise competition (<xref ref-type="disp-formula" rid="eqn8">Eq. (8)</xref>. The rank difference (red dots) is defined as the rank in bulk competition minus the rank in pairwise competition. (C) Rank difference between pairwise relative fitness in bulk and the relative fitness per-cycle in a pairwise competition for two different cases of the bulk competition. Based on the fitness data in the inset of <xref rid="fig4" ref-type="fig">Fig. 4C</xref>, we estimate a mutant ranking for pairwise relative fitness (<xref ref-type="disp-formula" rid="eqn23">Eq. (23)</xref>) in the case of a bulk competition growth cycle with high mutant library abundance (blue dots; compare <xref rid="fig4" ref-type="fig">Fig. 4<italic>A</italic></xref>, case III). For each case, the rank difference is defined as the rank in the bulk competition minus the rank in pairwise competition and the rank difference for case II (red dots) is identical to the data in panel B. <italic>A</italic>ll fitness statistics in this figure are based on the logit-encoding, however, since the underlying relative abundances are small (<italic>x</italic> ≪ 1), it is approximately equivalent to the log-encoding (log <italic>x</italic> ≈ logit <italic>x</italic>).</p></caption>
<graphic xlink:href="608874v1_figS15.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS16" position="float" fig-type="figure">
<label>Fig. S16.</label>
<caption><title><italic>A</italic> decomposition for the error from higher-order interactions in bulk competition experiments.</title>
<p>For a bulk competition growth cycle with low mutant library abundance (<xref rid="fig4" ref-type="fig">Fig. 4<italic>A</italic></xref>, case II), we calculate the pairwise relative fitness (<xref ref-type="disp-formula" rid="eqn23">Eq. (23)</xref>) for the knockouts in our empirical dataset (<xref rid="fig2" ref-type="fig">Fig. 2<italic>A</italic></xref>) using a previously established approximation [<xref ref-type="bibr" rid="c28">28</xref>] (Sec. S13). The error from higher-order interactions is defined as the pairwise fitness in bulk minus the fitness in pairwise competition. Based on the approximation for our model of population dynamics (Sec. (S13)), we derive a decomposition that separates the absolute error into two terms that we call the <italic>fitness-dependent error term</italic> (dark dots) and the <italic>fitness-independent error term</italic> (light dots). For full details on the decomposition, see Sec. (S14).</p></caption>
<graphic xlink:href="608874v1_figS16.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<fig id="figS17" position="float" fig-type="figure">
<label>Fig. S17.</label>
<caption><title>The relative error between bulk and pairwise competition experiments.</title>
<p>(<italic>A</italic>) Comparing the relative error between total and pairwise relative fitness in bulk. Based on the absolute error in <xref rid="fig4" ref-type="fig">Fig. 4C</xref>, we estimate a relative error for the total relative fitness (grey dots; <xref ref-type="disp-formula" rid="eqn22">Eq. (22)</xref>) and pairwise relative fitness (red dots; <xref ref-type="disp-formula" rid="eqn23">Eq. (23)</xref>) in a bulk competition growth cycle with low mutant library abundance (<xref rid="fig4" ref-type="fig">Fig. 4<italic>A</italic></xref>, case II). The relative error of each bulk statistic is defined as the absolute error (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>), divided by the fitness in pairwise competition (<xref ref-type="disp-formula" rid="eqnS91">Eq. (S91)</xref>). <italic>A</italic> dashed grey line indicates the threshold of 1% relative error. (B) Comparing the relative error between the components of higher-order interactions. Based on the absolute error from higher-order interactions in <xref rid="figS16" ref-type="fig">Fig. S16</xref>, we estimate the relative error for the fitness-dependent (dark dots) and the fitness-independent error component (light dots). Here the relative error is defined as the absolute error component (<xref rid="figS16" ref-type="fig">Fig. S16</xref>), divided by the relative fitness per-cycle in pairwise competition (see Sec. S14 for details). (C) Comparing the relative error between low and high mutant library abundance in bulk. Based on the absolute error in the inset of <xref rid="fig4" ref-type="fig">Fig. 4C</xref>, we estimate a relative error for the pairwise relative fitness at low mutant library abundance (red dots; <xref rid="fig4" ref-type="fig">Fig. 4<italic>A</italic></xref>, case II) and high mutant library abundance (blue dots; <xref rid="fig4" ref-type="fig">Fig. 4<italic>A</italic></xref>, case III). The relative error for each case is defined as the as absolute error (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>; inset), divived by the fitness in pairwise competition (<xref ref-type="disp-formula" rid="eqnS91">Eq. (S91)</xref>). On the x-axis, we plot the absolute value of relative fitness per-cycle in the pairwise competition.</p></caption>
<graphic xlink:href="608874v1_figS17.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.102635.1.sa4</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Mitri</surname>
<given-names>Sara</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Lausanne</institution>
</institution-wrap>
<city>Lausanne</city>
<country>Switzerland</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
</front-stub>
<body>
<p>This manuscript applies a theoretical analysis to two published datasets on yeast and bacterial evolution to compare different ways of quantifying fitness. It makes an <bold>important</bold> advance by clarifying how discrepancies can arise by using different approaches and provides recommendations for best practices. While the evidence is <bold>solid</bold>, some improvements in the presentation of the data and a greater focus on the causes of the discrepancies between the various fitness estimates would strengthen the paper further.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.102635.1.sa3</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The authors point out that the fitness estimates obtained from different experimental assays (monoculture, pairwise competition, or bulk competition) are not generally equivalent, not even with regard to the fitness ranking of different genotypes. Using a computational model based on experimentally measured growth phenotypes for knockout strains in yeast, as well as data from Lenski's Long Term Evolution Experiment (LTEE), they derive a set of best practice rules aimed at extracting the optimal amount of information from such experiments.</p>
<p>The study is very complete on a technical level and I have no suggestions for further analyses. However, I feel the readability and the conceptual focus of the manuscript could be significantly improved by rearranging the material with regard to the contents of the main text vs. the Methods and the Supplement. Detailed recommendations:</p>
<p>(1) Regarding readability, the large number of references to material in the Methods and Supplement fragment the main text and make it difficult to follow.</p>
<p>(2) Conceptually, it seems to me that the current presentation obscures the reasons why we should care about fitness in the first place. In the first paragraph of Results, the authors define fitness &quot;as any number that is sufficient to predict the genotype's relative abundance x(t) over a short-time horizon&quot;. To me, this seems like an extremely narrow and not very interesting definition. Instead, I view fitness as an intrinsic property of a genotype that allows us to predict its performance</p>
<p>
under a range of conditions, including in particular conditions that are different from the experimental setup that was used to obtain the fitness estimates. The latter viewpoint is well expressed in Supplementary Section S1, where the authors discuss the notion of fitness potential. I would recommend to move at least part of this discussion to the main text. By comparison, the arguments in favor of the logit encoding that currently opens the Results session are rather straightforward and could be shortened significantly.</p>
<p>(3) Similarly, the modeling strategy used in this work is quite subtle and needs to be explained more fully in the main text. The authors use growth traits (lag time, growth rate, and yield) extracted from monoculture experiments on a yeast knockout collection and feed them into a specific mathematical model to simulate pairwise and bulk competition scenarios. Since a key claim of the work is that monoculture experiments are generally poor predictors of competitive fitness, the basis for this conclusion and the assumptions on which it is based need to be described clearly in the main text. In the current version of the manuscript, this information has</p>
<p>
been largely relegated to the Methods section.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.102635.1.sa2</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The manuscript &quot;Quantifying microbial fitness in high-throughput experiments&quot; provides a comprehensive analysis of the various approaches to quantifying fitness in microbial evolution, focusing on three primary factors: encoding of relative abundance, time scale of measurement, and the choice of reference subpopulation. The authors systematically explore how these choices impact fitness statistics and provide recommendations aimed at standardizing practices in the field. This manuscript aims to highlight the impact of differing fitness definitions and the methodologies utilized for analysis and how that can significantly alter interpretations of mutant fitness, affecting evolutionary predictions and the overall understanding of genetic interactions in the experiments. Although this manuscript focuses on a critical issue in the quantification of fitness in high throughput experiments, it heavily relies on only one experimental dataset (Warringer et al 2003) and one organism i.e, Yeast (Saccharomyces cerevisiae) grown in a defined medium, the environmental influence is not completely captured. While the theoretical framework is strong, more experimental examples with more organisms (i.e., more datasets) in their analysis and comparison would enhance the manuscript, especially its conclusion.</p>
<p>Strengths:</p>
<p>The choices for quantifying fitness in evolution experiments are critical and highly relevant given the increasing prevalence of high-throughput experiments in evolutionary biology. The authors methodically categorize fitness statistics and their implications, providing clarity on a complex subject. This structured approach aids in understanding the nuances of fitness measurement. The manuscript effectively highlights how different choices in fitness measurement can influence fitness rankings and the understanding of epistasis, which is important for modeling evolutionary dynamics.</p>
<p>Weaknesses:</p>
<p>The theoretical framework is robust, but the manuscript could benefit from more empirical examples to illustrate how different fitness quantification methods lead to varied conclusions in experiments. The discussion on the choice of reference subpopulation could be expanded with the influence of the environment or the condition. Different types of reference groups might yield different implications for fitness calculations, and further elaboration would enhance this section. The authors overgeneralize some findings; for instance, the implications of fitness measurement choices could vary significantly across different microbes or experimental conditions. A more detailed discussion would strengthen the conclusion.</p>
<p>Overall, this manuscript is a significant contribution to the field of evolutionary biology, addressing a critical issue in the quantification of fitness but lacks more experimental support to make it a wider claim. By systematically exploring the factors that influence fitness measurements, the authors provide valuable insights that can guide future research - the framework is computationally thorough but needs a more detailed explanation of concepts instead of generalizing. Further work is needed, particularly to incorporate empirical examples and expand certain discussions to include environmental variation and their impact, which would improve clarity and applicability.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.102635.1.sa1</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors present analyses of different fitness measures derived from empirical data from yeast knock-out mutants and the long-term evolution experiment (LTEE) with Escherichia coli to explore discrepancies and identify preferred methods to estimate relative fitness in high-throughput experiments. Their work has three components. They first discuss the different &quot;encodings&quot; of relative abundance data and conclude that logit transformations are preferred because they transform nonlinear abundance trajectories into linear trajectories with greater predictive power. Next, they compare per-generation with per-growth cycle relative fitness estimates inferred from simulations of pairwise competitions based on published growth traits for the yeast strains and on published pairwise competition measurements for the LTEE data. Both data sets show quantitative and qualitative (i.e. rank order) discrepancies of estimates across different time scales, which are highlighted by considering possible underlying causes (i.e. trade-offs between growth traits) and consequences (i.e. epistasis among mutations affecting different growth traits). Finally, the authors compare simulated pairwise and bulk (i.e. where many mutants compete during a growth cycle in a single environment) competition assays based on the yeast knock-out mutants and demonstrate an optimal ratio of collective mutants to wild-type strains that minimizes both sampling error and overestimation of fitness estimates when compared with pairwise competitions.</p>
<p>Strengths:</p>
<p>The study deals with a highly relevant topic. Fitness is central to general evolutionary theory, but also poorly defined and implies different traits for different organisms and conditions. For microbes, which are often used in evolution experiments, high-throughput experiments may yield different measures to quantify abundance over time, from individual growth traits to bulk competition experiments. Hence, it is relevant to consider discrepancies among those measures and identify preferred measures with respect to predicting population dynamics and evolutionary processes. The present study contributes to this aim by (i) making readers aware of differences among commonly used fitness estimates, (ii) showing that simulated (yeast) and calculated (E. coli) competitive fitness may differ across time scales, and (iii) showing that bulk competitions may yield relative fitness estimates that are systematically higher than pairwise competitions. The study is rather thorough on the theory side, with extensive derivations and analyses of various fitness measures using their resource competition model in the Supplementary Information. The study ends with a few practical recommendations for preferred methods to infer relative fitness estimates, that may be useful for experimentalists and stimulate further investigations.</p>
<p>Weaknesses:</p>
<p>The study has several limitations. Perhaps the most apparent limitation is the lack of a clear answer to the question of which fitness measure is best &quot;in the light of first principles&quot;. The authors show clear discrepancies between fitness estimates across different time scales or using different reference genotypes in bulk competition and provide useful recommendations based on practical considerations (e.g. using pairwise competitions as the &quot;golden standard&quot;), but it remains unclear whether these measures provide the greatest value for the questions researchers may want to answer with them (e.g. predict shifts in genotype frequencies).</p>
<p>A second limitation is that the authors analyse fitness differences arising solely from resource competition, whereas microbes often interact via other mechanisms, e.g. the production of anticompetitior toxins, cross-feeding of metabolites, or lack of growth to enhance their persistence in stress conditions. Without simulations of these processes, understanding discrepancies among fitness measures is necessarily limited. In addition, the analysis of trade-offs between growth traits causing these discrepancies during resource competition seems confounded by biases in measurement error or parameter estimation, at least for growth rate and lag time (Figure 2B), where the replicate estimates for the wildtype show a similar negative correlation.</p>
<p>Third, the study does not validate relative fitness predictions from growth traits (as is done for the yeast mutants) with measured relative fitness estimates using competition assays, while such data are available, e.g. for the LTEE. This would strengthen their inferences about preferred fitness measures.</p>
<p>Fourth, the analysis of epistasis between mutations affecting different growth traits (shown in Figure 3) based on the LTEE data could be better introduced and analysed more comprehensively. Now, the examples given in panels C-F seem rather idiosyncratic and readers may wonder how general these consequences of using fitness estimates based on different time scales are.</p>
<p>Finally, the study is generally less accessible to experimentalists due to the extensive and principled treatment of specific population dynamic models and fitness inferences. This may distract from the overarching aim to identify fitness measures that are most accurate and useful for predictions of population dynamics and evolutionary processes. In this light, the motivation for the initial discussion of the importance of how to best encode relative abundance (Figure 1) is unclear. Also, the conclusion, that logit encoding is preferred, because it linearizes logistic growth dynamics and &quot;improves the quality of predictions&quot;, is not further motivated. Experimentalists using non-linear models to infer fitness from growth curves or competition assays may miss the relevance of this discussion.</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.102635.1.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Fink</surname>
<given-names>Justus Wilhelm</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1138-4009</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Manhart</surname>
<given-names>Michael</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-3791-9056</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>We thank all three reviewers and the editors for their detailed comments on our manuscript.  The two main themes of this feedback concern the paper’s generality and its presentation.  Reviewers #2 and #3 raise questions about how the discrepancies in fitness statistics we report will be realized across organisms, environments, and in models with interactions beyond resource competition (e.g., toxicity or cross-feeding).  All reviewers and the editors have also expressed the need for the presentation to be improved, including a broader introduction to the concept of fitness (Reviewer #1), a clearer explanation of our model (Reviewer #1), better explanations of how quantifying fitness answers key biological questions (Reviewer #3), and improvements to the most technical sections to ensure accessibility to experimentalists (Reviewer #3).</p>
<p>In light of these comments, we wish to clarify that the goal of this paper is to provide a proof-of-principle for how different choices in quantifying fitness can lead to different analysis outcomes.  Since the focus of this paper is on the theoretical concepts, we focus on a few example data sets and a simple model to demonstrate the existence of these discrepancies.  While other organisms and environments, especially with more complex growth dynamics and interactions, could certainly have additional or different discrepancies in fitness statistics, we believe the simplicity of our approach is valuable because it demonstrates that even basic features of microbial growth (common across systems) with realistic parameter values are sufficient to cause significant differences in fitness depending on these quantification choices.  We agree with the reviewers that a systematic documentation of how these fitness discrepancies are empirically realized is important, but we believe that question is best explored in separate future works that can focus fully on this empirical rather than theoretical question.</p>
<p>We plan to revise the manuscript in several ways, following the suggestions of the three reviewers and the editor.  First, we will better articulate the main goal and conclusions of this manuscript, especially its generality and limitations.  Second, we will work to streamline and clarify several points in the main text identified by the reviewers to make it more accessible and useful to a broader audience, especially experimentalists who routinely measure fitness in their work.  We are grateful to the reviewers and the editor for their time and effort in assessing the manuscript, and we look forward to providing an updated version that addresses these concerns.</p>
</body>
</sub-article>
</article>