<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">98033</article-id>
<article-id pub-id-type="doi">10.7554/eLife.98033</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.98033.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Semantical and Geometrical Protein Encoding Toward Enhanced Bioactivity and Thermostability</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Tan</surname>
<given-names>Yang</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="author-notes" rid="n1">‚Ä†</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes" corresp="yes">
<name>
<surname>Zhou</surname>
<given-names>Bingxin</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
<xref ref-type="author-notes" rid="n1">‚Ä†</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zheng</surname>
<given-names>Lirong</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Fan</surname>
<given-names>Guisheng</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Hong</surname>
<given-names>Liang</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Institute of Natural Sciences, Shanghai Jiao Tong University</institution>, Shanghai 200240, <country>China</country></aff>
<aff id="a2"><label>2</label><institution>School of Information Science and Engineering, East China University of Science and Technology</institution>, Shanghai, 200237, <country>China</country></aff>
<aff id="a3"><label>3</label><institution>Shanghai National Center for Applied Mathematics (SJTU center), Shanghai Jiao Tong University</institution>, Shanghai, 200240, <country>China</country></aff>
<aff id="a4"><label>4</label><institution>Zhangjiang Institute for Advanced Study, Shanghai Jiao Tong University</institution>, Shanghai, 201203, <country>China</country></aff>
<aff id="a5"><label>5</label><institution>Shanghai Artificial Intelligence Laboratory</institution>, Shanghai, 200232, <country>China</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Koo</surname>
<given-names>Peter</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Cold Spring Harbor Laboratory</institution>
</institution-wrap>
<city>Cold Spring Harbor</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Cui</surname>
<given-names>Qiang</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Boston University</institution>
</institution-wrap>
<city>Boston</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label><bold>For correspondence:</bold> <email>bingxin.zhou@sjtu.edu.cn</email> (Bingxin Zhou); <email>hongl3liang@sjtu.edu.cn</email> (Liang Hong)</corresp>
<fn id="n1" fn-type="equal"><label>‚Ä†</label><p>These authors contributed equally to this work</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-06-25">
<day>25</day>
<month>06</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP98033</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-03-28">
<day>28</day>
<month>03</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-03-19">
<day>19</day>
<month>03</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.12.01.569522"/>
</event>
</pub-history>
<permissions>
<copyright-statement>¬© 2024, Tan et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Tan et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-98033-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Protein engineering is a pivotal aspect of synthetic biology, involving the modification of amino acids within existing protein sequences to achieve novel or enhanced functionalities and physical properties. Accurate prediction of protein variant effects requires a thorough understanding of protein sequence, structure, and function. Deep learning methods have demonstrated remarkable performance in guiding protein modification for improved functionality. However, existing approaches predominantly rely on protein sequences, which face challenges in efficiently encoding the geometric aspects of amino acids‚Äô local environment and often fall short in capturing crucial details related to protein folding stability, internal molecular interactions, and bio-functions. Furthermore, there lacks a fundamental evaluation for developed methods in predicting protein thermostability, although it is a key physical property that is frequently investigated in practice. To address these challenges, this paper introduces a novel pre-training framework that integrates sequential and geometric encoders for protein primary and tertiary structures. This framework guides mutation directions toward desired traits by simulating natural selection on wild-type proteins and evaluates variant effects based on their fitness to perform specific functions. We assess the proposed approach using three benchmarks comprising over 300 deep mutational scanning assays. The prediction results showcase exceptional performance across extensive experiments when compared to other zero-shot learning methods, all while maintaining a minimal cost in terms of trainable parameters. This study not only proposes an effective framework for more accurate and comprehensive predictions to facilitate efficient protein engineering, but also enhances the <italic>in silico</italic> assessment system for future deep learning models to better align with empirical requirements. The PyTorch implementation are available at <ext-link ext-link-type="uri" xlink:href="https://github.com/tyang816/ProtSSN">https://github.com/tyang816/ProtSSN</ext-link>.</p>
</abstract>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Updated results on a new benchmark dataset; revised presentation.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>The diverse roles proteins play in nature necessitate their involvement in varied bio-functions, such as catalysis, binding, scaffolding, and transport (<bold><italic><xref ref-type="bibr" rid="c6">Frauenfelder and McMahon, 1998</xref></italic></bold>). Advances in science and technology have positioned proteins, particularly those with desired catalytic and binding properties, to pivotal positions in medicine, biology, and scientific research. While wild-type proteins exhibit optimal bio-functionality in their native environments, industrial applications often demand adaptation to conditions such as high temperature, high pressure, strong acidity, and strong alkalinity. The constrained efficacy of proteins in meeting the stringent requirements of industrial functioning environments hinders their widespread applications (<bold><italic><xref ref-type="bibr" rid="c53">Woodley, 2013</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c11">Ismail et al., 2021</xref></italic></bold>; <bold><italic><xref ref-type="bibr" rid="c61">Zheng et al., 2022</xref>; <xref ref-type="bibr" rid="c12">Jiang et al., 2023</xref></italic></bold>). Consequently, there arises a need to engineer these natural proteins to enhance their functionalities, aligning them with the demands of both industrial and scientific applications.</p>
<p>Analyzing the relationship between protein sequence and function yields valuable insights for engineering proteins with new or enhanced functions in synthetic biology. The intrinsic goal of protein engineering is to unveil highly functional sequences by navigating the intricate, high-dimensional surface of the fitness landscape (<bold><italic><xref ref-type="bibr" rid="c56">Yang et al., 2019</xref></italic></bold>), which delineates the relationship between amino acid (AA) sequences and the desired functional state. Predicting the effects of AA substitutions, insertions, and deletions (<bold><italic><xref ref-type="bibr" rid="c37">Riesselman et al., 2018</xref>; <xref ref-type="bibr" rid="c8">Gray et al., 2018</xref>; <xref ref-type="bibr" rid="c32">Notin et al., 2022</xref></italic></bold>) in proteins, <italic>i</italic>.<italic>e</italic>., mutation, thus allows researchers to dissect how changes in the AA sequence can impact the protein‚Äôs catalytic efficiency, stability, and binding affinity (<bold><italic><xref ref-type="bibr" rid="c45">Shin et al., 2021</xref></italic></bold>). However, the extensive, non-contiguous search space of AA combinations poses challenges for conventional methods, such as rational design (<bold><italic><xref ref-type="bibr" rid="c1">Aprile et al., 2020</xref></italic></bold>) or directed evolution (<bold><italic><xref ref-type="bibr" rid="c52">Wang et al., 2021</xref></italic></bold>), in efficiently and effectively identifying protein variants with desired properties. In response, deep learning has emerged as a promising solution that proposes favorable protein variants with high fitness.</p>
<p>Deep learning approaches have been instrumental in advancing scientific insights into proteins, predominantly categorized into sequence-based and structure-based methods. Autoregressive protein language models (<bold><italic><xref ref-type="bibr" rid="c32">Notin et al., 2022</xref>; <xref ref-type="bibr" rid="c25">Madani et al., 2023</xref></italic></bold>) interpret AA sequences as raw text to generate with self-attention mechanisms (<bold><italic><xref ref-type="bibr" rid="c48">Vaswani et al., 2017</xref></italic></bold>). Alternatively, masked language modeling objectives develop attention patterns that correspond to the residue-residue contact map of the protein (<bold><italic><xref ref-type="bibr" rid="c26">Meier et al., 2021</xref>; Rao et al., 2021a; <xref ref-type="bibr" rid="c38">Rives et al., 2021</xref>; <xref ref-type="bibr" rid="c51">Vig et al., 2021</xref>; <xref ref-type="bibr" rid="c2">Brandes et al., 2022</xref>; <xref ref-type="bibr" rid="c23">Lin et al., 2023</xref></italic></bold>). Other methods start from a multiple sequence alignment, summarizing the evolutionary patterns in target proteins (<bold><italic><xref ref-type="bibr" rid="c37">Riesselman et al., 2018</xref>; <xref ref-type="bibr" rid="c7">Frazer et al., 2021</xref>; Rao et al., 2021b</italic></bold>). These methods result in a strong capacity for discovering the hidden protein space. However, the many-to-one relationship of both sequence-to-structure and structure-to-function projections requires excessive training input or substantial learning resources, which raises concerns regarding the efficiency of these pathways when navigating the complexities of the vast sequence space associated with a target function. Moreover, the overlooked local environment of proteins hinders the model‚Äôs ability to capture structure-sensitive properties that impact protein‚Äôs thermostability, interaction with substrates, and catalytic process (<bold><italic><xref ref-type="bibr" rid="c60">Zhao et al., 2022</xref>; <xref ref-type="bibr" rid="c21">Koehler Leman et al., 2023</xref></italic></bold>). Alternatively, structure-based modeling methods serve as an effective enhancement to complement sequence-oriented inferences for proteins with their local environment (<bold><italic><xref ref-type="bibr" rid="c47">Torng and Altman, 2019</xref>; <xref ref-type="bibr" rid="c15">Jones et al., 2021</xref>; Zhou et al., 2023b; <xref ref-type="bibr" rid="c58">Yi et al., 2023</xref></italic></bold>). Given that core mutations often induce functional defects through subtle disruptions to structure or dynamics (<bold><italic><xref ref-type="bibr" rid="c41">Roscoe et al., 2013</xref></italic></bold>), incorporating protein geometry into the learning process can offer valuable insights into stabilizing protein functioning. Recent efforts have been made to encode geometric information of proteins for topology-sensitive tasks such as molecule binding (<bold><italic><xref ref-type="bibr" rid="c13">Jin et al., 2021</xref>; <xref ref-type="bibr" rid="c29">Myung et al., 2022</xref>; <xref ref-type="bibr" rid="c22">Kong et al., 2023</xref></italic></bold>) and protein properties prediction (<bold><italic><xref ref-type="bibr" rid="c59">Zhang et al., 2022</xref></italic></bold>). Nevertheless, structure encoders fall short in capturing non-local connections for AAs beyond their contact region and overlook correlations that do not conform to the ‚Äòstructure-function determination‚Äô heuristic.</p>
<p>There is a pressing need to develop a novel framework that overcomes limitations inherent in individual implementations of sequence or structure-based investigations. To this end, we introduce ProtSSN to assimilate the semantics and topology of <bold>Prot</bold>eins from their <bold>S</bold>equence and <bold>S</bold>tructure with deep neural <bold>N</bold>etworks. ProtSSN incorporates the intermediate state of protein structures and facilitates the discovery of an efficient and effective trajectory for mapping protein sequences to functionalities. The developed model extends the generalization and robustness of self-supervised protein language models while maintaining low computational costs, thereby facilitating self-supervised training and task-specific customization. A funnel-shaped learning pipeline, as depicted in <xref rid="fig1" ref-type="fig">Fig. 1</xref>, is designed due to the limited availability of protein crystal structures compared to observed protein sequences. Initially, the linguistic embedding establishes the semantic and grammatical rules in AA chains by inspecting millions of protein sequences. The topological embedding then enhances the interactions among locally connected AAs. Since a geometry can be placed or observed by different angles and positions in space, we represent proteins‚Äô topology by graphs and enhance the model‚Äôs robustness and efficiency with a rotation and translation equivariant graph representation learning scheme.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>An illustration of ProtSSN that extracts the semantical and geometrical characteristics of a protein from its sequentially-ordered global construction and spatially-gathered local contacts with protein language models and equivariant graph neural networks. The encoded hidden representation can be used for downstream tasks such as variants effect prediction that recognizes the impact of mutating a few sites of a protein on its functionality.</title></caption>
<graphic xlink:href="569522v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The pre-trained ProtSSN demonstrates its feasibility across a broad range of mutation effect prediction benchmarks covering catalysis, interaction, and thermostability. Mutation effects prediction serves as a common <italic>in silico</italic> assessment for evaluating the capability of an established deep learning framework in identifying favorable protein variants. With the continuous evolution of deep mutation scanning techniques and other high-throughput technologies, benchmark datasets have been curated to document fitness changes in mutants across diverse proteins with varying degrees of combinatorial and random modifications (<bold><italic><xref ref-type="bibr" rid="c28">Moal and Fern√°ndez-Recio, 2012</xref>; <xref ref-type="bibr" rid="c31">Nikam et al.,2021</xref>; <xref ref-type="bibr" rid="c49">Veleck·ª≥ et al., 2022</xref></italic></bold>). <bold>ProteinGym v1</bold> (<bold><italic><xref ref-type="bibr" rid="c33">Notin et al., 2023</xref></italic></bold>) comprehends fitness scoring of mutants to catalytic activity and binding affinity across over 200 well-studied proteins of varying deep mutational scanning (DMS) assays and taxa. Each protein includes tens of thousands of mutants documented from high-throughput screening techniques. While <bold>ProteinGym v1</bold> initiates the most comprehensive benchmark dataset for mutants toward different properties enhancement, these fitness scores are normalized and simplified into several classes without further specifications. For instance, a good portion of protein assays is scored by their stability, which, in practice, is further categorized into thermostability, photostability, pH-stability, <italic>etc</italic>. Moreover, these stability properties should be discussed under certain environmental conditions, such as pH and temperature. Unfortunately, these detailed attributes are excluded in <bold>ProteinGym v1</bold>. Since a trade-off relationship emerges between activity and thermostability (<bold><italic><xref ref-type="bibr" rid="c61">Zheng et al., 2022</xref></italic></bold>), protein engineering in practice extends beyond enhancing catalytic activities to maintaining or increasing thermostability for prolonged functional lifetimes and applications under elevated temperatures and chemical conditions (<bold><italic><xref ref-type="bibr" rid="c24">Liu et al., 2019</xref></italic></bold>). Consequently, there is a need to enrich mutation effect prediction benchmarks that evaluate the model‚Äôs efficacy in capturing variant effects concerning thermostability under distinct experimental conditions. In this study, we address the mutation effect prediction tasks on thermostability with <bold>DTm</bold> and <bold>DDG</bold>, two new single-site mutation benchmarks that measure thermostability using ŒîTm and ŒîŒîG values, respectively. Both benchmarks group experimental assays based on the protein-condition combinations. These two datasets supplement the publicly available DMS assay benchmarks and facilitate ready-to-use assessment for future deep learning methods toward protein thermostability enhancement.</p>
<p>This work fulfills practical necessities in the development of deep learning methods for protein engineering from three distinct perspectives. Firstly, the developed ProtSSN employs self-supervised learning during training to obviate the necessity for additional supervision in down-stream tasks. This zero-shot scenario is desirable due to the scarcity of experimental results, as well as the ‚Äòcold-start‚Äô situation common in many wet lab experiments. Secondly, the trained model furnishes robust and meaningful approximations to the joint distribution of the entire amino acid chain, thereby augmenting the <italic>epistatic effect</italic> (<bold><italic><xref ref-type="bibr" rid="c42">Sarkisyan et al., 2016</xref>; <xref ref-type="bibr" rid="c18">Khersonsky et al., 2018</xref></italic></bold>) in deep mutations. This augmentation stems from the model‚Äôs consideration of the nonlinear combinatorial effects of amino acid sites. Additionally, we complement the existing dataset of DMS assay with additional benchmark assays related to protein-environment interactions, specifically focusing on thermostability‚Äìan integral objective in numerous protein engineering projects.</p>
</sec>
<sec id="s2">
<title>Materials and Methods</title>
<p>This section starts by introducing the three mutational scanning benchmark datasets used in this study, including an open benchmark dataset <bold>ProteinGym v1</bold> and two new datasets on protein ther-mostability, <italic>i</italic>.<italic>e</italic>., <bold>DTm</bold> and <bold>DDG</bold>. Section establishes the proposed ProtSSN for protein sequences and structures encoding. The overall pipeline of model training and inference is presented in Section . The experimental setup for model evaluation is provided in Section .</p>
<sec id="s2a">
<title>Dataset</title>
<p>To evaluate model performance in predicting mutation effects, we compare ProtSSN with SOTA baselines on <bold>ProteinGym-v1</bold>, the largest open benchmark for DMS assays. We also introduce two novel benchmarks, <bold>DTm</bold> and <bold>DDG</bold>, for assessing protein thermostability under consistent control environments. Details of the new datasets are provided in <xref rid="tbl1" ref-type="table">Table 1</xref>. Considering the significant influence of experimental conditions on protein temperature, we explicitly note the pH environment in each assay. Refer to the following paragraphs for more details.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>Statistical summary of <bold>DTm</bold> and <bold>DDG</bold>.</title></caption>
<graphic xlink:href="569522v2_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s2b">
<title>ProteinGym</title>
<p>The assessment of ProtSSN for deep mutation effects prediction is conducted on <bold>ProteinGym v1</bold> (<bold><italic><xref ref-type="bibr" rid="c33">Notin et al., 2023</xref></italic></bold>). It is the most extensive protein substitution benchmark comprising 217 assays and more than 2.5<italic>M</italic> mutants. These DMS assays cover a broad spectrum of functional properties (<italic>e</italic>.<italic>g</italic>., ligand binding, aggregation, viral replication, and drug resistance) and span various protein families (<italic>e</italic>.<italic>g</italic>., kinases, ion channel proteins, transcription factors, and tumor suppressors) across different taxa (<italic>e</italic>.<italic>g</italic>., humans, other eukaryotes, prokaryotes, and viruses).</p>
<sec id="s2b1">
<title>DTm</title>
<p>The assays in the first novel thermostability benchmark are sourced from single-site mutations in <bold>ProThermDB</bold> (<bold><italic><xref ref-type="bibr" rid="c31">Nikam et al., 2021</xref></italic></bold>). Each assay is named in the format ‚Äò<italic>UniProt_ID-pH</italic>‚Äô. For instance, ‚Äò<italic>O00095-8</italic>.<italic>0</italic>‚Äô signifies mutations conducted and evaluated under pH 8.0 for protein <monospace>O00095</monospace>. The attributes include ‚Äòmutant‚Äô, ‚Äòscore‚Äô, and ‚ÄòUniProt_ID‚Äô, with at least 10 mutants to ensure a meaningful evaluation. To concentrate on single-site mutations compared to wild-type proteins, we exclude records with continuous mutations. To avoid dealing with partial or misaligned protein structures resulting from incomplete wet experimental procedures, we employ UniProt ID to pair protein sequences with folded structures predicted by AlphaFold2 (<bold><italic><xref ref-type="bibr" rid="c16">Jumper et al., 2021</xref></italic></bold>) from <ext-link ext-link-type="uri" xlink:href="https://alphafold.ebi.ac.uk">https://alphafold.ebi.ac.uk</ext-link>. In total, <bold>DTm</bold> consists of 66 such protein-environment pairs and 2, 520 mutations.</p>
</sec>
<sec id="s2b2">
<title>DDG<italic/></title>
<p>The second novel thermostability benchmark is sourced from <bold>DDMut</bold> (<bold><italic>Zhou et al., 2023c</italic></bold>), where mutants are paired with their PDB documents. We thus employ crystal structures for proteins in <bold>DDG</bold> and conduct additional preprocessing steps for environmental consistency. In particular, we group mutants of the same protein under identical experimental conditions and examine the alignment between mutation sites and sequences extracted from crystal structures. We discard mutant records that cannot be aligned with the sequence loaded from the associated PDB document. After removing data points with fewer than 10 mutations, <bold>DDG</bold> comprises 36 data points and 829 mutations. As before, assays are named in the format ‚Äò<italic>PDB_ID-pH-temperature</italic>‚Äô to indicate the chemical condition (pH) and temperature (in Celsius) of the experiment on the protein. An example assay content is provided in <xref rid="fig2" ref-type="fig">Fig. 2</xref>.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><title>An example source record of the mutation assay. The record is derived from DDG for the A chain of protein 1A7V, experimented at pH=6.5 and degree at 25¬∞C.</title></caption>
<graphic xlink:href="569522v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s2c">
<title>Proposed Method</title>
<p>Labeled data are usually scarce in biomolecule research, which demands designing a general self-supervised model for predicting variant effects on unknown proteins and protein functions. We propose ProtSSN with a pre-training scheme that recovers AA types from a given protein backbone structure with noisy local environment observations.</p>
<sec id="s2c1">
<title>Multi-level Protein Representation</title>
<sec id="s2c1a">
<title>Protein Primary Structure (Noisy)</title>
<p>Denote a given observation with AA type <inline-formula><inline-graphic xlink:href="569522v2_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. We assume this arbitrary observation is undergoing random mutation toward a stable state. The training objective is to learn a revised state <italic>v</italic> that is less likely to be eliminated by natural selection due to unfavorable properties such as instability or inability to fold. The perturbed observation is defined by a multinomial distribution.
<disp-formula id="eqn1">
<graphic xlink:href="569522v2_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where an AA in a protein chain has a chance of <italic>p</italic> to mutate to one of 20 AAs (including itself) following a <italic>replacement distribution</italic> Œò(¬∑) and (1 ‚àí <italic>p</italic>) of remaining unchanged. We consider <italic>p</italic> as a tunable parameter and define Œò(¬∑) by the frequency of AA types observed in wild-type proteins.</p>
</sec>
<sec id="s2c1b">
<title>Protein Tertiary Structure</title>
<p>The geometry of a protein is described by ùí¢= (ùí±,<italic>Œµ</italic>?, <bold><italic>W</italic></bold> <sub><italic>V</italic></sub>, <bold><italic>W</italic></bold> <sub><italic>E</italic></sub>, <bold><italic>X</italic></bold><sub><italic>V</italic></sub> ), which is a residue graph based on the <italic>k</italic>-nearest neighbor (<italic>k</italic>NN). Each node <italic>v</italic><sub><italic>i</italic></sub> ‚àà ùí± represents an AA in the protein connected to up to <italic>k</italic> closest nodes within 30√Ö (<bold><italic>Zhou et al., 2023a</italic></bold>). Node attributes <bold><italic>W</italic></bold> <sub><italic>V</italic></sub> are hidden semantic embeddings of AA types extracted by the semantic encoder (see Section ), and edge attributes <italic>W</italic> <sub><italic>E</italic></sub> ‚àà ‚Ñù<sup>93</sup> feature relationships of connected nodes based on inter-atomic distances, local N-C positions, and sequential position encoding. Additionally, <bold><italic>X</italic></bold><sub><italic>V</italic></sub> records 3D coordinates of AAs in the Euclidean space, which plays a crucial role in the subsequent geometric embedding stage to preserve roto-translation equivariance.</p>
</sec>
</sec>
<sec id="s2c2">
<title>Semantic Encoding of Global AA Contacts</title>
<p>Although it is generally believed by the community that a protein‚Äôs sequence determines its biological function via the folded structure, following strictly to this singular pathway risks overlooking other unobserved yet potentially influential inter-atomic communications impacting protein fitness. Our proposed ProtSSN thus includes pairwise relationships for residues through an analysis of proteins‚Äô primary structure from <inline-formula><inline-graphic xlink:href="569522v2_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and embeds them into hidden representations <bold><italic>W</italic></bold> <sub><italic>V</italic></sub> for residues. At each update, information and representations of the noisy AA sequence are encoded from the noisy input via an <italic>Evolutionary Scale Modeling</italic> method, ESM-2 (<bold><italic><xref ref-type="bibr" rid="c23">Lin et al., 2023</xref></italic></bold>), which employs a BERT-style masked language modeling objective. This objective predicts the identity of randomly selected AAs in a protein sequence by observing their context within the remainder of the sequence. Alternative semantic encoding strategies are discussed in Section .</p>
</sec>
<sec id="s2c3">
<title>Geometrical Encoding of Local AA Contacts</title>
<p>Proteins are structured in 3D space, which requires the geometric encoder to possess roto-translation equivariance to node positions as well as permutation invariant to node attributes. This design is vital to avoid the implementation of costly data augmentation strategies. We practice <italic>Equivariant Graph Neural Networks</italic> (EGNN) (<bold><italic><xref ref-type="bibr" rid="c43">Satorras et al., 2021</xref></italic></bold>) to acquire the hidden node representation <inline-formula><inline-graphic xlink:href="569522v2_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and node coordinates <inline-formula><inline-graphic xlink:href="569522v2_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula> at the <italic>l</italic> + 1th layer
<disp-formula id="eqn2">
<graphic xlink:href="569522v2_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
In these equations, <inline-formula><inline-graphic xlink:href="569522v2_inline5.gif" mimetype="image" mime-subtype="gif"/></inline-formula> represents the input edge attribute on ùí±<sub><italic>ij</italic></sub>, which is not updated by the network. The propagation rules <italic>œï</italic><sub><italic>e</italic></sub>, <italic>œï</italic><sub><italic>x</italic></sub> and <italic>œï</italic><sub><italic>v</italic></sub> are defined by differentiable functions, <italic>e</italic>.<italic>g</italic>.multi-layer perceptrons (MLPs). The final hidden representation on nodes <inline-formula><inline-graphic xlink:href="569522v2_inline6.gif" mimetype="image" mime-subtype="gif"/></inline-formula> embeds the microenvironment and local topology of AAs, and it will be carried on by readout layers for label predictions.</p>
</sec>
</sec>
<sec id="s2d">
<title>Model Pipeline</title>
<p>ProtSSN is designed for protein engineering with a self-supervised learning scheme. The model is capable of conducting zero-shot variant effect prediction on an unknown protein, and it can generate the joint distribution for the type of all AAs along the protein sequence of interest. This process accounts for the epistatic effect and concurrently returns all AA sites in a sequence. Below, we detail the workflow for training the zero-shot model and scoring the effect of a specific mutant.</p>
<sec id="s2d1">
<title>Training</title>
<p>The fundamental model architecture cascades a frozen sequence encoding module and a trainable tertiary structure encoder. The protein is represented by its sequence and structure characteristics, where the former is treated as plain text and the latter is formalized as a <italic>k</italic>NN graph with model-encoded node attributes, handcrafted edge attributes, and 3D positions of the corresponding AAs. The node attributes are encoded by a protein language model, which analyses pairwise hidden relationships among AAs from the input protein sequence and produces a vector representation <inline-formula><inline-graphic xlink:href="569522v2_inline7.gif" mimetype="image" mime-subtype="gif"/></inline-formula> for each AA, <italic>i</italic>.<italic>e</italic>.,
<disp-formula id="eqn3">
<graphic xlink:href="569522v2_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
with <inline-formula><inline-graphic xlink:href="569522v2_inline8.gif" mimetype="image" mime-subtype="gif"/></inline-formula> be the perturbed initial AA-type encoding. The language model LM<sub>frozen</sub>(¬∑), ESM-2 (<bold><italic><xref ref-type="bibr" rid="c23">Lin et al., 2023</xref></italic></bold>) for instance, has been pre-trained on a massive protein sequence database (<italic>e</italic>.<italic>g</italic>., <bold>UniRef50</bold> (<bold><italic><xref ref-type="bibr" rid="c46">Suzek et al., 2015</xref></italic></bold>)) to understand the semantic and grammatical rules of wild-type proteins with high-dimensional AA-level long-short-range interactions. The independent perturbation on AA types follows 1 operates in every epoch, which requires constant updates on the sequence embedding. To further enhance the interaction of locally connected AAs in the node representation, a stack of <italic>L</italic> EGNN layers is implemented on the input graph ùí¢ to yield
<disp-formula id="eqn4">
<graphic xlink:href="569522v2_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
During the pre-training phase for protein sequence recovery, the output layer <italic>œï</italic>(¬∑) provides the probability of AAs in one of 20 types, <italic>i</italic>.<italic>e</italic>.,
<disp-formula id="eqn5">
<graphic xlink:href="569522v2_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
for <italic>n</italic> AAs of the input protein. The model‚Äôs learnable parameters are refined by minimizing the cross-entropy of the recovered AAs with respect to the ground-truth AAs in wild-type proteins.</p>
</sec>
<sec id="s2d2">
<title>Inferencing</title>
<p>For a given mutant, its fitness score is derived from the joint distribution of the altered AA types on associated nodes that provides a preliminary assessment based on natural observations. We consider the AA type in the wild-type protein as a reference state and compare it with the predicted probability of AAs at the mutated site. Formally, for a mutant with mutated sites ùíØ (|ùíØ |‚â• 1), we define its fitness score using the corresponding <italic>log-odds-ratio, i</italic>.<italic>e</italic>.,
<disp-formula id="eqn6">
<graphic xlink:href="569522v2_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>y</italic><sub><italic>t</italic></sub> and <italic>v</italic><sub><italic>t</italic></sub> denote the mutated and wild-type type of the <italic>t</italic>th AA.</p>
</sec>
</sec>
<sec id="s2e">
<title>Experimental Protocol</title>
<p>We validate the efficacy of ProtSSN on zero-shot mutation effect prediction tasks. The performance is compared with other SOTA models of varying numbers of trainable parameters. The implementations are programmed with <monospace>PyTorch-Geometric</monospace> (ver 2.2.0) and <monospace>PyTorch</monospace> (ver 1.12.1) and executed on an NVIDIA<sup>¬Æ</sup> Tesla A100 GPU with 6, 912 CUDA cores and 80GB HBM2 installed on an HPC cluster.</p>
<sec id="s2e1">
<title>Training Setup</title>
<p>ProtSSN is pre-trained on a non-redundant subset of <bold>CATH v4.3.0</bold> (<bold><italic><xref ref-type="bibr" rid="c34">Orengo et al., 1997</xref></italic></bold>) domains, which contains 30, 948 experimental protein structures with less than 40% sequence identity. We remove proteins that exceed 2, 000 AAs in length for efficiency. For each <italic>k</italic>NN protein graph, node features are extracted and updated by a frozen ESM2-t33 prefix model (<bold><italic><xref ref-type="bibr" rid="c23">Lin et al., 2023</xref></italic></bold>). Protein topology is inferred by a 6-layer EGNN (<bold><italic><xref ref-type="bibr" rid="c43">Satorras et al., 2021</xref></italic></bold>) with the hidden dimension tuned from {512, 768, 1280}. Adam (<bold><italic><xref ref-type="bibr" rid="c19">Kingma and Ba, 2015</xref></italic></bold>) is used for backpropagation with the learning rate set to 0.0001. To avoid training instability or CUDA out-of-memory, we limit the maximum input to 8, 192 AA tokens per batch, constituting approximately 32 graphs.</p>
</sec>
<sec id="s2e2">
<title>Baseline Methods</title>
<p>We undertake an extensive comparison with baseline methods of self-supervised sequence or structure-based models on the fitness of mutation effects prediction (<xref rid="tbl2" ref-type="table">Table 2</xref>). Sequence models employ position embedding strategies such as autoregression (RITA (<bold><italic><xref ref-type="bibr" rid="c9">Hesslow et al., 2022</xref></italic></bold>), Tranception (<bold><italic><xref ref-type="bibr" rid="c32">Notin et al., 2022</xref></italic></bold>), and ProGen2 (<bold><italic><xref ref-type="bibr" rid="c30">Nijkamp et al., 2023</xref></italic></bold>)), masked language modeling (ESM-1b (<bold><italic><xref ref-type="bibr" rid="c38">Rives et al., 2021</xref></italic></bold>), ESM-1v (<bold><italic><xref ref-type="bibr" rid="c26">Meier et al., 2021</xref></italic></bold>), and ESM2 (<bold><italic><xref ref-type="bibr" rid="c23">Lin et al., 2023</xref></italic></bold>)), a combination of the both (ProtTrans (<bold><italic><xref ref-type="bibr" rid="c5">Elnaggar et al., 2021</xref></italic></bold>)), and convolutional modeling (CARP (<bold><italic><xref ref-type="bibr" rid="c55">Yang et al., 2022</xref></italic></bold>)). Additionally, we also compare with ESM-if1 (<bold><italic><xref ref-type="bibr" rid="c10">Hsu et al., 2022</xref></italic></bold>) which incorporates masked language modeling objectives with GVP (<bold><italic><xref ref-type="bibr" rid="c14">Jing et al., 2020</xref></italic></bold>), as well as MIF-ST (<bold><italic><xref ref-type="bibr" rid="c57">Yang et al., 2023</xref></italic></bold>) with both sequence and structure encoding.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><title>Details of Baseline Models.</title></caption>
<graphic xlink:href="569522v2_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s2e3">
<title>Benchmark Datasets</title>
<p>We conduct a comprehensive comparison of deep learning predictions on hundreds of DMS assays concerning different protein types and biochemical assays. We prioritize experimentally measured properties that possess a monotonic relationship with protein fitness, such as catalytic activity, binding affinity, expression, and thermostability. In particular, <bold>ProteinGym v1</bold> (<bold><italic><xref ref-type="bibr" rid="c33">Notin et al., 2023</xref></italic></bold>) groups 5 sets of protein properties from 217 assays. Two new datasets named <bold>DTm</bold> and <bold>DDG</bold> examine 102 environment-specific assays with thermostability scores. In total, 319 assays with around 2.5 million mutants are scored. To better understand the novelty of the proposed ProtSSN, we designed additional investigations on <bold>ProteinGym v0</bold> (<bold><italic><xref ref-type="bibr" rid="c32">Notin et al., 2022</xref></italic></bold>), an early-release version of <bold>ProteinGym</bold> with 1.5<italic>M</italic> missense variants across 86 assays (excluding one assay that failed to be folded by both AlphaFold2 and ESMFold, <italic>i</italic>.<italic>e</italic>., <monospace>A0A140D2T1_ZIKV_Sourisseau_growth_2019</monospace> ).</p>
</sec>
<sec id="s2e4">
<title>Evaluation Metric</title>
<p>We evaluate the performance of pre-trained models on a diverse set of proteins and protein functions using Spearman‚Äôs <italic>œÅ</italic> correlation that measures the strength and direction of the monotonic relationship between two ranked sequences, <italic>i</italic>.<italic>e</italic>., experimentally evaluated mutants and model-inferred mutants (<bold><italic><xref ref-type="bibr" rid="c26">Meier et al., 2021</xref>; <xref ref-type="bibr" rid="c32">Notin et al., 2022</xref>; <xref ref-type="bibr" rid="c7">Frazer et al., 2021</xref>; Zhou et al., 2023a</italic></bold>). This non-parametric rank measure is robust to outliers and asymmetry in mutation scores, and it does not assume any specific distribution of mutation fitness scores. The scale of <italic>œÅ</italic> ranges from ‚àí1 to 1, indicating the negative or positive correlation of the predicted sequence to the ground truth. The prediction is preferred if its <italic>œÅ</italic> to the experimentally examined ground truth is close to 1.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<title>Results</title>
<sec id="s3a">
<title>Variant Effect Prediction</title>
<p>We commence our investigation by assessing the predictive performance of ProtSSN on four bench-mark datasets using state-of-the-art (SOTA) protein learning models. We deploy different versions of ProtSSN that learns <italic>k</italic>NN graphs with <italic>k</italic> ‚àà {10, 20, 30} and <italic>h</italic> ‚àà {512, 768, 1, 280} hidden neurons in each of the 6 EGNN layers. For all baselines, their performance on <bold>DTm</bold> and <bold>DDG</bold> are reproduced with the official implementation listed in <xref rid="tbl2" ref-type="table">Table 2</xref>, and the scores on <bold>ProteinGym v1</bold> are retrieved from <ext-link ext-link-type="uri" xlink:href="https://proteingym.org/benchmarks">https://proteingym.org/benchmarks</ext-link> by <bold><italic>Notin et al</italic></bold>. (<bold><italic>2023</italic></bold>). As visualized in <xref rid="fig3" ref-type="fig">Fig. 3</xref> and reported in <xref rid="tbl3" ref-type="table">Table 3</xref>, ProtSSN demonstrated exceptional predictive performance with a significantly smaller number of trainable parameters when predicting the function and thermostability of mutants.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3.</label>
<caption><title>Spearman‚Äôs <italic>œÅ</italic> correlation of variant effect prediction on <bold>DTm, DDG</bold>, and <bold>ProteinGym v1</bold>.</title></caption>
<graphic xlink:href="569522v2_tbl3.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Number of trainable parameters and Spearman‚Äôs <italic>œÅ</italic> correlation on <bold>DTm, DDG</bold>, and <bold>ProteinGym v1</bold>, with the medium value located by the dashed lines. Dot, cross, and diamond markers represent sequence-based, structure-based, and sequence-structure models, respectively.</title></caption>
<graphic xlink:href="569522v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Compared to protein language models (<xref rid="fig3" ref-type="fig">Fig. 3</xref>, colored circles), ProtSSN benefits from abundant structure information to more accurately capture the overall protein characteristics, resulting in enhanced thermostability and thus achieving higher correlation scores on <bold>DTm</bold> and <bold>DDG</bold>. This is attributed to the compactness of the overall architecture as well as the presence of stable local structures such as alpha helices and beta sheets, both of which are crucial to protein thermostability by providing a framework that resists unfolding at elevated temperatures (<bold><italic><xref ref-type="bibr" rid="c40">Robinson-Rechavi et al., 2006</xref></italic></bold>). Consequently, the other two structures-involved models, <italic>i</italic>.<italic>e</italic>., ESM-if1 and MIF-ST, also exhibit higher performance on the two thermostability benchmarks.</p>
<p>While sequence-based analysis cannot entirely replace the role of structure-based analysis, compared to a fully structure-based deep learning method, a protein language model is more likely to capture sufficient information from sequences by increasing the model scale, <italic>i</italic>.<italic>e</italic>., the number of trainable parameters. This observation aligns with the mechanism of protein functionality, where local structures (such as binding pockets and catalytic pockets) and the overall structure (such as conformational changes and allosteric effect) are both crucial for binding and catalysis (<bold><italic><xref ref-type="bibr" rid="c44">Sheng et al., 2014</xref></italic></bold>). Unlike the thermostability benchmarks, the discrepancies between structure-involved models and protein language models are mitigated in <bold>ProteinGym v1</bold> by increasing the model scale. Overall, structure-based and sequence-based methods are suitable for different types of assays, but a comprehensive framework, such as ProtSSN, exhibits the best performance.</p>
</sec>
<sec id="s3b">
<title>Ablation Study</title>
<p>The effectiveness of ProtSSN with different modular designs is examined by its performance on the early released version <bold>ProteinGym v0</bold> (<bold><italic><xref ref-type="bibr" rid="c32">Notin et al., 2022</xref></italic></bold>) with 86 DMS assays. The complete comparison of baseline comparison on <bold>ProteinGym v0</bold> is detailed in Table S1 in SI. For the ablation study, the results are summarized in <xref rid="fig4" ref-type="fig">Fig. 4</xref>(a)-(d) and detailed in Table S2, where each record is subject to a combination of key arguments under investigation. For instance, in the top orange box of <xref rid="fig4" ref-type="fig">Fig. 4</xref>(a), we report all ablation results that utilize 6 EGNN layers for graph convolution, regardless of the different scales of ESM-2 or the definitions of node attributes. For all modules investigated in this section, we separately discuss their influence on predicting mutation effects when modifying a single site or an arbitrary number of sites. The two cases are marked on the y-axis by single‚Äô and ‚Äòall‚Äô, respectively.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Ablation Study on <bold>ProteinGym v0</bold> with different modular settings of ProtSSN. Each record represents the average Spearman‚Äôs correlation of all assays.</title></caption>
<graphic xlink:href="569522v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s3b1">
<title>Inclusion of Roto-Translation Equivariance</title>
<p>We assess the effect of incorporating rotation and translation equivariance for protein geometric and topological encoding. Three types of graph convolutions are compared, including GCN (<bold><italic><xref ref-type="bibr" rid="c20">Kipf and Welling, 2017</xref></italic></bold>), GAT (<bold><italic>Veliƒçkoviƒá et al., 2018</italic></bold>), and EGNN (<bold><italic><xref ref-type="bibr" rid="c43">Satorras et al., 2021</xref></italic></bold>). The first two are classic non-equivariant graph convolutional methods, and the last one, which we apply in the main algorithm, preserves roto-translation equivariance. We fix the number of EGNN layers to 6 and examine the performance of the other two methods with either 4 or 6 layers. We find that integrating equivariance when embedding protein geometry significantly.</p>
</sec>
<sec id="s3b2">
<title>Sequence Encoding</title>
<p>We next investigate the benefits of defining data-driven node attributes for protein representation learning. We compare the performance of models trained on two sets of graph inputs: the first set defines its AA node attributes through trained ESM2 (<bold><italic><xref ref-type="bibr" rid="c23">Lin et al., 2023</xref></italic></bold>), while the second set uses one-hot encoded AA types for each node. A clear advantage of using hidden representations by prefix models over hardcoded attributes is evident from the results presented in <xref rid="fig4" ref-type="fig">Fig. 4</xref>(b).</p>
</sec>
<sec id="s3b3">
<title>Depth of EGNN</title>
<p>Although graph neural networks can extract topological information from geometric inputs, it is vital to select an appropriate number of layers for the module to deliver the most expressive node representation without encountering the oversmoothing problem. We investigate a wide range of choices for the number of EGNN layers among {6, 12, 18}. As reported in <xref rid="fig4" ref-type="fig">Fig. 4</xref>(c), embedding graph topology with deeper networks does not lead to performance improvements. A moderate choice of 6 EGNN layers is sufficient for our learning task.</p>
</sec>
<sec id="s3b4">
<title>Scale of ESM</title>
<p>We also evaluate ProtSSN on different choices of language embedding dimensions to study the trade-off between computational cost and input richness. Various scales of prefix models, including {8, 150, 650, 3000} millions of parameters, have been applied to produce different sequential embeddings with {320, 640, 1280, 2560} dimensions, respectively. <xref rid="fig4" ref-type="fig">Fig. 4</xref>(d) reveals a clear preference for ESM2-t33, which employs 650 million parameters to achieve optimal model performance with the best stability. Notably, a higher dimension and richer semantic expression do not always yield better performance. A performance degradation is observed at ESM2 with 3 billion parameters.</p>
</sec>
</sec>
<sec id="s3c">
<title>AA Perturbation Strategies</title>
<p>ProtSSN utilizes noise sampling at each epoch on the node attributes to emulate random mutations in nature. This introduction of noise directly affects the node attribute input to the graphs. Alongside the ‚Äòmutate-then-recode‚Äô method we implemented in the main algorithm, we examined four additional strategies to perturb the input data during training. The construction of these ad-ditional strategies is detailed below, and their corresponding Spearman‚Äôs <italic>œÅ</italic> on <bold>ProteinGym v0</bold> is in <xref rid="fig4" ref-type="fig">Fig. 4</xref>(e).</p>
<sec id="s3c1">
<title>Global Average</title>
<p>Suppose the encoded sequential representation of a node is predominantly determined by its AA type. In essence, the protein sequence encoder will return similar embeddings for nodes of the same AA type, albeit at different positions within a protein. With this premise, the first strategy replaces the node embedding for perturbed nodes with the average representations of the same AA types. For example, a random node <italic>v</italic><sub><italic>i</italic></sub> in a protein is Glycine. If it is altered in the current epoch, <inline-formula><inline-graphic xlink:href="569522v2_inline9.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is designated as the average sequential embedding of all other Glycines.</p>
</sec>
<sec id="s3c2">
<title>Sliding Window</title>
<p>The presumption in the previous method neither aligns with the algorithmic design nor biological heuristics. Self-attention discerns the interaction of the central token with its neighbors across the entire document (protein). The representation of an AA is influenced by both its neighbors‚Äô types and locations. Thus, averaging embeddings of AAs from varying positions is likely to forfeit positional information of the modified AA. For this purpose, we consider a sliding window of size 3 along the protein sequence.</p>
</sec>
<sec id="s3c3">
<title>Gaussian Noise</title>
<p>The third option regards node embeddings of AA as hidden vectors and imposes white noise on the vector values. We define the mean= 0 and variance= 0.5 on the noise, making the revised node representation <inline-formula><inline-graphic xlink:href="569522v2_inline10.gif" mimetype="image" mime-subtype="gif"/></inline-formula>.</p>
</sec>
<sec id="s3c4">
<title>Mask</title>
<p>Finally, we employ the masking technique prevalent in masked language modeling and substitute the perturbed AA token with a special <monospace>&lt;mask&gt;</monospace> token. The prefix language model will interpret it as a novel token and employ self-attention mechanisms to assign a new representation to it. We utilize the same hyperparameter settings as that of BERT (<bold><italic><xref ref-type="bibr" rid="c3">Devlin et al., 2018</xref></italic></bold>) and choose 15% of tokens per iteration as potentially influenced subjects. Specifically, 80% of these subjects are replaced with <monospace>&lt;mask&gt;</monospace>, 10% of them are replaced randomly (to other AA types), and the remaining 10% stay unchanged.</p>
</sec>
</sec>
<sec id="s3d">
<title>Folding Methods</title>
<p>The analysis of protein structure through topological embeddings poses challenges due to the inherent difficulty in obtaining accurate structural observations through experimental techniques such as NMR (<bold><italic><xref ref-type="bibr" rid="c54">W√ºthrich, 1990</xref></italic></bold>) and Cryo-EM (<bold><italic><xref ref-type="bibr" rid="c4">Elmlund et al., 2017</xref></italic></bold>). As a substitution, we use <italic>in silico</italic> folding models such as AlphaFold2 (<bold><italic><xref ref-type="bibr" rid="c16">Jumper et al., 2021</xref></italic></bold>) and ESMFold (<bold><italic><xref ref-type="bibr" rid="c23">Lin et al., 2023</xref></italic></bold>). Although these folding methods may introduce additional errors due to the inherent uncertainty or inaccuracy in structural predictions, we investigate the robustness of our model in the face of potential inaccuracies introduced by these folding strategies.</p>
<p><xref rid="tbl4" ref-type="table">Table 4</xref> examines the impact of different folding strategies on the performance of DMS predictions for ESM-if1, MIF-ST, and ProtSSN. Although the performance based on ESMFold-derived protein structures generally lags behind structures folded by AlphaFold2, the minimal difference between the two strategies across all four benchmarks validates the robustness of our ProtSSN in response to variations in input protein structures. We deliberately divide the assays in <bold>ProteinGym v0</bold> (<bold><italic><xref ref-type="bibr" rid="c32">Notin et al., 2022</xref></italic></bold>) into two groups of interaction (<italic>e</italic>.<italic>g</italic>., binding and stability) and catalysis (<italic>e</italic>.<italic>g</italic>., activity), as the former is believed more sensitive to the structure of the protein (<bold><italic><xref ref-type="bibr" rid="c39">Robertson and Murphy, 1997</xref></italic></bold>).</p>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Table 4.</label>
<caption><title>Influence of folding strategies (AlphaFold2 and ESMFold) on prediction performance for structure-involved models.</title></caption>
<graphic xlink:href="569522v2_tbl4.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>ProtSSN emerges as the most robust method, maintaining consistent performance across different folding strategies, which underscores the importance of our model‚Äôs resilience to variations in input protein structures. The reported performance difference for both ESM-if1 and MIF-ST is 3‚àí5 times higher than that of ProtSSN. The inconsistency between the optimal results for <bold>DDG</bold> and the scores reported in <xref rid="tbl3" ref-type="table">Table 3</xref> comes from the utilization of crystal structures in the main results. Another noteworthy observation pertains to the performance of ESM-if1 and MIF-ST on <bold>DDG</bold>. In this case, predictions based on ESMFold surpass those based on AlphaFold2, even outperforming predictions derived from crystal structures. However, the superior performance of these methods with ESMFold hinges on inaccurate protein structures, rendering them less reliable.</p>
</sec>
<sec id="s3e">
<title>Performance Enhancement with MSA and Ensemble</title>
<p>We extend the evaluation on <bold>ProteinGym v0</bold> to include a comparison of our zero-shot ProtSSN with few-shot learning methods that leverage MSA information of proteins (<bold><italic><xref ref-type="bibr" rid="c26">Meier et al., 2021</xref></italic></bold>). The details are reported in <xref rid="tbl5" ref-type="table">Table 5</xref>, where the performance of baseline methods are retrieved from <ext-link ext-link-type="uri" xlink:href="https://proteingym.org/benchmarks">https://github.com/OATML-Markslab/ProteinGym</ext-link>. For ProtSSN, we employ an ensemble of nine models with varying sizes of <italic>k</italic>NN graphs (<italic>k</italic> ‚àà {10, 20, 30}) and EGNN hidden neurons ({512, 768, 1280}), as discussed previously. The MSA depth reflects the number of MSA sequences that can be found for the protein, which influences the quality of MSA-based methods.</p>
<table-wrap id="tbl5" orientation="portrait" position="float">
<label>Table 5.</label>
<caption><title>Variant Effect Prediction on <bold>ProteinGym v0</bold> with both MSA and non-MSA methods. Results are retrieved from (<bold><italic><xref ref-type="bibr" rid="c32">Notin et al., 2022</xref></italic></bold>).</title></caption>
<graphic xlink:href="569522v2_tbl5.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<table-wrap id="tbl6" orientation="portrait" position="float">
<label>Table 6.</label>
<caption><title>Spearman‚Äôs <italic>œÅ</italic> correlation of variant effect prediction on <bold>DTm</bold> and <bold>DDG</bold> for non-MSA methods with model ensemble.</title></caption>
<graphic xlink:href="569522v2_tbl6.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>ProtSSN demonstrates superior performance among non-MSA zero-shot methods in predicting both single-site and multi-site mutants, underscoring its pivotal role in guiding protein engineering towards deep mutation. Furthermore, ProtSSN outperforms MSA-based methods across taxa, except for viruses, where precise identification of conserved sites is crucial for positive mutations, especially in spike proteins (<bold><italic><xref ref-type="bibr" rid="c17">Katoh and Standley, 2021</xref>; <xref ref-type="bibr" rid="c27">Mercurio et al., 2021</xref></italic></bold>). In essence, ProtSSN provides an efficient and effective solution for variant effects prediction when compared to both non-MSA and MSA-based methods. Note that although MSA-based methods generally consume fewer trainable parameters than non-MSA methods, they incur significantly higher costs in terms of search time and memory usage. Moreover, the inference performance of MSA-based methods relies heavily on the quality of the input MSA, where the additionally involved variance makes impacts the stability of the model performance.</p>
</sec>
</sec>
<sec id="s4">
<title>Discussion and Conclusion</title>
<p>The development of modern computational methodologies for protein engineering is a crucial facet of <italic>in silico</italic> protein design. Effectively assessing the fitness of protein mutants not only supports cost-efficient experimental validations but also guides the modification of proteins toward enhanced or novel functions. Recent deep learning solutions employ a common strategy that involves establishing a hidden protein representation and masking potential mutation sites to recommend plausible amino acids. Previous research has primarily focused on extracting protein representations from either their sequential or structural modalities, with many treating the prediction of mutational effects merely as a secondary task following inverse folding or <italic>de novo</italic> protein design. These approaches often overlook the importance of comprehensive investigation on both global and local perspectives of amino acid interaction that are critical for featuring protein functions. Furthermore, these methods hardly tailored model designs for suggesting mutations, despite the significance of this type of tasks. In this work, we introduce ProtSSN, a denoising framework that effectively cascades protein sequence and structure embedding for predicting mutational effects. Both the protein language model and equivariant graph neural network are employed to encode the global interaction of amino acids with geometry-aware local enhancements. We have extensively validated the efficacy of ProtSSN across various protein function assays and taxa, including two thermostability datasets prepared by ourselves. Our approach consistently demonstrates substantial promise for protein engineering applications, such as facilitating the design of mutation sequences with enhanced interaction and enzymatic activity.</p>
</sec>
<sec id="d1e1568" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e1659">
<label>SI</label>
<media xlink:href="supplements/569522_file02.pdf"/>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Aprile</surname> <given-names>FA</given-names></string-name>, <string-name><surname>Sormanni</surname> <given-names>P</given-names></string-name>, <string-name><surname>Podpolny</surname> <given-names>M</given-names></string-name>, <string-name><surname>Chhangur</surname> <given-names>S</given-names></string-name>, <string-name><surname>Needham</surname> <given-names>LM</given-names></string-name>, <string-name><surname>Ruggeri</surname> <given-names>FS</given-names></string-name>, <string-name><surname>Perni</surname> <given-names>M</given-names></string-name>, <string-name><surname>Limbocker</surname> <given-names>R</given-names></string-name>, <string-name><surname>Heller</surname> <given-names>GT</given-names></string-name>, <string-name><surname>Sneideris</surname> <given-names>T</given-names></string-name>, <etal>et al.</etal> <article-title>Rational design of a conformation-specific antibody for the quantification of AŒ≤ oligomers</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2020</year>; <volume>117</volume>(<issue>24</issue>):<fpage>13509</fpage>‚Äì<lpage>13518</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Brandes</surname> <given-names>N</given-names></string-name>, <string-name><surname>Ofer</surname> <given-names>D</given-names></string-name>, <string-name><surname>Peleg</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Rappoport</surname> <given-names>N</given-names></string-name>, <string-name><surname>Linial</surname> <given-names>M.</given-names></string-name> <article-title>ProteinBERT: A universal deep-learning model of protein sequence and function</article-title>. <source>Bioinformatics</source>. <year>2022</year>; <volume>38</volume>(<issue>8</issue>):<fpage>2102</fpage>‚Äì<lpage>2110</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="preprint"><string-name><surname>Devlin</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chang</surname> <given-names>MW</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>K</given-names></string-name>, <string-name><surname>Toutanova</surname> <given-names>K.</given-names></string-name> <article-title>BERT: Pre-training of deep bidirectional transformers for language understanding</article-title>. <source>arXiv</source> <year>2018</year>;.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Elmlund</surname> <given-names>D</given-names></string-name>, <string-name><surname>Le</surname> <given-names>SN</given-names></string-name>, <string-name><surname>Elmlund</surname> <given-names>H.</given-names></string-name> <article-title>High-resolution Cryo-EM: the nuts and bolts</article-title>. <source>Current Opinion in Structural Biology</source>. <year>2017</year>; <volume>46</volume>:<fpage>1</fpage>‚Äì<lpage>6</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Elnaggar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Heinzinger</surname> <given-names>M</given-names></string-name>, <string-name><surname>Dallago</surname> <given-names>C</given-names></string-name>, <string-name><surname>Rehawi</surname> <given-names>G</given-names></string-name>, <string-name><surname>Yu</surname> <given-names>W</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>L</given-names></string-name>, <string-name><surname>Gibbs</surname> <given-names>T</given-names></string-name>, <string-name><surname>Feher</surname> <given-names>T</given-names></string-name>, <string-name><surname>Angerer</surname> <given-names>C</given-names></string-name>, <string-name><surname>Steinegger</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bhowmik</surname> <given-names>D</given-names></string-name>, <string-name><surname>Rost</surname> <given-names>B.</given-names></string-name> <article-title>ProtTrans: Toward Understanding the Language of Life Through Self-Supervised Learning</article-title>. <source>IEEE Transactions on Pattern Analysis and Machine Intelligence</source>. <year>2022</year>; .</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Frauenfelder</surname> <given-names>H</given-names></string-name>, <string-name><surname>McMahon</surname> <given-names>B.</given-names></string-name> <article-title>Dynamics and function of proteins: the search for general concepts</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>1998</year>; <volume>95</volume>(<issue>9</issue>):<fpage>4795</fpage>‚Äì<lpage>4797</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Frazer</surname> <given-names>J</given-names></string-name>, <string-name><surname>Notin</surname> <given-names>P</given-names></string-name>, <string-name><surname>Dias</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gomez</surname> <given-names>A</given-names></string-name>, <string-name><surname>Min</surname> <given-names>JK</given-names></string-name>, <string-name><surname>Brock</surname> <given-names>K</given-names></string-name>, <string-name><surname>Gal</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Marks</surname> <given-names>DS</given-names></string-name>. <article-title>Disease variant prediction with deep generative models of evolutionary data</article-title>. <source>Nature</source>. <year>2021</year>; <volume>599</volume>(<issue>7883</issue>):<fpage>91</fpage>‚Äì<lpage>95</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Gray</surname> <given-names>VE</given-names></string-name>, <string-name><surname>Hause</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Luebeck</surname> <given-names>J</given-names></string-name>, <string-name><surname>Shendure</surname> <given-names>J</given-names></string-name>, <string-name><surname>Fowler</surname> <given-names>DM</given-names></string-name>. <article-title>Quantitative missense variant effect prediction using large-scale mutagenesis data</article-title>. <source>Cell Systems</source>. <year>2018</year>; <volume>6</volume>(<issue>1</issue>):<fpage>116</fpage>‚Äì<lpage>124</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="confproc"><string-name><surname>Hesslow</surname> <given-names>D</given-names></string-name>, <string-name><surname>Zanichelli</surname> <given-names>N</given-names></string-name>, <string-name><surname>Notin</surname> <given-names>P</given-names></string-name>, <string-name><surname>Poli</surname> <given-names>I</given-names></string-name>, <string-name><surname>Marks</surname> <given-names>D.</given-names></string-name> <article-title>RITA: a study on scaling up generative protein sequence models</article-title>. <source>ICML Workshop on Computational Biology</source>; <year>2022</year> .</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="confproc"><string-name><surname>Hsu</surname> <given-names>C</given-names></string-name>, <string-name><surname>Verkuil</surname> <given-names>R</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Hie</surname> <given-names>B</given-names></string-name>, <string-name><surname>Sercu</surname> <given-names>T</given-names></string-name>, <string-name><surname>Lerer</surname> <given-names>A</given-names></string-name>, <string-name><surname>Rives</surname> <given-names>A.</given-names></string-name> <article-title>Learning inverse folding from millions of predicted structures</article-title>. <source>In: ICML PMLR</source>; <year>2022</year>. p. <fpage>8946</fpage>‚Äì<lpage>8970</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Ismail</surname> <given-names>AR</given-names></string-name>, <string-name><surname>Kashtoh</surname> <given-names>H</given-names></string-name>, <string-name><surname>Baek</surname> <given-names>KH</given-names></string-name>. <article-title>Temperature-resistant and solvent-tolerant lipases as industrial biocatalysts: Biotechnological approaches and applications</article-title>. <source>International Journal of Biological Macromolecules</source>. <year>2021</year>; <volume>187</volume>:<fpage>127</fpage>‚Äì<lpage>142</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Jiang</surname> <given-names>F</given-names></string-name>, <string-name><surname>Bian</surname> <given-names>J</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>H</given-names></string-name>, <string-name><surname>Li</surname> <given-names>S</given-names></string-name>, <string-name><surname>Bai</surname> <given-names>X</given-names></string-name>, <string-name><surname>Zheng</surname> <given-names>L</given-names></string-name>, <string-name><surname>Jin</surname> <given-names>S</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>GY</given-names></string-name>, <string-name><surname>Hong</surname> <given-names>L.</given-names></string-name> <article-title>Creatinase: Using Increased Entropy to Improve the Activity and Thermostability</article-title>. <source>The Journal of Physical Chemistry B</source>. <year>2023</year>; <volume>127</volume>(<issue>12</issue>):<fpage>2671</fpage>‚Äì<lpage>2682</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="confproc"><string-name><surname>Jin</surname> <given-names>W</given-names></string-name>, <string-name><surname>Wohlwend</surname> <given-names>J</given-names></string-name>, <string-name><surname>Barzilay</surname> <given-names>R</given-names></string-name>, <string-name><surname>Jaakkola</surname> <given-names>TS</given-names></string-name>. <article-title>Iterative Refinement Graph Neural Network for Antibody Sequence-Structure Co-design</article-title>. <source>In: ICLR</source>; <year>2021</year>. .</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="confproc"><string-name><surname>Jing</surname> <given-names>B</given-names></string-name>, <string-name><surname>Eismann</surname> <given-names>S</given-names></string-name>, <string-name><surname>Suriana</surname> <given-names>P</given-names></string-name>, <string-name><surname>Townshend</surname> <given-names>RJL</given-names></string-name>, <string-name><surname>Dror</surname> <given-names>R.</given-names></string-name> <article-title>Learning from Protein Structure with Geometric Vector Perceptrons</article-title>. <source>In: ICLR</source>; <year>2020</year>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Jones</surname> <given-names>D</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>H</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Zemla</surname> <given-names>A</given-names></string-name>, <string-name><surname>Stevenson</surname> <given-names>G</given-names></string-name>, <string-name><surname>Bennett</surname> <given-names>WD</given-names></string-name>, <string-name><surname>Kirshner</surname> <given-names>D</given-names></string-name>, <string-name><surname>Wong</surname> <given-names>SE</given-names></string-name>, <string-name><surname>Lightstone</surname> <given-names>FC</given-names></string-name>, <string-name><surname>Allen</surname> <given-names>JE</given-names></string-name>. <article-title>Improved protein‚Äìligand binding affinity prediction with structure-based deep fusion inference</article-title>. <source>Journal of Chemical Information and Modeling</source>. <year>2021</year>; <volume>61</volume>(<issue>4</issue>):<fpage>1583</fpage>‚Äì<lpage>1592</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Jumper</surname> <given-names>J</given-names></string-name>, <string-name><surname>Evans</surname> <given-names>R</given-names></string-name>, <string-name><surname>Pritzel</surname> <given-names>A</given-names></string-name>, <string-name><surname>Green</surname> <given-names>T</given-names></string-name>, <string-name><surname>Figurnov</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ronneberger</surname> <given-names>O</given-names></string-name>, <string-name><surname>Tunyasuvunakool</surname> <given-names>K</given-names></string-name>, <string-name><surname>Bates</surname> <given-names>R</given-names></string-name>, <string-name><surname>≈æ√≠dek</surname> <given-names>A</given-names></string-name>, <string-name><surname>Potapenko</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source>. <year>2021</year>; <volume>596</volume>(<issue>7873</issue>):<fpage>583</fpage>‚Äì<lpage>589</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Katoh</surname> <given-names>K</given-names></string-name>, <string-name><surname>Standley</surname> <given-names>DM</given-names></string-name>. <article-title>Emerging SARS-CoV-2 variants follow a historical pattern recorded in outgroups infecting non-human hosts</article-title>. <source>Communications Biology</source>. <year>2021</year>; <volume>4</volume>(<issue>1</issue>):<fpage>1134</fpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Khersonsky</surname> <given-names>O</given-names></string-name>, <string-name><surname>Lipsh</surname> <given-names>R</given-names></string-name>, <string-name><surname>Avizemer</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Ashani</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Goldsmith</surname> <given-names>M</given-names></string-name>, <string-name><surname>Leader</surname> <given-names>H</given-names></string-name>, <string-name><surname>Dym</surname> <given-names>O</given-names></string-name>, <string-name><surname>Rogotner</surname> <given-names>S</given-names></string-name>, <string-name><surname>Trudeau</surname> <given-names>DL</given-names></string-name>, <string-name><surname>Prilusky</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <article-title>Automated design of efficient and functionally diverse enzyme repertoires</article-title>. <source>Molecular Cell</source>. <year>2018</year>; <volume>72</volume>(<issue>1</issue>):<fpage>178</fpage>‚Äì<lpage>186</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="confproc"><string-name><surname>Kingma</surname> <given-names>DP</given-names></string-name>, <string-name><surname>Ba</surname> <given-names>J.</given-names></string-name> <article-title>ADAM: A method for stochastic optimization</article-title>. <source>In: International Conference on Learning Repre-sentation</source>; <year>2015</year>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="confproc"><string-name><surname>Kipf</surname> <given-names>TN</given-names></string-name>, <string-name><surname>Welling</surname> <given-names>M.</given-names></string-name> <article-title>Semi-supervised classification with graph convolutional networks</article-title>. <source>In: ICLR</source>; <year>2017</year>..</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Koehler Leman</surname> <given-names>J</given-names></string-name>, <string-name><surname>Szczerbiak</surname> <given-names>P</given-names></string-name>, <string-name><surname>Renfrew</surname> <given-names>PD</given-names></string-name>, <string-name><surname>Gligorijevic</surname> <given-names>V</given-names></string-name>, <string-name><surname>Berenberg</surname> <given-names>D</given-names></string-name>, <string-name><surname>Vatanen</surname> <given-names>T</given-names></string-name>, <string-name><surname>Taylor</surname> <given-names>BC</given-names></string-name>, <string-name><surname>Chandler</surname> <given-names>C</given-names></string-name>, <string-name><surname>Janssen</surname> <given-names>S</given-names></string-name>, <string-name><surname>Pataki</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal> <article-title>Sequence-structure-function relationships in the microbial protein universe</article-title>. <source>Nature Communications</source>. <year>2023</year>; <volume>14</volume>(<issue>1</issue>):<fpage>2351</fpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="web"><string-name><surname>Kong</surname> <given-names>X</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>W</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>Y.</given-names></string-name> <article-title>Conditional Antibody Design as 3D Equivariant Graph Translation</article-title>. <source>In: ICLR</source>; <year>2023</year>. <ext-link ext-link-type="uri" xlink:href="https://openreview.net/forum?id=LFHFQbjxIiP">https://openreview.net/forum?id=LFHFQbjxIiP</ext-link>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Lin</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Akin</surname> <given-names>H</given-names></string-name>, <string-name><surname>Rao</surname> <given-names>R</given-names></string-name>, <string-name><surname>Hie</surname> <given-names>B</given-names></string-name>, <string-name><surname>Zhu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Lu</surname> <given-names>W</given-names></string-name>, <string-name><surname>Smetanin</surname> <given-names>N</given-names></string-name>, <string-name><surname>Verkuil</surname> <given-names>R</given-names></string-name>, <string-name><surname>Kabeli</surname> <given-names>O</given-names></string-name>, <string-name><surname>Shmueli</surname> <given-names>Y</given-names></string-name>, <etal>et al.</etal> <article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>. <source>Science</source>. <year>2023</year>; <volume>379</volume>(<issue>6637</issue>):<fpage>1123</fpage>‚Äì<lpage>1130</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Liu</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Xun</surname> <given-names>G</given-names></string-name>, <string-name><surname>Feng</surname> <given-names>Y.</given-names></string-name> <article-title>The state-of-the-art strategies of protein engineering for enzyme stabilization</article-title>. <source>Biotechnology Advances</source>. <year>2019</year>; <volume>37</volume>(<issue>4</issue>):<fpage>530</fpage>‚Äì<lpage>537</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Madani</surname> <given-names>A</given-names></string-name>, <string-name><surname>Krause</surname> <given-names>B</given-names></string-name>, <string-name><surname>Greene</surname> <given-names>ER</given-names></string-name>, <string-name><surname>Subramanian</surname> <given-names>S</given-names></string-name>, <string-name><surname>Mohr</surname> <given-names>BP</given-names></string-name>, <string-name><surname>Holton</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Olmos Jr</surname> <given-names>JL</given-names></string-name>, <string-name><surname>Xiong</surname> <given-names>C</given-names></string-name>, <string-name><surname>Sun</surname> <given-names>ZZ</given-names></string-name>, <string-name><surname>Socher</surname> <given-names>R</given-names></string-name>, <etal>et al.</etal> <article-title>Large language models generate functional protein sequences across diverse families</article-title>. <source>Nature Biotechnology</source>. <year>2023</year>;.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Meier</surname> <given-names>J</given-names></string-name>, <string-name><surname>Rao</surname> <given-names>R</given-names></string-name>, <string-name><surname>Verkuil</surname> <given-names>R</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sercu</surname> <given-names>T</given-names></string-name>, <string-name><surname>Rives</surname> <given-names>A.</given-names></string-name> <article-title>Language models enable zero-shot prediction of the effects of mutations on protein function</article-title>. <source>In: NeurIPS</source>, vol. <volume>34</volume>; <year>2021</year>. p. <fpage>29287</fpage>‚Äì<lpage>29303</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Mercurio</surname> <given-names>I</given-names></string-name>, <string-name><surname>Tragni</surname> <given-names>V</given-names></string-name>, <string-name><surname>Busto</surname> <given-names>F</given-names></string-name>, <string-name><surname>De Grassi</surname> <given-names>A</given-names></string-name>, <string-name><surname>Pierri</surname> <given-names>CL</given-names></string-name>. <article-title>Protein structure analysis of the interactions between SARS-CoV-2 spike protein and the human ACE2 receptor: from conformational changes to novel neutralizing antibodies</article-title>. <source>Cellular and Molecular Life Sciences</source>. <year>2021</year>; <volume>78</volume>:<fpage>1501</fpage>‚Äì<lpage>1522</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Moal</surname> <given-names>IH</given-names></string-name>, <string-name><surname>Fern√°ndez-Recio</surname> <given-names>J.</given-names></string-name> <article-title>SKEMPI: A structural kinetic and energetic database of mutant protein interactions and its use in empirical models</article-title>. <source>Bioinformatics</source>. <year>2012</year>; <volume>28</volume>(<issue>20</issue>):<fpage>2600</fpage>‚Äì<lpage>2607</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Myung</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Pires</surname> <given-names>DE</given-names></string-name>, <string-name><surname>Ascher</surname> <given-names>DB</given-names></string-name>. <article-title>CSM-AB: graph-based antibody‚Äìantigen binding affinity prediction and docking scoring function</article-title>. <source>Bioinformatics</source>. <year>2022</year>; <volume>38</volume>(<issue>4</issue>):<fpage>1141</fpage>‚Äì<lpage>1143</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Nijkamp</surname> <given-names>E</given-names></string-name>, <string-name><surname>Ruffolo</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Weinstein</surname> <given-names>EN</given-names></string-name>, <string-name><surname>Naik</surname> <given-names>N</given-names></string-name>, <string-name><surname>Madani</surname> <given-names>A.</given-names></string-name> <article-title>ProGen2: exploring the boundaries of protein language models</article-title>. <source>Cell Systems</source>. <year>2023</year>; <volume>14</volume>(<issue>11</issue>):<fpage>968</fpage>‚Äì<lpage>978</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Nikam</surname> <given-names>R</given-names></string-name>, <string-name><surname>Kulandaisamy</surname> <given-names>A</given-names></string-name>, <string-name><surname>Harini</surname> <given-names>K</given-names></string-name>, <string-name><surname>Sharma</surname> <given-names>D</given-names></string-name>, <string-name><surname>Gromiha</surname> <given-names>MM</given-names></string-name>. <article-title>ProThermDB: thermodynamic database for proteins and mutants revisited after 15 years</article-title>. <source>Nucleic Acids Research</source>. <year>2021</year>; <volume>49</volume>(<issue>D1</issue>):<fpage>D420</fpage>‚Äì<lpage>D424</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="confproc"><string-name><surname>Notin</surname> <given-names>P</given-names></string-name>, <string-name><surname>Dias</surname> <given-names>M</given-names></string-name>, <string-name><surname>Frazer</surname> <given-names>J</given-names></string-name>, <string-name><surname>Hurtado</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Gomez</surname> <given-names>AN</given-names></string-name>, <string-name><surname>Marks</surname> <given-names>D</given-names></string-name>, <string-name><surname>Gal</surname> <given-names>Y.</given-names></string-name> <article-title>Tranception: protein fitness prediction with autoregressive transformers and inference-time retrieval</article-title>. <source>In: ICML</source>; <year>2022</year>. p. <fpage>16990</fpage>‚Äì<lpage>17017</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="confproc"><string-name><surname>Notin</surname> <given-names>P</given-names></string-name>, <string-name><surname>Kollasch</surname> <given-names>AW</given-names></string-name>, <string-name><surname>Ritter</surname> <given-names>D</given-names></string-name>, <string-name><surname>Van Niekerk</surname> <given-names>L</given-names></string-name>, <string-name><surname>Paul</surname> <given-names>S</given-names></string-name>, <string-name><surname>Spinner</surname> <given-names>H</given-names></string-name>, <string-name><surname>Rollins</surname> <given-names>NJ</given-names></string-name>, <string-name><surname>Shaw</surname> <given-names>A</given-names></string-name>, <string-name><surname>Weitzman</surname> <given-names>R</given-names></string-name>, <string-name><surname>Frazer</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <article-title>ProteinGym: Large-scale benchmarks for protein fitness prediction and design</article-title>. <source>In: NeurIPS</source>; <year>2023</year>..</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><surname>Orengo</surname> <given-names>C</given-names></string-name>, <string-name><surname>Michie</surname> <given-names>A</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>S</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>D</given-names></string-name>, <string-name><surname>Swindells</surname> <given-names>M</given-names></string-name>, <string-name><surname>Thornton</surname> <given-names>J.</given-names></string-name> <article-title>CATH ‚Äì a hierarchic classification of protein domain structures</article-title>. <source>Structure</source>. <year>1997</year>; <volume>5</volume>(<issue>8</issue>):<fpage>1093</fpage>‚Äì<lpage>1109</lpage>. doi: <pub-id pub-id-type="doi">10.1016/S0969-2126(97)00260-8</pub-id>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="confproc"><string-name><surname>Rao</surname> <given-names>R</given-names></string-name>, <string-name><surname>Meier</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sercu</surname> <given-names>T</given-names></string-name>, <string-name><surname>Ovchinnikov</surname> <given-names>S</given-names></string-name>, <string-name><surname>Rives</surname> <given-names>A.</given-names></string-name> <article-title>Transformer protein language models are unsupervised structure learners</article-title>. <source>In: ICLR</source>; <year>2021</year>..</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="confproc"><string-name><surname>Rao</surname> <given-names>RM</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Verkuil</surname> <given-names>R</given-names></string-name>, <string-name><surname>Meier</surname> <given-names>J</given-names></string-name>, <string-name><surname>Canny</surname> <given-names>J</given-names></string-name>, <string-name><surname>Abbeel</surname> <given-names>P</given-names></string-name>, <string-name><surname>Sercu</surname> <given-names>T</given-names></string-name>, <string-name><surname>Rives</surname> <given-names>A.</given-names></string-name> <article-title>MSA transformer</article-title>. <source>In: ICML</source>; <year>2021</year>. p. <fpage>8844</fpage>‚Äì<lpage>8856</lpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Riesselman</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Ingraham</surname> <given-names>JB</given-names></string-name>, <string-name><surname>Marks</surname> <given-names>DS</given-names></string-name>. <article-title>Deep generative models of genetic variation capture the effects of mutations</article-title>. <source>Nature Methods</source>. <year>2018</year>; <volume>15</volume>(<issue>10</issue>):<fpage>816</fpage>‚Äì<lpage>822</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Rives</surname> <given-names>A</given-names></string-name>, <string-name><surname>Meier</surname> <given-names>J</given-names></string-name>, <string-name><surname>Sercu</surname> <given-names>T</given-names></string-name>, <string-name><surname>Goyal</surname> <given-names>S</given-names></string-name>, <string-name><surname>Lin</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Guo</surname> <given-names>D</given-names></string-name>, <string-name><surname>Ott</surname> <given-names>M</given-names></string-name>, <string-name><surname>Zitnick</surname> <given-names>CL</given-names></string-name>, <string-name><surname>Ma</surname> <given-names>J</given-names></string-name>, <etal>et al.</etal> <article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2021</year>; <volume>118</volume>(<issue>15</issue>):<fpage>e2016239118</fpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Robertson</surname> <given-names>AD</given-names></string-name>, <string-name><surname>Murphy</surname> <given-names>KP</given-names></string-name>. <article-title>Protein structure and the energetics of protein stability</article-title>. <source>Chemical Reviews</source>. <year>1997</year>; <volume>97</volume>(<issue>5</issue>):<fpage>1251</fpage>‚Äì<lpage>1268</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Robinson-Rechavi</surname> <given-names>M</given-names></string-name>, <string-name><surname>Alib√©s</surname> <given-names>A</given-names></string-name>, <string-name><surname>Godzik</surname> <given-names>A.</given-names></string-name> <article-title>Contribution of electrostatic interactions, compactness and quaternary structure to protein thermostability: lessons from structural genomics of Thermotoga maritima</article-title>. <source>Journal of Molecular Biology</source>. <year>2006</year>; <volume>356</volume>(<issue>2</issue>):<fpage>547</fpage>‚Äì<lpage>557</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Roscoe</surname> <given-names>BP</given-names></string-name>, <string-name><surname>Thayer</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Zeldovich</surname> <given-names>KB</given-names></string-name>, <string-name><surname>Fushman</surname> <given-names>D</given-names></string-name>, <string-name><surname>Bolon</surname> <given-names>DN</given-names></string-name>. <article-title>Analyses of the effects of all ubiquitin point mutants on yeast growth rate</article-title>. <source>Journal of Molecular Biology</source>. <year>2013</year>; <volume>425</volume>(<issue>8</issue>):<fpage>1363</fpage>‚Äì<lpage>1377</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Sarkisyan</surname> <given-names>KS</given-names></string-name>, <string-name><surname>Bolotin</surname> <given-names>DA</given-names></string-name>, <string-name><surname>Meer</surname> <given-names>MV</given-names></string-name>, <string-name><surname>Usmanova</surname> <given-names>DR</given-names></string-name>, <string-name><surname>Mishin</surname> <given-names>AS</given-names></string-name>, <string-name><surname>Sharonov</surname> <given-names>GV</given-names></string-name>, <string-name><surname>Ivankov</surname> <given-names>DN</given-names></string-name>, <string-name><surname>Bozhanova</surname> <given-names>NG</given-names></string-name>, <string-name><surname>Baranov</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Soylemez</surname> <given-names>O</given-names></string-name>, <etal>et al.</etal> <article-title>Local fitness landscape of the green fluorescent protein</article-title>. <source>Nature</source>. <year>2016</year>; <volume>533</volume>(<issue>7603</issue>):<fpage>397</fpage>‚Äì<lpage>401</lpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="confproc"><string-name><surname>Satorras</surname> <given-names>VG</given-names></string-name>, <string-name><surname>Hoogeboom</surname> <given-names>E</given-names></string-name>, <string-name><surname>Welling</surname> <given-names>M.</given-names></string-name> <article-title>E(n) equivariant graph neural networks</article-title>. <source>In: ICML</source>; <year>2021</year>. p. <fpage>9323</fpage>‚Äì<lpage>9332</lpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Sheng</surname> <given-names>G</given-names></string-name>, <string-name><surname>Zhao</surname> <given-names>H</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Rao</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Tian</surname> <given-names>W</given-names></string-name>, <string-name><surname>Swarts</surname> <given-names>DC</given-names></string-name>, <string-name><surname>van der Oost</surname> <given-names>J</given-names></string-name>, <string-name><surname>Patel</surname> <given-names>DJ</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Y.</given-names></string-name> <article-title>Structure-based cleavage mechanism of Thermus thermophilus Argonaute DNA guide strand-mediated DNA target cleavage</article-title>. <source>Proceed-ings of the National Academy of Sciences</source>. <year>2014</year>; <volume>111</volume>(<issue>2</issue>):<fpage>652</fpage>‚Äì<lpage>657</lpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Shin</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Riesselman</surname> <given-names>AJ</given-names></string-name>, <string-name><surname>Kollasch</surname> <given-names>AW</given-names></string-name>, <string-name><surname>McMahon</surname> <given-names>C</given-names></string-name>, <string-name><surname>Simon</surname> <given-names>E</given-names></string-name>, <string-name><surname>Sander</surname> <given-names>C</given-names></string-name>, <string-name><surname>Manglik</surname> <given-names>A</given-names></string-name>, <string-name><surname>Kruse</surname> <given-names>AC</given-names></string-name>, <string-name><surname>Marks</surname> <given-names>DS</given-names></string-name>. <article-title>Protein design and variant prediction using autoregressive generative models</article-title>. <source>Nature Communications</source>. <year>2021</year>; <volume>12</volume>(<issue>1</issue>):<fpage>2403</fpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Suzek</surname> <given-names>BE</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>H</given-names></string-name>, <string-name><surname>McGarvey</surname> <given-names>PB</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>CH</given-names></string-name>, <string-name><surname>Consortium</surname> <given-names>U.</given-names></string-name> <article-title>UniRef clusters: a comprehensive and scalable alternative for improving sequence similarity searches</article-title>. <source>Bioinformatics</source>. <year>2015</year>; <volume>31</volume>(<issue>6</issue>):<fpage>926</fpage>‚Äì<lpage>932</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Torng</surname> <given-names>W</given-names></string-name>, <string-name><surname>Altman</surname> <given-names>RB</given-names></string-name>. <article-title>High precision protein functional site detection using 3D convolutional neural networks</article-title>. <source>Bioinformatics</source>. <year>2019</year>; <volume>35</volume>(<issue>9</issue>):<fpage>1503</fpage>‚Äì<lpage>1512</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="confproc"><string-name><surname>Vaswani</surname> <given-names>A</given-names></string-name>, <string-name><surname>Shazeer</surname> <given-names>N</given-names></string-name>, <string-name><surname>Parmar</surname> <given-names>N</given-names></string-name>, <string-name><surname>Uszkoreit</surname> <given-names>J</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>L</given-names></string-name>, <string-name><surname>Gomez</surname> <given-names>AN</given-names></string-name>, <string-name><surname>Kaiser</surname> <given-names>L</given-names></string-name>, <string-name><surname>Polosukhin</surname> <given-names>I.</given-names></string-name> <article-title>Attention Is All You Need</article-title>. <source>In: NeurIPS</source>; <year>2017</year>..</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Velecky</surname> <given-names>J</given-names></string-name>, <string-name><surname>Hamsikova</surname> <given-names>M</given-names></string-name>, <string-name><surname>Stourac</surname> <given-names>J</given-names></string-name>, <string-name><surname>Musil</surname> <given-names>M</given-names></string-name>, <string-name><surname>Damborsky</surname> <given-names>J</given-names></string-name>, <string-name><surname>Bednar</surname> <given-names>D</given-names></string-name>, <string-name><surname>Mazurenko</surname> <given-names>S.</given-names></string-name> <article-title>SoluProtMutDB: A manually curated database of protein solubility changes upon mutations</article-title>. <source>Computational and Structural Biotechnology Journal</source>. <year>2022</year>; <volume>20</volume>:<fpage>6339</fpage>‚Äì<lpage>6347</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="confproc"><string-name><surname>Velickovic</surname> <given-names>P</given-names></string-name>, <string-name><surname>Cucurull</surname> <given-names>G</given-names></string-name>, <string-name><surname>Casanova</surname> <given-names>A</given-names></string-name>, <string-name><surname>Romero</surname> <given-names>A</given-names></string-name>, <string-name><surname>Lio</surname> <given-names>P</given-names></string-name>, <string-name><surname>Bengio</surname> <given-names>Y.</given-names></string-name> <article-title>Graph attention networks</article-title>. <source>In: ICLR</source>; <year>2018</year>..</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="confproc"><string-name><surname>Vig</surname> <given-names>J</given-names></string-name>, <string-name><surname>Madani</surname> <given-names>A</given-names></string-name>, <string-name><surname>Varshney</surname> <given-names>LR</given-names></string-name>, <string-name><surname>Xiong</surname> <given-names>C</given-names></string-name>, <string-name><surname>Rajani</surname> <given-names>N</given-names></string-name>, <etal>et al.</etal> <article-title>BERTology Meets Biology: Interpreting Attention in Protein Language Models</article-title>. <source>In: ICLR</source>; <year>2021</year>..</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Wang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Xue</surname> <given-names>P</given-names></string-name>, <string-name><surname>Cao</surname> <given-names>M</given-names></string-name>, <string-name><surname>Yu</surname> <given-names>T</given-names></string-name>, <string-name><surname>Lane</surname> <given-names>ST</given-names></string-name>, <string-name><surname>Zhao</surname> <given-names>H.</given-names></string-name> <article-title>Directed evolution: methodologies and applications</article-title>. <source>Chemical Reviews</source>. <year>2021</year>; <volume>121</volume>(<issue>20</issue>):<fpage>12384</fpage>‚Äì<lpage>12444</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><surname>Woodley</surname> <given-names>JM</given-names></string-name>. <article-title>Protein engineering of enzymes for process applications</article-title>. <source>Current Opinion in Chemical Biology</source>. <year>2013</year>; <volume>17</volume>(<issue>2</issue>):<fpage>310</fpage>‚Äì<lpage>316</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>W√ºthrich</surname> <given-names>K.</given-names></string-name> <article-title>Protein structure determination in solution by NMR spectroscopy</article-title>. <source>Journal of Biological Chemistry</source>. <year>1990</year>; <volume>265</volume>(<issue>36</issue>):<fpage>22059</fpage>‚Äì<lpage>22062</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="confproc"><string-name><surname>Yang</surname> <given-names>KK</given-names></string-name>, <string-name><surname>Lu</surname> <given-names>AX</given-names></string-name>, <string-name><surname>Fusi</surname> <given-names>N.</given-names></string-name> <article-title>Convolutions are competitive with transformers for protein sequence pretraining</article-title>. <source>In: ICLR Machine Learning for Drug Discovery</source>; <year>2022</year>. .</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Yang</surname> <given-names>KK</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Arnold</surname> <given-names>FH</given-names></string-name>. <article-title>Machine-learning-guided directed evolution for protein engineering</article-title>. <source>Nature Methods</source>. <year>2019</year>; <volume>16</volume>(<issue>8</issue>):<fpage>687</fpage>‚Äì<lpage>694</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Yang</surname> <given-names>KK</given-names></string-name>, <string-name><surname>Zanichelli</surname> <given-names>N</given-names></string-name>, <string-name><surname>Yeh</surname> <given-names>H.</given-names></string-name> <article-title>Masked inverse folding with sequence transfer for protein representation learning</article-title>. <source>Protein Engineering, Design and Selection</source>. <year>2023</year>; <volume>36</volume>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="confproc"><string-name><surname>Yi</surname> <given-names>K</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>B</given-names></string-name>, <string-name><surname>Shen</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Li√≤</surname> <given-names>P</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>YG</given-names></string-name>. <article-title>Graph denoising diffusion for inverse protein folding</article-title>. <source>In: NeurIPS</source>; <year>2023</year>. .</mixed-citation></ref>
    <ref id="c59"><mixed-citation publication-type="preprint"><string-name><surname>Zhang</surname> <given-names>N</given-names></string-name>, <string-name><surname>Bi</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Liang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Cheng</surname> <given-names>S</given-names></string-name>, <string-name><surname>Hong</surname> <given-names>H</given-names></string-name>, <string-name><surname>Deng</surname> <given-names>S</given-names></string-name>, <string-name><surname>Lian</surname> <given-names>J</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>H.</given-names></string-name> <article-title>Ontoprotein: Protein pretraining with gene ontology embedding</article-title>. <source>arXiv</source>. <year>2022</year>;.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><surname>Zhao</surname> <given-names>W</given-names></string-name>, <string-name><surname>Zhong</surname> <given-names>B</given-names></string-name>, <string-name><surname>Zheng</surname> <given-names>L</given-names></string-name>, <string-name><surname>Tan</surname> <given-names>P</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Leng</surname> <given-names>H</given-names></string-name>, <string-name><surname>de Souza</surname> <given-names>N</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Hong</surname> <given-names>L</given-names></string-name>, <string-name><surname>Xiao</surname> <given-names>X.</given-names></string-name> <article-title>Proteome-wide 3D structure prediction provides insights into the ancestral metabolism of ancient archaea and bacteria</article-title>. <source>Nature Communications</source>. <year>2022</year>; <volume>13</volume>(<issue>1</issue>):<fpage>7861</fpage>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><surname>Zheng</surname> <given-names>L</given-names></string-name>, <string-name><surname>Lu</surname> <given-names>H</given-names></string-name>, <string-name><surname>Zan</surname> <given-names>B</given-names></string-name>, <string-name><surname>Li</surname> <given-names>S</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>H</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Jiang</surname> <given-names>F</given-names></string-name>, <string-name><surname>Liu</surname> <given-names>Q</given-names></string-name>, <etal>et al.</etal> <article-title>Loosely-packed dynamical structures with partially-melted surface being the key for thermophilic argonaute proteins achieving high DNA-cleavage activity</article-title>. <source>Nucleic Acids Research</source>. <year>2022</year>; <volume>50</volume>(<issue>13</issue>):<fpage>7529</fpage>‚Äì<lpage>7544</lpage>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="preprint"><string-name><surname>Zhou</surname> <given-names>B</given-names></string-name>, <string-name><surname>Zheng</surname> <given-names>L</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>B</given-names></string-name>, <string-name><surname>Tan</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Lv</surname> <given-names>O</given-names></string-name>, <string-name><surname>Yi</surname> <given-names>K</given-names></string-name>, <string-name><surname>Fan</surname> <given-names>G</given-names></string-name>, <string-name><surname>Hong</surname> <given-names>L.</given-names></string-name> <article-title>Protein Engineering with Lightweight Graph Denoising Neural Networks</article-title>. <source>bioRxiv</source>. <year>2023</year>; doi: <pub-id pub-id-type="doi">10.1101/2023.11.05.565665</pub-id>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="preprint"><string-name><surname>Zhou</surname> <given-names>B</given-names></string-name>, <string-name><surname>Zheng</surname> <given-names>L</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>B</given-names></string-name>, <string-name><surname>Yi</surname> <given-names>K</given-names></string-name>, <string-name><surname>Zhong</surname> <given-names>B</given-names></string-name>, <string-name><surname>Lio</surname> <given-names>P</given-names></string-name>, <string-name><surname>Hong</surname> <given-names>L.</given-names></string-name> <article-title>Conditional Protein Denoising Diffusion Generates Pro-grammable Endonucleases</article-title>. <source>bioRxiv</source>. <year>2023</year>; p. <fpage>2023</fpage>‚Äì<lpage>08</lpage>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="preprint"><string-name><surname>Zhou</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Pan</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Pires</surname> <given-names>DE</given-names></string-name>, <string-name><surname>Rodrigues</surname> <given-names>CH</given-names></string-name>, <string-name><surname>Ascher</surname> <given-names>DB</given-names></string-name>. <article-title>DDMut: predicting effects of mutations on protein stability using deep learning</article-title>. <source>Nucleic Acids Research</source>. <year>2023</year>; p. <fpage>gkad472</fpage>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98033.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Koo</surname>
<given-names>Peter</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Cold Spring Harbor Laboratory</institution>
</institution-wrap>
<city>Cold Spring Harbor</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>ProtSSN is a <bold>valuable</bold> approach that generates protein embeddings by integrating sequence and structural information, demonstrating improved prediction of mutation effects on thermostability compared to sequence-only models. The work is currently <bold>incomplete</bold> as it lacks a thorough comparison against other recent top-performing methods that also incorporate structural data, such as SaProt, EVE-based models, and GEMME. Providing a comprehensive analysis benchmarking ProtSSN against these state-of-the-art structure-based approaches would significantly strengthen the evidence supporting the utility of ProtSSN's joint sequence-structure representations.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98033.1.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors introduce a denoising-style model that incorporates both structure and primary-sequence embeddings to generate richer embeddings of peptides. My understanding is that the authors use ESM for the primary sequence embeddings, take resolved structures (or use structural predictions from AlphaFold when they're not available), and then develop an architecture to combine these two with a loss that seems reminiscent of diffusion models or masked language model approaches. The embeddings can be viewed as ensemble-style embedding of the two levels of sequence information, or with AlphaFold, an ensemble of two methods (ESM+AlphaFold). The authors also gather external datasets to evaluate their approach and compare it to previous approaches. The approach seems promising and appears to out-compete previous methods at several tasks. Nonetheless, I have strong concerns about a lack of verbosity as well as the exclusion of relevant methods and references.</p>
<p>Advances:</p>
<p>I appreciate the breadth of the analysis and comparisons to other methods. The authors separate tasks, models, and sizes of models in an intuitive, easy-to-read fashion that I find valuable for selecting a method for embedding peptides. Moreover, the authors gather two datasets for evaluating embeddings' utility for predicting thermostability. Overall, the work should be helpful for the field as more groups choose methods/pretraining strategies amenable to their goals, and can do so in an evidence-guided manner.</p>
<p>Considerations:</p>
<p>Primarily, a majority of the results and conclusions (e.g., Table 3) are reached using data and methods from ProteinGym, yet the best-performing methods on ProteinGym are excluded from the paper (e.g., EVE-based models and GEMME). In the ProteinGym database, these methods outperform ProtSSN models. Moreover, these models were published over a year---or even 4 years in the case of GEMME---before ProtSSN, and I do not see justification for their exclusion in the text.</p>
<p>Secondly, related to the comparison of other models, there is no section in the methods about how other models were used, or how their scores were computed. When comparing these models, I think it's crucial that there are explicit derivations or explanations for the exact task used for scoring each method. In other words, if the pre-training is indeed an important advance of the paper, the paper needs to show this more explicitly by explaining exactly which components of the model (and previous models) are used for evaluation. Are the authors extracting the final hidden layer representations of the model, treating these as features, and then using these features in a regression task to predict fitness/thermostability/DDG etc.? How are the model embeddings of other methods being used, since, for example, many of these methods output a k-dimensional embedding of a given sequence, rather than one single score that can be correlated with some fitness/functional metric? Summarily, I think the text lacks an explicit mention of how these embeddings are being summarized or used, as well as how this compares to the model presented.</p>
<p>I think the above issues can mainly be addressed by considering and incorporating points from Li et al. 2024[1] and potentially Tang &amp; Koo 2024[2]. Li et al.[1] make extremely explicit the use of pretraining for downstream prediction tasks. Moreover, they benchmark pretraining strategies explicitly on thermostability (one of the main considerations in the submitted manuscript), yet there is no mention of this work nor the dataset used (FLIP (Dallago et al., 2021)) in this current work. I think a reference and discussion of [1] is critical, and I would also like to see comparisons in line with [1], as [1] is very clear about what features from pretraining are used, and how. If the comparisons with previous methods were done in this fashion, this level of detail needs to be included in the text.</p>
<p>To conclude, I think the manuscript would benefit substantially from a more thorough comparison of previous methods. Maybe one way of doing this is following [1] or [2], and using the final embeddings of each method for a variety of regression tasks---to really make clear where these methods are performing relative to one another. I think a more thorough methods section detailing how previous methods did their scoring is also important. Lastly, TranceptEVE (or a model comparable to it) and GEMME should also be mentioned in these results, or at the bare minimum, be given justification for their absence.</p>
<p>[1] Feature Reuse and Scaling: Understanding Transfer Learning with Protein Language Models</p>
<p>
Francesca-Zhoufan Li, Ava P. Amini, Yisong Yue, Kevin K. Yang, Alex X. Lu</p>
<p>
bioRxiv 2024.02.05.578959; doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/2024.02.05.578959">https://doi.org/10.1101/2024.02.05.578959</ext-link></p>
<p>[2] Evaluating the representational power of pre-trained DNA language models for regulatory genomics</p>
<p>
Ziqi Tang, Peter K Koo</p>
<p>
bioRxiv 2024.02.29.582810; doi: <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/2024.02.29.582810">https://doi.org/10.1101/2024.02.29.582810</ext-link></p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.98033.1.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>To design proteins and predict disease, we want to predict the effects of mutations on the function of a protein. To make these predictions, biologists have long turned to statistical models that learn patterns that are conserved across evolution. There is potential to improve our predictions however by incorporating structure. In this paper, the authors build a denoising auto-encoder model that incorporates sequence and structure to predict mutation effects. The model is trained to predict the sequence of a protein given its perturbed sequence and structure. The authors demonstrate that this model is able to predict the effects of mutations better than sequence-only models.</p>
<p>As well, the authors curate a set of assays measuring the effect of mutations on thermostability. They demonstrate their model also predicts the effects of these mutations better than previous models and make this benchmark available for the community.</p>
<p>Strengths:</p>
<p>The authors describe a method that makes accurate mutation effect predictions by informing its predictions with structure.</p>
<p>Weaknesses:</p>
<p>It is unclear how this model compares to other methods of incorporating structure into models of biological sequences, most notably SaProt (<ext-link ext-link-type="uri" xlink:href="https://www.biorxiv.org/content/10.1101/2023.10.01.560349v1.full.pdf">https://www.biorxiv.org/content/10.1101/2023.10.01.560349v1.full.pdf</ext-link>).</p>
<p>ProteinGym is largely made of deep mutational scans, which measure the effect of every mutation on a protein. These new benchmarks contain on average measurements of less than a percent of all possible point mutations of their respective proteins. It is unclear what sorts of protein regions these mutations are more likely to lie in; therefore it is challenging to make conclusions about what a model has necessarily learned based on its score on this benchmark. For example, several assays in this new benchmark seem to be similar to each other, such as four assays on ubiquitin performed at pH 2.25 to pH 3.0.</p>
</body>
</sub-article>
</article>