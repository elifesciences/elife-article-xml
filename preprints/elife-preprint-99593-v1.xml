<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">99593</article-id>
<article-id pub-id-type="doi">10.7554/eLife.99593</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.99593.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Physics of Living Systems</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Emergence of alternative stable states in gene exchange communities</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Hong</surname>
<given-names>Juken</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Xue</surname>
<given-names>Wenzhi</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0009-0000-5176-5095</contrib-id>
<name>
<surname>Wang</surname>
<given-names>Teng</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>t.wang1@siat.ac.cn</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04gh4er46</institution-id><institution>Key Laboratory of Quantitative Synthetic Biology, Shenzhen Institute of Synthetic Biology, Shenzhen Institutes of Advanced Technology, Chinese Academy of Sciences</institution></institution-wrap>, <city>Shenzhen</city>, <country>China</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Momeni</surname>
<given-names>Babak</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Boston College</institution>
</institution-wrap>
<city>Chestnut Hill</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Schuman</surname>
<given-names>Meredith C</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Zurich</institution>
</institution-wrap>
<city>Zürich</city>
<country>Switzerland</country>
</aff>
</contrib>
</contrib-group>
<pub-date date-type="original-publication" iso-8601-date="2024-11-21">
<day>21</day>
<month>11</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP99593</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-06-18">
<day>18</day>
<month>06</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-06-22">
<day>22</day>
<month>06</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.06.18.599596"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Hong et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Hong et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-99593-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Microbial communities living in the same environment often display multiple alternative stable states, each characterized by a unique composition of species. Understanding the origin and determinants of microbiome multistability has broad implications in environments, human health and microbiome engineering. However, despite its conceptual importance, how multistability emerges in complex communities remains largely unknown. Here, we focused on the role of horizontal gene transfer (HGT), one important aspect mostly overlooked in previous theories, on the stability landscape of competing microbial populations. Combining theoretical derivation and numerical simulations, we demonstrated that in many scenarios increasing gene transfer rate could promote the emergence of many alternative stable states in complex microbiota. In metacommunities composed of multiple local patches, such multistability enabled by HGT allows the regional coexistence of diverse microbes which would otherwise outcompete each other. We further discussed the effects of different complicating factors on the role of HGT in mediating microbiome stability. Our results provide key insights for the predictive control and engineering of complex microbiota.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Microbial communities living in similar environments often display different community types, each characterized by a unique composition of species<sup><xref ref-type="bibr" rid="c1">1</xref>-<xref ref-type="bibr" rid="c4">4</xref></sup>. Changes in environmental factors, fluctuations of species abundances, or transient invasions can trigger abrupt and irreversible transitions between two types<sup><xref ref-type="bibr" rid="c5">5</xref>-<xref ref-type="bibr" rid="c7">7</xref></sup>. Such transitions, also known as regime shifts, lead to the dramatic alterations of microbiome functions and are tightly associated with many host diseases, soil fertility, marine biogeochemical flux, or bioproduction yield<sup><xref ref-type="bibr" rid="c8">8</xref>-<xref ref-type="bibr" rid="c12">12</xref></sup>. Understanding the origin of different community types has broad implications in environments, engineering and health<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c3">3</xref></sup>.</p>
<p>Multistability, a phenomenon where multiple stable states coexist for the same set of system parameters, is one of the most important mechanisms behind alternative community types and has been widely observed in a variety of natural or experimental microbiomes<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c13">13</xref>-<xref ref-type="bibr" rid="c17">17</xref></sup>. Under perturbations, a multistable system can be driven away from a former stable state, cross the tipping point and reach a new steady state. The population can persist in the new state even after the perturbations are withdrawn, exhibiting a behavior of ‘hysteresis’<sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c13">13</xref></sup>. Despite its conceptual importance, the determinants underlying microbiota multistability have been poorly understood due to the intrinsic complexity of microbial interactions<sup><xref ref-type="bibr" rid="c14">14</xref></sup>.</p>
<p>Unraveling how multistability emerges in complex microbiota can provide crucial insights in different scenarios. For instance, the existence of alternative ‘hidden’ stable states in gut microbiome undermines the community resilience against external perturbations such as pathogenic infections or dietary changes<sup><xref ref-type="bibr" rid="c18">18</xref></sup>. Understanding which mechanisms contribute to multistability will help the design of modulatory strategies that prevent the developments of unhealthy stable states<sup><xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c18">18</xref></sup>. Multistability also renders the catastrophic shift of microbial populations under antibiotic exposure from being drug-sensitive to drug-resistant<sup><xref ref-type="bibr" rid="c6">6</xref></sup>. Inhibiting the processes underlying multistability can be useful to reverse antibiotic resistance and prolong the efficacy of current antibiotics<sup><xref ref-type="bibr" rid="c19">19</xref></sup>. In engineered microbiomes, the drastic compositional changes can result in the unexpected loss of the desired functions. The ability to predict and control community multistability is essential to better harness the bioproduction potential of synthetic microbial consortia<sup><xref ref-type="bibr" rid="c15">15</xref></sup>.</p>
<p>Mathematical models are indispensable to decipher the emergent properties of complex populations<sup><xref ref-type="bibr" rid="c20">20</xref></sup>. While different ecological models have been developed to analyze the influences of some factors, such as microbial mutual inhibition and nutrient stoichiometries, in mediating community multistability, the roles of many critical mechanisms have been overlooked in existing theories<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>. Chief among these is horizontal gene transfer (HGT), a process where microbes share mobile genetic elements (MGEs) with their neighbors<sup><xref ref-type="bibr" rid="c21">21</xref></sup>. Indeed, HGT is prevalent in microbial world and mobile genes occupy a substantial proportion in microbial gene pool<sup><xref ref-type="bibr" rid="c22">22</xref>-<xref ref-type="bibr" rid="c24">24</xref></sup>. For instance, among the closely related microbial isolates in the same human body site, HGT occurs in more than 40% of the species pairs<sup><xref ref-type="bibr" rid="c25">25</xref></sup>. In the draft genomes of human gut microbes, tens of thousands of genes were mobilizable<sup><xref ref-type="bibr" rid="c23">23</xref></sup>. However, despite its functional and ecological importance, the interplay between genetic exchange and community multistability has not been rigorously examined in previous studies and a general conclusion remains lacking.</p>
<p>In this work, we focus on communities of competing microbes, a model system for microbiome multistability<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c14">14</xref>,<xref ref-type="bibr" rid="c26">26</xref></sup>. By combining theoretical analysis and numerical simulations, we demonstrated that in many scenarios gene transfer could promote the emergence of alternative stable states which otherwise would not exist. We further extended our analysis to metacommunities consisting of multiple local habitats. Our results suggested that while multistability enabled by HGT didn’t affect local diversity, it enabled the emergence of species diversity at regional scale. We also discussed the influence of different confounding factors on the applicability of the predictions. Our results provide valuable insights for microbial ecology, health and microbiome engineering.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>The role of HGT on bistability of two-species populations</title>
<p>To illustrate the basic concepts, let’s first consider a population of two competing species. The mutual inhibition between the two members creates a positive feedback, making bistability possible<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>. Without HGT, the community dynamics can be simulated by the classic Lotka-Volterra (LV) model that accounts for species growth rates (<italic>μ</italic><sub>1</sub> and <italic>μ</italic><sub>2</sub>), interspecies competition (<italic>γ</italic><sub>1</sub> and <italic>γ</italic><sub>2</sub>) and the dilution rate (<italic>D</italic>). Given the simplicity of this model, the condition of the system being bistable can be analytically solved as <italic>γ</italic><sub>1</sub> &gt; <italic>ϕ</italic><sub>2</sub>/<italic>ϕ</italic><sub>1</sub> and <italic>γ</italic><sub>2</sub> &gt; <italic>ϕ</italic><sub>1</sub>/<italic>ϕ</italic><sub>2</sub> where <inline-formula><inline-graphic xlink:href="599596v1_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v1_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula>(see Methods for more details). When this condition is satisfied, either species can dominate the population at steady state, depending on their initial abundances. Otherwise, the population will always rest at the same steady state regardless of the initial composition (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1.</label>
<caption><title>Horizontal gene transfer (HGT) promotes bistability of communities consisting of two competing microbes.</title>
<p><bold>(a)</bold> Schematics of monostable and bistable systems. A monostable system will always rest at the same steady state no matter where the system starts from. In contrast, a bistable system can reach two distinct steady states, depending on the initial ratio between the two competitors.</p>
<p><bold>(b)</bold> The phase diagram of the population with (bottom panel, η = 0.2 <italic>hr</italic><sup>−1</sup>) or without HGT (top panel). Different combinations of μ<sub>1</sub> and μ<sub>2</sub> between 0 and 1 <italic>hr</italic><sup>−1</sup> were tested. For each combination, the initial abundance of each species was randomized 200 times between 0 and 1 following uniform distribution. The system was monostable if all initializations led to the same steady state. Otherwise, the system was bistable. All combinations of μ<sub>1</sub> and μ<sub>2</sub> that led to bistability were marked in blue in the diagram. Other parameters are <italic>γ</italic> = 1.1, <italic>k</italic> = 0.005 <italic>hr</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>hr</italic><sup>−1</sup>, <inline-formula><inline-graphic xlink:href="599596v1_inline41.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Two states, <italic>P</italic> (μ<sub>1</sub> = 0.3 <italic>hr</italic><sup>−1</sup>, μ<sub>2</sub> = 0.8 <italic>hr</italic><sup>−1</sup>) and <italic>Q</italic> (μ<sub>1</sub> = 0.4 <italic>hr</italic><sup>−1</sup>, μ<sub>2</sub> = 0.6 <italic>hr</italic><sup>−1</sup>), were labeled as examples. <bold>(c-d)</bold> Population dynamics of <italic>P</italic> and <italic>Q</italic> under 100 different initializations. Here, the dynamic changes of species 1’s abundance were shown. Three different HGT rates (0, 0.1, 0.2 <italic>hr</italic><sup>−1</sup> from top to bottom) were tested. When gene transfer rate increases, the system at <italic>Q</italic> changed from monostable to bistable, while the system at <italic>P</italic> remained monostable.</p></caption>
<graphic xlink:href="599596v1_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To analyze the effect of HGT on bistability, we applied a mathematical model that we previously developed to describe gene transfer between competing species<sup><xref ref-type="bibr" rid="c27">27</xref></sup>. Compared with the classic LV model, the new framework considered the growth rate of each species as a combination of two components contributed by non-mobilizable genes and mobile genes, respectively (see Methods for more details). Due to the fitness effects of mobile genes (denoted as <italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub>, respectively), their gain and loss within each species caused the dynamic change of species growth rates. Gene transfer (with the rate denoted as <italic>η</italic>) allows the two competitors to partially exchange their fitness benefits or disadvantages, and we sought to understand whether this process would reshape the stability landscape of the system.</p>
<p>Due to the increase of modeling complexity, analytical solution becomes infeasible for the new framework. Instead, we determined whether the system was bistable by numerical simulations with randomized initial compositions<sup><xref ref-type="bibr" rid="c26">26</xref></sup>. In general, the resolution of this approach increases with the number of randomizations. Without loss of generality, here we randomly initialized the species abundances for 200 times between 0 and 1 following uniform distributions (Fig. S1a). Then we simulated the population dynamics for each initialization until steady state and obtained their species abundances. A system is called monostable if all populations starting from different compositions converge into the same state. In contrast, if two attractors exist, the system is called bistable (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>). We calculated the number of stable states for a wide range of <italic>μ</italic><sub>1</sub> and <italic>μ</italic><sub>2</sub> values and drew the phase diagram (<xref rid="fig1" ref-type="fig">Fig. 1b</xref>). Whether it is easy for the system to achieve bistability is reflected by the total area of bistability region on the phase diagram. Our numerical results suggested that increasing HGT enlarged the region, creating bistability in a lot of systems which would otherwise be monostable (<xref rid="fig1" ref-type="fig">Fig. 1b-d</xref>). Here, the number of initializations was not critical for the conclusion (Fig. S1a). The results also hold for populations with a variety of interspecies competitions or gene transfer rates (Fig. S1b-d), suggesting the robustness of our conclusion against a variety of confounding factors.</p>
<p>Our results suggested that increasing HGT made it more feasible for the system to become bistable. However, this should not be taken as an assertion that the system will always be bistable when HGT exists (<xref rid="fig1" ref-type="fig">Fig. 1c</xref> and <xref rid="fig1" ref-type="fig">d</xref>). The effect of HGT in creating bistability in a specific community depends on the competition strength, gene transfer rate and the fitness difference between species (<xref rid="fig1" ref-type="fig">Fig. 1b-d</xref>). Bistability will not appear when <italic>γ</italic><sub>1</sub><italic>γ</italic><sub>2</sub> &lt; 1, regardless of HGT rate (Methods). In addition, for two species with large fitness difference, the system might remain monostable when gene transfer rate increases (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>). In this case, the strong competitor will always win despite the gene flow. The effect of HGT in promoting bistability is more applicable between species with smaller fitness difference and stronger competition (<xref rid="fig1" ref-type="fig">Fig. 1b-d</xref>, Fig. S1b).</p>
</sec>
<sec id="s2b">
<title>HGT shapes the stability landscape of multi-species communities</title>
<p>The modeling framework can be readily generalized to more complex communities consisting of multiple competing species by taking into account the gene transfer between every pair of species (see Methods for more details). To understand how gene transfer rate affects the stability landscape of complex microbiota, we estimated the number of alternative stable states by randomly initializing the abundance of each species 500 times between 0 and 1 following uniform distributions. For each initialization, we simulated the population dynamics for 2000 hours till the systems reached equilibrium and calculated the steady-state abundances of different species (Fig. S2). Limit cycles were not observed in our simulations (Fig. S3).</p>
<p>The stability landscape of a complex community can be characterized by the absolute number of stable states. To this end, we grouped the steady states into different attractors using a given threshold. Two steady states with their Euclidean distance smaller than the threshold belonged to the same group (Fig. S4). However, the estimation of this number can be biased by the intrinsic limitations of the numerical approach. For instance, the limited number of initializations can underestimate this number. In contrast, the inability of a system to reach equilibrium within the limited time window of simulations can cause its overestimation. To overcome such limitations, we developed an alternative metric <italic>χ</italic> to measure the multistability of a system by borrowing the concept of ‘entropy’. Let <italic>φ</italic> be the number of stable states and <italic>x</italic><sub><italic>i</italic></sub> be the relative size of each domain of attraction (Σ<sub><italic>i</italic></sub> <italic>x</italic><sub><italic>i</italic></sub> = 1, <italic>i</italic> = 1,2, …, <italic>φ</italic>). <italic>χ</italic> is calculated as <italic>χ</italic> = <italic>exp</italic> (− Σ<sub><italic>i</italic></sub> <italic>x</italic><sub><italic>i</italic></sub><italic>logx</italic><sub><italic>i</italic></sub>), which accounts for the absolute number of stable states as well as the size of each basin. <italic>χ</italic> equals 1 in monostable systems. <italic>χ</italic> gets larger when more stable states emerge or the distribution of the basin sizes become more even. Numerical tests suggested that <italic>χ</italic> was robust to the variations of distance threshold, simulation timespan or number of initializations (Fig. S5).</p>
<p>As shown in <xref rid="fig2" ref-type="fig">Fig. 2</xref>, when HGT is absent, the number of stable states is usually small in a multi-species population. Increasing gene transfer rate reshaped the stability landscape of a microbiome by creating additional stable states. Each stable state is characterized by a different dominant species (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>). This prediction is generally applicable to communities consisting of different number of species (Fig. S6).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig. 2.</label>
<caption><title>The number of alternative stable states in multi-species communities increases with HGT rate.</title>
<p><bold>(a)</bold>, A schematic of the stability landscape of a population composed of multiple competing species with or without HGT. Each alternative stable state is characterized by a different dominant species (shown in filled circles).</p>
<p><bold>(b)</bold>, The emergence of alternative stable states in a five-species community with gene transfer. We simulated the dynamics of 500 parallel communities, each with the same kinetic parameters but different initial compositions. The species compositions of these communities at three different timepoints were shown by principal component analysis from left to right. Without HGT (η = 0), all populations converged into a single stable state. In contrast, with HGT (η = 0.2 <italic>hr</italic><sup>−1</sup>), four different dynamic attractors coexist. Here, populations reaching different stable states were marked with different colors. Other parameters are <inline-formula><inline-graphic xlink:href="599596v1_inline42.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, <italic>μ</italic><sub>1</sub> = 0.52 <italic>hr</italic><sup>−1</sup>, <italic>μ</italic><sub>2</sub> = 0.48 <italic>hr</italic><sup>−1</sup>, <italic>μ</italic><sub>z</sub> = 0.44 <italic>hr</italic><sup>−1</sup>, <italic>μ</italic><sub>4</sub> = 0.60 <italic>hr</italic><sup>−1</sup>, <italic>μ</italic><sub>5</sub> = 0.31 <italic>hr</italic><sup>−1</sup>, <italic>γ</italic> = 1.05, <italic>k</italic> = 0.005 <italic>hr</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>hr</italic><sup>−1</sup>.</p>
<p><bold>(c)</bold>, The number of stable states (top panel) and the multistability coefficient <italic>χ</italic> increase with HGT rate in communities consisting of 8 competing species. We calculated the number of stable states by randomly initializing the species abundances 500 times between 0 and 1 following uniform distributions. Then we simulated the steady states and clustered them into different attractors by applying a threshold of 0.05 on their Euclidean distances. The data were presented as mean ± standard deviation of 10 replicates. Each replicate corresponded to a different combination of randomized species growth rates.</p></caption>
<graphic xlink:href="599596v1_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>So far, our analysis has been focused on communities where the interaction network is fully connected, and each species competes with every other member. In each of such populations, it is highly infeasible to achieve the stable coexistence of different species. While this analysis provides the basic proof of principle, natural environments often consist of many niches<sup><xref ref-type="bibr" rid="c28">28</xref></sup>. Species living in the same niche compete with each other while species from different niches can coexist. To understand whether our conclusion is still applicable when niche effects are considered, we extended our analysis to communities carrying a random number of niches. Each species was randomly allocated into one of the niches, and the stability landscape was analyzed in the same way by randomly initializing the systems (see Methods for more details). Our results suggest that increasing HGT rate still promotes multistability, regardless of the niche structure of the competing communities (<xref rid="fig3" ref-type="fig">Fig. 3</xref>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Fig. 3.</label>
<caption><title>HGT promotes the multistability of communities with multiple niches.</title>
<p><bold>(a)</bold>, A schematic of a microbial population consisting of multiple niches. Species within each niche share the same carrying capacity and compete with each other, while species from different niches can coexist.</p>
<p>(<bold>b-c)</bold>, Multiple alternative stable states emerge in niche communities with gene exchange. Here, a system consisting of 10 species and 4 niches were shown as examples. The steady-state compositions of 100 parallel populations, each with different initializations, were calculated with (η = 0.1 <italic>hr</italic><sup><italic>−</italic>1</sup>) or without HGT. The heights of the colored bars represent the relative abundances of different species. Without HGT, 2 stable states existed for the 100 populations, while with HGT, 6 different stable states existed. The carrying capacity of each niche was randomized between 0 and 1. Other parameters are <inline-formula><inline-graphic xlink:href="599596v1_inline43.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, <italic>k</italic> = 0.005 <italic>hr</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>hr</italic><sup>−1</sup>. Interspecies competition strength equals 1.05 within each niche.</p>
<p><bold>(d)</bold>, The multistability <italic>χ</italic> in niche communities increases with HGT rate. Communities of 8 species were considered as an example. The data were presented as mean ± standard deviation of 10 replicates. For each replicate, the species growth rates were randomized between 0.3 and 0.7 <italic>hr</italic><sup>−1</sup> following uniform distributions. The number of niches were randomized as 2, 3 or 4.</p></caption>
<graphic xlink:href="599596v1_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2c">
<title>HGT-enabled multistability promotes the regional coexistence of competing species</title>
<p>Our results highlight the role of HGT on shaping the stability landscape of closed local communities. Natural microbiomes, however, exist at scales broader than a localized population. A set of local communities subject to similar environments, also known as ‘patches’, form a metacommunity<sup><xref ref-type="bibr" rid="c29">29</xref>,<xref ref-type="bibr" rid="c30">30</xref></sup>. When multiple stable states coexist, the compositions of different patches may differ from each other due to the variability of their initial species occupation. Collectively, the multistability in the local patches might give rise to the regional species diversity in the metacommunity. This intuition leads to our hypothesis that HGT allows the stable coexistence of multiple competing species at regional scale, even when species exclusively outcompete each other in every local population.</p>
<p>To examine this hypothesis, we constructed metacommunities of 100 patches connected by dispersal of microbes. Without loss of generality, we considered a 2-D array of local patches and assumed that the dispersal only occurred between adjacent patches (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>, see Methods for more details). Each local patch carried 10 competing species that exchanged mobile genes with each other. The dynamics of each patch was governed by the same set of parameters but initialized with different species compositions. We then numerically simulated the dynamics of the metacommunity till it reached steady state.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Fig. 4.</label>
<caption><title>HGT promotes the regional diversity in metacommunities of local populations connected by dispersal.</title>
<p><bold>(a)</bold>, A schematic of microbial dispersal within the metacommunity. The filled circles represent different local patches.</p>
<p><bold>(b)</bold>, A metacommunity composed of 100 connected patches was shown as an example. Each local population contained 10 competing species and was randomly initialized with different species compositions. Dispersal occurred between neighboring patches with a rate of 0.001 <italic>hr</italic><sup>−1</sup>. Without HGT, the systems were monostable, resulting in low regional diversity. HGT promotes the regional diversity by the emergence of multistability in each local patch. The collective diversity of the metacommunity was calculated by pooling all the local populations together. Other parameters are <inline-formula><inline-graphic xlink:href="599596v1_inline44.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, <italic>γ</italic> = 1.05, <italic>k</italic> = 0.005 <italic>hr</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>hr</italic><sup>−1</sup>.</p>
<p><bold>(c)</bold>, The regional diversity of a metacommunity increases with HGT rate. We first pooled all local populations together and calculated the total abundance of every species in the metacommunity. Then we quantified the regional diversity using Shannon index. The data were presented as mean ± standard deviation of 10 replicates.</p></caption>
<graphic xlink:href="599596v1_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Without HGT, the metacommunity exhibited strong spatial homogeneity at regional scale (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>). Different patches rested at similar species compositions. In contrast, HGT created a spatial pattern of species distributions across different patches, due to the emergent multistability (<xref rid="fig4" ref-type="fig">Fig. 4b</xref>). To analyze the influence of HGT on regional diversity, we pooled all local populations together and calculated the collective species diversity in the pool using Shannon index. Our results suggested that while local diversity remained low regardless of HGT rate, the regional diversity of microbial species increased with HGT rate (<xref rid="fig4" ref-type="fig">Fig. 4b</xref> and c). The conclusion is applicable for different dispersal rates (Figs. S7 and S8). These results highlight the fundamental role of HGT in community stability and diversity at local and regional scale.</p>
</sec>
<sec id="s2d">
<title>The influences of different confounding factors on the role of HGT in mediating population multistability</title>
<p>Our previous analysis has focused on the role HGT in communities where: (1) MGEs only affect species growth rates and have no influences on inter-species competition; (2) the fitness effects of MGEs (<italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub>) are independent of the host species. To understand how these assumptions affected the prediction and clarify the potential caveats of our conclusion, we further extended our modeling framework by accounting for different confounding factors.</p>
<p>In nature, the horizontal transfer of some genes can change the competition strengths between different species. For instance, the sharing of many mobile genes can promote niche overlapping, leading to an increase of competition strength<sup><xref ref-type="bibr" rid="c31">31</xref>,<xref ref-type="bibr" rid="c32">32</xref></sup>. Some mobile genes encode public goods that benefit the host’s neighboring species<sup><xref ref-type="bibr" rid="c33">33</xref>,<xref ref-type="bibr" rid="c34">34</xref></sup>. HGT of these genes will reduce the strength of interspecies competition. To understand how the transfer of these genes would influence community bistability, we adapted the previous model by considering the dynamic change of competition strength during HGT (see Supplementary Materials for more details). In particular, for two-species populations, we divided the interspecies competitions into two components: the basal competition strengths (<italic>γ</italic><sub>1</sub> and <italic>γ</italic><sub>2</sub>) and the added parts by HGT (<italic>δ</italic><sub>1</sub> and <italic>δ</italic><sub>2</sub>). The overall competition strength was calculated as <inline-formula><inline-graphic xlink:href="599596v1_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v1_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, respectively. Positive <italic>δ</italic> ‘s mean HGT promotes the inter-species competition, while negative <italic>δ</italic> ‘s mean HGT reduces competition. Numerical simulations with randomized parameters suggested that when <italic>δ</italic>’s were positive, HGT still promoted the bistability, whereas if <italic>δ</italic>’s were negative, gene transfer would reduce the chance of bistability (<xref rid="fig5" ref-type="fig">Fig. 5a-d</xref>). We further extended our analysis to multispecies communities and calculated the number of stable states. As shown in <xref rid="fig5" ref-type="fig">Fig. 5e</xref> and <xref rid="fig5" ref-type="fig">f</xref>, the number of stable states increases with HGT rate when MGEs promotes competition, while decreases with HGT rate when MGEs reduces competition.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Fig. 5.</label>
<caption><title>The effects of HGT on population multistability when MGEs promote or reduce competition.</title>
<p><bold>(a-b)</bold>, The schematics of HGT promoting or reducing competition.</p>
<p><bold>(c)</bold>, For populations of two species, when MGEs promote competition, increasing HGT rate enlarged the area of bistability region in the phase diagram. Here, <italic>δ</italic> describes the effect of mobile genes on the competition strength. Positive <italic>δ</italic> represents HGT promoting competition. In numerical simulations, we tested three different <italic>δ</italic> values (marked in different colors). When calculating the area of bistability region, we randomized <italic>μ</italic><sub>1</sub> and <italic>μ</italic><sub>2</sub> 500 times between 0 and 1 hr<sup>-1</sup> following uniform distributions while keeping <inline-formula><inline-graphic xlink:href="599596v1_inline45.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v1_inline46.gif" mime-subtype="gif" mimetype="image"/></inline-formula> constants. For each pair of growth rates, we randomized the initial abundance of each species 200 times between 0 and 1 following uniform distributions. The system was monostable if all initializations led to the same steady state. Otherwise, the system was bistable. Then we calculated the fraction of growth rate combinations that generated bistability out of the 500 random combinations. Other parameters are <italic>γ</italic><sub>1</sub> = <italic>γ</italic><sub>2</sub> = 1.1, <italic>k</italic> = 0.005 <italic>h</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>h</italic><sup>−1</sup>.</p>
<p><bold>(d)</bold>, When MGEs reduce competition, the area of bistability region decreases with HGT rate. Three negative <italic>δ</italic> values were tested and shown as examples here.</p>
<p><bold>(e)</bold>, For populations of 5 species, when MGEs promote competition, the number of stable states increases with HGT rate. We calculated the number of stable states by randomly initializing the species abundances 500 times. Then we simulated the steady states and clustered them into different attractors by applying a threshold of 0.05 on their Euclidean distances. The data were presented as mean ± standard deviation of 10 replicates. Each replicate corresponds to a different combination of randomized species growth rates. Other parameters are <italic>γ</italic><sub><italic>i</italic>,<italic>j</italic></sub> = 1.1, <italic>k</italic> = 0.005 <italic>h</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>h</italic><sup>−1</sup>, <italic>δ</italic> = 0.5.</p>
<p><bold>(f)</bold>, When MGEs reduce competition, the number of stable states decrease with HGT rate. The data were presented as mean ± standard deviation of 10 replicates. <italic>δ</italic> = −0.5 was used in the simulation.</p></caption>
<graphic xlink:href="599596v1_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>In previous analysis, we also assumed that the effects of MGEs on host growth (<italic>λ</italic><sub>1</sub> and <italic>λ</italic><sub>2</sub>) were independent of the host species. In nature, however, the same MGE can have different fitness effects in different genomic backgrounds, a phenomenon called epistasis<sup><xref ref-type="bibr" rid="c35">35</xref>-<xref ref-type="bibr" rid="c38">38</xref></sup>. There are two types of epistasis: magnitude epistasis, where the host genomic background only affects the magnitude but not the sign of <italic>λ</italic> value, and sign epistasis, where the same MGE is burdensome in one species while beneficial in the other host. The model can be readily extended to account for these two types of epistasis (see Supplementary Materials for more details). In particular, we dissected the growth rates <italic>μ</italic><sub>1</sub> and <italic>μ</italic><sub>2</sub> into two components: the basal growth rate (<inline-formula><inline-graphic xlink:href="599596v1_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v1_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula>), and the fitness effects (<italic>λ</italic><sub>11</sub> and <italic>λ</italic><sub>22</sub>) of the mobilizable genes. The growth rates of <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> were calculated as <italic>μ</italic><sub>1</sub>(1 + <italic>λ</italic><sub>12</sub>) and <italic>μ</italic><sub>2</sub>(1 + <italic>λ</italic><sub>21</sub>), respectively. Here <italic>λ</italic><sub><italic>ij</italic></sub> (<italic>i, j</italic> = 1,2) stands for the fitness effects of the <italic>j</italic>-th mobile gene in the <italic>i</italic>-th species. Without epistasis, the fitness effects are independent of the host species (<italic>λ</italic><sub>11</sub> = <italic>λ</italic><sub>21</sub> and <italic>λ</italic><sub>22</sub> = <italic>λ</italic><sub>12</sub>). The epistasis can be quantified by two ratios: <italic>ξ</italic><sub>1</sub> = <italic>λ</italic><sub>21</sub>/<italic>λ</italic><sub>11</sub> and <italic>ξ</italic><sub>2</sub> = <italic>λ</italic><sub>12</sub>/<italic>λ</italic><sub>22</sub>. <italic>ξ</italic><sub>1</sub> &gt; 0 and <italic>ξ</italic><sub>2</sub> &gt; 0 represent magnitude epistasis, whereas <italic>ξ</italic><sub>1</sub> &lt; 0 or <italic>ξ</italic><sub>2</sub> &lt; 0 represent the sign epistasis. We carried out additional numerical simulations to evaluate how different epistasis types influence the role of HGT in community stability. Our results suggested that with magnitude epistasis, HGT still enlarged the area of bistability region (<xref rid="fig6" ref-type="fig">Fig. 6a</xref> and <xref rid="fig6" ref-type="fig">b</xref>). In contrast, sign epistasis overturned HGT’s role on community stability: with sign epistasis, increasing gene transfer rate reduced the area of bistability region (<xref rid="fig6" ref-type="fig">Fig. 6c</xref> and <xref rid="fig6" ref-type="fig">d</xref>). These results suggest that MGE epistasis might add another layer of complexities into the interplay between HGT and community stability.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Fig. 6.</label>
<caption><title>The influence of epistasis on the role of HGT in mediating population bistability.</title>
<p><bold>(a-b)</bold> With magnitude epistasis, increasing HGT rate still promotes bistability in populations of two competing species.</p>
<p><bold>(c-d)</bold> With sign epistasis, increasing HGT rate reduces the area of bistability region. For each type of epistasis, we considered two scenarios. In a and c, host genetic background influences the fitness effect of only one MGE, while in b and d, host genetic background influences both MGEs. <italic>ξ</italic><sub>1</sub> and <italic>ξ</italic><sub>2</sub> are defined as <italic>λ</italic><sub>21</sub>/<italic>λ</italic><sub>11</sub> and <italic>λ</italic><sub>12</sub>/<italic>λ</italic><sub>22</sub>, respectively. <italic>ξ</italic><sub>1</sub> &gt; 0 and <italic>ξ</italic><sub>2</sub> &gt; 0 represent magnitude epistasis, while <italic>ξ</italic><sub>1</sub> &lt; 0 or <italic>ξ</italic><sub>2</sub> &lt; 0 represents the sign epistasis. Other parameters are <italic>γ</italic><sub>1</sub> = <italic>γ</italic><sub>2</sub> = 1.1, <italic>k</italic> = 0.005 <italic>h</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>h</italic><sup>−1</sup>.</p></caption>
<graphic xlink:href="599596v1_fig6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>The fitness effect of an MGE can be extreme in some cases. For instance, under strong antibiotic selection, only cells carrying the antibiotic resistant genes (ARGs) can survive. To examine whether our conclusion is still applicable in this scenario, we generalized our model by considering the transfer of an ARG in a population under strong antibiotic selection (see Supplementary Materials for more details). Specifically, we assumed that the ARG was initially carried by one species in the populations. Without HGT, only the donor species carrying the ARG can survive due to antibiotic selection (<xref rid="fig7" ref-type="fig">Fig. 7a</xref>). In this case, the system will always be monostable regardless of the initial species compositions. With HGT, the ARGs can be transferred to other species, creating chances for other species to survive (<xref rid="fig7" ref-type="fig">Fig. 7b</xref>). To understand how HGT affects community stability under this condition, we first analyzed the phase diagram of the two-species population. Our simulation results suggested that bistability became possible when there existed gene transfer and increasing HGT rate in general enlarged the bistability area (<xref rid="fig7" ref-type="fig">Fig. 7c</xref> and <xref rid="fig7" ref-type="fig">d</xref>). Here, without loss of generality we assumed that the ARG was initially carried only by species 1. Bistability was more feasible when <italic>μ</italic><sub>2</sub> &gt; <italic>μ</italic><sub>1</sub> (<xref rid="fig7" ref-type="fig">Fig. 7c</xref>), suggesting that the effect of HGT on promoting bistability will be stronger when the weak competitor acts as the ARG donor. We further analyzed the number of stable states in complex communities transferring an ARG. As shown in <xref rid="fig7" ref-type="fig">Fig. 7e</xref> and f, for these populations under antibiotic selection, increasing transfer rate of the ARG also promoted the emergence of multistability, suggesting the general applicability of our prediction in this scenario.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Fig. 7.</label>
<caption><title>The horizontal transfer of ARGs creates chances of multistability for communities under strong antibiotic selection.</title>
<p><bold>(a-b)</bold>, The schematics of communities under strong antibiotic selection. Without HGT, only the donor species carrying the ARG can survive. HGT allows the other species to acquire ARG from the donor, creating opportunities for the other species to survive under antibiotic treatments.</p>
<p><bold>(c)</bold>, The phase diagram of two-species populations transferring an ARG. Different combinations of <italic>μ</italic><sub>1</sub> and <italic>μ</italic><sub>2</sub> between 0 and 1 <italic>hr</italic><sup>−1</sup> were tested. All combinations of <italic>μ</italic><sub>1</sub> and <italic>μ</italic><sub>2</sub> that led to bistability were marked in blue in the diagram. Other parameters are <italic>γ</italic> = 1.1, <italic>k</italic> = 0.005 <italic>hr</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>hr</italic><sup>−1</sup>, <inline-formula><inline-graphic xlink:href="599596v1_inline47.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Here, we assumed that the ARG was initially carried only by species 1. Bistability was more feasible when <italic>μ</italic><sub>2</sub> &gt; <italic>μ</italic><sub>1</sub>.</p>
<p><bold>(d)</bold>, Increasing HGT rate enlarges the area of bistability region in the phase diagram of two competing species transferring an ARG. Three different competition strengths were tested (marked in different colors).</p>
<p><bold>(e-f)</bold>, For communities of 5 or 8 species under antibiotic selection, increasing HGT rate of an ARG promotes the emergence of alternative stable states. We calculated the number of stable states by randomly initializing the species abundances 500 times. Then we simulated the steady states and clustered them into different attractors. The data were presented as mean ± standard deviation of 10 replicates. Each replicate corresponds to a different combination of randomized species growth rates. Other parameters are <italic>γ</italic><sub><italic>i</italic>,<italic>j</italic></sub> = 1.5, <italic>k</italic> = 0.005 <italic>h</italic><sup>−1</sup>, <italic>D</italic> = 0.2 <italic>h</italic><sup>−1</sup>.</p></caption>
<graphic xlink:href="599596v1_fig7.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Our work predicts that in many scenarios horizontal gene flow promotes multistability in communities of competing microbes. At the scale of local populations, the emergence of alternative stable states undermines the global stability of the community, making the system less resilient to perturbations on species abundances and creating greater opportunities for regime shifts. In metacommunities, gene flow creates spatial heterogeneity of species compositions in different patches. Despite the low diversity in every local patch, HGT-driven multistability creates substantial diversity at regional scale. In microbial ecology, how microbes competing for a limited number of resources stably coexist has been a long-standing puzzle<sup><xref ref-type="bibr" rid="c39">39</xref>,<xref ref-type="bibr" rid="c40">40</xref></sup>. Our results highlight the importance of considering gene exchange when addressing this fundamental challenge.</p>
<p>While this work predicts the potential role of HGT in microbiota diversity and stability, several caveats need to be considered when applying this prediction. For MGEs with sign epistasis, or MGEs that relax interspecies competitions, HGT might reduce the number of stable states. The relative importance of gene flow in a real community might also be context dependent. The effect of HGT in promoting multistability might be stronger between species with intense competition and similar fitness. In environments with high cell density and abundant MGEs, such as mammal gut, the role of HGT will also be more prominent<sup><xref ref-type="bibr" rid="c41">41</xref></sup>. In contrast, the influence of HGT on community multistability might become less important in populations with poor cell density and slow gene transfer. Nevertheless, by comparison with empirical estimates of plasmid conjugation rates from a previous study<sup><xref ref-type="bibr" rid="c42">42</xref></sup>, the HGT rates in our analysis are biologically relevant in a variety of natural environments (Methods).</p>
<p>Previous studies documented the presence of multiple alternative community types in soil<sup><xref ref-type="bibr" rid="c15">15</xref></sup>, human vaginal, gut and oral microbiomes<sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c43">43</xref>,<xref ref-type="bibr" rid="c44">44</xref></sup>. In particular, multiple groups of bacteria in human gut exhibit robust bistable abundance distributions, resulting in over 32 different stable state combinations<sup><xref ref-type="bibr" rid="c45">45</xref></sup>. Our results provide a plausible explanation for the large number of community types in these populations, even though our interpretation doesn’t exclude other mechanisms including gradients of environmental factors<sup><xref ref-type="bibr" rid="c1">1</xref></sup>. Disentangling the contributions of HGT from the other factors in diverse natural microbiomes is a promising topic for future research.</p>
<p>Controlling the multistability of complex microbiota has important applications in human health. For instance, in gut microbiome, the development of unhealthy stable states is closely related to many diseases such as obesity, type 2 diabetes mellitus and gastrointestinal disorders<sup><xref ref-type="bibr" rid="c46">46</xref>-<xref ref-type="bibr" rid="c48">48</xref></sup>. Strategies have been developed to overcome the resilience of unhealthy states, including fecal transplantation or supplementation with probiotics<sup><xref ref-type="bibr" rid="c18">18</xref></sup>. Our work predicts that the horizontal transfer of MGEs such as plasmids might be an additional mechanism for the emergence of the unhealthy states. Indeed, human gut is a ‘hotspot’ of gene flow<sup><xref ref-type="bibr" rid="c41">41</xref></sup>. Therefore, inhibiting the MGE spread using small molecules might offer new opportunities to reshape the stability landscape and narrow down the attraction domains of the disease states<sup><xref ref-type="bibr" rid="c49">49</xref>,<xref ref-type="bibr" rid="c50">50</xref></sup>.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Modeling framework of two competing species sharing mobile genes</title>
<p>We used a mathematical model developed in a previous work to analyze the population dynamics of two competing species transferring mobile genes with fitness effects<sup><xref ref-type="bibr" rid="c27">27</xref></sup>. Briefly, the model includes four ordinary differential equations (ODEs):
<disp-formula id="eqn1">
<graphic xlink:href="599596v1_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn2">
<graphic xlink:href="599596v1_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn3">
<graphic xlink:href="599596v1_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn4">
<graphic xlink:href="599596v1_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p><italic>S</italic><sub>1</sub> and <italic>S</italic><sub>2</sub> are the abundances of the two species. <italic>γ</italic><sub>1</sub> and <italic>γ</italic><sub>2</sub> describe the strengths of interspecies competition. <italic>N</italic><sub><italic>m</italic></sub> is the maximum carrying capacity, and <italic>D</italic> is the dilution rate. <italic>P</italic><sub><italic>i</italic></sub> (<italic>i</italic> = 1, 2) represents the abundance of the subpopulation in the <italic>i</italic>-th species that acquires the mobilizable genes from its competitor. <italic>μ</italic><sub><italic>i</italic></sub> represents the maximum growth rate of the <italic>i</italic>-th species when interspecies HGT is absent. <italic>μ</italic><sub><italic>i</italic></sub> is calculated as <inline-formula><inline-graphic xlink:href="599596v1_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula> where <inline-formula><inline-graphic xlink:href="599596v1_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the basal growth rate determined by the non-mobilizable genes and <italic>λ</italic><sub><italic>i</italic></sub> is the fitness effect of the mobile genes. Interspecies gene flow allows each species to acquire mobile genes from its competitor, resulting in the dynamic change of the effective species growth rates <inline-formula><inline-graphic xlink:href="599596v1_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, which is calculated as: <inline-formula><inline-graphic xlink:href="599596v1_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v1_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. <inline-formula><inline-graphic xlink:href="599596v1_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v1_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula> stand for HGT rates. Here, we assumed that intraspecies and interspecies transfer occurred at the same rates. <italic>k</italic><sub>1</sub> and <italic>k</italic><sub>2</sub> are the loss rates of the mobile genes.</p>
<p>Let <italic>s</italic><sub>1</sub> = <italic>S</italic><sub>1</sub>/<italic>N</italic><sub><italic>m</italic></sub>, <italic>s</italic><sub>2</sub> = <italic>S</italic><sub>2</sub>/<italic>N</italic><sub><italic>m</italic></sub>, <italic>p</italic><sub>1</sub> = <italic>P</italic><sub>1</sub>/<italic>N</italic><sub><italic>m</italic></sub> and <italic>p</italic><sub>2</sub> = <italic>P</italic><sub>2</sub>/<italic>N</italic><sub><italic>m</italic></sub>. The model can be further simplified as
<disp-formula id="eqn5">
<graphic xlink:href="599596v1_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn6">
<graphic xlink:href="599596v1_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn7">
<graphic xlink:href="599596v1_eqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn8">
<graphic xlink:href="599596v1_eqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Here, <italic>s</italic><sub>1</sub>, <italic>s</italic><sub>2</sub>, <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> are dimensionless. η<sub><italic>i</italic></sub> is related with <inline-formula><inline-graphic xlink:href="599596v1_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula> by <inline-formula><inline-graphic xlink:href="599596v1_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Therefore, the unit of η<sub>1</sub> and η<sub>2</sub> is <italic>hour</italic><sup>−1</sup>. Without HGT, <italic>p</italic><sub>1</sub> and <italic>p</italic><sub>2</sub> become consistently 0, and the model is equivalent to the classic Lotka-Volterra (LV) framework:
<disp-formula id="eqn9">
<graphic xlink:href="599596v1_eqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn10">
<graphic xlink:href="599596v1_eqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s4b">
<title>Stability analysis of the classic LV model</title>
<p>The classic LV model has four fixed points:<inline-formula><inline-graphic xlink:href="599596v1_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The Jacobian matrix of each fixed point can be calculated as<inline-formula><inline-graphic xlink:href="599596v1_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where <inline-formula><inline-graphic xlink:href="599596v1_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v1_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are the species abundances at each fixed point.</p>
<p>The system is bistable only when ℊ<sub>2</sub> and ℊ<sub>3</sub> are both stable. The Jacobian matrix of ℊ<sub>2</sub> is <inline-formula><inline-graphic xlink:href="599596v1_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The eigenvalues of <italic>J</italic><sub>2</sub> can be obtained as <inline-formula><inline-graphic xlink:href="599596v1_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <italic>D</italic> – <italic>μ</italic><sub>2</sub>. ℊ<sub>2</sub> is stable when both eigenvalues are negative, which leads to <italic>γ</italic><sub>2</sub> &gt; <italic>ϕ</italic><sub>1</sub>/<italic>ϕ</italic><sub>2</sub> where <inline-formula><inline-graphic xlink:href="599596v1_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v1_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Similarly, ℊ<sub>3</sub> is stable when <italic>γ</italic><sub>1</sub> &gt; <italic>ϕ</italic><sub>2</sub>/<italic>ϕ</italic><sub>1</sub>.</p>
<p>Therefore, the condition for the system being bistable is <italic>γ</italic><sub>2</sub> &gt; <italic>ϕ</italic><sub>1</sub>/<italic>ϕ</italic><sub>2</sub> and <italic>γ</italic><sub>1</sub> &gt; <italic>ϕ</italic><sub>2</sub>/<italic>ϕ</italic><sub>1</sub>.</p>
</sec>
<sec id="s4c">
<title>Bistability analysis of two-species populations by numerical simulations</title>
<p>We performed numerical simulations to determine the bistability of a population consisting of two competing species transferring mobile genes. Specifically, for a system with given parameters, we randomly initialized the species abundances between 0 and 1 following uniform distributions for 200 times. Then we simulated the dynamics of each population till the abundance of every species reached equilibrium, and we treated it as a steady state. We grouped the 200 steady states into different attractors by applying the threshold of 0.01. Two steady states with their Euclidean distance smaller than the threshold belonged to the same group. The Euclidean distance was calculated as <inline-formula><inline-graphic xlink:href="599596v1_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula> where <italic>k</italic> is the species index and <italic>s</italic><sub><italic>i</italic>,<italic>k</italic></sub> represents the abundance of the <italic>k</italic>-th species in the <italic>i</italic>-th steady state.</p>
</sec>
<sec id="s4d">
<title>Theoretical framework of multiple competing species transferring mobile genes</title>
<p>For a community of <italic>m</italic> competing species that share mobile genes with each other, the modeling framework consists of two groups of ODEs:
<disp-formula id="eqn11">
<graphic xlink:href="599596v1_eqn11.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn12">
<graphic xlink:href="599596v1_eqn12.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<italic>s</italic><sub><italic>i</italic></sub> is the abundance of the <italic>i</italic>-th species. <italic>p</italic><sub><italic>ij</italic></sub> is the size of the subpopulation in the <italic>i</italic>-th species that acquires <italic>s</italic><sub><italic>j</italic></sub>-originated mobile genes. <italic>γ</italic><sub><italic>ij</italic></sub> is the negative interaction that <italic>s</italic><sub><italic>j</italic></sub> imposes on the <italic>i</italic>-th species. <italic>D</italic> is the dilution rate. <inline-formula><inline-graphic xlink:href="599596v1_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, the effective growth rate of <italic>s</italic><sub><italic>i</italic></sub>, is calculated by <inline-formula><inline-graphic xlink:href="599596v1_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is defined as <inline-formula><inline-graphic xlink:href="599596v1_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula> where <inline-formula><inline-graphic xlink:href="599596v1_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the basal growth rate, <italic>λ</italic><sub><italic>ij</italic></sub> is the fitness effect of the <italic>s</italic><sub><italic>j</italic></sub>-originated mobile genes in the <italic>i</italic>-th species. η<sub><italic>jki</italic></sub> is the transfer rate of the <italic>s</italic><sub><italic>j</italic></sub>-originated genes from species <italic>k</italic> to species <italic>i. k</italic><sub><italic>ij</italic></sub> is the gene loss rate.</p>
</sec>
<sec id="s4e">
<title>Analysis of multistability of complex communities</title>
<p>For a population of <italic>m</italic> species with given niches and kinetic parameters, we initialized the system 500 times in the ranges of 0 &lt; <italic>s</italic><sub><italic>i</italic></sub> &lt; 1 following uniform distributions. The initial conditions for <italic>p</italic><sub><italic>ij</italic></sub>’s are <italic>p</italic><sub><italic>ii</italic></sub> = <italic>s</italic><sub><italic>i</italic></sub> and <italic>p</italic><sub><italic>ij</italic></sub> = 0 (<italic>i</italic> ≠ <italic>j</italic>). Then the dynamics of each population was simulated for 2000 hours till the system reached the steady state. For each steady state we obtained the corresponding species composition and grouped the 500 solutions into different stable states based on their Euclidean distances.</p>
</sec>
<sec id="s4f">
<title>Niche-based model of multi-species communities</title>
<p>For a community consisting of <italic>m</italic> competing species, let the number of niches be <italic>l</italic>. Each niche has a maximum carrying capacity <inline-formula><inline-graphic xlink:href="599596v1_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Each species lives in one of the niches. Let <italic>M</italic> be the map from species index to the index of its niche. <italic>M</italic><sub><italic>i</italic></sub> = <italic>k</italic> means that the <italic>i</italic>- th species lives in the <italic>k</italic>-th niche. For species <italic>i</italic> and <italic>j</italic>, if <italic>M</italic><sub><italic>i</italic></sub> = <italic>M</italic><sub><italic>j</italic></sub>, these two species belong to the same niche and compete with each other. Species from different niche do not directly interact. Therefore, the model becomes:
<disp-formula id="eqn13">
<graphic xlink:href="599596v1_eqn13.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn14">
<graphic xlink:href="599596v1_eqn14.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>In simulations, the number of niches was randomized between 2 and <italic>m</italic>/2. The maximum carrying capacity of each niche was randomized between 0 and 1 following uniform distributions. Then each species was randomly allocated into one of the niches.</p>
</sec>
<sec id="s4g">
<title>Theoretical framework of metacommunity dynamics</title>
<p>Consider a metacommunity composed of <italic>u</italic> × <italic>v</italic> local patches. The location of each patch can be described by two coordinates [<italic>a, b</italic>] (<italic>a</italic> = 1,2, …, <italic>u</italic> and <italic>b</italic> = 1,2, …, <italic>v</italic>). Let ω be the dispersal rate between the adjacent patches. The dynamics of the metacommunity can then be described by generalizing equations (11) and (12) to each local patch:
<disp-formula id="eqn15">
<graphic xlink:href="599596v1_eqn15.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="eqn16">
<graphic xlink:href="599596v1_eqn16.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>For the patch located at [<italic>a, b</italic>], <italic>s</italic><sub><italic>a</italic>,<italic>b</italic>,<italic>i</italic></sub> is the abundance of the <italic>i</italic>-th species, and <italic>p</italic><sub><italic>a</italic>,<italic>b</italic>,<italic>i</italic>,<italic>j</italic></sub> is the size of the subpopulation in the <italic>i</italic>-th species that acquires <italic>s</italic><sub><italic>j</italic></sub>-originated mobile genes. The effective growth rate <inline-formula><inline-graphic xlink:href="599596v1_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is calculated as<inline-formula><inline-graphic xlink:href="599596v1_inline31.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
<p><inline-formula><inline-graphic xlink:href="599596v1_inline32.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v1_inline33.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are the gains of <italic>s</italic><sub><italic>a</italic>,<italic>b</italic>,<italic>i</italic></sub> and <italic>p</italic><sub><italic>a</italic>,<italic>b</italic>,<italic>i</italic>,<italic>j</italic></sub> by dispersal, respectively. We assumed that microbial dispersal only occurred between adjacent patches. Therefore, <inline-formula><inline-graphic xlink:href="599596v1_inline34.gif" mime-subtype="gif" mimetype="image"/></inline-formula> was calculated by summing the dispersal terms at four directions: left, right, up, and down. The left component can be calculated as
<disp-formula id="ueqn1">
<graphic xlink:href="599596v1_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
<p>Similarly, <inline-formula><inline-graphic xlink:href="599596v1_inline35.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="599596v1_inline36.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is calculated as:
<disp-formula id="ueqn2">
<graphic xlink:href="599596v1_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<inline-formula><inline-graphic xlink:href="599596v1_inline37.gif" mime-subtype="gif" mimetype="image"/></inline-formula> can then be obtained as <inline-formula><inline-graphic xlink:href="599596v1_inline38.gif" mime-subtype="gif" mimetype="image"/></inline-formula> can be formulated in the similar way.</p>
</sec>
<sec id="s4h">
<title>The collective species diversity in a metacommunity</title>
<p>To analyze the total species diversity in a metacommunity, we first calculated the total abundance of each species across all patches: <italic>s</italic><sub><italic>i</italic></sub> = Σ<sub><italic>a</italic>=1,2,…,<italic>u</italic></sub> Σ<sub><italic>b</italic>=1,2,…,<italic>v</italic></sub> <italic>s</italic><sub><italic>a</italic>,<italic>b</italic>,<italic>i</italic></sub>. Then we measured the diversity using Shannon index, a common metric used in ecology. Shannon index can be calculated as<inline-formula><inline-graphic xlink:href="599596v1_inline39.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. <italic>s</italic><sub><italic>T</italic></sub> is the total species abundance: <inline-formula><inline-graphic xlink:href="599596v1_inline40.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
</sec>
<sec id="s4i">
<title>Biological relevance of our analysis</title>
<p>The empirically measured gene transfer rates (denoted as η<sup><italic>c</italic></sup>, with the unit of <italic>cells</italic><sup>−1</sup> · <italic>mL</italic> · <italic>hour</italic><sup>−1</sup>) should be multiplied by <italic>N</italic><sub><italic>m</italic></sub>, the maximum carrying capacity of the population, before being used our model. Therefore, the transfer rate η in our analysis are several orders of magnitude higher than the experimentally measured rates<sup><xref ref-type="bibr" rid="c51">51</xref>,<xref ref-type="bibr" rid="c52">52</xref></sup>. In this work, we focused on HGT rate in the range of 0 &lt; η<sub><italic>i</italic></sub> &lt; 0.4 <italic>hour</italic><sup>−1</sup>. Whether this range is biologically relevant depends on <italic>N</italic><sub><italic>m</italic></sub> of the population. Considering the typical estimates of plasmid transfer rates cross species (10<sup>−13</sup> <italic>cells</italic><sup>−1</sup> · <italic>mL</italic> · <italic>hour</italic><sup>−1</sup>, from <italic>Klebsiella pneumoniae</italic> to <italic>Escherichia coli</italic>) and within species (10<sup>−7</sup> <italic>cells</italic><sup>−1</sup> · <italic>mL</italic> · <italic>hour</italic><sup>−1</sup>, between <italic>E. coli</italic> strains) provided by a previous study<sup><xref ref-type="bibr" rid="c51">51</xref></sup>, HGT rates in our analysis are relevant in various environments from human colon (∼10<sup><xref ref-type="bibr" rid="c12">12</xref></sup> cells per gram) <sup><xref ref-type="bibr" rid="c53">53</xref></sup> to deep oceanic subsurface (10<sup><xref ref-type="bibr" rid="c6">6</xref></sup>∼10<sup><xref ref-type="bibr" rid="c8">8</xref></sup> cells per gram)<sup><xref ref-type="bibr" rid="c54">54</xref></sup>.</p>
</sec>
</sec>
</body>
<back>
<sec id="s5">
<title>Code Availability</title>
<p>All the codes and source data associated with the numerical simulations and analysis of this manuscript are available at the Github repository: (<ext-link ext-link-type="uri" xlink:href="https://github.com/twang1993/MultistabilityByHGT">https://github.com/twang1993/MultistabilityByHGT</ext-link>).</p>
</sec>
<ack>
<title>Acknowledgements</title>
<p>This work is supported by Shenzhen Institute of Synthetic Biology Scientific Research Program (Grant No. HSE199011086). The funder had no role in study design, data collection and analysis, the decision to publish, or the preparation of the manuscript.</p>
</ack>
<sec id="s6">
<title>Declaration of interests</title>
<p>The authors declare no competing interests.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gonze</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Lahti</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Raes</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Faust</surname>, <given-names>K.</given-names></string-name></person-group> <article-title>Multi-stability and the origin of microbial community types</article-title>. <source>The ISME Journal</source> <volume>11</volume>, <fpage>2159</fpage>–<lpage>2166</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c2"><label>2</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Arumugam</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Enterotypes of the human gut microbiome</article-title>. <source>Nature</source> <volume>473</volume>, <fpage>174</fpage>–<lpage>180</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c3"><label>3</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gibson</surname>, <given-names>T. E.</given-names></string-name>, <string-name><surname>Bashan</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Cao</surname>, <given-names>H.-T.</given-names></string-name>, <string-name><surname>Weiss</surname>, <given-names>S. T.</given-names></string-name> &amp; <string-name><surname>Liu</surname>, <given-names>Y.-Y.</given-names></string-name></person-group> <article-title>On the origins and control of community types in the human microbiome</article-title>. <source>PLoS Computational Biology</source> <volume>12</volume>, <fpage>e1004688</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c4"><label>4</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Estrela</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Functional attractors in microbial community assembly</article-title>. <source>Cell Systems</source> <volume>13</volume>, <fpage>29</fpage>-<lpage>42.e27</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c5"><label>5</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Chaparro-Pedraza</surname>, <given-names>P. C.</given-names></string-name> &amp; <string-name><surname>de Roos</surname>, <given-names>A. M.</given-names></string-name></person-group> <article-title>Ecological changes with minor effect initiate evolution to delayed regime shifts</article-title>. <source>Nature Ecology and Evolution</source> <volume>4</volume>, <fpage>412</fpage>–<lpage>418</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c6"><label>6</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beardmore</surname>, <given-names>R. E.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Drug-mediated metabolic tipping between antibiotic resistant states in a mixed-species community</article-title>. <source>Nature Ecology and Evolution</source> <volume>2</volume>, <fpage>1312</fpage>–<lpage>1320</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c7"><label>7</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amor</surname>, <given-names>D. R.</given-names></string-name>, <string-name><surname>Ratzke</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Gore</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Transient invaders can induce shifts between alternative stable states of microbial communities</article-title>. <source>Science Advances</source> <volume>6</volume>, <fpage>eaay8676</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c8"><label>8</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Relman</surname>, <given-names>D. A.</given-names></string-name></person-group> <article-title>The human microbiome: ecosystem resilience and health</article-title>. <source>Nutrition Reviews</source> <volume>70</volume>, <fpage>S2</fpage>–<lpage>S9</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c9"><label>9</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hartmann</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Six</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Soil structure and microbiome functions in agroecosystems</article-title>. <source>Nature Reviews Earth and Environment</source> <volume>4</volume>, <fpage>4</fpage>–<lpage>18</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c10"><label>10</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The shift of soil microbial community induced by cropping sequence affect soil properties and crop yield</article-title>. <source>Frontiers in Microbiology</source> <volume>14</volume>, <fpage>1095688</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c11"><label>11</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kumar</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Hasty</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Stability, robustness, and containment: preparing synthetic biology for real-world deployment</article-title>. <source>Current Opinion in Biotechnology</source> <volume>79</volume>, <fpage>102880</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c12"><label>12</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fuhrman</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Cram</surname>, <given-names>J. A.</given-names></string-name> &amp; <string-name><surname>Needham</surname>, <given-names>D. M.</given-names></string-name></person-group> <article-title>Marine microbial community dynamics and their ecological interpretation</article-title>. <source>Nature Reviews Microbiology</source> <volume>13</volume>, <fpage>133</fpage>–<lpage>146</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c13"><label>13</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Khazaei</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Metabolic multistability and hysteresis in a model aerobe-anaerobe microbiome community</article-title>. <source>Science Advances</source> <volume>6</volume>, <fpage>eaba0353</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c14"><label>14</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dubinkina</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Fridman</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Pandey</surname>, <given-names>P. P.</given-names></string-name> &amp; <string-name><surname>Maslov</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Multistability and regime shifts in microbial communities explained by competition for essential nutrients</article-title>. <source>Elife</source> <volume>8</volume>, <elocation-id>e49720</elocation-id> (<year>2019</year>).</mixed-citation></ref>
<ref id="c15"><label>15</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fujita</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Alternative stable states, nonlinear behavior, and predictability of microbiome dynamics</article-title>. <source>Microbiome</source> <volume>11</volume>, <fpage>63</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c16"><label>16</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mangal</surname>, <given-names>U.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Multistability and hysteresis in states of oral microbiota: Is it impacting the dental clinical cohort studies?</article-title> <source>Journal of Periodontal Research</source> <volume>58</volume>, <fpage>381</fpage>–<lpage>391</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c17"><label>17</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zaoli</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Grilli</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>A macroecological description of alternative stable states reproduces intra-and inter-host variability of gut microbiome</article-title>. <source>Science Advances</source> <volume>7</volume>, <fpage>eabj2882</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c18"><label>18</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fassarella</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Gut microbiome stability and resilience: elucidating the response to perturbations in order to modulate gut health</article-title>. <source>Gut</source> <volume>70</volume>, <fpage>595</fpage>–<lpage>605</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c19"><label>19</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andersson</surname>, <given-names>D. I.</given-names></string-name> &amp; <string-name><surname>Hughes</surname>, <given-names>D.</given-names></string-name></person-group> <article-title>Antibiotic resistance and its cost: is it possible to reverse resistance?</article-title> <source>Nature Reviews Microbiology</source> <volume>8</volume>, <fpage>260</fpage>–<lpage>271</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c20"><label>20</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van den Berg</surname>, <given-names>N. I.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Ecological modelling approaches for predicting emergent properties in microbial communities</article-title>. <source>Nature Ecology and Evolution</source> <volume>6</volume>, <fpage>855</fpage>–<lpage>865</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c21"><label>21</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Soucy</surname>, <given-names>S. M.</given-names></string-name>, <string-name><surname>Huang</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Gogarten</surname>, <given-names>J. P.</given-names></string-name></person-group> <article-title>Horizontal gene transfer: building the web of life</article-title>. <source>Nature Reviews Genetics</source> <volume>16</volume>, <fpage>472</fpage>–<lpage>482</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c22"><label>22</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bordenstein</surname>, <given-names>S. R.</given-names></string-name> &amp; <string-name><surname>Reznikoff</surname>, <given-names>W. S.</given-names></string-name></person-group> <article-title>Mobile DNA in obligate intracellular bacteria</article-title>. <source>Nature Reviews Microbiology</source> <volume>3</volume>, <fpage>688</fpage>–<lpage>699</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c23"><label>23</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brito</surname>, <given-names>I. L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Mobile genes in the human microbiome are structured from global to individual scales</article-title>. <source>Nature</source> <volume>535</volume>, <fpage>435</fpage>–<lpage>439</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c24"><label>24</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brockhurst</surname>, <given-names>M. A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The ecology and evolution of pangenomes</article-title>. <source>Current Biology</source> <volume>29</volume>, <fpage>R1094</fpage>–<lpage>R1103</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c25"><label>25</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smillie</surname>, <given-names>C. S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Ecology drives a global network of gene exchange connecting the human microbiome</article-title>. <source>Nature</source> <volume>480</volume>, <fpage>241</fpage>–<lpage>244</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c26"><label>26</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gilpin</surname>, <given-names>M. E.</given-names></string-name> &amp; <string-name><surname>Case</surname>, <given-names>T. J.</given-names></string-name></person-group> <article-title>Multiple domains of attraction in competition communities</article-title>. <source>Nature</source> <volume>261</volume>, <fpage>40</fpage>–<lpage>42</lpage> (<year>1976</year>).</mixed-citation></ref>
<ref id="c27"><label>27</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Hong</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Wang</surname>, <given-names>T.</given-names></string-name></person-group> <article-title>Horizontal gene transfer is predicted to overcome the diversity limit of competing microbial species</article-title>. <source>Nature Communications</source> <volume>15</volume>, <fpage>800</fpage>, doi:<pub-id pub-id-type="doi">10.1038/s41467-024-45154-w</pub-id> (<year>2024</year>).</mixed-citation></ref>
<ref id="c28"><label>28</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Finlay</surname>, <given-names>B. B.</given-names></string-name> &amp; <string-name><surname>Medzhitov</surname>, <given-names>R.</given-names></string-name></person-group> <article-title>Host-microbe interactions: fulfilling a niche</article-title>. <source>Cell Host and Microbe</source> <volume>1</volume>, <fpage>3</fpage>–<lpage>4</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c29"><label>29</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Leibold</surname>, <given-names>M. A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The metacommunity concept: a framework for multi-scale community ecology</article-title>. <source>Ecology Letters</source> <volume>7</volume>, <fpage>601</fpage>–<lpage>613</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c30"><label>30</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Miller</surname>, <given-names>E. T.</given-names></string-name>, <string-name><surname>Svanbäck</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Bohannan</surname>, <given-names>B. J.</given-names></string-name></person-group> <article-title>Microbiomes as metacommunities: understanding host-associated microbes through metacommunity ecology</article-title>. <source>Trends in Ecology and Evolution</source> <volume>33</volume>, <fpage>926</fpage>–<lpage>935</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c31"><label>31</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bonham</surname>, <given-names>K. S.</given-names></string-name>, <string-name><surname>Wolfe</surname>, <given-names>B. E.</given-names></string-name> &amp; <string-name><surname>Dutton</surname>, <given-names>R. J.</given-names></string-name></person-group> <article-title>Extensive horizontal gene transfer in cheese-associated bacteria</article-title>. <source>Elife</source> <volume>6</volume>, <elocation-id>e22144</elocation-id> (<year>2017</year>).</mixed-citation></ref>
<ref id="c32"><label>32</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Caro-Quintero</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Konstantinidis</surname>, <given-names>K. T.</given-names></string-name></person-group> <article-title>Inter-phylum HGT has shaped the metabolism of many mesophilic and anaerobic bacteria</article-title>. <source>The ISME journal</source> <volume>9</volume>, <fpage>958</fpage>–<lpage>967</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c33"><label>33</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mc Ginty</surname>, <given-names>S.</given-names></string-name> É., <string-name><surname>Lehmann</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Brown</surname>, <given-names>S. P.</given-names></string-name> &amp; <string-name><surname>Rankin</surname>, <given-names>D. J.</given-names></string-name></person-group> <article-title>The interplay between relatedness and horizontal gene transfer drives the evolution of plasmid-carried public goods</article-title>. <source>Proceedings of the Royal Society B: Biological Sciences</source> <volume>280</volume>, <fpage>20130400</fpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c34"><label>34</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dimitriu</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Genetic information transfer promotes cooperation in bacteria</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>111</volume>, <fpage>11103</fpage>–<lpage>11108</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c35"><label>35</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Acar Kirit</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lagator</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Bollback</surname>, <given-names>J. P.</given-names></string-name></person-group> <article-title>Experimental determination of evolutionary barriers to horizontal gene transfer</article-title>. <source>BMC Microbiology</source> <volume>20</volume>, <fpage>1</fpage>–<lpage>13</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c36"><label>36</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gama</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Zilhão</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Dionisio</surname>, <given-names>F.</given-names></string-name></person-group> <article-title>Plasmid interactions can improve plasmid persistence in bacterial populations</article-title>. <source>Frontiers in Microbiology</source> <volume>11</volume>, <fpage>2033</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c37"><label>37</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Silva</surname>, <given-names>R. F.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Pervasive sign epistasis between conjugative plasmids and drug-resistance chromosomal mutations</article-title>. <source>PLoS Genetics</source> <volume>7</volume>, <fpage>e1002181</fpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c38"><label>38</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>San Millan</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Heilbron</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>MacLean</surname>, <given-names>R. C.</given-names></string-name></person-group> <article-title>Positive epistasis between co-infecting plasmids promotes plasmid survival in bacterial populations</article-title>. <source>The ISME Journal</source> <volume>8</volume>, <fpage>601</fpage>–<lpage>612</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c39"><label>39</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Serván</surname>, <given-names>C. A.</given-names></string-name>, <string-name><surname>Capitán</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Grilli</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Morrison</surname>, <given-names>K. E.</given-names></string-name> &amp; <string-name><surname>Allesina</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Coexistence of many species in random ecosystems</article-title>. <source>Nature Ecology and Evolution</source> <volume>2</volume>, <fpage>1237</fpage>–<lpage>1242</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c40"><label>40</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grilli</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Feasibility and coexistence of large ecological communities</article-title>. <source>Nature Communications</source> <volume>8</volume>, <fpage>14389</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c41"><label>41</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The human microbiome: a hot spot of microbial horizontal gene transfer</article-title>. <source>Genomics</source> <volume>100</volume>, <fpage>265</fpage>–<lpage>270</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c42"><label>42</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kosterlitz</surname>, <given-names>O.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Estimating the transfer rates of bacterial plasmids with an adapted Luria– Delbrück fluctuation analysis</article-title>. <source>PLoS Biology</source> <volume>20</volume>, <fpage>e3001732</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c43"><label>43</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ravel</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Vaginal microbiome of reproductive-age women</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>108</volume>, <fpage>4680</fpage>–<lpage>4687</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c44"><label>44</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ding</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Schloss</surname>, <given-names>P. D.</given-names></string-name></person-group> <article-title>Dynamics and associations of microbial community types across the human body</article-title>. <source>Nature</source> <volume>509</volume>, <fpage>357</fpage>–<lpage>360</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c45"><label>45</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lahti</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Salojärvi</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Salonen</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Scheffer</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>De Vos</surname>, <given-names>W. M.</given-names></string-name></person-group> <article-title>Tipping elements in the human intestinal ecosystem</article-title>. <source>Nature Communications</source> <volume>5</volume>, <fpage>4344</fpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c46"><label>46</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kootte</surname>, <given-names>R. S.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Improvement of insulin sensitivity after lean donor feces in metabolic syndrome is driven by baseline intestinal microbiota composition</article-title>. <source>Cell Metabolism</source> <volume>26</volume>, <fpage>611</fpage>-<lpage>619.e616</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c47"><label>47</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Canfora</surname>, <given-names>E. E.</given-names></string-name>, <string-name><surname>Meex</surname>, <given-names>R. C.</given-names></string-name>, <string-name><surname>Venema</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Blaak</surname>, <given-names>E. E.</given-names></string-name></person-group> <article-title>Gut microbial metabolites in obesity, NAFLD and T2DM</article-title>. <source>Nature Reviews Endocrinology</source> <volume>15</volume>, <fpage>261</fpage>–<lpage>273</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c48"><label>48</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Moustafa</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Genetic risk, dysbiosis, and treatment stratification using host genome and gut microbiome in inflammatory bowel disease</article-title>. <source>Clinical Translational Gastroenterology</source> <volume>9</volume>, <fpage>e132</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c49"><label>49</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Palencia-Gándara</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Conjugation inhibitors effectively prevent plasmid transmission in natural environments</article-title>. <source>MBio</source> <volume>12</volume>, <pub-id pub-id-type="doi">10.1128/mbio.01277-01221</pub-id> (<year>2021</year>).</mixed-citation></ref>
<ref id="c50"><label>50</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fernandez-Lopez</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Unsaturated fatty acids are inhibitors of bacterial conjugation</article-title>. <source>Microbiology</source> <volume>151</volume>, <fpage>3517</fpage>–<lpage>3526</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c51"><label>51</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kosterlitz</surname>, <given-names>O.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Estimating the transfer rates of bacterial plasmids with an adapted Luria– Delbrück fluctuation analysis</article-title>. <source>PLoS Biology</source> <volume>20</volume>, <fpage>e3001732</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c52"><label>52</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lopatkin</surname>, <given-names>A. J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Persistence and reversal of plasmid-mediated antibiotic resistance</article-title>. <source>Nature Communications</source> <volume>8</volume>, <fpage>1689</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c53"><label>53</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dieterich</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Schink</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Zopf</surname>, <given-names>Y.</given-names></string-name></person-group> <article-title>Microbiota in the gastrointestinal tract</article-title>. <source>Medical Sciences</source> <volume>6</volume>, <fpage>116</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c54"><label>54</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Flemming</surname>, <given-names>H.-C.</given-names></string-name> &amp; <string-name><surname>Wuertz</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Bacteria and archaea on Earth and their abundance in biofilms</article-title>. <source>Nature Reviews Microbiology</source> <volume>17</volume>, <fpage>247</fpage>–<lpage>260</lpage> (<year>2019</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99593.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Momeni</surname>
<given-names>Babak</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Boston College</institution>
</institution-wrap>
<city>Chestnut Hill</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This manuscript offers a modeling platform in which horizontal gene transfer (HGT) is incorporated into the ecological dynamics of microbial communities. The investigation is <bold>valuable</bold> as it brings to the forefront a potentially significant process and highlights its implications. However, the investigation in its current form is <bold>incomplete</bold> because it is based on a narrow range of parameters and assumptions. As a result, the scope and relevance of the findings are not fully clear. A more in-depth description of model assumptions and the formulation structure and a more thorough analysis of the impact of different parameters would strengthen the manuscript. This work will be of interest to microbiologists as well as researchers in ecological and evolutionary biology.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99593.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors present a modelling study to test the hypothesis that horizontal gene transfer (HGT) can modulate the outcome of interspecies competition in microbiomes, and in particular promote bistability in systems across scales. The premise is a model developed by the same authors in a previous paper where bistability happens because of a balance between growth rates and competition for a mutual resource pool (common carrying capacity). They show that introducing a transferrable element that gives a &quot;growth rate bonus&quot; expands the region of parameter space where bistability happens. The authors then investigate how often (in terms of parameter space) this bistability occurs across different scales of complexity, and finally under selection for the mobile element (framed as ABR selection).</p>
<p>Strengths:</p>
<p>The authors tackle an important, yet complex, question: how do different evolutionary processes impact the ecology of microbial ecosystems? They do a nice job at increasing the scales of heterogeneity and asking how these impact their main observable: bistability.</p>
<p>Weaknesses:</p>
<p>The author's starting point is their interaction LV model and the manuscript then explores how this model behaves under different scenarios. Because the structure of the model and the underlying assumptions essentially dictate these outcomes, I would expect to see much more focus on how these two aspects relate to the specific scenarios that are discussed. For example:</p>
<p>A key assumption is that the mobile element conveys a multiplicative growth rate benefit (1+lambda). However, the competition between the species is modelled as a factor gamma that modulates the competition for overall resource and thus appears in the saturation term (1+ S1/Nm + gamma2*S2/Nm). This means that gamma changes the perceived abundance of the other species (if gamma &gt; 1, then from the point of view of S1 it looks like there are more S2 than there really are). Most importantly, the relationship between these parameters dictates whether or not there will be bistability (as the authors state).</p>
<p>This decoupling between the transferred benefit and the competition can have different consequences. One of them is that - from the point of view of the mobile element - the mobile element competes at different strengths within the same population compared to between. To what degree introducing such a mobile element modifies the baseline bistability expectation thus strongly depends on how it modifies gamma and lambda.</p>
<p>Thus, this structural aspect needs to be much more carefully presented to help the reader follow how much of the results are just trivial given the model assumptions and which have more of an emergent flavour. From my point of view, this has an important impact on helping the reader understand how the model that the authors present can contribute to the understanding of the question &quot;how microbes competing for a limited number of resources stably coexist&quot;. I do appreciate that this changes the focus of the manuscript from a presentation of simulation results to more of a discussion of mathematical modelling.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99593.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this work, the authors use a theoretical model to study the potential impact of Horizontal Gene Transfer on the number of alternative stable states of microbial communities. For this, they use a modified version of the competitive Lotka Volterra model-which accounts for the effects of pairwise, competitive interactions on species growth-that incorporates terms for the effects of both an added death (dilution) rate acting on all species and the rates of horizontal transfer of mobile genetic elements-which can in turn affect species growth rates. The authors analyze the impact of horizontal gene transfer in different scenarios: bistability between pairs of species, multistability in communities, and a modular structure in the interaction matrix to simulate multiple niches. They also incorporate additional elements to the model, such as spatial structure to simulate metacommunities and modification of pairwise interactions by mobile genetic elements. In almost all these cases, the authors report an increase in either the number of alternative stable states or the parameter region (e.g. growth rate values) in which they occur.</p>
<p>In my opinion, understanding the role of horizontal gene transfer in community multistability is a very important subject. This manuscript is a useful approach to the subject, but I'm afraid that a thorough analysis of the role of different parameters under different scenarios is missing in order to support the general claims of the authors. The authors have extended their analysis to increase their biological relevance, but I believe that the analysis still lacks comprehensiveness.</p>
<p>Understanding the origin of alternative stable states in microbial communities and how often they may occur is an important challenge in microbial ecology and evolution. Shifts between these alternative stable states can drive transitions between e.g. a healthy microbiome and dysbiosis. A better understanding of how horizontal gene transfer can drive multistability could help predict alternative stable states in microbial communities, as well as inspire novel treatments to steer communities towards the most desired (e.g. healthy) stable states.</p>
<p>Strengths:</p>
<p>(1) Generality of the model: the work is based on a phenomenological model that has been extensively used to predict the dynamics of ecological communities in many different scenarios.</p>
<p>(2) The question of how horizontal gene transfer can drive alternative stable states in microbial communities is important and there are very few studies addressing it.</p>
<p>Weaknesses:</p>
<p>(1) There is a need for a more comprehensive analysis of the relative importance of the different model parameters in driving multistability. For example, there is no analysis of the effects of the added death rate in multistability. This parameter has been shown to determine whether a given pair of interacting species exhibits bistability or not (see e.g. Abreu et al 2019 Nature Communications 10:2120). Similarly, each scenario is analyzed for a unique value of species interspecies interaction strength-with the exception of the case for mobile genetic elements affecting interaction strength, which considers three specific values. Considering heterogeneous interaction strengths (e.g. sampling from a random distribution) could also lead to more realistic scenarios - the authors generally considered that all species pairs interact with the same strength. Analyzing a larger range of growth rates effects of mobile genetic elements would also help generalize the results. In order to achieve a more generic assessment of the impact of horizontal gene transfer in driving multistability, its role should be systematically compared to the effects of the rest of the parameters of the model.</p>
<p>(2) The authors previously developed this theoretical model to study the impact of horizontal gene transfer on species coexistence. In this sense, it seems that the authors are exploring a different (stronger interspecies competition) range of parameter values of the same model, which could potentially limit novelty and generality.</p>
<p>(3) The authors analyze several scenarios that, in my opinion, naturally follow from the results and parameter value choices in the first sections, making their analysis not very informative. For example, after showing that horizontal gene transfer can increase multistability both between pairs of species and in a community context, the way they model different niches does not bring significantly new results. Given that the authors showed previously in the manuscript that horizontal gene transfer can impact multistability in a community in which all species interact with each other, one might expect that it will also impact multistability in a larger community made of (sub)communities that are independent of (not interacting with) each-which is the proposed way for modelling niches. A similar argument can be made regarding the analysis of (spatially structured) metacommunities. It is known that, for smaller enough dispersal rates, space can promote regional diversity by enabling each local community to remain in a different stable state. Therefore, in conditions in which the impact of horizontal gene transfer drives multistability, it will also drive regional diversity in a metacommunity.</p>
<p>(4) In some cases, the authors consider that mobile genetic elements can lead to ~50% growth rate differences. In the presence of an added death rate, this can be a relatively strong advantage that makes the fastest grower easily take over their competitors. It would be important to discuss biologically relevant examples in which such growth advantages driven by mobile genetic elements could be expected, and how common such scenarios might be.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99593.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Hong et al. used a model they previously developed to study the impact of horizontal gene transfer (HGT) on microbial multispecies communities. They investigated the effect of HGT on the existence of alternative stable states in a community. The model most closely resembles HGT through the conjugation of incompatible plasmids, where the transferred genes confer independent growth-related fitness effects. For this type of HGT, the authors find that increasing the rate of HGT leads to an increasing number of stable states. This effect of HGT persists when the model is extended to include multiple competitive niches (under a shared carrying capacity) or spatially distinct patches (that interact in a grid-like fashion). Instead, if the mobile gene is assumed to reduce between-species competition, increasing HGT leads to a smaller region of multistability and fewer stable states. Similarly, if the mobile gene is deleterious an increase in HGT reduces the parameter region that supports multistability.</p>
<p>This is an interesting and important topic, and I welcome the authors' efforts to explore these topics with mathematical modeling. The manuscript is well written and the analyses seem appropriate and well-carried out. However, I believe the model is not as general as the authors imply and more discussion of the assumptions would be helpful (both to readers + to promote future theoretical work on this topic). Also, given the model, it is not clear that the conclusions hold quite so generally as the authors claim and for biologically relevant parameters. To address this, I would recommend adding sensitivity analyses to the manuscript.</p>
<p>Specific points</p>
<p>(1) The model makes strong assumptions about the biology of HGT, that are not adequately spelled out in the main text or methods, and will not generally prove true in all biological systems. These include:</p>
<p>
a) The process of HGT can be described by mass action kinetics. This is a common assumption for plasmid conjugation, but for phage transduction and natural transformation, people use other models (e.g. with free phage that adsorp to all populations and transfer in bursts).</p>
<p>
b) A subpopulation will not acquire more than one mobile gene, subpopulations can not transfer multiple genes at a time, and populations do not lose their own mobilizable genes. [this may introduce bias, see below].</p>
<p>
c) The species internal inhibition is independent of the acquired MGE (i.e. for p1 the self-inhibition is by s1).</p>
<p>
These points are in addition to the assumptions explored in the supplementary materials, regarding epistasis, the independence of interspecies competition from the mobile genes, etc. I would appreciate it if the authors could be more explicit in the main text about the range of applicability of their model, and in the methods about the assumptions that are made.</p>
<p>(2) I am not surprised that a mechanism that creates diversity will lead to more alternative stable states. Specifically, the null model for the absence of HGT is to set gamma to zero, resulting in pij=0 for all subpopulations (line 454). This means that a model with N^2 classes is effectively reduced to N classes. It seems intuitive that an LV-model with many more species would also allow for more alternative stable states. For a fair comparison, one would really want to initialize these subpopulations in the model (with the same growth rates - e.g. mu1(1+lambda2)) but without gene mobility.</p>
<p>(3) I am worried that the absence of double gene acquisitions from the model may unintentionally promote bistability. This assumption is equivalent to an implicit assumption of incompatibility between the genes transferred from different species. A highly abundant species with high HGT rates could fill up the &quot;MGE niche&quot; in a species before any other species have reached appreciable size. This would lead to greater importance of initial conditions and could thus lead to increased multistability.</p>
<p>This concern also feels reminiscent of the &quot;coexistence for free&quot; literature (first described here <ext-link ext-link-type="uri" xlink:href="http://dx.doi.org/10.1016/j.epidem.2008.07.001">http://dx.doi.org/10.1016/j.epidem.2008.07.001</ext-link> ) which was recently discussed in the context of plasmid conjugation models in the supplementary material (section 3) of <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1098/rstb.2020.0478">https://doi.org/10.1098/rstb.2020.0478</ext-link> .</p>
<p>(4) The parameter values tested seem to focus on very large effects, which are unlikely to occur commonly in nature. If I understand the parameters in Figure 1b correctly for instance, lambda2 leads to a 60% increase in growth rate. Such huge effects of mobile genes (here also assumed independent from genetic background) seem unlikely except for rare cases. To make this figure easier to interpret and relate to real-world systems, it could be worthwhile to plot the axes in terms of the assumed cost/benefit of the mobile genes of each species.</p>
<p>Something similar holds for the HGT rate (eta): given that the population of E. coli or Klebsiella in the gut is probably closer to 10^9 than 10^12 (they make up only a fraction of all cells in the gut), the assumed rates for eta are definitely at the high end of measured plasmid transfer rates (e.g. F plasmid transfers at a rate of 10^-9 mL/CFU h-1, but it is derepressed and considered among the fastest - <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.plasmid.2020.102489">https://doi.org/10.1016/j.plasmid.2020.102489</ext-link> ). To adequately assess the impact of the HGT rate on microbial community stability it would need to be scanned on a log (rather than a linear) scale. Considering the meta-analysis by Sheppard et al. it would make sense to scan it from 10^-7 to 1 for a community with a carrying capacity around 10^9.</p>
<p>(5) It is not clear how sensitive the results (e.g. Figure 2a on the effect of HGT) are to the assumption of the fitness effect distribution of the mobile genes. This is related to the previous point that these fitness effects seem quite large. I think some sensitivity analysis of the results to the other parameters of the simulation (also the assumed interspecies competition varies from figure to figure) would be helpful to put the results into perspective and relate them to real biological systems.</p>
</body>
</sub-article>
</article>