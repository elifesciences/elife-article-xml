<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">96362</article-id>
<article-id pub-id-type="doi">10.7554/eLife.96362</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.96362.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Ecology</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Physics of Living Systems</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Evidence of social learning across symbolic cultural barriers in sperm whales</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Leitao</surname>
<given-names>Antonio</given-names>
</name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="aff" rid="a2">b</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lucas</surname>
<given-names>Maxime</given-names>
</name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="aff" rid="a2">b</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Poetto</surname>
<given-names>Simone</given-names>
</name>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="aff" rid="a11">k</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hersh</surname>
<given-names>Taylor A.</given-names>
</name>
<xref ref-type="aff" rid="a3">c</xref>
<xref ref-type="aff" rid="a4">d</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gero</surname>
<given-names>Shane</given-names>
</name>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="aff" rid="a5">e</xref>
<xref ref-type="aff" rid="a6">f</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gruber</surname>
<given-names>David F.</given-names>
</name>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="aff" rid="a7">g</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bronstein</surname>
<given-names>Michael</given-names>
</name>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="aff" rid="a8">h</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Petri</surname>
<given-names>Giovanni</given-names>
</name>
<email>petri.giovanni@gmail.com</email>
<xref ref-type="aff" rid="a1">a</xref>
<xref ref-type="aff" rid="a2">b</xref>
<xref ref-type="aff" rid="a9">i</xref>
<xref ref-type="aff" rid="a10">j</xref>
</contrib>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Kalan</surname>
<given-names>Ammie K</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Victoria</institution>
</institution-wrap>
<city>Victoria</city>
<country>Canada</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Weigel</surname>
<given-names>Detlef</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Biology Tübingen</institution>
</institution-wrap>
<city>Tübingen</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<aff id="a1"><label>a</label><institution>CENTAI Institute</institution>, <addr-line>Corso Inghilterra 3, 10138 TO</addr-line>, <country>Italy</country></aff>
<aff id="a2"><label>b</label><institution>Project CETI</institution>, <addr-line>New York, NY, 10003</addr-line> <country>USA</country></aff>
<aff id="a3"><label>c</label><institution>Comparative Bioacoustics Group, Max Planck Institute for Psycholinguistics</institution>, <addr-line>Nijmegen</addr-line>, <country>Netherlands</country></aff>
<aff id="a4"><label>d</label><institution>Marine Mammal Institute, Oregon State University</institution>, <addr-line>Newport, OR</addr-line>, <country>United States</country></aff>
<aff id="a5"><label>e</label><institution>Department of Biology, Carleton University</institution>, <addr-line>Ottawa, Ontario</addr-line>, <country>Canada</country></aff>
<aff id="a6"><label>f</label><institution>The Dominica Sperm Whale Project</institution>, <addr-line>Roseau</addr-line>, <country>Dominica</country></aff>
<aff id="a7"><label>g</label><institution>Department of Natural Sciences, City University of New York, Baruch College</institution>, <addr-line>New York, NY</addr-line>, <country>United States</country></aff>
<aff id="a8"><label>h</label><institution>Department of Computer Science, University of Oxford</institution>, <addr-line>Oxford</addr-line>, <country>UK</country></aff>
<aff id="a9"><label>i</label><institution>NPLab, Network Science Institute, Northeastern University London</institution>, <addr-line>London</addr-line>, <country>UK</country></aff>
<aff id="a10"><label>j</label><institution>IMT Lucca</institution>, <addr-line>Lucca</addr-line>, <country>Italy</country></aff>
<aff id="a11"><label>k</label><institution>Center for Modern Interdisciplinary Technologies, Nicolaus Copernicus University</institution>, <addr-line>Toruń</addr-line>, <country>Poland</country></aff>
<pub-date pub-type="epub">
<day>18</day>
<month>01</month>
<year>2024</year>
</pub-date>
<pub-date date-type="original-publication" iso-8601-date="2024-05-14">
<day>14</day>
<month>05</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP96362</elocation-id>
<history><date date-type="sent-for-review" iso-8601-date="2024-02-20">
<day>20</day>
<month>02</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-01-18">
<day>18</day>
<month>01</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.48550/arXiv.2307.05304"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Leitao et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Leitao et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-96362-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>We provide quantitative evidence suggesting social learning in sperm whales across sociocultural boundaries, using acoustic data from the Pacific and Atlantic Oceans. Traditionally, sperm whale populations are categorized into clans based on their <italic>vocal repertoire</italic>: the rhythmically patterned click sequences (codas) that they use. Among these codas, <italic>identity</italic> codas function as symbolic markers for each clan, accounting for 35-60% of codas they produce. We introduce a computational method to model whale speech, which encodes rhythmic microvariations within codas, capturing their <italic>vocal style</italic>. We find that vocal style-clans closely align with repertoire-clans. However, contrary to vocal repertoire, we show that sympatry increases vocal style similarity between clans for <italic>non</italic>-identity codas, i.e. most codas, suggesting social learning across cultural boundaries. More broadly, this subcoda structure model offers a framework for comparing communication systems in other species, with potential implications for deeper understanding of vocal and cultural transmission within animal societies.</p>
</abstract>
</article-meta>
</front>
<body>
<sec id="s1" sec-type="intro">
<title>Introduction</title>
<p>Cultural transmission is defined as the transmission of information or behaviors between individuals of the same species by means of social learning [<xref ref-type="bibr" rid="c1">1</xref>]. While humans represent a benchmark of such capacity, cultural transmission has been observed in a wide variety of animals, including cetaceans [<xref ref-type="bibr" rid="c2">2</xref>, <xref ref-type="bibr" rid="c3">3</xref>], songbirds [<xref ref-type="bibr" rid="c4">4</xref>], non-human primates [<xref ref-type="bibr" rid="c5">5</xref>], and insects [<xref ref-type="bibr" rid="c6">6</xref>]. It typically takes one of three forms: vertical transmission, from adult kin to young kin; oblique transmission, from unrelated adults to young; or horizontal transmission, from peer to peer [<xref ref-type="bibr" rid="c7">7</xref>].</p>
<p>When animals have the capacity for social learning, group-specific differences can arise and remain stable when they become distinguishable by symbolic markers: arbitrary group-identity signals that are recognizable by both members of the group itself and by members of other groups [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>]. In humans, symbolic markers can take a myriad of forms, ranging from visible signs, such as tattoos or garments, to communication cues or signals, such as idiomatic sentences or accents [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c10">10</xref>]. In animals, however, quantitative evidence of symbolic markers is remarkably scarce, one exception being recent results on the use of <italic>identity codas</italic> in sperm whale social communication [<xref ref-type="bibr" rid="c11">11</xref>].</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Statistical modeling of subcoda structure in sperm whales.</title>
<p>A Sperm whale communication consists of rhythmic sequences of clicks, called codas. A coda is specified by a sequence of inter-click intervals (ICIs). Codas are classified into types based on their rhythmic pattern, which can have various degrees of regularity (e.g., 4R2 vs 1+3). B Social groups of sperm whales employ specific vocal repertoires: the set of coda types they use and their associated usage frequencies. As an illustration, we show those of the EC1 and EC2 clans from the Dominica dataset [<xref ref-type="bibr" rid="c12">12</xref>]. Only the most numerous coda types are shown: the rest of the vocal repertoires consists of more coda types with residual frequencies. C The subcoda structure can be modeled by considering rhythmic variations within codas of the same coda type. To do so, codas are represented as sequences of discrete inter-click intervals (dICIs), by discretizing absolute ICIs into discrete bins, which can then be considered akin to symbols (e.g. A, B, C, …), providing a tokenization of codas. Different instances of a single coda type can correspond to slightly different dICI sequences. The resulting dICI sequences are modeled using variable-length Markov chains, which can be represented as <italic>subcoda trees</italic>. These trees can be built for an individual speaker or for a group of speakers, and capture the statistical and memory structures of rhythm variations within codas and in the transitions between those. In other words, the tree captures a vocal style—how they say what they say. The vocal styles of different groups of sperm whales can be quantitatively compared by calculating a distance between their subcoda trees.</p></caption>
<graphic xlink:href="2307.05304v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Sperm whales live in multi-tiered societies and have a complex vocal communication system [<xref ref-type="bibr" rid="c13">13</xref>]. They communicate through rhythmic patterns (<italic>codas</italic>) of short broadband sounds (<italic>clicks</italic>), which have traditionally been classified into a finite set of <italic>coda types</italic> based on the total number of clicks, their rhythm, and their tempo [<xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c15">15</xref>] (<xref ref-type="fig" rid="fig1">Fig. 1A</xref>). For example, the 4-regular (4R2) type refers to a pattern of four evenly spaced clicks, whereas the 1+3 type refers to two clicks separated by a longer pause followed by two clicks in quick succession. Coda types are thus standardized rhythmic patterns, but individual vocalizations of a given coda type exhibit micro-variations around that pattern.</p>
<p>The set of vocalized coda types (<italic>coda usage</italic>) combined with how frequently each is vocalized (<italic>coda frequency</italic>) makes up a <italic>vocal repertoire</italic> (<xref ref-type="fig" rid="fig1">Fig. 1B</xref>). For example, the 4R2 coda is used by many sperm whales, but other coda types are more specific in their usage or frequency to certain groups of sperm whales. While there is evidence of individual variation in vocal repertoires [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>], sperm whales belonging to the same social unit—a stable, matrilineally-based group of whales, share a common vocal repertoire that is stable across years [<xref ref-type="bibr" rid="c17">17</xref>, <xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>]. Social units that share substantial parts of their repertoire are said to be part of the same <italic>vocal clan</italic> [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c21">21</xref>]. There is clear social segregation between members of different clans, even when living in sympatry, and thus clans mark a higher level of social organization, which appears to be defined on the basis of cultural vocal markers [<xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c11">11</xref>] (see <xref ref-type="table" rid="tbl1">Table 1</xref> for a summary of the key concepts).</p>
<p>The clan specific and frequent usage of certain coda types, termed <italic>identity codas</italic> [<xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c11">11</xref>], align with the expectations for symbolic markers of group membership [<xref ref-type="bibr" rid="c9">9</xref>]. Furthermore, quantitative evidence that sperm whales themselves use identity codas as such markers has recently emerged: the more two clans overlap in geographic space, the more different their identity coda usage is [<xref ref-type="bibr" rid="c11">11</xref>]. This is consistent with computational models [<xref ref-type="bibr" rid="c9">9</xref>] of the evolution of symbolic marking, which predict that differences between cultural norms will be starkest when inter-group interactions are more common (e.g., in boundary or overlap regions).</p>
<p>All remaining coda types have been referred to as <italic>non-identity</italic> (non-ID) <italic>codas</italic> and constitute a very large fraction of sperm whales’ total number of coda utterances. In fact, the total number of emitted non-ID codas accounts for more than 6 out of 10 codas (see SM Section 1.1 for the counts per clan and per coda type). This begets the question: if ID codas are used as clan identity signals, what can be said about the remaining 65% of codas?</p>
<p>Here, we introduce a novel descriptive framework that focuses on the <italic>subcoda structure</italic>, that is, the rhythmic micro-variations of intervals between clicks within codas (<xref ref-type="fig" rid="fig1">Fig. 1C</xref>). This framework, formally encoded in what we call a “subcoda tree”, captures <italic>how</italic> codas are uttered: a <italic>vocal style</italic>. We find that variations in this vocal style, even for a single coda type, identify an individual’s social unit and clan, effectively fingerprinting vocal repertoires. With this, we add a new dimension with respect to previous approaches based on <italic>which</italic> codas are said—vocal repertoires. Thus, we propose a new concept of <italic>vocal identity</italic> of sperm whales that comprises both vocal style and vocal repertoire.</p>
<p>By applying our modeling framework to acoustic data from the Atlantic and Pacific Oceans, we obtain two main results. First, we partition sperm whale populations into vocal style-defined clans, which we find to recapitulate the previously defined vocal repertoire clans. This confirms that our method does capture meaningful speech characteristics. Second, and crucially, we find that the vocal style of non-ID codas is more similar for more sympatric clans, i.e. clans whose territory overlaps more spatially. In contrast, we do not find an effect of sympatry on the similarity of vocal styles when studying only ID codas. This suggests that geographic overlap induces vocal styles to become more similar between clans, without jeopardizing each clan’s acoustic identity signals. Our results strengthen previous results on the use of ID codas as symbolic markers, while supporting cultural transmission and social learning of vocalizations among whales of <italic>different</italic> clans, as predicted by theoretical models [<xref ref-type="bibr" rid="c22">22</xref>].</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1:</label>
<caption><p>Summary of key concepts</p></caption>
<alternatives>
<graphic xlink:href="2307.05304v2_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
<table frame="hsides" rules="groups">
<thead>
<tr>
<th align="left" valign="top">Concept</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">Click</td>
<td align="left" valign="top">Sharp broadband pulses [<xref ref-type="bibr" rid="c23">23</xref>]</td>
</tr>
<tr>
<td align="left" valign="top">Inter-click interval (ICI)</td>
<td align="left" valign="top">Time interval between two consecutive clicks</td>
</tr>
<tr>
<td align="left" valign="top">Coda</td>
<td align="left" valign="top">Stereotyped, short series of clicks produced by sperm whales in social situations [<xref ref-type="bibr" rid="c14">14</xref>]</td>
</tr>
<tr>
<td align="left" valign="top">Coda type</td>
<td align="left" valign="top">Categorical classification of codas based on rhythm and tempo of coda inter-click intervals [<xref ref-type="bibr" rid="c16">16</xref>]</td>
</tr>
<tr>
<td align="left" valign="top">Coda frequency</td>
<td align="left" valign="top">Usage frequency of each coda type</td>
</tr>
<tr>
<td align="left" valign="top">Coda sample</td>
<td align="left" valign="top">Set of codas recorded during one event</td>
</tr>
<tr>
<td align="left" valign="top">Coda usage</td>
<td align="left" valign="top">Set of coda types used by a group of whales</td>
</tr>
<tr>
<td align="left" valign="top">Identity codas</td>
<td align="left" valign="top">Subset of coda types most frequently used by a sperm whale clan; canonically used to define vocal clans.</td>
</tr>
<tr>
<td align="left" valign="top">Non-identity codas</td>
<td align="left" valign="top">Coda types produced by whales belonging to multiple vocal clans (i.e., all coda types that are not identity codas)</td>
</tr>
<tr>
<td align="left" valign="top">Vocal clan</td>
<td align="left" valign="top">Higher-order level of social organization delineated based on social units that share a substantial part of their vocal repertoire [<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c20">20</xref>]</td>
</tr>
<tr>
<td align="left" valign="top">Vocal repertoire</td>
<td align="left" valign="top">Coda usage and frequency combined. Description of what sperm whales say.</td>
</tr>
<tr>
<td align="left" valign="top">Vocal style</td>
<td align="left" valign="top">Encodes the rhythmic variations within codas. Description of how sperm whales emit codas</td>
</tr>
<tr>
<td align="left" valign="top">Vocal identity</td>
<td align="left" valign="top">Concept comprising both vocal style and vocal repertoire</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="s2" sec-type="results">
<title>Results</title>
<sec id="s2a">
<title>Subcoda structure captures variability in sperm whale communication</title>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Vocal style recovers social structure of vocal clans in Dominica sperm whales.</title>
<p>A We show the similarity of vocal style, measured as subcoda tree-distance, among social units within a vocal clan (<italic>within</italic>, darker color shade) and between two clans (<italic>between</italic>, lighter color shade). We used the manual clan assignments from [<xref ref-type="bibr" rid="c21">21</xref>] as ground truth. Vocal style is more similar within clans than between clans. B We show the hierarchical clustering of social unit subcoda trees. Each leaf corresponds to a social unit, and the colors below show their known clan assignments. The clustering recovers the two-clan structure observed in past work [<xref ref-type="bibr" rid="c21">21</xref>].</p></caption>
<graphic xlink:href="2307.05304v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We model the internal structure of codas, in terms of rhythmic variations at the level of clicks, by using variable length Markov chains (VLMCs). Our analytical pipeline is illustrated in <xref ref-type="fig" rid="fig1">Fig. 1C</xref>. We build each VLMC in two main steps. We first convert codas, naturally represented as sequences of continuous, absolute, inter-click intervals (ICIs), to sequences of discrete ICIs (dICIs), by discretizing time into bins. In this way, each dICI represents a narrow range of possible ICI values. The bins have a fixed width (or resolution) St and thus implicitly correspond to the temporal resolution of our representation (see Methods for details on the optimal choice of St). Note that although ICIs have units of time (seconds), dICIs are (unit-less) symbols (e.g. A, B, C, etc.), representing multiples of St (and so the smaller <italic>St,</italic> the more the symbols). For example, the shortest ICIs will be mapped to the symbol A whereas longer ones will be mapped to symbols further down the alphabet. Hence, each coda (a sequence of ICIs) is mapped to a sequence of discrete symbols (a sequence of dICIs). The second part of the pipeline focuses on modeling the internal structure of codas in terms of dICI sequences. Essentially, we want to estimate transition probabilities from a dICI sub-sequence to the next dICI (<xref ref-type="fig" rid="fig1">Fig. 1B</xref>). A standard way would be to describe this using <italic>k</italic>-order Markov chain models, which encode information on previous sub-sequences up to <italic>k</italic> steps in the past of the sequence. However, it is possible that different sequences of dICIs contain different amounts of information or memory regarding potential next dICIs. This is akin to what happens with words (e.g., a word beginning with “re” can continue in more ways than one starting with “zy”). To account for this possibility while also retaining only the most compressed statistical representation of how codas are structured in terms of dICIs, we employ VLMCs.</p>
<p>VLMCs are generalizations of standard (fixed-memory) Markov chains that allow sub-sequences of dICIs of variable lengths. Longer sequences are kept only if they are significantly more informative in predicting the next dICI than random chance, yielding an optimally compressed representation (see Methods for details on model fitting and selection, including the optimal choice of <italic>St</italic>). Furthermore, VLMCs naturally have a tree structure (see <xref ref-type="fig" rid="fig1">Fig. 1C</xref>), because of the natural order between sequences and their sub-sequences. In particular, each node represents a sub-sequence of dICIs, and is equipped with a probability distribution of transitions to the next dICIs. The origin node corresponds to the empty sequence, leaf nodes correspond to the longest sequences, and all nodes forming the branch in between correspond to the sub-sequences of that leaf node. Thus, we call VLMCs fitted to coda ICI data <italic>subcoda trees</italic>.</p>
<p>Note that dICI sequences encode rhythmic variations within codas. Indeed, a coda type is a standard rhythmic pattern that can be realized with variations in its ICIs and thus in its dICIs too. For example, the 4R2 coda type can be vocalized as BCC but also as CBB (in a representation with, say, 26 symbols). In that sense, subcoda trees, through the dICIs sequences that they contain and their transition probabilities, capture information about a vocal style. Four more features of subcoda trees are noteworthy: (i) because the method’s input is a set of codas, we can build subcoda trees for repertoires corresponding to different social scales, from individual sperm whales, to social units, all the way up to vocal clans; (ii) the difference between different subcoda trees can be measured using a probabilistic distance (see Methods), which we can use to compare subcoda trees across sperm whale clans; (iii) certain features of the vocal style can be quantified via metrics on the subcoda tree: for example we can define a complexity of the vocal style measured by an entropy on the tree; and (iv) subcoda trees can also be used as generative models, to create new synthetic codas in the form of dICI sequences to train downstream machine learning models.</p>
</sec>
<sec id="s2b">
<title>Vocal style recovers vocal clan structure</title>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><title>Vocal style recovers social structure of vocal clans in Pacific Ocean sperm whales.</title>
<p>A We show the similarity of vocal style, measured as subcoda tree-distance, between coda samples within a vocal clan (<italic>within</italic>, darker color shade) and between a clan and all others (<italic>between</italic>, lighter color shade). We used the vocal clans identified in [<xref ref-type="bibr" rid="c11">11</xref>]. Vocal style is more similar within a clan than between clans. B We show the hierarchical clustering of subcoda trees. Each leaf corresponds to a coda sample, and the colors below show their vocal clan assignments (based on coda usage) from [<xref ref-type="bibr" rid="c11">11</xref>]. We find generally good overlap between the groups obtained from clustering vocal style and those from vocal repertoire, with the exception of the <italic>Short</italic> clan (red) that is somewhat mixed with the <italic>Palindrome</italic> (orange) and <italic>Rapid Increasing</italic> (yellow) clans.</p></caption>
<graphic xlink:href="2307.05304v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The information about vocal style contained in subcoda trees is sufficient to recover the social structure of sperm whales (social units and clans). We show this in two ways. First, we analyze a dataset from sperm whales in Dominica (Dominica dataset) [<xref ref-type="bibr" rid="c21">21</xref>]. This dataset has rich annotations (coda type annotations, identity of recorded whales, social relations of recorded whales) which makes it particularly useful for validation. Specifically, the sperm whales in the Dominica dataset are divided into well known social clans, each composed of several social units,each with its own specific vocal repertoires, and thus can be defined as two different vocal clans. For each social unit in this dataset, we aggregate the individual whales’ coda samples and build a subcoda tree. Computing the distance between these trees (see Methods), we find that the distances between social units within the same clan are significantly smaller than between clans (<xref ref-type="fig" rid="fig2">Fig. 2A</xref>). We also find that an agglomerative clustering (average linkage, see Methods for details) on the distance between the subcoda trees correctly clusters social units into their respective clans (<xref ref-type="fig" rid="fig2">Fig. 2B</xref>). Without a priori knowledge of the clan memberships, we used vocal style to recover the existing classification of social units into two clans, which was previously done based on similarity between vocal repertoires (i.e., coda types and usage) [<xref ref-type="bibr" rid="c21">21</xref>].</p>
<p>Second, we find that the subcoda structure of synthetic codas, generated from subcoda trees fitted on real data, closely reproduces that of real codas. To do this, we first train a simple classifier to assign codas to one of the two vocal clans, based on coda type. Variations of the same classifier, trained on the same real data, have been shown to discriminate between individual whales, social units, and clans with high accuracy [<xref ref-type="bibr" rid="c12">12</xref>]. We train the classifier on real codas, and then test it on both real and synthetic ones. The synthetic codas were generated using the subcoda tree of each clan, with a number of codas similar to that of the original dataset for a fair comparison (see Methods for details). We find that synthetic codas are correctly classified into their clans with an accuracy close (~ 85%) to that obtained on the real data (~ 90%, see <italic><xref ref-type="appendix" rid="app1">Supplementary Materials</xref></italic> Section 4).</p>
<p>Motivated by these results, we extend our analysis to a much larger dataset from the Pacific Ocean (Pacific dataset) [<xref ref-type="bibr" rid="c11">11</xref>]. This dataset is more sparsely annotated because of the breadth of its spatial coverage. We restricted our analyses to a well-sampled subset (n = 57 coda samples) of the full Pacific dataset (see Methods for details). Coda samples are only labeled by the spatial position at which they were recorded, but no information is available about the identity of the vocalizing sperm whales (see Methods for details). In fact, each repertoire likely contains codas from multiple individuals of a single clan. It has recently been shown that these coda samples can be divided into seven vocal clans based on their coda usage [<xref ref-type="bibr" rid="c11">11</xref>]. We use those clans as a benchmark for the following analysis.</p>
<p>Since there is no social unit-level information for this dataset, we fit a subcoda tree for each repertoire (i.e., all of the codas recorded on a single day in a single region). Trees are significantly more similar for coda samples belonging to the same vocal clan than for those belonging to different vocal clans (<xref ref-type="fig" rid="fig3">Fig. 3A</xref>). We also find that clustering coda samples based on vocal style returns a dendrogram that closely matches the one obtained from coda usage in [<xref ref-type="bibr" rid="c11">11</xref>] (<xref ref-type="fig" rid="fig3">Fig. 3B</xref>). The major exception we find is the <italic>Short</italic> clan (red), named because member whales produce short codas with very few clicks, for which anomalous results were previously reported as well [<xref ref-type="bibr" rid="c11">11</xref>]. In our case, this is due to the Short clan being less well localized in the space of trees, while the other clans have well-defined centroids (see <italic><xref ref-type="appendix" rid="app1">Supplementary Materials</xref></italic> <xref ref-type="fig" rid="fig9">Fig. 9</xref> for a low-dimensional representation subcoda tree metric space).</p>
<p>Therefore, we find that sperm whale vocal clans in the Atlantic Ocean (Caribbean Sea) and Pacific Ocean can be identified by a <italic>vocal identity</italic> that encompasses both clan-specific <italic>vocal repertoire</italic> [<xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c11">11</xref>] and <italic>vocal style</italic> as defined in this work.</p>
</sec>
<sec id="s2c">
<title>Clan sympatry impacts vocal style of non-ID codas only</title>
<p>While interesting, the fact that both vocal repertoires and vocal styles discriminate between clans might imply that considering both could be redundant for vocal identity. However, we find that this is not the case when we consider the functional role of ID versus non-ID codas.</p>
<p>More precisely, different clans can share significant portions of their total range, overlapping across large swaths of ocean. Such sympatric clans exhibit a decreasing similarity of their ID coda usage with increasing clan overlap [<xref ref-type="bibr" rid="c11">11</xref>]. This means that the more two clans overlap in space, the more dissimilar their vocal repertoires are in terms of ID coda types and their usage frequency. This is consistent with the idea that ID codas are used as symbolic markers to delineate cultural boundaries between social groups [<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c9">9</xref>]. In contrast, non-ID coda usage do not show any relationship to clan overlap.</p>
<p>We find the exact <italic>opposite</italic> effect when considering vocal style. The similarity in vocal style for ID codas across clans does not depend on the level of clan overlap (<xref ref-type="fig" rid="fig4">Fig. 4a</xref>). In contrast, the similarity in vocal style for non-ID codas displays a clear and significant increase (i.e., decreasing subcoda tree-distance) as clan spatial overlap increases (<xref ref-type="fig" rid="fig4">Fig. 4b</xref>). In the <italic><xref ref-type="appendix" rid="app1">Supplementary Materials</xref></italic> (see Section 2.4.2), we show that the same results hold at the single coda type level, in addition to the whole clan level, along with an analysis of the confidence intervals. These results imply that the internal structure of codas is more similar for groups that likely spend more time in the same space, akin to accents aligning in human populations that share the same territory [<xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c26">26</xref>]. This also highlights the complementarity of vocal repertoire and style: the trends are different precisely because the two concepts describe different aspects of whale speech.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><title>Clan overlap influences non-ID coda vocal styles</title>
<p>Comparing the similarities of different VLMC models fit for each Pacific Ocean clan for both ID and non-ID coda samples. The y-axis represents the measured distance between the subcoda trees, and the x-axis shows the geographical clan overlap (as calculated in [<xref ref-type="bibr" rid="c11">11</xref>]). Each point represents a pairwise comparison between two clans. The effect of overlap on ID coda vocal style similarity is minimal and non-significant while the opposite is true for non-ID codas: overlapping clans produce non-ID codas with a more similar vocal style. The VLMC distances are also typically much greater for ID codas than for non-ID codas. Note that while these results are visually opposite to those reported in Hersh et al. [<xref ref-type="bibr" rid="c10">10</xref>], they support the same final conclusions (see “Identity and non-identity codas show different trends” for details).</p></caption>
<graphic xlink:href="2307.05304v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s3" sec-type="discussion">
<title>Discussion</title>
<p>We have presented a general method for modeling animal communication systems and their complexity based on VLMCs. In the context of sperm whales, this new method allows the extraction of <italic>subcoda trees</italic>, which succinctly describe the internal temporal structure of codas. Previous work on the structure of sperm whale communication has largely focused on supra-level coda analyses: for example, by classifying codas into types, quantifying how often different types are used, and distinguishing between individual whales, social units, or clans based on those counts [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c27">27</xref>]. Here, we adopted a more fine-scale approach by investigating potential structure <italic>within</italic> codas. To do so, we used VLMCs to model the transition probability of observing a specific ICI given the previous ones. A VLMC, or here a subcoda tree, encodes all those probabilities but only for dICI sequences that are informative—other sequences are automatically discarded. As such, a subcoda tree is a statistically validated representation of the internal memory structure of codas at the level of sequences of clicks. It contains information about important rhythmic variations and transitions between them: a vocal style.</p>
<p>Using such representations, we propose a novel concept of <italic>vocal identity</italic> for sperm whales composed of <italic>vocal repertoire</italic> (what they say) and <italic>vocal style</italic> (how they say it), the latter being captured by our framework. We find that: (i) vocal styles vary between social units and clans, and can be used to distinguish them; (ii) the similarity of clan vocal styles for non-ID codas increases with increasing spatial overlap, while no change occurs for ID codas; and (iii) social learning across symbolic cultural boundaries most parsimoniously explains the observed trends.</p>
<sec id="s3a">
<title>Vocal style recovers hierarchical social structure</title>
<p>Using the Dominica dataset, sperm whales had previously been divided into two vocal clans, based on their vocal repertoires and observed social interactions [<xref ref-type="bibr" rid="c21">21</xref>]. In our study, comparing the vocal styles of those same whales led to the same assignment of social units to two vocal clans. Similarly, for the Pacific dataset, clustering based on vocal styles yielded clans that were in good agreement with those previously defined based on vocal repertoires [<xref ref-type="bibr" rid="c11">11</xref>] (<italic><xref ref-type="appendix" rid="app1">Supplementary Materials</xref></italic> for an extended comparison). The difference between the two partitions was mainly due to the Short clan, which was more spread out in subcoda tree space than the other clans, causing overlap with other clans that showed less variability. This variability could be linked to the fact that Short clan whales typically make codas with very few (e.g., three or four) clicks, leading to subcoda trees with very few nodes. In Ref. [<xref ref-type="bibr" rid="c11">11</xref>], the authors observe a similar lack of uniformity in coda usage of the Short clan.</p>
</sec>
<sec id="s3b">
<title>Identity and non-identity codas show different trends</title>
<p>For ID codas, we show that the similarity between clan vocal styles is not affected by spatial overlap, while it has recently been shown that the similarity between clan vocal repertoires decreases with overlap [<xref ref-type="bibr" rid="c11">11</xref>]. This means that spatial overlap does not affect how whales produce ID codas (in terms of their fine-scale rhythmic structure; our results) but does affect how often they produce them. In contrast, for non-ID codas, we show that the similarity between vocal styles increases with spatial overlap between two clans, while no change was observed for vocal repertoires in previous work on the same dataset. In other words, increasing spatial overlap is correlated with more similar fine-scale rhythmic structure of non-ID codas produced by whales from different clans (our results), but does not affect how often non-ID codas are produced. Our study thus supports and nuances the results of Hersh et al. [<xref ref-type="bibr" rid="c11">11</xref>]. We provide further support for selection acting to produce unambiguous, recognizable identity signals in the ID codas. However, ID codas only account for 35% of the total vocalizations; the remaining 65% of codas have traditionally been lumped into a catch-all category (i.e., non-ID codas) and their function remains enigmatic (these numbers are an average over the Pacific clans, and go up to 93% for non-ID codas when counting number of coda types instead of number of codas emitted, see SM 1.1 for details). We could still discriminate among clans using non-ID coda vocal style; however, the increased similarity of non-ID coda vocal styles between clans with greater spatial overlap, as demonstrated here, suggests that non-ID codas are likely vocal cues and not identity signals like the ID codas. Accordingly, vocal repertoire and vocal style capture different and complementary information on sperm whale communication, and should be considered in tandem in future studies.</p>
</sec>
<sec id="s3c">
<title>Evidence for social learning across cultural boundaries</title>
<p>There are several potential mechanisms driving the similarity in non-ID coda vocal styles—but not ID coda vocal styles—across spatially overlapped clans: environmental variation, genetics, and/or social learning.</p>
<p>Local adaptation to specific ecological conditions can lead to geographic variation in acoustic signals [<xref ref-type="bibr" rid="c28">28</xref>]. If environmental pressures alone were responsible for the trends we observe in sperm whales, this would imply that (i) more spatially overlapped clans experience more similar environments, (ii) non-ID coda vocal style is impacted by or dependent on environmental parameters, and (iii) ID coda vocal style is not impacted by/dependent on environmental parameters. Although the first point is somewhat intuitive, to date there is no evidence that coda production systematically varies with environment. In fact, clans are recognizable across ocean basins, making local adaptation an unlikely driver of the observed trend in non-ID coda vocal style.</p>
<p>If genetic relatedness were responsible, this would imply that (i) more spatially overlapped clans are more genetically related, (ii) non-ID coda vocal styles are genetically inherited, and (iii) ID coda vocal styles are not genetically inherited. If all three requirements were met, then the observed similarity in non-ID coda vocal styles for more spatially overlapped clans could be due to genetic determination under a general isolation by distance structure. However, research to date suggests this scenario is unlikely. Rendell et al. [<xref ref-type="bibr" rid="c29">29</xref>] found little evidence to support genetics as an explanation of differences in vocal dialects among clans in the Pacific Ocean. Furthermore, Alexander et al. [<xref ref-type="bibr" rid="c30">30</xref>] found that regional genetic differentiation in the Pacific Ocean is very low: while social group is important for explaining both mitochondrial and nuclear DNA variance, geographic region is not. This contrasts with results from the Indian Ocean, where region was the strongest predictor of mitochondrial DNA variance. Given that gene flow in sperm whales is largely male-mediated and that mitochondrial DNA haplotypes are broadly shared across the Pacific Ocean, it is unlikely that coda dialects are genetically determined [<xref ref-type="bibr" rid="c30">30</xref>, <xref ref-type="bibr" rid="c31">31</xref>]. Agent-based models grounded in empirical data from Pacific Ocean sperm whales further support coda usage as socially learned, not genetically inherited [<xref ref-type="bibr" rid="c22">22</xref>]. To fully rule out a genetic explanation for our results, the analyses in [<xref ref-type="bibr" rid="c29">29</xref>] could be replicated for ID coda usage and non-ID coda usage separately. This would shed light on whether certain coda types are genetically inherited vs. socially learned, as has been suggested for some humpback whale (<italic>Megaptera novaeangliae</italic>) vocalizations [<xref ref-type="bibr" rid="c32">32</xref>].</p>
<p>The most parsimonious explanation for the observed similarity of non-ID coda vocal styles of clans with increasing spatial overlap is social learning across clan boundaries. This is remarkable, given that sperm whale clans belonging to different clans have rarely been observed physically interacting at sea [<xref ref-type="bibr" rid="c3">3</xref>]. However, that does not preclude the possibility that they are within acoustic range of each other [<xref ref-type="bibr" rid="c33">33</xref>] and that cross-cultural social learning opportunities arise. This explanation is compatible with (and bolsters) past work suggesting that ID and non-ID codas function differently in sperm whale communication, and further suggests that they experience different evolutionary pressures [<xref ref-type="bibr" rid="c22">22</xref>]. Whether social learning has facilitated stochastic (i.e., cultural drift) or deterministic (i.e., cultural selection) processes is more difficult to determine, and it is unclear whether the observed non-ID coda vocal style alignment has been neutral or adaptive [<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c28">28</xref>]. Importantly, these findings suggest that vocal learning in sperm whales may not be limited to vertical transmission from related adults to young kin, but that horizontal and/or oblique social learning from outside the natal social unit might also be occuring.</p>
<p>Vocal identity in sperm whales is thus consistent with both cultural selection on ID codas to maintain discrete signals for vocal recognition in sympatry, and social learning between clans leading to a vocal style more similar to that of other whales with which they are in acoustic contact more frequently. This highlights a more complex system of transmission in which clan identity is maintained through selection, while gradual change over time may occur within and across clans for vocalizations which do not function in social recognition and thus may create similar vocal styles.</p>
</sec>
<sec id="s3d">
<title>Future directions</title>
<p>Our results can be expanded in multiple ways in future work. The first, and the simplest conceptually, would be to conduct the present analysis on a larger dataset. More codas would improve the quality of the statistical analyses and ensure that all codas are represented in realistic proportions for each clan. Moreover, longitudinal datasets might provide direct evidence to discriminate between the social learning hypothesis and competing ones (e.g. drift in vocal style). Similarly, confirmations could emerge from large scale genetic datasets addressing the issues of phylogenetic relatedness (or lack thereof) in clans that are closer in vocal style distance. Such datasets do not exist at present, but efforts towards automated and semi-automated collection techniques are underway (e.g. Project CETI [<xref ref-type="bibr" rid="c35">35</xref>]). Second, from a methodological perspective, we could add spectral information (in terms of acoustic frequencies) to the temporal information currently used. Although sperm whale acoustic communication seems mostly based on rhythm, spectral features of individual clicks may convey additional information. This possibility could be incorporated into our method by labeling the dICIs according to the frequency content of the associated click (or by extending the available “alphabet” for the VLMC). Third, it would be interesting to investigate in more detail the function of non-ID codas. Indeed, even though ID codas were only recently formally named for the first time, they have been the primary focus of sperm whale coda research for decades. As previously mentioned, non-ID codas are a catch-all category for anything that is not an ID coda, but that does not mean that all non-ID codas function in the same way. To start to unveil their function, we need to consider the context (behavioral, environmental, etc.) in which different non-ID codas are produced [<xref ref-type="bibr" rid="c36">36</xref>]. The pattern we documented may or may not apply to all non-ID codas, but it is at least strong enough that we detect the relationship with clan spatial overlap when collectively considering all non-ID codas.</p>
</sec>
</sec>
<sec id="s4" sec-type="methods">
<title>Methods</title>
<sec id="s4a">
<title>Acoustic data</title>
<p>In social situations, sperm whales acoustically communicate through short bursts of <italic>clicks</italic> with recognizable patterns based on rhythm and tempo referred to as <italic>codas</italic>. Codas are generally represented as sequences of ICIs, equivalent to a time series of click onsets.</p>
<p>We analyzed two datasets in the present study. The Dominica dataset contains 8719 annotated codas recorded in the Atlantic Ocean off the island of Dominica between 2005 and 2019. The codas come from 12 social units grouped into two vocal clans (EC1 and EC2). The Pacific dataset was collected between 1978 and 2017 at 23 locations in the Pacific Ocean (the recording methods are available in the supplementary materials of [<xref ref-type="bibr" rid="c11">11</xref>]). The codas were divided into coda samples according to their recording day and each repertoire was assigned a single vocal clan inferred in [<xref ref-type="bibr" rid="c11">11</xref>]. When considering a clan-level analysis (<xref ref-type="fig" rid="fig3">Fig. 3</xref>) all coda samples were used to compute the subcoda trees (23555 codas). However, when analysing at a coda samples level (<xref ref-type="fig" rid="fig4">Fig. 4</xref>), we discarded coda samples with less than 200 codas with statistical inference in mind, resulting in a final count of 57 coda samples (17046 codas) for the Pacific.</p>
</sec>
<sec id="s4b">
<title>Representation of sperm whale communication as discrete inter-click intervals</title>
<p>As a preliminary step, we discretized the (continuous) ICI values into bins of width <italic>δt</italic> seconds. In other words, we represented the continuum of ICI values by a finite set of discrete ICIs (dICIs) based on the duration of the ICI. The bin width <italic>δt</italic> controls the <italic>temporal resolution</italic> of the representation: a higher value of <italic>δt</italic> implies a coarser representation with fewer dICIs. We also imposed an upper bound <italic>t</italic><sub>max</sub>: any ICI value greater than that was truncated to <italic>t</italic><sub>max</sub>. This ensured that the set of dICIs was finite. Note that although ICIs have units of time (seconds), dICIs are unitless (they represent time intervals). The resulting representation of ICIs as dICIs is a discrete random variable defined as
<disp-formula id="FD1">
<alternatives>
<mml:math id="M1" display="block"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>ICI,t</mml:mtext></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2307.05304v2_eqn1.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(1)</label>
</disp-formula>
</p>
<p>which takes values in the finite set <inline-formula id="ID1">
<alternatives>
<mml:math display="inline" id="I1"><mml:mi>χ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2307.05304v2_ieq1.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. We represented the sequences of ICIs by sequences of dICIs from that finite set. Note that any ICI value above <italic>t</italic><sub>max</sub> is mapped to the dICI <inline-formula id="ID2">
<alternatives>
<mml:math display="inline" id="I2"><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2307.05304v2_ieq2.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> and therefore represents the end of a coda. We set <italic>t</italic><sub>max</sub> = 1 (longer than any ICI) and <italic>δt</italic> = 0.05 throughout the analysis (see <italic><xref ref-type="appendix" rid="app1">Supplementary Materials</xref></italic> section 3.3.2 for justification of this choice and section 3.4.3 for an analysis on the influence of this parameter).</p>
</sec>
<sec id="s4c">
<title>Variable length Markov chains</title>
<p>We then modeled these dICI sequences using variable length Markov chains (VLMCs). VLMCs provide the large memory advantage of higher-order Markov chains when needed, without the drawback of having too many unnecessary parameters in the model.</p>
<p>Fitting a VLMC is the process of deciding how much memory is necessary to model specific sequences. The criterion for making this decision is the following: longer sequences are discarded if their distribution of transition probabilities is similar to that of shorter subsequences. This process is often called <italic>context tree estimation</italic> and consists of two steps.</p>
<p>The first step is to consider <italic>W<sub>D</sub></italic> the set of all sequences of maximum length <italic>D</italic> (which we set to 10) and to assign the following probability distribution <italic>q<sub>w</sub></italic> to each sequence:
<disp-formula id="FD2">
<alternatives>
<mml:math id="M2" display="block"><mml:msub><mml:mi>q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2307.05304v2_eqn2.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(2)</label>
</disp-formula>
</p>
<p>that is, the probability of observing a state <italic>x</italic> ∈ <italic>χ</italic> given the sequence <italic>w</italic>.</p>
<p>The second step is to prune the sequences that do not add information. Take two sequences <italic>u, w</italic> ∈ <italic>W<sub>D</sub></italic>, one being the suffix of the other <italic>w</italic> = <italic>σu</italic>. The information gained <italic>H<sub>w</sub></italic> by considering the longer sequence can be measured with a weighted Kullback-Leibler (KL) divergence <italic>D<sub>KL</sub></italic> [<xref ref-type="bibr" rid="c37">37</xref>]. The longer memory sequence <italic>w</italic> is kept only if the information gain is greater than some threshold <italic>K</italic> [<xref ref-type="bibr" rid="c38">38</xref>, <xref ref-type="bibr" rid="c39">39</xref>]
<disp-formula id="FD3">
<alternatives>
<mml:math id="M3" display="block"><mml:mi>Δ</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>&gt;</mml:mo><mml:mi>K</mml:mi></mml:math>
<graphic xlink:href="2307.05304v2_eqn3.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(3)</label>
</disp-formula>
</p>
<p>where <italic>N(w)</italic> denotes the length of sequence <italic>w</italic>. Sequences that satisfy this condition are called <italic>contexts</italic> and sequences that do not are discarded. A VLMC can be defined as the set of these contexts <italic>w</italic> and their associated probability distribution <italic>q<sub>w</sub></italic> (see <italic><xref ref-type="appendix" rid="app1">Supplementary Materials</xref></italic> section 3.1 for details).</p>
<p>A VLMC can be visualized as a tree by representing each context w by a node and setting the root node as the context of length zero. Contexts that are subsequences of each other are then part of the same branches, which end with the longest contexts.</p>
</sec>
<sec id="s4d">
<title>Quantitative Comparison of VLMCs</title>
<p>If two VLMC models <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> are built over the same finite set of dICIs <italic>χ</italic>, there exists a map <italic>ϕ<sub>1</sub></italic> : <italic>W<sub>D</sub></italic> → <italic>T</italic><sub>1</sub> that maps any sequence of elements of <italic>χ</italic> into the longest sequence present in <italic>T</italic><sub>1</sub>, and similarly for <italic>T</italic><sub>2</sub>. This map also induces a map between the probability distributions of <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub>. Given two distributions over the same set <italic>χ</italic>, we can measure how different they are with the <italic>KL</italic> divergence. Therefore, it is possible to define a dissimilarity between <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> by considering the average <italic>KL</italic> divergence over all sequences of <italic>T</italic>1 and their map <italic>ϕ</italic><sub>1</sub>(<italic>T</italic><sub>2</sub>) ⊆ <italic>T</italic><sub>1</sub>
<disp-formula id="FD4">
<alternatives>
<mml:math id="M4" display="block"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>p</mml:mi><mml:mrow><mml:mi>ϕ</mml:mi><mml:mn>1</mml:mn><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:msub><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2307.05304v2_eqn4.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(4)</label>
</disp-formula>
</p>
<p>Refer to the <italic><xref ref-type="appendix" rid="app1">Supplmentary Materials</xref></italic> section 3.4 for a more detailed explanation.</p>
<p>This results in a dissimilarity measure that captures not just the difference in emission distribution but also the structural differences of the associated context trees. When comparing the distribution of distances in <xref ref-type="fig" rid="fig2">Fig. 2A</xref> and <xref ref-type="fig" rid="fig3">Fig. 3A</xref> we performed a <italic>Kolmogorov-Smirnov</italic> test to test if the distances between social units/coda samples of the same clan and distances between social units/coda samples of different clans had come from the same distribution. For every pair, we can reject the hypothesis of the distances coming from the same distribution with 95% confidence.</p>
</sec>
<sec id="s4e">
<title>Hierachical Clustering of VLMCs</title>
<p>The dendrograms in <xref ref-type="fig" rid="fig2">Fig. 2B</xref> and <xref ref-type="fig" rid="fig3">Fig. 3B</xref> were obtained by hierarchical clustering using average linkage on the set of subcoda trees (VLMCs). Since the distance is not symmetric, for agglomerative clustering we considered the symmetric distance:
<disp-formula id="FD5">
<alternatives>
<mml:math id="M5" display="block"><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>max</mml:mi><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2307.05304v2_eqn5.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(5)</label>
</disp-formula>
</p>
</sec>
<sec id="s4f">
<title>Measuring clan overlap</title>
<p>We used the clan spatial overlap values from [<xref ref-type="bibr" rid="c11">11</xref>]. Briefly, given two clans A and B, and the coda samples associated to them, the amount of geographical overlap of A in B was measured as the fraction of coda samples belonging to clan A that were recorded within 1000 kilometers of at least one repertoire of clan B. One thousand kilometers is the approximate annual home range span of sperm whales in the eastern tropical Pacific [<xref ref-type="bibr" rid="c40">40</xref>, <xref ref-type="bibr" rid="c41">41</xref>].</p>
</sec>
<sec id="s4g">
<title>Statistical Testing</title>
<p>On <xref ref-type="fig" rid="fig2">Fig. 2</xref> and <xref ref-type="fig" rid="fig3">Fig. 3</xref> we compare the distributions of distances between subcoda trees of coda samples/social units of the same clan (<italic>within</italic>) and of different clans (<italic>between</italic>). The purpose is to assess whether these distributions originate from the same underlying population. We employ both the <italic>Kolmogorov-Smirnov</italic> test and the <italic>T-</italic>test. The observed <italic>p</italic>-values were well below 0.01 for all clans. This allows us to confidently reject the hypothesis that there is no difference between the vocal style between different clans. For more information check the <italic><xref ref-type="appendix" rid="app1">Supplementary Materials</xref></italic> in section 3.4.2.</p>
<p>To assess the existence of a relationship between clan overlap and vocal style similarity, we applied an ordinary least squares linear regression model (OLS). We show the resulting <italic>p</italic> values of the OLS statistical test at the bottom left of each plot of <xref ref-type="fig" rid="fig4">Fig. 4</xref> along with the observed <italic>r</italic><sup>2</sup> value. To assess whether there is true difference between the two cases, we also bootstrapped the linear regression calculation to obtain 95% confidence intervals for the slopes of the fits, resulting in both negative and positive values in the ID case, but only negative slope values for the non-ID case, thus confirming our interpretation.</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>This study was funded by Project CETI via grants from Dalio Philanthropies and Ocean X; Sea Grape Foundation; Rosamund Zander/Hansjorg Wyss, Chris Anderson/Jacqueline Novogratz through The Audacious Project: a collaborative funding initiative housed at TED. TAH was supported by Max Planck Group Leader funding to Andrea Ravignani of the Max Planck Institute for Psycholinguistics. The Dominica coda dataset originates from The Dominica Sperm Whale Project which was supported by a FNU fellowship for the Danish Council for Independent Research supplemented by a Sapere Aude Research Talent Award, a Carlsberg Foundation expedition grant, a grant from Focused on Nature, two Explorer Grants from the National Geographic Society (all to SG), and supplementary grants from the Arizona Center for Nature Conservation, Quarters For Conservation, the Dansk Akustisks Selskab, Oticon Foundation, and the Dansk Tennis Fond. Further funding was provided by Discovery and Equipment grants from the Natural Sciences and Engineering Research Council of Canada to Hal Whitehead (Dalhousie University) and a FNU large frame grant and a Villum Foundation Grant to Peter Madsen (Aarhus University). The publicly accessible Pacific Ocean sperm whale coda dataset we used in this study emanates from the Global Coda Dialect Project, a consortium of scientists conducting sperm whale acoustics research worldwide. Members of the consortium who contributed to the Pacific Ocean dataset include: Luke Rendell, Mauricío Cantor, Lindy Weilgart, Masao Amano, Steve M. Dawson, Elisabeth Slooten, Christopher M. Johnson, Iain Kerr, Roger Payne, Andy Rogan, Ricardo Antunes, Olive Andrews, Elizabeth L. Ferguson, Cory Ann Hom-Weaver, Thomas F. Norris, Yvonne M. Barkley, Karlina P. Merkens, Erin M. Oleson, Thomas Doniol-Valcroze, James F. Pilkington, Jonathan Gordon, Manuel Fernandes, Marta Guerra, Leigh Hickmott and Hal Whitehead. We are grateful to Scott Baker and Alana Alexander for answering questions about sperm whale genetics.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Culture in whales and dolphins</article-title>. <source>Behav. Brain Sci</source>. <volume>24</volume>, <fpage>309</fpage>–<lpage>324</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whiten</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Ayala</surname>, <given-names>F. J.</given-names></string-name>, <string-name><surname>Feldman</surname>, <given-names>M. W.</given-names></string-name> &amp; <string-name><surname>Laland</surname>, <given-names>K. N.</given-names></string-name></person-group> <article-title>The extension of biology through culture</article-title>. <source>Proc. Natl. Acad. Sci</source>. <volume>114</volume>, <fpage>7775</fpage>–<lpage>7781</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name></person-group> <source>The cultural lives of whales and dolphins</source> (<publisher-name>University of Chicago Press</publisher-name>, <year>2014</year>).</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Slater</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>The cultural transmission of bird song</article-title>. <source>Trends Ecol. Evol</source>. <volume>1</volume>, <fpage>94</fpage>–<lpage>97</lpage> (<year>1986</year>).</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luncz</surname>, <given-names>L. V.</given-names></string-name>, <string-name><surname>Wittig</surname>, <given-names>R. M.</given-names></string-name> &amp; <string-name><surname>Boesch</surname>, <given-names>C.</given-names></string-name></person-group> <article-title>Primate archaeology reveals cultural transmission in wild chimpanzees (pan troglodytes verus)</article-title>. <source>Philos. Trans. R. Soc. B</source> <volume>370</volume>, <fpage>20140348</fpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alem</surname>, <given-names>S.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Associative mechanisms allow for social learning and cultural transmission of string pulling in an insect</article-title>. <source>PLoS Biol</source>. <volume>14</volume>, <elocation-id>e1002564</elocation-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Cavalli-Sforza</surname>, <given-names>L. L.</given-names></string-name> &amp; <string-name><surname>Feldman</surname>, <given-names>M. W.</given-names></string-name></person-group> <source>Cultural transmission and evolution: A quantitative approach</source>. <volume>16</volume> (<publisher-name>Princeton University Press</publisher-name>, <year>1981</year>).</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Barth</surname>, <given-names>F.</given-names></string-name></person-group> <chapter-title>Introduction</chapter-title>. In <source>Ethnic Groups and Boundaries</source> (<publisher-name>Little Brow</publisher-name>, <year>1969</year>).</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McElreath</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Boyd</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Richerson</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>Shared norms and the evolution of ethnic markers</article-title>. <source>Curr. Anthropol</source>. <volume>44</volume>, <fpage>122</fpage>–<lpage>130</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyd</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Richerson</surname>, <given-names>P. J.</given-names></string-name></person-group> <article-title>The evolution of ethnic markers</article-title>. <source>Cult Anthropol</source> <volume>2</volume>, <fpage>65</fpage>–<lpage>79</lpage> (<year>1987</year>).</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hersh</surname>, <given-names>T. A.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Evidence from sperm whale clans of symbolic marking in non-human cultures</article-title>. <source>Proc. Natl. Acad. Sci</source>. <volume>119</volume>, <elocation-id>e2201692119</elocation-id> (<year>2022</year>).</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bermant</surname>, <given-names>P. C.</given-names></string-name>, <string-name><surname>Bronstein</surname>, <given-names>M. M.</given-names></string-name>, <string-name><surname>Wood</surname>, <given-names>R. J.</given-names></string-name>, <string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Gruber</surname>, <given-names>D. F.</given-names></string-name></person-group> <article-title>Deep Machine Learning Techniques for the Detection and Classification of Sperm Whale Bioacoustics</article-title>. <source>Sci. Rep</source>. <volume>9</volume>, <fpage>12588</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Cantor</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name></person-group> <chapter-title>Sperm whale, the largest toothed creature on earth</chapter-title>. In <source>Ethology and behavioral ecology odontocetes,</source> <fpage>261</fpage>–<lpage>280</lpage> (<publisher-name>Springer</publisher-name>, <year>2019</year>).</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watkins</surname>, <given-names>W. A.</given-names></string-name> &amp; <string-name><surname>Schevill</surname>, <given-names>W. E.</given-names></string-name></person-group> <article-title>Sperm whale codas</article-title>. <source>J. Acoust. Soc. Am</source>. <volume>62</volume>, <fpage>1485</fpage> (<year>1977</year>).</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hersh</surname>, <given-names>T. A.</given-names></string-name>, <string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Using identity calls to detect structure in acoustic datasets</article-title>. <source>Methods Ecol. Evol</source>. <volume>12</volume>, <fpage>1668</fpage>–<lpage>1678</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weilgart</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Coda communication by sperm whales (<italic>Physeter macro-cephalus</italic>) off the Galapagos Islands</article-title>. <source>Can. J. Zool</source>. <volume>71</volume>, <fpage>744</fpage>–<lpage>752</lpage> (<year>1993</year>).</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schulz</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name></person-group> <article-title>Individual vocal production in a sperm whale (physeter macrocephalus) social unit</article-title>. <source>Mar. Mammal Sci</source>. <volume>27</volume>, <fpage>149</fpage>–<lpage>166</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name></person-group> <article-title>Individual, unit and vocal clan level identity cues in sperm whale codas</article-title>. <source>R. Soc. Open Sci</source>. <volume>3</volume>, <fpage>150372</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Spatial and temporal variation in sperm whale coda vocalizations: stable usage and local dialects</article-title>. <source>Anim. Behav</source>. <volume>70</volume>, <fpage>191</fpage>–<lpage>198</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rendell</surname>, <given-names>L. E.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Vocal clans in sperm whales (Physeter macrocephalus)</article-title>. <source>Proc. Royal Soc. B</source> <volume>270</volume>, <fpage>225</fpage>–<lpage>231</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Bøttcher</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Madsen</surname>, <given-names>P. T.</given-names></string-name></person-group> <article-title>Socially segregated, sympatric sperm whale clans in the Atlantic Ocean</article-title>. <source>R. Soc. Open Sci</source>. <volume>3</volume>, <fpage>160061</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cantor</surname>, <given-names>M.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Multilevel animal societies can emerge from cultural transmission</article-title>. <source>Nat. Commun</source>. <volume>6</volume>, <fpage>8091</fpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Backus</surname>, <given-names>R. H.</given-names></string-name> &amp; <string-name><surname>Schevill</surname>, <given-names>W. E.</given-names></string-name></person-group> <article-title>Physeter clicks</article-title>. <source>Whales, dolphins, and porpoises</source> <fpage>510</fpage>–<lpage>527</lpage> (<year>1966</year>).</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vachon</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Hersh</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Ocean nomads or island specialists? culturally driven habitat partitioning contrasts in scale between geographically isolated sperm whale populations</article-title>. <source>R. Soc. Open Sci</source>. <volume>9</volume>, <comment>211737</comment> (<year>2022</year>).</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cohen</surname>, <given-names>E.</given-names></string-name></person-group> <article-title>The evolution of tag-based cooperation in humans: The case for accent</article-title>. <source>Curr. Anthropol</source>. <volume>53</volume>, <fpage>588</fpage>–<lpage>616</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henrich</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Muthukrishna</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>The origins and psychology of human cooperation</article-title>. <source>Annu. Rev. Psychol</source>. <volume>72</volume>, <fpage>207</fpage>–<lpage>240</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oliveira</surname>, <given-names>C.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Sperm whale codas may encode individuality as well as clan identity</article-title>. <source>J. Acoust. Soc. Am</source>. <volume>139</volume>, <fpage>2860</fpage>–<lpage>2869</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname>, <given-names>K.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Geographic variation in the acoustic traits of greater horseshoe bats: testing the importance of drift and ecological selection in evolutionary processes</article-title>. <source>PLoS One</source> <volume>8</volume>, <elocation-id>e70368</elocation-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Mesnick</surname>, <given-names>S. L.</given-names></string-name>, <string-name><surname>Dalebout</surname>, <given-names>M. L.</given-names></string-name>, <string-name><surname>Burtenshaw</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Can genetic differences explain vocal dialect variation in sperm whales, physeter macrocephalus?</article-title> <source>Behav. Genet</source>. <volume>42</volume>, <fpage>332</fpage>–<lpage>343</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alexander</surname>, <given-names>A.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>What influences the worldwide genetic structure of sperm whales (physeter macrocephalus)?</article-title> <source>Mol. Ecol</source>. <volume>25</volume>, <fpage>2754</fpage>–<lpage>2772</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lyrholm</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Leimar</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Johanneson</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Gyllensten</surname>, <given-names>U.</given-names></string-name></person-group> <article-title>Sex-biased dispersal in sperm whales: contrasting mitochondrial and nuclear genetic structure of global populations</article-title>. <source>Proceedings of the Royal Society of London. Series B: Biological Sciences</source> <volume>266</volume>, <fpage>347</fpage>–<lpage>354</lpage> (<year>1999</year>).</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Epp</surname>, <given-names>M. V.</given-names></string-name>, <string-name><surname>Fournet</surname>, <given-names>M. E.</given-names></string-name>, <string-name><surname>Silber</surname>, <given-names>G. K.</given-names></string-name> &amp; <string-name><surname>Davoren</surname>, <given-names>G. K.</given-names></string-name></person-group> <article-title>Allopatric humpback whales of differing generations share call types between foraging and wintering grounds</article-title>. <source>Sci. Rep</source>. <volume>11</volume>, <fpage>16297</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Madsen</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Wahlberg</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Møhl</surname>, <given-names>B.</given-names></string-name></person-group> <article-title>Male sperm whale (physeter macrocephalus) acoustics in a high-latitude habitat: implications for echolocation and communication</article-title>. <source>Behav. Ecol. Sociobiol</source>. <volume>53</volume>, <fpage>31</fpage>–<lpage>41</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deecke</surname>, <given-names>V. B.</given-names></string-name>, <string-name><surname>Ford</surname>, <given-names>J. K.</given-names></string-name> &amp; <string-name><surname>Spong</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>Dialect change in resident killer whales: implications for vocal learning and cultural transmission</article-title>. <source>Anim. Behav</source>. <volume>60</volume>, <fpage>629</fpage>–<lpage>638</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andreas</surname>, <given-names>J.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Towards understanding the communication in sperm whales</article-title>. <source>iScience</source> <volume>25</volume>, <fpage>104393</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frantzis</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Alexiadou</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>Male sperm whale (physeter macrocephalus) coda production and coda-type usage depend on the presence of conspecifics and the behavioural context</article-title>. <source>Can. J. Zool</source>. <volume>86</volume>, <fpage>62</fpage>–<lpage>75</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kullback</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Leibler</surname>, <given-names>R. A.</given-names></string-name></person-group> <article-title>On information and sufficiency</article-title>. <source>Ann. Math. Stat</source>. <volume>22</volume>, <fpage>79</fpage>–<lpage>86</lpage> (<year>1951</year>).</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mächler</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Bühlmann</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>Variable length markov chains: methodology, computing, and software</article-title>. <source>J. Comput. Graph. Stat</source>. <volume>13</volume>, <fpage>435</fpage>–<lpage>455</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c39"><label>[39]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Galves</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Galves</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Garcia</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>Garcia</surname>, <given-names>N. L.</given-names></string-name> &amp; <string-name><surname>Leonardi</surname>, <given-names>F.</given-names></string-name></person-group> <article-title>Context tree selection and linguistic rhythm retrieval from written texts</article-title>. <source>Ann. Appl. Stat</source>. <volume>6</volume>, <fpage>186</fpage>–<lpage>209</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c40"><label>[40]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Analysis of animal movement using opportunistic individual identifications: application to sperm whales</article-title>. <source>Ecology</source> <volume>82</volume>, <fpage>1417</fpage>–<lpage>1432</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c41"><label>[41]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Coakes</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Jaquet</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Lusseau</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Movements of sperm whales in the tropical pacific</article-title>. <source>Marine Ecology Progress Series</source> <volume>361</volume>, <fpage>291</fpage>–<lpage>300</lpage> (<year>2008</year>).</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<title>Supplementary Materials</title>
<p><italic>Evidence of social learning across symbolic cultural barriers in sperm whales</italic></p>
<sec id="s5">
<title>1 Data and Preprocessing</title>
<p>Sperm whales communicate vocally via <italic>clicks</italic> : short bursts of sound emitted in sequence. These clicks are combined into recognizable patterns called <italic>codas</italic>. Clicking sperm whales were recorded with a hydrophone, and clicks were detected in the resulting audio files by human experts. The data that we used consists of time sequences of inter-click intervals (ICIs), i.e. the times between two consecutive detected clicks—this is equivalent to having a time series of click onsets.</p>
<p>We used two datasets: the Dominica and Pacific datasets. The Dominica dataset contains 8719 annotated codas recorded in the Atlantic Ocean near Dominica. The codas come from 12 social units grouped into two vocal clans (EC1 and EC2). The Pacific dataset consists of around 23555 codas recorded between 1978 and 2017 in 23 Pacific Ocean locations. The codas were divided into coda samples according to their recording day and each coda sample was assigned a single vocal clan inferred in [<xref ref-type="bibr" rid="c52">11</xref>]. When considering a clan-level analysis all coda samples where used to compute the VLMC models. However when analysing at a coda sample level, we discarded coda samples with less than 200 codas with statistical inference in mind, resulting in a final count of 57 coda samples (17046 codas) for the Pacific.</p>
<p>To model the ICI sequences in the datasets, we represented the ICIs by a finite set of symbols (or states), in three main steps (<xref ref-type="fig" rid="fig5">Fig. S1</xref>). First, we denoted X a continuous random variable that represents an ICI:
<disp-formula id="FD6">
<alternatives>
<mml:math id="M6" display="block"><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>I</mml:mi><mml:mi>C</mml:mi><mml:mi>I</mml:mi><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2307.05304v2_eqn6.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S1)</label>
</disp-formula>
</p>
<p>Second, we imposed an upper bound <italic>t</italic><sub>max</sub> on the values taken by <italic>X</italic>. This was to make sure that we are modeling with a finite number of states. Specially, in situations here the maximum number of states have to be known. We set this value to 1 second to be sure that it is longer than any ICI.</p>
<disp-formula id="FD7">
<alternatives>
<mml:math id="M7" display="block"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>ICI,t</mml:mtext></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2307.05304v2_eqn7.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S2)</label>
</disp-formula>
<p>Thirdly and finally, we discretized the values of the ICIs into a set of bins, akin to a histogram. We denote <italic>δt</italic> the width of these bins in seconds and call it the <italic>temporal resolution</italic> of the representation. Formally, we define
<disp-formula id="FD8">
<alternatives>
<mml:math id="M8" display="block"><mml:msub><mml:mi>X</mml:mi><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi><mml:mo>,</mml:mo><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>[</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:mi>min</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mtext>ICI,t</mml:mtext></mml:mrow><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>]</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2307.05304v2_eqn8.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S3)</label>
</disp-formula>
</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Supplementary Figure S1:</label>
<caption><title>Representing sperm whale communication as a sequence of symbols.</title>
<p>a The temporal patterns of click onsets are equivalently encoded as sequences of inter-click intervals (ICIs). <bold>b</bold> We discard ICI values larger than a threshold <italic>t</italic><sub>max</sub> seconds, and <bold>(c)</bold> discretize the others into a finite set of bins of width <italic>δt</italic> seconds. Each bin is then assigned a symbol (here a letter of the Latin alphabet), so that each symbol represents an ICI in a given range. <bold>d</bold> We then represent sperm whale communication as a sequence of these symbols.</p></caption>
<graphic xlink:href="2307.05304v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>By construction, this defines a discrete random variable that takes values in the finite set <inline-formula id="ID3">
<alternatives>
<mml:math display="inline" id="I3"><mml:mi>χ</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mn>0</mml:mn><mml:mo>,</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mo>…</mml:mo><mml:mo>,</mml:mo><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2307.05304v2_ieq3.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. Note that each element of this set represents a range of ICI values of length <italic>δt</italic> seconds. Any ICI value above <italic>t</italic><sub>max</sub> is mapped to the symbol <inline-formula id="ID4">
<alternatives>
<mml:math display="inline" id="I4"><mml:mrow><mml:mo>⌊</mml:mo><mml:mrow><mml:mfrac><mml:mrow><mml:msub><mml:mi>t</mml:mi><mml:mrow><mml:mi>max</mml:mi></mml:mrow></mml:msub></mml:mrow><mml:mrow><mml:mi>δ</mml:mi><mml:mi>t</mml:mi></mml:mrow></mml:mfrac></mml:mrow><mml:mo>⌋</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2307.05304v2_ieq4.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula>. It thus represents the end of a coda. We set the upper bound to <italic>t</italic><sub>max</sub> = 1 seconds and <italic>δt</italic> = 0.05 (see Section 3.3 for details about the choice of values).</p>
<p>We then modeled sperm whale communication sequences (<italic>X<sub>i</sub></italic>)<sub><italic>i</italic>∈ℕ</sub>. In addition, for clarity, we will denote the elements of <italic>χ</italic> by letters of the Latin alphabet A, B, and so on. In terms of terminology, we will also refer to <italic>χ</italic> as an alphabet, and to its elements as symbols or states, interchangeably.</p>
<sec id="s5a">
<title>1.1 ID and non-ID codas</title>
<p>Some coda types are considered ID for some clans but non-ID for others. The Pacific dataset [<xref ref-type="bibr" rid="c52">11</xref>] has annotations specifying this label (ID or non-ID) for each coda and each clan. For each clan, we counted the total number of codas that are ID and the total number of codas that are not (see <xref ref-type="table" rid="tbl2">Table S1</xref>).</p>
<p>We also provide similar statistics for the count of different coda types (see <xref ref-type="table" rid="tbl3">Table S2</xref>).</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Supplementary Table S1</label>
<caption><p>Count of Codas</p></caption>
<alternatives>
<graphic xlink:href="2307.05304v2_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
<table frame="hsides" rules="groups">
<thead>
<tr>
<th align="left" valign="top">Clan Name</th>
<th align="left" valign="top">Total</th>
<th align="left" valign="top">ID</th>
<th align="right" valign="top">Non-ID</th>
<th align="right" valign="top">Percentage of ID</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">Four Plus (FP)</td>
<td align="left" valign="top">2590</td>
<td align="right" valign="top">587</td>
<td align="right" valign="top">2003</td>
<td align="right" valign="top">22.66%</td>
</tr>
<tr>
<td align="left" valign="top">Palindrome (PALI)</td>
<td align="left" valign="top">2124</td>
<td align="right" valign="top">1249</td>
<td align="right" valign="top">875</td>
<td align="right" valign="top">58.8%</td>
</tr>
<tr>
<td align="left" valign="top">Plus One (PO)</td>
<td align="left" valign="top">2083</td>
<td align="right" valign="top">1252</td>
<td align="right" valign="top">831</td>
<td align="right" valign="top">60.11%</td>
</tr>
<tr>
<td align="left" valign="top">Regular (REG)</td>
<td align="left" valign="top">8289</td>
<td align="right" valign="top">3545</td>
<td align="right" valign="top">4744</td>
<td align="right" valign="top">42.77%</td>
</tr>
<tr>
<td align="left" valign="top">Rapid Increasing (RI)</td>
<td align="left" valign="top">1776</td>
<td align="right" valign="top">425</td>
<td align="right" valign="top">1351</td>
<td align="right" valign="top">23.93%</td>
</tr>
<tr>
<td align="left" valign="top">Short (SH)</td>
<td align="left" valign="top">5428</td>
<td align="right" valign="top">562</td>
<td align="right" valign="top">4866</td>
<td align="right" valign="top">10.35%</td>
</tr>
<tr>
<td align="left" valign="top">Slow Increasing (SI)</td>
<td align="left" valign="top">1265</td>
<td align="right" valign="top">541</td>
<td align="right" valign="top">724</td>
<td align="right" valign="top">42.77%</td>
</tr>
<tr>
<td align="left" valign="top">Total</td>
<td align="left" valign="top">23555</td>
<td align="right" valign="top">8161</td>
<td align="right" valign="top">15394</td>
<td align="right" valign="top">34.65%</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Supplementary Table S2</label>
<caption><p>Count of Coda Types</p></caption>
<alternatives>
<graphic xlink:href="2307.05304v2_tbl3.tif" mimetype="image" mime-subtype="tiff"/>
<table frame="hsides" rules="groups">
<thead>
<tr>
<th align="left" valign="top">Clan Name</th>
<th align="right" valign="top">Total</th>
<th align="right" valign="top">ID</th>
<th align="right" valign="top">Non-ID</th>
<th align="right" valign="top">Percentage of ID</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">Four Plus (FP)</td>
<td align="right" valign="top">72</td>
<td align="right" valign="top">2</td>
<td align="right" valign="top">70</td>
<td align="right" valign="top">2.78%</td>
</tr>
<tr>
<td align="left" valign="top">Palindrome (PALI)</td>
<td align="right" valign="top">64</td>
<td align="right" valign="top">9</td>
<td align="right" valign="top">55</td>
<td align="right" valign="top">14.06%</td>
</tr>
<tr>
<td align="left" valign="top">Plus One (PO)</td>
<td align="right" valign="top">54</td>
<td align="right" valign="top">6</td>
<td align="right" valign="top">48</td>
<td align="right" valign="top">11.11%</td>
</tr>
<tr>
<td align="left" valign="top">Regular (REG)</td>
<td align="right" valign="top">74</td>
<td align="right" valign="top">9</td>
<td align="right" valign="top">65</td>
<td align="right" valign="top">12.16%</td>
</tr>
<tr>
<td align="left" valign="top">Rapid Increasing (RI)</td>
<td align="right" valign="top">79</td>
<td align="right" valign="top">2</td>
<td align="right" valign="top">77</td>
<td align="right" valign="top">2.53%</td>
</tr>
<tr>
<td align="left" valign="top">Short (SH)</td>
<td align="right" valign="top">85</td>
<td align="right" valign="top">1</td>
<td align="right" valign="top">84</td>
<td align="right" valign="top">1.18%</td>
</tr>
<tr>
<td align="left" valign="top">Slow Increasing (SI)</td>
<td align="right" valign="top">59</td>
<td align="right" valign="top">3</td>
<td align="right" valign="top">56</td>
<td align="right" valign="top">5.08%</td>
</tr>
<tr>
<td align="left" valign="top">Total</td>
<td align="right" valign="top">487</td>
<td align="right" valign="top">32</td>
<td align="right" valign="top">455</td>
<td align="right" valign="top">6.57%</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="s6">
<title>2 The role of memory</title>
<p>A coda is a series of clicks emitted in fast succession. They have traditionally been identified by practitioners as building blocks for sperm whale communication. Whether or not codas themselves are composed by series of smaller collections of clicks is however an open question. We asked: are the codas the smallest such blocks, or is there structure at a scale shorter than codas—but longer than the individual clicks that constitute them? In order to answer this, we modeled sperm whale communication as higher-order Markov chains, that is, Markov chains with a memory h larger than or equal to one (but of fixed length)—see Section 2 for details. In other words, we assume that the probability of observing an ICI within given range—here referred to as symbol or state—depends on the <italic>h</italic> previous states. For a given <italic>h</italic>, we fit this Markov model to the data by estimating the transition probabilities from sequence of <italic>h</italic> state to any other state.</p>
<p>The results are summarized in <xref ref-type="fig" rid="fig6">Fig. S2</xref>, for a range of memory values <italic>h</italic>, and for two temporal resolutions for the binning of the ICIs. We note that there is a bifurcation between two different behaviors around <italic>h</italic> ≈ 3: transition probabilities go from very low (approximately random transitions) to very large (almost deterministic transitions). Indeed, for <italic>h</italic> &lt; 3, these probabilities are very low [<xref ref-type="fig" rid="fig6">Fig. S2(a)</xref>] and all similar [<xref ref-type="fig" rid="fig6">Fig. S2(b)</xref>]. All possible next states are equally likely, but not very likely: this indicates underfitting. On the contrary, for <italic>h</italic> &gt; 3, the transition probabilities are all close to one and all similar. Moreover, only a few of them are non-zero [<xref ref-type="fig" rid="fig6">Fig. S2(c)</xref>]. Given a sequence longer than three, only one next state can be observed: this indicates overfitting. Finally, for <italic>h</italic> ≈ 3, transition probabilities are heterogeneous: their average is between 0 and 1, their variance exhibits a peak, and more than one state can potentially be observed next. Moreover, the Akaike Information Criterion (AIC) displays a minimum around that value of the memory, which indicates that it provides a good trade-off between variance of the data explained and the number of parameters needed for the model.</p>
<p>This transition around h ≈ 3 suggests that there is structure at that level of memory, which is shorter than most coda types. This motivates our search for structure within codas. However, fixed-memory Markov Chains do not allow for different configurations to have different levels of memory, which leads to variable length Markov Chains (described in the next section).</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Supplementary Figure S2</label>
<caption><title>Fixed length Markov model bifurcates as a function of memory length <italic>h</italic>.</title>
<p>We show <bold>(a)</bold> the mean, and <bold>(b)</bold> the variance of the transition probabilities as a function of <italic>h</italic>. We also show <bold>(c)</bold> the number of non-zero transition probabilities per state, and <bold>(d)</bold> the AIC. The dashed and dotted lines represent two different temporal resolutions (i.e., bin size used during Preprocessing). There is a bifurcation around <italic>h</italic> ≈ 3 that suggests subcoda structure.</p></caption>
<graphic xlink:href="2307.05304v2_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s7">
<title>3 Variable Length Markov Chains</title>
<p>Some states can be predicted with more or less memory of past states than others. This observation is the base motivation for introducing variable length Markov Chains (VLMCs) which go beyond the fixed-memory limit of traditional Markov chains. Take for example a state <italic>X</italic><sub>2</sub> that has the same probability of occurring knowing the last two states (<italic>x</italic><sub>0</sub><italic>x</italic><sub>1</sub> ∈ <italic>χ</italic><sup>2</sup>) or only the last state (<italic>x</italic><sub>1</sub> ∈ <italic>χ</italic><sup>1</sup>:
<disp-formula id="FD9">
<alternatives>
<mml:math id="M9" display="block"><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2307.05304v2_eqn9.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S4)</label>
</disp-formula>
</p>
<p>In this case, a shorter memory (<italic>h</italic> = 1) is sufficient and we do not need a longer one (<italic>h</italic><sub>2</sub>).</p>
<p>In practice, VLMCs bypass the necessity of having (<italic>n</italic> − 1)<italic>n<sup>h</sup></italic> parameters by allowing states to have unequal lengths (memory). Smaller lengths are preferred whenever the additional memory does not significantly change the distribution of transitions to the next possible states.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Supplementary Figure S3</label>
<caption><title>Steps for fitting a VLMC from a sequence.</title>
<p>Step 1 (a): Construction of the full (<italic>or saturated</italic>) suffix tree up to maximum depth <italic>D</italic>. Step 2 (b): Assigning a probability measure to every element of the tree. Step 3 (c) Pruning of nodes that carry the same information content as parents according to <xref ref-type="disp-formula" rid="FD15">Eq. (S10)</xref>. In this example, context <italic>CBA</italic> is relevant because it changes the distribution of transition probabilities with respect to its parent <italic>BA</italic> and therefore it is not pruned.</p></caption>
<graphic xlink:href="2307.05304v2_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s7a">
<title>3.1 Building a VLMC</title>
<p>For a Markov model of fixed order <italic>h</italic>, the set of possible states <italic>χ<sup>h</sup></italic> is composed of all possible sequences of length <italic>h</italic>. For a VLMC, however, states can be sequences of arbitrary length. The set of possible states is thus a subset of the set of all sequences that can be built from the alphabet <italic>χ</italic>, including the empty sequence <italic>χ</italic><sup>0</sup> = ∅. Let <italic>W</italic> denote this set.</p>
<disp-formula id="FD10">
<alternatives>
<mml:math id="M10" display="block"><mml:mi>W</mml:mi><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∪</mml:mo><mml:mi>i</mml:mi><mml:mi>∞</mml:mi></mml:munderover><mml:mrow><mml:msup><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2307.05304v2_eqn10.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S5)</label>
</disp-formula>
<p>In this project, because codas are typically constructed from a small number of clicks, we only consider <italic>finite</italic> length sequences (see [?] for non-finite VLMCs). In practice, we choose a <italic>maximum</italic> memory allowed <italic>D</italic>, which we set to <italic>D</italic> = 10, much larger than the typical coda length.</p>
<disp-formula id="FD11">
<alternatives>
<mml:math id="M11" display="block"><mml:msub><mml:mi>W</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∪</mml:mo><mml:mi>i</mml:mi><mml:mrow><mml:mi>D</mml:mi><mml:mo>=</mml:mo><mml:mn>10</mml:mn></mml:mrow></mml:munderover><mml:mrow><mml:msup><mml:mi>χ</mml:mi><mml:mi>i</mml:mi></mml:msup></mml:mrow></mml:mstyle></mml:math>
<graphic xlink:href="2307.05304v2_eqn11.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S6)</label>
</disp-formula>
<p>Fitting a VLMC is the process of finding some subset <italic>L</italic> ⊆ <italic>W<sub>D</sub></italic> where the elements satisfy the condition: shorter states are preferred if their distribution of transition probabilities is similar to their longer length equivalents. This is generally called context tree estimation in the literature [?].</p>
<sec id="s7a1">
<sec id="s7a1a">
<title>Probabilising the tree</title>
<p>We start with <italic>W<sub>D</sub></italic> for some <italic>D</italic> which we take to be equal to 10. To each element of <italic>w</italic> ∈ <italic>W<sub>D</sub></italic> we assign a probability distribution <italic>q<sub>w</sub></italic> over the set <italic>χ</italic> as the probability of observing a state <italic>x</italic> ∈ <italic>χ</italic> given a previous sequence <italic>w</italic>.</p>
<disp-formula id="FD12">
<alternatives>
<mml:math id="M12" display="block"><mml:msub><mml:mi>q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>|</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2307.05304v2_eqn12.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S7)</label>
</disp-formula>
<p>Where <italic>P</italic> denotes the likelihood estimation computed as
<disp-formula id="FD13">
<alternatives>
<mml:math id="M13" display="block"><mml:msub><mml:mi>q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>X</mml:mi><mml:mo>=</mml:mo><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:msub><mml:mo>∑</mml:mo><mml:mrow><mml:mi>c</mml:mi><mml:mo>∈</mml:mo><mml:mi>χ</mml:mi></mml:mrow></mml:msub><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>c</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math>
<graphic xlink:href="2307.05304v2_eqn13.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S8)</label>
</disp-formula>
</p>
<p>where <italic>N (w)</italic> the number of occurrences of the sequence <italic>w</italic>.</p>
</sec>
<sec id="s7a1b">
<title>Pruning the tree</title>
<p>Given two sequences <italic>u, w</italic> ∈ <italic>W<sub>D</sub></italic>, we say that <italic>u</italic> is a suffix of <italic>w</italic> if <italic>w</italic> = <italic>σu</italic> for some other sequence <italic>σ</italic> of length ≥ 1. If <italic>σ</italic> ∈ <italic>χ</italic> we say that <italic>u</italic> is a parent of <italic>w</italic>. That is, <italic>u</italic> is a parent of <italic>w</italic> if <italic>u</italic> is a suffix of <italic>w</italic> and <italic>w</italic> is longer by only one letter.</p>
<p>In an intuitive way, <italic>u</italic> is a parent of <italic>w</italic> if <italic>w</italic> “looks into the past” one step further than <italic>u</italic>. At the core of the VLMC is measuring the information gain in using the longer memory <italic>u</italic> instead of its shorter memory parent <italic>w</italic>. If this information gain is not sufficient, then we discard the longer memory <italic>u</italic>. We measure the information gain in using the longer memory <italic>w</italic> instead of <italic>u</italic> with a weighted Kullback-Leibler (KL) divergence DKL [<xref ref-type="bibr" rid="c78">37</xref>]:
<disp-formula id="FD14">
<alternatives>
<mml:math id="M14" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>Δ</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>u</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>  </mml:mtext><mml:mo>=</mml:mo><mml:mi>N</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>χ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>w</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>P</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>u</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2307.05304v2_eqn14.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S9)</label>
</disp-formula>
</p>
<p>The longer memory sequence <italic>w</italic> is kept if and only if the information gain is greater than some threshold <italic>K</italic> [<xref ref-type="bibr" rid="c79">38</xref>, <xref ref-type="bibr" rid="c80">39</xref>]. Refer to Section 3.3 for a discussion on the value of <italic>K</italic>. The set of all sequences that respect the above threshold are called <italic>contexts</italic>, and denoted by <italic>T</italic>:
<disp-formula id="FD15">
<alternatives>
<mml:math id="M15" display="block"><mml:mi>T</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>D</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mi>Δ</mml:mi><mml:msub><mml:mi>H</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>&gt;</mml:mo><mml:mi>K</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2307.05304v2_eqn15.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S10)</label>
</disp-formula>
</p>
<p>A VLMC is the the Markov model with the set of states:
<disp-formula id="FD16">
<alternatives>
<mml:math id="M16" display="block"><mml:mi>L</mml:mi><mml:mo>=</mml:mo><mml:mrow><mml:mo>{</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mi>x</mml:mi><mml:mo>|</mml:mo><mml:mi>t</mml:mi><mml:mo>∈</mml:mo><mml:mi>T</mml:mi><mml:mo>,</mml:mo><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>χ</mml:mi></mml:mrow><mml:mo>}</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2307.05304v2_eqn16.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S11)</label>
</disp-formula>
</p>
<p>and with transition probabilities defined by <italic>q<sub>w</sub></italic> for <italic>w</italic> ∈ <italic>T</italic>.</p>
</sec>
</sec>
</sec>
<sec id="s7b">
<title>3.2 Model Selection</title>
<p>When modeling a process (<italic>X<sub>i</sub></italic>)<sub><italic>i</italic>∈ℕ</sub> with a Markov model, the memory length <italic>h</italic> controls the trade-off between complexity and error. Higher memory values tend to result in models that generalize poorly. On the other hand, lower values of <italic>h</italic> fail to capture the patterns, resulting in a uniformly random model.</p>
<p>To choose an appropriate value of <italic>h</italic>, it is common to employ some statistic that measures the trade-off between precision in prediction and the number of parameters. A model with high predictability and a low number of parameters is favored. There is a wide range of metrics [?] and one of the most widely used is the AIC [?, ?]:
<disp-formula id="FD17">
<alternatives>
<mml:math id="M17" display="block"><mml:mtext>AIC=2</mml:mtext><mml:mi>k</mml:mi><mml:mo>−</mml:mo><mml:mn>2</mml:mn><mml:mi>log</mml:mi><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>ℕ</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2307.05304v2_eqn17.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S12)</label>
</disp-formula>
</p>
<p><inline-formula id="ID5">
<alternatives>
<mml:math display="inline" id="I5"><mml:mover accent="true"><mml:mi>P</mml:mi><mml:mo stretchy="true">^</mml:mo></mml:mover><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>X</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>i</mml:mi><mml:mo>∈</mml:mo><mml:mi>ℕ</mml:mi></mml:mrow></mml:msub><mml:mo>|</mml:mo><mml:msub><mml:mi>M</mml:mi><mml:mi>h</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2307.05304v2_ieq5.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> is the maximum likelihood of the sequence (<italic>X<sub>i</sub></italic>)<sub><italic>i</italic>∈ℕ</sub> given the Markov model <italic>M<sub>h</sub></italic> with memory length <italic>h</italic> and <italic>k</italic> parameters (transition probabilities). The best model is indicated by the lowest AIC.</p>
</sec>
<sec id="s7c">
<title>3.3 Parameter sensitivity</title>
<sec id="s7c1">
<title>3.3.1 Information gain threshold <italic>K</italic></title>
<p>The threshold value <italic>K</italic> represents the minimum information gain necessary to increment the memory of a given context by one. This value ultimately influences the depth and shape of the VLMC model. Low thresholds result in deep trees with many parameters and are prone to overfitting, whereas small threshold values cause trees to not expand past low values of memory and potentially fail to capture statistical dependencies (<xref ref-type="fig" rid="fig8">Fig. S4</xref>).</p>
<p>The best value of <italic>K</italic> should be the one that outputs the optimal VLMC model (i.e., the one that minimizes the AIC).</p>
<disp-formula id="FD18">
<alternatives>
<mml:math id="M18" display="block"><mml:mi>arg</mml:mi><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mrow><mml:mi>T</mml:mi><mml:mo>⊆</mml:mo><mml:msub><mml:mi>W</mml:mi><mml:mi>D</mml:mi></mml:msub></mml:mrow></mml:munder><mml:mtext>AIC</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>T</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2307.05304v2_eqn18.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S13)</label>
</disp-formula>
<p>However, this search is done over the entire set of possible context trees. The problem of estimating the optimal context tree is an ongoing research area although many good methods have been proposed [<xref ref-type="bibr" rid="c80">39</xref>].</p>
<p>For some threshold K. The above dissimilarity is an expression of differences of deviances and as such follows an asymptotic <inline-formula id="ID6">
<alternatives>
<mml:math display="inline" id="I6"><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:math>
<inline-graphic xlink:href="2307.05304v2_ieq6.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> distribution [<xref ref-type="bibr" rid="c79">38</xref>] with |<italic>χ</italic>|−1 degrees of freedom. As such we can set the <italic>K</italic> thresholds to represent quantiles of a <italic>χ</italic><sup>2</sup> distribution. We use the 0.95 quantile, meaning we keep the child whose additional memory exceeds the value:
<disp-formula id="FD19">
<alternatives>
<mml:math id="M19" display="block"><mml:mi>K</mml:mi><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mn>2</mml:mn></mml:mfrac><mml:msup><mml:mi>χ</mml:mi><mml:mn>2</mml:mn></mml:msup><mml:mrow><mml:mo>|</mml:mo><mml:mi>χ</mml:mi><mml:mo>|</mml:mo></mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn><mml:mo>,</mml:mo><mml:mn>0.95</mml:mn></mml:math>
<graphic xlink:href="2307.05304v2_eqn19.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S14)</label>
</disp-formula>
</p>
<fig id="fig8" position="float" fig-type="figure">
<label>Supplementary Figure S4</label>
<caption><title>Selecting the optimal information cutoff <italic>K</italic>.</title>
<p>The AIC for different VLMC models with respect to the cutoff value <italic>(K)</italic> used to build them. Above are some context trees associated with three different VLMCs. The trees decrease in size for the threshold increases since the information gain has to be greater for a context to be “accepted” in the tree. This effect is also visible in the average path length which can be seen as the average memory of the model.</p></caption>
<graphic xlink:href="2307.05304v2_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s7c2">
<title>3.3.2 Temporal resolution <italic>δt</italic></title>
<p>The temporal resolution <italic>τt</italic> denotes the scale at which we discretize the continuous, absolute ICI values into bins. A small value might provide differentiation between clicks, but also burdens the VLMC models by increasing the number of parameters and states.</p>
<p>To select the most appropriate resolution parameter, one might be tempted to compare the AIC obtained from different VLMC models extracted from data at different resolutions. However, that is not possible since models fit on different data are not really comparable. Imagine the extreme case with a time resolution so large that all clicks are mapped to the same discrete symbol: any model fit on this data would achieve an optimal AIC value.</p>
<p>In our case, we compare the AIC obtained from the VLMC model with the AIC obtained from a fixed length Markov model of order 0 fitted to the same aggregated data. The intuition behind this approach is that the zero length Markov model represents how “easy” it is to predict the data. The best resolution would be the one where the difference between the AIC of our fit VLMC is the biggest when compared to the 0<sup><italic>th</italic></sup> order Markov model (<xref ref-type="fig" rid="fig9">Fig. S5</xref>).</p>
<fig id="fig9" position="float" fig-type="figure">
<label>Supplementary Figure S5</label>
<caption><title>Selecting the optimal temporal resolution.</title>
<p>The temporal resolution parameter <italic>δt</italic> for the preprocessing steps is chosen by subtracting the AIC of the 0th order memory Markov model from the AIC of a VLMC model, which encodes how well the model predict versus how easy it is to predict the data. We use this setup because the AIC alone is not sufficient, because the actual fitted dataset changes with the resolution parameter, and thus models with different <italic>δt</italic> are not directly comparable. The minimum value is the best resolution parameter although any value between 0.01 and 0.1 seems acceptable. We show this for three individual sperm whales (colors) from the Dominica dataset.</p></caption>
<graphic xlink:href="2307.05304v2_fig9.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s7d">
<title>3.4 Quantitative comparison of VLMCs</title>
<p>The KL divergence is one of the most used methods for measuring statistical dissimilarity between two distributions, mostly due to its connections to information-theory. Being a generative model, a VLMC is not a single probability distribution, but a set of distributions <italic>q<sub>w</sub></italic> one for each context <italic>w</italic> ∈ <italic>T</italic>.</p>
<p>Given two VLMC models <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> over the same alphabet <italic>χ</italic>. Let <italic>p</italic> and <italic>q</italic> be their associated sets of transitions distributions, respectively. We define the divergence <italic>d</italic><sub><italic>KL</italic></sub>(<italic>T</italic><sub>1</sub>, <italic>T</italic><sub>2</sub>) between them as the average KL divergence between the set of associated transition distributions.</p>
<p>However, there may not be a one-to-one map between <italic>q</italic><sub><italic>w</italic></sub> and <italic>p</italic><sub><italic>w</italic></sub>. In fact, more often than not <italic>T</italic><sub>1</sub> and <italic>T</italic><sub>2</sub> have a different number of contexts. As such, for every <italic>w</italic> ∈ <italic>T</italic><sub>1</sub> we associate <italic>u</italic> ∈ <italic>T</italic><sub>2</sub> where <italic>u</italic> is the longest suffix of <italic>w</italic> that belongs to <italic>T</italic><sub>2</sub>. This results in a dissimilarity measure that captures not just the difference in emission distribution but also the structural differences of the associated context trees:</p>
<sec id="s7d1">
<sec id="s7d1a">
<title>Divergence</title>
<p>Given two VLMCs (<italic>T</italic><sub>1</sub>, <italic>(qw</italic>)w∈T<sub>1</sub>) and (T<sub>2</sub>, <italic>(pw</italic>)<italic>w∈T</italic><sub>2</sub>) built over the finite alphabet <italic>χ</italic> we define the distance:
<disp-formula id="FD20">
<alternatives>
<mml:math id="M20" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>d</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>,</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:mi>p</mml:mi><mml:munder><mml:mo>←</mml:mo><mml:mrow><mml:mtext>pref</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mtext>    </mml:mtext><mml:mo>=</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mrow><mml:mrow><mml:mo>|</mml:mo><mml:mrow><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow><mml:mo>|</mml:mo></mml:mrow></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>w</mml:mi><mml:mo>∈</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:munder><mml:mrow><mml:mstyle displaystyle="true"><mml:munder><mml:mo>∑</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>∈</mml:mo><mml:mi>χ</mml:mi></mml:mrow></mml:munder><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>w</mml:mi></mml:msub><mml:mi>log</mml:mi><mml:mfrac><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>w</mml:mi></mml:msub></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:munder><mml:mo>←</mml:mo><mml:mrow><mml:mtext>pref</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle></mml:mrow></mml:mstyle></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2307.05304v2_eqn20.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S15)</label>
</disp-formula>
</p>
<p>Where <inline-formula id="ID7">
<alternatives>
<mml:math display="inline" id="I7"><mml:munder><mml:mo>←</mml:mo><mml:mrow><mml:mtext>pref</mml:mtext><mml:mrow><mml:mo>(</mml:mo><mml:mi>w</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:munder></mml:math>
<inline-graphic xlink:href="2307.05304v2_ieq7.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
</inline-formula> denotes the longest suffix of <italic>w</italic> ∈ <italic>T</italic><sub>1</sub> that belongs to <italic>T</italic><sub>2</sub>.</p>
<disp-formula id="FD21">
<alternatives>
<mml:math id="M21" display="block"><mml:munder><mml:mo>←</mml:mo><mml:mrow><mml:mtext>pref</mml:mtext></mml:mrow></mml:munder><mml:mo>:</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mo>→</mml:mo><mml:msub><mml:mi>T</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:math>
<graphic xlink:href="2307.05304v2_eqn21.tif" mimetype="image" mime-subtype="tiff"/></alternatives>
<label>(S16)</label>
</disp-formula>
<fig id="fig10" position="float" fig-type="figure">
<label>Supplementary Figure S6</label>
<caption><title>Measuring dissimilarity between two VLMC models.</title>
<p>The two trees represent two VLMCs models built over the same alphabet <italic>χ</italic>. We measure their dissimilarity or distance with the KL divergence.</p></caption>
<graphic xlink:href="2307.05304v2_fig10.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s7d2">
<title>3.4.1 Statistical testing on distribution of the distances</title>
<p>We fit a VLMC model on coda samples/social units from different clans on both the Pacific and Dominica dataset. For each clan we compute the distances between all VLMC models belonging to that clan (<italic>within</italic>) and between the models of the clan to the ones belonging to other clans (<italic>between</italic>) (<xref ref-type="fig" rid="fig11">Fig. S7</xref>). On each pair (<italic>within/between</italic>) we tested the distributions to check if they both came from the same populations. We employed both the <italic>Kolmogorov-Smirnov</italic> test and the <italic>T-</italic>Test. We also measured the effect size using <italic>Cohen’s</italic> method. The resulting statistics for both datasets can be found in the tables below.</p>
</sec>
<sec id="s7d3">
<title>3.4.2 Non-ID results by coda type</title>
<p>In this section we repeat the approach on comparing the geographical clan overlap with the VLMC distance on non-ID codas. In contrast to the main text, we segment each set of codas by coda type and note the slope, the p-value of the Pearson correlation and the p-value according to a Spearman correlation, <xref ref-type="table" rid="tbl5">Table S4</xref>. Just as the main text, when segmenting by coda type we observe that the vast majority of correlations is negative, i.e., geographically overlapped clans have a more similar communication. However, although most correlations are negative, only a small portion is significant. It is important to take into consideration that the amount of data used to fit each VLMC model is considerably reduced given the extra segmentation. Furthermore, coda types that were uttered exclusively by only two clans were also omitted as it is always possible to draw a line between two points, and thus a linear analysis makes little sense.</p>
<fig id="fig11" position="float" fig-type="figure">
<label>Supplementary Figure S7</label>
<caption><title>Comparison of the distribution of distances between VLMC models, with statistical significance.</title>
<p>Each color represents a clan of a given dataset: Pacific <bold>A)</bold> and Dominica <bold>B)</bold>. The <italic>within</italic> distribution represents the distance between VLMC models fit on elements of the same clan. The <italic>between</italic> represent the distance between VLMC models of different clans.</p></caption>
<graphic xlink:href="2307.05304v2_fig11.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig12" position="float" fig-type="figure">
<label>Supplementary Figure S8</label>
<caption><title>VLMC distance and geographical overlap relation by coda type.</title>
<p>each bar represents a number of unique coda types. Note that almost all coda types have a negative correlation with geographical overlap, although only a small portion is significant. The p-values shown are with respect to the Pearson correlation, <xref ref-type="table" rid="tbl5">Table S4</xref></p></caption>
<graphic xlink:href="2307.05304v2_fig12.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Supplementary Table S3</label>
<caption><title>Distance distribution statistics.</title>
<p>Table with the <italic>p-</italic> values and the effect size corresponding to the comparison of the <italic>within/between</italic> distance distributions of coda samples from the Dominica clans (top) and the Pacific clans (bottom), under the Kolmogorov-Smirnov (K-S test) and the T-Test.</p></caption>
<alternatives>
<graphic xlink:href="2307.05304v2_tbl4.tif" mimetype="image" mime-subtype="tiff"/>
<table frame="hsides" rules="groups">
<thead>
<tr>
<th align="left" valign="top">Clan</th>
<th align="center" valign="top">K-S test</th>
<th align="center" valign="top">T-test</th>
<th align="center" valign="top">Effect Size</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">EC1</td>
<td align="center" valign="top">1.5 × 10<sup>−16</sup></td>
<td align="center" valign="top">1 × 10<sup>−24</sup></td>
<td align="center" valign="top">−2.4</td>
</tr>
<tr>
<td align="left" valign="top">EC2</td>
<td align="center" valign="top">0.0019</td>
<td align="center" valign="top">0.0006</td>
<td align="center" valign="top">−1.9</td>
</tr>
<tr>
<td align="left" valign="top">Four Plus</td>
<td align="center" valign="top">1.7 × 10<sup>−7</sup></td>
<td align="center" valign="top">6.2 × 10<sup>−6</sup></td>
<td align="center" valign="top">−0.67</td>
</tr>
<tr>
<td align="left" valign="top">Palindrome</td>
<td align="center" valign="top">6.7 × 10<sup>−17</sup></td>
<td align="center" valign="top">6.7 × 10<sup>−13</sup></td>
<td align="center" valign="top">−1.3</td>
</tr>
<tr>
<td align="left" valign="top">Plus One</td>
<td align="center" valign="top">6.9 × 10<sup>−21</sup></td>
<td align="center" valign="top">2.4 × 10<sup>−14</sup></td>
<td align="center" valign="top">−1.6</td>
</tr>
<tr>
<td align="left" valign="top">Regular</td>
<td align="center" valign="top">4.2 × 10<sup>−27</sup></td>
<td align="center" valign="top">7.2 × 10<sup>−28</sup></td>
<td align="center" valign="top">−0.76</td>
</tr>
<tr>
<td align="left" valign="top">Rapid Increasing</td>
<td align="center" valign="top">0.00016</td>
<td align="center" valign="top">0.0005</td>
<td align="center" valign="top">−0.72</td>
</tr>
<tr>
<td align="left" valign="top">Short</td>
<td align="center" valign="top">6.5 × 10<sup>−14</sup></td>
<td align="center" valign="top">9.9 × 10<sup>−18</sup></td>
<td align="center" valign="top">−0.67</td>
</tr>
<tr>
<td align="left" valign="top">Slow Increasing</td>
<td align="center" valign="top">1.6 × 10<sup>−9</sup></td>
<td align="center" valign="top">1.6 × 10<sup>−7</sup></td>
<td align="center" valign="top">−1.4</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<sec id="s7d4">
<title>3.4.3 Stability under different resolutions</title>
<p>We also show that our results about the effect of sympatry on non-ID coda vocal styles hold for different values of the time resolution. That is, that the parameter preprocessing steps and the method parameters have little to no effect on the fundamental results of our approach. In <xref ref-type="fig" rid="fig13">Fig. S9</xref> we repeat the analysis of the main text. We compare the geographical overlap with the distance between the VLMC of the pacific clans on both non-ID and ID codas.</p>
<p>We observe that regardless of the time resolution used in the method (for discretizing the continuous ICIs into discrete ICIs), our results hold. That is, there is never a significant correlation between overlap and ID codas and that there is always a negative correlation between clan overlap and non-ID codas.</p>
</sec>
</sec>
<sec id="s7e">
<title>3.5 Dependence on Coda Type</title>
<p>In this section we provide results highlighting the lack of correlation between VLMC (subcoda tree) similarity and coda type distribution. First, rythmic variations on how each coda type is <italic>constructed</italic> are present and are indicative of the clan (<xref ref-type="fig" rid="fig15">Fig. S11</xref> and <xref ref-type="fig" rid="fig14">Fig. S10</xref>). For example, the way the clan EC1 vocalizes codas of type <italic>8R</italic> is significantly different from the clan EC2 (<xref ref-type="fig" rid="fig15">Fig. S11</xref>).</p>
<p>In fact one can fit a VLMC on each coda type and compare each VLMC (segmented by coda type and clan) between both elements of the same clan and elements of different clans. We observe that there is a statistically significant difference between the distances of VLMC from different clans and VLMC of the same clan (<xref ref-type="fig" rid="fig14">Fig. S10</xref>). This indicates that whales vocalize different coda types in a clan-distinctive manner. Which also point to an independence between vocal style and coda type distribution.</p>
<fig id="fig13" position="float" fig-type="figure">
<label>Supplementary Figure S9</label>
<caption><title>Results are significant for different resolutions.</title>
<p>The dotted line represents the 0.05 confidence value. When varying the time resolution used for fitting the VLMCs we observe that our main results persist: ID codas are not related with geographical overlap while non-ID codas always are. The bottom row shows two illustrations of the bin sizes (and subsequently the number of different states) resulting from the preprocessing using 0.01 and 0.1 seconds time resolution respectively.</p></caption>
<graphic xlink:href="2307.05304v2_fig13.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig14" position="float" fig-type="figure">
<label>Supplementary Figure S10</label>
<caption><title>Clans vocalize different coda types in a distinctive manner</title>
<p>Boxplots for the distances between VLMC’s segmented by coda type and clan (Pacific <bold>A</bold> and Dominica <bold>B</bold>). We observe that VLMC fit on different coda types but from the same clan and more similar than when compared with across clans.</p></caption>
<graphic xlink:href="2307.05304v2_fig14.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s7e1">
<title>3.5.1 Comparing Dendrograms</title>
<p>Using the distance between the VLMC trees it is possible to create a hierarchical plot of the coda samples. One can find it beneficial to compare our resulting hierarchical plot with the clan labels from [<xref ref-type="bibr" rid="c52">11</xref>] where the authors group the whales by coda type usage and divide the Pacific clans into the aforementioned 7 clans. However, comparing a dendrogram with a realized set of labels is not trivial. On the other hand, an effective comparison of two sets of labels can be achieved using the <italic>Adjusted Rand Score</italic>, or other entropy based metrics. The Adjusted Rand Score has a value of 0.0 for random labeling (independent of number of clusters) and 1.0 for clusters that match perfectly. The lowest possible score is −0.5 for exceptionally disparate clusterings.</p>
<fig id="fig15" position="float" fig-type="figure">
<label>Supplementary Figure S11</label>
<caption><title>A) and C) Rhythmic variations within coda types.</title>
<p>All codas of type <italic>8R</italic> that were vocalized by whales of the Dominican clan EC1 (blue) and EC2 (green), along with the average position and variation over all vocalizations. <bold>B) No correlation with coda type distribution</bold>. Comparison between VLMC distance and KL-Divergence (entropy) between coda type distributions on the data used to fit the VLMC.</p></caption>
<graphic xlink:href="2307.05304v2_fig15.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To obtain two sets of labels we progressively cut the dendrogram obtained by the VLMC and compared the set of labels with the clan labels from [<xref ref-type="bibr" rid="c52">11</xref>]. At each cut we calculate the adjusted rand score (results in <xref ref-type="fig" rid="fig16">Fig. S12</xref>). We observed a maximum value of 0.5. This reiterates not only the concordance with the pre-existing vocal usage clans but also emphasizes that vocal style is capturing new information at a different, lower, scale.</p>
</sec>
</sec>
<sec id="s7f">
<title>3.6 Confidence Interval on relation between non-id coda style and clan overlap</title>
<p>An interval confidence for the slope for the result in <xref ref-type="fig" rid="fig4">Figure 4</xref> can be achieved by subsampling the data (1000 times) and running the same linear regression analysis on the subsampled data. From the resulting distribution of regression slopes we observe that the 95% confidence intervals for the non-ID scenario contains only values with negative slope, while on the ID case, the confidence interval contains both negative and positive values (<xref ref-type="fig" rid="fig17">Fig. S13</xref>)</p>
<fig id="fig16" position="float" fig-type="figure">
<label>Supplementary Figure S12</label>
<caption><title>Adjusted Rand Score for VLMC clustering dendrogram</title>
<p>Comparison of the dendrogram obtained from the VLMC distance between the trees with the vocal clan labels. The values of the Adjusted Rand Score go from −0.5 to 1.</p></caption>
<graphic xlink:href="2307.05304v2_fig16.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig17" position="float" fig-type="figure">
<label>Supplementary Figure S13</label>
<caption><title>Bootstraping regression results of <xref ref-type="fig" rid="fig4">Figure 4</xref>.</title>
<p>Resulting distribution of slope values for subsamples of the data for the ID coda case <bold>A</bold> and the non-ID case <bold>B</bold>. The shaded area represents the 95% confidence interval.</p></caption>
<graphic xlink:href="2307.05304v2_fig17.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s8">
<title>4 Classification of synthetic codas</title>
<p>The fixed-length Markov chains described above lack flexibility: a model with large memory <italic>h</italic> generalizes better but requires estimating an ever-increasing number of parameters. For this reason, we then used VLMCs, which combine the best of both worlds by determining the optimal memory needed for each transition individually. Essentially, we keep a transition probability with a longer memory <italic>P</italic>(<italic>X<sub>i</sub></italic>|<italic>x<sub>j</sub>x<sub>k</sub></italic>) only if it changes the distribution sufficiently compared to a short memory one <italic>P</italic>(<italic>X<sub>i</sub></italic>|<italic>x<sub>j</sub></italic>).</p>
<p>A VLMC can be naturally visualized as a tree, where the concept of order arises from the fact that shorter memory contexts are subsequences of longer ones. In <xref ref-type="fig" rid="fig18">Fig. S14A and B</xref>, we show examples of two VLMCs computed from data from a single sperm whale each. The visual structure of these trees can be related to the actual information-theoretic structure of these sperm whales’ communication. Indeed, the root node is represented in orange, and nodes that are depth <italic>h</italic> in the tree (that is h edges away from the root node) represent context (or sequences) of memory <italic>h</italic>. To verify that the structure we observe actually contains information, we need to compare it to the structure of a null model. To do this, we took the same ICI time series used to build the tree from <xref ref-type="fig" rid="fig18">Fig. S14A</xref>, and randomly shuffled its ICIs. This way, all temporal information is lost. This results in a tree that has no structure, as shown in <xref ref-type="fig" rid="fig18">Fig. S14C</xref>. The VLMC-indicated structure can thus be interpreted as coming from the sperm whale communication.</p>
<fig id="fig18" position="float" fig-type="figure">
<label>Supplementary Figure S14</label>
<caption><title>VLMCs capture structure of sperm whale communication.</title>
<p>We show context trees associated with the variable length models built for two individual sperm whales: (<bold>a</bold>) <italic>ATWOOD</italic>, and (<bold>b</bold>) <italic>FORK</italic>. For comparison, we show (<bold>c</bold>) the corresponding tree after randomly shuffling ICIs from the same timeseries data used to build (<bold>a</bold>). Note how the shuffled version does not exhibit any structure. The orange node represents the root node, and the size of each node represents the number of occurrences of the associated context.</p></caption>
<graphic xlink:href="2307.05304v2_fig18.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Having confirmed that our VLMCs capture some communication structure, we ask: What and how much structure does it capture? To answer this, we took advantage of two facts. First, the VLMCs can be used to generate new codas by generating sequences of states that correspond to ICIs. Indeed, like for any Markov model, we can start from the empty sequence, and start adding suffixes with probabilities defined by the model (see Methods). In other words, we can generate synthetic data. Second, in [<xref ref-type="bibr" rid="c53">12</xref>] the authors present an LSTM-based classifier capable of assigning a coda to a specific clan with over 90% accuracy. We trained it on the original ICI data used to build our trees, achieving similar accuracy as shown by the black curve in <xref ref-type="fig" rid="fig19">Fig. S15</xref>. To verify how much information our VLMCs capture, we used that trained classifier on the synthetic codas generated with our trees. Remarkably, it classified the generated data with between 70 and 80% accuracy, depending on the temporal resolution <italic>5t</italic> (blue in <xref ref-type="fig" rid="fig19">Fig. S15</xref>). The fairly small difference in accuracy between the real and synthetic data indicates that a large part of the communication structure captured by the classifier in the real data is also captured by our VLMC models.</p>
<fig id="fig19" position="float" fig-type="figure">
<label>Supplementary Figure S15</label>
<caption><title>Deep learning classifier trained on real communication data generalises well to synthetic data generated by the VLMCs.</title>
<p>We show (<bold>a</bold>) the accuracy of the classifier on the real data (in black) and the synthetic data (in blue), as a function of the temporal resolution <italic>δt</italic>. The dashed grey curve highlights the maximum accuracy of on the generated data. The classifier’s task was to identify to which of (<bold>b</bold>) two clans the data belonged to: EC1 or EC2.</p></caption>
<graphic xlink:href="2307.05304v2_fig19.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig20" position="float" fig-type="figure">
<label>Supplementary Figure S16</label>
<caption><title>Vector Space embedding using UMAP</title>
<p>Embedding of all the Pacific Ocean clans according to their VLMC distance into two dimensions using UMAP.</p></caption>
<graphic xlink:href="2307.05304v2_fig20.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<table-wrap id="tbl5" orientation="portrait" position="float">
<label>Supplementary Table S4</label>
<caption><title>Geographical overlap and subcoda distance by coda type.</title>
<p>Results of comparing the geographical overlap and VLMC distance segmented by coda types. Negative correlations are highlighted as well as p-values that are below 0.05. “Number of Clans” represents how many clans were compared.</p></caption>
<alternatives>
<graphic xlink:href="2307.05304v2_tbl5.tif" mimetype="image" mime-subtype="tiff"/>
<table frame="hsides" rules="groups">
<thead>
<tr>
<th align="center" valign="top">Coda Type</th>
<th align="center" valign="top">Slope</th>
<th align="center" valign="top">Pearson-P</th>
<th align="center" valign="top">Spearman-P</th>
<th align="center" valign="top">Number of Clans</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" valign="top">33</td>
<td align="center" valign="top"><bold>-0.353</bold></td>
<td align="center" valign="top">0.864</td>
<td align="center" valign="top">0.787</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">34</td>
<td align="center" valign="top"><bold>-0.944</bold></td>
<td align="center" valign="top">0.257</td>
<td align="center" valign="top">0.050</td>
<td align="center" valign="top">4</td>
</tr>
<tr>
<td align="center" valign="top">35</td>
<td align="center" valign="top"><bold>-6.022</bold></td>
<td align="center" valign="top"><bold>0.031</bold></td>
<td align="center" valign="top"><bold>0.032</bold></td>
<td align="center" valign="top">5</td>
</tr>
<tr>
<td align="center" valign="top">42</td>
<td align="center" valign="top"><bold>-4.098</bold></td>
<td align="center" valign="top"><bold>0.004</bold></td>
<td align="center" valign="top"><bold>0.010</bold></td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">43</td>
<td align="center" valign="top"><bold>-0.615</bold></td>
<td align="center" valign="top">0.596</td>
<td align="center" valign="top">0.573</td>
<td align="center" valign="top">4</td>
</tr>
<tr>
<td align="center" valign="top">45</td>
<td align="center" valign="top"><bold>-1.327</bold></td>
<td align="center" valign="top">0.266</td>
<td align="center" valign="top">0.207</td>
<td align="center" valign="top">5</td>
</tr>
<tr>
<td align="center" valign="top">47</td>
<td align="center" valign="top"><bold>-5.808</bold></td>
<td align="center" valign="top">0.628</td>
<td align="center" valign="top">0.700</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">48</td>
<td align="center" valign="top">9.818</td>
<td align="center" valign="top">0.258</td>
<td align="center" valign="top">0.257</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">49</td>
<td align="center" valign="top">10.481</td>
<td align="center" valign="top">0.371</td>
<td align="center" valign="top">0.538</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">51</td>
<td align="center" valign="top"><bold>-0.939</bold></td>
<td align="center" valign="top">0.634</td>
<td align="center" valign="top">0.695</td>
<td align="center" valign="top">6</td>
</tr>
<tr>
<td align="center" valign="top">52</td>
<td align="center" valign="top"><bold>-1.663</bold></td>
<td align="center" valign="top"><bold>0.002</bold></td>
<td align="center" valign="top"><bold>0.021</bold></td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">53</td>
<td align="center" valign="top"><bold>-3.341</bold></td>
<td align="center" valign="top"><bold>0.017</bold></td>
<td align="center" valign="top">0.075</td>
<td align="center" valign="top">6</td>
</tr>
<tr>
<td align="center" valign="top">55</td>
<td align="center" valign="top">0.522</td>
<td align="center" valign="top">0.909</td>
<td align="center" valign="top">0.752</td>
<td align="center" valign="top">4</td>
</tr>
<tr>
<td align="center" valign="top">57</td>
<td align="center" valign="top"><bold>-3.480</bold></td>
<td align="center" valign="top">0.410</td>
<td align="center" valign="top">0.511</td>
<td align="center" valign="top">4</td>
</tr>
<tr>
<td align="center" valign="top">58</td>
<td align="center" valign="top"><bold>-0.896</bold></td>
<td align="center" valign="top">0.755</td>
<td align="center" valign="top">0.623</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">61</td>
<td align="center" valign="top"><bold>-1.512</bold></td>
<td align="center" valign="top"><bold>0.074</bold></td>
<td align="center" valign="top"><bold>0.006</bold></td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">64</td>
<td align="center" valign="top"><bold>-1.651</bold></td>
<td align="center" valign="top">0.061</td>
<td align="center" valign="top">0.276</td>
<td align="center" valign="top">5</td>
</tr>
<tr>
<td align="center" valign="top">66</td>
<td align="center" valign="top"><bold>-2.482</bold></td>
<td align="center" valign="top">0.138</td>
<td align="center" valign="top">0.062</td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">67</td>
<td align="center" valign="top"><bold>-2.782</bold></td>
<td align="center" valign="top">0.172</td>
<td align="center" valign="top">0.269</td>
<td align="center" valign="top">6</td>
</tr>
<tr>
<td align="center" valign="top">71</td>
<td align="center" valign="top"><bold>-1.994</bold></td>
<td align="center" valign="top">0.870</td>
<td align="center" valign="top">0.518</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">72</td>
<td align="center" valign="top"><bold>-0.041</bold></td>
<td align="center" valign="top">0.979</td>
<td align="center" valign="top">0.856</td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">73</td>
<td align="center" valign="top"><bold>-1.334</bold></td>
<td align="center" valign="top">0.337</td>
<td align="center" valign="top">0.329</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">76</td>
<td align="center" valign="top"><bold>-0.981</bold></td>
<td align="center" valign="top">0.681</td>
<td align="center" valign="top">0.829</td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">77</td>
<td align="center" valign="top"><bold>-4.093</bold></td>
<td align="center" valign="top">0.141</td>
<td align="center" valign="top">0.093</td>
<td align="center" valign="top">5</td>
</tr>
<tr>
<td align="center" valign="top">79</td>
<td align="center" valign="top"><bold>-1.116</bold></td>
<td align="center" valign="top">0.268</td>
<td align="center" valign="top">0.142</td>
<td align="center" valign="top">5</td>
</tr>
<tr>
<td align="center" valign="top">82</td>
<td align="center" valign="top"><bold>-0.847</bold></td>
<td align="center" valign="top">0.265</td>
<td align="center" valign="top">0.266</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">83</td>
<td align="center" valign="top">0.908</td>
<td align="center" valign="top">0.578</td>
<td align="center" valign="top">0.284</td>
<td align="center" valign="top">6</td>
</tr>
<tr>
<td align="center" valign="top">85</td>
<td align="center" valign="top"><bold>-1.473</bold></td>
<td align="center" valign="top"><bold>0.044</bold></td>
<td align="center" valign="top"><bold>0.032</bold></td>
<td align="center" valign="top">4</td>
</tr>
<tr>
<td align="center" valign="top">86</td>
<td align="center" valign="top"><bold>-0.089</bold></td>
<td align="center" valign="top">0.845</td>
<td align="center" valign="top">0.600</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">88</td>
<td align="center" valign="top">2.831</td>
<td align="center" valign="top"><bold>0.000</bold></td>
<td align="center" valign="top"><bold>0.000</bold></td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">91</td>
<td align="center" valign="top"><bold>-2.662</bold></td>
<td align="center" valign="top">0.254</td>
<td align="center" valign="top">0.387</td>
<td align="center" valign="top">6</td>
</tr>
<tr>
<td align="center" valign="top">93</td>
<td align="center" valign="top">0.613</td>
<td align="center" valign="top">0.597</td>
<td align="center" valign="top">0.618</td>
<td align="center" valign="top">6</td>
</tr>
<tr>
<td align="center" valign="top">310</td>
<td align="center" valign="top"><bold>-4.118</bold></td>
<td align="center" valign="top">0.320</td>
<td align="center" valign="top">0.193</td>
<td align="center" valign="top">4</td>
</tr>
<tr>
<td align="center" valign="top">311</td>
<td align="center" valign="top"><bold>-1.554</bold></td>
<td align="center" valign="top">0.170</td>
<td align="center" valign="top"><bold>0.016</bold></td>
<td align="center" valign="top">6</td>
</tr>
<tr>
<td align="center" valign="top">312</td>
<td align="center" valign="top"><bold>-1.275</bold></td>
<td align="center" valign="top">0.325</td>
<td align="center" valign="top">0.069</td>
<td align="center" valign="top">6</td>
</tr>
<tr>
<td align="center" valign="top">313</td>
<td align="center" valign="top"><bold>-3.087</bold></td>
<td align="center" valign="top">0.475</td>
<td align="center" valign="top">0.186</td>
<td align="center" valign="top">4</td>
</tr>
<tr>
<td align="center" valign="top">315</td>
<td align="center" valign="top"><bold>-1.189</bold></td>
<td align="center" valign="top">0.593</td>
<td align="center" valign="top">0.700</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">411</td>
<td align="center" valign="top">0.489</td>
<td align="center" valign="top">0.711</td>
<td align="center" valign="top">0.795</td>
<td align="center" valign="top">4</td>
</tr>
<tr>
<td align="center" valign="top">412</td>
<td align="center" valign="top"><bold>-2.092</bold></td>
<td align="center" valign="top">0.578</td>
<td align="center" valign="top">0.700</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">414</td>
<td align="center" valign="top"><bold>-2.269</bold></td>
<td align="center" valign="top"><bold>0.012</bold></td>
<td align="center" valign="top"><bold>0.006</bold></td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">511</td>
<td align="center" valign="top"><bold>-3.246</bold></td>
<td align="center" valign="top"><bold>0.038</bold></td>
<td align="center" valign="top">0.059</td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">513</td>
<td align="center" valign="top"><bold>-1.806</bold></td>
<td align="center" valign="top">0.174</td>
<td align="center" valign="top">0.107</td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">514</td>
<td align="center" valign="top"><bold>-0.449</bold></td>
<td align="center" valign="top">0.869</td>
<td align="center" valign="top">1.000</td>
<td align="center" valign="top">4</td>
</tr>
<tr>
<td align="center" valign="top">610</td>
<td align="center" valign="top"><bold>-1.794</bold></td>
<td align="center" valign="top">0.145</td>
<td align="center" valign="top">0.123</td>
<td align="center" valign="top">7</td>
</tr>
<tr>
<td align="center" valign="top">612</td>
<td align="center" valign="top">5.633</td>
<td align="center" valign="top">0.486</td>
<td align="center" valign="top">0.618</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">613</td>
<td align="center" valign="top"><bold>-0.426</bold></td>
<td align="center" valign="top">0.907</td>
<td align="center" valign="top">0.397</td>
<td align="center" valign="top">3</td>
</tr>
<tr>
<td align="center" valign="top">1011</td>
<td align="center" valign="top"><bold>-1.081</bold></td>
<td align="center" valign="top">0.539</td>
<td align="center" valign="top">0.660</td>
<td align="center" valign="top">5</td>
</tr>
<tr>
<td align="center" valign="top">1012</td>
<td align="center" valign="top"><bold>-0.966</bold></td>
<td align="center" valign="top">0.696</td>
<td align="center" valign="top">0.342</td>
<td align="center" valign="top">4</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
<ref-list>
<title>References</title>
<ref id="c42"><label>[1]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Culture in whales and dolphins</article-title>. <source>Behav. Brain Sci</source>. <volume>24</volume>, <fpage>309</fpage>–<lpage>324</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c43"><label>[2]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whiten</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Ayala</surname>, <given-names>F. J.</given-names></string-name>, <string-name><surname>Feldman</surname>, <given-names>M. W.</given-names></string-name> &amp; <string-name><surname>Laland</surname>, <given-names>K. N.</given-names></string-name></person-group> <article-title>The extension of biology through culture</article-title>. <source>Proc. Natl. Acad. Sci</source>. <volume>114</volume>, <fpage>7775</fpage>–<lpage>7781</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c44"><label>[3]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name></person-group> <source>The cultural lives of whales and dolphins</source> (<publisher-name>University of Chicago Press</publisher-name>, <year>2014</year>).</mixed-citation></ref>
<ref id="c45"><label>[4]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Slater</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>The cultural transmission of bird song</article-title>. <source>Trends Ecol. Evol</source>. <volume>1</volume>, <fpage>94</fpage>–<lpage>97</lpage> (<year>1986</year>).</mixed-citation></ref>
<ref id="c46"><label>[5]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luncz</surname>, <given-names>L. V.</given-names></string-name>, <string-name><surname>Wittig</surname>, <given-names>R. M.</given-names></string-name> &amp; <string-name><surname>Boesch</surname>, <given-names>C.</given-names></string-name></person-group> <article-title>Primate archaeology reveals cultural transmission in wild chimpanzees (pan troglodytes verus)</article-title>. <source>Philos. Trans. R. Soc. B</source> <volume>370</volume>, <fpage>20140348</fpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c47"><label>[6]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alem</surname>, <given-names>S.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Associative mechanisms allow for social learning and cultural transmission of string pulling in an insect</article-title>. <source>PLoS Biol</source>. <volume>14</volume>, <elocation-id>e1002564</elocation-id> (<year>2016</year>).</mixed-citation></ref>
<ref id="c48"><label>[7]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Cavalli-Sforza</surname>, <given-names>L. L.</given-names></string-name> &amp; <string-name><surname>Feldman</surname>, <given-names>M. W.</given-names></string-name></person-group> <source>Cultural transmission and evolution: A quantitative approach</source>. <volume>16</volume> (<publisher-name>Princeton University Press</publisher-name>, <year>1981</year>).</mixed-citation></ref>
<ref id="c49"><label>[8]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Barth</surname>, <given-names>F.</given-names></string-name></person-group> <chapter-title>Introduction</chapter-title>. In <source>Ethnic Groups and Boundaries</source> (<publisher-name>Little Brow</publisher-name>, <year>1969</year>).</mixed-citation></ref>
<ref id="c50"><label>[9]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>McElreath</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Boyd</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Richerson</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>Shared norms and the evolution of ethnic markers</article-title>. <source>Curr. Anthropol</source>. <volume>44</volume>, <fpage>122</fpage>–<lpage>130</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c51"><label>[10]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyd</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Richerson</surname>, <given-names>P. J.</given-names></string-name></person-group> <article-title>The evolution of ethnic markers</article-title>. <source>Cult Anthropol</source> <volume>2</volume>, <fpage>65</fpage>–<lpage>79</lpage> (<year>1987</year>).</mixed-citation></ref>
<ref id="c52"><label>[11]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hersh</surname>, <given-names>T. A.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Evidence from sperm whale clans of symbolic marking in non-human cultures</article-title>. <source>Proc. Natl. Acad. Sci</source>. <volume>119</volume>, <elocation-id>e2201692119</elocation-id> (<year>2022</year>).</mixed-citation></ref>
<ref id="c53"><label>[12]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bermant</surname>, <given-names>P. C.</given-names></string-name>, <string-name><surname>Bronstein</surname>, <given-names>M. M.</given-names></string-name>, <string-name><surname>Wood</surname>, <given-names>R. J.</given-names></string-name>, <string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Gruber</surname>, <given-names>D. F.</given-names></string-name></person-group> <article-title>Deep Machine Learning Techniques for the Detection and Classification of Sperm Whale Bioacoustics</article-title>. <source>Sci. Rep</source>. <volume>9</volume>, <fpage>12588</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c54"><label>[13]</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Cantor</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name></person-group> <chapter-title>Sperm whale, the largest toothed creature on earth</chapter-title>. In <source>Ethology and behavioral ecology odontocetes</source>, <fpage>261</fpage>–<lpage>280</lpage> (<publisher-name>Springer</publisher-name>, <year>2019</year>).</mixed-citation></ref>
<ref id="c55"><label>[14]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watkins</surname>, <given-names>W. A.</given-names></string-name> &amp; <string-name><surname>Schevill</surname>, <given-names>W. E.</given-names></string-name></person-group> <article-title>Sperm whale codas</article-title>. <source>J. Acoust. Soc. Am</source>. <volume>62</volume>, <fpage>1485</fpage> (<year>1977</year>).</mixed-citation></ref>
<ref id="c56"><label>[15]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hersh</surname>, <given-names>T. A.</given-names></string-name>, <string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Using identity calls to detect structure in acoustic datasets</article-title>. <source>Methods Ecol. Evol</source>. <volume>12</volume>, <fpage>1668</fpage>–<lpage>1678</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c57"><label>[16]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Weilgart</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Coda communication by sperm whales (<italic>Physeter macrocephalus</italic>) off the Galapagos Islands</article-title>. <source>Can. J. Zool</source>. <volume>71</volume>, <fpage>744</fpage>–<lpage>752</lpage> (<year>1993</year>).</mixed-citation></ref>
<ref id="c58"><label>[17]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schulz</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name></person-group> <article-title>Individual vocal production in a sperm whale (physeter macrocephalus) social unit</article-title>. <source>Mar. Mammal Sci</source>. <volume>27</volume>, <fpage>149</fpage>–<lpage>166</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c59"><label>[18]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name></person-group> <article-title>Individual, unit and vocal clan level identity cues in sperm whale codas</article-title>. <source>R. Soc. Open Sci</source>. <volume>3</volume>, <fpage>150372</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c60"><label>[19]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Spatial and temporal variation in sperm whale coda vocalizations: stable usage and local dialects</article-title>. <source>Anim. Behav</source>. <volume>70</volume>, <fpage>191</fpage>–<lpage>198</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c61"><label>[20]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rendell</surname>, <given-names>L. E.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Vocal clans in sperm whales (Physeter macrocephalus)</article-title>. <source>Proc. Royal Soc. B</source> <volume>270</volume>, <fpage>225</fpage>–<lpage>231</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c62"><label>[21]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Bøttcher</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Madsen</surname>, <given-names>P. T.</given-names></string-name></person-group> <article-title>Socially segregated, sympatric sperm whale clans in the Atlantic Ocean</article-title>. <source>R. Soc. Open Sci</source>. <volume>3</volume>, <fpage>160061</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c63"><label>[22]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cantor</surname>, <given-names>M.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Multilevel animal societies can emerge from cultural transmission</article-title>. <source>Nat. Commun</source>. <volume>6</volume>, <fpage>8091</fpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c64"><label>[23]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Backus</surname>, <given-names>R. H.</given-names></string-name> &amp; <string-name><surname>Schevill</surname>, <given-names>W. E.</given-names></string-name></person-group> <article-title>Physeter clicks</article-title>. <source>Whales, dolphins, and porpoises</source> <fpage>510</fpage>–<lpage>527</lpage> (<year>1966</year>).</mixed-citation></ref>
<ref id="c65"><label>[24]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vachon</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Hersh</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Gero</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Ocean nomads or island specialists? culturally driven habitat partitioning contrasts in scale between geographically isolated sperm whale populations</article-title>. <source>R. Soc. Open Sci</source>. <volume>9</volume>, <fpage>211737</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c66"><label>[25]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cohen</surname>, <given-names>E.</given-names></string-name></person-group> <article-title>The evolution of tag-based cooperation in humans: The case for accent</article-title>. <source>Curr. Anthropol</source>. <volume>53</volume>, <fpage>588</fpage>–<lpage>616</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c67"><label>[26]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Henrich</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Muthukrishna</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>The origins and psychology of human cooperation</article-title>. <source>Annu. Rev. Psychol</source>. <volume>72</volume>, <fpage>207</fpage>–<lpage>240</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c68"><label>[27]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Oliveira</surname>, <given-names>C.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Sperm whale codas may encode individuality as well as clan identity</article-title>. <source>J. Acoust. Soc. Am</source>. <volume>139</volume>, <fpage>2860</fpage>–<lpage>2869</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c69"><label>[28]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sun</surname>, <given-names>K.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Geographic variation in the acoustic traits of greater horseshoe bats: testing the importance of drift and ecological selection in evolutionary processes</article-title>. <source>PLoS One</source> <volume>8</volume>, <elocation-id>e70368</elocation-id> (<year>2013</year>).</mixed-citation></ref>
<ref id="c70"><label>[29]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rendell</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Mesnick</surname>, <given-names>S. L.</given-names></string-name>, <string-name><surname>Dalebout</surname>, <given-names>M. L.</given-names></string-name>, <string-name><surname>Burtenshaw</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Can genetic differences explain vocal dialect variation in sperm whales, physeter macrocephalus?</article-title> <source>Behav. Genet</source>. <volume>42</volume>, <fpage>332</fpage>–<lpage>343</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c71"><label>[30]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Alexander</surname>, <given-names>A.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>What influences the worldwide genetic structure of sperm whales (physeter macrocephalus)?</article-title> <source>Mol. Ecol</source>. <volume>25</volume>, <fpage>2754</fpage>–<lpage>2772</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c72"><label>[31]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lyrholm</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Leimar</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Johanneson</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Gyllensten</surname>, <given-names>U.</given-names></string-name></person-group> <article-title>Sex-biased dispersal in sperm whales: contrasting mitochondrial and nuclear genetic structure of global populations</article-title>. <source>Proceedings of the Royal Society of London. Series B: Biological Sciences</source> <volume>266</volume>, <fpage>347</fpage>–<lpage>354</lpage> (<year>1999</year>).</mixed-citation></ref>
<ref id="c73"><label>[32]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Epp</surname>, <given-names>M. V.</given-names></string-name>, <string-name><surname>Fournet</surname>, <given-names>M. E.</given-names></string-name>, <string-name><surname>Silber</surname>, <given-names>G. K.</given-names></string-name> &amp; <string-name><surname>Davoren</surname>, <given-names>G. K.</given-names></string-name></person-group> <article-title>Allopatric humpback whales of differing generations share call types between foraging and wintering grounds</article-title>. <source>Sci. Rep</source>. <volume>11</volume>, <fpage>16297</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c74"><label>[33]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Madsen</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Wahlberg</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Møhl</surname>, <given-names>B.</given-names></string-name></person-group> <article-title>Male sperm whale (physeter macro-cephalus) acoustics in a high-latitude habitat: implications for echolocation and communication</article-title>. <source>Behav. Ecol. Sociobiol</source>. <volume>53</volume>, <fpage>31</fpage>–<lpage>41</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c75"><label>[34]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Deecke</surname>, <given-names>V. B.</given-names></string-name>, <string-name><surname>Ford</surname>, <given-names>J. K.</given-names></string-name> &amp; <string-name><surname>Spong</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>Dialect change in resident killer whales: implications for vocal learning and cultural transmission</article-title>. <source>Anim. Behav</source>. <volume>60</volume>, <fpage>629</fpage>–<lpage>638</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c76"><label>[35]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andreas</surname>, <given-names>J.</given-names></string-name></person-group> <etal>et al.</etal> <article-title>Towards understanding the communication in sperm whales</article-title>. <source>iScience</source> <volume>25</volume>, <fpage>104393</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c77"><label>[36]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frantzis</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Alexiadou</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>Male sperm whale (physeter macrocephalus) coda production and coda-type usage depend on the presence of conspecifics and the behavioural context</article-title>. <source>Can. J. Zool</source>. <volume>86</volume>, <fpage>62</fpage>–<lpage>75</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c78"><label>[37]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kullback</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Leibler</surname>, <given-names>R. A.</given-names></string-name></person-group> <article-title>On information and sufficiency</article-title>. <source>Ann. Math. Stat</source>. <volume>22</volume>, <fpage>79</fpage>–<lpage>86</lpage> (<year>1951</year>).</mixed-citation></ref>
<ref id="c79"><label>[38]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mächler</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Bühlmann</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>Variable length markov chains: methodology, computing, and software</article-title>. <source>J. Comput. Graph. Stat</source>. <volume>13</volume>, <fpage>435</fpage>–<lpage>455</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c80"><label>[39]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Galves</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Galves</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Garcia</surname>, <given-names>J. E.</given-names></string-name>, <string-name><surname>Garcia</surname>, <given-names>N. L.</given-names></string-name> &amp; <string-name><surname>Leonardi</surname>, <given-names>F.</given-names></string-name></person-group> <article-title>Context tree selection and linguistic rhythm retrieval from written texts</article-title>. <source>Ann. Appl. Stat</source>. <volume>6</volume>, <fpage>186</fpage>–<lpage>209</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c81"><label>[40]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Analysis of animal movement using opportunistic individual identifications: application to sperm whales</article-title>. <source>Ecology</source> <volume>82</volume>, <fpage>1417</fpage>–<lpage>1432</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c82"><label>[41]</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whitehead</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Coakes</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Jaquet</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Lusseau</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Movements of sperm whales in the tropical pacific</article-title>. <source>Marine Ecology Progress Series</source> <volume>361</volume>, <fpage>291</fpage>–<lpage>300</lpage> (<year>2008</year>).</mixed-citation></ref>
</ref-list>
</app>
</app-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96362.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Kalan</surname>
<given-names>Ammie K</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Victoria</institution>
</institution-wrap>
<city>Victoria</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>important</bold> study, which presents novel data on variation in sperm whale communication, contributes to a richer understanding of the social transmission of vocal styles across neighbouring clans. The evidence is <bold>solid</bold> but could be further improved with some clarification of the specialized measurements and terms used, particularly for comparisons to other taxa. This research will be of interest for bioacoustics and animal communication specialists, particularly those working on social learning and culture.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96362.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This manuscript presents evidence of 'vocal style' in sperm whale vocal clans. Vocal style was defined as specific patterns in the way that rhythmic codas were produced, providing a fine-scale means of comparing coda variations. Vocal style effectively distinguished clans similar to the way in which vocal repertoires are typically employed. For non-identity codas, vocal style was found to be more similar among clans with more geographic overlap. This suggests the presence of social transmission across sympatric clans while maintaining clan vocal identity.</p>
<p>Strengths:</p>
<p>This is a well-executed study that contributes exciting new insights into cultural vocal learning in sperm whales. The methodology is sound and appropriate for the research question, building on previous work and ground-truthing much of their theories. The use of the Dominica dataset to validate their method lends strength to the concept of vocal style and its application more broadly to the Pacific dataset. The results are framed well in the context of previous works and clearly explain what novel insights the results provide to the current understanding of sperm whale vocal clans. The discussion does an overall great job of outlining why horizontal social learning is the best explanation for the results found.</p>
<p>Weaknesses:</p>
<p>The primary issues with the manuscript are in the technical nature of the writing and a lack of clarity at times with certain terminology. For example, several tree figures are presented and 'distance' between trees is key to the results, yet 'distance' is not clearly defined in a way for someone unfamiliar with Markov chains to understand. However, these are issues that can easily be dealt with through minor revisions with a view towards making the manuscript more accessible to a general audience.</p>
<p>I also feel that the discussion could focus a bit more on the broader implications - specifically what the developed methods and results might imply about cultural transmission in other species. This is specifically mentioned in the abstract but not really delved into in detail during the discussion.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96362.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The current article presents a new type of analytical approach to the sequential organisation of whale coda units.</p>
<p>Strengths:</p>
<p>The detailed description of the internal temporal structure of whale codas is something that has been thus far lacking.</p>
<p>Weaknesses:</p>
<p>It is unclear how the insight gained from these analyses differs or adds to the voluminous available literature on how codas varies between whale groups and populations. It provides new details, but what new aspects have been learned, or what features of variation seem to be only revealed by this new approach?</p>
<p>
The theoretical basis and concepts of the paper are problematical and indeed, hamper potentially the insights into whale communication that the methods could offer. Some aspects of the results are also overstated.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96362.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The study presented by Leitao et al., represents an important advancement in comprehending the social learning processes of sperm whales across various communicative and socio-cultural contexts. The authors introduce the concept of &quot;vocal style&quot; as an addition to the previously established notion of &quot;vocal repertoire,&quot; thereby enhancing our understanding of sperm whale vocal identity.</p>
<p>Strengths:</p>
<p>A key finding of this research is the correlation between the similarity of clan vocal styles for non-ID codas and spatial overlap (while no change occurs for ID codas), suggesting that social learning plays a crucial role in shaping symbolic cultural boundaries among sperm whale populations. This work holds great appeal for researchers interested in animal cultures and communication. It is poised to attract a broad audience, including scholars studying animal communication and social learning processes across diverse species, particularly cetaceans.</p>
<p>Weaknesses:</p>
<p>In terms of terminology, while the authors use the term &quot;saying&quot; to describe whale vocalizations, it may be more conservative to employ terms like &quot;vocalize&quot; or &quot;whale speech&quot; throughout the manuscript. This approach aligns with the distinction between human speech and other forms of animal communication, as outlined in prior research (Hockett, 1960; Cheney &amp; Seyfarth, 1998; Hauser et al., 2002; Pinker &amp; Jackendoff, 2005; Tomasello, 2010).</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96362.1.sa4</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Leitao</surname>
<given-names>Antonio</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Lucas</surname>
<given-names>Maxime</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Poetto</surname>
<given-names>Simone</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Hersh</surname>
<given-names>Taylor A.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gero</surname>
<given-names>Shane</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gruber</surname>
<given-names>David F.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Bronstein</surname>
<given-names>Michael</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Petri</surname>
<given-names>Giovanni</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>We thank the reviewers for their positive assessments and constructive feedback.</p>
<p>In light of their comments, we will aim to improve the explanation of the methods and interpretation of results, as well as their relation to well-established literature in this research area.</p>
<p>The major contributions of our work are threefold:</p>
<list list-type="bullet">
<list-item><p>First, we introduce a novel way of analyzing codas that specifically targets subcoda structures by considering inter-click intervals within codas in terms of transition probabilities. By describing codas’ click patterns via Variable Length Markov Chains, we do not need to consider codas in their entirety, but we can detect coda subunits.This enables a new dimension for quantitatively comparing differences among various individuals, social units, and clans; which we term ‘vocal style’.</p>
</list-item></list>
<list list-type="bullet">
<list-item><p>Using this approach, we reinforce findings from past research, including the idea that identity codas function as symbolic markers of vocal clan identity (Hersh et al., 2022; Sharma et al., 2024). More importantly, we offer new insights into the function of non-identity codas, which comprise the majority of coda types produced by sperm whales but have been largely uncharacterized.</p>
</list-item></list>
<list list-type="bullet">
<list-item><p>Our work reveals that non-identity coda vocal styles are more similar for spatially overlapped clans, and suggests that this similarity in style may be maintained by social learning across clan boundaries. This opens up a paradigm shift in our understanding of between-clan acoustic interactions.</p>
</list-item></list>
<p>From a broader perspective, our work builds on two well-established research areas: the form and function of sperm whale codas, and statistical generative models, specifically Variable Length Markov Chains on finite data spaces. Our methods, results, and interpretations are grounded in theories and concepts from these fields.</p>
<p>For clarity, we will ensure that our terminology aligns with field standards and existing research. We will clearly introduce each key theory or concept at first mention and justify its relevance. In particular, we will clarify the definition and meaning of the distance between subcoda trees for a general audience. We agree with the reviewers’ comments on the broader implications and will refine our work accordingly.</p>
</body>
</sub-article>
</article>