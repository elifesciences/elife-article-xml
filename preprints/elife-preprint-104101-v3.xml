<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">104101</article-id>
<article-id pub-id-type="doi">10.7554/eLife.104101</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.104101.3</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.4</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories><title-group>
<article-title>Online reinforcement learning of state representation in recurrent network: the power of random feedback and biological constraints</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Tsurumi</surname>
<given-names>Takayuki</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6306-6600</contrib-id>
<name>
<surname>Kato</surname>
<given-names>Ayaka</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8044-9195</contrib-id>
<name>
<surname>Kumar</surname>
<given-names>Arvind</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2192-4248</contrib-id>
<name>
<surname>Morita</surname>
<given-names>Kenji</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a5">5</xref>
<email>morita@p.u-tokyo.ac.jp</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/057zh3y96</institution-id><institution>Physical and Health Education, Graduate School of Education, The University of Tokyo</institution></institution-wrap>, <city>Tokyo</city>, <country country="JP">Japan</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/02qg15b79</institution-id><institution>Theoretical Sciences Visiting Program, Okinawa Institute of Science and Technology</institution></institution-wrap>, <city>Okinawa</city>, <country country="JP">Japan</country></aff>
<aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04a9tmd77</institution-id><institution>Department of Psychiatry, Icahn School of Medicine at Mount Sinai</institution></institution-wrap>, <city>New York</city>, <country country="US">United States</country></aff>
<aff id="a4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/026vcq606</institution-id><institution>Division of Computational Science and Technology, School of Electrical Engineering and Computer Science, KTH Royal Institute of Technology</institution></institution-wrap>, <city>Stockholm</city>, <country country="SE">Sweden</country></aff>
<aff id="a5"><label>5</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/057zh3y96</institution-id><institution>International Research Center for Neurointelligence (WPI-IRCN), The University of Tokyo</institution></institution-wrap>, <city>Tokyo</city>, <country country="JP">Japan</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Naud</surname>
<given-names>Richard</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Ottawa</institution>
</institution-wrap>
<city>Ottawa</city>
<country country="CA">Canada</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Poirazi</surname>
<given-names>Panayiota</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>FORTH Institute of Molecular Biology and Biotechnology</institution>
</institution-wrap>
<city>Heraklion</city>
<country country="GR">Greece</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-01-14">
<day>14</day>
<month>01</month>
<year>2025</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-07-22">
<day>22</day>
<month>07</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP104101</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-11-05">
<day>05</day>
<month>11</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-10-04">
<day>04</day>
<month>10</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.08.22.609100"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2025-01-14">
<day>14</day>
<month>01</month>
<year>2025</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.104101.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.104101.1.sa4">eLife Assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.104101.1.sa3">Reviewer #1 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.104101.1.sa2">Reviewer #2 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.104101.1.sa1">Reviewer #3 (Public review):</self-uri>
<self-uri content-type="author-comment" xlink:href="https://doi.org/10.7554/eLife.104101.1.sa0">Author response:</self-uri>
</event>
<event>
<event-desc>Reviewed preprint v2</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2025-06-30">
<day>30</day>
<month>06</month>
<year>2025</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.104101.2"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.104101.2.sa4">eLife Assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.104101.2.sa3">Reviewer #1 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.104101.2.sa2">Reviewer #2 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.104101.2.sa1">Reviewer #3 (Public review):</self-uri>
<self-uri content-type="author-comment" xlink:href="https://doi.org/10.7554/eLife.104101.2.sa0">Author response:</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, Tsurumi et al</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>Tsurumi et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-104101-v3.pdf"/>
<abstract>
<title>Abstract</title><p>Representation of external and internal states in the brain plays a critical role in enabling suitable behavior. Recent studies suggest that state representation and state value can be simultaneously learnt through Temporal-Difference-Reinforcement-Learning (TDRL) and Backpropagation-Through-Time (BPTT) in recurrent neural networks (RNNs) and their readout. However, neural implementation of such learning remains unclear as BPTT requires offline update using transported downstream weights, which is suggested to be biologically implausible. We demonstrate that simple online training of RNNs using TD reward prediction error and random feedback, without additional memory or eligibility trace, can still learn the structure of tasks with cue-reward delay and timing variability. This is because TD learning itself is a solution for temporal credit assignment, and feedback alignment, a mechanism originally proposed for supervised learning, enables gradient approximation without weight transport. Furthermore, we show that biologically constraining downstream weights and random feedback to be non-negative not only preserves learning but may even enhance it because the non-negative constraint ensures loose alignment - allowing the downstream and feedback weights to roughly align from the beginning. These results provide insights into the neural mechanisms underlying the learning of state representation and value, highlighting the potential of random feedback and biological constraints.</p>
</abstract>
<funding-group>
<award-group id="funding-1">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/00hhkn466</institution-id>
<institution>Japan Society for the Promotion of Science (JSPS)</institution>
</institution-wrap>
</funding-source>
<award-id>23H03295</award-id>
</award-group>
<award-group id="funding-1a">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/00hhkn466</institution-id>
<institution>Japan Society for the Promotion of Science (JSPS)</institution>
</institution-wrap>
</funding-source>
<award-id>23K27985</award-id>
</award-group>
<award-group id="funding-1b">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/00hhkn466</institution-id>
<institution>Japan Society for the Promotion of Science (JSPS)</institution>
</institution-wrap>
</funding-source>
<award-id>25H02594</award-id>
</award-group>
<award-group id="funding-2">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/02s016q17</institution-id>
<institution>Naito Foundation</institution>
</institution-wrap>
</funding-source>
</award-group>
<award-group id="funding-3">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/00hhkn466</institution-id>
<institution>Japan Society for the Promotion of Science (JSPS)</institution>
</institution-wrap>
</funding-source>
<award-id>Overseas Research Fellowships</award-id>
</award-group>
<award-group id="funding-4">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/026vcq606</institution-id>
<institution>KTH Royal Institute of Technology</institution>
</institution-wrap>
</funding-source>
<award-id>Digital Futures (KTH) grant</award-id>
</award-group>
<award-group id="funding-5">
<funding-source>
<institution-wrap>
<institution-id institution-id-type="ror">https://ror.org/026vcq606</institution-id>
<institution>KTH Royal Institute of Technology</institution>
</institution-wrap>
</funding-source>
<award-id>StratNeuro SRA</award-id>
</award-group>
</funding-group>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>We have added new simulation results as Appendix.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Multiple lines of studies have suggested that Temporal-Difference-Reinforcement-Leaning (TDRL) is implemented in the cortico-basal ganglia-dopamine (DA) circuits where DA encodes TD reward-prediction-error (RPE) <sup><xref ref-type="bibr" rid="c1">1</xref>–<xref ref-type="bibr" rid="c6">6</xref></sup> and DA-dependent plasticity of cortico-striatal synapses corresponds to TD-RPE-dependent update of state/action values <sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c9">9</xref></sup>. Traditionally, TDRL in the cortico-basal ganglia-DA circuits was considered to serve only for relatively simple behavior. However, subsequent studies suggested that more sophisticated, apparently goal-directed/model-based behavior can also be achieved by TDRL if states are appropriately represented <sup><xref ref-type="bibr" rid="c10">10</xref>–<xref ref-type="bibr" rid="c12">12</xref></sup> and that DA signals indeed reflect model-based predictions <sup><xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c14">14</xref></sup>. Conversely, impairments in state representation may relate to behavioral or mental-health problems <sup><xref ref-type="bibr" rid="c15">15</xref>–<xref ref-type="bibr" rid="c19">19</xref></sup>. Early modeling studies treated state representations appropriate to the situation/task as given (’handcrafted’ by the authors), but representation itself should be learnt in the brain <sup><xref ref-type="bibr" rid="c20">20</xref>–<xref ref-type="bibr" rid="c25">25</xref></sup>. Recently it was shown that appropriate state representation can be learnt through TDRL in a recurrent neural network (RNN) by minimizing squared TD value-error without explicit target <sup><xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c26">26</xref></sup>, while state value can be simultaneously learnt in connections downstream of the RNN.</p>
<p>However, whether such a learning -referred to as the value-RNN <sup><xref ref-type="bibr" rid="c26">26</xref></sup>, can be implemented in the brain remains unclear. This is because the value-RNN <sup><xref ref-type="bibr" rid="c26">26</xref></sup> used the Backpropagation-Through-Time (BPTT) <sup><xref ref-type="bibr" rid="c27">27</xref></sup>, which applies gradient-descent error-’backpropagation’ (hereafter referred to as backprop) <sup><xref ref-type="bibr" rid="c28">28</xref>, <xref ref-type="bibr" rid="c29">29</xref></sup> to a temporally unfolded RNNs. BPTT has been argued to be biologically implausible mainly due to problems with feedback and causality. Regarding feedback, updating upstream connections requires feedback whose weights are transported from downstream forward connections, but such weight transportation is difficult to implement biologically <sup><xref ref-type="bibr" rid="c30">30</xref>, <xref ref-type="bibr" rid="c31">31</xref></sup>. In the case of the value-RNN, if the state-representing RNN and the value-encoding readout are implemented by the intra-cortical circuit and the striatal neurons, respectively, as generally assumed <sup><xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c32">32</xref>, <xref ref-type="bibr" rid="c33">33</xref></sup>, this weight transportation means that the update (plasticity) rule for intra-cortical connections involves the downstream cortico-striatal synaptic strengths, which are not accessible from the cortex. Regarding the problem of causality in BPTT, the error needs to be incrementally accumulated in the temporally backward order, but such an acausal offline update is biologically implausible <sup><xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c35">35</xref></sup>.</p>
<p>Recently, a potential solution for the feedback problem of backprop has been proposed <sup><xref ref-type="bibr" rid="c36">36</xref></sup> (see also <sup><xref ref-type="bibr" rid="c37">37</xref>–<xref ref-type="bibr" rid="c44">44</xref></sup> for other approaches). Specifically, in supervised learning of feed-forward networks, it was shown that when the transported downstream weights used for updating upstream connections were replaced with fixed random strengths, comparable learning performance was still achieved <sup><xref ref-type="bibr" rid="c36">36</xref></sup>. This was suggested to be because the information of the random strengths transferred to the upstream connections and then to the downstream feed-forward connections so that these feed-forward connections became aligned to the random feedback and thereby the random feedback could work similarly to the feedback with transported downstream weights in backprop. This mechanism was named the ‘feedback alignment’ (FA)<sup><xref ref-type="bibr" rid="c36">36</xref></sup>, and was subsequently shown to work also in online supervised learning of RNN (algorithm named RFLO (random feedback local online)) <sup><xref ref-type="bibr" rid="c34">34</xref></sup> and proposed to be ‘neurally’ implemented <sup><xref ref-type="bibr" rid="c45">45</xref></sup> (in a different way from the present study as we discuss in the Discussion).</p>
<p>The value-RNN <sup><xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c26">26</xref></sup> differs from supervised learning considered in these previous feedback-alignment studies in two ways: i) it is TD learning, i.e., it approximates the true error by the TD-RPE because the true error, or true state value, is unknown, and ii) it uses a scalar error (TD-RPE) rather than a vector error. Scalar reward-based online learning of RNN with random feedback was actually shown to work in a different study <sup><xref ref-type="bibr" rid="c35">35</xref></sup> (their Supplementary Figure 5), but TD-RPE was not introduced in that setup, while the same study also examined another setup with TD-RPE but result with random feedback was not shown for this latter setup (their Figure 4 and 5). Therefore, it was nontrivial whether the value-RNN could be modified to incorporate online update using random feedback. Here we demonstrate that such a modified value-RNN could still work and provide a mechanistic insight into how it works.</p>
<p>Next we address other biological-plausibility issues with FA-based rule. Specifically, we imposed biological constraints that the downstream (cortico-striatal) weights and the fixed random feedback, as well as the activities of neurons in the RNN, were all non-negative. Moreover, we also remedied the non-monotonic dependence of the update of RNN connection-strength on post-synaptic neural activity. We found that the non-negative constraint appeared to aid, rather than degrade, the learning by ensuring that the downstream weights and the fixed random feedback were loosely aligned from the beginning. These results suggest how learning of state representation and value could be implemented via DA-dependent synaptic plasticity in cortical and striatal circuits, where DA encodes TD-RPE.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<label>1.</label><title>Online value-RNN with fixed random feedback</title>
<p>We considered an online value-RNN in the cortico-basal ganglia circuits (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). In this model a cortical region/population represents information of sensory observation (<bold><italic>o</italic></bold>) and send it to another cortical region/population which estimates a state (<bold><italic>x</italic></bold>) given the sensory inputs. We approximate this cortical population an RNN (number of RNN units was varied between 5 and 40). Neurons in the RNN learn to represent states by updating the strengths of recurrent connections <bold>A</bold> and feed-forward connections <bold>B</bold>. The activity of a population of striatal neurons that receive inputs from the RNN is supposed to learn to represent the state values (<italic>v</italic>), by learning the weights (<bold><italic>w</italic></bold>) of cortico-striatal connections. DA neurons in the ventral tegmental area (VTA) receive information about the value and reward (<italic>r</italic>) from the striatum (both direct and indirect pathways) and other structures, and the activity of the DA neurons, as well as released DA, represents TD-RPE (<italic>δ</italic>). The TD-RPE-representing DA is released in the striatum and also in the cortical RNN through mesocorticolimbic projections, and used for modifying <bold>A</bold>, <bold>B</bold> and <bold><italic>w</italic></bold> (<xref rid="fig1" ref-type="fig">Fig. 1</xref>).</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1</label>
<caption><p>Implementation of the online value-RNN in the cortico-basal ganglia-DA circuits.</p></caption>
<graphic xlink:href="609100v4_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The original value-RNN <sup><xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c26">26</xref></sup> adopted BPTT <sup><xref ref-type="bibr" rid="c27">27</xref></sup> as an update rule for the connections onto the RNN (<bold>A</bold> and <bold>B</bold>), which requires the (gradually changing) value weights (<bold><italic>w</italic></bold>), but this is biologically implausible because the corticostriatal synaptic weights are not available in the cortex as mentioned above. Therefore, we examined a model (agent) in which these weights were replaced with fixed random strengths (<bold><italic>c</italic></bold>), in comparison with a model that used these weights. Because the temporally acausal offline update used in BPTT is also biologically implausible, we used an online learning rule, which considers only the influence of the recurrent weights at the previous time step (see the Methods for details and equations). We refer to these models (agents) as the online value-RNN or oVRNN.</p>
<p>We assumed that a single RNN unit corresponds to a small population of neurons that intrinsically share inputs and outputs, for genetic or developmental reasons, and the activity of each unit represents the (relative) firing rate of the population. Cortical population activity is suggested to be sustained not only by fast synaptic transmission and spiking but also, even predominantly, by slower synaptic neurochemical dynamics <sup><xref ref-type="bibr" rid="c46">46</xref></sup> such as short-term facilitation, whose time constant can be around 500 milliseconds <sup><xref ref-type="bibr" rid="c47">47</xref></sup>. Therefore, we assumed that single time-step of our rate-based (rather than spike-based) model corresponds to 500 milliseconds.</p>
<p>In each simulation, the recurrent (<bold>A</bold>) and feed-forward connection (<bold>B</bold>) weights onto the RNN units were initialized to pseudo standard normal random numbers. As a negative control, we also conducted simulations in which these connections were not updated from initial values, referring to as the case with “untrained (fixed) RNN”. Notably, the value weights <bold><italic>w</italic></bold> (i.e., connection weights from the RNN to the striatal value unit) were still trained in the models with untrained RNN. The oVRNN models, and the model with untrained RNN, were continuously trained across trials in each task, because we considered that it was ecologically more plausible than episodic training of separate trials.</p>
</sec>
<sec id="s2b">
<label>2.1</label><title>Simulation of a Pavlovian cue-reward association task with variable inter-trial intervals</title>
<p>First we took a small RNN with 7 units to represent state in the cortex, and simulated a Pavlovian cue-reward association task, in which a cue was followed by a reward three time-steps later, and inter-trial interval (i.e., reward to next cue) was randomly chosen from 4, 5, 6, or 7 time-steps (<xref rid="fig2" ref-type="fig">Fig. 2A</xref>). Given that single time-step corresponds to 500 milliseconds as mentioned above, three time-steps from cue to reward correspond to 1.5 sec, which matches the delay in the conditioning task used by Schultz et al. <sup><xref ref-type="bibr" rid="c2">2</xref></sup>. In this task, states after receiving of cue information can be defined by time-steps from the cue, and the state values of these states can be estimated by calculating the expected cumulative discounted future rewards <sup><xref ref-type="bibr" rid="c48">48</xref></sup> through simulations; we refer to them as “estimated true state values” (<xref rid="fig2" ref-type="fig">Fig. 2B</xref>, black line). Expected TD-RPE can be calculated from these estimated true values (<xref rid="fig2" ref-type="fig">Fig. 2B</xref>, red line).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2</label>
<caption><title>Simulation of a Pavlovian cue-reward association task.</title>
<p><bold>(A)</bold> Simulated task with variable inter-trial intervals. <bold>(B)</bold> Black line: Estimated true values of states/timings through simulations according to the definition of state value, i.e., expected cumulative discounted future rewards, taking into account the effect of probabilistic inter-trial interval (ITI). Red line: TD-RPEs calculated from the estimated true state/timing values. <bold>(C-G)</bold> State values (black lines) and TD-RPEs (red lines) at 1000-th trial, averaged across 100 simulations (error-bars indicating mean ± SEM across simulations; same applied to the followings unless otherwise mentioned), in different types of agent: (C) TD-RL agent having punctate state representation and state values without continuation between trials (i.e., the value of the last state in a trial was not updated by TD-RPE upon entering the next trial); (D) TD-RL agent having punctate state representation and continuously updated state values across trials; (E) Online value-RNN with backprop (oVRNNbp). The number of RNN units was 7 (same applied to (F,G); (F) Online value-RNN with fixed random feedback (oVRNNrf); (G) Agent with untrained RNN. <bold>(H)</bold> State values at 1000-th trial in individual simulations of oVRNNbp (top), oVRNNrf (middle), and untrained RNN (bottom). <bold>(I)</bold> Histograms of the value of the pre-reward state (i.e., the state one-time step before the reward state) at 1000-th trial in individual simulations of the three models. The vertical black dashed lines indicate the true value of the pre-reward state (estimated through simulations). <bold>(J)</bold> <italic>Left</italic>: Mean of the squares of differences between the state values developed by each agent and the estimated true state values between cue and reward (referred to as the mean squared value-error) at 1000-th trial in oVRNNbp (red line), oVRNNrf (blue line), and the model with untrained RNN (gray line) when the number of RNN units (<italic>n</italic>) was varied from 5 to 40. Learning rate for value weights was normalized by dividing by <italic>n</italic>/7 (same applied to the followings unless otherwise mentioned). <italic>Right</italic>: Mean squared value-error in oVRNNrf (blue line: same data as in the left panel) and oVRNN with uniform feedback (green line). <bold>(K)</bold> Log contribution ratios of the principal components of the time series (for 1000 trials) of RNN activities in each model with 20 RNN units. <bold>(L)</bold> Mean squared value-error in each model with 20 RNN units across trials. <bold>(M)</bold> Mean squared value-error in each model at 3000-th trial in the cases where the cue-reward delay was 3, 4, 5, or 6 time-steps (top to bottom panels).</p></caption>
<graphic xlink:href="609100v4_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>First, for comparison, we examined traditional TD-RL agent with punctate state representation (without using the RNN), in which each state (time-step from a cue) was represented in a punctate manner, i.e., by a one-hot vector such as (1, 0, …, 0), (0, 1, …, 0), and so on. We examined two cases: one in which training was done in an episodic manner without continuation between trials (i.e., the value of the last state in a trial was not updated by TD-RPE upon entering the next trial) and the other in which training was done continuously across trials, as in the cases of agents using the RNN. The former agent developed positive values between cue and reward, and abrupt TD-RPE upon cue (<xref rid="fig2" ref-type="fig">Fig. 2C</xref>), whereas the latter agent developed positive values also for states in the inter-trial interval (<xref rid="fig2" ref-type="fig">Fig. 2D</xref>), looking similar to the true values (<xref rid="fig2" ref-type="fig">Fig. 2B</xref>).</p>
<p>We then examined our oVRNN agents, with backprop-type transported downstream weights (oVRNNbp: <xref rid="fig2" ref-type="fig">Fig. 2E</xref>) or with fixed random feedback (oVRNNrf: <xref rid="fig2" ref-type="fig">Fig. 2F</xref>), in comparison with the agent with untrained fixed RNN (<xref rid="fig2" ref-type="fig">Fig. 2G</xref>). As shown in the figures, oVRNNbp successfully learned the values of states between cue and reward, and oVRNNrf also learned these values, although to a somewhat smaller degree on average. On the other hand, the agent with untrained RNN developed the smallest state values on average among the three agents. This inferiority of untrained RNN may sound odd because there were only four states from cue to reward while random RNN with enough units is expected to be able to represent many different states (c.f., <sup><xref ref-type="bibr" rid="c49">49</xref></sup>) and the effectiveness of training of only the readout weights has been shown in reservoir computing studies <sup><xref ref-type="bibr" rid="c50">50</xref>–<xref ref-type="bibr" rid="c53">53</xref></sup>. However, there was a difficulty stemming from the continuous training across trials (rather than episodic training of separate trials): the activity of untrained RNN upon cue presentation generally differed from trial to trial, and so it is non-trivial that cue presentation in different trials should be regarded as the same single state, even if it could eventually be dealt with at the readout level if the number of units increases.</p>
<p>The results above indicate that value-RNN could be trained online by fixed random feedback at least to a certain extent, although somewhat less effectively than by backprop-type feedback. Results of individual simulations shown in <xref rid="fig2" ref-type="fig">Fig. 2H,I</xref> indicate that state values developed in oVRNNrf were largely comparable to those developed in oVRNNbp once they were successfully learned but the success rate was smaller than oVRNNbp while still larger than the untrained RNN.</p>
</sec>
<sec id="s2c">
<label>2.2</label><title>Systematic simulations and analyses</title>
<p>Next, we tested whether learning performance of oVRNNbp, oVRNNrf, and the agent with untrained fixed RNN depends on the number of RNN units (<italic>n</italic>). For a valid comparison with the previously shown cases with 7 RNN units, the learning rate for the value weights was normalized by dividing by <italic>n</italic>/7. Learning performance was measured by the mean of squares of differences between the state values developed by each of these three types of agents and the estimated true state values (<xref rid="fig2" ref-type="fig">Fig. 2B</xref>) between cue and reward at 1000-th trial. As shown in the left panel of <xref rid="fig2" ref-type="fig">Fig. 2J</xref>, on average across simulations, oVRNNbp and oVRNNrf exhibited largely comparable performance and always outperformed the untrained RNN (<italic>p</italic> &lt; 0.00022 in Wilcoxon rank sum test for oVRNNbp or oVRNNrf vs untrained for each number of RNN units), although oVRNNbp somewhat outperformed or underperformed oVRNNrf when the number of RNN units was small (≤10 (<italic>p</italic> &lt; 0.049)) or large (≥25 (<italic>p</italic> &lt; 0.045)), respectively. As the number of RNN units increased from 5 to 15 or 20, all these three agents improved their performance. Additional increase of RNN units did not largely change the mean performance in oVRNNrf, while moderately decreased it in oVRNNbp and untrained RNN. The green line in <xref rid="fig2" ref-type="fig">Fig. 2J-right</xref> shows the performance of a special case where the random feedback in oVRNNrf was fixed to the direction of (1, 1, …, 1)<sup>T</sup> (i.e., uniform feedback) with a random coefficient, which was largely comparable to, but somewhat worse than, that for the general oVRNNrf (blue line).</p>
<p>In order to examine the dimensionality of RNN dynamics, we conducted principal component analysis (PCA) of the time series (for 1000 trials) of RNN activities and calculated the contribution ratios of PCs in the cases of oVRNNbp, oVRNNrf, and untrained RNN with 20 RNN units. <xref rid="fig2" ref-type="fig">Figure 2K</xref> shows a log of contribution ratios of 20 PCs in each case. Compared with the case of untrained RNN, in oVRNNbp and oVRNNrf, initial component(s) had smaller contributions (PC1 (<italic>t</italic>-test <italic>p</italic> = 0.00018 in oVRNNbp; <italic>p</italic> = 0.0058 in oVRNNrf) and PC2 (<italic>p</italic> = 0.080 in oVRNNbp; <italic>p</italic> = 0.0026 in oVRNNrf)) while later components had larger contributions (PC3∼10,15∼20 <italic>p</italic> &lt; 0.041 in oVRNNbp; PC5∼20 <italic>p</italic> &lt; 0.0017 in oVRNNrf) on average, and this is considered to underlie their superior learning performance. We noticed that late components had larger contributions in oVRNNrf than in oVRNNbp, although these two models with 20 RNN units were comparable in terms of cue∼reward state values (<xref rid="fig2" ref-type="fig">Fig. 2J-left</xref>).</p>
<p>We examined how learning proceeded across trials in the models with 20 RNN units. As shown in <xref rid="fig2" ref-type="fig">Fig. 2L</xref>, learning became largely converged by 1000-th trial, although slight improvement continued afterward. We further examined the cases with longer cue-reward delays. As shown in <xref rid="fig2" ref-type="fig">Fig. 2M</xref>, as the delay increased, the mean squared error of state values (at 3000-th trial) increased, but the relative superiority of oVRNNbp and oVRNNrf over the model with untrained RNN remained to hold, except for cases with small number of RNN units (5) and long delay (5 or 6) (<italic>p</italic> &lt; 0.0025 in Wilcoxon rank sum test for oVRNNbp or oVRNNrf vs untrained for each number of RNN units for each delay).</p>
</sec>
<sec id="s2d">
<label>2.3</label><title>Occurrence of feedback alignment and an intuitive understanding of its mechanism</title>
<p>Next, we questioned how feedback alignment contributes to the learnability of oVRNNrf. To address this question we used an RNN with 7 units and examined whether the value weight vector <bold><italic>w</italic></bold> became aligned to the random feedback vector <bold><italic>c</italic></bold> in oVRNNrf, by looking at the changes in the angle between these two vectors across trials. As shown in <xref rid="fig3" ref-type="fig">Fig. 3A</xref>, this angle, averaged across simulations, decreased over trials, indicating that the value weight <bold><italic>w</italic></bold> indeed tended to become aligned to the random feedback <bold><italic>c</italic></bold>. We then examined whether better alignment of <bold><italic>w</italic></bold> to <bold><italic>c</italic></bold> related to better development of state value by looking at the relation between the angle between <bold><italic>w</italic></bold> and <bold><italic>c</italic></bold> and the value of the pre-reward state at 1000-th trial. As shown in <xref rid="fig3" ref-type="fig">Fig. 3B</xref>, there was a negative correlation such that the smaller the angle (i.e., more aligned), the larger the state value (<italic>r</italic> = −0.288, <italic>p</italic> = 0.00362), consistent with our expectation. These results indicate that the mechanism of feedback alignment, previously shown to work for supervised learning, also worked for TD learning of value weights and recurrent/feed-forward connections.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3</label>
<caption><title>Occurrence of feedback alignment and an intuitive understanding of its mechanism.</title>
<p><bold>(A)</bold> Over-trial changes in the angle between the value-weight vector <bold><italic>w</italic></bold> and the fixed random feedback vector <bold><italic>c</italic></bold> in the simulations of oVRNNrf (7 RNN units). The solid line and the dashed lines indicate the mean and ± SD across 100 simulations, respectively. <bold>(B)</bold> Negative correlation (<italic>r</italic> = −0.288, <italic>p</italic> = 0.00362) between the angle between <bold><italic>w</italic></bold> and <bold><italic>c</italic></bold> (horizontal axis) and the value of the pre-reward state (vertical axis) at 1000-th trial. The dots indicate the results of individual simulations, and the line indicates the regression line. <bold>(C)</bold> Angle between the hypothetical change in <bold><italic>x</italic></bold>(<italic>t</italic>) = <bold><italic>f</italic></bold>(<bold>A<italic>x</italic></bold>(<italic>t</italic>−1),<bold>B<italic>o</italic></bold>(<italic>t</italic>−1)) in case <bold>A</bold> and <bold>B</bold> were replaced with their updated ones, multiplied with the sign of TD-RPE (sign(<italic>δ</italic>(<italic>t</italic>))), and the fixed random feedback vector <bold><italic>c</italic></bold> across time-steps. The black thick line and the gray lines indicate the mean and ± SD across 100 simulations, respectively (same applied to (D)). <bold>(D)</bold> Multiplication of TD-RPEs in successive trials at individual states (top: cue, 4th from the top: reward). Positive or negative value indicates that TD-RPEs in successive trials have the same or different signs, respectively. <bold>(E)</bold> <italic>Left</italic>: RNN trajectories mapped onto the primary and secondary principal components (horizontal and vertical axes, respectively) in three successive trials (red, blue, and green lines (heavily overlapped)) at different phases in an example simulation (10th-12th, 300th-302th, 600th-602th, and 900th-902th trials from top to bottom). The crosses and circles indicate the cue and reward states, respectively. <italic>Right</italic>: State values (black lines) and TD-RPEs (red lines) at 11th, 301th, 601th, and 901th trial.</p></caption>
<graphic xlink:href="609100v4_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4</label>
<caption><title>Simulation of two tasks having probabilistic structures, which were qualitatively similar to the two tasks examined in experiments <sup><xref ref-type="bibr" rid="c54">54</xref></sup> and modeled by the original value-RNN with BPTT <sup><xref ref-type="bibr" rid="c26">26</xref></sup>.</title>
<p><bold>(A)</bold> Simulated two tasks, in which reward was given at the early or the late timing with equal probabilities in all the trials (task 1) or 60% of trials (task 2). <bold>(B) (a)</bold> <italic>Top</italic>: Trial types. Two trial types (with early reward and with late reward) in task 1 and three trial types (with early reward, with late reward, and without reward) in task 2. <italic>Bottom</italic>: Value of each timing in each trial type estimated through simulations. <bold>(b)</bold> Agent’s probabilistic belief about the current trial type, in the case where agent was in fact in the trial with early reward (top row), the trial with late reward (second row), or the trial without reward (third row in task 2). <bold>(c)</bold> <italic>Top</italic>: States defined by considering the probabilistic beliefs at each timing from cue. <italic>Bottom</italic>: True state/timing values calculated by taking (mathematical) expected value of the estimated value of each timing in each trial type. <bold>(C)</bold> Expected TD-RPE calculated from the estimated true values of the states/timings for task 1 (left) and task 2 (right). Red lines: case where reward was given at the early timing, blue lines: case where reward was given at the late timing. It is expected that TD-RPE at early reward is larger than TD-RPE at late reward in task 1 whereas the opposite is the case in task 2, as indicated by the inequality sings. <bold>(D-H)</bold> TD-RPEs at the latest trial within 1000 trials in which reward was given at the early timing (red lines) or the late timing (blue lines), averaged across 100 simulations (error-bars indicating ± SEM across simulations), in the different types of agent: (D,E) TD-RL agent having punctate state representation and state values without (D) or with (E) continuation between trials; (F) oVRNNbp. The number of RNN units was 12 (same applied to (G,H)); (G) oVRNNrf; (H) agent with untrained RNN. The <italic>p</italic> values are for paired <italic>t</italic>-test between TD-RPE at early reward and TD-RPE at late reward (100 pairs, two-tailed), and the <italic>d</italic> values are Cohen’s <italic>d</italic> using an average variance and their signs are with respect to the expected patterns shown in (C) (same applied to <xref ref-type="fig" rid="fig8">Fig. 8</xref> and <xref ref-type="fig" rid="fig9">Fig. 9C</xref>).</p></caption>
<graphic xlink:href="609100v4_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5</label>
<caption><title>Revised online value-RNN models with further biological constraints.</title>
<p>(<bold>A</bold>) oVRNNbp-rev: oVRNNbp (online value-RNN with backprop) was modified so that the activities of neurons in the RNN (<bold><italic>x</italic></bold>) and the value weights (<bold><italic>w</italic></bold>) became non-negative. (<bold>B</bold>) oVRNNrf-bio: oVRNNrf (online value-RNN with fixed random feedback) was modified so that <bold><italic>x</italic></bold> and <bold><italic>w</italic></bold>, as well as the fixed random feedback (<bold><italic>c</italic></bold>), became non-negative and also the dependence of the update rules for recurrent/feed-forward connections (<bold>A</bold> and <bold>B</bold>) on post-synaptic activity became monotonic + saturation.</p></caption>
<graphic xlink:href="609100v4_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>How did the feedback alignment mechanistically occur? We made an attempt to obtain an intuitive understanding. Assume that positive TD-RPE (<italic>δ</italic>(<italic>t</italic>) &gt; 0) is generated in a state, <italic>S</italic> (= <bold><italic>x</italic></bold>(<italic>t</italic>)) in a trial. Because of the update rule for <bold><italic>w</italic></bold> (<bold><italic>w</italic></bold> ← <bold><italic>w</italic></bold> + <italic>aδ</italic>(<italic>t</italic>)<bold><italic>x</italic></bold>(<italic>t</italic>)) (<xref rid="eqn1h" ref-type="disp-formula">Eq. 1.9</xref> in the Methods), <bold><italic>w</italic></bold> is updated in the direction of <bold><italic>x</italic></bold>(<italic>t</italic>). Next, what is the effect of updates of recurrent/feed-forward connections (<bold>A</bold> and <bold>B</bold>) on <bold><italic>x</italic></bold>? For simplicity, here we consider the case where observation is null (<bold><italic>o</italic></bold> = <bold>0</bold>) and so <bold><italic>x</italic></bold>(<italic>t</italic>) = <bold><italic>f</italic></bold>(<bold>A<italic>x</italic></bold>(<italic>t</italic>−1)) holds (but similar argument can be done in the case where observation is not null). If <bold>A</bold> is replaced with its updated one, it can be calculated that <italic>i</italic>-th element of <bold>A<italic>x</italic></bold>(<italic>t</italic>−1) will hypothetically change by <italic>c<sub>i</sub></italic> × (a positive value) (technical note: the value is <italic>aδ</italic>(<italic>t</italic>){Σ<italic><sub>j</sub>x<sub>j</sub></italic>(<italic>t</italic>−1)<sup><xref ref-type="bibr" rid="c2">2</xref></sup>}(0.5 + <italic>x<sub>i</sub></italic>(<italic>t</italic>))(0.5 − <italic>x<sub>i</sub></italic>(<italic>t</italic>)) (c.f., <xref rid="eqn1i" ref-type="disp-formula">Eq. 1.10</xref>) which is positive unless <italic>x</italic>(<italic>t</italic>−1) = <bold>0</bold>), and therefore the vector <bold>A<italic>x</italic></bold>(<italic>t</italic>−1) as a whole will hypothetically change by a vector that is in a relatively close angle with <bold><italic>c</italic></bold> , or more specifically, is in the same quadrant as (and thus within at maximum 90° from) <bold><italic>c</italic></bold> (for example, [<italic>c</italic><sub>1</sub> <italic>c</italic><sub>2</sub> <italic>c</italic><sub>3</sub>]<sup>T</sup> and [0.5<italic>c</italic><sub>1</sub> 1.2<italic>c</italic><sub>2</sub> 0.8<italic>c</italic><sub>3</sub>]<sup>T</sup>). Then, because <italic>f</italic> is a monotonically increasing sigmoidal function, <bold><italic>x</italic></bold>(<italic>t</italic>) = <bold><italic>f</italic></bold>(<bold>A<italic>x</italic></bold>(<italic>t</italic>−1)) will also hypothetically change by a vector that is in a relatively close angle with <bold><italic>c</italic></bold>. This was indeed the case in our simulations as shown in <xref rid="fig3" ref-type="fig">Fig. 3C</xref>, which plotted the angle between the hypothetical change in <bold><italic>x</italic></bold>(<italic>t</italic>) = <bold><italic>f</italic></bold>(<bold>A<italic>x</italic></bold>(<italic>t</italic>−1),<bold>B<italic>o</italic></bold>(<italic>t</italic>−1)) in case <bold>A</bold> and <bold>B</bold> were replaced with their updated ones, multiplied with the sign of TD-RPE (sign(<italic>δ</italic>(<italic>t</italic>))), and the fixed random feedback vector <bold><italic>c</italic></bold> across time-steps.</p>
<p>In this way, at state <italic>S</italic> where TD-RPE is positive, <bold><italic>w</italic></bold> is updated in the direction of <bold><italic>x</italic></bold>(<italic>t</italic>), and <bold><italic>x</italic></bold>(<italic>t</italic>) will hypothetically change by a vector that is in a relatively close angle with <bold><italic>c</italic></bold> if <bold>A</bold> is replaced with its updated one. Then, if the update of <bold><italic>w</italic></bold> and the hypothetical change in <bold><italic>x</italic></bold>(<italic>t</italic>) due to the update of <bold>A</bold> could be integrated, <bold><italic>w</italic></bold> would become aligned to <bold><italic>c</italic></bold> (if TD-RPE is instead negative, <bold><italic>w</italic></bold> is updated in the opposite direction of <bold><italic>x</italic></bold>(<italic>t</italic>), and <bold><italic>x</italic></bold>(<italic>t</italic>) will hypothetically change by a vector that is in a relatively close angle with −<bold><italic>c</italic></bold>, and so the same story holds in the end).</p>
<p>There is, however, a caveat regarding how the update of <bold><italic>w</italic></bold> and the hypothetical change in <bold><italic>x</italic></bold>(<italic>t</italic>) can be integrated. Although technical, here we briefly describe the caveat and a possible solution for it. The updates of <bold><italic>w</italic></bold> and <bold>A</bold> use TD-RPE, which are calculated based on <italic>v</italic>(<italic>t</italic>) = <bold><italic>w</italic></bold><sup>T</sup> <bold><italic>x</italic></bold>(<italic>t</italic>) and <italic>v</italic>(<italic>t</italic>+1) = <bold><italic>w</italic></bold><sup>T</sup> <bold><italic>x</italic></bold>(<italic>t</italic>+1), and so <bold><italic>x</italic></bold>(<italic>t</italic>) and <bold><italic>x</italic></bold>(<italic>t</italic>+1) should already be determined beforehand. Therefore, the hypothetical change in <bold><italic>x</italic></bold>(<italic>t</italic>) due to the update of <bold>A</bold>, described in the above, does not actually occur (this was why we mentioned ‘hypothetical’) and thus cannot be integrated with the update of <bold><italic>w</italic></bold>. Nevertheless, integration could still occur across successive trials, at least to a certain extent. Specifically, although TD-RPEs at <italic>S</italic> in successive trials would generally differ from each other, they would still tend to have the same sign, as was indeed the case in our simulations (<xref rid="fig3" ref-type="fig">Fig. 3D</xref>). Also, although the trajectories of RNN activity (<bold><italic>x</italic></bold>) in successive trials would differ, we could expect a certain level of similarity because the RNN is entrained by observation-representing inputs, again as was indeed the case in our example simulation (<xref rid="fig3" ref-type="fig">Fig. 3E</xref>). Then, the hypothetical change in <bold><italic>x</italic></bold>(<italic>t</italic>) due to the update of <bold>A</bold>, considered above, could become a reality in the next trial, to a certain extent, and could thus be integrated into the update of <bold><italic>w</italic></bold>, explaining the occurrence of feedback alignment.</p>
</sec>
<sec id="s2e">
<label>2.4</label><title>Simulation of tasks with probabilistic structures of reward timing/existence</title>
<p>Previous work <sup><xref ref-type="bibr" rid="c54">54</xref></sup> examined the response of DA neurons in cue-reward association tasks in which reward timing was probabilistically determined (early in some trials but late in other trials). There were two tasks, which were largely similar but there was a key difference that reward was given in all the trials in one task whereas reward was omitted in some randomly determined trials in another task. Starkweather et al. <sup><xref ref-type="bibr" rid="c54">54</xref></sup> found that the DA response to later reward was smaller than the response to earlier reward in the former task, presumably reflecting the animal’s belief that delayed reward will surely come, but the opposite was the case in the latter task, presumably because the animal suspected that reward was omitted in that trial. Starkweather et al.<sup><xref ref-type="bibr" rid="c54">54</xref></sup> then showed that such response patterns could be explained if DA encoded TD-RPE under particular state representations that incorporated the probabilistic structures of the task (called the ‘belief state’). In that study, such state representations were ‘handcrafted’ by the authors, but the subsequent work <sup><xref ref-type="bibr" rid="c26">26</xref></sup> showed that the original value-RNN with backprop (BPTT) could develop similar representations and reproduce the experimentally observed DA patterns.</p>
<p>In order to examine if our online value-RNN with fixed random feedback could also explain those experimental results, we simulated two tasks (<xref rid="fig4" ref-type="fig">Fig. 4A</xref>) that were qualitatively similar to (though simpler than) the two tasks examined in the experiments <sup><xref ref-type="bibr" rid="c54">54</xref></sup>. In our task 1, a cue was always followed by a reward either two or four time-steps later with equal probabilities. Task 2 was the same as task 1 except that reward was omitted with 40% probability. In task 1, if reward was not given at the early timing (i.e., two-steps later than cue), agent could predict that reward would be given at the late timing (i.e., four-steps later than cue), and thus TD-RPE upon reward at the late timing is expected to be smaller than TD-RPE upon reward at the early timing (if agent perfectly learned the task structure, TD-RPE upon reward at the late timing should be 0). By contrast, in task 2, if reward was not given at the early timing, it might indicate that reward would be given at the late timing but might instead indicate that reward would be omitted in that trial, and thus TD-RPE upon reward at the late timing is expected to exist and can even be larger than TD-RPE upon reward at the early timing.</p>
<p>In these tasks, states can be defined in the following way. There were two types of trials, with early or late reward, in task 1, and additionally one more type of trial, without reward, in task 2 (<xref rid="fig4" ref-type="fig">Fig. 4Ba</xref>, top). For each timing after receival of cue information in each of these trial types, its value can be estimated through simulations (<xref rid="fig4" ref-type="fig">Fig. 4Ba</xref>, bottom). Agent could not know the current trial type until receiving reward at the early timing or the late timing or receiving no reward at both timings. Until these timings, agent could have probabilistic belief about the current trial type, e.g., 50% in the trial with early reward and 50% in the trial with late reward (in task 1) or 30% in the trial with early reward, 30% in the trial with late reward, and 40% in the trial without reward (in task 2) (<xref rid="fig4" ref-type="fig">Fig. 4Bb</xref>). States of the timings after receival of cue information can be defined by incorporating these probabilistic beliefs at each timing (<xref rid="fig4" ref-type="fig">Fig. 4Bc</xref>, top). Their true values can be calculated by taking (mathematical) expected value of the estimated values of each timing in each trial type (<xref rid="fig4" ref-type="fig">Fig. 4Bc</xref>, bottom). Expected TD-RPE calculated from the estimated true values (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>) exhibited features that matched the conjecture mentioned above: in task 1, TD-RPE upon reception of late reward, which was actually 0, was smaller than TD-RPE upon reception of early reward, whereas in task 2, TD-RPE upon reception of late reward was larger than TD-RPE upon reception of early reward (as indicated by the inequality signs on <xref rid="fig4" ref-type="fig">Fig. 4C</xref>).</p>
<p>As mentioned above, the previous work <sup><xref ref-type="bibr" rid="c54">54</xref></sup> has shown that VTA DA neurons exhibited similar activity patterns to the abovementioned TD-RPE patterns, and the subsequent work <sup><xref ref-type="bibr" rid="c26">26</xref></sup> has shown that the original value-RNN with backprop (BPTT) could reproduce such TD-RPE patterns. We examined how our oVRNNbp and oVRNNrf, (with 12 RNN units) behaved in our simulated two tasks. oVRNNbp developed the expected TD-RPE patterns, i.e., smaller TD-RPE upon late than early timing in task 1 but opposite pattern in task 2 (<xref rid="fig4" ref-type="fig">Fig. 4F</xref>), and oVRNNrf also developed such patterns although the effect size for task 1 was small (<xref rid="fig4" ref-type="fig">Fig. 4G</xref>). These results indicate that online value-RNN could learn the probabilistic structures of the tasks even with fixed random feedback. By contrast, agents with punctate state representation without or with continuous value update across trials (<xref rid="fig4" ref-type="fig">Fig. 4D,E</xref>), as well as agent with untrained fixed RNN (<xref rid="fig4" ref-type="fig">Fig. 4H</xref>), could not develop such patterns well.</p>
</sec>
<sec id="s2f">
<label>3.1</label><title>Online value-RNN with further biological constraints</title>
<p>So far, the activities of neurons in the RNN (<bold><italic>x</italic></bold>) were initialized to pseudo standard normal random numbers, and thereafter took numbers in the range between −0.5 and 0.5 that was the range of the sigmoidal input-output function. The value weights (<bold><italic>w</italic></bold>) could also take both positive and negative values since no constraint was imposed. The fixed random feedback in oVRNNrf (<bold><italic>c</italic></bold>) was generated by pseudo standard normal random numbers, and so could also be positive or negative. Negativity of the neurons’ activities and the value weights could potentially be regarded as inhibitory or smaller-than-baseline quantities. However, because neuronal firing rate is non-negative and cortico-striatal projections are excitatory, it would be biologically more plausible to assume that the activities of neurons in the RNN and the value weights are non-negative. As for the fixed random feedback, if it is negative, the update rule becomes anti-Hebbian under positive TD-RPE, and so assuming non-negativity would be plausible since Hebbian property has been suggested for rapid plasticity of cortical synapses <sup><xref ref-type="bibr" rid="c55">55</xref></sup> (see Appendix A.2 for possible consideration of behavioral time-scale synaptic plasticity (BTSP) in our models). Regarding the connection weights in/onto the RNN, here we keep the original assumption that they could be positive or negative because it could be an approximate description of recurrent neuronal network with both recurrent excitation and inhibition. Later (<xref rid="s2i" ref-type="sec">Section 4.1</xref>) we will examine extended models that incorporate excitatory and inhibitory units and conform to the Dale’s law.</p>
<p>Other than the sign of connection weights, there was another biological plausibility issue in the update rule for recurrent and feed-forward connections that were derived from the gradient descent. Specifically, the dependence on the post-synaptic activity was non-monotonic, maximized at the middle of the range of activity. It would be more biologically plausible to assume a monotonic increase (while an <italic>opposite</italic> shape of non-monotonicity, once decrease and thereafter increase, called the BCM (Bienenstock-Cooper-Munro) rule has actually been suggested <sup><xref ref-type="bibr" rid="c56">56</xref>–<xref ref-type="bibr" rid="c58">58</xref></sup>).</p>
<p>In order to address these issues, we considered revised models. We first considered a revised oVRNNbp (with backprop-type transported weights), referred to as oVRNNbp-rev, in which the RNN activities and the value weights were constrained to be non-negative, while the non-monotonic dependence of the update rule on the post-synaptic activity remained unchanged (<xref rid="fig5" ref-type="fig">Fig. 5A</xref>). We then considered a revised oVRNNrf, referred to as oVRNNrf-bio, in which the fixed random feedback, as well as the RNN activities and the value weights, were constrained to be non-negative, and also the update rule was modified so that the dependence on the post-synaptic activity became monotonic (with saturation) (<xref rid="fig5" ref-type="fig">Fig. 5B</xref>).</p>
<p>We examined how these revised models, in comparison with agent with untrained RNN that also had non-negative constraint for <bold><italic>x</italic></bold> and <bold><italic>w</italic></bold>, performed in the Pavlovian cue-reward association task examined above (the numbers of RNN-units and trials were set to 12 and 1500, respectively). oVRNNbp-rev well developed state values toward reward (<xref rid="fig6" ref-type="fig">Fig. 6A</xref>). oVRNNrf-bio also developed state values to a largely comparable extent (<xref rid="fig6" ref-type="fig">Fig. 6B</xref>). By contrast, agent with untrained RNN could not develop such a pattern of state values (<xref rid="fig6" ref-type="fig">Fig. 6C</xref>). This, however, could be because initially set recurrent/feed-forward connections were far from those learned in the online value-RNNs. Therefore, as a more strict control, we conducted simulations of agent with untrained RNN with non-negative <bold><italic>x</italic></bold> and <bold><italic>w</italic></bold>, where in each simulation the recurrent/feed-forward connections were set to be those shuffled from the learnt connections in a simulation of oVRNNrf-bio (hereafter we refer to these two types of untrained RNN as “naive untrained RNN” and “shuffled untrained RNN”). The model with shuffled untrained RNN developed state values somewhat better than the naive untrained RNN case (<xref rid="fig6" ref-type="fig">Fig. 6D</xref>), but still worse than oVRNNbp-rev and oVRNNrf-bio.</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6</label>
<caption><title>Performances of the revised online value-RNN models in the cue-reward association task, in comparison with models with untrained RNN that also had the non-negative constraint.</title>
<p><bold>(A-D)</bold> State values (black lines) and TD-RPEs (red lines) at 1500-th trial in oVRNNbp-rev (A), oVRNNrf-bio (B), agent with naive untrained RNN (i.e., randomly initialized RNN) with <bold><italic>x</italic></bold> and <bold><italic>w</italic></bold> constrained to be non-negative (C), and agent with untrained RNN with connections shuffled from those learnt in oVRNNrf-bio and also with non-negative <bold><italic>x</italic></bold> and <bold><italic>w</italic></bold> (D). The number of RNN units was 12 in all the cases. Error-bars indicate mean ± SEM across 100 simulations; same applied to the followings unless otherwise mentioned. The right histograms show the across-simulation distribution of the value of the pre-reward state in each model. The vertical black dashed lines in the histograms indicate the true value of the pre-reward state (estimated through simulations). <bold>(E)</bold> <italic>Left</italic>: Mean squared value-error at 1500-th trial in oVRNNbp-rev (red line), oVRNNrf-bio (blue line), agent with naive untrained RNN (gray solid line: partly out of view), and agent with shuffled untrained RNN (gray dotted line) when the number of RNN units (<italic>n</italic>) was varied from 5 to 40. Learning rate for value weights was normalized by dividing by <italic>n</italic>/12 (same applied to the followings). <italic>Right</italic>: Mean squared value-error in oVRNNrf-bio (blue line: same data as in the left panel), oVRNN-bio with random-magnitude uniform feedback (green line), oVRNN-bio with fixed-magnitude (0.5) uniform feedback (light blue line), and oVRNNrf-rev where the update rule of oVRNNrf-bio was changed back to the original one (blue dotted line). <bold>(F)</bold> <italic>Left</italic>: Mean of the elements of the recurrent and feed-forward connections (at 1500-th trial) of oVRNNbp-rev (red line), oVRNNrf-bio (blue line), and naive untrained RNN (gray solid line). <italic>Right</italic>: Mean of the elements of the recurrent and feed-forward connections of oVRNNrf-bio (blue line: same data as in the left panel), oVRNN-bio with random-magnitude uniform feedback (green line), oVRNN-bio with fixed-magnitude (0.5) uniform feedback (light blue line), and oVRNNrf-rev (blue dotted line). <bold>(G)</bold> Learned state values (left panel) and TD-RPEs (right panel) in oVRNNbp-rev (red lines) and oVRNNrf-bio (blue lines) in the cases with 40 RNN units, compared to the estimated true values (black lines). <bold>(H)</bold> Log of contribution ratios of the principal components of the time series (for 1500 trials) of RNN activities in each model with 20 RNN units. <bold>(I)</bold> Mean squared value-error in each model with 20 RNN units across trials. <bold>(J)</bold> Mean squared value-error at 3000-th trial in each model in the cases where the cue-reward delay was 3, 4, 5, or 6 time-steps (top to bottom panels). Left and right panels show the results with default learning rates and halved learning rates, respectively.</p></caption>
<graphic xlink:href="609100v4_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2g">
<label>3.2</label><title>Systematic simulations and analyses</title>
<p>We varied the number of RNN units (<italic>n</italic>), with the learning rate for value weights normalized by dividing by <italic>n</italic>/12, and compared the performance (mean of squared errors of state values between cue and reward at 1500-th trial) of oVRNNbp-rev and oVRNNrf-bio, in comparison with models with naive or shuffled untrained RNN. As shown in the left panel of <xref rid="fig6" ref-type="fig">Fig. 6E</xref>, oVRNNbp-rev and oVRNNrf-bio exhibited largely comparable performance and always outperformed the models with untrained RNN (<italic>p</italic> &lt; 2.5×10<sup>−12</sup> in Wilcoxon rank sum test for oVRNNbp-rev or oVRNNrf-bio vs naive or shuffled untrained for each number of RNN units), although oVRNNbp-rev somewhat outperformed or underperformed oVRNNrf-bio when the number of RNN units was small (≤10 (<italic>p</italic> &lt; 0.00029)) or large (≥25 (<italic>p</italic> &lt; 3.7×10<sup>−6</sup>)), respectively (<xref rid="fig6" ref-type="fig">Figure 6G</xref> shows the learned state values and TD-RPEs in oVRNNbp-rev and oVRNNrf-bio in the cases with 40 RNN units, compared to the estimated true values). Remarkably, oVRNNrf-bio generally achieved better performance than both oVRNNbp and oVRNNrf, which did not have the non-negative constraint (Wilcoxon rank sum test, vs oVRNNbp : <italic>p</italic> &lt; 7.8×10<sup>−6</sup> for 5 or ≥25 RNN units; vs oVRNNrf: <italic>p</italic> &lt; 0.021 for ≤10 or ≥20 RNN units).</p>
<p>The left panel of <xref rid="fig6" ref-type="fig">Figure 6F</xref> shows the mean of the elements of the recurrent and feed-forward connections at 1500-th trial in the different models. As shown in this figure, these connections (initialized to pseudo standard normal random numbers) were learnt to become negative on average, in oVRNNbp-rev and oVRNNrf-bio. This learnt negative-dominance (inhibition-dominance) could possibly be related, e.g., through prevention of excessive activity, to the good performance of oVRNNrf-bio and also the better performance of the shuffled untrained RNN than the naive untrained RNN. The green and light blue lines in the right panels of <xref rid="fig6" ref-type="fig">Figure 6E</xref> and <xref rid="fig6" ref-type="fig">Figure 6F</xref> show the results for special cases where the random feedback in oVRNNrf-bio was fixed to the direction of (1, 1, …, 1)<sup>T</sup> (i.e., uniform feedback) with a random non-negative magnitude (green line) or a fixed magnitude of 0.5 (light blue line). The performance of these special cases, especially the former (with random magnitude) was somewhat worse than that of oVRNNrf-bio, but still better than that of the models with untrained RNN. The blue dotted lines in the right panels of <xref rid="fig6" ref-type="fig">Figure 6E</xref> and <xref rid="fig6" ref-type="fig">Figure 6F</xref> show the results where the modified update rule of oVRNNrf-bio was changed back to the original rule with non-monotonic dependence on the post-synaptic activity (<xref rid="fig5" ref-type="fig">Fig. 5A</xref>). The performance of this model was somewhat worse than oVRNNrf-bio, indicating that the biologically motivated modification of the update rule in fact improved the performance.</p>
<p><xref rid="fig6" ref-type="fig">Figure 6H</xref> shows contribution ratios of PCs of the time series of RNN activities in each model with 20 RNN units. Compared with the cases with naive/shuffled untrained RNN, in oVRNNbp-rev and oVRNNrf-bio, later components had relatively high contributions (PC5∼20 <italic>p</italic> &lt; 1.4×10<sup>−6</sup> (<italic>t</italic>-test vs naive) or &lt; 0.014 (vs shuffled) in oVRNNbp-rev; PC6∼20 <italic>p</italic> &lt; 2.0×10<sup>−7</sup> (vs naive) or PC7∼20 <italic>p</italic> &lt; 5.9×10<sup>−14</sup> (vs shuffled) in oVRNNrf-bio), explaining their superior value-learning performance. <xref rid="fig6" ref-type="fig">Figure 6I</xref> shows how learning proceeded across trials in the models with 20 RNN units. While oVRNNbp-rev and oVRNNrf-bio eventually reached a comparable level of errors, oVRNNrf-bio outperformed oVRNNbp-rev in early trials (at 200, 300, 400, or 500 trials; <italic>p</italic> &lt; 0.049 in Wilcoxon rank sum test for each). This is presumably because the value weights did not develop well in early trials and so the backprop-type feedback, which was the same as the value weights, did not work well, while the non-negative fixed random feedback worked finely from the beginning. <xref rid="fig6" ref-type="fig">Figure 6J</xref> shows the cases with longer cue-reward delays, with default or halved learning rates. As the delay increased, the mean squared error of state values (at 3000-th trial) increased, but the relative superiority of oVRNNbp-rev and oVRNNrf-bio over the models with untrained RNN remained to hold, except for a few cases with 5 RNN units (5 delay oVRNNrf-bio vs shuffled with default learning rate, 6 delay oVRNNrf-bio vs naive or shuffled with halved learning rate) (<italic>p</italic> &lt; 0.047 in Wilcoxon rank sum test for oVRNNbp-rev or oVRNNrf-bio vs naive or shuffled untrained for each number of RNN units for each delay).</p>
<p>We further examined how the revised online value-RNN models performed in the two tasks with probabilistic structures examined above. The models with 12 RNN units appeared not able to produce the expected different patterns of TD-RPEs in the two tasks (TD-RPE at early reward &gt; TD-RPE at late reward in task 1 and opposite pattern in task 2), and we increased the number of RNN units to 20. Then, both oVRNNbp-rev and oVRNNrf-bio produced such TD-RPE patterns (<xref rid="fig7" ref-type="fig">Fig. 7A,B</xref>) whereas the models with untrained RNN could not (<xref rid="fig7" ref-type="fig">Fig. 7C,D</xref>). This indicates that the online value-RNN with random feedback and further biological constraints could learn the differential characteristics of the tasks.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7</label>
<caption><title>Performances of the revised online value-RNN models with further biological constraints in the two tasks having probabilistic structures, in comparison with models with untrained RNN.</title>
<p>TD-RPEs at the latest trial within 2000 trials in which reward was given at the early timing (red lines) or the late timing (blue lines) in task 1 (left) and task 2 (right), averaged across 100 simulations (error-bars indicating ± SEM across simulations), are shown for the four types of agent: (A) oVRNNbp-rev; (B) oVRNNrf-bio; (C) agent with naive untrained RNN; (D) agent with untrained RNN with connections shuffled from those learnt in oVRNNrf-bio. The number of RNN units was 20 for all the cases.</p></caption>
<graphic xlink:href="609100v4_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2h">
<label>3.3</label><title>Loose alignment and feedback alignment</title>
<p>Coming back to the original cue-reward association task, we examined how the angle between the value weights (<bold><italic>w</italic></bold>) and the random feedback (<bold><italic>c</italic></bold>) changed across trials in oVRNNrf-bio with 12 RNN units. As shown in <xref rid="fig8" ref-type="fig">Fig. 8A</xref>, the angle was on average smaller than 90°, which was the chance-level angle in the case without non-negative constraint, from the beginning, while there was no further alignment over trials. This could be understood as follows. Because both the value weights (<bold><italic>w</italic></bold>) and the random feedback (<bold><italic>c</italic></bold>) were now constrained to be non-negative, these two vectors were ensured to be in a relatively close angle (i.e., in the same quadrant) from the beginning. By virtue of this loose alignment, the random feedback could act similarly to backprop-type transported-weight feedback, even without further alignment.</p>
<fig id="fig8" position="float" orientation="portrait" fig-type="figure">
<label>Figure 8</label>
<caption><title>Loose alignment of the value weights (<bold><italic>w</italic></bold>) and the random feedback (<bold><italic>c</italic></bold>) in oVRNNrf-bio (with 12 RNN units).</title>
<p>(<bold>A</bold>) Over-trial changes in the angle between the value weights <italic>w</italic> and the fixed random feedback <italic>c</italic>. The solid line and the dashed lines indicate the mean and ± SD across 100 simulations, respectively. (<bold>B</bold>) No correlation between the <italic>w</italic>-<italic>c</italic> angle (horizontal axis) and the value of the pre-reward state (vertical axis) at 1500-th trial (<italic>r</italic> = 0.0117, <italic>p</italic> = 0.908). The dots indicate the results of individual simulations. (<bold>C</bold>) Correlation between the <italic>w</italic>-<italic>c</italic> angle at <italic>k</italic>-th trial (horizontal axis) and the value of the cue, post-cue, pre-reward, or reward state (top-bottom panels) at 500-th trial across 1000 simulations. The solid lines indicate the correlation coefficient, and the short vertical bars at the top of each panel indicates the cases in which <italic>p</italic>-value was less than 0.05. (D) Distribution of the angle between two 12-dimensional vectors when the elements of both vectors were drawn from [0 1] uniform pseudo-random numbers (a) or when one of the vectors was replaced with [1 0 0 … 0] (i.e., on the edge of the non-negative quadrant) (b) or [1 1 0 … 0] (i.e., on the boundary of the non-negative quadrant) (c). (E) Across-simulations histograms of elements of <italic>w</italic> in oVRNNrf-bio with 12 RNN units ordered from the largest to smallest ones after 1500 trials when there was no value-weight-decay (a) or there was value-weight-decay with decay rate (per time-step) of 0.001 (b) or 0.002 (c). The error-bars indicate the mean ± SEM across 100 simulations. (F) Over-trial changes in the angle between the value weights <italic>w</italic> and the fixed random feedback <italic>c</italic> when there was value-weight-decay with decay rate (per time-step) of 0.001 (top panel) or 0.002 (bottom panel). Notations are the same those in (A). (G) Mean squared value-error at 1500-th trial in oVRNNrf-bio with 12 RNN units with the rate of value-weight-decay was varied (horizontal axis). The error-bars indicate the mean ± SEM across 100 simulations.</p></caption>
<graphic xlink:href="609100v4_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We examined if the angle between the value weights (<bold><italic>w</italic></bold>) and the random feedback (<bold><italic>c</italic></bold>) at 1500-th trial was associated with the developed value of pre-reward state across simulations, but found no association (<italic>r</italic> = 0.0117, <italic>p</italic> = 0.908) (<xref rid="fig8" ref-type="fig">Fig. 8B</xref>). We then examined if the <bold><italic>w</italic></bold>-<bold><italic>c</italic></bold> angle at earlier trials (2nd - 500-th trials) was associated with the developed values at 500-th trial, with the number of simulations increased to 1000 so that small correlation could be detected. We found that the <bold><italic>w</italic></bold>-<bold><italic>c</italic></bold> angle at initial trials (2nd - around 10-th trials) was negatively correlated with the developed values of the reward state and preceding states at 500-th trial (<xref rid="fig8" ref-type="fig">Fig. 8C</xref>). As for the reward state, negative correlation at around 100-th - 300-th trial was also observed. These results suggest that better alignment of <bold><italic>w</italic></bold> and <bold><italic>c</italic></bold> at initial and early timings was associated with better development of state values, in line with the conjecture that loose alignment of <bold><italic>w</italic></bold> and <bold><italic>c</italic></bold> coming from the non-negative constraint supported learning. It should be noted, however, that there were cases where positive (although small) correlation was observed. Its exact reason is not sure, but it could be related to the fact that largeness of developed values or the speed of value development does not necessarily mean good learning.</p>
<p>As mentioned above, while the angle between <bold><italic>w</italic></bold> and <bold><italic>c</italic></bold> was on average smaller than 90° from the beginning, there was no further alignment over trials. This seemed mysterious because the mechanism for feedback alignment that we derived for the models without non-negative constraint was expected to work also for the models with non-negative constraint. As a possible reason for the non-occurrence of feedback alignment, we guessed that one or a few element(s) of <bold><italic>w</italic></bold> grew prominently during learning, and so <bold><italic>w</italic></bold> became close to an edge or boundary of the non-negative quadrant and thereby angle between <bold><italic>w</italic></bold> and other vector became generally large (as illustrated in <xref rid="fig8" ref-type="fig">Fig. 8D</xref>). <xref rid="fig8" ref-type="fig">Figure 8Ea</xref> shows the mean±SEM of the elements of <bold><italic>w</italic></bold> ordered from the largest to smallest ones after 1500 trials. As conjectured above, a few elements indeed grew prominently.</p>
<p>We considered that if a slight decay (forgetting) of value weights (c.f., <sup><xref ref-type="bibr" rid="c59">59</xref>–<xref ref-type="bibr" rid="c61">61</xref></sup>) was assumed, such a prominent growth of a few elements of <bold><italic>w</italic></bold> may be mitigated and alignment of <bold><italic>w</italic></bold> to <bold><italic>c</italic></bold>, beyond the initial loose alignment because of the non-negative constraint, may occur. These conjectures were indeed confirmed by simulations (<xref rid="fig8" ref-type="fig">Fig. 8Eb</xref>,c and <xref rid="fig8" ref-type="fig">Fig. 8F</xref>). The mean squared value error slightly increased when the value-weight-decay was assumed (<xref rid="fig8" ref-type="fig">Fig. 8G</xref>), however, presumably reflecting a decrease in developed values and a deterioration of learning because of the decay.</p>
</sec>
<sec id="s2i">
<label>4.1</label><title>Models with excitatory and inhibitory units</title>
<p>As mentioned above, in oVRNNbp-rev and oVRNNrf-bio, the connection weights in/onto the RNN could be both positive and negative, against the Dale’s law. Recent studies started to examine neural networks incorporating the Dale’s law <sup><xref ref-type="bibr" rid="c62">62</xref>, <xref ref-type="bibr" rid="c63">63</xref></sup> or other connectivity features <sup><xref ref-type="bibr" rid="c64">64</xref></sup>. So we examined extended models, named oVRNNbp-rev-ei and oVRNNrf-bio-ei, which incorporated excitatory E-units, modeling pyramidal cells, and inhibitory I-units, modeling fast-spiking (FS) cells (<xref rid="fig9" ref-type="fig">Fig. 9A</xref>). Cortical excitation can operate slowly due to slow synaptic dynamics <sup><xref ref-type="bibr" rid="c46">46</xref>, <xref ref-type="bibr" rid="c47">47</xref></sup> (see the description about the time-step in the Methods for details). In contrast, inhibition from FS cells to pyramidal cells may operate more quickly, since it was shown <sup><xref ref-type="bibr" rid="c65">65</xref></sup> that observed phases of regular-spiking (RS, putatively pyramidal) cells’ and FS cells’ spikes <sup><xref ref-type="bibr" rid="c66">66</xref></sup> could be explained by fast FS→RS inhibition and temporally distributed recurrent excitation.</p>
<fig id="fig9" position="float" orientation="portrait" fig-type="figure">
<label>Figure 9</label>
<caption><title>oVRNNbp-rev-ei and oVRNNrf-bio-ei models incorporating excitatory E-units and inhibitory I-units.</title>
<p><bold>(A)</bold> Schematic illustration of the models’ architecture. For ease of viewing, only limited parts of units and connections are drawn. <bold>(B)</bold> Mean squared value-error at 1500-th trial in the cue-reward association task in oVRNNbp-rev-ei (red line), oVRNNrf-bio-ei (blue line), and E-/I-units-incorporated models with naive untrained RNN (i.e., randomly initialized RNN) (gray solid line) or untrained RNN with connections shuffled from those learnt in oVRNNrf-bio-ei (gray dotted line). <bold>(C)</bold> Patterns of TD-RPE in the tasks with probabilistic structures generated in the four models with E-/I-units. Simulation conditions and notations are the same those in <xref ref-type="fig" rid="fig7">Fig. 7</xref>.</p></caption>
<graphic xlink:href="609100v4_fig9.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Given these, we assumed that excitation from E-units to E- and I-units took one time-step whereas I→E inhibition operated within a time-step, and also that each E-unit received inputs from all the E-units and a particular I-unit (although this assumption could be supported by the abovementioned suggestions, its validity remains largely open). Chemical and electrical connections between FS cells exist and are suggested to serve for synchronization or oscillation <sup><xref ref-type="bibr" rid="c67">67</xref>, <xref ref-type="bibr" rid="c68">68</xref></sup>, but we omitted I→I connections because our models did not describe fast spike dynamics. Since FS cells can fire at high frequencies, we assumed that the activation function for I-units was not saturating but linear. Lastly, we did not assume plasticity for connections from/to I-units. The connection weights onto the E- and I-units from the observation units and E-units were non-negatively initialized, specifically, initialized to pseudo normal random numbers with mean = 3 and standard deviation = 1 and rectified to 0 when becoming negative.</p>
<p>We examined how these extended models behaved in the Pavlovian task and the probabilistic tasks. As shown in <xref rid="fig9" ref-type="fig">Fig. 9B</xref>, oVRNNbp-rev-ei and oVRNNrf-bio-ei learned the state values in the Pavlovian task much more accurately than the models with naive untrained RNN or untrained RNN whose connections from the observation and E-units to E- and I-units were shuffled from oVRNNrf-bio-ei (<italic>p</italic> &lt; 5.2×10<sup>−12</sup> in Wilcoxon rank sum test for oVRNNbp-rev-ei or oVRNNrf-bio-ei vs naive or shuffled untrained for each number of RNN units). oVRNNbp-rev-ei somewhat outperformed or underperformed oVRNNrf-bio-ei when the number of RNN units was small (≤10 (<italic>p</italic> &lt; 0.0091)) or relatively large (15∼35 (<italic>p</italic> &lt; 0.027)), respectively. Also, as shown in <xref rid="fig9" ref-type="fig">Fig. 9C</xref>, oVRNNbp-rev-ei and oVRNNrf-bio-ei with 20 E-units and 20 I-units generated the expected different patterns of TD-RPEs in the two tasks (TD-RPE at early reward &gt; TD-RPE at late reward in task 1 and opposite pattern in task 2) although the effect size for task 2 in oVRNNrf-bio-ei was small, while the models with untrained RNN did not.</p>
<p>As such, the extended models with E-units and I-units showed largely similar behaviors to those of the original oVRNNbp-rev and oVRNNrf-bio with mixed positive and negative RNN weights. This is actually reasonable, because combining the update equations for I-units and E-units in the extended models (top two equations in <xref rid="fig9" ref-type="fig">Fig. 9A</xref>) results in an equation largely similar to the update equation for RNN units in the original models (top equation in <xref rid="fig1" ref-type="fig">Fig. 1</xref>). In other words, the original models with mixed positive and negative RNN weights could be regarded as a simplified description of the models with E-units and I-units under the abovementioned assumptions. Therefore, for simplicity, we will return to mixed positive and negative RNN weights in the following.</p>
</sec>
<sec id="s2j">
<label>4.2</label><title>Task with distractor cue</title>
<p>So far we have examined situations where there existed a reward and a cue associated with the reward. However, in real environments, it is likely that there exist both reward-associated and non-associated (distractor) cues and agent does not initially know which cue is associated with reward and which is not. Learning cue-reward association in such distractor-existing environments is generally not easy for biologically constrained models, and it has been addressed by only few previous work <sup><xref ref-type="bibr" rid="c69">69</xref></sup>. We examined whether our biologically constrained oVRNNrf-bio, as well as oVRNNbp-rev, could learn the cue-reward association under the presence of distractor cue. We considered a simple case where there existed a distractor cue, which was presented to the agent with a certain probability at every time-step, between cue-reward duration or reward-cue duration (i.e., inter-trial interval) or simultaneously with cue or reward. As for the agent’s models, we assumed that the observation inputs had an additional element (dimension), which was set to 1 when the distractor was presented and 0 when not (<xref rid="fig10" ref-type="fig">Fig. 10A</xref>).</p>
<fig id="fig10" position="float" orientation="portrait" fig-type="figure">
<label>Figure 10</label>
<caption><title>Cue-reward association task with distractor cue.</title>
<p><bold>(A)</bold> Modification of oVRNNbp-rev and oVRNNrf-bio to incorporate possible existence of distractor cue. The observation units <bold><italic>o</italic></bold> had an additional element (leftmost circle labeled as ‘Dist’), which was 1 at the time-steps where distractor cue was present and 0 otherwise. <bold>(B-E)</bold> Results of the cases where the probability of the presence of distractor cue at every time-step was 0 (B), 0.1 (C), 0.2 (D), and 0.3 (E). <italic>Left panels</italic>: Examples of the presence of distractor (’D’), reward-associated cue (’C’), and reward (’R’) over 100 time-steps. <italic>Middle panels</italic>: Mean squared value-error at 1500-th trial in oVRNNbp-rev (red line), oVRNNrf-bio (blue line), and the models with naive or shuffled untrained RNN (gray solid or dotted line). <italic>Right panels</italic>: Results for the models with E- and I-units (oVRNNbp-rev-ei: red line, oVRNNrf-bio-ei: blue line, models with naive or shuffled untrained RNN: gray solid or dotted line), which were modified to incorporate possible existence of distractor cue in the same manner as in (A).</p></caption>
<graphic xlink:href="609100v4_fig10.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We examined how oVRNNbp-rev, oVRNNrf-bio, and the models with untrained RNN behaved in the modified Pavlovian task with a distractor cue, which was presented with probability 0, 0.1, 0.2, or 0.3 at every time-step (<xref rid="fig10" ref-type="fig">Fig. 10B-E</xref>, left panels). As a result, even when there was such a distractor cue, oVRNNbp-rev and oVRNNrf-bio could still learn the state values better than the models with naive or shuffled untrained RNN (<italic>p</italic> &lt; 1.7×10<sup>−10</sup> in Wilcoxon rank sum test for oVRNNbp-rev or VRNNrf-bio vs naive or shuffled untrained for each number of RNN units for each level of distractor probability) (<xref rid="fig10" ref-type="fig">Fig. 10C-E</xref>, middle panels), although the accuracy moderately decreased compared with the case without distractor cue (<xref rid="fig10" ref-type="fig">Fig. 10B</xref>, middle panel). These results suggest robustness of the learning ability of oVRNNrf-bio against distractor in realistic situations. We further examined how the models with E- and I-units behaved in the task with a distractor cue, and confirmed that even in the presence of disctractor cue, oVRNNbp-rev-ei and oVRNNrf-bio-ei could learn the state values better than the models with naive or shuffled untrained RNN (<italic>p</italic> &lt; 3.2×10<sup>−8</sup> in Wilcoxon rank sum test for oVRNNbp-rev-ei or oVRNNrf-bio-ei vs naive or shuffled untrained for each number of RNN units for each level of distractor probability) (<xref rid="fig10" ref-type="fig">Fig. 10B-E</xref>, right panels).</p>
</sec>
<sec id="s2k">
<label>4.3</label><title>Incorporation of action selection</title>
<p>Ultimate purpose of animals and RL agents is to optimize their policy, i.e., probability of action selection at each state to maximize rewards. Therefore, we examined if our models could be extended to incorporate action selection. In reference to the proposals that algorithm akin to the actor-critic method may be implemented in the brain <sup><xref ref-type="bibr" rid="c35">35</xref>, <xref ref-type="bibr" rid="c70">70</xref>, <xref ref-type="bibr" rid="c71">71</xref></sup>, we considered extended models oVRNNbp-rev-ac and oVRNNrf-bio-ac, which incorporated an actor-critic architecture (<xref rid="fig11" ref-type="fig">Fig. 11A</xref>). Specifically, each RNN unit was assumed to connect to not only the state-value(<italic>v</italic>)-representing unit in the ventral striatum but also the action-value(<italic>q<sub>k</sub></italic>)-representing units in the dorsal striatum. Their non-negative weights (<italic>u<sub>kj</sub></italic>) represented (as a vector) action preferences, which slightly decayed with time so as not to unboundedly increase.</p>
<fig id="fig11" position="float" orientation="portrait" fig-type="figure">
<label>Figure 11</label>
<caption><title>Incorporation of action selection.</title>
<p><bold>(A)</bold> Schematic illustration of the models incorporating an actor-critic architecture. <bold>(B)</bold> Two-alternative choice task. <bold>(a)</bold> Task diagram. <bold>(b,c)</bold> Proportion of Action 1 selection in 2901∼3000-th trials in oVRNNbp-rev-as (red line), oVRNNrf-bio-as (blue line), and the models with naive untrained RNN (i.e., randomly initialized RNN) (gray solid line) or untrained RNN with connections shuffled from those learnt in VRNNrf-bio-as (gray dotted line). Error-bars indicate the mean ± SEM over 100 simulations. The inverse temperature was set to 1 (b) or 2 (c). <bold>(C)</bold> Inter-temporal choice task. The notations are the same as those in (B).</p></caption>
<graphic xlink:href="609100v4_fig11.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>It has been suggested that action is selected through competition of neural populations in the striatum-thalamus-cortex(-striatum) circuit, which represent or receive action values, in the presence of noise <sup><xref ref-type="bibr" rid="c72">72</xref>–<xref ref-type="bibr" rid="c74">74</xref></sup>. However, because our models did not describe fast neural dynamics (see the description about the time-step in the Methods), we assumed a soft-max function for action selection, i.e., assumed that an action was selected according to a soft-max probability determined by the difference in the action values when there were two action candidates. We then assumed that there is a cortical region, which contains action-representing neural populations, implemented as ‘action units’ in the model (<xref rid="fig11" ref-type="fig">Fig. 11A</xref>). Action unit was assumed to become active (i.e., = 1) when the corresponding action was selected and inactive (i.e., = 0) otherwise, and these action units were assumed to send inputs to the RNN, similarly to the observation units informing the presence of cue and reward.</p>
<p>We examined how these models (oVRNNbp-rev-ac and oVRNNrf-bio-ac) and control models with naive or shuffled untrained RNN behaved in two-alternative choice tasks. In the first choice task (<xref rid="fig11" ref-type="fig">Fig. 11Ba</xref>), taking action 1 lead to a large (size 2) reward two time-steps later whereas taking action 2 lead to a small (size 1) reward two time-steps later. oVRNNbp-rev-ac and oVRNNrf-bio-ac, after training, successfully selected the better action, action 1, in most cases, whereas the models with untrained RNN did not develop strong tendency to select action 1 (<xref rid="fig11" ref-type="fig">Fig. 11Bb,c</xref>). Next, in the second choice task (<xref rid="fig11" ref-type="fig">Fig. 11Ca</xref>), taking action 1 lead to a large (size 2) reward two time-steps later whereas taking action 2 lead to a small (size 1) reward one time-step later. So this task imposed inter-temporal choice between delayed large reward and sooner small reward. oVRNNbp-rev-ac, after training, tended to select action 1, which was better than action 2 even when presumed temporal discounting (0.8 per time-step) was taken into account (<xref rid="fig11" ref-type="fig">Fig. 11Cb,c</xref>). oVRNNrf-bio-ac also tended to select action 1 when the number of RNN units was not small. On the other hand, the models with untrained RNN tended to select sooner small reward. These results suggest that oVRNNrf-bio-ac, as well as oVRNNbp-rev-ac, could learn to select advantageous action to a certain extent, even in the case of inter-temporal choice.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>We have shown that state representation and value can be learned online in the RNN and its readout by using random feedback instead of biologically unavailable downstream weights. This was achieved through feedback alignment, and we have presented an intuitive understanding of its mechanism. We have further shown that the non-negative constraint realizes loose alignment of the forward weights and feedback from the beginning, which appeared to support learning.</p>
<sec id="s3a">
<title>Roles of DA</title>
<p>Midbrain DA neurons project to both striatum and cortex, including the prefrontal cortex <sup><xref ref-type="bibr" rid="c75">75</xref></sup> and the hippocampus <sup><xref ref-type="bibr" rid="c76">76</xref></sup>. As for striatal DA, DA-dependent cortico-striatal plasticity is considered to implement TD-RPE-based value update <sup><xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c77">77</xref></sup>. By contrast, while cortical DA has been implicated in working memory <sup><xref ref-type="bibr" rid="c78">78</xref>–<xref ref-type="bibr" rid="c81">81</xref></sup>, decision making <sup><xref ref-type="bibr" rid="c82">82</xref></sup>, and aversive memory <sup><xref ref-type="bibr" rid="c83">83</xref></sup>, its role as TD-RPE remains unclear, despite findings suggesting that cortical DA does encode (TD-)RPE <sup><xref ref-type="bibr" rid="c84">84</xref>–<xref ref-type="bibr" rid="c87">87</xref></sup> and modulate plasticity <sup><xref ref-type="bibr" rid="c88">88</xref>, <xref ref-type="bibr" rid="c89">89</xref></sup>. Learnability of our biologically constrained online value-RNN suggests that TD-RPE-encoding cortical DA modulates plasticity of RNN so that appropriate state representation can be learnt.</p>
<p>Many studies reported heterogeneities of DA signals, which may come from encoding prediction errors other than RPE or feature-specific components of RPE <sup><xref ref-type="bibr" rid="c90">90</xref></sup>. Referring to a result <sup><xref ref-type="bibr" rid="c91">91</xref></sup> indicating DA’s encoding of non-reward PEs and the fact that DA neurons receive inputs from the cerebellum <sup><xref ref-type="bibr" rid="c92">92</xref>, <xref ref-type="bibr" rid="c93">93</xref></sup>, which presumably implements supervised learning <sup><xref ref-type="bibr" rid="c94">94</xref></sup>, a recent work <sup><xref ref-type="bibr" rid="c45">45</xref></sup> proposed that DA encodes vector-valued errors used for supervised learning of actions in continuous space. In contrast, we assumed DA’s encoding of scalar TD-RPE, which can be consistent with the heterogeneity due to encoding of feature-specific RPE components <sup><xref ref-type="bibr" rid="c90">90</xref></sup>. The previous model <sup><xref ref-type="bibr" rid="c45">45</xref></sup> and our model can coexist, with different DA neuronal populations encoding different types of errors, or a single DA neuron switching its encoding depending on context/inputs.</p>
<p>VTA DA neurons project also to the basolateral amygdala (BLA) <sup><xref ref-type="bibr" rid="c95">95</xref></sup>, and DA regulates plasticity also there <sup><xref ref-type="bibr" rid="c96">96</xref></sup>. Moreover, VTA→BLA DA entailed properties of TD-RPE, although increased also upon aversive event, and was not itself reinforcing but crucial for the formation of environmental model <sup><xref ref-type="bibr" rid="c97">97</xref></sup>. BLA has recurrent connections <sup><xref ref-type="bibr" rid="c98">98</xref></sup>, projects to the striatum <sup><xref ref-type="bibr" rid="c99">99</xref>, <xref ref-type="bibr" rid="c100">100</xref></sup>, and engages in abstract context representation <sup><xref ref-type="bibr" rid="c101">101</xref></sup>. Thus, given that goal-directed-like behavior could be achieved through sophisticated state representation <sup><xref ref-type="bibr" rid="c10">10</xref>–<xref ref-type="bibr" rid="c12">12</xref></sup>, it could potentially be learned by value-RNN-like mechanism in the BLA. Whether such sophisticated representation can be learned, however, remains open, and it might require multidimensional error <sup><xref ref-type="bibr" rid="c102">102</xref></sup> beyond TD-RPE.</p>
<p>There are many DA-related mechanisms that were not incorporated into our models, including the distinctions of D1-direct and D2-indirect pathways <sup><xref ref-type="bibr" rid="c103">103</xref>–<xref ref-type="bibr" rid="c107">107</xref></sup> and cortical projections to them <sup><xref ref-type="bibr" rid="c108">108</xref>–<xref ref-type="bibr" rid="c111">111</xref></sup>, as well as mechanisms underlying TD-RPE encoding (c.f., <sup><xref ref-type="bibr" rid="c106">106</xref>, <xref ref-type="bibr" rid="c112">112</xref></sup>) or learning for it (c.f., <sup><xref ref-type="bibr" rid="c69">69</xref></sup>). Future studies are expected to incorporate these.</p>
</sec>
<sec id="s3b">
<title>Predictions and implications of our models</title>
<p>oVRNNrf predicts that the feedback vector <bold><italic>c</italic></bold> and the value-weight vector <bold><italic>w</italic></bold> become gradually aligned, while oVRNNrf-bio predicts that <bold><italic>c</italic></bold> and <bold><italic>w</italic></bold> are loosely aligned from the beginning. Element of <bold><italic>c</italic></bold> could be measured as the magnitude of pyramidal cell’s response to DA stimulation. Element of <bold><italic>w</italic></bold> corresponding to a given pyramidal cell could be measured, if striatal neuron that receives input from that pyramidal cell can be identified (although technically demanding), as the magnitude of response of the striatal neuron to activation of the pyramidal cell. Then, the abovementioned predictions could be tested by (i) identify cortical, striatal, and VTA regions that are connected, (ii) identify pairs of cortical pyramidal cells and striatal neurons that are connected, (iii) measure the responses of identified pyramidal cells to DA stimulation, as well as the responses of identified striatal neurons to activation of the connected pyramidal cells, and (iv) test whether DA→pyramidal responses and pyramidal→striatal responses are associated across pyramidal cells, and whether such associations develop through learning.</p>
<p>Testing this prediction, however, would be technically quite demanding, as mentioned above. An alternative way of testing our model is to manipulate the cortical DA feedback and see if it will cause (re-)alignment of value weights (i.e., cortical striatal strengths). Specifically, our model predicts that if DA projection to a particular cortical locus is silenced, effect of the activity of that locus on the value-encoding striatal activity will become diminished.</p>
<p>We have shown that oVRNNrf and oVRNNrf-bio could work even when the random feedback was uniform, i.e., fixed to the direction of (1, 1, …, 1)<sup>T</sup>, although the performance was somewhat worse. This is reasonable because uniform feedback can still encode scalar TD-RPE that drives our models, in contrast to a previous study <sup><xref ref-type="bibr" rid="c45">45</xref></sup>, which considered DA’s encoding of vector error and thus regarded uniform feedback as a negative control. If oVRNNrf/oVRNNrf-bio-like mechanism indeed operates in the brain and the feedback is near uniform, alignment of the value weights <bold><italic>w</italic></bold> to near (1, 1, …, 1) is expected to occur. This means that states are (learned to be) represented in such a way that simple summation of cortical neuronal activity approximates value, thereby potentially explaining why value is often correlated with regional activation (fMRI BOLD signal) of cortical regions <sup><xref ref-type="bibr" rid="c113">113</xref></sup>. Notably, uniform feedback coupled with positive forward weights was shown to be effective also in supervised learning of one-dimensional output in feed-forward network <sup><xref ref-type="bibr" rid="c114">114</xref></sup>, and we guess that loose alignment may underlie it.</p>
</sec>
<sec id="s3c">
<title>On the RNN unit</title>
<p>In our oVRNNbp without non-negative constraint, as the number of RNN units increased, the squared error initially decreased but then increased (<xref rid="fig2" ref-type="fig">Fig. 2J</xref>) (while intriguingly it was not the case for the models with non-negative constraint (<xref rid="fig6" ref-type="fig">Fig. 6E</xref>)). In contrast, in the original value-RNN <sup><xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c26">26</xref></sup>, the ability to develop belief-state-like representation was reported to improve as the number of RNN units increased to 100 or 50. There are at least two possible reasons for this difference, other than the difference in the performance measures. First one is the difference in the update rules. As mentioned earlier, the original value-RNN used BPTT <sup><xref ref-type="bibr" rid="c27">27</xref></sup> whereas our oVRNNbp used an online learning rule, which only considered the influence of the recurrent weights at the previous time step.</p>
<p>Second one is a difference in the RNN unit. Specifically, the original value-RNN used the Gated Recurrent Unit (GRU) cell <sup><xref ref-type="bibr" rid="c115">115</xref></sup> whereas we used a simple sigmoidal function. RNN with simple nonlinear unit is known to have the vanishing gradient problem <sup><xref ref-type="bibr" rid="c116">116</xref></sup>, which could be alleviated by using memorable/gated RNN such as the Long Short-Term Memory (LSTM) unit <sup><xref ref-type="bibr" rid="c117">117</xref></sup> or the GRU cell <sup><xref ref-type="bibr" rid="c115">115</xref></sup>. We used the simple sigmoidal unit because biological plausibility of the GRU cell appeared elusive. However, gated unit similar to the LSTM unit has actually been proposed to be implemented in cortical microcircuits <sup><xref ref-type="bibr" rid="c118">118</xref></sup>, and incorporation of such biologically plausible gated unit into our online value-RNN would be a hopeful direction.</p>
<p>From a bottom-up viewpoint, our RNN unit did not incorporate spiking <sup><xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c57">57</xref>, <xref ref-type="bibr" rid="c119">119</xref></sup> nor nonlinear dendritic computations <sup><xref ref-type="bibr" rid="c44">44</xref>, <xref ref-type="bibr" rid="c120">120</xref>, <xref ref-type="bibr" rid="c121">121</xref></sup>. Recent studies suggest that dendritic mechanisms <sup><xref ref-type="bibr" rid="c37">37</xref>, <xref ref-type="bibr" rid="c38">38</xref></sup>, possibly in combination with burst-dependent plasticity <sup><xref ref-type="bibr" rid="c41">41</xref>, <xref ref-type="bibr" rid="c42">42</xref></sup>, can realize credit assignment without backprop in supervised and unsupervised learning <sup><xref ref-type="bibr" rid="c122">122</xref>, <xref ref-type="bibr" rid="c123">123</xref></sup>. Also, recent model of hippocampus <sup><xref ref-type="bibr" rid="c25">25</xref></sup> has shown that a network of multi-compartment units could learn complex representations. Having dendritic mechanisms is different from just increasing the number of neural-network layers because of their own specific features/constraints, and it was argued <sup><xref ref-type="bibr" rid="c44">44</xref></sup> that adding such biological constraints enables learning in deep neural networks. Therefore, incorporation of biological details into RNN unit in our models would be hopeful also from the bottom-up viewpoint.</p>
</sec>
<sec id="s3d">
<title>Comparison to other algorithms</title>
<p>As an alternative to backprop in hierarchical network, aside from feedback alignment <sup><xref ref-type="bibr" rid="c36">36</xref></sup>, Associative Reward-Penalty (A<sub>R-P</sub>) algorithm has been proposed <sup><xref ref-type="bibr" rid="c124">124</xref>–<xref ref-type="bibr" rid="c126">126</xref></sup>. In A<sub>R-P</sub>, the hidden units behave stochastically, allowing the gradient to be estimated via stochastic sampling. Recent work <sup><xref ref-type="bibr" rid="c127">127</xref></sup> has proposed Phaseless Alignment Learning (PAL), in which high-frequency noise-induced learning of feedback projections proceeds simultaneously with learning of forward projections using the feedback in a lower frequency. Noise-induced learning of the weights on readout neurons from untrained RNN by reward-modulated Hebbian plasticity has also been demonstrated <sup><xref ref-type="bibr" rid="c128">128</xref></sup>. Such noise- or perturbation-based <sup><xref ref-type="bibr" rid="c40">40</xref></sup> mechanisms are biologically plausible because neurons and neural networks can exhibit noisy or chaotic behavior <sup><xref ref-type="bibr" rid="c129">129</xref>–<xref ref-type="bibr" rid="c131">131</xref></sup>, and might improve the performance of value-RNN if implemented.</p>
<p>Regarding learning of RNN, “e-prop” <sup><xref ref-type="bibr" rid="c35">35</xref></sup> was proposed as a locally learnable online approximation of BPTT <sup><xref ref-type="bibr" rid="c27">27</xref></sup>, which was used in the original value RNN <sup><xref ref-type="bibr" rid="c26">26</xref></sup>. In e-prop, neuron-specific learning signal is combined with weight-specific locally-updatable “eligibility trace”. Reward-based e-prop was also shown to work <sup><xref ref-type="bibr" rid="c35">35</xref></sup>, both in a setup not introducing TD-RPE with symmetric or random feedback (their Supplementary Figure 5) and in another setup introducing TD-RPE with symmetric feedback (their Figure 4 and 5). Compared to these, our models differ in multiple ways.</p>
<p>First, we have shown that alignment to random feedback occurs in the models driven by TD-RPE. Second, our models do not have “eligibility trace” (nor memorable/gated unit, different from the original value-RNN <sup><xref ref-type="bibr" rid="c26">26</xref></sup>; see Appendix A.1 for possible incorporation of eligibility trace into our models), but could still solve temporal credit assignment to a certain extent because TD learning is by itself a solution for it (notably, recent work showed that combination of TD(0) and model-based RL well explained rat’s choice and DA patterns <sup><xref ref-type="bibr" rid="c132">132</xref></sup>). However, as mentioned before, single time-step in our models was assumed to correspond to hundreds of milliseconds, incorporating slow synaptic dynamics, whereas e-prop is an algorithm for spiking neuron models with a much finer time scale. From this aspect, our models could be seen as a coarse-time-scale approximation of e-prop. On top of these, our results point to a potential computational benefit of biological non-negative constraint, which could effectively limit the parameter space and promote learning.</p>
</sec>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Online value-RNN with backprop (oVRNNbp)</title>
<p>We constructed an online value-RNN model based on the previous proposals <sup><xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c26">26</xref></sup> but with several differences. We assumed that the activities of neurons in the RNN at time <italic>t</italic>+1 were determined by the activities of these neurons and neurons representing observation (cue, reward, or nothing) at time <italic>t</italic>:
<disp-formula id="eqn1">
<graphic xlink:href="609100v4_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where</p>
<p><bold><italic>x</italic></bold> = (<italic>x<sub>j</sub></italic>) : activity of <italic>j</italic>-th neuron in the RNN (<italic>j</italic> = 1, .., <italic>n</italic>)
<list list-type="simple">
<list-item><p><bold><italic>o</italic></bold> = (<italic>o<sub>k</sub></italic>) : activity of <italic>k</italic>-th neuron in the observation layer (<italic>k</italic> = 1, 2)</p></list-item>
</list>
if there was a cue at <italic>t</italic>, <bold><italic>o</italic></bold>(<italic>t</italic>) = (1 0)<sup>T</sup>,</p>
<p>if there was a reward at <italic>t</italic>, <bold><italic>o</italic></bold>(<italic>t</italic>) = (0 1)<sup>T</sup>,</p>
<p>and otherwise, <bold><italic>o</italic></bold>(<italic>t</italic>) = (0 0)<sup>T</sup></p>
<p><bold>A</bold> = (<italic>A<sub>ij</sub></italic>) : recurrent connection strength from <italic>x<sub>j</sub></italic> to <italic>x<sub>i</sub></italic></p>
<p><bold>B</bold> = (<italic>B<sub>ik</sub></italic>) : feed-forward connection strength from <italic>o<sub>k</sub></italic> to <italic>x<sub>i</sub></italic>
<disp-formula id="eqn1a">
<graphic xlink:href="609100v4_eqn1a.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
sigmoidal function representing neuronal input-output relation</p>
<p>The estimated value of the state at <italic>t</italic> was calculated as
<disp-formula id="eqn1b">
<graphic xlink:href="609100v4_eqn1b.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where
<disp-formula>
<graphic xlink:href="609100v4_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
were the value weights. The error between this estimated value and the true value, <italic>v<sub>true</sub></italic>(<italic>t</italic>), was defined as:
<disp-formula id="eqn1c">
<graphic xlink:href="609100v4_eqn1c.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Parameters <italic>w<sub>j</sub></italic>, <italic>A<sub>ij</sub></italic>, and <italic>B<sub>ik</sub></italic> that minimize the squared error <italic>ε</italic>(<italic>t</italic>)<sup><xref ref-type="bibr" rid="c2">2</xref></sup> could be found by a gradient descent / error-backpropagation (backprop) method, i.e., by updating them in the directions of −∂(<italic>ε</italic>(<italic>t</italic>)<sup><xref ref-type="bibr" rid="c2">2</xref></sup>)/∂<italic>w<sub>j</sub></italic>, −∂(<italic>ε</italic>(<italic>t</italic>)<sup><xref ref-type="bibr" rid="c2">2</xref></sup>)/∂<italic>A<sub>ij</sub></italic>, and −∂(<italic>ε</italic>(<italic>t</italic>)<sup><xref ref-type="bibr" rid="c2">2</xref></sup>)/∂<italic>B<sub>ik</sub></italic>. −∂(<italic>ε</italic>(<italic>t</italic>)<sup><xref ref-type="bibr" rid="c2">2</xref></sup>)/∂<italic>w<sub>j</sub></italic> was calculated as follows:
<disp-formula id="eqn1d">
<graphic xlink:href="609100v4_eqn1d.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
In the last line, since <italic>ε</italic>(<italic>t</italic>) was unavailable as <italic>v<sub>true</sub></italic>(<italic>t</italic>) was unknown, it was approximated by the TD-RPE:
<disp-formula id="eqn1e">
<graphic xlink:href="609100v4_eqn1e.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
−∂(<italic>ε</italic>(<italic>t</italic>)<sup><xref ref-type="bibr" rid="c2">2</xref></sup>)/∂<italic>A<sub>ij</sub></italic>was calculated as follows:
<disp-formula id="eqn1f">
<graphic xlink:href="609100v4_eqn1f.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Similarly, −∂(<italic>ε</italic>(<italic>t</italic>)<sup><xref ref-type="bibr" rid="c2">2</xref></sup>)/∂<italic>B<sub>ik</sub></italic>was calculated as follows:
<disp-formula id="eqn1g">
<graphic xlink:href="609100v4_eqn1g.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
According to these, the online update rule for the value-RNN was determined as follows:
<disp-formula id="eqn1h">
<graphic xlink:href="609100v4_eqn1h.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn1i">
<graphic xlink:href="609100v4_eqn1i.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn1j">
<graphic xlink:href="609100v4_eqn1j.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>a</italic><sub>value</sub> and <italic>a</italic><sub>RNN</sub> were the learning rates. In each simulation, the elements of <bold>A</bold> and <bold>B</bold> , as well as the elements of <bold><italic>x</italic></bold>, were initialized to pseudo standard normal random numbers, and the elements of <bold><italic>w</italic></bold> were initialized to 0.</p>
</sec>
<sec id="s4b">
<title>Online value-RNN with fixed random feedback (oVRNNrf)</title>
<p>We considered an implementation of the online value-RNN described above in the cortico-basal ganglia-DA system (<xref rid="fig1" ref-type="fig">Fig. 1</xref>):</p>
<p><bold><italic>x</italic></bold> : activities of neurons in a cortical region with rich recurrent connections</p>
<p><bold>A</bold> : recurrent connection strengths among <bold><italic>x</italic></bold>
<list list-type="simple">
<list-item><p><bold><italic>o</italic></bold>: activities of neurons in a cortical region processing sensory inputs</p></list-item>
</list>
<bold>B</bold> : feed-forward connection strengths from <bold><italic>o</italic></bold> to <bold><italic>x</italic></bold></p>
<p><bold><italic>f</italic></bold> : sigmoidal relationship from the input to the output of the cortical neurons <bold><italic>w</italic></bold> : connection strengths from cortical neurons <bold><italic>x</italic></bold> to a group of striatal neurons <italic>v</italic> : activity of the group of striatal neurons</p>
<p><bold><italic>δ</italic></bold> : activity of a group of DA neurons / released DA The update rule for <bold><italic>w</italic></bold>
<disp-formula id="eqn1k">
<graphic xlink:href="609100v4_eqn1k.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
could be naturally implemented as cortico-striatal synaptic plasticity, which depends on DA (<italic>δ</italic>(<italic>t</italic>)) and pre-synaptic (cortical) neuronal activity (<italic>x<sub>j</sub></italic>(<italic>t</italic>)). However, an issue emerged in implementation of the update rules for <bold>A</bold> and <bold>B</bold>:
<disp-formula id="eqn1l">
<graphic xlink:href="609100v4_eqn1l.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn1m">
<graphic xlink:href="609100v4_eqn1m.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Specifically, <italic>w<sub>i</sub></italic> included in the rightmost of these update rules (for the strengths of cortico-cortical synapses <italic>A<sub>ij</sub></italic>and <italic>B<sub>ik</sub></italic>) is the connection strength from cortical neuron <italic>x<sub>i</sub></italic>to striatal neurons, i.e., the strength of the cortico-striatal synapses (located within the striatum), which is considered to be unavailable at the cortico-cortical synapses (located within the cortex).</p>
<p>As mentioned in the Introduction, this is an example of the long-standing difficulty in biological implementation of backprop, and recently a potential solution for this difficulty, i.e., replacement of the downstream connection strengths in the update rule for upstream connections with fixed random strengths, has been demonstrated in supervised learning of feed-forward and recurrent networks <sup><xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c36">36</xref>, <xref ref-type="bibr" rid="c45">45</xref></sup>. The online value-RNN, which we considered here, differed from supervised learning considered in these previous studies in two ways: i) it was TD learning, apparent in the approximation of the true error <italic>ε</italic>(<italic>t</italic>) by the TD-RPE <italic>δ</italic>(<italic>t</italic>) in the derivation described above, and ii) it used a scalar error (TD-RPE) rather than a vector error. But we expected that the feedback alignment mechanism could still work at least to some extent, and explored it in this study. Specifically, we examined a modified online value-RNN with fixed random feedback (oVRNNrf), in which the update rules for <bold>A</bold> and <bold>B</bold> were modified as follows:
<disp-formula id="eqn2">
<graphic xlink:href="609100v4_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn2a">
<graphic xlink:href="609100v4_eqn2a.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>w<sub>i</sub></italic> in the update rules of the online value-RNN with backprop (oVRNNbp) was replaced with a fixed random parameter <italic>c<sub>i</sub></italic>. Notably, these modified update rules for the cortico-cortical connections <bold>A</bold> and <bold>B</bold> required only pre-synaptic activities (<italic>x<sub>j</sub></italic>(<italic>t</italic>−1), <italic>o<sub>k</sub></italic>(<italic>t</italic>−1)), post-synaptic activities (<italic>x<sub>i</sub></italic>(<italic>t</italic>)), TD-RPE-representing DA (<italic>δ</italic>(<italic>t</italic>)), and fixed random strengths (<italic>c<sub>i</sub></italic>), which would all be available at the cortico-cortical synapses given that VTA DA neurons project not only to the striatum but also to the cortex and random <italic>c<sub>i</sub></italic> could be provided by intrinsic heterogeneity. In each simulation, the elements of <bold><italic>c</italic></bold> were initialized to pseudo standard normal random numbers.</p>
</sec>
<sec id="s4c">
<title>Revised online value-RNN models with further biological constraints</title>
<p>In the later part of this study, we examined revised online value-RNN models with further biological constraints. Specifically, we considered models, in which the value weights and the activities of neurons in the RNN were constrained to be non-negative. In order to do so, the update rule for <bold><italic>w</italic></bold> was modified to:
<disp-formula id="eqn3">
<graphic xlink:href="609100v4_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where max(<italic>q</italic><sub>1</sub>, <italic>q</italic><sub>2</sub>) returned the maximum of <italic>q</italic><sub>1</sub> and <italic>q</italic><sub>2</sub>. Also, the sigmoidal input-output function was replaced with
<disp-formula id="eqn3a">
<graphic xlink:href="609100v4_eqn3a.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
and the elements of <bold><italic>x</italic></bold> were initialized to pseudo uniform [0 1] random numbers. The backprop-based update rules for <bold>A</bold> and <bold>B</bold> in oVRNNbp were replaced with
<disp-formula id="eqn3b">
<graphic xlink:href="609100v4_eqn3b.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn3c">
<graphic xlink:href="609100v4_eqn3c.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
We referred to the model with these modifications to oVRNNbp as oVRNNbp-rev.</p>
<p>As a revised online value-RNN with fixed random feedback (oVRNNrf), in addition to the abovementioned modifications of the update of <bold><italic>w</italic></bold>, the sigmoidal input-output function, and the initialization of <bold><italic>x</italic></bold>, the fixed random feedback <bold><italic>c</italic></bold> was assumed to be non-negative. Specifically, the elements of <bold><italic>c</italic></bold> were set to pseudo uniform [0 1] random numbers. Moreover, the update rules for <bold>A</bold> and <bold>B</bold> were replaced with</p>
<p>(when <italic>x<sub>i</sub></italic>(<italic>t</italic>) ≤ 0.5)
<disp-formula id="eqn3d">
<graphic xlink:href="609100v4_eqn3d.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn3e">
<graphic xlink:href="609100v4_eqn3e.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
(when <italic>x<sub>i</sub></italic>(<italic>t</italic>) &gt; 0.5)
<disp-formula id="eqn3f">
<graphic xlink:href="609100v4_eqn3f.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn3g">
<graphic xlink:href="609100v4_eqn3g.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
so that the originally non-monotonic dependence on <italic>x<sub>i</sub></italic>(<italic>t</italic>) (post-synaptic activity) became monotonic + saturation (<xref rid="fig5" ref-type="fig">Fig. 5B</xref>). These update rules with non-negative <italic>c<sub>i</sub></italic> could be said to be Hebbian with additional modulation by TD-RPE (Hebbian under positive TD-RPE) (see Appendix A.2 for possible consideration of behavioral time-scale synaptic plasticity (BTSP) in our models). We referred to the model with these modifications to oVRNNrf as oVRNNrf-bio. In the right panels of <xref rid="fig6" ref-type="fig">Fig. 6E,F</xref>, we also examined the model where the modified update rules of oVRNNrf-bio were changed back to the original ones, referred to as oVRNNrf-rev. In some simulations in <xref rid="fig8" ref-type="fig">Fig. 8E-G</xref>, we examined a modified oVRNNrf-bio with a slight decay (forgetting) of value weights, in which each element of <bold><italic>w</italic></bold> decayed at every time-step:
<disp-formula id="eqn3h">
<graphic xlink:href="609100v4_eqn3h.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>dr</italic> was the decay rate per time-step and was set to 0.001 or 0.002.</p>
<p>We further examined extensions of oVRNNbp-rev and oVRNNrf-bio, referred to as oVRNNbp-rev-ei and oVRNNrf-bio-ei, which incorporated excitatory E-units and inhibitory I-units (<xref rid="fig9" ref-type="fig">Fig. 9A</xref>). Based on biological suggestions (see the Results), we made the following assumptions. Each E-unit received inputs from the observation units <bold><italic>o</italic></bold> (connections: <bold>B<sub>E</sub></bold>), all the E-units (connections: <bold>A<sub>E</sub></bold>), and a particular I-unit (with a strength <italic>h</italic>), and projected to the striatal value unit (connections: <bold><italic>w</italic></bold>). Each I-unit received inputs from the observation units <bold><italic>o</italic></bold> (connections: <bold>B<sub>I</sub></bold>) and all the E-units (connections: <bold>A<sub>I</sub></bold>). Excitation from the observation units and E-units to E- and I-units took one time-step whereas I→E inhibition operated within a time-step. The activation function for E-unit and plasticity rules for connections from/to E-units were the same as those for the RNN unit in the original models. I-unit had a linear activation function, and there was no plasticity for connections from/to I-units. Update rule for <bold><italic>w</italic></bold> was the same as the original one with the activity of the RNN units replaced with the activity of E-units. Equations for the activities of E-units and I-units, <bold><italic>x</italic><sub>E</sub></bold> and <bold><italic>x</italic><sub>I</sub></bold>, are given as follows:
<disp-formula id="eqn3i">
<graphic xlink:href="609100v4_eqn3i.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn3j">
<graphic xlink:href="609100v4_eqn3j.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>h</italic> was set to 1. The elements of <bold>A<sub>I</sub></bold>, <bold>B<sub>I</sub></bold>, <bold>A<sub>E</sub></bold>, and <bold>B<sub>E</sub></bold> were initialized to be non-negative: max(0, 3 + <italic>z</italic>),</p>
<p>where <italic>z</italic> was a pseudo standard normal random number. The elements of <bold><italic>x</italic><sub>E</sub></bold> were initialized to pseudo uniform [0 1] random numbers, and the initial values of <bold><italic>x</italic><sub>I</sub></bold> were determined according to the abovementioned equation.</p>
</sec>
<sec id="s4d">
<title>Incorporation of action selection</title>
<p>We considered extensions of oVRNNbp-rev and oVRNNrf-bio that incorporated an actor-critic architecture, referred to as oVRNNbp-rev-ac and oVRNNrf-bio-ac (<xref rid="fig11" ref-type="fig">Fig. 11A</xref>). Each RNN unit additionally connected to additional two units representing the action-values of action 1 and action 2 (<italic>q</italic><sub>1</sub> and <italic>q</italic><sub>2</sub>):
<disp-formula id="eqn4">
<graphic xlink:href="609100v4_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <bold>U</bold> = (<italic>u<sub>kj</sub></italic>) consisted of two row vectors that represented the preferences of the two actions. At the time-step next to cue-presentation, one action was selected in a soft-max manner based on the action values. Specifically, action <italic>k</italic> was selected with the probability of
<disp-formula id="eqn4a">
<graphic xlink:href="609100v4_eqn4a.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>β</italic> was the inverse temperature parameter, set to 1 or 2, representing the degree of exploitation over exploration. Selected action was then informed to the RNN units. Specifically, the observation layer had two additional elements (<bold><italic>o’</italic></bold> in <xref rid="fig11" ref-type="fig">Fig. 11A</xref>) corresponding to the two actions. These elements became 1 when the corresponding action was selected and 0 otherwise. The preference of selected action <italic>k</italic> was updated by using the TD-RPE <italic>δ</italic>(<italic>t</italic>) as follows:
<disp-formula id="eqn4b">
<graphic xlink:href="609100v4_eqn4b.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>a</italic><sub>pref</sub> was the learning rate. In order to prevent unbounded increase of action preference, we assumed a slight decay of all the action preferences at every time-step:
<disp-formula id="eqn4c">
<graphic xlink:href="609100v4_eqn4c.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>dr</italic> was the decay rate per time-step and was set to 0.001. <italic>u<sub>kj</sub></italic> (i.e., the elements of <bold>U</bold>) were initialized to 0. The connection weights from the action-observation units <bold><italic>o’</italic></bold>, as well as from <bold><italic>o</italic></bold> and the RNN units, onto the RNN units were initialized to pseudo standard normal random numbers.</p>
</sec>
<sec id="s4e">
<title>Simulation of the tasks</title>
<p>In the Pavlovian cue-reward association task, at time 1 of each trial, cue observation was received by the RNN, and at time 4, reward observation was received. Trial was pseudo-randomly ended at time 7, 8, 9, or 10, and the next trial started from the next time-step (i.e., inter-trial interval (ITI) was 4, 5, 6, or 7 time-steps with equal probabilities). Reward size was <italic>r</italic> = 1. We also conducted simulations with longer cue-reward delays, in which reward was given at time 5, 6, or 7, and the end of trial was shifted accordingly. The tasks with probabilistic structures (task 1 and task 2) were implemented in the same way except that reward timing was not time 4 but time 3 or 5 with equal probabilities, specifically, 50% and 50% in task 1 and 30% and 30% in task 2, and there was no reward in the remaining 40% of trials in task 2. The tasks with action selection were also implemented in the same way except that size 2 reward was received, i.e., the reward term in the TD-RPE calculation as well as the reward-corresponding element of the observation inputs were set to 2, at time 4 when action 1 was selected whereas size 1 reward was received at time 4 (in the first choice task) or time 3 (in the second choice task) when action 2 was selected.</p>
<p>The cue or reward state/timing, mentioned in the text and marked in the figures, was defined to be the timing when the RNN received the cue or reward observation, respectively. Specifically, if <bold><italic>o</italic></bold>(<italic>t</italic>) = (1 0)<sup>T</sup> or <bold><italic>o</italic></bold>(<italic>t</italic>) = (0 1)<sup>T</sup> at time <italic>t</italic>, <italic>t</italic> + 1 was defined to be a cue or reward timing, respectively. For the agents with punctate state representation, which is also referred to as the complete serial compound (CSC) representation <sup><xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c48">48</xref>, <xref ref-type="bibr" rid="c133">133</xref></sup>, each timing from a cue in the tasks was represented by a 10-dimensional one-hot vector, starting from (1 0 0 … 0)<sup>T</sup> for the cue state, with the next state (0 1 0 … 0)<sup>T</sup> and so on.</p>
<p>In the simulations of the cue-reward association task with distractor cue, the observation units <bold><italic>o</italic></bold> = (<italic>o<sub>k</sub></italic>) had an additional element <italic>o</italic><sub>3</sub> (<xref rid="fig10" ref-type="fig">Fig. 10A</xref>), which was 1 at the time-steps where distractor cue was present and 0 otherwise. We examined four cases, in which the probability of the presence of distractor cue at every time-step throughout the task was 0, 0.1, 0.2, and 0.3 (<xref rid="fig10" ref-type="fig">Fig. 10B-E</xref>).</p>
<p>Learning rates were set as follows. For the models with punctate state representation, <italic>a</italic><sub>value</sub> = 0.1. For oVRNNbp, oVRNNrf, and the model with untrained RNN compared with these two, <italic>a</italic><sub>RNN</sub> = 0.1 and <italic>a</italic><sub>value</sub> = 0.1/(<italic>n</italic>/7). For oVRNNbp-rev, oVRNNrf-bio, and the models with untrained RNN compared with these two, <italic>a</italic><sub>RNN</sub> = 0.1 and <italic>a</italic><sub>value</sub> = <italic>a</italic><sub>pref</sub> = 0.1/(<italic>n</italic>/12) except for the right panels of <xref rid="fig6" ref-type="fig">Fig. 6J</xref>, and <italic>a</italic><sub>RNN</sub> = 0.05 and <italic>a</italic><sub>value</sub> = 0.05/(<italic>n</italic>/12) for the right panels of <xref rid="fig6" ref-type="fig">Fig. 6J</xref>. Time discount factor (<italic>γ</italic>) was set to 0.8.</p>
</sec>
<sec id="s4f">
<title>Estimation of true state/timing values</title>
<p>As for the Pavlovian cue-reward association task, we defined states after agent’s receival of cue information by relative timings from the cue, and estimated their (true) values by simulations according to the definition of state value. We generated a sequence of cues and rewards corresponding to 1000 trials with the ITI after the first trial, ITI<sub>1</sub>, fixed to one of the possible lengths (4, 5, 6, or 7 time-steps), and calculated cumulative discounted future rewards within the sequence:
<disp-formula>
<graphic xlink:href="609100v4_ueqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic><sub>t</sub></italic><sub>_rew</sub> denotes the time-step of each reward counted from the starting state, starting from +1, …, and +3 + ITI<sub>1</sub> time steps from a cue (the last one corresponded to the cue timing of the next trial). For each case where ITI<sub>1</sub> = 4, 5, 6, or 7, we repeated this 1000 times, generating 1000 sequences (i.e., 1000 simulations of 1000 trials), with different sets of pseudo-random numbers, and calculated the average over these 1000 sequences (we refer to these as ITI<sub>1</sub>-specific values). We estimated the value of each state of +1, …, and +7 time steps from cue (i.e., −2, …, +4 time-steps from reward) by taking the average of the ITI<sub>1</sub>-specific values for four possible ITI<sub>1</sub>.</p>
<p>We also estimated the true values of the cue timing and one and two timing(s) before it in the following way; these values could not be estimated in the abovementioned way because agent should not know the length of ITI (i.e., when ITI ends) until receiving cue information at the cue timing. In the case where ITI is in fact 4 time-steps, until receiving the next cue, agent should think that ITI can be 4, 5, 6, or 7 time-steps with equal probabilities (1/4 for each). Thus, the value of next cue timing and one and two timing(s) before it should be the average of the four ITI<sub>1</sub>-specific values of +4, +3, and +2 time-steps from reward. Similarly, in the case where ITI is in fact 5 time-steps, until the previous time-step of the next cue, agent should think that ITI can be 4, 5, 6, or 7 time-steps with equal probabilities (1/4 for each). Thus, the value of one and two timing(s) before next cue should be the average of the four ITI<sub>1</sub>-specific values of +4 and +3 time-steps from reward. On the other hand, at the timing of the next cue, agent should think that ITI can be 5, 6, or 7 (but not 4) time-steps with equal probabilities (1/3 for each). Thus, the value of next cue timing should be the average of the three ITI<sub>1</sub>-specific values (for ITI<sub>1</sub> = 5, 6, or 7) of +5 time-steps from reward. Similar considerations can be made for the cases where ITI is in fact 6 or 7 time-steps. And then, the “true” value of (next) cue timing can be calculated as the average of the values of next cue timing in the cases where ITI is in fact 4, 5, 6, or 7 time-steps. Using these estimated true state values, we calculated TD-RPE at each state/timing (−2, −1, …, and +5 time steps from cue). True state/timing values in the cases where the cue-reward delay was 4, 5, or 6 time-steps were estimated in the same way.</p>
<p>We also estimated true state/timing values for tasks 1 and 2 that had probabilistic structures. As for task 1, we first estimated the values of each timing in each of the trial types (<xref rid="fig4" ref-type="fig">Fig. 4Ba</xref>, left), in which reward was given at early (2 time-steps after cue) or late (4 time-steps after cue) timing, in the same manner (but using 10000 rather than 1000 simulations for each condition) as done for the cue-reward association task mentioned above (values of the cue timing and the one and two timing(s) before cue after each trial type were also estimated). Then, based on the agent’s belief about trial types (<xref rid="fig4" ref-type="fig">Fig. 4Bb</xref>, left), we defined the following states: +1 and +2 time steps from cue (i.e., states visited (entered) before knowing whether reward was given at the early timing (= +2 time step from cue)), +3, 4, 5, and 6 time steps from cue after reception of reward at the early timing, and +3, 4, 5, and 6 time steps from cue after no reception of reward at the early timing (<xref rid="fig4" ref-type="fig">Fig. 4Bc</xref>, left-top). We calculated the true values of these states and also of the cue timing and one and two timing(s) before cue (<xref rid="fig4" ref-type="fig">Fig. 4Bc</xref>, left-bottom) by taking (mathematical) expected value of the abovementioned estimated value of each timing in each trial type. Using these true values, we calculated TD-RPE (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>, left).</p>
<p>As for task 2, we first estimated the values of each timing in each of the trial types (<xref rid="fig4" ref-type="fig">Fig. 4Ba</xref>, right), in which reward was given at early (2 time-steps after cue) or late (4 time-steps after cue) timing or was not given. Then, based on the agent’s belief about trial types (<xref rid="fig4" ref-type="fig">Fig. 4Bb</xref>, right), we defined the following states: +1 and +2 time steps from cue (i.e., states visited (entered) before knowing whether reward was given at the early timing), +3, 4, 5, and 6 time steps from cue after reception of reward at the early timing, +3 and 4 time steps from cue after no reception of reward at the early timing (states visited (entered) before knowing whether reward was given at the late timing (= +4 time step from cue)), +5 and 6 time steps from cue after reception of reward at the late timing, and +5 and 6 time steps from cue after no reception of reward at both early and late timings (<xref rid="fig4" ref-type="fig">Fig. 4Bc</xref>, right-top). We estimated the true values of these states and also of the cue timing and one and two timing(s) before cue (<xref rid="fig4" ref-type="fig">Fig. 4Bc</xref>, right-bottom) in the same manner as for task 1, and using these true values, we calculated TD-RPE (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>, right).</p>
</sec>
<sec id="s4g">
<title>Analyses, software, and code availability</title>
<p>SEM (Standard error of the mean) was approximated by SD (standard deviation)/√<italic>N</italic> (number of samples). Cohen’s <italic>d</italic> using an average variance was calculated as (difference in the means) / (square root of the average of variances). Linear regression, principal component analysis (PCA), Wilcoxon rank sum test, and <italic>t</italic>-tests were conducted by using R (functions lm, prcomp, wilcox.exact (in package exactRankTests), and t.test). Difference in Wilcoxon rank sum test and <italic>t</italic>-tests was reported when <italic>p</italic> &lt; 0.05. Simulations were conducted by using MATLAB, and pseudo-random numbers were implemented by using rand, randn, and randperm functions. The codes for simulations and analyses are available at GitHub (<ext-link ext-link-type="uri" xlink:href="https://github.com/kenjimoritagithub/oVRNN1">https://github.com/kenjimoritagithub/oVRNN1</ext-link>).</p>
</sec>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>The authors thank Dr. Kenji Doya for valuable suggestions. KM was supported by Grants-in-Aid for Scientific Research 23H03295, 23K27985, and 25H02594 from Japan Society for the Promotion of Science (JSPS) and the Naito Foundation. AyK was supported by JSPS Overseas Research Fellowships. ArK was partially funded by Digital Futures (KTH) grant and StratNeuro SRA.</p>
</ack>
<sec id="d1e3696" sec-type="additional-information">
<title>Additional information</title>
<sec id="s5">
<title>Author contributions</title>
<p>Conceptualization: KM; Formal analysis: KM, TT; Investigation: KM, TT, AyK; Writing – original draft: KM; Writing – review &amp; editing: KM, TT, AyK, ArK</p>
</sec>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Montague</surname>, <given-names>P.R.</given-names></string-name>, <string-name><surname>Dayan</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Sejnowski</surname>, <given-names>T.J</given-names></string-name></person-group>. <article-title>A framework for mesencephalic dopamine systems based on predictive Hebbian learning</article-title>. <source>J Neurosci</source> <volume>16</volume>, <fpage>1936</fpage>–<lpage>1947</lpage> (<year>1996</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Schultz</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Dayan</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Montague</surname>, <given-names>P.R</given-names></string-name></person-group>. <article-title>A neural substrate of prediction and reward</article-title>. <source>Science</source> <volume>275</volume>, <fpage>1593</fpage>–<lpage>1599</lpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Niv</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Schoenbaum</surname>, <given-names>G</given-names></string-name></person-group>. <article-title>Dialogues on prediction errors</article-title>. <source>Trends Cogn Sci</source> <volume>12</volume>, <fpage>265</fpage>–<lpage>272</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cohen</surname>, <given-names>J.Y.</given-names></string-name>, <string-name><surname>Haesler</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Vong</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lowell</surname>, <given-names>B.B.</given-names></string-name> &amp; <string-name><surname>Uchida</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>Neuron-type-specific signals for reward and punishment in the ventral tegmental area</article-title>. <source>Nature</source> <volume>482</volume>, <fpage>85</fpage>–<lpage>88</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Steinberg</surname>, <given-names>E.E.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>A causal link between prediction errors, dopamine neurons and learning</article-title>. <source>Nat Neurosci</source> <volume>16</volume>, <fpage>966</fpage>–<lpage>973</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname>, <given-names>H.R.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>A Unified Framework for Dopamine Signals across Timescales</article-title>. <source>Cell</source> <volume>183</volume>, <fpage>1600</fpage>–<lpage>1616.e1625</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reynolds</surname>, <given-names>J.N.</given-names></string-name>, <string-name><surname>Hyland</surname>, <given-names>B.I.</given-names></string-name> &amp; <string-name><surname>Wickens</surname>, <given-names>J.R</given-names></string-name></person-group>. <article-title>A cellular mechanism of reward-related learning</article-title>. <source>Nature</source> <volume>413</volume>, <fpage>67</fpage>–<lpage>70</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shen</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Flajolet</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Greengard</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Surmeier</surname>, <given-names>D.J</given-names></string-name></person-group>. <article-title>Dichotomous dopaminergic control of striatal synaptic plasticity</article-title>. <source>Science</source> <volume>321</volume>, <fpage>848</fpage>–<lpage>851</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yagishita</surname>, <given-names>S.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>A critical time window for dopamine actions on the structural plasticity of dendritic spines</article-title>. <source>Science</source> <volume>345</volume>, <fpage>1616</fpage>–<lpage>1620</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Russek</surname>, <given-names>E.M.</given-names></string-name>, <string-name><surname>Momennejad</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Botvinick</surname>, <given-names>M.M.</given-names></string-name>, <string-name><surname>Gershman</surname>, <given-names>S.J.</given-names></string-name> &amp; <string-name><surname>Daw</surname>, <given-names>N.D</given-names></string-name></person-group>. <article-title>Predictive representations can link model-based reinforcement learning to model-free mechanisms</article-title>. <source>PLoS Comput Biol</source> <volume>13</volume>, <fpage>e1005768</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stachenfeld</surname>, <given-names>K.L.</given-names></string-name>, <string-name><surname>Botvinick</surname>, <given-names>M.M.</given-names></string-name> &amp; <string-name><surname>Gershman</surname>, <given-names>S.J</given-names></string-name></person-group>. <article-title>The hippocampus as a predictive map</article-title>. <source>Nat Neurosci</source> <volume>20</volume>, <fpage>1643</fpage>–<lpage>1653</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Qian</surname>, <given-names>L.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Prospective contingency explains behavior and dopamine signals during associative learning</article-title>. <source>Nat Neurosci</source> <pub-id pub-id-type="doi">10.1038/s41593-025-01915-4</pub-id> (<year>2025</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Langdon</surname>, <given-names>A.J.</given-names></string-name>, <string-name><surname>Sharpe</surname>, <given-names>M.J.</given-names></string-name>, <string-name><surname>Schoenbaum</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Niv</surname>, <given-names>Y</given-names></string-name></person-group>. <article-title>Model-based predictions for dopamine</article-title>. <source>Curr Opin Neurobiol</source> <volume>49</volume>, <fpage>1</fpage>–<lpage>7</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Keiflin</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Pribut</surname>, <given-names>H.J.</given-names></string-name>, <string-name><surname>Shah</surname>, <given-names>N.B.</given-names></string-name> &amp; <string-name><surname>Janak</surname>, <given-names>P.H</given-names></string-name></person-group>. <article-title>Ventral Tegmental Dopamine Neurons Participate in Reward Identity Predictions</article-title>. <source>Curr Biol</source> <volume>29</volume>, <fpage>93</fpage>–<lpage>103.e103</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Redish</surname>, <given-names>A.D.</given-names></string-name>, <string-name><surname>Jensen</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Johnson</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Kurth-Nelson</surname>, <given-names>Z</given-names></string-name></person-group>. <article-title>Reconciling reinforcement learning models with behavioral extinction and renewal: implications for addiction, relapse, and problem gambling</article-title>. <source>Psychol Rev</source> <volume>114</volume>, <fpage>784</fpage>–<lpage>805</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gershman</surname>, <given-names>S.J.</given-names></string-name>, <string-name><surname>Jones</surname>, <given-names>C.E.</given-names></string-name>, <string-name><surname>Norman</surname>, <given-names>K.A.</given-names></string-name>, <string-name><surname>Monfils</surname>, <given-names>M.H.</given-names></string-name> &amp; <string-name><surname>Niv</surname>, <given-names>Y</given-names></string-name></person-group>. <article-title>Gradual extinction prevents the return of fear: implications for the discovery of state</article-title>. <source>Front Behav Neurosci</source> <volume>7</volume>, <issue>164</issue> (<year>2013</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shimomura</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Kato</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Morita</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>Rigid reduced successor representation as a potential mechanism for addiction</article-title>. <source>Eur J Neurosci</source> <volume>53</volume>, <fpage>3768</fpage>–<lpage>3790</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Feng</surname>, <given-names>Z.</given-names></string-name>, <string-name><surname>Nagase</surname>, <given-names>A.M.</given-names></string-name> &amp; <string-name><surname>Morita</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>A Reinforcement Learning Approach to Understanding Procrastination: Does Inaccurate Value Approximation Cause Irrational Postponing of a Task?</article-title> <source>Front Neurosci</source> <volume>15</volume>, <issue>660595</issue> (<year>2021</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sato</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Shimomura</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Morita</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>Opponent learning with different representations in the cortico-basal ganglia pathways can develop obsession-compulsion cycle</article-title>. <source>PLoS Comput Biol</source> <volume>19</volume>, <fpage>e1011206</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gershman</surname>, <given-names>S.J.</given-names></string-name> &amp; <string-name><surname>Niv</surname>, <given-names>Y</given-names></string-name></person-group>. <article-title>Learning latent structure: carving nature at its joints</article-title>. <source>Curr Opin Neurobiol</source> <volume>20</volume>, <fpage>251</fpage>–<lpage>256</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Niv</surname>, <given-names>Y</given-names></string-name></person-group>. <article-title>Learning task-state representations</article-title>. <source>Nat Neurosci</source> <volume>22</volume>, <fpage>1544</fpage>–<lpage>1553</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>George</surname>, <given-names>T.M.</given-names></string-name>, <string-name><surname>de Cothi</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Stachenfeld</surname>, <given-names>K.L.</given-names></string-name> &amp; <string-name><surname>Barry</surname>, <given-names>C</given-names></string-name></person-group>. <article-title>Rapid learning of predictive maps with STDP and theta phase precession</article-title>. <source>eLife</source> <volume>12</volume>, <elocation-id>e80663</elocation-id> (<year>2023</year>). <pub-id pub-id-type="doi">10.7554/eLife.80663</pub-id></mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bono</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Zannone</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Pedrosa</surname>, <given-names>V.</given-names></string-name> &amp; <string-name><surname>Clopath</surname>, <given-names>C</given-names></string-name></person-group>. <article-title>Learning predictive cognitive maps with spiking neurons during behavior and replays</article-title>. <source>eLife</source> <volume>12</volume>, <elocation-id>e80671</elocation-id> (<year>2023</year>). <pub-id pub-id-type="doi">10.7554/eLife.80671</pub-id></mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fang</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Aronov</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Abbott</surname>, <given-names>L.F.</given-names></string-name> &amp; <string-name><surname>Mackevicius</surname>, <given-names>E.L</given-names></string-name></person-group>. <article-title>Neural learning rules for generating flexible predictions and computing the successor representation</article-title>. <source>eLife</source> <volume>12</volume>, <elocation-id>e80680</elocation-id> (<year>2023</year>). <pub-id pub-id-type="doi">10.7554/eLife.80680</pub-id></mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cone</surname>, <given-names>I.</given-names></string-name> &amp; <string-name><surname>Clopath</surname>, <given-names>C</given-names></string-name></person-group>. <article-title>Latent representations in hippocampal network model co-evolve with behavioral exploration of task structure</article-title>. <source>Nat Commun</source> <volume>15</volume>, <issue>687</issue> (<year>2024</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hennig</surname>, <given-names>J.A.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Emergence of belief-like representations through reinforcement learning</article-title>. <source>PLoS Comput Biol</source> <volume>19</volume>, <fpage>e1011067</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Rumelhart</surname>, <given-names>D.E.</given-names></string-name>, <string-name><surname>Hinton</surname>, <given-names>G.E.</given-names></string-name> &amp; <string-name><surname>Williams</surname>, <given-names>R.J.</given-names></string-name></person-group>, <year>1985</year>).<chapter-title>Learning Internal Representations by Error Propagation</chapter-title>. in <source>Parallel Distributed Processing: Explorations in the Microstructure of Cognition</source> <italic>Volume</italic> <volume>1</volume> <italic>Foundations</italic> (ed. <person-group person-group-type="editor"><string-name><given-names>D.E.</given-names> <surname>Rumelhart</surname></string-name>, <string-name><surname>McClelland</surname>, <given-names>J.L.</given-names></string-name>, <collab>The PDP Group</collab></person-group>) <fpage>318</fpage>–<lpage>362</lpage> (<publisher-name>MIT Press</publisher-name>, <publisher-loc>Cambridge</publisher-loc>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Amari</surname>, <given-names>S</given-names></string-name></person-group>. <article-title>A Theory of Adaptive Pattern Classifiers</article-title>. <source>IEEE Transactions on Electronic Computers <bold>EC</bold></source><bold>-</bold><volume>16</volume>, <fpage>299</fpage>–<lpage>307</lpage> (<year>1967</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rumelhart</surname>, <given-names>D.E.</given-names></string-name>, <string-name><surname>Hinton</surname>, <given-names>G.E.</given-names></string-name> &amp; <string-name><surname>Williams</surname>, <given-names>R.J</given-names></string-name></person-group>. <article-title>Learning representations by back-propagating errors</article-title>. <source>Nature</source> <volume>323</volume>, <fpage>533</fpage>–<lpage>536</lpage> (<year>1986</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grossberg</surname>, <given-names>S</given-names></string-name></person-group>. <article-title>Competitive learning: from interactive activation to adaptive resonance</article-title>. <source>Cognitive Science</source> <volume>11</volume>, <fpage>23</fpage>–<lpage>63</lpage> (<year>1987</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Crick</surname>, <given-names>F</given-names></string-name></person-group>. <article-title>The recent excitement about neural networks</article-title>. <source>Nature</source> <volume>337</volume>, <fpage>129</fpage>–<lpage>132</lpage> (<year>1989</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Doya</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>Complementary roles of basal ganglia and cerebellum in learning and motor control</article-title>. <source>Curr Opin Neurobiol</source> <volume>10</volume>, <fpage>732</fpage>–<lpage>739</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Doherty</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Dissociable roles of ventral and dorsal striatum in instrumental conditioning</article-title>. <source>Science</source> <volume>304</volume>, <fpage>452</fpage>–<lpage>454</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Murray</surname>, <given-names>J.M</given-names></string-name></person-group>. <article-title>Local online learning in recurrent networks with random feedback</article-title>. <source>eLife</source> <volume>8</volume>, <elocation-id>e43299</elocation-id> (<year>2019</year>). <pub-id pub-id-type="doi">10.7554/eLife.43299</pub-id></mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bellec</surname>, <given-names>G.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>A solution to the learning dilemma for recurrent networks of spiking neurons</article-title>. <source>Nat Commun</source> <volume>11</volume>, <fpage>3625</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lillicrap</surname>, <given-names>T.P.</given-names></string-name>, <string-name><surname>Cownden</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Tweed</surname>, <given-names>D.B.</given-names></string-name> &amp; <string-name><surname>Akerman</surname>, <given-names>C.J</given-names></string-name></person-group>. <article-title>Random synaptic feedback weights support error backpropagation for deep learning</article-title>. <source>Nat Commun</source> <volume>7</volume>, <issue>13276</issue> (<year>2016</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Guerguiev</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Lillicrap</surname>, <given-names>T.P.</given-names></string-name> &amp; <string-name><surname>Richards</surname>, <given-names>B.A</given-names></string-name></person-group>. <article-title>Towards deep learning with segregated dendrites</article-title>. <source>eLife</source> <volume>6</volume>, <elocation-id>e22901</elocation-id> (<year>2017</year>). <pub-id pub-id-type="doi">10.7554/eLife.22901</pub-id></mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sacramento</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Costa</surname>, <given-names>R.P.</given-names></string-name>, <string-name><surname>Bengio</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Senn</surname>, <given-names>W.</given-names></string-name></person-group> <article-title>Dendritic cortical microcircuits approximate the backpropagation algorithm</article-title>. in <source>Advances in Neural Information Processing Systems 31 (NeurIPS 2018)</source> (<year>2018</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Whittington</surname>, <given-names>J.C.R.</given-names></string-name> &amp; <string-name><surname>Bogacz</surname>, <given-names>R</given-names></string-name></person-group>. <article-title>Theories of Error Back-Propagation in the Brain</article-title>. <source>Trends Cogn Sci</source> <volume>23</volume>, <fpage>235</fpage>–<lpage>250</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lillicrap</surname>, <given-names>T.P.</given-names></string-name>, <string-name><surname>Santoro</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Marris</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Akerman</surname>, <given-names>C.J.</given-names></string-name> &amp; <string-name><surname>Hinton</surname>, <given-names>G.</given-names></string-name></person-group> <article-title>Backpropagation and the brain</article-title>. <source>Nat Rev Neurosci</source> <volume>21</volume>, <fpage>335</fpage>–<lpage>346</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Payeur</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Guerguiev</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Zenke</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Richards</surname>, <given-names>B.A.</given-names></string-name> &amp; <string-name><surname>Naud</surname>, <given-names>R</given-names></string-name></person-group>. <article-title>Burst-dependent synaptic plasticity can coordinate learning in hierarchical circuits</article-title>. <source>Nat Neurosci</source> <volume>24</volume>, <fpage>1010</fpage>–<lpage>1019</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Greedy</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Zhu</surname>, <given-names>H.W.</given-names></string-name>, <string-name><surname>Pemberton</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Mellor</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Costa</surname>, <given-names>R.P.</given-names></string-name></person-group> <article-title>Single-phase deep learning in cortico-cortical networks</article-title>. in <source>Advances in Neural Information Processing Systems 35 (NeurIPS 2022)</source> (<year>2022</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Song</surname>, <given-names>Y.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Inferring neural activity before plasticity as a foundation for learning beyond backpropagation</article-title>. <source>Nat Neurosci</source> <volume>27</volume>, <fpage>348</fpage>–<lpage>358</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pagkalos</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Makarov</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Poirazi</surname>, <given-names>P</given-names></string-name></person-group>. <article-title>Leveraging dendritic properties to advance machine learning and neuro-inspired computing</article-title>. <source>Curr Opin Neurobiol</source> <volume>85</volume>, <issue>102853</issue> (<year>2024</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wärnberg</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Kumar</surname>, <given-names>A</given-names></string-name></person-group>. <article-title>Feasibility of dopamine as a vector-valued feedback signal in the basal ganglia</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>120</volume>, <fpage>e2221994120</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mongillo</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Barak</surname>, <given-names>O.</given-names></string-name> &amp; <string-name><surname>Tsodyks</surname>, <given-names>M</given-names></string-name></person-group>. <article-title>Synaptic theory of working memory</article-title>. <source>Science</source> <volume>319</volume>, <fpage>1543</fpage>–<lpage>1546</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morishima</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Morita</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Kubota</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Kawaguchi</surname>, <given-names>Y</given-names></string-name></person-group>. <article-title>Highly differentiated projection-specific cortical subnetworks</article-title>. <source>J Neurosci</source> <volume>31</volume>, <fpage>10380</fpage>–<lpage>10391</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sutton</surname>, <given-names>R.S.</given-names></string-name> &amp; <string-name><surname>Barto</surname>, <given-names>A.G</given-names></string-name></person-group>. <source>Reinforcement Learning: An Introduction</source> (<edition>Second</edition> <italic>Edition)</italic> (<publisher-name>MIT Press, Cambridge</publisher-name>, <publisher-loc>MA</publisher-loc>, <year>2018</year>).</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rajan</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Abbott</surname>, <given-names>L.F</given-names></string-name></person-group>. <article-title>Eigenvalue spectra of random matrices for neural networks</article-title>. <source>Phys Rev Lett</source> <volume>97</volume>, <fpage>188104</fpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dominey</surname>, <given-names>P.F</given-names></string-name></person-group>. <article-title>Complex sensory-motor sequence learning based on recurrent state representation and reinforcement learning</article-title>. <source>Biol Cybern</source> <volume>73</volume>, <fpage>265</fpage>–<lpage>274</lpage> (<year>1995</year>).</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Maass</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Natschläger</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Markram</surname>, <given-names>H</given-names></string-name></person-group>. <article-title>Real-time computing without stable states: a new framework for neural computation based on perturbations</article-title>. <source>Neural Comput</source> <volume>14</volume>, <fpage>2531</fpage>–<lpage>2560</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jaeger</surname>, <given-names>H</given-names></string-name></person-group>. <article-title>Echo state network</article-title>. <source>Scholarpedia</source> <volume>2</volume>, <fpage>2330</fpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tanaka</surname>, <given-names>G.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Recent advances in physical reservoir computing: A review</article-title>. <source>Neural Netw</source> <volume>115</volume>, <fpage>100</fpage>–<lpage>123</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Starkweather</surname>, <given-names>C.K.</given-names></string-name>, <string-name><surname>Babayan</surname>, <given-names>B.M.</given-names></string-name>, <string-name><surname>Uchida</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Gershman</surname>, <given-names>S.J.</given-names></string-name></person-group> <article-title>Dopamine reward prediction errors reflect hidden-state inference across time</article-title>. <source>Nat Neurosci</source> <volume>20</volume>, <fpage>581</fpage>–<lpage>589</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Feldman</surname>, <given-names>D.E</given-names></string-name></person-group>. <article-title>Synaptic mechanisms for plasticity in neocortex</article-title>. <source>Annu Rev Neurosci</source> <volume>32</volume>, <fpage>33</fpage>–<lpage>55</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bienenstock</surname>, <given-names>E.L.</given-names></string-name>, <string-name><surname>Cooper</surname>, <given-names>L.N.</given-names></string-name> &amp; <string-name><surname>Munro</surname>, <given-names>P.W</given-names></string-name></person-group>. <article-title>Theory for the development of neuron selectivity: orientation specificity and binocular interaction in visual cortex</article-title>. <source>J Neurosci</source> <volume>2</volume>, <fpage>32</fpage>–<lpage>48</lpage> (<year>1982</year>).</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gjorgjieva</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Clopath</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Audet</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Pfister</surname>, <given-names>J.P</given-names></string-name></person-group>. <article-title>A triplet spike-timing-dependent plasticity model generalizes the Bienenstock-Cooper-Munro rule to higher-order spatiotemporal correlations</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>, <fpage>19383</fpage>–<lpage>19388</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shouval</surname>, <given-names>H.Z</given-names></string-name></person-group>. <article-title>What is the appropriate description level for synaptic plasticity?</article-title> <source>Proc Natl Acad Sci U S A</source> <volume>108</volume>, <fpage>19103</fpage>–<lpage>19104</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morita</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Kato</surname>, <given-names>A</given-names></string-name></person-group>. <article-title>Striatal dopamine ramping may indicate flexible reinforcement learning with forgetting in the cortico-basal ganglia circuits</article-title>. <source>Front Neural Circuits</source> <volume>8</volume>, <issue>36</issue> (<year>2014</year>).</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kato</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Morita</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>Forgetting in Reinforcement Learning Links Sustained Dopamine Signals to Motivation</article-title>. <source>PLoS Comput Biol</source> <volume>12</volume>, <fpage>e1005145</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Kato</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Morita</surname>, <given-names>K.</given-names></string-name></person-group> <article-title>Striatal Gradient in Value-Decay Explains Regional Differences in Dopamine Patterns and Reinforcement Learning Computations</article-title>. <source>bioRxiv</source> <pub-id pub-id-type="doi">10.1101/2025.01.24.631285</pub-id> (<year>2025</year>).</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Cornford</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Learning to live with Dale’s principle: ANNs with separate excitatory and inhibitory units</article-title>. <source>bioRxiv</source> <pub-id pub-id-type="doi">10.1101/2020.11.02.364968</pub-id> (<year>2021</year>).</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Li</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Cornford</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Ghosh</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Richards</surname>, <given-names>B.</given-names></string-name></person-group> <article-title>Learning better with Dale’s Law: A Spectral Perspective</article-title>. <source>bioRxiv</source> <pub-id pub-id-type="doi">10.1101/2023.06.28.546924</pub-id> (<year>2023</year>).</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mastrogiuseppe</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Ostojic</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>Linking Connectivity, Dynamics, and Computations in Low-Rank Recurrent Neural Networks</article-title>. <source>Neuron</source> <volume>99</volume>, <fpage>609</fpage>–<lpage>623.e629</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morita</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Kalra</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Aihara</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Robinson</surname>, <given-names>H</given-names></string-name></person-group>. <article-title>Recurrent synaptic input and the timing of gamma-frequency-modulated firing of pyramidal cells during neocortical “UP” states</article-title>. <source>J Neurosci</source> <volume>28</volume>, <fpage>1871</fpage>–<lpage>1881</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c66"><label>66.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hasenstaub</surname>, <given-names>A.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Inhibitory postsynaptic potentials carry synchronized frequency information in active cortical networks</article-title>. <source>Neuron</source> <volume>47</volume>, <fpage>423</fpage>–<lpage>435</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c67"><label>67.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>, <given-names>X.-J</given-names></string-name></person-group>. <article-title>Neurophysiological and computational principles of cortical rhythms in cognition</article-title>. <source>Physiol Rev</source> <volume>90</volume>, <fpage>1195</fpage>–<lpage>1268</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c68"><label>68.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Wang</surname>, <given-names>X.J</given-names></string-name></person-group>. <article-title>Mechanisms of gamma oscillations</article-title>. <source>Annu Rev Neurosci</source> <volume>35</volume>, <fpage>203</fpage>–<lpage>225</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c69"><label>69.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cone</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Clopath</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Shouval</surname>, <given-names>H.Z</given-names></string-name></person-group>. <article-title>Learning to express reward prediction error-like dopaminergic activity requires plastic representations of time</article-title>. <source>Nat Commun</source> <volume>15</volume>, <fpage>5856</fpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c70"><label>70.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Sutton</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Barto</surname>, <given-names>A</given-names></string-name></person-group>. <source>Reinforcement Learning</source> (<publisher-name>MIT Press, Cambridge</publisher-name>, <publisher-loc>MA</publisher-loc>, <year>1998</year>).</mixed-citation></ref>
<ref id="c71"><label>71.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Takahashi</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Schoenbaum</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Niv</surname>, <given-names>Y</given-names></string-name></person-group>. <article-title>Silencing the critics: understanding the effects of cocaine sensitization on dorsolateral and ventral striatum in the context of an actor/critic model</article-title>. <source>Front Neurosci</source> <volume>2</volume>, <fpage>86</fpage>–<lpage>99</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c72"><label>72.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname>, <given-names>X.-J</given-names></string-name></person-group>. <article-title>Probabilistic decision making by slow reverberation in cortical circuits</article-title>. <source>Neuron</source> <volume>36</volume>, <fpage>955</fpage>–<lpage>968</lpage> (<year>2002</year>).</mixed-citation></ref>
<ref id="c73"><label>73.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lo</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Wang</surname>, <given-names>X</given-names></string-name></person-group>. <article-title>Cortico-basal ganglia circuit mechanism for a decision threshold in reaction time tasks</article-title>. <source>Nat Neurosci</source> <volume>9</volume>, <fpage>956</fpage>–<lpage>963</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c74"><label>74.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hunt</surname>, <given-names>L.T.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Mechanisms underlying cortical activity during value-guided choice</article-title>. <source>Nat Neurosci</source> <volume>15</volume>, <fpage>470</fpage>–<lpage>476</lpage>, S471-473 (<year>2012</year>).</mixed-citation></ref>
<ref id="c75"><label>75.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Williams</surname>, <given-names>S.M.</given-names></string-name> &amp; <string-name><surname>Goldman-Rakic</surname>, <given-names>P.S</given-names></string-name></person-group>. <article-title>Widespread origin of the primate mesofrontal dopamine system</article-title>. <source>Cereb Cortex</source> <volume>8</volume>, <fpage>321</fpage>–<lpage>345</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c76"><label>76.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Broussard</surname>, <given-names>J.I.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Dopamine Regulates Aversive Contextual Learning and Associated In Vivo Synaptic Plasticity in the Hippocampus</article-title>. <source>Cell Rep</source> <volume>14</volume>, <fpage>1930</fpage>–<lpage>1939</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c77"><label>77.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Samejima</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Ueda</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Doya</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Kimura</surname>, <given-names>M</given-names></string-name></person-group>. <article-title>Representation of action-specific reward values in the striatum</article-title>. <source>Science</source> <volume>310</volume>, <fpage>1337</fpage>–<lpage>1340</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c78"><label>78.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brozoski</surname>, <given-names>T.J.</given-names></string-name>, <string-name><surname>Brown</surname>, <given-names>R.M.</given-names></string-name>, <string-name><surname>Rosvold</surname>, <given-names>H.E.</given-names></string-name> &amp; <string-name><surname>Goldman</surname>, <given-names>P.S</given-names></string-name></person-group>. <article-title>Cognitive deficit caused by regional depletion of dopamine in prefrontal cortex of rhesus monkey</article-title>. <source>Science</source> <volume>205</volume>, <fpage>929</fpage>–<lpage>932</lpage> (<year>1979</year>).</mixed-citation></ref>
<ref id="c79"><label>79.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sawaguchi</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Goldman-Rakic</surname>, <given-names>P.S</given-names></string-name></person-group>. <article-title>D1 dopamine receptors in prefrontal cortex: involvement in working memory</article-title>. <source>Science</source> <volume>251</volume>, <fpage>947</fpage>–<lpage>950</lpage> (<year>1991</year>).</mixed-citation></ref>
<ref id="c80"><label>80.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Durstewitz</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Seamans</surname>, <given-names>J.K.</given-names></string-name> &amp; <string-name><surname>Sejnowski</surname>, <given-names>T.J</given-names></string-name></person-group>. <article-title>Dopamine-mediated stabilization of delay-period activity in a network model of prefrontal cortex</article-title>. <source>J Neurophysiol</source> <volume>83</volume>, <fpage>1733</fpage>–<lpage>1750</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c81"><label>81.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brunel</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Wang</surname>, <given-names>X</given-names></string-name></person-group>. <article-title>Effects of neuromodulation in a cortical network model of object working memory dominated by recurrent inhibition</article-title>. <source>J Comput Neurosci</source> <volume>11</volume>, <fpage>63</fpage>–<lpage>85</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c82"><label>82.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Floresco</surname>, <given-names>S.B.</given-names></string-name> &amp; <string-name><surname>Magyar</surname>, <given-names>O</given-names></string-name></person-group>. <article-title>Mesocortical dopamine modulation of executive functions: beyond working memory</article-title>. <source>Psychopharmacology (Berl)</source> <volume>188</volume>, <fpage>567</fpage>–<lpage>585</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c83"><label>83.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tsetsenis</surname>, <given-names>T.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Midbrain dopaminergic innervation of the hippocampus is sufficient to modulate formation of aversive memories</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>118</volume>, <fpage>e2111069118</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c84"><label>84.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>O’Doherty</surname>, <given-names>J.P.</given-names></string-name>, <string-name><surname>Dayan</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Friston</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Critchley</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Dolan</surname>, <given-names>R.J</given-names></string-name></person-group>. <article-title>Temporal difference models and reward-related learning in the human brain</article-title>. <source>Neuron</source> <volume>38</volume>, <fpage>329</fpage>–<lpage>337</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c85"><label>85.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Takahashi</surname>, <given-names>Y.K.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Expectancy-related changes in firing of dopamine neurons depend on orbitofrontal cortex</article-title>. <source>Nat Neurosci</source> <volume>14</volume>, <fpage>1590</fpage>–<lpage>1597</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c86"><label>86.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Starkweather</surname>, <given-names>C.K.</given-names></string-name>, <string-name><surname>Gershman</surname>, <given-names>S.J.</given-names></string-name> &amp; <string-name><surname>Uchida</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>The Medial Prefrontal Cortex Shapes Dopamine Reward Prediction Errors under State Uncertainty</article-title>. <source>Neuron</source> <volume>98</volume>, <fpage>616</fpage>–<lpage>629.e616</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c87"><label>87.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Takahashi</surname>, <given-names>Y.K.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Expectancy-related changes in firing of dopamine neurons depend on hippocampus</article-title>. <source>bioRxiv</source> <pub-id pub-id-type="doi">10.1101/2023.07.19.549728</pub-id> (<year>2023</year>).</mixed-citation></ref>
<ref id="c88"><label>88.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Otani</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Daniel</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Roisin</surname>, <given-names>M.P.</given-names></string-name> &amp; <string-name><surname>Crepel</surname>, <given-names>F</given-names></string-name></person-group>. <article-title>Dopaminergic modulation of long-term synaptic plasticity in rat prefrontal neurons</article-title>. <source>Cereb Cortex</source> <volume>13</volume>, <fpage>1251</fpage>–<lpage>1256</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c89"><label>89.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sayegh</surname>, <given-names>F.J.P.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Ventral tegmental area dopamine projections to the hippocampus trigger long-term potentiation and contextual learning</article-title>. <source>Nat Commun</source> <volume>15</volume>, <fpage>4100</fpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c90"><label>90.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname>, <given-names>R.S.</given-names></string-name>, <string-name><surname>Sagiv</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Engelhard</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Witten</surname>, <given-names>I.B.</given-names></string-name> &amp; <string-name><surname>Daw</surname>, <given-names>N.D</given-names></string-name></person-group>. <article-title>A feature-specific prediction error model explains dopaminergic heterogeneity</article-title>. <source>Nat Neurosci</source> <volume>27</volume>, <fpage>1574</fpage>–<lpage>1586</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c91"><label>91.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Avvisati</surname>, <given-names>R.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Distributional coding of associative learning in discrete populations of midbrain dopamine neurons</article-title>. <source>Cell Rep</source> <volume>43</volume>, <issue>114080</issue> (<year>2024</year>).</mixed-citation></ref>
<ref id="c92"><label>92.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Watabe-Uchida</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Zhu</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Ogawa</surname>, <given-names>S.K.</given-names></string-name>, <string-name><surname>Vamanrao</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Uchida</surname>, <given-names>N</given-names></string-name></person-group>. <article-title>Whole-brain mapping of direct inputs to midbrain dopamine neurons</article-title>. <source>Neuron</source> <volume>74</volume>, <fpage>858</fpage>–<lpage>873</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c93"><label>93.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Carta</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>C.H.</given-names></string-name>, <string-name><surname>Schott</surname>, <given-names>A.L.</given-names></string-name>, <string-name><surname>Dorizan</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Khodakhah</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>Cerebellar modulation of the reward circuitry and social behavior</article-title>. <source>Science</source> <volume>363</volume> (<year>2019</year>).</mixed-citation></ref>
<ref id="c94"><label>94.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Marr</surname>, <given-names>D</given-names></string-name></person-group>. <article-title>A theory of cerebellar cortex</article-title>. <source>J Physiol</source> <volume>202</volume>, <fpage>437</fpage>–<lpage>470</lpage> (<year>1969</year>).</mixed-citation></ref>
<ref id="c95"><label>95.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beier</surname>, <given-names>K.T.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Circuit Architecture of VTA Dopamine Neurons Revealed by Systematic Input-Output Mapping</article-title>. <source>Cell</source> <volume>162</volume>, <fpage>622</fpage>–<lpage>634</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c96"><label>96.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Li</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Rainnie</surname>, <given-names>D.G</given-names></string-name></person-group>. <article-title>Bidirectional regulation of synaptic plasticity in the basolateral amygdala induced by the D1-like family of dopamine receptors and group II metabotropic glutamate receptors</article-title>. <source>J Physiol</source> <volume>592</volume>, <fpage>4329</fpage>–<lpage>4351</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c97"><label>97.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sias</surname>, <given-names>A.C.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Dopamine projections to the basolateral amygdala drive the encoding of identity-specific reward memories</article-title>. <source>Nat Neurosci</source> <volume>27</volume>, <fpage>728</fpage>–<lpage>736</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c98"><label>98.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Headley</surname>, <given-names>D.B.</given-names></string-name>, <string-name><surname>Kyriazi</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Feng</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Nair</surname>, <given-names>S.S.</given-names></string-name> &amp; <string-name><surname>Pare</surname>, <given-names>D</given-names></string-name></person-group>. <article-title>Gamma Oscillations in the Basolateral Amygdala: Localization, Microcircuitry, and Behavioral Correlates</article-title>. <source>J Neurosci</source> <volume>41</volume>, <fpage>6087</fpage>–<lpage>6101</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c99"><label>99.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Britt</surname>, <given-names>J.P.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Synaptic and behavioral profile of multiple glutamatergic inputs to the nucleus accumbens</article-title>. <source>Neuron</source> <volume>76</volume>, <fpage>790</fpage>–<lpage>803</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c100"><label>100.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lee</surname>, <given-names>I.B.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Persistent enhancement of basolateral amygdala-dorsomedial striatum synapses causes compulsive-like behaviors in mice</article-title>. <source>Nat Commun</source> <volume>15</volume>, <issue>219</issue> (<year>2024</year>).</mixed-citation></ref>
<ref id="c101"><label>101.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Saez</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Rigotti</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Ostojic</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Fusi</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Salzman</surname>, <given-names>C.D</given-names></string-name></person-group>. <article-title>Abstract Context Representations in Primate Amygdala and Prefrontal Cortex</article-title>. <source>Neuron</source> <volume>87</volume>, <fpage>869</fpage>–<lpage>881</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c102"><label>102.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Stalnaker</surname>, <given-names>T.A.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Dopamine neuron ensembles signal the content of sensory prediction errors</article-title>. <source>eLife</source> <volume>8</volume>, <elocation-id>e49315</elocation-id> (<year>2019</year>). <pub-id pub-id-type="doi">10.7554/eLife.49315</pub-id></mixed-citation></ref>
<ref id="c103"><label>103.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gerfen</surname>, <given-names>C.R.</given-names></string-name> &amp; <string-name><surname>Surmeier</surname>, <given-names>D.J</given-names></string-name></person-group>. <article-title>Modulation of Striatal Projection Systems by Dopamine</article-title>. <source>Annu Rev Neurosci</source> <volume>34</volume>, <fpage>441</fpage>–<lpage>466</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c104"><label>104.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Collins</surname>, <given-names>A.G.</given-names></string-name> &amp; <string-name><surname>Frank</surname>, <given-names>M.J</given-names></string-name></person-group>. <article-title>Opponent actor learning (OpAL): modeling interactive effects of striatal dopamine on reinforcement learning and choice incentive</article-title>. <source>Psychol Rev</source> <volume>121</volume>, <fpage>337</fpage>–<lpage>366</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c105"><label>105.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mikhael</surname>, <given-names>J.G.</given-names></string-name> &amp; <string-name><surname>Bogacz</surname>, <given-names>R</given-names></string-name></person-group>. <article-title>Learning Reward Uncertainty in the Basal Ganglia</article-title>. <source>PLoS Comput Biol</source> <volume>12</volume>, <fpage>e1005062</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c106"><label>106.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morita</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Kawaguchi</surname>, <given-names>Y</given-names></string-name></person-group>. <article-title>A Dual Role Hypothesis of the Cortico-Basal-Ganglia Pathways: Opponency and Temporal Difference Through Dopamine and Adenosine</article-title>. <source>Front Neural Circuits</source> <volume>12</volume>, <issue>111</issue> (<year>2019</year>).</mixed-citation></ref>
<ref id="c107"><label>107.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lowet</surname>, <given-names>A.S.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>An opponent striatal circuit for distributional reinforcement learning</article-title>. <source>Nature</source> <volume>639</volume>, <fpage>717</fpage>–<lpage>726</lpage> (<year>2025</year>).</mixed-citation></ref>
<ref id="c108"><label>108.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wall</surname>, <given-names>N.R.</given-names></string-name>, <string-name><surname>De La Parra</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Callaway</surname>, <given-names>E.M.</given-names></string-name> &amp; <string-name><surname>Kreitzer</surname>, <given-names>A.C</given-names></string-name></person-group>. <article-title>Differential innervation of direct-and indirect-pathway striatal projection neurons</article-title>. <source>Neuron</source> <volume>79</volume>, <fpage>347</fpage>–<lpage>360</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c109"><label>109.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morita</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>Differential cortical activation of the striatal direct and indirect pathway cells: reconciling the anatomical and optogenetic results by using a computational method</article-title>. <source>J Neurophysiol</source> <volume>112</volume>, <fpage>120</fpage>–<lpage>146</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c110"><label>110.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hooks</surname>, <given-names>B.M.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Topographic precision in sensory and motor corticostriatal projections varies across cell type and cortical area</article-title>. <source>Nat Commun</source> <volume>9</volume>, <fpage>3549</fpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c111"><label>111.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morita</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Im</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Kawaguchi</surname>, <given-names>Y</given-names></string-name></person-group>. <article-title>Differential striatal axonal arborizations of the intratelencephalic and pyramidal-tract neurons: analysis of the data in the MouseLight database</article-title>. <source>Front Neural Circuits</source> <volume>13</volume>, <issue>71</issue> (<year>2019</year>).</mixed-citation></ref>
<ref id="c112"><label>112.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Tian</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Distributed and Mixed Information in Monosynaptic Inputs to Dopamine Neurons</article-title>. <source>Neuron</source> <volume>91</volume>, <fpage>1374</fpage>–<lpage>1389</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c113"><label>113.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Levy</surname>, <given-names>D.J.</given-names></string-name> &amp; <string-name><surname>Glimcher</surname>, <given-names>P.W</given-names></string-name></person-group>. <article-title>The root of all value: a neural common currency for choice</article-title>. <source>Curr Opin Neurobiol</source> <volume>22</volume>, <fpage>1027</fpage>–<lpage>1038</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c114"><label>114.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Konishi</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Igarashi</surname>, <given-names>K.M.</given-names></string-name> &amp; <string-name><surname>Miura</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>Biologically plausible local synaptic learning rules robustly implement deep supervised learning</article-title>. <source>Front Neurosci</source> <volume>17</volume>, <fpage>1160899</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c115"><label>115.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Cho</surname>, <given-names>K.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Learning Phrase Representations using RNN Encoder–Decoder for Statistical Machine Translation</article-title>. <source>arXiv</source> 1406.1078 (<year>2014</year>).</mixed-citation></ref>
<ref id="c116"><label>116.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hochreiter</surname>, <given-names>S</given-names></string-name></person-group>. <article-title>The vanishing gradient problem during learning recurrent neural nets and problem solutions</article-title>. <source>International Journal of Uncertainty, Fuzziness and Knowledge-Based Systems</source> <volume>6</volume>, <fpage>107</fpage>–<lpage>115</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c117"><label>117.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hochreiter</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Schmidhuber</surname>, <given-names>J</given-names></string-name></person-group>. <article-title>Long short-term memory</article-title>. <source>Neural Comput</source> <volume>9</volume>, <fpage>1735</fpage>–<lpage>1780</lpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c118"><label>118.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Costa</surname>, <given-names>R.P.</given-names></string-name>, <string-name><surname>Assael</surname>, <given-names>Y.M.</given-names></string-name>, <string-name><surname>Shillingford</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>De Freitas</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Vogels</surname>, <given-names>T.</given-names></string-name></person-group> <article-title>Cortical microcircuits as gated-recurrent neural networks</article-title>. <source>Advances in Neural Information Processing Systems</source> (<year>2017</year>).</mixed-citation></ref>
<ref id="c119"><label>119.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shouval</surname>, <given-names>H.Z.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>S.S.</given-names></string-name> &amp; <string-name><surname>Wittenberg</surname>, <given-names>G.M</given-names></string-name></person-group>. <article-title>Spike timing dependent plasticity: a consequence of more fundamental learning rules</article-title>. <source>Front Comput Neurosci</source> <volume>4</volume>, <issue>19</issue> (<year>2010</year>).</mixed-citation></ref>
<ref id="c120"><label>120.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Poirazi</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Brannon</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Mel</surname>, <given-names>B</given-names></string-name></person-group>. <article-title>Pyramidal neuron as two-layer neural network</article-title>. <source>Neuron</source> <volume>37</volume>, <fpage>989</fpage>–<lpage>999</lpage> (<year>2003</year>).</mixed-citation></ref>
<ref id="c121"><label>121.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Morita</surname>, <given-names>K</given-names></string-name></person-group>. <article-title>Possible role of dendritic compartmentalization in the spatial working memory circuit</article-title>. <source>J Neurosci</source> <volume>28</volume>, <fpage>7699</fpage>–<lpage>7724</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c122"><label>122.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Körding</surname>, <given-names>K.P.</given-names></string-name> &amp; <string-name><surname>König</surname>, <given-names>P</given-names></string-name></person-group>. <article-title>Supervised and unsupervised learning with two sites of synaptic integration</article-title>. <source>J Comput Neurosci</source> <volume>11</volume>, <fpage>207</fpage>–<lpage>215</lpage> (<year>2001</year>).</mixed-citation></ref>
<ref id="c123"><label>123.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Illing</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Ventura</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Bellec</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Gerstner</surname>, <given-names>W.</given-names></string-name></person-group> <article-title>Local plasticity rules can learn deep representations using self-supervised contrastive predictions</article-title>. in <source>Advances in Neural Information Processing Systems 34 (NeurIPS 2021)</source> (<year>2021</year>).</mixed-citation></ref>
<ref id="c124"><label>124.</label><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Barto</surname>, <given-names>A.G.</given-names></string-name> &amp; <string-name><surname>Jordan</surname>, <given-names>M.I</given-names></string-name></person-group>. <article-title>Gradient Following Without Back-Propagation in Layered Networks</article-title>. in <conf-name>Proceedings of the First Annual International Conference on Neural Networks</conf-name> <italic>Vol.</italic> <volume>II</volume> <fpage>629</fpage>–<lpage>636</lpage> (San Diego, CA., <year>1987</year>).</mixed-citation></ref>
<ref id="c125"><label>125.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mazzoni</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Andersen</surname>, <given-names>R.A.</given-names></string-name> &amp; <string-name><surname>Jordan</surname>, <given-names>M.I</given-names></string-name></person-group>. <article-title>A more biologically plausible learning rule for neural networks</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>88</volume>, <fpage>4433</fpage>–<lpage>4437</lpage> (<year>1991</year>).</mixed-citation></ref>
<ref id="c126"><label>126.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mazzoni</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Andersen</surname>, <given-names>R.A.</given-names></string-name> &amp; <string-name><surname>Jordan</surname>, <given-names>M.I</given-names></string-name></person-group>. <article-title>A more biologically plausible learning rule than backpropagation applied to a network model of cortical area 7a</article-title>. <source>Cereb Cortex</source> <volume>1</volume>, <fpage>293</fpage>–<lpage>307</lpage> (<year>1991</year>).</mixed-citation></ref>
<ref id="c127"><label>127.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Max</surname>, <given-names>K.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Learning efficient backprojections across cortical hierarchies in real time</article-title>. <source>Nature Machine Intelligence</source> <volume>6</volume>, <fpage>619</fpage>–<lpage>630</lpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c128"><label>128.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hoerzer</surname>, <given-names>G.M.</given-names></string-name>, <string-name><surname>Legenstein</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Maass</surname>, <given-names>W</given-names></string-name></person-group>. <article-title>Emergence of complex computational structures from chaotic neural networks through reward-modulated Hebbian learning</article-title>. <source>Cereb Cortex</source> <volume>24</volume>, <fpage>677</fpage>–<lpage>690</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c129"><label>129.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Faisal</surname>, <given-names>A.A.</given-names></string-name>, <string-name><surname>Selen</surname>, <given-names>L.P.</given-names></string-name> &amp; <string-name><surname>Wolpert</surname>, <given-names>D.M</given-names></string-name></person-group>. <article-title>Noise in the nervous system</article-title>. <source>Nat Rev Neurosci</source> <volume>9</volume>, <fpage>292</fpage>–<lpage>303</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c130"><label>130.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Aihara</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Matsumoto</surname>, <given-names>G.</given-names></string-name></person-group>, <year>1986</year>).<chapter-title>Chaotic oscillations and bifurcations in squid giant axons</chapter-title>. in <person-group person-group-type="editor"><string-name><given-names>A.V.</given-names> <surname>Holden</surname></string-name></person-group><source>Chaos</source> (ed. ) (<publisher-name>Princeton University Press</publisher-name>, ).</mixed-citation></ref>
<ref id="c131"><label>131.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Vreeswijk</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Sompolinsky</surname>, <given-names>H</given-names></string-name></person-group>. <article-title>Chaos in neuronal networks with balanced excitatory and inhibitory activity</article-title>. <source>Science</source> <volume>274</volume>, <fpage>1724</fpage>–<lpage>1726</lpage> (<year>1996</year>).</mixed-citation></ref>
<ref id="c132"><label>132.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Krausz</surname>, <given-names>T.A.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Dual credit assignment processes underlie dopamine signals in a complex spatial environment</article-title>. <source>Neuron</source> <volume>111</volume>, <fpage>3465</fpage>–<lpage>3478.e3467</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c133"><label>133.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ludvig</surname>, <given-names>E.A.</given-names></string-name>, <string-name><surname>Sutton</surname>, <given-names>R.S.</given-names></string-name> &amp; <string-name><surname>Kehoe</surname>, <given-names>E.J</given-names></string-name></person-group>. <article-title>Evaluating the TD model of classical conditioning</article-title>. <source>Learn Behav</source> <volume>40</volume>, <fpage>305</fpage>–<lpage>319</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c134"><label>134.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Markram</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lübke</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Frotscher</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Sakmann</surname>, <given-names>B</given-names></string-name></person-group>. <article-title>Regulation of synaptic efficacy by coincidence of postsynaptic APs and EPSPs</article-title>. <source>Science</source> <volume>275</volume>, <fpage>213</fpage>–<lpage>215</lpage> (<year>1997</year>).</mixed-citation></ref>
<ref id="c135"><label>135.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bi</surname>, <given-names>G.Q.</given-names></string-name> &amp; <string-name><surname>Poo</surname>, <given-names>M.M</given-names></string-name></person-group>. <article-title>Synaptic modifications in cultured hippocampal neurons: dependence on spike timing, synaptic strength, and postsynaptic cell type</article-title>. <source>J Neurosci</source> <volume>18</volume>, <fpage>10464</fpage>–<lpage>10472</lpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c136"><label>136.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Drew</surname>, <given-names>P.J.</given-names></string-name> &amp; <string-name><surname>Abbott</surname>, <given-names>L.F</given-names></string-name></person-group>. <article-title>Extending the effects of spike-timing-dependent plasticity to behavioral timescales</article-title>. <source>Proc Natl Acad Sci U S A</source> <volume>103</volume>, <fpage>8876</fpage>–<lpage>8881</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c137"><label>137.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bittner</surname>, <given-names>K.C.</given-names></string-name>, <string-name><surname>Milstein</surname>, <given-names>A.D.</given-names></string-name>, <string-name><surname>Grienberger</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Romani</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Magee</surname>, <given-names>J.C</given-names></string-name></person-group>. <article-title>Behavioral time scale synaptic plasticity underlies CA1 place fields</article-title>. <source>Science</source> <volume>357</volume>, <fpage>1033</fpage>–<lpage>1036</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c138"><label>138.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Caya-Bissonnette</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Naud</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Béïque</surname>, <given-names>J.-C.</given-names></string-name></person-group> <article-title>Cellular Substrate of Eligibility Traces</article-title>. <source>bioRxiv</source> <pub-id pub-id-type="doi">10.1101/2023.06.29.547097</pub-id> (<year>2023</year>).</mixed-citation></ref>
<ref id="c139"><label>139.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Bailey</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Mattar</surname>, <given-names>M.G.</given-names></string-name></person-group> <article-title>Predecessor Features</article-title>. <source>arXiv</source> <pub-id pub-id-type="doi">10.48550/arXiv.2206.00303</pub-id> (<year>2022</year>).</mixed-citation></ref>
<ref id="c140"><label>140.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Jeong</surname>, <given-names>H.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Mesolimbic dopamine release conveys causal associations</article-title>. <source>Science</source> <volume>378</volume>, <fpage>eabq6740</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c141"><label>141.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Garr</surname>, <given-names>E.</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Mesostriatal dopamine is sensitive to changes in specific cue-reward contingencies</article-title>. <source>Sci Adv</source> <volume>10</volume>, <fpage>eadn4203</fpage> (<year>2024</year>).</mixed-citation></ref>
<ref id="c142"><label>142.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Floeder</surname>, <given-names>J.R.</given-names></string-name>, <string-name><surname>Jeong</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Mohebi</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Namboodiri</surname>, <given-names>V.M.K.</given-names></string-name></person-group> <article-title>Mesolimbic dopamine ramps reflect environmental timescales</article-title>. <source>eLife</source> <pub-id pub-id-type="doi">10.7554/eLife.98666.1</pub-id> (<year>2024</year>).</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<title>Appendix</title>
<sec id="s6a">
<label>A.1</label><title>Eligibility trace</title>
<p>As mentioned in the Introduction and Discussion, our model has relations to other models, including the algorithms named RFLO (random feedback local online) <sup><xref ref-type="bibr" rid="c34">34</xref></sup> and e-prop <sup><xref ref-type="bibr" rid="c35">35</xref></sup>. In the derivation of RFLO <sup><xref ref-type="bibr" rid="c34">34</xref></sup>, initially, partial derivative of the across-time sum of squared errors with respect to each RNN weight was taken (as in the exact RTRL (Real-Time Recurrent Learning)), and then in order to make the update rule local, the parts depending on the other weights were omitted, while the local “eligibility traces” were remained. e-prop <sup><xref ref-type="bibr" rid="c35">35</xref></sup> also resulted in the terms interpreted as eligibility traces. By contrast, we started from partial derivative of the squared error at the current time rather than its across-time sum, and the resulting update rule does not contain eligibility trace. Our model could still solve credit assignment at least to some extent because we use TD error and TD learning itself (even TD(0) without eligibility trace) is a solution for credit assignment as we mentioned in the Discussion.</p>
<p>Based on these considerations, we conjectured that adding eligibility trace to our update rule could possibly improve the learnability of our model especially in the case with long cue-reward delay, and we tested it. We considered modified models, in which the terms depending on the pre-synaptic and post-synaptic activities in the update rules for the connections on the RNN units were replaced with the terms including eligibility traces that were locally updated and exponentially decayed. Specifically, we examined modified oVRNNbp-rev and oVRNNrf-bio, in which the following part in the update rules for elements of <bold>A</bold> and <bold>B</bold>:
<disp-formula>
<graphic xlink:href="609100v4_ueqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
was replaced with (1−<italic>η</italic>)<italic>Z<sub>ij</sub></italic>, where <italic>Z<sub>ij</sub></italic> was updated at every time-step as follows:
<disp-formula>
<graphic xlink:href="609100v4_ueqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<italic>η</italic> (&lt; 1) was a parameter indicating the length (time scale) of eligibility trace.</p>
<p>We simulated the Pavlovian cue-reward association task with 6 time-steps cue-reward delay, varying the parameter <italic>η</italic>. As a result, in the model with random feedback, oVRNNrf-bio, with 40 RNN units and the default learning rates that we used, eligibility trace indeed improved the performance, though not drastically (the blue line in the left panel of <xref rid="figa1" ref-type="fig">Figure A1</xref>), while in the model with symmetric feedback (oVRNNbp-rev), there was no improvement (the red line in the left panel). In the cases with the learning rates halved (used in <xref rid="fig6" ref-type="fig">Fig. 6J-right</xref>), the results look more complicated (the right panel).</p>
<fig id="figa1" position="float" orientation="portrait" fig-type="figure">
<label>Figure A1</label>
<caption><title>Performance (mean squared value error from cue to reward) of modified oVRNNbp-rev (red lines) and oVRNNrf-bio (blue lines) incorporating eligibility trace in the Pavlovian cue-reward association task with 6 time-steps cue-reward delay, with the default learning rates (left panel) or halved learning rates (right panel) used in <xref ref-type="fig" rid="fig6">Fig. 6J</xref> left and right, respectively.</title>
<p>The eligibility-trace parameter <italic>η</italic> was varied as indicated by the horizontal axis. The data at <italic>η</italic> = 0 are the results for the original models without eligibility trace (the same data as those shown in <xref ref-type="fig" rid="fig6">Fig. 6J</xref>), for which 100 simulations were executed. For the other cases, we executed 1000 simulations in order to precisely examine changes in the performance.</p></caption>
<graphic xlink:href="609100v4_figa1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s6b">
<label>A.2</label><title>Behavioral time-scale synaptic plasticity (BTSP)</title>
<p>We originally assumed that update of the connections onto the RNN units is implemented by Hebbian synaptic plasticity. However, considering this point further, we have realized that Hebbian plasticity, or at least a typical form of it, namely, the spike-timing-dependent-plasticity (STDP) <sup><xref ref-type="bibr" rid="c134">134</xref>, <xref ref-type="bibr" rid="c135">135</xref></sup> may not be able to implement the update of the RNN connections in our model. This is because while the single time-step in our model was assumed to correspond to several hundreds of milliseconds, the time scale of STDP is much shorter, up to several tens of milliseconds. Besides, measurable degrees of STDP would be caused only after repetitive pairing of pre- and post-synaptic spikes, whereas our non-spiking rate-based model has no description of such repetitive pairing. There have been proposals on how such a gap between the time scale of STDP and behavioral time scale could be bridged <sup><xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c23">23</xref>, <xref ref-type="bibr" rid="c136">136</xref></sup>, and with such mechanisms, STDP could still potentially implement the update of the RNN connections in our model. However, it may be more likely to be implemented by a different from of synaptic plasticity named the behavioral time-scale synaptic plasticity (BTSP) <sup><xref ref-type="bibr" rid="c137">137</xref>, <xref ref-type="bibr" rid="c138">138</xref></sup>.</p>
<p>BTSP, originally found in hippocampal CA1 synapses <sup><xref ref-type="bibr" rid="c137">137</xref></sup>, is induced by pairing of pre- and post- synaptic activity, similar to STDP. However, different from STDP, the time scale of BTSP is much longer, up to seconds, and also BTSP can be induced with only a few, or even a single, pairing. These features could better fit the update of the RNN connections in our model. Recently <sup><xref ref-type="bibr" rid="c138">138</xref></sup>, BTSP was found also in the neocortex, in particular, the prefrontal cortex, which receives rich DA projections and is thus a primarily hypothesized brain region for the RNN in our model. Compared to hippocampal BTSP, prefrontal BTSP has somewhat shorter time scale, several hundreds of millisecond difference between pre- and post-synaptic activity, for potentiation, and also differs in that pairing within a time window of 100-300 ms does not cause potentiation (instead causing slight depression) <sup><xref ref-type="bibr" rid="c138">138</xref></sup>.</p>
<p>In terms of time-scale, BTSP appears to be good for implementing the update of the RNN connections in our model. However, two points need consideration. First, bidirectional modulation of BTSP by positive/negative DA signals will be required, but it has not yet been experimentally shown. Second, in both hippocampal <sup><xref ref-type="bibr" rid="c137">137</xref></sup> and prefrontal <sup><xref ref-type="bibr" rid="c138">138</xref></sup> BTSP, potentiation is caused not only by the pre→post order but also by the post→pre order of activity paring, different from STDP. As for hippocampal BTSP, there is still an asymmetry, i.e., potentiation occurs more/longer for pre→post pairing than for post→pre pairing (<xref rid="fig3" ref-type="fig">Fig. 3D</xref> of <sup><xref ref-type="bibr" rid="c137">137</xref></sup>). Similar asymmetry was not reported for prefrontal BTSP <sup><xref ref-type="bibr" rid="c138">138</xref></sup>, although asymmetry could still possibly appear due to additional factors <italic>in vivo</italic>. The update rule for the RNN connections in our model, inherited from the original derivation according to the gradient descent, assumes potentiation for pre→post pairing but not for post→pre pairing under positive TD-RPE. It thus remains elusive whether learning could still occur in our model when not only pre→post pairing but also post→pre pairing induces potentiation under positive TD-RPE.</p>
<p>We examined this by simulations of the Pavlovian cue-reward association task with 3 time-steps cue-reward delay with modified oVRNNrf-bio, in which update of the connections on the RNN units was induced by pre→post and post→pre activity pairings with <italic>k</italic><sub>pre→post</sub> : 1 − <italic>k</italic><sub>pre→post</sub> ratio, with <italic>k</italic><sub>pre→post</sub> varied from 1 (corresponding to the original oVRNNrf-bio), 0.75 (3 : 1 ratio), 0.66.. (2 : 1 ratio), 0.6 (3 : 2 ratio), to 0.5 (1 : 1 ratio, i.e.; symmetric). More specifically, we examined modified oVRNNrf-bio, in which the update rules for <bold>A</bold> and <bold>B</bold> (<xref rid="eqn3d" ref-type="disp-formula">Eq. 3.5</xref>-<xref rid="eqn3g" ref-type="disp-formula">8</xref>) were replaced with the followings:
<disp-formula>
<graphic xlink:href="609100v4_ueqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>k</italic><sub>pre→post</sub> is a parameter indicating the proportion of update induced by pre→post activity pairing and was set to 1 (corresponding to the original oVRNNrf-bio), 0.75, 2/3(=0.66..), 0.6, or 0.5.</p>
<p>The results, mean squared errors in the state values from cue to reward, are shown in <xref rid="figa2" ref-type="fig">Figure A2</xref>. As shown in the figure, the model performed better than the untrained control with connections shuffled from learnt original oVRNNrf-bio even when update of the RNN connections was induced by not only pre→post but also post→pre activity pairings if there was at least a modest level of asymmetry (3 : 2) and the number of RNN units was not small (25 or above).</p>
<fig id="figa2" position="float" orientation="portrait" fig-type="figure">
<label>Figure A2</label>
<caption><title>Performance (mean squared value error from cue to reward) of modified oVRNNrf-bio incorporating behavioral time-scale synaptic plasticity (BTSP) in the Pavlovian cue-reward association task with 3 time-steps cue-reward delay.</title>
<p>In the modified model, the update rule for the weights on the RNN units was modified so that update could depend on both pre→post and post→pre activity pairings. The proportion of update induced by pre→post activity pairing (parameter <italic>k</italic><sub>pre→post</sub>) was varied to 1 (corresponding to the original oVRNNrf-bio), 0.75, 2/3(=0.66..), 0.6, or 0.5, indicated by solid lines with different colors. The gray dotted line indicates the performance of agent having untrained RNN with connections shuffled from learnt original oVRNNrf-bio. Other configurations are the same as those for <xref ref-type="fig" rid="fig6">Fig. 6E</xref> left. Other parameters were set as follows. Learning rates: <italic>a</italic><sub>RNN</sub> = 0.1 and <italic>a</italic><sub>value</sub> = 0.1/(<italic>n</italic>/12). Time discount factor: <italic>γ</italic> = 0.8. Number of trials: 1500. Number of simulations: 100 for each condition.</p></caption>
<graphic xlink:href="609100v4_figa2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Addition of synaptic update by post→pre pairing up to a certain extent thus does not totally ruin the performance of our model, but it still causes a degradation, rather than an improvement, in terms of this performance measure, as would be expected. However, addition of synaptic update by post→pre pairing could potentially provide the model with other features. Specifically, given that potentiation by pre→post pairing could cause self-organization of the successor representation (SR) <sup><xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c23">23</xref></sup>, potentiation by post→pre pairing could potentially cause self-organization of the opposite, predecessor representation (PR) (c.f., <sup><xref ref-type="bibr" rid="c139">139</xref></sup>). Then, having both pre→post potentiation and post→pre potentiation could achieve a formation of state representation that has features of both SR and PR. Intriguingly, recent studies <sup><xref ref-type="bibr" rid="c140">140</xref>–<xref ref-type="bibr" rid="c142">142</xref></sup> suggest that mesolimbic DA signals ‘adjusted net contingency for causal relations (ANCCR)’, which combines SR and PR. Whether BTSP with both pre→post potentiation and post→pre potentiation contributes to its mechanism may be interesting to address in future studies.</p>
</sec>
</app>
</app-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104101.3.sa4</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Naud</surname>
<given-names>Richard</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>University of Ottawa</institution>
</institution-wrap>
<city>Ottawa</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
</front-stub>
<body>
<p>In this <bold>important</bold> study, the authors model reinforcement-learning experiments using a recurrent neural network. The work examines if the detailed credit assignment necessary for back-propagation through time can be replaced with random feedback. The authors provide <bold>solid</bold> evidence that the solution is adequate within relatively simple tasks.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104101.3.sa3</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>Can a plastic RNN serve as a basis function for learning to estimate value. In previous work this was shown to be the case, with a similar architecture to that proposed here. The learning rule in previous work was back-prop with an objective function that was the TD error function (delta) squared. Such a learning rule is non-local as the changes in weights within the RNN, and from inputs to the RNN depends on the weights from the RNN to the output, which estimates value. This is non-local, and in addition, these weights themselves change over learning. The main idea in this paper is to examine if replacing the values of these non-local changing weights, used for credit assignment, with random fixed weights can still produce similar results to those obtained with complete bp. This random feedback approach is motivated by a similar approach used for deep feed-forward neural networks.</p>
<p>This work shows that this random feedback in credit assignment performs well but is not as well as the precise gradient-based approach. When more constraints due to biological plausibility are imposed performance degrades. These results are consistent with previous results on random feedback.</p>
<p>Strengths:</p>
<p>The authors show that random feedback can approximate well a model trained with detailed credit assignment.</p>
<p>The authors simulate several experiments including some with probabilistic reward schedules and show results similar to those obtained with detailed credit assignments as well as in experiments.</p>
<p>The paper examines the impact of more biologically realistic learning rules and the results are still quite similar to the detailed back-prop model.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104101.3.sa2</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>Tsurumi et al. show that recurrent neural networks can learn state and value representations in simple reinforcement learning tasks when trained with random feedback weights. The traditional method of learning for recurrent network in such tasks (backpropogation through time) requires feedback weights which are a transposed copy of the feed-forward weights, a biologically implausible assumption. This manuscript builds on previous work regarding &quot;random feedback alignment&quot; and &quot;value-RNNs&quot;, and extends them to a reinforcement learning context. The authors also demonstrate that certain non-negative constraints can enforce a &quot;loose alignment&quot; of feedback weights. The author's results suggest that random feedback may be a powerful tool of learning in biological networks, even in reinforcement learning tasks.</p>
<p>Strengths:</p>
<p>The authors describe well the issues regarding biologically plausible learning in recurrent networks and in reinforcement learning tasks. They take care to propose networks which might be implemented in biological systems and compare their proposed learning rules to those already existing in literature. Further, they use small networks on relatively simple tasks, which allows for easier intuition into the learning dynamics.</p>
<p>Weaknesses:</p>
<p>The principles discovered by the authors in these smaller networks are not applied to larger networks or more complicated tasks with long temporal delays (&gt;100 timesteps), so it remains unclear to what degree these methods can scale or can be used more generally.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104101.3.sa1</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The paper studies learning rules in a simple sigmoidal recurrent neural network setting. The recurrent network has a single layer of 10 to 40 units. It is first confirmed that feedback alignment (FA) can learn a value function in this setting. Then so-called bio-plausible constraints are added: (1) when value weights (readout) is non-negative, (2) when the activity is non-negative (normal sigmoid rather than downscaled between -0.5 and 0.5), (3) when the feedback weights are non-negative, (4) when the learning rule is revised to be monotic: the weights are not downregulated. In the simple task considered all four biological features do not appear to impair totally the learning.</p>
<p>Strengths:</p>
<p>(1) The learning rules are implemented in a low-level fashion of the form: (pre-synaptic-activity) x (post-synaptic-activity) x feedback x RPE. Which is therefore interpretable in terms of measurable quantities in the wet-lab.</p>
<p>(2) I find that non-negative FA (FA with non negative c and w) is the most valuable theoretical insight of this paper: I understand why the alignment between w and c is automatically better at initialization.</p>
<p>(3) The task choice is relevant, since it connects with experimental settings of reward conditioning with possible plasticity measurements.</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.104101.3.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Tsurumi</surname>
<given-names>Takayuki</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Kato</surname>
<given-names>Ayaka</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6306-6600</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Kumar</surname>
<given-names>Arvind</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8044-9195</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Morita</surname>
<given-names>Kenji</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-2192-4248</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the previous reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Public Review):</bold></p>
</disp-quote>
<p>We thank the reviewer for the positive feedback on the work. The reviewer has raised two weaknesses and in the following we discuss how those can be addressed.</p>
<disp-quote content-type="editor-comment">
<p>Weaknesses:</p>
<p>The impact of the article is limited by using a network with discrete time- steps, and only a small number of time steps from stimulus to reward. They assume that each time step is on the order of hundreds of ms. They justify this by pointing to some slow intrinsic mechanisms, but they do not implement these slow mechanisms is a network with short time steps, instead they assume without demonstration that these could work as suggested. This is a reasonable first approximation, but its validity should be explicitly tested.</p>
</disp-quote>
<p>Our goal here was to give a proof of concept that online random feedback is sufficient to train an RNN to estimate value. Indeed, it is important to show that the idea works in a model where the slow mechanisms are explicitly implemented. However, this is a non-trivial task and desired to be addressed in future works.</p>
<disp-quote content-type="editor-comment">
<p>As the delay between cue and reward increases the performance decreases. This is not surprising given the proposed mechanism, but is still a limitation, especially given that we do not really know what a is the reasonable value of a single time step.</p>
</disp-quote>
<p>In reply to this comment and the other reviewer's related comment, we have conducted two sets of additional simulations, one for examining incorporation of eligibility traces, and the other for considering (though not mechanistically implementing) behavioral time-scale synaptic plasticity (BTSP). We have added their results to the revised manuscript as Appendix. We think that the results addressed this point to some extent while how longer cue-reward delay can be learnt by elaboration of the model remains as a future issue.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
</disp-quote>
<p>We thank the reviewer for the positive feedback on the work. The reviewer gave comments on our revisions, and here we discuss how those can be addressed.</p>
<disp-quote content-type="editor-comment">
<p>Comments on revisions: I would still want to see how well the network learns tasks with longer time delays (on the order of 100 or even 1000 timesteps). Previous work has shown that random feedback struggles to encode longer timescales (see Murray 2019, Figure 2), so I would be interested to see how that translates to the RL context in your model.</p>
</disp-quote>
<p>We would like to note that in Murray et al 2019 the random feedback per se appeared not to be primarily responsible for the difficulty in encoding longer timesclaes. In the Figure 2d (Murray 2019), the author compared his RFLO (random feedback local online) and BPTT with two intermediate algorithms, which incorporated either one of the two approximations made in RFLO: i) random feedback instead of symmetric feedback, and ii) omittance of non-local effect (i.e., dependence of the derivative of the loss with respect to a given weight on the other weights). The performance difference between RFLO and BPTT was actually mostly explained by ii), as the author mentioned &quot;The results show that the local approximation is essentially fully responsible for the performance difference between RFLO and BPTT, while there is no significant loss in performance due to the random feedback alone. (Line 6-8, page 7 of Murray, 2019, eLife)&quot;.</p>
<p>Meanwhile, regarding the difference in the performance of the model with random feedback vs the model with symmetric feedback in our settings, actually it appeared (already) in the case with 6 time-steps or less (the biologically constrained model with random feedback performed worse: Fig. 6J, left).</p>
<p>In practice, our model, either with random or symmetric feedback, would not be able to learn the cases with very long delays. This is indeed a limitation of our model. However, our model is critically different from the model of Murray 2019 in that we use RL rather than supervised learning and we use a scalar bootstrapped (TD) reward-prediction-error rather than the true output error. We would think that these differences may be major reasons for the limited learning ability of our model.</p>
<p>Regarding the feasibility of the model when tasks involve longer time delays: Indeed this is a problem and the other reviewers have also raised the same point. Our model can be extended by incorporating either a kind of eligibility trace (similar one to those contained in RFLO and e-prop) or behavioral time-scale synaptic plasticity (BTSP), and we have added the results of simulations incorporating each to the revised manuscript as Appendix. But how longer cue-reward delay can be learnt by elaboration of the model remains as a future issue.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public Review):</bold></p>
<p>Comments on revisions: Thank you for addressing all my comments in your reply.</p>
</disp-quote>
<p>We are happy to learn that all concerns raised by the reviewer in the previous round were addressed adequately. We agree with the reviewer that there are several ways the work can be improved.</p>
<p>The various points raised by the reviewers at weaknesses are desired to be taken up in future works.</p>
</body>
</sub-article>
</article>