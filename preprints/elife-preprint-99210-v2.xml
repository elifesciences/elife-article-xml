<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">99210</article-id>
<article-id pub-id-type="doi">10.7554/eLife.99210</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.99210.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.4</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Genetics and Genomics</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Tradeoffs in Modeling Context Dependency in Complex Trait Genetics</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Weine</surname>
<given-names>Eric</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6269-0276</contrib-id>
<name>
<surname>Smith</surname>
<given-names>Samuel Pattillo</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Knowlton</surname>
<given-names>Rebecca Kathryn</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3655-748X</contrib-id>
<name>
<surname>Harpak</surname>
<given-names>Arbel</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<email>arbelharpak@utexas.edu</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj54h04</institution-id><institution>Department of Integrative Biology, The University of Texas at Austin</institution></institution-wrap>, <city>Austin</city>, <country country="US">United States</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj54h04</institution-id><institution>Department of Population Health, The University of Texas at Austin</institution></institution-wrap>, <city>Austin</city>, <country country="US">United States</country></aff>
<aff id="a3"><label>3</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/024mw5h28</institution-id><institution>Department of Human Genetics, University of Chicago</institution></institution-wrap>, <city>Chicago</city>, <country country="US">United States</country></aff>
<aff id="a4"><label>4</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/00hj54h04</institution-id><institution>Department of Statistics and Data Sciences, The University of Texas at Austin</institution></institution-wrap>, <city>Austin</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Perry</surname>
<given-names>George H</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Pennsylvania State University</institution>
</institution-wrap>
<city>University Park</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Perry</surname>
<given-names>George H</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Pennsylvania State University</institution>
</institution-wrap>
<city>University Park</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-07-17">
<day>17</day>
<month>07</month>
<year>2024</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-03-13">
<day>13</day>
<month>03</month>
<year>2025</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP99210</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-05-14">
<day>14</day>
<month>05</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-05-14">
<day>14</day>
<month>05</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.06.21.545998"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-07-17">
<day>17</day>
<month>07</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.99210.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.99210.1.sa3">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99210.1.sa2">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.99210.1.sa1">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="author-comment" xlink:href="https://doi.org/10.7554/eLife.99210.1.sa0">Author response:</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Weine et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Weine et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-99210-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>Genetic effects on complex traits may depend on context, such as age, sex, environmental exposures or social settings. However, it is often unclear if the extent of context dependency, or Gene-by-Environment interaction (GxE), merits more involved models than the additive model typically used to analyze data from genome-wide association studies (GWAS). Here, we suggest considering the utility of GxE models in GWAS as a tradeoff between bias and variance parameters. In particular, We derive a decision rule for choosing between competing models for the estimation of allelic effects. The rule weighs the increased estimation noise when context is considered against the potential bias when context dependency is ignored. In the empirical example of GxSex in human physiology, the increased noise of context-specific estimation often outweighs the bias reduction, rendering GxE models less useful when variants are considered independently. However, we argue that for complex traits, the joint consideration of context dependency across many variants mitigates both noise and bias. As a result, polygenic GxE models can improve both estimation and trait prediction. Finally, we exemplify (using GxDiet effects on longevity in fruit flies) how analyses based on independently ascertained “top hits” alone can be misleading, and that considering polygenic patterns of GxE can improve interpretation.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Edits to the text: primarily signposting on the relationship between the theoretical derivation of the single-variant decision rule and later sections of the manuscript discussing inference and prediction in complex trait genetics.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>In organisms and study systems where the environment can be tractably manipulated, gene-by-environment interactions (GxE) are the rule, not the exception [<xref ref-type="bibr" rid="c1">1</xref>–<xref ref-type="bibr" rid="c5">5</xref>]. Yet, in complex (polygenic) human traits, there are but a few cases in which models that incorporate GxE explain data—such as Genome-Wide Association Study (GWAS) data—better than parsimonious models that assume additive contributions of genetic and environmental factors [<xref ref-type="bibr" rid="c6">6</xref>–<xref ref-type="bibr" rid="c8">8</xref>]. This is true for both physical environments but also for other definitions of “E,” broadly construed to be any context that modifies genetic effects, such as age, sex, or social setting [<xref ref-type="bibr" rid="c9">9</xref>–<xref ref-type="bibr" rid="c16">16</xref>].</p>
<p>GWAS commonly estimate marginal additive effects of an allele on a trait. The estimand here can be thought of as the average effect of the allele over a distribution of multidimensional contexts [<xref ref-type="bibr" rid="c17">17</xref>]. With this view, some differences in allelic effects across contexts are likely omnipresent, but may very well be small, such that the cost of including additional parameters (for context-specific effects) outweighs the benefit of measuring heterogeneous effects.</p>
<p>Here, we consider this problem and its connection to the currently underwhelming utility of GxE models in GWAS. First, we rigorously describe the statistical trade-off involved in estimating context-specificity at the level of a single variant. Then, we highlight ways in which this trade-off might change as we consider GxE in complex traits, involving numerous genetic variants simultaneously.</p>
<p>We begin by framing the problem of estimating context-specificity at an individual variant as a bias–variance trade-off. For example, consider the estimation of an allelic effect on lung cancer risk that depends on smoking status. When the allelic effect is estimated from a sample without considering smoking status, the estimate would be biased with respect to the true effect in smokers. We can estimate the effect separately in smokers and non-smokers to eliminate the bias, but the consideration of the additional parameters—smoking status-specific effects—has an associated cost of increasing the estimation variance, compared to an estimator that ignores smoking status. This bias–variance trade-off is closely related to the “signal-to-noise” ratio, where the signal of interest is the true difference in context-specific allelic effects. To demonstrate this tradeoff in real data, we consider sex-specific effects on physiological traits in humans. We show that for the majority of traits, it is typically unhelpful to model sex dependency for individual sites since the increase in noise vastly outweighs the signal.</p>
<p>We then consider the extension to GxE in complex traits. Complex trait variation is primarily due to numerous genetic variants of small effects distributed throughout the genome [<xref ref-type="bibr" rid="c18">18</xref>–<xref ref-type="bibr" rid="c21">21</xref>]. Simultaneously considering GxE across multiple variants may decrease estimation noise if the extent and mode of context-specificity is similar across numerous variants. This would tilt the scale in favor of context-dependent estimation. In addition, we show how conventional approaches for detecting and characterizing GxE, which focus on the most significant associations, may lead to erroneous conclusions. Finally, we discuss implications for complex trait prediction (with polygenic scores). We suggest a future focus on prediction methods that empirically learn the extent and nature of context dependency by simultaneously considering GxE across many variants.</p>
</sec>
<sec id="s2">
<title>Results and Discussion</title>
<sec id="s2a">
<title>Modeling context-dependent effect estimation as a bias–variance trade-off</title>
<p><bold>The problem setup</bold>. We consider a sample of n + m individuals characterized as being in one of two contexts, A or B. n of the individuals are in context A with the remaining m individuals in context B. We measure a continuous trait for each individual, denoted by
<disp-formula id="ueqn1">
<graphic xlink:href="545998v4_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We begin by considering the estimation of the effect of a single variant on the continuous trait. We assume a generative model of the form
<disp-formula id="eqn1">
<graphic xlink:href="545998v4_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>β</italic><sub><italic>A</italic></sub> and <italic>β</italic><sub><italic>B</italic></sub> are fixed, context-specific effects of a reference allele at a biallelic, autosomal variant i, g<sub><italic>i</italic></sub> ∈ {0, 1, 2} is the observed reference allele count. α<sub><italic>A</italic></sub> and α<sub><italic>B</italic></sub> are the context-specific intercepts, corresponding to the mean trait for individuals with zero reference alleles in context A and B, respectively. <inline-formula><inline-graphic xlink:href="545998v4_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are context-specific observation variances. We would like to estimate the allelic effects <italic>β</italic><sub><italic>A</italic></sub> and <italic>β</italic><sub><italic>B</italic></sub>.</p>
<sec id="s2a1">
<title>Estimation approaches</title>
<p>We compare two approaches to this estimation problem. The first approach, which we refer to as GxE estimation, is to stratify the sample by context and separately perform an ordinary least squares (OLS) regression in each sample. This approach yields two estimates, <inline-formula><inline-graphic xlink:href="545998v4_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, the OLS estimates of <italic>β</italic><sub><italic>A</italic></sub> and <italic>β</italic><sub><italic>B</italic></sub> of the generative model in <xref ref-type="disp-formula" rid="eqn1">Eq. 1</xref>, respectively. This estimation model is equivalent to a linear model with a term for the interaction between context and reference allele count, in the sense that context-specific allelic effect estimators have the same maximum likelihood estimators in the two models (see <xref rid="d1e1189" ref-type="supplementary-material">Supplementary Materials</xref>).</p>
<p>The second approach, which we refer to as additive estimation, is to perform an OLS regression on the entire sample and use the allelic effect estimate to estimate both <italic>β</italic><sub><italic>A</italic></sub> and <italic>β</italic><sub><italic>B</italic></sub>. We denote this estimator as <inline-formula><inline-graphic xlink:href="545998v4_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, to emphasize that the regression is run on all individuals from context A and context B. This estimation model posits that for i = 1, …, n + m,
<disp-formula id="eqn2">
<graphic xlink:href="545998v4_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where α<sub><italic>A∪B</italic></sub> is the mean trait value for an individual with zero reference alleles, <italic>β</italic><sub><italic>A∪B</italic></sub> is the additive allelic effect and <inline-formula><inline-graphic xlink:href="545998v4_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the observation variance which is independent of context. Notably, this model differs from the generative model assumed above: <italic>β</italic><sub><italic>A∪B</italic></sub> may not equal <italic>β</italic><sub><italic>A</italic></sub> and <italic>β</italic><sub><italic>B</italic></sub>; in addition, this model ignores heteroskedasticity across contexts.</p>
</sec>
<sec id="s2a2">
<title>Error analysis</title>
<p>We focus on the mean squared error (MSE) of the additive and GxE estimators for the allelic effect in context A. The estimator minimizing the MSE may differ between contexts A and B, but the analysis for context B is analogous. When selecting between these two estimation approaches, a bias–variance decomposition of the MSE is useful.</p>
<p>Based on OLS theory ([<xref ref-type="bibr" rid="c22">22</xref>, Theorem 11.3.3]), under the model specified above we have
<disp-formula id="ueqn2">
<graphic xlink:href="545998v4_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="545998v4_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the mean genotype of individuals in context A. The unbiasedness of the GxE estimator implies
<disp-formula id="ueqn3">
<graphic xlink:href="545998v4_ueqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="545998v4_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the mean squared error of estimating <italic>β</italic><sub><italic>A</italic></sub> with <inline-formula><inline-graphic xlink:href="545998v4_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The case of the additive estimator, <inline-formula><inline-graphic xlink:href="545998v4_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, is a bit more involved. As we show in the <bold>Methods</bold> section, we can write
<disp-formula id="eqn3">
<graphic xlink:href="545998v4_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
for non-negative weights ω<sub><italic>A</italic></sub> and ω<sub><italic>B</italic></sub> (that need not sum to 1). Further, we show in <xref ref-type="disp-formula" rid="eqn7">Eq. 7</xref> of the <bold>Methods</bold> section that ω<sub><italic>A</italic></sub> ∝ nH<sub><italic>A</italic></sub> and ω<sub><italic>B</italic></sub> ∝ mH<sub><italic>B</italic></sub>, where H<sub><italic>A</italic></sub> and H<sub><italic>B</italic></sub> are the sample heterozygozities in contexts A and B, respectively. Using <xref ref-type="disp-formula" rid="eqn3">Eq. 3</xref>, we may write
<disp-formula id="ueqn4">
<graphic xlink:href="545998v4_ueqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>V</italic><sub><italic>B</italic></sub> is defined analogously to <italic>V</italic><sub><italic>A</italic></sub>. Thus, with MSE as our metric for comparison, we prefer the GxE estimator in context A when
<disp-formula id="ueqn5">
<graphic xlink:href="545998v4_ueqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
or, if and only if
<disp-formula id="eqn4">
<graphic xlink:href="545998v4_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We refer to <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> as the “decision rule,” since it guides us on the more accurate estimator; to minimize the MSE, we will use the context-specific estimator if and only if the inequality is satisfied.</p>
<p>To gain some intuition about the important parameters here, we first consider the case of equal allele frequencies (and hence equal heterozygozities) in both contexts and equal estimation variance in both contexts. In this case, the GxE estimator is advantaged by larger context-specificity (larger |<italic>β</italic><sub><italic>A</italic></sub> − <italic>β</italic><sub><italic>B</italic></sub>|) and disadvantaged by larger estimation noise (larger <italic>V</italic><sub><italic>A</italic></sub> = <italic>V</italic><sub><italic>B</italic></sub>) (<xref rid="fig1" ref-type="fig">Fig. 1</xref>). In fact, the decision boundary (i.e. the point at which the two models have equal MSE) can be written as a linear combination of |<italic>β</italic><sub><italic>A</italic></sub> − <italic>β</italic><sub><italic>B</italic></sub>| and <inline-formula><inline-graphic xlink:href="545998v4_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (<xref rid="fig1" ref-type="fig">Fig. 1C</xref>). In this special case, we show in the <bold>Methods</bold> section that <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> is an equality when
<disp-formula id="eqn5">
<graphic xlink:href="545998v4_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula></p>
<p>More generally, in the case where H<sub><italic>A</italic></sub> = H<sub><italic>B</italic></sub> but <italic>V</italic><sub><italic>A</italic></sub> ≠ <italic>V</italic><sub><italic>B</italic></sub>, we show in the <bold>Methods</bold> section that we can write <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> as
<disp-formula id="eqn6">
<graphic xlink:href="545998v4_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
This dimensionless re-parameterization of the decision rule makes explicit its dependence on three factors <inline-formula><inline-graphic xlink:href="545998v4_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula> can be viewed as the “signal-to-noise” ratio: it captures the degree of context-specificity (the signal) relative to the estimation noise in the focal context, A. <inline-formula><inline-graphic xlink:href="545998v4_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the relative contribution to heterozygosity, which equals the relative contribution to variance in the independent variable of the OLS regression of <xref ref-type="disp-formula" rid="eqn2">Eq. 2</xref>. <inline-formula><inline-graphic xlink:href="545998v4_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the ratio of context-specific estimation noises. In the <xref rid="d1e1189" ref-type="supplementary-material">Supplementary Materials</xref>, we extend the decision rule for the case of a continuous context variable.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><p>Bias-Variance tradeoff for single-site estimation with equal estimation noise and equal heterozygozity across contexts. The x-axis shows the difference in context-specific effects, while the y-axis shows the standard deviation of the context-specific estimators—both in raw measurement units. The color on the plot indicates the difference between the additive and GxE estimators in bias (A), variance (B) or MSE (C). Only the additive estimator is potentially biased. The bias is proportional to the difference in context-specific effects and independent of the estimation noise. <bold>(B)</bold> The difference in variance is is proportional to context-specific estimation noise and independent of the difference of context-specific effects. <bold>(C)</bold> The decision boundary is linear in both the estimation noise and the difference between context-specific effects.</p></caption>
<graphic xlink:href="545998v4_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>For a given trait and context, we can consider the behavior of the decision rule across variants with variable allele frequencies and allelic effects. The ratio of estimation noises, <inline-formula><inline-graphic xlink:href="545998v4_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, will not be constant. However, in some cases, considering a fixed <italic>r</italic> across variants is a good approximation. In GWAS of complex traits, each variant often explains a small fraction of trait variance. As a result, the estimation noise is effectively a matter of trait variance and heterozygosity alone. If per-site heterozygosity is similar in strata A and B, as it is, for example, for autosomal variants in biological males and females, <italic>r</italic> is approximately fixed across variants [<xref ref-type="bibr" rid="c9">9</xref>].</p>
<p><xref rid="fig2" ref-type="fig">Fig. 2</xref> illustrates the linearity of the decision boundary under the assumption that <italic>r</italic> is fixed across variants. It also shows that the slope of the decision boundary changes as a function of r. Intuitively, we are less likely to prefer GxE estimation for the noisier context. In fact, for sufficiently small values of <italic>r</italic> (e.g. <italic>r</italic> &lt; <inline-formula><inline-graphic xlink:href="545998v4_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for <inline-formula><inline-graphic xlink:href="545998v4_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>), <inline-formula><inline-graphic xlink:href="545998v4_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula> will be negative. This corresponds to the situation where <italic>V</italic><sub><italic>A</italic></sub> ≪ <italic>V</italic><sub><italic>B</italic></sub>, in which case the additive estimator is never preferable to the GxE estimator in estimating <italic>β</italic><sub><italic>A</italic></sub>, as the signal-to-noise ratio is always non-negative. Typically, this will also imply that the additive estimator is greatly preferable for estimating <italic>β</italic><sub><italic>B</italic></sub>, as <inline-formula><inline-graphic xlink:href="545998v4_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula> will be extremely noisy.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><p>The decision boundary with different ratios of context-specific estimation noises. In all panels, the heterozygozity of the variant is assumed to be equal across contexts. The x and y axes are the same as in <xref rid="fig1" ref-type="fig">Fig. 1</xref>. Estimation noise in the focal context, A, is half that of the other context, B. <bold>(B)</bold> Estimation noise is equal in both contexts. <bold>(C)</bold> Estimation noise in focal context is double that of the other context.</p></caption>
<graphic xlink:href="545998v4_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>It is natural to ask where the decision rule of <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref> falls with respect to empirical GWAS data. We considered the example of biological sex as the context (GxSex), and examined sex-stratified GWAS data across 27 continuous physiological traits in the UK Biobank [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c23">23</xref>]. For each of nine million variants, we estimated the difference in sex-specific effects and the variance of each marginal effect estimator in males. Then, using an estimate of the ratio of sex-specific trait variances as a proxy for the ratio of estimation variances of males and females, we approximated the linear decision boundary between the additive and GxE estimators (<xref rid="fig3" ref-type="fig">Fig. 3A,B</xref>; <xref rid="d1e1189" ref-type="supplementary-material">Text S1</xref>). To demonstrate the accuracy of our decision rule, we employed a data-splitting technique where we estimate the MSE difference between estimators in a training set and evaluate the accuracy in a holdout set (<xref rid="d1e1189" ref-type="supplementary-material">Fig. S1</xref><bold/>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><p>Applying the decision rule to sex-dependent effects on human physiological traits. <bold>(A-B)</bold> The x-axis shows the estimated absolute difference between the effect of variants in males and females. The y-axis shows the measured standard error for each variant in males, the focal context here. The dashed line shows the decision boundary for effect estimation in males. The difference in MSE between estimation methods increases linearly with distance from the dashed line, as in <xref rid="fig2" ref-type="fig">Fig. 2</xref>. If a variant falls above (below) the line, the additive (GxE) estimator has a lower MSE. (A) shows a random sample of 15K single nucleotide variants whereas (B) shows only variants with a marginal p-value less than 5×10<sup>−8</sup> in males. <bold>(C-D)</bold> The percent of effects in males which would be better estimated by the GxE estimator, across continuous physiological traits. To estimate these percentages, one single nucleotide variant is sampled from each of 1,700 approximately independent auotosomal linkage blocks, and this procedure is repeated 10 times. Shown are average percentages across the 10 iterations.</p></caption>
<graphic xlink:href="545998v4_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>For almost all traits examined, very few allelic effects in males are expected to be more accurately estimated using the male-specific estimator (usually between 0% and 0.1%). Notable exceptions to this rule are testosterone, sex hormone binding globulin (SHBG), and waist-to-hip ratio adjusted for body mass index (BMI), for which roughly .5% of allelic effects are expected to be better estimated with the GxE model (<xref rid="fig3" ref-type="fig">Fig. 3B</xref>). However, when considering only SNPs that are genome-wide significant in males (marginal p-value &lt; 5 × 10<sup><italic>−</italic>8</sup> in males), many traits show a much larger proportion of effects that would be better estimated by the GxE model. At an extreme, for testosterone, all genome-wide significant SNPs are expected to be better estimated by the GxE model. In addition, a large fraction of genome-wide significant effects are better estimated with the GxE model for creatinine (62%), arm fat-free mass (24%), waist-to-hip ratio (19%) and SHBG (18%) as well (<xref rid="fig3" ref-type="fig">Fig. 3,D</xref>).</p>
<p>The decision rule we derived could potentially guide more accurate allelic effect estimation approaches. However, the consideration of GxE pattern sharing across many variants (polygenic GxE) can alter both bias and variance and therefore the tradeoff. In our discussion of complex traits that follows, we therefore expand on the rule through qualitative consequences of polygenic GxE, and no longer stick to the analytical single variant rule.</p>
</sec>
</sec>
<sec id="s2b">
<title>Context dependency in complex traits</title>
<p>At the single variant level, and specifically when variants are considered independently from one another, we have discussed how the accurate estimation of allelic effects can be boiled down to a bias–variance tradeoff. For complex traits, genetic variance is often dominated by the contribution of numerous variants of small effects that are best understood when analyzed jointly [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c24">24</xref>–<xref ref-type="bibr" rid="c28">28</xref>]. It stands to reason that to evaluate context-dependence in complex traits, we would also want to jointly consider polygenic patterns, rather than just the patterns at the loci most strongly associated with a trait [<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c13">13</xref>, <xref ref-type="bibr" rid="c29">29</xref>–<xref ref-type="bibr" rid="c32">32</xref>].</p>
<p>Motivated by this rationale, we recently inferred polygenic GxSex patterns in human physiology [<xref ref-type="bibr" rid="c9">9</xref>]. One pattern that emerged as a common mode of GxSex across complex physiological traits is “amplification”: a systematic difference in the magnitude of genetic effects between the sexes. Moving beyond sex and considering any context, amplification can happen if, for example, many variants regulate a shared pathway that is moderated by a factor—and that factor varies in its distribution among contexts. Amplification is but one possible mode of polygenic GxE, but can serve as a guiding example for ways in which GxE may be pervasive but difficult to characterize with existing approaches [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c33">33</xref>, <xref ref-type="bibr" rid="c34">34</xref>]. In what follows, we will therefore use the example of pervasive amplification (across causal effects) to illustrate the interpretive advantage of considering context dependency across variants jointly, rather than independently.</p>
<sec id="s2b1">
<title>A focus on “top hits” may lead to mis-characterization of polygenic GxE</title>
<p>A common approach to the analysis of context dependency involves two steps. First, categorization of context dependency (or lack thereof) is performed for each variant independently. Second, variants falling under each category are counted and annotated across the genome. Some recent examples of this approach towards the characterization of GxE in complex traits include studies of GxSex effects on flight performance in <italic>Drosophila</italic> [<xref ref-type="bibr" rid="c35">35</xref>], GxSex effects on various traits in humans [<xref ref-type="bibr" rid="c36">36</xref>, <xref ref-type="bibr" rid="c37">37</xref>] and GxDietxAge effects on body weight in mice [<xref ref-type="bibr" rid="c38">38</xref>].</p>
<p>Characterizing polygenic trends by summarizing many independent hypothesis tests may miss GxE signals that are subtle and statistically undetectable at each individual variant, yet pervasive and substantial cumulatively across the genome. To characterize polygenic GxE based on just the “top hits” may lead to ascertainment biases, with respect to both the pervasiveness and the mode of GxE across the genome. Much like the heritability of complex traits is thought to be due to the contribution of many small (typically sub-significant) effects [<xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c26">26</xref>], when GxE is pervasive we may expect that the sum of many small differences in context-specific effects accounts for the majority of GxE variation.</p>
<p>For concreteness, we consider in more depth one recent study characterizing GxDiet effects on longevity in <italic>Drosophila melanogaster</italic> [<xref ref-type="bibr" rid="c39">39</xref>]. In this study, Pallares et al. tracked caged fly populations given one of two diets: a “control” diet and a “high-sugar” diet. Across 271K single nucleotide variants, the authors tested for association between alleles and their survival to a sampling point (thought of as a proxy for “lifespan” or “longevity”) under each diet independently. Then, they classified variants according to whether or not their associations with survivorship were significant under each diet as follows:</p>
<list list-type="order">
<list-item><p>significant under neither diet → classify as <italic>no effect</italic>.</p></list-item>
<list-item><p>significant when fed the high-sugar diet, but not when fed the control diet → classify as <italic>high-sugar specific effect</italic>.</p></list-item>
<list-item><p>significant when fed the control diet, but not when fed the high-sugar diet → classify as <italic>control specific effect</italic>.</p></list-item>
<list-item><p>significant under both diets → classify as <italic>shared effect</italic>.</p></list-item>
</list>
<p>This authors’ choice of four categories a variant may fall into may be motivated by the wish to test for the presence of “cryptic genetic variation”—genetic variation that is maintained in a context where it is functionally neutral but carries large effects in a new or stressful context [<xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c5">5</xref>, <xref ref-type="bibr" rid="c33">33</xref>, <xref ref-type="bibr" rid="c40">40</xref>]. Indeed, of the variants Pallares et al. classified as having an effect (one hundredth of variants tested), approximately 31% were high-sugar specific, while the remaining 69% of the variants were shared. Fewer than 1% were labelled as having control specific effects. They concluded that high-sugar specific effects on longevity are pervasive, compatible with the hypothesis of widespread cryptic genetic variation for longevity.</p>
<p>This characterization of GxE, based on “top hits”, places an emphasis on the context(s) in which trait associations are statistically significant, rather than on estimating how the context-specific effects covary. In addition, this particular classification system also does not cover all possible ways in which context-specific effects may differ. In the <xref rid="d1e1189" ref-type="supplementary-material">Supplementary Materials</xref>, we discuss these interpretation difficulties further.</p>
<p>We next show that a generative model that differs qualitatively from the cryptic genetic variation model yields results that are highly similar to those observed by Pallares et al. We simulated data under pervasive amplification. Specifically, we sampled from a mixture of 40% of variants having no effect under either diet and 60% of variants having an effect under both diets—but exactly 1.4× larger under a high-sugar diet. We then simulated the noisy estimation of these effects, and employed the classification approach of Pallares et al. to the simulated data (<bold>Methods</bold>).</p>
<p>The patterns of allelic effects in the control compared to high-sugar contexts were qualitatively similar in the experimental data and our pervasive amplification simulation. This is true both genome-wide (<xref rid="fig4" ref-type="fig">Fig. 4A</xref> compared to <xref rid="fig4" ref-type="fig">Fig. 4B</xref>) and for the set of variants classified as significant with their classification approach (<xref rid="fig4" ref-type="fig">Fig. 4C</xref> compared to <xref rid="fig4" ref-type="fig">Fig. 4D</xref>). The similarity of ascertained variants further highlights caveats of interpretation based on the classification of “top hits”: despite the fact that we did not simulate any variants that only have an effect under the high-sugar diet, approximately 36% of significant variants were classified as specific to the high-sugar diet (green points in <xref rid="fig4" ref-type="fig">Fig. 4D</xref>), comparable to the 31% of variants classified as high-sugar specific in the experimental data (<xref rid="fig4" ref-type="fig">Fig. 4C</xref>). These variants simply have sub-significant associations in the control group and significant associations in the high-sugar group. In addition, every variant in the shared category (blue points in <xref rid="fig4" ref-type="fig">Fig. 4D</xref>) in fact has a larger effect in the high-sugar diet than in the control diet, which cannot be captured by the classification system itself but represents the only mode of GxE in our simulation.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><p>A focus on top hits may be lead to mischaracterization of polygenic GxE. <bold>(A)</bold> Data from an experiment measuring allelic effects on longevity in caged flies given one of two diets, “control” and “high sugar”. Shown are allelic effect estimates under each diet for a random sample of approximately 12K variants. Simulated data where all true allelic effects are exactly 1.4 times larger under a high-sugar diet. The effects are estimated with sampling noise mimicking the Pallares et al. data. <bold>(C)</bold> Allelic effect estimates of variants ascertained as significant and classified as “diet-specific” or “shared” by Pallares et al. <bold>(D)</bold> Simulated effects ascertained as significant and classified using a similar procedure to that applied in (C). While the generative mode of GxE we used in our simulations was not considered by Pallares et al., the simulation results (left panels) closely match the patterns observed in their data (right panels) across all effects (top panels) and as reflected via their classification approach (bottom panels).</p></caption>
<graphic xlink:href="545998v4_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>To recap, we simulated a mode of GxE that is not considered in Pallares et al. (i.e., pervasive amplification) and that is at odds with their conclusions about evidence for a large discrete class of SNPs with diet-specific effects (i.e., cryptic genetic variation). The close match of our simulation to the empirical results of Pallares et al. therefore illustrates that the characterization of GxE via hypothesis testing and classification at each variant independently may lead to erroneous interpretation when applied to empirical complex trait data as well. In the <xref rid="d1e1189" ref-type="supplementary-material">Supplementary Materials</xref>, we show that a re-analysis of the Pallares et al. data that is based on estimating the covariance of allelic effects directly is consistent with pervasive amplification as well (<xref rid="d1e1189" ref-type="supplementary-material">Fig. S4</xref>). In conclusion, the classification of “top hits” alone may not be representative of the extent of GxE nor of the most pervasive modes of GxE.</p>
</sec>
<sec id="s2b2">
<title>The utility of modeling GxE for complex trait prediction</title>
<p>Modeling context dependency of genetic effects may hold the potential for constructing polygenic scores that are more accurate, or improve their portability across contexts [<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c41">41</xref>–<xref ref-type="bibr" rid="c45">45</xref>]. Evidence for the utility of GxE models in polygenic score prediction, however, has been underwhelming and GxE models are still rarely applied [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c10">10</xref>]. A key reason behind this apparent discrepancy is the bias–variance tradeoff for individual variants discussed above. If context-specific effects are similar—a likely possibility for highly polygenic traits with the majority of heritability owing to small causal effects—then additive models will tend to outperform [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c46">46</xref>, <xref ref-type="bibr" rid="c47">47</xref>]. This is because the unbiasedness of GxE estimation does not make up for the cost of additional estimator variance, resulting from sample stratification by context or the addition of explicit interaction terms [<xref ref-type="bibr" rid="c10">10</xref>].</p>
<p>We exemplify the relative importance of variance compared to bias in polygenic scoring using simulations. We continue with the generative model of pervasive amplification as an example. Namely, we simulated a GWAS of a continuous trait with independent effects in 2, 500 variants (50% of variants included in the GWAS). Effects were either the same in two contexts, A and B, or 1.4 times larger in context B. The GWAS is conducted with either a small sample size or a large sample size, conferring low or high statistical power, respectively. We then constructed polygenic scores using 833 variants (corresponding to one-third of the causal variants), which were ascertained as most significantly associated with the trait according to either the additive model (orange and red in <xref rid="fig5" ref-type="fig">Fig. 5</xref>) in or context-specific hypothesis tests (green and blue in <xref rid="fig5" ref-type="fig">Fig. 5</xref>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><title>Polygenic score performance for context-dependent prediction models.</title>
<p>In each simulation, a GWAS is performed on 5, 000 biallelic variants, half of which have no effect in either context. Of the other half, some percent of the variants (indicated on the x-axis) had effects 1.4× larger in one of contexts and the remaining SNPs had equal effects in both contexts. The broad sense heritability was set to 0.4 in all simulations. The y-axis shows the average, over 11, 000 simulations, of the out-of-sample Pearson correlation between polygenic score and trait value. <bold>(A)</bold> Results with a GWAS sample size of 1, 000 individuals. <bold>(B)</bold> Results with a GWAS size of 50, 000 individuals.</p></caption>
<graphic xlink:href="545998v4_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Even in settings with pervasive GxE, additive polygenic scores (red lines in <xref rid="fig5" ref-type="fig">Fig. 5</xref>) outperformed context-specific scores (green lines in <xref rid="fig5" ref-type="fig">Fig. 5</xref>). The advantage of the additive model is manifested in two ways: more accurate estimation, as discussed above, but also better identification of true associations with the trait. We considered the two advantages separately. It is sometimes better to ascertain variants using the lower variance approach and estimate effects using the lower-bias approach. In our simulations, this strategy (orange lines in <xref rid="fig5" ref-type="fig">Fig. 5</xref>) was preferable to using the GxE model for both ascertainment and estimation (green line). It was not preferable to using the additive model (red line) for both approaches; but it was the preferable strategy under a slightly different parametric regime, corresponding to more GxE (<xref rid="d1e1189" ref-type="supplementary-material">Fig. S4B</xref>).</p>
<p>Finally, we considered a polygenic GxE approach, as implemented in “multivariate adaptive shrinkage” (<italic>mash</italic>) [<xref ref-type="bibr" rid="c29">29</xref>], a method to estimate context-specific effects by leveraging common patterns of effect covariance between contexts observed across the genome. <italic>mash</italic> models the underlying distribution of effects in all contexts as a mixture of zero-centered Multivariate Normal distributions with different covariance structures (as well as the null matrix, to induce additional shrinkage). After estimating this distribution via maximum likelihood, <italic>mash</italic> uses it as a prior to obtain posterior effect estimates for each variant in each context. As a result, posterior effect estimates across contexts regress towards commonly observed patterns of covariance of allelic effects across contexts.</p>
<p>In our simulations, in the presence of substantial amplification, the polygenic adaptive shrinkage approach outperformed all other methods as long as the study was adequately powered (<xref rid="fig5" ref-type="fig">Fig. 5B</xref>). This is thanks to the unique ability (compared to the three other approaches) to leverage the sharing of signals across variants, including the extent and nature of context dependency. With low power, however, the additive model performed best (<xref rid="fig5" ref-type="fig">Fig. 5A</xref>). We attribute this to the variance cost associated with the polygenic adaptive shrinkage approach—driven by the estimation of additional parameters for capturing the genome-wide covariance relationships.</p>
</sec>
<sec id="s2b3">
<title>Conclusion</title>
<p>When genetic variants are considered independently, the estimation of their effects in different contexts can be boiled down to a bias-variance tradeoff. For complex traits, we show through example that further considering polygenic patterns of GxE can be key for understanding context-dependent genetic architecture and to aid in prediction. The notion that complex trait analyses should combine observations at top associated loci alongside polygenic trends has gained traction with additive models of trait variation; it may be similarly important in our understanding of context-dependency.</p>
</sec>
</sec>
</sec>

</body>
<back>
<sec id="s3">
<title>Methods</title>
<sec id="s3a">
<title>Expressing the Additive Estimator as a Linear Combination of GxE Estimators</title>
<p>In this section, we prove the result of <xref ref-type="disp-formula" rid="eqn3">Eq. 3</xref>, stating that
<disp-formula id="ueqn6">
<graphic xlink:href="545998v4_ueqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
for some non-negative weights ω<sub><italic>A</italic></sub> and ω<sub><italic>B</italic></sub>. To do this, we will need some additional notation. Let <inline-formula><inline-graphic xlink:href="545998v4_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula> denote the average number of effect alleles in individuals in context A, and let <inline-formula><inline-graphic xlink:href="545998v4_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula> denote the average effect allele count across all individuals. Similarly, let <inline-formula><inline-graphic xlink:href="545998v4_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula> denote the average trait value in context A, and let <inline-formula><inline-graphic xlink:href="545998v4_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula> denote the average trait value across all individuals.</p>
<p>As an OLS estimator, the context-specific estimator is defined as
<disp-formula id="ueqn7">
<graphic xlink:href="545998v4_ueqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Similarly, the additive estimator can be written as:
<disp-formula id="ueqn8">
<graphic xlink:href="545998v4_ueqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We will show that the weights in <xref ref-type="disp-formula" rid="eqn3">Eq. 3</xref> depend on the effect allele frequency in the two contexts, <italic>f</italic><sub><italic>A</italic></sub> and <italic>f</italic><sub><italic>B</italic></sub>. We will assume mean-centered traits, such that <inline-formula><inline-graphic xlink:href="545998v4_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula> We note that mean-centering is inconsequential for effect estimation. We can then write
<disp-formula id="ueqn10">
<graphic xlink:href="545998v4_ueqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="ueqn10a">
<graphic xlink:href="545998v4_ueqn10a.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Thus, <inline-formula><inline-graphic xlink:href="545998v4_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in <xref ref-type="disp-formula" rid="eqn3">Eq. 3</xref>. We note that the numerator of ω<sub><italic>A</italic></sub> is n times the sample heterozygozity in context A, and the numerator of ω<sub><italic>B</italic></sub> is m times the sample heterozygozity in context B. Thus, we have shown that
<disp-formula id="eqn7">
<graphic xlink:href="545998v4_eqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where H<sub><italic>A</italic></sub> and H<sub><italic>B</italic></sub> are the sample heterozygozities in context A and B, respectively. And, in the special case where <italic>f</italic><sub><italic>A</italic></sub> = <italic>f</italic><sub><italic>B</italic></sub>, because this implies that the sample heterozygozities will be approximately equal across contexts, we have that
<disp-formula id="eqn8">
<graphic xlink:href="545998v4_eqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</sec>
<sec id="s3b">
<title>Linearity of the decision rule</title>
<p>In <xref ref-type="disp-formula" rid="eqn5">Eq. 5</xref>, under the assumption that <italic>V</italic><sub><italic>A</italic></sub> = <italic>V</italic><sub><italic>B</italic></sub> and H<sub><italic>A</italic></sub> = H<sub><italic>B</italic></sub>, the decision boundary is expressed as a linear function of |<italic>β</italic><sub><italic>A</italic></sub> − <italic>β</italic><sub><italic>B</italic></sub>| and <inline-formula><inline-graphic xlink:href="545998v4_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as
<disp-formula id="ueqn10b">
<graphic xlink:href="545998v4_ueqn10b.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here, we prove that the linearity of the decision rule holds in the more general case where <inline-formula><inline-graphic xlink:href="545998v4_inline31.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for some fixed value of r. <xref ref-type="disp-formula" rid="eqn5">Eq. 5</xref> then follows as a special case of this fact when <italic>r</italic> = 1.</p>
<p>Starting from <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref>, we prefer the GxE estimator to the additive estimator when estimating <italic>β</italic><sub><italic>A</italic></sub> if
<disp-formula id="ueqn13">
<graphic xlink:href="545998v4_ueqn13.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
If our assumption that <inline-formula><inline-graphic xlink:href="545998v4_inline34.gif" mime-subtype="gif" mimetype="image"/></inline-formula> does not hold, we note that the GxE model is always preferable and technically speaking there exists no decision rule between the two models. Now, when heterozygozities (and thus minor allele frequencies) are equal across contexts, then <xref ref-type="disp-formula" rid="eqn8">Eq. 8</xref> implies <italic>ω</italic><sub><italic>A</italic></sub> + <italic>ω</italic><sub><italic>B</italic></sub> = 1. Therefore, we may write the decision rule as
<disp-formula id="ueqn14">
<graphic xlink:href="545998v4_ueqn14.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here, we see that for any fixed <italic>r</italic> the decision rule is linear with a slope determined by <italic>r</italic> (<xref rid="fig2" ref-type="fig">Fig. 2</xref>). Now, in the special case where <italic>r</italic> = 1, we have
<disp-formula id="ueqn15">
<graphic xlink:href="545998v4_ueqn15.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="ueqn15a">
<graphic xlink:href="545998v4_ueqn15a.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Now, substituting the definitions of ω<sub><italic>A</italic></sub> and ω<sub><italic>B</italic></sub> in the case of equal minor allele frequencies given in <xref ref-type="disp-formula" rid="eqn8">Eq. 8</xref>, we can write
<disp-formula id="ueqn16">
<graphic xlink:href="545998v4_ueqn16.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
This inequality is instead an equality under the conditions stated in <xref ref-type="disp-formula" rid="eqn5">Eq. 5</xref>. Finally, again using the definition of <italic>ω</italic><sub><italic>A</italic></sub> and ω<sub><italic>B</italic></sub> given in <xref ref-type="disp-formula" rid="eqn8">Eq. 8</xref>, we note that our assumption that <inline-formula><inline-graphic xlink:href="545998v4_inline36.gif" mime-subtype="gif" mimetype="image"/></inline-formula> will always hold in the case of equal minor allele frequencies and <italic>r</italic> = 1, as
<disp-formula id="ueqn17">
<graphic xlink:href="545998v4_ueqn17.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
which is strictly positive.</p>
</sec>
<sec id="s3c">
<title>Re-parameterized decision rule in terms of unitless quantities</title>
<p>In <xref ref-type="disp-formula" rid="eqn6">Eq. 6</xref>, under the assumption that H<sub><italic>A</italic></sub> = H<sub><italic>B</italic></sub>, we re-state the decision rule in terms of the signal-to-noise ratio. Here, we prove this result.</p>
<p>From <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref>, we have that we should select the GxE model to estimate <italic>β</italic><sub><italic>A</italic></sub> if and only if
<disp-formula id="ueqn18">
<graphic xlink:href="545998v4_ueqn18.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Now, because H<sub><italic>A</italic></sub> = H<sub><italic>B</italic></sub>, we know by <xref ref-type="disp-formula" rid="eqn8">Eq. 8</xref> that ω<sub><italic>A</italic></sub> + ω<sub><italic>B</italic></sub> = 1. Then, we may write the decision rule as
<disp-formula id="ueqn19">
<graphic xlink:href="545998v4_ueqn19.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<disp-formula id="ueqn19a">
<graphic xlink:href="545998v4_ueqn19a.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
as is stated in <xref ref-type="disp-formula" rid="eqn6">Eq. 6</xref>.</p>
</sec>
<sec id="s3d">
<title>Simulation of GxDiet effects on longevity in Drosophila</title>
<p>In <xref rid="fig4" ref-type="fig">Fig. 4</xref>, we compare the effect estimates of Pallares et al. to ones we got in simulations of pervasive amplification. Here, we detail the simulation approach.</p>
<p>We first generated true effects under each diet. For variants j = 1, …, 50, 000, we sampled a true effect under the high-sugar diet <inline-formula><inline-graphic xlink:href="545998v4_inline36a.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and under the control diet <inline-formula><inline-graphic xlink:href="545998v4_inline36b.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. A random 60% of variants were set to have no effect under either diet, with the effects of the remaining 40% of variants sampled as
<disp-formula id="ueqn20">
<graphic xlink:href="545998v4_ueqn20.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
This corresponds to a systematic amplification of 1.4× in the high-sugar compared to the control diet. We selected these parameters based on inspection of the resulting distribution of effects and their correspondence to the Pallares et al. data.</p>
<p>We then simulated the effect estimation. For each variant, the effect estimate was simulated as Normally distributed with mean equal to the true effect and standard deviation equal to a randomly sampled (with replacement) standard error from the effect estimates of Pallares et al. That is, given the simulated values of the true effect estimates <inline-formula><inline-graphic xlink:href="545998v4_inline36c.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline36d.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, we simulated effect estimates as
<disp-formula id="ueqn21">
<graphic xlink:href="545998v4_ueqn21.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where k represents the index of a randomly selected variant from the empirical data of Pallares et al. and <inline-formula><inline-graphic xlink:href="545998v4_inline38.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline39.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are the corresponding estimated standard errors for the effect estimates in the control and high-sugar groups, respectively. This process yielded vectors of estimated effects in the high-sugar group and control group, <inline-formula><inline-graphic xlink:href="545998v4_inline40.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline41.gif" mime-subtype="gif" mimetype="image"/></inline-formula> respectively, and vectors of estimated standard errors in the high-sugar group and control group, <inline-formula><inline-graphic xlink:href="545998v4_inline42.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline43.gif" mime-subtype="gif" mimetype="image"/></inline-formula> respectively. We then performed a Z-test for each variant under each diet, yielding two vectors of p-values, <bold><italic>p</italic></bold><sub><italic>h</italic></sub> and <bold><italic>p</italic></bold><sub><italic>c</italic></sub>, corresponding to the high-sugar and control diets, respectively.</p>
<p>Using these p-values, we followed a similar approach to Pallares et al. to classify the variants (<xref rid="fig4" ref-type="fig">Fig. 4D</xref>). First, as in Pallares et al., we computed q-values separately for each diet [<xref ref-type="bibr" rid="c48">48</xref>], yielding <bold><italic>q</italic></bold><sub><italic>h</italic></sub> and <bold><italic>q</italic></bold><sub><italic>c</italic></sub>, corresponding to the q-values of non-zero effects in the high-sugar and control diets, respectively. Then, we employed the following classification scheme for each variant j = 1, …, 50, 000:</p>
<list list-type="order">
<list-item><p>if <inline-formula><inline-graphic xlink:href="545998v4_inline44.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline45.gif" mime-subtype="gif" mimetype="image"/></inline-formula> classify as <italic>no effect</italic>.</p></list-item>
<list-item><p>if <inline-formula><inline-graphic xlink:href="545998v4_inline46.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline47.gif" mime-subtype="gif" mimetype="image"/></inline-formula> classify as <italic>high-sugar specific effect</italic>.</p></list-item>
<list-item><p>if <inline-formula><inline-graphic xlink:href="545998v4_inline48.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline49.gif" mime-subtype="gif" mimetype="image"/></inline-formula> classify as <italic>control specific effect</italic>.</p></list-item>
<list-item><p>if <inline-formula><inline-graphic xlink:href="545998v4_inline50.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline51.gif" mime-subtype="gif" mimetype="image"/></inline-formula> classify as <italic>shared effect</italic>.</p></list-item>
</list>
<p>We note that p-value and q-value cutoffs used are nominally different than those used in the Pallares et al. study.</p>
</sec>
<sec id="s3e">
<title>Polygenic Score Simulations</title>
<p>In <xref rid="fig5" ref-type="fig">Fig. 5</xref>, we show the results of multiple simulations where we compute polygenic scores in each of two contexts under amplification. Here, we detail the generation of data in the simulations and the methods for constructing polygenic scores.</p>
<p>As in <bold>Results and Discussion</bold>, we assumed that we have n + m observations of a continuous trait, where the first n individuals are observed in context A and the final m are observed in context B. For convenience, in this case we assumed n = m. Now, for variants j = 1, …, p we generated true effects in contexts A and B independently from the mixture model
<disp-formula id="ueqn22">
<graphic xlink:href="545998v4_ueqn22.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where π<sub>0</sub> (which we set to 0.5) represents the proportion of SNPs with null effects in both contexts, α represents the proportion of non-null SNPs which have exactly equal effects in both contexts, and 1 − α is the proportion of non-null SNPs which are generated as perfectly correlated but with 1.5× the standard deviation in context A. Let <inline-formula><inline-graphic xlink:href="545998v4_inline52.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline53.gif" mime-subtype="gif" mimetype="image"/></inline-formula> represent the resulting p-vectors of true effects for contexts <italic>A</italic> and <italic>B</italic>, respectively.</p>
<p>Next, we generated genotype counts for each of the n + m individuals at all p variants. Specifically, we independently generated genotypes as
<disp-formula id="ueqn23">
<graphic xlink:href="545998v4_ueqn23.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>f</italic><sub><italic>j</italic></sub> is the minor allele frequency at variant j in the population, <italic>s</italic><sub>1</sub> and <italic>s</italic><sub>2</sub> are parameters controlling the distribution of minor allele freqeuncies in the population, and g<sub><italic>ij</italic></sub> is the observed genotype for individual i at variant j. Here, we set <italic>s</italic><sub>1</sub> = 1 and <italic>s</italic><sub>2</sub> = 5. Let <bold><italic>G</italic></bold><sub><italic>A</italic></sub> and <bold><italic>G</italic></bold><sub><italic>B</italic></sub> represent the generated <italic>n</italic> × <italic>p</italic> matrices of genotypes in contexts A and B, respectively.</p>
<p>Finally, we generated the observed continuous traits for context <inline-formula><inline-graphic xlink:href="545998v4_inline54.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and context <inline-formula><inline-graphic xlink:href="545998v4_inline55.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as
<disp-formula id="ueqn24">
<graphic xlink:href="545998v4_ueqn24.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="545998v4_inline56.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline57.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are the observation variances in contexts A and B, respectively, and <italic>I</italic><sub><italic>w</italic></sub> is the <italic>w</italic> × <italic>w</italic> identity matrix. In our simulations, we set <inline-formula><inline-graphic xlink:href="545998v4_inline58.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline59.gif" mime-subtype="gif" mimetype="image"/></inline-formula> such that the narrow sense heritability is 40% in each context. So that we may later test the accuracy of our polygenic scores, we generated both a training set (consisting of n individuals in each context, where n = 1, 000 in the low power simulation and n = 50, 000 in the high power simulation) for effect estimation and a test set (consisting of 3, 000 individuals in each context) using the above distributions.</p>
<p><xref rid="fig5" ref-type="fig">Fig. 5</xref> compares four distinct approaches for constructing polygenic scores, derived from three allelic effect estimation approaches: additive estimation with shrinkage, GxE estimation with shrinkage and <italic>mash</italic>. First, the additive and GxE estimates are derived independently for each variant as described in <bold>Results and Discussion</bold>. Let <inline-formula><inline-graphic xlink:href="545998v4_inline60.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline61.gif" mime-subtype="gif" mimetype="image"/></inline-formula> be the p-vectors of GxE estimates of effects in context A and B, respectively. Similarly, let <inline-formula><inline-graphic xlink:href="545998v4_inline62.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline63.gif" mime-subtype="gif" mimetype="image"/></inline-formula> be the p-vectors of the standard errors of GxE estimates of effects in context A and B, respectively. Finally, let <inline-formula><inline-graphic xlink:href="545998v4_inline64.gif" mime-subtype="gif" mimetype="image"/></inline-formula> be the p-vector of estimated effects from the additive model and be the p-vector of standard errors of estimated effects from the additive model. Using the GxE estimates, we also constructed estimates of the effects in each context using <italic>mash</italic>. Specifically, we ran mash on the n × 2 matrices <inline-formula><inline-graphic xlink:href="545998v4_inline65.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (of effects) and <inline-formula><inline-graphic xlink:href="545998v4_inline66.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (of standard errors). <italic>mash</italic> then yields <inline-formula><inline-graphic xlink:href="545998v4_inline67.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline68.gif" mime-subtype="gif" mimetype="image"/></inline-formula> the posterior distributions of the effects in contexts A and B, respectively.</p>
<p>To construct each polygenic score, we made two choices. First, a choice between the three sets of p-values (or pseudo p-values, see below) for thresholding—we include the 833 (corresponding to one-third of the causal variants) most significant variants in the polygenic score. The second choice was between the three sets of effect estimates to be used as weights in the polygenic score (<xref rid="fig5" ref-type="fig">Fig. 5</xref>). For instance, when the GxE model was used for ascertainment, we selected the set of variants Ω<sub><italic>A</italic></sub> ⊂ {1, …, p} consisting of the variants with the 833 smallest p-values and Ω<sub><italic>B</italic></sub> ⊂ {1, …, p} consisting of the variants with the 833 smallest p-values (derived from <inline-formula><inline-graphic xlink:href="545998v4_inline69.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="545998v4_inline70.gif" mime-subtype="gif" mimetype="image"/></inline-formula>). Then, we predicted trait values (out of sample) by multiplying the effect estimates of our chosen “estimation method” (for <italic>mash</italic> we use the posterior mean) by the effect allele count at each of the selected variants for the individual in question.</p>
</sec>
</sec>
<ack>
<title>Acknowledgements</title>
<p>We thank Doc Edge, Marc Feldman, Mark Kirkpatrick, Molly Przeworski, Anil Raj, Elliot Tucker-Drob and members of the Harpak Lab for comments on the manuscript. We thank Peter Andolfatto, Julien Ayroles and Tom Juenger for helpful discussions. All authors were supported by NIH R35GM151108 to A.H. S.P. Smith was also supported by NIH RF1AG073593. This study was conducted using the UK Biobank resource under application 61666, as approved by the University of Texas at Austin institutional review board (protocol 2019-02-0125).</p>
</ack>
<sec id="suppd1e1198" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="d1e1189">
<label>Supplementary Materials</label>
<media xlink:href="supplements/545998_file02.pdf"/>
</supplementary-material>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>El-Soda</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Malosetti</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Zwaan</surname>, <given-names>B. J.</given-names></string-name>, <string-name><surname>Koornneef</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Aarts</surname>, <given-names>M. G.</given-names></string-name></person-group> <article-title>Genotype× environment interaction QTL mapping in plants: lessons from Arabidopsis</article-title>. <source>Trends in plant science</source> <volume>19</volume>, <fpage>390</fpage>–<lpage>398</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Vieira</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Genotype-environment interaction for quantitative trait loci affecting life span in Drosophila melanogaster</article-title>. <source>Genetics</source> <volume>154</volume>, <fpage>213</fpage>–<lpage>227</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Des Marais</surname>, <given-names>D. L.</given-names></string-name>, <string-name><surname>Hernandez</surname>, <given-names>K. M.</given-names></string-name> &amp; <string-name><surname>Juenger</surname>, <given-names>T. E.</given-names></string-name></person-group> <article-title>Genotype-by-environment interaction and plasticity: exploring genomic responses of plants to the abiotic environment</article-title>. <source>Annual Review of Ecology, Evolution, and Systematics</source> <volume>44</volume>, <fpage>5</fpage>–<lpage>29</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Smith</surname>, <given-names>E. N.</given-names></string-name> &amp; <string-name><surname>Kruglyak</surname>, <given-names>L.</given-names></string-name></person-group> <article-title>Gene–environment interaction in yeast gene expression</article-title>. <source>PLoS biology</source> <volume>6</volume>, <fpage>e83</fpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paaby</surname>, <given-names>A. B.</given-names></string-name> &amp; <string-name><surname>Rockman</surname>, <given-names>M. V.</given-names></string-name></person-group> <article-title>Cryptic genetic variation: evolution’s hidden substrate</article-title>. <source>Nature Reviews Genetics</source> <volume>15</volume>, <fpage>247</fpage>–<lpage>258</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Munafó</surname>, <given-names>M. R.</given-names></string-name>, <string-name><surname>Zammit</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Flint</surname>, <given-names>J.</given-names></string-name></person-group> <article-title>Practitioner Review: A critical perspective on gene–environment interaction models–what impact should they have on clinical perceptions and practice?</article-title> <source>Journal of child Psychology and Psychiatry</source> <volume>55</volume>, <fpage>1092</fpage>–<lpage>1101</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kraft</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Aschard</surname>, <given-names>H.</given-names></string-name></person-group> <article-title>Finding the missing gene–environment interactions</article-title>. <source>European Journal of Epidemiology</source> <volume>30</volume>, <fpage>353</fpage>–<lpage>355</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sella</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Barton</surname>, <given-names>N. H.</given-names></string-name></person-group> <article-title>Thinking about the evolution of complex traits in the era of genome-wide association studies</article-title>. <source>Annual Review of Genomics and Human Genetics</source> <volume>20</volume>, <fpage>461</fpage>–<lpage>493</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhu</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Amplification is the primary mode of gene-by-sex interaction in complex human traits</article-title>. <source>Cell Genomics</source> (<year>2023</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Schwaba</surname>, <given-names>T.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Comparison of the Multivariate Genetic Architecture of Eight Major Psychiatric Disorders Across Sex</article-title>. <source>medRxiv</source> (<year>2023</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Elgart</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Correlations between complex human phenotypes vary by genetic background, gender, and environment</article-title>. <source>Cell Reports Medicine</source> <volume>3</volume>, <fpage>100844</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Duncan</surname>, <given-names>L. E.</given-names></string-name> &amp; <string-name><surname>Keller</surname>, <given-names>M. C.</given-names></string-name></person-group> <article-title>A critical review of the first 10 years of candidate gene-by-environment interaction research in psychiatry</article-title>. <source>American Journal of Psychiatry</source> <volume>168</volume>, <fpage>1041</fpage>–<lpage>1049</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gibson</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Lacek</surname>, <given-names>K. A.</given-names></string-name></person-group> <article-title>Canalization and robustness in human genetics and disease</article-title>. <source>Annual Review of Genetics</source> <volume>54</volume>, <fpage>189</fpage>–<lpage>211</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Brown</surname>, <given-names>B. C.</given-names></string-name>, <string-name><surname>Ye</surname>, <given-names>C. J.</given-names></string-name>, <string-name><surname>Price</surname>, <given-names>A. L.</given-names></string-name>, <string-name><surname>Zaitlen</surname>, <given-names>N.</given-names></string-name>, <collab>Consortium, A. G. E. N. T. 2. D.</collab>, <etal>et al.</etal></person-group> <article-title>Transethnic genetic-correlation estimates from summary statistics</article-title>. <source>The American Journal of Human Genetics</source> <volume>99</volume>, <fpage>76</fpage>–<lpage>88</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ge</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>C.-Y.</given-names></string-name>, <string-name><surname>Neale</surname>, <given-names>B. M.</given-names></string-name>, <string-name><surname>Sabuncu</surname>, <given-names>M. R.</given-names></string-name> &amp; <string-name><surname>Smoller</surname>, <given-names>J. W.</given-names></string-name></person-group> <article-title>Phenome-wide heritability analysis of the UK Biobank</article-title>. <source>PLoS Genetics</source> <volume>13</volume>, <fpage>e1006711</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Balliu</surname>, <given-names>B.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>An integrated approach to identify environmental modulators of genetic risk factors for complex traits</article-title>. <source>The American Journal of Human Genetics</source> <volume>108</volume>, <fpage>1866</fpage>–<lpage>1879</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Veller</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Przeworski</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Coop</surname>, <given-names>G.</given-names></string-name></person-group> <article-title>Causal interpretations of family GWAS in the presence of heterogeneous effects</article-title>. <source>bioRxiv</source>, <fpage>2023</fpage>–<lpage>11</lpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Fisher</surname>, <given-names>R. A.</given-names></string-name></person-group> <source>The genetical theory of natural selection</source> (<publisher-name>Clarendon Press</publisher-name>, <year>1930</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Falconer</surname>, <given-names>D. S.</given-names></string-name> &amp; <string-name><surname>Mackay</surname>, <given-names>T. F.</given-names></string-name></person-group> <source>Introduction to quantitative genetics</source> (<publisher-loc>Longman</publisher-loc>, <year>1996</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yengo</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>A saturated map of common genetic variants associated with human height</article-title>. <source>Nature</source> <volume>610</volume>, <fpage>704</fpage>–<lpage>712</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zwick</surname>, <given-names>M. E.</given-names></string-name>, <string-name><surname>Cutler</surname>, <given-names>D. J.</given-names></string-name> &amp; <string-name><surname>Chakravarti</surname>, <given-names>A.</given-names></string-name></person-group> <article-title>Patterns of genetic variation in Mendelian and complex traits</article-title>. <source>Annual Review of Genomics and Human Genetics</source> <volume>1</volume>, <fpage>387</fpage>–<lpage>407</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Casella</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Berger</surname>, <given-names>R. L.</given-names></string-name></person-group> <source>Statistical Inference</source>, (<year>2021</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bycroft</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>The UK Biobank resource with deep phenotyping and genomic data</article-title>. <source>Nature</source> <volume>562</volume>, <fpage>203</fpage>–<lpage>209</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sinnott-Armstrong</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Naqvi</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Rivas</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Pritchard</surname>, <given-names>J. K.</given-names></string-name></person-group> <article-title>GWAS of three molecular traits high-lights core genes and pathways alongside a highly polygenic background</article-title>. <source>eLife</source> <volume>10</volume>, <elocation-id>e58615</elocation-id> (<year>2021</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shi</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Kichaev</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Pasaniuc</surname>, <given-names>B.</given-names></string-name></person-group> <article-title>Contrasting the genetic architecture of 30 complex traits from summary association data</article-title>. <source>The American Journal of Human Genetics</source> <volume>99</volume>, <fpage>139</fpage>–<lpage>153</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyle</surname>, <given-names>E. A.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>Y. I.</given-names></string-name> &amp; <string-name><surname>Pritchard</surname>, <given-names>J. K.</given-names></string-name></person-group> <article-title>An expanded view of complex traits: from polygenic to omnigenic</article-title>. <source>Cell</source> <volume>169</volume>, <fpage>1177</fpage>–<lpage>1186</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Liu</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>Y. I.</given-names></string-name> &amp; <string-name><surname>Pritchard</surname>, <given-names>J. K.</given-names></string-name></person-group> <article-title>Trans effects on gene expression can drive omnigenic inheritance</article-title>. <source>Cell</source> <volume>177</volume>, <fpage>1022</fpage>–<lpage>1034</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wray</surname>, <given-names>N. R.</given-names></string-name>, <string-name><surname>Wijmenga</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Sullivan</surname>, <given-names>P. F.</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Visscher</surname>, <given-names>P. M.</given-names></string-name></person-group> <article-title>Common disease is more complex than implied by the core gene omnigenic model</article-title>. <source>Cell</source> <volume>173</volume>, <fpage>1573</fpage>–<lpage>1580</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Urbut</surname>, <given-names>S. M.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Carbonetto</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Stephens</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Flexible statistical methods for estimating and testing effects in genomic studies with multiple conditions</article-title>. <source>Nature Genetics</source> <volume>51</volume>, <fpage>187</fpage>–<lpage>195</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Zhang</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>QTL× environment interactions underlie ionome divergence in switchgrass</article-title>. <source>G3</source> <volume>11</volume>, <fpage>jkab144</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Paaby</surname>, <given-names>A. B.</given-names></string-name> &amp; <string-name><surname>Gibson</surname>, <given-names>G.</given-names></string-name></person-group> <article-title>Cryptic genetic variation in evolutionary developmental genetics</article-title>. <source>Biology</source> <volume>5</volume>, <fpage>28</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Aschard</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Evidence for large-scale gene-by-smoking interaction effects on pulmonary function</article-title>. <source>International journal of epidemiology</source> <volume>46</volume>, <fpage>894</fpage>–<lpage>904</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gibson</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Dworkin</surname>, <given-names>I.</given-names></string-name></person-group> <article-title>Uncovering cryptic genetic variation</article-title>. <source>Nature Reviews Genetics</source> <volume>5</volume>, <fpage>681</fpage>–<lpage>690</lpage> (<year>2004</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Miao</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Reimagining gene-environment interaction analysis for human complex traits</article-title>. <source>bioRxiv</source>, <fpage>2022</fpage>–<lpage>12</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spierer</surname>, <given-names>A. N.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Natural variation in the regulation of neurodevelopmental genes modifies flight performance in Drosophila</article-title>. <source>PLoS Genetics</source> <volume>17</volume>, <fpage>e1008887</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Traglia</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Bout</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Weiss</surname>, <given-names>L. A.</given-names></string-name></person-group> <article-title>Sex-heterogeneous SNPs disproportionately influence gene expression and health</article-title>. <source>PLoS Genetics</source> <volume>18</volume>, <fpage>e1010147</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bernabeu</surname>, <given-names>E.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Sex differences in genetic architecture in the UK Biobank</article-title>. <source>Nature Genetics</source> <volume>53</volume>, <fpage>1283</fpage>–<lpage>1289</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wright</surname>, <given-names>K. M.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Age and diet shape the genetic architecture of body weight in diversity outbred mice</article-title>. <source>eLife</source> <volume>11</volume>, <elocation-id>e64329</elocation-id> (<year>2022</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Pallares</surname>, <given-names>L. F.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Dietary stress remodels the genetic architecture of lifespan variation in outbred Drosophila</article-title>. <source>Nature Genetics</source>, <fpage>1</fpage>–<lpage>7</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Young</surname>, <given-names>A. I.</given-names></string-name>, <string-name><surname>Wauthier</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Donnelly</surname>, <given-names>P.</given-names></string-name></person-group> <article-title>Multiple novel gene-by-environment interactions modify the effect of FTO variants on body mass index</article-title>. <source>Nature communications</source> <volume>7</volume>, <fpage>12724</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mostafavi</surname>, <given-names>H.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Variable prediction accuracy of polygenic scores within an ancestry group</article-title>. <source>eLife</source> <volume>9</volume>, <elocation-id>e48376</elocation-id> (<year>2020</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Patel</surname>, <given-names>R. A.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Genetic interactions drive heterogeneity in causal variant effect sizes for gene expression and complex traits</article-title>. <source>The American Journal of Human Genetics</source> <volume>109</volume>, <fpage>1286</fpage>–<lpage>1297</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Turley</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Multi-trait analysis of genome-wide association summary statistics using MTAG</article-title>. <source>Nature Genetics</source> <volume>50</volume>, <fpage>229</fpage>–<lpage>237</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Spence</surname>, <given-names>J. P.</given-names></string-name>, <string-name><surname>Sinnott-Armstrong</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Assimes</surname>, <given-names>T.</given-names></string-name> &amp; <string-name><surname>Pritchard</surname>, <given-names>J. K.</given-names></string-name></person-group> <article-title>A flexible modeling and inference framework for estimating variant effect sizes from GWAS summary statistics</article-title>. <source>bioRxiv</source>, <fpage>2022</fpage>–<lpage>04</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Wang</surname>, <given-names>J. Y.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Three Open Questions in Polygenic Score Portability</article-title>. <source>bioRxiv</source> (<year>2024</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hill</surname>, <given-names>W. G.</given-names></string-name>, <string-name><surname>Goddard</surname>, <given-names>M. E.</given-names></string-name> &amp; <string-name><surname>Visscher</surname>, <given-names>P. M.</given-names></string-name></person-group> <article-title>Data and theory point to mainly additive genetic variance for complex traits</article-title>. <source>PLoS Genetics</source> <volume>4</volume>, <fpage>e1000008</fpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Young</surname>, <given-names>A. I.</given-names></string-name></person-group> <article-title>Solving the missing heritability problem</article-title>. <source>PLoS Genetics</source> <volume>15</volume>, <fpage>e1008222</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Storey</surname>, <given-names>J. D.</given-names></string-name></person-group> <article-title>The positive false discovery rate: a Bayesian interpretation and the q-value</article-title>. <source>The Annals of Statistics</source> <volume>31</volume>, <fpage>2013</fpage>–<lpage>2035</lpage> (<year>2003</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99210.2.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Perry</surname>
<given-names>George H</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Pennsylvania State University</institution>
</institution-wrap>
<city>University Park</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Fundamental</kwd>
</kwd-group>
</front-stub>
<body>
<p>It is known from model organisms that genes' effects on traits are often modulated by environmental variables, but similar gene-by-environment (GxE) interactions have been difficult to detect using statistical analyses of genomic data, e.g., in humans. This study introduces a new framework to estimate gene-by-environment effects, treating it as a bias-variance tradeoff problem. The authors <bold>convincingly</bold> show that greater statistical power can be achieved in detecting GxE if an underlying model of polygenic GxE is assumed. This polygenic amplification model is a truly novel view with <bold>fundamental</bold> promise for the detection of GxE in genomic datasets, especially with continued development to detect more complex signals of amplification.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99210.2.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Experiments in model organisms have revealed that the effects of genes on heritable traits are often mediated by environmental factors -- so-called gene-by-environment (or GxE) interactions. In human genetics, however, where indirect statistical approaches must be taken to detect GxE, limited evidence has been found for pervasive GxE interactions. The present manuscript argues that the failure of statistical methods to detect GxE may be due to how GxE is modelled (or not modelled) by these methods.</p>
<p>The authors show, via re-analysis of an existing dataset in Drosophila, that a polygenic 'amplification' model can parsimoniously explain patterns of differential genetic effects across environments. (Work from the same lab had previously shown that the amplification model is consistent with differential genetic effects across the sexes for a number of traits in humans.) The parsimony of the amplification model allows for powerful detection of GxE in scenarios in which it pertains, as the authors show via simulation.</p>
<p>Before the authors consider polygenic models of GxE, however, they present a very clear analysis of a related question around GxE: When one wants to estimate the effect of an individual allele in a particular environment, when is it better to stratify one's sample by environment (reducing sample size, and therefore increasing the variance of the estimator) versus using the entire sample (including individuals not in the environment of interest, and therefore biasing the estimator away from the true effect specific to the environment of interest)? Intuitively, the sample-size cost of stratification is worth paying if true allelic effects differ substantially between the environment of interest and other environments (i.e., GxE interactions are large), but not worth paying if effects are similar across environments. The authors quantify this trade-off in a way that is both mathematically precise and conveys the above intuition very clearly. They argue on its basis that, when allelic effects are small (as in highly polygenic traits), single-locus tests for GxE may be substantially underpowered.</p>
<p>The paper is an important further demonstration of the plausibility of the amplification model of GxE, which, given its parsimony, holds substantial promise for the detection and characterization of GxE in genomic datasets. However, the empirical and simulation examples considered in the paper (and previous work from the same lab) are somewhat &quot;best-case&quot; scenarios for the amplification model, with only two environments and with these environments amplifying equally the effects of only a single set of genes. It would be an important step forward to demonstrate the possibility of detecting amplification in more complex scenarios, with multiple environments each differentially modulating the effects of multiple sets of genes. This could be achieved via simulations similar to those presented in the current manuscript.</p>
<p>Comments on revisions:</p>
<p>The authors have (with reasonable justification) said that my main recommendations for strengthening the conclusions of the paper are beyond its scope, and they have thoughtfully responded to my (and the other reviewer's) other comments. The paper is now more clearly written---in particular, the connection between the single-locus bias-variance tradeoff calculations and the polygenic results is much more transparent than before. Given that the authors have (again, with fair justification) chosen not to address my major comment, my broad assessment of the paper is unchanged---I think it is an important contribution to a critical topic---and I have no further comments for its improvement (though I note an issue with figure referencing in the captions of Supplementary Figs S2 and S3).</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.99210.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Weine</surname>
<given-names>Eric</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Smith</surname>
<given-names>Samuel Pattillo</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-6269-0276</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Knowlton</surname>
<given-names>Rebecca Kathryn</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Harpak</surname>
<given-names>Arbel</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-3655-748X</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews:</bold></p>
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>Experiments in model organisms have revealed that the effects of genes on heritable traits are often mediated by environmental factors---so-called gene-by-environment (or GxE) interactions. In human genetics, however, where indirect statistical approaches must be taken to detect GxE, limited evidence has been found for pervasive GxE interactions. The present manuscript argues that the failure of statistical methods to detect GxE may be due to how GxE is modelled (or not modelled) by these methods.</p>
<p>The authors show, via re-analysis of an existing dataset in Drosophila, that a polygenic ‘amplification’ model can parsimoniously explain patterns of differential genetic effects across environments. (Work from the same lab had previously shown that the amplification model is consistent with differential genetic effects across the sexes for several traits in humans.) The parsimony of the amplification model allows for powerful detection of GxE in scenarios in which it pertains, as the authors show via simulation.</p>
<p>Before the authors consider polygenic models of GxE, however, they present a very clear analysis of a related question around GxE: When one wants to estimate the effect of an individual allele in a particular environment, when is it better to stratify one’s sample by environment (reducing sample size, and therefore increasing the variance of the estimator) versus using the entire sample (including individuals not in the environment of interest, and therefore biasing the estimator away from the true effect specific to the environment of interest)? Intuitively, the sample-size cost of stratification is worth paying if true allelic effects differ substantially between the environment of interest and other environments (i.e., GxE interactions are large), but not worth paying if effects are similar across environments. The authors quantify this trade-off in a way that is both mathematically precise and conveys the above intuition very clearly. They argue on its basis that, when allelic effects are small (as in highly polygenic traits), single-locus tests for GxE may be substantially underpowered.</p>
<p>The paper is an important further demonstration of the plausibility of the amplification model of GxE, which, given its parsimony, holds substantial promise for the detection and characterization of GxE in genomic datasets. However, the empirical and simulation examples considered in the paper (and previous work from the same lab) are somewhat “best-case” scenarios for the amplification model, with only two environments, and with these environments amplifying equally the effects of only a single set of genes. It would be an important step forward to demonstrate the possibility of detecting amplification in more complex scenarios, with multiple environments each differentially modulating the effects of multiple sets of genes. This could be achieved via simulations similar to those presented in the current manuscript.</p>
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>Summary:</p>
<p>Wine et al. describe a framework to view the estimation of gene-context interaction analysis through the lens of bias-variance tradeoff. They show that, depending on trait variance and context-specific effect sizes, effect estimates may be estimated more accurately in context-combined analysis rather than in context-specific analysis. They proceed by investigating, primarily via simulations, implications for the study or utilization of gene-context interaction, for testing and prediction, in traits with polygenic architecture. First, the authors describe an assessment of the identification of context-specificity (or context differences) focusing on “top hits” from association analyses. Next, they describe an assessment of polygenic scores (PGSs) that account for context-specific effect sizes, showing, in simulations, that often the PGSs that do not attempt to estimate context-specific effect sizes have superior prediction performance. An exception is a PGS approach that utilizes information across contexts. Strengths:</p>
<p>The bias-variance tradeoff framing of GxE is useful, interesting, and rigorous. The PGS analysis under pervasive amplification is also interesting and demonstrates the bias-variance tradeoff.</p>
<p>Weaknesses:</p>
<p>The weakness of this paper is that the first part -- the bias-variance tradeoff analysis -- is not tightly connected to, i.e. not sufficiently informing, the later parts, that focus on polygenic architecture. For example, the analysis of “top hits” focuses on the question of testing, rather than estimation, and testing was not discussed within the bias-variance tradeoff framework. Similarly, while the PGS analysis does demonstrate (well) the bias-variance tradeoff, the reader is left to wonder whether a bias-variance deviation rule (discussed in the first part of the manuscript) should or could be utilized for PGS construction.</p>
</disp-quote>
<p>We thank the editors and the reviewers for their thoughtful critique and helpful suggestions throughout. In our revision, we focused on tightening the relationship between the analytical single variant bias-variance tradeoff derivation and the various empirical analyses that follow.</p>
<p>We improved discussion of our scope and what is beyond our scope. For example, our language was insufficiently clear if it suggested to the editor and reviewers that we are developing a method to characterize polygenic GxE. Developing a new method that does so (let alone evaluating performance across various scenarios) is beyond the scope of this manuscript.</p>
<p>Similarly, we clarify that we use amplification only as an example of a mode of GxE that is not adequately characterized by current approaches. We do not wish to argue it is an omnibus explanation for all GxE in complex traits. In many cases, a mixture of polygenic GxE relationships seems most fitting (as observed, for example, in Zhu et al., 2023, for GxSex in human physiology).</p>
<disp-quote content-type="editor-comment">
<p><bold>Recommendations for the authors:</bold></p>
<p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p>
<p>MAJOR COMMENT</p>
<p>The amplification model is based on an understanding of gene networks in which environmental variables concertedly alter the effects of clusters of genes, or modules, in the network (e.g., if an environmental variable alters the effect of some gene, it indirectly and proportionately alters the effects of genes downstream of that gene in the network---or upstream if the gene acts as a bottleneck in some pathway). It is clear in this model that (i) multiple environmental variables could amplify distinct modules, and (ii) a single environmental variable could itself amplify multiple separate modules, with a separate amplification factor for each module.</p>
<p>However, perhaps inspired by their previous work on GxSex interactions in humans, the authors’ focus in the present manuscript is on cases where there are only two environments (“control” and “high-sugar diet” in the Drosophila dataset that they reanalyze, and “A” and “B” in their simulations [and single-locus mathematical analysis]), and they consider models where these environments amplify only a single set of genes, i.e., with a single amplification factor. While it is of course interesting that a single-amplification-factor model can generate data that resemble those in the Drosophila dataset that the authors re-analyze, most scenarios of amplification GxE will presumably be more complex. It seems that detecting amplification in these more complex scenarios using methods such as the authors do in their final section will be correspondingly more difficult. Indeed, in the limit of sufficiently many environmental variables amplifying sufficiently many modules, the scenario would resemble one of idiosyncratic single-locus GxE which, as the authors argue, is very difficult to detect. That more complex scenarios of amplification, with multiple environments separately amplifying multiple modules each, might be difficult to detect statistically is potentially an important limitation to the authors’ approach, and should be tested in their simulations.</p>
</disp-quote>
<p>We agree that characterizing GxE when there is a mixture of drivers of context-dependency is difficult. Developing a method that does so across multiple (and perhaps not pre-defined) contexts is of high interest to us but beyond the scope of the current manuscript</p>
<p>We note that for GxSex, modeling this mixture does generally improve phenotypic prediction, and more so in traits where we infer amplification as a major mode of GxE.</p>
<disp-quote content-type="editor-comment">
<p>MINOR COMMENTS</p>
<p>Lines 88-90: “This estimation model is equivalent to a linear model with a term for the interaction between context and reference allele count, in the sense that context-specific allelic effect estimators have the same distributions in the two models.”</p>
<p>Does this equivalence require the model with the interaction term also to have an interaction term for the intercept, i.e., the slope on a binary variable for context (since the generative model in Eq. 1 allows for context-specific intercepts)?</p>
</disp-quote>
<p>It does require an interaction term for the intercept. This is e_i (and its effect beta_E) in Eq. S2 (line 70 of the supplement).</p>
<disp-quote content-type="editor-comment">
<p>Lines 94-96: Perhaps just a language thing, but in what sense does the estimation model described in lines 92-94 “assume” a particular distribution of trait values in the combined sample? It’s just an OLS regression, and one can analyze its expected coefficients with reference to the generative model in Eq. 1, or any other model. To say that it “assumes” something presupposes its purpose, which is not clear from its description in lines 92-94.</p>
</disp-quote>
<p>We corrected “assume” to “posit”.</p>
<disp-quote content-type="editor-comment">
<p>Lines 115-116: It should perhaps be noted that the weights wA and wB need not sum to 1.</p>
</disp-quote>
<p>Indeed; it is now explicitly stated.</p>
<disp-quote content-type="editor-comment">
<p>Lines 154-160: I think the role of r could be made even clearer by also discussing why, when VA&gt;&gt;VB, it is better to use the whole-sample estimate of betaA than the sample-A-specific estimate (since this is a more counterintuitive case than the case of VA&lt;&lt;VB discussed by the authors).</p>
</disp-quote>
<p>This is addressed in lines 153-154, stating: “Typically, this (VA&lt;&lt;VB) will also imply that the additive estimator is greatly preferable for estimating β_B , as β_B will be extremely noisy”</p>
<disp-quote content-type="editor-comment">
<p>Line 243 and Figure 4 caption: The text states that the simulated effects in the high-sugar environment are 1.1x greater than those in the control environment, while the caption states that they are 1.4x greater.</p>
</disp-quote>
<p>We have corrected the text to be consistent with our simulations.</p>
<disp-quote content-type="editor-comment">
<p>TYPOS/WORDING</p>
<p>Line 14: “harder to interpret” --&gt; “harder-to-interpret”</p>
<p>Line 22: We --&gt; we</p>
<p>Line 40: “as average effect” -&gt; “as the average effect”?</p>
<p>Line 57: “context specific” --&gt; “context-specific”</p>
<p>Line 139: “re-parmaterization” --&gt; “re-parameterization”</p>
<p>Lines 140, 158, 412: “signal to noise” --&gt; “signal-to-noise”</p>
<p>Figure 3C,D: “pule rate” --&gt; “pulse rate”</p>
<p>The caption of Figure 3: “conutinous” --&gt; “continuous”</p>
<p>Line 227: “a variant may fall” --&gt; “a variant may fall into”</p>
<p>Line 295: “conferring to more GxE” --&gt; “conferring more GxE” or “corresponding to more GxE”? This is very pedantic, but I think “bias-variance” should be “bias--variance” throughout, i.e., with an en-dash rather than a hyphen.</p>
</disp-quote>
<p>We have corrected all of the above typos.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p>
<p>(This section repeats some of what I wrote earlier).</p>
<p>- First polygenic architecture part: the manuscript focuses on “top hits” in trying to identify sets of variants that are context-specific. This “top hits” approach seems somewhat esoteric and, as written, not connected tightly enough to the bias-variance tradeoff issue. The first section of the paper which focuses on bias-variance trade-off mostly deals with estimation. The “top hits” section deals with testing, which introduces additional issues that are due to thresholding. Perhaps the authors can think of ways to make the connection stronger between the bias-variance tradeoff part to the “top hits” part, e.g., by introducing testing earlier on and/or discussion estimation in addition to testing in the “top hits” part of the manuscript. The second polygenic architecture part: polygenic scores that account for interaction terms. Here the authors focused (well, also here) on pervasive amplification in simulations. This part combines estimation and testing (both the choice of variants and their estimated effects are important). In pervasive amplification the idea is that causal variants are shared, the results may be different than in a model with context-specific effects and variant selection may have a large impact. Still, I think that these simulations demonstrate the idea developed in the bias-variance tradeoff part of the paper, though the reader is left to wonder whether a bias-variance decision rule should or could be utilized for PGS construction.</p>
</disp-quote>
<p>In both of these sections we discuss how the consideration of polygenic GxE patterns alters the conclusions based on the single-variant tradeoff. In the “top hits” section, we show that single-variant classification itself, based on a series of marginal hypothesis tests alone, can be misleading. The PGS prediction accuracy analysis shows that both approaches are beaten by the polygenic GxE estimation approach. Intuitively, this is because the consideration of polygenic GxE can mitigate both the bias and variance, as it leverages signals from many variants.</p>
<p>We agree that the links between these sections of the paper were not sufficiently clear, and have added signposting to help clarify them (lines 176-180; lines 275-277; lines 316-321).</p>
<disp-quote content-type="editor-comment">
<p>- Simulation of GxDiet effects on longevity: the methods of the simulation are strange, or communicated unclearly. The authors’ report (page 17) poses a joint distribution of genetic effects (line 439), but then, they simulated effect estimates standard errors by sampling from summary statistics (line 445) rather than simulated data and then estimating effect and effect SE. Why pose a true underlying multivariate distribution if it isn’t used?</p>
</disp-quote>
<p>We rewrote the Methods section “Simulation of GxDiet effects on longevity in Drosophila to make our simulation approach clearer (lines 427-449). We are indeed simulating the true effects from the joint distribution proposed. However, in order to mimic the noisiness of the experiment in our simulations, we sample estimated effects from the true simulated effects, with estimation noise conferring to that estimated in the Pallares et al. dataset (i.e., sampling estimation variances from the squares of empirical SEs).</p>
<disp-quote content-type="editor-comment">
<p>- How were the “most significantly associated variants” selected into the PGS in the polygenic prediction part? Based on a context-specific test? A combined-context test of effect size estimates?</p>
</disp-quote>
<p>For the “Additive” and “Additive ascertainment, GxE estimation” models (red and orange in Fig. 5, respectively), we ascertain the combined-context set. For the “GxE” and “polygenic GxE” (green and blue in Fig. 5, respectively) models, we ascertain in a context-specific test. We now state this explicitly in lines 280-288 and lines 507-526.</p>
<disp-quote content-type="editor-comment">
<p>- As stated, I find the conclusion statement not specific enough in light of the rest of the manuscript. “the consideration of polygenic GxE trends is key” - this is very vague. What does it mean “to consider polygenic GxE trends” in the context of this paper? I can’t tell. “The notion that complex trait analyses should combine observations at top associated loci” - I don’t think the authors really refer to combining “observations”, rather perhaps combine information from top associated loci. But this does not represent the “top hits” approach that merely counts loci by their testing patterns. “It may be a similarly important missing piece...” What does “it” refer to? The top loci? What makes it an important missing piece?</p>
</disp-quote>
<p>We rewrote the conclusion paragraph to address these concerns (lines 316-321).</p>
</body>
</sub-article>
</article>