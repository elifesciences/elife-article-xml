<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">96627</article-id>
<article-id pub-id-type="doi">10.7554/eLife.96627</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.96627.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.4</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Spatial periodicity in grid cell firing is explained by a neural sequence code of 2-D trajectories</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7700-4312</contrib-id>
<name>
<surname>R.G.</surname>
<given-names>Rebecca</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0964-676X</contrib-id>
<name>
<surname>Ascoli</surname>
<given-names>Giorgio A.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Sutton</surname>
<given-names>Nate M.</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0340-0128</contrib-id>
<name>
<surname>Dannenberg</surname>
<given-names>Holger</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Mathematical Sciences, George Mason University, 4400 University Dr</institution>., Fairfax, VA 22030</aff>
<aff id="a2"><label>2</label><institution>Department of Bioengineering, George Mason University, 4400 University Dr</institution>., Fairfax, VA 22030</aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Peyrache</surname>
<given-names>Adrien</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>McGill University</institution>
</institution-wrap>
<city>Montreal</city>
<country>Canada</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Colgin</surname>
<given-names>Laura L</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Texas at Austin</institution>
</institution-wrap>
<city>Austin</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label><bold>Corresponding author:</bold> Holger Dannenberg (<email>hdannenb@gmu.edu</email>)</corresp>
<fn id="n1"><p><bold>Conflicts of Interest:</bold> The authors declare no competing interests.</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-06-05">
<day>05</day>
<month>06</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP96627</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-02-16">
<day>16</day>
<month>02</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-02-17">
<day>17</day>
<month>02</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.05.30.542747"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, R.G. et al</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>R.G. et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-96627-v1.pdf"/>
<abstract>
<title>Abstract</title><p>Spatial periodicity in grid cell firing has been interpreted as a neural metric for space providing animals with a coordinate system in navigating physical and mental spaces. However, the specific computational problem being solved by grid cells has remained elusive. Here, we provide mathematical proof that spatial periodicity in grid cell firing is the only possible solution to a neural sequence code of 2-D trajectories and that the hexagonal firing pattern of grid cells is the most parsimonious solution to such a sequence code. We thereby provide a teleological cause for the existence of grid cells and reveal the underlying nature of the global geometric organization in grid maps as a direct consequence of a simple local sequence code. A sequence code by grid cells provides intuitive explanations for many previously puzzling experimental observations and may transform our thinking about grid cells.</p>
</abstract>
<kwd-group kwd-group-type="author">
<title>Keywords</title>
<kwd>grid cells</kwd>
<kwd>cell sequences</kwd>
<kwd>path integration</kwd>
<kwd>trajectory coding</kwd>
</kwd-group>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Corrected missing figure legends in Supplementary Materials.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<sec id="s1a">
<title>What is the nature of the problem being solved by grid cells?</title>
<p>Grid cells in the medial entorhinal cortex (MEC)<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref></sup> and adjacent regions such as the pre- and parasubiculum<sup><xref ref-type="bibr" rid="c3">3</xref></sup> are hypothesized to supply a “spatial metric” for cognitive map-based navigation and path integration<sup><xref ref-type="bibr" rid="c4">4</xref>–<xref ref-type="bibr" rid="c6">6</xref></sup>, episodic memory<sup><xref ref-type="bibr" rid="c7">7</xref>–<xref ref-type="bibr" rid="c9">9</xref></sup>, and navigating abstract feature spaces<sup><xref ref-type="bibr" rid="c10">10</xref>–<xref ref-type="bibr" rid="c12">12</xref></sup>. Grid cells recorded in freely foraging animals fire at multiple locations in space so that the firing fields form a hexagonal lattice (<bold><xref rid="fig1" ref-type="fig">Figures 1A – 1D</xref></bold>). Since their first discovery, the remarkable spatial periodicity in grid cell firing has been a topic of intense research<sup><xref ref-type="bibr" rid="c6">6</xref></sup>. This research was fueled in part by awe of the beautiful symmetry and complexity displayed in the spatial firing pattern of a single cell. Moreover, research efforts were driven by the hope that understanding the underlying nature of grid cell firing would greatly advance our understanding of how the mammalian brain performs navigational computations and higher cognitive functions such as episodic memory.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Spatially periodic firing of grid cells in 2-D space emerges from a neural sequence code of trajectories</title>
<p><bold>A,</bold> Schematic drawing of a 1 x 1 m<sup>2</sup> environment surrounded by walls in the presence of a single visual cue card<bold>. B,</bold> Trajectory plot visualizing grid cell spiking activity as a function of the animal’s location in space. Data obtained from the medial entorhinal cortex of a freely foraging mouse<sup><xref ref-type="bibr" rid="c42">42</xref>,<xref ref-type="bibr" rid="c75">75</xref></sup>. The black line indicates the path taken by the animal. Red dots indicate the locations where action potentials (spikes) were generated by the grid cell. <bold>C,</bold> Firing rate map of the spiking data shown in A. Data are visualized as 3 x 3 cm<sup>2</sup> spatial bins, smoothed with a Gaussian kernel. Red and blue colors indicate high and low firing rates. Peak and average firing rates are 15 and 1.9 Hz. <bold>D,</bold> Spatial autocorrelogram of the data shown in B. Red and blue colors indicate high and low correlation values. <bold>E,</bold> The animal’s current position and velocity determine the animal’s trajectory. In a sequence code, directions are represented by pairs of sequentially active cell assemblies with non-overlapping cellular composition. We refer to the individual members in a set of completely distinct cell assemblies as <italic>units</italic>. The red circle represents the currently active unit. The next active unit in the sequence code is <italic>uniquely</italic> determined by the currently active cell and the velocity vector (Definition 8). N = North, NE = Northeast, NW = Northwest, W = West, SW = Southwest, and SE = Southeast. <bold>F,</bold> Units’ firing fields that surround each other symmetrically in a hexagonal lattice packing allow for equal angular resolution in the coding of trajectories by cell sequences. Colors represent distinct units. <bold>G</bold>, If a units’ firing field was surrounded by fewer or more than six firing fields that touched each other, opposite directions would not be represented at the same angular resolution. In this example, <italic>east</italic> ◊ <italic>west</italic> cannot be distinguished from <italic>east</italic> ◊ <italic>northwest</italic> and <italic>east</italic> ◊ <italic>southwest</italic> because the three directions are represented by the same sequence of units, <italic>yellow</italic> ◊ <italic>red</italic>. However, the opposite direction, <italic>west</italic> ◊ <italic>east</italic>, is represented by three different cell sequences allowing for a finer angular resolution in the representation of traveling direction. <bold>H,</bold> Example of possible pairs of units creating a sequence code. If the sequence code shall represent all directions with equal angular resolution, the cellular composition of sequentially active cell assemblies needs to be completely distinct every 60 degrees (E and F). Possible representations of velocity vectors by sequences of two units are shown for when the currently active unit is #1 or #2. Numbers within circles identify distinct units. <bold>I,</bold> Example of a complete sequence code that uniquely represents all directions at 60 degrees resolution as a function of the currently active unit and the traveling direction. <bold>J,</bold> Sequential activation of seven distinct units can code for infinitively long trajectories along all three major axes of a hexagonal lattice. <bold>K,</bold> The same sequential activation map as in I and J but plotted in 2-D space. Note that the firing fields of individual units form grid maps in 2-D space, as highlighted in grey for unit #1.</p></caption>
<graphic xlink:href="542747v4_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>However, no theory exists to date that explains the emergence of grid cell firing patterns from basic principles unifying the many seemingly unconnected experimental observations on periodic firing patterns and their distortions under a single framework<sup><xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>. Consequently, currently existing mechanistic models of grid cell firing fall short of explaining the basic question of <italic>why</italic> grid cells exist in the first place. Most previous studies on grid cell function follow a traditional approach based on the well-founded assertion in biology that structure determines function. This approach has resulted in a vast literature describing properties of grid cells in multiple species, how these properties depend on internal neural circuit dynamics and external cues, and how grid cell dynamics can be employed for computational or behavioral functions such as memory-guided navigation<sup><xref ref-type="bibr" rid="c4">4</xref>–<xref ref-type="bibr" rid="c6">6</xref></sup> and the planning of direct trajectories to goals<sup><xref ref-type="bibr" rid="c15">15</xref>,<xref ref-type="bibr" rid="c16">16</xref></sup>. However, this traditional approach has been proven notoriously difficult in identifying a teleological cause for the existence of grid cells in mammalian brains, i.e., an explanation of the specific functional purpose they serve. Computational models of grid cells such as oscillatory interference models<sup><xref ref-type="bibr" rid="c17">17</xref>–<xref ref-type="bibr" rid="c21">21</xref></sup> and continuous attractor models<sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c22">22</xref>,<xref ref-type="bibr" rid="c23">23</xref></sup> provide mechanistic explanations of how the spatial periodicity in firing can emerge from the structure of microcircuits within the superficial layers of the MEC<sup><xref ref-type="bibr" rid="c24">24</xref>–<xref ref-type="bibr" rid="c26">26</xref></sup>. However, these mechanistic models, too, cannot identify the teleological cause for the emergence of spatial periodicity in grid cell firing. Consequently, functions of grid cells are often explained in generic terms and statements, such as that grid cells supply a path integration-based “metric for space” or provide a “coordinate system” for spatial mapping.</p>
<p>The approach taken in this study to develop a theoretical framework explaining the emergence of grid cell firing patterns from a computational goal differs from mechanistic modeling approaches and from traditional approaches in the grid cell literature that aim to assign functions to grid cells based on their properties. Instead, we turn the question on its head and ask the reverse question: What is an important function performed by the mammalian brain that could either not be performed at all or would be substantially more costly or inefficient to perform in the absence of grid cells? This approach follows the logic proposed by David Marr: “To phrase the matter in another way, an algorithm is likely to be understood more readily by understanding the nature of the problem being solved than by examining the mechanism (and hardware) in which it is embodied” (Marr, 2010, Chapter 1.2).</p>
<p>This study provides mathematical proof that, in Marr’s words, “the nature of the problem being solved” by grid cells is coding of trajectories in 2-D space using cell sequences. By doing so, we offer a specific answer to the question of why grid cell firing patterns are observed in the mammalian brain. Thus, we (1) provide a teleological cause for the existence of grid cells and (2) provide a unifying theoretical framework that spans a bridge between the literature on grid cells and the vast literature on neural sequences in the hippocampal formation.</p>
</sec>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Spatial periodicity in grid cell firing emerges from a cell sequence code of trajectories in 2-D space</title>
<p>To constrain our search for a function that requires grid cells or could not be performed efficiently without grid cells, we reasoned that this function shall rely on sequential activation of grid cell assemblies, in short grid cell sequences. This reasoning rests on well-established experimental data on neural activity in the hippocampal formation showing that cell sequences can provide a code for transitional structures of world states, generating an internal representation for memory-guided navigation<sup><xref ref-type="bibr" rid="c28">28</xref>–<xref ref-type="bibr" rid="c30">30</xref></sup>. Please note that the term “cell sequences” refers either to sequences of single cells or the sequences of cell assemblies, which are often observed in animal experiments as sequential activity of individual cells due to limitations in the number of neurons that can be recorded simultaneously. We further reasoned that, if a fundamental function of grid cells exists, such a function is very likely related to coding of trajectories. This reasoning rests on theoretical work demonstrating that theta sequences of grid cell populations can provide a traveling-direction signal<sup><xref ref-type="bibr" rid="c31">31</xref></sup>, and that temporally structured neural activity in the hippocampal formation may be necessary to temporally bind neural representations of contiguous events<sup><xref ref-type="bibr" rid="c12">12</xref></sup>. Moreover, data obtained from rodent experiments<sup><xref ref-type="bibr" rid="c32">32</xref>,<xref ref-type="bibr" rid="c33">33</xref></sup> and theoretical work<sup><xref ref-type="bibr" rid="c34">34</xref></sup> suggest that grid cells serve path integration and memory-guided navigation. A code for spatial trajectories by cell sequences that is usable across different environments would be very useful to keep track of changes in location relative to a starting point, i.e., path integration.</p>
<p>We therefore set out to provide mathematical proof that spatial periodicity in grid cell firing emerges from the assertion that cell sequences code for trajectories in 2-D space under the constraint that the number of neurons in the brain is finite.</p>
</sec>
<sec id="s2b">
<title>Mathematical proof</title>
<p>In the following, we prove that the firing fields of grid cells emerge from assuming a basic set of axioms defining how cell sequences code for trajectories in 2-D space. In particular, we prove that the grid fields must be arranged such that their centers are placed at the points of a hexagonal lattice. We will draw on geometry and combinatorics for this, enabling us to give a visual but nevertheless rigorous argument.</p>
<p><bold>Definition 1.1. Spatial firing field.</bold> A spatial firing field of a neuron defines a specific region in space, where a neuron is active, i.e., the neuron responds to a specific spatial location of an animal with an increased rate of action potential firing.</p>
<p><bold>Remark 1.2.</bold> Conversely, if the firing fields of multiple neurons overlap at one point in space, multiple neurons are active at the same time.</p>
<p><bold>Definition 1.3. Cell assembly.</bold> We refer to the co-activity of multiple neurons with overlapping firing fields as a functional <italic>cell assembly</italic>.</p>
<p><bold>Definition 1.4. Compound spatial firing field.</bold> A compound spatial firing field is the union of all firing fields of all cells that are part of a cell assembly.</p>
<p><bold>Definition 2.1. Isometry.</bold> An <italic>isometry</italic> is a bijective map <italic>f</italic> that preserves distance, that is for any two points x and y,
<disp-formula id="ueqn1">
<graphic xlink:href="542747v4_ueqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
<p>We say that two geometric figures are <italic>geometrically congruent</italic> if there is an isometry between them. We will abbreviate this to <italic>congruent</italic> in what follows.</p>
<p>The intuitive idea here is that two figures are congruent if one can be laid on top of the other so that they match perfectly. This can be done via rotation, translation, reflection, or a combination of these.</p>
<p><bold>Definition 3.1. Kissing number.</bold> Given a geometric figure, the kissing number is the largest number of non-overlapping figures congruent to the original geometric figure that can be arranged in the plane so that they all touch the original geometric figure.</p>
<p><bold>Remark 3.2.</bold> This usually refers to spheres embedded in various Euclidean spaces, but here we restrict to the plane and allow convex (see Definition 5) geometric figures other than circles.</p>
<p><bold>Example 3.3.</bold> The kissing number of a circle in the plane is 6, which is achieved using a hexagonal packing of circles<sup><xref ref-type="bibr" rid="c35">35</xref>,<xref ref-type="bibr" rid="c36">36</xref></sup>.</p>
<p><bold>Definition 4.1. Lattice and lattice packing.</bold> A <italic>lattice</italic> in the plane is an infinite set of points such that adding or subtracting any one point to/from another in the lattice returns another point in the lattice, any two points of the lattice are separated by a minimum distance, and any point in the plane is within a maximum distance of a lattice point.</p>
<p>A <italic>lattice packing</italic> is a packing of the plane by congruent geometric objects, such that the centers of the objects are located at the points of a lattice.</p>
<p><bold>Example 4.2.</bold> The points in the plane with integer coordinates form a lattice.</p>
<p><bold>Example 4.3.</bold> The tiling of the plane by equilateral triangles, squares, or hexagons is a lattice packing. So is the hexagonal circle packing, in which every circle is surrounded by six other circles touching it.</p>
<p><bold>Fact 4.4.</bold> A lattice is invariant under isometries that take one point of the lattice to another point of the lattice.</p>
<p><bold>Fact 4.5.</bold> There are five types of a lattice in the plane (Kittel, 1966, Chapter 1) (<bold>Supplementary Figure S1, A – E</bold>).
<list list-type="order">
<list-item><p>Oblique</p></list-item>
<list-item><p>Square</p></list-item>
<list-item><p>Hexagonal</p></list-item>
<list-item><p>Rectangular</p></list-item>
<list-item><p>Centered rectangular</p></list-item>
</list>
<bold>Definition 5. Convexity.</bold> A geometric object in the plane is <italic>convex</italic> if for any line segment whose endpoints lie on the object, the entirety of the line segment also lies on the object (<bold>Supplementary Figure S1, F – H</bold>).</p>
<p><bold>Definition 6. Trajectory.</bold> A <italic>trajectory</italic> is a path taken in space.</p>
<p><bold>Definition 7.1. Cell sequence.</bold> A <italic>cell sequence</italic> refers to continuous neural activity consisting of sequentially active cells or cell assemblies.</p>
<p><bold>Definition 7.2. Units within a cell sequence.</bold> In the context of a cell sequence, a “unit” within a sequence refers either to a single cell or a cell assembly. A sequence of cell assemblies refers to the sequential activity of cell assemblies such that the cellular compositions of two sequentially active cell assemblies do no overlap. Conversely, the firing fields of all cellular components of the first cell assembly do not overlap with the firing fields of all cellular components of the second cell assembly.</p>
<p><bold>Remark 7.3.</bold> Cell assemblies can perform pattern completion and are thereby resistant to noise so that a cell assembly would be activated robustly even if a single cell of this assembly failed to be activated. Moreover, cell assemblies allow for conjunctive coding by individual cells.</p>
<p><bold>Definition 8. Sequence coding of trajectories.</bold> <italic>Sequence coding of trajectories</italic> is given if the identity of the next active unit in a sequence is uniquely determined by the currently active unit and the velocity vector associated with the current trajectory (<bold><xref rid="fig1" ref-type="fig">Figures 1E – 1J</xref></bold>).</p>
<p><bold>Axioms (<xref rid="tbl1" ref-type="table">Table 1</xref>).</bold> Our goal is to provide a mathematical proof that spatial periodicity in grid cell firing emerges as a parsimonious solution to provide a code for trajectories in 2-D space by cell sequences.</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>Axioms from which grid cell firing emerges as the most parsimonious solution to provide a code for trajectories in 2-D space</title></caption>
<graphic xlink:href="542747v4_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>In the following sections, we demonstrate that if we assume axioms 1 to 4, it must be the case that the intersecton of all firing fields of trajectory-coding cells or all compound firing fields of cell assemblies must be congruent (the same shape), and the centers of the firing fields must be arranged in a hexagonal lattice. For the sake of simplicity in writing, we refer to cells or cell assemblies as units.</p>
<p>To illustrate this, note that by Axiom 3, a particular firing field U is surrounded by the maximal number of other firing fields, each of which must be congruent to each other. This implies that all firing fields around U are congruent. Pick a firing field V adjacent to U. By the same argument, it must be the case that all firing fields around V are congruent. Since U is adjacent to V, it is congruent to the firing fields around V. Some of these are adjacent to U as well, so U is congruent to the firing fields around both V and U, as well as to V. By continuing this argument across the whole plane, we see that all firing fields must be congruent.</p>
<p>Since each firing field U must be surrounded by the maximal number of firing fields, the kissing number of the arrangement must be maximal. Further, by the symmetry requirement (Axiom 3), this must be achieved by a hexagonal lattice packing with a kissing number of 6 (<bold><xref rid="fig1" ref-type="fig">Figures 1F</xref> and <xref rid="fig1" ref-type="fig">1G</xref></bold>). Any square lattice packing either has a kissing number of 4 or lacks symmetry between the “corner” firing fields and “side” firing fields.</p>
<p>We now use axiom 1 to demonstrate that the firing fields of trajectory-coding units must be convex. Examining <bold>Supplementary Figure S1H</bold>, we see that if a firing field is non-convex, a single sequence will code for more than one trajectory.</p>
<p>At this point, we know that (i) all firing fields are congruent to each other, (ii) they are arranged in a hexagonal lattice, and (iii) each firing field is convex.</p>
<p><bold>Definition 9. Row and diagonal.</bold> We refer to a straight sequence of firing fields along one of the major axes of the hexagonal lattice as a row and along the remaining two axes as diagonals (<bold><xref rid="fig1" ref-type="fig">Figure 1 K</xref></bold>).</p>
<p>As we will proof below, the possibilities of arrangements of firing fields of all distinct units is restricted by axioms 1-3. We further realize that the units appearing in one row of the lattice must repeat if the number of units is finite (Axiom 4).</p>
<p>But as soon as one unit repeats, the <italic>sequence</italic> of units must also repeat. For example, assume we start in a firing field of one trajectory-coding unit and travel in some direction. If, for example, units 1,3, and 4 fire in that order and the animal continues traveling in the same direction, units 1,3, and 4 will eventually fire again in that order.</p>
<p>Generally speaking, starting in a firing field of unit <italic>i</italic> and going along any set of firing fields, some unit must eventually become active again since the total number of units is finite by axiom 4. Once there is a repeat of one unit’s firing field, the whole sequence of firing fields of all units must repeat by axiom 1. More specifically, if we had a sequence 1,2, …, <italic>k</italic>, 1, <italic>t</italic> of units, then 1,2 and 1, <italic>t</italic> both would code for traveling in the same direction from unit 1, contradicting axiom 1.</p>
<p>The repeating sequence of locally active units must at least have length 3 as if we had a repeat of length 2, we would have a sequence <italic>i</italic>, <italic>j</italic>, <italic>i</italic>. In this case <italic>i</italic>, <italic>j</italic> would represent two distinct trajectories, contradicting axiom 1. If the same unit fired twice in a row, say we had a sequence i,1,1,j, then 1,1 and 1,j would both code for the same trajectory, contradicting axiom 1 again.</p>
<p>It follows that the arrangement in one row determines the possibilities of arrangements in the remaining rows.</p>
<p>More explicitly, assuming axioms 1 and 4, the firing fields of trajectory-coding units must be spatially periodic, in the sense that starting at any point and continuing in a single direction, the initial sequence of locally active units must eventually repeat with a repeat length of at least 3 (<bold><xref rid="fig2" ref-type="fig">Figure 2</xref></bold>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2.</label>
<caption><title>Repeating sequences of units coding for trajectories result in lattice packing of firing fields</title>
<p>Left panels show firing fields of multiple distinct units with non-overlapping firing fields arranged in a 2-D lattice packing (grid). Each grid provides a sequence code of trajectories. Mid panels show the sequences that code for the directions along the three major axes of the grid. Right panels highlight the firing fields of an individual unit visualizing the type of lattice formed by the firing fields of one unit. <bold>A</bold>, An example of the minimal number of seven units and resulting sequences with repeat length 7 along the three grid axes. The resulting firing fields of individual units (referred to as a “grid map” in animal experiments) are arranged on a hexagonal lattice rotated by 10.9 degrees against a vertical axis. <bold>B</bold>, An example of eight cells and sequences with repeat lengths 4 along one axis, and repeat length 8 along the two other axes. The resulting firing fields are arranged on a centered rectangular lattice. <bold>C</bold>, An example of nine cells and sequences with repeat length 3 along all three grid axes, resulting in hexagonal lattice packing of indivual units’ firing fields.</p></caption>
<graphic xlink:href="542747v4_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p><bold>Remark.11.3.</bold> This does not require symmetry in the sense that traveling in two different directions from unit <italic>i</italic> may give repeating sequences of two different lengths, as seen in <bold><xref rid="fig2" ref-type="fig">Figure 2B</xref></bold>, where the repeats have lengths 4 and 8, depending on the angle of travel from a given unit.</p>
<p>The next goal is to determine how our axioms restrict the arrangement of firing fields in a single computational unit of trajectory-coding units. Since these firing fields are arranged in a hexagonal lattice, we determine the possible ways to label the firing fields in this lattice (drawn as circles for convenience), as visually representated in <xref rid="fig4" ref-type="fig">Figures 4</xref> and <xref rid="fig5" ref-type="fig">5</xref>.</p>
<p>Many of the proofs in the rest of this section use the method of proof by cases: we describe all possible ways to label the firing fields, and then explain why some of those cases contradict our hypotheses. A key observation is that the sequence that appears in one row of the lattice restricts the possibilities for which sequences can appear in the adjacent row.</p>
<p>First, we will demonstrate that every sequence of units along one of the three major axes of the hexagonal lattice (rows and diagonals) must be either a translation of an existent sequence in a parallel axis or consist of a disjoint set of units.</p>
<p>To prove this statement, suppose that row A consists of units 1, …, <italic>k</italic> repeating in this order. Then any row that contains any unit from 1, …, <italic>k</italic> must contain the full repeat 1, …, <italic>k</italic> by axiom 1. So any row containing any unit from 1, …, <italic>k</italic> is a translation of row A, and any unit that does not contain them is disjoint from row A.</p>
<p><bold>Remark 12.3.</bold> We count the distance of a translation of a row A by starting at a unit <italic>a</italic>, passing to the unit diagonally down and to the right of unit <italic>a</italic>, and counting spaces moved right from here. Translations must be by 0,1,2, …, <italic>k</italic> − 1 spaces, where row A contains <italic>k</italic> units.</p>
<p>We note that if a row or diagonal of the hexagonal lattice is a translation of a neighboring row or diagonal, the translation must be by at least 2 and at most <italic>n</italic> − 3, where <italic>n</italic> is the repeat length. If the translation is by 0, we have one unit firing adjacent to itself, which contradicts axiom 1. If the translation is by 1, say unit i has units j,i below and immediately to the right (South-East) of it, then j,i is now coding for two distinct trajectories, namely North-West and East. This contradicts axiom 1. If the translation is by <italic>n</italic> − 2, or <italic>n</italic> − 1, these are left-right reflections of translations by 1 or 0, respectively, and have the same issues.</p>
<p>Further, it must be true that sequence repeats in parallel rows or diagonals must be of the same length.</p>
<p>To illustrate this, assume two consecutive rows A and B have sequence repeats of different lengths, say row A consists of 1, …, <italic>k</italic> and row B consists of <italic>k</italic> + 1, …, <italic>k</italic> + <italic>s</italic>, where <italic>k</italic> &lt; <italic>s</italic>. Then, the unit sequence 1, <italic>k</italic> + 1 will appear in one repeat and the unit sequence 1, <italic>k</italic> + <italic>t</italic> will appear in the next, where <italic>t</italic> is not equal to 1. This contradicts axiom 1 (<bold><xref rid="fig5" ref-type="fig">Figure 5A</xref></bold>).</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3.</label>
<caption><title>The minimum number of distinct units providing a sequence code of trajectories in 2-D space is 7, and there are exactly 2 possible arrangements of units up to relabeling</title>
<p><bold>A</bold>, Repeat lengths that are smaller than 7 result in a violation of a sequence code of trajectories because the code would be ambiguous and not unique. A red question mark indicates that no unit can be found for this position that would not violate the sequence code. Red numbers indicate that activity of this unit at the current position would violate sequence coding of trajectories due to ambiquity. Blue background color marks the sequential activity of 2 units that violate the sequence code of trajectories (Definition 8) because the next active cell in the sequence is not uniquely determined by the currently active cell and the velocity vector associated with the current trajectory of an animal. <bold>B</bold>, If the repeat length is 7, there are three potential translations of the sequence in row 1 to fill up row 2 (see Mathematical proof). Only two of those three tranlsations result in an arrangement of units (up to relabeling of units) that creates a sequence code for trajectories in 2-D space. These two arrangements are mirror images of each other and imply that the firing fields of each individual grid unit fall on the vertices of equilateral triangles, i.e., they form a hexagonal grid. <bold>C</bold>, Both possible arrangements of firing fields imply that grid patterns of other grid units have the same spacing and rotation, and only differ in spatial phase (compare grid patterns of unit #1 and unit #6). The smallest angle between one grid axis and the boundary of a rectangular enclosure is 10.9 degrees if one row of sequences is aligned with one of the borders of the enclosure.</p></caption>
<graphic xlink:href="542747v4_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Transformation of a sequence code of trajectories from 2-D space to 1-D space</title>
<p><bold>A,B</bold>, A sequence of 7 different units can code for a trajectory in a 1-D compartmentalized “hairpin” maze (A) or a 1-D circular track (B). Note that the distance between firing fields would increase in the 1-D “hairpin” maze and 1-D circular track compared to the distance between spatial firing fields in a 2-D environment. Also note that sequences could undergo a phase reset at behaviorally relevant points, e.g., the turning points in the “hairpin” maze (A). <bold>C</bold>, The sequence of active units in a 1-D environment can be interpreted as a cross-section of the trajectory sequence code in a 2-D space. <bold>D</bold>, Anchoring of firing filelds to environmental borders predicts parametric rescaling of an individual unit’s grid pattern when a familiar enclosure is deformed. Each color represents one grid unit, each circle represents one firing field. For clarity, the complete set of firing fields of an individual unit is shown only for one unit (orange color). In addition, sequences are shown for all three major axes. Left panel, original maze configuration. Mid and right panel, the environment is compressed along the vertical or horizontal dimension resulting in a parametric deformation of firing fields and the grid pattern of individual units’ firing fields along the vertical or horizontal dimension. <bold>E</bold>, Progressively faster advancement from the currently active unit to the next active unit in the sequence code of trajectories results in progressive decrease in grid spacing and thereby a local distortion of the grid map. Open circles represent firing fields of grid units along the three major axes. The red filled circle in the center represents a salient location such as a rewarded goal location toward which nearby grid fields gravitate.</p></caption>
<graphic xlink:href="542747v4_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5.</label>
<caption><title>Multiple grid units provide nearly continuous resolution in the coding of trajectories</title>
<p><bold>A</bold>, The circles with numbers show the <italic>centers</italic> of the grid fields from 4 grids, each composed of 7 distinct units (total of 28 grid units). Shaded areas represent the firing fields of individual units. Units with non-overlapping firing fields form “grids”, shown in black, green, blue, and red colors. Each number within a circle identifies a distinct unit. If units represent cell assemblies, a combination of numbers (e.g., “1,2”) identifies a unit whose cellular composition is an overlap between two units with adjacent firing fields. E.g., unit “1,2” is composed of cells that are part of units “1” and “2”, resulting in an overlap of firing fields. For visual clarity, not all unit numbers are shown. <bold>B</bold>, Grids #2, #3, and #4 are phase-shifted along one of the three major axes of grid #1. The emerging grid map of an individual unit’s firing fields is highlighted in color for one grid unit in each grid. The phase-shift of each grid is indicated by showing the transparent grid pattern of grid #1. <bold>C</bold>, When more grid units are added, the units can be represented in 3-D neural space as a neural manifold, shown here for a total of 1792 grid units forming 256 grids of non-overlapping firing fields. The colored cells represent one diagonal axis across rows of non-repeating units if plotted in the 2-D plane as shown in A.</p></caption>
<graphic xlink:href="542747v4_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>A final useful fact is that the length of the sequence repeat in any row or diagonal must divide the number of units. As a result, if the number <italic>n</italic> of units is prime, the length of the sequence repeat in any row or diagonal must be of length <italic>n</italic>.</p>
<p>In order to prove this last fact, we will work by supposing the repeat length is less than <italic>n</italic> in some dimension, and showing that the repeat length must then divide <italic>n</italic> . Without loss of generality, assume it is the horizontal (West-East) direction, so that one row consists of 1,2, …, <italic>i</italic> repeating, for some <italic>i</italic> &lt; <italic>n</italic>. Then, every row must consist of units 1,2, …, <italic>i</italic> or be disjoint from the units in other rows. Since every unit will appear in exactly 1 of the distinct rows, the total number of units must divide evenly into sets of i, one for each distinct row. So, the length of the repeat in each row must divide <italic>n</italic>.</p>
<p>If <italic>n</italic> is prime, every row has repeat length dividing <italic>n</italic>. Since no row can have a repeat of length 1 by the work above, every row has repeat length <italic>n</italic>.</p>
<p>Next, we prove that the minimum number of trajectory-coding units in 2-D space is 7 and describe the possible arrangements of 7 units’ firing fields in 2-D space that establish a sequence code of trajectories.</p>
<p>Given the requirement that each firing field is surrounded by 6 firing fields of distinct units, the minimum number of units providing a sequence code of trajectories in 2-D space is 7.</p>
<p>By our work above, the repeat length must be 7 in all directions. We may assume the units are labelled such that row A consists of units 1,2, … 7 (<bold><xref rid="fig3" ref-type="fig">Figure 3B</xref></bold>). Hence, every row is a translation of row A. Since the translation must be at least 2 and at most 4, we have a total of 3 options for how much row B is translated from row A. In <bold><xref rid="fig3" ref-type="fig">Figure 3B</xref></bold>, we show that translation by 3 yields a contradiction, so translation by 2 and 4 are the only possible options. Once rows A and B are determined, every other row is uniquely determined by axiom 1.</p>
<p>There are thus exactly 2 possible arrangements of 7 units so that they form a sequence code for trajectories in 2-D space, up to relabeling of cells. Intriguingly, both possible arrangements of 7 units result in a hexagonal arrangement of firing fields of all distinct units, and these arrangements are rotated against the wall of a rectangular enclosure by 10.9 degrees (<bold><xref rid="fig3" ref-type="fig">Figure 3B</xref></bold>).</p>
<p>While the two solutions to a sequence code of trajectories with 7 units both result in a hexagonal lattice packing of firing fields, solutions with 8 or more units can result in other types of lattice packing (<bold>Supplementary Figure S1</bold>), such as the oblique lattice or centered rectangular lattice that have also been observed in single unit recordings of freely behaving animals<sup><xref ref-type="bibr" rid="c38">38</xref></sup>. Code to compute and visualize “grid maps” of trajectory-coding sequence arrangements with up to 14 units has been made publicly available to help the scientific community test some of our predictions against future datasets<sup><xref ref-type="bibr" rid="c39">39</xref></sup>. Because (1) each row must either be a translation of the previous row or entirely disjoint from it, (2) the length of the repeat in each row is the same and divides the total number of units, and (3) if one row is translated from the one above, the translation must be by at least 2 and at most n-3 (where n is the length of the repeating sequence in the previous row), we can classify all possible arrangements of trajectory coding sequences of units for any particular number of units. In <xref rid="tbl2" ref-type="table">Table 2</xref>, we list all possible ways to construct a sequence code composed of 7-12 trajectory-coding units up to translation and rotation. Note that increasing the number of units in a sequence code does <italic>not</italic> increase the spatial or angular resolution in the representation of a trajectory. Therefore, a code that uses more than the minimal number of 7 units has no functional benefit (see Discussion).</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><p>List of possible grid maps and properties of these grid maps given the total number of units participating in a trajectory-coding sequence in a rectangular environment. For each individual unit’s grid map that has a non-zero angle to a border, a reflection or 90°-rotation and reflection up to relabeling of the units exist, and these additional possibilies are not included in this list.</p></caption>
<graphic xlink:href="542747v4_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>The grid pattern that we have found to emerge as the most parsimonious solution assuming axioms 1 to 4 (see Results), i.e., the solution to a sequence code of trajectories using a minimal number of units, mirrors experimental results on grid units from animal experiments as we demonstrate below.</p>
</sec>
<sec id="s2c">
<title>Sequence coding of trajectories predicts grid spacing and rotation of grid maps against a wall</title>
<p>The solution to sequence coding of trajectories predicts firing fields on the single cell level that form a hexagonal lattice, as observed in grid cell data obtained from freely behaving rodents<sup><xref ref-type="bibr" rid="c2">2</xref>,<xref ref-type="bibr" rid="c40">40</xref></sup> and crawling Egyptian fruit bats<sup><xref ref-type="bibr" rid="c41">41</xref></sup>. The triangular structure of grid cells’ firing maps (grid maps) have been characterized by three parameters, namely grid field size, grid spacing, and grid orientation<sup><xref ref-type="bibr" rid="c2">2</xref></sup>. When using the distance between the centers of two adjacent grid fields to measure grid spacing and a diameter-like metric to measure grid field size, the sequence code of trajectories model of grid cell firing predicts a fixed ratio of grid spacing to field size of √7 ≈ 2.65 (see Methods). We tested this prediction on a data set of n = 27 grid cells recorded in mice for a previously published study<sup><xref ref-type="bibr" rid="c42">42</xref></sup>. Quantifying field sizes requires identifying the borders of individual fields as a first step. Since the characteristic feature of a firing field is its firing rate, we chose to use a threshold for the firing rate to determine the field boundaries (see Methods). Setting the field detection threshold to 31% of the peak firing rate optimized detection of grid fields in most grid cells (n = 25 out of 27 cells) (<bold>Supplementary Figure S2A</bold>). We found that the ratio of the field spacing to a diameter-like metric of the field size was 2.39 ± 0.25 (mean ± SD; n = 25) (<bold>Supplementary Figure S2B</bold>), which is only slightly smaller than 2.65, the upper bound predicted by the model. Note that the ratio of grid field spacing to field size observed in experimental data is expected to be smaller than the model-predicted ratio because of the many factors that result in out-of-field firing of neurons recorded in experiments, such as transient drifts of grid maps, path integration errors, conjunctive coding properties, and noise in experimental measurements (<bold>Supplementary Figure S2C and Supplementary Figure S3</bold>).</p>
<p>Another testable prediction of our model is that the grid map associated with the most parsimonious solution using 7 units is rotated by 10.9 degrees against the nearest wall of a rectangular enclosure (<xref rid="tbl2" ref-type="table">Table 2</xref>). This angle is well within the range of experimentally observed values. Concretely, Stensola et al. (2015)<sup><xref ref-type="bibr" rid="c38">38</xref></sup> reported a distribution of angles with a plateau between ∼6 and ∼12 degrees (mean ± SD: 7.2 ± 3.5). Notably, the median of the angle to the nearest wall in a highly familiar as opposed to a novel environment was 9.8 degrees<sup><xref ref-type="bibr" rid="c38">38</xref></sup>. The sequence code model of grid cell firing thus provides a simple and intuitive answer to the otherwise puzzling observation that most grid field maps observed in freely behaving animals are rotated against the nearest wall of a rectangular enclosure.</p>
</sec>
<sec id="s2d">
<title>Sequence coding of trajectories predicts fragmentation of grid maps in 1-D space</title>
<p>Another experimental observation related to the spatial geometry of grid fields that can be explained by a sequence code of trajectories is the fragmentation of grid cell maps in a multicompartment environment (<bold><xref rid="fig4" ref-type="fig">Figures 4A – 4C</xref></bold>). The 2-D spatial periodicity in grid cell firing is replaced by one-dimensional (1-D) spatial periodicity if movement through space is restricted to 1-D trajectories along parallel alleys in a multi-compartment maze<sup><xref ref-type="bibr" rid="c43">43</xref></sup>. A sequence code of trajectories predicts such a fragmentation of grid cell maps because parallel trajectories would result in the same sequential activation of cells, and neural coding on a 1-D tract is most efficient when sequences are aligned with the movement direction (<bold><xref rid="fig4" ref-type="fig">Figure 4A</xref></bold>). Likewise, grid cells have been shown to path integrate distances on a 1-D circular track<sup><xref ref-type="bibr" rid="c44">44</xref></sup>, consistent with a sequence code of a trajectory along a 1-D circular track (<bold><xref rid="fig4" ref-type="fig">Figure 4B</xref></bold>). Notably, Jacob et al. (2019) report in their study that the field spacing of grid cells is increased in a 1-D circular track compared to a 2-D environment. The authors’ explanation is that field spacing is increased due to the lack of visual cues. However, an alternative explanation based on the sequence model of grid cell firing is that the animal’s trajectory on a linear track is represented by a sequence of cells (<bold><xref rid="fig4" ref-type="fig">Figure 4C</xref></bold>). Moreover, the sequence code of trajectories is consistent with an analysis of experimental data<sup><xref ref-type="bibr" rid="c45">45</xref></sup> showing that firing fields of grid cells on a 1-D linear track are compatible with a slice through a 2-D hexagonal pattern. Specifically, a slice through a 2-D hexagonal firing pattern explains linear-track data if translational shifts of the pattern are allowed at turning points without a requirement of rotating or scaling the grid. In the context of the sequence code of trajectories, a translational shift of the grid pattern of a single cell is equivalent to re-anchoring the sequence code after the animal has turned around facing the opposite direction on the linear track. Such a translational shift or re-anchoring of the sequence code is consistent with experimental data showing differential spatial coding by place cells in the hippocampus for inbound and outbound running directions on a linear track<sup><xref ref-type="bibr" rid="c46">46</xref></sup>.</p>
<p>Furthermore, grid cells have been shown to code for traveled distance, elapsed time, or a combination of distance and time when animals run in place on a treadmill<sup><xref ref-type="bibr" rid="c47">47</xref></sup>. The firing pattern of grid cells as time or distance cells is remarkably similar to the firing pattern of grid cells that emerges when animals navigate 1-D linear tracks after correcting for logarithmic expansion in grid field size over time. The fact that grid cells show repeating firing fields in other dimensions than physical space is consistent with a sequence code of trajectories in any type of dimension that has behavioral relevance for the animal. Experimental data<sup><xref ref-type="bibr" rid="c47">47</xref></sup> demonstrate parallel coding of different dimensions by different grid cells, suggesting individual grid cell sequences can provide independent codes of trajectories through different dimensions, thereby enabling parallel processing of different cognitive functions.</p>
</sec>
<sec id="s2e">
<title>Sequence coding of trajectories predicts rescaling and restructuring of grid maps in response to changes in a familiar environment</title>
<p>A sequence code of trajectories does not need to be rigid but instead can be malleable and rescaled in response to changes in the environment as long as the start and end points of the sequences are anchored to salient environmental landmarks. Thus, sequence coding of trajectories by grid cells provide an explanation of distortions of the grid pattern that are frequently observed in animal studies. Experiments in freely behaving rodents demonstrate that stretching or compression of enclosed environments result in stretching or compression of the grid map in the rescaled dimension. For instance, stretching or compressing the borders of a familiar open field recording arena resulted in an increase or decrease of the distance between firing fields in the rescaled dimension of the deformed enclosure<sup><xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c48">48</xref></sup>. Such distortions have been challenging to interpret under the assumption that grid cells provide a “spatial metric” or “coordinate system” for navigation. However, if we assume a sequence code with start and end points of trajectories anchored to landmarks or environmental borders, distortions of the grid along the rescaled dimension would be expected. The sequence code of trajectories would remain the same if trajectories are defined relative to the borders of the environment (<bold><xref rid="fig4" ref-type="fig">Figure 4D</xref></bold>). Moreover, experimental data in rats show that grid maps that have been established in two adjacent compartments separated by a wall within the same larger environment merge once the wall is removed<sup><xref ref-type="bibr" rid="c49">49</xref></sup>. Merging of the two grid maps appeared to happen instantly resulting in local spatial periodicity and continuity between the two original maps<sup><xref ref-type="bibr" rid="c49">49</xref></sup>, consistent with the sequence code of trajectories by grid cells.</p>
<p>Scaling of grids has also been observed in the form of an expansion, i.e., increased grid spacing between individual firing fields and increased field sizes, in response to novelty of the environment<sup><xref ref-type="bibr" rid="c50">50</xref></sup>. Such scaling has also been reported in climbing rats foraging on a vertical wall<sup><xref ref-type="bibr" rid="c51">51</xref></sup>. Both the scaling of grids in response to scaling the borders of an environment and the expansion of grid fields in response to novelty are inconsistent with the hypothesis that grid cells provide a spatial metric for navigation or path integration. However, an increase in grid spacing in response to a novel environment can be explained by a sequence code of trajectories reflecting an initially broader spatial resolution. This makes sense because the overall layout of a novel space is initially more important than the fine-grained details. As the animal becomes more familiar with the environment, it is likely paying more attention to spatial details requiring a trajectory code with higher spatial resolution, resulting in a smaller grid map. While this hypothesis needs to be tested in future studies, experimental data show that changes in grid field size co-occur, though to a lesser extent, with changes in the size of place cell firing fields in response to novel environments<sup><xref ref-type="bibr" rid="c50">50</xref>,<xref ref-type="bibr" rid="c52">52</xref>,<xref ref-type="bibr" rid="c53">53</xref></sup>. In summary, sequence coding of trajectories is consistent with the experimentally observed scaling of grids in response to deformations of the borders of the environment and with compression or expansion of firing fields and grid spacing in response to novelty.</p>
<p>Furthermore, a sequence code of trajectories in 2-D space is consistent with experimental data showing that grid fields move toward goal locations<sup><xref ref-type="bibr" rid="c54">54</xref></sup> or restructure their spatial firing maps to incorporate the location of a learned reward<sup><xref ref-type="bibr" rid="c55">55</xref></sup>. These data support the hypothesis that grid cells do not provide a simple metric of space. Instead, the spatial firing pattern of grid cells is malleable in response to relevant contextual features. Such local distortions of global grid patterns by salient locations have recently been compared to spacetime distortions by blackholes<sup><xref ref-type="bibr" rid="c14">14</xref></sup>. We propose that such warping of grid maps is caused by an increased probability that the currently active grid cell activates the next grid cell in the sequence of trajectory-coding cells. This would result in a progressive decrease in grid spacing that could yield a gradual increase of overlap of grid fields or deformations of grid fields near a goal location, thereby causing local distortions in the grid map of a single grid cell (<bold><xref rid="fig4" ref-type="fig">Figure 4E</xref></bold>). A sequence code of trajectories by grid cells is thus consistent with malleable grid maps because the spacing between adjacent firing fields can change in response to local contextual features without compromising the sequence code. The same mechanism can explain shearing induced asymmetry and multiple alignment solutions that have been shown in experimental data<sup><xref ref-type="bibr" rid="c38">38</xref></sup>.</p>
</sec>
<sec id="s2f">
<title>Multiple grids provide nearly continuous resolution in the coding of trajectories and predict grid cell properties on the population level</title>
<p>In addition to properties of grid cell firing on the single cell level, the definition of sequence coding of trajectories implies an intriguing property of grid cells on the population level, namely that each grid cell’s collection of firing fields is geometrically congruent to any other grid cell’s collection of firing fields. This property mirrors experimental data from single unit recordings in rodents showing that adjacent firing field grid patterns of different anatomically close grid cells differ only in phase but have the same orientation and scale<sup><xref ref-type="bibr" rid="c2">2</xref></sup>. Since the firing fields of distinct units (i) do not overlap and (ii) discretize directions into six running directions only, we asked (i) how other running directions are represented and (ii) how partial transitions between firing fields can be accomplished. Consistent with experimental data<sup><xref ref-type="bibr" rid="c2">2</xref></sup>, the sequence code of trajectories model of grid cell firing accounts for smooth transitions between firing fields and the representations of more than six running directions by using multiple grids of seven units each, where each unit has the same field size. However, the firing fields are shifted in phase. It follows from axiom 3 that one needs to add three grids composed of the same number of units as the original grid and shifted in phase such that their field centers fall exactly between the firing fields along one major axis of the original grid (<bold><xref rid="fig5" ref-type="fig">Figures 5A</xref> and <xref rid="fig5" ref-type="fig">5B</xref></bold>). Consequently, the firing fields of all distinct units of the compound grid must again fall on a hexagonal lattice.</p>
<p>Two key conclusions from this theoretical result are that (i) an arbitrarily smooth transition between grid fields/grid cells becomes possible during navigation with an arbitrarily large number of grid cells (organized in fundamental grids of seven units with non-overlapping firing fields), and (ii) traveling directions can be represented with an arbitrarily high angular resolution (see also the <bold>video animation</bold> of the sequence model associated with this study). This is consistent with experimental data on simultaneously recorded multiple grid cells with overlapping firing fields and consistent with data showing that grid cell dynamics can be represented with a toroidal manifold (<bold><xref rid="fig5" ref-type="fig">Figure 5C</xref></bold>).</p>
<p>Moreover, experimental data have shown that grid cells cluster into autonomous modules with distinct scale, orientation, symmetry and theta frequency modulation<sup><xref ref-type="bibr" rid="c56">56</xref></sup>. If we assume that grid cells emerge from a sequence code of trajectories, adjacent firing fields in that sequence would provide a discrete sequence of sampling points in the coding of trajectories, and the distance between the centers of two adjacent firing fields would determine the spatial resolution. Doubling the number of sampling points, i.e., doubling the number of firing fields per unit area would double the spatial resolution<sup><xref ref-type="bibr" rid="c57">57</xref></sup>. Conversely, dividing the number of firing fields per unit area in half would halve the spatial resolution. To double or halve the spatial resolution in 2-D space, the number of firing fields per area needs to double or be cut in half, respectively (<bold>Supplementary Figure S4</bold>). Because firing fields are densely packed, doubling the number of firing fields per unit area in 2-D space would result in dividing the distance between two adjacent firing fields by a factor of √2. This is exactly what has been observed in animal experiments<sup><xref ref-type="bibr" rid="c38">38</xref></sup>.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<sec id="s3a">
<title>A teleological cause for the existence of grid cells</title>
<p>In this study, we prove mathematically that spatial periodicity in grid cell firing emerges as the only possible solution to provide a code of trajectories in 2-D space by cell sequences. Within the space of all possible solutions, hexagonal symmetry in grid cell firing emerges as the most parsimonious solution with respect to the required number of neurons. The hexagonal firing pattern of grid cells in 2-D space is arguably their most intriguing property. Yet, despite decades of experimental and theoretical research, the fundamental nature of the computational problem solved by grid cells has remained largely elusive. Previous studies on grid cells have been fruitful in describing functional properties of grid cells and grid cell firing at the level of neuroanatomy, connectivity, neurophysiology, and circuit dynamics, but have largely failed to provide a specific and intuitive answer to why grid cells have evolved: what is the computational advantage of grid cells over other potential mechanisms or algorithmic implementations in the context of a computational goal? Previous investigations of grid cell function<sup><xref ref-type="bibr" rid="c24">24</xref>–<xref ref-type="bibr" rid="c26">26</xref></sup> based on mechanistic models such as the oscillatory interference<sup><xref ref-type="bibr" rid="c17">17</xref>–<xref ref-type="bibr" rid="c21">21</xref></sup> or continuous attractor models<sup><xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c22">22</xref>,<xref ref-type="bibr" rid="c23">23</xref></sup> do not address the computational goal of or teleological cause for the existence of grid cells. Other studies have used normative models to demonstrate that grid patterns can emerge to optimize the coding of space by grid cells<sup><xref ref-type="bibr" rid="c58">58</xref>,<xref ref-type="bibr" rid="c59">59</xref></sup> or to optimize path integration<sup><xref ref-type="bibr" rid="c34">34</xref>,<xref ref-type="bibr" rid="c60">60</xref>,<xref ref-type="bibr" rid="c61">61</xref></sup>. However, these normative models fall short in demonstrating that grid cells are necessary for the assumed normative functions and often rely on hidden architectural, hyperparameter, and constraint choices to obtain grid cell firing patterns<sup><xref ref-type="bibr" rid="c62">62</xref></sup> as discussed under the next section “Normative models of grid cell firing”.</p>
<p>We therefore deviated from these traditional approaches of investigating the nature of grid cell properties and asked the question: Is there a brain function that could either not be performed at all or would be substantially more costly or difficult to perform in the absence of grid cells? To constrain our search for such a function, we assumed that any coding mechanisms that operates on spatial firing requires cell sequences as a fundamental neural syntax in the brain<sup><xref ref-type="bibr" rid="c29">29</xref>–<xref ref-type="bibr" rid="c31">31</xref></sup>. Assuming that neural coding of trajectories in 2-D space is important for animal navigation, we show that grid cells are the most effective solution. We demonstrate that 7 cells are sufficient to provide an unambiguous code for trajectories in 2-D space and that the only two possible solutions with 7 cells result in firing fields that fall on a hexagonal grid. Notably, these two solutions result in grid maps that are mirror images of each other up to relabeling the cells. Any other solution to the problem would require at least 8 cells, an increase in the number of cells forming a grid unit by more than 14%. Note that an increase in the number of cells within one grid unit would not result in an increase in spatial or angular resolution in the coding of trajectories. It can therefore be reasoned that performing the same computational function with the minimum number of cells forming a grid unit is evolutionary advantageous because it conserves space, cellular material, energy, and resources<sup><xref ref-type="bibr" rid="c63">63</xref></sup>. A solution to a sequence code of trajectories that builds on fundamental units of only 7 grid cells compared to a larger number of cells would then be expected to be most frequently adopted. We therefore argue that we have provided a teleological cause for the existence of grid cells and an answer to the fundamental question of why grid cells have emerged in brains of navigating animals, namely that grid cells are the most parsimonious solution to sequence coding of trajectories in 2-D space.</p>
</sec>
<sec id="s3b">
<title>Comparison to normative models of grid cell firing</title>
<p>Normative models generally fall into two classes: One that uses artificial neural network models and one that uses a mathematical or analytical approach. Grid-like firing has been found to emerge in artificial neural networks when the models were trained to perform path integration under simple biologically plausible constraints. The emerged grid cells then endowed agents with the ability to perform vector-based navigation<sup><xref ref-type="bibr" rid="c34">34</xref>,<xref ref-type="bibr" rid="c60">60</xref></sup>. While these models demonstrate that path integration is an important driving force in the generation of grid cells, the mechanism that is generating grid cell firing patterns remains obscure due to the untransparent nature of neural networks. Moreover, the results often depend on specific hyperparameter choices to explain the emergence of grid-like units under anatomical constraints (see<sup><xref ref-type="bibr" rid="c62">62</xref></sup> for a discussion). In contrast, we have provided mathematical proof that spatial periodicity of firing fields emerges from a sequence code of trajectories in 2-D space and that the most parsimonious solution with only seven cells results in hexagonal lattice packing.</p>
</sec>
<sec id="s3c">
<title>Sequence coding of trajectories by grid cells provides a mechanistic explanation for how grid cells serve path integration and can support memory-guided navigation</title>
<p>If the step-by-step advancements from the currently active cell to the next cell in the grid cell sequence are caused by integrating velocity signals, grid cells perform path integration. The ensuing grid cell sequence is then the result of the path integration and can be interpreted as a sequence code by a downstream reader, potentially the hippocampus. Different grid cell modules integrate velocity signals at different (spatial) scales that are determined by the distance between the grid field centers of adjacent cells in the sequence. A sequence code of trajectories by grid cells therefore provides a mechanistic explanation for the functional role of grid cells in path integration. The model described in this paper can be implemented with temporal coding (spiking neurons) or rate coding, or even with binary activity states of neurons, where neurons are activated sequentially as a function of the animal’s velocity. Previous modeling work has shown that circuit mechanisms using grid cells in combination with speed-modulated head direction cells and hippocampal place cells can provide a substrate for episodic encoding and retrieval of spatiotemporal trajectories<sup><xref ref-type="bibr" rid="c7">7</xref></sup>. Furthermore, grid cell sequences have been shown to be useful in simulations of new goal-directed trajectories, where grid cells were used in a network of head direction cells, hippocampal place cells and persistent spiking cells to plan forward trajectories through the environment that search for place cells near a goal location<sup><xref ref-type="bibr" rid="c16">16</xref></sup>. Recent experimental data demonstrate that temporally coordinated entorhinal inputs drive hippocampal sequences to perform memory-guided navigation<sup><xref ref-type="bibr" rid="c28">28</xref></sup> and that temporally structured population activity of grid and place cells represent local trajectories essential for goal-directed navigation and planning<sup><xref ref-type="bibr" rid="c64">64</xref></sup>.</p>
<p>It would provide an advantage to animals if they could plan trajectories towards goals on different spatial scales to “zoom in” or “zoom out” on a cogntive map of their environment. We therefore proposed that each grid module represents trajectories at progressively lower or higher resolution to enable planning of trajectories across different spatial scales. This approach is analogous to mip mapping known from computer graphics, where an image is sampled by a stack of images, each of which is represented with half the resolution of the previous to increase rendering performance<sup><xref ref-type="bibr" rid="c57">57</xref></sup>. Notably, in a 1-D environment, doubling the number of firing fields per unit length would result in dividing the distance between two adjacent firing fields in half. It remains to be tested experimentally whether grid cell modules can adapt the scaling factor to optimize computational efficiency in multiscale representation of 1-D environments.</p>
<p>The grid cell model presented in this study assumes the ideal tiling of space and equal representation of traveling direction. If this assumption was relaxed, there would be gaps in the representation of space and traveling direction or some traveling directions will be represented with larger or smaller fields, hence with smaller or larger angular resolution, respectively (see <bold><xref rid="fig1" ref-type="fig">Figures 1F</xref> and <xref rid="fig1" ref-type="fig">1G</xref></bold>). However, path integration performed by animals is far from being perfect, and it would be of interest for future work to investigate whether non-ideal tiling of space by grid cells may be one of many factors contributing to errors in path integration<sup><xref ref-type="bibr" rid="c32">32</xref>,<xref ref-type="bibr" rid="c33">33</xref></sup>. One potential mechanism to compensate for non-ideal tiling of space is population coding. Grid cells can be part of grid cell assemblies, and the population activity of many multiple grid units consisting of seven grid cell assemblies can be interpreted by a reader mechanism as a robust population code.</p>
<p>Notably, sequence coding of trajectories is not limited to physical space but could be useful for cognitive functions such as working memory or episodic memory that connects events into a cohesive story, consistent with experimental data demonstrating a grid-like code of conceptual knowledge space in humans<sup><xref ref-type="bibr" rid="c10">10</xref></sup>. A sequence code of trajectories by grid cells can thus explain data from human subjects that link reduced grid-like activity with path integration deficits observed in Alzheimer’s disease risk carriers<sup><xref ref-type="bibr" rid="c65">65</xref>,<xref ref-type="bibr" rid="c66">66</xref></sup>, and data from rodent experiments demonstrating that grid cell firing is reduced in a rodent animal model of Alzheimer’s disease<sup><xref ref-type="bibr" rid="c67">67</xref>,<xref ref-type="bibr" rid="c68">68</xref></sup>.</p>
</sec>
<sec id="s3d">
<title>Sequence coding of trajectories in 3D space</title>
<p>There is no reason to assume that the sequence code of trajectories described in this study is restricted to 2-D space. We have discussed in previous paragraphs how a sequence code of trajectories by grid cells can code for trajectories in 1-D space. In principle, such a sequence code can be expanded to three-dimensional (3D) or higher dimensional spaces. However, there are multiple equally optimal possibilities to generate a close-packed arrangement of firing fields in 3D space<sup><xref ref-type="bibr" rid="c69">69</xref>,<xref ref-type="bibr" rid="c70">70</xref></sup>, where each sphere touches 12 neighboring spheres. Two examples of lattice packings in 3D that achieve this kissing number are the face-centered cubic and hexagonal close packed arrangements, which both have layers arranged in hexagonal lattices but stack the layers differently<sup><xref ref-type="bibr" rid="c71">71</xref></sup>. A model based on a sequence code of trajectories by grid cells would therefore predict larger variability in spatial periodicity of grid cell firing in 3D space compared to 2-D space. It remains to be determined whether specific solutions to cell sequence coding of trajectories in 3D space could result in local or global symmetries. The distribution of grid cell firing fields in rats exploring a 3D volumetric space is irregular<sup><xref ref-type="bibr" rid="c72">72</xref></sup>. However, since sequences need to repeat, cell sequence coding of trajectories in 3D space predicts some degree of local order in the grid map of a single grid cell. Consistent with this prediction, experimental data show that grid cells recorded in flying bats exhibit fixed local distances between firing fields despite the lack of a global lattice arrangement of firing fields<sup><xref ref-type="bibr" rid="c73">73</xref></sup>. Taken together, these experimental data are consistent with a sequence code of trajectories that expands to 3D space, even though this sequence coding may not need to result in a globally symmetric arrangement of the firing fields of a single cell. Based on data from animals navigating in 3D environments, it has recently been proposed that the characteristic hexagonal firing pattern of grid cells is a “by-product of whatever process causes the cells to fire in spatially discrete regions of uniform size.”<sup><xref ref-type="bibr" rid="c74">74</xref></sup> This study demonstrates that said process is a neural sequence code of trajectories.</p>
</sec>
<sec id="s3e">
<title>Limitations of the study</title>
<p>This study demonstrates a teleological cause for the existence of grid cells, namely sequence coding of trajectories in 2-D. The goal of this study was thus not to provide a mechanistic model of grid cells or biologically-detailed model of the connections between neurons that can mechanistically account for grid cell firing. The model thus remains agnostic about the specific mechanistic implementation as to how a velocity signal is integrated in entorhinal circuits to move activity from one neuron in the sequence to the next neuron in the sequence as a function of the animal’s velocity and makes no predictions about connectivity between neuron types and the connenction strengths.</p>
<p>While we have demonstrated that the ratio of grid field spacing to grid field size in an experimental data set of grid cells obtained from mice is consistent with the prediction made by the trajectory code by neural sequences model of grid cell firing, we acknowledge that future studies should test this model prediction on larger data sets obtained from other species and recorded across different grid cell modules.</p>
</sec>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Key resources table</title>
<table-wrap id="utbl1" orientation="portrait" position="float">
<graphic xlink:href="542747v4_utbl1.tif" mimetype="image" mime-subtype="tiff"/>
<graphic xlink:href="542747v4_utbl1a.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s4b">
<title>Data and code availability</title>
<p>This paper analyzes existing, previously published data. The accession numbers for the datasets are listed in the key resources table. All original code has been deposited on GitHub and is publicly available, and DOIs are listed in the key resources table. Any additional information required to reanalyze the data reported in this work is available from the lead contact upon request.</p>
</sec>
<sec id="s4c">
<title>Math notations</title>
<p>A <italic>theorem</italic> is a mathematical statement that can be proved using logical deduction from previously known results.</p>
<p>A <italic>proof</italic> is a logical argument using known results to generate new mathematical statements. The purpose of a proof is to convince the reader that the result follows from known results.</p>
<p>A <italic>plane</italic> is a flat surface extending infinitely far in two dimensions. Also referred to as ℝ<sup>2</sup>, since it can be assigned coordinates of the form (a, b) where a and b are real numbers.</p>
<p>A <italic>Euclidean metric</italic> is the usual notion of distance in the plane. Two points with coordinates (<italic>x</italic><sub>1</sub>, <italic>y</italic><sub>1</sub>) and (<italic>x</italic><sub>2</sub>, <italic>y</italic><sub>2</sub>) have distance <inline-formula><inline-graphic xlink:href="542747v4_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula>.</p>
<p><italic>Adding points</italic> means adding their coordinates, <italic>subtracting one point from another</italic> involves subtracting their coordinates.</p>
<p>A <italic>bijective map</italic> is a correspondence between two sets such that every point in one set is matched with exactly one point in the other set.</p>
<p>A <italic>geometric figure</italic> is a geometric object with a shape in the plane.</p>
<p>We work in ℝ<sup>2</sup> (the plane), with the Euclidean metric.</p>
</sec>
<sec id="s4d">
<title>Quantification and statistical analysis</title>
<sec id="s4d1">
<title>Prediction of ratio between grid field spacing and grid field size</title>
<p>The grid field spacing <italic><bold>s</bold></italic> was computed as a multiple of the diameter <italic><bold>d</bold></italic> of a circular grid field for a grid unit with seven cells. Using the Pythagorean theorem, we can write:
<disp-formula id="ueqn2">
<graphic xlink:href="542747v4_ueqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="ueqn3">
<graphic xlink:href="542747v4_ueqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula></p>
</sec>
<sec id="s4d2">
<title>Quantification of grid field spacing and grid field size in experimental data</title>
<p>Since the characteristic feature of a firing field is its firing rate, we chose to use a threshold for the firing rate to determine the field boundaries. Notably, choosing the threshold too low will result in firing fields that are too large and that will merge with each other, thus not allowing identification of individual fields. However, choosing the threshold too high will result in measurements of field sizes that are too small. To avoid bias regarding the predicted value, the person performing the analysis was blinded towards the value predicted by the sequence model of grid cells.</p>
</sec>
<sec id="s4d3">
<title>Field Detection Software Design</title>
<p>Software was created to automatically detect grid cell fields. Those detected fields are used to find the mean field size and spacing for each cell. Open source code for the software is available at <ext-link ext-link-type="uri" xlink:href="http://github.com/Hippocampome-Org/gridcell_metrics">github.com/Hippocampome-Org/gridcell_metrics</ext-link>. The code includes data for all cells used for analyses in this article, and allows a user to reproduce the field detection results. The software detects grid fields by the use of a threshold to filter out out-of-field firing. Out-of-field firing is approximated by firing at a location with a firing rate below a specified percentage relative to the peak firing rate given an animal location. The code performs grid field detection using the spatial autocorrelogram of the cell’s firing rate map. The firing rate map was generated by dividing the open-field environment into 3 cm spatial bins and computing, for each spatial bin, the occupancy-normalized spiking rate as described in Dannenberg et al. (2020)<sup><xref ref-type="bibr" rid="c42">42</xref></sup>. Rate maps were then smoothed by a 3 cm wide two-dimensional Gaussian kernel.</p>
<p>The objective of the software is to only analyze the most central field and the six closest fields surrounding it to avoid complications with analyzing fields that contact borders of a plot and have part of their areas missing due to their fields extending past the border. Other fields are detected but not saved for analyses. The DBSCAN clustering algorithm from MATLAB’s (<ext-link ext-link-type="uri" xlink:href="http://mathworks.com">mathworks.com</ext-link>) Statistics and Machine Learning Toolbox is used to automatically separate the field data into clusters. Each cluster represents a detected field area. The field centers are computed as the centroids of the detected clusters. The positions of centroids are computed by calculating the mean of all pixels on the x-axis and y-axis of a field cluster and taking the mean x-axis and y-axis values as the coordinates of the centroid for each field. The area of each field is calculated as the number of pixels in the field. The spacing between fields is calculated as the Euclidean distance between field centroids. The mean spacing value is computed from 6 measurements of the spacings from the center field to each of the 6 surrounding fields. The grid field size is computed as the mean of a diameter-like metric from each fields’ area. The diameter-like metric <italic>d</italic> uses the formula for finding a circle diameter given its area, namely <inline-formula><inline-graphic xlink:href="542747v4_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. The ratio of field spacing to field size is then computed as the field spacing divided by the field size.</p>
</sec>
<sec id="s4d4">
<title>Assessment of Field Detection Software Performance</title>
<p>The grid field detection algorithm performed best (measured as the percentage of cells where grid fields could be detected) with the threshold set to 31% (<bold>Supplementary Figure S2B</bold>). The evaluation of performance was based on data from 27 grid cell recording files that were a part of a previously published study by Dannenberg et al., (2020)<sup><xref ref-type="bibr" rid="c42">42</xref></sup>. Only recording files from baseline conditions (the “Light” condition in Dannenberg et al., 2020<sup><xref ref-type="bibr" rid="c42">42</xref></sup>) were analyzed. Grid cells that met a minimal grid score threshold of 0.19 were included. The grid score was computed as described in Dannenberg et al. (2020)<sup><xref ref-type="bibr" rid="c42">42</xref></sup>. Effective field detection by the software was confirmed by the experimenter as (1) the intended number of fields being detected (center field in plot and 6 closest to it) and (2) the fields being detected without merging of grid fields compared to visual inspection of the cells’ firing rate map. Grid cells that did not have effective field detection by the software were not included in ratio measurements. The software-computed size of grid fields is a function of a threshold parameter that was constant for all cells and was chosen to optimize performance of the software such that the number of grid cells for which the software detected grid fields was maximal. Since the threshold was constant for all cells, field sizes could appear larger or smaller relative to estimated field sizes based on visual inspection of rate maps. However, this was not determined to be a reason to exclude a cell for analysis with the threshold parameter that detected those sizes. Evaluating what size is large or small is considered to be subjective and such a subjective evaluation was avoided to benefit the ability to reproduce results. Small field detection at some thresholds is a known issue that can be addressed further in future work.</p>
</sec>
</sec>
</sec>
<sec id="d1e1545" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e1630">
<label>video animation</label>
<media xlink:href="supplements/542747_file02.mp4"/>
</supplementary-material>
<supplementary-material id="d1e1637">
<label>Supplementary Figure S1</label>
<media xlink:href="supplements/542747_file03.pdf"/>
</supplementary-material>
<supplementary-material id="d1e1644">
<label>Supplementary Figure S2</label>
<media xlink:href="supplements/542747_file04.pdf"/>
</supplementary-material>
<supplementary-material id="d1e1651">
<label>Supplementary Figure S3</label>
<media xlink:href="supplements/542747_file05.pdf"/>
</supplementary-material>
<supplementary-material id="d1e1659">
<label>Supplementary Figure S4</label>
<media xlink:href="supplements/542747_file06.pdf"/>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>This work was supported by the National Institute of Neurological Disorders and Stroke of the National Institutes of Health, grant numbers R00NS116129 to H.D. and R01NS39600 to G.A.A. Thank you to Harrison Bray for helpful conversations about lattice packings, and thank you to Xihui Zheng for help with graphical illustrations. We thank Michael E. Hasselmo for sharing data with us and for comments on the manuscript. We thank Marc W. Howard for helpful comments on the manuscript.</p>
</ack>
<sec id="note1">
<title>Note</title>
<p>This reviewed preprint has been updated to correct an author's name; previously displayed as R.G. Rebecca.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Molden</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Witter</surname>, <given-names>M.P.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E.I.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>M.-B</given-names></string-name>. (<year>2004</year>). <article-title>Spatial representation in the entorhinal cortex</article-title>. <source>Science</source> <volume>305</volume>, <fpage>1258</fpage>–<lpage>1264</lpage>. <pub-id pub-id-type="doi">10.1126/science.1099901</pub-id>.</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Hafting</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Molden</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>E.I</given-names></string-name>. (<year>2005</year>). <article-title>Microstructure of a spatial map in the entorhinal cortex</article-title>. <source>Nature</source> <volume>436</volume>, <fpage>801</fpage>–<lpage>806</lpage>. <pub-id pub-id-type="doi">10.1038/nature03721</pub-id>.</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Boccara</surname>, <given-names>C.N.</given-names></string-name>, <string-name><surname>Sargolini</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Thoresen</surname>, <given-names>V.H.</given-names></string-name>, <string-name><surname>Solstad</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Witter</surname>, <given-names>M.P.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E.I.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>M.-B</given-names></string-name>. (<year>2010</year>). <article-title>Grid cells in pre- and parasubiculum</article-title>. <source>Nat. Neurosci</source>. <volume>13</volume>, <fpage>987</fpage>–<lpage>994</lpage>. <pub-id pub-id-type="doi">10.1038/nn.2602</pub-id>.</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Fuhs</surname>, <given-names>M.C.</given-names></string-name>, and <string-name><surname>Touretzky</surname>, <given-names>D.S</given-names></string-name>. (<year>2006</year>). <article-title>A spin glass model of path integration in rat medial entorhinal cortex</article-title>. <source>J. Neurosci. Off. J. Soc. Neurosci</source>. <volume>26</volume>, <fpage>4266</fpage>–<lpage>4276</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.4353-05.2006</pub-id>.</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>McNaughton</surname>, <given-names>B.L.</given-names></string-name>, <string-name><surname>Battaglia</surname>, <given-names>F.P.</given-names></string-name>, <string-name><surname>Jensen</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E.I.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>M.-B</given-names></string-name>. (<year>2006</year>). <article-title>Path integration and the neural basis of the “cognitive map”</article-title>. <source>Nat Rev Neurosci</source> <volume>7</volume>, <fpage>663</fpage>–<lpage>678</lpage>. <pub-id pub-id-type="doi">10.1038/nrn1932</pub-id>.</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Moser</surname>, <given-names>E.I.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, and <string-name><surname>McNaughton</surname>, <given-names>B.L</given-names></string-name>. (<year>2017</year>). <article-title>Spatial representation in the hippocampal formation: a history</article-title>. <source>Nat. Neurosci</source>. <volume>20</volume>, <fpage>1448</fpage>–<lpage>1464</lpage>. <pub-id pub-id-type="doi">10.1038/nn.4653</pub-id>.</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><string-name><surname>Hasselmo</surname>, <given-names>M.E</given-names></string-name>. (<year>2009</year>). <article-title>A model of episodic memory: mental time travel along encoded trajectories using grid cells</article-title>. <source>Neurobiol. Learn. Mem</source>. <volume>92</volume>, <fpage>559</fpage>–<lpage>573</lpage>. <pub-id pub-id-type="doi">10.1016/j.nlm.2009.07.005</pub-id>.</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Eichenbaum</surname>, <given-names>H.</given-names></string-name>, and <string-name><surname>Cohen</surname>, <given-names>N.J</given-names></string-name>. (<year>2014</year>). <article-title>Can we reconcile the declarative memory and spatial navigation views on hippocampal function?</article-title> <source>Neuron</source> <volume>83</volume>, <fpage>764</fpage>–<lpage>770</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2014.07.032</pub-id>.</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Schiller</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Eichenbaum</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Buffalo</surname>, <given-names>E.A.</given-names></string-name>, <string-name><surname>Davachi</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Foster</surname>, <given-names>D.J.</given-names></string-name>, <string-name><surname>Leutgeb</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Ranganath</surname>, <given-names>C</given-names></string-name>. (<year>2015</year>). <article-title>Memory and Space: Towards an Understanding of the Cognitive Map</article-title>. <source>J. Neurosci. Off. J. Soc. Neurosci</source>. <volume>35</volume>, <fpage>13904</fpage>–<lpage>13911</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.2618-15.2015</pub-id>.</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Constantinescu</surname>, <given-names>A.O.</given-names></string-name>, <string-name><surname>O’Reilly</surname>, <given-names>J.X.</given-names></string-name>, and <string-name><surname>Behrens</surname>, <given-names>T.E.J</given-names></string-name>. (<year>2016</year>). <article-title>Organizing conceptual knowledge in humans with a gridlike code</article-title>. <source>Science</source> <volume>352</volume>, <fpage>1464</fpage>–<lpage>1468</lpage>. <pub-id pub-id-type="doi">10.1126/science.aaf0941</pub-id>.</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><string-name><surname>Hawkins</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Lewis</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Klukas</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Purdy</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Ahmad</surname>, <given-names>S</given-names></string-name>. (<year>2018</year>). <article-title>A Framework for Intelligence and Cortical Function Based on Grid Cells in the Neocortex</article-title>. <source>Front. Neural Circuits</source> <volume>12</volume>, <issue>121</issue>. <pub-id pub-id-type="doi">10.3389/fncir.2018.00121</pub-id>.</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Rueckemann</surname>, <given-names>J.W.</given-names></string-name>, <string-name><surname>Sosa</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Giocomo</surname>, <given-names>L.M.</given-names></string-name>, and <string-name><surname>Buffalo</surname>, <given-names>E.A</given-names></string-name>. (<year>2021</year>). <article-title>The grid code for ordered experience</article-title>. <source>Nat. Rev. Neurosci</source>. <volume>22</volume>, <fpage>637</fpage>–<lpage>649</lpage>. <pub-id pub-id-type="doi">10.1038/s41583-021-00499-9</pub-id>.</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Jeffery</surname>, <given-names>K.J</given-names></string-name>. (<year>2024</year>). <article-title>The mosaic structure of the mammalian cognitive map</article-title>. <source>Learn. Behav</source>. <pub-id pub-id-type="doi">10.3758/s13420-023-00618-9</pub-id>.</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Ginosar</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Aljadeff</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Las</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Derdikman</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Ulanovsky</surname>, <given-names>N</given-names></string-name>. (<year>2023</year>). <article-title>Are grid cells used for navigation? On local metrics, subjective spaces, and black holes</article-title>. <source>Neuron</source> <volume>111</volume>, <fpage>1858</fpage>–<lpage>1875</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2023.03.027</pub-id>.</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><string-name><surname>Bush</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Manson</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name>. (<year>2015</year>). <article-title>Using Grid Cells for Navigation</article-title>. <source>Neuron</source> <volume>87</volume>, <fpage>507</fpage>–<lpage>520</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2015.07.006</pub-id>.</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><string-name><surname>Erdem</surname>, <given-names>U.M.</given-names></string-name>, and <string-name><surname>Hasselmo</surname>, <given-names>M.E</given-names></string-name>. (<year>2014</year>). <article-title>A biologically inspired hierarchical goal directed navigation model</article-title>. <source>J. Physiol. Paris</source> <volume>108</volume>, <fpage>28</fpage>–<lpage>37</lpage>. <pub-id pub-id-type="doi">10.1016/j.jphysparis.2013.07.002</pub-id>.</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>O’Keefe</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name>. (<year>2005</year>). <article-title>Dual phase and rate coding in hippocampal place cells: theoretical significance and relationship to entorhinal grid cells</article-title>. <source>Hippocampus</source> <volume>15</volume>, <fpage>853</fpage>–<lpage>866</lpage>. <pub-id pub-id-type="doi">10.1002/hipo.20115</pub-id>.</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Burgess</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, and <string-name><surname>O’Keefe</surname>, <given-names>J</given-names></string-name>. (<year>2007</year>). <article-title>An oscillatory interference model of grid cell firing</article-title>. <source>Hippocampus</source> <volume>17</volume>, <fpage>801</fpage>–<lpage>812</lpage>. <pub-id pub-id-type="doi">10.1002/hipo.20327</pub-id>.</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Giocomo</surname>, <given-names>L.M.</given-names></string-name>, <string-name><surname>Zilli</surname>, <given-names>E.A.</given-names></string-name>, <string-name><surname>Fransén</surname>, <given-names>E.</given-names></string-name>, and <string-name><surname>Hasselmo</surname>, <given-names>M.E</given-names></string-name>. (<year>2007</year>). <article-title>Temporal frequency of subthreshold oscillations scales with entorhinal grid cell field spacing</article-title>. <source>Science</source> <volume>315</volume>, <fpage>1719</fpage>–<lpage>1722</lpage>. <pub-id pub-id-type="doi">10.1126/science.1139207</pub-id>.</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>Hasselmo</surname>, <given-names>M.E.</given-names></string-name>, <string-name><surname>Giocomo</surname>, <given-names>L.M.</given-names></string-name>, and <string-name><surname>Zilli</surname>, <given-names>E.A</given-names></string-name>. (<year>2007</year>). <article-title>Grid cell firing may arise from interference of theta frequency membrane potential oscillations in single neurons</article-title>. <source>Hippocampus</source> <volume>17</volume>, <fpage>1252</fpage>–<lpage>1271</lpage>. <pub-id pub-id-type="doi">10.1002/hipo.20374</pub-id>.</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name>. (<year>2008</year>). <article-title>Grid cells and theta as oscillatory interference: theory and predictions</article-title>. <source>Hippocampus</source> <volume>18</volume>, <fpage>1157</fpage>–<lpage>1174</lpage>. <pub-id pub-id-type="doi">10.1002/hipo.20518</pub-id>.</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Burak</surname>, <given-names>Y.</given-names></string-name>, and <string-name><surname>Fiete</surname>, <given-names>I.R</given-names></string-name>. (<year>2009</year>). <article-title>Accurate path integration in continuous attractor network models of grid cells</article-title>. <source>PLoS Comput. Biol</source>. <volume>5</volume>, <fpage>e1000291</fpage>. <pub-id pub-id-type="doi">10.1371/journal.pcbi.1000291</pub-id>.</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Shipston-Sharman</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Solanka</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Nolan</surname>, <given-names>M.F</given-names></string-name>. (<year>2016</year>). <article-title>Continuous attractor network models of grid cell firing based on excitatory-inhibitory interactions</article-title>. <source>J. Physiol</source>. <volume>594</volume>, <fpage>6547</fpage>–<lpage>6557</lpage>. <pub-id pub-id-type="doi">10.1113/JP270630</pub-id>.</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><string-name><surname>Zilli</surname>, <given-names>E.A</given-names></string-name>. (<year>2012</year>). <article-title>Models of grid cell spatial firing published 2005-2011</article-title>. <source>Front. Neural Circuits</source> <volume>6</volume>, <issue>16</issue>. <pub-id pub-id-type="doi">10.3389/fncir.2012.00016</pub-id>.</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Couey</surname>, <given-names>J.J.</given-names></string-name>, <string-name><surname>Witoelar</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>S.-J.</given-names></string-name>, <string-name><surname>Zheng</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Ye</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Dunn</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Czajkowski</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E.I.</given-names></string-name>, <string-name><surname>Roudi</surname>, <given-names>Y.</given-names></string-name>, <etal>et al.</etal> (<year>2013</year>). <article-title>Recurrent inhibitory circuitry as a mechanism for grid formation</article-title>. <source>Nat. Neurosci</source>. <volume>16</volume>, <fpage>318</fpage>–<lpage>324</lpage>. <pub-id pub-id-type="doi">10.1038/nn.3310</pub-id>.</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Zutshi</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Fu</surname>, <given-names>M.L.</given-names></string-name>, <string-name><surname>Lilascharoen</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Leutgeb</surname>, <given-names>J.K.</given-names></string-name>, <string-name><surname>Lim</surname>, <given-names>B.K.</given-names></string-name>, and <string-name><surname>Leutgeb</surname>, <given-names>S</given-names></string-name>. (<year>2018</year>). <article-title>Recurrent circuits within medial entorhinal cortex superficial layers support grid cell firing</article-title>. <source>Nat. Commun</source>. <volume>9</volume>, <issue>3701</issue>. <pub-id pub-id-type="doi">10.1038/s41467-018-06104-5</pub-id>.</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="book"><string-name><surname>Marr</surname>, <given-names>D.</given-names></string-name> (<year>2010</year>). <source>Vision: a computational investigation into the human representation and processing of visual information</source> (<publisher-name>MIT Press</publisher-name>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><string-name><surname>Liu</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Todorova</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Tang</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Oliva</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Fernandez-Ruiz</surname>, <given-names>A</given-names></string-name>. (<year>2023</year>). <article-title>Associative and predictive hippocampal codes support memory-guided behaviors</article-title>. <source>Science</source> <volume>382</volume>, <fpage>eadi8237</fpage>. <pub-id pub-id-type="doi">10.1126/science.adi8237</pub-id>.</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><string-name><surname>Buzsáki</surname>, <given-names>G</given-names></string-name>. (<year>2010</year>). <article-title>Neural syntax: cell assemblies, synapsembles, and readers</article-title>. <source>Neuron</source> <volume>68</volume>, <fpage>362</fpage>–<lpage>385</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2010.09.023</pub-id>.</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>McKenzie</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Davachi</surname>, <given-names>L</given-names></string-name>. (<year>2022</year>). <article-title>Neurophysiology of Remembering</article-title>. <source>Annu. Rev. Psychol</source>. <volume>73</volume>, null. <pub-id pub-id-type="doi">10.1146/annurev-psych-021721-110002</pub-id>.</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Zutshi</surname>, <given-names>I.</given-names></string-name>, <string-name><surname>Leutgeb</surname>, <given-names>J.K.</given-names></string-name>, and <string-name><surname>Leutgeb</surname>, <given-names>S</given-names></string-name>. (<year>2017</year>). <article-title>Theta sequences of grid cell populations can provide a movement-direction signal</article-title>. <source>Curr. Opin. Behav. Sci</source>. <volume>17</volume>, <fpage>147</fpage>–<lpage>154</lpage>. <pub-id pub-id-type="doi">10.1016/j.cobeha.2017.08.012</pub-id>.</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Allen</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Gil</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Resnik</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Toader</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Seeburg</surname>, <given-names>P.</given-names></string-name>, and <string-name><surname>Monyer</surname>, <given-names>H</given-names></string-name>. (<year>2014</year>). <article-title>Impaired path integration and grid cell spatial periodicity in mice lacking GluA1-containing AMPA receptors</article-title>. <source>J. Neurosci. Off. J. Soc. Neurosci</source>. <volume>34</volume>, <fpage>6245</fpage>–<lpage>6259</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.4330-13.2014</pub-id>.</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Gil</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Ancau</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Schlesiger</surname>, <given-names>M.I.</given-names></string-name>, <string-name><surname>Neitz</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Allen</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>De Marco</surname>, <given-names>R.J.</given-names></string-name>, and <string-name><surname>Monyer</surname>, <given-names>H.</given-names></string-name> (<year>2018</year>). <article-title>Impaired path integration in mice with disrupted grid cell firing</article-title>. <source>Nat. Neurosci</source>. <volume>21</volume>, <fpage>81</fpage>–<lpage>91</lpage>. <pub-id pub-id-type="doi">10.1038/s41593-017-0039-3</pub-id>.</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Sorscher</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Mel</surname>, <given-names>G.C.</given-names></string-name>, <string-name><surname>Ocko</surname>, <given-names>S.A.</given-names></string-name>, <string-name><surname>Giocomo</surname>, <given-names>L.M.</given-names></string-name>, and <string-name><surname>Ganguli</surname>, <given-names>S</given-names></string-name>. (<year>2023</year>). <article-title>A unified theory for the computational and mechanistic origins of grid cells</article-title>. <source>Neuron</source> <volume>111</volume>, <fpage>121</fpage>–<lpage>137</lpage>.e13. <pub-id pub-id-type="doi">10.1016/j.neuron.2022.10.003</pub-id>.</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Thue</surname>, <given-names>A</given-names></string-name>. (<year>1910</year>). <article-title>Über die dichteste Zusammenstellung von kongruenten Kreisen in einer Ebene</article-title>. <source>Norske Vid. Selsk. Skr</source>. <volume>1</volume>, <fpage>1</fpage>–<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Tóth</surname>, <given-names>L.F</given-names></string-name>. (<year>1942</year>). <article-title>Über die dichteste Kugellagerung</article-title>. <source>Math. Z</source>. <volume>48</volume>, <fpage>676</fpage>–<lpage>684</lpage>. <pub-id pub-id-type="doi">10.1007/BF01180035</pub-id>.</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="book"><string-name><surname>Kittel</surname>, <given-names>C.</given-names></string-name> (<year>1966</year>). <source>Introduction to solid state physics</source> <edition>3rd</edition> ed. (<publisher-name>Wiley</publisher-name>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Stensola</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Stensola</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>E.I</given-names></string-name>. (<year>2015</year>). <article-title>Shearing-induced asymmetry in entorhinal grid cells</article-title>. <source>Nature</source> <volume>518</volume>, <fpage>207</fpage>–<lpage>212</lpage>. <pub-id pub-id-type="doi">10.1038/nature14151</pub-id>.</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><surname>Gleeson</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Davison</surname>, <given-names>A.P.</given-names></string-name>, <string-name><surname>Silver</surname>, <given-names>R.A.</given-names></string-name>, and <string-name><surname>Ascoli</surname>, <given-names>G.A</given-names></string-name>. (<year>2017</year>). <article-title>A Commitment to Open Source in Neuroscience</article-title>. <source>Neuron</source> <volume>96</volume>, <fpage>964</fpage>–<lpage>965</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2017.10.013</pub-id>.</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Hafting</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Witter</surname>, <given-names>M.P.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E.I.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>M.-B</given-names></string-name>. (<year>2008</year>). <article-title>Grid cells in mice</article-title>. <source>Hippocampus</source> <volume>18</volume>, <fpage>1230</fpage>–<lpage>1238</lpage>. <pub-id pub-id-type="doi">10.1002/hipo.20472</pub-id>.</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><string-name><surname>Yartsev</surname>, <given-names>M.M.</given-names></string-name>, <string-name><surname>Witter</surname>, <given-names>M.P.</given-names></string-name>, and <string-name><surname>Ulanovsky</surname>, <given-names>N</given-names></string-name>. (<year>2011</year>). <article-title>Grid cells without theta oscillations in the entorhinal cortex of bats</article-title>. <source>Nature</source> <volume>479</volume>, <fpage>103</fpage>–<lpage>107</lpage>. <pub-id pub-id-type="doi">10.1038/nature10583</pub-id>.</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><string-name><surname>Dannenberg</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Lazaro</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Nambiar</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Hoyland</surname>, <given-names>A.</given-names></string-name>, and <string-name><surname>Hasselmo</surname>, <given-names>M.E</given-names></string-name>. (<year>2020</year>). <article-title>Effects of visual inputs on neural dynamics for coding of location and running speed in medial entorhinal cortex</article-title>. <source>eLife</source> <volume>9</volume>, <fpage>e62500</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.62500</pub-id>.</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><string-name><surname>Derdikman</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Whitlock</surname>, <given-names>J.R.</given-names></string-name>, <string-name><surname>Tsao</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Hafting</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>E.I</given-names></string-name>. (<year>2009</year>). <article-title>Fragmentation of grid cell maps in a multicompartment environment</article-title>. <source>Nat Neurosci</source>. <pub-id pub-id-type="doi">10.1038/nn.2396</pub-id>.</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><string-name><surname>Jacob</surname>, <given-names>P.-Y.</given-names></string-name>, <string-name><surname>Capitano</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Poucet</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Save</surname>, <given-names>E.</given-names></string-name>, and <string-name><surname>Sargolini</surname>, <given-names>F</given-names></string-name>. (<year>2019</year>). <article-title>Path integration maintains spatial periodicity of grid cell firing in a 1D circular track</article-title>. <source>Nat. Commun</source>. <volume>10</volume>, <fpage>1</fpage>–<lpage>13</lpage>. <pub-id pub-id-type="doi">10.1038/s41467-019-08795-w</pub-id>.</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><string-name><surname>Pröll</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Häusler</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Herz</surname>, <given-names>A.V.M</given-names></string-name>. (<year>2018</year>). <article-title>Grid-cell activity on linear tracks indicates purely translational remapping of 2D firing patterns at movement turning points</article-title>. <source>J. Neurosci. Off. J. Soc. Neurosci</source>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.0413-18.2018</pub-id>.</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><string-name><surname>Dombeck</surname>, <given-names>D.A.</given-names></string-name>, <string-name><surname>Harvey</surname>, <given-names>C.D.</given-names></string-name>, <string-name><surname>Tian</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Looger</surname>, <given-names>L.L.</given-names></string-name>, and <string-name><surname>Tank</surname>, <given-names>D.W</given-names></string-name>. (<year>2010</year>). <article-title>Functional imaging of hippocampal place cells at cellular resolution during virtual navigation</article-title>. <source>Nat. Neurosci</source>. <volume>13</volume>, <fpage>1433</fpage>–<lpage>1440</lpage>. <pub-id pub-id-type="doi">10.1038/nn.2648</pub-id>.</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><string-name><surname>Kraus</surname>, <given-names>B.J.</given-names></string-name>, <string-name><surname>Brandon</surname>, <given-names>M.P.</given-names></string-name>, <string-name><surname>Robinson</surname>, <given-names>R.J.</given-names></string-name>, <string-name><surname>Connerney</surname>, <given-names>M.A.</given-names></string-name>, <string-name><surname>Hasselmo</surname>, <given-names>M.E.</given-names></string-name>, and <string-name><surname>Eichenbaum</surname>, <given-names>H</given-names></string-name>. (<year>2015</year>). <article-title>During Running in Place, Grid Cells Integrate Elapsed Time and Distance Run</article-title>. <source>Neuron</source> <volume>88</volume>, <fpage>578</fpage>–<lpage>589</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuron.2015.09.031</pub-id>.</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Hayman</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Burgess</surname>, <given-names>N.</given-names></string-name>, and <string-name><surname>Jeffery</surname>, <given-names>K.J.</given-names></string-name> (<year>2007</year>). <article-title>Experience-dependent rescaling of entorhinal grids</article-title>. <source>Nat. Neurosci</source>. <volume>10</volume>, <fpage>682</fpage>–<lpage>684</lpage>. <pub-id pub-id-type="doi">10.1038/nn1905</pub-id>.</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><string-name><surname>Wernle</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Waaga</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Mørreaunet</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Treves</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>E.I.</given-names></string-name> (<year>2018</year>). <article-title>Integration of grid maps in merged environments</article-title>. <source>Nat. Neurosci</source>. <volume>21</volume>, <fpage>92</fpage>–<lpage>101</lpage>. <pub-id pub-id-type="doi">10.1038/s41593-017-0036-6</pub-id>.</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="journal"><string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Ginzberg</surname>, <given-names>L.L.</given-names></string-name>, <string-name><surname>O’Keefe</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name>. (<year>2012</year>). <article-title>Grid cell firing patterns signal environmental novelty by expansion</article-title>. <source>Proc. Natl. Acad. Sci. U. S. A</source>. <volume>109</volume>, <fpage>17687</fpage>–<lpage>17692</lpage>. <pub-id pub-id-type="doi">10.1073/pnas.1209918109</pub-id>.</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><string-name><surname>Casali</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Bush</surname>, <given-names>D.</given-names></string-name>, and <string-name><surname>Jeffery</surname>, <given-names>K.</given-names></string-name> (<year>2019</year>). <article-title>Altered neural odometry in the vertical dimension</article-title>. <source>Proc. Natl. Acad. Sci</source>., <fpage>201811867</fpage>. <pub-id pub-id-type="doi">10.1073/pnas.1811867116</pub-id>.</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><string-name><surname>Wilson</surname>, <given-names>M.A.</given-names></string-name>, and <string-name><surname>McNaughton</surname>, <given-names>B.L</given-names></string-name>. (<year>1993</year>). <article-title>Dynamics of the hippocampal ensemble code for space</article-title>. <source>Science</source> <volume>261</volume>, <fpage>1055</fpage>–<lpage>1058</lpage>. <pub-id pub-id-type="doi">10.1126/science.8351520</pub-id>.</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><string-name><surname>Karlsson</surname>, <given-names>M.P.</given-names></string-name>, and <string-name><surname>Frank</surname>, <given-names>L.M</given-names></string-name>. (<year>2008</year>). <article-title>Network dynamics underlying the formation of sparse, informative representations in the hippocampus</article-title>. <source>J. Neurosci. Off. J. Soc. Neurosci</source>. <volume>28</volume>, <fpage>14271</fpage>–<lpage>14281</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.4261-08.2008</pub-id>.</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><string-name><surname>Boccara</surname>, <given-names>C.N.</given-names></string-name>, <string-name><surname>Nardin</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Stella</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>O’Neill</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Csicsvari</surname>, <given-names>J</given-names></string-name>. (<year>2019</year>). <article-title>The entorhinal cognitive map is attracted to goals</article-title>. <source>Science</source> <volume>363</volume>, <fpage>1443</fpage>–<lpage>1447</lpage>. <pub-id pub-id-type="doi">10.1126/science.aav4837</pub-id>.</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><string-name><surname>Butler</surname>, <given-names>W.N.</given-names></string-name>, <string-name><surname>Hardcastle</surname>, <given-names>K.</given-names></string-name>, and <string-name><surname>Giocomo</surname>, <given-names>L.M</given-names></string-name>. (<year>2019</year>). <article-title>Remembered reward locations restructure entorhinal spatial maps</article-title>. <source>Science</source> <volume>363</volume>, <fpage>1447</fpage>–<lpage>1452</lpage>. <pub-id pub-id-type="doi">10.1126/science.aav5297</pub-id>.</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="journal"><string-name><surname>Stensola</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Stensola</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Solstad</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Frøland</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>E.I</given-names></string-name>. (<year>2012</year>). <article-title>The entorhinal grid map is discretized</article-title>. <source>Nature</source> <volume>492</volume>, <fpage>72</fpage>–<lpage>78</lpage>. <pub-id pub-id-type="doi">10.1038/nature11649</pub-id>.</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="journal"><string-name><surname>Williams</surname>, <given-names>L.</given-names></string-name> (<year>1983</year>). <article-title>Pyramidal parametrics</article-title>. <source>Proc. 10th Annu. Conf. Comput. Graph. Interact. Tech</source>. <pub-id pub-id-type="doi">10.1145/800059</pub-id>.</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="journal"><string-name><surname>Mathis</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Stemmler</surname>, <given-names>M.B.</given-names></string-name>, and <string-name><surname>Herz</surname>, <given-names>A.V</given-names></string-name>. (<year>2015</year>). <article-title>Probable nature of higher-dimensional symmetries underlying mammalian grid-cell activity patterns</article-title>. <source>eLife</source> <volume>4</volume>. <pub-id pub-id-type="doi">10.7554/eLife.05979</pub-id>.</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><string-name><surname>Wei</surname>, <given-names>X.-X.</given-names></string-name>, <string-name><surname>Prentice</surname>, <given-names>J.</given-names></string-name>, and <string-name><surname>Balasubramanian</surname>, <given-names>V</given-names></string-name>. (<year>2015</year>). <article-title>A principle of economy predicts the functional architecture of grid cells</article-title>. <source>eLife</source> <volume>4</volume>, <fpage>e08362</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.08362</pub-id>.</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="journal"><string-name><surname>Banino</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Uria</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Blundell</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Lillicrap</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Mirowski</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Pritzel</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Chadwick</surname>, <given-names>M.J.</given-names></string-name>, <string-name><surname>Degris</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Modayil</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal> (<year>2018</year>). <article-title>Vector-based navigation using grid-like representations in artificial agents</article-title>. <source>Nature</source> <volume>557</volume>, <fpage>429</fpage>–<lpage>433</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-018-0102-6</pub-id>.</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="journal"><string-name><surname>Cueva</surname>, <given-names>C.J.</given-names></string-name>, and <string-name><surname>Wei</surname>, <given-names>X.-X.</given-names></string-name> (<year>2018</year>). <article-title>Emergence of grid-like representations by training recurrent neural networks to perform spatial localization</article-title>. <source>Preprint at arXiv</source>, <pub-id pub-id-type="doi">10.48550/arXiv.1803.07770</pub-id> 10.48550/arXiv.1803.07770.</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="journal"><string-name><given-names>Rylan</given-names> <surname>Schaeffer</surname></string-name>, <string-name><given-names>Mikail</given-names> <surname>Khona</surname></string-name>, and <string-name><given-names>Ila Rani</given-names> <surname>Fiete</surname></string-name> (<year>2022</year>). <article-title>No Free Lunch from Deep Learning in Neuroscience: A Case Study through Models of the Entorhinal-Hippocampal Circuit</article-title>. <source>bioRxiv</source>, 2022.08.07.503109. <pub-id pub-id-type="doi">10.1101/2022.08.07.503109</pub-id>.</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="journal"><string-name><surname>Laughlin</surname>, <given-names>S.B.</given-names></string-name>, and <string-name><surname>Sejnowski</surname>, <given-names>T.J</given-names></string-name>. (<year>2003</year>). <article-title>Communication in Neuronal Networks</article-title>. <source>Science</source> <volume>301</volume>, <fpage>1870</fpage>– <lpage>1874</lpage>. <pub-id pub-id-type="doi">10.1126/science.1089662</pub-id>.</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="journal"><string-name><surname>Chaudhuri-Vayalambrone</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Rule</surname>, <given-names>M.E.</given-names></string-name>, <string-name><surname>Bauza</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Krstulovic</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Kerekes</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Burton</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>O’Leary</surname>, <given-names>T.</given-names></string-name>, and <string-name><surname>Krupic</surname>, <given-names>J</given-names></string-name>. (<year>2023</year>). <article-title>Simultaneous representation of multiple time horizons by entorhinal grid cells and CA1 place cells</article-title>. <source>Cell Rep</source>. <volume>42</volume>, <issue>112716</issue>. <pub-id pub-id-type="doi">10.1016/j.celrep.2023.112716</pub-id>.</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><string-name><surname>Kunz</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Schröder</surname>, <given-names>T.N.</given-names></string-name>, <string-name><surname>Lee</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Montag</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Lachmann</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Sariyska</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Reuter</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Stirnberg</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Stöcker</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Messing-Floeter</surname>, <given-names>P.C.</given-names></string-name>, <etal>et al.</etal> (<year>2015</year>). <article-title>Reduced grid-cell-like representations in adults at genetic risk for Alzheimer’s disease</article-title>. <source>Science</source> <volume>350</volume>, <fpage>430</fpage>–<lpage>433</lpage>. <pub-id pub-id-type="doi">10.1126/science.aac8128</pub-id>.</mixed-citation></ref>
<ref id="c66"><label>66.</label><mixed-citation publication-type="journal"><string-name><surname>Bierbrauer</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Kunz</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Gomes</surname>, <given-names>C.A.</given-names></string-name>, <string-name><surname>Luhmann</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Deuker</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Getzmann</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Wascher</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Gajewski</surname>, <given-names>P.D.</given-names></string-name>, <string-name><surname>Hengstler</surname>, <given-names>J.G.</given-names></string-name>, <string-name><surname>Fernandez-Alvarez</surname>, <given-names>M.</given-names></string-name>, <etal>et al.</etal> (<year>2020</year>). <article-title>Unmasking selective path integration deficits in Alzheimer’s disease risk carriers</article-title>. <source>Sci. Adv</source>. <volume>6</volume>, <fpage>eaba1394</fpage>. <pub-id pub-id-type="doi">10.1126/sciadv.aba1394</pub-id>.</mixed-citation></ref>
<ref id="c67"><label>67.</label><mixed-citation publication-type="journal"><string-name><surname>Ying</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Keinath</surname>, <given-names>A.T.</given-names></string-name>, <string-name><surname>Lavoie</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Vigneault</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>El Mestikawy</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Brandon</surname>, <given-names>M.P</given-names></string-name>. (<year>2022</year>). <article-title>Disruption of the grid cell network in a mouse model of early Alzheimer’s disease</article-title>. <source>Nat. Commun</source>. <volume>13</volume>, <issue>886</issue>. <pub-id pub-id-type="doi">10.1038/s41467-022-28551-x</pub-id>.</mixed-citation></ref>
<ref id="c68"><label>68.</label><mixed-citation publication-type="journal"><string-name><surname>Ying</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Reboreda</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Yoshida</surname>, <given-names>M.</given-names></string-name>, and <string-name><surname>Brandon</surname>, <given-names>M.P</given-names></string-name>. (<year>2023</year>). <article-title>Grid cell disruption in a mouse model of early Alzheimer’s disease reflects reduced integration of self-motion cues</article-title>. <source>Curr. Biol. CB</source>, <volume>S0960–9822</volume>(<issue>23</issue>)<fpage>00547</fpage>-<lpage>X</lpage>. <pub-id pub-id-type="doi">10.1016/j.cub.2023.04.065</pub-id>.</mixed-citation></ref>
<ref id="c69"><label>69.</label><mixed-citation publication-type="journal"><string-name><surname>Stella</surname>, <given-names>F.</given-names></string-name>, and <string-name><surname>Treves</surname>, <given-names>A</given-names></string-name>. (<year>2015</year>). <article-title>The self-organization of grid cells in 3D</article-title>. <source>eLife</source> <volume>4</volume>, <fpage>e05913</fpage>. <pub-id pub-id-type="doi">10.7554/eLife.05913</pub-id>.</mixed-citation></ref>
<ref id="c70"><label>70.</label><mixed-citation publication-type="web"><string-name><surname>Weisstein</surname>, <given-names>E.W.</given-names></string-name> <source>Sphere Packing</source>. <ext-link ext-link-type="uri" xlink:href="https://mathworld.wolfram.com/">https://mathworld.wolfram.com/</ext-link>.</mixed-citation></ref>
<ref id="c71"><label>71.</label><mixed-citation publication-type="book"><string-name><surname>Conway</surname>, <given-names>J.H.</given-names></string-name>, and <string-name><surname>Sloane</surname>, <given-names>N.J.A</given-names></string-name>. (<year>1999</year>). <source>Sphere packings, lattices, and groups</source> <edition>3rd</edition> ed. (<publisher-name>Springer</publisher-name>).</mixed-citation></ref>
<ref id="c72"><label>72.</label><mixed-citation publication-type="journal"><string-name><surname>Grieves</surname>, <given-names>R.M.</given-names></string-name>, <string-name><surname>Jedidi-Ayoub</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Mishchanchuk</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Renaudineau</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Duvelle</surname>, <given-names>É.</given-names></string-name>, and <string-name><surname>Jeffery</surname>, <given-names>K.J</given-names></string-name>. (<year>2021</year>). <article-title>Irregular distribution of grid cell firing fields in rats exploring a 3D volumetric space</article-title>. <source>Nat. Neurosci</source>. <volume>24</volume>, <fpage>1567</fpage>–<lpage>1573</lpage>. <pub-id pub-id-type="doi">10.1038/s41593-021-00907-4</pub-id>.</mixed-citation></ref>
<ref id="c73"><label>73.</label><mixed-citation publication-type="journal"><string-name><surname>Ginosar</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Aljadeff</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Burak</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Sompolinsky</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Las</surname>, <given-names>L.</given-names></string-name>, and <string-name><surname>Ulanovsky</surname>, <given-names>N</given-names></string-name>. (<year>2021</year>). <article-title>Locally ordered representation of 3D space in the entorhinal cortex</article-title>. <source>Nature</source> <volume>596</volume>, <fpage>404</fpage>–<lpage>409</lpage>. <pub-id pub-id-type="doi">10.1038/s41586-021-03783-x</pub-id>.</mixed-citation></ref>
<ref id="c74"><label>74.</label><mixed-citation publication-type="journal"><string-name><surname>Jeffery</surname>, <given-names>K.J</given-names></string-name>. (<year>2023</year>). <article-title>Symmetries and asymmetries in the neural encoding of 3D space</article-title>. <source>Philos. Trans. R. Soc. Lond. B. Biol. Sci</source>. <volume>378</volume>, <issue>20210452</issue>. <pub-id pub-id-type="doi">10.1098/rstb.2021.0452</pub-id>.</mixed-citation></ref>
<ref id="c75"><label>75.</label><mixed-citation publication-type="journal"><string-name><surname>Dannenberg</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Kelley</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Hoyland</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Monaghan</surname>, <given-names>C.K.</given-names></string-name>, and <string-name><surname>Hasselmo</surname>, <given-names>M.E</given-names></string-name>. (<year>2019</year>). <article-title>The Firing Rate Speed Code of Entorhinal Speed Cells Differs across Behaviorally Relevant Time Scales and Does Not Depend on Medial Septum Inputs</article-title>. <source>J. Neurosci</source>. <volume>39</volume>, <fpage>3434</fpage>–<lpage>3453</lpage>. <pub-id pub-id-type="doi">10.1523/JNEUROSCI.1450-18.2019</pub-id>.</mixed-citation></ref>
<ref id="c76"><label>76.</label><mixed-citation publication-type="journal"><string-name><surname>Sargolini</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Hafting</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>McNaughton</surname>, <given-names>B.L.</given-names></string-name>, <string-name><surname>Witter</surname>, <given-names>M.P.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name>, and <string-name><surname>Moser</surname>, <given-names>E.I</given-names></string-name>. (<year>2006</year>). <article-title>Conjunctive representation of position, direction, and velocity in entorhinal cortex</article-title>. <source>Science</source> <volume>312</volume>, <fpage>758</fpage>– <lpage>762</lpage>. <pub-id pub-id-type="doi">10.1126/science.1125572</pub-id>.</mixed-citation></ref>
<ref id="c77"><label>77.</label><mixed-citation publication-type="journal"><string-name><surname>Gatome</surname>, <given-names>C.W.</given-names></string-name>, <string-name><surname>Slomianka</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Lipp</surname>, <given-names>H.P.</given-names></string-name>, and <string-name><surname>Amrein</surname>, <given-names>I</given-names></string-name>. (<year>2010</year>). <article-title>Number estimates of neuronal phenotypes in layer II of the medial entorhinal cortex of rat and mouse</article-title>. <source>Neuroscience</source> <volume>170</volume>, <fpage>156</fpage>–<lpage>165</lpage>. <pub-id pub-id-type="doi">10.1016/j.neuroscience.2010.06.048</pub-id>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96627.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Peyrache</surname>
<given-names>Adrien</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>McGill University</institution>
</institution-wrap>
<city>Montreal</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>valuable</bold> study aims to present a mathematical theory for why the periodicity of the hexagonal pattern of grid cell firing would be helpful for encoding 2D spatial trajectories. The idea is supported by <bold>solid</bold> evidence, but some of the comparisons of theory to the experimental data seem <bold>incomplete</bold>, and the reasoning supporting some of the assumptions made should be strengthened. The work would be of interest to neuroscientists studying neural mechanisms of spatial navigation.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96627.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Rebecca R.G. et al. set to determine the function of grid cells. They present an interesting case claiming that the spatial periodicity seen in the grid pattern provides a parsimonious solution to the task of coding 2D trajectories using sequential cell activation. Thus, this work defines a probable function grid cells may serve (here, the function is coding 2D trajectories), and proves that the grid pattern is a solution to that function. This approach is somewhat reminiscent in concept to previous works that defined a probable function of grid cells (e.g., path integration) and constructed normative models for that function that yield a grid pattern. However, the model presented here gives clear geometric reasoning to its case.</p>
<p>Stemming from 4 axioms, the authors present a concise demonstration of the mathematical reasoning underlying their case. The argument is interesting and the reasoning is valid, and this work is a valuable addition to the ongoing body of work discussing the function of grid cells.</p>
<p>However, the case uses several assumptions that need to be clearly stated as assumptions, clarified, and elaborated on: Most importantly, the choice of grid function is grounded in two assumptions:</p>
<p>
(1) that the grid function relies on the activation of cell sequences, and</p>
<p>
(2) that the grid function is related to the coding of trajectories. While these are interesting and valid suggestions, since they are used as the basis of the argument, the current justification could be strengthened (references 28-30 deal with the hippocampus, reference 31 is interesting but cannot hold the whole case).</p>
<p>The work further leans on the assumption that sequences in the same direction should be similar regardless of their position in space, it is not clear why that should necessarily be the case, and how the position is extracted for similar sequences in different positions. The authors also strengthen their model with the requirement that grid cells should code for infinite space. However, the grid pattern anchors to borders and might be used to code navigated areas locally. Finally, referencing ref. 14, the authors claim that no existing theory for the emergence of grid cell firing that unifies the experimental observations on periodic firing patterns and their distortions under a single framework. However, that same reference presents exactly that - a mathematical model of pairwise interactions that unifies experimental observations. The authors should clarify this point.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96627.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>In this work, the authors consider why grid cells might exhibit hexagonal symmetry - i.e., for what behavioral function might this hexagonal pattern be uniquely suited? The authors propose that this function is the encoding of spatial trajectories in 2D space. To support their argument, the authors first introduce a set of definitions and axioms, which then lead to their conclusion that a hexagonal pattern is the most efficient or parsimonious pattern one could use to uniquely label different 2D trajectories using sequences of cells. The authors then go through a set of classic experimental results in the grid cell literature - e.g. that the grid modules exhibit a multiplicative scaling, that the grid pattern expands with novelty or is warped by reward, etc. - and describe how these results are either consistent with or predicted by their theory. Overall, this paper asks a very interesting question and provides an intriguing answer. However, the theory appears to be extremely flexible and very similar to ideas that have been previously proposed regarding grid cell function.</p>
<p>Major strengths:</p>
<p>The general idea behind the paper is very interesting - why *does* the grid pattern take the form of a hexagonal grid? This is a question that has been raised many times; finding a truly satisfying answer is difficult but of great interest to many in the field. The authors' main assertion that the answer to this question has to do with the ability of a hexagonal arrangement of neurons to uniquely encode 2D trajectories is an intriguing suggestion. It is also impressive that the authors considered such a wide range of experimental results in relation to their theory.</p>
<p>Major weaknesses:</p>
<p>One major weakness I perceive is that the paper overstates what it delivers, to an extent that I think it can be a bit confusing to determine what the contributions of the paper are. In the introduction, the authors claim to provide &quot;mathematical proof that ... the nature of the problem being solved by grid cells is coding of trajectories in 2-D space using cell sequences. By doing so, we offer a specific answer to the question of why grid cell firing patterns are observed in the mammalian brain.&quot; This paper does not provide proof of what grid cells are doing to support behavior or provide the true answer as to why grid patterns are found in the brain. The authors offer some intriguing suggestions or proposals as to why this might be based on what hexagonal patterns could be good for, but I believe that the language should be clarified to be more in line with what the authors present and what the strength of their evidence is.</p>
<p>Relatedly, the authors claim that they find a teleological reason for the existence of grid cells - that is, discover the function that they are used for. However, in the paper, they seem to instead assume a function based on what is known and generally predicted for grid cells (encode position), and then show that for this specific function, grid cells have several attractive properties.</p>
<p>There is also some other work that seems very relevant, as it discusses specific computational advantages of a grid cell code but was not cited here: <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/nn.2901">https://www.nature.com/articles/nn.2901</ext-link>.</p>
<p>A second major weakness was that some of the claims in the section in which they compared their theory to data seemed either confusing or a bit weak. I am not a mathematician, so I was not able to follow all of the logic of the various axioms, remarks, or definitions to understand how the authors got to their final conclusion, so perhaps that is part of the problem. But below I list some specific examples where I could not follow why their theory predicted the experimental result, or how their theory ultimately operated any differently from the conventional understanding of grid cell coding. In some cases, it also seemed that the general idea was so flexible that it perhaps didn't hold much predictive power, as extra details seemed to be added as necessary to make the theory fit with the data.</p>
<p>I don't quite follow how, for at least some of their model predictions, the 'sequence code of trajectories' theory differs from the general attractor network theory. It seems from the introduction that these theories are meant to serve different purposes, but the section of the paper in which the authors claim that various experimental results are predicted by their theory makes this comparison difficult for me to understand. For example, in the section describing the effect of environmental manipulations in a familiar environment, the authors state that the experimental results make sense if one assumes that sequences are anchored to landmarks. But this sounds just like the classic attractor-network interpretation of grid cell activity - that it's a spatial metric that becomes anchored to landmarks.</p>
<p>It was not clear to me why their theory predicted the field size/spacing ratio or the orientation of the grid pattern to the wall.</p>
<p>I don't understand how repeated advancement of one unit to the next, as shown in Figure 4E, would cause the change in grid spacing near a reward.</p>
<p>I don't follow how this theory predicts the finding that the grid pattern expands with novelty. The authors propose that this occurs because the animals are not paying attention to fine spatial details, and thus only need a low-resolution spatial map that eventually turns into a higher-resolution one. But it's not clear to me why one needs to invoke the sequence coding hypothesis to make this point.</p>
<p>The last section, which describes that the grid spacing of different modules is scaled by the square root of 2, says that this is predicted if the resolution is doubled or halved. I am not sure if this is specifically a prediction of the sequence coding theory the authors put forth though since it's unclear why the resolution should be doubled or halved across modules (as opposed to changed by another factor).</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.96627.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The manuscript presents an intriguing explanation for why grid cell firing fields do {\em not} lie on a lattice whose axes aligned to the walls of a square arena. This observation, by itself, merits the manuscript's dissemination to the journals audience.</p>
<p>The presentation is quirky (but keep the quirkiness!).</p>
<p>But let me recast the problem presented by the authors as one of combinatorics. Given repeating, spatially separated firing fields across cells, one obtains temporal sequences of grid cells firing. Label these cells by integers from $[n]$. Any two cells firing in succession should uniquely identify one of six directions (from the hexagonal lattice) in which the agent is currently moving.</p>
<p>Now, take the symmetric group $\Sigma$ of cyclic permutations on $n$ elements.</p>
<p>
We ask whether there are cyclic permutations of $[n]$ such that</p>
<disp-formula id="sa3equ1">
<graphic mime-subtype="jpg" xlink:href="elife-96627-sa3-equ1.jpg" mimetype="image"/>
</disp-formula>
<p>So, for instance, $(4,2,3,1)$ would not be counted as a valid permutation of $(1,2,3,4)$, as $(2,3)$ and $(1,4)$ are adjacent.</p>
<p>Furthermore, given $[n]$, are there two distinct cyclic permutations such that {\em no} adjacencies are preserved when considering any pair of permutations (among the triple of the original ordered sequence and the two permutations)? In other words, if we consider the permutation required to take the first permutation into the second, that permutation should not preserve any adjacencies.</p>
<p>{\bf Key question}: is there any difference between the solution to the combinatorics problem sketched above and the result in the manuscript? Specifically, the text argues that for $n=7$ there is only {\em one} solution.</p>
<p>Ideally, one would strive to obtain a closed-form solution for the number of such permutations as a function of $n$.</p>
</body>
</sub-article>
</article>