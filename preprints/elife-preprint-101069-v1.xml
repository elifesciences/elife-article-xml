<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:mml="http://www.w3.org/1998/Math/MathML" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">101069</article-id>
<article-id pub-id-type="doi">10.7554/eLife.101069</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.101069.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>μGUIDE: a framework for quantitative imaging via generalized uncertainty-driven inference using deep learning</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Jallais</surname>
<given-names>Maëliss</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
<email>jallaism@cardiff.ac.uk</email>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Palombo</surname>
<given-names>Marco</given-names>
</name>
<xref ref-type="aff" rid="A1">1</xref>
<xref ref-type="aff" rid="A2">2</xref>
</contrib>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Sui</surname>
<given-names>Jing</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Beijing Normal University</institution>
</institution-wrap>
<city>Beijing</city>
<country>China</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Walczak</surname>
<given-names>Aleksandra M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>CNRS</institution>
</institution-wrap>
<city>Paris</city>
<country>France</country>
</aff>
</contrib>
</contrib-group>
<aff id="A1"><label>1</label><institution>Cardiff University Brain Research Imaging Centre (CUBRIC), School of Psychology, Cardiff University</institution>, <addr-line>Cardiff</addr-line>, <country>United Kingdom</country>;</aff>
<aff id="A2"><label>2</label><institution>School of Computer Science and Informatics, Cardiff University</institution>, <addr-line>Cardiff</addr-line>, <country>United Kingdom</country></aff>
<pub-date pub-type="epub">
<day>27</day>
<month>06</month>
<year>2024</year>
</pub-date>
<pub-date date-type="original-publication" iso-8601-date="2024-08-22">
<day>22</day>
<month>08</month>
<year>2024</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP101069</elocation-id>
<history><date date-type="sent-for-review" iso-8601-date="2024-06-30">
<day>30</day>
<month>06</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-06-27">
<day>27</day>
<month>06</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.48550/arXiv.2312.17293"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2024, Jallais &amp; Palombo</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Jallais &amp; Palombo</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-101069-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>This work proposes μGUIDE: a general Bayesian framework to estimate posterior distributions of tissue microstructure parameters from any given biophysical model or signal representation, with exemplar demonstration in diffusion-weighted MRI. Harnessing a new deep learning architecture for automatic signal feature selection combined with simulationbased inference and efficient sampling of the posterior distributions, μGUIDE bypasses the high computational and time cost of conventional Bayesian approaches and does not rely on acquisition constraints to define model-specific summary statistics. The obtained posterior distributions allow to highlight degeneracies present in the model definition and quantify the uncertainty and ambiguity of the estimated parameters.</p>
</abstract>
</article-meta>
</front>
<body>
<sec id="s1" sec-type="intro">
<title>1 Introduction</title>
<p>Diffusion-weighted Magnetic Resonance Imaging (dMRI) is a promising technique for characterizing brain microstructure in-vivo using a paradigm called microstructure imaging [Novikov et al., 2018a, <xref ref-type="bibr" rid="R4">Alexander et al., 2019</xref>, <xref ref-type="bibr" rid="R40">Jelescu et al., 2020</xref>]. Traditionally, microstructure imaging quantifies histologically meaningful features of brain microstructure by fitting a forward (biophysical) model voxel-wise to the set of signals obtained from images acquired with different sensitivities, yielding model parameter maps [<xref ref-type="bibr" rid="R4">Alexander et al., 2019</xref>].</p>
<p>Most commonly used techniques rely on a non-linear curve fitting of the signal and return the optimal solution, i.e. the best parameters guess of the fitting procedure. However, this may hide model degeneracy, that is all the other possible estimates that could explain the observed signal equally well [<xref ref-type="bibr" rid="R39">Jelescu et al., 2016</xref>]. Another crucial consideration in model fitting is accounting for the uncertainty in parameter estimates. This uncertainty serves various purposes, including assessing result confidence [<xref ref-type="bibr" rid="R42">Jones, 2003</xref>], quantifying noise effects [<xref ref-type="bibr" rid="R8">Behrens et al., 2003</xref>] or assisting in experimental design [<xref ref-type="bibr" rid="R2">Alexander, 2008</xref>].</p>
<p>Instead of attempting to remove the degeneracies, which has been the focus of a large number of studies [Palombo et al., 2023, De Almeida Martins et al., 2021, <xref ref-type="bibr" rid="R75">Slator et al., 2021</xref>, <xref ref-type="bibr" rid="R41">Jelescu et al., 2022</xref>, <xref ref-type="bibr" rid="R86">Warner et al., 2023</xref>, Uhl et al., 2024, <xref ref-type="bibr" rid="R58">Mougel et al., 2024</xref>, <xref ref-type="bibr" rid="R61">Olesen et al., 2022</xref>, Palombo et al., 2020, <xref ref-type="bibr" rid="R34">Howard et al., 2022</xref>, <xref ref-type="bibr" rid="R43">Jones et al., 2018</xref>, <xref ref-type="bibr" rid="R84">Vincent et al., 2020</xref>, <xref ref-type="bibr" rid="R33">Henriques et al., 2021</xref>, <xref ref-type="bibr" rid="R1">Afzali et al., 2021</xref>, Lampinen et al., 2023, <xref ref-type="bibr" rid="R89">Zhang et al., 2012</xref>-07, <xref ref-type="bibr" rid="R29">Guerreri et al., 2023</xref>, <xref ref-type="bibr" rid="R31">Gyori et al., 2022</xref>, Novikov et al., 2018b], we propose to highlight them and present all the possible parameter values that could explain an observed signal, providing users with more information to make more confident and explainable use of the inference results.</p>
<p>Posterior distributions are powerful tools to characterize all the possible parameter estimations that could explain an observed measurement, their uncertainty, and existing model degeneracy [Box and Tiao, 2011]. Bayesian inference allows for the estimation of these posterior distributions, traditionally approximating them using numerical methods, such as Markov-Chain-Monte-Carlo (MCMC) [<xref ref-type="bibr" rid="R57">Metropolis et al., 1953</xref>]. In quantitative MRI, these methods have been used for example to estimate brain connectivity [<xref ref-type="bibr" rid="R8">Behrens et al., 2003</xref>], optimize imaging protocols [<xref ref-type="bibr" rid="R2">Alexander, 2008</xref>], or infer crossing fibers by combining multiple spatial resolutions [Sotiropoulos et al., 2013]. However, these classical Bayesian inference methods are computationally expensive and time consuming. They also often require adjustments and tuning specific to each biophysical model [<xref ref-type="bibr" rid="R32">Harms and Roebroeck, 2018</xref>].</p>
<p>Harnessing a new deep learning architecture for automatic signal feature selection and efficient sampling of the posterior distributions using simulation-based inference [<xref ref-type="bibr" rid="R16">Cranmer et al., 2020</xref>, <xref ref-type="bibr" rid="R53">Lueckmann et al., 2017</xref>, Papamakarios et al., 2019], here we propose μGUIDE: a general Bayesian framework to estimate posterior distributions of tissue microstructure parameters from any given biophysical model/signal representation. μGUIDE extends and generalises previous work [<xref ref-type="bibr" rid="R36">Jallais et al., 2022</xref>] to any forward model and without acquisition constraints, providing fast estimations of posterior distributions voxel-wise. We demonstrate μGUIDE using numerical simulations on three biophysical models of increasing complexity and degeneracy and compare the obtained estimates with existing methods, including the classical MCMC approach. We then apply the proposed framework to dMRI data acquired from healthy human volunteers and participants with epilepsy. μGUIDE framework is agnostic to the origin of the data and the details of the forward model, so we envision its usage and utility to perform Bayesian inference of model parameters also using data from other MRI modalities (e.g. relaxation MRI) and beyond.</p>
</sec>
<sec id="s2" sec-type="results">
<title>2 Results</title>
<sec id="s2-1">
<title>2.1 Framework overview</title>
<p>The full architecture of the proposed Bayesian framework, dubbed μGUIDE, is presented in <xref ref-type="fig" rid="fig1">Fig. 1</xref>. μGUIDE allows to efficiently estimate full posterior distributions of tissue parameters. It is comprised of two modules that are optimized together to minimize the Kullback-Leibler divergence between the true posterior distribution and the estimated one for every parameters of a given forward model. The ‘Neural Posterior Estimator’ (NPE) module [<xref ref-type="bibr" rid="R67">Papamakarios et al., 2017</xref>] uses normalizing flows [<xref ref-type="bibr" rid="R69">Papamakarios et al., 2021</xref>] to approximate the posterior distribution, while the ‘Multi-Layer Perceptron’ (MLP) module is used to reduce the data dimensionality and ensure fast and robust convergence of the NPE module.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>μGUIDE framework.</title>
<p>μGUIDE takes as input an observed data vector and relies on the definition of a biophysical or computational model [<xref ref-type="bibr" rid="R7">Ascoli et al., 2007</xref>, <xref ref-type="bibr" rid="R12">Callaghan et al., 2020</xref>, <xref ref-type="bibr" rid="R40">Jelescu et al., 2020</xref>]. It outputs a posterior distribution of the model parameters. Based on a SBI framework, it combines a Multi-Layer Perceptron (MLP) with 3 layers and a Neural Posterior Estimator (NPE). The MLP learns a low-dimensional representation of <bold>x</bold>, based on a small number of features <italic>(N<sub>f</sub></italic>), that can be either defined a priori or determined empirically during training. The MLP is trained simultaneously with the NPE, leading to the extraction of the optimal features that minimize the bias and uncertainty of <italic>p(<bold>θ</bold></italic>|<bold>x</bold>).</p></caption>
<graphic xlink:href="2312.17293v3_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>The full posterior distribution contains a lot of useful information. To summarize and easily visualize this information, we propose three measures that quantify the best estimates and the associated confidence levels, and a way to highlight degeneracy. The three measures are the Maximum A Posteriori (MAP), which corresponds to the most likely parameter estimate; an uncertainty measure, which quantifies the dispersion of the 50% most probable samples using the interquartile range, relative to the prior range; and an ambiguity measure, which measures the Full Width at Half Maximum (FWHM), in percentage with respect to the prior range. <xref ref-type="fig" rid="fig2">Fig. 2</xref> presents those measures on exemplar posterior distributions.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><title>μGUIDE summarizes information contained in the estimated posterior distributions.</title>
<p>A) Examples of degenerate and non-degenerate posterior distributions. B) Presentation of the measures introduced to quantify a posterior distribution on exemplar non-degenerate posterior distributions. Maximum A Posteriori (MAP): is the most likely parameter estimate (dashed vertical lines). Uncertainty: measures the dispersion of the 50% most probable samples using the interquartile range, with respect to the prior range. Ambiguity: measures the Full Width at Half Maximum (FWHM), in percentage with respect to the prior range.</p></caption>
<graphic xlink:href="2312.17293v3_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>We show exemplar applications of μGUIDE to three biophysical models of increasing complexity and degeneracy from the dMRI literature: Ball&amp;Stick [<xref ref-type="bibr" rid="R8">Behrens et al., 2003</xref>] (Model 1); Standard Model (SM) [Novikov et al., 2018a] (Model 2); and extended-SANDI [Palombo et al., 2020] (Model 3).</p>
</sec>
<sec id="s2-2">
<title>2.2 Evaluation of μGUIDE on simulations</title>
<sec id="s2-2-1">
<title>2.2.1 Comparison with MCMC</title>
<p>We performed a comparison between the posterior distributions obtained using μGUIDE and MCMC, a classical Bayesian method. <xref ref-type="fig" rid="fig3">Fig. 3A</xref> shows posterior distributions on three exemplar simulations with SNR = 50 using the model 2 (SM), obtained with 15000 samples. Sharper and less biased posterior estimations are obtained using μGUIDE. <xref ref-type="fig" rid="fig3">Fig. 3B</xref> presents histograms for each model parameter of the bias between the ground truth value used to simulate a signal, and the MAP of the posterior distributions obtained with either μGUIDE or MCMC, on 200 simulations. Results indicate that the bias is similar or smaller using μGUIDE. Overall, μGUIDE posterior distributions are more accurate than the ones obtained with MCMC.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><title>Comparison between μGUIDE and MCMC.</title>
<p>A) Posterior distributions obtained using either μGUIDE or MCMC on three exemplar simulations with model 2 (SM - SNR = 50). B) Bias between the ground truth values used for simulating the diffusion signals, and the maximum-a-posteriori extracted from the posterior distributions using either μGUIDE or MCMC. Sharper and less biased posterior distributions are obtained using μGUIDE.</p></caption>
<graphic xlink:href="2312.17293v3_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Moreover, it took on average 29.3 s to obtain the posterior distribution using MCMC on a GPU (NVIDIA GeForce GT 710) for one voxel, while it only took 0.02 s for μGUIDE. μGUIDE is about 1500 times faster than MCMC, which makes it more suitable for applying it on large datasets.</p>
</sec>
<sec id="s2-2-2">
<title>2.2.2 The importance of feature selection</title>
<p><xref ref-type="fig" rid="fig4">Fig. 4</xref> shows the MAP extracted from the posterior distributions versus the ground truth parameters used to generate the diffusion signal with μGUIDE and manually-defined summary statistics for the three models. Less biased MAPs with lower ambiguities and uncertainties are obtained with μGUIDE, indicating that the MLP allows for the extraction of additional information not contained in the summary statistics, helping to solve the inverse problem with higher accuracy and precision. μGUIDE generalizes the method developed in [<xref ref-type="bibr" rid="R36">Jallais et al., 2022</xref>] to make it applicable to any forward model and any acquisition protocol, while making the estimates more precise and accurate thanks to the automatic feature extraction.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><title>Fitting accuracy comparison between μGUIDE’s MLP-extracted features and manually-defined summary statistics.</title>
<p>Maximum-A-Posterioris extracted from the posterior distributions vs ground truth parameters used for generating the signal for the three models. Orange points correspond to the MAPs obtained using MLP-extracted features (μGUIDE) and the blue ones to the MAPs with the manually-defined summary statistics. Only the non-degenerate posterior distributions were kept. The summary statistics used in those three models are the direction-averaged signal for the Ball&amp;Stick model, the LEMONADE system of equations [Novikov et al., 2018b] for the SM, and the summary statistics defined in [<xref ref-type="bibr" rid="R36">Jallais et al., 2022</xref>] for the extended-SANDI model. Results are shown on 100 exemplar noise-free simulations with random parameter combinations. The optimal features extracted by the MLP allow to reduce the bias and variance of the obtained microstructure posterior distributions.</p></caption>
<graphic xlink:href="2312.17293v3_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2-2-3">
<title>2.2.3 μGUIDE highlights degeneracies</title>
<p><xref ref-type="fig" rid="fig5">Fig. 5</xref> presents the posterior distributions of microstructure parameters for the three models obtained with μGUIDE on exemplar noise-free simulations. Blue curves correspond to non-degenerate posterior distributions, while the red ones present at least one degeneracy for one of the parameters. As the complexity of the model increases, degeneracy in the model definitions appear. This figure showcases μGUIDE ability to highlight degeneracy in the model parameter estimation.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><title>Exemplar posterior distributions of the microstructure parameters for the Ball&amp;Stick, SM and extended SANDI models, obtained using μGUIDE on exemplar noise-free simulations.</title>
<p>As the complexity of the model increases, degeneracies appear (red posterior distributions). μGUIDE allows to highlight those degeneracies present in the model definition.</p></caption>
<graphic xlink:href="2312.17293v3_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p><xref ref-type="table" rid="tbl1">Tables 1</xref> and <xref ref-type="table" rid="tbl2">2</xref> present the number of degenerate cases for each parameter in the three models, on 10000 simulations. <xref ref-type="table" rid="tbl1">Table 1</xref> considers noise-free simulations and the training and estimations were performed on CPU. <xref ref-type="table" rid="tbl2">Table 2</xref> reports results on noisy simulations (Rician noise with SNR = 50), with training and testing performed on a GPU (NVIDIA GeForce RTX 4090). The time needed for the inference and to estimate the posterior distributions on 10000 simulations, define if they are degenerate or not, and extract the MAP, uncertainty, ambiguity, are also reported. The more complex the model, the more degeneracies.</p>
<table-wrap id="tbl1" position="float" orientation="portrait">
<label>Table 1:</label>
<caption><title>Number of degenerate cases per parameter on 10000 noise-free simulations.</title>
<p>Training and estimations of the posterior distributions was performed on CPU. Time for training each model and time for estimating posterior distributions of 10000 noise-free simulations, define if they are degenerate or not, and extract the MAP, uncertainty, ambiguity are also reported.</p></caption>
<alternatives>
<graphic xlink:href="2312.17293v3_tbl1.tif" mime-subtype="tiff" mimetype="image"/>
<table frame="box" rules="all">
<thead>
<tr>
<th align="center" valign="top" rowspan="2">Model (SNR = ∞)</th>
<th align="center" valign="top" rowspan="2">Training Time (CPU)</th>
<th align="center" valign="top" rowspan="2">Fitting Time (on 10000 simulations)</th>
<th align="center" valign="top" colspan="8">Number of Degeneracies (on 10000 simulations)</th>
</tr>
<tr>
<th align="center" valign="top"><italic>f<sub>n</sub></italic></th>
<th align="center" valign="top"><italic>D<sub>n</sub></italic></th>
<th align="center" valign="top"><inline-formula id="ID1">
<alternatives>
<mml:math display="inline" id="I1"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:msubsup></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq1.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula></th>
<th align="center" valign="top"><italic>ODI</italic></th>
<th align="center" valign="top"><inline-formula id="ID2">
<alternatives>
<mml:math display="inline" id="I2"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mo>⊥</mml:mo></mml:msubsup></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq2.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula></th>
<th align="center" valign="top"><italic>f<sub>s</sub></italic></th>
<th align="center" valign="top"><italic>f<sub>e</sub></italic></th>
<th align="center" valign="top"><italic>C<sub>s</sub></italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" valign="top"><bold>Model 1</bold> Ball&amp;Stick</td>
<td align="center" valign="top">11min</td>
<td align="center" valign="top">96s</td>
<td align="center" valign="top">0</td>
<td align="center" valign="top">0</td>
<td align="center" valign="top">0</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
</tr>
<tr>
<td align="center" valign="top"><bold>Model 2</bold> Standard Model</td>
<td align="center" valign="top">2h02</td>
<td align="center" valign="top">135s</td>
<td align="center" valign="top">4</td>
<td align="center" valign="top">34</td>
<td align="center" valign="top">23</td>
<td align="center" valign="top">33</td>
<td align="center" valign="top">8</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
</tr>
<tr>
<td align="center" valign="top"><bold>Model 3</bold> Extended-SANDI model</td>
<td align="center" valign="top">2h02</td>
<td align="center" valign="top">1412s</td>
<td align="center" valign="top">205</td>
<td align="center" valign="top">4</td>
<td align="center" valign="top">260</td>
<td align="center" valign="top">57</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">1395</td>
<td align="center" valign="top">2571</td>
<td align="center" valign="top">1011</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
<table-wrap id="tbl2" position="float" orientation="portrait">
<label>Table 2:</label>
<caption><title>Number of degenerate cases per parameter on 10000 noisy simulations (Rician noise with SNR = 50).</title>
<p>Training and estimations of the posterior distributions was performed using a GPU. Time for training each model and time for estimating posterior distributions of 10000 noisy simulations, define if they are degenerate or not, and extract the MAP, uncertainty, ambiguity are also reported.</p></caption>
<alternatives>
<graphic xlink:href="2312.17293v3_tbl2.tif" mime-subtype="tiff" mimetype="image"/>
<table frame="box" rules="all">
<thead>
<tr>
<th align="center" valign="top" rowspan="2">Model (SNR=50)</th>
<th align="center" valign="top" rowspan="2">Training Time (GPU)</th>
<th align="center" valign="top" rowspan="2">Fitting Time (on 10000 simulations)</th>
<th align="center" valign="top" colspan="8">Number of Degeneracies (on 10000 simulations)</th>
</tr>
<tr>
<th align="center" valign="top"><italic>f<sub>n</sub></italic></th>
<th align="center" valign="top"><italic>D<sub>n</sub></italic></th>
<th align="center" valign="top"><inline-formula id="ID3">
<alternatives>
<mml:math display="inline" id="I3"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:msubsup></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq3.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula></th>
<th align="center" valign="top"><italic>ODI</italic></th>
<th align="center" valign="top"><inline-formula id="ID4">
<alternatives>
<mml:math display="inline" id="I4"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mo>⊥</mml:mo></mml:msubsup></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq4.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula></th>
<th align="center" valign="top"><italic>f<sub>s</sub></italic></th>
<th align="center" valign="top"><italic>f<sub>e</sub></italic></th>
<th align="center" valign="top"><italic>C<sub>s</sub></italic></th>
</tr>
</thead>
<tbody>
<tr>
<td align="center" valign="top"><bold>Model 1</bold> Ball&amp;Stick</td>
<td align="center" valign="top">26min</td>
<td align="center" valign="top">79s</td>
<td align="center" valign="top">0</td>
<td align="center" valign="top">0</td>
<td align="center" valign="top">0</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
</tr>
<tr>
<td align="center" valign="top"><bold>Model 2</bold> Standard Model</td>
<td align="center" valign="top">42min</td>
<td align="center" valign="top">82s</td>
<td align="center" valign="top">75</td>
<td align="center" valign="top">71</td>
<td align="center" valign="top">117</td>
<td align="center" valign="top">109</td>
<td align="center" valign="top">29</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">–</td>
</tr>
<tr>
<td align="center" valign="top"><bold>Model 3</bold> Extended-SANDI model</td>
<td align="center" valign="top">50min</td>
<td align="center" valign="top">238s</td>
<td align="center" valign="top">47</td>
<td align="center" valign="top">24</td>
<td align="center" valign="top">784</td>
<td align="center" valign="top">6</td>
<td align="center" valign="top">–</td>
<td align="center" valign="top">828</td>
<td align="center" valign="top">1047</td>
<td align="center" valign="top">56</td>
</tr>
</tbody>
</table>
</alternatives>
</table-wrap>
</sec>
</sec>
<sec id="s2-3">
<title>2.3 Application of μGUIDE to real data</title>
<p>After demonstrating that the proposed framework provides good estimates in the controlled case of simulations, we applied μGUIDE to both a healthy volunteer and a participant with epilepsy. The estimation of the posterior distributions is done independently for each voxel. To easily assess the values and the quality of the fitting, we are plotting the maximum-a-posterior, ambiguity and uncertainty maps, but the full posterior distributions are stored and available for all the voxels. Voxels presenting a degeneracy are highlighted with a red dot.</p>
<sec id="s2-3-1">
<title>2.3.1 Healthy volunteer</title>
<p>We applied μGUIDE to a healthy volunteer, using the Ball&amp;Stick, SM and extended-SANDI models. <xref ref-type="fig" rid="fig6">Fig. 6</xref> presents the parametric maps of an exemplar set of model parameters for each model, alongside their degeneracy, uncertainty and ambiguity. The Ball&amp;Stick model presents no degeneracy, the SM presents some degeneracy, mostly in voxels with high likelihood of partial voluming with cerebrospinal fluid (CSF) and at the white matter - gray matter boundaries. The extended-SANDI model is the model showing the highest number of degenerate cases, mostly localized within the white matter areas characterized by complex microstructure, e.g. crossing fibers. This result is expected, as the complexity of the models increases, leading to more combinations of tissue parameters that can explain an observed signal. Measures of ambiguity and uncertainty allow to quantify the confidence in the estimates and help interpreting the results.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><title>Parametric maps of the Ball&amp;Stick (top), SM (middle) and extended-SANDI model (bottom), obtained using μGUIDE.</title>
<p>Maximum-a-posteriori estimation, uncertainty and ambiguity measure maps are reported, overlayed with voxels considered degenerate (red dots).</p></caption>
<graphic xlink:href="2312.17293v3_fig6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s2-3-2">
<title>2.3.2 Participant with epilepsy</title>
<p><xref ref-type="fig" rid="fig7">Fig. 7</xref> demonstrates μGUIDE application to a participant with epilepsy, using the SM. Noteworthy, the axonal signal fraction estimates within the epileptic lesion show low uncertainty and ambiguity measures hence high confidence, while orientation dispersion index estimates show high uncertainty and ambiguity suggesting low confidence, cautioning the interpretation.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7:</label>
<caption><title>Parametric maps of a participant with epilepsy obtained using μGUIDE with the SM, superimposed with the grey matter (black) and white matter (white) lesions segmentation.</title>
<p>Mean values of the maximum-a-posterior, uncertainty and ambiguity measures are reported in the two regions of interest. Lower MAP values are obtained in the lesions for the axonal signal fraction and the orientation dispersion index compared to healthy tissue. Higher uncertainty and ambiguity ODI values are reported, suggesting less stable estimations.</p></caption>
<graphic xlink:href="2312.17293v3_fig7.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
</sec>
</sec>
<sec id="s3" sec-type="discussion">
<title>3 Discussion</title>
<sec id="s3-1">
<title>3.1 Applicability of μGUIDE to multiple models</title>
<p>The μGUIDE framework offers the advantage of being easily applicable to various biophysical models and representations, thanks to its data-driven approach for data reduction. The need to manually define specific summary statistics that capture the relevant information for microstructure estimation from the multi-shell diffusion signal is removed. This also eliminates the acquisition constraints that were previously imposed by the summary statistics definition [<xref ref-type="bibr" rid="R36">Jallais et al., 2022</xref>]. The extracted features contain additional information compared to the summary statistics (see Appendix A), resulting in a notable reduction in bias (on average 5.2 fold lower), uncertainty (on average 2.6 fold lower) and ambiguity (on average 2.7 fold lower) in the estimated posterior distributions. Consequently, μGUIDE improves parameters estimation over current state-of-the-art methods (e.g. Jallais et al. [2022]), showing for example reduced bias (on average 5.2 fold lower) and dispersion (on average 6.4 fold lower) on the MAP estimates for each of the three example models investigated (see <xref ref-type="fig" rid="fig4">Fig. 4</xref>).</p>
<p>In this study, we presented applications of μGUIDE to brain microstructure estimation using three well-established biophysical models, with increased complexity: the Ball&amp;Stick model, the Standard Model, and an extended-SANDI model. However, our approach is not limited to brain tissue nor to diffusion-weighted MRI and can be extended to different organs by employing their respective acquisition encoding and forward models, such as NEXI for exchange estimates [<xref ref-type="bibr" rid="R37">Jallais et al., 2024</xref>]; mcDESPOT for myelin water fraction mapping using quantitative MRI relaxation [<xref ref-type="bibr" rid="R18">Deoni et al., 2008</xref>]; VERDICT in prostate imaging [<xref ref-type="bibr" rid="R65">Panagiotaki et al., 2014</xref>]; or even adapted to different imaging modalities (e.g., EEG and MEG), where there is a way to link (via modelling or simulation) the observed signal to a set of parameters of interest. This versatility underscores the broad applicability of our proposed approach across various biological systems and imaging techniques.</p>
<p>It is important to note that μGUIDE is still a model-dependent method, meaning that the training process is based on the specific model being used. Additionally, the number of features extracted by the MLP needs to be predetermined. One way to determine the number of features is by matching it with the number of parameters being estimated. Alternatively, a dimensionality-reduction study using techniques like t-distributed stochastic neighbour embedding (tSNE) [Van der <xref ref-type="bibr" rid="R82">Maaten and Hinton, 2008</xref>] can be conducted to determine the optimal number of features.</p>
</sec>
<sec id="s3-2">
<title>3.2 μGUIDE: an efficient framework for Bayesian inference</title>
<p>One notable advantage of μGUIDE is its amortized nature. With this approach, the training process is performed only once, and thereafter, the posterior estimations can be independently obtained for all voxels. This amortization enables efficient estimations of the posterior distributions. μGUIDE outperforms in terms of speed conventional Bayesian inference methods such as MCMC, showing a “--1500 fold acceleration. The time savings achieved with μGUIDE make it a highly efficient and practical tool for estimating posterior distributions in a timely manner.</p>
<p>This unlocks the possibility to process with Bayesian inference very large datasets in manageable time (e.g. approximately 6 months to process 10k dMRI datasets) and to include Bayesian inference in iterative processes that require the repeated computation of the posterior distributions (e.g., dMRI acquisition optimization Alexander [2008]).</p>
<p>In the dMRI community, the use of SBI methods to characterize full posterior distributions as well as quantify the uncertainty in parameter estimations was first introduced in Jallais et al. [2022] for a grey matter model. An application to crossing fibers has recently been proposed by Karimi et al. [2024]. Those approaches use different density estimators. This work and Jallais et al. [2022] rely on Masked Autoregressive FLows (MAF) Papamakarios et al. [2017], while the work by Karimi et al. [2024] is based on Mixture Density Networks (MDN) [<xref ref-type="bibr" rid="R9">Bishop, 1994</xref>]. MAFs have been found to show superior performance compared to MDNs [Goncalves et al., 2020, <xref ref-type="bibr" rid="R71">Patron et al., 2022</xref>].</p>
</sec>
<sec id="s3-3">
<title>3.3 μGUIDE quantifies confidence to guide interpretation</title>
<p>Quantifying confidence in an estimate is of crucial importance. As demonstrated by our pathological example, changes in the tissue microstructure parameters can help clinicians decide which parameters are the most reliable and better interpret microstructure changes within diseased tissue. On large population studies, the quantified uncertainty can be taken into account when performing group statistics and to detect outliers.</p>
<p>Multiple approaches have been used to try and quantify this uncertainty. Gradient descent often provides a measure of confidence for each parameter estimate. Alternative approaches use the shape of the fitted tensor itself as a measure of uncertainty for the fiber direction [<xref ref-type="bibr" rid="R49">Koch et al., 2002</xref>, <xref ref-type="bibr" rid="R70">Parker and Alexander, 2003</xref>]. Other methods also rely on bootstrapping techniques to estimate uncertainty. Repetition bootstrapping for example depends on repeated measurements of signal for each gradient direction, but imply a long acquisition time and cost, and are prone to motion artifacts [<xref ref-type="bibr" rid="R52">Lazar and Alexander, 2005</xref>, <xref ref-type="bibr" rid="R42">Jones, 2003</xref>]. In contrast, residual bootstrapping methods resample the residuals of a regression model. Yet, this approach is heavily dependent on the model and can lead to overfitting [<xref ref-type="bibr" rid="R87">Whitcher et al., 2008</xref>, <xref ref-type="bibr" rid="R13">Chung et al., 2006</xref>]. In general, resampling methods can be problematic for sparse samples, as the bootstrapped samples tend to underestimate the true randomness of the distribution [<xref ref-type="bibr" rid="R45">Kauermann et al., 2009</xref>]. We propose to quantify the confidence by estimating full posterior distributions, which also has the benefit of highlighting degeneracy.</p>
<p>Variance observed in the posterior distributions can be attributed to several factors. The presence of noise in the signal contributes to irreducible variance, decreasing the confidence in the estimates as the noise level increases. Another source of variance can arise from the choice of acquisition parameters. Different acquisitions may provide varying levels of confidence in the parameter estimates. Under-sampled acquisitions or inadequate b-shells may fail to capture essential information about a tissue microstructure, such as soma or neurite radii, resulting in inaccurate estimates.</p>
<p>μGUIDE can guide users in determining whether an acquisition is suitable for estimating parameters of a given model and <italic>viceversa,</italic> the variance and bias of the posterior distributions estimated with μGUIDE can be used to guide the optimization of the data acquisition to maximize accuracy and precision of the model parameters estimates.</p>
<p>The presence of degeneracy in the solution of the inverse problem is influenced by the complexity of the model being used and the lack of sufficient information in the data. In recent years, researchers have introduced increasingly sophisticated models to better represent the brain tissue, such as SANDI [Palombo et al., 2020], NEXI [<xref ref-type="bibr" rid="R41">Jelescu et al., 2022</xref>] and eSANDIX [<xref ref-type="bibr" rid="R61">Olesen et al., 2022</xref>], that take into account an increasing number of tissue features. By applying μGUIDE, it becomes possible to gain insights into the degree of degeneracy within a model and to assess the balance between model realism and the ability to accurately invert the problem. We have recently provided an example of such application for NEXI and SANDIX [<xref ref-type="bibr" rid="R37">Jallais et al., 2024</xref>].</p>
</sec>
<sec id="s3-4">
<title>3.4 Summary</title>
<p>We propose a general Bayesian framework, dubbed μGUIDE, to efficiently estimate posterior distributions of tissue microstructure parameters. For any given acquisition and signal model/representation, μGUIDE improves parameters estimation and computational time over existing state-of-the-art methods. It allows to highlight degeneracy, and quantify confidence in the estimates, guiding results interpretation towards more confident and explainable diagnosis using modern deep learning. μGUIDE is not inherently limited to dMRI and microstructure imaging. We envision its usage and utility to perform efficient Bayesian inference also using data from any modality where there is a way to link (via modelling or simulation) the observed measurements to a set of parameters of interest.</p>
</sec>
</sec>
<sec id="s4" sec-type="methods">
<title>4 Methods</title>
<sec id="s4-1">
<title>4.1 Solving the inverse problem using Bayesian inference</title>
<sec id="s4-1-1">
<title>4.1.1 The inference problem</title>
<p>We make the hypothesis that an observed dMRI signal <bold>x</bold><sub>0</sub> can be explained (and generated) using a handful of relevant tissue microstructure parameters <italic><bold>θ</bold></italic><sub>0</sub>, following the definition of a forward model:
<disp-formula id="FD1">
<alternatives>
<mml:math id="M1" display="block"><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>=</mml:mo><mml:mi>M</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:msub><mml:mi>θ</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2312.17293v3_eqn1.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</disp-formula>
</p>
<p>The objective is, given this observation <bold><italic>x</italic></bold><sub>0</sub>, to estimate the parameters <bold><italic>∞</italic></bold><sub>0</sub> that generated it.</p>
<p>Forward models are designed to mimic at best a given biophysical phenomenon, for some given time and scale [<xref ref-type="bibr" rid="R3">Alexander, 2009</xref>, <xref ref-type="bibr" rid="R88">Yablonskiy and Sukstanskii, 2010</xref>, <xref ref-type="bibr" rid="R38">Jelescu and Budde, 2017</xref>, Novikov et al., 2018a, <xref ref-type="bibr" rid="R4">Alexander et al., 2019</xref>, <xref ref-type="bibr" rid="R40">Jelescu et al., 2020</xref>]. As a consequence, forward models are injection functions (every biologically plausible <bold><italic>∞</italic></bold><sub>i</sub> generates exactly one signal <italic><bold>x<sub>i</sub></bold></italic>), but do not always happen to be bijections, meaning that multiple <bold><italic>∞<sub>i</sub></italic></bold> can generate the same signal <italic><bold>x<sub>i</sub></bold></italic>. It can be impossible, based on biological considerations, to infer which solution <bold><italic>∞<sub>i</sub></italic></bold> best reflects the probed structure. We refer to these models as ‘degenerate models’.</p>
<p>Point estimates algorithms, such as minimum least square or maximum likelihood estimation algorithms, allow to estimate one set of microstructure parameters that could explain an observed signal. In the case of degenerate models, the solution space can be multi-modal and those algorithms will hide possible solutions. When considering real-life acquisitions, i.e. noisy and/or under-sampled acquisitions, one also needs to consider the bias introduced with respect to the forward model, and the resulting variance in the estimates [<xref ref-type="bibr" rid="R42">Jones, 2003</xref>, <xref ref-type="bibr" rid="R8">Behrens et al., 2003</xref>].</p>
<p>We propose a new framework that allows for the estimation of full posterior distributions p(<bold><italic>∞</italic></bold>|<italic>x</italic><sub>0</sub>), that is all the probable parameters that could represent the underlying tissue, along with an uncertainty measure and the interdependency of parameters. These posteriors can help interpreting the obtained results and make more informed decisions.</p>
</sec>
<sec id="s4-1-2">
<title>4.1.2 The Bayesian formalism</title>
<p>The posterior distribution can be defined using Bayes’ theorem as follows:
<disp-formula id="FD2">
<alternatives>
<mml:math id="M2" display="block"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mfrac><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mfrac></mml:math>
<graphic xlink:href="2312.17293v3_eqn2.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
<label>(1)</label>
</disp-formula>
</p>
<p>where p(<bold>x</bold><sub>0</sub>|<bold>θ</bold>) is the likelihood of the observed data point, p(<bold>θ</bold>) is the prior distribution defining our initial knowledge of the parameter values, and p(<bold>x</bold><sub>0</sub>) is a normalizing constant, commonly referred to as the evidence of the data.</p>
<p>The evidence term is usually very hard to estimate, as it corresponds to all the possible realisations of <bold>x</bold><sub>0</sub>, i.e. <inline-formula id="ID5">
<alternatives>
<mml:math display="inline" id="I5"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:msub><mml:mo>∫</mml:mo><mml:mrow><mml:mi>a</mml:mi><mml:mi>l</mml:mi><mml:mi>l</mml:mi><mml:mtext>  </mml:mtext><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle><mml:mtext> </mml:mtext><mml:mi>d</mml:mi><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq5.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula>. For simplification, methods usually estimate an unnormalized probability density function, i.e.
<disp-formula id="FD3">
<alternatives>
<mml:math id="M3" display="block"><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mtext>  </mml:mtext><mml:mi>∞</mml:mi><mml:mtext>  </mml:mtext><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>.</mml:mo></mml:math>
<graphic xlink:href="2312.17293v3_eqn3.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
<label>(2)</label>
</disp-formula>
</p>
<p>To approximate these posterior distributions, traditional methods rely on the estimation of the likelihood <italic>p(<bold>x</bold></italic><sub>0</sub>|<italic><bold>θ</bold></italic>) of the observed data point <bold><italic>x</italic></bold><sub>0</sub> via an analytic expression. This likelihood function corresponds to an integral over all possible trajectories through the latent space, that is <italic>p(<bold>x</bold></italic><sub>0</sub>|<italic><bold>θ</bold></italic>) = ∫ <italic>p(<bold>x</bold></italic><sub>0</sub>, <bold><italic>z|∞</italic></bold>)d<italic>z</italic>, where p(<bold><italic>x</italic></bold><sub>0</sub>, <bold><italic>z</italic></bold>|<bold><italic>∞</italic></bold>) is the joint probability density of observed data <bold>x</bold><sub>0</sub> and latent variables <bold>z</bold>. For forward models with large latent spaces, computing this integral explicitly becomes impractical. The likelihood function is then intractable, rendering these methods unusable [<xref ref-type="bibr" rid="R16">Cranmer et al., 2020</xref>]. Models that do not admit a tractable likelihood are called <italic>implicit models</italic> [<xref ref-type="bibr" rid="R20">Diggle and Gratton, 1984</xref>].</p>
<p>To circumvent this issue, some techniques have been proposed to sample numerically from the likelihood function, such as Markov-Chain-Monte-Carlo (MCMC) [<xref ref-type="bibr" rid="R57">Metropolis et al., 1953</xref>]. Another set of approaches proposes to train a conditional density estimator to learn a surrogate of the likelihood distribution [Papamakarios et al., 2019, <xref ref-type="bibr" rid="R54">Lueckmann et al., 2019</xref>], the likelihoodratio [<xref ref-type="bibr" rid="R15">Cranmer et al., 2016</xref>, <xref ref-type="bibr" rid="R30">Gutmann et al., 2018</xref>] or the posterior distribution [<xref ref-type="bibr" rid="R66">Papamakarios and Murray, 2016</xref>, <xref ref-type="bibr" rid="R53">Lueckmann et al., 2017</xref>, Papamakarios et al., 2019], allowing to greatly reduce computation times. These methods are dubbed Likelihood-Free Inference (LFI), or SimulationBased Inference (SBI) methods [<xref ref-type="bibr" rid="R16">Cranmer et al., 2020</xref>, <xref ref-type="bibr" rid="R79">Tejero-Cantero et al., 2020</xref>]. In particular, there has been a growing interest towards deep generative modeling approaches in the machine learning community [<xref ref-type="bibr" rid="R55">Lueckmann et al., 2021</xref>]. They rely on specially tailored neural network architectures to approximate probability density functions from a set of examples. Normalizing flows [<xref ref-type="bibr" rid="R69">Papamakarios et al., 2021</xref>] are a particular class of such neural networks that have demonstrated promising results for SBI in different research fields [Goncalves et al., 2020, <xref ref-type="bibr" rid="R28">Greenberg et al., 2019</xref>].</p>
<p>While this work focuses on the estimate of the posterior distribution using a conditional density estimator, we show a comparison with MCMC, which are commonly used methods in the community. We will therefore introduce this method in the following paragraph.</p>
</sec>
<sec id="s4-1-3">
<title>4.1.3 Estimating the likelihood function</title>
<p>Well-established approaches for estimating the likelihood function are MCMC methods. These methods rely on a noise model to define the likelihood distribution, such as the Rician [<xref ref-type="bibr" rid="R64">Panagiotaki et al., 2012</xref>] or Offset Gaussian models [<xref ref-type="bibr" rid="R3">Alexander, 2009</xref>]. In this work, we will be using the Microstructure Diffusion Toolbox to perform the MCMC computations [<xref ref-type="bibr" rid="R32">Harms and Roebroeck, 2018</xref>], which relies on the Offset Gaussian model. The log-likelihood function is then the following:
<disp-formula id="FD4">
<alternatives>
<mml:math id="M4" display="block"><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>|</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mo>∑</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>−</mml:mo><mml:msqrt><mml:mi>M</mml:mi></mml:msqrt><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mi>θ</mml:mi><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mrow><mml:mn>2</mml:mn><mml:msup><mml:mi>σ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mo>−</mml:mo><mml:mi>m</mml:mi><mml:mo>.</mml:mo><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>σ</mml:mi><mml:msqrt><mml:mrow><mml:mn>2</mml:mn><mml:mi>π</mml:mi></mml:mrow></mml:msqrt></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2312.17293v3_eqn4.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
<label>(3)</label>
</disp-formula>
</p>
<p>where <italic><bold>M(∞)</bold></italic> is the signal obtained using the biophysical model, <italic>σ</italic> is the standard deviation of the Gaussian distributed noise, estimated from the reconstructed magnitude images [<xref ref-type="bibr" rid="R19">Dietrich et al., 2007</xref>], and <italic>m</italic> is the number of observations in the dataset.</p>
<p>MCMC methods allow to obtain posterior distributions using Bayes’ formula (<xref ref-type="disp-formula" rid="FD3">Eq. (2)</xref>) with the previously defined likelihood function (<xref ref-type="disp-formula" rid="FD4">Eq. (3)</xref>) and some prior distributions, which are usually uniform distributions defined on biologically plausible ranges. They generate a multi-dimensional chain of samples which is guaranteed to converge towards a stationary distribution, which approximates the posterior distribution [<xref ref-type="bibr" rid="R57">Metropolis et al., 1953</xref>].</p>
<p>The need to compute the signal following the forward model at each iteration makes these sampling methods computationally expensive and time consuming. In addition, they require some adjustments specific to each model, such as the choice of burn-in length, thinning and the number of samples to store. Harms and Roebroeck [2018] recommend to use the Adaptive Metropolis-Within-Gibbs (AMWG) algorithm for sampling dMRI models, initialized with a maximum likelihood estimator obtained from non-linear optimization, with 100 to 200 samples for burn-in and no thinning. The recommended number of samples is model-dependent. Authors recommendations can be found in their paper.</p>
</sec>
<sec id="s4-1-4">
<title>4.1.4 Bypassing the likelihood function</title>
<p>An alternative method was proposed to overcome the challenges associated with approximating the likelihood function and the limitations of MCMC sampling algorithms. This approach involves directly approximating the posterior distribution by using a conditional density estimator, i.e. a family of conditional probability density function approximators denoted as <italic>q<sub>ϕ</sub>(<bold>∞|x</bold>)</italic>. These approximators are parameterized by <italic>ϕ</italic> and accept both the parameters <italic><bold>θ</bold></italic> and the observation <bold>x</bold> as input arguments. Our posterior approximation is then obtained by minimizing its average Kullback-Leibler divergence with respect to the conditional density estimator for different choices of <bold>x</bold>, as per [<xref ref-type="bibr" rid="R66">Papamakarios and Murray, 2016</xref>]:
<disp-formula id="FD5">
<alternatives>
<mml:math id="M5" display="block"><mml:mrow><mml:munder><mml:mrow><mml:mi>min</mml:mi></mml:mrow><mml:mi>ϕ</mml:mi></mml:munder><mml:mo>.</mml:mo><mml:mtext> </mml:mtext><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mtext> </mml:mtext><mml:mi>w</mml:mi><mml:mi>i</mml:mi><mml:mi>t</mml:mi><mml:mi>h</mml:mi><mml:mtext> </mml:mtext><mml:mi>L</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>=</mml:mo><mml:msub><mml:mtext>E</mml:mtext><mml:mrow><mml:mi>x</mml:mi><mml:mo>~</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo></mml:mrow></mml:msub><mml:mo stretchy="false">[</mml:mo><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mtext>KL</mml:mtext></mml:mrow></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>p</mml:mi><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mo stretchy="false">(</mml:mo><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">)</mml:mo><mml:mo stretchy="false">]</mml:mo><mml:mo>,</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2312.17293v3_eqn5.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
<label>(4)</label>
</disp-formula>
</p>
<p>which can be rewritten as
<disp-formula id="FD6">
<alternatives>
<mml:math id="M6" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mrow><mml:mi>K</mml:mi><mml:mi>L</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mrow></mml:mstyle><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi>log</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>x</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mstyle displaystyle="true"><mml:mrow><mml:mo>∫</mml:mo><mml:mrow><mml:mi>log</mml:mi></mml:mrow></mml:mrow></mml:mstyle></mml:mrow></mml:mrow></mml:mstyle><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>d</mml:mi><mml:mi>θ</mml:mi><mml:mi>d</mml:mi><mml:mi>x</mml:mi><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:msub><mml:mi>E</mml:mi><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>~</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>x</mml:mi><mml:mo>,</mml:mo><mml:mi>θ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msub><mml:mrow><mml:mo>[</mml:mo> <mml:mrow><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow> <mml:mo>]</mml:mo></mml:mrow><mml:mo>+</mml:mo><mml:mi>C</mml:mi><mml:mo>,</mml:mo></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2312.17293v3_eqn6.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
<label>(5)</label>
</disp-formula>
</p>
<p>where <italic>C</italic> is a constant that does not depend on <italic>∞</italic>. Note that in practice we consider a <italic>N</italic>-sample Monte-Carlo approximation of the loss function:
<disp-formula id="FD7">
<alternatives>
<mml:math id="M7" display="block"><mml:mi>L</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>≈</mml:mo><mml:msup><mml:mi>L</mml:mi><mml:mi>N</mml:mi></mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mi>ϕ</mml:mi><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mo>−</mml:mo><mml:mfrac><mml:mn>1</mml:mn><mml:mi>N</mml:mi></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:mi>i</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>N</mml:mi></mml:munderover><mml:mrow><mml:mi>log</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>+</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2312.17293v3_eqn7.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
<label>(6)</label>
</disp-formula>
</p>
<p>where the <italic>N</italic> data points <italic>(<bold>θ</bold><sub>i</sub>, x<sub>i</sub></italic>) are sampled from the joint distribution with <italic><bold>θ</bold><sub>i</sub> ~ p(<bold>θ</bold>)</italic> and <italic><bold>x</bold><sub>i</sub></italic> ~ <italic>p(<bold>x</bold>|<bold>θ</bold><sub>i</sub></italic>). We can then use stochastic gradient descent to obtain a set of parameters <italic>ϕ</italic> which minimizes <italic>L<sup>N</sup></italic>.</p>
<p>If the class of conditional density estimators is sufficiently expressive, it can be demonstrated that the minimizer of <xref ref-type="disp-formula" rid="FD7">Eq. (6)</xref> converges to <italic>p(<bold>θ</bold>|<bold>y</bold>)</italic> when <italic>N</italic> → ∞ [<xref ref-type="bibr" rid="R28">Greenberg et al., 2019</xref>]. It is worth noting that the parametrization <italic>ϕ</italic>, obtained at the end of the optimization procedure, serves as an amortized posterior for various choices of <bold>x</bold>. Hence, for a particular observation <italic><bold>x</bold></italic><sub>0</sub>, we can simply use <italic>q<sub>ϕ</sub></italic>(<bold><italic>θ</italic></bold>|<bold><italic>x</italic></bold><sub>0</sub>) as an approximation of <italic>p(<bold>θ</bold>|<bold>x</bold></italic><sub>0</sub>).</p>
</sec>
</sec>
<sec id="s4-2">
<title>4.2 μGUIDE framework</title>
<p>The full architecture of the proposed Bayesian framework, dubbed μGUIDE, is presented in <xref ref-type="fig" rid="fig1">Fig. 1</xref>. The analysis codes underpinning the results presented here can be found upon publication in the Cardiff University data catalogue and on Github: <ext-link ext-link-type="uri" xlink:href="https://github.com/mjallais/uGUIDE">https://github.com/mjallais/uGUIDE</ext-link> (both CPU and GPU are supported).</p>
<p>μGUIDE is comprised of two modules that are optimized together to minimize the Kull-back-Leibler divergence between the true posterior distribution and the estimated one for every parameters of a given forward model. The ‘Neural Posterior Estimator’ (NPE) module uses normalizing flows to approximate the posterior distribution, while the ‘Multi-Layer Perceptron’ (MLP) module is used to reduce the data dimensionality and ensure fast and robust convergence of the NPE module. The following Sections provide more details about our implementation of each module.</p>
<sec id="s4-2-1">
<title>4.2.1 Neural Posterior Estimator</title>
<p>In this study, the Sequential Neural Posterior Estimation (SNPE-C) algorithm [<xref ref-type="bibr" rid="R66">Papamakarios and Murray, 2016</xref>, <xref ref-type="bibr" rid="R28">Greenberg et al., 2019</xref>] with a single round is employed to train a neural network that directly approximates the posterior distribution. Thus, sampling from the posterior can be done by sampling from the trained neural network. Neural density estimators have the advantage of providing exact density evaluations, in contrast to Variational Autoencoders (VAE) Kingma and Welling [2019] or generative adversarial networks (GAN) Goodfellow et al. [2014], which are better suited for generating synthetic data.</p>
<p>The conditional probability density function approximators used in this pro ject belong to a class of neural networks called normalizing flows [<xref ref-type="bibr" rid="R69">Papamakarios et al., 2021</xref>]. These flows are invertible functions capable of transforming vectors generated from a simple base distribution (e.g. the standard multivariate Gaussian distribution) into an approximation of the true posterior distribution. An autoregressive architecture for normalizing flows is employed, implemented via the Masked Autoregressive Flow (MAF) Papamakarios et al. [2017], which is constructed by stacking five Masked Autoencoder for Distribution Estimation models (MADE) Germain et al. [2015]. An explanation of how MAF and MADE work is provided in Appendix B.</p>
<p>To test that the predicted posteriors for a given model are not incorrect we use posterior predictive checks, which is described in more details in Appendix C.</p>
</sec>
<sec id="s4-2-2">
<title>4.2.2 Handling the large dimensionality of the data with Multi-Layer Perceptron</title>
<p>As the dimensionality of the input data <bold>x</bold> grows, the complexity of the corresponding inverse problem also increases. Accurately characterizing the posterior distributions or estimating the tissue microstructure parameters becomes more challenging. As a consequence, it is often necessary to rely on a set of low-dimensional features (or summary statistics) instead of the raw data for the inference task process [<xref ref-type="bibr" rid="R10">Blum et al., 2013</xref>, <xref ref-type="bibr" rid="R22">Fearnhead and Prangle, 2012</xref>, Papamakarios et al., 2019]. These summary statistics are features that capture the essential information within the raw data, allowing to reduce the size of the input vector. Learning a set of sufficient statistics before estimating the posterior distribution makes the inference easier and offers many benefits (see e.g. the Rao-Blackwell theorem).</p>
<p>A follow-up challenge lies in the choice of suitable summary statistics. For well-understood problems and data, it is possible to manually design these features using deterministic functions that condense the information contained in the raw signal into a set of handful summary statistics. Previous works, such as Novikov et al. [2018b] and Jallais et al. [2022], have proposed specific summary statistics for two different biophysical models. However, defining these summary statistics is difficult and often requires prior knowledge of the problem at hand. In the context of dMRI, they also rely on acquisition constraints and are model-specific.</p>
<p>In this work, the proposed framework aims to be applicable to any forward model and be as general as possible. We therefore propose to learn the summary statistics from the high-dimensional input signals <bold>x</bold> using a neural network. This neural network is referred to as an embedding neural network. The observed signals are fed into the embedding neural network, whose outputs are then passed to the neural density estimator. The parameters of the embedding network are learned together with the parameters of the neural density estimator, leading to the extraction of optimal features that minimize the uncertainty of <italic>p(<bold>ϕ</bold>|<bold>x</bold>)</italic>. Here, we propose to use a MLP with three layers as a summary statistics extractor. The number of features <italic>N<sub>f</sub></italic> extracted by the MLP can be either defined a priori or determined empirically during training.</p>
</sec>
<sec id="s4-2-3">
<title>4.2.3 Training μGUIDE</title>
<p>To train μGUIDE we need couples of input vectors <bold>x</bold> and corresponding ground-truth values for the model parameters that we want to estimate, <italic><bold>θ</bold>.</italic> The input <bold>x</bold> can be real or simulated data (e.g. dMRI signals); or a mixture of these two. We train μGUIDE by stochastically minimizing the loss function defined in <xref ref-type="disp-formula" rid="FD7">Eq. (6)</xref> using the Adam optimizer [<xref ref-type="bibr" rid="R47">Kingma and Ba, 2015</xref>] with a learning rate of 10<sup>−3</sup> and a minibatch size of 128. We use 1 million simulations for each model, 5% of which are randomly selected to be used as a validation set. Training is stopped when the validation loss does not decrease for 30 consecutive epochs.</p>
</sec>
<sec id="s4-2-4">
<title>4.2.4 Quantifying the confidence in the estimates</title>
<p>The full posterior distribution contains a lot of useful information about a given model parameter best estimates; uncertainty; ambiguity and degeneracy. To summarize and easily visualize this information, we propose three measures that quantify the best estimates and the associated confidence levels, and a way to highlight degeneracy.</p>
<p>We start by checking whether a posterior distribution is degenerate, that is if the distribution presents multiple distinct parameter solutions, appearing as multiple local maxima (<xref ref-type="fig" rid="fig2">Fig. 2</xref>). To that aim, we fit two Gaussian distributions to the obtained posterior distributions. A voxel is considered as degenerate if the derivative of the fitted Gaussian distributions changes signs more than once (i.e. multiple local maxima), and if the two Gaussian distributions are not overlapping (the distance between the two Gaussian means is inferior to the sum of their standard deviations).</p>
<p>For non-degenerate posterior distributions, we extract three quantities:
<list list-type="order" id="L1">
<list-item><p>The Maximum A Posteriori (MAP), which corresponds to the most likely parameter estimate.</p></list-item>
<list-item><p>An uncertainty measure, which quantifies the dispersion of the 50% most probable samples using the interquartile range, relative to the prior range.</p></list-item>
<list-item><p>An ambiguity measure, which measures the Full Width at Half Maximum (FWHM), in percentage with respect to the prior range.</p></list-item>
</list>
</p>
<p><xref ref-type="fig" rid="fig2">Fig. 2</xref> presents those measures on exemplar posterior distributions.</p>
</sec>
</sec>
<sec id="s4-3">
<title>4.3 Application of μGUIDE to biophysical modelling of dMRI data</title>
<p>We show exemplar applications of μGUIDE to three biophysical models of increasing complexity and degeneracy from the dMRI literature. For each model, we compare the fitting quality of the posterior distributions obtained using the MLP and manually defined summary statistics.</p>
<sec id="s4-3-1">
<title>4.3.1 Biophysical models of dMRI signal.</title>
<p><bold>Model 1: Ball&amp;Stick</bold> [<xref ref-type="bibr" rid="R8">Behrens et al., 2003</xref>]. This is a two-compartment model (intra-neurite and extra-neurite space) where the dMRI signal from the brain tissue is modeled as a weighted sum, with weight <italic>f<sub>in</sub></italic>, of signals from water diffusing inside the neurites, approximated as sticks (i.e. cylinders of zero radius) with diffusivity <italic>D<sub>in</sub></italic>, and water diffusing within the extra-neurite space, approximated as Gaussian diffusion in an isotropic medium with diffusivity <italic>D<sub>e</sub></italic>. The direction of the stick is randomly sampled on a sphere. This model has the main advantage of being nondegenerate. We define the summary statistics as the direction-averaged signal (six b-shells, see Section 4.3.3).</p>
<p><bold>Model 2: Standard Model (SM)</bold> [Novikov et al., 2018a]. Expanding on model 1, this model represents the dMRI signal from the brain tissue as a weighted sum of the signal from water diffusing within the neurite space, approximated as sticks with symmetric orientation dispersion following a Watson distribution and water diffusing within the extra-neurite space, modelled as anisotropic Gaussian diffusion. The microstructure parameters of this two-compartment model are the neurite signal fraction <italic>f</italic> , the intra-neurite diffusivity <italic>D<sub>a</sub></italic>, the orientation dispersion index <italic>ODI</italic>, and the parallel and perpendicular diffusivities within the extra-neurite space <inline-formula id="ID6">
<alternatives>
<mml:math display="inline" id="I6"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:msubsup></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq6.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula> and <inline-formula id="ID7">
<alternatives>
<mml:math display="inline" id="I7"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mo>⊥</mml:mo></mml:msubsup></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq7.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula> We use the LEMONADE [Novikov et al., 2018b] system of equations, which is based on a cumulant decomposition of the signal, to define six summary statistics.</p>
<p><bold>Model 3: extended-SANDI</bold> [Palombo et al., 2020]. This is a three-compartment model (intra-neurite, intra-soma and extra-cellular space) where the dMRI signal from the brain tissue is modelled as a weighted sum of the signal from water diffusing within the neurite space, approximated as sticks with symmetric orientation dispersion following a Watson distribution; water diffusing within cell bodies (namely soma), modelled as restricted diffusion in spheres; and water diffusing within the extra-cellular space, modelled as isotropic Gaussian diffusion. The parameters of interest are the neurite signal fraction <italic>f<sub>n</sub></italic>, the intra-neurite diffusivity <italic>D<sub>n</sub></italic>, the orientation dispersion index <italic>ODI</italic>, the extra-cellular signal fraction <italic>f<sub>e</sub></italic> and isotropic diffusivity <italic>D<sub>e</sub></italic>, the soma signal fraction <italic>f<sub>s</sub></italic>, and a proxy of soma radius and diffusivity <italic>C<sub>s</sub></italic>, defined as [<xref ref-type="bibr" rid="R36">Jallais et al., 2022</xref>]:
<disp-formula id="FD8">
<alternatives>
<mml:math id="M8" display="block"><mml:msub><mml:mi>C</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mfrac><mml:mn>2</mml:mn><mml:mrow><mml:msub><mml:mi>D</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:msup><mml:mi>δ</mml:mi><mml:mn>2</mml:mn></mml:msup></mml:mrow></mml:mfrac><mml:mstyle displaystyle="true"><mml:munderover><mml:mo>∑</mml:mo><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow><mml:mi>∞</mml:mi></mml:munderover><mml:mrow><mml:mfrac><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>4</mml:mn></mml:mrow></mml:msubsup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msubsup><mml:mi>r</mml:mi><mml:mi>s</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:mo>−</mml:mo><mml:mn>2</mml:mn></mml:mrow></mml:mfrac></mml:mrow></mml:mstyle><mml:mo>⋅</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>2</mml:mn><mml:mi>δ</mml:mi><mml:mo>−</mml:mo><mml:mfrac><mml:mrow><mml:mn>2</mml:mn><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>D</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mo>−</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>D</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>δ</mml:mi></mml:mrow></mml:msup><mml:mo>−</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>D</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mi>Δ</mml:mi></mml:mrow></mml:msup><mml:mo>+</mml:mo><mml:msup><mml:mi>e</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:msubsup><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>D</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>Δ</mml:mi><mml:mo>+</mml:mo><mml:mi>δ</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:msup></mml:mrow><mml:mrow><mml:msubsup><mml:mi>α</mml:mi><mml:mi>m</mml:mi><mml:mn>2</mml:mn></mml:msubsup><mml:msub><mml:mi>D</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow></mml:mfrac></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:math>
<graphic xlink:href="2312.17293v3_eqn8.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</disp-formula>
</p>
<p>with <italic>r<sub>s</sub></italic> and <italic>D<sub>s</sub></italic> the soma radius and diffusivity respectively, and <italic>α<sub>m</sub></italic> the <italic>m</italic>th root of <inline-formula id="ID8">
<alternatives>
<mml:math display="inline" id="I8"><mml:msup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msup><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mn>3</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mstyle scriptlevel="+1"><mml:mfrac><mml:mn>5</mml:mn><mml:mn>2</mml:mn></mml:mfrac></mml:mstyle></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>α</mml:mi><mml:msub><mml:mi>r</mml:mi><mml:mi>s</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq8.tif" mime-subtype="tiff" mimetype="image"/>
<inline-graphic xlink:href="2312.17293v3_ieq9.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula>, with <italic>J<sub>n</sub></italic>(x) the Bessel functions of the first kind. We use the six summary statistics defined in [<xref ref-type="bibr" rid="R36">Jallais et al., 2022</xref>], which are based on a high and low b-value signal expansion.</p>
<p>Prior distributions <italic>p(<bold>θ</bold>)</italic> are defined as uniform distributions over biophysically plausible ranges. Signal fractions are defined within the interval [0,1], diffusivities between 0.1 and 3 μm<sup>2</sup> ms<sup>-1</sup>, ODI between 0.03 and 0.95, and <italic>C<sub>s</sub></italic> between 0.15 and 1105 μm<sup>2</sup> (which correspond to <italic>r<sub>s</sub></italic> ∈ [1; 15] μm and fixed <italic>D<sub>s</sub></italic> = 3 μm<sup>2</sup> ms<sup>-1</sup>).</p>
<p>The SM imposes the constraint <inline-formula id="ID9">
<alternatives>
<mml:math display="inline" id="I9"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mo>⊥</mml:mo></mml:msubsup></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq10.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula> &lt; <inline-formula id="ID10">
<alternatives>
<mml:math display="inline" id="I10"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:msubsup></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq11.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula> To generate samples uniformly distributed on the space defined by this condition, we are using two random variables <italic>u</italic><sub>0</sub> and <italic>u</italic><sub>1</sub>, both sampled uniformly between 0 and 1, and then relate them to <inline-formula id="ID11">
<alternatives>
<mml:math display="inline" id="I11"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:msubsup></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq12.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula> and <inline-formula id="ID12">
<alternatives>
<mml:math display="inline" id="I12"><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mo>⊥</mml:mo></mml:msubsup></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq13.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula> using the following equations:
<disp-formula id="FD9">
<alternatives>
<mml:math id="M9" display="block"><mml:mrow><mml:mo>{</mml:mo> <mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:msubsup><mml:mo>=</mml:mo><mml:msqrt><mml:mrow><mml:msup><mml:mrow><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>3.0</mml:mn><mml:mo>−</mml:mo><mml:mn>0.1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mn>2</mml:mn></mml:msup><mml:mo>⋅</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>0</mml:mn></mml:msub><mml:mo>+</mml:mo><mml:mn>0.1</mml:mn></mml:mrow></mml:msqrt></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mo>⊥</mml:mo></mml:msubsup><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msubsup><mml:mi>D</mml:mi><mml:mi>e</mml:mi><mml:mrow><mml:mo>|</mml:mo><mml:mo>|</mml:mo></mml:mrow></mml:msubsup><mml:mo>−</mml:mo><mml:mn>0.1</mml:mn></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>⋅</mml:mo><mml:msub><mml:mi>u</mml:mi><mml:mn>1</mml:mn></mml:msub><mml:mn>0.1</mml:mn></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math>
<graphic xlink:href="2312.17293v3_eqn9.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
<label>(7)</label>
</disp-formula>
</p>
<p>The extended-SANDI model requires for the signal fractions to sum to 1, that is <italic>f<sub>n</sub>+f<sub>s</sub>+f<sub>k</sub></italic> = 1. To uniformly cover the simplex <italic>f<sub>n</sub></italic> + <italic>f<sub>s</sub></italic> + <italic>f<sub>e</sub></italic> = 1, we define two new parameters <italic>k</italic><sub>1</sub> and <italic>k</italic><sub>2</sub> , uniformly sampled between 0 and 1, and use the following equations to get the corresponding signal fractions:
<disp-formula id="FD10">
<alternatives>
<mml:math id="M10" display="block"><mml:mrow><mml:mo>{</mml:mo> <mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mi>n</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub><mml:msqrt><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mi>s</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msub><mml:mi>k</mml:mi><mml:mn>2</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:msqrt><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:msub><mml:mi>f</mml:mi><mml:mi>e</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mn>1</mml:mn><mml:mo>−</mml:mo><mml:msqrt><mml:mrow><mml:msub><mml:mi>k</mml:mi><mml:mn>1</mml:mn></mml:msub></mml:mrow></mml:msqrt></mml:mtd></mml:mtr></mml:mtable></mml:mrow></mml:math>
<graphic xlink:href="2312.17293v3_eqn10.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
<label>(8)</label>
</disp-formula>
</p>
<p>To ensure comparability of results, we extract the same number of features <italic>N<sub>f</sub></italic> using the MLP as the number of summary statistics for each model. We therefore use <italic>N<sub>f</sub></italic> = 6 for the Ball&amp;Stick, the SM and the extended-SANDI models.</p>
</sec>
<sec id="s4-3-2">
<title>4.3.2 Validation in Numerical Simulations</title>
<p>We start by validating the proposed method using posterior predictive checks (PPC) and simulated signals from model 2 (see more details in Appendix C). Since PPC alone does not guarantee the correctness of the estimated posteriors, we further validated the obtained posterior distributions comparing them with the Adaptive Metropolis-Within-Gibbs MCMC [<xref ref-type="bibr" rid="R72">Roberts and Rosenthal, 2009</xref>]. We generated simulations following the same acquisition protocol as the real data (see Section 4.3.3), and added Rician distributed noise with a Signal-to-Noise-Ratio (SNR) of 50. We then estimated the posterior distributions using both μGUIDE and the MCMC method implemented in the MDT toolbox [<xref ref-type="bibr" rid="R32">Harms and Roebroeck, 2018</xref>]. We initialized the sampling using a maximum likelihood estimator. We sampled 15200 samples from the distribution, the first 200 ones being used as burn-in, and no thinning. Similarly, we sampled 15000 samples from the estimated posterior distributions using μGUIDE.</p>
<p>Then, we show that μGUIDE can be applicable to any model. We use model 1 and 3 as examples of simpler (and non-degenerate) and more complex (and degenerate) models than model 2, respectively.</p>
<p>We compared the proposed framework to a state-of-the-art method for posterior estimation [<xref ref-type="bibr" rid="R36">Jallais et al., 2022</xref>]. This method relies on manually-defined summary statistics, while μGUIDE automatically extracts some features using an embedded neural network. μGUIDE was trained directly on noisy simulations. The manually-defined summary statistics were extracted from these simulated noisy signals and then used as training dataset for a MAF, similarly to [<xref ref-type="bibr" rid="R36">Jallais et al., 2022</xref>].</p>
<p>Finally, we used μGUIDE to highlight degeneracy in all the models. While the complexity of the models increases, more degeneracy can be found. The degeneracy is inherent to the model definition, and is not induced by the noise. μGUIDE allows to highlight those degeneracies and quantify the confidence in the obtained estimates.</p>
<p>The training was performed on N = 10<sup>6</sup> numerical simulations for each model, computed using the MISST package [<xref ref-type="bibr" rid="R35">lanus et al., 2017</xref>] and random combinations of the model parameters, each uniformly sampled from the previously defined ranges, with the addition of Rician distributed noise with SNR equivalent to the experimental data, i.e. 50.</p>
</sec>
<sec id="s4-3-3">
<title>4.3.3 dMRI Data Acquisition and Processing</title>
<p>We applied μGUIDE to dMRI data collected from two participants: a healthy volunteer from the WAND dataset [<xref ref-type="bibr" rid="R56">McNabb et al., 2024</xref>] and an age-matched participant with epilepsy, acquired with the same protocol used for the MICRA dataset [<xref ref-type="bibr" rid="R50">Koller et al., 2021</xref>]. Data were acquired on a Connectome 3T scanner using a single-shot spin-echo, echo-planar imaging sequence with b-values = [200, 500, 1200, 2400, 4000, 6000] s mm<sup>-2</sup>, [20, 20, 30, 61, 61, 61] uniformly distributed directions respectively and 13 non-diffusion-weighted images at 2 mm isotropic resolution. TR was set to 3000 ms, TE to 59 ms, and the diffusion gradient duration and separation to 7 ms and 24 ms respectively. Short diffusion times and TE were achieved thanks to the Connectom gradients, allowing to enhance the signal-to-noise ratio and sensitivity to small water displacements [<xref ref-type="bibr" rid="R43">Jones et al., 2018</xref>, <xref ref-type="bibr" rid="R74">Setsompop et al., 2013</xref>]. We considered the noise as Rician with an SNR of 50 for both subjects.</p>
<p>Data were preprocessed using a combination of in-house pipelines and tools from the FSL [<xref ref-type="bibr" rid="R6">Andersson et al., 2003</xref>, <xref ref-type="bibr" rid="R5">Andersson and Sotiropoulos, 2016</xref>, <xref ref-type="bibr" rid="R76">Smith, 2002</xref>, <xref ref-type="bibr" rid="R77">Smith et al., 2004</xref>] and MRTrix3 [<xref ref-type="bibr" rid="R80">Tournier et al., 2019</xref>] software packages. The preprocessing steps included brain extraction [<xref ref-type="bibr" rid="R76">Smith, 2002</xref>], denoising [<xref ref-type="bibr" rid="R14">Cordero-Grande et al., 2019</xref>, Veraart et al., 2016], drift correction [<xref ref-type="bibr" rid="R85">Vos et al., 2017</xref>, <xref ref-type="bibr" rid="R73">Sairanen et al., 2018</xref>], susceptibility-induced distortions [<xref ref-type="bibr" rid="R6">Andersson et al., 2003</xref>, <xref ref-type="bibr" rid="R77">Smith et al., 2004</xref>], motion and eddy current correction [<xref ref-type="bibr" rid="R5">Andersson and Sotiropoulos, 2016</xref>], correction for gradient non-linearity distortions [<xref ref-type="bibr" rid="R25">Glasser et al., 2013</xref>], and Gibbs ringing artefacts correction [<xref ref-type="bibr" rid="R46">Kellner et al., 2016</xref>].</p>
</sec>
<sec id="s4-3-4">
<title>4.3.4. dMRI Data Analysis</title>
<p>Diffusion signals were first normalized by the mean non-diffusion-weighted signals acquired for each voxel. Each voxel was then estimated in parallel using the μGUIDE framework. For each observed signal <italic><bold>x<sub>v</sub></bold></italic> (i.e. for each voxel), we drew 50000 samples via rejection-sampling from <italic>q<sub>ϕ</sub>(θ<sub>i</sub>|<bold>x<sub>v</sub></bold>)</italic> for each model parameter <italic>θ<sub>i</sub></italic>, allowing to retrieve the full posterior distributions. If a posterior distribution was not deemed degenerate, the maximum-a-posteriori, uncertainty and ambiguity measures were extracted from the posterior distributions.</p>
<p>The manually-defined summary statistics of the SM are defined using a cumulant expansion, which is only valid for small b-values. We therefore only used the b ≤ 2500 smm<sup>-2</sup> data for this model. In order to obtain comparable results, we restricted the application of μGUIDE to this range of b-values as well. An extra b-shell (b-value = 5000 s mm<sup>-2</sup>; 61 directions) was interpolated using <italic>mapl</italic> [<xref ref-type="bibr" rid="R23">Fick et al., 2016</xref>] for the extended-SANDI model when using the method developed by Jallais et al. [2022] based on summary statistics.</p>
<p>The training of μGUIDE was performed as described in 4.3.2 and an example of training dataset and input signal vector is provided in <xref ref-type="fig" rid="fig8">Fig. 8</xref>.</p>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8:</label>
<caption><title>Example training set and input signals for μGUIDE.</title>
<p>A) Examples of input synthetic data vectors and corresponding ground truth model parameters used in the training set of Model 1 (Ball&amp;Stick). B) Example of input measured signals from a voxel in a healthy participant, used for inference.</p></caption>
<graphic xlink:href="2312.17293v3_fig8.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>All the computations were performed both on CPU and GPU (NVIDIA GeForce RTX 4090).</p>
</sec>
</sec>
</sec>
</body>
<back>
<ack>
<title>5 Acknowledgments</title>
<p>This work, Maeliss Jallais and Marco Palombo are supported by UKRI Future Leaders Fellowship (MR/T020296/2). We are thankful to Dr. Dmitri Sastin and Dr. Khalid Hamandi for sharing their dataset from a participant with epilepsy, and to Dr. Carolyn McNabb, Dr. Eirini Messar-itaki and Dr. Pedro Luque Laguna for preprocessing the data of the healthy participant from the WAND data. The WAND data were acquired at the UK National Facility for In Vivo MR Imaging of Human Tissue Microstructure funded by the EPSRC (grant EP/M029778/1) and The Wolfson Foundation, and supported by a Wellcome Trust Investigator Award (096646/Z/11/Z) and a Wellcome Trust Strategic Award (104943/Z/14/Z).</p>
</ack>
<ref-list>
<title>References</title>
<ref id="R1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Maryam</given-names> <surname>Afzali</surname></string-name>, <string-name><given-names>Markus</given-names> <surname>Nilsson</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, and <string-name><given-names>Derek K</given-names> <surname>Jones</surname></string-name></person-group>. <article-title>SPHERIOUSLY? the challenges of estimating sphere radius non-invasively in the human brain from diffusion MRI</article-title>. <source>NeuroImage,</source> <volume>237</volume>:<fpage>118183</fpage>, <year>2021</year>. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2021.118183</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811921004602">https://linkinghub.elsevier.com/retrieve/pii/S1053811921004602</ext-link>.</mixed-citation></ref>
<ref id="R2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name></person-group>. <article-title>A general framework for experiment design in diffusion MRI and its application in measuring direct tissue-microstructure features</article-title>. <source>Magnetic Resonance in Medicine,</source> <volume>60</volume>(<issue>2</issue>):<fpage>439</fpage>–<lpage>448</lpage>, <year>2008</year>. ISSN <issn>0740-3194</issn>, <issn>1522-2594</issn>. doi: <pub-id pub-id-type="doi">10.1002/mrm.21646</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/10.1002/mrm.21646">https://onlinelibrary.wiley.com/doi/10.1002/mrm.21646</ext-link>.</mixed-citation></ref>
<ref id="R3"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name></person-group>. <chapter-title>Modelling, fitting and sampling in diffusion MRI</chapter-title>. In <person-group person-group-type="editor"><string-name><given-names>David</given-names> <surname>Laidlaw</surname></string-name> and <string-name><given-names>Joachim</given-names> <surname>Weickert</surname></string-name></person-group>, editors, <source>Visualization and Processing of Tensor Fields,</source> pages <fpage>3</fpage>–<lpage>20</lpage>. <publisher-name>Springer Berlin Heidelberg</publisher-name>, <year>2009</year>. ISBN <isbn>978-3-540-88377-7</isbn> <isbn>978-3-540-88378-4</isbn>. doi: <pub-id pub-id-type="doi">10.1007/978-3-540-88378-4-1</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/10.1007/978-3-540-88378-4_1">http://link.springer.com/10.1007/978-3-540-88378-4_1</ext-link>. Series Title: Mathematics and Visualization.</mixed-citation></ref>
<ref id="R4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name>, <string-name><given-names>Tim B.</given-names> <surname>Dyrby</surname></string-name>, <string-name><given-names>Markus</given-names> <surname>Nilsson</surname></string-name>, and <string-name><given-names>Hui</given-names> <surname>Zhang</surname></string-name></person-group>. <article-title>Imaging brain microstructure with diffusion MRI: practicality and applications</article-title>. <source>NMR in Biomedicine</source>, <volume>32</volume>(<issue>4</issue>), <year>2019</year>, <fpage>1099</fpage>–<lpage>1492</lpage>. doi: <pub-id pub-id-type="doi">10.1002/nbm.3841</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/10.1002/nbm.3841">https://onlinelibrary.wiley.com/doi/10.1002/nbm.3841</ext-link>.</mixed-citation></ref>
<ref id="R5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jesper L.R.</given-names> <surname>Andersson</surname></string-name> and <string-name><given-names>Stamatios N.</given-names> <surname>Sotiropoulos</surname></string-name></person-group>. <article-title>An integrated approach to correction for off-resonance effects and subject movement in diffusion MR imaging</article-title>. <source>NeuroImage</source>, <volume>125</volume>:<fpage>10631078</fpage>, <year>2016</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2015.10.019</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811915009209">https://linkinghub.elsevier.com/retrieve/pii/S1053811915009209</ext-link>.</mixed-citation></ref>
<ref id="R6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jesper L.R.</given-names> <surname>Andersson</surname></string-name>, <string-name><given-names>Stefan</given-names> <surname>Skare</surname></string-name>, and <string-name><given-names>John</given-names> <surname>Ashburner</surname></string-name></person-group>. <article-title>How to correct susceptibility distortions in spin-echo echo-planar images: application to diffusion tensor imaging</article-title>. <source>NeuroImage,</source> <volume>20</volume>(<issue>2</issue>):<fpage>870</fpage>–<lpage>888</lpage>, <year>2003</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/S1053-8119(03)00336-7</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811903003367">https://linkinghub.elsevier.com/retrieve/pii/S1053811903003367</ext-link>.</mixed-citation></ref>
<ref id="R7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Giorgio A</given-names> <surname>Ascoli</surname></string-name>, <string-name><given-names>Duncan E</given-names> <surname>Donohue</surname></string-name>, and <string-name><given-names>Maryam</given-names> <surname>Halavi</surname></string-name></person-group>. <article-title>Neuromorpho. org: a central resource for neuronal morphologies</article-title>. <source>Journal of Neuroscience,</source> <volume>27</volume>(<issue>35</issue>):<fpage>9247</fpage>–<lpage>9251</lpage>, <year>2007</year>.</mixed-citation></ref>
<ref id="R8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>T.E.J.</given-names> <surname>Behrens</surname></string-name>, <string-name><given-names>M.W.</given-names> <surname>Woolrich</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Jenkinson</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Johansen-Berg</surname></string-name>, <string-name><given-names>R.G.</given-names> <surname>Nunes</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Clare</surname></string-name>, <string-name><given-names>P.M.</given-names> <surname>Matthews</surname></string-name>, <string-name><given-names>J.M.</given-names> <surname>Brady</surname></string-name>, and <string-name><given-names>S.M.</given-names> <surname>Smith</surname></string-name></person-group>. <article-title>Characterization and propagation of uncertainty in diffusion-weighted MR imaging</article-title>. <source>Magnetic Resonance in Medicine,</source> <volume>50</volume>(<issue>5</issue>):<fpage>1077</fpage>–<lpage>1088</lpage>, <year>2003</year>. ISSN 0740-3194, 1522-2594. doi: <pub-id pub-id-type="doi">10.1002/mrm.10609</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://doi.wiley.com/10.1002/mrm.10609">http://doi.wiley.com/10.1002/mrm.10609</ext-link>.</mixed-citation></ref>
<ref id="R9"><mixed-citation publication-type="report"><person-group person-group-type="author"><string-name><given-names>Christopher M.</given-names> <surname>Bishop</surname></string-name></person-group>. <source>Mixture density networks</source> <publisher-name>Aston University</publisher-name>. <year>1994</year>. URL <ext-link ext-link-type="uri" xlink:href="https://publications.aston.ac.uk/id/eprint/373/">https://publications.aston.ac.uk/id/eprint/373/</ext-link>.</mixed-citation></ref>
<ref id="R10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>M. G. B.</given-names> <surname>Blum</surname></string-name>, <string-name><given-names>M. A.</given-names> <surname>Nunes</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Prangle</surname></string-name>, and <string-name><given-names>S. A.</given-names> <surname>Sisson</surname></string-name></person-group>. <article-title>A comparative review of dimension reduction methods in approximate bayesian computation</article-title>. <source>Statistical Science</source>, <volume>28</volume>(<issue>2</issue>), <year>2013</year>. ISSN 0883-4237. doi: <pub-id pub-id-type="doi">10.1214/12-STS406</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://projecteuclid.org/journals/statistical-science/volume-28/issue-2/A-Comparative-Review-of-Dimension-Reduction-Methods-in-Approximate-Bayesian/10.1214/12-STS406.full">https://projecteuclid.org/journals/statistical-science/volume-28/issue-2/A-Comparative-Review-of-Dimension-Reduction-Methods-in-Approximate-Bayesian/10.1214/12-STS406.full</ext-link>.</mixed-citation></ref>
<ref id="R11"><mixed-citation publication-type="book"><person-group person-group-type="author"><collab>George EP Box and George C Tiao</collab></person-group>. <source>Bayesian inference in statistical analysis</source>. <publisher-name>John Wiley &amp; Sons</publisher-name>, <year>2011</year>.</mixed-citation></ref>
<ref id="R12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ross</given-names> <surname>Callaghan</surname></string-name>, <string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, and <string-name><given-names>Hui</given-names> <surname>Zhang</surname></string-name></person-group>. <article-title>Config: Contextual fibre growth to generate realistic axonal packing for diffusion mri simulation</article-title>. <source>NeuroImage</source>, <volume>220</volume>: <fpage>117107</fpage>, <year>2020</year>. ISSN 1053-8119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.117107</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S1053811920305930">https://www.sciencedirect.com/science/article/pii/S1053811920305930</ext-link>.</mixed-citation></ref>
<ref id="R13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>SungWon</given-names> <surname>Chung</surname></string-name>, <string-name><given-names>Ying</given-names> <surname>Lu</surname></string-name>, and <string-name><given-names>Roland G.</given-names> <surname>Henry</surname></string-name></person-group>. <article-title>Comparison of bootstrap approaches for estimation of uncertainties of DTI parameters</article-title>. <source>NeuroImage,</source> <volume>33</volume>(<issue>2</issue>):<fpage>531</fpage>–<lpage>541</lpage>, <year>2006</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2006.07.001</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811906007403">https://linkinghub.elsevier.com/retrieve/pii/S1053811906007403</ext-link>.</mixed-citation></ref>
<ref id="R14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Lucilio</given-names> <surname>Cordero-Grande</surname></string-name>, <string-name><given-names>Daan</given-names> <surname>Christiaens</surname></string-name>, <string-name><given-names>Jana</given-names> <surname>Hutter</surname></string-name>, <string-name><given-names>Anthony N.</given-names> <surname>Price</surname></string-name>, and <string-name><given-names>Jo V.</given-names> <surname>Hajnal</surname></string-name></person-group>. <article-title>Complex diffusion-weighted image estimation via matrix recovery under general noise models</article-title>. <source>NeuroImage,</source> <volume>200</volume>:<fpage>391</fpage>–<lpage>404</lpage>, <year>2019</year>. ISSN 1053-8119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2019.06.039</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.sciencedirect.com/science/article/pii/S1053811919305348">https://www.sciencedirect.com/science/article/pii/S1053811919305348</ext-link>.</mixed-citation></ref>
<ref id="R15"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Kyle</given-names> <surname>Cranmer</surname></string-name>, <string-name><given-names>Juan</given-names> <surname>Pavez</surname></string-name>, and <string-name><given-names>Gilles</given-names> <surname>Louppe</surname></string-name></person-group>. <article-title>Approximating likelihood ratios with calibrated discriminative classifiers</article-title>, <source>arXiv</source> <year>2016</year>. URL <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1506.02169">http://arxiv.org/abs/1506.02169</ext-link>.</mixed-citation></ref>
<ref id="R16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Kyle</given-names> <surname>Cranmer</surname></string-name>, <string-name><given-names>Johann</given-names> <surname>Brehmer</surname></string-name>, and <string-name><given-names>Gilles</given-names> <surname>Louppe</surname></string-name></person-group>. <article-title>The frontier of simulation-based inference</article-title>. <source>Proceedings of the National Academy of Sciences</source>, page <fpage>201912789</fpage>, <year>2020</year>. ISSN 0027-8424, 10916490. doi: <pub-id pub-id-type="doi">10.1073/pnas.1912789117</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.pnas.org/lookup/doi/10.1073/pnas">http://www.pnas.org/lookup/doi/10.1073/pnas</ext-link>. 1912789117.</mixed-citation></ref>
<ref id="R17"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Joao P. De Almeida</given-names> <surname>Martins</surname></string-name>, <string-name><given-names>Markus</given-names> <surname>Nilsson</surname></string-name>, <string-name><given-names>Bjorn</given-names> <surname>Lampinen</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, <string-name><given-names>Peter T.</given-names> <surname>While</surname></string-name>, <string-name><given-names>Carl-Fredrik</given-names> <surname>Westin</surname></string-name>, and <string-name><given-names>Filip</given-names> <surname>Szczepankiewicz</surname></string-name></person-group>. <article-title>Neural networks for parameter estimation in microstructural MRI: Application to a diffusion-relaxation model of white matter</article-title>. <source>NeuroImage</source>, <volume>244</volume>:<fpage>118601</fpage>, <year>2021</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2021.118601</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811921008740">https://linkinghub.elsevier.com/retrieve/pii/S1053811921008740</ext-link>.</mixed-citation></ref>
<ref id="R18"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Sean CL</given-names> <surname>Deoni</surname></string-name>, <string-name><given-names>Brian K</given-names> <surname>Rutt</surname></string-name>, <string-name><given-names>Tarunya</given-names> <surname>Arun</surname></string-name>, <string-name><given-names>Carlo</given-names> <surname>Pierpaoli</surname></string-name>, and <string-name><given-names>Derek K</given-names> <surname>Jones</surname></string-name></person-group>. <chapter-title>Gleaning multicomponent t1 and t2 information from steady-state imaging data</chapter-title>. <source>Magnetic Resonance in Medicine: An Official Journal of the International Society for Magnetic Resonance in Medicine</source>, <volume>60</volume>(<issue>6</issue>):<fpage>1372</fpage>–<lpage>1387</lpage>, <year>2008</year>. <publisher-name>Publisher: Wiley Online Library</publisher-name>.</mixed-citation></ref>
<ref id="R19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Olaf</given-names> <surname>Dietrich</surname></string-name>, <string-name><given-names>Jose G.</given-names> <surname>Raya</surname></string-name>, <string-name><given-names>Scott B.</given-names> <surname>Reeder</surname></string-name>, <string-name><given-names>Maximilian F.</given-names> <surname>Reiser</surname></string-name>, and <string-name><given-names>Stefan O.</given-names> <surname>Schoenberg</surname></string-name></person-group>. <article-title>Measurement of signal-to-noise ratios in MR images: Influence of multichannel coils, parallel imaging, and reconstruction filters</article-title>. <source>Journal of Magnetic Resonance Imaging</source>, <volume>26</volume>(<issue>2</issue>):<fpage>375</fpage>–<lpage>385</lpage>, <year>2007</year>. ISSN 10531807, 15222586. doi: <pub-id pub-id-type="doi">10.1002/jmri.20969</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/10.1002/jmri.20969">https://onlinelibrary.wiley.com/doi/10.1002/jmri.20969</ext-link>.</mixed-citation></ref>
<ref id="R20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Peter J.</given-names> <surname>Diggle</surname></string-name> and <string-name><given-names>Richard J.</given-names> <surname>Gratton</surname></string-name></person-group>. <article-title>Monte carlo methods of inference for implicit statistical models</article-title>. <source>Journal of the Royal Statistical Society: Series B (Methodological),</source> <volume>46</volume>(<issue>2</issue>):<fpage>193</fpage>–<lpage>212</lpage>, <year>1984</year>. ISSN 00359246. doi: <pub-id pub-id-type="doi">10.1111/j.2517-6161.1984.tb01290.x</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1984.tb01290.x">https://onlinelibrary.wiley.com/doi/10.1111/j.2517-6161.1984.tb01290.x</ext-link>.</mixed-citation></ref>
<ref id="R21"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Conor</given-names> <surname>Durkan</surname></string-name>, <string-name><given-names>Artur</given-names> <surname>Bekasov</surname></string-name>, <string-name><given-names>Iain</given-names> <surname>Murray</surname></string-name>, and <string-name><given-names>George</given-names> <surname>Papamakarios</surname></string-name></person-group>. <article-title>Neural spline flows</article-title>. <source>Advances in neural information processing systems</source>, <volume>32</volume>, <year>2019</year>.</mixed-citation></ref>
<ref id="R22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Paul</given-names> <surname>Fearnhead</surname></string-name> and <string-name><given-names>Dennis</given-names> <surname>Prangle</surname></string-name></person-group>. <article-title>Constructing summary statistics for approximate bayesian computation: Semi-automatic approximate bayesian computation</article-title>. <source>Journal of the Royal Statistical Society Series B: Statistical Methodology,</source> <volume>74</volume>(<issue>3</issue>):<fpage>419</fpage>–<lpage>474</lpage>, <year>2012</year>. ISSN 1369-7412, 1467-9868. doi: <pub-id pub-id-type="doi">10.1111/j.1467-9868.2011.01010.x</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://academic.oup.com/jrsssb/article/74/3/419/7075312">https://academic.oup.com/jrsssb/article/74/3/419/7075312</ext-link>.</mixed-citation></ref>
<ref id="R23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Rutger H.J.</given-names> <surname>Fick</surname></string-name>, <string-name><given-names>Demian</given-names> <surname>Wassermann</surname></string-name>, <string-name><given-names>Emmanuel</given-names> <surname>Caruyer</surname></string-name>, and <string-name><given-names>Rachid</given-names> <surname>Deriche</surname></string-name></person-group>. <article-title>MAPL: Tissue microstructure estimation using laplacian-regularized MAP-MRI and its application to HCP data</article-title>. <source>NeuroImage,</source> <volume>134</volume>:<fpage>365</fpage>–<lpage>385</lpage>, <year>2016</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.03.046</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811916002512">https://linkinghub.elsevier.com/retrieve/pii/S1053811916002512</ext-link>.</mixed-citation></ref>
<ref id="R24"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Mathieu</given-names> <surname>Germain</surname></string-name>, <string-name><given-names>Karol</given-names> <surname>Gregor</surname></string-name>, <string-name><given-names>Iain</given-names> <surname>Murray</surname></string-name>, and <string-name><given-names>Hugo</given-names> <surname>Larochelle</surname></string-name></person-group>. <chapter-title>Made: Masked autoencoder for distribution estimation</chapter-title>. In <source>International conference on machine learning</source>, pages <fpage>881</fpage>–<lpage>889</lpage>. <publisher-name>PMLR</publisher-name>, <year>2015</year>.</mixed-citation></ref>
<ref id="R25"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Matthew F.</given-names> <surname>Glasser</surname></string-name>, <string-name><given-names>Stamatios N.</given-names> <surname>Sotiropoulos</surname></string-name>, <string-name><given-names>J. Anthony</given-names> <surname>Wilson</surname></string-name>, <string-name><given-names>Timothy S.</given-names> <surname>Coalson</surname></string-name>, <string-name><given-names>Bruce</given-names> <surname>Fischl</surname></string-name>, <string-name><given-names>Jesper L.</given-names> <surname>Andersson</surname></string-name>, <string-name><given-names>Junqian</given-names> <surname>Xu</surname></string-name>, <string-name><given-names>Saad</given-names> <surname>Jbabdi</surname></string-name>, <string-name><given-names>Matthew</given-names> <surname>Webster</surname></string-name>, <string-name><given-names>Jonathan R.</given-names> <surname>Polimeni</surname></string-name>, <string-name><given-names>David C. Van</given-names> <surname>Essen</surname></string-name>, and <string-name><given-names>Mark</given-names> <surname>Jenkinson</surname></string-name></person-group>. <article-title>The minimal preprocessing pipelines for the human connectome pro ject</article-title>. <source>NeuroImage</source>, <volume>80</volume>:<fpage>105</fpage>–<lpage>124</lpage>, <year>2013</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage</pub-id>. 2013.04.127. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811913005053">https://linkinghub.elsevier.com/retrieve/pii/S1053811913005053</ext-link>.</mixed-citation></ref>
<ref id="R26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Pedro J</given-names> <surname>Goncalves</surname></string-name>, <string-name><given-names>Jan-Matthis</given-names> <surname>Lueckmann</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Deistler</surname></string-name>, <string-name><given-names>Marcel</given-names> <surname>Nonnenmacher</surname></string-name>, <string-name><given-names>Kaan</given-names> <surname>Ocal</surname></string-name>, <string-name><given-names>Giacomo</given-names> <surname>Bassetto</surname></string-name>, <string-name><given-names>Chaitanya</given-names> <surname>Chintaluri</surname></string-name>, <string-name><given-names>William F</given-names> <surname>Podlaski</surname></string-name>, <string-name><given-names>Sara A</given-names> <surname>Haddad</surname></string-name>, <string-name><given-names>Tim P</given-names> <surname>Vogels</surname></string-name>, <string-name><given-names>David S</given-names> <surname>Greenberg</surname></string-name>, and <string-name><given-names>Jakob H</given-names> <surname>Macke</surname></string-name></person-group>. <article-title>Training deep neural density estimators to identify mechanistic models of neural dynamics</article-title>. <source>eLife</source>, <volume>9</volume>:<elocation-id>e56261</elocation-id>, <year>2020</year>. ISSN 2050-084X. doi: <pub-id pub-id-type="doi">10.7554/eLife.56261</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://elifesciences.org/articles/56261">https://elifesciences.org/articles/56261</ext-link>.</mixed-citation></ref>
<ref id="R27"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Ian J.</given-names> <surname>Goodfellow</surname></string-name>, <string-name><given-names>Jean</given-names> <surname>Pouget-Abadie</surname></string-name>, <string-name><given-names>Mehdi</given-names> <surname>Mirza</surname></string-name>, <string-name><given-names>Bing</given-names> <surname>Xu</surname></string-name>, <string-name><given-names>David</given-names> <surname>Warde-Farley</surname></string-name>, <string-name><given-names>Sherjil</given-names> <surname>Ozair</surname></string-name>, <string-name><given-names>Aaron</given-names> <surname>Courville</surname></string-name>, and <string-name><given-names>Yoshua</given-names> <surname>Bengio</surname></string-name></person-group>. <article-title>Generative adversarial networks</article-title>, <source>arXiv</source> <year>2014</year>. URL <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1406.2661">http://arxiv.org/abs/1406.2661</ext-link>.</mixed-citation></ref>
<ref id="R28"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>David S.</given-names> <surname>Greenberg</surname></string-name>, <string-name><given-names>Marcel</given-names> <surname>Nonnenmacher</surname></string-name>, and <string-name><given-names>Jakob H.</given-names> <surname>Macke</surname></string-name></person-group>. <article-title>Automatic posterior transformation for likelihood-free inference</article-title>, <source>arXiv</source> <year>2019</year>. URL <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/1905.07488">http://arxiv.org/abs/1905.07488</ext-link>.</mixed-citation></ref>
<ref id="R29"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Michele</given-names> <surname>Guerreri</surname></string-name>, <string-name><given-names>Sean</given-names> <surname>Epstein</surname></string-name>, <string-name><given-names>Hojjat</given-names> <surname>Azadbakht</surname></string-name>, and <string-name><given-names>Hui</given-names> <surname>Zhang</surname></string-name></person-group>. <article-title>Resolving quantitative MRI model degeneracy with machine learning via training data distribution design</article-title>, <source>arXiv</source> <year>2023</year>. URL <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2303.05464">http://arxiv.org/abs/2303.05464</ext-link>.</mixed-citation></ref>
<ref id="R30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Michael U.</given-names> <surname>Gutmann</surname></string-name>, <string-name><given-names>Ritabrata</given-names> <surname>Dutta</surname></string-name>, <string-name><given-names>Samuel</given-names> <surname>Kaski</surname></string-name>, and <string-name><given-names>Jukka</given-names> <surname>Corander</surname></string-name></person-group>. <article-title>Likelihood-free inference via classification</article-title>. <source>Statistics and Computing</source>, <volume>28</volume>(<issue>2</issue>):<fpage>411</fpage>–<lpage>425</lpage>, <year>2018</year>. ISSN 0960-3174, 1573-1375. doi: <pub-id pub-id-type="doi">10.1007/s11222-017-9738-6</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/10.1007/s11222-017-9738-6">http://link.springer.com/10.1007/s11222-017-9738-6</ext-link>.</mixed-citation></ref>
<ref id="R31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Noemi G.</given-names> <surname>Gyori</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, <string-name><given-names>Christopher A.</given-names> <surname>Clark</surname></string-name>, <string-name><given-names>Hui</given-names> <surname>Zhang</surname></string-name>, and <string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name></person-group>. <article-title>Training data distribution significantly impacts the estimation of tissue microstructure with machine learning</article-title>. <source>Magnetic Resonance in Medicine</source>, <volume>87</volume>(<issue>2</issue>):<fpage>932</fpage>–<lpage>947</lpage>, <year>2022</year>. ISSN 0740-3194, 15222594. doi: <pub-id pub-id-type="doi">10.1002/mrm.29014</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/10.1002/mrm.29014">https://onlinelibrary.wiley.com/doi/10.1002/mrm.29014</ext-link>.</mixed-citation></ref>
<ref id="R32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Robbert L.</given-names> <surname>Harms</surname></string-name> and <string-name><given-names>Alard</given-names> <surname>Roebroeck</surname></string-name></person-group>. <article-title>Robust and fast markov chain monte carlo sampling of diffusion MRI microstructure models</article-title>. <source>Frontiers in Neuroinformatics</source>, <volume>12</volume>:<fpage>97</fpage>, <year>2018</year>. ISSN 16625196. doi: <pub-id pub-id-type="doi">10.3389/fninf.2018.00097</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.frontiersin.org/article/10.3389/fninf.2018.00097/full">https://www.frontiersin.org/article/10.3389/fninf.2018.00097/full</ext-link>.</mixed-citation></ref>
<ref id="R33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Rafael N.</given-names> <surname>Henriques</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, <string-name><given-names>Sune N.</given-names> <surname>Jespersen</surname></string-name>, <string-name><given-names>Noam</given-names> <surname>Shemesh</surname></string-name>, <string-name><given-names>Henrik</given-names> <surname>Lundell</surname></string-name>, and <string-name><given-names>Andrada</given-names> <surname>lanus</surname></string-name></person-group>. <article-title>Double diffusion encoding and applications for biomedical imaging</article-title>. <source>Journal of Neuroscience Methods</source>, <volume>348</volume>:<fpage>108989</fpage>, <year>2021</year>. ISSN 01650270. doi: <pub-id pub-id-type="doi">10.1016/j.jneumeth.2020.108989</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S016502702030412X">https://linkinghub.elsevier.com/retrieve/pii/S016502702030412X</ext-link>.</mixed-citation></ref>
<ref id="R34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Amy Fd</given-names> <surname>Howard</surname></string-name>, <string-name><given-names>Michiel</given-names> <surname>Cottaar</surname></string-name>, <string-name><given-names>Mark</given-names> <surname>Drakesmith</surname></string-name>, <string-name><given-names>Qiuyun</given-names> <surname>Fan</surname></string-name>, <string-name><given-names>Susie Y.</given-names> <surname>Huang</surname></string-name>, <string-name><given-names>Derek K.</given-names> <surname>Jones</surname></string-name>, <string-name><given-names>Frederik J.</given-names> <surname>Lange</surname></string-name>, <string-name><given-names>Jeroen</given-names> <surname>Mollink</surname></string-name>, <string-name><given-names>Suryanarayana Umesh</given-names> <surname>Rudrapatna</surname></string-name>, <string-name><given-names>Qiyuan</given-names> <surname>Tian</surname></string-name>, <string-name><given-names>Karla L</given-names> <surname>Miller</surname></string-name>, and <string-name><given-names>Saad</given-names> <surname>Jbabdi</surname></string-name></person-group>. <article-title>Estimating axial diffusivity in the NODDI model</article-title>. <source>NeuroImage</source>, <volume>262</volume>:<fpage>119535</fpage>, <year>2022</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2022.119535</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811922006504">https://linkinghub.elsevier.com/retrieve/pii/S1053811922006504</ext-link>.</mixed-citation></ref>
<ref id="R35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Andrada</given-names> <surname>lanus</surname></string-name>, <string-name><given-names>Noam</given-names> <surname>Shemesh</surname></string-name>, <string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name>, and <string-name><given-names>Ivana</given-names> <surname>Drobnjak</surname></string-name></person-group>. <article-title>Double oscillating diffusion encoding and sensitivity to microscopic anisotropy: Double oscillating diffusion encoding</article-title>. <source>Magnetic Resonance in Medicine,</source> <volume>78</volume>(<issue>2</issue>):<fpage>550</fpage>–<lpage>564</lpage>, <year>2017</year>. ISSN 07403194. doi: <pub-id pub-id-type="doi">10.1002/mrm.26393</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/10.1002/mrm.26393">https://onlinelibrary.wiley.com/doi/10.1002/mrm.26393</ext-link>.</mixed-citation></ref>
<ref id="R36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Maeliss</given-names> <surname>Jallais</surname></string-name>, <string-name><given-names>Pedro L. C.</given-names> <surname>Rodrigues</surname></string-name>, <string-name><given-names>Alexandre</given-names> <surname>Gramfort</surname></string-name>, and <string-name><given-names>Demian</given-names> <surname>Wassermann</surname></string-name></person-group>. <article-title>Inverting brain grey matter models with likelihood-free inference: a tool for trustable cytoarchitecture measurements</article-title>. <source>Machine Learning for Biomedical Imaging,</source> <volume>1</volume>:<fpage>1</fpage>–<lpage>28</lpage>, <year>2022</year>. ISSN 2766-905X. doi: <pub-id pub-id-type="doi">10.59275/j.melba.2022-a964</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://melba-journal.org/2022:010">https://melba-journal.org/2022:010</ext-link>.</mixed-citation></ref>
<ref id="R37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Maeliss</given-names> <surname>Jallais</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, <string-name><given-names>Ileana</given-names> <surname>Jelescu</surname></string-name>, and <string-name><given-names>Quentin</given-names> <surname>Uhl</surname></string-name></person-group>. <article-title>Shining light on degeneracies and uncertainties in the NEXI and SANDIX models with μGUIDE</article-title>. In <source>ISMRM 2024,</source> <year>2024</year>.</mixed-citation></ref>
<ref id="R38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ileana O.</given-names> <surname>Jelescu</surname></string-name> and <string-name><given-names>Matthew D.</given-names> <surname>Budde</surname></string-name></person-group>. <article-title>Design and validation of diffusion MRI models of white matter</article-title>. <source>Frontiers in Physics</source>, <volume>5</volume>, <year>2017</year>. ISSN 2296-424X. doi: <pub-id pub-id-type="doi">10.3389/fphy.2017.00061</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://journal.frontiersin.org/article/10.3389/fphy.2017.00061/full">http://journal.frontiersin.org/article/10.3389/fphy.2017.00061/full</ext-link>.</mixed-citation></ref>
<ref id="R39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ileana O.</given-names> <surname>Jelescu</surname></string-name>, <string-name><given-names>Jelle</given-names> <surname>Veraart</surname></string-name>, <string-name><given-names>Els</given-names> <surname>Fieremans</surname></string-name>, and <string-name><given-names>Dmitry S.</given-names> <surname>Novikov</surname></string-name></person-group>. <article-title>Degeneracy in model parameter estimation for multi-compartmental diffusion in neuronal tissue: Degeneracy in model parameter estimation of diffusion in neural tissue</article-title>. <source>NMR in Biomedicine</source>, <volume>29</volume>(<issue>1</issue>):<fpage>33</fpage>–<lpage>47</lpage>, <year>2016</year>. ISSN 09523480. doi: <pub-id pub-id-type="doi">10.1002/nbm.3450</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://doi.wiley.com/10.1002/nbm.3450">http://doi.wiley.com/10.1002/nbm.3450</ext-link>.</mixed-citation></ref>
<ref id="R40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ileana O.</given-names> <surname>Jelescu</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, <string-name><given-names>Francesca</given-names> <surname>Bagnato</surname></string-name>, and <string-name><given-names>Kurt G.</given-names> <surname>Schilling</surname></string-name></person-group>. <article-title>Challenges for biophysical modeling of microstructure</article-title>. <source>Journal of Neuroscience Methods</source>, <volume>344</volume>:<fpage>108861</fpage>, <year>2020</year>. ISSN 01650270. doi: <pub-id pub-id-type="doi">10.1016/j.jneumeth.2020.108861</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S0165027020302843">https://linkinghub.elsevier.com/retrieve/pii/S0165027020302843</ext-link>.</mixed-citation></ref>
<ref id="R41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Ileana O.</given-names> <surname>Jelescu</surname></string-name>, <string-name><given-names>Alexandre de</given-names> <surname>Skowronski</surname></string-name>, <string-name><given-names>Francoise</given-names> <surname>Geffroy</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, and <string-name><given-names>Dmitry S.</given-names> <surname>Novikov</surname></string-name></person-group>. <article-title>Neurite exchange imaging (NEXI): A minimal model of diffusion in gray matter with inter-compartment water exchange</article-title>. <source>NeuroImage</source>, <volume>256</volume>:<fpage>119277</fpage>, <year>2022</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2022.119277</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811922003986">https://linkinghub.elsevier.com/retrieve/pii/S1053811922003986</ext-link>.</mixed-citation></ref>
<ref id="R42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Derek K.</given-names> <surname>Jones</surname></string-name></person-group>. <article-title>Determining and visualizing uncertainty in estimates of fiber orientation from diffusion tensor MRI</article-title>. <source>Magnetic Resonance in Medicine</source>, <volume>49</volume>(<issue>1</issue>):<fpage>7</fpage>–<lpage>12</lpage>, <year>2003</year>. ISSN 0740-3194, 1522-2594. doi: <pub-id pub-id-type="doi">10.1002/mrm.10331</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://doi.wiley.com/10.1002/mrm.10331">http://doi.wiley.com/10.1002/mrm.10331</ext-link>.</mixed-citation></ref>
<ref id="R43"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>D.K.</given-names> <surname>Jones</surname></string-name>, <string-name><given-names>D.C.</given-names> <surname>Alexander</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Bowtell</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Cercignani</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Dell’Acqua</surname></string-name>, <string-name><given-names>D.J.</given-names> <surname>McHugh</surname></string-name>, <string-name><given-names>K.L.</given-names> <surname>Miller</surname></string-name>, <string-name><given-names>M.</given-names> <surname>Palombo</surname></string-name>, <string-name><given-names>G.J.M.</given-names> <surname>Parker</surname></string-name>, <string-name><given-names>U.S.</given-names> <surname>Rudrapatna</surname></string-name>, and <string-name><given-names>C.M.W.</given-names> <surname>Tax</surname></string-name></person-group>. <article-title>Microstructural imaging of the human brain with a ‘super-scanner’: 10 key advantages of ultra-strong gradients for diffusion MRI</article-title>. <source>NeuroImage</source>, <volume>182</volume>:<fpage>8</fpage>–<lpage>38</lpage>, <year>2018</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.05.047</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811918304610">https://linkinghub.elsevier.com/retrieve/pii/S1053811918304610</ext-link>.</mixed-citation></ref>
<ref id="R44"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Hazhar Sufi</given-names> <surname>Karimi</surname></string-name>, <string-name><given-names>Arghya</given-names> <surname>Pal</surname></string-name>, <string-name><given-names>Lipeng</given-names> <surname>Ning</surname></string-name>, and <string-name><given-names>Yogesh</given-names> <surname>Rathi</surname></string-name></person-group>. <article-title>Likelihood-free posterior estimation and uncertainty quantification for diffusion MRI models</article-title>. <source>Imaging Neuroscience</source>, <year>2024</year>. ISSN 2837-6056. doi: <pub-id pub-id-type="doi">10.1162/imag_a_00088</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://direct.mit.edu/imag/article/doi/10.1162/imag_a_00088/119146/Likelihood-free-Posterior-Estimation-and">https://direct.mit.edu/imag/article/doi/10.1162/imag_a_00088/119146/Likelihood-free-Posterior-Estimation-and</ext-link>.</mixed-citation></ref>
<ref id="R45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Goran</given-names> <surname>Kauermann</surname></string-name>, <string-name><given-names>Gerda</given-names> <surname>Claeskens</surname></string-name>, and <string-name><given-names>J. D.</given-names> <surname>Opsomer</surname></string-name></person-group>. <article-title>Bootstrapping for penalized spline regression</article-title>. <source>Journal of Computational and Graphical Statistics</source>, <volume>18</volume>(<issue>1</issue>):<fpage>126</fpage>–<lpage>146</lpage>, <year>2009</year>. ISSN 10618600, 1537-2715. doi: <pub-id pub-id-type="doi">10.1198/jcgs.2009.0008</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.tandfonline.com/doi/abs/10.1198/jcgs.2009.0008">http://www.tandfonline.com/doi/abs/10.1198/jcgs.2009.0008</ext-link>.</mixed-citation></ref>
<ref id="R46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Elias</given-names> <surname>Kellner</surname></string-name>, <string-name><given-names>Bibek</given-names> <surname>Dhital</surname></string-name>, <string-name><given-names>Valerij G.</given-names> <surname>Kiselev</surname></string-name>, and <string-name><given-names>Marco</given-names> <surname>Reisert</surname></string-name></person-group>. <article-title>Gibbs-ringing artifact removal based on local subvoxel-shifts</article-title>. <source>Magnetic Resonance in Medicine</source>, <volume>76</volume>(<issue>5</issue>):<fpage>1574</fpage>–<lpage>1581</lpage>, <year>2016</year>. doi: <pub-id pub-id-type="doi">10.1002/mrm.26054</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/abs/10.1002/mrm.26054">https://onlinelibrary.wiley.com/doi/abs/10.1002/mrm.26054</ext-link>.</mixed-citation></ref>
<ref id="R47"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Diederik</given-names> <surname>Kingma</surname></string-name> and <string-name><given-names>Jimmy</given-names> <surname>Ba</surname></string-name></person-group>. <article-title>Adam: A method for stochastic optimization</article-title>. In <source>International Conference on Learning Representations (ICLR)</source>, <year>2015</year>.</mixed-citation></ref>
<ref id="R48"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>Diederik P.</given-names> <surname>Kingma</surname></string-name> and <string-name><given-names>Max</given-names> <surname>Welling</surname></string-name></person-group>. <chapter-title>An introduction to variational autoencoders</chapter-title>. In <source>Foundations and Trends® in Machine Learning,</source> volume <volume>12</volume>, pages <fpage>307</fpage>–<lpage>392</lpage>. <publisher-name>now Publishers Inc</publisher-name>, <year>2019</year>. doi: <pub-id pub-id-type="doi">10.1561/2200000056</pub-id>.</mixed-citation></ref>
<ref id="R49"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Martin A.</given-names> <surname>Koch</surname></string-name>, <string-name><given-names>David G.</given-names> <surname>Norris</surname></string-name>, and <string-name><given-names>Margret</given-names> <surname>Hund-Georgiadis</surname></string-name></person-group>. <article-title>An investigation of functional and anatomical connectivity using magnetic resonance imaging</article-title>. <source>NeuroImage</source>, <volume>16</volume>(<issue>1</issue>):<fpage>241</fpage>–<lpage>250</lpage>, <year>2002</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1006/nimg.2001.1052</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811901910523">https://linkinghub.elsevier.com/retrieve/pii/S1053811901910523</ext-link>.</mixed-citation></ref>
<ref id="R50"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Kristin</given-names> <surname>Koller</surname></string-name>, <string-name><given-names>Umesh</given-names> <surname>Rudrapatna</surname></string-name>, <string-name><given-names>Maxime</given-names> <surname>Chamberland</surname></string-name>, <string-name><given-names>Erika P.</given-names> <surname>Raven</surname></string-name>, <string-name><given-names>Greg D.</given-names> <surname>Parker</surname></string-name>, <string-name><given-names>Chantal M.W.</given-names> <surname>Tax</surname></string-name>, <string-name><given-names>Mark</given-names> <surname>Drakesmith</surname></string-name>, <string-name><given-names>Fabrizio</given-names> <surname>Fasano</surname></string-name>, <string-name><given-names>David</given-names> <surname>Owen</surname></string-name>, <string-name><given-names>Garin</given-names> <surname>Hughes</surname></string-name>, <string-name><given-names>Cyril</given-names> <surname>Charron</surname></string-name>, <string-name><given-names>C John</given-names> <surname>Evans</surname></string-name>, and <string-name><given-names>Derek K.</given-names> <surname>Jones</surname></string-name></person-group>. <article-title>MICRA: Microstructural image compilation with repeated acquisitions</article-title>. <source>NeuroImage</source>, <volume>225</volume>:<fpage>117406</fpage>, <year>2021</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.117406</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811920308910">https://linkinghub.elsevier.com/retrieve/pii/S1053811920308910</ext-link>.</mixed-citation></ref>
<ref id="R51"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Bjorn</given-names> <surname>Lampmen</surname></string-name>, <string-name><given-names>Filip</given-names> <surname>Szczepankiewicz</surname></string-name>, <string-name><given-names>Jimmy</given-names> <surname>Latt</surname></string-name>, <string-name><given-names>Linda</given-names> <surname>Knutsson</surname></string-name>, <string-name><given-names>Johan</given-names> <surname>Martensson</surname></string-name>, <string-name><given-names>Isabella M.</given-names> <surname>Bjorkman-Burtscher</surname></string-name>, <string-name><given-names>Danielle Van</given-names> <surname>Westen</surname></string-name>, <string-name><given-names>Pia C.</given-names> <surname>Sundgren</surname></string-name>, <string-name><given-names>Freddy</given-names> <surname>Stahlberg</surname></string-name>, and <string-name><given-names>Markus</given-names> <surname>Nilsson</surname></string-name></person-group>. <article-title>Probing brain tissue microstructure with MRI: principles, challenges, and the role of multidimensional diffusion-relaxation encoding</article-title>. <source>NeuroImage</source>, <volume>282</volume>:<fpage>120338</fpage>, <year>2023</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2023.120338</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811923004895">https://linkinghub.elsevier.com/retrieve/pii/S1053811923004895</ext-link>.</mixed-citation></ref>
<ref id="R52"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Mariana</given-names> <surname>Lazar</surname></string-name> and <string-name><given-names>Andrew L.</given-names> <surname>Alexander</surname></string-name></person-group>. <article-title>Bootstrap white matter tractography (BOOT-TRAC)</article-title>. <source>NeuroImage</source>, <volume>24</volume>(<issue>2</issue>):<fpage>524</fpage>–<lpage>532</lpage>, <year>2005</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2004.08.050</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811904005130">https://linkinghub.elsevier.com/retrieve/pii/S1053811904005130</ext-link>.</mixed-citation></ref>
<ref id="R53"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><given-names>Jan-Matthis</given-names> <surname>Lueckmann</surname></string-name>, <string-name><given-names>Pedro J</given-names> <surname>Goncalves</surname></string-name>, <string-name><given-names>Giacomo</given-names> <surname>Bassetto</surname></string-name>, <string-name><given-names>Kaan</given-names> <surname>Ocal</surname></string-name>, <string-name><given-names>Marcel</given-names> <surname>Nonnenmacher</surname></string-name>, and <string-name><given-names>Jakob H</given-names> <surname>Macke</surname></string-name></person-group>. <article-title>Flexible statistical inference for mechanistic models of neural dynamics</article-title>. In <person-group person-group-type="editor"><string-name><given-names>I.</given-names> <surname>Guyon</surname></string-name>, <string-name><given-names>U. Von</given-names> <surname>Luxburg</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Bengio</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Wallach</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Fergus</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Vishwanathan</surname></string-name>, and <string-name><given-names>R.</given-names> <surname>Garnett</surname></string-name></person-group>, editors, <source>Advances in Neural Information Processing Systems</source>, volume <volume>30</volume>. <publisher-name>Curran Associates, Inc.</publisher-name>, <year>2017</year>. URL <ext-link ext-link-type="uri" xlink:href="https://proceedings.neurips.cc/paper_files/paper/2017/file/addfa9b7e234254d26e9c7f2af1005cb-Paper.pdf">https://proceedings.neurips.cc/paper_files/paper/2017/file/addfa9b7e234254d26e9c7f2af1005cb-Paper.pdf</ext-link>.</mixed-citation></ref>
<ref id="R54"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><given-names>Jan-Matthis</given-names> <surname>Lueckmann</surname></string-name>, <string-name><given-names>Giacomo</given-names> <surname>Bassetto</surname></string-name>, <string-name><given-names>Theofanis</given-names> <surname>Karaletsos</surname></string-name>, and <string-name><given-names>Jakob H.</given-names> <surname>Macke</surname></string-name></person-group>. <article-title>Likelihood-free inference with emulator networks</article-title>. In <person-group person-group-type="editor"><string-name><given-names>Francisco</given-names> <surname>Ruiz</surname></string-name>, <string-name><given-names>Cheng</given-names> <surname>Zhang</surname></string-name>, <string-name><given-names>Dawen</given-names> <surname>Liang</surname></string-name>, and <string-name><given-names>Thang</given-names> <surname>Bui</surname></string-name></person-group>, editors, <source>Proceedings of The 1st Symposium on Advances in Approximate Bayesian Inference, volume 96 of Proceedings of Machine Learning Research</source>, pages <fpage>32</fpage>–<lpage>53</lpage>. <publisher-name>PMLR</publisher-name>, <year>2019</year>. URL <ext-link ext-link-type="uri" xlink:href="https://proceedings.mlr.press/v96/lueckmann19a.html">https://proceedings.mlr.press/v96/lueckmann19a.html</ext-link>.</mixed-citation></ref>
<ref id="R55"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><given-names>Jan-Matthis</given-names> <surname>Lueckmann</surname></string-name>, <string-name><given-names>Jan</given-names> <surname>Boelts</surname></string-name>, <string-name><given-names>David</given-names> <surname>Greenberg</surname></string-name>, <string-name><given-names>Pedro</given-names> <surname>Goncalves</surname></string-name>, and <string-name><given-names>Jakob</given-names> <surname>Macke</surname></string-name></person-group>. <article-title>Benchmarking simulation-based inference</article-title>. In <person-group person-group-type="editor"><string-name><given-names>Arindam</given-names> <surname>Banerjee</surname></string-name> and <string-name><given-names>Kenji</given-names> <surname>Fukumizu</surname></string-name></person-group>, editors, <source>Proceedings of The 24th International Conference on Artificial Intelligence and Statistics, volume 130 of Proceedings of Machine Learning Research</source>, pages <fpage>343</fpage>–<lpage>351</lpage>. <publisher-name>PMLR</publisher-name>, <year>2021</year>. URL <ext-link ext-link-type="uri" xlink:href="https://proceedings.mlr.press/v130/lueckmann21a.html">https://proceedings.mlr.press/v130/lueckmann21a.html</ext-link>.</mixed-citation></ref>
<ref id="R56"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Carolyn B</given-names> <surname>McNabb</surname></string-name>, <string-name><given-names>Ian D</given-names> <surname>Driver</surname></string-name>, <string-name><given-names>Vanessa</given-names> <surname>Hyde</surname></string-name>, <string-name><given-names>Garin</given-names> <surname>Hughes</surname></string-name>, <string-name><given-names>Hannah L</given-names> <surname>Chandler</surname></string-name>, <string-name><given-names>Hannah</given-names> <surname>Thomas</surname></string-name>, <string-name><given-names>Eirini</given-names> <surname>Messaritaki</surname></string-name>, <string-name><given-names>Carl</given-names> <surname>Hodgetts</surname></string-name>, <string-name><given-names>Craig</given-names> <surname>Hedge</surname></string-name>, <string-name><given-names>Christopher</given-names> <surname>Allen</surname></string-name>, <string-name><given-names>Maria</given-names> <surname>Engel</surname></string-name>, <string-name><given-names>Sophie F</given-names> <surname>Standen</surname></string-name>, <string-name><given-names>Emma</given-names> <surname>Morgan</surname></string-name>, <string-name><given-names>Elena</given-names> <surname>Stylianopoulou</surname></string-name>, <string-name><given-names>Svetla</given-names> <surname>Manolova</surname></string-name>, <string-name><given-names>Lucie</given-names> <surname>Reed</surname></string-name>, <string-name><given-names>Mark</given-names> <surname>Drakesmith</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Germuska</surname></string-name>, <string-name><given-names>Alexander</given-names> <surname>Shaw</surname></string-name>, <string-name><given-names>Lars</given-names> <surname>Mueller</surname></string-name>, <string-name><given-names>Holly</given-names> <surname>Rossiter</surname></string-name>, <string-name><given-names>Chris</given-names> <surname>Jenkins</surname></string-name>, <string-name><given-names>John</given-names> <surname>Evans</surname></string-name>, <string-name><given-names>David</given-names> <surname>Owen</surname></string-name>, <string-name><given-names>Gavin</given-names> <surname>Perry</surname></string-name>, <string-name><given-names>Slawomir</given-names> <surname>Kusmir</surname></string-name>, <string-name><given-names>Emily</given-names> <surname>Lambe</surname></string-name>, <string-name><given-names>Adam</given-names> <surname>Partridge</surname></string-name>, <string-name><given-names>Alison</given-names> <surname>Cooper</surname></string-name>, <string-name><given-names>Peter</given-names> <surname>Hobden</surname></string-name>, <string-name><given-names>Andrew</given-names> <surname>Lawrence</surname></string-name>, <string-name><given-names>Richard</given-names> <surname>Wise</surname></string-name>, <string-name><given-names>James</given-names> <surname>Walters</surname></string-name>, <string-name><given-names>Petroc</given-names> <surname>Sumner</surname></string-name>, <string-name><given-names>Krish</given-names> <surname>Singh</surname></string-name>, and <string-name><given-names>Derek K</given-names> <surname>Jones</surname></string-name></person-group>. <article-title>The welsh advanced neuroimaging database: an open-source state-of-the-art resource for brain research</article-title>. In <source>ISMRM 2024</source>, <year>2024</year>.</mixed-citation></ref>
<ref id="R57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Nicholas</given-names> <surname>Metropolis</surname></string-name>, <string-name><given-names>Arianna W.</given-names> <surname>Rosenbluth</surname></string-name>, <string-name><given-names>Marshall N.</given-names> <surname>Rosenbluth</surname></string-name>, <string-name><given-names>Augusta H.</given-names> <surname>Teller</surname></string-name>, and <string-name><given-names>Edward</given-names> <surname>Teller</surname></string-name></person-group>. <article-title>Equation of state calculations by fast computing machines</article-title>. <source>The Journal of Chemical Physics</source>, <volume>21</volume>(<issue>6</issue>):<fpage>1087</fpage>–<lpage>1092</lpage>, <year>1953</year>. ISSN 0021-9606, 1089-7690. doi: <pub-id pub-id-type="doi">10.1063/1.1699114</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://pubs.aip.org/jcp/article/21/6/1087/202680/Equation-of-State-Calculations-by-Fast-Computing">https://pubs.aip.org/jcp/article/21/6/1087/202680/Equation-of-State-Calculations-by-Fast-Computing</ext-link>.</mixed-citation></ref>
<ref id="R58"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Eloise</given-names> <surname>Mougel</surname></string-name>, <string-name><given-names>Julien</given-names> <surname>Valette</surname></string-name>, and <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name></person-group>. <article-title>Investigating exchange, structural disorder, and restriction in gray matter via water and metabolites diffusivity and kurtosis time-dependence</article-title>. <source>Imaging Neuroscience</source>, <volume>2</volume>:<fpage>1</fpage>–<lpage>14</lpage>, <year>2024</year>.</mixed-citation></ref>
<ref id="R59"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Dmitry S.</given-names> <surname>Novikov</surname></string-name>, <string-name><given-names>Els</given-names> <surname>Fieremans</surname></string-name>, <string-name><given-names>Sune N.</given-names> <surname>Jespersen</surname></string-name>, and <string-name><given-names>Valerij G.</given-names> <surname>Kiselev</surname></string-name></person-group>. <article-title>Quantifying brain microstructure with diffusion MRI: Theory and parameter estimation: Brain microstructure with dMRI: Theory and parameter estimation</article-title>. <source>NMR in Biomedicine</source>, page <elocation-id>e3998</elocation-id>, <year>2018a</year>. ISSN 09523480. doi: <pub-id pub-id-type="doi">10.1002/nbm.3998</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://doi.wiley.com/10.1002/nbm.3998">http://doi.wiley.com/10.1002/nbm.3998</ext-link>.</mixed-citation></ref>
<ref id="R60"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Dmitry S.</given-names> <surname>Novikov</surname></string-name>, <string-name><given-names>Jelle</given-names> <surname>Veraart</surname></string-name>, <string-name><given-names>Ileana O.</given-names> <surname>Jelescu</surname></string-name>, and <string-name><given-names>Els</given-names> <surname>Fieremans</surname></string-name></person-group>. <article-title>Rotationally-invariant mapping of scalar and orientational metrics of neuronal microstructure with diffusion MRI</article-title>. <source>NeuroImage,</source> <volume>174</volume>:<fpage>518</fpage>–<lpage>538</lpage>, <year>2018b</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2018.03.006</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811918301915">https://linkinghub.elsevier.com/retrieve/pii/S1053811918301915</ext-link>.</mixed-citation></ref>
<ref id="R61"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jonas L.</given-names> <surname>Olesen</surname></string-name>, <string-name><given-names>Leif</given-names> <surname>østergaard</surname></string-name>, <string-name><given-names>Noam</given-names> <surname>Shemesh</surname></string-name>, and <string-name><given-names>Sune N.</given-names> <surname>Jespersen</surname></string-name></person-group>. <article-title>Diffusion time dependence, power-law scaling, and exchange in gray matter</article-title>. <source>NeuroImage</source>, <volume>251</volume>:<fpage>118976</fpage>, <year>2022</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2022.118976</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811922001057">https://linkinghub.elsevier.com/retrieve/pii/S1053811922001057</ext-link>.</mixed-citation></ref>
<ref id="R62"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, <string-name><given-names>Andrada</given-names> <surname>Ianus</surname></string-name>, <string-name><given-names>Michele</given-names> <surname>Guerreri</surname></string-name>, <string-name><given-names>Daniel</given-names> <surname>Nunes</surname></string-name>, <string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name>, <string-name><given-names>Noam</given-names> <surname>Shemesh</surname></string-name>, and <string-name><given-names>Hui</given-names> <surname>Zhang</surname></string-name></person-group>. <article-title>SANDI: A compartment-based model for non-invasive apparent soma and neurite imaging by diffusion MRI</article-title>. <source>NeuroImage</source>, <volume>215</volume>:<fpage>116835</fpage>, <year>2020</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2020.116835</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811920303220">https://linkinghub.elsevier.com/retrieve/pii/S1053811920303220</ext-link>.</mixed-citation></ref>
<ref id="R63"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, <string-name><given-names>Vanya</given-names> <surname>Valindria</surname></string-name>, <string-name><given-names>Saurabh</given-names> <surname>Singh</surname></string-name>, <string-name><given-names>Eleni</given-names> <surname>Chiou</surname></string-name>, <string-name><given-names>Francesco</given-names> <surname>Giganti</surname></string-name>, <string-name><given-names>Hayley</given-names> <surname>Pye</surname></string-name>, <string-name><given-names>Hayley C.</given-names> <surname>Whitaker</surname></string-name>, <string-name><given-names>David</given-names> <surname>Atkinson</surname></string-name>, <string-name><given-names>Shonit</given-names> <surname>Punwani</surname></string-name>, <string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name>, and <string-name><given-names>Eleftheria</given-names> <surname>Panagiotaki</surname></string-name></person-group>. <article-title>Joint estimation of relaxation and diffusion tissue parameters for prostate cancer with relaxation-VERDICT MRI</article-title>. <source>Scientific Reports</source>, <volume>13</volume>(<issue>1</issue>):<fpage>2999</fpage>, <year>2023</year>. ISSN 2045-2322. doi: <pub-id pub-id-type="doi">10.1038/s41598-023-30182-1</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://www.nature.com/articles/s41598-023-30182-1">https://www.nature.com/articles/s41598-023-30182-1</ext-link>.</mixed-citation></ref>
<ref id="R64"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Eleftheria</given-names> <surname>Panagiotaki</surname></string-name>, <string-name><given-names>Torben</given-names> <surname>Schneider</surname></string-name>, <string-name><given-names>Bernard</given-names> <surname>Siow</surname></string-name>, <string-name><given-names>Matt G.</given-names> <surname>Hall</surname></string-name>, <string-name><given-names>Mark F.</given-names> <surname>Lythgoe</surname></string-name>, and <string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name></person-group>. <article-title>Compartment models of the diffusion MR signal in brain white matter: A taxonomy and comparison</article-title>. <source>NeuroImage</source>, <volume>59</volume>(<issue>3</issue>):<fpage>2241</fpage>–<lpage>2254</lpage>, <year>2012</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2011.09.081</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811911011566">https://linkinghub.elsevier.com/retrieve/pii/S1053811911011566</ext-link>.</mixed-citation></ref>
<ref id="R65"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Eletheria</given-names> <surname>Panagiotaki</surname></string-name>, <string-name><given-names>Simon</given-names> <surname>Walker-Samuel</surname></string-name>, <string-name><given-names>Bernard</given-names> <surname>Siow</surname></string-name>, <string-name><given-names>S. Peter</given-names> <surname>Johnson</surname></string-name>, <string-name><given-names>Vineeth</given-names> <surname>Rajkumar</surname></string-name>, <string-name><given-names>R. Barbara</given-names> <surname>Pedley</surname></string-name>, <string-name><given-names>Mark F.</given-names> <surname>Lythgoe</surname></string-name>, and <string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name></person-group>. <article-title>Noninvasive quantification of solid tumor microstructure using VERDICT MRI</article-title>. <source>Cancer Research</source>, <volume>74</volume>(<issue>7</issue>):<fpage>1902</fpage>–<lpage>1912</lpage>, <year>2014</year>. ISSN 0008-5472, 1538-7445. doi: <pub-id pub-id-type="doi">10.1158/0008-5472.CAN-13-2511</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://aacrjournals.org/cancerres/article/74/7/1902/599821/Noninvasive-Quantification-of-Solid-Tumor">https://aacrjournals.org/cancerres/article/74/7/1902/599821/Noninvasive-Quantification-of-Solid-Tumor</ext-link>.</mixed-citation></ref>
<ref id="R66"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>George</given-names> <surname>Papamakarios</surname></string-name> and <string-name><given-names>Iain</given-names> <surname>Murray</surname></string-name></person-group>. <article-title>Fast £-free inference of simulation models with bayesian conditional density estimation</article-title>. <source>Advances in neural information processing systems</source>, <volume>29</volume>, <year>2016</year>.</mixed-citation></ref>
<ref id="R67"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>George</given-names> <surname>Papamakarios</surname></string-name>, <string-name><given-names>Theo</given-names> <surname>Pavlakou</surname></string-name>, and <string-name><given-names>Iain</given-names> <surname>Murray</surname></string-name></person-group>. <article-title>Masked autoregressive flow for density estimation</article-title>. <source>Advances in neural information processing systems</source>, <volume>30</volume>, <year>2017</year>.</mixed-citation></ref>
<ref id="R68"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><given-names>George</given-names> <surname>Papamakarios</surname></string-name>, <string-name><given-names>David</given-names> <surname>Sterratt</surname></string-name>, and <string-name><given-names>Iain</given-names> <surname>Murray</surname></string-name></person-group>. <chapter-title>Sequential neural likelihood: Fast likelihood-free inference with autoregressive flows</chapter-title>. In <source>The 22nd international conference on artificial intel ligence and statistics</source>, pages <fpage>837</fpage>–<lpage>848</lpage>. <publisher-name>PMLR</publisher-name>, <year>2019</year>.</mixed-citation></ref>
<ref id="R69"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>George</given-names> <surname>Papamakarios</surname></string-name>, <string-name><given-names>Eric</given-names> <surname>Nalisnick</surname></string-name>, <string-name><given-names>Danilo Jimenez</given-names> <surname>Rezende</surname></string-name>, <string-name><given-names>Shakir</given-names> <surname>Mohamed</surname></string-name>, and <string-name><given-names>Balaji</given-names> <surname>Lakshminarayanan</surname></string-name></person-group>. <article-title>Normalizing flows for probabilistic modeling and inference</article-title>. <source>The Journal of Machine Learning Research</source>, <volume>22</volume>(<issue>1</issue>):<fpage>2617</fpage>–<lpage>2680</lpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="R70"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><given-names>Geoff J. M.</given-names> <surname>Parker</surname></string-name> and <string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name></person-group>. <article-title>Probabilistic monte carlo based mapping of cerebral connections utilising whole-brain crossing fibre information</article-title>. In <person-group person-group-type="editor"><string-name><given-names>Chris</given-names> <surname>Taylor</surname></string-name> and <string-name><given-names>J. Alison</given-names> <surname>Noble</surname></string-name></person-group>, editors, <source>Information Processing in Medical Imaging</source>, volume <volume>2732</volume>, pages <fpage>684</fpage>–<lpage>695</lpage>. <publisher-name>Springer Berlin Heidelberg</publisher-name>, <year>2003</year>. ISBN <isbn>978-3-540-40560-3</isbn> <isbn>978-3-540-45087-0</isbn>. doi: <pub-id pub-id-type="doi">10.1007/978-3-540-45087-0_57</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://link.springer.com/10.1007/978-3-540-45087-0_57">http://link.springer.com/10.1007/978-3-540-45087-0_57</ext-link>.</mixed-citation></ref>
<ref id="R71"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jose Pedro Manzano</given-names> <surname>Patron</surname></string-name>, <string-name><given-names>Theodore</given-names> <surname>Kypraios</surname></string-name>, and <string-name><given-names>Stamatios N</given-names> <surname>Sotiropoulos</surname></string-name></person-group>. <article-title>Amortised inference in diffusion mri biophysical models using artificial neural networks and simulation-based frameworks</article-title>. In <source>ISMRM 2022</source>, <year>2022</year>.</mixed-citation></ref>
<ref id="R72"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Gareth O.</given-names> <surname>Roberts</surname></string-name> and <string-name><given-names>Jeffrey S.</given-names> <surname>Rosenthal</surname></string-name></person-group>. <article-title>Examples of adaptive MCMC</article-title>. <source>Journal of Computational and Graphical Statistics,</source> <volume>18</volume>(<issue>2</issue>):<fpage>349</fpage>–<lpage>367</lpage>, <year>2009</year>. ISSN 1061-8600, 1537-2715. doi: <pub-id pub-id-type="doi">10.1198/jcgs.2009.06134</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://www.tandfonline.com/doi/abs/10.1198/jcgs.2009.06134">http://www.tandfonline.com/doi/abs/10.1198/jcgs.2009.06134</ext-link>.</mixed-citation></ref>
<ref id="R73"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Viljami</given-names> <surname>Sairanen</surname></string-name>, <string-name><given-names>Alexander</given-names> <surname>Leemans</surname></string-name>, and <collab>Chantal MW Tax</collab></person-group>. <article-title>Fast and accurate slicewise outlier detection (solid) with informed model estimation for diffusion mri data</article-title>. <source>NeuroImage,</source> <volume>181</volume>:<fpage>331346</fpage>, <year>2018</year>.</mixed-citation></ref>
<ref id="R74"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>K.</given-names> <surname>Setsompop</surname></string-name>, <string-name><given-names>R.</given-names> <surname>Kimmlingen</surname></string-name>, <string-name><given-names>E.</given-names> <surname>Eberlein</surname></string-name>, <string-name><given-names>T.</given-names> <surname>Witzel</surname></string-name>, <string-name><given-names>J.</given-names> <surname>Cohen-Adad</surname></string-name>, <string-name><given-names>J.A.</given-names> <surname>McNab</surname></string-name>, <string-name><given-names>B.</given-names> <surname>Keil</surname></string-name>, <string-name><given-names>M.D.</given-names> <surname>Tisdall</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Hoecht</surname></string-name>, <string-name><given-names>P.</given-names> <surname>Dietz</surname></string-name>, <string-name><given-names>S.F.</given-names> <surname>Cauley</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Tountcheva</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Matschl</surname></string-name>, <string-name><given-names>V.H.</given-names> <surname>Lenz</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Heberlein</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Potthast</surname></string-name>, <string-name><given-names>H.</given-names> <surname>Thein</surname></string-name>, <string-name><given-names>J. Van</given-names> <surname>Horn</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Toga</surname></string-name>, <string-name><given-names>F.</given-names> <surname>Schmitt</surname></string-name>, <string-name><given-names>D.</given-names> <surname>Lehne</surname></string-name>, <string-name><given-names>B.R.</given-names> <surname>Rosen</surname></string-name>, <string-name><given-names>V.</given-names> <surname>Wedeen</surname></string-name>, and <string-name><given-names>L.L.</given-names> <surname>Wald</surname></string-name></person-group>. <article-title>Pushing the limits of in vivo diffusion MRI for the human connectome pro ject</article-title>. <source>NeuroImage</source>, <volume>80</volume>:<fpage>220</fpage>–<lpage>233</lpage>, <year>2013</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2013.05.078</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811913005788">https://linkinghub.elsevier.com/retrieve/pii/S1053811913005788</ext-link>.</mixed-citation></ref>
<ref id="R75"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Paddy J.</given-names> <surname>Slator</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, <string-name><given-names>Karla L.</given-names> <surname>Miller</surname></string-name>, <string-name><given-names>Carl-Fredrik</given-names> <surname>Westin</surname></string-name>, <string-name><given-names>Frederik</given-names> <surname>Laun</surname></string-name>, <string-name><given-names>Daeun</given-names> <surname>Kim</surname></string-name>, <string-name><given-names>Justin P.</given-names> <surname>Haldar</surname></string-name>, <string-name><given-names>Dan</given-names> <surname>Benjamini</surname></string-name>, <string-name><given-names>Gregory</given-names> <surname>Lemberskiy</surname></string-name>, <string-name><given-names>Joao P. de Almeida</given-names> <surname>Martins</surname></string-name>, and <string-name><given-names>Jana</given-names> <surname>Hutter</surname></string-name></person-group>. <article-title>Combined diffusion-relaxometry microstructure imaging: Current status and future prospects</article-title>. <source>Magnetic Resonance in Medicine</source>, <volume>86</volume>(<issue>6</issue>):<fpage>2987</fpage>–<lpage>3011</lpage>, <year>2021</year>. doi: <pub-id pub-id-type="doi">10.1002/mrm.28963</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/abs/10.1002/mrm.28963">https://onlinelibrary.wiley.com/doi/abs/10.1002/mrm.28963</ext-link>.</mixed-citation></ref>
<ref id="R76"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Stephen M.</given-names> <surname>Smith</surname></string-name></person-group>. <article-title>Fast robust automated brain extraction</article-title>. <source>Human Brain Mapping</source>, <volume>17</volume>(<issue>3</issue>):<fpage>143</fpage>–<lpage>155</lpage>, <year>2002</year>. doi: <pub-id pub-id-type="doi">10.1002/hbm.10062</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/abs/10.1002/hbm.10062">https://onlinelibrary.wiley.com/doi/abs/10.1002/hbm.10062</ext-link>.</mixed-citation></ref>
<ref id="R77"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Stephen M</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>Mark</given-names> <surname>Jenkinson</surname></string-name>, <string-name><given-names>Mark W</given-names> <surname>Woolrich</surname></string-name>, <string-name><given-names>Christian F</given-names> <surname>Beckmann</surname></string-name>, <string-name><given-names>Timothy EJ</given-names> <surname>Behrens</surname></string-name>, <string-name><given-names>Heidi</given-names> <surname>Johansen-Berg</surname></string-name>, <string-name><given-names>Peter R</given-names> <surname>Bannister</surname></string-name>, <string-name><given-names>Marilena De</given-names> <surname>Luca</surname></string-name>, <string-name><given-names>Ivana</given-names> <surname>Drobnjak</surname></string-name>, <string-name><given-names>David E</given-names> <surname>Flitney</surname></string-name>, <etal>et al</etal></person-group>. <article-title>Advances in functional and structural mr image analysis and implementation as fsl</article-title>. <source>NeuroImage</source>, <volume>23</volume>:<fpage>S208</fpage>–<lpage>S219</lpage>, <year>2004</year>.</mixed-citation></ref>
<ref id="R78"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>S. N.</given-names> <surname>Sotiropoulos</surname></string-name>, <string-name><given-names>S.</given-names> <surname>Jbabdi</surname></string-name>, <string-name><given-names>J. L.</given-names> <surname>Andersson</surname></string-name>, <string-name><given-names>M. W.</given-names> <surname>Woolrich</surname></string-name>, <string-name><given-names>K.</given-names> <surname>Ugurbil</surname></string-name>, and <string-name><given-names>T. E. J.</given-names> <surname>Behrens</surname></string-name></person-group>. <article-title>RubiX: Combining spatial resolutions for bayesian inference of crossing fibers in diffusion MRI</article-title>. <source>IEEE Transactions on Medical Imaging</source>, <volume>32</volume>(<issue>6</issue>):<fpage>969</fpage>–<lpage>982</lpage>, <year>2013</year>. ISSN 0278-0062, 1558-254X. doi: <pub-id pub-id-type="doi">10.1109/TMI.2012.2231873</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://ieeexplore.ieee.org/document/6420959/">http://ieeexplore.ieee.org/document/6420959/</ext-link>.</mixed-citation></ref>
<ref id="R79"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><given-names>Alvaro</given-names> <surname>Tejero-Cantero</surname></string-name>, <string-name><given-names>Jan</given-names> <surname>Boelts</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Deistler</surname></string-name>, <string-name><given-names>Jan-Matthis</given-names> <surname>Lueckmann</surname></string-name>, <string-name><given-names>Conor</given-names> <surname>Durkan</surname></string-name>, <string-name><given-names>Pedro J.</given-names> <surname>Goncalves</surname></string-name>, <string-name><given-names>David S.</given-names> <surname>Greenberg</surname></string-name>, and <string-name><given-names>Jakob H.</given-names> <surname>Macke</surname></string-name></person-group>. <article-title>SBI - a toolkit for simulationbased inference</article-title>, <source>arXiv</source> <year>2020</year>. URL <ext-link ext-link-type="uri" xlink:href="http://arxiv.org/abs/2007.09114">http://arxiv.org/abs/2007.09114</ext-link>.</mixed-citation></ref>
<ref id="R80"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>J-Donald</given-names> <surname>Tournier</surname></string-name>, <string-name><given-names>Robert</given-names> <surname>Smith</surname></string-name>, <string-name><given-names>David</given-names> <surname>Raffelt</surname></string-name>, <string-name><given-names>Rami</given-names> <surname>Tabbara</surname></string-name>, <string-name><given-names>Thijs</given-names> <surname>Dhollander</surname></string-name>, <string-name><given-names>Maximilian</given-names> <surname>Pietsch</surname></string-name>, <string-name><given-names>Daan</given-names> <surname>Christiaens</surname></string-name>, <string-name><given-names>Ben</given-names> <surname>Jeurissen</surname></string-name>, <string-name><given-names>Chun-Hung</given-names> <surname>Yeh</surname></string-name>, and <string-name><given-names>Alan</given-names> <surname>Connelly</surname></string-name></person-group>. <article-title>Mrtrix3: A fast, flexible and open software framework for medical image processing and visualisation</article-title>. <source>NeuroImage</source>, <volume>202</volume>:<fpage>116137</fpage>, <year>2019</year>.</mixed-citation></ref>
<ref id="R81"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Quentin</given-names> <surname>Uhl</surname></string-name>, <string-name><given-names>Tommaso</given-names> <surname>Pavan</surname></string-name>, <string-name><given-names>Malwina</given-names> <surname>Molendowska</surname></string-name>, <string-name><given-names>Derek K</given-names> <surname>Jones</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, and <string-name><given-names>Ileana</given-names> <surname>Jelescu</surname></string-name></person-group>. <article-title>Quantifying human gray matter microstructure using neurite exchange imaging (nexi) and 300 mt/m gradients</article-title>. <source>Imaging Neuroscience</source>, <year>2024</year>.</mixed-citation></ref>
<ref id="R82"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Laurens Van der</given-names> <surname>Maaten</surname></string-name> and <string-name><given-names>Geoffrey</given-names> <surname>Hinton</surname></string-name></person-group>. <article-title>Visualizing data using t-SNE</article-title>. <source>Journal of machine learning research</source>, <volume>9</volume>(<issue>11</issue>), <year>2008</year>.</mixed-citation></ref>
<ref id="R83"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Jelle</given-names> <surname>Veraart</surname></string-name>, <string-name><given-names>Dmitry S.</given-names> <surname>Novikov</surname></string-name>, <string-name><given-names>Daan</given-names> <surname>Christiaens</surname></string-name>, <string-name><given-names>Benjamin</given-names> <surname>Ades-aron</surname></string-name>, <string-name><given-names>Jan</given-names> <surname>Sijbers</surname></string-name>, and <string-name><given-names>Els</given-names> <surname>Fieremans</surname></string-name></person-group>. <article-title>Denoising of diffusion MRI using random matrix theory</article-title>. <source>NeuroImage</source>, <volume>142</volume>:<fpage>394</fpage>–<lpage>406</lpage>, <year>2016</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2016.08.016</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811916303949">https://linkinghub.elsevier.com/retrieve/pii/S1053811916303949</ext-link>.</mixed-citation></ref>
<ref id="R84"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Melissa</given-names> <surname>Vincent</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, and <string-name><given-names>Julien</given-names> <surname>Valette</surname></string-name></person-group>. <article-title>Revisiting double diffusion encoding MRS in the mouse brain at 11.7t: Which microstructural features are we sensitive to?</article-title> <source>NeuroImage</source>, <volume>207</volume>:<fpage>116399</fpage>, <year>2020</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2019.116399</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811919309905">https://linkinghub.elsevier.com/retrieve/pii/S1053811919309905</ext-link>.</mixed-citation></ref>
<ref id="R85"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Sjoerd B.</given-names> <surname>Vos</surname></string-name>, <string-name><given-names>Chantal M. W.</given-names> <surname>Tax</surname></string-name>, <string-name><given-names>Peter R.</given-names> <surname>Luijten</surname></string-name>, <string-name><given-names>Sebastien</given-names> <surname>Ourselin</surname></string-name>, <string-name><given-names>Alexander</given-names> <surname>Leemans</surname></string-name>, and <string-name><given-names>Martijn</given-names> <surname>Froeling</surname></string-name></person-group>. <article-title>The importance of correcting for signal drift in diffusion MRI</article-title>. <source>Magnetic Resonance in Medicine</source>, <volume>77</volume>(<issue>1</issue>):<fpage>285</fpage>–<lpage>299</lpage>, <year>2017</year>. ISSN 0740-3194, 1522-2594. doi: <pub-id pub-id-type="doi">10.1002/mrm.26124</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/10.1002/mrm.26124">https://onlinelibrary.wiley.com/doi/10.1002/mrm.26124</ext-link>.</mixed-citation></ref>
<ref id="R86"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>William</given-names> <surname>Warner</surname></string-name>, <string-name><given-names>Marco</given-names> <surname>Palombo</surname></string-name>, <string-name><given-names>Renata</given-names> <surname>Cruz</surname></string-name>, <string-name><given-names>Ross</given-names> <surname>Callaghan</surname></string-name>, <string-name><given-names>Noam</given-names> <surname>Shemesh</surname></string-name>, <string-name><given-names>Derek K.</given-names> <surname>Jones</surname></string-name>, <string-name><given-names>Flavio</given-names> <surname>Dell’Acqua</surname></string-name>, <string-name><given-names>Andrada</given-names> <surname>Ianus</surname></string-name>, and <string-name><given-names>Ivana</given-names> <surname>Drobnjak</surname></string-name></person-group>. <article-title>Temporal diffusion ratio (TDR) for imaging restricted diffusion: Optimisation and pre-clinical demonstration</article-title>. <source>NeuroImage</source>, <volume>269</volume>:<fpage>119930</fpage>, <year>2023</year>. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2023.119930</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811923000782">https://linkinghub.elsevier.com/retrieve/pii/S1053811923000782</ext-link>.</mixed-citation></ref>
<ref id="R87"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Brandon</given-names> <surname>Whitcher</surname></string-name>, <string-name><given-names>David S.</given-names> <surname>Tuch</surname></string-name>, <string-name><given-names>Jonathan J.</given-names> <surname>Wisco</surname></string-name>, <string-name><given-names>A. Gregory</given-names> <surname>Sorensen</surname></string-name>, and <string-name><given-names>Liqun</given-names> <surname>Wang</surname></string-name></person-group>. <article-title>Using the wild bootstrap to quantify uncertainty in diffusion tensor imaging</article-title>. <source>Human Brain Mapping,</source> <volume>29</volume>(<issue>3</issue>):<fpage>346</fpage>–<lpage>362</lpage>, <year>2008</year>. ISSN 10659471, 10970193. doi: <pub-id pub-id-type="doi">10.1002/hbm.20395</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://onlinelibrary.wiley.com/doi/10.1002/hbm.20395">https://onlinelibrary.wiley.com/doi/10.1002/hbm.20395</ext-link>.</mixed-citation></ref>
<ref id="R88"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Dmitriy A.</given-names> <surname>Yablonskiy</surname></string-name> and <string-name><given-names>Alexander L.</given-names> <surname>Sukstanskii</surname></string-name></person-group>. <article-title>Theoretical models of the diffusion weighted MR signal</article-title>. <source>NMR in Biomedicine,</source> <volume>23</volume>(<issue>7</issue>):<fpage>661</fpage>–<lpage>681</lpage>, <year>2010</year>. ISSN 09523480. doi: <pub-id pub-id-type="doi">10.1002/nbm.1520</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="http://doi.wiley.com/10.1002/nbm.1520">http://doi.wiley.com/10.1002/nbm.1520</ext-link>.</mixed-citation></ref>
<ref id="R89"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><given-names>Hui</given-names> <surname>Zhang</surname></string-name>, <string-name><given-names>Torben</given-names> <surname>Schneider</surname></string-name>, <string-name><given-names>Claudia A.</given-names> <surname>Wheeler-Kingshott</surname></string-name>, and <string-name><given-names>Daniel C.</given-names> <surname>Alexander</surname></string-name></person-group>. <article-title>NODDI: Practical in vivo neurite orientation dispersion and density imaging of the human brain</article-title>. <source>NeuroImage,</source> <volume>61</volume>(<issue>4</issue>):<fpage>1000</fpage>–<lpage>1016</lpage>, <year>2012</year>–07. ISSN 10538119. doi: <pub-id pub-id-type="doi">10.1016/j.neuroimage.2012.03.072</pub-id>. URL <ext-link ext-link-type="uri" xlink:href="https://linkinghub.elsevier.com/retrieve/pii/S1053811912003539">https://linkinghub.elsevier.com/retrieve/pii/S1053811912003539</ext-link>.</mixed-citation></ref>
</ref-list>
<app-group>
<app id="app1">
<title>Appendix</title>
<sec id="s5">
<title>A Correlation analysis between features extracted by μGUIDE and manually-defined summary statistics</title>
<p><xref ref-type="fig" rid="fig9">Fig. 9</xref> presents the correlation matrices obtained from the correlation between the MLP-extracted features from μGUIDE and the manually-defined summary statistics defined in Section 4.3, considering noisy simulations (SNR=50). For each model, at least one feature extracted by μGUIDE is not or weakly correlated with the summary statistics. Additional information, not contained in the summary statistics, is extracted by the MLP from the input signal, leading to reduced bias, uncertainty and ambiguity in the parameter estimates (see <xref ref-type="fig" rid="fig4">Fig. 4</xref>).</p>
<fig id="fig9" position="float" fig-type="figure">
<label>Figure 9:</label>
<caption><title>Correlation matrices between features extracted by the MLP in μGUIDE and manually-defined summary features for the three models.</title></caption>
<graphic xlink:href="2312.17293v3_fig9.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s6">
<title>B Masked Autoregressive Flows</title>
<p>The conditional probability density function approximators used in this project belong to a class of neural networks called Normalizing Flows (NF) Papamakarios et al. [2021]. NFs provide a general way of transforming complex probability distributions over continuous random variables into simple base distributions <italic>p(<bold>z</bold>)</italic> (such as normal distributions) through a chain of invertible and differentiable transformations f. By applying the change of variable formula, the target distribution <italic>q<sub>ϕ</sub></italic> (<italic><bold>θ</bold>|<bold>x</bold></italic>) can be written as:
<disp-formula id="FD11">
<alternatives>
<mml:math id="M11" display="block"><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:mi>det</mml:mi><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>ϕ</mml:mi></mml:msub></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>;</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>,</mml:mo></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:math>
<graphic xlink:href="2312.17293v3_eqn11.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
<label>(9)</label>
</disp-formula>
</p>
<p>where <bold>z</bold> = <italic>f<sub>ϕ</sub>(<bold>θ</bold>; <bold>x</bold>)</italic> is invertible and differentiable (i.e. a diffeomorphism), and <italic>J<sub>f</sub><sub>ϕ</sub> (<bold>θ</bold>; <bold>x</bold>)</italic> is the Jacobian of <italic>f<sub>ϕ</sub>(<bold>θ</bold>; <bold>x</bold>)</italic>. The forward direction allows for density evaluation, that is learning the mapping between the target and the base distributions, i.e. learning the parameters <italic>ϕ</italic>. The inverse direction allows to estimate a density estimator <italic>q<sub>ϕ</sub> (<bold>θ</bold> | <bold>x</bold><sub>0</sub>)</italic> by sampling points <bold>z</bold> from the base distribution and applying the inverse transform <inline-formula id="ID13">
<alternatives>
<mml:math display="inline" id="I13"><mml:msubsup><mml:mi>f</mml:mi><mml:mi>ϕ</mml:mi><mml:mrow><mml:mo>−</mml:mo><mml:mn>1</mml:mn></mml:mrow></mml:msubsup><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>z</mml:mi><mml:mo>;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mn>0</mml:mn></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq14.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula>.</p>
<p>A main requirement is that the flow needs to be expressive enough to approximate any arbitrarily highly complex distribution. An interesting property of diffeomorphisms is that they are closed under composition, which means that a composition of K diffeomorphisms <italic>f</italic> = <italic>f</italic><sub>1</sub> ◦ <italic>f</italic><sub>2</sub> ◦ … ◦ <italic>f</italic><sub>K</sub> is also a diffeomorphism, and the Jacobian determinant is the product of the determinant of each component. Combining multiple transformations allows to increase the expressivity of the general flow. We obtain:
<disp-formula id="FD12">
<alternatives>
<mml:math id="M12" display="block"><mml:mtable columnalign="left"><mml:mtr><mml:mtd><mml:msub><mml:mi>q</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mi>log</mml:mi><mml:mrow><mml:mo>|</mml:mo> <mml:mrow><mml:mi>det</mml:mi><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∏</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow></mml:mstyle></mml:mrow> <mml:mo>|</mml:mo></mml:mrow></mml:mtd></mml:mtr><mml:mtr><mml:mtd><mml:mo>=</mml:mo><mml:mi>p</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>f</mml:mi><mml:mi>ϕ</mml:mi></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:mi>θ</mml:mi><mml:mo>|</mml:mo><mml:mi>x</mml:mi></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mrow><mml:mo>)</mml:mo></mml:mrow><mml:mstyle displaystyle="true"><mml:msubsup><mml:mo>∑</mml:mo><mml:mrow><mml:mi>k</mml:mi><mml:mo>=</mml:mo><mml:mn>1</mml:mn></mml:mrow><mml:mi>K</mml:mi></mml:msubsup><mml:mrow><mml:mi>log</mml:mi><mml:mo>|</mml:mo><mml:mi>det</mml:mi></mml:mrow></mml:mstyle><mml:mtext> </mml:mtext><mml:msub><mml:mi>J</mml:mi><mml:mrow><mml:mi>f</mml:mi><mml:mi>k</mml:mi></mml:mrow></mml:msub><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>θ</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>x</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:mtd></mml:mtr></mml:mtable></mml:math>
<graphic xlink:href="2312.17293v3_eqn12.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
<label>(10)</label>
</disp-formula>
</p>
<p>Flows need to be flexible and expressive enough to model any desired distribution but also need to be computationally efficient, that is, computing the associated Jacobian determinants need to be tractable and efficient. Among a number of proposed architectures such as mixture density networks [<xref ref-type="bibr" rid="R9">Bishop, 1994</xref>] or neural spline flows [<xref ref-type="bibr" rid="R21">Durkan et al., 2019</xref>], we focused on Masked Autoregressive Flows (MAF) [<xref ref-type="bibr" rid="R67">Papamakarios et al., 2017</xref>], which has shown state-of-the-art performance as well as the ability to estimate multi-modal posterior distributions [Goncalves et al., 2020, <xref ref-type="bibr" rid="R71">Patron et al., 2022</xref>, <xref ref-type="bibr" rid="R69">Papamakarios et al., 2021</xref>].</p>
<p>Autoregressive flows are universal approximators and have the form <inline-formula id="ID14">
<alternatives>
<mml:math display="inline" id="I14"><mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>i</mml:mi></mml:msub><mml:mo>=</mml:mo><mml:mi>τ</mml:mi><mml:mrow><mml:mo>(</mml:mo><mml:mrow><mml:msub><mml:mi>z</mml:mi><mml:mi>i</mml:mi></mml:msub><mml:mo>;</mml:mo><mml:msub><mml:mi>h</mml:mi><mml:mi>i</mml:mi></mml:msub></mml:mrow><mml:mo>)</mml:mo></mml:mrow></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq15.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula> where <italic><bold>h<sub>i</sub></bold></italic> = <italic>c<sub>i</sub></italic>(<italic><bold>z&lt;i</bold></italic>) [<xref ref-type="bibr" rid="R69">Papamakarios et al., 2021</xref>]. <italic>τ</italic> is termed the <italic>transformer</italic> and is a stritly monotonic function parametrized by <italic><bold>h</bold><sub>i</sub></italic>, and <italic>c<sub>i</sub></italic> the <italic>i</italic>-th <italic>conditioner</italic>. Each <italic><bold>h</bold><sub>i</sub></italic> and therefore each <inline-formula id="ID15">
<alternatives>
<mml:math display="inline" id="I15"><mml:msub><mml:msup><mml:mi>z</mml:mi><mml:mo>′</mml:mo></mml:msup><mml:mi>i</mml:mi></mml:msub></mml:math>
<inline-graphic xlink:href="2312.17293v3_ieq16.tif" mime-subtype="tiff" mimetype="image"/></alternatives>
</inline-formula> can be computed independently in parallel, helping to keep a low computation time. The conditioner constraints each output to depend only on variables with dimension indices less than <italic>i</italic>, which makes the Jacobian of the flow lower diagonal. Its determinant can then be obtained easily as the product of its diagonal elements.</p>
<p>To efficiently implement the conditioner, this method relies on the Masked Autoencoder for Distribution Estimation (MADE) [<xref ref-type="bibr" rid="R24">Germain et al., 2015</xref>] architecture. To create a neural network that obey the autoregressive structure of the conditioner, a fully connected feedforward neural network is multiplied to binary masks, which removes some connections by assigning them a weigh of 0. The binary masks can easily be obtained by following a few simple steps (see <xref ref-type="fig" rid="fig10">Fig. 10</xref> for an illustration):
<list list-type="order" id="L2">
<list-item><p>Label the input and output nodes between 1 and <italic>D, D</italic> being the dimension of the input vector <italic><bold>z</bold></italic>.</p></list-item>
<list-item><p>Randomly assign each hidden unit a number between 1 and <italic>D</italic> — 1, which indicates the number of inputs it will be connected to.</p></list-item>
<list-item><p>For each hidden layer, connect the hidden units to units with inferior or equal labels.</p></list-item>
<list-item><p>Connect output units to units with strictly inferior labels.</p></list-item>
</list>
</p>
<fig id="fig10" position="float" fig-type="figure">
<label>Figure 10:</label>
<caption><title>Schematic of MADE autoregressive network construction.</title></caption>
<graphic xlink:href="2312.17293v3_fig10.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>For μGUIDE’s implementation, we use a combination of 5 MADEs.</p>
<p>As a result, the MAF architecture only needs a single forward pass through the flow and, combined with the low-cost computation of the determinant, allows for fast training and evaluation of the posterior distributions.</p>
</sec>
<sec id="s7">
<title>C Posterior Predictive Checks</title>
<p>Posterior Predictive Checks (PPC) are a common safety check to verify inference is not wrong. The idea is to compare input signals with generated signals from samples drawn from the posterior distributions. If the inference is correct, the generated signals should look similar to the input signal.</p>
<p>We performed the following steps:
<list list-type="bullet" id="L3">
<list-item><p>Sample N <italic><bold>θ<sub>i</sub></bold></italic> from the prior distribution: <italic><bold>θ<sub>i</sub></bold> ~ p(<bold>θ</bold>)</italic></p></list-item>
<list-item><p>Generate the corresponding signals using the forward model: <italic><bold>x<sub>i</sub></bold></italic> = <italic>M(<bold>θ</bold><sub>i</sub>)</italic></p></list-item>
<list-item><p>Perform the inference and estimate the posterior distributions <italic>p(<bold>θ<sub>i</sub></bold> |<bold>x<sub>i</sub></bold>)</italic></p></list-item>
<list-item><p>Sample <italic>N<sub>PP</sub></italic> samples <italic><bold>θ<sub>i,s</sub></bold></italic> from <italic>p(<bold>θ<sub>i</sub>|x<sub>i</sub></bold>)</italic></p></list-item>
<list-item><p>Reconstruct the signals from the sampled <italic><bold>θ<sub>i,s</sub></bold></italic> using the forward model: <italic><bold>x<sub>i,s</sub></bold></italic> = <italic>M(<bold>θ<sub>i,s</sub></bold>)</italic></p></list-item>
<list-item><p>Compare the obtained <italic><bold>x<sub>i,s</sub></bold></italic> with <italic><bold>x<sub>i</sub></bold></italic>.</p></list-item>
</list>
</p>
<p><xref ref-type="fig" rid="fig11">Fig. 11</xref> presents results on model 2 (SM), on both noise-free and noisy signals (Rician noise with SNR=50) for <italic>N</italic> =10 random combinations of model parameters, and <italic>N<sub>pp</sub></italic> = 100. As dMRI data have a high dimensionality, we report the direction-average signal. Plain lines show the signals <italic><bold>x<sub>i</sub></bold></italic>, and the shaded areas correspond to the area in which the corresponding <italic><bold>x<sub>i,s</sub></bold></italic> fall. <bold>x<sub>i</sub></bold> lie within the support of <italic><bold>x<sub>i,s</sub></bold></italic>, indicating the inference is not wrong. Note that the support of <italic><bold>x<sub>i,s</sub></bold></italic> is bigger for noisy simulations, reflecting the wider posterior distributions obtained from the inference.</p>
<fig id="fig11" position="float" fig-type="figure">
<label>Figure 11:</label>
<caption><title>Posterior Predictive Checks.</title>
<p>Comparison between signals <italic><bold>x<sub>i</sub></bold></italic> generated using random parameter combinations and their reconstructions using samples from <italic>p(<bold>θ<sub>i</sub>|x<sub>i</sub></bold>)</italic>.</p></caption>
<graphic xlink:href="2312.17293v3_fig11.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
</app>
</app-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.101069.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Sui</surname>
<given-names>Jing</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Beijing Normal University</institution>
</institution-wrap>
<city>Beijing</city>
<country>China</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>The authors proposed a novel deep learning framework to estimate posterior distributions of tissue microstructure parameters. This provides a <bold>valuable</bold> methodology with practical implications for automatically estimating parameter distributions from different biophysical models. The experiments show <bold>solid</bold> evidence for generalizing the method to use data from different protocol acquisitions and work with models of varying complexity.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.101069.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The authors proposed a framework to estimate the posterior distribution of parameters in biophysical models. The framework has two modules: the first MLP module is used to reduce data dimensionality and the second NPE module is used to approximate the desired posterior distribution. The results show that the MLP module can capture additional information compared to manually defined summary statistics. By using the NPE module, the repetitive evaluation of the forward model is avoided, thus making the framework computationally efficient. The results show the framework has promise in identifying degeneracy. This is an interesting work.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.101069.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
The authors improve the work of Jallais et al. (2022) by including a novel module capable of automatically learning feature selection from different acquisition protocols inside a supervised learning framework. Combining the module above with an estimation framework for estimating the posterior distribution of model parameters, they obtain rich probabilistic information (uncertainty and degeneracy) on the parameters in a reasonable computation time.</p>
<p>The main contributions of the work are:</p>
<p>
(1) The whole framework allows the user to avoid manually defining summary statistics, which may be slow and tedious and affect the quality of the results.</p>
<p>
(2) The authors tested the proposal by tackling three different biophysical models for brain tissue and using data with characteristics commonly used by the diffusion-MR-microstructure research community.</p>
<p>
(3) The authors validated their method well with the state-of-the-art.</p>
<p>The main weakness is:</p>
<p>
(1) The methodology was tested only on scenarios with a signal-to-noise ratio (SNR) equal to 50. It is interesting to show results with lower SNR and without noise that the method can detect the model's inherent degenerations and how the degeneration increases when strong noise is present. I suggest expanding the Figure in Appendix 1 to include this information.</p>
<p>The authors showed the utility of their proposal by computing complex parameter descriptors automatically in an achievable time for three different and relevant biophysical models.</p>
<p>Importantly, this proposal promotes tackling, analyzing, and considering the degenerated nature of the most used models in brain microstructure estimation.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.101069.1.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Jallais</surname>
<given-names>Maëliss</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Palombo</surname>
<given-names>Marco</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>We appreciate the time and effort that you and the reviewers have dedicated to providing valuable feedback on our manuscript. We are grateful to the reviewers for their insightful comments.</p>
<p>Reviewer #1:</p>
<p>
We thank the reviewer for the positive comments made on our manuscript.</p>
<p>Reviewer #2:</p>
<p>
We thank the reviewer for these positive remarks.</p>
<p>Concerning the main weakness highlighted by the reviewer:</p>
<p>We presented results in our submitted work both without noise and with a signal-to-noise ratio (SNR) equal to 50. Figure 5 shows exemplar posterior distributions obtained in a noise-free scenario, and Table 1 reports the number of degeneracies for each model on 10000 noise-free simulations. These results highlight that the presence of degeneracies is inherent to the model definition. Figures 3, 6 and 7 present results considering an SNR of 50. Results with lower SNR have indeed not been included into this work. We agree that adding a figure showing the impact of noise on the posterior distributions will be a good addition to this work. We will include an additional figure in the second version, as interestingly suggested.</p>
</body>
</sub-article>
</article>