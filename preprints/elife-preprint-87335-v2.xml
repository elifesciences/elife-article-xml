<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">87335</article-id>
<article-id pub-id-type="doi">10.7554/eLife.87335</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.87335.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Genetics and Genomics</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>The protein domains of vertebrate species in which selection is more effective have greater intrinsic structural disorder</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1837-5209</contrib-id>
<name>
<surname>Weibel</surname>
<given-names>Catherine A</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="author-notes" rid="n1">*</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5347-5419</contrib-id>
<name>
<surname>Wheeler</surname>
<given-names>Andrew L</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="author-notes" rid="n1">*</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0518-6783</contrib-id>
<name>
<surname>James</surname>
<given-names>Jennifer E</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1605-6426</contrib-id>
<name>
<surname>Willis</surname>
<given-names>Sara M</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a7">7</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9341-4899</contrib-id>
<name>
<surname>McShea</surname>
<given-names>Hanon</given-names>
</name>
<xref ref-type="aff" rid="a8">8</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7398-2127</contrib-id>
<name>
<surname>Masel</surname>
<given-names>Joanna</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="corresp" rid="cor1">†</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Department of Mathematics, University of Arizona</institution>, Tucson, Arizona 85721, <country>USA</country></aff>
<aff id="a2"><label>2</label><institution>Department of Physics, University of Arizona</institution>, Tucson, Arizona 85721, <country>USA</country></aff>
<aff id="a3"><label>3</label><institution>Department of Applied Physics, Stanford University</institution>, California, <country>USA</country></aff>
<aff id="a4"><label>4</label><institution>Genetics Graduate Interdisciplinary Program, University of Arizona</institution>, Tucson, Arizona 85721, <country>USA</country></aff>
<aff id="a5"><label>5</label><institution>Department of Ecology and Evolutionary Biology, University of Arizona</institution>, Tucson, Arizona 85721, <country>USA</country></aff>
<aff id="a6"><label>6</label><institution>Department of Ecology and Genetics, Evolutionary Biology Center, Uppsala University</institution>, <country>Sweden</country></aff>
<aff id="a7"><label>7</label><institution>University Information Technology Services, University of Arizona</institution>, Tucson, Arizona 85721, <country>USA</country></aff>
<aff id="a8"><label>8</label><institution>Department of Earth System Science, Stanford University</institution></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Ogbunugafor</surname>
<given-names>C Brandon</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Yale University</institution>
</institution-wrap>
<city>New Haven</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Weigel</surname>
<given-names>Detlef</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Biology Tübingen</institution>
</institution-wrap>
<city>Tübingen</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>†</label><bold>Corresponding author:</bold> Joanna Masel, Email: <email>masel@arizona.edu</email></corresp>
<fn id="n1" fn-type="equal"><label>*</label><p>these authors contributed equally</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-07-26">
<day>26</day>
<month>07</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2024-07-16">
<day>16</day>
<month>07</month>
<year>2024</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP87335</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-03-16">
<day>16</day>
<month>03</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-03-03">
<day>03</day>
<month>03</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.03.02.530449"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-07-26">
<day>26</day>
<month>07</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.87335.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.87335.1.sa2">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.87335.1.sa1">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.87335.1.sa0">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="author-comment" xlink:href="https://doi.org/10.7554/eLife.87335.1.sa3">Author Response</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Weibel et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Weibel et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-87335-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>The nearly neutral theory of molecular evolution posits variation among species in the effectiveness of selection. In an idealized model, the census population size determines both this minimum magnitude of the selection coefficient required for deleterious variants to be reliably purged, and the amount of neutral diversity. Empirically, an “effective population size” is often estimated from the amount of putatively neutral genetic diversity and is assumed to also capture a species’ effectiveness of selection. A potentially more direct measure of the effectiveness of selection is the degree to which selection maintains preferred codons. However, past metrics that compare codon bias across species are confounded by among-species variation in %GC content and/or amino acid composition. Here we propose a new Codon Adaptation Index of Species (CAIS), based on Kullback-Leibler divergence, that corrects for both confounders. We demonstrate the use of CAIS correlations, as well as the Effective Number of Codons, to show that the protein domains of more highly adapted vertebrate species evolve higher intrinsic structural disorder</p>
</abstract>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Found two bugs in code that changed some results (Fig 3,4,6), updated Figure 2, minor edits to methods and discussion, updated author list.</p></fn>
</fn-group>
<fn-group content-type="external-links">
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://github.com/MaselLab/Codon-Adaptation-Index-of-Species">https://github.com/MaselLab/Codon-Adaptation-Index-of-Species</ext-link>
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Species differ from each other in many ways, including mating system, ploidy, spatial distribution, life history, size, lifespan, genome size, mutation rate, selective pressure, and population size. These differences make the process of purifying selection more efficient in some species than others. Our understanding of both the causes and consequences of these differences is limited in part by a reliable metric with which to measure them. In the long term, the probability that a gene is fixed for one allele rather than another allele is given by the ratio of fixation and counter-fixation probabilities (<xref ref-type="bibr" rid="c8">Bulmer 1991</xref>). In an idealized population of constant population size and no selection at linked sites, a mutation-selection-drift model describes how this ratio of fixation probabilities depends on the census population size <italic>N</italic> (<xref ref-type="bibr" rid="c38">Kimura 1962</xref>), and hence gives the fraction of sites expected to be found in preferred vs. non-preferred states (<xref rid="fig1" ref-type="fig">Figure 1</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><p>The effectiveness of selection, calculated as the long-term ratio of time spent in fixed deleterious : fixed beneficial allele states given symmetric mutation rates, is a function of the product <italic>sN</italic>. Assuming a diploid Wright-Fisher population with s &lt;&lt;1, the probability of fixation of a new mutation <inline-formula><inline-graphic xlink:href="530449v2_inline8.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and the y-axis is calculated as <italic>π(N, -s)</italic>⁄<italic>(π(N, -s) + π(N, s)). s</italic> is held constant at a value of 0.001 and <italic>N</italic> is varied. Results for other small magnitude values of <italic>s</italic> are superimposable. For small <italic>sN</italic>, selection is ineffective at producing codon bias. For large <italic>sN</italic>, selection is highly effective. For only a relatively narrow range of intermediate values of <italic>sN</italic>, the degree of codon bias depends quantitatively on <italic>sN</italic>.</p></caption>
<graphic xlink:href="530449v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>This reasoning has been extended to real populations by positing that species have an “effective” population size, <italic>N</italic><sub><italic>e</italic></sub> (<xref ref-type="bibr" rid="c52">Ohta 1973</xref>). <italic>N</italic><sub><italic>e</italic></sub> is the census population size of an idealized population that reproduces a property of interest in the focal population. <italic>N</italic><sub><italic>e</italic></sub> is therefore not a single quantity per population, but instead depends on which property is of interest.</p>
<p>The amount of neutral polymorphism is the usual property used to empirically estimate <italic>N</italic><sub><italic>e</italic></sub> (<xref ref-type="bibr" rid="c9">Charlesworth 2009</xref>; <xref ref-type="bibr" rid="c14">Doyle et al. 2015</xref>; <xref ref-type="bibr" rid="c47">Lynch et al. 2016</xref>). However, the property of most relevance to nearly neutral theory is instead the inflection point <italic>s</italic> at which non-preferred alleles become common enough to matter (<xref rid="fig1" ref-type="fig">Figure 1</xref>), and hence the degree to which highly exquisite adaptation can be maintained in the face of ongoing mutation and genetic drift (<xref ref-type="bibr" rid="c38">Kimura 1962</xref>; <xref ref-type="bibr" rid="c51">Ohta 1972</xref>; <xref ref-type="bibr" rid="c53">Ohta 1992</xref>). While genetic diversity has been found to reflect some aspects of life history strategy (<xref ref-type="bibr" rid="c59">Romiguier et al. 2014</xref>), there remain concerns about whether neutral genetic diversity and the limits to weak selection always remain closely coupled in non-equilibrium settings.</p>
<p>As a practical matter, <italic>N</italic><sub><italic>e</italic></sub> is usually calculated by dividing some measure of the amount of putatively neutral (often synonymous) polymorphism segregating in a population by that species’ mutation rate (<xref ref-type="bibr" rid="c9">Charlesworth 2009</xref>). As a result, <italic>N</italic><sub><italic>e</italic></sub> values are only available for species that have both polymorphism data and accurate mutation rate estimates, limiting their use. Worse, <italic>N</italic><sub><italic>e</italic></sub> is not a robust statistic. In the absence of a clear species definition, polymorphism is sometimes calculated across too broad a range of genomes, substantially inflating <italic>N</italic><sub><italic>e</italic></sub> (<xref ref-type="bibr" rid="c11">Daubin &amp; Moran 2004</xref>); a poor sampling scheme can have the converse effect of deflating genetic diversity. Transient hypermutation (<xref ref-type="bibr" rid="c55">Plotkin et al. 2006</xref>), which is common in microbes, causes further short-term inconsistencies in polymorphism levels. Perhaps most importantly, a recent bottleneck will deflate <italic>N</italic><sub><italic>e</italic></sub> based on the coalescence, even if too brief to lead to significant erosion of fine-tuned adaptations. But drift barrier theory concerns the level with which adaptation is fine-tuned, and so a better metric would capture that directly, rather than indirectly rely on neutral diversity.</p>
<p>An alternative approach to measure the efficiency of selection exploits codon usage bias, which is influenced by weak selection for factors such as translational speed and accuracy (<xref ref-type="bibr" rid="c29">Hershberg &amp; Petrov 2008</xref>; <xref ref-type="bibr" rid="c56">Plotkin &amp; Kudla 2011</xref>; <xref ref-type="bibr" rid="c33">Hunt et al. 2014</xref>). The degree of bias in synonymous codon usage that is driven by selective preference offers a more direct way to assess how effective selection is at the molecular level in a given species (<xref ref-type="bibr" rid="c44">Li 1987</xref>; <xref ref-type="bibr" rid="c8">Bulmer 1991</xref>; <xref ref-type="bibr" rid="c2">Akashi 1996</xref>; <xref ref-type="bibr" rid="c66">Subramanian 2008</xref>). Conveniently, it can be estimated from only a single genome, i.e., without polymorphism or mutation rate data for that species.</p>
<p>One commonly used metric, the Codon Adaptation Index (CAI) (Sharp &amp; <xref ref-type="bibr" rid="c44">Li 1987</xref>; <xref ref-type="bibr" rid="c63">Sharp et al. 2010</xref>) takes the average of Relative Synonymous Codon Usage (RSCU) scores, which quantify how often a codon is used, relative to the codon that is most frequently used to encode that amino acid in that species. While this works well for comparing genes within the same species, it unfortunately means that the species-wide strength of codon bias appears in the normalizing denominator (see <xref ref-type="disp-formula" rid="eqn4">equation 4</xref> below and <xref rid="figS1" ref-type="fig">Supplementary Figure 1A</xref>). Paradoxically, this can make more exquisitely adapted species have lower rather than higher species-averaged CAI scores (<xref rid="figS1" ref-type="fig">Supplementary Figure 1B</xref>; <xref ref-type="bibr" rid="c57">Rocha 2004</xref>; <xref ref-type="bibr" rid="c6">Botzman &amp; Margalit 2011</xref>).</p>
<p>To compare species using CAI, it has been suggested that instead of taking a genome-wide average, one should consider a set of highly expressed reference genes (<xref ref-type="bibr" rid="c62">Sharp et al. 2005</xref>; <xref ref-type="bibr" rid="c71">Vicario et al. 2007</xref>; <xref ref-type="bibr" rid="c66">Subramanian 2008</xref>; <xref ref-type="bibr" rid="c13">dos Reis &amp; Wernisch 2009</xref>). This approach assumes that the relative strength of selection on those reference genes (often a function of gene expression) remains approximately constant across the set of species considered (red distributions in <xref rid="fig2" ref-type="fig">Figure 2</xref>). Its use also requires careful attention to the length of reference genes (<xref ref-type="bibr" rid="c69">Urrutia &amp; Hurst 2001</xref>; <xref ref-type="bibr" rid="c12">Doherty &amp; McInerney 2013</xref>), and some approaches also require information about tRNA gene copy numbers and abundances (<xref ref-type="bibr" rid="c13">dos Reis &amp; Wernisch 2009</xref>).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><p>More highly adapted species (bottom) have a higher proportion of their sites subject to effective selection on codon bias (blue area). The CAI attempts to compare the intensity of selection (<xref rid="fig1" ref-type="fig">Figure 1</xref>, x-axis) in a subset of genes under strong selection (red areas). Given the narrow range of quantitative dependence of codon bias on <italic>sN</italic> shown in <xref rid="fig1" ref-type="fig">Figure 1</xref>, our new metric is intended to capture differences in the proportion of the proteome subject to substantial selection (blue areas).</p></caption>
<graphic xlink:href="530449v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Since codon bias varies quantitatively within only a small range of <italic>sN</italic> (<xref rid="fig1" ref-type="fig">Figure 1</xref>), a promising approach is to measure the proportion of sites at which codon adaptation is effective. We posit that more highly adapted species have a higher proportion of both genes and sites subject to effective selection on codon bias (<xref rid="fig2" ref-type="fig">Figure 2</xref>; <xref ref-type="bibr" rid="c26">Galtier et al. 2018</xref>). Indeed, CAI might also rely in part on variation in the fraction of sites within the reference genes that is subject to effective selection as a function of species (<xref rid="fig2" ref-type="fig">Figure 2</xref>, red). Here we take this logic further, considering all sites in a proteome-wide approach. Averaging across the entire proteome provides robustness to shifts in the expression level of or strength of selection on particular genes. The proteome-wide average depends on the fraction of sites whose selection coefficients exceed the “drift barrier” for that particular species (<xref rid="fig2" ref-type="fig">Figure 2</xref>, blue threshold).</p>
<p>In estimating the effects of selection, it is critical to control for other causes of codon bias. In particular, species differ in their mutational bias with respect to %GC, and in the frequency of GC-biased gene conversion (<xref ref-type="bibr" rid="c69">Urrutia &amp; Hurst 2001</xref>; <xref ref-type="bibr" rid="c17">Duret &amp; Galtier 2009</xref>; <xref ref-type="bibr" rid="c12">Doherty &amp; McInerney 2013</xref>; <xref ref-type="bibr" rid="c20">Figuet et al. 2014</xref>). Here, we control for %GC, capturing species differences both in mutation and in gene conversion, by calculating the Kullback-Leibler divergence of the observed codon frequencies away from the codon frequencies that we would expect to see given the genomic %GC content of the species. Kullback-Leibler divergence measures the distance of an observed probability distribution from an expected reference distribution given %GC, capturing a measure of surprise (<xref ref-type="bibr" rid="c41">Kullback &amp; Leibler 1951</xref>). This method does not require us to specify preferred vs. non-preferred codons, and can thus also accommodate situations in which different genes have different codon preferences (<xref ref-type="bibr" rid="c27">Gingold et al. 2014</xref>; <xref ref-type="bibr" rid="c10">Cope et al. 2018</xref>).</p>
<p>An alternative metric, the Effective Number of Codons (ENC) originally quantified how far the codon usage of a sequence departs from equal usage of synonymous codons (<xref ref-type="bibr" rid="c73">Wright 1990</xref>), with lower ENC values indicating greater departure. This approach creates a complex relationship with GC content (<xref ref-type="bibr" rid="c24">Fuglsang 2008</xref>), and so ENC was later modified to correct for GC content (<xref ref-type="bibr" rid="c49">Novembre 2002</xref>). However, a remaining issue with this modified ENC is that differences among species in amino acid composition might act as a confounding factor, even after controlling for GC content. Specifically, species that make more use of an amino acid for which there is stronger selection among codons (which is sometimes the case (<xref ref-type="bibr" rid="c71">Vicario et al.2007</xref>)) would have higher codon bias, even if each amino acid considered on its own had identical codon bias irrespective of which species it is in. Confounding with amino acid frequencies has been shown to be a problem at the individual protein level (<xref ref-type="bibr" rid="c10">Cope et al. 2018</xref>). Neither ENC (<xref ref-type="bibr" rid="c23">Fuglsang 2004</xref>; <xref ref-type="bibr" rid="c24">Fuglsang 2008</xref>) nor the CAI (Sharp &amp; <xref ref-type="bibr" rid="c44">Li 1987</xref>) adequately control for differences in amino acid composition when applied across species. Despite early claims to the contrary (<xref ref-type="bibr" rid="c73">Wright 1990</xref>), this problem is not easy to fix for ENC (<xref ref-type="bibr" rid="c23">Fuglsang 2004</xref>; <xref ref-type="bibr" rid="c24">Fuglsang 2008</xref>).</p>
<p>Here, we extend the CAI, using the information-theory based Kullback-Leibler divergence, so that it corrects for both GC and amino acid composition (see Methods) to create a new Codon Adaptation Index of Species (CAIS). The availability of complete genomes allows both metrics to be readily calculated without data on polymorphism or mutation rate, without selecting reference genes, and without concerns about demographic history. Our purpose is to find an accessible metric that can quantify the limits to weak selection important to nearly neutral theory; this differs from past evaluations focused on comparing different genes of the same species and recapitulating “ground truth” simulations thereof (<xref ref-type="bibr" rid="c67">Sun et al. 2012</xref>; <xref ref-type="bibr" rid="c75">Zhang et al. 2012</xref>; <xref ref-type="bibr" rid="c45">Liu et al. 2018</xref>). To demonstrate the usefulness of our method, we identify a novel correlation with intrinsic structural disorder (ISD), pointing to what else might be subject to weak selective preferences at the molecular level. While ENC can also identify subtle selection on ISD, CAIS can do so without the risk of confounding with amino acid frequencies.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Both ENC and CAIS solve the GC confounding problem that plagues CAI</title>
<p>CAI is seriously confounded with GC content (<xref rid="fig3" ref-type="fig">Figure 3A</xref>). ENC is not confounded with GC content (<xref rid="fig3" ref-type="fig">Figure 3B</xref>), while CAIS has only a very weak correlation that is not significant after correction for multiple comparisons (<xref rid="fig3" ref-type="fig">Figure 3C</xref>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><p>CAI is seriously confounded with GC content, while ENC and CAIS are not. We control for phylogenetic confounding via Phylogenetic Independent Contrasts (PIC) (<xref ref-type="bibr" rid="c19">Felsenstein 1985</xref>); this yields an unbiased R<sup>2</sup> estimate (<xref ref-type="bibr" rid="c58">Rohlf 2006</xref>). Each datapoint is one of 118 vertebrate species with “Complete” intergenic genomic sequence (allowing for %GC correction) and TimeTree divergence dates (allowing for PIC correction). Red line shows unweighted lm(y∼x) with grey region as 95% confidence interval. Plots without PIC correction are shown in Supplementary Figure 2.</p></caption>
<graphic xlink:href="530449v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2b">
<title>Proteins in better adapted species evolve more structural disorder</title>
<p>As an example of how correlations with codon adaptation metrics can be used to identify weak selective preferences, we investigate protein ISD. Disordered proteins are more likely to be harmful when overexpressed (<xref ref-type="bibr" rid="c70">Vavouri et al. 2009</xref>), and ISD is more abundant in eukaryotic than prokaryotic proteins (<xref ref-type="bibr" rid="c61">Schad et al. 2011</xref>; <xref ref-type="bibr" rid="c74">Xue et al. 2012</xref>; <xref ref-type="bibr" rid="c3">Basile et al. 2019</xref>), suggesting that low ISD might be favored by more effective selection.</p>
<p>However, compositional differences among proteomes might not be driven by differences in how a given protein sequence evolves as a function of the effectiveness of selection. Instead, they might be driven by the recent birth of ISD-rich proteins in animals (<xref ref-type="bibr" rid="c36">James et al. 2021</xref>), and/or by differences among sequences in their subsequent tendency to proliferate into many different genes (<xref ref-type="bibr" rid="c35">James et al. 2023</xref>). To focus only on the effects of descent with modification, we use a linear mixed model, with each species having a fixed effect on ISD, while controlling for Pfam domain identity as a random effect. We note that once GC is controlled for, codon adaptation can be assessed similarly in intrinsically disordered vs. ordered proteins (<xref ref-type="bibr" rid="c28">Gossmann et al. 2012</xref>). Controlling for Pfam identity is supported, with standard deviation in ISD of 0.178 among Pfams compared to residual standard deviation of 0.058, and a p-value on the significance of the Pfam random effect term of 3×10<sup>-13</sup>. Controlling in this way for Pfam identity, we then ask whether the fixed species effects on ISD are correlated with CAIS and with ENC.</p>
<p>Surprisingly, more exquisitely adapted species have more disordered protein domains (<xref rid="fig4" ref-type="fig">Figure 4</xref>). Results using ENC and CAIS are similar, with ENC having higher power; the correlation coefficient is 0.36 for CAIS compared to 0.50 for ENC, and the p-value for ENC is 3 orders of magnitude lower. We note, however, that amino acid frequencies strongly influence ISD (<xref ref-type="bibr" rid="c68">Theillet et al. 2013</xref>). The CAIS correlation is more reliable than the ENC correlation because by construction, CAIS controls for differences in amino acid frequencies among species.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Protein domains have higher ISD when found in more exquisitely adapted species. We show - ENC instead of ENC to more easily compare with CAIS. Each datapoint is one of 118 vertebrate species with “complete” intergenic genomic sequence available (allowing for %GC correction), and TimeTree divergence dates (allowing for PIC correction). “Effects” on ISD shown on the y-axis are fixed effects of species identity in our linear mixed model, after PIC correction. Red line shows unweighted lm(y∼x) with grey region as 95% confidence interval. Panels without PIC correction are presented in Supplementary Figure 3.</p></caption>
<graphic xlink:href="530449v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Different parts of the genome have different GC contents (<xref ref-type="bibr" rid="c4">Bernardi 2000</xref>; <xref ref-type="bibr" rid="c18">Eyre-Walker &amp; Hurst 2001</xref>; <xref ref-type="bibr" rid="c34">International Human Genome Sequencing Consortium 2001</xref>), primarily because the extent to which GC-biased gene conversion increases GC content depends on the local rate of recombination (<xref ref-type="bibr" rid="c25">Galtier et al. 2001</xref>; <xref ref-type="bibr" rid="c48">Meunier &amp; Duret 2004</xref>; <xref ref-type="bibr" rid="c16">Duret et al. 2006</xref>; <xref ref-type="bibr" rid="c17">Duret &amp; Galtier 2009</xref>). We therefore also calculated a version of CAIS whose codon frequency expectations are based on local intergenic GC content. This performed worse (<xref rid="fig4" ref-type="fig">Figure 4C</xref>) than our simple use of genome-wide GC content (<xref rid="fig4" ref-type="fig">Figure 4A</xref>) with respect to the strength of correlation between CAIS and ISD. If GC-biased gene conversion is a more powerful force than weak selective preferences among codons, then local GC content will evolve more rapidly than codon usage (<xref ref-type="bibr" rid="c39">Kondrashov et al. 2010</xref>). In this case, genome-wide GC may serve as an appropriately time-averaged proxy. It is also possible that the local non-coding sequences we used were too short (at 3000bp or more), creating excessive noise that obscured the signal.</p>
<p>Many vertebrates have higher recombination rates and hence GC-biased gene conversion near genes; in this case genome-wide GC content would misestimate the codon usage expected from the combination of mutation bias and GC-biased gene conversion in the vicinity of genes. If GC-biased gene conversion drove CAIS, we expect high <inline-formula><inline-graphic xlink:href="530449v2_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula> to predict high CAIS. We do not see this relationship (<xref rid="fig5" ref-type="fig">Figure 5</xref>), suggesting that gene conversion strength is not a confounding factor impacting CAIS.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><p>CAIS is not correlated with the degree to which local genomic regions differ in their GC content from global GC content. If CAIS were driven by GC biased gene conversion, genomes with more heterogeneous %GC distributions should have higher CAIS scores.</p></caption>
<graphic xlink:href="530449v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Younger animal-specific protein domains have higher ISD (<xref ref-type="bibr" rid="c36">James et al. 2021</xref>). It is possible that selection in favor of high ISD is strongest in young domains, which might use more primitive methods to avoid aggregation (<xref ref-type="bibr" rid="c22">Foy et al. 2019</xref>; <xref ref-type="bibr" rid="c5">Bertram &amp; Masel 2020</xref>). To test this, we analyze two subsets of our data: those that emerged prior to the last eukaryotic common ancestor (LECA), here referred to as “old” protein domains, and “young” protein domains that emerged after the divergence of animals and fungi from plants. Young and old domains show equally strong trends of increasing disorder with species’ adaptedness (<xref rid="fig6" ref-type="fig">Figure 6</xref>).</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><p>More exquisitely adapted species have higher ISD in both ancient and recent protein domains. Age assignments are taken from <xref ref-type="bibr" rid="c36">James et al. (2021)</xref>, with vertebrate protein domains that emerged prior to LECA classified as “old”, and vertebrate protein domains that emerged after the divergence of animals and fungi from plants as “young”. “Effects” on ISD shown on the y-axis are fixed effects of species identity in our linear mixed model. The same n=118 datapoints are shown as in Figures 3 and 4. Red line shows lm(y∼x), with grey region as 95% confidence interval. Panels without PIC correction are shown in Supplementary Figure 4. We show -ENC instead of ENC to more easily compare with CAIS.</p></caption>
<graphic xlink:href="530449v2_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>When different properties are each causally affected by a species’ exquisiteness of adaptation, this will create a correlation between the properties. We use codon adaptation as a reference property, such that correlations with codon adaptation indicate selection. To detect ISD as a novel property under selection, we used a linear mixed model approach that controls for Pfam identity as a random effect. This approach shows that the same Pfam domain tends to be more disordered when found in a well-adapted species (i.e. a species with a higher CAIS or ENC). This is true for both ancient and recently emerged protein domains.</p>
<p>It is important that no additional variable such as GC content or amino acid frequencies creates a spurious correlation by affecting both CAIS and our property of interest. For this reason, we define CAIS as the observed Kullback-Leibler divergence (<xref ref-type="bibr" rid="c41">Kullback &amp; Leibler 1951</xref>) from the codon usage expected given the GC content. The GC content pertinent to this expectation is primarily the product of mutation bias and GC-biased gene conversion (<xref ref-type="bibr" rid="c60">Romiguier &amp; Roux 2017</xref>), but potentially also of selection on individual nucleotide substitutions that is hypothesized to favor higher %GC (<xref ref-type="bibr" rid="c46">Long et al. 2018</xref>). By controlling for %GC, we exclude all these forces from influencing CAIS or ENC. We thus capture the extent of adaptation in codon bias, including translational speed, accuracy, and any intrinsic preference for GC over AT that is specific to coding regions. These remaining codon-adaptive factors do not create a statistically convincing correlation between CAIS and GC (<xref rid="fig3" ref-type="fig">Figures 3C</xref>), nor between ENC and GC (<xref rid="fig3" ref-type="fig">Figure 3B</xref>), although CAI is strongly correlated with GC (<xref rid="fig3" ref-type="fig">Figure 3A</xref>). Notably, our new CAIS metric of codon adaptation controls for amino acid frequencies, rather than, like ENC, only GC content.</p>
<p>A direct effect of ISD on fitness agrees with studies of random ORFs in <italic>Escherichia coli</italic>, where fitness was driven more by amino acid composition than %GC content, after controlling for the intrinsic correlation between the two (<xref ref-type="bibr" rid="c40">Kosinski et al. 2022</xref>). However, we have not ruled out a role for selection for higher %GC in ways that are general rather than restricted to coding regions, whether in shaping mutational biases (<xref ref-type="bibr" rid="c65">Smith &amp; Eyre-Walker 2001</xref>; <xref ref-type="bibr" rid="c30">Hershberg &amp; Petrov 2009</xref>; <xref ref-type="bibr" rid="c31">Hildebrand et al. 2010</xref>; <xref ref-type="bibr" rid="c50">Novoa et al. 2019</xref>; <xref ref-type="bibr" rid="c21">Forcelloni &amp; Giansanti 2020</xref>) or the extent of gene conversion, or even at the single nucleotide level in a manner shared between coding regions and intergenic regions (<xref ref-type="bibr" rid="c46">Long et al. 2018</xref>).</p>
<p>A more complex metric could control for more than just GC content and amino acid frequencies. First vs. second vs. third codon positions have different nucleotide usage on average, but while correcting for this might be useful for comparing genes (<xref ref-type="bibr" rid="c75">Zhang et al. 2012</xref>), correcting for it while comparing species might remove the effect of interest. Similarly, while it might be useful to control for dinucleotide and trinucleotide frequencies (<xref ref-type="bibr" rid="c7">Brbić et al. 2015</xref>), to avoid circularity these would need to be taken from intergenic sequences, with care needed to avoid influence from unannotated protein-coding genes or even pseudogenes.</p>
<p>Note that if a species were to experience a sudden reduction in census population size, e.g. due to habitat loss, leading to less effective selection, it would take some multiple of the neutral coalescent time for CAIS to fully adjust. CAIS thus represents a relatively long-term historical pattern of adaptation. The timescales setting neutral polymorphism based <italic>N</italic><sub><italic>e</italic></sub> estimates are likely shorter, based on a single round of coalescence. It is possible that the reason that we obtained correlations when we controlled for genome-wide GC content, but not when we controlled for local GC content, is also that codon adaptation adjusts slowly relative to the timescale of fluctuations in local GC content.</p>
<p>Here we developed a new metric of species adaptedness at the codon level, capable of quantifying degrees of codon adaptation even among vertebrates. We chose vertebrates partly due to the abundance of suitable data, and partly as a stringent test case, given past studies finding limited evidence for codon adaptation (<xref ref-type="bibr" rid="c37">Kessler &amp; Dean 2014</xref>). It remains to be seen how CAIS scales among species with stronger codon adaptation. We restricted our analysis to only the best annotated genomes, in part to ensure the quality of intergenic %GC estimates, and in part limited by the feasibility of running linear mixed models with six million data points. The phylogenetic tree is well resolved for vertebrate species, with an overrepresentation of mammalian species. Despite the focus on vertebrates, we were able to discover new results regarding selection on ISD.</p>
<p>Our finding that more effective selection prefers higher ISD was unexpected, given that lower-<italic>N</italic><sub><italic>e</italic></sub> eukaryotes have more disordered proteins than higher-<italic>N</italic><sub><italic>e</italic></sub> prokaryotes (<xref ref-type="bibr" rid="c1">Ahrens et al. 2017</xref>; <xref ref-type="bibr" rid="c3">Basile et al. 2019</xref>). However, this can be reconciled in a model in which highly disordered sequences are less likely to be found in high-<italic>N</italic><sub><italic>e</italic></sub> species, but the sequences that are present tend to have slightly higher disorder than their low-<italic>N</italic><sub><italic>e</italic></sub> homologs. High ISD might help mitigate the trade-off between affinity and specificity in protein-protein interactions (<xref ref-type="bibr" rid="c15">Dunker et al. 1998</xref>; <xref ref-type="bibr" rid="c32">Huang &amp; Liu 2013</xref>; <xref ref-type="bibr" rid="c43">Lazar et al. 2022</xref>); non-specific interactions might be short-lived due to the high entropy associated with disorder, which specific interactions are robust to.</p>
<p>Codon adaptation metrics more directly quantify how species vary in their exquisiteness of adaptation, than do estimates of effective population size that are based on neutral polymorphism. Both CAIS and ENC can also be estimated for far more species because they do not require polymorphism or mutation rate data, nor tRNA gene copy numbers and abundances, but only a single complete genome. CAIS has the additional advantage of not being confounded with amino acid frequencies. This makes CAIS a useful tools for applying nearly neutral theory to protein evolution, as shown by our worked example of ISD.</p>
</sec>
<sec id="s4">
<title>Methods</title>
<sec id="s4a">
<title>Species</title>
<p>Pfam sequences and IUPRED2 estimates of Intrinsic Structural Disorder (ISD) predictions were taken from <xref ref-type="bibr" rid="c36">James et al. (2021)</xref>, who studied species marked as “Complete” in the GOLD database, with divergence dates available in TimeTree (<xref ref-type="bibr" rid="c42">Kumar et al. 2017</xref>). <xref ref-type="bibr" rid="c36">James et al. (2021)</xref> applied a variety of quality controls to exclude contaminants from the set of Pfams and assign accurate dates of Pfam emergence. Pfams that emerged prior to LECA are classified here as “old”, and Pfams that emerged after the divergence of animals and fungi from plants are classified as “young”, following annotation by <xref ref-type="bibr" rid="c36">James et al. (2021)</xref>. Species list and other information can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/MaselLab/Codon-Adaptation-Index-of-Species">https://github.com/MaselLab/Codon-Adaptation-Index-of-Species</ext-link>.</p>
</sec>
<sec id="s4b">
<title>Codon Adaptation Index</title>
<p>Sharp and <xref ref-type="bibr" rid="c44">Li (1987)</xref> quantified codon bias through the Codon Adaptation Index (CAI), a normalized geometric mean of synonymous codon usage bias across sites, excluding stop and start codons. We modify this to calculate CAI including stop and start codons, because of documented preferences among stop codons in mammals (<xref ref-type="bibr" rid="c72">Wangen &amp; Green 2020</xref>). While usually used to compare genes within a species, among-species comparisons can be made using a reference set of genes that are highly expressed (Sharp &amp; <xref ref-type="bibr" rid="c44">Li 1987</xref>). Each codon <italic>i</italic> is assigned a Relative Synonymous Codon Usage value:
<disp-formula id="eqn1">
<graphic xlink:href="530449v2_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>N</italic><sub><italic>i</italic></sub> denotes the number of times that codon <italic>i</italic> is used, and the denominator sums over all <italic>n</italic><sub><italic>a</italic></sub> codons that code for that specific amino acid. RSCU values are normalized to produce a relative adaptiveness values <italic>w</italic><sub><italic>i</italic></sub> for each codon, relative to the best adapted codon for that amino acid:
<disp-formula id="eqn2">
<graphic xlink:href="530449v2_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Let <italic>L</italic> be the number of codons across all protein-coding sequences considered. Then
<disp-formula id="eqn3">
<graphic xlink:href="530449v2_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
To understand the effects of normalization, it is useful to rewrite this as:
<disp-formula id="eqn4">
<graphic xlink:href="530449v2_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>CAI</italic><sub><italic>raw</italic></sub> is the geometric mean of the “unnormalized” or observed synonymous codon usages, and <italic>CAI</italic><sub><italic>max</italic></sub> is the maximum possible CAI given the observed codon frequencies.</p>
</sec>
<sec id="s4c">
<title>GC Content</title>
<p>We calculated total %GC content (intergenic and genic) during a scan of all six reading frames across genic and intergenic sequences available from NCBI with access dates between May and July 2019 (described in <xref ref-type="bibr" rid="c35">James et al. (2023)</xref>). Of the 170 vertebrates meeting the quality criteria of <xref ref-type="bibr" rid="c36">James et al. (2021)</xref>, 118 had annotated intergenic sequences within NCBI, so we restricted the dataset further to keep only the 118 species for which total GC content was available.</p>
</sec>
<sec id="s4d">
<title>Codon Adaptation Index of Species (CAIS)</title>
<sec id="s4d1">
<title>Controlling for GC bias in Synonymous Codon Usage</title>
<p>Consider a sequence region <italic>r</italic> within species <italic>s</italic> where each nucleotide has an expected probability of being G or C = <italic>g</italic><sub><italic>r</italic></sub>. For our main analysis, we consider just one region <italic>r</italic> encompassing the entire genome of a species <italic>s</italic>. In a secondary analysis, we break the genome up and use local values of <italic>g</italic><sub><italic>r</italic></sub> in the non-coding regions within and surrounding a gene or set of overlapping genes. To annotate the boundaries of these local regions, we first selected 1500 base pairs flanking each side of every coding sequence identified by NCBI annotations. Coding sequence annotations are broken up according to exon by NCBI. When coding sequences of the same gene did not fall within 3000 base pairs of each other, they were treated as different regions. When two coding sequences, whether from the same gene or from different genes, had overlapping 1500bp catchment areas, we merged them together. <italic>g</italic><sub><italic>r</italic></sub> was then calculated based on the non-coding sites within each region, including both genic regions such as promoters and non-genic regions such as introns and intergenic sequences.</p>
<p>With no bias between C vs. G, nor between A vs. T, nor patterns beyond the overall composition taken one nucleotide at a time, the expected probability of seeing codon <italic>i</italic> in a triplet within <italic>r</italic> is
<disp-formula id="eqn5">
<graphic xlink:href="530449v2_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>k</italic><sub><italic>GC</italic></sub> <italic>+ k</italic><sub><italic>AT</italic></sub> <italic>=</italic> 3 total positions in codon <italic>i</italic>. The expected probability that amino acid <italic>a</italic> in region <italic>r</italic> is encoded by codon <italic>i</italic> is
<disp-formula id="eqn6">
<graphic xlink:href="530449v2_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
We can then measure the degree to which the observed codon frequencies diverge from these expected probabilities using the Kullback–Leibler divergence. This gives a CAIS metric for a species <italic>s</italic> where <italic>O</italic><sub><italic>i,s</italic></sub> is the observed frequency of codon <italic>i</italic>:
<disp-formula id="eqn7">
<graphic xlink:href="530449v2_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
</sec>
<sec id="s4d2">
<title>Controlling for Amino Acid Composition</title>
<p>Some amino acids may be more intrinsically prone to codon bias. We want a metric that quantifies effectiveness of selection (not amino acid frequency), so we re-weight CAIS on the basis of a standardized amino acid composition, to remove the effect of variation among species in amino acid frequencies.</p>
<p>Let <italic>F</italic><sub><italic>a</italic></sub> be the frequency of amino acid <italic>a</italic> across the entire dataset of 118 vertebrate genomes. We want to re-weight <italic>O</italic><sub><italic>i,s</italic></sub> on the basis of <italic>F</italic><sub><italic>a</italic></sub> to ensure that differences in amino acid frequencies among species do not affect CAIS, while preserving relative codon frequencies for the same amino acid. We do this by solving for <italic>α</italic><sub><italic>a,s</italic></sub> so that
<disp-formula id="eqn8">
<graphic xlink:href="530449v2_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
We then define <inline-formula><inline-graphic xlink:href="530449v2_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula> to obtain an amino acid frequency adjusted CAIS:
<disp-formula id="eqn9">
<graphic xlink:href="530449v2_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
The <italic>F</italic><sub><italic>a</italic></sub> values for our species set are at <ext-link ext-link-type="uri" xlink:href="https://github.com/MaselLab/Codon-Adaptation-Index-of-Species/blob/main/CAIS_ENC_calculation/Total_amino_acid_frequency_vertebrates.txt">https://github.com/MaselLab/Codon-Adaptation-Index-of-Species/blob/main/CAIS_ENC_calculation/Total_amino_acid_frequency_vertebrates.txt</ext-link>. Use of the standardized set of amino acid frequencies <italic>F</italic><sub><italic>a</italic></sub> has only a small effect on computed CAIS values relative to using each vertebrate species’ own amino acid frequencies (<xref rid="figS5" ref-type="fig">Supplementary Figure 5</xref>).</p>
<p>CAIS corrected for local intergenic GC content but not species-wide amino acid composition is
<disp-formula id="eqn10">
<graphic xlink:href="530449v2_eqn10.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>O</italic><sub><italic>i,r</italic></sub> is the number of times codon <italic>i</italic> appears in region <italic>r</italic> of species <italic>s, E</italic><sub><italic>i,r</italic></sub> is the expected number of times codon <italic>i</italic> would appear in region <italic>r</italic> of species <italic>s</italic> given the local intergenic GC content, G is the number of regions, and <inline-formula><inline-graphic xlink:href="530449v2_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the total number of codons in the genome. Rewritten for greater computational ease:
<disp-formula id="eqn11">
<graphic xlink:href="530449v2_eqn11.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Given the limited impact of amino acid frequency correction, we used <xref ref-type="disp-formula" rid="eqn11">Equation 11</xref> for the local GC results, but we could correct for amino acid composition by replacing the <italic>O</italic><sub><italic>i,r</italic></sub> prefactor with <inline-formula><inline-graphic xlink:href="530449v2_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, or even <inline-formula><inline-graphic xlink:href="530449v2_inline5.gif" mimetype="image" mime-subtype="gif"/></inline-formula>.</p>
</sec>
<sec id="s4d3">
<title>Novembre’s Effective Number of Codons (ENC) controlled for total GC Content</title>
<p>The expected number of codons is based on the squared deviations <inline-formula><inline-graphic xlink:href="530449v2_inline6.gif" mimetype="image" mime-subtype="gif"/></inline-formula> of the frequencies of the codons for each amino acid <italic>a</italic> from null expectations:
<disp-formula id="eqn12">
<graphic xlink:href="530449v2_eqn12.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>N</italic><sub><italic>a</italic></sub> is the total number of times that amino acid <italic>a</italic> appears. <xref ref-type="bibr" rid="c49">Novembre (2002)</xref> defines the corrected “F value” of amino acid <italic>a</italic> as
<disp-formula id="eqn13">
<graphic xlink:href="530449v2_eqn13.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
and
<disp-formula id="eqn14">
<graphic xlink:href="530449v2_eqn14.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where each <inline-formula><inline-graphic xlink:href="530449v2_inline7.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is the average of the “F values” for amino acids with <italic>n</italic><sub><italic>a</italic></sub> synonymous codons. Past measures of ENC do not contain stop or start codons (<xref ref-type="bibr" rid="c73">Wright 1990</xref>; <xref ref-type="bibr" rid="c49">Novembre 2002</xref>; <xref ref-type="bibr" rid="c23">Fuglsang 2004</xref>), but as we did for CAI and CAIS above, we include stop codons as an “amino acid” and therefore amend (14) to
<disp-formula id="eqn15">
<graphic xlink:href="530449v2_eqn15.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
</sec>
</sec>
<sec id="s4e">
<title>Statistical Analysis</title>
<p>All statistical modelling was done in R 3.5.1. Scripts for calculating CAI and CAIS were written in Python 3.7.</p>
<sec id="s4e1">
<title>Phylogenetic Independent Contrasts</title>
<p>Spurious phylogenetically confounded correlations can occur when closely related species share similar values of both metrics. One danger of such pseudoreplication is Simpson’s paradox, where there are negative slopes within taxonomic groups, but a positive slope among them might combine to yield an overall positive slope. We avoid pseudoreplication by using Phylogenetic Independent Contrasts (PIC) (<xref ref-type="bibr" rid="c19">Felsenstein 1985</xref>) to assess correlation. PIC analysis was done using the R package “ape” (<xref ref-type="bibr" rid="c54">Paradis &amp; Schliep 2019</xref>).</p>
</sec>
</sec>
</sec>
<sec id="s5">
<title>Data Availability</title>
<p>All data and code underlying this article are available in the public repository at <ext-link ext-link-type="uri" xlink:href="https://github.com/MaselLab/Codon-Adaptation-Index-of-Species">https://github.com/MaselLab/Codon-Adaptation-Index-of-Species</ext-link>.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>This work was supported by the National Institutes of Health (R01 GM104040 and T32 GM132008), the John Templeton Foundation (60814), the Arnold and Mabel Beckman Foundation Scholars Program, the Western Alliance to Expand Student Opportunities (WAESO) Louis Stokes Alliance for Minority Participation (LSAMP) National Science Foundation (NSF) Cooperative Agreement (HRD-1101728), and UA/NASA Space Grant Undergraduate Research Internship program. We thank Luke Kosinski, David Liberles, and Sawsan Wehbi for helpful discussions, Paul Nelson for providing the genome-wide GC contents, and the University of Arizona Undergraduate Biology Research Program for training. We thank Gavin Douglas for writing a convenient end-to-end implementation of CAIS on the basis of our preprint, which can be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/gavinmdouglas/handy_pop_gen/blob/main/CAIS.py">https://github.com/gavinmdouglas/handy_pop_gen/blob/main/CAIS.py</ext-link>, and for catching a minor bug in our code in time for us to correct it in the version of record. We thank the anonymous reviewers for constructive feedback, and Laurent Duret for helpful elaboration on the concerns of reviewer 1.</p>
</ack>
<ref-list>
<title>Literature Cited</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><surname>Ahrens</surname>, <given-names>JB</given-names></string-name>, <string-name><surname>Nunez-Castilla</surname>, <given-names>J</given-names></string-name>, and <string-name><surname>Siltberg-Liberles</surname>, <given-names>J.</given-names></string-name> <year>2017</year>. <article-title>Evolution of intrinsic disorder in eukaryotic proteins</article-title>. <source>Cellular and Molecular Life Sciences</source> <volume>74</volume>:<fpage>3163</fpage>–<lpage>3174</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><surname>Akashi</surname>, <given-names>H.</given-names></string-name> <year>1996</year>. <article-title>Molecular Evolution Between Drosophila melanogaster and D. simulans Reduced Codon Bias, Faster Rates of Amino Acid Substitution, and Larger Proteins in D. melanogaster</article-title>. <source>Genetics</source> <volume>144</volume>:<fpage>1297</fpage>–<lpage>1307</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><surname>Basile</surname>, <given-names>W</given-names></string-name>, <string-name><surname>Salvatore</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Bassot</surname>, <given-names>C</given-names></string-name>, and <string-name><surname>Elofsson</surname>, <given-names>A.</given-names></string-name> <year>2019</year>. <article-title>Why do eukaryotic proteins contain more intrinsically disordered regions?</article-title> <source>PLoS Computational Biology</source> <volume>15</volume>:<fpage>e1007186</fpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><surname>Bernardi</surname>, <given-names>G.</given-names></string-name> <year>2000</year>. <article-title>Isochores and the evolutionary genomics of vertebrates</article-title>. <source>Gene</source> <volume>241</volume>:<fpage>3</fpage>–<lpage>17</lpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><surname>Bertram</surname>, <given-names>J</given-names></string-name>, and <string-name><surname>Masel</surname>, <given-names>J.</given-names></string-name> <year>2020</year>. <article-title>Evolution rapidly optimizes stability and aggregation in lattice proteins despite pervasive landscape valleys and mazes</article-title>. <source>Genetics</source> <volume>214</volume>:<fpage>1047</fpage>–<lpage>1057</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><surname>Botzman</surname>, <given-names>M</given-names></string-name>, and <string-name><surname>Margalit</surname>, <given-names>H.</given-names></string-name> <year>2011</year>. <article-title>Variation in global codon usage bias among prokaryotic organisms is associated with their lifestyles</article-title>. <source>Genome Biology</source> <volume>12</volume>:<fpage>R109</fpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><surname>Brbić</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Warnecke</surname>, <given-names>T</given-names></string-name>, <string-name><surname>Kriško</surname>, <given-names>A</given-names></string-name>, and <string-name><surname>Supek</surname>, <given-names>F.</given-names></string-name> <year>2015</year>. <article-title>Global Shifts in Genome and Proteome Composition Are Very Tightly Coupled</article-title>. <source>Genome Biology and Evolution</source> <volume>7</volume>:<fpage>1519</fpage>–<lpage>1532</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><surname>Bulmer</surname>, <given-names>M.</given-names></string-name> <year>1991</year>. <article-title>The selection-mutation-drift theory of synonymous codon usage</article-title>. <source>Genetics</source> <volume>129</volume>:<fpage>897</fpage>–<lpage>907</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><surname>Charlesworth</surname>, <given-names>B.</given-names></string-name> <year>2009</year>. <article-title>Effective population size and patterns of molecular evolution and variation</article-title>. <source>Nature Reviews Genetics</source> <volume>10</volume>:<fpage>195</fpage>–<lpage>205</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><surname>Cope</surname>, <given-names>AL</given-names></string-name>, <string-name><surname>Hettich</surname>, <given-names>RL</given-names></string-name>, and <string-name><surname>Gilchrist</surname>, <given-names>MA</given-names></string-name>. <year>2018</year>. <article-title>Quantifying codon usage in signal peptides: Gene expression and amino acid usage explain apparent selection for inefficient codons</article-title>. <source>Biochimica et Biophysica Acta (BBA) - Biomembranes</source> <volume>1860</volume>:<fpage>2479</fpage>–<lpage>2485</lpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><surname>Daubin</surname>, <given-names>V</given-names></string-name>, and <string-name><surname>Moran</surname>, <given-names>NA</given-names></string-name>. <year>2004</year>. <article-title>Comment on “The Origins of Genome Complexity”</article-title>. <source>Science</source> <volume>306</volume>:<fpage>978</fpage>–<lpage>978</lpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><surname>Doherty</surname>, <given-names>A</given-names></string-name>, and <string-name><surname>McInerney</surname>, <given-names>JO</given-names></string-name>. <year>2013</year>. <article-title>Translational Selection Frequently Overcomes Genetic Drift in Shaping Synonymous Codon Usage Patterns in Vertebrates</article-title>. <source>Molecular Biology and Evolution</source> <volume>30</volume>:<fpage>2263</fpage>–<lpage>2267</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><surname>dos Reis</surname>, <given-names>M.</given-names></string-name> and <string-name><surname>Wernisch</surname>, <given-names>L.</given-names></string-name> <year>2009</year>. <article-title>Estimating Translational Selection in Eukaryotic Genomes</article-title>. <source>Molecular Biology and Evolution</source> <volume>26</volume>:<fpage>451</fpage>–<lpage>461</lpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><string-name><surname>Doyle</surname>, <given-names>JM</given-names></string-name>, <string-name><surname>Hacking</surname>, <given-names>CC</given-names></string-name>, <string-name><surname>Willoughby</surname>, <given-names>JR</given-names></string-name>, <string-name><surname>Sundaram</surname>, <given-names>M</given-names></string-name>, and <string-name><surname>DeWoody</surname>, <given-names>JA</given-names></string-name>. <year>2015</year>. <article-title>Mammalian genetic diversity as a function of habitat, body size, trophic class, and conservation status</article-title>. <source>Journal of Mammalogy</source> <volume>96</volume>:<fpage>564</fpage>–<lpage>572</lpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><surname>Dunker</surname>, <given-names>AK</given-names></string-name>, <string-name><surname>Garner</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Guilliot</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Romero</surname>, <given-names>P</given-names></string-name>, <string-name><surname>Albrecht</surname>, <given-names>K</given-names></string-name>, <string-name><surname>Hart</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Obradovic</surname>, <given-names>Z</given-names></string-name>, <string-name><surname>Kissinger</surname>, <given-names>C</given-names></string-name>, and <string-name><surname>Villafranca</surname>, <given-names>JE</given-names></string-name>. <year>1998</year>. <article-title>Protein disorder and the evolution of molecular recognition: theory, predictions and observations</article-title>. <source>Pacific Symposium on Biocomputing</source> Pp. <fpage>473</fpage>–<lpage>484</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><surname>Duret</surname>, <given-names>L</given-names></string-name>, <string-name><surname>Eyre-Walker</surname>, <given-names>A</given-names></string-name>, and <string-name><surname>Galtier</surname>, <given-names>N.</given-names></string-name> <year>2006</year>. <article-title>A new perspective on isochore evolution</article-title>. <source>Gene</source> <volume>385</volume>:<fpage>71</fpage>–<lpage>74</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><surname>Duret</surname>, <given-names>L</given-names></string-name>, and <string-name><surname>Galtier</surname>, <given-names>N.</given-names></string-name> <year>2009</year>. <article-title>Biased Gene Conversion and the Evolution of Mammalian Genomic Landscapes</article-title>. <source>Annual Review of Genomics and Human Genetics</source> <volume>10</volume>:<fpage>285</fpage>–<lpage>311</lpage>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><string-name><surname>Eyre-Walker</surname>, <given-names>A</given-names></string-name>, and <string-name><surname>Hurst</surname>, <given-names>LD</given-names></string-name>. <year>2001</year>. <article-title>The evolution of isochores</article-title>. <source>Nature Reviews Genetics</source> <volume>2</volume>:<fpage>549</fpage>–<lpage>555</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><surname>Felsenstein</surname>, <given-names>J.</given-names></string-name> <year>1985</year>. <article-title>Phylogenies and the Comparative Method</article-title>. <source>The American Naturalist</source> <volume>125</volume>:<fpage>1</fpage>–<lpage>15</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><surname>Figuet</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Ballenghien</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Romiguier</surname>, <given-names>J</given-names></string-name>, and <string-name><surname>Galtier</surname>, <given-names>N.</given-names></string-name> <year>2014</year>. <article-title>Biased Gene Conversion and GC-Content Evolution in the Coding Sequences of Reptiles and Vertebrates</article-title>. <source>Genome Biology and Evolution</source> <volume>7</volume>:<fpage>240</fpage>–<lpage>250</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><surname>Forcelloni</surname>, <given-names>S</given-names></string-name>, and <string-name><surname>Giansanti</surname>, <given-names>A.</given-names></string-name> <year>2020</year>. <article-title>Evolutionary Forces and Codon Bias in Different Flavors of Intrinsic Disorder in the Human Proteome</article-title>. <source>Journal of Molecular Evolution</source> <volume>88</volume>:<fpage>164</fpage>–<lpage>178</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><surname>Foy</surname>, <given-names>SG</given-names></string-name>, <string-name><surname>Wilson</surname>, <given-names>BA</given-names></string-name>, <string-name><surname>Bertram</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Cordes</surname>, <given-names>MHJ</given-names></string-name>, and <string-name><surname>Masel</surname>, <given-names>J.</given-names></string-name> <year>2019</year>. <article-title>A Shift in Aggregation Avoidance Strategy Marks a Long-Term Direction to Protein Evolution</article-title>. <source>Genetics</source> <volume>211</volume>:<fpage>1345</fpage>–<lpage>1355</lpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><string-name><surname>Fuglsang</surname>, <given-names>A.</given-names></string-name> <year>2004</year>. <article-title>The ‘effective number of codons’ revisited</article-title>. <source>Biochemical and Biophysical Research Communications</source> <volume>317</volume>:<fpage>957</fpage>–<lpage>964</lpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><surname>Fuglsang</surname>, <given-names>A.</given-names></string-name> <year>2008</year>. <article-title>Impact of bias discrepancy and amino acid usage on estimates of the effective number of codons used in a gene, and a test for selection on codon usage</article-title>. <source>Gene</source> <volume>410</volume>:<fpage>82</fpage>–<lpage>88</lpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><surname>Galtier</surname>, <given-names>N</given-names></string-name>, <string-name><surname>Piganeau</surname>, <given-names>G</given-names></string-name>, <string-name><surname>Mouchiroud</surname>, <given-names>D</given-names></string-name>, and <string-name><surname>Duret</surname>, <given-names>L.</given-names></string-name> <year>2001</year>. <article-title>GC-Content Evolution in Mammalian Genomes: The Biased Gene Conversion Hypothesis</article-title>. <source>Genetics</source> <volume>159</volume>:<fpage>907</fpage>–<lpage>911</lpage>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><surname>Galtier</surname>, <given-names>N</given-names></string-name>, <string-name><surname>Roux</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Rousselle</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Romiguier</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Figuet</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Glémin</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Bierne</surname>, <given-names>N</given-names></string-name>, and <string-name><surname>Duret</surname>, <given-names>L.</given-names></string-name> <year>2018</year>. <article-title>Codon Usage Bias in Animals: Disentangling the Effects of Natural Selection, Effective Population Size, and GC-Biased Gene Conversion</article-title>. <source>Molecular Biology and Evolution</source> <volume>35</volume>:<fpage>1092</fpage>–<lpage>1103</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><surname>Gingold</surname>, <given-names>H</given-names></string-name>, <string-name><surname>Tehler</surname>, <given-names>D</given-names></string-name>, <string-name><surname>Christoffersen</surname>, <given-names>Nanna R</given-names></string-name>, <string-name><surname>Nielsen</surname>, <given-names>Morten M</given-names></string-name>, <string-name><surname>Asmar</surname>, <given-names>F</given-names></string-name>, <string-name><surname>Kooistra</surname>, <given-names>Susanne M</given-names></string-name>, <string-name><surname>Christophersen</surname>, <given-names>Nicolaj S</given-names></string-name>, <string-name><surname>Christensen</surname>, <given-names>LL</given-names></string-name>, <string-name><surname>Borre</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Sørensen</surname>, <given-names>Karina D</given-names></string-name>, <string-name><surname>Andersen</surname>, <given-names>Lars D</given-names></string-name>, <string-name><surname>Andersen</surname>, <given-names>Claus L</given-names></string-name>, <string-name><surname>Hulleman</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Wurdinger</surname>, <given-names>T</given-names></string-name>, <string-name><surname>Ralfkiær</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Helin</surname>, <given-names>K</given-names></string-name>, <string-name><surname>Grønbæk</surname>, <given-names>K</given-names></string-name>, <string-name><surname>Ørntoft</surname>, <given-names>T</given-names></string-name>, <string-name><surname>Waszak</surname>, <given-names>Sebastian M</given-names></string-name>, <string-name><surname>Dahan</surname>, <given-names>O</given-names></string-name>, … <string-name><surname>Pilpel</surname>, <given-names>Y.</given-names></string-name> <year>2014</year>. <article-title>A Dual Program for Translation Regulation in Cellular Proliferation and Differentiation</article-title>. <source>Cell</source> <volume>158</volume>:<fpage>1281</fpage>–<lpage>1292</lpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><surname>Gossmann</surname>, <given-names>TI</given-names></string-name>, <string-name><surname>Keightley</surname>, <given-names>PD</given-names></string-name>, and <string-name><surname>Eyre-Walker</surname>, <given-names>A.</given-names></string-name> <year>2012</year>. <article-title>The Effect of Variation in the Effective Population Size on the Rate of Adaptive Molecular Evolution in Eukaryotes</article-title>. <source>Genome Biology and Evolution</source> <volume>4</volume>:<fpage>658</fpage>–<lpage>667</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><surname>Hershberg</surname>, <given-names>R</given-names></string-name>, and <string-name><surname>Petrov</surname>, <given-names>DA</given-names></string-name>. <year>2008</year>. <article-title>Selection on Codon Bias</article-title>. <source>Annual Review of Genetics</source> <volume>42</volume>:<fpage>287</fpage>–<lpage>299</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><surname>Hershberg</surname>, <given-names>R</given-names></string-name>, and <string-name><surname>Petrov</surname>, <given-names>DA</given-names></string-name>. <year>2009</year>. <article-title>General Rules for Optimal Codon Choice</article-title>. <source>PLoS Genetics</source> <volume>5</volume>:<fpage>e1000556</fpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><surname>Hildebrand</surname>, <given-names>F</given-names></string-name>, <string-name><surname>Meyer</surname>, <given-names>A</given-names></string-name>, and <string-name><surname>Eyre-Walker</surname>, <given-names>A.</given-names></string-name> <year>2010</year>. <article-title>Evidence of Selection upon Genomic GC-Content in Bacteria</article-title>. <source>PLoS Genetics</source> <volume>6</volume>:<fpage>e1001107</fpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><surname>Huang</surname>, <given-names>Y</given-names></string-name>, and <string-name><surname>Liu</surname>, <given-names>Z.</given-names></string-name> <year>2013</year>. <article-title>Do Intrinsically Disordered Proteins Possess High Specificity in Protein– Protein Interactions?</article-title> <source>Chemistry – A European Journal</source> <volume>19</volume>:<fpage>4462</fpage>–<lpage>4467</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><surname>Hunt</surname>, <given-names>RC</given-names></string-name>, <string-name><surname>Simhadri</surname>, <given-names>VL</given-names></string-name>, <string-name><surname>Iandoli</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Sauna</surname>, <given-names>ZE</given-names></string-name>, and <string-name><surname>Kimchi-Sarfaty</surname>, <given-names>C.</given-names></string-name> <year>2014</year>. <article-title>Exposing synonymous mutations</article-title>. <source>Trends In Genetics</source> <volume>30</volume>:<fpage>308</fpage>–<lpage>321</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><collab>International Human Genome Sequencing Consortium</collab>. <year>2001</year>. <article-title>Initial sequencing and analysis of the human genome</article-title>. <source>Nature</source> <volume>409</volume>:<fpage>860</fpage>–<lpage>921</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><surname>James</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Nelson</surname>, <given-names>P</given-names></string-name>, and <string-name><surname>Masel</surname>, <given-names>J.</given-names></string-name> <year>2023</year>. <article-title>Differential retention of Pfam domains contributes to long-term evolutionary trends</article-title>. <source>Molecular Biology and Evolution</source>:<fpage>msad073</fpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><surname>James</surname>, <given-names>JE</given-names></string-name>, <string-name><surname>Willis</surname>, <given-names>SM</given-names></string-name>, <string-name><surname>Nelson</surname>, <given-names>PG</given-names></string-name>, <string-name><surname>Weibel</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Kosinski</surname>, <given-names>LJ</given-names></string-name>, and <string-name><surname>Masel</surname>, <given-names>J.</given-names></string-name> <year>2021</year>. <article-title>Universal and taxon-specific trends in protein sequences as a function of age</article-title>. <source>eLife</source> <volume>10</volume>:<fpage>e57347</fpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><surname>Kessler</surname>, <given-names>MD</given-names></string-name>, and <string-name><surname>Dean</surname>, <given-names>MD</given-names></string-name>. <year>2014</year>. <article-title>Effective population size does not predict codon usage bias in mammals</article-title>. <source>Ecology and Evolution</source> <volume>4</volume>:<fpage>3887</fpage>–<lpage>3900</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><surname>Kimura</surname>, <given-names>M.</given-names></string-name> <year>1962</year>. <article-title>On the probability of fixation of mutant genes in a population</article-title>. <source>Genetics</source> <volume>47</volume>:<fpage>713</fpage>–<lpage>719</lpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><surname>Kondrashov</surname>, <given-names>AS</given-names></string-name>, <string-name><surname>Povolotskaya</surname>, <given-names>IS</given-names></string-name>, <string-name><surname>Ivankov</surname>, <given-names>DN</given-names></string-name>, and <string-name><surname>Kondrashov</surname>, <given-names>FA</given-names></string-name>. <year>2010</year>. <article-title>Rate of sequence divergence under constant selection</article-title>. <source>Biology Direct</source> <volume>5</volume>:<fpage>5</fpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><surname>Kosinski</surname>, <given-names>LJ</given-names></string-name>, <string-name><surname>Aviles</surname>, <given-names>NR</given-names></string-name>, <string-name><surname>Gomez</surname>, <given-names>K</given-names></string-name>, and <string-name><surname>Masel</surname>, <given-names>J.</given-names></string-name> <year>2022</year>. <article-title>Random Peptides Rich in Small and Disorder-Promoting Amino Acids Are Less Likely to Be Harmful</article-title>. <source>Genome Biology and Evolution</source> <volume>14</volume>:<fpage>evac085</fpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><surname>Kullback</surname>, <given-names>S</given-names></string-name>, and <string-name><surname>Leibler</surname>, <given-names>RA</given-names></string-name>. <year>1951</year>. <article-title>On Information and Sufficiency</article-title>. <source>The Annals of Mathematical Statistics</source> <volume>22</volume>:<fpage>79</fpage>–<lpage>86</lpage>, 8.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><surname>Kumar</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Stecher</surname>, <given-names>G</given-names></string-name>, <string-name><surname>Suleski</surname>, <given-names>M</given-names></string-name>, and <string-name><surname>Hedges</surname>, <given-names>SB</given-names></string-name>. <year>2017</year>. <article-title>TimeTree: A Resource for timelines, timetrees, and divergence times</article-title>. <source>Molecular Biology and Evolution</source> <volume>34</volume>:<fpage>1812</fpage>–<lpage>1819</lpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><surname>Lazar</surname>, <given-names>T</given-names></string-name>, <string-name><surname>Tantos</surname>, <given-names>A</given-names></string-name>, <string-name><surname>Tompa</surname>, <given-names>P</given-names></string-name>, and <string-name><surname>Schad</surname>, <given-names>E.</given-names></string-name> <year>2022</year>. <article-title>Intrinsic protein disorder uncouples affinity from binding specificity</article-title>. <source>Protein Science</source> <volume>31</volume>:<fpage>e4455</fpage>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><surname>Li</surname>, <given-names>W-H.</given-names></string-name> <year>1987</year>. <article-title>Models of nearly neutral mutations with particular implications for nonrandom usage of synonymous codons</article-title>. <source>Journal of Molecular Evolution</source> <volume>24</volume>:<fpage>337</fpage>–<lpage>345</lpage>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><surname>Liu</surname>, <given-names>SS</given-names></string-name>, <string-name><surname>Hockenberry</surname>, <given-names>AJ</given-names></string-name>, <string-name><surname>Jewett</surname>, <given-names>MC</given-names></string-name>, and <string-name><surname>Amaral</surname>, <given-names>LAN</given-names></string-name>. <year>2018</year>. <article-title>A novel framework for evaluating the performance of codon usage bias metrics</article-title>. <source>Journal of The Royal Society Interface</source> <volume>15</volume>:<fpage>20170667</fpage>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><surname>Long</surname>, <given-names>H</given-names></string-name>, <string-name><surname>Sung</surname>, <given-names>W</given-names></string-name>, <string-name><surname>Kucukyildirim</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Williams</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Miller</surname>, <given-names>SF</given-names></string-name>, <string-name><surname>Guo</surname>, <given-names>W</given-names></string-name>, <string-name><surname>Patterson</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Gregory</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Strauss</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Stone</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Berne</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Kysela</surname>, <given-names>D</given-names></string-name>, <string-name><surname>Shoemaker</surname>, <given-names>WR</given-names></string-name>, <string-name><surname>Muscarella</surname>, <given-names>ME</given-names></string-name>, <string-name><surname>Luo</surname>, <given-names>H</given-names></string-name>, <string-name><surname>Lennon</surname>, <given-names>JT</given-names></string-name>, <string-name><surname>Brun</surname>, <given-names>YV</given-names></string-name>, and <string-name><surname>Lynch</surname>, <given-names>M.</given-names></string-name> <year>2018</year>. <article-title>Evolutionary determinants of genome-wide nucleotide composition</article-title>. <source>Nature Ecology &amp; Evolution</source> <volume>2</volume>:<fpage>237</fpage>–<lpage>240</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><surname>Lynch</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Ackerman</surname>, <given-names>MS</given-names></string-name>, <string-name><surname>Gout</surname>, <given-names>J-F</given-names></string-name>, <string-name><surname>Long</surname>, <given-names>H</given-names></string-name>, <string-name><surname>Sung</surname>, <given-names>W</given-names></string-name>, <string-name><surname>Thomas</surname>, <given-names>WK</given-names></string-name>, and <string-name><surname>Foster</surname>, <given-names>PL</given-names></string-name>. <year>2016</year>. <article-title>Genetic drift, selection and the evolution of the mutation rate</article-title>. <source>Nature Reviews Genetics</source> <volume>17</volume>:<fpage>704</fpage>–<lpage>714</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><surname>Meunier</surname>, <given-names>J</given-names></string-name>, and <string-name><surname>Duret</surname>, <given-names>L.</given-names></string-name> <year>2004</year>. <article-title>Recombination Drives the Evolution of GC-Content in the Human Genome</article-title>. <source>Molecular Biology and Evolution</source> <volume>21</volume>:<fpage>984</fpage>–<lpage>990</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><surname>Novembre</surname>, <given-names>JA</given-names></string-name>. <year>2002</year>. <article-title>Accounting for Background Nucleotide Composition When Measuring Codon Usage Bias</article-title>. <source>Molecular Biology and Evolution</source> <volume>19</volume>:<fpage>1390</fpage>–<lpage>1394</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="journal"><string-name><surname>Novoa</surname>, <given-names>EM</given-names></string-name>, <string-name><surname>Jungreis</surname>, <given-names>I</given-names></string-name>, <string-name><surname>Jaillon</surname>, <given-names>O</given-names></string-name>, and <string-name><surname>Kellis</surname>, <given-names>M.</given-names></string-name> <year>2019</year>. <article-title>Elucidation of Codon Usage Signatures across the Domains of Life</article-title>. <source>Molecular Biology and Evolution</source> <volume>36</volume>:<fpage>2328</fpage>–<lpage>2339</lpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="journal"><string-name><surname>Ohta</surname>, <given-names>T.</given-names></string-name> <year>1972</year>. <article-title>Population size and rate of evolution</article-title>. <source>Journal of Molecular Evolution</source> <volume>1</volume>:<fpage>305</fpage>–<lpage>314</lpage>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><surname>Ohta</surname>, <given-names>T.</given-names></string-name> <year>1973</year>. <article-title>Slightly Deleterious Mutant Substitutions in Evolution</article-title>. <source>Nature</source> <volume>246</volume>:<fpage>96</fpage>–<lpage>98</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><surname>Ohta</surname>, <given-names>T.</given-names></string-name> <year>1992</year>. <article-title>The Nearly Neutral Theory of Molecular Evolution</article-title>. <source>Annual Review of Ecology and Systematics</source> <volume>23</volume>:<fpage>263</fpage>–<lpage>286</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><surname>Paradis</surname>, <given-names>E</given-names></string-name>, and <string-name><surname>Schliep</surname>, <given-names>K.</given-names></string-name> <year>2019</year>. <article-title>ape 5.0: an environment for modern phylogenetics and evolutionary analyses in R</article-title>. <source>Bioinformatics</source> <volume>35</volume>:<fpage>526</fpage>–<lpage>528</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><surname>Plotkin</surname>, <given-names>JB</given-names></string-name>, <string-name><surname>Dushoff</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Desai</surname>, <given-names>MM</given-names></string-name>, and <string-name><surname>Fraser</surname>, <given-names>HB</given-names></string-name>. <year>2006</year>. <article-title>Codon Usage and Selection on Proteins</article-title>. <source>Journal of Molecular Evolution</source> <volume>63</volume>:<fpage>635</fpage>–<lpage>653</lpage>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><surname>Plotkin</surname>, <given-names>JB</given-names></string-name>, and <string-name><surname>Kudla</surname>, <given-names>G.</given-names></string-name> <year>2011</year>. <article-title>Synonymous but not the same: the causes and consequences of codon bias</article-title>. <source>Nature Reviews Genetics</source> <volume>12</volume>:<fpage>32</fpage>–<lpage>42</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><surname>Rocha</surname>, <given-names>EPC</given-names></string-name>. <year>2004</year>. <article-title>Codon usage bias from tRNA’s point of view: Redundancy, specialization, and efficient decoding for translation optimization</article-title>. <source>Genome Research</source> <volume>14</volume>:<fpage>2279</fpage>–<lpage>2286</lpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><surname>Rohlf</surname>, <given-names>FJ</given-names></string-name>. <year>2006</year>. <article-title>A Comment on Phylogenetic Correction</article-title>. <source>Evolution</source> <volume>60</volume>:<fpage>1509</fpage>–<lpage>1515</lpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><surname>Romiguier</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Gayral</surname>, <given-names>P</given-names></string-name>, <string-name><surname>Ballenghien</surname>, <given-names>M</given-names></string-name>, <string-name><surname>Bernard</surname>, <given-names>A</given-names></string-name>, <string-name><surname>Cahais</surname>, <given-names>V</given-names></string-name>, <string-name><surname>Chenuil</surname>, <given-names>A</given-names></string-name>, <string-name><surname>Chiari</surname>, <given-names>Y</given-names></string-name>, <string-name><surname>Dernat</surname>, <given-names>R</given-names></string-name>, <string-name><surname>Duret</surname>, <given-names>L</given-names></string-name>, <string-name><surname>Faivre</surname>, <given-names>N</given-names></string-name>, <string-name><surname>Loire</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Lourenco</surname>, <given-names>JM</given-names></string-name>, <string-name><surname>Nabholz</surname>, <given-names>B</given-names></string-name>, <string-name><surname>Roux</surname>, <given-names>C</given-names></string-name>, <string-name><surname>Tsagkogeorga</surname>, <given-names>G</given-names></string-name>, <string-name><surname>Weber</surname>, <given-names>AAT</given-names></string-name>, <string-name><surname>Weinert</surname>, <given-names>LA</given-names></string-name>, <string-name><surname>Belkhir</surname>, <given-names>K</given-names></string-name>, <string-name><surname>Bierne</surname>, <given-names>N</given-names></string-name>, <string-name><surname>Glémin</surname>, <given-names>S</given-names></string-name>, … <string-name><surname>Galtier</surname>, <given-names>N.</given-names></string-name> <year>2014</year>. <article-title>Comparative population genomics in animals uncovers the determinants of genetic diversity</article-title>. <source>Nature</source> <volume>515</volume>:<fpage>261</fpage>–<lpage>263</lpage>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><surname>Romiguier</surname>, <given-names>J</given-names></string-name>, and <string-name><surname>Roux</surname>, <given-names>C.</given-names></string-name> <year>2017</year>. <article-title>Analytical Biases Associated with GC-Content in Molecular Evolution</article-title>. <source>Frontiers in Genetics</source> <volume>8</volume>:<fpage>16</fpage>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><surname>Schad</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Tompa</surname>, <given-names>P</given-names></string-name>, and <string-name><surname>Hegyi</surname>, <given-names>H.</given-names></string-name> <year>2011</year>. <article-title>The relationship between proteome size, structural disorder and organism complexity</article-title>. <source>Genome Biology</source> <volume>12</volume>:<fpage>R120</fpage>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><surname>Sharp</surname>, <given-names>PM</given-names></string-name>, <string-name><surname>Bailes</surname>, <given-names>E</given-names></string-name>, <string-name><surname>Grocock</surname>, <given-names>RJ</given-names></string-name>, <string-name><surname>Peden</surname>, <given-names>JF</given-names></string-name>, and <string-name><surname>Sockett</surname>, <given-names>RE</given-names></string-name>. <year>2005</year>. <article-title>Variation in the strength of selected codon usage bias among bacteria</article-title>. <source>Nucleic Acids Research</source> <volume>33</volume>:<fpage>1141</fpage>–<lpage>1153</lpage>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><string-name><surname>Sharp</surname>, <given-names>PM</given-names></string-name>, <string-name><surname>Emery</surname>, <given-names>LR</given-names></string-name>, and <string-name><surname>Zeng</surname>, <given-names>K.</given-names></string-name> <year>2010</year>. <article-title>Forces that influence the evolution of codon bias</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>365</volume>:<fpage>1203</fpage>–<lpage>1212</lpage>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><string-name><surname>Sharp</surname>, <given-names>PM</given-names></string-name>, and <string-name><surname>Li</surname>, <given-names>W-H.</given-names></string-name> <year>1987</year>. <article-title>The codon adaptation index-a measure of directional synonymous codon usage bias, and its potential applications</article-title>. <source>Nucleic Acids Research</source> <volume>15</volume>:<fpage>1281</fpage>–<lpage>1295</lpage>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><string-name><surname>Smith</surname>, <given-names>NGC</given-names></string-name>, and <string-name><surname>Eyre-Walker</surname>, <given-names>A.</given-names></string-name> <year>2001</year>. <article-title>Synonymous Codon Bias Is Not Caused by Mutation Bias in G+C-Rich Genes in Humans</article-title>. <source>Molecular Biology and Evolution</source> <volume>18</volume>:<fpage>982</fpage>–<lpage>986</lpage>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><string-name><surname>Subramanian</surname>, <given-names>S.</given-names></string-name> <year>2008</year>. <article-title>Nearly Neutrality and the Evolution of Codon Usage Bias in Eukaryotic Genomes</article-title>. <source>Genetics</source> <volume>178</volume>:<fpage>2429</fpage>–<lpage>2432</lpage>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><string-name><surname>Sun</surname>, <given-names>X</given-names></string-name>, <string-name><surname>Yang</surname>, <given-names>Q</given-names></string-name>, and <string-name><surname>Xia</surname>, <given-names>X.</given-names></string-name> <year>2012</year>. <article-title>An Improved Implementation of Effective Number of Codons (Nc)</article-title>. <source>Molecular Biology and Evolution</source> <volume>30</volume>:<fpage>191</fpage>–<lpage>196</lpage>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><string-name><surname>Theillet</surname>, <given-names>F-X</given-names></string-name>, <string-name><surname>Kalmar</surname>, <given-names>L</given-names></string-name>, <string-name><surname>Tompa</surname>, <given-names>P</given-names></string-name>, <string-name><surname>Han</surname>, <given-names>K-H</given-names></string-name>, <string-name><surname>Selenko</surname>, <given-names>P</given-names></string-name>, <string-name><surname>Dunker</surname>, <given-names>AK</given-names></string-name>, <string-name><surname>Daughdrill</surname>, <given-names>GW</given-names></string-name>, and <string-name><surname>Uversky</surname>, <given-names>VN</given-names></string-name>. <year>2013</year>. <article-title>The alphabet of intrinsic disorder</article-title>. <source>Intrinsically Disordered Proteins</source> <volume>1</volume>:<fpage>e24360</fpage>.</mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><string-name><surname>Urrutia</surname>, <given-names>AO</given-names></string-name>, and <string-name><surname>Hurst</surname>, <given-names>LD</given-names></string-name>. <year>2001</year>. <article-title>Codon Usage Bias Covaries With Expression Breadth and the Rate of Synonymous Evolution in Humans, but This Is Not Evidence for Selection</article-title>. <source>Genetics</source> <volume>159</volume>:<fpage>1191</fpage>–<lpage>1199</lpage>.</mixed-citation></ref>
<ref id="c70"><mixed-citation publication-type="journal"><string-name><surname>Vavouri</surname>, <given-names>T</given-names></string-name>, <string-name><surname>Semple</surname>, <given-names>JI</given-names></string-name>, <string-name><surname>Garcia-Verdugo</surname>, <given-names>R</given-names></string-name>, and <string-name><surname>Lehner</surname>, <given-names>B.</given-names></string-name> <year>2009</year>. <article-title>Intrinsic Protein Disorder and Interaction Promiscuity Are Widely Associated with Dosage Sensitivity</article-title>. <source>Cell</source> <volume>138</volume>:<fpage>198</fpage>–<lpage>208</lpage>.</mixed-citation></ref>
<ref id="c71"><mixed-citation publication-type="journal"><string-name><surname>Vicario</surname>, <given-names>S</given-names></string-name>, <string-name><surname>Moriyama</surname>, <given-names>EN</given-names></string-name>, and <string-name><surname>Powell</surname>, <given-names>JR</given-names></string-name>. <year>2007</year>. <article-title>Codon usage in twelve species of Drosophila</article-title>. <source>BMC Evolutionary Biology</source> <volume>7</volume>:<fpage>226</fpage>.</mixed-citation></ref>
<ref id="c72"><mixed-citation publication-type="journal"><string-name><surname>Wangen</surname>, <given-names>JR</given-names></string-name>, and <string-name><surname>Green</surname>, <given-names>R.</given-names></string-name> <year>2020</year>. <article-title>Stop codon context influences genome-wide stimulation of termination codon readthrough by aminoglycosides</article-title>. <source>eLife</source> <volume>9</volume>:<fpage>e52611</fpage>.</mixed-citation></ref>
<ref id="c73"><mixed-citation publication-type="journal"><string-name><surname>Wright</surname>, <given-names>F.</given-names></string-name> <year>1990</year>. <article-title>The ‘effective number of codons’ used in a gene</article-title>. <source>Gene</source> <volume>87</volume>:<fpage>23</fpage>–<lpage>29</lpage>.</mixed-citation></ref>
<ref id="c74"><mixed-citation publication-type="journal"><string-name><surname>Xue</surname>, <given-names>B</given-names></string-name>, <string-name><surname>Dunker</surname>, <given-names>AK</given-names></string-name>, and <string-name><surname>Uversky</surname>, <given-names>VN</given-names></string-name>. <year>2012</year>. <article-title>Orderly order in protein intrinsic disorder distribution: disorder in 3500 proteomes from viruses and the three domains of life</article-title>. <source>Journal of Biomolecular Structure and Dynamics</source> <volume>30</volume>:<fpage>137</fpage>–<lpage>149</lpage>.</mixed-citation></ref>
<ref id="c75"><mixed-citation publication-type="journal"><string-name><surname>Zhang</surname>, <given-names>Z</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>J</given-names></string-name>, <string-name><surname>Cui</surname>, <given-names>P</given-names></string-name>, <string-name><surname>Ding</surname>, <given-names>F</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>A</given-names></string-name>, <string-name><surname>Townsend</surname>, <given-names>JP</given-names></string-name>, and <string-name><surname>Yu</surname>, <given-names>J.</given-names></string-name> <year>2012</year>. <article-title>Codon Deviation Coefficient: a novel measure for estimating codon usage bias and its statistical significance</article-title>. <source>BMC Bioinformatics</source> <volume>13</volume>:<fpage>43</fpage>.</mixed-citation></ref>
</ref-list>
<sec>
<fig id="figS1" position="float" fig-type="figure">
<label>Supplementary Figure 1:</label>
<caption><p>Codon Adaptation Index is not appropriate for species-wide effectiveness of selection measurements. Each CAI value shown is averaged over an entire species’ proteome. A) The value of CAI is driven by its normalizing denominator term, CAI<sub>max</sub>. B) As a result, CAI is inversely proportional to CAIS. Each datapoint is one of 118 vertebrate species with “Complete” intergenic genomic sequence available (allowing for %GC correction) and TimeTree divergence dates (allowing for PIC correction). P-values shown are for Pearson’s correlation.</p></caption>
<graphic xlink:href="530449v2_figS1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS2" position="float" fig-type="figure">
<label>Supplementary Figure 2:</label>
<caption><p>The same relationships are shown as in <xref rid="fig3" ref-type="fig">Figure 3</xref>, here without correction for phylogenetic confounding. CAI and ENC both corelate with genomic GC, but CAIS does not. Red line shows lm(y∼x), with grey region as 95% confidence interval. We use PIC corrected results rather than these results because PIC correction removes non-independent errors to produce an unbiased R<sup>2</sup> estimate (<xref ref-type="bibr" rid="c58">Rohlf 2006</xref>).</p></caption>
<graphic xlink:href="530449v2_figS2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS3" position="float" fig-type="figure">
<label>Supplementary Figure 3:</label>
<caption><p>The same relationships are shown as in <xref rid="fig4" ref-type="fig">Figure 4</xref>, here without correction for phylogenetic confounding. As in <xref rid="fig4" ref-type="fig">Figure 4</xref>, ISD of protein domains is higher in more highly adapted species, as measured by CAIS and ENC, but not by CAIS calculated with local GC% rather than genome-wide GC%. ISD is calculated as in <xref rid="fig4" ref-type="fig">Figure 4</xref>. Red line shows lm(y∼x), with grey region as 95% confidence interval.</p></caption>
<graphic xlink:href="530449v2_figS3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS4" position="float" fig-type="figure">
<label>Supplementary Figure 4:</label>
<caption><p>Without correction for phylogenetic confounding, more highly adapted species have higher ISD in both young and old protein domains. Age assignments and ISD effects are calculated as in <xref rid="fig6" ref-type="fig">Figure 6</xref>. same n=118 datapoints are shown as in <xref rid="fig3" ref-type="fig">Figures 3</xref>-<xref rid="fig5" ref-type="fig">5</xref>. Red line shows lm(y∼x), with grey region as 95% confidence interval.</p></caption>
<graphic xlink:href="530449v2_figS4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figS5" position="float" fig-type="figure">
<label>Supplementary Figure 5:</label>
<caption><p>Vertebrate CAIS values are not greatly affected by computation for a standardized amino acid composition vs. computation for the amino acid frequencies in the species in question.</p></caption>
<graphic xlink:href="530449v2_figS5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87335.2.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ogbunugafor</surname>
<given-names>C Brandon</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Yale University</institution>
</institution-wrap>
<city>New Haven</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Useful</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study develops a <bold>useful</bold> metric for quantifying codon usage adaptation - the Codon Adaptation Index of Species (CAIS). This metric permits direct comparisons of the strength of selection at the molecular level across species. The study is based on <bold>solid</bold> evidence, and the authors identify relationships between CAIS and the presence of disordered protein domains. Other correlations, such as the one between CAIS and body size, are weak and non-significant. In summary, the study introduces an interesting new approach to quantifying codon usage across species, which may be helpful in attempts to measure selection at the molecular level.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87335.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Assessment</p>
<p>This study develops a potentially useful metric for quantifying codon usage adaptation – the Codon Adaptation Index of Species (CAIS) – that is intended to allow for more direct comparisons of the strength of selection at the molecular level across species by controlling for interspecies variation in amino acid usage and GC content. As evidence to support there claim CAIS better controls for GC content and amino acid usage across species, they note that CAIS has only a weak positive correlation with GC% (that does not stand up to multiple hypothesis testing correction) while CAI has a clear negative correlation with GC%. Using CAIS, they find better adapted species have more disordered protein domains; however, excitement about these findings is dampened due to (1) this result is also observed using the effective number of codons (ENC) and</p>
<p>(2) concerns over the interpretation of CAIS as a proxy for the effectiveness of selection.</p>
<p>Public Review</p>
<p>Summary</p>
<p>The goal of the authors in this study is to develop a more reliable approach for quantifying codon usage such that it is more comparable across species. Specifically, the authors wish to estimate the degree of adaptive codon usage, which is potentially a general proxy for the strength of selection at the molecular level. To this end, the authors created the Codon Adaptation Index for Species (CAIS) that attempts to control for differences in amino acid usage and GC% across species. Using their new metric, the authors observe a positive relationship between CAIS and the overall “disorderedness” of a species protein domains. I think CAIS has the potential to be a valuable tool for those interested in comparing codon adaptation across species in certain situations. However, I have certain theoretical concerns about CAIS as a direct proxy for the efficiency of selection sNe when mutation bias changes across species.</p>
<p>Strengths</p>
<p>(1) I appreciate that the authors recognize the potential issues of comparing CAI when amino acid usage varies and correct for this in CAIS. I think this is sometimes an under-appreciated point in the codon usage literature, as CAI is a relative measure of codon usage bias (i.e. only considers synonyms). However, the strength of natural selection on codon usage can potentially vary across amino acids, such that comparing mean CAI between protein regions with different amino acid biases may result in spurious signals of statistical significance.</p>
<p>(2) The CAIS metric presented here is generally applicable to any species that has an annotated genome with protein-coding sequences. A significant improvement over the previous version is the implementation of software tool for applying this method.</p>
<p>(3) The authors do a better job of putting their results in the context of the underlying theory of CAIS compared to the previous version.</p>
<p>(4) The paper is generally well-written.</p>
<p>Weaknesses</p>
<p>(1) The previously observed correlation between CAIS and body size was due to a bug when calculating phylogenetic independent contrasts. I commend the authors for acknowledging this mistake and updating the manuscript accordingly. I feel that the unobserved correlation between CAIS and body size should remain in the final version of the manuscript. Although it is disappointing that it is not statistically significant, the corrected results are consistent with previous findings (Kessler and Dean 2014).</p>
<p>(2) I appreciate the authors for providing a more detailed explanation of the theoretical basis model. However, I remain skeptical that shifts in CAIS across species indicates shifts in the strength of selection. I am leaving the math from my previous review here for completeness.</p>
<p>As in my previous review, let’s take a closer look at the ratio of observed codon frequencies vs. expected codon frequencies under mutation alone, which was previously notated as RSCUS in the original formulation. In this review, I will keep using the RSCUS notation, even though it has been dropped from the updated version. The key point is this is the ratio of observed and expected codon frequencies. If this ratio is 1 for all codons, then CAIS would be 0 based on equation 7 in the manuscript – consistent with the complete absence of selection on codon usage. From here on out, subscripts will only be used to denote the codon and it will be assumed that we are only considering the case of r = genome for some species s.</p>
<disp-formula id="sa1equ1">
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-equ1.jpg" mimetype="image"/>
</disp-formula>
<p>I think what the authors are attempting to do is “divide out” the effects of mutation bias (as given by Ei), such that only the effects of natural selection remain, i.e. deviations from the expected frequency based on mutation bias alone represents adaptive codon usage. Consider Gilchrist et al. GBE 2015, which says that the expected frequency of codon i at selection-mutation-drift equilibrium in gene g for an amino acid with Na synonymous codons is</p>
<disp-formula id="sa1equ2">
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-equ2.jpg" mimetype="image"/>
</disp-formula>
<p>where ∆M is the mutation bias, ∆η is the strength of selection scaled by the strength of drift, and φg is the gene expression level of gene g. In this case, ∆M and ∆η reflect the strength and direction of mutation bias and natural selection relative to a reference codon, for which ∆M,∆η = 0. Assuming the selection-mutation-drift equilibrium model is generally adequate to model of the true codon usage patterns in a genome (as I do and I think the authors do, too), the Ei,g could be considered the expected observed frequency codon i in gene g</p>
<p>E[Oi,g].</p>
<p>Let’s re-write the <inline-formula id="sa1equ3"><inline-graphic xlink:href="elife-87335-sa1-equ3.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>  in the form of Gilchrist et al., such that it is a function of mutation bias ∆M. For simplicity we will consider just the two codon case and assume the amino acid sequence is fixed. Assuming GC% is at equilibrium, the term gr and 1 − gr can be written as</p>
<disp-formula id="sa1equ4">
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-equ4.jpg" mimetype="image"/>
</disp-formula>
<p>where µx→y is the mutation rate from nucleotides x to y. As described in Gilchrist et al. MBE 2015 and Shah and Gilchrist PNAS 2011, the mutation bias <inline-formula id="sa1equ5"><inline-graphic xlink:href="elife-87335-sa1-equ5.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. This can be expressed in terms of the equilibrium GC content by recognizing that</p>
<disp-formula id="sa1equ6">
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-equ6.jpg" mimetype="image"/>
</disp-formula>
<p>As we are assuming the amino acid sequence is fixed, the probability of observing a synonymous codon i at an amino acid becomes just a Bernoulli process.</p>
<disp-formula id="sa1equ7">
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-equ7.jpg" mimetype="image"/>
</disp-formula>
<p>If we do this, then</p>
<disp-formula id="sa1equ8">
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-equ8.jpg" mimetype="image"/>
</disp-formula>
<p>Recall that in the Gilchrist et al. framework, the reference codon has ∆MNNG,NNG = 0 =⇒ e−∆MNNG,NNG =</p>
<p>(1) Thus, we have recovered the Gilchrist et al. model from the formulation of Ei under the assumption that natural selection has no impact on codon usage and codon NNG is the pre-defined reference codon. To see this, plug in 0 for ∆η in equation (1).</p>
<p>We can then calculate the expected RSCUS using equation (1) (using notation E[Oi]) and equation (6) for the two codon case. For simplicity assume, we are only considering a gene of average expression (defined as <inline-formula id="sa1equ9"><inline-graphic xlink:href="elife-87335-sa1-equ9.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>). Assume in this case that NNG is the reference codon (∆MNNG,∆ηNNG = 0).</p>
<disp-formula id="sa1equ10">
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-equ10.jpg" mimetype="image"/>
</disp-formula>
<p>This shows that the expected value of RSCUS for a two codon amino acid is expected to increase as the strength of selection ∆η increases, which is desired. Note that ∆η in Gilchrist et al. is formulated in terms of selection against a codon relative to the reference, such that a negative value represents that a codon is favored relative to the reference. If ∆η = 0 (i.e. selection does not favor either codon), then E[RSCUS] = 1. Also note that the expected RSCUS does not remain independent of the mutation bias. This means that even if sNe (i.e. the strength of natural selection) does not change between species, changes to the strength and direction of mutation bias across species could impact RSCUS. Assuming my math is right, I think one needs to be cautious when interpreting CAIS as representative of the differences in the efficiency of selection across species except under very particular circumstances.</p>
<p>Consider our 2-codon amino acid scenario. You can see how changing GC content without changing selection can alter the CAIS values calculated from these two codons. Particularly problematic appears to be cases of extreme mutation biases, where CAIS tends toward 0 even for higher absolute values of the selection parameter. Codon usage for the majority of the genome will be primarily determined by mutation biases,</p>
<p>with selection being generally strongest in a relatively few highly-expressed genes. Strong enough mutation biases ultimately can overwhelm selection, even in highly-expressed genes, reducing the fraction of sites subject to codon adaptation.</p>
<fig id="sa1fig1">
<label>Peer review image 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-fig1.jpg" mimetype="image"/>
</fig>
<fig id="sa1fig2">
<label>Peer review image 2.</label>
<caption>
<title>CAIS (Low Expression)</title>
</caption>
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-fig2.jpg" mimetype="image"/>
</fig>
<fig id="sa1fig3">
<label>Peer review image 3.</label>
<caption>
<title>CAIS (Average Expression)</title>
</caption>
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-fig3.jpg" mimetype="image"/>
</fig>
<fig id="sa1fig4">
<label>Peer review image 4.</label>
<caption>
<title>CAIS (High Expression)</title>
</caption>
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa1-fig4.jpg" mimetype="image"/>
</fig>
<p>If we treat the expected codon frequencies as genome-wide frequencies, then we are basically assuming this genome made up entirely of a single 2-codon amino acid with selection on codon usage being uniform across all genes. This is obviously not true, but I think it shows some of the potential limitations of the CAIS approach. Based on these simulations, CAIS seems best employed under specific scenarios. One such case could be when it is known that mutation bias varies little across the species of interest. Looking at the species used in this manuscript, most of them have a GC content around 0.41, so I suspect their results are okay (assuming things like GC-biased gene conversion are not an issue). Outliers in GC content probably are best excluded from the analysis.</p>
<p>Although I have not done so, I am sure this could be extended to the 4 and 6 codon amino acids. One potential challenge to CAIS is the non-monotonic changes in codon frequencies observed in some species (again, see Shah and Gilchrist 2011 and Gilchrist et al. 2015).</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87335.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Weibel</surname>
<given-names>Catherine A</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1837-5209</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Wheeler</surname>
<given-names>Andrew L</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5347-5419</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>James</surname>
<given-names>Jennifer E</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0518-6783</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Willis</surname>
<given-names>Sara M</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-1605-6426</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>McShea</surname>
<given-names>Hanon</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-9341-4899</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Masel</surname>
<given-names>Joanna</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7398-2127</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<p>In addition to our responses to reviewer suggestions below, a minor bug in the calculation of CAIS was brought to our attention by a reader of our preprint. We have corrected this bug and rerun analyses, whose results became slightly stronger as noise was removed. While we were doing that, someone pointed out to us that our equations were almost the same as Kullback-Leibler divergence, which explains why our metric performed so well. We have made the numerically trivial (see before vs. after figure below) mathematical change to use Kullback-Leibler divergence instead, and now have a better story, with a solid basis in information theory, as to why CAIS works.</p>
<fig id="sa2fig1">
<label>Author response image 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-87335-sa2-fig1.jpg" mimetype="image"/>
</fig>
<p>Unfortunately, we discovered a second bug that caused our PIC correction code to fail to perform the needed correction for phylogenetic confounding. The previously reported correlation between CAIS (or ENC) with body mass no longer survives PIC-correction. We have therefore removed this analysis from the manuscript. Our story now stands more on the theoretical basis of CAIS and ENC than on the post facto validation than it previously did. We now also present CAIS and ENC on a more equal footing. ENC results are slightly stronger, while CAIS has the complementary advantage of correcting for amino acid frequencies.</p>
<p>The work involved in these changes, as well as some of the responses to reviews below, justifies changing the second author into a co-first author, and adding an additional coauthor (Hanon McShea) who discovered the second bug.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>In this manuscript, the authors propose a new codon adaptation metric, Codon Adaptation Index of Species (CAIS), which they present as an easily obtainable proxy for effective population size. To permit between-species comparisons, they control for both amino acid frequencies and genomic GC content, which distinguishes their approach from existing ones. Having confirmed that CAIS negatively correlates with vertebrate body mass, as would be expected if small-bodied species with larger effective populations experience more efficient selection on codon usage, they then examine the relationship between CAIS and intrinsic structural disorder in proteins.</p>
<p>The idea of a robust species-level measure of codon adaptation is interesting. If CAIS is indeed a reliable proxy for the effectiveness of selection, it could be useful to analyze species without reliable life history- or mutation rate data (which will apply to many of the genomes becoming available in the near future).</p>
<p>A key question is whether CAIS, in fact, measures adaptation at the codon level. Unfortunately, CAIS is only validated indirectly by confirming a negative correlation with body mass. As a result, the observations about structural disorder are difficult to evaluate.</p>
</disp-quote>
<p>As discussed in the preamble above, we have replaced the body mass validation with a stronger theoretical basis in information theory.</p>
<disp-quote content-type="editor-comment">
<p>A potential problem is that differences in GC between species are not independent of life history. Effective population size can drive compositional differences due to the effects of GC-biased gene conversion (gBGC). As noted by Galtier et al. (2018), genomic GC correlates negatively with body mass in mammals and birds. It would therefore be important to examine how gBGC might affect CAIS, and to what extent it could explain the relationship between CAIS and body mass.</p>
<p>Suppose that gBGC drives an increase in GC that is most pronounced at 3rd codon positions in highrecombination regions in small-bodied species. In this case, could observed codon usage depart more strongly from expectations calculated from overall genomic GC in small vertebrates compared to large ones? The authors also report that correcting for local intergenic GC was unsuccessful, based on the lack of a significant negative relationship with body mass (Figure 3D). In principle, this could also be consistent with local GC providing a relatively more appropriate baseline in regions with high recombination rates. Considering these scenarios would clarify what exactly CAIS is capturing.</p>
</disp-quote>
<p>Figure 3 (previously Supplementary Figures S5A and S5B) shows that CAIS is negligibly correlated with %GC (not robust to multiple comparisons correction), and ENC not at all. We believe this is evidence against the possibility brought up by the reviewer, i.e. that Ne might affect gBGC (and hence global %GC). This relationship, if present, could act as a confounding effect, but it is not present within our species dataset.</p>
<p>Note that we expect our genomic-GC-based codon usage expectations to reflect unchecked gBGC in an average genomic region, independently of whether that species has high or low Ne. Our working model is that non-selective forces, include gBGC as well as conventional mutation biases, vary among species, and that they rather than selection determine each species’ genome-wide %GC. By correcting for genome-wide %GC, CAIS and ENC correct for both mutation bias and gBGC, in order to isolate the effects of selection.</p>
<p>This argument, based on an average genomic region, is vulnerable to gene-rich genomic regions having differentially higher recombination rates and hence GC-biased gene conversion. However, we do not see the expected positive correlation between |𝐥𝐨𝐜𝐚𝐥 𝐆𝐂 - global GC| and CAIS (see new Figure 5), again suggesting that gene conversion strength is not a confounding factor acting on CAIS.</p>
<disp-quote content-type="editor-comment">
<p>Given claims about &quot;exquisitely adapted species&quot;, the case for using CAIS as a measure of codon adaptation would also be stronger if a relationship with gene expression could be demonstrated. RSCU is expected to be higher in highly expressed genes. Is there any evidence that the equivalent GCcontrolled measure behaves similarly?</p>
</disp-quote>
<p>Correlations with gene expression are outside the scope of the current work, which is focused on producing and exploiting a single value of codon adaptation per species. It is indeed possible that our general approach of using Kullback-Leibler divergence to correct for genomic %GC could be useful in future work investigating differences among genes.</p>
<disp-quote content-type="editor-comment">
<p>The manuscript is overall easy to follow, though some additional context may be helpful for the general reader. A more detailed discussion of how this work compares to the approach taken by Galtier et al. (2018), which accounted for GC content and gBGC when examining codon preferences, would be appropriate, for example. In addition, it would have been useful to mention past work that has attempted to explicitly quantify selection on codon usage.</p>
</disp-quote>
<p>One key difference between our work and that of Galtier et al. 2018 is that our approach does not rely on identifying specific codon preferences as a function of species. Our approach might therefore be robust to scenarios where different genes have different codon preferences (see Gingold et al. 2014 <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1016/j.cell.2014.08.011">https://doi.org/10.1016/j.cell.2014.08.011</ext-link>). At a high level, our results are in broad agreement with those of Galtier et al., 2018, who found that gBGC affected all animal species, regardless of Ne, and who like us, found that the degree of selection on codon usage depended on Ne.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>## Summary</p>
<p>The goal of the authors in this study is to develop a more reliable approach for quantifying codon usage such that it is more comparable across species. Specifically, the authors wish to estimate the degree of adaptive codon usage, which is potentially a general proxy for the strength of selection at the molecular level. To this end, the authors created the Codon Adaptation Index for Species (CAIS) that controls for differences in amino acid usage and GC% across species. Using their new metric, the authors find a previously unobserved negative correlation between the overall adaptiveness of codon usage and body size across 118 vertebrates. As body size is negatively correlated with effective population size and thus the general strength of natural selection, the negative correlation between CAIS and body size is expected. The authors argue this was previously unobserved due to failures of other popular metrics such as Codon Adaptation Index (CAI) and the Effective Number of Codons (ENC) to adequately control for differences in amino acid usage and GC content across species. Most surprisingly, the authors also find a positive relationship between CAIS and the overall &quot;disorderedness&quot; of a species protein domains. As some of these results are unexpected, which is acknowledged by the authors, I think it would be particularly beneficial to work with some simulated datasets. I think CAIS has the potential to be a valuable tool for those interested in comparing codon adaptation across species in certain situations. However, I have certain theoretical concerns about CAIS as a direct proxy for the efficiency of selection $sN_e$ when the mutation bias changes across species.</p>
<p>## Strengths</p>
<p>(1) I appreciate that the authors recognize the potential issues of comparing CAI when amino acid usage varies and correct for this in CAIS. I think this is sometimes an under-appreciated point in the codon usage literature, as CAI is a relative measure of codon usage bias (i.e. only considers synonyms). However, the strength of natural selection on codon usage can potentially vary across amino acids, such that comparing mean CAI between protein regions with different amino acid biases may result in spurious signals of statistical significance (see Cope et al. Biochemica et Biophysica Acta - Biomembranes 2018 for a clear example of this).</p>
</disp-quote>
<p>We now cite Cope et al. as an example of how amino acid composition can act as a confounding factor.</p>
<disp-quote content-type="editor-comment">
<p>(2) The authors present numerous analysis using both ENC and mean CAI as a comparison to CAIS, helping given a sense of how CAIS corrects for some of the issues with these other metrics. I also enjoyed that they examined the previously unobserved relationship between codon usage bias and body size, which has bugged me ever since I saw Kessler and Dean 2014. The result comparing protein disorder to CAIS was particularly interesting and unexpected.</p>
</disp-quote>
<p>Unfortunately, our previous PIC correction code was buggy, and in fact the relationship with body size does not survive PIC correction (although it is strong prior to PIC correction). We have therefore removed it from the paper. However, the more novel result on protein disorder remains strong.</p>
<disp-quote content-type="editor-comment">
<p>(3) The CAIS metric presented here is generally applicable to any species that has an annotated genome with protein-coding sequences.</p>
<p>## Weaknesses</p>
<p>(1) The main weakness of this work is that it lacks simulated data to confirm that it works as expected. This would be particularly useful for assessing the relationship between CAIS and the overall effect of protein structure disorder, which the authors acknowledge is an unexpected result. I think simulations could also allow the authors to assess how their metric performs in situations where mutation bias and natural selection act in the same direction vs. opposite directions. Additionally, although I appreciate their comparisons to ENC and mean CAI, the lack of comparison to other popular codon metrics for calculating the overall adaptiveness of a genome (e.g. dos Reis et al.'s $S$ statistic, which is a function of tRNA Adaptation Index (tAI) and ENC) may be more appropriate. Even if results are similar to $S$, CAIS has a noted advantage that it doesn't require identifying tRNA gene copy numbers or abundances, which I think are generally less readily available than genomic GC% and protein-coding sequences.</p>
</disp-quote>
<p>The main limitation of dos Reis’s test in our view is that, like the better versions of CAI, it requires comparable orthologs across species. See also the discussion below re the benefits of proteome-wide approach. We now also note the advantage of not needing tRNA gene copy numbers and abundances.</p>
<p>Simulated datasets would be great, but we think it a nice addition rather than must-have, in particular because we are skeptical about whether our understanding of all relevant processes is good enough such that simulations would add much to our more heuristic argument along the lines of Figure 2. E.g. the complications of Gingold et al. 2014 cited above are pertinent, but incorporating them would make simulations quite involved. Instead, we now have a stronger theoretical justification for CAIS grounded in information theory. We have significantly expanded discussion of Figure 2 to give a clearer idea of the conceptual underpinnings of CAIS and ENC.</p>
<disp-quote content-type="editor-comment">
<p>The authors mention the selection-mutation-drift equilibrium model, which underlies the basic ideas of this work (e.g. higher $N_e$ results in stronger selection on codon usage), but a more in-depth framing of CAIS in terms of this model is not given. I think this could be valuable, particularly in addressing the question &quot;are we really estimating what we think we're estimating?&quot;</p>
<p>Let's take a closer look at the formulation for RSCUS. From here on out, subscripts will only be used to denote the codon and it will be assumed that we are only considering the case of r = genome for some species s.</p>
<p><inline-graphic xlink:href="elife-87335-inf1.jpg" mimetype="image" mime-subtype="jpeg"/></p>
<p>I think what the authors are attempting to do is &quot;divide out&quot; the effects of mutation bias (as given by $E_i$), such that only the effects of natural selection remain, i.e. deviations from the expected frequency based on mutation bias alone represent adaptive codon usage. Consider Gilchrist et al. MBE 2015, which says that the expected frequency of codon i at selection-mutation-drift equilibrium in gene g for an amino acid with Na synonymous codons is</p>
<p><inline-graphic xlink:href="elife-87335-inf2.jpg" mimetype="image" mime-subtype="jpeg"/></p>
<p>where ∆M is the mutation bias, ∆η is the strength of selection scaled by the strength of drift, and φg is the gene expression level of gene g. In this case, ∆M and ∆η reflect the strength and direction of mutation bias and natural selection relative to a reference codon, for which ∆M,∆η = 0. Assuming the selection-mutation-drift equilibrium model is generally adequate to model of the true codon usage patterns in a genome (as I do and I think the authors do, too), the Ei,g could be considered the expected observed frequency codon i in gene g</p>
<p>E[Oi,g].</p>
<p>Let’s re-write the <inline-graphic xlink:href="elife-87335-inf3.jpg" mimetype="image" mime-subtype="jpeg"/>  in the form of Gilchrist et al., such that it is a function of mutation bias ∆M. For simplicity we will consider just the two codon case and assume the amino acid sequence is fixed. Assuming GC% is at equilibrium, the term gr and 1 − gr can be written as</p>
<p><inline-graphic xlink:href="elife-87335-inf4.jpg" mimetype="image" mime-subtype="jpeg"/></p>
<p>where µx→y is the mutation rate from nucleotides x to y. As described in Gilchrist et al. MBE 2015 and Shah and Gilchrist PNAS 2011, the mutation bias <inline-graphic xlink:href="elife-87335-inf5.jpg" mimetype="image" mime-subtype="jpeg"/> .This can be expressed in terms of the equilibrium GC content by recognizing that</p>
<p><inline-graphic xlink:href="elife-87335-inf6.jpg" mimetype="image" mime-subtype="jpeg"/></p>
<p>As we are assuming the amino acid sequence is fixed, the probability of observing a synonymous codon i at an amino acid becomes just a Bernoulli process.</p>
<p><inline-graphic xlink:href="elife-87335-inf7.jpg" mimetype="image" mime-subtype="jpeg"/></p>
<p>If we do this, then</p>
<p><inline-graphic xlink:href="elife-87335-inf8.jpg" mimetype="image" mime-subtype="jpeg"/></p>
<p>Recall that in the Gilchrist et al. framework, the reference codon has ∆MNNG,NNG = 0 =⇒ e−∆MNNG,NNG =1. Thus, we have recovered the Gilchrist et al. model from the formulation of $E_i$ under the assumption that natural selection has no impact on codon usage and codon NNG is the pre-defined reference codon. To see this, plug in 0 for ∆η in equation (1)..</p>
<p>We can then calculate the expected RSCUS using equation (1) (using notation E[Oi]) and equation (6) for the two codon case. For simplicity assume, we are only considering a gene of average expression (defined as <inline-graphic xlink:href="elife-87335-inf9.jpg" mimetype="image" mime-subtype="jpeg"/>). Assume in this case that NNG is the reference codon (∆MNNG,∆ηNNG = 0).</p>
<p><inline-graphic xlink:href="elife-87335-inf10.jpg" mimetype="image" mime-subtype="jpeg"/></p>
<p>This shows that the expected value of RSCUS for a two-codon amino acid is expected to increase as the strength of selection $\Delta\eta$ increases, which is desired. Note that $\Delta\eta$ in Gilchrist et al. is formulated in terms of selection *against* a codon relative to the reference, such that a negative value represents that a codon is favored relative to the reference. If $\Delta\eta = 0$ (i.e. selection does not favor either codon), then $E[RSCUS] = 1$. Also note that the expected RSCUS does not remain independent of the mutation bias. This means that even if $sN_e$ (i.e. the strength of natural selection) does not change between species, changes to the strength and direction of mutation bias across species could impact RSCUS. Assuming my math is right, I think one needs to be cautious when interpreting CAIS as representative of the differences in the efficiency of selection across species except under very particular circumstances. One such case could be when it is known that mutation bias varies little across the species of interest. Looking at the species used in this manuscript, most of them have a GC content ranging around 0.41, so I suspect their results are okay.</p>
<p>Although I have not done so, I am sure this could be extended to the 4 and 6 codon amino acids.</p>
</disp-quote>
<p>We thank Reviewer 2 for explicitly laying out the math that was implicit in our Figures 1 and 2. While we keep our more heuristic presentation, our revised manuscript now more clearly acknowledges that the per-site codon adaptation bias depicted in Figure 1 has limited sensitivity to s*Ne. The reason that we believe our approach worked despite this, is that we think the phenomenon is driven by what is shown in Figure 2. I.e., where Ne makes a difference is by determining the proteome-wide fraction of codons subject to significant codon adaptation, rather than by determining the strength of codon adaptation at any particular site or gene. We have made multiple changes to the texts to make this point clearer.</p>
<disp-quote content-type="editor-comment">
<p>Another minor weakness of this work is that although the method is generally applicable to any species with an annotated genome and the code is publicly available, the code itself contains hard-coded values for GC% and amino acid frequencies across the 118 vertebrates. The lack of a more flexible tool may make it difficult for less computationally-experienced researchers to take advantage of this method.</p>
</disp-quote>
<p>Genome-wide %GC values are hard-coded because they were taken from the previous study of James et al. (2023) <ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1093/molbev/msad073">https://doi.org/10.1093/molbev/msad073</ext-link>. As summarized in the manuscript, genome-wide %GC was a byproduct of a scan of all six reading frames across genic and intergenic sequences available from NCBI with access dates between May and July 2019. The more complicated code used to calculate the intergenic %GC, and the code used to calculate amino acid frequencies is located at <ext-link ext-link-type="uri" xlink:href="https://github.com/MaselLab/CodonAdaptation-Index-of-Species">https://github.com/MaselLab/CodonAdaptation-Index-of-Species</ext-link>. Luckily, someone else just wrote a simpler end to end pipeline for us, on the basis of our preprint. We now note this in the Acknowledgements, and link to it: <ext-link ext-link-type="uri" xlink:href="https://github.com/gavinmdouglas/handy_pop_gen/blob/main/CAIS.py">https://github.com/gavinmdouglas/handy_pop_gen/blob/main/CAIS.py</ext-link>.</p>
</body>
</sub-article>
</article>