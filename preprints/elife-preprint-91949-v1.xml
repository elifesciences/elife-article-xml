<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">91949</article-id>
<article-id pub-id-type="doi">10.7554/eLife.91949</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.91949.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.1</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>osl-dynamics: A toolbox for modelling fast dynamic brain activity</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-0888-1207</contrib-id>
<name>
<surname>Gohil</surname>
<given-names>C.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Huang</surname>
<given-names>R.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Roberts</surname>
<given-names>E.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-7133-509X</contrib-id>
<name>
<surname>van Es</surname>
<given-names>M.W.J.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Quinn</surname>
<given-names>A.J.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Vidaurre</surname>
<given-names>D.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Woolrich</surname>
<given-names>M.W.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Oxford Centre for Human Brain Activity, Wellcome Centre for Integrative Neuroimaging, Department of Psychiatry, University of Oxford</institution>, <country>United Kingdom</country></aff>
<aff id="a2"><label>2</label><institution>Centre for Human Brain Health, School of Psychology, University of Birmingham</institution>, <country>United Kingdom</country></aff>
<aff id="a3"><label>3</label><institution>Center for Functionally Integrative Neuroscience, Department of Clinical Medicine, Aarhus University</institution>, <country>Denmark</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Ray</surname>
<given-names>Supratim</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Indian Institute of Science Bangalore</institution>
</institution-wrap>
<city>Bengaluru</city>
<country>India</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>de Lange</surname>
<given-names>Floris P</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Donders Institute for Brain, Cognition and Behaviour</institution>
</institution-wrap>
<city>Nijmegen</city>
<country>Netherlands</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label> Corresponding author; email: <email>chetan.gohil@psych.ox.ac.uk</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-11-09">
<day>09</day>
<month>11</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP91949</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-09-14">
<day>14</day>
<month>09</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-08-08">
<day>08</day>
<month>08</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.08.07.549346"/>
</event>
</pub-history>
<permissions>
<copyright-statement>Â© 2023, Gohil et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Gohil et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-91949-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>Neural activity contains rich spatio-temporal structure that corresponds to cognition. This includes oscillatory bursting and dynamic activity that span across networks of brain regions, all of which can occur on timescales of a tens of milliseconds. While these processes can be accessed through brain recordings and imaging, modelling them presents methodological challenges due to their fast and transient nature. Furthermore, the exact timing and duration of interesting cognitive events is often a priori unknown. Here we present the OHBA Software Library Dynamics Toolbox (<monospace>osl-dynamics</monospace>), a Python-based package that can identify and describe recurrent dynamics in functional neuroimaging data on timescales as fast as tens of milliseconds. At its core are machine learning generative models that are able to adapt to the data and learn the timing, as well as the spatial and spectral characteristics, of brain activity with few assumptions. <monospace>osl-dynamics</monospace> incorporates state-of-the-art approaches that can be, and have been, used to elucidate brain dynamics in a wide range of data types, including magneto/electroencephalography, functional magnetic resonance imaging, invasive local field potential recordings and electrocorticography. It also provides novel summary measures of brain dynamics that can be used to inform our understanding of cognition, behaviour and disease. We hope <monospace>osl-dynamics</monospace> will further our understanding of brain function, through its ability to enhance the modelling of fast dynamic processes.</p>
</abstract>
<abstract>
<title>Highlights</title>
<list list-type="bullet">
<list-item><p>An open-source toolbox for identify and describing brain dynamics in neuroimaging data on fast timescales.</p></list-item>
<list-item><p>Includes visualisation and quantification of oscillatory bursting and network dynamics.</p></list-item>
<list-item><p>Provides novel summary measures and group analysis tools of brain dynamics that can be used to inform our understanding of cognition, behaviour and disease.</p></list-item>
<list-item><p>Implemented in Python and makes use of <monospace>TensorFlow</monospace>.</p></list-item>
<list-item><p>Includes comprehensive documentation and tutorials.</p></list-item>
</list>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
</notes>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>There is growing evidence for the importance of oscillatory activity in brain function [<xref ref-type="bibr" rid="c1">1</xref>]. Neural oscillations have been linked to cognitive processes, such as information encoding and processing, as well as attention [<xref ref-type="bibr" rid="c2">2</xref>] and distinct oscillatory activity has been observed in different states of consciousness [<xref ref-type="bibr" rid="c3">3</xref>]. Furthermore, the synchronisation of neural oscillations has been proposed as a mechanism for communication [<xref ref-type="bibr" rid="c4">4</xref>]. Neural oscillations have also been a useful tool for understanding brain dysfunction; for example, changes have been observed in the oscillatory activity of diseased and healthy cohorts [<xref ref-type="bibr" rid="c5">5</xref>].</p>
<p>An aspect of neural oscillations that remains to be fully understood is its dynamic nature, particularly at fast timescales [<xref ref-type="bibr" rid="c6">6</xref>]. Recently, it has been proposed that neuronal populations exhibit short <italic>bursts</italic> of oscillatory activity on timescales of 100 ms [<xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>] rather than the classical view of ongoing oscillations that are modulated in amplitude. This has important implications for how we should be modelling oscillatory activity changes in cognition and disease [<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c12">12</xref>]. Unfortunately, the methods available to detect bursts in oscillatory data are limited, often requiring arbitrary choices for parameters relating to the frequency content, amplitude and duration [<xref ref-type="bibr" rid="c13">13</xref>]. These choices can significantly impact the conclusions reached by such analyses.</p>
<p>Furthermore, oscillatory bursting is not isolated to individual brain regions. It has been shown that bursting can occur across cortical networks [<xref ref-type="bibr" rid="c9">9</xref>], and there are bursts of coherent activity in networks that lasts on the order of 50-100 ms in both resting-state [<xref ref-type="bibr" rid="c14">14</xref>] and in task [<xref ref-type="bibr" rid="c15">15</xref>]. Precise knowledge of these fast network dynamics is a valuable insight that can help us understand cognitive processes; for example, the dynamics of specific functional resting-state networks have been linked to memory replay (a â¤ 50 ms process that occurs in memory consolidation) [<xref ref-type="bibr" rid="c16">16</xref>]. Changes in the dynamics of functional networks have also been shown to be predictive of behavioural traits [<xref ref-type="bibr" rid="c17">17</xref>] and disease [<xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c19">19</xref>, <xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c22">22</xref>, <xref ref-type="bibr" rid="c23">23</xref>]. The key barrier that prevents us from fully utilising a network perspective is that the accurate estimation of dynamic functional networks is challenging. This is in part due to the timing and duration of interesting cognitive events, and the corresponding activity in functional networks, not being known. Consequently, we need to rely on methods that can adapt to the data and automatically identify when networks activate.</p>
<p>Here, we present the OHBA Software Library Dynamics Toolbox (<monospace>osl-dynamics</monospace>), a Python package that meets two far-reaching methodological challenges that limit the field of cognitive neuroscience: burst detection and the identification of dynamic functional brain networks. It does so by deploying data driven generative models that have a proven ability to adapt to the data from a wide range of imaging modalities, and can learn the spatio-temporal characteristics of brain activity, with few assumptions and at fast timescales [<xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c26">26</xref>].</p>
<p>In applications for burst detection, <monospace>osl-dynamics</monospace> can automatically detect oscillatory bursts without the need to specify the frequencies, amplitude threshold or duration of the bursts. This allows <monospace>osl-dynamics</monospace> to answer questions such as: when do oscillatory bursts occur; what is their oscillatory frequency; and what are their characteristic features (e.g. average lifetime, interval, occurrence and amplitude)?</p>
<p>In the detection of dynamic functional brain networks, <monospace>osl-dynamics</monospace> can automatically detect network dynamics at fast timescales with few assumptions. This allows <monospace>osl-dynamics</monospace> to answer questions such as: what large-scale functional networks do individuals or groups exhibit; when do these functional networks activate and what are their characteristic dynamics; what functional networks activate in response to a task; do individuals differ in their functional network activations? On top of this, <monospace>osl-dynamics</monospace> can characterise functional networks from a more conventional, static (time-averaged), perspective using the same methodology where appropriate as the dynamic methods.</p>
<p>Here, we will illustrate the use of <monospace>osl-dynamics</monospace> using publicly available magnetoencephalography (MEG) datasets. However, we emphasise that the scope of the toolbox extends well beyond MEG, containing approaches that can be used, and have been used, to elucidate network and oscillatory dynamics in a range of applications that include electroencephalography [<xref ref-type="bibr" rid="c27">27</xref>, <xref ref-type="bibr" rid="c28">28</xref>], functional magnetic resonance imaging (fMRI) [<xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c30">30</xref>], invasive local field potential recordings [<xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c29">29</xref>] and electrocorticography [<xref ref-type="bibr" rid="c31">31</xref>].</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Methods</title>
<sec id="s2a">
<label>2.1</label>
<title>Generative Models</title>
<p>In the study of dynamics, we are often interested in the properties of a time series, such as power spectral density (PSD), mean, covariance, etc., at a given time point. A common heuristic approach for calculating this is to use a sliding window. However, this approach only utilises a short window around the time point of interest and suffers from a tradeoff between the temporal precision of dynamics and an accurate estimation of the properties (via a sufficiently large window). In [<xref ref-type="bibr" rid="c32">32</xref>], it was shown that this approach is inadequate for studying fast changes in functional connectivity. In <monospace>osl-dynamics</monospace>, we adopt an alternative approach based on <italic>generative models</italic> [<xref ref-type="bibr" rid="c33">33</xref>]. These are models that learn the probability distribution of the training data. In this report, we will focus on two generative models for time series data: the Hidden Markov Model (HMM) [<xref ref-type="bibr" rid="c34">34</xref>] and Dynamic Network Modes (DyNeMo) [<xref ref-type="bibr" rid="c26">26</xref>]. Both of these models (discussed further below) incorporate an underlying dynamic latent variable in the generative process. The objective during training is to learn the most likely latent variables to have generated the observed time series (we minimise the <italic>variational free energy</italic> [<xref ref-type="bibr" rid="c35">35</xref>]). In doing this, the model can identify non-contiguous segments of the time series that share the same latent variable. Pooling this information leads to more robust estimates of the local properties of the data.</p>
<p>The generative model for the HMM (shown in <xref rid="fig1" ref-type="fig">Figure 1A</xref>) is</p>
<p>
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="549346v1_eqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>Î¸</italic><sub><italic>t</italic></sub> â {1, â¦, <italic>K</italic>} is the latent state at time <italic>t, K</italic> is the number of states and <bold><italic>x</italic></bold><sub><italic>t</italic></sub> is the generated data. <italic>p</italic>(<bold><italic>x</italic></bold><sub><italic>t</italic></sub>|<italic>Î¸</italic><sub><italic>t</italic></sub>) is the <italic>observation model</italic>. Here, we use
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="549346v1_eqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <bold><italic>Âµ</italic></bold><sub><italic>k</italic></sub> â {<bold><italic>Âµ</italic></bold><sub>1</sub>, â¦, <bold><italic>Âµ</italic></bold><sub><italic>K</italic></sub>} is a state mean and <bold><italic>D</italic></bold><sub><italic>k</italic></sub> â {<bold><italic>D</italic></bold><sub>1</sub>, â¦, <bold><italic>D</italic></bold><sub><italic>K</italic></sub>} is a state covariance. Dynamics in the time series are generated through state switching, which is characterised by the transition probability <italic>p</italic>(<italic>Î¸</italic><sub><italic>t</italic></sub>|<italic>Î¸</italic><sub><italic>tâ</italic>1</sub>). Each pairwise state transition forms the <italic>transition probability matrix</italic>, [<xref ref-type="bibr" rid="c34">34</xref>]
<disp-formula id="eqn3">
<alternatives><graphic xlink:href="549346v1_eqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<monospace>osl-dynamics</monospace> uses variational Bayesian inference [<xref ref-type="bibr" rid="c35">35</xref>] to learn the most likely state to have generated the observed data. This has the advantage of being able to account for uncertainty in the latent state. For more information regarding the implementation of the HMM in <monospace>osl-dynamics</monospace> see the documentation: <ext-link ext-link-type="uri" xlink:href="https://osl-dynamics.readthedocs.io/en/latest/models/hmm.html">https://osl-dynamics.readthedocs.io/en/latest/models/hmm.html</ext-link>. The HMM has been successfully used to study dynamics in neuroimaging data in a variety of settings [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c11">11</xref>, <xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c15">15</xref>, <xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c18">18</xref>, <xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c25">25</xref>, <xref ref-type="bibr" rid="c30">30</xref>].</p>
<p>DyNeMo is a recently proposed model that overcomes two key limitations of the HMM: the mutually exclusive states and limited memory [<xref ref-type="bibr" rid="c26">26</xref>]. The generative model for DyNeMo (shown in <xref rid="fig1" ref-type="fig">Figure 1B</xref>) is
<disp-formula id="eqn4">
<alternatives><graphic xlink:href="549346v1_eqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <bold><italic>Î¸</italic></bold><sub><italic>t</italic></sub> is a latent vector at time <italic>t</italic> (referred to as a <italic>logit</italic>) and <bold><italic>x</italic></bold><sub><italic>t</italic></sub> is the generated data. The observation model we use is
<disp-formula id="eqn5">
<alternatives><graphic xlink:href="549346v1_eqn5.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <bold><italic>Âµ</italic></bold><sub><italic>j</italic></sub> â {<bold><italic>Âµ</italic></bold><sub>1</sub>, â¦, <bold><italic>Âµ</italic></bold><sub><italic>J</italic></sub>} is a mode mean, <bold><italic>D</italic></bold><sub><italic>j</italic></sub> â{<bold><italic>D</italic></bold><sub>1</sub>, â¦, <bold><italic>D</italic></bold><sub><italic>J</italic></sub>} is a mode covariance, <italic>J</italic> is the number of modes and
<disp-formula id="eqn6">
<alternatives><graphic xlink:href="549346v1_eqn6.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
is the mixing coefficient for mode <italic>j</italic>. Dynamics in the latent vector are generated through <italic>p</italic>(<bold><italic>Î¸</italic></bold><sub><italic>t</italic></sub>|<bold><italic>Î¸</italic></bold><sub>1:<italic>tâ</italic>1</sub>), which is a distribution parameterised using a recurrent neural network [<xref ref-type="bibr" rid="c36">36</xref>]. Specifically,
<disp-formula id="eqn7">
<alternatives><graphic xlink:href="549346v1_eqn7.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>f</italic> and <italic>g</italic> are calculated using a recurrent neural network. <monospace>osl-dynamics</monospace> uses <italic>amortised</italic> variational Bayesian inference [<xref ref-type="bibr" rid="c37">37</xref>] to learn the most likely latent vector to have generated the observed data. This is a highly efficient inference scheme that is scalable to large datasets. For more information regarding the implementation of DyNeMo in <monospace>osl-dynamics</monospace> see the documentation:<ext-link ext-link-type="uri" xlink:href="https://osl-dynamics.readthedocs.io/en/latest/models/dynemo.html">https://osl-dynamics.readthedocs.io/en/latest/models/dynemo.html</ext-link>.</p>
<p>Once trained, both models reveal a dynamic latent description of the training data. For the HMM, the latent description is a hidden state time course<sup><xref ref-type="fn" rid="fn1">1</xref></sup>, which is the most likely state inferred at each time point in the training data. For DyNeMo, it is a mode time course, which is the mixing coefficient time series for each mode inferred from the training data. We will discuss in <xref ref-type="sec" rid="s2e1">Sections 2.5.1</xref> and <xref ref-type="sec" rid="s2e2">2.5.2</xref> how these latent descriptions can be used to summarise dynamics in the training data.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>Generative models implemented in osl-dynamics.</title>
<p>A) Hidden Markov Model (HMM) [<xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c25">25</xref>]. Here, data is generated using a hidden state (<italic>Î¸</italic><sub><italic>t</italic></sub>) and observation model, which in our case is a multivariate normal distribution parameterised by a state mean (<bold><italic>Âµ</italic></bold><sub><italic>k</italic></sub>) and covariance (<bold><italic>D</italic></bold><sub><italic>k</italic></sub>). Only one state can be active at a given time point. Dynamics are modelled via state switching using a transition probability matrix (<italic>A</italic><sub><italic>ij</italic></sub>), which forecasts the probability of the current state based on the previous state. B) Dynamic Network Modes (DyNeMo) [<xref ref-type="bibr" rid="c26">26</xref>]. Here, the data is generated using a linear combination of <italic>modes</italic> (<bold><italic>Âµ</italic></bold><sub><italic>j</italic></sub> and <bold><italic>D</italic></bold><sub><italic>j</italic></sub>) and dynamics are modelled using a recurrent neural network (RNN: <italic>f</italic> and <italic>g</italic>), which forecasts the probability of a particular mixing ratio (<bold><italic>Î±</italic></bold><sub><italic>t</italic></sub>) based on a long history of previous values via the underlying logits (<bold><italic>Î¸</italic></bold><sub><italic>t</italic></sub>).</p></caption>
<graphic xlink:href="549346v1_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Datasets</title>
<p>We make use of two publicly available datasets</p>
<list list-type="bullet">
<list-item><p><bold>CTF rest MEG dataset</bold>. This contains resting-state (eyes open) MEG data collected using a 275-channel CTF scanner. This dataset contains 5 minute recordings from 65 healthy participants. It was collected at Nottingham University, UK as part of the MEGUK partnership [<xref ref-type="bibr" rid="c38">38</xref>].</p></list-item>
<list-item><p><bold>Elekta task MEG dataset</bold>. This contains MEG data recorded during a visual perception task [<xref ref-type="bibr" rid="c39">39</xref>]. 6 runs from 19 healthy participants were recorded using an Elekta Neuromag Vectorview 306 scanner. This dataset was collected at Cambridge University, UK.</p></list-item>
</list>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Preprocessing and Source Reconstruction</title>
<p>The steps involved in estimating source data from an MEG recording are shown in <xref rid="fig2" ref-type="fig">Figure 2</xref>. This part of the pipeline can be performed with the OHBA Software Library (OSL) [<xref ref-type="bibr" rid="c40">40</xref>, <xref ref-type="bibr" rid="c41">41</xref>], which is a separate Python package for M/EEG analysis. The exact steps applied to the raw data for each dataset were:</p>
<list list-type="order">
<list-item><p>MaxFilter (only applied to the Elekta dataset).</p></list-item>
<list-item><p>Bandpass filter 1-125 Hz.</p></list-item>
<list-item><p>Notch filter 50 Hz and 100 Hz.</p></list-item>
<list-item><p>Downsample to 250 Hz.</p></list-item>
<list-item><p>Automated bad segment removal and bad channel detection.<sup><xref ref-type="fn" rid="fn2">2</xref></sup></p></list-item>
<list-item><p>Automated ICA cleaning using the correlation the EOG/ECG channel to select artefact components.<sup><xref ref-type="fn" rid="fn3">3</xref></sup></p></list-item>
<list-item><p>Coregistration (using polhemus headshape points/fiducials and a structural MRI).</p></list-item>
<list-item><p>Bandpass filter 1-45 Hz.</p></list-item>
<list-item><p>Linearly Constrained Minimum Variance (LCMV) beamformer.</p></list-item>
<list-item><p>Parcellate to regions of interest. In this work, we used 38 parcels<sup><xref ref-type="fn" rid="fn4">4</xref></sup>.</p></list-item>
<list-item><p>Symmetric orthogonalisation (to correct source leakage [<xref ref-type="bibr" rid="c42">42</xref>]).</p></list-item>
<list-item><p>Dipole sign flipping (to align the sign of parcel time courses across subjects/runs).<sup><xref ref-type="fn" rid="fn5">5</xref></sup></p></list-item>
<list-item><p>Downsample to 100 Hz (only included in the burst detection pipeline).</p></list-item>
</list>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Preprocessing and source reconstruction.</title>
<p>First, the sensor-level recordings are cleaned using standard signal processing techniques. This includes filtering, downsampling and artefact removal. Following this, the sensor-level recordings are used to estimate source activity using a beamformer. Finally, we parcellate the data and perform corrections (orthogonalisation and dipole sign flipping). Acronyms: electrocardiogram (ECG), electrooculogram (EOG), independent component analysis (ICA). These steps can be performed with the OHBA Software Library: <ext-link ext-link-type="uri" xlink:href="https://github.com/OHBA-analysis/osl">https://github.com/OHBA-analysis/osl</ext-link>.</p></caption>
<graphic xlink:href="549346v1_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>These preprocessing steps have been found to work well for a wide variety of datasets when studying dynamics. The scripts used for preprocessing and source reconstruction can be found here: <ext-link ext-link-type="uri" xlink:href="https://github.com/OHBA-analysis/osl-dynamics/tree/main/examples/toolbox_paper">https://github.com/OHBA-analysis/osl-dynamics/tree/main/examples/toolbox_paper</ext-link>.</p>
</sec>
<sec id="s2d">
<label>2.4</label>
<title>Data Preparation</title>
<p>We usually prepare the source data before training a model. The data preparation can be different depending on what aspect of the data we are interested in studying.</p>
<sec id="s2d1">
<title>Amplitude Envelope (AE)</title>
<p>If we are interested in studying dynamics in the amplitude of oscillations, we can train a model on AE data. Here, we typically bandpass filter a frequency range of interest and calculate an AE using the absolute value of a Hilbert transform. <xref rid="fig3" ref-type="fig">Figure 3B</xref> shows what happens when we calculate the AE of oscillatory data. We can see the AE data tracks changes in the amplitude of oscillations.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><title>Methods for preparing training data.</title>
<p>A.I) Original (simulated) time series data. Only a short segment (0.2 s) is shown. Channel 1 (2) is a modulated sine wave at 15 Hz (30 Hz) with ð©(0, 0.1) noise added. A.II) Covariance of the original data. B) Amplitude Envelope (AE) data (solid red line) and original data (dashed blue line). C.I) Time-Delay Embedded (TDE) time series. An embedding window of <italic>Â±</italic>5 lags was used. C.II) Covariance of TDE data. C.III) Spectral properties of the original data estimated using the covariance matrix of TDE data. Acronyms: Autocorrelation Function (ACF), Power Spectral Density (PSD).</p></caption>
<graphic xlink:href="549346v1_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><title>TDE-HMM burst detection pipeline.</title>
<p>This is run on a single regionâs parcel time course. Separate HMMs are trained for each region. A) Source reconstructed data is prepared by performing time-delay embedding and standardisation (z-transform). Following this an HMM is trained on the data and statistics that summarise the bursts are calculated from the inferred state time course. B) Subject-specific metrics summarising the bursts at a particular region are used in group-level analysis.</p></caption>
<graphic xlink:href="549346v1_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2d2">
<title>Time-Delay Embedding (TDE)</title>
<p>Studying the amplitude dynamics of oscillations does not reveal any insights into how different regions interact via phase synchronisation. For this, we need to prepare the data using TDE [<xref ref-type="bibr" rid="c43">43</xref>]. This augments the time series with extra channels containing time-lagged versions of the original channels. <xref rid="fig3" ref-type="fig">Figure 3C.I</xref> shows an example of this. To perform TDE, we need to specify the number of lagged channels to add (number of embeddings) and the lag to shift each additional channel by. In <monospace>osl-dynamics</monospace>, we always shift by one time point, so we only need to specify the number of lags. By adding extra channels, we embed the autocorrelation function (ACF) of the original data (as well as the cross-correlation function) into the covariance matrix of the TDE data. This is illustrated in <xref rid="fig3" ref-type="fig">Figure 3C.II</xref>. We plot the ACF taken from the TDE covariance matrix and the PSD (calculated using a Fourier transform) in <xref rid="fig3" ref-type="fig">Figure 3C.III</xref>. By using TDE data we make the covariance matrix sensitive to the frequency of oscillations in the original data. The covariance matrix is also sensitive to cross channel phase synchronisation via of the off-diagonal elements. Training on TDE data allows us to study dynamics in oscillatory amplitude and phase synchronisation between channels. When we prepare TDE data, we are normally only interested in looking for dynamics in the auto/cross correlation function via the covariance matrix, so we fix the mean to zero in the generative model.</p>
<p>For further details and example code for preparing data in <monospace>osl-dynamics</monospace> see the tutorial: <ext-link ext-link-type="uri" xlink:href="https://osl-dynamics.readthedocs.io/en/latest/tutorials_build/data_preparation.html">https://osl-dynamics.readthedocs.io/en/latest/tutorials_build/data_preparation.html</ext-link>.</p>
</sec>
</sec>
<sec id="s2e">
<label>2.5</label>
<title>First-Level and Group-Level Analysis</title>
<p>Starting from the source reconstructed data, we study a dataset with a two-stage process:</p>
<list list-type="order">
<list-item><p><bold>First-level analysis</bold>. Here, our objective is to estimate subject-specific quantities. In the static (time-averaged) analysis, we calculate these quantities directly from the source data. However, if we are doing a dynamic analysis, we first train a generative model, such as the HMM or DyNeMo<sup><xref ref-type="fn" rid="fn6">6</xref></sup>. We then use the latent description provided by this model with the source data to estimate the quantities of interest - this approach is known as <italic>dual estimation</italic><sup><xref ref-type="fn" rid="fn7">7</xref></sup> [<xref ref-type="bibr" rid="c44">44</xref>].</p></list-item>
<list-item><p><bold>Group-level analysis</bold>. Quantities estimated for individual subjects, such as network metrics or summary statistics for dynamics, are used to model a group. For example, this could be predicting behavioural traits or characteristics of individual subjects, comparing two groups, or calculating the group average of an evoked response to a task. Typically, statistical significance testing is done at the group-level to verify that any observed differences or inferred relationships are not simply due to chance.</p></list-item>
</list>
<p>We will present the results of applying five pipelines to source reconstructed data calculated from the datasets mentioned in <xref ref-type="sec" rid="s2b">Section 2.2</xref>: a burst detection pipeline based on the HMM (discussed in <xref ref-type="sec" rid="s2e1">Section 2.5.1</xref>); three dynamic network analysis pipelines based on the HMM and DyNeMo (discussed in <xref ref-type="sec" rid="s2e2">Section 2.5.2</xref>) and a static network analysis pipeline (discussed in <xref ref-type="sec" rid="s2e3">Section 2.5.3</xref>).</p>
<sec id="s2e1">
<label>2.5.1</label>
<title>Burst Detection</title>
<p>We use an approach based on the HMM to detect bursts of oscillatory activity. In this approach, we prepare the source data using TDE. A typical TDE-HMM burst detection pipeline is shown in <xref rid="fig3" ref-type="fig">Figure 3</xref>. When the HMM state time courses are inferred on the training data, each âvisitâ to a particular state corresponds to a burst, or transient spectral event, with spectral properties specific to the state (e.g. an increase in <italic>Î²</italic>-band power). This approach assumes that we are looking for bursting in a single channel (brain region) at a time; separate HMMs can be used to detect bursting in each channel. We use the state time course to calculate summary statistics that characterise the dynamics of bursts. Typical summary statistics are:</p>
<list list-type="bullet">
<list-item><p><bold>Mean lifetime</bold><sup><xref ref-type="fn" rid="fn8">8</xref></sup>. This is the average duration a state is active.</p></list-item>
<list-item><p><bold>Mean interval</bold>. This is the average duration between successive state activations.</p></list-item>
<list-item><p><bold>Burst count</bold>. This is the number of times a state activates in a second on average.</p></list-item>
<list-item><p><bold>Mean amplitude</bold>. This is the average value of the AE of the source data when each state is active.</p></list-item>
</list>
<p>We calculate each of these for a particular state and subject. The averages are taken over all state activations. Given when a state is active we can use the source data to calculate the PSD of each burst type. We use the multitaper approach described in [<xref ref-type="bibr" rid="c24">24</xref>] to do this due to its ability to accurately estimate spectra. We present the results of applying a TDE-HMM burst detection pipeline to the CTF rest MEG dataset in <xref ref-type="sec" rid="s3a">Section 3.1</xref>.</p>
</sec>
<sec id="s2e2">
<label>2.5.2</label>
<title>Identifying Dynamic Functional Networks</title>
<p><monospace>osl-dynamics</monospace> provides more options for modelling dynamic functional networks. Note, in this case we train on multivariate data containing the activity at multiple regions of interest, rather than a single region, which is what we did in the burst detection pipeline (<xref ref-type="sec" rid="s2e1">Section 2.5.1</xref>). Indeed, one perspective on using <monospace>osl-dynamics</monospace> to model dynamic functional networks, is that it is identifying bursts that span across multiple brain regions. <xref rid="fig5" ref-type="fig">Figure 5</xref> shows the different combinations of data preparation and generative models that are available for a dynamic network analysis pipeline. We discuss each of these options and when they should be used below.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><title>Dynamic functional network analysis pipeline.</title>
<p>A) First-level modelling. This includes data preparation (shown in the blue boxes), model training and post-hoc analysis (shown in the red boxes). The first-level modelling is used to derive subject-specific quantities. B) Group-level modelling. This involves using the subject-specific description from the first-level modelling to model a group.</p></caption>
<graphic xlink:href="549346v1_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s2e2a">
<title>AE-HMM</title>
<p>If we are interested in identifying dynamics in amplitude, we can train on AE data. Once we have trained a model, we can estimate subject and state-specific networks (amplitude maps) using the training data and inferred state time course. Additionally, we can calculate summary statistics that characterise the dynamics from the inferred state time course. These summary statistics are:</p>
<list list-type="bullet">
<list-item><p><bold>Fractional occupancy</bold>. This is the fraction of the total time that each state is active.</p></list-item>
<list-item><p><bold>Mean lifetime</bold>. This is the average duration that a state is active.</p></list-item>
<list-item><p><bold>Mean interval</bold>. This is the average duration between successive state visits.</p></list-item>
<list-item><p><bold>Switching rate</bold>. This is the number of activations per second of a particular state.</p></list-item>
</list>
<p>We calculate each of these for a particular state and subject. The averages are taken over all state activations. We present the results of an AE-HMM pipeline on the Elekta task MEG dataset in <xref ref-type="sec" rid="s3b">Section 3.2</xref>.</p>
</sec>
<sec id="s2e2b">
<title>TDE-HMM</title>
<p>We can use TDE data to study dynamics in phase synchronisation as well as dynamics in amplitude. In a dynamic network analysis pipeline we train on a multivariate time series (i.e. the time series for all regions of interest together). This means after TDE we have a very large number of channels (number of embeddings times number of regions). Therefore, we often need to perform principal component analysis (PCA) for dimensionality reduction to ensure the data fits into computer memory.</p>
<p>In the TDE-HMM pipeline, we can calculate the same summary statistics as the AE-HMM pipeline. However, to estimate the functional networks we use the multitaper approach described in [<xref ref-type="bibr" rid="c24">24</xref>]. Here, we use the source data and inferred state time course to estimate subject, region and state-specific PSDs and cross PSDs. When then use the PSDs to calculate power maps and cross PSDs to calculate coherence networks, see [<xref ref-type="bibr" rid="c24">24</xref>] for further details. Note, we also use the spectral decomposition approached introduced in [<xref ref-type="bibr" rid="c14">14</xref>] to specify a frequency range for calculating power maps and coherence networks. This involves applying non-negative matrix factorisation to the stacked subject and state-specific coherence spectra to identify common frequency bands of coherent activity. In this report, we fit two spectral components and only present the networks for the first band, which typically cover 1-25 Hz. We will see the results of applying a TDE-HMM pipeline for dynamic network analysis on both the CTF rest and Elekta task MEG dataset in <xref ref-type="sec" rid="s3c">Section 3.3</xref>.</p>
</sec>
<sec id="s2e2c">
<title>TDE-DyNeMo</title>
<p>This this pipeline, we replace the HMM with DyNeMo and train on TDE data. Unlike the mutually exclusive state description provided by the HMM, DyNeMo infers mode time courses, which describe the mixing ratio of each mode at each time point [<xref ref-type="bibr" rid="c26">26</xref>]. This mixture description complicates the calculation of subject-specific quantities, such as networks and summary statistics. To calculate mode and region-specific PSDs, we use the approach based on the General Linear Model (GLM) proposed in [<xref ref-type="bibr" rid="c45">45</xref>] where we regress the mixing coefficients onto a (cross) spectrogram, see [<xref ref-type="bibr" rid="c26">26</xref>] for further details. We then use the mode PSDs and cross PSDs to calculate power maps and coherence networks respectively. We can summarise the dynamics of each mode time course with quantities such as the mean, standard deviation and pairwise Pearson correlation. Alternatively, if we were interested in calculating the same summary statistics as the HMM (fractional occupancy, lifetime, interval, switching rate) we would first need to binarise the mode time courses. This can be done using a two-component Gaussian Mixture Model (GMM), which is discussed in [<xref ref-type="bibr" rid="c26">26</xref>]. Note, an additional complication related to the mode time course is that it does not contain any information regarding the relative magnitude of each mode covariance. For example, a mode with a small value for the mixing ratio can still be a large contributor to the instantaneous covariance if the values in the mode covariance matrix are relatively large. We account for this by renormalising the mode time course<sup><xref ref-type="fn" rid="fn9">9</xref></sup>, this is discussed further in [<xref ref-type="bibr" rid="c26">26</xref>]. We present the results of a TDE-DyNeMo pipeline on the CTF rest MEG dataset in <xref ref-type="sec" rid="s3d">Section 3.4</xref>.</p>
</sec>
<sec id="s2e2d">
<title>AE-DyNeMo</title>
<p>The final option is to train DyNeMo on AE data. In this case, the amplitude maps are calculated using the GLM approach by regressing the mixing coefficients on a sliding window AE time course. Summary statistics for dynamics are calculated in the same way as the TDE-DyNeMo pipeline.</p>
<p>When we display the networks inferred by each of the pipelines above, we will threshold them to only show the strongest connections. In this work, we will specify the threshold using a data-driven approach where we fit a two-component GMM to the distribution of connections in each network. We interpret one of the components as the distribution for background connections and the other as the distribution for atypically strong connections, which is what we display in each plot.</p>
</sec>
</sec>
<sec id="s2e3">
<label>2.5.3</label>
<title>Identifying Static Functional Networks</title>
<p>A feature of <monospace>osl-dynamics</monospace> is that more conventional, static (time-averaged), network analyses can be carried out using the same methodology that we use in the dynamic methods. This allows for a much more straightforward comparison between static and dynamic analyses. To model static functional networks we simply need to specific the metrics we would like to use to summarise the networks and we calculate these directly from the source data. <xref rid="fig6" ref-type="fig">Figure 6</xref> shows a typical static network analysis pipeline. We present the result of a static network analysis pipeline on the CTF rest MEG dataset in <xref ref-type="sec" rid="s3e">Section 3.5</xref>. Note, for the static networks we select the top 5% of connections to display in each plot rather than the GMM approached we used to threshold the dynamic functional networks.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><title>Static functional network analysis pipeline.</title>
<p>A) The source reconstructed data is used to calculate metrics that describe networks. B) The subject-specific metrics are used to model a group. Acronyms: amplitude envelope correlation (AEC), power spectral density (PSD).</p></caption>
<graphic xlink:href="549346v1_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s2f">
<label>2.6</label>
<title>Run-to-Run Variability</title>
<p>The HMM and DyNeMo are trained by minimising a cost function (in <monospace>osl-dynamics</monospace>, we use the <italic>variational free energy</italic> [<xref ref-type="bibr" rid="c34">34</xref>, <xref ref-type="bibr" rid="c26">26</xref>]). As is typical, this approach suffers from a local optimum issue, where the model can converge to different explanations (latent descriptions) of the data during training. I.e., difference state/mode time courses can lead to similar values for the variational free energy. The final description can be sensitive to the stochasticity in updating model parameters and the initial parameter values.</p>
<p>A strategy for dealing with this that has worked well in the past is to train multiple models from scratch (each model is referred to as a <italic>run</italic>) and only the model with the lowest variational free energy is analysed. We consider this model as the best description of the data. We ensure any conclusions based on this model are reproducible in the best model from another set of independent runs. In all of our results here, we trained each model 30 times and (randomly) grouped the runs into 3 sets of 10. We then compared the 3 best runs to verify that they all produce the same results. Other strategies for dealing with run-to-run variability involve combining multiple runs, see [<xref ref-type="bibr" rid="c46">46</xref>] for a discussion of these techniques.</p>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Exemplary Analyses</title>
<p>In this section, we outline example uses of <monospace>osl-dynamics</monospace> to study source reconstructed MEG data. <xref ref-type="sec" rid="s3a">Section 3.1</xref> presents the results of an oscillatory burst analysis pipeline. <xref ref-type="sec" rid="s3b">Sections 3.2</xref>-<xref ref-type="sec" rid="s3d">3.4</xref> present the results of various dynamic network analysis pipelines. For comparison, we also include the results of a static network analysis pipeline in <xref ref-type="sec" rid="s3e">Section 3.5</xref>.</p>
<sec id="s3a">
<label>3.1</label>
<title>Burst detection using a single-region TDE-HMM</title>
<p>The pipeline in <xref rid="fig4" ref-type="fig">Figure 4</xref> was applied to do burst detection on a single parcel in the left motor cortex. The source data was calculated using the CTF rest MEG dataset. All subjects were concatenated temporally and used to train the TDE-HMM. The results are shown in <xref rid="fig7" ref-type="fig">Figure 7</xref>.</p>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7:</label>
<caption><title>Burst detection: single region source reconstructed MEG data (left motor cortex) shows short-lived bursts of oscillatory activity.</title>
<p>A.I) Dynamic spectral properties of the first 20 s of the time series from the first subject. A.II) Amplitude envelope calculated after bandpass filtering the time series over the <italic>Î²</italic>-band (top), <italic>Î±</italic>-band (middle) and <italic>Î´/Î¸</italic>-band (bottom). B.I) The inferred state probability time course for the first 20 s of the first subject. B.II) The PSD of each state. B.III) Pearson correlation of each state probability time course with the amplitude envelopes for different frequency bands. B.IV) Distribution over subjects for summary statistics characterising the bursts. Note, no additional bandpass filtering was done to the source data when calculating the mean amplitude. C.I) Variational free energy for three sets of ten runs. C.II) Summary statistics for the best run from each set. The script used to generate the results in this figure is here: <ext-link ext-link-type="uri" xlink:href="https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/ctf_rest/tde_hmm_bursts.py">https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/ctf_rest/tde_hmm_bursts.py</ext-link>.</p></caption>
<graphic xlink:href="549346v1_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We see from the wavelet transform in <xref rid="fig7" ref-type="fig">Figure 7A.I</xref> that there are short bursts of oscillatory activity in this time series. This illustrates how it would be non-trivial, using conventional bandpass filtering and thresholding methods, to identify when exactly a burst occurs and what frequencies are contained within it. Instead of a conventional burst detection method, we use a 3 state TDE-HMM to identify bursts in a data-driven fashion. We see from the inferred state probability time course (<xref rid="fig7" ref-type="fig">Figure 7B.I</xref>) that there are short-lived states that describe this data. We can see from <xref rid="fig7" ref-type="fig">Figure 7B.II</xref> that each state corresponds to unique oscillatory activity. State 1 is interpreted as a non-oscillatory background state because it does not show any significant peaks in its PSD. States 2 and 3 show oscillatory activity in the <italic>Î´/Î¸</italic> band (1-7 Hz) and <italic>Î±/Î²</italic> band (7-30 Hz) respectively. <xref rid="fig7" ref-type="fig">Figure 7B.III</xref> shows the correlation of each state probability time course with the AEs for different frequency bands (<xref rid="fig7" ref-type="fig">Figure 7A.II</xref>). Based on this, we identify state 2 as a <italic>Î´/Î¸</italic>-burst state and state 3 as a <italic>Î²</italic>-burst state. We can see from <xref rid="fig7" ref-type="fig">Figure 7B.IV</xref> that these bursts have a variety of lifetimes ranging from a hundred to several hundred milliseconds.</p>
<p><xref rid="fig7" ref-type="fig">Figure 7C</xref> investigates the reproducibility of the description provided by the TDE-HMM. <xref rid="fig7" ref-type="fig">Figure 7C.I</xref> shows the final value of the variational free energy for each set and run. Comparing summary statistics (<xref rid="fig7" ref-type="fig">Figure 7C.II</xref>) for the best run (i.e. the one with the lowest variational free energy) from each set, we see the first-level analysis is very reproducible.</p>
</sec>
<sec id="s3b">
<label>3.2</label>
<title>Detecting network dynamics using a multi-region AE-HMM</title>
<p>The AE-HMM pipeline in <xref rid="fig5" ref-type="fig">Figure 5</xref> was applied to source reconstructed data from the Elekta task MEG dataset to identify amplitude-based network dynamics. All subjects and runs were concatenated temporally to train the model. The results are shown in <xref rid="fig8" ref-type="fig">Figure 8</xref> with an example of a group-level analysis on the HMM state time courses (calculation of a group-averaged evoked response).</p>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8:</label>
<caption><title>Dynamic network detection: a multi-region AE-HMM trained on the Elekta task MEG dataset reveals functional networks with fast dynamics that are related to the task.</title>
<p>A.I) For each state, group-averaged amplitude maps relative to the mean across states. A.II) State probability time course for the first 8 seconds of the first subject. A.III) Distribution over subjects for the summary statistics for each state. B.I) State time courses (Viterbi path) epoched around the presentation of visual stimuli. The horizontal bars indicate time points with <italic>p</italic>-value <italic>&lt;</italic> 0.05. The maximum statistic was used in permutation testing to control for the family wise error rate. C.I) Variational free energy for three sets of ten runs. C.II) Summary statistics for the best run from each set. C.III) Relative mean activity maps for the best run from each set. C.IV) State time courses epoched around the presentation of visual stimuli for the best run from each set. The script used to generate the results in this figure is here: <ext-link ext-link-type="uri" xlink:href="https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/elekta_task/ae_hmm.py">https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/elekta_task/ae_hmm.py</ext-link></p></caption>
<graphic xlink:href="549346v1_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We see the AE-HMM identifies plausible functional networks [<xref ref-type="bibr" rid="c47">47</xref>] with fast dynamics, typically with lifetimes of 50-100 ms (<xref rid="fig8" ref-type="fig">Figure 8A.III</xref>). We identify a default mode network (state 1); two visual networks (states 2 and 6); two frontotemporal networks (state 3 and 7); and two sensorimotor networks (states 4 and 5).</p>
<p>The AE-HMM was trained on the continuous source reconstructed data in an <italic>unsupervised</italic> manner, i.e. without any knowledge of the task. Post-HMM training, we can epoch the inferred state time course (Veterbi path) around the task (presentation of a visual stimuli<sup><xref ref-type="fn" rid="fn10">10</xref></sup>) and average over trials. This gives the probability of each state being activate around a visual event. This is shown in <xref rid="fig8" ref-type="fig">Figure 8B.I</xref>. We observe a significant increase (<italic>p</italic>-value <italic>&lt;</italic> 0.05) in the activation of the visual network (state 6) between 50-100 ms after the presentation of the visual stimuli as expected. We also observe a significant activation (<italic>p</italic>-value <italic>&lt;</italic> 0.05) of the frontotemporal network (state 7) 300-900 ms after the visual stimuli as well as a deactivation of the visual network (state 6).</p>
</sec>
<sec id="s3c">
<label>3.3</label>
<title>Detecting network dynamics using a multi-region TDE-HMM</title>
<p>The TDE-HMM pipeline in <xref rid="fig5" ref-type="fig">Figure 5</xref> was also applied to the Elekta task MEG dataset. All subjects and runs were concatenated temporally and used to train the model. The results are shown in <xref rid="fig9" ref-type="fig">Figure 9</xref>.</p>
<fig id="fig9" position="float" fig-type="figure">
<label>Figure 9:</label>
<caption><title>Dynamic network detection: a multi-region TDE-HMM trained on the Elekta task MEG dataset reveals spectrally distinct functional networks with fast dynamics.</title>
<p>A.I) For each state, group-averaged power maps relative to the mean across states (top) and PSD averaged over regions (bottom), both the state-specific (coloured solid line) and static PSD (i.e. the average across states, dashed black line) are shown. A.II) State probability time course for the first 8 seconds of the first subject. A.III) Distribution over subjects for the summary statistics for each state. B.I) State time courses (Viterbi path) epoched around the presentation of visual stimuli. The horizontal bars indicate time points with <italic>p</italic>-value <italic>&lt;</italic> 0.05. The maximum statistic was used in permutation testing to control for the family wise error rate. C.I) Variational free energy for three sets of ten runs. C.II) Summary statistics for the best run from each set. C.III) Relative power maps for the best run from each set. C.IV) State time courses epoched around the presentation of visual stimuli for the best run from each set. The script used to generate the results in this figure is here: <ext-link ext-link-type="uri" xlink:href="https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/elekta_task/tde_hmm.py">https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/elekta_task/tde_hmm.py</ext-link>.</p></caption>
<graphic xlink:href="549346v1_fig9.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Qualitatively, we observe the same functional networks as the AE-HMM pipeline. We observe virtually the same spatial patterns in TDE-HMM power maps (<xref rid="fig9" ref-type="fig">Figure 9A.I</xref>, top) and AE-HMM amplitude maps (<xref rid="fig8" ref-type="fig">Figure 8A.I</xref>). We can see from the state PSDs (<xref rid="fig9" ref-type="fig">Figure 9A.I</xref>, bottom) that the networks identified by the TDE-HMM exhibit distinct spectral (oscillatory) activity. The TDE-HMM networks also have fast dynamics (<xref rid="fig9" ref-type="fig">Figure 9A.III</xref>) with lifetimes of 50-100 ms. In <xref rid="fig9" ref-type="fig">Figure 9B.I</xref>, we can see we are able to reproduce the evoked response analysis we did using the AE-HMM (<xref rid="fig8" ref-type="fig">Figure 8B.I</xref>). <xref rid="fig9" ref-type="fig">Figure 9C</xref> investigates the reproducibility of the TDE-HMM trained on this dataset. We can see the best run from each set reproduces the summary statistics (<xref rid="fig9" ref-type="fig">Figure 9C.II</xref>), power maps (<xref rid="fig9" ref-type="fig">Figure 9C.III</xref>) and evoked response (<xref rid="fig9" ref-type="fig">Figure 9C.IV</xref>) very well.</p>
<p>The Elekta MEG dataset was recorded during a visual perception task. For comparison, we perform the same analysis on the CTF rest MEG dataset. All subjects were concatenated temporally and used to train the model. <xref rid="fig10" ref-type="fig">Figure 10</xref> shows the results of applying a TDE-HMM pipeline to this dataset. We observe the same networks in rest (<xref rid="fig10" ref-type="fig">Figure 10A</xref>) as in task (<xref rid="fig9" ref-type="fig">Figure 9A</xref>), which is a known result from fMRI studies [<xref ref-type="bibr" rid="c48">48</xref>]. We also include the coherence networks in <xref rid="fig10" ref-type="fig">Figure 10A.I</xref>. We observe regions with high power activations have high connectivity (coherence). These networks also have fast dynamics (<xref rid="fig10" ref-type="fig">Figure 10A.III</xref>) with lifetimes of 50-100 ms.</p>
<fig id="fig10" position="float" fig-type="figure">
<label>Figure 10:</label>
<caption><title>Dynamic network detection: a multi-region TDE-HMM trained on the CTF rest MEG dataset identifies the same functional networks to those found with the Elekta task MEG dataset and reveals differences in the dynamics for young vs old groups.</title>
<p>A.I) For each state, group-averaged power maps relative to mean across states (top), absolute coherence networks (middle) and PSD averaged over regions (bottom), both the state-specific (coloured solid line) and static PSD (i.e. the average across states, dashed black line) are shown. A.II) State probability time course for the first 8 seconds of the first subject and run. A.III) Distribution over subjects for the summary statistics of each state. B.I) Comparison of the summary statistics for a young (18-34 years old) and old (34-60 years old) group. The star indicates a <italic>p</italic>-value <italic>&lt;</italic> 0.05. The maximum statistic was used in permutation testing to control for the family wise error rate. C.I) Variational free energy for three sets of ten runs. C.II) Summary statistics for the best run from each set. C.III) Relative power maps for the best run from each set. C.IV) Comparison of summary statistics for young and old groups using the best run from each set. The script used to generate the results in this figure is here: <ext-link ext-link-type="uri" xlink:href="https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/ctf_rest/tde_hmm_networks.py">https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/ctf_rest/tde_hmm_networks.py</ext-link>.</p></caption>
<graphic xlink:href="549346v1_fig10.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To illustrate a group-level analysis we could do with a dynamic network perspective, we compared two groups: 27 subjects in a young group (18-34 years old) and 38 subjects in an old group (34-60 years). <xref rid="fig10" ref-type="fig">Figure 10B.I</xref> shows summary statistics for each group. We see the fractional occupancy and switching rate of the sensorimotor network (state 4) is increased in the older group (<italic>p</italic>-value <italic>&lt;</italic> 0.05). The mean lifetime of the visual network (state 6) is also decreased in the older group (<italic>p</italic>-value <italic>&lt;</italic> 0.05). The older group also has a wider distribution of mean intervals for the default mode network (state 1) and suppressed state (8) (<italic>p</italic>-value <italic>&lt;</italic> 0.05). <xref rid="fig10" ref-type="fig">Figure 10C</xref> shows the summary statistics (C.II), power maps (C.III) and group differences (C.IV) are very reproducible. The age-related differences we observe here are consistent with existing studies [<xref ref-type="bibr" rid="c49">49</xref>]. We will discuss the young vs old comparison further in <xref ref-type="sec" rid="s3e">Section 3.5</xref>.</p>
</sec>
<sec id="s3d">
<label>3.4</label>
<title>Dynamic network detection using multi-region TDE-DyNeMo</title>
<p>The TDE-DyNeMo pipeline in <xref rid="fig5" ref-type="fig">Figure 5</xref> was applied to the CTF rest MEG dataset. All subjects were concatenated temporally and used to train the model. The results are shown in <xref rid="fig11" ref-type="fig">Figure 11</xref>. Note, for DyNeMo we found that learning 7 modes (rather than 8) led to more reproducible results. Therefore, we present the 7 mode fit in <xref rid="fig11" ref-type="fig">Figure 11</xref>.</p>
<fig id="fig11" position="float" fig-type="figure">
<label>Figure 11:</label>
<caption><title>Dynamic network detection: a multi-region TDE-DyNeMo trained on the CTF rest MEG dataset reveals spectrally distinct modes that are more localised than HMM states and overlap in time.</title>
<p>A.I) For each mode, group-averaged power maps relative to the mean across modes (top), absolute coherence networks (middle) and PSD averaged over regions (bottom), both the mode-specific (coloured solid line) and static PSD (i.e. the average across modes, dashed black line) are shown. A.II) Mode time course (mixing coefficients) renormalised using the trace of the mode covariances. A.III) Pearson correlation between renormalised mode time courses calculated by concatenating the time series from each subject. A.IV) Distribution over subjects for summary statistics (mean and standard deviation) of the renormalised mode time courses. B.I) Comparison of the summary statistics for a young (18-34 years old) and old (34-60 years old) group. The maximum statistic was used in permutation testing to control for the family wise error rate. C.I) Variational free energy for three sets of ten runs. C.II) Summary statistics for the best run of each set. C.III) Relative power map for the best run of each set. The script used to generate the results in this figure is here: <ext-link ext-link-type="uri" xlink:href="https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/ctf_rest/tde_dynemo_networks.py">https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/ctf_rest/tde_dynemo_networks.py</ext-link>.</p></caption>
<graphic xlink:href="549346v1_fig11.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We can see from the power maps and coherence networks (<xref rid="fig11" ref-type="fig">Figure 11A.I</xref>) that DyNeMo identifies much more localised power activations and a cleaner network structure than was seen with the TDE-HMM. We can see from the PSDs (<xref rid="fig11" ref-type="fig">Figure 11A.I</xref>, bottom) that these networks also exhibit distinct spectral characteristics.</p>
<p>From the (renormalised) mode time course (<xref rid="fig11" ref-type="fig">Figure 11A.II</xref>) we see the description provided by DyNeMo is that of overlapping networks that dynamically vary in mixing ratios. This is a complementary perspective to the state description provided by the HMM. Co-activations of each mode can be understood by looking at the Pearson correlation between (renormalised) mode time courses (<xref rid="fig11" ref-type="fig">Figure 11A.III</xref>). We observe modes with activity in neighbouring regions show more co-activation. We summarise the (renormalised) mode time course using statistics (the mean and standard deviation) in <xref rid="fig11" ref-type="fig">Figure 11A.IV</xref>.</p>
<p>To compare DyNeMo to the HMM in a group-level analysis, we repeat the young vs old study using the DyNeMo-specific summary statistics (i.e. the mean and standard deviation of the renormalised mode time courses). <xref rid="fig11" ref-type="fig">Figure 11B.I</xref> shows significant group differences for young (18-34 years old) and old (34-60 years old) participants. We can see an increased mode contribution (mean renormalised mode time course) for the sensorimotor network (mode 4), which reflects the increase in fractional occupancy we saw in the TDE-HMM (<xref rid="fig10" ref-type="fig">Figure 10B.I</xref>). We see DyNeMo is able to reveal a stronger effect size with a <italic>p</italic>-value <italic>&lt;</italic> 0.01 compared to the TDE-HMM, which had a <italic>p</italic>-value <italic>&lt;</italic> 0.05. DyNeMo also shows a decrease in the variability (standard deviation of the renormalised mode time course) for the left temporal network (mode 5, <italic>p</italic>-value <italic>&lt;</italic> 0.01). We will discuss the young vs old comparison further in <xref ref-type="sec" rid="s3e">Section 3.5</xref>. <xref rid="fig11" ref-type="fig">Figure 11C</xref> investigates the reproducibility of this pipeline. We see the power maps (C.III), summary statistics (C.II) and group differences (C.IV) are very reproducible.</p>
</sec>
<sec id="s3e">
<label>3.5</label>
<title>Estimating Static Functional Networks</title>
<p>For comparison, we also apply a typical static network analysis pipeline (including static functional connectivity) to the CTF rest MEG dataset. We also consider how the static perspective in a young vs old group-level analysis compares to the dynamic perspective provided by the TDE-HMM in <xref rid="fig10" ref-type="fig">Figure 10</xref> and TDE-DyNeMo in <xref rid="fig11" ref-type="fig">Figure 11</xref>, illustrating the benefits of being able to do static and dynamic analyses within the same toolbox.</p>
<p><xref rid="fig12" ref-type="fig">Figure 12</xref> shows the the group-averaged power maps (A.I) coherence networks (A.II) and amplitude envelope correlation (AEC) networks (A.III) calculated using all subjects. We observe <italic>Î´</italic>-power is strongest in anterior regions and <italic>Î±</italic>-power is strongest in posterior regions. We also observe qualitatively similar coherence and AEC networks. In particular, we see strong occipital connectivity in the <italic>Î±</italic>-band in both the coherence and AEC networks.</p>
<fig id="fig12" position="float" fig-type="figure">
<label>Figure 12:</label>
<caption><title>Static network detection: osl-dynamics can also be used to perform static network analyses (including functional connectivity).</title>
<p>In the CTF rest MEG dataset, this reveals frequency-specific differences in the static functional networks of young (18-34 years old) and old (34-60 years old) participants. Group-average power maps (A.I) coherence networks (A.II) and AEC networks (A.III) for the canonical frequency bands (<italic>Î´, Î¸, Î±, Î²</italic>). B.I) Power difference for old minus young (top) and <italic>p</italic>-values (bottom). Only frequency bands with at least one parcel with a <italic>p</italic>-value <italic>&lt;</italic> 0.05 are shown, the rest are marked with n.s. (none significant). B.II) AEC difference for old minus young only showing edges with a <italic>p</italic>-value <italic>&lt;</italic> 0.05. The maximum statistic was used in permutation testing to control for the family wise error rate. The script used to generate the results in this figure is here: <ext-link ext-link-type="uri" xlink:href="https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/ctf_rest/static_networks.py">https://github.com/OHBA-analysis/osl-dynamics/blob/main/examples/toolbox_paper/ctf_rest/static_networks.py</ext-link>.</p></caption>
<graphic xlink:href="549346v1_fig12.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p><xref rid="fig12" ref-type="fig">Figure 12B</xref> shows significant (<italic>p</italic>-value <italic>&lt;</italic> 0.05) differences in the power maps (B.I) and AEC networks (B.II) for old (34-60 years old) minus young (18-34 years old) groups. For example, we observe a significant reduction in temporal <italic>Î´</italic>-power and increase in sensorimotor <italic>Î²</italic>-power. We also observe a significant increase in sensorimotor AEC in the <italic>Î²</italic>-band (<xref rid="fig12" ref-type="fig">Figure 12B.II</xref>). We can compare this to the dynamic network analysis carried out with the TDE-HMM in <xref rid="fig10" ref-type="fig">Figure 10</xref> and TDE-DyNeMo in <xref rid="fig11" ref-type="fig">Figure 11</xref>. The dynamic network perspective provided by the TDE-HMM shows an increase in the fractional occupancy of state 4 (<xref rid="fig10" ref-type="fig">Figure 10B.I</xref>), which is a network with high <italic>Î²</italic>-power and connectivity (coherence) in the sensorimotor region. This is consistent with the static increase in <italic>Î²</italic>-power and AEC connectivity we observe here; i.e. the increase in static <italic>Î²</italic>-power and connectivity with age can be linked to a larger fraction of time spent in the sensorimotor network. The perspective provided by TDE-DyNeMo shows an increase with age in the contribution of mode 4 (<xref rid="fig11" ref-type="fig">Figure 11B.I</xref>), which represents a sensorimotor network. This is a complementary explanation for the increase in static <italic>Î²</italic>-power and connectivity as a larger contribution from the sensorimotor network to the overall brain activity of older participants.</p>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Discussion</title>
<p>In <xref ref-type="sec" rid="s3a">Section 3.1</xref>, we use the TDE-HMM to identify oscillatory bursts in a data-driven manner with much fewer assumptions than conventional burst detection methods based on amplitude thresholding. The advantages of using a data-driven approach like the TDE-HMM are discussed further in [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c50">50</xref>]. In short, with an conventional approach we must pre-specify a frequency of interest and we may miss oscillatory bursts that do not reach an arbitrary threshold. In contrast, the TDE-HMM is less sensitive to the amplitude (it is better able to identify low-amplitude oscillatory bursts) and can identify the frequency of oscillations automatically.</p>
<p>In <xref ref-type="sec" rid="s3b">Sections 3.2</xref> and <xref ref-type="sec" rid="s3c">3.3</xref>, we presented the functional networks identified by HMMs in a variety of settings. These networks were identified automatically at fast (sub-second) timescales from the data (unsupervised) with no input from the user. We found a set of plausible networks that were related to task (<xref rid="fig8" ref-type="fig">Figure 8</xref>) and demographics (<xref rid="fig10" ref-type="fig">Figure 10</xref>). These networks were very reproducible: across multiple HMM runs; across different data preparation techniques (AE and TDE); across different experimental paradigms (task and rest) and across different scanners (Elekta and CTF).</p>
<p>Given we observe similar networks with the AE-HMM and TDE-HMM (<xref rid="fig8" ref-type="fig">Figures 8</xref> and <xref rid="fig9" ref-type="fig">9</xref> respectively), one may ask which pipeline is recommended. The TDE-HMM approach is able to model dynamics in oscillatory amplitude and phase synchronisation whereas the AE-HMM can only model dynamics in amplitude. This means the TDE-HMM is generally a better model for oscillatory dynamics. An occasion where the AE-HMM may be preferred is if the extra computational load of training on TDE/PCA data prohibits the TDE-HMM.</p>
<p><monospace>osl-dynamics</monospace> offers a choice of two generative models for detecting network dynamics: the HMM or DyNeMo. The HMM assumes that there are mutually exclusive network states, whereas DyNeMo assumes the network modes are mixed differently at each time point. While DyNeMoâs assumption is arguably more realistic, the HMMâs stronger assumption has the benefit of simplifying the decomposition, which can make interpreting the network dynamics more straightforward. In short, the HMM and DyNeMo provide complementary descriptions of network dynamics, with either one being potentially useful depending on the context [<xref ref-type="bibr" rid="c26">26</xref>]. DyNeMo does have the additional advantage of using a richer temporal regularisation through the use of a deep recurrent network network. This has been shown to capture longer range temporal structure than the HMM [<xref ref-type="bibr" rid="c26">26</xref>], and exploring the cognitive importance of long-range temporal structure is an interesting area of future investigation [<xref ref-type="bibr" rid="c51">51</xref>].</p>
<p><monospace>osl-dynamics</monospace> can also be used to compute static network descriptions, including conventional static functional connectivity. This uses the same methodology as the state (or mode) specific network estimation in the dynamic approaches, making comparisons between dynamic and static perspectives more straightforward. In <xref ref-type="sec" rid="s3e">Section 3.5</xref>, we used this feature to relate the static functional network description to a dynamic perspective. We would like to stress that the young vs old study is used as an example of the type of group analyses that can be performed with this toolbox and that a more rigorous study with a larger population dataset is needed to understand the impact of ageing on functional networks. The results in <xref ref-type="sec" rid="s3e">Section 3.5</xref> should be taken as just an indication of possible ageing effects that can be investigated in a future study. In this report, we focus on the presentation of the tools needed to make such studies possible.</p>
</sec>
<sec id="s5">
<label>5</label>
<title>Conclusions</title>
<p>We present a new toolbox for studying time series data: <monospace>osl-dynamics</monospace>. This is an open-source package written in Python. We believe the availability of this package in Python improves the accessibility of these tools, in particular for non-technical users. Additionally, it avoids the need for a paid license. Using Python also enables us to take advantage of modern deep learning libraries (in particular <monospace>TensorFlow</monospace> [<xref ref-type="bibr" rid="c52">52</xref>]) which enables us to scale these methods to very large datasets, something that is currently not possible with existing toolboxes.</p>
<p><monospace>osl-dynamics</monospace> can be used, and has been used, in a wide range of applications and on a variety of data modalities: electrophysiological, invasive local field potential, functional magnetic resonance imaging, etc. Here, we illustrated its use in applications of burst detection and dynamic network analysis using MEG data. This package also allows the user to study the static (time averaged) properties of a time series alongside dynamics within the same toolbox. The methods contained in <monospace>osl-dynamics</monospace> provide novel summary measures for dynamics and group-level analysis tools that can be used to inform our understanding of cognition, behaviour and disease.</p>
</sec>
<sec id="d1e1899" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e1991">
<label>Supplementary Information</label>
<media xlink:href="supplements/549346_file03.pdf"/>
</supplementary-material>
</sec>
</body>
<back>
<ref-list>
<title>References</title>
<ref id="c1"><label>[1]</label><mixed-citation publication-type="book"><string-name><surname>Buzsaki</surname>, <given-names>G.</given-names></string-name>. <source>Rhythms of the Brain</source>. <publisher-name>Oxford University Press</publisher-name>, <year>2006</year>.</mixed-citation></ref>
<ref id="c2"><label>[2]</label><mixed-citation publication-type="journal"><string-name><surname>Ward</surname>, <given-names>L.M.</given-names></string-name> <article-title>âSynchronous neural oscillations and cognitive processes</article-title>.â <source>Trends in cognitive sciences</source> <volume>7</volume>.<issue>12</issue> (<year>2003</year>): <fpage>553</fpage>â<lpage>559</lpage>.</mixed-citation></ref>
<ref id="c3"><label>[3]</label><mixed-citation publication-type="book"><string-name><surname>Engel</surname>, <given-names>A.K.</given-names></string-name>, and <string-name><surname>Fries</surname>, <given-names>P.</given-names></string-name> <chapter-title>âNeuronal oscillations, coherence, and consciousness</chapter-title>.â <source>The Neurology of consciousness</source>. <publisher-name>Academic Press</publisher-name>, <year>2016</year>. <fpage>49</fpage>â<lpage>60</lpage>.</mixed-citation></ref>
<ref id="c4"><label>[4]</label><mixed-citation publication-type="journal"><string-name><surname>Fries</surname>, <given-names>P.</given-names></string-name> <article-title>âRhythms for cognition: communication through coherence</article-title>.â <source>Neuron</source> <volume>88</volume>.<issue>1</issue> (<year>2015</year>): <fpage>220</fpage>â<lpage>235</lpage>.</mixed-citation></ref>
<ref id="c5"><label>[5]</label><mixed-citation publication-type="journal"><string-name><surname>Basar</surname>, <given-names>E.</given-names></string-name>, and <string-name><surname>Bahar Guntekin</surname>, <given-names>B.</given-names></string-name> <article-title>âA review of brain oscillations in cognitive disorders and the role of neurotransmitters</article-title>.â <source>Brain research</source> <volume>1235</volume> (<year>2008</year>): <fpage>172</fpage>â<lpage>193</lpage>.</mixed-citation></ref>
<ref id="c6"><label>[6]</label><mixed-citation publication-type="journal"><string-name><surname>van Ede</surname>, <given-names>F.</given-names></string-name>, <etal>et al.</etal> <article-title>âNeural oscillations: sustained rhythms or transient burst-events?</article-title>.â <source>Trends in neurosciences</source> <volume>41</volume>.<issue>7</issue> (<year>2018</year>): <fpage>415</fpage>â<lpage>417</lpage>.</mixed-citation></ref>
<ref id="c7"><label>[7]</label><mixed-citation publication-type="journal"><string-name><surname>Jones</surname>, <given-names>S.R.</given-names></string-name> <article-title>âWhen brain rhythms arenât ârhythmicâ: implication for their mechanisms and meaning</article-title>.â <source>Current opinion in neurobiology</source> <volume>40</volume> (<year>2016</year>): <fpage>72</fpage>â<lpage>80</lpage>.</mixed-citation></ref>
<ref id="c8"><label>[8]</label><mixed-citation publication-type="journal"><string-name><surname>Shin</surname>, <given-names>H.</given-names></string-name>, <etal>et al.</etal> <article-title>âThe rate of transient beta frequency events predicts behavior across tasks and species</article-title>.â <source>Elife</source> <volume>6</volume> (<year>2017</year>): <fpage>e29086</fpage>.</mixed-citation></ref>
<ref id="c9"><label>[9]</label><mixed-citation publication-type="journal"><string-name><surname>Seedat</surname>, <given-names>Z. A.</given-names></string-name>, <etal>et al.</etal> <article-title>âThe role of transient spectral âburstsâ in functional connectivity: A magnetoencephalography study</article-title>.â <source>Neuroimage</source> <volume>209</volume> (<year>2020</year>): <fpage>116537</fpage>.</mixed-citation></ref>
<ref id="c10"><label>[10]</label><mixed-citation publication-type="journal"><string-name><surname>Stevner</surname>, <given-names>A.B.A.</given-names></string-name>, <etal>et al.</etal> <article-title>âDiscovery of key whole-brain transitions and dynamics during human wakefulness and non-REM sleep</article-title>.â <source>Nature communications</source> <volume>10</volume>.<issue>1</issue> (<year>2019</year>): <fpage>1035</fpage>.</mixed-citation></ref>
<ref id="c11"><label>[11]</label><mixed-citation publication-type="journal"><string-name><surname>Khawaldeh</surname>, <given-names>S.</given-names></string-name>, <etal>et al.</etal> <article-title>âBalance between competing spectral states in subthalamic nucleus is linked to motor impairment in Parkinsonâs disease</article-title>.â <source>Brain</source> <volume>145</volume>.<issue>1</issue> (<year>2022</year>): <fpage>237</fpage>â<lpage>250</lpage>.</mixed-citation></ref>
<ref id="c12"><label>[12]</label><mixed-citation publication-type="book"><string-name><surname>Moraud</surname>, <given-names>E.M.</given-names></string-name>, <etal>et al.</etal> <chapter-title>âPredicting beta bursts from local field potentials to improve closedloop DBS paradigms in Parkinsonâs patients</chapter-title>.â <source>2018 40th Annual International Conference of the IEEE Engineering in Medicine and Biology Society (EMBC)</source>. <publisher-name>IEEE</publisher-name>, <year>2018</year>.</mixed-citation></ref>
<ref id="c13"><label>[13]</label><mixed-citation publication-type="journal"><string-name><surname>Bakkum</surname>, <given-names>D.J.</given-names></string-name>, <etal>et al.</etal> <article-title>âParameters for burst detection</article-title>.â <source>Frontiers in computational neuroscience</source> <volume>7</volume> (<year>2014</year>): <fpage>193</fpage>.</mixed-citation></ref>
<ref id="c14"><label>[14]</label><mixed-citation publication-type="journal"><string-name><surname>Vidaurre</surname>, <given-names>D.</given-names></string-name>, <etal>et al.</etal> <article-title>âSpontaneous cortical activity transiently organises into frequency specific phase-coupling networks</article-title>.â <source>Nature communications</source> <volume>9</volume>.<issue>1</issue> (<year>2018</year>): <fpage>2987</fpage>.</mixed-citation></ref>
<ref id="c15"><label>[15]</label><mixed-citation publication-type="journal"><string-name><surname>Quinn</surname>, <given-names>A.J.</given-names></string-name>, <etal>et al.</etal> <article-title>âTask-evoked dynamic network analysis through hidden markov modeling</article-title>.â <source>Frontiers in neuroscience</source> <volume>12</volume> (<year>2018</year>): <fpage>603</fpage>.</mixed-citation></ref>
<ref id="c16"><label>[16]</label><mixed-citation publication-type="journal"><string-name><surname>Higgins</surname>, <given-names>C.</given-names></string-name>, <etal>et al.</etal> <article-title>âReplay bursts in humans coincide with activation of the default mode and parietal alpha networks</article-title>.â <source>Neuron</source> <volume>109</volume>.<issue>5</issue> (<year>2021</year>): <fpage>882</fpage>â<lpage>893</lpage>.</mixed-citation></ref>
<ref id="c17"><label>[17]</label><mixed-citation publication-type="journal"><string-name><surname>LiÃ©geois</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title>âResting brain dynamics at different timescales capture distinct aspects of human behavior</article-title>.â <source>Nature communications</source> <volume>10</volume>.<issue>1</issue> (<year>2019</year>): <fpage>2317</fpage>.</mixed-citation></ref>
<ref id="c18"><label>[18]</label><mixed-citation publication-type="journal"><string-name><surname>Sitnikova</surname>, <given-names>T.A.</given-names></string-name>, <etal>et al.</etal> <article-title>âShort timescale abnormalities in the states of spontaneous synchrony in the functional neural networks in Alzheimerâs disease</article-title>.â <source>NeuroImage: Clinical</source> <volume>20</volume> (<year>2018</year>): <fpage>128</fpage>â<lpage>152</lpage>.</mixed-citation></ref>
<ref id="c19"><label>[19]</label><mixed-citation publication-type="journal"><string-name><surname>Du</surname>, <given-names>Y.</given-names></string-name>, <etal>et al.</etal> <article-title>âClassification and prediction of brain disorders using functional connectivity: promising but challenging</article-title>.â <source>Frontiers in neuroscience</source> <volume>12</volume> (<year>2018</year>): <fpage>525</fpage>.</mixed-citation></ref>
<ref id="c20"><label>[20]</label><mixed-citation publication-type="journal"><string-name><surname>Van Schependom</surname>, <given-names>J.</given-names></string-name>, <etal>et al.</etal> <article-title>âAltered transient brain dynamics in multiple sclerosis: Treatment or pathology?</article-title>.â <source>Human brain mapping</source> <volume>40</volume>.<issue>16</issue> (<year>2019</year>): <fpage>4789</fpage>â<lpage>4800</lpage>.</mixed-citation></ref>
<ref id="c21"><label>[21]</label><mixed-citation publication-type="journal"><string-name><surname>Salvan</surname>, <given-names>P.</given-names></string-name>, <etal>et al.</etal> <article-title>âFrequency modulation of entorhinal cortex neuronal activity drives distinct frequency-dependent states of brain-wide dynamics</article-title>.â <source>Cell Reports</source> <volume>37</volume>.<issue>5</issue> (<year>2021</year>).</mixed-citation></ref>
<ref id="c22"><label>[22]</label><mixed-citation publication-type="journal"><string-name><surname>Sharma</surname>, <given-names>A.</given-names></string-name>, <etal>et al.</etal> <article-title>âDifferential dopaminergic modulation of spontaneous corticoâsubthalamic activity in parkinsonâs disease</article-title>.â <source>Elife</source> <volume>10</volume> (<year>2021</year>): <fpage>e66057</fpage>.</mixed-citation></ref>
<ref id="c23"><label>[23]</label><mixed-citation publication-type="journal"><string-name><surname>Ma</surname>, <given-names>X.</given-names></string-name>, <etal>et al.</etal> <article-title>âAltered temporal organization of brief spontaneous brain activities in patients with Alzheimerâs disease</article-title>.â <source>Neuroscience</source> <volume>425</volume> (<year>2020</year>): <fpage>1</fpage>â<lpage>11</lpage>.</mixed-citation></ref>
<ref id="c24"><label>[24]</label><mixed-citation publication-type="journal"><string-name><surname>Vidaurre</surname>, <given-names>D.</given-names></string-name>, <etal>et al.</etal> <article-title>âSpectrally resolved fast transient brain states in electrophysiological data</article-title>.â <source>Neuroimage</source> <volume>126</volume> (<year>2016</year>): <fpage>81</fpage>â<lpage>95</lpage>.</mixed-citation></ref>
<ref id="c25"><label>[25]</label><mixed-citation publication-type="journal"><string-name><surname>Vidaurre</surname>, <given-names>D.</given-names></string-name>, <etal>et al.</etal> <article-title>âDiscovering dynamic brain networks from big data in rest and task</article-title>.â <source>Neuroimage</source> <volume>180</volume> (<year>2018</year>): <fpage>646</fpage>â<lpage>656</lpage>.</mixed-citation></ref>
<ref id="c26"><label>[26]</label><mixed-citation publication-type="journal"><string-name><surname>Gohil</surname>, <given-names>C.</given-names></string-name>, <etal>et al.</etal> <article-title>âMixtures of large-scale dynamic functional brain network modes</article-title>.â <source>NeuroImage</source> <volume>263</volume> (<year>2022</year>): <fpage>119595</fpage>.</mixed-citation></ref>
<ref id="c27"><label>[27]</label><mixed-citation publication-type="journal"><string-name><surname>Hunyadi</surname>, <given-names>B.</given-names></string-name>, <etal>et al.</etal> <article-title>âA dynamic system of brain networks revealed by fast transient EEG fluctuations and their fMRI correlates</article-title>.â <source>Neuroimage</source> <volume>185</volume> (<year>2019</year>): <fpage>72</fpage>â<lpage>82</lpage>.</mixed-citation></ref>
<ref id="c28"><label>[28]</label><mixed-citation publication-type="journal"><string-name><surname>Ghimatgar</surname>, <given-names>H.</given-names></string-name>, <etal>et al.</etal> <article-title>âAn automatic single-channel EEG-based sleep stage scoring method based on hidden Markov Model</article-title>.â <source>Journal of neuroscience methods</source> <volume>324</volume> (<year>2019</year>): <fpage>108320</fpage>.</mixed-citation></ref>
<ref id="c29"><label>[29]</label><mixed-citation publication-type="journal"><string-name><surname>Garwood</surname>, <given-names>I.C.</given-names></string-name>, <etal>et al.</etal> <article-title>âA hidden Markov model reliably characterizes ketamine-induced spectral dynamics in macaque local field potentials and human electroencephalograms</article-title>.â <source>PLoS Computational Biology</source> <volume>17</volume>.<issue>8</issue> (<year>2021</year>): <fpage>e1009280</fpage>.</mixed-citation></ref>
<ref id="c30"><label>[30]</label><mixed-citation publication-type="journal"><string-name><surname>Vidaurre</surname>, <given-names>D.</given-names></string-name>, <etal>et al.</etal> <article-title>âBrain network dynamics are hierarchically organized in time</article-title>.â <source>Proceedings of the National Academy of Sciences</source> <volume>114</volume>.<issue>48</issue> (<year>2017</year>): <fpage>12827</fpage>â<lpage>12832</lpage>.</mixed-citation></ref>
<ref id="c31"><label>[31]</label><mixed-citation publication-type="journal"><string-name><surname>Wissel</surname>, <given-names>T.</given-names></string-name>, <etal>et al.</etal> <article-title>âHidden Markov model and support vector machine based decoding of finger movements using electrocorticography</article-title>.â <source>Journal of neural engineering</source> <volume>10</volume>.<issue>5</issue> (<year>2013</year>): <fpage>056020</fpage>.</mixed-citation></ref>
<ref id="c32"><label>[32]</label><mixed-citation publication-type="journal"><string-name><surname>Liuzzi</surname>, <given-names>L.</given-names></string-name>, <etal>et al.</etal> <article-title>âHow sensitive are conventional MEG functional connectivity metrics with sliding windows to detect genuine fluctuations in dynamic functional connectivity?</article-title>.â <source>Frontiers in neuroscience</source> <volume>13</volume> (<year>2019</year>): <fpage>797</fpage>.</mixed-citation></ref>
<ref id="c33"><label>[33]</label><mixed-citation publication-type="other"><string-name><surname>Lamb</surname>, <given-names>A.</given-names></string-name>. <article-title>âA Brief Introduction to Generative Models</article-title>.â <source>arXiv</source> preprint arXiv:2103.00265 (<year>2021</year>).</mixed-citation></ref>
<ref id="c34"><label>[34]</label><mixed-citation publication-type="other"><string-name><surname>Rezek</surname>, <given-names>I</given-names></string-name>, and <string-name><surname>Roberts</surname>, <given-names>S.</given-names></string-name> <article-title>âEnsemble hidden Markov models with extended observation densities for biosignal analysis</article-title>.â <source>Probabilistic modeling in bioinformatics and medical informatics</source> (<year>2005</year>): <fpage>419</fpage>â<lpage>450</lpage>.</mixed-citation></ref>
<ref id="c35"><label>[35]</label><mixed-citation publication-type="book"><string-name><surname>Bishop</surname>, <given-names>C.M.</given-names></string-name>, and <string-name><surname>Nasser</surname> <given-names>M. Nasrabadi</given-names></string-name>. <source>Pattern recognition and machine learning</source>. Vol. <volume>4</volume>. No. <issue>4</issue>. <publisher-loc>New York</publisher-loc>: <publisher-name>springer</publisher-name>, <year>2006</year>.</mixed-citation></ref>
<ref id="c36"><label>[36]</label><mixed-citation publication-type="book"><string-name><surname>GÃ©ron</surname>, <given-names>A.</given-names></string-name>. <source>Hands-on machine learning with Scikit-Learn, Keras, and TensorFlow</source>. <publisher-name>OâReilly Media, Inc</publisher-name>., <year>2022</year>.</mixed-citation></ref>
<ref id="c37"><label>[37]</label><mixed-citation publication-type="other"><string-name><surname>Kingma</surname>, <given-names>D.P.</given-names></string-name>, and <string-name><surname>Welling</surname>, <given-names>M.</given-names></string-name> <article-title>âAuto-encoding variational bayes</article-title>.â <source>arXiv</source> preprint arXiv:1312.6114 (<year>2013</year>).</mixed-citation></ref>
<ref id="c38"><label>[38]</label><mixed-citation publication-type="web"><ext-link ext-link-type="uri" xlink:href="https://meguk.ac.uk/">https://meguk.ac.uk/</ext-link>.</mixed-citation></ref>
<ref id="c39"><label>[39]</label><mixed-citation publication-type="journal"><string-name><surname>Wakeman</surname>, <given-names>D.G.</given-names></string-name>, and <string-name><surname>Henson</surname>, <given-names>R.N.</given-names></string-name> <article-title>âA multi-subject, multi-modal human neuroimaging dataset</article-title>.â <source>Scientific data</source> <volume>2</volume>.<issue>1</issue> (<year>2015</year>): <fpage>1</fpage>â<lpage>10</lpage>.</mixed-citation></ref>
<ref id="c40"><label>[40]</label><mixed-citation publication-type="web"><ext-link ext-link-type="uri" xlink:href="https://github.com/OHBA-analysis/osl">https://github.com/OHBA-analysis/osl</ext-link>.</mixed-citation></ref>
<ref id="c41"><label>[41]</label><mixed-citation publication-type="web"><string-name><surname>Quinn</surname>, <given-names>A.J.</given-names></string-name>, <string-name><surname>van Es</surname>, <given-names>M.W.J.</given-names></string-name>, <string-name><surname>Gohil</surname>, <given-names>C.</given-names></string-name>, and <string-name><surname>Woolrich</surname>, <given-names>M.W.</given-names></string-name> <article-title>OHBA Software Library in Python (OSL) (0.1.1)</article-title>. <source>Zenodo</source> (<year>2022</year>). <pub-id pub-id-type="doi">10.5281/zenodo.6875060</pub-id>.</mixed-citation></ref>
<ref id="c42"><label>[42]</label><mixed-citation publication-type="journal"><string-name><surname>Colclough</surname>, <given-names>G.L.</given-names></string-name>, <etal>et al.</etal> <article-title>âA symmetric multivariate leakage correction for MEG connectomes</article-title>.â <source>Neuroimage</source> <volume>117</volume> (<year>2015</year>): <fpage>439</fpage>â<lpage>448</lpage>.</mixed-citation></ref>
<ref id="c43"><label>[43]</label><mixed-citation publication-type="book"><string-name><surname>Strogatz</surname>, <given-names>S.H.</given-names></string-name> <source>Nonlinear dynamics and chaos with student solutions manual: With applications to physics, biology, chemistry, and engineering</source>. <publisher-name>CRC press</publisher-name>, <year>2018</year>.</mixed-citation></ref>
<ref id="c44"><label>[44]</label><mixed-citation publication-type="journal"><string-name><surname>Vidaurre</surname>, <given-names>D.</given-names></string-name>, <etal>et al.</etal> <article-title>âBehavioural relevance of spontaneous, transient brain network interactions in fMRI</article-title>.â <source>Neuroimage</source> <volume>229</volume> (<year>2021</year>): <fpage>117713</fpage>.</mixed-citation></ref>
<ref id="c45"><label>[45]</label><mixed-citation publication-type="other"><string-name><surname>Quinn</surname>, <given-names>A.J.</given-names></string-name>, <etal>et al.</etal> <article-title>âThe GLM-Spectrum: A multilevel framework for spectrum analysis with covariate and confound modelling</article-title>.â <source>bioRxiv</source> (<year>2022</year>): <fpage>2022</fpage>â<lpage>11</lpage>.</mixed-citation></ref>
<ref id="c46"><label>[46]</label><mixed-citation publication-type="other"><string-name><surname>Alonso</surname>, <given-names>S.</given-names></string-name>, and <string-name><surname>Vidaurre</surname>, <given-names>D.</given-names></string-name> <article-title>âTowards stability of dynamic FC estimates in neuroimaging and electrophysiology: solutions and limits</article-title>.â <source>bioRxiv</source> (<year>2023</year>): <fpage>2023</fpage>â<lpage>01</lpage>.</mixed-citation></ref>
<ref id="c47"><label>[47]</label><mixed-citation publication-type="journal"><string-name><surname>Yeo</surname>, <given-names>B.T.</given-names></string-name>, <etal>et al.</etal> <article-title>âThe organization of the human cerebral cortex estimated by intrinsic functional connectivity</article-title>.â <source>Journal of neurophysiology</source> <volume>106</volume>.<issue>3</issue> (<year>2011</year>): <fpage>1125</fpage>â<lpage>1165</lpage>.</mixed-citation></ref>
<ref id="c48"><label>[48]</label><mixed-citation publication-type="journal"><string-name><surname>Smith</surname>, <given-names>S.M.</given-names></string-name>, <etal>et al.</etal> <article-title>âCorrespondence of the brainâs functional architecture during activation and rest</article-title>.â <source>Proceedings of the national academy of sciences</source> <volume>106</volume>.<issue>31</issue> (<year>2009</year>): <fpage>13040</fpage>â<lpage>13045</lpage>.</mixed-citation></ref>
<ref id="c49"><label>[49]</label><mixed-citation publication-type="journal"><string-name><surname>Coquelet</surname>, <given-names>N.</given-names></string-name>, <etal>et al.</etal> <article-title>âChanges in electrophysiological static and dynamic human brain functional architecture from childhood to late adulthood</article-title>.â <source>Scientific Reports</source> <volume>10</volume>.<issue>1</issue> (<year>2020</year>): <fpage>1</fpage>â<lpage>14</lpage>.</mixed-citation></ref>
<ref id="c50"><label>[50]</label><mixed-citation publication-type="other"><string-name><surname>Masaracchia</surname>, <given-names>L.</given-names></string-name>, <etal>et al.</etal> <article-title>âDissecting unsupervised learning through hidden Markov modelling in electrophysiological data</article-title>.â <source>bioRxiv</source> (<year>2023</year>): <fpage>2023</fpage>â<lpage>01</lpage>.</mixed-citation></ref>
<ref id="c51"><label>[51]</label><mixed-citation publication-type="other"><string-name><surname>van Es</surname>, <given-names>M.W.J.</given-names></string-name>, <etal>et al.</etal> <article-title>âLarge-scale cortical networks are organized in structured cycles</article-title>.â <source>bioRxiv</source> (<year>2023</year>): 2023-07.</mixed-citation></ref>
<ref id="c52"><label>[52]</label><mixed-citation publication-type="web"><ext-link ext-link-type="uri" xlink:href="https://www.tensorflow.org/">https://www.tensorflow.org/</ext-link>.</mixed-citation></ref>
</ref-list>
<fn-group>
<fn id="fn1">
<label><sup>1</sup></label>
<p>Also known as the Viterbi path.</p></fn>
<fn id="fn2">
<label><sup>2</sup></label>
<p>See <monospace>osl.preprocessing.osl wrappers.detect badsegments</monospace> and <monospace>detect badchannels</monospace> in [<xref ref-type="bibr" rid="c40">40</xref>].</p></fn>
<fn id="fn3">
<label><sup>3</sup></label>
<p>See <monospace>osl.preprocessing.mne wrappers.run mne ica autoreject</monospace> in [<xref ref-type="bibr" rid="c40">40</xref>].</p></fn>
<fn id="fn4">
<label><sup>4</sup></label>
<p>We used a parcellation based on anatomy: <monospace>fmri d100 parcellation with PCC reduced 2mm ss5mm ds8mm.nii.gz</monospace> [<xref ref-type="bibr" rid="c40">40</xref>].</p></fn>
<fn id="fn5">
<label><sup>5</sup></label>
<p>See <monospace>osl.source_recon.sign_flipping</monospace> in [<xref ref-type="bibr" rid="c40">40</xref>]. Note, this step can be skipped if you are training on amplitude envelope data.</p></fn>
<fn id="fn6">
<label><sup>6</sup></label>
<p>Note, the HMM and DyNeMo are typically trained as group models using the concatenated data from all subjects. This means the models are unaware that the data originates from different subjects.</p></fn>
<fn id="fn7">
<label><sup>7</sup></label>
<p>This step is analogous to dual regression in independent component analysis.</p></fn>
<fn id="fn8">
<label><sup>8</sup></label>
<p>The lifetime is also known as <italic>dwell time</italic>.</p></fn>
<fn id="fn9">
<label><sup>9</sup></label>
<p>We weight each mode time course by the trace of its mode covariance and divide by the sum over modes at each time point to ensure the renormalised mode time course sums to one.</p></fn>
<fn id="fn10">
<label><sup>10</sup></label>
<p>A picture of a familiar, unfamiliar or scrambled face.</p></fn>
</fn-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.91949.1.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ray</surname>
<given-names>Supratim</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Indian Institute of Science Bangalore</institution>
</institution-wrap>
<city>Bengaluru</city>
<country>India</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>The authors present a software package called osl-dynamics that uses generative models (Hidden Markov Model and Dynamic Network Modes) that can be adapted to the data, and the latent states and transition across states obtained through the model can be used to describe spectro-temporal characteristics of the brain signals, as well as for oscillatory burst detection. This approach is <bold>important</bold> and adds to the repertoire of techniques that can be used to study high-dimensional data and having access to this software (with tutorials and examples) will help other researchers test the usefulness of their approach. The evidence is <bold>convincing</bold>, but could further benefit from an objective way by which the output of their model can be compared/judged or through results from synthetic data with known properties.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.91949.1.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
These types of analyses use many underlying assumptions about the data, which are not easy to verify. Hence, one way to test how the algorithm is performing in a task is to study its performance on synthetic data in which the properties of the variable of interest can be apriori fixed. For example, for burst detection, synthetic data can be generated by injected bursts of known durations, and checking if the algorithm is able to pick it up. Burst detection is difficult in the spectral domain since direct spectral estimators have high variance (see Subhash Chandran et al., 2018, J Neurophysiol). Therefore, detected burst lengths are typically much lower than injected burst lengths (see Figure 3). This problem can be solved by doing burst estimation in the time domain itself, for example, using Matching Pursuit (MP). I think the approach presented in this paper would also work since this model is also trained on data in the time domain. Indeed, the synthetic data can be made more &quot;challenging&quot; by injecting multiple oscillatory bursts that are overlapping in time, for which a greedy approach like MP may fail. It would be very interesting to test whether this method can &quot;keep up&quot; as the data is made more challenging. While showing results from brain signals directly (e.g., Figure 7) is nice, it will be even more impactful if it is backed up with results obtained from synthetic data with known properties.</p>
<p>I was wondering about what kind of &quot;synthetic data&quot; could be used for the results shown in Figure 8-12 but could not come up with a good answer. Perhaps data in which different sensory systems are activated (visual versus auditory) or sensory versus movement epochs are compared to see if the activation maps change as expected. We see similarities between states across multiple runs (reproducibility analysis) and across tasks (e.g. Figure 8 vs 9) and even methods (Figure 8 vs 10), which is great. However, we should also expect the emergence of new modes specific to sensory activation (say auditory cortex for an auditory task). This will allow us to independently check the performance of this method.</p>
<p>The authors should explain the reproducibility results (variational free energy and best run analysis) in the Results section itself, to better orient the reader on what to look for.</p>
<p>Page 15: the comparison across subjects is interesting, but it is not clear why sensory-motor areas show a difference and the mean lifetime of the visual network decreases. Can you please explain this better? The promised discussion in section 3.5 can be expanded as well.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.91949.1.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
The authors have developed a comprehensive set of tools to describe dynamics within a single time-series or across multiple time-series. The motivation is to better understand interacting networks within the human brain. The time-series used here are from direct estimates of the brain's electrical activity; however, the tools have been used with other metrics of brain function and would be applicable to many other fields.</p>
<p>Strengths:</p>
<p>
The methods described are principled, and based on generative probabilistic models.</p>
<p>
This makes them compact descriptors of the complex time-frequency data.</p>
<p>
Few initial assumptions are necessary in order to reveal this compact description.</p>
<p>
The methods are well described and demonstrated within multiple peer-reviewed articles.</p>
<p>
This toolbox will be a great asset to the brain imaging community.</p>
<p>Weaknesses:</p>
<p>
The only question I had was how to objectively/quantitatively compare different network models. This is possibly easily addressed by the authors.</p>
</body>
</sub-article>
</article>