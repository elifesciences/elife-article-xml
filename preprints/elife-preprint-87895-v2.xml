<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">87895</article-id>
<article-id pub-id-type="doi">10.7554/eLife.87895</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.87895.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Physics of Living Systems</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>How microscopic epistasis and clonal interference shape the fitness trajectory in a spin glass model of microbial long-term evolution</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1336-7568</contrib-id>
<name>
<surname>Boffi</surname>
<given-names>Nicholas M.</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Guo</surname>
<given-names>Yipei</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rycroft</surname>
<given-names>Chris H.</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
<xref ref-type="aff" rid="a4">4</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Amir</surname>
<given-names>Ariel</given-names>
</name>
<xref ref-type="aff" rid="a5">5</xref>
<xref ref-type="aff" rid="a6">6</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Courant Institute of Mathematical Sciences, New York University</institution></aff>
<aff id="a2"><label>2</label><institution>Janelia Research Campus</institution></aff>
<aff id="a3"><label>3</label><institution>Department of Mathematics, University of Wisconsin–Madison</institution></aff>
<aff id="a4"><label>4</label><institution>Mathematics Group, Lawrence Berkeley National Laboratory</institution></aff>
<aff id="a5"><label>5</label><institution>Weizmann Institute of Science</institution></aff>
<aff id="a6"><label>6</label><institution>John A. Paulson School of Engineering and Applied Sciences, Harvard University</institution></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Ogbunugafor</surname>
<given-names>C Brandon</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Yale University</institution>
</institution-wrap>
<city>New Haven</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Landry</surname>
<given-names>Christian R</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Université Laval</institution>
</institution-wrap>
<city>Québec</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label> Corresponding author; email: <email>boffi@cims.nyu.edu</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-06-15">
<day>15</day>
<month>06</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2023-09-11">
<day>11</day>
<month>09</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP87895</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-03-29">
<day>29</day>
<month>03</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-01-20">
<day>20</day>
<month>01</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.01.16.524306"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-06-15">
<day>15</day>
<month>06</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.87895.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.87895.1.sa2">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.87895.1.sa1">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.87895.1.sa0">Reviewer #2 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Boffi et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Boffi et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-87895-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>The adaptive dynamics of evolving microbial populations takes place on a complex fitness landscape generated by epistatic interactions. The population generically consists of multiple competing strains, a phenomenon known as clonal interference. Microscopic epistasis and clonal interference are central aspects of evolution in microbes, but their combined effects on the functional form of the population’s mean fitness are poorly understood. Here, we develop a computational method that resolves the full microscopic complexity of a simulated evolving population subject to a standard serial dilution protocol. Through extensive numerical experimentation, we find that stronger microscopic epistasis gives rise to fitness trajectories with slower growth independent of the number of competing strains, which we quantify with power-law fits and understand mechanistically via a random walk model that neglects dynamical correlations between genes. We show that increasing the level of clonal interference leads to fitness trajectories with faster growth (in functional form) without microscopic epistasis, but leaves the rate of growth invariant when epistasis is sufficiently strong, indicating that the role of clonal interference depends intimately on the underlying fitness landscape. The simulation package for this work may be found at <ext-link ext-link-type="uri" xlink:href="https://github.com/nmboffi/spin_glass_evodyn">https://github.com/nmboffi/spin_glass_evodyn</ext-link>.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Addition of comparison to spin glass physics and link to code.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>Laboratory evolution experiments have demonstrated the widespread prevalence of microscopic epistasis, the tendency for the phenotype associated with a mutation to depend on the background genotype in which it emerged (<xref ref-type="bibr" rid="c36">Khan et al., 2011</xref>; <xref ref-type="bibr" rid="c9">Chou et al., 2011</xref>; <xref ref-type="bibr" rid="c70">Wang et al., 2013</xref>; <xref ref-type="bibr" rid="c25">Good and Desai, 2015</xref>; <xref ref-type="bibr" rid="c5">Bakerlee et al., 2022</xref>; <xref ref-type="bibr" rid="c40">Kryazhimskiy et al., 2014</xref>; <xref ref-type="bibr" rid="c14">Diaz-Colunga et al., 2022</xref>). Basic evolutionary theory indicates that for moderate mutation rates the overall population will consist of many competing strains, because additional mutations can emerge before an existing mutation has time to fix in the culture (<xref ref-type="bibr" rid="c19">Gerrish and Lenski, 1998</xref>; <xref ref-type="bibr" rid="c12">Desai and Fisher, 2007</xref>; <xref ref-type="bibr" rid="c11">de Visser and Rozen, 2006</xref>; <xref ref-type="bibr" rid="c57">Park and Krug, 2007</xref>). This “clonal interference” is consistently observed in laboratory experiments such as Lenski’s long-term evolution experiment (LTEE) (<xref ref-type="bibr" rid="c17">Fogle et al., 2008</xref>; <xref ref-type="bibr" rid="c46">Lenski et al., 1991</xref>; <xref ref-type="bibr" rid="c45">Lenski and Travisano, 1994</xref>; <xref ref-type="bibr" rid="c44">Lenski, 2017</xref>; <xref ref-type="bibr" rid="c74">Wiser et al., 2013</xref>). Yet, despite the agreed-upon ubiquity of both aspects of evolution, there are few quantitative predictions for how they affect some of the most common experimental outputs, such as the mean fitness of the population. The central difficulty arises from the need to treat both the population and the genome at the microscopic level, which requires sophisticated analytical tools or high-resolution experiments.</p>
<p>The traditional approach in evolutionary theory is to make use of assumptions and statistical model classes that sidestep these complexities. Most theoretical studies of long-term adaptation take place in the “strong selection weak mutation” (SSWM) limit (<xref ref-type="bibr" rid="c21">Gillespie, 1983</xref>, <xref ref-type="bibr" rid="c22">1984</xref>, <xref ref-type="bibr" rid="c23">1991</xref>; <xref ref-type="bibr" rid="c55">Orr, 2002</xref>; <xref ref-type="bibr" rid="c26">Good et al., 2012</xref>), where the time for a beneficial mutation event to occur is large in comparison to the time for a typical beneficial mutation to fix in the population. While convenient due to analytical simplifications, this limit neglects clonal interference by ensuring that the culture consists of a single dominant strain at almost all times, and is hence known to be invalid for populations under standard laboratory conditions (<xref ref-type="bibr" rid="c11">de Visser and Rozen, 2006</xref>). As an unfortunate by-product, even if the predictions of a model are found to match experimental data, it is not clear how the addition of clonal interference will change the results.</p>
<p>To avoid the analytical and computational challenges associated with modeling the genome at microscopic granularity, significant theoretical effort has been spent studying macroscopic “rugged” or “uncorrelated” models (<xref ref-type="bibr" rid="c34">Kauffman and Levin, 1987</xref>; <xref ref-type="bibr" rid="c35">Kauffman and Weinberger, 1989</xref>; <xref ref-type="bibr" rid="c73">Wilke, 2004</xref>; <xref ref-type="bibr" rid="c49">Macken and Perelson, 1989</xref>; <xref ref-type="bibr" rid="c16">Flyvbjerg and Lautrup, 1992</xref>; <xref ref-type="bibr" rid="c37">Kingman, 1978</xref>), which posit the fitness of a mutant to be drawn at random from a fixed distribution (<xref ref-type="bibr" rid="c58">Park and Krug, 2008</xref>). More recently, macroscopic “fitness-parameterized” models – which assume the distribution of fitness effects (DFE) depends only on the fitness of the parent – have garnered interest as a way to model correlations in the fitness landscape (<xref ref-type="bibr" rid="c38">Kryazhimskiy et al., 2009</xref>). Although macroscopic models have provided significant insight into evolutionary dynamics, both classes exhibit serious disadvantages. Rugged landscapes make predictions that are known to violate experimental measurements, such as the typical length of an adaptive walk (<xref ref-type="bibr" rid="c56">Orr, 2006</xref>). Fitness-parameterized models can help correct some of these issues, but to do so they require an assumption about how the DFE depends on fitness, which is typically unknown because of its experimental intractability.</p>
<p>One approach that corrects the deficiencies of macroscopic models is the use of microscopic models, which treat the genome as a sequence of loci each with a binary label indicating the presence or absence of a mutation. Perhaps the most well-studied microscopic model in evolutionary theory is Kauffman’s NK model (<xref ref-type="bibr" rid="c34">Kauffman and Levin, 1987</xref>), but similar microscopic models can be obtained systematically via Fourier expansion (<xref ref-type="bibr" rid="c53">Neher and Shraiman, 2011</xref>). This approach leads to the class of spin glass models well-studied in statistical physics (<xref ref-type="bibr" rid="c63">Sherrington and Kirkpatrick, 1975</xref>; <xref ref-type="bibr" rid="c67">Sompolinsky and Zippelius, 1982</xref>; Arous et al., 2001), theoretical neuroscience (<xref ref-type="bibr" rid="c2">Amit et al., 1985a</xref>,<xref ref-type="bibr" rid="c3">b</xref>; <xref ref-type="bibr" rid="c31">Hopfield, 1982</xref>), ecology (<xref ref-type="bibr" rid="c62">Roy et al., 2020</xref>), machine learning (<xref ref-type="bibr" rid="c8">Choromanska et al., 2015</xref>), and combinatorial optimization (<xref ref-type="bibr" rid="c50">Mezard and Montanari, 2009</xref>; <xref ref-type="bibr" rid="c51">Mezard et al., 1987</xref>). Recently, spin glass models have been used to study the role of epistasis in adaptive dynamics, leading to insight into the generation of slow, logarithmic fitness trajectories (<xref ref-type="bibr" rid="c28">Guo et al., 2019</xref>) and into how macroscopic epistasis emerges from widespread microscopic interactions (<xref ref-type="bibr" rid="c61">Reddy and Desai, 2021</xref>). But due to the computational expense of full-scale microscopic simulations, these prior works make the SSWM assumption, which greatly simplifies the resulting adaptive dynamics to a process that is analytically tractable.</p>
<p>In order to understand the role played by microscopic epistasis and clonal interference in real-world evolving populations, we present a systematic numerical study of the evolutionary dynamics of a microbial culture under serial dilution on a microscopic fitness landscape far from the SSWM regime. To do so, we consider a spin glass type model that enables us to independently tune the magnitude of epistasis and the level of clonal interference in the culture. The model contains both additive and epistatic terms. The relative magnitude of the two terms can be adjusted, and the epistatic interaction takes place pairwise between two loci on the genome.</p>
<p>To resolve the adaptive dynamics, we develop a high-performance, <monospace>OpenMP</monospace>-based multi-threaded implementation of the resulting stochastic process in <monospace>C++</monospace>, which we use to study an adaptive walk to a fitness peak comprising a few hundred fixation events. The implementation leverages several algorithmic advances to capture the complete microscopic details of the process over long timescales: an efficient algorithm for computation of the fitness that leverages the structure of the epistatic interaction, a hashing-based method for storage of strains by genotype for fast splitting and joining, and an efficient approach for diluting the culture. These algorithmic advances render tractable the computation of the entire distribution of fitness effects, the complete sequence of fixed mutations along with their individual effects, and the number of remaining beneficial mutations for any strain at any time with realistic population sizes (one hundred million bacteria) over realistic timescales (tens of thousands of generations). In the strong clonal interference regime, tracking all microscopic details generates hundreds of gigabytes of data; the resulting datasets are processed by custom-built <monospace>Python</monospace> code that produces standard, experimentally-measurable observables.</p>
<p>Our framework brings insight into both real-world experimental systems and modern approaches in evolutionary theory. To this end, we show that hill-climbing dynamics on a random and sparse fitness landscape with two-point interactions cannot give rise to the slow, low-exponent power law trajectories observed in Lenski’s LTEE even with clonal interference, suggesting that other factors such as structured interactions might be at play. Moreover, we show that any macroscopic fitness-parameterized model used to describe a microscopic process must depend intrinsically on the level of clonal interference in the population, implying that the DFE in a macroscopic model for an experimental system must be tuned to the mutation rate of the culture.</p>
<p>The paper is organized as follows. In Model details, we describe details of the fitness landscape and the simulation. In Landscape ruggedness slows the fitness trajectory, we show how microscopic epistasis slows the functional form of the fitness trajectory independent of the level of clonal interference. In A fitness-parameterized mapping and A random walk model, we develop simplified macrosopic models to interpret and explain mechanistically the effect of microscopic epistasis. In The effect of clonal interference, we show how the effect of clonal interference depends on the strength of microscopic epistasis, and that an accurate fitness parameterized model must be tuned to the level of clonal interference in the population. We conclude with a discussion and extensions in Discussion and conclusions.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Model details</title>
<sec id="s2a">
<label>2.1</label>
<title>Definition</title>
<p>To study the effect of microscopic epistasis on the average fitness trajectory, it is useful to model the genome as a sequence of sites and to consider fitness landscapes that specify the fitness as a function of the state of the genome. We study a generic finite-sites microscopic model (<xref rid="fig1" ref-type="fig">Figure 1</xref>) inspired by the Sherrington-Kirkpatrick spin glass in statistical physics (<xref ref-type="bibr" rid="c63">Sherrington and Kirkpatrick, 1975</xref>). In the next subsection, we elaborate on the generality of a model of this form.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1:</label>
<caption><title>The microscopic epistasis model</title>
<p>(A) The fitness of a given strain is defined by its genotype <italic><bold>α</bold></italic> ∈ {±1}<sup><italic>L</italic></sup>. Each gene <italic>i</italic> contributes <italic>α</italic><sub><italic>i</italic></sub><italic>h</italic><sub><italic>i</italic></sub> independent of the background genotype and an epistatic contribution <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline14.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> due to its interaction with all other genes. The <italic>h</italic><sub><italic>i</italic></sub> and <italic>J</italic><sub><italic>ij</italic></sub> values are drawn randomly, and the relative magnitudes of the two contributions can be tuned by adjusting a parameter <italic>β</italic> ∈ [0, 1]. Each gene interacts, on average, with a fraction <italic>ρ</italic> of other genes. The fitness landscape is thus described by a disordered network, here shown for <italic>L</italic> = 250 and <italic>ρ</italic> = 0.05, with color indicating magnitude and connectivity demonstrating the sparsity pattern of the <italic>J</italic><sub><italic>ij</italic></sub>. (B) A typical hill-climbing trajectory with both clonal interference (<italic>µ</italic> = 2 × 10<sup>−4</sup>) and microscopic epistasis (<italic>β</italic> = 0.5). Replicate trajectories are displayed in low opacity, while the mean over all replicates is shown in open circles with error bars depicting the standard error of the mean. The mean fitness is consistent with a power-law relaxation with exponent <italic>c</italic> ≈ 0.575 (solid). The inset displays the trajectory (dashed) and the best-fit power law (solid, shifted for visual clarity) on a log-log scale. (C) As <italic>β</italic> is increased, the epistatic contribution becomes more significant, and the landscape smoothly becomes more rugged. (D) As the mutation rate increases, the magnitude of clonal interference can be smoothly tuned.</p></caption>
<graphic xlink:href="524306v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s2a1">
<title>The fitness model</title>
<p>With <italic>L</italic> denoting the length of the genome, the fitness of a strain with genotype <bold><italic>α</italic></bold> ∈ {±1}<sup><italic>L</italic></sup> is given by the expression
<disp-formula id="eqn1">
<alternatives><graphic xlink:href="524306v2_eqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Here, <italic>F</italic><sub>off</sub> is an arbitrary offset value that can be used to fix the initial fitness independent of the initial genotype. Inspired by experimental competition assays in typical laboratory microbial evolution settings, we compare the fitness of a given strain to the fitness of the ancestral strain. To do so, we choose <italic>F</italic><sub>off</sub> so that the fitness of the ancestral strain is equal to one; this arbitrary shift has no effect on the dynamics or our conclusions.</p>
<p>In (1), each <italic>h</italic><sub><italic>i</italic></sub> represents the instantaneous contribution of a mutation at gene <italic>i</italic> to the fitness of the strain in the absence of epistasis. Each <italic>J</italic><sub><italic>ij</italic></sub> = <italic>J</italic><sub><italic>ji</italic></sub> describes the microscopic epistasis between mutations at genes <italic>i</italic> and <italic>j</italic>. Realistic biological fitness landscapes are thought to be rugged, containing many local extrema. By taking the values of <italic>h</italic><sub><italic>i</italic></sub> and <italic>J</italic><sub><italic>ij</italic></sub> to be random, (1) gives rise to such a complex fitness landscape.</p>
</sec>
<sec id="s2a2">
<title>Disorder statistics</title>
<p>Because biological networks are typically sparse (<xref rid="c68" ref-type="bibr">Tong et al., 2004</xref>; <xref rid="c10" ref-type="bibr">Costanzo et al., 2016</xref>), our model is such that each gene only interacts on average with a fraction 0 <italic>&lt; ρ</italic> ≤ 1 of the other genes. <italic>ρ</italic> is typically on the order of a few percent in realistic networks, and we set <italic>ρ</italic> accordingly. These considerations lead to the choice of distributions
<disp-formula id="ueqn1">
<alternatives><graphic xlink:href="524306v2_ueqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
with <italic>J</italic><sub><italic>ii</italic></sub> = 0 for all <italic>i</italic>. Above, N(<italic>µ, σ</italic><sup>2</sup>) denotes a normal distribution with mean <italic>µ</italic> and variance <italic>σ</italic><sup>2</sup>, and Ber(<italic>ρ</italic>) denotes a Bernoulli distribution with parameter <italic>ρ</italic>. The variances are set to <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline1.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline2.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> where 0 ≤ <italic>β</italic> ≤ 1 sets the magnitude of microscopic epistasis and Δ &gt; 0 sets the magnitude of generic fitness increments. This scaling with <italic>β</italic> ensures that the fitness increase at initialization <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline3.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is approximately independent of <italic>β</italic>. This choice provides a useful setting to qualitatively compare the speed of fitness trajectories in addition to quantitative measures such as fitting parametric functional forms (<xref ref-type="bibr" rid="c27">Guo and Amir, 2022</xref>). Typical fitness increments in laboratory experiments are on the order of a few percent of the ancestral strain’s fitness (<xref rid="c6" ref-type="bibr">Barrick et al., 2009</xref>), and we choose Δ to match this observation. Our conclusions about the roles of epistasis and clonal interference (and their mechanisms) do not depend on the specific choice.</p>
</sec>
<sec id="s2a3">
<title>Fitness trajectories</title>
<p>The fitness landscape is defined by a sparse and random genetic interaction network (<xref rid="fig1" ref-type="fig">Figure 1A</xref>). Adaptation dynamics produce fitness trajectories (<xref rid="fig1" ref-type="fig">Figure 1B</xref>) qualitatively consistent with experimental observations of long-term evolution in microbial populations (<xref ref-type="bibr" rid="c44">Lenski, 2017</xref>), leading to power-law trajectories with exponents between 0.45 and 3.1. For details on how these trajectories and exponents are produced, see Further simulation details.</p>
</sec>
<sec id="s2a4">
<title>Landscape structure</title>
<p>The parameter <italic>β</italic> can be used to continuously tune the ruggedness of the landscape (<xref rid="fig1" ref-type="fig">Figure 1C</xref>). For <italic>β</italic> = 0, there is no microscopic epistasis, and the evolutionary dynamics corresponds to a hill-climbing event towards the single fitness maximum with value Σ <sub><italic>i</italic></sub> |<italic>h</italic><sub><italic>i</italic></sub>|. In the opposite extreme for <italic>β</italic> = 1, mutations do not have any effect independent of the genetic background, and the landscape is rife with local fitness maxima. In particular, for <italic>β</italic> &gt; 0, the landscape exhibits widespread sign epistasis, which is known to be necessary to generate rugged features thought to be present in realistic experimental fitness landscapes (<xref ref-type="bibr" rid="c71">Weinreich et al., 2005</xref>). By systematically varying this parameter and observing its effect on the average fitness trajectory throughout the approach to a fitness maximum, we quantify the role of microscopic epistasis in <italic>slowing</italic> the functional form (i.e., reducing the power-law exponent) of the fitness trajectory both with and without clonal interference.</p>
<p>The structure of the landscape near the initialization can also be tuned by adjusting the number of available beneficial mutations, or the <italic>rank R</italic>, of the ancestral strain. To remove this source of variability, we fix the rank of the ancestral strain to be identical across all experiments.</p>
</sec>
<sec id="s2a5">
<title>Dilution and selection</title>
<p>We study a batch culture subject to a standard serial dilution protocol (<xref ref-type="bibr" rid="c46">Lenski et al., 1991</xref>; <xref ref-type="bibr" rid="c47">Lin et al., 2020a</xref>; <xref ref-type="bibr" rid="c13">Desai et al., 2007</xref>; <xref ref-type="bibr" rid="c39">Kryazhimskiy et al., 2012</xref>). The population is allowed to grow until the total number of bacteria in the simulation reaches <italic>N</italic><sub><italic>f</italic></sub> = <italic>D</italic>×<italic>N</italic><sub>0</sub> where <italic>D</italic> is the dilution factor. When the total population size reaches <italic>N</italic><sub><italic>f</italic></sub>, we say that a day has been completed. At the end of each day, the population is diluted back to size <italic>N</italic><sub>0</sub> by sampling from a multivariate hypergeometric distribution. Repeated sampling from this distribution is computationally intensive, and we developed an efficient approximate scheme to do so in the strong clonal interference regime (see Further simulation details).</p>
</sec>
<sec id="s2a6">
<title>Simulation parameters</title>
<p>Motivated by Lenski’s long-term evolution experiment (<xref ref-type="bibr" rid="c46">Lenski et al., 1991</xref>; <xref ref-type="bibr" rid="c45">Lenski and Travisano, 1994</xref>), we set <italic>D</italic> = 100, <italic>N</italic><sub>0</sub> = 10<sup>6</sup>, and <italic>N</italic><sub><italic>f</italic></sub> = 10<sup>8</sup> in all simulations. We fix <italic>ρ</italic> = 0.05 and Δ = 0.005, respectively motivated by sparsity of biological networks and the overall magnitude of typical fitness increments in laboratory experiments. We set <italic>L</italic> = 1000, which corresponds to considering mutations at the level of each gene in <italic>E. coli</italic>. Because typically only a fraction of possible mutations are beneficial, we fix the initial rank to 100. The mutation rate <italic>µ</italic> and epistatic parameter <italic>β</italic> are varied and will be specified along with the results.</p>
</sec>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Choice of model</title>
<p>There are several compelling reasons to study the fitness model in <xref ref-type="disp-formula" rid="eqn1">Equation (1)</xref> that we now highlight.</p>
<sec id="s2b1">
<title>Generality</title>
<p><xref ref-type="disp-formula" rid="eqn1">Equation (1)</xref> represents the two lowest-order terms in a Fourier expansion of an arbitrary function defined on the Boolean hypercube (<xref ref-type="bibr" rid="c53">Neher and Shraiman, 2011</xref>). As such, our model represents a rigorously quantifiable approximation of <italic>any</italic> choice of fitness model defined on the hypercube.</p>
</sec>
<sec id="s2b2">
<title>Tunable epistasis</title>
<p>The presence of the continuous parameter <italic>β</italic> allows us to systematically vary the relative contribution of the epistatic interaction, enabling a detailed study of the effect of microscopic epistasis on the dynamics of adaptation. The well-known NK model (<xref ref-type="bibr" rid="c34">Kauffman and Levin, 1987</xref>) similarly contains a parameter (<italic>K</italic>, the number of genes in an epistatic interaction) that can be used to tune the ruggedness of the landscape. However, this parameter is discrete and changing it leads to a more drastic shift in the structure of the fitness landscape.</p>
</sec>
<sec id="s2b3">
<title>Tunable clonal interference</title>
<p>For low mutation rate, the population is in the SSWM regime and the evolutionary dynamics correspond to sequential sweeps of beneficial mutations throughout the population, which consists of a single dominant strain (<xref rid="fig1" ref-type="fig">Figure 1D</xref>). As the mutation rate increases, the adaptation dynamics become richer, enabling higher-order effects such as multiple mutations (<xref ref-type="bibr" rid="c72">Weissman et al., 2009</xref>), stochastic tunneling (<xref ref-type="bibr" rid="c33">Iwasa et al., 2004</xref>; <xref ref-type="bibr" rid="c28">Guo et al., 2019</xref>), and competing populations, all of which emerge naturally in our simulations.</p>
</sec>
<sec id="s2b4">
<title>Efficiency</title>
<p><xref ref-type="disp-formula" rid="eqn1">Equation (1)</xref> has significant computational advantages—summarized by <xref ref-type="statement" rid="lem1">Lemma 1</xref>— that enable us to develop a large-scale simulation. Leveraging algebraic simplifications intrinsic to the model’s mathematical structure, the fitness of a given strain may be computed as a correction to the fitness of a reference strain that is updated adaptively to track the state of the population. The resulting “adaptive fast fitness computation” is several orders of magnitude faster than a naive calculation, and our ability to simulate to long times in the strong clonal interference regime hinges upon it.</p>
</sec>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Results</title>
<sec id="s3a">
<label>3.1</label>
<title>Landscape ruggedness slows the fitness trajectory</title>
<p>We first study the effect of microscopic epistasis on the functional form of the fitness trajectory in both the SSWM (<italic>µ</italic> = 10<sup>−8</sup>) and clonal interference (<italic>µ</italic> = 2 × 10<sup>−4</sup>) mutation regimes (<xref rid="fig2" ref-type="fig">Figure 2</xref>). Intuitively, by complicating the fitness landscape and increasing the difficulty of the corresponding optimization problem, we expect greater levels of microscopic epistasis to lead to a slower fitness trajectory. Empirically, we find that the value of the fitness peak increases slightly with increasing <italic>β</italic>. To eliminate this variability, each mean fitness trajectory is normalized to lie between the values 1 and 2 for visualization. The fitness trajectory takes more time to approach its asymptotic value as <italic>β</italic> increases, indicating a slower approach towards equilibrium (<xref rid="fig2" ref-type="fig">Figure 2A/B</xref>).</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2:</label>
<caption><title>Increasing landscape ruggedness slows the fitness trajectory. Left: SSWM. Right: Clonal interference.</title>
<p>Error bars for the first four panes (shown as shaded regions, for this and other figures) indicate standard error of the mean over replicates. (A) Normalized fitness trajectories as a function of <italic>β</italic> in the SSWM limit (<italic>µ</italic> = 10<sup>−8</sup>). Higher values of <italic>β</italic> exhibit a slower approach towards the fitness peak. (B) Normalized fitness trajectories in the clonal interference regime (<italic>µ</italic> = 2 × 10<sup>−4</sup>). (C) Substitution trajectories in the SSWM limit (<italic>µ</italic> = 10<sup>−8</sup>). Higher values of <italic>β</italic> lead to a greater number of fixed mutations. (D) Substitution trajectories in the clonal interference regime (<italic>µ</italic> = 2 × 10<sup>−4</sup>). (E) Fitness relaxation exponents as a function of <italic>β</italic> in the SSWM limit and clonal interference regimes. As <italic>β</italic> increases, the fitness relaxation slows. Dashed lines indicate analytically-computable exponents <italic>c</italic> = 2.0 for <italic>β</italic> = 0 and <italic>c</italic> = 0.5 for <italic>β</italic> = 1.0 in the SSWM regime. Error bars indicate 95% quantiles computed from the bootstrap distribution (for details, see Further simulation details).</p></caption>
<graphic xlink:href="524306v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Insight into the mechanism by which epistasis slows the fitness trajectory can be obtained by visualizing the substitution trajectories (<xref rid="fig2" ref-type="fig">Figure 2C/D</xref>), which describe the number of mutations that have fixed in the population at time <italic>t</italic>. The substitution trajectories demonstrate that increasing the amount of microscopic epistasis smoothly leads to an accumulation of more fixed mutations at each time. Because the initial rank (the number of available beneficial mutations) is identical for each value of <italic>β</italic>, the substitution trajectories suggest a simple picture: as <italic>β</italic> increases, a greater number of new available beneficial mutations are generated per each typical fixation event. Moreover, because more mutations are needed to cease adaptation, each typical fixation event must provide less progress towards the fitness peak. Mathematically, this corresponds to a greater prevalence of “flat regions” in the fitness landscape, which have been identified as a source of slow dynamics in previous studies of spin-glass physics (<xref ref-type="bibr" rid="c41">Kurchan and Laloux, 1996</xref>).</p>
<p>These observations highlight the role of microscopic epistasis in slowing down long-term evolutionary dynamics, but they do not make a quantitative claim about the functional form of the fitness trajectory. To make such a claim, we can fit the data to a predictive model and study how the model parameters depend on <italic>β</italic>. The functional form of the fitness trajectory can be computed analytically in the SSWM regime in a fitness-parameterized context approximately met by our fitness model with <italic>β</italic> = 0 (<xref ref-type="bibr" rid="c25">Good and Desai, 2015</xref>); the resulting trajectory is given by the power-law relaxation
<disp-formula id="eqn2">
<alternatives><graphic xlink:href="524306v2_eqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
with <italic>F</italic><sub>∞</sub> = Σ|<italic>h</italic><sub><italic>i</italic></sub>|, <italic>c</italic> = 2, and <italic>F</italic><sub>0</sub> = 1 by our choice of <italic>F</italic><sub>off</sub>. We find empirically that in both the SSWM and clonal interference regimes, the power-law in (2) provides a good fit to the mean fitness trajectory for <italic>β</italic> &gt; 0.</p>
<p>We fit (2) to the mean fitness trajectory (see Further simulation details) over a range of values of <italic>β</italic> (<xref rid="fig2" ref-type="fig">Figure 2E</xref>). In both regimes, the relaxation exponent <italic>c</italic> decreases monotonically with increasing <italic>β</italic>, indicating a quantitative slowdown of the fitness trajectory with increasing levels of microscopic epistasis. In the next section, we will show that we can estimate the exponent <italic>c</italic> = 0.5 for <italic>β</italic> = 1.0 in the SSWM regime.</p>
</sec>
<sec id="s3b">
<label>3.2</label>
<title>A fitness-parameterized mapping</title>
<p>The mechanism suggested by the substitution trajectories can be confirmed by mapping the microscopic model to a fitness-parameterized landscape with two effective parameters: a single beneficial fitness increment given by the expected beneficial fitness increment ⟨Δ<italic>F</italic><sub><italic>b</italic></sub>⟩<sup><xref ref-type="fn" rid="fn1">1</xref></sup>, and a beneficial mutation rate set by the rank <italic>R</italic> (<xref rid="fig3" ref-type="fig">Figure 3</xref>). The reduction to a few-parameter fitness-parameterized model has been justified both theoretically (<xref ref-type="bibr" rid="c26">Good et al., 2012</xref>) and experimentally (<xref ref-type="bibr" rid="c30">Hegreness et al., 2006</xref>) in the clonal interference regime, and we find that it similarly provides useful insight in the SSWM regime.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3:</label>
<caption><title>A mapping to a fitness-parameterized landscape as a function of <italic>β</italic>. Top: SSWM. Bottom: Clonal interference.</title>
<p>Error bars in the first four panes indicate standard error of the mean over replicates. (A) Rank as a function of fitness in the SSWM regime. The functional form of <italic>R</italic>(<italic>F</italic>) changes significantly as <italic>β</italic> varies, progressing from a concave decreasing function for <italic>β</italic> = 0.25 towards a linear form for <italic>β</italic> = 1. For all <italic>β</italic> ≠ 0, the rank decreases monotonically with <italic>β</italic>. (B) Expected normalized beneficial fitness increment ⟨Δ<italic>F</italic><sub><italic>b</italic></sub>⟩ as a function of normalized fitness in the SSWM regime. Global epistasis emerges naturally in our model, leading to a linear decrease in ⟨Δ<italic>F</italic><sub><italic>b</italic></sub>⟩ with <italic>F</italic> for all nonzero values of <italic>β</italic>. For all values of <italic>β</italic>, the increment decreases monotonically with <italic>β</italic>. (C/D) Rank/expected increment as a function of fitness with clonal interference; similar observations hold as for SSWM.</p></caption>
<graphic xlink:href="524306v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In both mutation regimes, for all nonzero values of <italic>β</italic>, the expected beneficial increment behaves linearly as a function of fitness (<xref rid="fig3" ref-type="fig">Figure 3B/D</xref>). This phenomenon is known as “macroscopic” or “global” epistasis, and has been shown to be an emergent property of a class of finite-sites models similar to the one considered here (<xref ref-type="bibr" rid="c61">Reddy and Desai, 2021</xref>). Consistent with the observations of the previous section, the expected beneficial increment (scaled relative to the fitness peak) decreases with <italic>β</italic> at fixed fitness, which highlights that microscopic epistasis tends to reduce the progress towards the peak provided by each typical fixation event.</p>
<p>Unlike the beneficial fitness increment, the rank <italic>R</italic>(<italic>F</italic>) exhibits more variation in functional form as <italic>β</italic> is varied, which progresses towards linearity as <italic>β</italic> tends to one (<xref rid="fig3" ref-type="fig">Figure 3A/C</xref>). Considering only <italic>β</italic> &gt; 0, <italic>R</italic>(<italic>F</italic>) decreases with increasing <italic>β</italic> at each <italic>F</italic>; including <italic>β</italic> = 0, this is also true for sufficiently large <italic>F</italic>. This indicates that at any fixed relative distance from the fitness peak, beneficial mutation events become more rare as <italic>β</italic> increases.</p>
<p>Taken together, these observations demonstrate that microscopic epistasis leads to a slower fitness trajectory through two complementary effects. At each fixed value of fitness, beneficial mutations are less likely to be found by random mutation; moreover, more of them are required to reach the peak due to a lower typical (normalized) increment. These additional beneficial mutations are generated by the epistatic interaction as each fixation event occurs.</p>
<sec id="s3b1">
<title>Quantitative model</title>
<p>These arguments can also be justified mathematically, leading to a quantitative prediction of <italic>c</italic> = 0.5 for <italic>β</italic> = 1, consistent with the result in <xref rid="fig2" ref-type="fig">Figure 2E</xref>. In such a two-parameter macroscopic model, the fitness evolves according to the dynamics
<disp-formula id="eqn3">
<alternatives><graphic xlink:href="524306v2_eqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where each quantity on the right-hand side is evaluated at <italic>F</italic> (<italic>t</italic>). In the SSWM regime, <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline4.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> according to Haldane’s formula (<xref ref-type="bibr" rid="c29">Haldane, 1927</xref>). The preceding paragraphs demonstrate that <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline5.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> decreases as a function of <italic>β</italic> for each fixed <italic>F</italic>, giving rise to a slower trajectory. From <xref rid="fig3" ref-type="fig">Figure 3A/B</xref>, both <italic>R</italic>(<italic>F</italic>) and ⟨Δ<italic>F</italic><sub><italic>b</italic></sub>⟩(<italic>F</italic>) are approximately linear and reach zero at <italic>F</italic> = 2. Hence <italic>R</italic> ≈ <italic>k</italic>⟨Δ<italic>F</italic><sub><italic>b</italic></sub>⟩ for a fixed <italic>k</italic> &gt; 0. <xref ref-type="disp-formula" rid="eqn3">Equation 3</xref> then reads
<disp-formula id="ueqn2">
<alternatives><graphic xlink:href="524306v2_ueqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
which predicts that asymptotically
<disp-formula id="ueqn3">
<alternatives><graphic xlink:href="524306v2_ueqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
for a fixed <italic>B</italic> &gt; 0. This prediction provides a complement to the analytical result of <italic>c</italic> = 2 in the SSWM regime with <italic>β</italic> = 0.</p>
</sec>
</sec>
<sec id="s3c">
<label>3.3</label>
<title>A random walk model</title>
<p>The previous sections provided an explanation for the effect of microscopic epistasis on long-term adaptation dynamics: as the level of microscopic epistasis increases, the typical number of available beneficial mutations at fixed fitness decreases while the number of fixed mutations required to reach the peak increases, leading to a slower trajectory. In this section, we formulate a mechanistic model that provides a qualitative explanation for why microscopic epistasis generates new beneficial mutations and slows the trajectory.</p>
<sec id="s3c1">
<title>Distribution of increments</title>
<p>The previous section highlighted that the mechanism is common to both the SSWM and clonal interference regimes, for which reason we restrict to the SSWM limit in the subsequent analysis. In the SSWM limit, a single empirical distribution of fitness effects is induced by the fitness landscape
<disp-formula id="eqn4">
<alternatives><graphic xlink:href="524306v2_eqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where Δ<italic>F</italic><sub><italic>i</italic></sub>(<italic>t</italic>) = −2<italic>α</italic><sub><italic>i</italic></sub>(<italic>t</italic>) (<italic>h</italic><sub><italic>i</italic></sub> + Σ<sub><italic>j</italic></sub> <italic>J</italic><sub><italic>ij</italic></sub><italic>α</italic><sub><italic>j</italic></sub>(<italic>t</italic>)) is the fitness effect of a mutation at gene <italic>i</italic> at time <italic>t</italic>. Because there is only a single strain, the dynamics of adaptation can be characterized entirely by the evolution of <italic>ρ</italic><sub><italic>t</italic></sub> in time. When a mutation at site <italic>i</italic> fixes (which can only occur if Δ<italic>F</italic><sub><italic>i</italic></sub>(<italic>t</italic>) &gt; 0), the corresponding increment is updated:
<disp-formula id="eqn5">
<alternatives><graphic xlink:href="524306v2_eqn5.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
In the absence of microscopic epistasis, each such fixation event would decrease the rank by one until all available beneficial mutations have fixed. However, due to microscopic epistasis, the fixation of a mutation at gene <italic>i</italic> causes a change in all other fitness increments:
<disp-formula id="eqn6">
<alternatives><graphic xlink:href="524306v2_eqn6.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
The update to the fitness increment in (6) is complex due to the presence of correlations between <italic>α</italic><sub><italic>i</italic></sub> and <italic>α</italic><sub><italic>j</italic></sub> induced by the coupling <italic>J</italic><sub><italic>ij</italic></sub>. Moreover, the distribution of <italic>α</italic><sub><italic>i</italic></sub><italic>α</italic><sub><italic>j</italic></sub><italic>J</italic><sub><italic>ij</italic></sub> must be conditioned on the event that Δ<italic>F</italic><sub><italic>i</italic></sub> &gt; 0. Previous studies in spin glass (<xref ref-type="bibr" rid="c32">Horner, 2007</xref>; <xref ref-type="bibr" rid="c15">Eastham et al., 2006</xref>) and electron glass (<xref ref-type="bibr" rid="c52">Mogilyanskii and Raikh, 1989</xref>; <xref ref-type="bibr" rid="c1">Amir et al., 2008</xref>) physics have obtained significant physical insight by neglecting these dynamical correlations, and here we take a similar approach.</p>
</sec>
<sec id="s3c2">
<title>Update statistics</title>
<p>The neglect of dynamical correlations implies that the effect of each fixation event is to add a random Gaussian noise term with probability <italic>ρ</italic> (the network sparsity parameter) to all other increments,
<disp-formula id="eqn7">
<alternatives><graphic xlink:href="524306v2_eqn7.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Above, <italic>µ</italic><sub><italic>β</italic></sub> and <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline6.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> are mean and variance parameters of the noise distribution; these can be estimated numerically from data to account for initialization from a state with <italic>R</italic> = 100 and to condition on beneficial mutation events (see Further simulation details). This process corresponds to a biased random walk (<xref ref-type="disp-formula" rid="eqn7">Equation (7)</xref>) with nonlocal transport (<xref ref-type="disp-formula" rid="eqn5">Equation (5)</xref>) on the fitness increments.</p>
</sec>
<sec id="s3c3">
<title>Coarse-grained simulation</title>
<p>To test this mechanistic model, we developed a coarse-grained simulation methodology based on Gillespie’s stochastic simulation algorithm (<xref ref-type="bibr" rid="c20">Gillespie, 1976</xref>) (see Further simulation details). Fitting the power law in (2) to the mean fitness trajectories shows that the random walk model predicts a monotonically decreasing exponent and a monotonically increasing number of fixed mutations as a function of <italic>β</italic> (<xref rid="fig4" ref-type="fig">Figure 4A</xref>). This is qualitatively consistent with the results of applying the same coarse-grained simulation approach in the SSWM approximation to the full fitness model (<xref rid="fig4" ref-type="fig">Figure 4B</xref>). Due to the neglect of correlations, the random walk model predicts a lower number of generated beneficial mutations and a correspondingly higher fitness exponent.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4:</label>
<caption><title>A simple random walk model captures the generation of beneficial mutations and a decreasing exponent with increasing microscopic epistasis.</title>
<p>(A) Fitness relaxation exponent and number of fixed mutations to reach a local fitness maximum (zero rank) as a function of <italic>β</italic>, computed within the random walk model (which neglects correlations). The model predicts a monotonically decreasing exponent and a monotonically increasing number of fixations as a function of <italic>β</italic>. Error bars around exponents indicate 95% quantiles from the bootstrap distribution (100 samples) while central line depicts the median. Error bars around number of fixations indicate standard deviation over 200 replicates and central line the mean. (B) Analogous figure to (A), but within the SSWM approximation using a coarse-grained Gillespie simulation framework (where correlations develop over time). The behavior is qualitatively similar to the random walk model, though the exponent decreases further and the number of fixation events is larger. (C) Illustration of the diffusive generation of mutations. As beneficial mutations fix, the beneficial half of the distribution of fitness increments <italic>ρ</italic><sub><italic>t</italic></sub>(Δ<italic>F</italic>) is depleted and transported to the deleterious half. Each fixation event causes the distribution to broaden due to the epistatic interaction, which combines with a buildup of deleterious mutations to create a diffusive flux from the deleterious half to the beneficial half of the distribution.</p></caption>
<graphic xlink:href="524306v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s3c4">
<title>Why are beneficial mutations generated?</title>
<p>Because only beneficial mutations can fix in the SSWM limit, the transport in (5) is asymmetric, and beneficial mutations will be rapidly converted to deleterious mutations with equal magnitude but opposite sign. The noise in (7) broadens the distribution of fitness increments, which converts deleterious mutations with small magnitude into beneficial mutations with small magnitude and vice-versa. The buildup of deleterious mutations results in a diffusive flux from the deleterious half to the beneficial half, providing a simple mechanism for the formation of new beneficial mutations (<xref rid="fig4" ref-type="fig">Figure 4C</xref>). Empirically, we find that <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline7.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> increases with <italic>β</italic>, driving the generation of a greater number of mutations with increasing <italic>β</italic> and correspondingly slower trajectory.</p>
</sec>
</sec>
<sec id="s3d">
<label>3.4</label>
<title>The effect of clonal interference</title>
<p>Clonal interference is known to reduce fixation probabilities (<xref ref-type="bibr" rid="c19">Gerrish and Lenski, 1998</xref>; <xref ref-type="bibr" rid="c48">Lin et al., 2020b</xref>), and hence to slow down the rate of adaptation when compared to an SSWM model with the same parameters. Given its prevalence in realistic evolving laboratory populations, models incorporating both clonal interference and macroscopic epistasis have been developed to predict the slow power law fitness trajectory observed in Lenski’s long-term evolution experiment (<xref ref-type="bibr" rid="c74">Wiser et al., 2013</xref>). Despite this interest, the effect of clonal interference on the shape of the fitness trajectory is still poorly understood.</p>
<p>In fitness-parameterized models, for sufficiently weak clonal interference, the way clonal interference affects the shape of the fitness trajectory depends on how the beneficial mutation rate changes with fitness (<xref ref-type="bibr" rid="c27">Guo and Amir, 2022</xref>). In particular, for typical models where beneficial mutations become less prevalent as the population climbs up the hill, clonal interference <italic>accelerates</italic> the fitness trajectory. While this result provides insight into the role of clonal interference in laboratory populations, it’s not clear if it holds more generally in a microscopic framework, or when the magnitude of clonal interference becomes large. Here, we demonstrate that the effect of clonal interference on the fitness trajectory depends on the strength of microscopic epistasis. In its absence, clonal interference is seen to accelerate the trajectory, while for a sufficiently strong epistatic interaction, clonal interference does not quantitatively affect the speed of the trajectory.</p>
<p>In simulation, the magnitude of clonal interference is tuned by adjusting the mutation rate <italic>µ</italic>. Increasing the mutation rate increases clonal interference, but also accelerates adaptation by allowing for more mutations each day. This effect can be eliminated by normalizing time by the mutation rate, so as to isolate the role of clonal interference itself. Viewed in these units, clonal interference decelerates the fitness trajectory due to the suppression of fixation probabilities (<xref rid="fig7" ref-type="fig">Figure 7</xref>)). However, when measuring the speed of a fitness trajectory, it is more rigorous to assign a quantitative measure by fitting a functional form such as the power law in (2), which will directly estimate the timescale parameter <italic>a</italic> independently for each <italic>µ</italic>. Fitting this power law reveals exponents that hover around <italic>c</italic> ≈ 0.8 in the epistatic setting (here, <italic>β</italic> = 0.25), but increase from <italic>c</italic> ≈ 1.85 for <italic>µ</italic> = 10<sup>−8</sup> to <italic>c</italic> ≈ 2.6 for <italic>µ</italic> = 10<sup>−4</sup> in the non-epistatic setting (<xref rid="fig5" ref-type="fig">Figure 5</xref>). These results can also be visualized qualitatively by normalizing time in units such that the initial rate of fitness increase is constant for different values of <italic>µ</italic>, as was done for the results in <xref rid="fig2" ref-type="fig">Figure 2</xref> via the definition of <italic>β</italic> (<xref rid="fig8" ref-type="fig">Figure 8</xref>).</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5:</label>
<caption><title>The effect of clonal interference on the fitness trajectory depends on the strength of microscopic epistasis.</title>
<p>Results of fitting the power law in (2) as a function of <italic>µ</italic>. The relaxation exponent <italic>c</italic> increases monotonically with <italic>µ</italic> for the non-epistatic model (<italic>β</italic> = 0), while the exponent remains essentially constant in the epistatic model (<italic>β</italic> = 0.25).</p></caption>
<graphic xlink:href="524306v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6:</label>
<caption><title>A mapping to a fitness-parameterized landscape as a function of <italic>µ</italic>. Left: non-epistatic (<italic>β</italic> = 0). Right: epistatic (<italic>β</italic> = 0.25).</title>
<p>(A/B) Unlike in classical fitness-parameterized models, the level of clonal interference cannot be tuned independently from the landscape. Because clonal interference modifies fixation probabilities, the conditional distribution of fitness effects <italic>ρ</italic><sub><italic>µ</italic></sub>(∆<italic>F</italic>|<italic>F</italic>) depends on <italic>μ</italic> both with and without epistasis (epistatic: <italic>F</italic> ≈ 1.85; non-epistatic: <italic>F</italic> ≈ 1.65. Distributions were approximated via kernel density estimation with a bandwidth parameter <italic>σ</italic> = 1.0). (C/D) Expected beneficial increment as a function of fitness. Both with and without epistasis, the expected increment tends to decrease with increasing <italic>μ</italic> at fixed fitness, capturing the fact that higher <italic>μ</italic> favors the fixation of mutations with higher effect. (E/F) Average rank as a function of fitness. Without epistasis, the rank increases with increasing <italic>μ</italic> at fixed fitness. With epistasis, the rank curves behave non-monotonically in <italic>μ</italic> at fixed fitness, and become comparable at high fitness. Inset in (F) shows rank as a function of <italic>μ</italic> for fixed <italic>F</italic> ≈ 1.9, highlighting the non-monotonic behavior.</p></caption>
<graphic xlink:href="524306v2_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig7" position="float" fig-type="figure">
<label>Figure 7:</label>
<caption><title>The effect of clonal interference on the fitness trajectory: re-scaling by <italic>µ</italic>. Left: epistatic. Right: non-epistatic.</title>
<p>(A/B) When measuring time in units of the mutation rate, clonal interference slows the fitness trajectory due to a suppresion of fixation probabilities. All trajectories are initialized at one, consistent with previous result: logarithmic time axis hides the very early time dynamics.</p></caption>
<graphic xlink:href="524306v2_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig8" position="float" fig-type="figure">
<label>Figure 8:</label>
<caption><title>The effect of clonal interference on the fitness trajectory: rescaling by <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline19.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. Left: epistatic. Right: non-epistatic.</title>
<p>(A/B) Geometrically, rescaling time by the initial rate of fitness increase ensures that “slower” trajectories reach the fitness peak at a later time, in qualitative agreement with the results of power-law fitting. Assuming a power law functional form as in the main text, at long times −log(<italic>F</italic><sub>∞</sub> − <italic>F</italic>(<italic>t</italic>)) = <italic>c</italic>log(1 + <italic>at</italic>) − log(<italic>F</italic><sub>∞</sub> − <italic>F</italic><sub>0</sub>) becomes linear with slope given by the exponent <italic>c</italic>. The asymptotic slope increases with <italic>µ</italic> without microscopic epistasis (A, <italic>β</italic> = 0.25), but does not clearly depend on the mutation rate with microscopic epistasis (B, <italic>β</italic> = 0).</p></caption>
<graphic xlink:href="524306v2_fig8.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<sec id="s3d1">
<title>A change in the effective landscape</title>
<p>To understand this result – and why it differs from the predictions of the fitness-parameterized setting – we can map the microscopic model to an effective fitness-parameterized landscape (<xref rid="fig6" ref-type="fig">Figure 6</xref>). This mapping reveals a striking observation: the effective macroscopic model depends on the mutation rate, which is typically treated as an independent parameter in the standard fitness-parameterized framework. Intuitively, there are many states in the landscape with the same value of <italic>F</italic> but which differ in their conditional distribution of increments <italic>ρ</italic>(Δ<italic>F</italic>|<italic>F</italic>); these states are dynamically selected in a way that depends on the level of clonal interference. In both the epistatic and non-epistatic landscapes, we find that the distribution becomes more sharply peaked for higher levels of clonal interference, while it has a heavier tail for lower levels (<xref rid="fig6" ref-type="fig">Figure 6A/B</xref>). This occurs because clonal interference suppresses the fixation of low-effect mutations. The result is that systems with high clonal interference typically reach a given <italic>F</italic> through fewer, more valuable mutations, while systems with low clonal interference typically reach <italic>F</italic> through the accumulation of more low-value mutations.</p>
<p>This effect can be visualized over the trajectory by making use of the summary statistics ⟨Δ<italic>F</italic><sub><italic>b</italic></sub>⟩ (expected increment) and <italic>R</italic> (rank) viewed as a function of the fitness. In both landscapes, the expected increment decreases with increasing <italic>µ</italic> (<xref rid="fig6" ref-type="fig">Figure 6C/D</xref>). By contrast, the behavior of the rank depends on the strength of microscopic epistasis. Without epistasis, the rank increases with <italic>µ</italic> (<xref rid="fig6" ref-type="fig">Figure 6E</xref>), while with epistasis, the rank becomes non-monotonic in <italic>µ</italic>, and becomes comparable at high fitness (<xref rid="fig6" ref-type="fig">Figure 6F</xref>). This observation suggests the importance of the rank in setting the speed of the fitness trajectory, analogous to the results presented in A fitness-parameterized mapping. Both with and without microscopic epistasis, the behavior of the rank with <italic>µ</italic> parallels that of the exponent <italic>c</italic>.</p>
</sec>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Discussion and conclusions</title>
<p>In this paper, motivated by laboratory serial dilution experiments, we developed a high-performance simulation approach to study the dynamics of long-term adaptation. We focused on a generic microscopic model that considers the microbial genome as a collection of sites with a binary value indicating the presence of a mutation. Our model contains a non-dimensional parameter 0 ≤ <italic>β</italic> ≤ 1 that enables us to smoothly tune the relative contribution of microscopic epistasis to the fitness effect Δ<italic>F</italic><sub><italic>i</italic></sub> of a mutation at gene <italic>i</italic>. In addition, we can tune an overall mutation rate <italic>µ</italic> to adjust the magnitude of clonal interference in the culture. By independently varying the parameters <italic>β</italic> and <italic>µ</italic>, we mapped out a phase diagram that describes the effects of microscopic epistasis and clonal interference on the functional form of the mean fitness trajectory.</p>
<p>Our simulation approach gives us the ability to probe microscopic details that are challenging to obtain experimentally, such as statistics of the distribution of fitness effects and the rank over time. The approach also allows us to study regimes such as strong microscopic epistasis and strong clonal interference that have eluded previous theoretical study. In addition to its generality, our model has computational advantages that enable us to probe the long-time dynamics required to reach a local fitness maximum.</p>
<sec id="s4a">
<title>The role of microscopic epistasis</title>
<p>By mapping the model to a simplified fitness-parameterized landscape, we showed that as the strength of microscopic epistasis increases, more mutations are needed to reach a local fitness maximum. In addition, beneficial mutations become less likely; these two properties together lead to a slower trajectory. We isolated a mechanism for this phenomenon – the generation of new, low-effect beneficial mutations mediated by the epistatic interaction when the culture is at high fitness – and we showed through a random walk model that this generation is sufficient to slow the fitness trajectory.</p>
<p>A by-product of our analysis is an observation that, as microscopic epistasis increases in strength, the beneficial mutation rate becomes an increasingly linear function of fitness, similar to the phenomenon of “global epistasis” observed for the expected beneficial fitness increment (<xref ref-type="bibr" rid="c61">Reddy and Desai, 2021</xref>). This suggests that the strength of epistasis in realistic microbial populations could be inferred by measuring the beneficial mutation rate as a function of fitness experimentally.</p>
</sec>
<sec id="s4b">
<title>The role of clonal interference</title>
<p>Through a similar analysis, we observed that in the microscopic context considered here, any equivalent fitness-parameterized model must depend on the mutation rate <italic>µ</italic>, a parameter that is typically tuned independently. In effect, the change in fixation probabilities induced by clonal interference filters the accessible genotypes with a given fitness <italic>F</italic>, giving rise to a conditional distribution of fitness increments <italic>ρ</italic><sub><italic>µ</italic></sub>(∆<italic>F</italic>|<italic>F</italic>) that depends on <italic>µ</italic>.</p>
<p>Based on this observation, we showed that the effect of clonal interference on the fitness trajectory differs from prior predictions made in the fitness-parameterized setting, and moreover that it depends on the strength of microscopic epistasis. In a non-epistatic model, increasing clonal interference accelerates the fitness trajectory. For sufficiently strong microscopic epistasis, clonal interference has no effect on the speed of the fitness trajectory. We leave the development of a mechanistic model capturing this phenomenon to future work.</p>
</sec>
<sec id="s4c">
<title>The beneficial mutation rate</title>
<p>A surprising observation is that the trend of the rank with <italic>β</italic> in <xref rid="fig3" ref-type="fig">Figure 3A/B</xref> and with <italic>μ</italic> in <xref rid="fig6" ref-type="fig">Figure 6E/F</xref> is consistent with the behavior of the exponent with <italic>β</italic> and <italic>µ</italic>. This is similar to predictions made within the fitness-parameterized framework, where it was found that the effect of clonal interference depends on how the beneficial mutation rate changes with fitness (<xref ref-type="bibr" rid="c27">Guo and Amir, 2022</xref>). Taken together, these results suggest that the behavior of the beneficial mutation rate as a function of fitness plays a central role in setting the speed of the fitness trajectory.</p>
</sec>
<sec id="s4d">
<title>Connections to spin glass physics</title>
<p>In this work, we studied a model inspired by the Sherrington-Kirkpatrick spin glass using the techniques of microbial population genetics. Nevertheless, the fundamental questions we study here – such as characterizing the speed and functional form of relaxation processes – are also studied in the spin glass literature using seemingly different tools. In particular, the two- and four-point correlation functions <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline8.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> and <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline9.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> are often studied as a function of the waiting time <italic>t</italic><sub><italic>w</italic></sub> and the lag time ∆<italic>t</italic> to characterize the decay of spin correlations and the importance of correlated spin flips, respectively (<xref ref-type="bibr" rid="c7">Castellani and Cavagna, 2005</xref>; <xref ref-type="bibr" rid="c69">Toninelli et al., 2005</xref>)<sup><xref ref-type="fn" rid="fn2">2</xref></sup>.</p>
<p>It is a simple calculation to show that the two-point correlation function obeys the identity
<disp-formula id="eqn8">
<alternatives><graphic xlink:href="524306v2_eqn8.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
where <italic>m</italic>(∆<italic>t</italic>) denotes the population mean substitution trajectory at time ∆<italic>t</italic>. For general <italic>t</italic><sub><italic>w</italic></sub>, <italic>χ</italic><sub>2</sub>(<italic>t</italic><sub><italic>w</italic></sub>, ∆<italic>t</italic>) simply shifts the definition of the ancestral strain. This relation provides a novel link between standard techniques in spin glass physics and microscopic population genetics. Yet, the dynamics of fixation induce important differences: it is well-known that in the absence of epistasis the substitution trajectory follows a power law relaxation similar to (2) with <italic>c</italic> = 1.0 (<xref ref-type="bibr" rid="c25">Good and Desai, 2015</xref>). This stands in contrast to the standard setting in spin glasses, where the two-point correlation function often exhibits stretched exponential relaxations (<xref ref-type="bibr" rid="c60">Phillips, 1996</xref>).</p>
<p>We fit power law relaxations to the <italic>χ</italic><sub>2</sub>(0, ∆<italic>t</italic>) trajectories in the SSWM regime as a function of <italic>β</italic> and found a median exponent 1.03 for <italic>β</italic> = 0. For <italic>β</italic> &gt; 0, we still found good agreement with a power law functional form and obtained a decaying exponent with increasing <italic>β</italic> (<xref rid="fig9" ref-type="fig">Figure 9</xref>, SI Appendix). We also found that the average over sites in the definitions of <italic>χ</italic><sub>2</sub> and <italic>χ</italic><sub>4</sub> are roughly equivalent to the angular average over trajectories, so that <italic>χ</italic><sub>4</sub>(0, ∆<italic>t</italic>) ≈ <italic>χ</italic><sub>2</sub>(0, ∆<italic>t</italic>)<sup>2</sup> (<xref rid="fig10" ref-type="fig">Figure 10</xref>, SI Appendix). This demonstrates that it is sufficient to consider the two-point correlation function, or equivalently the substitution trajectory, and that no additional information is contained in the four-point correlator.</p>
<fig id="fig9" position="float" fig-type="figure">
<label>Figure 9:</label>
<caption><p>(A) <italic>χ</italic><sub>2</sub> trajectories as a function of <italic>β</italic> and the lag time Δ<italic>t</italic> in the SSWM limit. Solid lines show the mean over 200 independent trajectories and errorbars show ± one standard deviation. Dashed line shows best fit to the power law <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline15.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. (B) Relaxation exponents <italic>c</italic> for <italic>χ</italic><sub>2</sub> as a function of <italic>β</italic>. Similar to the fitness trajectory, the exponent decreases with increasing <italic>β</italic>. Solid point shows median of the bootstrap distribution computed over 250 estimates; errorbars show 95% confidence intervals.</p></caption>
<graphic xlink:href="524306v2_fig9.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig10" position="float" fig-type="figure">
<label>Figure 10:</label>
<caption><p>(A) <italic>χ</italic><sub>4</sub> trajectories as a function of <italic>β</italic> and the lag time Δ<italic>t</italic> in the SSWM limit. Solid lines show the mean over 200 independent trajectories and errorbars show ± one standard deviation. (B) <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline16.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> trajectories as a function of <italic>β</italic>. Because the genomic average of <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline17.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is approximately equal to an average over trajectories, we find that <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline18.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. visually, the mean trajectories are nearly indistinguishable.</p></caption>
<graphic xlink:href="524306v2_fig10.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s4e">
<label>4.3</label>
<title>Future directions</title>
<p>Our model and simulation can be extended in many exciting directions. One possibility is to allow for horizontal gene transfer between bacterial strains. By allowing large jumps across the fitness landscape, horizontal gene transfer may have a similar effect to microscopic epistasis, and could slow the fitness trajectory by generating groups of new beneficial mutations (<xref ref-type="bibr" rid="c64">Slomka et al., 2020</xref>); on the other hand, it could also accelerate the fitness trajectory by allowing for larger steps towards a fitness maximum. Another possibility is to bias the model, so that the <italic>h</italic><sub><italic>i</italic></sub> and <italic>J</italic><sub><italic>ij</italic></sub> have non-zero means, and to study the effect of these mean values on the long-term dynamics. A third possibility is to allow for further structure in the interaction matrix <italic>J</italic>, rather than the i.i.d. random entries considered here. For example, by allowing for low-rank structure in <italic>J</italic>, one could in principle quantify the role of connected modules of mutations on the functional form of the fitness trajectory (<xref ref-type="bibr" rid="c59">Parter et al., 2008</xref>; <xref ref-type="bibr" rid="c42">Landau and Sompolinsky, 2016</xref>, <xref ref-type="bibr" rid="c43">2021</xref>). A final direction would be to form a mechanistic model for the effect of clonal interference both with and without epistasis, similar to the random walk model developed to understand the effect of microscopic epistasis.</p>
<p>Our work focuses primarily on clonal interference between potential mutations, which is the most well-studied form of clonal interference. However, recent work has shown that an alternative “within-path” clonal interference between a mutant and its ancestor has a significant effect on both the rate of adaptation and on the specific adaptive trajectories selected in evolving populations (<xref ref-type="bibr" rid="c54">Ogbunugafor and Eppstein, 2016</xref>); within-path clonal interference can be quantified along a given trajectory as the sum of the inverse fitness increments. In the clonal interference regime, <xref rid="fig3" ref-type="fig">Figure 3D</xref> shows that the expected fitness increment decreases at fixed fitness with increasing <italic>β</italic>. This implies that at a given fitness, the total level of within-path clonal interference increases with <italic>β</italic> on average. It would be interesting to study how much this contributes to the decrease in exponent <italic>c</italic> with increasing <italic>β</italic> in the clonal interference regime. This could be quantified, for example, by computing the total within-path clonal interference along potential trajectories and identifying how well it correlates with the preferred trajectories as a function of <italic>β</italic>.</p>
<p>In addition to the extensions considered above, our simulation environment forms a fertile testing ground for theoretical predictions. The relaxation exponents as a function of <italic>β</italic> considered in <xref rid="fig2" ref-type="fig">Figure 2E</xref> could in principle be predicted within the random walk approximation using the techniques developed by <xref ref-type="bibr" rid="c32">Horner (2007)</xref>, or within a dynamical mean-field theory that studies the evolution of the average value of the mutation variables ⟨<italic>α</italic><sub><italic>i</italic></sub>(<italic>t</italic>)⟩ ∈ [−1, 1] over time (<xref ref-type="bibr" rid="c24">Ginzburg and Sompolinsky, 1994</xref>; <xref ref-type="bibr" rid="c66">Sompolinsky and Zippelius, 1981</xref>; <xref ref-type="bibr" rid="c65">Sommers, 1987</xref>). Solving such a model, in addition to analytically quantifying the slowing of the fitness trajectory with <italic>β</italic>, would provide a prediction for a functional form that could be tested against experimental fitness trajectories.</p>
<p><xref rid="fig5" ref-type="fig">Figure 5</xref> shows that for <italic>β</italic> = 0.25, clonal interference has no effect on the fitness trajectory. Moreover, <xref rid="fig2" ref-type="fig">Figure 2E</xref> highlights that this remains true for <italic>β</italic> &gt; 0.25. It would be interesting to carefully probe the value of <italic>β</italic> for which the effect of clonal interference vanishes, and to determine if this occurs as a sharp phase transition or if there is a gradual decay of the effect of clonal interference with <italic>β</italic>. Understanding this behavior could lead to a way to measure the strength of epistasis in experimental systems, by studying how the fitness trajectory depends on the level of clonal interference.</p>
</sec>
</sec>
</body>
<back>
<ack>
<label>4.2</label>
<title>Acknowledgments</title>
<p>We thank Haim Sompolinsky, Guy Bunin, and Yoav Ram for many useful discussions, and we thank Jimmy Almgren-Bell for contributions to an initial version of the simulation software. N. M. B. was partially supported by the Research Training Group in Modeling and Simulation funded by the National Science Foundation via grant RTG/DMS – 1646339. C. H. R. was partially supported by the Applied Mathematics Program of the U.S. DOE Office of Science Advanced Scientific Computing Research under Contract No. DE-AC02-05CH11231.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name>, <string-name><given-names>Yuval</given-names> <surname>Oreg</surname></string-name>, and <string-name><given-names>Yoseph</given-names> <surname>Imry</surname></string-name>. <article-title>Mean-field model for electron-glass dynamics</article-title>. <source>Phys. Rev. B</source>, <volume>77</volume>, <year>2008</year>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><string-name><given-names>Daniel J.</given-names> <surname>Amit</surname></string-name>, <string-name><given-names>Hanoch</given-names> <surname>Gutfreund</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Spin-glass models of neural networks</article-title>. <source>Phys. Rev. A</source>, <volume>32</volume>, <year>1985a</year>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><string-name><given-names>Daniel J.</given-names> <surname>Amit</surname></string-name>, <string-name><given-names>Hanoch</given-names> <surname>Gutfreund</surname></string-name>, and <string-name><given-names>H.</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Storing infinite numbers of patterns in a spin-glass model of neural networks</article-title>. <source>Phys. Rev. Lett</source>., <volume>55</volume>, <year>1985b</year>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><string-name><given-names>G.</given-names> <surname>Ben Arous</surname></string-name>, <string-name><given-names>A.</given-names> <surname>Dembo</surname></string-name>, and <string-name><given-names>A.</given-names> <surname>Guionnet</surname></string-name>. <article-title>Aging of spherical spin glasses</article-title>. <source>Probability Theory and Related Fields</source>, <volume>120</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>67</lpage>, <month>May</month> <year>2001</year>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><string-name><given-names>Christopher W.</given-names> <surname>Bakerlee</surname></string-name>, <string-name><given-names>Alex N. Nguyen</given-names> <surname>Ba</surname></string-name>, <string-name><given-names>Yekaterina</given-names> <surname>Shulgina</surname></string-name>, <string-name><given-names>Jose I. Rojas</given-names> <surname>Echenique</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>Idiosyncratic epistasis leads to global fitness–correlated trends</article-title>. <source>Science</source>, <volume>376</volume> (<issue>6593</issue>):<fpage>630</fpage>–<lpage>635</lpage>, <month>May</month> <year>2022</year>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><string-name><given-names>Jeffrey E.</given-names> <surname>Barrick</surname></string-name> <etal>et al.</etal> <article-title>Genome evolution and adaptation in a long-term experiment with Escherichia coli</article-title>. <source>Nature</source>, <volume>461</volume>(<issue>7268</issue>), <year>2009</year>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><string-name><given-names>Tommaso</given-names> <surname>Castellani</surname></string-name> and <string-name><given-names>Andrea</given-names> <surname>Cavagna</surname></string-name>. <article-title>Spin-Glass Theory for Pedestrians</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source>, 2005(<issue>05</issue>):<fpage>P05012</fpage>, <year>2005</year>. ISSN <issn>1742-5468</issn>. doi: <pub-id pub-id-type="doi">10.1088/1742-5468/2005/05/P05012</pub-id>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><string-name><given-names>Anna</given-names> <surname>Choromanska</surname></string-name>, <string-name><given-names>Yann</given-names> <surname>LeCun</surname></string-name>, and <string-name><given-names>Gérard</given-names> <surname>Ben Arous</surname></string-name>. <article-title>Open problem: The landscape of the loss surfaces of multilayer networks</article-title>. In <person-group person-group-type="editor"><string-name><given-names>Peter</given-names> <surname>Grünwald</surname></string-name>, <string-name><given-names>Elad</given-names> <surname>Hazan</surname></string-name>, and <string-name><given-names>Satyen</given-names> <surname>Kale</surname></string-name>, editors</person-group>, <source>Proceedings of The 28th Conference on Learning Theory</source>, volume <volume>40</volume> <collab>of Proceedings of Machine Learning Research</collab>, <year>2015</year>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><string-name><given-names>Hsin-Hung</given-names> <surname>Chou</surname></string-name>, <string-name><given-names>Hsuan-Chao</given-names> <surname>Chiu</surname></string-name>, <string-name><given-names>Nigel F</given-names> <surname>Delaney</surname></string-name>, <string-name><given-names>Daniel</given-names> <surname>Segrè</surname></string-name>, and <string-name><given-names>Christopher J</given-names> <surname>Marx</surname></string-name>. <article-title>Diminishing returns epistasis among beneficial mutations decelerates adaptation</article-title>. <source>Science</source>, <volume>332</volume> (<issue>6034</issue>):<fpage>1190</fpage>–<lpage>1192</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><string-name><given-names>Michael</given-names> <surname>Costanzo</surname></string-name> <etal>et al.</etal> <article-title>A global genetic interaction network maps a wiring diagram of cellular function</article-title>. <source>Science</source>, <volume>353</volume>(<issue>6306</issue>), <year>2016</year>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><string-name><given-names>J Arjan G M</given-names> <surname>de Visser</surname></string-name> and <string-name><given-names>Daniel E</given-names> <surname>Rozen</surname></string-name>. <article-title>Clonal Interference and the Periodic Selection of New Beneficial Mutations in Escherichia coli</article-title>. <source>Genetics</source>, <volume>172</volume>(<issue>4</issue>):<fpage>2093</fpage>–<lpage>2100</lpage>, <month>April</month> <year>2006</year>. ISSN <issn>1943-2631</issn>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><string-name><given-names>M. M.</given-names> <surname>Desai</surname></string-name> and <string-name><given-names>D. S.</given-names> <surname>Fisher</surname></string-name>. <article-title>Beneficial mutation selection balance and the effect of linkage on positive selection</article-title>. <source>Genetics</source>, <volume>176</volume>(<issue>3</issue>), <year>2007</year>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>, <string-name><given-names>Daniel S.</given-names> <surname>Fisher</surname></string-name>, and <string-name><given-names>Andrew W.</given-names> <surname>Murray</surname></string-name>. <article-title>The speed of evolution and maintenance of variation in asexual populations</article-title>. <source>Current Biology</source>, <volume>17</volume>(<issue>5</issue>):<fpage>385</fpage>–<lpage>394</lpage>, <year>2007</year>. ISSN <issn>0960-9822</issn>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="other"><string-name><given-names>Juan</given-names> <surname>Diaz-Colunga</surname></string-name>, <string-name><given-names>Abigail</given-names> <surname>Skwara</surname></string-name>, <string-name><given-names>Karna</given-names> <surname>Gowda</surname></string-name>, <string-name><given-names>Ramon</given-names> <surname>Diaz-Uriarte</surname></string-name>, <string-name><given-names>Mikhail</given-names> <surname>Tikhonov</surname></string-name>, <string-name><given-names>Djordje</given-names> <surname>Bajic</surname></string-name>, and <string-name><given-names>Alvaro</given-names> <surname>Sanchez</surname></string-name>. <article-title>Global epistasis on fitness landscapes</article-title>. <source>arXiv</source>:2210.03677, <year>2022</year>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><string-name><given-names>P. R.</given-names> <surname>Eastham</surname></string-name>, <string-name><given-names>R. A.</given-names> <surname>Blythe</surname></string-name>, <string-name><given-names>A. J.</given-names> <surname>Bray</surname></string-name>, and <string-name><given-names>M. A.</given-names> <surname>Moore</surname></string-name>. <article-title>Mechanism for the failure of the edwards hypothesis in the sherrington-kirkpatrick spin glass</article-title>. <source>Phys. Rev. B</source>, <volume>74</volume>, <year>2006</year>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><string-name><given-names>Henrik</given-names> <surname>Flyvbjerg</surname></string-name> and <string-name><given-names>Benny</given-names> <surname>Lautrup</surname></string-name>. <article-title>Evolution in a rugged fitness landscape</article-title>. <source>Physical Review A</source>, <volume>46</volume>(<issue>10</issue>):<fpage>6714</fpage>–<lpage>6723</lpage>, <year>1992</year>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="journal"><string-name><given-names>Craig A.</given-names> <surname>Fogle</surname></string-name>, <string-name><given-names>James L.</given-names> <surname>Nagle</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>Clonal interference, multiple mutations and adaptation in large asexual populations</article-title>. <source>Genetics</source>, <volume>180</volume>(<issue>4</issue>), <year>2008</year>.</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="book"><string-name><given-names>James E.</given-names> <surname>Gentle</surname></string-name>. <source>Random Number Generation and Monte Carlo Methods</source>. <publisher-name>Springer</publisher-name>, <year>1998</year>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><string-name><given-names>Philip J</given-names> <surname>Gerrish</surname></string-name> and <string-name><given-names>Richard E</given-names> <surname>Lenski</surname></string-name>. <article-title>The fate of competing beneficial mutations in an asexual population</article-title>. <source>Genetics</source>, <volume>102</volume>:<fpage>127</fpage>, <year>1998</year>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><string-name><given-names>Daniel T</given-names> <surname>Gillespie</surname></string-name>. <article-title>A general method for numerically simulating the stochastic time evolution of coupled chemical reactions</article-title>. <source>Journal of Computational Physics</source>, <volume>22</volume>(<issue>4</issue>), <year>1976</year>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="journal"><string-name><given-names>John H.</given-names> <surname>Gillespie</surname></string-name>. <article-title>A simple stochastic gene substitution model</article-title>. <source>Theoretical Population Biology</source>, <volume>23</volume> (<issue>2</issue>):<fpage>202</fpage>–<lpage>215</lpage>, <year>1983</year>. ISSN <issn>0040-5809</issn>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><string-name><given-names>John H.</given-names> <surname>Gillespie</surname></string-name>. <article-title>Molecular Evolution Over the Mutational Landscape</article-title>. <source>Evolution</source>, <volume>38</volume>(<issue>5</issue>):<fpage>1116</fpage>–<lpage>1129</lpage>, <year>1984</year>. ISSN <issn>0014-3820</issn>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="book"><string-name><given-names>John H</given-names> <surname>Gillespie</surname></string-name>. <source>The causes of molecular evolution</source>, volume <volume>2</volume>. <publisher-name>Oxford University Press On Demand</publisher-name>, <year>1991</year>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><string-name><given-names>Iris</given-names> <surname>Ginzburg</surname></string-name> and <string-name><given-names>Haim</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Theory of correlations in stochastic neural networks</article-title>. <source>Phys. Rev. E</source>, <volume>50</volume>, <year>1994</year>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="journal"><string-name><given-names>Benjamin H.</given-names> <surname>Good</surname></string-name> and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>The impact of macroscopic epistasis on long-term evolutionary dynamics</article-title>. <source>Genetics</source>, <volume>199</volume>(<issue>1</issue>), <year>2015</year>.</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><string-name><given-names>Benjamin H.</given-names> <surname>Good</surname></string-name>, <string-name><given-names>Igor M.</given-names> <surname>Rouzine</surname></string-name>, <string-name><given-names>Daniel J.</given-names> <surname>Balick</surname></string-name>, <string-name><given-names>Oskar</given-names> <surname>Hallatschek</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>Distribution of fixed beneficial mutations and the rate of adaptation in asexual populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>109</volume>(<issue>13</issue>), <year>2012</year>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><string-name><given-names>Yipei</given-names> <surname>Guo</surname></string-name> and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name>. <article-title>The effect of weak clonal interference on average fitness trajectories in the presence of macroscopic epistasis</article-title>. <source>Genetics</source>, <volume>220</volume>(<issue>4</issue>), <month>April</month> <year>2022</year>. ISSN <issn>1943-2631</issn>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><string-name><given-names>Yipei</given-names> <surname>Guo</surname></string-name>, <string-name><given-names>Marija</given-names> <surname>Vucelja</surname></string-name>, and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name>. <article-title>Stochastic tunneling across fitness valleys can give rise to a logarithmic long-term fitness trajectory</article-title>. <source>Science Advances</source>, <volume>5</volume>(<issue>7</issue>), <year>2019</year>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><string-name><given-names>J. B. S.</given-names> <surname>Haldane</surname></string-name>. <article-title>A mathematical theory of natural and artificial selection, part v: Selection and mutation</article-title>. <source>Mathematical Proceedings of the Cambridge Philosophical Society</source>, <volume>23</volume>(<issue>7</issue>), <year>1927</year>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><string-name><given-names>Matthew</given-names> <surname>Hegreness</surname></string-name>, <string-name><given-names>Noam</given-names> <surname>Shoresh</surname></string-name>, <string-name><given-names>Daniel</given-names> <surname>Hartl</surname></string-name>, and <string-name><given-names>Roy</given-names> <surname>Kishony</surname></string-name>. <article-title>An equivalence principle for the incorporation of favorable mutations in asexual populations</article-title>. <source>Science</source>, <volume>311</volume>(<issue>5767</issue>), <year>2006</year>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><string-name><given-names>J J</given-names> <surname>Hopfield</surname></string-name>. <article-title>Neural networks and physical systems with emergent collective computational abilities</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>79</volume>(<issue>8</issue>), <year>1982</year>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><string-name><given-names>H.</given-names> <surname>Horner</surname></string-name>. <article-title>Time dependent local field distribution and metastable states in the sk-spin-glass</article-title>. <source>The European Physical Journal B</source>, <volume>60</volume>(<issue>4</issue>), <year>2007</year>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><string-name><given-names>Yoh</given-names> <surname>Iwasa</surname></string-name>, <string-name><given-names>Franziska</given-names> <surname>Michor</surname></string-name>, and <string-name><given-names>Martin A.</given-names> <surname>Nowak</surname></string-name>. <article-title>Stochastic tunnels in evolutionary dynamics</article-title>. <source>Genetics</source>, <volume>166</volume>(<issue>3</issue>), <year>2004</year>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><string-name><given-names>Stuart</given-names> <surname>Kauffman</surname></string-name> and <string-name><given-names>Simon</given-names> <surname>Levin</surname></string-name>. <article-title>Towards a general theory of adaptive walks on rugged landscapes</article-title>. <source>Journal of Theoretical Biology</source>, <volume>128</volume>(<issue>1</issue>), <year>1987</year>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><string-name><given-names>Stuart A</given-names> <surname>Kauffman</surname></string-name> and <string-name><given-names>Edward D</given-names> <surname>Weinberger</surname></string-name>. <article-title>The NK model of rugged fitness landscapes and its application to maturation of the immune response</article-title>. <source>Journal of theoretical biology</source>, <volume>141</volume>(<issue>2</issue>):<fpage>211</fpage>–<lpage>245</lpage>, <year>1989</year>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><string-name><given-names>Aisha I</given-names> <surname>Khan</surname></string-name>, <string-name><given-names>Duy M</given-names> <surname>Dinh</surname></string-name>, <string-name><given-names>Dominique</given-names> <surname>Schneider</surname></string-name>, <string-name><given-names>Richard E</given-names> <surname>Lenski</surname></string-name>, and <string-name><given-names>Tim F</given-names> <surname>Cooper</surname></string-name>. <article-title>Negative epistasis between beneficial mutations in an evolving bacterial population</article-title>. <source>Science</source>, <volume>332</volume>(<issue>6034</issue>): <fpage>1193</fpage>–<lpage>1196</lpage>, <year>2011</year>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><string-name><given-names>J. F. C.</given-names> <surname>Kingman</surname></string-name>. <article-title>A simple model for the balance between selection and mutation</article-title>. <source>Journal of Applied Probability</source>, <volume>15</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>12</lpage>, <year>1978</year>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><string-name><given-names>Sergey</given-names> <surname>Kryazhimskiy</surname></string-name>, <string-name><given-names>Gašper</given-names> <surname>Tkačik</surname></string-name>, and <string-name><given-names>Joshua B.</given-names> <surname>Plotkin</surname></string-name>. <article-title>The dynamics of adaptation on correlated fitness landscapes</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>106</volume>(<issue>44</issue>), <year>2009</year>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><string-name><given-names>Sergey</given-names> <surname>Kryazhimskiy</surname></string-name>, <string-name><given-names>Daniel P.</given-names> <surname>Rice</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>Population subdivision and adaptation in asexual populations of saccharomyces cerevisiae</article-title>. <source>Evolution</source>, <volume>66</volume>(<issue>6</issue>):<fpage>1931</fpage>–<lpage>1941</lpage>, <year>2012</year>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><string-name><given-names>Sergey</given-names> <surname>Kryazhimskiy</surname></string-name>, <string-name><given-names>Daniel P.</given-names> <surname>Rice</surname></string-name>, <string-name><given-names>Elizabeth R.</given-names> <surname>Jerison</surname></string-name>, and <string-name><given-names>Michael M.</given-names> <surname>Desai</surname></string-name>. <article-title>Global epistasis makes adaptation predictable despite sequence-level stochasticity</article-title>. <source>Science</source>, <volume>344</volume>(<issue>6191</issue>):<fpage>1519</fpage>–<lpage>1522</lpage>, <month>June</month> <year>2014</year>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><string-name><given-names>Jorge</given-names> <surname>Kurchan</surname></string-name> and <string-name><given-names>Laurent</given-names> <surname>Laloux</surname></string-name>. <article-title>Phase space geometry and slow dynamics</article-title>. <source>Journal of Physics A: Mathematical and General</source>, <volume>29</volume>(<issue>9</issue>):<fpage>1929</fpage>–<lpage>1948</lpage>, <year>1996</year>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><string-name><given-names>Itamar D.</given-names> <surname>Landau</surname></string-name> and <string-name><given-names>Haim</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>The impact of structural heterogeneity on excitation-inhibition balance in cortical networks</article-title>. <source>Neuron</source>, <volume>92</volume>(<issue>5</issue>), <year>2016</year>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="journal"><string-name><given-names>Itamar D.</given-names> <surname>Landau</surname></string-name> and <string-name><given-names>Haim</given-names> <surname>Sompolinsky</surname></string-name>. <article-title>Macroscopic fluctuations emerge in balanced networks with incomplete recurrent alignment</article-title>. <source>Phys. Rev. Research</source>, <volume>3</volume>, <year>2021</year>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="journal"><string-name><given-names>Richard E.</given-names> <surname>Lenski</surname></string-name>. <article-title>Experimental evolution and the dynamics of adaptation and genome evolution in microbial populations</article-title>. <source>The ISME Journal</source>, <volume>11</volume>(<issue>10</issue>), <year>2017</year>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><string-name><given-names>Richard E</given-names> <surname>Lenski</surname></string-name> and <string-name><given-names>Michael</given-names> <surname>Travisano</surname></string-name>. <article-title>Dynamics of adaptation and diversification: a 10,000-generation experiment with bacterial populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>91</volume>(<issue>15</issue>):<fpage>6808</fpage>–<lpage>6814</lpage>, <year>1994</year>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><string-name><given-names>Richard E</given-names> <surname>Lenski</surname></string-name>, <string-name><given-names>Michael R</given-names> <surname>Rose</surname></string-name>, <string-name><given-names>Suzanne C</given-names> <surname>Simpson</surname></string-name>, and <string-name><given-names>Scott C</given-names> <surname>Tadler</surname></string-name>. <article-title>Long-term experimental evolution in Escherichia coli. I. Adaptation and divergence during 2,000 generations</article-title>. <source>The American Naturalist</source>, <volume>138</volume>(<issue>6</issue>):<fpage>1315</fpage>–<lpage>1341</lpage>, <year>1991</year>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><string-name><given-names>Jie</given-names> <surname>Lin</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Manhart</surname></string-name>, and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name>. <article-title>Evolution of microbial growth traits under serial dilution</article-title>. <source>Genetics</source>, <volume>215</volume>(<issue>3</issue>):<fpage>767</fpage>–<lpage>777</lpage>, 07 <year>2020a</year>. ISSN <issn>1943-2631</issn>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><string-name><given-names>Jie</given-names> <surname>Lin</surname></string-name>, <string-name><given-names>Michael</given-names> <surname>Manhart</surname></string-name>, and <string-name><given-names>Ariel</given-names> <surname>Amir</surname></string-name>. <article-title>Evolution of microbial growth traits under serial dilution</article-title>. <source>Genetics</source>, <volume>215</volume>(<issue>3</issue>):<fpage>767</fpage>–<lpage>777</lpage>, <year>2020b</year>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><string-name><given-names>C. A.</given-names> <surname>Macken</surname></string-name> and <string-name><given-names>A. S.</given-names> <surname>Perelson</surname></string-name>. <article-title>Protein evolution on rugged landscapes</article-title>. <source>Proceedings of the National Academy of Sciences of the United States of America</source>, <volume>86</volume>(<issue>16</issue>):<fpage>6191</fpage>–<lpage>6195</lpage>, <year>1989</year>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="book"><string-name><given-names>Marc</given-names> <surname>Mezard</surname></string-name> and <string-name><given-names>Andrea</given-names> <surname>Montanari</surname></string-name>. <source>Information, Physics, and Computation</source>. <publisher-name>Oxford University Press, Inc</publisher-name>., <year>2009</year>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="book"><string-name><given-names>Marc</given-names> <surname>Mezard</surname></string-name>, <string-name><given-names>Giorgio</given-names> <surname>Parisi</surname></string-name>, and <string-name><given-names>Miguel Angel</given-names> <surname>Virasoro</surname></string-name>. <source>Spin glass theory and beyond</source>. <publisher-name>World Scientific</publisher-name>, <year>1987</year>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><string-name><given-names>A. A.</given-names> <surname>Mogilyanskii</surname></string-name> and <string-name><given-names>M. E.</given-names> <surname>Raikh</surname></string-name>. <article-title>Self-consistent description of coulomb gap at finite temperatures</article-title>. <source>Soviet Physics – JETP (English Translation)</source>, <volume>68</volume>(<issue>5</issue>), <year>1989</year>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><string-name><given-names>Richard A.</given-names> <surname>Neher</surname></string-name> and <string-name><given-names>Boris I.</given-names> <surname>Shraiman</surname></string-name>. <article-title>Statistical genetics and evolution of quantitative traits</article-title>. <source>Rev. Mod. Phys</source>., <volume>83</volume>, <year>2011</year>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><string-name><given-names>C. Brandon</given-names> <surname>Ogbunugafor</surname></string-name> and <string-name><given-names>Margaret J.</given-names> <surname>Eppstein</surname></string-name>. <article-title>Competition along trajectories governs adaptation rates towards antimicrobial resistance</article-title>. <source>Nature Ecology &amp; Evolution</source>, <volume>1</volume>(<issue>1</issue>):<fpage>1</fpage>–<lpage>8</lpage>, <year>2016</year>. doi: <pub-id pub-id-type="doi">10.1038/s41559-016-0007</pub-id>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="journal"><string-name><given-names>H. Allen</given-names> <surname>Orr</surname></string-name>. <article-title>The Population Genetics of Adaptation: The Adaptation of Dna Sequences</article-title>. <source>Evolution</source>, <volume>56</volume>(<issue>7</issue>):<fpage>1317</fpage>–<lpage>1330</lpage>, <year>2002</year>. ISSN <issn>1558-5646</issn>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="journal"><string-name><given-names>H. Allen</given-names> <surname>Orr</surname></string-name>. <article-title>The Population Genetics of Adaptation on Correlated Fitness Landscapes: The Block Model</article-title>. <source>Evolution</source>, <volume>60</volume>(<issue>6</issue>):<fpage>1113</fpage>–<lpage>1124</lpage>, <year>2006</year>. ISSN <issn>1558-5646</issn>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><string-name><given-names>Su-Chan</given-names> <surname>Park</surname></string-name> and <string-name><given-names>Joachim</given-names> <surname>Krug</surname></string-name>. <article-title>Clonal interference in large populations</article-title>. <source>Proceedings of the National Academy of Sciences</source>, <volume>104</volume>(<issue>46</issue>):<fpage>18135</fpage>–<lpage>18140</lpage>, <month>November</month> <year>2007</year>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><string-name><given-names>Su-Chan</given-names> <surname>Park</surname></string-name> and <string-name><given-names>Joachim</given-names> <surname>Krug</surname></string-name>. <article-title>Evolution in random fitness landscapes: the infinite sites model</article-title>. <source>Journal of Statistical Mechanics: Theory and Experiment</source>, <volume>2008</volume>(<issue>04</issue>), <year>2008</year>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><string-name><given-names>Merav</given-names> <surname>Parter</surname></string-name>, <string-name><given-names>Nadav</given-names> <surname>Kashtan</surname></string-name>, and <string-name><given-names>Uri</given-names> <surname>Alon</surname></string-name>. <article-title>Facilitated variation: How evolution learns from past environments to generalize to new environments</article-title>. <source>PLOS Computational Biology</source>, <volume>4</volume>(<issue>11</issue>), <year>2008</year>.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="journal"><string-name><given-names>J. C.</given-names> <surname>Phillips</surname></string-name>. <article-title>Stretched exponential relaxation in molecular and electronic glasses</article-title>. <source>Reports on Progress in Physics</source>, <volume>59</volume>(<issue>9</issue>):<fpage>1133</fpage>, <month>September</month> <year>1996</year>. ISSN <issn>0034-4885</issn>. doi: <pub-id pub-id-type="doi">10.1088/0034-4885/59/9/003</pub-id>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><string-name><given-names>Gautam</given-names> <surname>Reddy</surname></string-name> and <string-name><given-names>Michael M</given-names> <surname>Desai</surname></string-name>. <article-title>Global epistasis emerges from a generic model of a complex trait</article-title>. <source>eLife</source>, <volume>10</volume>:<fpage>e64740</fpage>, <year>2021</year>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="journal"><string-name><given-names>Felix</given-names> <surname>Roy</surname></string-name>, <string-name><given-names>Matthieu</given-names> <surname>Barbier</surname></string-name>, <string-name><given-names>Giulio</given-names> <surname>Biroli</surname></string-name>, and <string-name><given-names>Guy</given-names> <surname>Bunin</surname></string-name>. <article-title>Complex interactions can create persistent fluctuations in high-diversity ecosystems</article-title>. <source>PLOS Computational Biology</source>, <volume>16</volume>(<issue>5</issue>):<fpage>1</fpage>–<lpage>14</lpage>, 05 <year>2020</year>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><string-name><given-names>David</given-names> <surname>Sherrington</surname></string-name> and <string-name><given-names>Scott</given-names> <surname>Kirkpatrick</surname></string-name>. <article-title>Solvable model of a spin-glass</article-title>. <source>Phys. Rev. Lett</source>., <volume>35</volume>, <year>1975</year>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><string-name><given-names>Shai</given-names> <surname>Slomka</surname></string-name>, <string-name><given-names>Itamar</given-names> <surname>Françoise</surname></string-name>, <string-name><given-names>Gil</given-names> <surname>Hornung</surname></string-name>, <string-name><given-names>Omer</given-names> <surname>Asraf</surname></string-name>, <string-name><given-names>Tammy</given-names> <surname>Biniashvili</surname></string-name>, <string-name><given-names>Yitzhak</given-names> <surname>Pilpel</surname></string-name>, and <string-name><given-names>Orna</given-names> <surname>Dahan</surname></string-name>. <article-title>Experimental evolution of Bacillus subtilis reveals the evolutionary dynamics of horizontal gene transfer and suggests adaptive and neutral effects</article-title>. <source>Genetics</source>, <volume>216</volume>(<issue>2</issue>), <year>2020</year>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><string-name><given-names>Hans-Jürgen</given-names> <surname>Sommers</surname></string-name>. <article-title>Path-integral approach to ising spin-glass dynamics</article-title>. <source>Phys. Rev. Lett</source>., <volume>58</volume>, <year>1987</year>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><string-name><given-names>H.</given-names> <surname>Sompolinsky</surname></string-name> and <string-name><given-names>Annette</given-names> <surname>Zippelius</surname></string-name>. <article-title>Dynamic theory of the spin-glass phase</article-title>. <source>Physical Review Letters</source>, <volume>47</volume>(<issue>5</issue>):<fpage>359</fpage>–<lpage>362</lpage>, <month>August</month> <year>1981</year>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="book"><string-name><given-names>H.</given-names> <surname>Sompolinsky</surname></string-name> and <string-name><given-names>Annette</given-names> <surname>Zippelius</surname></string-name>. <chapter-title>Relaxational dynamics of the Edwards-Anderson model and the mean-field theory of spin-glasses</chapter-title>. <source>Physical Review B</source>, <volume>25</volume>(<issue>11</issue>):<fpage>6860</fpage>–<lpage>6875</lpage>, <month>June</month> <year>1982</year>. Publisher: <publisher-name>American Physical Society</publisher-name>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><string-name><given-names>Amy</given-names> <surname>Tong</surname></string-name>, <string-name><given-names>Yan</given-names> <surname>Hin</surname></string-name>, <etal>et al.</etal> <article-title>Global mapping of the yeast genetic interaction network</article-title>. <source>Science</source>, <volume>303</volume> (<issue>5659</issue>), <year>2004</year>.</mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><string-name><given-names>Cristina</given-names> <surname>Toninelli</surname></string-name>, <string-name><given-names>Matthieu</given-names> <surname>Wyart</surname></string-name>, <string-name><given-names>Ludovic</given-names> <surname>Berthier</surname></string-name>, <string-name><given-names>Giulio</given-names> <surname>Biroli</surname></string-name>, and <string-name><given-names>Jean-Philippe</given-names> <surname>Bouchaud</surname></string-name>. <article-title>Dynamical susceptibility of glass formers: Contrasting the predictions of theoretical scenarios</article-title>. <source>Physical Review E</source>, <volume>71</volume>(<issue>4</issue>):<fpage>041505</fpage>, <year>2005</year>. ISSN <issn>1539-3755</issn>, 1550-2376. doi: <pub-id pub-id-type="doi">10.1103/PhysRevE.71.041505</pub-id>.</mixed-citation></ref>
<ref id="c70"><mixed-citation publication-type="journal"><string-name><given-names>Yinhua</given-names> <surname>Wang</surname></string-name>, <string-name><given-names>Carolina Diaz</given-names> <surname>Arenas</surname></string-name>, <string-name><given-names>Daniel M</given-names> <surname>Stoebel</surname></string-name>, and <string-name><given-names>Tim F</given-names> <surname>Cooper</surname></string-name>. <article-title>Genetic background affects epistatic interactions between two beneficial mutations</article-title>. <source>Biology letters</source>, <volume>9</volume>(<issue>1</issue>):<fpage>20120328</fpage>, <year>2013</year>.</mixed-citation></ref>
<ref id="c71"><mixed-citation publication-type="journal"><string-name><given-names>Daniel M.</given-names> <surname>Weinreich</surname></string-name>, <string-name><given-names>Richard A.</given-names> <surname>Watson</surname></string-name>, and <string-name><given-names>Lin</given-names> <surname>Chao</surname></string-name>. <article-title>Perspective: sign epistasis and genetic constraint on evolutionary trajectories</article-title>. <source>Evolution</source>, <volume>59</volume>(<issue>6</issue>):<fpage>1165</fpage>–<lpage>1174</lpage>, <year>2005</year>. ISSN <issn>0014-3820</issn>, 1558-5646. doi: <pub-id pub-id-type="doi">10.1111/j.0014-3820.2005.tb01768.x</pub-id>.</mixed-citation></ref>
<ref id="c72"><mixed-citation publication-type="journal"><string-name><given-names>D. B.</given-names> <surname>Weissman</surname></string-name>, <string-name><given-names>M. M.</given-names> <surname>Desai</surname></string-name>, <string-name><given-names>D. S.</given-names> <surname>Fisher</surname></string-name>, and <string-name><given-names>M. W.</given-names> <surname>Feldman</surname></string-name>. <article-title>The rate at which asexual populations cross fitness valleys</article-title>. <source>Theor Popul Biol</source>, <volume>75</volume>(<issue>4</issue>), <year>2009</year>.</mixed-citation></ref>
<ref id="c73"><mixed-citation publication-type="journal"><string-name><given-names>Claus O</given-names> <surname>Wilke</surname></string-name>. <article-title>The speed of adaptation in large asexual populations</article-title>. <source>Genetics</source>, <volume>167</volume>(<issue>4</issue>):<fpage>2045</fpage>–<lpage>2053</lpage>, <month>August</month> <year>2004</year>.</mixed-citation></ref>
<ref id="c74"><mixed-citation publication-type="journal"><string-name><given-names>Michael J.</given-names> <surname>Wiser</surname></string-name>, <string-name><given-names>Noah</given-names> <surname>Ribeck</surname></string-name>, and <string-name><given-names>Richard E.</given-names> <surname>Lenski</surname></string-name>. <article-title>Long-term dynamics of adaptation in asexual populations</article-title>. <source>Science</source>, <volume>342</volume>(<issue>6164</issue>), <year>2013</year>.</mixed-citation></ref>
</ref-list>
<sec id="s5">
<title>A Further simulation details</title>
<p>Here, we provide an overview of the simulation methodology, as well as values for the parameters used in our numerical experiments.</p>
<sec id="s5a">
<title>Strains</title>
<p>We begin with a population of size <italic>N</italic><sub>0</sub> and with an initial ancestral genotype <bold><italic>α</italic></bold><sup>(0)</sup> drawn randomly as <italic>L</italic> i.i.d. random variables taking the values ±1 with equal probability. We define mutations with respect to this initial sequence and define a strain by the path taken on the hypercube from the initial genotype to its current genotype. Due to microscopic epistasis, the fitness effect of a mutation can only be defined in the context of its genetic background. Defining strains by their path ensures that mutations at the same site with different fitness effects are correctly tracked throughout the simulation.</p>
</sec>
<sec id="s5b">
<title>Fitness and growth</title>
<p>We assume that each strain grows exponentially with rate given by its fitness. The primary quantity we study is the population mean fitness <italic>F</italic>(<italic>t</italic>), which is defined as the average fitness over all cells in the population. To obtain <italic>F</italic>(<italic>t</italic>), we average its value over replicate trajectories initialized from different ancestral genotypes within the same fitness landscape.</p>
<p>Recall that the fitness of a strain with genotype <bold><italic>α</italic></bold> ∈ {±1}<sup><italic>L</italic></sup> is given by
<disp-formula id="eqn9">
<alternatives><graphic xlink:href="524306v2_eqn9.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Because each strain grows with rate proportional to its fitness, we may write
<disp-formula id="eqn10">
<alternatives><graphic xlink:href="524306v2_eqn10.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
In (10), <italic>N</italic><sub><italic>i</italic></sub>(<italic>t</italic>) represents the size of strain <italic>i</italic> at time <italic>t</italic>, <bold><italic>α</italic></bold><sup>(<italic>i</italic>)</sup> is the genotype for strain <italic>i</italic>, and Δ<italic>t</italic> &gt; 0 is a timestep (set to Δ<italic>t</italic> = 0.01 in all simulations). To avoid biasing the growth for strains with low bacteria count, we allow <italic>N</italic><sub><italic>i</italic></sub>(<italic>t</italic>) ∈ ℝ throughout the simulation.</p>
</sec>
<sec id="s5c">
<title>Mutations</title>
<p>As the strains grow, mutants are generated with a fixed mutation rate <italic>μ</italic> &gt; 0, which describes the probability of a cell gaining a mutation when it divides. The genotype of a mutant is obtained from the genotype of the parent by flipping a site uniformly at random. A mutation is aid to have <italic>fixed</italic> if it is present in all strains. For a mutant with genotype <bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup> produced from a parent with genotype <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>, the fitness increment is Δ<italic>F</italic> (<bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup>, <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>) = <italic>F</italic> (<bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup>) − <italic>F</italic> (<bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>), while the selection coefficient is <italic>s</italic>(<bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup>, <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>) = Δ<italic>F</italic>(<bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup>, <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>)<italic>/F</italic> (<bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>).</p>
<p>After a step of size Δ<italic>t</italic>, following (10), the number of new bacteria produced by a given strain is equal to
<disp-formula id="ueqn4">
<alternatives><graphic xlink:href="524306v2_ueqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
To ensure that the number of mutants generated by strain <italic>i</italic> does not exceed the number of bacteria Δ<italic>N</italic><sub><italic>i</italic></sub>(<italic>t</italic>) generated by strain <italic>i</italic>, we draw a Poisson random variable
<disp-formula id="ueqn5">
<alternatives><graphic xlink:href="524306v2_ueqn5.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
and then set the number of mutants to be
<disp-formula id="ueqn6">
<alternatives><graphic xlink:href="524306v2_ueqn6.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
As new strains are generated through mutation events, we must check if they already exist in the population. If the strain already exists, the mutant joins the existing strain rather than defining a new one. Checking for the existence of a newly generated strain in the overall population can be performed efficiently by hashing the list of integers defining the path through genome space. All current paths can be stored in a set defining the active strains: the time complexity of checking set membership scales as 𝒪(1) with the number of strains, which is a significant reduction compared to checking all new mutant strains against all existing strains.</p>
</sec>
<sec id="s5d">
<title>Dilution protocol</title>
<p>The number of bacteria in each strain that make it through dilution to the following day follows a multivariate hypergeometric distribution. To efficiently sample from this distribution, we sequentially draw from the hypergeometric marginal distributions (<xref ref-type="bibr" rid="c18">Gentle, 1998</xref>). We first sort the population by number of bacteria in descending order. We then sample <italic>k</italic><sub>1</sub> ∼ Hyper (<italic>N</italic><sub><italic>f</italic></sub>, <italic>N</italic><sub>1</sub>, <italic>N</italic><sub>0</sub>) where <italic>N</italic><sub>1</sub> is the size of the largest strain. We then recursively apply this procedure, choosing <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline10.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> until we have drawn <italic>N</italic><sub>0</sub> bacteria or we have gone through the entire population. For greater efficiency, each hypergeometric marginal distribution can be replaced with a draw from a binomial distribution. We verified that our results are independent to this approximation.</p>
</sec>
<sec id="s5e">
<title>Replicates</title>
<p>Each simulation is performed with a number of replicate populations. Each replicate is instantiated with the same quenched disorder as specified by the <italic>h</italic><sub><italic>i</italic></sub> and <italic>J</italic><sub><italic>ij</italic></sub>. The dynamics for each replicate differ through the random initialization of the ancestral genotype <bold><italic>α</italic></bold><sup>(0)</sup> and through the sequence of random mutations. In the experiments studying the role of clonal interference, the same <italic>h</italic> and <italic>J</italic> are used as <italic>μ</italic> is varied.</p>
</sec>
<sec id="s5f">
<title>Power-law fitting methodology</title>
<p>To obtain fitness exponents, the mean (computed over repli- cates) trajectory is fit via nonlinear least-squares using the <monospace>scipy</monospace> function <monospace>curve_fit</monospace>. The standard error of the mean is used to weight the residuals in the loss function. Error bars are computed via the bootstrap method, by randomly sampling subsets of trajectories and fitting models to the mean over each subset. The corresponding estimates define an empirical distribution over parameters, from which we compute quantiles and use the median as the estimate of the parameters.</p>
</sec>
<sec id="s5g">
<title>Random walk statistics</title>
<p>We perform the following procedure to obtain an estimate of <italic>μ</italic><sub><italic>β</italic></sub> and <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline11.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula>. We average over initial landscapes and <monospace>n_inits</monospace> initializations with rank <italic>R</italic> for each value of <italic>β</italic>. For each initialization, we select a single beneficial mutation at random and compute the changes to all other <italic>R</italic> − 1 beneficial fitness increments. We compute the empirical mean and variance of these changes and average the resulting estimates over all landscapes and initializations. In the numerical experiments reported here, we set <italic>R</italic> = 100, <monospace>n_inits</monospace> = 10, and <monospace>n landscapes</monospace> = 10, though we found that our results were insensitive to the choice of number of landscapes and initializations.</p>
</sec>
<sec id="s5h">
<title>Coarse-grained simulation methodology</title>
<p>To simulate the discrete random walk model, we compute an initial empirical distribution of fitness increments according to (9) and save the sparsity pattern defined by the randomly drawn <italic>J</italic><sub><italic>ij</italic></sub>. At each fixation event, we flip Δ<italic>F</italic><sub><italic>i</italic></sub> → −Δ<italic>F</italic><sub><italic>i</italic></sub> and adjust each Δ<italic>F</italic><sub><italic>j</italic></sub> → Δ<italic>F</italic><sub><italic>j</italic></sub> + <italic>η</italic><sub><italic>j</italic></sub> for <italic>j</italic> ≠ <italic>i</italic> as discussed in the main text. If <italic>J</italic><sub><italic>ij</italic></sub> = 0 in the originally drawn genetic network, we set <italic>η</italic><sub><italic>j</italic></sub> = 0. For comparison, the full SSWM dynamics can be simulated using (9) directly.</p>
<p>Fixation probabilities are determined by Haldane’s formula <italic>p</italic><sub>fix</sub>(Δ<italic>F</italic>) ∼ Δ<italic>F/F</italic>. To fit our discrete random walk model into the framework of Gillespie’s stochastic simulation algorithm, we define “chemical reactions” corresponding to each possible fixation event. The reaction propensity for a mutation at site <italic>i</italic> is taken to be equal to <italic>p</italic><sub>fix</sub>(Δ<italic>F</italic><sub><italic>i</italic></sub>). We choose a mutation site at random with probability proportional to its fixation probability. We randomly draw the time that occurred before the next fixation event according to an exponential distribution with mean <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline12.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> (up to an overall mutation rate fixing the units of time).</p>
</sec>
</sec>
<sec id="s6">
<title>B Fast fitness computation</title>
<p>The following lemma gives a fast algorithm for computing the fitness of a given bacterial strain. The proof proceeds by noting that rather than computing (1) directly, we can compute the fitness of a strain <bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup> with respect to its parent strain <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup>. It concludes by observing that the fitness of <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup> can be related to the fitness of an arbitrary reference strain <bold><italic>α</italic></bold><sup>(<italic>r</italic>)</sup>. This reference strain can be adjusted on-the-fly to track the state of the population.</p>
<statement id="lem1">
<label>Lemma 1.</label>
<p><italic>Let</italic> <bold><italic>α</italic></bold><sup>(<italic>r</italic>)</sup> ∈ {±1}<sup><italic>L</italic></sup> <italic>denote the genotype of a reference strain</italic>, <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup> ∈ {±1}<sup><italic>L</italic></sup> <italic>denote the genotype of the parent strain, and</italic> <bold><italic>α</italic></bold><sup>(<italic>c</italic>)</sup> ∈ {±1}<sup><italic>L</italic></sup> <italic>denote the genotype of the child strain obtained from</italic> <bold><italic>α</italic></bold><sup>(<italic>p</italic>)</sup> <italic>via a mutation at gene k. Then</italic>,
<disp-formula id="eqn11">
<alternatives><graphic xlink:href="524306v2_eqn11.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<italic>where M</italic><sub><italic>r</italic></sub> <italic>denotes the set of mutations of the parent with respect to the reference strain</italic>.</p>
<p><xref ref-type="disp-formula" rid="eqn11">Equation (11)</xref> states that if we store the elements of the vector <bold>J<italic>α</italic></bold><sup>(<italic>r</italic>)</sup> ∈ ℝ<sup><italic>L</italic></sup>, we can compute the fitness of a child strain in terms of the fitness of the parent strain in time complexity 𝒪(|<italic>M</italic><sub><italic>r</italic></sub>|). This is a massive improvement over the 𝒪(<italic>L</italic><sup>2</sup>) complexity corresponding to a naive calculation of the quadratic form, and a large improvement over the 𝒪(<italic>L</italic>) complexity corresponding to computing the fitness of the child with respect to the fitness of the parent, particularly if the reference strain is updated to keep |<italic>M</italic><sub><italic>r</italic></sub>| small. We found empirically that setting the reference strain to be equal to the dominant strain every time the dominant strain accumulates 15 new fixed mutations was a good heuristic.</p>
<p><italic>Proof</italic>. Observe that we may write
<disp-formula id="ueqn7">
<alternatives><graphic xlink:href="524306v2_ueqn7.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
</p>
</statement>
<p>Now, write that <inline-formula><alternatives><inline-graphic xlink:href="524306v2_inline13.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> with
<disp-formula id="eqn12">
<alternatives><graphic xlink:href="524306v2_eqn12.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
Plugging this in completes the proof. □</p>
</sec>
<sec id="s7">
<title>C Additional figures</title>
<p><xref rid="fig7" ref-type="fig">Figures 7</xref> and <xref rid="fig8" ref-type="fig">8</xref> visualize the fitness trajectory as a function of normalized time, as referenced in the main text.</p>
<p><xref rid="fig9" ref-type="fig">Figures 9</xref> and <xref rid="fig10" ref-type="fig">10</xref> consider the correlation functions
<disp-formula id="ueqn8">
<alternatives><graphic xlink:href="524306v2_ueqn8.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
and
<disp-formula id="ueqn9">
<alternatives><graphic xlink:href="524306v2_ueqn9.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
from spin glass physics, as referenced in the main text.</p>
</sec>
<fn-group>
<fn id="fn1">
<label><sup>1</sup></label>
<p>Here, ⟨·⟩ denotes an average over the distribution of fitness effects at time <italic>t</italic>. Moreover, this quantity is normalized via the same change of scale used to ensure <italic>F</italic>(<italic>t</italic>) ∈ [1, 2].</p></fn>
<fn id="fn2">
<label><sup>2</sup></label>
<p>Here, angular brackets denote an average over independent trajectories.</p></fn>
</fn-group>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87895.2.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ogbunugafor</surname>
<given-names>C Brandon</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Yale University</institution>
</institution-wrap>
<city>New Haven</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Compelling</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This <bold>important</bold> study describes a high performance computational approach to interrogate how microscopic epistasis and clonal interference affect evolutionary dynamics in a spin glass model of microbial evolution. The study offers several insights that can aid in our understanding of the forces that operate in adaptive evolution. The evidence provided is <bold>compelling</bold>, with its rigorous use of models and analytical descriptions of how these forces manifest in evolution.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87895.2.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This paper presents extensive numerical simulations using a model that incorporates up to second-order epistasis to study the joint effects of microscopic epistasis and clonal interference on the evolutionary dynamics of a microbial population. Previous works that explicitly modeled microscopic epistasis typically assumed strong selection &amp; weak mutation (SSWM), a condition that is generally not met in real-life evolutionary processes. Alternatively, another class of models coarse-grained the effects of microscopic epistasis into a generic distribution of fitness effects. The framework introduced in this paper represents an important advance with respect to these previous approaches, allowing for the explicit modeling of microscopic epistasis in non-SSWM scenarios. The modeling framework presented promises to be a valuable tool to study microbial evolution in silico.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87895.2.sa0</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This paper presents an extensive numerical study of microbial evolution using a model of fitness inspired by spin glass physics. It places special emphasis on elucidating the combined effects of microscopic epistasis, which dictates how the fitness effect of a mutation depends on the genetic background on which it occurs, and clonal interference, which describes the proliferation of and competition between multiple strains. Both microscopic epistasis and clonal interference have been observed in microbial evolution experiments, and are chief contributors to the complexity of evolutionary dynamics. Correlations between random mutations and nonlinearities associated with interactions between sub-populations consisting of competing strains make it extremely challenging to make quantitative theoretical predictions for evolutionary dynamics and associated observables such as the mean fitness. While the body of theoretical and computational research on modeling evolutionary dynamics is extensive, most theoretical efforts rely on making simplifications such as the strong selection weak mutation (SSWM) limit, which neglects clonal interference, or assumptions about the distribution of fitness effects that are not experimentally verifiable.</p>
<p>The authors have addressed this challenge by running a numerical microbial evolution experiment over realistic population sizes (~ 100 million cells) and timescales (~ 10,000 generations) using a spin glass model of fitness that considers pairwise interactions between mutations on distinct genetic loci. By independently tuning mutation rate as well as the strength of epistasis, the authors have shown that epistasis generically slows down the growth of fitness trajectories regardless of the amount of clonal interference. On the other hand, in the absence of epistasis, clonal interference speeds up the growth of fitness trajectories, but leaves the growth unchanged in the presence of epistasis. The authors quantitatively characterize these observations using asymptotic power law fits to the mean fitness trajectories. Further, the authors employ more simplified macroscopic models that are informed by their empirical findings, to reveal the mechanistic origins of the epistasis mediated slowing down of fitness growth. Specifically, they show that epistasis leads to a broadening of the distribution of fitness increments, leading to the fixation of a large number of mutations that confer small benefits. Effectively, this leads to an increase in the number of fixed mutations required to climb the fitness peak. This increased number of required beneficial mutations together with the decreasing availability of beneficial mutations at high fitness lead to the slowdown of fitness growth. The authors' data analysis is quite solid and their conclusions are well supported by quantitative macroscopic models. The paper also includes an interesting analysis of dynamical correlations between mutations, using tools developed in the spin glass literature.</p>
<p>One of the highlights of this paper is the author's astute choice of model, which strikes an impressive balance between complexity, flexibility, and numerical accessibility. In particular, the authors were able to achieve results over realistic population sizes and timescales largely because of the amenability of the model to the implementation of an efficient simulation algorithm. At the same time, the strength of epistasis and clonal interference can be tuned in a facile manner, enabling the authors to map out a phase diagram spanning these two axes. One could argue that the numerical scheme employed here would only work for a specific class of models, and is therefore not generalizable to all models of evolutionary dynamics. While this is likely true, the model is capable of recapitulating several complex aspects of microbial evolution, and is therefore not unduly restrictive.</p>
<p>Spin glass physics has already provided significant insights into a wide range of topics in the life sciences including protein folding, neuroscience, ecology and evolution. The present work carries this approach forward, with immediate implications for microbial evolution, and potential implications in related areas of research such as microbial ecology. In addition to the theoretical value of spin glass physics, the high performance algorithm developed in this work lays the foundation for formulating data driven approaches aimed at understanding evolutionary dynamics. In the future, there is considerable scope for utilizing data generated by such models to train machine learning algorithms for quantifying parameters associated with epistasis, clonal interference, and the distribution of fitness effects in laboratory experiments.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.87895.2.sa3</article-id>
<title-group>
<article-title>Author Response</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Boffi</surname>
<given-names>Nicholas M.</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1336-7568</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Guo</surname>
<given-names>Yipei</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Rycroft</surname>
<given-names>Chris H.</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Amir</surname>
<given-names>Ariel</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 1</bold></p>
</disp-quote>
<p>We thank the reviewer for their thoughtful comments. We have addressed them below, and we believe that have significantly strengthened the clarity of the manuscript.</p>
<disp-quote content-type="editor-comment">
<p>Main Comments:</p>
<p>In Fig. 2C-D, I am not sure I understand why ≈ 100 mutations fix with β = 0. In the absence of epistasis, and since the coefficients hi are sampled from a symmetric distribution centered at zero, it is to be expected that roughly half of the mutations will have positive fitness effects and thus will eventually fix in the population. With L = 250, I would have expected to see the number of fixed mutations approach ≈ 125 for β = 0. Perhaps I am missing something?</p>
</disp-quote>
<p>• In our simulations, we initialize all populations from a state where there are only 100 available beneficial mutations (i.e., the initial rank is always 100). Without epistasis, these initial beneficial mutations are the only beneficial mutations that will be present throughout the entire trajectory. Hence, for β = 0, only 100 beneficial mutations can fix. Previously, this information could be found in the “Materials and methods” section of the SI. To make this aspect of our simulation more clear in the revision, we have added a discussion of the initial rank to the “Landscape structure” subsection of the model definition section. In addition, we have merged “Materials and methods” with “Further simulation details” in the SI into one section, and have listed the values for the simulation parameters in the model definition section.</p>
<disp-quote content-type="editor-comment">
<p>Along these lines, the authors show that increasing β leads to a higher number of fixed mutations. I am not sure I understand their explanation for this. In line 209 they write that as β increases, “mutations are needed to cease adaptation”. The way I see it, in the absence of epistasis the fitness peak should correspond to a genotype with ≈ L/2 mutations (the genotype carrying all mutations with hi &gt; 0). Increasing the magnitude of microscopic epistasis (i.e., increasing β ), and assuming that there is no bias towards positive epistasis (which there shouldn’t be based on the model formulation, i.e., section &quot;Disorder statistics&quot; on page 4), can change the “location” of the fitness peak, such that it now corresponds to a different genotype. Statistically speaking, however, there are more genotypes with L/2 mutations than with any other number of mutations, so I would have expected that, on average, the number of mutations fixed in the population would still have been ≈ L/2 (naturally with somewhat large variation across replicates, as seems to be the case).</p>
</disp-quote>
<p>• With epistasis, the situation becomes more complex. The structure of our model imposes significant sign epistasis in general (i.e. mutations can be beneficial on one background genotype and deleterious on another). This means that in the presence of epistasis, more than 100 mutations can be required to reach a local optimum even when the initial rank was 100. Intuitively, this occurs because mutations that were deleterious on the ancestral background genotype can become beneficial on future genotypes. We find that this occurs consistently throughout adaptation, leading to the accumulation of more mutations with increasing epistasis.</p>
<p>• Please note that we use the value L = 1000 in our simulations. We have also made the fact that we use L = 1000 more clear by moving the description of the simulation parameters to the main text.</p>
<disp-quote content-type="editor-comment">
<p>I do see how, in the clonal interference regime, there can be multiple genotypes in the population at a given time (each with a different mutational load), thus making the number of fixed mutations larger than L/2 when aggregating over all genotypes in the population. But this observation makes less intuitive sense to me in the SSWM regime. In lines 207-208, the authors state that “as beta increases, a greater number of new available beneficial mutations are generated per each typical fixation event”. While this is true, it is also the case that a greater number of mutations that would have been beneficial in the absence of epistasis are now deleterious due to negative epistasis (if I am understanding what the authors mean correctly).</p>
</disp-quote>
<p>• The reviewer is correct to note that in the strong clonal interference regime, there will be more accumulated mutations across the entire population than in any single strain. However, we report the number mutations that have fixed, i.e., become present in the entire population.</p>
<p>• We find that the typical decrease in rank (per fixation event) of the population decreases with increasing epistasis — i.e., the number of available beneficial mutations that are “consumed” when a mutation fixes is typically lower in systems with stronger epistasis.</p>
<disp-quote content-type="editor-comment">
<p>Similarly, I am not sure I understand how one goes from equation (6) to equation (7). In particular, it would seem to me that the term 4αiαj Ji j in equation (6) should be equally likely to be positive or negative (again assuming no bias towards positive Ji j). I thus do not see why ηi j in equation (7) is sampled from a normal distribution with mean µβ instead of just mean zero.</p>
</disp-quote>
<p>• The reviewer is correct that, for a uniformly random initial state, αi , αj , and Ji j will be uncorrelated so that the distribution of 4αiαj Ji j can be computed exactly (and has mean zero). However, we initialize from a state with rank 100, so that we need to compute the distribution of the random variable E[αiαj Ji j|αiαj Ji j &gt; 0, R = 100]. This is mathematically very challenging, because there are nontrivial correlations between spins even at initialization. For these reasons, we found the uniformly random approximation insufficient. This is described in the paragraph following Equation (7) in the resubmission.</p>
<disp-quote content-type="editor-comment">
<p>Minor Comments:</p>
<p>The authors use a model including terms up to second-order epistasis. To be clear, I think this choice is entirely justified: as they mention in their manuscript, this structure allows to approximate any fitness model defined on a Boolean hypercube. As I understand it, the reason for not incorporating higher-order terms (as in e.g. Reddy and Desai, eLife 2021) has to do with computational efficiency, i.e., accommodating higher-order terms in equation (10) may lead to a substantial increase in computation time. Is this the case?</p>
</disp-quote>
<p>• The author is correct that the incorporation of higher-order terms leads to significantly more expensive computation. It’s an interesting direction of future inquiry to see if our adaptive fast fitness computation method can be extended to higher-order interactions.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 2</bold></p>
</disp-quote>
<p>We would like to thank the reviewer for their careful reading and their useful comments connecting our work to spin glass physics. We believe the resulting additions to the paper have made our contributions stronger, and that they reveal some novel connections between the substitution trajectory and correlation functions in spin glasses. A summary of our investigation is provided below, and we have added two paragraphs to the discussion section under the heading “Connections to spin glass physics”.</p>
<disp-quote content-type="editor-comment">
<p>Main Comments:</p>
<p>In spin glasses, slowdown of dynamics could have contributions from stretched exponential relaxation of spin correlations as well as aging, each of which are associated with their own exponents. In the present model, these processes could be quantified by computing two-point correlations associated with genomic overlap, as a function of lag time as well as waiting time (generation number). The population dynamics of competing strains makes the analysis more complicated. But it should be possible to define these correlations by separately averaging over lineages starting from a single parent genome, and over distinct parent genomes. It would be interesting to see how exponents associated with these correlations relate to the exponent c associated with asymptotic fitness growth.</p>
</disp-quote>
<p>•   To investigate this point, we first considered the two-point correlation function 〈αi (tw)αi (tw+
∆t)〉 for waiting time tw and lag time ∆t. Because all spins are statistically identical, it is natural to average this over the spin index i, leading to the quantity</p>
<disp-formula id="sa3equ1">
<graphic mime-subtype="jpg" xlink:href="elife-87895-sa3-equ1.jpg" mimetype="image"/>
</disp-formula>
<p>Viewed as a function of ∆t for any fixed tw, it is clear that <inline-formula id="sa3equ2"><inline-graphic xlink:href="elife-87895-sa3-equ2.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. If m mutations with respect to α(tw) have fixed at time tw + ∆t, a similar calculation shows that <inline-formula id="sa3equ3"><inline-graphic xlink:href="elife-87895-sa3-equ3.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. Surprisingly, this simple derivation reveals that the two-spin correlation function commonly studied in spin glass physics is an affine transformation of the substitution trajectory commonly studied in population genetics. Moreover, it shows that the effect of tw is to change the definition of the ancestral strain, so that we may set tw = 0 without loss of generality and study the correlation function χ2(t) = 1 − 2m(t) where m(t) is the mean substitution trajectory of the population. Much of our analysis proceeds by analyzing the effect of epistasis on the accumulation of mutations. This relation provides a novel connection between this analysis and the analysis of correlation functions in the spin glass literature.</p>
<p>• It is well known that in the SSWM limit without epistasis, the substitution trajectory follows a power law similar to the fitness trajectory with relaxation exponent 1.0 [1]. Informed by this identity, we performed simulations in the SSWM limit and fit power laws to the correlation function χ2 as a function of time. We have verified that χ2(t) obeys a power- law relaxation with exponent roughly 1.0 for β = 0; moreover, as anticipated by the reviewer, the corresponding exponent decreases with increasing β . Nevertheless, we find that these relaxation exponents are distinct from those found for the fitness trajectory, despite following the same qualitative trend. This point is particularly interesting, as it highlights that the dynamics of fixation induce a distinct functional form at the level of the correlation functions when compared to, for example, the Glauber dynamics in statistical physics.</p>
<disp-quote content-type="editor-comment">
<p>The strength of dynamic correlations in spin glasses can be characterized by the four-point susceptibility, which contains information about correlated spin flips. These correlations are maximized over characteristic timescales. In the context of evolution, such analysis may provide insights on the correlated accumulation of mutations on different sets of loci over different timescales. It would be interesting to see how these correlations change as a function of the mutation rate as well as the strength of epistasis.</p>
</disp-quote>
<p>• To study this point, we considered the four-point correlation function</p>
<disp-formula id="sa3equ4">
<graphic mime-subtype="jpg" xlink:href="elife-87895-sa3-equ4.jpg" mimetype="image"/>
</disp-formula>
<p>Because spins are statistically identical, we found numerically that the genotype average is roughly equivalent to the angular average over trajectories. Inter-changing the order of the summation and the angular averaging, we then find that</p>
<disp-formula id="sa3equ5">
<graphic mime-subtype="jpg" xlink:href="elife-87895-sa3-equ5.jpg" mimetype="image"/>
</disp-formula>
<p>so that the information contained in the four-point correlation function is the same as the information contained in the two-point correlation function.</p>
<disp-quote content-type="editor-comment">
<p>Fig. 2E and Fig. 5 together suggests an intriguing possibility when interpreted in the spin glass context. It is clear that in the absence of epistasis, clonal interference accelerates fitness growth. Fig. 2E additionally suggests that this scenario will continue to hold even in the presence of weak, but finite epistasis, but disappears for sufficiently strong epistasis. I wonder if the two regimes are separated by a phase transition at some non-trivial strength of epistasis. Indeed, the qualitative behavior appears to change from that of a random field Ising spin glass for small β , to that of a zero field Sherrington-Kirkpatrick spin glass for sufficiently large β . While the foregoing comments are somewhat speculative, perhaps a discussion along these lines, and what it means in the context of evolution could be a useful addition to the discussion section of the paper.</p>
</disp-quote>
<p>• We thank the reviewer for this interesting suggestion, and we have added a discussion of this point to the text in the future directions section, lines 483–489.</p>
<disp-quote content-type="editor-comment">
<p>Minor Comments:</p>
<p>1. In the abstract (line 17-18), I recommend use of the phrase &quot;a simulated evolving population&quot; to avoid a possible misinterpretation of the work as experimental as opposed to numerical.</p>
</disp-quote>
<p>• We have added the word “simulated”.</p>
<disp-quote content-type="editor-comment">
<p>1. In line 70, the word &quot;the&quot; before &quot;statistical physics&quot; is redundant.</p>
</disp-quote>
<p>• We have removed “the”.</p>
<disp-quote content-type="editor-comment">
<p>1. To make the message in lines 294-295 visually clear, I recommend keeping the Y-axis scale bars constant across Fig. 4A and Fig. 4B.</p>
</disp-quote>
<p>• We appreciate the suggestion. However, we found that when putting the two figures on the same scale, because the agreement is only qualitative and not quantitative (as emphasized in the text), it becomes difficult to view the trend in both systems. For this reason, we have chosen to keep the figure as-is.</p>
<disp-quote content-type="editor-comment">
<p>1. Fig. 6 caption states: &quot;Without epistasis, the rank decreases with increasing µ&quot;. It should be &quot;rank increases&quot;.</p>
</disp-quote>
<p>• We have fixed this.</p>
<disp-quote content-type="editor-comment">
<p>1. In the last sentence in the caption to Fig. 8, the labels &quot;(A, β =0)&quot; and &quot;(B, β =0.25)&quot; need to be swapped.</p>
</disp-quote>
<p>• We have fixed this.</p>
<disp-quote content-type="editor-comment">
<p><bold>Editor Comments</bold></p>
</disp-quote>
<p>We thank the editor for pointing our attention towards these three interesting references, in particular the second, which appears most relevant to our work. We have added a discussion of reference 2 in the future directions section (lines 471–482), commenting on how to determine the contribution of within-path clonal interference to the fitness dynamics in our model. We have also added a reference to article 3 in the model description, commenting on the importance of sign epistasis and the prevalence of sign epistasis in our model with β &gt; 0.</p>
<p><bold>References:</bold></p>
<p>1. Good BH, Desai MM. The impact of macroscopic epistasis on long-term evolutionary dynamics. Genetics. 2015.</p>
</body>
</sub-article>
</article>