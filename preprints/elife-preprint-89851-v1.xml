<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">89851</article-id>
<article-id pub-id-type="doi">10.7554/eLife.89851</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.89851.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Modeled grid cells aligned by a flexible attractor</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Benas</surname>
<given-names>Sabrina</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">*</xref></contrib>
<contrib contrib-type="author">
<name>
<surname>Fernandez</surname>
<given-names>Ximena</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
<xref ref-type="author-notes" rid="n1">*</xref></contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-5996-8436</contrib-id>
<name>
<surname>Kropff</surname>
<given-names>Emilio</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">#</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Leloir Institute – IIBBA/CONICET</institution>, Buenos Aires, <country>Argentina</country></aff>
<aff id="a2"><label>2</label><institution>Department of Mathematics, Durham University</institution>, <country>UK</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Giocomo</surname>
<given-names>Lisa M</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Stanford School of Medicine</institution>
</institution-wrap>
<city>Stanford</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Poirazi</surname>
<given-names>Panayiota</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>FORTH Institute of Molecular Biology and Biotechnology</institution>
</institution-wrap>
<city>Heraklion</city>
<country>Greece</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn id="n1" fn-type="equal"><label>*</label><p>These authors contributed equally.</p></fn>
<corresp id="cor1"><label>#</label>Corresponding author; email: <email>kropff@gmail.com</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-09-01">
<day>01</day>
<month>09</month>
<year>2023</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP89851</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-06-26">
<day>26</day>
<month>06</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-05-28">
<day>28</day>
<month>05</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2022.06.13.495956"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Benas et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Benas et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-89851-v1.pdf"/>
<abstract>
<title>Abstract</title><p>Entorhinal grid cells implement a spatial code with hexagonal periodicity, signaling the position of the animal within an environment. Grid maps of cells belonging to the same module share spacing and orientation, only differing in relative two-dimensional spatial phase, which could result from being interconnected by a two-dimensional attractor. However, this architecture has the drawbacks of being complex to construct and rigid, allowing no deviations from the hexagonal pattern such as the ones observed under a variety of experimental manipulations. Here we show that a simpler one-dimensional attractor is enough to align grid cells equally well. Using topological data analysis, we show that the resulting population activity is a sample of a torus, while the ensemble of maps preserves features of the network architecture. The flexibility of this low dimensional attractor allows it to negotiate the geometry of the representation manifold with the feedforward inputs, rather than imposing it. More generally, our results represent a proof of principle against the intuition that the architecture and the representation manifold of an attractor are the same topological object, with implications to the study of attractor networks across the brain.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>The main text and the appendix have been revised.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Grid cells in the medial entorhinal cortex and other brain areas provide a representation of the spatial environment navigated by an animal, through maps of hexagonal periodicity that have been compared to a system of Cartesian axes <sup><xref ref-type="bibr" rid="c1">1</xref>–<xref ref-type="bibr" rid="c3">3</xref></sup>. While different mechanisms have been proposed as the basis to make a neuron develop a collection of responsive fields distributed in space with hexagonal periodicity, the alignment of axes of symmetry between neighboring, co-modular neurons in most computational models occurs through direct excitatory communication between them <sup><xref ref-type="bibr" rid="c4">4</xref>–<xref ref-type="bibr" rid="c7">7</xref></sup>. In general, the network responsible for this communication can be thought of as a two-dimensional continuous attractor <sup><xref ref-type="bibr" rid="c8">8</xref></sup>.</p>
<p>Attractor networks are among the clearest examples of unsupervised self-organization in the brain. Point-like attractors emerge naturally in a network with dense recurrent connectivity equipped with Hebbian plasticity, and can be used to store and retrieve discrete pieces of information <sup><xref ref-type="bibr" rid="c9">9</xref></sup>. If a number of point-like attractors is set close enough to each other along some manifold, a continuous attractor emerges. One-dimensional ring attractors have been used to model head direction cells <sup><xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c11">11</xref></sup>, while two dimensional attractors have been used to model population maps of space such as those of place cells or grid cells <sup><xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c12">12</xref>, <xref ref-type="bibr" rid="c13">13</xref></sup>. A common underlying assumption is that the dimensionality of the network architecture mimics that of the space that is being represented, which explains why the word ‘dimensionality’ applied to an attractor is indistinctly used to refer to one or the other. However, the network activity does not only depend on recurrent connections, but also on inputs, and the potential interplay between these two sources has so far received little attention. Grid cells have been modeled using two-dimensional attractors because they represent two-dimensional space, but a number of reasons call for the exploration of alternatives. First, grid cells are also capable of representing one dimensional variables such as space, time or the frequency of a sound, or three dimensional space, exhibiting poor to no periodicity <sup><xref ref-type="bibr" rid="c14">14</xref>–<xref ref-type="bibr" rid="c19">19</xref></sup>. Second, two dimensional attractors impose a rather rigid constraint on the activity of neurons, but grid maps can suffer global or local modifications in response to different experimental manipulations <sup><xref ref-type="bibr" rid="c20">20</xref>–<xref ref-type="bibr" rid="c26">26</xref></sup>. Third, the mechanisms behind the formation and maintenance of such a complex and fine-tuned network are far from understood, and theoretical proposals tend to involve as a prerequisite an independent functional representation of two-dimensional space to serve as a tutor <sup><xref ref-type="bibr" rid="c27">27</xref>, <xref ref-type="bibr" rid="c28">28</xref></sup>. Fourth, a recent experiment shows that when animals are trained to navigate deprived from sensory and vestibular feedback, entorhinal cells tend to develop a surprising ring (1D) rather than toroidal (2D) population dynamic <sup><xref ref-type="bibr" rid="c29">29</xref></sup>.</p>
<p>Here we explore the possibility that grid cells are aligned by simpler, one-dimensional attractors, which, as we show, have the potential to flexibly organize the population activity into a space with a dimensionality that is negotiated with the inputs rather than pre-defined. Crucially, we show for the first time with mathematical rigor that the architecture and representational space of an attractor network can be two different topological objects. This proof of principle broadens the spectrum of potential candidates for the recurrent architecture interconnecting grid cells, opening the possibility of variability along animal development and maturation, or across the multiple brain areas where grid cells have been described.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>Grid maps aligned by a one-dimensional attractor</title>
<p>To understand if grid maps can be aligned by an architecture of excitatory recurrent collateral connections simpler than a two-dimensional attractor, we trained a model in which grid maps are obtained from spatial inputs through self-organization <sup><xref ref-type="bibr" rid="c4">4</xref></sup>. In this model, a layer of spatially stable inputs projects to a layer of grid cells through feedforward connections equipped with Hebbian plasticity (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>). Two factors, all-to-all inhibition and adaptation, force neurons in the grid cell layer to take turns to get activated. This dynamic promotes selectivity in the potentiation of afferent synapses to any given grid cell. As a virtual animal navigates an open-field environment, modeled entorhinal cells self-organize, acquiring maps with hexagonal symmetry as a result of Hebbian sculpting of the feedforward connectivity matrix. Previous work shows that these maps are not naturally aligned unless excitatory recurrent collaterals are included <sup><xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c27">27</xref></sup>.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Figure 1</label>
<caption><title>Attractors with a 2D or 1D architecture align grid maps.</title><p><bold>a</bold>, Schematics of the network model, including an input layer with place cell-like activity (purple), feedforward all-to-all connections with Hebbian plasticity and a grid cell layer (green) with global inhibition and a set of excitatory recurrent collaterals of fixed structure. <bold>b</bold>, Schematics of the recurrent connectivity from a given cell (orange) to its neighbors (green) in a 2D (top) or 1D (bottom) setup. <bold>c</bold>, Representative examples of maps belonging to the same 2D (top) or 1D (bottom) network at the end of training. <bold>d</bold>, Average of all autocorrelograms in the same two simulations, highlighting the 6 maxima around the center (black circles). <bold>e</bold>, Superposition of the 6 maxima around the center (as in <bold>d</bold>) for all individual autocorrelograms in the same two simulations.</p></caption>
<graphic xlink:href="495956v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We performed 100 simulations of a simplified version of this self-organizing network (Methods), including 225 input cells and N<sub>EC</sub> = 100 grid cells, in two otherwise identical setups. In the first scenario (2D), we added to the grid cell layer a classical architecture of recurrent collateral connections shaped as a torus (<xref rid="fig1" ref-type="fig">Fig. 1b</xref>). In the second scenario (1D), we used instead a much simpler ring attractor architecture. At the end of the learning process, maps in both types of simulation had hexagonal symmetry (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>). The mean population autocorrelogram also had hexagonal symmetry, indicating that individual maps within the network shared spacing and orientation (<xref rid="fig1" ref-type="fig">Fig. 1d</xref>), which was further confirmed by the clustering into 6 well defined groups of first order autocorrelogram maxima for the pool of all cells (<xref rid="fig1" ref-type="fig">Fig. 1e</xref>). This was true not only for the 2D architecture, which was constructed in an ad hoc way to align grid maps, but also for the much simpler 1D architecture.</p>
<p>For a quantitative comparison of grid cell properties, we incorporated two additional conditions: a stripe-like linear attractor with no periodic boundaries (1D<sub>L</sub>) and a condition with no recurrent collaterals (No), in setups otherwise identical to those of 1D and 2D. We compared across conditions the hexagonality of maps (through a gridness index), the spacing between neighboring fields and the angular spread in axes of symmetry across the population, indicative of alignement (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>). We found marked differences only between the No condition and the other three. Gridness was highest for 1D, followed closely by 2D and 1D<sub>L</sub>, while the No condition exhibited markedly lower values. Spacing and spread were lowest for the 2D condition, followed by a small margin by 1D and 1D<sub>L</sub>, with the No condition again presenting the largest differences with the rest. These results suggest that attractor connectivity of all investigated types not only aligns grid cells similarly but also has the effect of compressing maps in terms of spacing. To visualize how individual maps varied across categories, we plotted the distribution of pooled maxima (as in <xref rid="fig1" ref-type="fig">Fig. 1e</xref>) relative to the axis of the corresponding autocorrelogram presenting the highest correlation value (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>).</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Figure 2</label>
<caption><title>Quantification of the alignment and contraction of grid maps by different attractor architectures.</title><p><bold>a</bold>, Distribution of gridness (left), spacing (center) and spread (right) at the end of the learning process across conditions (quartiles; identical simulations except for the architecture of recurrent collaterals). <bold>b</bold>, Smoothed distribution of maxima relative to the main axis of the corresponding autocorrelogram. <bold>c</bold>, Mean evolution of gridness (top) and spacing (bottom) in transient maps along the learning process, calculated from individual (left) or average (right) autocorrelograms.</p></caption>
<graphic xlink:href="495956v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To address differences in the self-organization dynamics, we next inspected maps along the learning process (<xref rid="fig2" ref-type="fig">Fig. 2c</xref>). We found that the mean gridness of cells initially increased at a similar pace for all conditions, saturating early in this process only for the No condition. Further increase in gridness was an emergent property only allowed by attractor dynamics, which in the 2D condition took a slightly slower start compensated later by an elbow toward plateauing behavior at higher gridness values. For simulations with attractors, population gridness, while always lower than mean individual gridness, increased steadily, with 2D exhibiting slightly higher values most of the time, but no substantial increase was observed in the No condition given the absence of alignment between maps. The asymptotic behavior for both individual and population gridness was similar for all conditions with attractors. Individual spacing in maps with attractors showed a decrease throughout most of the learning process, more pronounced in the 2D condition, while the No condition evidenced a steady increase toward an asymptote. A combination of progressive increase in gridness and decrease in spacing across days has been observed in animals familiarizing with a novel environment <sup><xref ref-type="bibr" rid="c20">20</xref></sup>. Our results, although only qualitatively exhibiting similar trends, point to the efficiency of excitatory collaterals in imposing constraints to the population activity as a possible mechanism. This compression of maps resulting from experience was less evident in the mean population spacing, obtained from average autocorrelograms, indicating that, at least in our simulations, this phenomenon has a strong driver in the deviation of individual cells from the coordinated population behavior, which would explain why the contraction is more marked for the most rigid constraint (2D). Despite these subtle differences, gridness, spacing and spread looked overall very similar across conditions with attractors, and markedly different in the No condition.</p>
</sec>
<sec id="s2b">
<title>Toroidal topology of the population activity space</title>
<p>Classical features such as gridness and spacing looked similar in maps obtained with different attractor geometry. We next asked, more generally, if the topology of the population activity was also the same for different conditions. Every pixel in the arena where the virtual animal runs is associated with a vector containing the mean activity of each neuron in that position. These vectors are the columns of the population matrix M, where the element M<sub>ij</sub> is the mean activity of the i<sup>th</sup> neuron in the j<sup>th</sup> pixel. This set of vectors form a point cloud of size equal to the number of pixels in a space of dimension N<sub>EC</sub> (the number of grid cells). It is commonly understood, given the symmetry of grid maps, that this cloud should be a sample of a low dimensional structure represented by a twisted torus and embedded in a high dimensional space <sup><xref ref-type="bibr" rid="c8">8</xref></sup>, as recently shown in experimental data<sup><xref ref-type="bibr" rid="c13">13</xref></sup> (see Methods and Fig. S1).</p>
<p>The topology of a point cloud can in some cases be completely determined through a series of methods in topological data analysis. The theorem of classification of closed surfaces states that if the population activity space is a sample of a geometric object that (i) is locally two-dimensional, (ii) has neither boundary nor singularities and (iii) is orientable, then its topology is determined by its homology <sup><xref ref-type="bibr" rid="c30">30</xref></sup> (see Methods).</p>
<p>To understand whether and when this is true in our simulations, we first studied the local dimension of the population activity space (i) for the different conditions. To avoid irregularities sometimes found at the perimeter of the environment, we used for all further analyses the 60 cm wide central square of each 1 m wide map. For every data point, we extracted the principal components of a local neighborhood around it (<xref ref-type="fig" rid="figs1">Fig. S1</xref>). We defined the local dimension at this point as the number of principal components for which an elbow in the rate of explained variance in the local neighborhood was found. In all conditions, most of the data points had a local dimensionality equal to 2 (more than 90 % in all conditions), with eventual outliers that had some impact on the mean but not on the median (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>). To understand if these deviations were the result of noise or, in contrast, had a structure in the physical space, we next plotted individual maps of local dimensionality (<xref rid="fig3" ref-type="fig">Fig. 3b</xref>) and their average across simulations of the same condition (<xref rid="fig3" ref-type="fig">Fig. 3c</xref>). We only observed a structure in the No condition, where mean values close to 3 were concentrated at the corners of the reduced map. These results suggest that the population activity in all conditions with attractors is concentrated around a structure with a local dimension of 2.</p>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Figure 3</label>
<caption><title>The population activity in all attractor conditions is locally 2-dimensional, with no boundary or singularities.</title><p><bold>a</bold>, Distribution across conditions of the fraction of the data with local dimensionality of 2 (quartiles). <bold>b</bold>, Distribution of local dimensionality across physical space in representative examples of 1D and 2D conditions. <bold>c</bold>, Average distribution of local dimensionality for all conditions (same color code as in <bold>b</bold>). <bold>d-f</bold>, As <bold>a-c</bold> for but exploring deviations of the local homology H<sub>1</sub> from a value of 1, the value expected away from borders and singularities.</p></caption>
<graphic xlink:href="495956v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Next, to understand if the data had boundary or singularities (ii), we studied the local homology of the underlying space by estimating the first Betti number β<sub>1</sub> in an annulus neighborhood around each data point <sup><xref ref-type="bibr" rid="c31">31</xref></sup> (<xref rid="fig3" ref-type="fig">Fig. 3d</xref>). In a sample of a locally 2-dimensional manifold with neither boundary nor singularities, the data inside the annulus neighborhood is expected to form a ring, with local β<sub>1</sub> = 1, while points in the boundary are characterized by β<sub>1</sub> = 0 and singularities by β<sub>1</sub> &gt;1 (<xref ref-type="fig" rid="figs1">Fig. S1d</xref>). We observed that most of the data points had β<sub>1</sub> = 1, which was the case for more than 90% of data in conditions with attractors and around 70% in the No condition. The No condition had not only the lowest fraction of data with β<sub>1</sub> = 1, but also the lowest deviation in the distribution, pointing to a systematic decrease in β<sub>1</sub>. This could be explained by examining individual maps of local β<sub>1</sub> (<xref rid="fig3" ref-type="fig">Fig. 3e</xref>) and averages across simulations (<xref rid="fig3" ref-type="fig">Fig. 3f</xref>). The conditions with attractors exhibited no structure in eventual deviations from β<sub>1</sub> = 1, but the average for the No condition had a value β<sub>1</sub> = 0 in the pixels close to the perimeter of the reduced map, indicating a non-empty boundary set in the population activity.</p>
<p>Put together, these results suggest that the population activity for simulations with attractors is locally 2-dimensional, without boundary or singularities, forming a closed surface. In contrast, data clouds in the No condition do not meet the first two conditions of the theorem of classification of closed surfaces, and are compatible with a two-dimensional sheet exhibiting a boundary along the edge of the space selected for analysis.</p>
<p>We next studied the orientability (iii) of the population activity space for the conditions with attractors. For each simulation we obtained and compared persistence diagrams in Z<sub>2</sub> and Z<sub>3</sub>. The pooled distribution of such diagrams and the averages across 100 simulations of each type (Methods) were almost identical for conditions 1D, 2D (<xref rid="fig4" ref-type="fig">Figs. 4a,b</xref>) and 1D<sub>L</sub> (<xref ref-type="fig" rid="figs2">Fig. S2</xref>), indicating that the population activity in all cases is an orientable manifold.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Figure 4</label>
<caption><title>For 1D and 2D architectures, the population activity is an orientable manifold with the homology of torus.</title><p><bold>a</bold>, Smoothed density of pooled data (colored areas) and average across simulations (circles) of persistence diagrams with coefficients in Z<sub>2</sub> for H<sub>0</sub> (grey), H<sub>1</sub> (blue) and H<sub>2</sub> (red) corresponding to simulations in the 1D (top) and 2D (bottom) conditions. <bold>b</bold>, As <bold>a</bold> but with coefficients in Z<sub>3</sub>. Similarity with a implies that population activity lies within an orientable surface. <bold>c</bold>, Distribution across simulations of lifetime difference between consecutive generators ordered for each simulation from longest to shortest lifetime for 1D (left) and 2D (right). Maxima coincide with Betti numbers. <bold>d</bold>, Pie plot and table indicating the number of simulations (out of 100 in each condition) classified according to their Betti numbers.</p></caption>
<graphic xlink:href="495956v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Given that for simulations with attractors the three conditions posed by the theorem of classification of closed surfaces were met, we were able to conclude that the topology of the population activity is determined by its Betti numbers. From the average diagrams for all conditions with attractors, Betti numbers could be qualitatively estimated as those of a torus: β<sub>0</sub> = 1, β<sub>1</sub> = 2 and β<sub>2</sub> = 1 (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>). This was the case not only for average persistence diagrams, but also for most of the individual simulations, as shown in the plots of the distribution across simulations of the difference in lifetime of consecutive generators ordered from largest to smallest (<xref rid="fig4" ref-type="fig">Fig. 4c</xref>). When quantifying the Betti numbers for individual simulations using a common cutoff value (Methods), 82 (out of 100) were classified as [1, 2, 1] in the 1D condition and 76 in the 2D condition (<xref rid="fig4" ref-type="fig">Fig. 4d</xref>), with small deviations compatible with a noisy scenario for the rest of the simulations.</p>
<p>In summary, our analyses show that different attractor architectures (torus, ring, stripe) similarly constrain the population activity into a torus embedded in a high dimensional space. This is not surprising for the 2D condition, where the architecture has itself the topology of a torus, but is an unprecedented result in the case of the 1D and 1D<sub>L</sub> conditions, given that these simpler attractors were not tailored to represent two-dimensional neighboring relations.</p>
</sec>
<sec id="s2c">
<title>Features of network architecture in the spatial maps</title>
<p>Our analyses showed that all conditions with attractors had a population activity with the topology of a torus, irrespective of the architecture of recurrent connections. We next asked if similar tools could be used to unveil differences between conditions, following the intuition that the network architecture could perhaps be reflected in the geometry of map similarity relationships across neurons. We computed Betti numbers for the point cloud given by spatial maps of individual neurons, represented by a set of N<sub>EC</sub> = 100 points (the number of neurons) in a 625-dimensional space (the number of pixels in the reduced map) (<xref rid="fig5" ref-type="fig">Fig. 5</xref>). This is equivalent to what was done in the previous section, but with the transpose of the matrix M introduced there.</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Figure 5</label>
<caption><title>Features of the attractor architecture observed in the persistent homology of neural activity.</title><p><bold>a</bold>, From top to bottom, diagrams as in <xref rid="fig4" ref-type="fig">Figure 4a</xref> but for the point cloud of neurons in conditions 1D, 2D and 1D<sub>L</sub>. Each panel shows smoothed density of pooled data (colored areas) and average (circles) persistence diagrams for H<sub>0</sub> (gray), H<sub>1</sub> (blue) and H<sub>2</sub> (red) with coefficients in Z<sub>2</sub>. <bold>b</bold>, As in <xref rid="fig4" ref-type="fig">Figure 4c</xref>, distribution of the difference between consecutive generators ordered for each simulation from longest to shortest lifetime. <bold>c</bold>, Pie plots showing the percentage of simulations in which each combination of Betti numbers was found.</p></caption>
<graphic xlink:href="495956v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>For the 2D condition, the mean diagram could qualitatively be described as having the Betti numbers of a torus [1,2,1], which was also apparent in the difference between consecutive ordered lifetimes (<xref rid="fig5" ref-type="fig">Fig. 5a,b</xref>). However, in individual persistence diagrams only 27 simulations had Betti numbers [1,2,1], while 69 had Betti numbers [1,2,0] where the cavity could not be correctly identified (<xref rid="fig5" ref-type="fig">Fig. 5c</xref>). The reason for this discrepancy, or the failure to find the cavity in individual diagrams, is possibly related to the low number of datapoints used in this analysis (100 vs. 625 in the previous case) taking the signal-to-noise ratio close to the limit of no detection. In contrast, 1D simulations had an average persistence diagram similar to the majority of individual diagrams (86%), characterized by the Betti numbers of a ring [1,1,0], while for 1D<sub>L</sub> simulations the average diagram and 97% of individual diagrams had Betti numbers [1,0,0] compatible with a stripe.</p>
<p>In summary, the analysis on the matrix M showed that all conditions with attractors had a population activity embedded in a torus, while the analysis on its transpose showed qualitative differences across conditions, where in general the homology recapitulated that of the architecture of recurrent connections.</p>
</sec>
<sec id="s2d">
<title>Flexibility of one-dimensional attractors</title>
<p>Given that one-dimensional attractors are not constructed in an <italic>ad hoc</italic> way to guarantee the correct organization of the population activity into a pre-defined configuration, we next asked what kind of geometrical arrangement was found by our self-organizing model to allow covering two-dimensional space with a one-dimensional arrangement of neurons. To visualize the population activity in space, we colored neurons in the 1D ring attractor according to hue, so that connected neurons along the ring were assigned similar colors. We then assigned to each pixel in the virtual space the color that best described the mean population activity associated with it. This allowed us to plot for each simulation a map in which color represented the mean population activity (<xref rid="fig6" ref-type="fig">Fig. 6a</xref>). While all individual colors in these maps had hexagonal periodicity, as expected from a population of aligned grid maps, the geometry of the attractor layout in physical space allowed for a classification into 4 orders (O<sub>0</sub> to O<sub>3</sub>) with different prevalence (<xref rid="fig6" ref-type="fig">Fig. 6b</xref>). A way to understand these configurations is to imagine a cycle along the attractor. The cycle begins and ends in the same color, but since in physical space any given color is constrained to have hexagonal periodicity, the end has to lie either in the same place as it started (O<sub>0</sub>) or in an n-order neighboring field (in our case n = 1 to 3; <xref rid="fig6" ref-type="fig">Fig. 6c</xref>). This conceptualization implies that, although we only found 4 configurations for aligning grid cells with a 1D attractor, the constraint imposed by hexagonal symmetry is compatible with a countably infinite number of them (as many as orders of neighbors in a hexagonal grid), provided attractors are able to stretch enough in physical space. We speculate that the number of neurons in the grid cell layer (N<sub>EC</sub>) could play a critical role in determining to what extent the attractor can stretch and which configurations can be achieved in practice by a given network. Simulations of the 1D<sub>L</sub> condition were classified into categories following the same logic, by assessing the distance between the two extremes of the attractor (colored black and white) in terms of neighboring order in a hexagonal grid (<xref rid="fig6" ref-type="fig">Figs. 6b</xref> and <xref rid="fig6" ref-type="fig">6d</xref>).</p>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Figure 6</label>
<caption><title>Multiple configurations for the alignment of grid maps by one-dimensional attractors.</title><p><bold>a</bold>, Top: Population map for 4 representative examples of 1D simulations with increasing configuration order (indicated) from left to right. Color indicates the region of the ring attractor best describing the mean population activity at each position. Schematics of some of the frontiers, defined by abrupt changes in color (black), and hexagonal tiles maximally coinciding with these frontiers (semi-transparent white) are included for visualization purposes. Bottom: Schematic representation of the order of the solution as the minimum number of colors traversing the perimeter of the hexagonal tile or, equivalently, the minimum number of hexagonal tiles whose perimeter is traversed by one cycle of the attractor. <bold>b</bold>, Table indicating the number of simulations out of 100 in which each configuration order was found. <bold>c</bold>, Schematic representation of the ring attractor extending in space from a starting point to different order neighbors in a hexagonal arrangement. <bold>d</bold>, As <bold>a</bold> but for the 1D<sub>L</sub> condition. Gray scale emphasizes the lack of connections between extremes of the stripe attractor.</p></caption>
<graphic xlink:href="495956v2_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>These results show that the weak constraint imposed by one-dimensional flexible attractors allows for many possible solutions to co-exist as local minima of the self-organization energy landscape.</p>
</sec>
<sec id="s2e">
<title>Visualization of the twisted torus</title>
<p>Dimensionality reduction techniques are a popular way of visualizing high dimensional data, such as the population activity in our simulations. It should be noted, however, that in general they provide no guarantee of preserving the topology of the data cloud in the original high dimensional space. For our data, three-dimensional Isomap projections <sup><xref ref-type="bibr" rid="c32">32</xref></sup> allowed for the visualization of the twisted torus in all conditions with attractors. In many simulations, the three-dimensional reduction of the population activity looked like a tetrahedron (<xref rid="fig7" ref-type="fig">Fig. 7a</xref>). If data were grouped using k-means clustering (k = 4) in the reduced Isomap space, a four-color checkerboard emerged in physical space. The minimal tile containing all four colors was a square in which one pair of opposite sides had simple periodicity while the other had a periodicity with a 180° twist, which is the basic representation for the twisted torus (<xref ref-type="fig" rid="figs1">Fig. S1</xref>). Other times the same reduction technique, with identical parameters, produced directly a torus-like shape, squeezed at two opposite sides (<xref rid="fig7" ref-type="fig">Fig. 7b,c</xref>). While extreme solutions looked like the tetrahedron or the torus, intermediate visualizations were also found which could not be clearly interpreted as one or the other. The fact that the same procedure produced so different visualizations calls for a cautious approach to interpreting the geometry of reduced data when using non-linear methods such as Isomap. This technique does not aim to preserve the global geometry of the original point cloud, but instead the relative distance between data points.</p>
<fig id="fig7" position="float" orientation="portrait" fig-type="figure">
<label>Figure 7</label>
<caption><title>Two different visualizations of the twisted torus obtained with Isomap.</title><p><bold>a</bold>, Top: Representative examples of dimensionality reduction into a structure resembling a tetrahedron for different conditions (indicated). Data points are colored according to the distance to one of the four cluster centers obtained with k-means (each one close to tetrahedron vertices; k = 4). Bottom: Same data and color code but plotted in physical space. The white square indicates the minimal tile containing all colors, with correspondence between edges, indicated by arrows, matching the basic representation of the twisted torus. <bold>b</bold>, Representative examples of dimensionality reduction into a torus structure squeezed at two points, obtained in other simulations using identical Isomap parametrization. Hue (color) and value (from black to bright) indicate angular and radial cylindrical coordinates, respectively. <bold>c</bold>, For the same two examples (indicated), three dimensional renderings. To improve visualization of the torus cavity, color is only preserved for data falling along the corresponding dashed lines in <bold>b</bold>.</p></caption>
<graphic xlink:href="495956v2_fig7.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Our results show that there are multiple ways in which continuous attractors can align grid cells, including simple architectures such as ring or stripe attractors. In topological terms the resulting population activity is equivalent (homeomorphic), despite differences in the topology of the architecture or in projections obtained through dimensionality-reduction techniques.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Our main result is that the alignment of hexagonal axes in a model of grid cells can result from interactions between neurons following a simple one-dimensional architecture, not constructed <italic>ad hoc</italic> for representation of two-dimensional spaces. This possibility has not been assessed before in modeling because a common assumption is that recurrent collateral architecture perfectly defines the geometry of the manifold that the population activity is constrained to by the attractor. We show for the first time that this seemingly reasonable assumption is wrong, providing two counter-examples in which the representational space is a torus but the architecture, either a ring or a stripe, has a different topology and even lower dimensionality. Crucially, if the attractor is not active, grid maps obtained under otherwise identical conditions exhibit markedly lower levels of hexagonal symmetry and do not align, failing to constrain the population activity into a torus. Our results open the way to considering the potential of simple flexible attractors for a wide spectrum of modeling applications, given their capability of enacting on the population activity a negotiated constraint, as opposed to rigid attractors with no such degrees of freedom.</p>
<p>Advantages of flexible attractors are versatility and simplicity in network design. Grid cells, for example, represent multiple geometries with individual characteristics in each case. Two-dimensional maps of familiar environments are highly symmetric and periodic, but this is not the case for maps in other dimensionalities. In one- and three-dimensional spatial tasks grid cells exhibit multiple fields, as in two-dimensional navigation, but with larger and more irregular spacing <sup><xref ref-type="bibr" rid="c16">16</xref>–<xref ref-type="bibr" rid="c19">19</xref></sup>. In other one-dimensional tasks, involving the representation of frequency of a sound or time, they much more often develop single response fields <sup><xref ref-type="bibr" rid="c14">14</xref>, <xref ref-type="bibr" rid="c15">15</xref></sup>. To properly model this collection of scenarios with rigid attractors, one should consider a number of them embedded on the same network architecture, each specialized for a single purpose, and possibly a mechanism to select the attractor best suited for every situation. Alternatively, the same could perhaps be achieved with a single architectonic principle. One-dimensional attractors are simple enough to emerge independently of experience, as exhibited by head direction cells in rats prior to eye-opening <sup><xref ref-type="bibr" rid="c33">33</xref></sup> or internally generated sequences in the hippocampus <sup><xref ref-type="bibr" rid="c34">34</xref></sup>. Future computational explorations should include a wider range of architectures to assess whether even simpler configurations than the ones used here, such as a collection of short fragmented sequences, could align grid cells in a similar way.</p>
<p>Most grid cell models are focused on path integration, or the capacity of spatial maps to persist in the absence of spatial inputs based on self-motion information <sup><xref ref-type="bibr" rid="c6">6</xref>, <xref ref-type="bibr" rid="c7">7</xref>, <xref ref-type="bibr" rid="c28">28</xref></sup>. Experiments in which animals navigate in the dark support this functionality for hippocampal and entorhinal maps, and it has been recently shown that the path integrator can be recalibrated in an almost online fashion <sup><xref ref-type="bibr" rid="c35">35</xref></sup>. However, although from a theoretical perspective grid cells are ideal candidates to implement path integration, the involvement of some or all grid cells in this operation still needs to find direct experimental proof. In contrast, a growing corpus of evidence suggests that grid cells can exhibit behaviors that deviate from pure path integration. This includes local and global distortions of the two-dimensional grid map in response to a variety of experimental manipulations <sup><xref ref-type="bibr" rid="c20">20</xref>, <xref ref-type="bibr" rid="c22">22</xref>–<xref ref-type="bibr" rid="c26">26</xref></sup>, as well as the progressive refinement in symmetry and decrease in spacing observed across days of familiarization to a novel environment <sup><xref ref-type="bibr" rid="c21">21</xref>, <xref ref-type="bibr" rid="c36">36</xref></sup>. In our model, this last result could be understood as an increase in the efficiency with which collateral connections impose their constraint. As feedforward synaptic weights are modified, neurons become better tuned to the constraint and individual deviation from the collective behavior decreases. More generally, understanding how this heterogeneous set of experimental results could emerge from interactions between path integration and mapping is a challenge for future work in which the concept of flexible attractors could prove useful. Path integration is an operation that needs to be computed in the direction of movement, which is at a given instant a one-dimensional space. Many grid cell models can be thought of as employing several overlapping two-dimensional attractors, each specialized in one direction of movement, to achieve path integration in all directions <sup><xref ref-type="bibr" rid="c6">6</xref></sup>, a task that one-dimensional attractors might be naturally suited for without loss of flexibility.</p>
<p>In a recent experiment, mice were trained to run head-fixed at a free pace on a rotating wheel, in complete darkness and with no other sensory or behavioral feedback <sup><xref ref-type="bibr" rid="c29">29</xref></sup>. It could be expected that in such a situation the population activity deprived of inputs is influenced to a greater extent by its internal dynamics, so that this kind of experiment offers a window into the architecture of the attractor. The experimenters observed that the entorhinal population dynamic engaged in cycles, with a period of tens of seconds to minutes. These cycles, naturally occurring here but not in other areas of the brain, point to the possibility of one-dimensional attractor arrangements, modelled by either our 1D or 1D<sub>L</sub> conditions, as a prevailing organizational principle of the entorhinal cortex. Future efforts should focus on whether or not a relationship exists between the organization of grid cells within entorhinal cycles and their relative spatial phases in two-dimensional open field experiments, contrasting the population map with configurations shown in <xref rid="fig6" ref-type="fig">Figure 6</xref>.</p>
<p>Grid cells were originally described in superficial layers of the medial entorhinal cortex, but were later found also in other entorhinal layers and even in an increasing number of other brain areas <sup><xref ref-type="bibr" rid="c37">37</xref>–<xref ref-type="bibr" rid="c39">39</xref></sup>. Our work points to the possibility that organizational principles simpler than previously thought could act in some of these areas to structure grid cell population activity. In addition, given that grid cell properties change substantially during the early life of rodents <sup><xref ref-type="bibr" rid="c40">40</xref>, <xref ref-type="bibr" rid="c41">41</xref></sup>, flexible attractors could also be taken into account as a potential intermediate stage toward the formation of more complex architectures.</p>
<p>Our work shows that attractor networks have capabilities that so far have not been exploited in modeling. Addressing the dimensionality of an attractor network, as is common practice to describe it, becomes challenging from the perspective of our results, given that a single network architecture can organize population activity into manifolds of diverse geometry, and the same geometry can be achieved by architectures of different dimensionality. Generally speaking, operations of cross-dimensional embedding achieved by flexible attractors could shed light on the way we map a world of unknown complexity through our one-dimensional experience.</p>
</sec>
</body>
<back>
<ack>
<title>Acknowledgements</title>
<p>This work was supported by Human Frontiers Science Program grant RGY0072/2018 (E.K.), Argentina Foncyt grant PICT 2019-2596 (E.K.) and EPSRC grant EP/R018472/1 (X.F.).</p>
</ack>
<sec id="s4">
<title>Methods</title>
<p>The model is inspired in a previous work that describes extensively the mechanism and reasons why Hebbian learning sculpts hexagonal maps through self-organization (Kropff &amp; Treves, 2008). We here describe the main ingredients of the model and small modifications aimed to make it simpler and computationally less expensive.</p>
<p>The network has an input layer of N<sub>I</sub> = 225 neurons projecting to a layer of N<sub>EC</sub> = 100 cells. While the model works with arbitrary spatially stable inputs (Kropff &amp; Treves, 2008), for simplicity we use place cell like inputs. Input cells had Gaussian response fields with a standard deviation of 5.4 cm centered at preferred positions uniformly distributed across the 1 m arena.</p>
<p>The total field h received by grid cell i at time t is given by two terms. The first one includes the contributions of the feedforward connections from input cells. The second one includes recurrent contributions</p>
<disp-formula>
<alternatives><graphic xlink:href="495956v2_ueqn1.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<p>where <inline-formula><alternatives><inline-graphic xlink:href="495956v2_inline1.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> are the firing rate of input cell j and grid cell k, respectively. The feedforward synaptic weight matrix W<sup>I</sup> is equipped with Hebbian plasticity, while for the purposes of this paper the recurrent synaptic weigh W<sup>EC</sup> is fixed (see next section).</p>
<p>The field of the cell is inserted into a set of two equations with two internal variables, h<sup>act</sup> and h<sup>inact</sup> and a parameter β aimed to mimic adaptation or neural fatigue within the cell,</p>
<disp-formula>
<alternatives><graphic xlink:href="495956v2_ueqn2.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<p>Once the value of h<sup>act</sup> is obtained for all grid cells, a threshold linear transfer function with gain G is applied. A threshold T mimicking inhibition is established so that only the fraction A of cells with highest h<sup>act</sup> values has non-zero firing rate, while a normalization, acting as an effective gain, ensures that Hebbian plasticity does not get stuck at the beginning of the learning process due to low post-synaptic activity. The activity of each cell is obtained as</p>
<disp-formula>
<alternatives><graphic xlink:href="495956v2_ueqn3.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<p>where the operation |…|<sub>&gt;0</sub> represents a rectifying linear transformation and &lt;…&gt; denotes averaging across all cells. This normalization is effectively equivalent to controlling the sparseness of the network (Kropff &amp; Treves, 2008) but is much more efficient computationally.</p>
<p>The update of the feedforward synaptic weight <inline-formula><alternatives><inline-graphic xlink:href="495956v2_inline2.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is given by de Hebbian rule</p>
<disp-formula>
<alternatives><graphic xlink:href="495956v2_ueqn4.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<p>where ε is a learning parameter and the computationally efficient temporal average operation</p>
<disp-formula>
<alternatives><graphic xlink:href="495956v2_ueqn5.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<p>is used. Negative values of W<sup>I</sup> are set to zero and the vector of all presynaptic weights entering a given postsynaptic grid cell is divided by its Euclidean norm to ensure that it remains inside a hypersphere.</p>
<p>In our hands, the condition 2D was the one with the greatest sensibility to model parameters. For this reason, they were fine-tuned using the 2D recurrent architecture, aiming to reduce as much as possible the number of cells and thus optimize the computational cost. This was achieved by reducing the grid cell layer to 100 cells, a number below which self-organization of the population activity into a torus ceased to be consistent. We noticed that including a greater number of neurons in the input layer had a substantial impact on the speed and stability of the learning process, which led us to include 225 input cells. Once the 2D architecture simulations were optimized, the other conditions were run using the same values for all parameters and initial conditions, except for the parameters describing the recurrent collateral architecture itself. The following are some important model parameters.</p>
<p>Parameters ensuring that the mean contributions of feed forward and recurrent inputs to a neuron are of the same order of magnitude:</p>
<list list-type="bullet">
<list-item><p>Gain A for otherwise normalized recurrent inputs: 2.</p></list-item>
<list-item><p>Gain G for feedforward inputs: 0.1.</p></list-item>
<list-item><p>Peak value for inputs r<sup>I</sup>: 20.</p></list-item>
<list-item><p>Grid cells allowed to have non-zero activity at any given time: 60 %.</p></list-item>
</list>
<p>Other parameters:</p>
<list list-type="bullet">
<list-item><p>Adaptation parameter β: 0.04.</p></list-item>
<list-item><p>Average parameter δ: 0.5</p></list-item>
<list-item><p>Side of the square arena: 1 m.</p></list-item>
<list-item><p>Input field standard deviation: 5.4 cm.</p></list-item>
<list-item><p>Distance traveled in one simulation step: 0.6 cm.</p></list-item>
<list-item><p>Variation in direction at each step: normal distribution with 0<underline>°</underline> mean and 17<underline>°</underline> s.d.</p></list-item>
<list-item><p>Overall number of steps per simulation 2 10<sup>7</sup>.</p></list-item>
</list>
<sec id="s4a">
<title>Recurrent collateral architectures</title>
<sec id="s4a1">
<title>Toroidal architecture</title>
<p>For the purpose of designing the 2D architecture of recurrent collaterals, each neuron in a given simulation was assigned a position, uniformly covering a 2D arena. The strength of connectivity between a given pair of cells k and l was set to depend on their relative position <bold>x</bold> = [x<sub>k</sub> - x<sub>l</sub>, y<sub>k</sub> - y<sub>l</sub>], through a function f(<bold>x</bold>) that was defined as the sum of three cosine functions in directions <bold>k</bold><sub>i</sub>, 120° and 240° from each other, i.e. an ideal grid map <sup><xref ref-type="bibr" rid="c4">4</xref></sup>,</p>
<disp-formula>
<alternatives><graphic xlink:href="495956v2_ueqn6.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<p>The spacing of this imaginary grid map (inverse to the modulus of <bold>k</bold>) could be varied along a wide range of values without noticeable consequences on the simulations. For simulations included in this work it was set to 60 cm.</p>
</sec>
<sec id="s4a2">
<title>Ring architecture</title>
<p>For the 1D condition, neurons were uniformly distributed along an imaginary ring, spaced by 3.6°. The connection strength between any pair of neurons was defined as proportional to a 7.2° standard deviation Gaussian function of the minimum angle between them.</p>
</sec>
<sec id="s4a3">
<title>Stripe architecture</title>
<p>For the 1D<sub>L</sub> condition, neurons were uniformly distributed along an imaginary stripe. The connection strength between any pair of neurons was defined as proportional to Gaussian function of the distance between them, with standard deviation equal to twice the distance between consecutive neurons.</p>
</sec>
</sec>
<sec id="s4b">
<title>Rate Maps</title>
<p>Mean rate for each pixel in space was obtained from the instantaneous rate of each neuron observed during visits to the pixel. To optimize memory usage, at any given time the pixel currently traversed by the rat was identified and its mean rate for each neuron j, m<sub>j</sub> updated as</p>
<disp-formula>
<alternatives><graphic xlink:href="495956v2_ueqn7.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<p>where r<sub>j</sub> is the instantaneous firing rate and τ is 0.03. The rest of the pixels of the map were not modified at this step.</p>
<p>Autocorrelograms were obtained by correlating two copies of each map displaced relatively to one another in all directions and magnitudes. To reduce the absolute value close to the borders, where correlations can reach extreme values with poor statistical power, a 1 m circular hamming window was applied to each autocorrelogram. Mean population autocorrelograms were obtained by averaging the autocorrelogram across all neurons in a given simulation.</p>
</sec>
<sec id="s4c">
<title>Quantification of grid properties</title>
<sec id="s4c1">
<title>Spacing</title>
<p>Autocorrelograms were interpolated to a Cartesian grid in polar coordinates, so that correlation could be analyzed for all angles at any fixed radius. Spacing was defined as the radius with maximal 6-period Fourier component modulation of the correlation across angles.</p>
</sec>
<sec id="s4c2">
<title>Gridness</title>
<p>For the radius that defined spacing, gridness was defined as the mean autocorrelation at the six 60-degree spaced maxima minus that at the six 60-degree spaced minima.</p>
</sec>
<sec id="s4c3">
<title>Angular spread</title>
<p>For each cell in a given simulation, the six maxima around the center of the autocorrelogram were identified. A k-means clustering algorithm was applied to the pool of all maxima in the simulation (MATLAB <italic>kmeans</italic>() function, with k = 6, otherwise default parameters and 10 repetitions to avoid local minima). The spread was defined as the mean absolute angle difference between pairs of points belonging to the same cluster.</p>
</sec>
</sec>
<sec id="s4d">
<title>Metric Structure of the Population Activity</title>
<p>To study the topology of the population activity (<xref rid="fig4" ref-type="fig">Fig. 4</xref>), the central 60 cm of each map in a simulation was considered. The population activity thus determines point clouds of 625 points — the size of the arena, i.e., 25x25 — in <sup><italic>EC</italic></sup>, where N <sub>EC</sub> = 100 is the number of simulated grid cells. For the purpose of capturing the intrinsic geometry of the underlying space determined by these point clouds, and to avoid the effects of the ‘curse of dimensionality’, we endowed each point cloud with an estimator of the <italic>geodesic distance</italic>. This estimator, known as the <italic>kNN-distance</italic>, is defined as the length of the shortest path along the <italic>k-nearest neighbors graph</italic>, a graph with an edge between every data point and each of its k-nearest neighbors with respect to the ambient Euclidean distance. We set the value k = 10 for all our analyses but similar results could be obtained for a range of similar values of k.</p>
<p>To recover network architecture features (<xref rid="fig5" ref-type="fig">Fig. 5</xref>), we studied the simultaneous spatial activity of grid cells. The associated point cloud is a set of N<sub>EC</sub> = 100 vectors in <italic>R</italic><sup><italic>625</italic></sup> representing the average activity of every grid cell on each pixel of the arena. This point cloud, when endowed with the metric structure given by the Pearson correlation distance, shares geometric features with the combinatorial architecture of the underlying neural network.</p>
</sec>
<sec id="s4e">
<title>Persistent Homology</title>
<p>We aimed to robustly recover geometric information, such as the number of connected components, cycles and holes of different dimensions, from the simulated data (<xref ref-type="fig" rid="figs1">Fig. S1a</xref>). To do so we computed the <italic>persistent homology</italic> <sup><xref ref-type="bibr" rid="c42">42</xref>–<xref ref-type="bibr" rid="c45">45</xref></sup> of each point cloud endowed with its respective metric structure. As output we obtained <italic>persistence diagrams</italic>, graphical representations of the evolution of the generators of the <italic>homology groups</italic> associated to each point cloud, for different parameter scales (<xref ref-type="fig" rid="figs1">Fig. S1c</xref>). Each generator is described as a point whose first coordinate represents its <italic>birth</italic> and the second coordinate, its <italic>lifetime</italic>. Generators with long lifetime indicate topological features, while the ones with short lifetime are linked to noise. Note that persistent homology at degree 0 encodes the evolution of connected components. It is always the case that a single generator of H<sub>0</sub> has an infinite lifetime, as a consequence of the compactness of the point cloud. Its lifetime was set to an arbitrary value larger than generators associated to noise but with a similar magnitude, to facilitate visualization. To summarize the information of the persistent homology over <italic>all</italic> simulations, we computed both the average of the persistence diagrams as its <italic>Frechet mean</italic> <sup><xref ref-type="bibr" rid="c46">46</xref>, <xref ref-type="bibr" rid="c47">47</xref></sup>, as well as the density associated with the distribution of points in the diagrams (<xref rid="fig4" ref-type="fig">Fig. 4</xref>).</p>
<p>All the computations of persistence diagrams, related to both the population activity and the cross-cell similarities, were performed with the Ripser package <sup><xref ref-type="bibr" rid="c48">48</xref></sup>, while the Frechet mean (or barycenter of persistence diagrams) was obtained using the corresponding library in GUDHI <sup><xref ref-type="bibr" rid="c49">49</xref></sup>.</p>
</sec>
<sec id="s4f">
<title>Automated quantification of individual persistence diagrams</title>
<p>Betti numbers are typically assessed from persistence diagrams in a qualitative way. Profiting from the fact that we had 100 similar persistence diagrams for every condition, we designed an automated procedure to determine cutoff values for each homology group and condition. A histogram of lifetime with 100 bins between 0 and the maximum value was obtained for the pool of all cycles in all simulations belonging to the condition. The histogram was smoothed with a 3-bin standard deviation gaussian window. Locations of minima in this smoothed histogram were identified and the one representing the greatest fall from the previous maximum was set as the cutoff lifetime value. Persistence diagrams for individual simulations were analyzed by counting how many cycles had a lifetime greater than the corresponding cutoff value.</p>
</sec>
<sec id="s4g">
<title>Local Principal Component Analysis</title>
<p>Local <italic>Principal Component Analysis (PCA)</italic> is a well-established procedure to detect the local dimension of point clouds <sup><xref ref-type="bibr" rid="c50">50</xref></sup>. It is based on the popular method PCA of linear dimensionality reduction, applied to local k-nearest neighborhoods of each data point (<xref ref-type="fig" rid="figs1">Fig. S1b</xref>). We employed local neighborhoods of size k = 70 for all simulations of population activity with attractors and k = 20 for the ones in the No condition. These values were determined as the center of a range of k values with stable outcomes.</p>
<p>For every local neighborhood, we computed the evolution of the <italic>rate of explained variance</italic> after adding each principal component (in decreasing eigenvalue-order). An estimator of the local dimension at a point is the number of dimensions at which there is a drop off (or ‘elbow’) in the curve of explained variances (Fig S1b). For elbow detection we used the Python package kneed <sup><xref ref-type="bibr" rid="c51">51</xref></sup>.</p>
</sec>
<sec id="s4h">
<title>Local Persistent Homology</title>
<p>Persistent homology can also be used to capture the topological structure <italic>around</italic> each data point. Even though homology does not distinguish among local neighborhoods of different dimensions (and hence, it is not useful to identify local dimensions), it is an appropriate method to detect anomalies such as points in the <italic>boundary</italic> or <italic>singularities</italic>. The main idea is to identify the shape of the region <italic>surrounding</italic> each point, by studying the persistent homology of an annular neighborhood <sup><xref ref-type="bibr" rid="c31">31</xref></sup>.</p>
<p>We defined the <italic>annular local neighborhood</italic> of a point x as the set of points in the point cloud (ordered according to the Euclidean distance to x) between the <italic>1</italic><sup>th</sup> and the <italic>2</italic><sup>th</sup> nearest neighbors, with <italic><sub>1</sub></italic> = 50, <italic><sub>2</sub></italic> = 100 for the simulations with attractor, and <sub>1</sub> = 10, <sub>2</sub> = 30 for the ones in the No condition (<xref ref-type="fig" rid="figs1">Fig. S1d</xref>). We used the Ripser package <sup><xref ref-type="bibr" rid="c48">48</xref></sup> for the computation of local persistent homology.</p>
</sec>
<sec id="s4i">
<title>Orientability</title>
<p>Orientability is the geometric property that ensures a consistent local coordinate system in a manifold. In the special case of <italic>closed</italic> manifolds (compact connected manifolds without boundary) this homeomorphism invariant can be detected by its homology.</p>
<p>We computed the persistence diagrams of the point clouds obtained from 100 simulations of the population activity of grid cells in all conditions, using coefficients in both <italic><sub>2</sub></italic> and <italic><sub>3</sub></italic> (<xref ref-type="fig" rid="figs1">Fig. S1e</xref>). A summary of the persistent homology over all the simulations (for every coefficient field) was presented via the Frechet mean and the density of the distribution of the generators in the persistent diagrams.</p>
<p>Note that for <italic>any</italic> closed manifold M of dimension 2, <italic><sub>2</sub></italic>(,<italic><sub>2</sub></italic>) ≠ 0. This is consistent with salient generator in the (Frechet mean) persistence diagram for <italic><sub>2</sub></italic> that we can detect in all conditions with attractors (<xref rid="fig4" ref-type="fig">Fig. 4</xref>). We also observe that the Frechet mean of persistence diagrams remains unaltered after the change of coefficients from <italic><sub>2</sub></italic> to <italic><sub>3</sub></italic> . This proves the orientability of the underlying surfaces in all cases. If the sample belonged to a non-orientable surface, the salient generator of the persistent diagram representing <italic><sub>2</sub></italic>(,<italic><sub>2</sub></italic>) should disappear when compared with <italic><sub>2</sub></italic>(,<italic><sub>3</sub></italic>) (<xref ref-type="fig" rid="figs1">Fig. S1e</xref>). This should also be accompanied by the disappearance of a salient generator of <italic><sub>1</sub></italic>(,<italic><sub>2</sub></italic>) when contrasted with <italic><sub>1</sub></italic>(,<italic><sub>3</sub></italic>). This phenomenon of simultaneous changes in homology is explained by the independence of the Euler characteristic on the choice of field of coefficients.</p>
</sec>
<sec id="s4j">
<title>Dimensionality Reduction</title>
<p>Among the most popular techniques in manifold learning are the procedures for <italic>dimensionality reduction</italic>, that aim to project high-dimensional point clouds into a low- dimensional space while preserving some properties of the original data.</p>
<p><italic>Isomap</italic> is a celebrated (non-linear) dimensionality reduction method that assumes the data is a sample of a low dimensional manifold embedded in a high dimensional Euclidean space. It reduces the dimensionality by mapping the original data into a lower dimensional Euclidean space while preserving geodesic distances on the manifold subjacent in the data. Since the intrinsic distance in the underlying manifold is unknown, it estimates the geodesic distance by the kNN graph distance, where the parameter k represents the number of nearest neighbors used in the construction of the graph.</p>
<p>We performed Isomap projections of the population activity in all conditions 2D, 1D, 1D<sub>L</sub> and No condition, with a parameter value of k = 10 (although comparable results are obtained for a range of similar values). We employed the method Isomap from the Python library sklearn.manifold.</p>
<p>We remark that, even though dimensionality reduction procedures may serve as a useful tool for data visualization and feature extraction as part of a machine learning pipeline, they do not provide guarantee a priori to preserve the topology of the underlying manifold, so they do not constitute in general a proof of structure of the original data neither an accurate preprocessing method for a subsequent rigorous geometric analysis.</p>
</sec>
</sec>
<app-group>
<app id="app5">
<label>APPENDIX:</label>
<title>Topological data analysis for manifold reconstruction</title>
<p>Applied algebraic topology provides a number of methods for the computation of relevant mathematical descriptors from data, that allow to completely determine the underlying geometric structure. In this appendix we present a summary of the main tools in Topological Data Analysis aimed to recognize manifolds from data in high dimensional Euclidean spaces.</p>
<sec id="s6">
<label>I.</label>
<title>Manifolds</title>
<p>The guiding principle in most of the modeling methods in data analysis is the <italic>manifold hypothesis</italic>, that is, the assumption that the data are concentrated near a single unknown manifold of <italic>small</italic> intrinsic dimension (or with intrinsic dimension significantly lower than the ambient dimension of the data).</p>
<p>Manifolds of dimension <italic>d</italic> are geometric spaces characterized by the following local property: there is a neighborhood around every point that resembles a <italic>d</italic>-dimensional Euclidean disk. Some examples of 2-dimensional manifolds are the plane, the cylinder, the sphere and the torus. More complex examples are the Mobius band, the projective plane and the Klein bottle (<xref ref-type="fig" rid="figs1">Fig. S1a</xref>). Surfaces can be combined surfaces with <italic>connected sum construction</italic>, an operation that joins two surfaces (after cutting out holes where the surfaces are glued) to produce a new connected surface.</p>
<p>A standard topological equivalence relation between manifolds is the <italic>homeomorphism type</italic>, under which there is a continuous one-to-one correspondence between their points (with continuous inverse). It can be proven that there is no pair of homeomorphic manifolds within the first two columns of Figure S1a. In contrast, the torus and the twisted torus are homeomorphic.</p>
<p>The identification of manifolds by means of a small set of invariants is a major problem in algebraic topology that gave rise to one of the most outstanding questions in math: the Poincare conjecture. Indeed, for dimension d &gt; 4 the problem of homeomorphism of manifolds is undecidable algorithmically<sup><xref ref-type="bibr" rid="c52">52</xref></sup>. However, for dimension <italic>d</italic> = 2 there is a complete classification in terms of computable invariants. The main relevant invariant is the Euler characteristic, a number that summarizes the geometric information about the holes in different dimensions of the space (see III. Homology, persistent homology and Euler characteristic).</p>
<sec id="s6a">
<title>Theorem (Classification of closed surfaces)</title>
<p><italic>Let M be a compact manifold of dimension 2 without boundary. Let χ be the Euler characteristic of M. There are two cases:</italic></p>
<list list-type="simple">
<list-item><label>i)</label><p><italic>If M is orientable, then it is homeomorphic to a connected sum of 1-χ/2 torii.</italic></p></list-item>
<list-item><label>ii)</label><p><italic>If M is non-orientable, then it is homeomorphic to a connected sum of 2-χ projective planes.</italic></p></list-item>
</list>
<p>This result provides a method to univocally determine the homeomorphism type of the geometric structure subjacent in data, provided it is an instance of a closed surface. Indeed, it is enough to compute (or infer) the following finite list of invariant properties:</p>
<list list-type="simple">
<list-item><label>-</label><p>the intrinsic dimension (and prove that it is equal to 2);</p></list-item>
<list-item><label>-</label><p>the Euler characteristic (or equivalently, the Betti numbers);</p></list-item>
<list-item><label>-</label><p>orientability or non-orientability;</p></list-item>
<list-item><label>-</label><p>the (non)existence of singularities and boundary.</p></list-item>
</list>
<p>In the next sections, we expose the more established topological methods for the inference of those invariants from a given finite point cloud.</p>
</sec>
</sec>
<sec id="s7">
<label>II.</label>
<title>Intrinsic dimension</title>
<p>Manifolds are characterized by a regular local structure homeomorphic to disks of a fixed dimension. Formally, a topological space is a manifold M of <italic>dimension d</italic> if for each point x in M the <italic>local neighborhood B</italic>(<italic>x,r</italic>) ⋂ <italic>M</italic>— the intersection with M of an ambient ball with center x and radius r — is homeomorphic to a planar disk in <italic>R<sup>d</sup></italic> for a radius r sufficiently small. In essence, a manifold is a geometric space that can be locally generated <italic>almost linearly</italic> with exactly <italic>d</italic> independent directions (resembling a <italic>d</italic>-dimensional vector space) (Figure S1b).</p>
<p>Given a finite <italic>sample X<sub>n</sub></italic>⊂<italic>R<sup>D</sup></italic> of n points <italic>near</italic> a(n unknown) manifold M, the intrinsic dimension of the point cloud can be recovered via a combinatorial method called <italic>local PCA</italic><sup><xref ref-type="bibr" rid="c50">50</xref></sup>. The method is based on the local reconstruction of the planar discs that best fit the data points, resembling the local geometry of the underlying manifold. The local neighborhoods of the points x in <italic>X<sub>n</sub></italic> are estimated as the set of its k nearest neighbors <italic>kNN</italic> (<italic>x</italic>) = {<italic>x</italic><sub>1</sub>,<italic>x</italic><sub>2</sub>,.. ., <italic>x<sub>k</sub></italic>} (for a relatively small value of the parameter k). The main goal of local PCA is to find the directions of higher variance and project the data locally onto the generated affine subspace in order to minimize the average squared error between the original local neighborhood and its dimension-reduced approximation.</p>
<p>The standard procedure is described below. The covariance matrix C associated to the points in kNN(x) is defined as <inline-formula><alternatives><inline-graphic xlink:href="495956v2_inline3.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> where <inline-formula><alternatives><inline-graphic xlink:href="495956v2_inline4.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> The matrix C is diagonalizable, with eigenvalues <inline-formula><alternatives><inline-graphic xlink:href="495956v2_inline5.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> and associated orthogonal eigenvectors <italic>v</italic><sub>1</sub>, <italic>v</italic><sub>2</sub>,…, <italic>v<sub>k</sub></italic> Given <italic>d</italic>&gt; 0, the set subspace generated by the set of eigenvectors <italic>v</italic><sub>1</sub>, <italic>v</italic><sub>2</sub>,…, <italic>v<sub>d</sub></italic> can be seen as an optimal rank <italic>d</italic> linear approximation of the local data. The vector <italic>v<sub>i</sub></italic> is called the i-th <italic>principal component</italic> and <inline-formula><alternatives><inline-graphic xlink:href="495956v2_inline6.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is the <italic>cumulative recovered variance</italic> by the projection of <italic>kNN</italic>(<italic>x</italic>) onto the affine space spanned by the first i principal components (analogously, <inline-formula><alternatives><inline-graphic xlink:href="495956v2_inline7.gif" mimetype="image" mime-subtype="gif"/></alternatives></inline-formula> is the <italic>difference in consecutive variance</italic>). In the ideal situation, when the manifold <bold>is</bold> a d-dimensional hyperplane and the sample <italic>X<sub>n</sub></italic> does not present noise, the spectral decomposition of <italic>C<sub>x</sub></italic> is analogous for every <italic>x</italic> ∊ <italic>X<sub>n</sub></italic>: it has d positive eigenvalues and k-d eigenvalues equal to zero, in consistency with the local (and global) dimension of M. In that case, the function of cumulative recovered variances becomes constant after the d-th component (equivalently, the function of difference consecutive variances becomes zero). In the general case of a noisy sample of a manifold with non-null local curvature, we may observe a ‘knee’ in the curve of cumulative recovered variances — equivalently, an ‘elbow’ in the curve of difference recovered variances — at the value of the intrinsic dimension of the underlying data (<xref ref-type="fig" rid="figs1">Fig. S1b</xref>).</p>
<p>We associate to every point of the sample the dimension of the best hyperplane that fits the local data (as an estimator of the local dimension). If the global data is a sample of a manifold, then the estimation of the local dimension around each point should be equal to its global intrinsic dimension almost everywhere.</p>
</sec>
<sec id="s8">
<label>III.</label>
<title>Homology, Persistent Homology and Euler characteristic</title>
<p>One of the best-known computable homeomorphism invariants in algebraic topology is <italic>homology</italic>. This invariant assigns to every topological space M (and a ring of coefficients R) a sequence <italic>H<sub>i</sub></italic>(<italic>M, R</italic>) of groups that capture geometric signatures at dimension i. Indeed, the rank of the group <italic>H<sub>i</sub></italic>(<italic>M, R</italic>) defines the <italic>i-th Betti numbe</italic>r <italic>β<sub>i</sub></italic> of M and it quantifies the number of (independent) i-dimensional <italic>holes</italic> existing in M. For instance, <italic>β</italic><sub>O</sub> represents the number of connected components, <italic>β</italic><sub>1</sub> the number of 1-dimensional cycles, <italic>β</italic><sub>2</sub> the number of voids and so on (<xref ref-type="fig" rid="figs1">Fig. S1a</xref>). The Euler characteristic <italic>χ<sub>M</sub></italic> of M is the alternate sum of its Betti numbers</p>
<disp-formula>
<alternatives><graphic xlink:href="495956v2_ueqn8.gif" mimetype="image" mime-subtype="gif"/></alternatives>
</disp-formula>
<p>Notice that manifolds of dimension d do not present holes of dimension greater that d (i.e, <italic>H<sub>i</sub></italic>(<italic>M, k</italic>) = 0 for all <italic>i</italic> &gt; <italic>d</italic>). In particular, the sum above is finite.</p>
<p>There exist efficient algorithms — based on normal matrix decompositions — to compute homology from combinatorial descriptions of manifolds. Among the most used discrete representations of manifolds are the <italic>simplicial complexes</italic>, structures composed by simplices of different dimension (such as points, edges, triangles, etc) that encode all the relevant topological information of a space (for instance, a sphere can be codified as the boundary of a tetrahedron). However, when the manifold is only described through a finite sample of its points, the standard algorithm to compute homology is unable to draw any relevant data about the topology of the underlying structure, since it literally interprets the input as a finite discrete set.</p>
<p><italic>Persistent homology</italic> overcomes this limitation by looking at the sample at different scales of spatial resolution. More concretely, this method quantifies the evolution of homology groups of the point cloud when replacing each point by a ball of common increasing radius. We recall briefly the main techniques in persistent homology employed in this article. Given a point cloud <italic>X<sub>n</sub></italic> embedded in a Euclidean space and a scale parameter ε, the Vietoris-Rips complex <italic>VR</italic><sub>ε</sub> is a simplicial complex with a simplex of dimension of <italic>m</italic> for every subset of data points {<italic>x</italic><sub>0</sub>,<italic>x</italic><sub>1</sub>,…, <italic>x<sub>m</sub></italic>} at pairwise distances less than ε. Geometrically, <italic>VR</italic><sub>ε</sub> is built as follows. Construct a ball of radius ε/2 with center on each data point. Then, put an edge joining the center of every pair of intersecting balls. Finally, every time there is a subset of m+1 points pairwise connected with edges, then fill with the convex hull of the points in <italic>R</italic><sup>2<italic>m</italic>+1</sup>(these are the <italic>m</italic>-simplices). Notice that if ε &lt; ε’, then <italic>VR</italic><sub>ε</sub> ⊆ <italic>VR</italic><sub>ε’</sub>. So {<italic>VR<sub>ε</sub></italic>}<italic><sub>ε</sub></italic><sub>≥0</sub> represents a family of combinatorial spaces whose homology groups capture the evolution of the topology of the point cloud for different resolution scales {<italic>ε</italic> ≥ 0} The <italic>persistent homology</italic> of <italic>X<sub>n</sub></italic> at degree <italic>i</italic> is the family of homology groups {<italic>H<sub>i</sub></italic>(<italic>VR</italic><sub>ε</sub>)}<italic><sub>ε</sub></italic><sub>≥0,</sub> along with the induced maps <italic>H<sub>i</sub></italic>(<italic>VR<sub>ε</sub></italic>) → <italic>H<sub>i</sub></italic>(<italic>VR<sub>ε</sub></italic>) every time <italic>ε</italic> &lt; ε’. All this information can be summarized as the list of parameter scales at which every generator in homology appears (<italic>birth</italic>) and disappears (<italic>death</italic>). This suggests a graphical representation of persistent homology as a <italic>barcod</italic>e: a collection of horizontal line segments in a plane whose horizontal axis corresponds to the parameter and whose vertical axis represents an (arbitrary) ordering of homology generators (see Figure 8 (b)). Equivalently, the persistent homology of a point cloud can be described as a diagram called <italic>persistence diagram</italic> which represents every generator as a two-coordinated point whose first coordinate means its birth and the second coordinate, its <italic>lifetim</italic>e (death - birth) (see Figure 8 (c)). Generators with long lifetime represent actual generators in the homology of the underlying space, whereas those with short lifetime are related to noise.</p>
</sec>
<sec id="s9">
<label>IV.</label>
<title>Orientability</title>
<p>Orientability of manifolds characterizes the property of synchronizing local oriented coverings into a global description. In particular, it is a homeomorphism invariant that captures geometric properties of different nature than homology. For instance, the cylinder and the Mobius band have both the same homology, but the former is orientable while the latter is non-orientable. Nevertheless, in the case of closed manifolds — that is, compact manifolds without boundary — homology with coefficients in different finite fields can be used as a tool to characterize orientability. If brief, a closed d-manifold M is orientable if (and only if) <italic>H<sub>d</sub></italic>(<italic>M, Z</italic><sub>3</sub>) is non-null. Otherwise, <italic>H<sub>d</sub></italic>(<italic>M, Z</italic><sub>3</sub>) = 0 and M is non-orientable (this is a consequence of the Poincare duality<sup><xref ref-type="bibr" rid="c30">30</xref></sup>). Notice that <italic>H<sub>d</sub></italic>(<italic>M, Z</italic><sub>2</sub>) is always non-null for any closed d-manifolds.</p>
<p>When working with a finite sample of a closed manifold, orientability can be deduced analogously from the computation of the persistent homology of the data points with coefficients in <italic>Z</italic><sub>3</sub>. In particular, in the case of non-orientable closed <italic>surfaces</italic>, one should observe that the salient generator of the persistent diagram representing <italic>H<sub>2</sub></italic>(<italic>M, Z</italic><sub>2</sub>) disappears when compared with the one of <italic>H<sub>2</sub></italic>(<italic>M, Z</italic><sub>3</sub>), while diagrams associated to both <italic>H<sub>2</sub></italic>(<italic>M, Z</italic><sub>3</sub>) and <italic>H<sub>2</sub></italic>(<italic>M, Z</italic><sub>2</sub>) should remain unaltered when the samples correspond to an orientable surface (<xref ref-type="fig" rid="figs1">Fig. S1e</xref>).</p>
</sec>
<sec id="s10">
<label>V.</label>
<title>Local homology, singularities and boundary</title>
<p>To test the manifold assumption, one may measure how much a given topological space fails to be locally Euclidean, even in the noisy case<sup><xref ref-type="bibr" rid="c31">31</xref></sup>. Methods based on <italic>local homology</italic> successfully detect singular or boundary regions, in which the local neighborhood is not homeomorphic to a disk. The key construction is the set of local homology groups <italic>H</italic><sub>*</sub>(<italic>M</italic>, <italic>M</italic> \{<italic>x</italic>}) for all x in the topological space M, which in fact only depends on the local topology of M around x and are isomorphic to <italic>H</italic><sub>*</sub>(<italic>B</italic>(<italic>x</italic>, <italic>r</italic>) ⋂ <italic>M</italic>, <italic>B</italic>(<italic>x</italic>, <italic>r</italic>) ⋂ <italic>M</italic> \ {<italic>x</italic>}) for an open neighborhood U of x.</p>
<p>In practice, local homology at x can be studied as the homology of <italic>local annular neighborhoods Ax = (B(x, r</italic><sub>2</sub>) \ <italic>B</italic>(<italic>x</italic>, <italic>r</italic><sub>1</sub>) ⋂ for radii 0 &lt; <italic>r</italic><sub>1</sub> &lt; <italic>r</italic><sub>2</sub> and, hence, it represents a useful tool to identify boundary or singularities. Indeed, in manifolds of dimension d, annular neighborhoods are topologically equivalent to (d-1)-dimensional spheres <italic>S<sup>d</sup></italic><sup>-1</sup>, whereas in the presence of anomalies like boundary and singularities, its topology resembles semispheres or several spheres glued together respectively. At this point, homology is an excellent classifier among these situations, given that <italic>dim H<sub>i</sub></italic>(<italic>A<sub>x</sub></italic>) = 1 for I = 0, d and 0 otherwise when <italic>A</italic><sub>x ≃</sub> <italic>S<sup>d</sup></italic>, while <italic>H<sub>i</sub></italic>(<italic>A<sub>x</sub></italic>) =1 only for I = 0 and 0 otherwise for points x in the boundary. Finally, any other situation holds in the case of topological singularities.</p>
<p>In an inference scenario, the underlying space M is only given via a finite sample <italic>X<sub>n</sub></italic> of (possibly noisy) points, and local homology can be robustly estimated using <italic>persistent</italic> homology. The strategy is as follows: for each point x in <italic>X<sub>n</sub></italic> define an estimator of its annulus neighborhood <italic>A<sub>x</sub></italic> as the set of points in the sample between the <italic>k</italic><sub>1</sub>-th and the <italic>k</italic><sub>1</sub>-th nearest neighbor of x, for integers 0 &lt; <italic>k</italic><sub>1</sub> &lt; <italic>k</italic><sub>2</sub>. Then, compute the persistent homology of <italic>A<sub>x</sub></italic> and identify the number of salient generators for each degree. Finally, classify the status of each point x depending on the persistent Betti numbers of <italic>A<sub>x</sub></italic>.</p>
</sec>
<sec><p><fig id="figs1" position="float" orientation="portrait" fig-type="figure">
<label>Figure S1</label>
<caption><title>Methods in topological data analysis and examples.</title><p><bold>a</bold>, Basic representation of different geometries (indicated) and their corresponding Betti numbers. <bold>b</bold>, Local dimensionality of a sphere (i) and a local neighborhood (ii), computed by obtaining its local principal components (iii) and finding and elbow on the rate of explained variance (iv). <bold>c</bold>, Left, top: Birth and death of a generator in H<sub>1</sub> (a cycle) for the same collection of datapoints and increasing radius. Left, bottom: barcode diagram indicating the birth and death of all generators. Right: Lifetime diagram indicating the birth and length of bars in <bold>b</bold>, distinctively indicating relevant generators and noise. <bold>d</bold>, Local homology in different locations of a locally two-dimensional object. Deviations from the Betti number B<sub>1</sub> = 1 can indicate boundaries (B<sub>1</sub> = 0) or singularities (B<sub>1</sub> &gt; 1) as exemplified. <bold>e</bold>, Orientable (top, torus) and non-orientable (bottom, Klein bottle) objects with Betti numbers [1, 2, 1] in Z<sub>2</sub> but different Betti numbers in Z<sub>3</sub> (indicated).</p></caption>
<graphic xlink:href="495956v2_figs1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs2" position="float" orientation="portrait" fig-type="figure">
<label>Figure S2</label>
<caption><title>Persistent homology and Betti numbers for condition 1D<sub>L</sub>.</title><p><bold>a</bold>, Smoothed density of pooled data (colored areas) and average across simulations (circles) of persistence diagrams with coefficients in Z<sub>2</sub> for H<sub>0</sub> (grey), H<sub>1</sub> (blue) and H<sub>2</sub> (red) corresponding to simulations in the 1D<sub>L</sub> condition. <bold>b</bold>, as <bold>a</bold> but in Z<sub>3.</sub> <bold>c</bold>, Distribution across simulations of lifetime difference between consecutive generators ordered for each simulation from longest to shortest lifetime. <bold>d</bold>, Pie plot and table indicating the number of simulations (out of 100) classified according to their Betti numbers.</p></caption>
<graphic xlink:href="495956v2_figs2.tif" mimetype="image" mime-subtype="tiff"/>
</fig></p></sec></app></app-group>
<ref-list>
<title>References</title>
<ref id="c1"><label>1</label><mixed-citation publication-type="journal"><string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name>, <string-name><surname>Kropff</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>M.-B</given-names></string-name>. <article-title>Place cells, grid cells, and the brain’s spatial representation system</article-title>. <source>Annu. Rev. Neurosci</source>. <volume>31</volume>, <fpage>69</fpage>–<lpage>89</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c2"><label>2</label><mixed-citation publication-type="journal"><string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Molden</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Witter</surname>, <given-names>M. P.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>M.-B</given-names></string-name>. <article-title>Spatial representation in the entorhinal cortex</article-title>. <source>Science</source> (<year>2004</year>).</mixed-citation></ref>
<ref id="c3"><label>3</label><mixed-citation publication-type="journal"><string-name><surname>Buzsáki</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>E. I</given-names></string-name>. <article-title>Memory, navigation and theta rhythm in the hippocampal- entorhinal system</article-title>. <source>Nature neuroscience</source> <volume>16</volume>, <fpage>130</fpage>–<lpage>138</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c4"><label>4</label><mixed-citation publication-type="journal"><string-name><surname>Kropff</surname>, <given-names>E.</given-names></string-name> &amp; <string-name><surname>Treves</surname>, <given-names>A</given-names></string-name>. <article-title>The emergence of grid cells: Intelligent design or just adaptation?</article-title> <source>Hippocampus</source> <volume>18</volume>, <fpage>1256</fpage>–<lpage>1269</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c5"><label>5</label><mixed-citation publication-type="journal"><string-name><surname>Couey</surname>, <given-names>J. J.</given-names></string-name> <etal>et al.</etal> <article-title>Recurrent inhibitory circuitry as a mechanism for grid formation</article-title>. <source>Nature neuroscience</source> <volume>16</volume>, <fpage>318</fpage>–<lpage>324</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c6"><label>6</label><mixed-citation publication-type="journal"><string-name><surname>Burak</surname>, <given-names>Y.</given-names></string-name> &amp; <string-name><surname>Fiete</surname>, <given-names>I. R</given-names></string-name>. <article-title>Accurate path integration in continuous attractor network models of grid cells</article-title>. <source>PLoS computational biology</source> <volume>5</volume>, <fpage>e1000291</fpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c7"><label>7</label><mixed-citation publication-type="journal"><string-name><surname>Burgess</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>O’keefe</surname>, <given-names>J</given-names></string-name>. <article-title>An oscillatory interference model of grid cell firing</article-title>. <source>Hippocampus</source> <volume>17</volume>, <fpage>801</fpage>–<lpage>812</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c8"><label>8</label><mixed-citation publication-type="journal"><string-name><surname>Knierim</surname>, <given-names>J. J.</given-names></string-name> &amp; <string-name><surname>Zhang</surname>, <given-names>K</given-names></string-name>. <article-title>Attractor dynamics of spatially correlated neural activity in the limbic system</article-title>. <source>Annual review of neuroscience</source> <volume>35</volume>, <issue>267</issue> (<year>2012</year>).</mixed-citation></ref>
<ref id="c9"><label>9</label><mixed-citation publication-type="journal"><string-name><surname>Hopfield</surname>, <given-names>J. J</given-names></string-name>. <article-title>Neural networks and physical systems with emergent collective computational abilities</article-title>. <source>Proceedings of the national academy of sciences</source> <volume>79</volume>, <fpage>2554</fpage>–<lpage>2558</lpage> (<year>1982</year>).</mixed-citation></ref>
<ref id="c10"><label>10</label><mixed-citation publication-type="journal"><string-name><surname>Redish</surname>, <given-names>A. D.</given-names></string-name>, <string-name><surname>Elga</surname>, <given-names>A. N.</given-names></string-name> &amp; <string-name><surname>Touretzky</surname>, <given-names>D. S</given-names></string-name>. <article-title>A coupled attractor model of the rodent head direction system</article-title>. <source>Network: computation in neural systems</source> <volume>7</volume>, <issue>671</issue> (<year>1996</year>).</mixed-citation></ref>
<ref id="c11"><label>11</label><mixed-citation publication-type="journal"><string-name><surname>Zhang</surname>, <given-names>K</given-names></string-name>. <article-title>Representation of spatial orientation by the intrinsic dynamics of the head- direction cell ensemble: a theory</article-title>. <source>Journal of Neuroscience</source> <volume>16</volume>, <fpage>2112</fpage>–<lpage>2126</lpage> (<year>1996</year>).</mixed-citation></ref>
<ref id="c12"><label>12</label><mixed-citation publication-type="journal"><string-name><surname>Battaglia</surname>, <given-names>F. P.</given-names></string-name> &amp; <string-name><surname>Treves</surname>, <given-names>A</given-names></string-name>. <article-title>Attractor neural networks storing multiple space representations: a model for hippocampal place fields</article-title>. <source>Physical Review E</source> <volume>58</volume>, <fpage>7738</fpage> (<year>1998</year>).</mixed-citation></ref>
<ref id="c13"><label>13</label><mixed-citation publication-type="journal"><string-name><surname>Gardner</surname>, <given-names>R. J.</given-names></string-name> <etal>et al.</etal> <article-title>Toroidal topology of population activity in grid cells</article-title>. <source>Nature</source>, <fpage>1</fpage>–<lpage>6</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c14"><label>14</label><mixed-citation publication-type="journal"><string-name><surname>Aronov</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Nevers</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Tank</surname>, <given-names>D. W</given-names></string-name>. <article-title>Mapping of a non-spatial dimension by the hippocampal–entorhinal circuit</article-title>. <source>Nature</source> <volume>543</volume>, <fpage>719</fpage>–<lpage>722</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c15"><label>15</label><mixed-citation publication-type="journal"><string-name><surname>Kraus</surname>, <given-names>B. J.</given-names></string-name> <etal>et al.</etal> <article-title>During running in place, grid cells integrate elapsed time and distance run</article-title>. <source>Neuron</source> <volume>88</volume>, <fpage>578</fpage>–<lpage>589</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c16"><label>16</label><mixed-citation publication-type="journal"><string-name><surname>Yoon</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Lewallen</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Kinkhabwala</surname>, <given-names>A. A.</given-names></string-name>, <string-name><surname>Tank</surname>, <given-names>D. W.</given-names></string-name> &amp; <string-name><surname>Fiete</surname>, <given-names>I. R</given-names></string-name>. <article-title>Grid cell responses in 1D environments assessed as slices through a 2D lattice</article-title>. <source>Neuron</source> <volume>89</volume>, <fpage>1086</fpage>–<lpage>1099</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c17"><label>17</label><mixed-citation publication-type="journal"><string-name><surname>Hafting</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Fyhn</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Bonnevie</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>M.-B.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>E. I</given-names></string-name>. <article-title>Hippocampus- independent phase precession in entorhinal grid cells</article-title>. <source>Nature</source> <volume>453</volume>, <fpage>1248</fpage>–<lpage>1252</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c18"><label>18</label><mixed-citation publication-type="journal"><string-name><surname>Grieves</surname>, <given-names>R. M.</given-names></string-name> <etal>et al.</etal> <article-title>Irregular distribution of grid cell firing fields in rats exploring a 3D volumetric space</article-title>. <source>Nature neuroscience</source> <volume>24</volume>, <fpage>1567</fpage>–<lpage>1573</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c19"><label>19</label><mixed-citation publication-type="journal"><string-name><surname>Ginosar</surname>, <given-names>G.</given-names></string-name> <etal>et al.</etal> <article-title>Locally ordered representation of 3D space in the entorhinal cortex</article-title>. <source>Nature</source> <volume>596</volume>, <fpage>404</fpage>–<lpage>409</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c20"><label>20</label><mixed-citation publication-type="journal"><string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Hayman</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Burgess</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Jeffery</surname>, <given-names>K. J</given-names></string-name>. <article-title>Experience-dependent rescaling of entorhinal grids</article-title>. <source>Nature neuroscience</source> <volume>10</volume>, <fpage>682</fpage>–<lpage>684</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c21"><label>21</label><mixed-citation publication-type="journal"><string-name><surname>Yoon</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal> <article-title>Specific evidence of low-dimensional continuous attractor dynamics in grid cells</article-title>. <source>Nature neuroscience</source> <volume>16</volume>, <fpage>1077</fpage>–<lpage>1084</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c22"><label>22</label><mixed-citation publication-type="journal"><string-name><surname>Krupic</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Bauza</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Burton</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>O’Keefe</surname>, <given-names>J</given-names></string-name>. <article-title>Grid cell symmetry is shaped by environmental geometry</article-title>. <source>Nature</source> <volume>518</volume>, <fpage>232</fpage>–<lpage>235</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c23"><label>23</label><mixed-citation publication-type="journal"><string-name><surname>Krupic</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Bauza</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Burton</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>O’Keefe</surname>, <given-names>J</given-names></string-name>. <article-title>Local transformations of the hippocampal cognitive map</article-title>. <source>Science</source> <volume>359</volume>, <fpage>1143</fpage>–<lpage>1146</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c24"><label>24</label><mixed-citation publication-type="journal"><string-name><surname>Boccara</surname>, <given-names>C. N.</given-names></string-name>, <string-name><surname>Nardin</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Stella</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>O’Neill</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Csicsvari</surname>, <given-names>J</given-names></string-name>. <article-title>The entorhinal cognitive map is attracted to goals</article-title>. <source>Science</source> <volume>363</volume>, <fpage>1443</fpage>–<lpage>1447</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c25"><label>25</label><mixed-citation publication-type="journal"><string-name><surname>Butler</surname>, <given-names>W. N.</given-names></string-name>, <string-name><surname>Hardcastle</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Giocomo</surname>, <given-names>L. M</given-names></string-name>. <article-title>Remembered reward locations restructure entorhinal spatial maps</article-title>. <source>Science</source> <volume>363</volume>, <fpage>1447</fpage>–<lpage>1452</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c26"><label>26</label><mixed-citation publication-type="journal"><string-name><surname>Sanguinetti-Scheck</surname>, <given-names>J. I.</given-names></string-name> &amp; <string-name><surname>Brecht</surname>, <given-names>M</given-names></string-name>. <article-title>Home, head direction stability, and grid cell distortion</article-title>. <source>Journal of Neurophysiology</source> (<year>2020</year>).</mixed-citation></ref>
<ref id="c27"><label>27</label><mixed-citation publication-type="journal"><string-name><surname>Si</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Treves</surname>, <given-names>A</given-names></string-name>. <article-title>A model for the differentiation between grid and conjunctive units in medial entorhinal cortex</article-title>. <source>Hippocampus</source> <volume>23</volume>, <fpage>1410</fpage>–<lpage>1424</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c28"><label>28</label><mixed-citation publication-type="journal"><string-name><surname>Widloski</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Fiete</surname>, <given-names>I. R</given-names></string-name>. <article-title>A model of grid cell development through spatial exploration and spike time-dependent plasticity</article-title>. <source>Neuron</source> <volume>83</volume>, <fpage>481</fpage>–<lpage>495</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c29"><label>29</label><mixed-citation publication-type="other"><string-name><given-names>Gonzalo</given-names> <surname>Cogno</surname></string-name>, S., <etal>et al.</etal> <article-title>Minute-scale oscillatory sequences in medial entorhinal cortex</article-title>. <source>bioRxiv</source> (<year>2022</year>).</mixed-citation></ref>
<ref id="c30"><label>30</label><mixed-citation publication-type="book"><string-name><surname>Hatcher</surname>, <given-names>A</given-names></string-name>. <source>Algebraic Topology</source>. (<publisher-name>Cambridge University Press</publisher-name>, <year>2002</year>).</mixed-citation></ref>
<ref id="c31"><label>31</label><mixed-citation publication-type="journal"><string-name><surname>Stolz</surname>, <given-names>B. J.</given-names></string-name>, <string-name><surname>Tanner</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Harrington</surname>, <given-names>H. A.</given-names></string-name> &amp; <string-name><surname>Nanda</surname>, <given-names>V</given-names></string-name>. <article-title>Geometric anomaly detection in data</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>117</volume>, <fpage>19664</fpage>–<lpage>19669</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c32"><label>32</label><mixed-citation publication-type="journal"><string-name><surname>Tenenbaum</surname>, <given-names>J. B.</given-names></string-name>, <string-name><surname>Silva</surname>, <given-names>V.</given-names></string-name> d. &amp; <string-name><surname>Langford</surname>, <given-names>J. C.</given-names></string-name> <article-title>A global geometric framework for nonlinear dimensionality reduction</article-title>. <source>science</source> <volume>290</volume>, <fpage>2319</fpage>–<lpage>2323</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c33"><label>33</label><mixed-citation publication-type="journal"><string-name><surname>Bjerknes</surname>, <given-names>T. L.</given-names></string-name>, <string-name><surname>Langston</surname>, <given-names>R. F.</given-names></string-name>, <string-name><surname>Kruge</surname>, <given-names>I. U.</given-names></string-name>, <string-name><surname>Moser</surname>, <given-names>E. I.</given-names></string-name> &amp; <string-name><surname>Moser</surname>, <given-names>M.-B</given-names></string-name>. <article-title>Coherence among head direction cells before eye opening in rat pups</article-title>. <source>Current Biology</source> <volume>25</volume>, <fpage>103</fpage>–<lpage>108</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c34"><label>34</label><mixed-citation publication-type="journal"><string-name><surname>Pastalkova</surname>, <given-names>E.</given-names></string-name>, <string-name><surname>Itskov</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Amarasingham</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Buzsaki</surname>, <given-names>G</given-names></string-name>. <article-title>Internally generated cell assembly sequences in the rat hippocampus</article-title>. <source>Science</source> <volume>321</volume>, <fpage>1322</fpage>–<lpage>1327</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c35"><label>35</label><mixed-citation publication-type="journal"><string-name><surname>Jayakumar</surname>, <given-names>R. P.</given-names></string-name> <etal>et al.</etal> <article-title>Recalibration of path integration in hippocampal place cells</article-title>. <source>Nature</source> <volume>566</volume>, <fpage>533</fpage>–<lpage>537</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c36"><label>36</label><mixed-citation publication-type="journal"><string-name><surname>Barry</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Ginzberg</surname>, <given-names>L. L.</given-names></string-name>, <string-name><surname>O’Keefe</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Burgess</surname>, <given-names>N</given-names></string-name>. <article-title>Grid cell firing patterns signal environmental novelty by expansion</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>109</volume>, <fpage>17687</fpage>–<lpage>17692</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c37"><label>37</label><mixed-citation publication-type="journal"><string-name><surname>Boccara</surname>, <given-names>C. N.</given-names></string-name> <etal>et al.</etal> <article-title>Grid cells in pre-and parasubiculum</article-title>. <source>Nature neuroscience</source> <volume>13</volume>, <fpage>987</fpage>–<lpage>994</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c38"><label>38</label><mixed-citation publication-type="journal"><string-name><surname>Long</surname>, <given-names>X.</given-names></string-name>, <string-name><surname>Deng</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Cai</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Chen</surname>, <given-names>Z. S.</given-names></string-name> &amp; <string-name><surname>Zhang</surname>, <given-names>S.-J.</given-names></string-name> <article-title>A compact spatial map in V2 visual cortex</article-title>. <source>BioRxiv</source> (<year>2021</year>).</mixed-citation></ref>
<ref id="c39"><label>39</label><mixed-citation publication-type="journal"><string-name><surname>Long</surname>, <given-names>X.</given-names></string-name> &amp; <string-name><surname>Zhang</surname>, <given-names>S.-J</given-names></string-name>. <article-title>A novel somatosensory spatial navigation system outside the hippocampal formation</article-title>. <source>Cell research</source> <volume>31</volume>, <fpage>649</fpage>–<lpage>663</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c40"><label>40</label><mixed-citation publication-type="journal"><string-name><surname>Langston</surname>, <given-names>R. F.</given-names></string-name> <etal>et al.</etal> <article-title>Development of the spatial representation system in the rat</article-title>. <source>Science</source> <volume>328</volume>, <fpage>1576</fpage>–<lpage>1580</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c41"><label>41</label><mixed-citation publication-type="journal"><string-name><surname>Wills</surname>, <given-names>T. J.</given-names></string-name>, <string-name><surname>Cacucci</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Burgess</surname>, <given-names>N.</given-names></string-name> &amp; <article-title>O’Keefe, J. Development of the hippocampal cognitive map in preweanling rats</article-title>. <source>science</source> <volume>328</volume>, <fpage>1573</fpage>–<lpage>1576</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c42"><label>42</label><mixed-citation publication-type="book"><string-name><surname>Boissonnat</surname>, <given-names>J.-D.</given-names></string-name>, <string-name><surname>Chazal</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Yvinec</surname>, <given-names>M</given-names></string-name>. <source>Geometric and topological inferenc</source><italic>e</italic>. Vol. <volume>57</volume> (<publisher-name>Cambridge University Pres</publisher-name>s, <year>2018</year>).</mixed-citation></ref>
<ref id="c43"><label>43</label><mixed-citation publication-type="other"><string-name><surname>Edelsbrunner</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Harer</surname>, <given-names>J.</given-names></string-name> <article-title>Persistent homology-a survey. <italic>Contemporary mathematics</italic></article-title> <volume>453</volume>, <fpage>257</fpage>–<lpage>282</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c44"><label>44</label><mixed-citation publication-type="other"><string-name><surname>Edelsbrunner</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Letscher</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Zomorodian</surname>, <given-names>A.</given-names></string-name> <conf-name>in Proceedings 41st annual symposium on foundations of computer science</conf-name>. <fpage>454</fpage>–<lpage>463</lpage> (<source>IEEE</source>).</mixed-citation></ref>
<ref id="c45"><label>45</label><mixed-citation publication-type="journal"><string-name><surname>Zomorodian</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Carlsson</surname>, <given-names>G.</given-names></string-name> <article-title>Computing persistent homology</article-title>. <source>Discrete &amp; Computational Geometry</source> <volume>33</volume>, <fpage>249</fpage>–<lpage>274</lpage> (<year>2005</year>).</mixed-citation></ref>
<ref id="c46"><label>46</label><mixed-citation publication-type="journal"><string-name><surname>Mileyko</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Mukherjee</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Harer</surname>, <given-names>J</given-names></string-name>. <article-title>Probability measures on the space of persistence diagrams</article-title>. <source>Inverse Problems</source> <volume>27</volume>, <issue>124007</issue> (<year>2011</year>).</mixed-citation></ref>
<ref id="c47"><label>47</label><mixed-citation publication-type="journal"><string-name><surname>Turner</surname>, <given-names>K.</given-names></string-name>, <string-name><surname>Mileyko</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Mukherjee</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Harer</surname>, <given-names>J</given-names></string-name>. <article-title>Fréchet means for distributions of persistence diagrams</article-title>. <source>Discrete &amp; Computational Geometry</source> <volume>52</volume>, <fpage>44</fpage>–<lpage>70</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c48"><label>48</label><mixed-citation publication-type="journal"><string-name><surname>Bauer</surname>, <given-names>U</given-names></string-name>. <article-title>Ripser: efficient computation of Vietoris–Rips persistence barcodes</article-title>. <source>Journal of Applied and Computational Topology</source> <volume>5</volume>, <fpage>391</fpage>–<lpage>423</lpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c49"><label>49</label><mixed-citation publication-type="other"><string-name><surname>Maria</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Boissonnat</surname>, <given-names>J.-D.</given-names></string-name>, <string-name><surname>Glisse</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Yvinec</surname>, <given-names>M.</given-names></string-name> <chapter-title>in International congress on mathematical software</chapter-title>. <fpage>167</fpage>–<lpage>174</lpage> (<publisher-name>Springer</publisher-name>).</mixed-citation></ref>
<ref id="c50"><label>50</label><mixed-citation publication-type="journal"><string-name><surname>Fukunaga</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Olsen</surname>, <given-names>D. R</given-names></string-name>. <article-title>An algorithm for finding intrinsic dimensionality of data</article-title>. <source>IEEE Transactions on Computers</source> <volume>100</volume>, <fpage>176</fpage>–<lpage>183</lpage> (<year>1971</year>).</mixed-citation></ref>
<ref id="c51"><label>51</label><mixed-citation publication-type="other"><string-name><surname>Satopaa</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Albrecht</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Irwin</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Raghavan</surname>, <given-names>B.</given-names></string-name> <article-title>in 2011 <italic>31st international conference on distributed computing systems workshops</italic></article-title>. <fpage>166</fpage>–<lpage>171</lpage> (<source>IEEE</source>).</mixed-citation></ref>
<ref id="c52"><label>52</label><mixed-citation publication-type="journal"><string-name><surname>Markov</surname>, <given-names>A.</given-names></string-name> <article-title>O konstruktivnykh funkciyakh</article-title>. <source>Trudy Mat. Instituta im. Steklova</source> <volume>52</volume>, <fpage>315</fpage>–<lpage>348</lpage> (<year>1958</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.89851.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Giocomo</surname>
<given-names>Lisa M</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Stanford School of Medicine</institution>
</institution-wrap>
<city>Stanford</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Incomplete</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Useful</kwd>
</kwd-group>
</front-stub>
<body>
<p>In this <bold>useful</bold> study, the authors use a computational model to investigate how recurrent connections influence the firing patterns of grid cells, which are thought to play a role in encoding an animal's position in space. The work suggests that a one-dimensional network architecture may be sufficient to generate the hexagonal firing patterns of grid cells, a possible alternative to attractor models based on recurrent connectivity between grid cells. However, the support for this proposal was <bold>incomplete</bold>, as the model was inconsistent with certain key features of grid cell organization.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.89851.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This study investigates the impact of recurrent connections on grid fields generated in networks trained by adjusting the strength of feedforward spatial inputs. The main result is that if the recurrent connections in the network are given a 1D continuous attractor architecture, then aligned grid firing patterns emerge in the network following training. Detailed analyses of the low dimensional dynamics of the resulting networks are then presented. The simulations and analyses appear carefully carried out.</p>
<p>The feedforward model investigated by the authors (previously introduced by Kropff &amp; Treves, 2008) is an interesting and important alternative to models that generate grid firing patterns through 2-dimensional continuous attractor network (CAN) dynamics. However, while both classes of model generate grid fields, in making comparisons the manuscript is insufficiently clear about their differences. In particular, in the CAN models grid firing is a direct result of their 2-D architecture, either a torus structure with a single activity bump (e.g. Guanella et al. 2007, Pastoll et al. 2013), or sheet with multiple local activity bumps (Fuhs &amp; Touretzky, Burak &amp; Fiete, 2009). In these models, spatial input can anchor the grid representations but is not necessary for grid firing. By contrast, in the feedforward models neurons transform existing spatial inputs into a grid representation. Thus, the two classes of model implement different computations; CANs path integrate, while the feedforward models transform spatial representations. A demonstration that a 1D CAN generates coordinated 2D grid fields would be surprising and important, but it's less clear why coordination between grids generated by the feedforward mechanism would be surprising. As written, it's unclear which of these claims the study is trying to make. If the former, then the conclusion doesn't appear well supported by the data as presented, if the latter then the results are perhaps not so unexpected, and the imposed attractor dynamics may still not be relevant.</p>
<p>Whichever claim is being made, it could be helpful to more carefully evaluate the model dynamics given predictions expected for the different classes of model. Key questions that are not answered by the manuscript include:</p>
<p>- At what point is the 1D attractor architecture playing a role in the models presented here? Is it important specifically for training or is it also contributing to computation in the fully trained network?</p>
<p>- Is an attractor architecture required at all for emergence of population alignment and gridness? Key controls missing from Figure 2 include training on networks with other architectures. For example, one might consider various architectures with randomly structured connectivity (e.g. drawing weights from exponential or Gaussian distributions).</p>
<p>- In the trained models do the recurrent connections substantially influence activity in the test conditions? Or after training are the 1D dynamics drowned out by feedforward inputs?</p>
<p>- What is the low dimensional structure of the input to the network? Can the apparent discrepancy between dimensionality of architecture and representation be resolved by considering structure of the inputs, e.g. if the input is a 2 dimensional representation of location then is it surprising that the output is too?</p>
<p>- What happens to representations in the trained networks presented when place cells remap? Is the 1D manifold maintained as expected for CAN models, or does it reorganise?</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.89851.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
The authors proposed that grid cells may be aligned by simpler, 1D attractors, and they showed that the structure and the representational space of an attractor network can be two different topological objects.</p>
<p>Strengths:</p>
<p>
It is very interesting that the toroidal topology of the population activity (the representational space) and the structure of the attractor network do not necessarily to be the same. The authors carried out extensive computational modeling to support such evidence. The results presented by the authors in this study could have an impact in the grid cell field, which will motivate future experimental studies to examine the detailed structure of the grid cell population.</p>
<p>Weaknesses:</p>
<p>
The authors mentioned that &quot;the recurrent collateral structure defines the geometry of the manifold...&quot; and pointed out that this assumption is wrong. I am afraid this claim is too strong. The Gardner Torus paper showed evidence of the 2D CAN exists in the EC as a possible substrate of the grid pattern. Do the authors mean here that even the population activity in the grid cells show the torus structure, it does not necessarily mean that the grid cells form a 2D CAN? I understand that from the computational modeling view, it is doable to find counter-examples (like the 1D attractor network) in which the representational space is a torus but the structure is different. However, from the experimental view, do you expect that the grid cell network is a low-dimensional attractor network? To prove this, is there any evidence from the experimental data?</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.89851.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The paper proposes an alternative to the attractor hypothesis, as an explanation for the fact that grid cell population activity patterns (within a module) span a toroidal manifold. The proposal is based on a class of models that were extensively studied in the past, in which grid cells are driven by synaptic inputs from place cells in the hippocampus. The synapses are updated according to a Hebbian plasticity rule. Combined with an adaptation mechanism, this leads to patterning of the inputs from place cells to grid cells such that the spatial activity patterns are organized as an array of localized firing fields with hexagonal order. I refer to these models below as feedforward models.</p>
<p>It has already been shown by Si, Kropff, and Treves in 2012 that recurrent connections between grid cells can lead to alignment of their spatial response patterns. This idea was revisited by Urdapilleta, Si, and Treves in 2017. Thus, it should already be clear that in such models, the population activity pattern spans a manifold with toroidal topology. The main new contributions in the present paper are (i) in considering some forms of recurrent connectivity that were not directly addressed before (but see comments below). (ii) in applying topological analysis to simulations of the model. (iii) in interpreting the results as a potential explanation for the observations of Gardner et al.</p>
<p>Strengths:</p>
<p>The exploration of learning in a feedforward model, when recurrent connectivity in the grid cell layer is structured in a ring topology, is interesting. The insight that this not only aligns the grid cells in a common direction but also creates a correspondence between their intrinsic coordinate (in terms of the ring-like recurrent connectivity) and their tuning on the torus is interesting as well, and the paper as a whole may influence future theoretical thinking on the mechanisms giving rise to the properties of grid cells.</p>
<p>Weaknesses:</p>
<p>1. It is not clear to me that the proposal here is fundamentally new. In Si, Kropff and Treves (2012) recurrent connectivity was dependent on the head direction tuning and thus had a ring structure. Urdapilleta, Si, and Treves considered connectivity that depends on the distance on a 2d plane.</p>
<p>2. The paper refers to the connectivity within the grid cell layer as an attractor. However, would this connectivity, on its own, indeed sustain persistent attractor states? This is not examined in the paper. Furthermore, is this even necessary to obtain the results in the model? Perhaps weak connections that do not produce an attractor would be sufficient to align the spatial response patterns during the learning of feedforward weights, and reproduce the results? In general, there is no exploration of how the strength of collateral interactions affects the outcome.</p>
<p>3. I did not understand what is learned from the local topology analysis. Given that all the grid cells are driven by an input from place cells that spans a 2d manifold, and that the activity in the grid cell network settles on a steady state that depends only on the inputs, isn't it quite obvious that the manifold of activity in the grid cell layer would have, locally, a 2d structure?</p>
<p>4. The modeling is all done in planar 2d environments, where the feedforward learning mechanism promotes the emergence of a hexagonal pattern in the single neuron tuning curve. This, combined with the fact that all neurons develop spatial patterns with the same spacing and orientation, implies even without any topological analysis that the emerging topology of the population activity is a torus.</p>
<p>However, the toroidal topology of grid cells in reality has been observed by Gardner et al also in the wagon wheel environment and in sleep, and there is substantial evidence based on pairwise correlations that it persists also in various other situations, in which the spatial response pattern is not a hexagonal firing pattern. It is not clear that the mechanism proposed in the present paper would generate toroidal topology of the population activity in more complex environments. In fact, it seems likely that it will not do so.</p>
<p>5. Moreover, the recent work of Gardner et al. demonstrated much more than the preservation of the topology in the different environments and in sleep: the toroidal tuning curves of individual neurons remained the same in different environments. Previous works, that analyzed pairwise correlations under hippocampal inactivation and various other manipulations, also pointed towards the same conclusion. Thus, the same population activity patterns are expressed in many different conditions. In the present model, the results of Figure 6 suggest that even across distinct rectangular environments, toroidal tuning curves will not be preserved, because there are multiple possible arrangements of the phases on the torus which emerge in different simulations.</p>
<p>6. In real grid cells, there is a dense and fairly uniform representation of all phases (see the toroidal tuning of grid cells measured by Gardner et al). Here the distribution of phases is not shown, but Figure 7 suggests that phases are non uniformly represented, with significant clustering around a few discrete phases. This, I believe, is also the origin for the difficulty in identifying the toroidal topology based on the transpose of the matrix M: vectors representing the spatial response patterns of individual neurons are localized near the clusters, and there are only a few of them that represent other phases. Therefore, there is no dense coverage of the toroidal manifold that would exist if all phases were represented equally. This is not just a technical issue, however: there appears to be a mismatch between the results of the model and the experimental reality, in terms of the phase coverage.</p>
<p>7. The manuscript makes several strong claims that incorrectly represent the relation between experimental data and attractor models, on one hand, and the present model on the other hand. For the latter, see the comments above. For the former, I provide a detailed list in the recommendations to the authors, but in short: the paper claims that attractor models induce rigidness in the neural activity which is incompatible with distortions seen in the spatial response patterns of grid cells. However, this claim seems to confuse distortions in the spatial response pattern, which are fully compatible with the attractor model, with distortions in the population activity patterns, which would be incompatible with the attractor model. The attractor model has withstood numerous tests showing that the population activity manifold is rigidly preserved across conditions - a strong prediction (which is not made, as far as I can see, by feedforward models). I am not aware of any data set where distortions of the population activity manifold have been identified, and the preservation has been demonstrated in many examples where the spatial response pattern is disrupted. This is the main point of two papers cited in the present manuscript: by Yoon et al, and Gardner et al.</p>
<p>8. There is also some weakness in the mathematical description of the dynamics. Mathematical equations are formulated in discrete time steps, without a clear interpretation in terms of biophysically relevant time scales. It appears that there are no terms in the dynamics associated with an intrinsic time scale of the neurons or the synapses, and this introduces a difficulty in interpreting synaptic weights as being weak or strong. As mentioned above, the nature of the recurrent dynamics within the grid cell network (whether it exhibits continuous attractor behavior) is not sufficiently clear.</p>
<p>In my view, the weaknesses discussed above limit the ability of the model, as it stands, to offer a compelling explanation for the toroidal topology of grid cell population activity patterns, and especially the rigidity of the manifold across environments and behavioral states. Still, the work offers an interesting way of thinking on how the toroidal topology might emerge. Perhaps with certain additional elements this may motivate new theoretical insights.</p>
</body>
</sub-article>
</article>