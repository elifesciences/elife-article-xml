<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">90634</article-id>
<article-id pub-id-type="doi">10.7554/eLife.90634</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.90634.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.3</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Neuroscience</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Statistical learning shapes pain perception and prediction independently of external cues</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0876-5465</contrib-id>
<name>
<surname>Onysk</surname>
<given-names>Jakub</given-names>
</name>
<xref ref-type="corresp" rid="cor1">*</xref>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gregory</surname>
<given-names>Nicholas</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Whitefield</surname>
<given-names>Mia</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Jain</surname>
<given-names>Maeghal</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8306-8454</contrib-id>
<name>
<surname>Turner</surname>
<given-names>Georgia</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1724-5832</contrib-id>
<name>
<surname>Seymour</surname>
<given-names>Ben</given-names>
</name>
<xref ref-type="aff" rid="a4">4</xref>
<xref ref-type="aff" rid="a5">5</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8441-9236</contrib-id>
<name>
<surname>Mancini</surname>
<given-names>Flavia</given-names>
</name>
<xref ref-type="corresp" rid="cor2">†</xref>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<aff id="a1"><label>1</label><institution>Computational and Biological Learning Unit, Department of Engineering, University of Cambridge</institution>, Cambridge CB2 1PZ, <country>UK</country></aff>
<aff id="a2"><label>2</label><institution>Applied Computational Psychiatry Lab, Max Planck Centre for Computational Psychiatry and Ageing Research, Queen Square Institute of Neurology and Mental Health Neuroscience Department, Division of Psychiatry, University College London</institution>, <country>UK</country></aff>
<aff id="a3"><label>3</label><institution>MRC Cognition and Brain Sciences Unit, University of Cambridge</institution>, <country>UK</country></aff>
<aff id="a4"><label>4</label><institution>Wellcome Centre for Integrative Neuroimaging, John Radcliffe Hospital</institution>, Headington, Oxford OX3 9DU, <country>UK</country></aff>
<aff id="a5"><label>5</label><institution>Center for Information and Neural Networks (CiNet)</institution>, Osaka 565-0871, <country>Japan</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Ploner</surname>
<given-names>Markus</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Department of Neurology and TUM-Neuroimaging Center, TUM School of Medicine and Health, Technical University of Munich (TUM)</institution>
</institution-wrap>
<city>Munich</city>
<country>Germany</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Büchel</surname>
<given-names>Christian</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University Medical Center Hamburg-Eppendorf</institution>
</institution-wrap>
<city>Hamburg</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>Corresponding author: <email>jakub.onysk.22@ucl.ac.uk</email></corresp>
<corresp id="cor2"><label>†</label>Corresponding author: <email>flavia.mancini@eng.cam.ac.uk</email></corresp>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-10-04">
<day>04</day>
<month>10</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2024-05-28">
<day>28</day>
<month>05</month>
<year>2024</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP90634</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-07-19">
<day>19</day>
<month>07</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-07-04">
<day>04</day>
<month>07</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.03.23.23287656"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-10-04">
<day>04</day>
<month>10</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.90634.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.90634.1.sa3">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.90634.1.sa2">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.90634.1.sa1">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.90634.1.sa0">Reviewer #3 (Public Review):</self-uri>
<self-uri content-type="author-comment" xlink:href="https://doi.org/10.7554/eLife.90634.1.sa4">Author Response</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Onysk et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Onysk et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-90634-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>The placebo and nocebo effects highlight the importance of expectations in modulating pain perception, but in everyday life we don’t need an external source of information to form expectations about pain. The brain can learn to predict pain in a more fundamental way, simply by experiencing fluctuating, non-random streams of noxious inputs, and extracting their temporal regularities. This process is called statistical learning. Here we address a key open question: does statistical learning modulate pain perception? We asked 27 participants to both rate and predict pain intensity levels in sequences of fluctuating heat pain. Using a computational approach, we show that probabilistic expectations and confidence were used to weight pain perception and prediction. As such, this study goes beyond well-established conditioning paradigms associating non-pain cues with pain outcomes, and shows that statistical learning itself shapes pain experience. This finding opens a new path of research into the brain mechanisms of pain regulation, with relevance to chronic pain where it may be dysfunctional.</p>
</abstract>
</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<notes notes-type="financial-disclosure">
<title>Funding Statement</title><p>The study was funded by a MRC Career Development Award to FM (MR/T010614/1) and a UKRI Advanced846
Pain Discovery Platform grant to both F.M. and B.S. (MR/W027593/1). B.S. was also funded by Wellcome (214251/Z/18/Z), Versus Arthritis (21537), and IITP (MSIT 2019-0-01371). This work has been performed using resources provided by the Cambridge Tier-2 system operated by the University of Cambridge Research Computing Service (<ext-link ext-link-type="uri" xlink:href="http://www.hpc.cam.ac.uk">www.hpc.cam.ac.uk</ext-link>) funded by EPSRC Tier-2 capital grant (EP/T022159/1). HPC access was additionally funded by an EPSRC research infrastructure grant to F.M.</p></notes>
<notes notes-type="disclosures">
<title>Author Declarations</title><p>I confirm all relevant ethical guidelines have been followed, and any necessary IRB and/or ethics committee approvals have been obtained.</p><p>Yes</p><p>The details of the IRB/oversight body that provided approval or exemption for the research described are given below:</p><p>Department of Engineering, University Cambridge Ethics Committee gave ethical approval for this work.</p><p>I confirm that all necessary patient/participant consent has been obtained and the appropriate institutional forms have been archived, and that any patient/participant/sample identifiers included were not known to anyone (e.g., hospital staff, patients or participants themselves) outside the research group so cannot be used to identify individuals.</p><p>Yes</p><p>I understand that all clinical trials and any other prospective interventional studies must be registered with an ICMJE-approved registry, such as ClinicalTrials.gov. I confirm that any such study reported in the manuscript has been registered and the trial registration ID is provided (note: if posting a prospective study registered retrospectively, please provide a statement in the trial ID field explaining why the study was not registered in advance).</p><p>Yes</p><p>I have followed all appropriate research reporting guidelines, such as any relevant EQUATOR Network research reporting checklist(s) and other pertinent material, if applicable.</p><p>Yes</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>- We clarified our modelling choices in the Modelling strategy subsection of the results
section.
- We restructured introduction, results and parts of the methods
- We have visualised the experimental design in <xref rid="fig1" ref-type="fig">Figure 1D</xref>. Furthermore, we have visualised the two main computational models
(eRL and eKF) in <xref rid="fig2" ref-type="fig">Figure 2</xref>
- We re-plotted <xref rid="fig1" ref-type="fig">Figure 1E-F</xref> with a different exemplary participant, whose rating go above the pain threshold. We also included all participant pain perception and prediction ratings, noxious input sequences and confidence ratings in the supplement in Figures S1-S3.
- We elaborated on the significance statements in the Modelling Results subsection and Discussion
- We increased the number of simulations per model pair to ≈ 100 (after rejecting fits based on diagnostics criteria - E-BFMI and divergent transitions) and updated the confusion matrix (Table S4).
- We included parameter recovery scatter plots for each model and paramter in the
Supplement Figures S7-S11
- We have considered the suggested diagnostics and include bulk and tail ESS values for each condition, model, parameter in the Supplement Tables S6-S9. We also report number of chain with low E-BFMI (0), number of divergent transitions (0) and the E-BFMI values per chain in Table S10</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<label>1</label>
<title>Introduction</title>
<p>Clinical pain typically varies over time; in most pain states, the brain receives a stream of volatile and noisy noxious signals, which are also auto-correlated in time. The temporal structure of these signals is important, because the human brain has evolved the exceptional ability to extract regularities from streams of auto-correlated sensory signals, a process called statistical learning [<xref ref-type="bibr" rid="c1">1</xref>–<xref ref-type="bibr" rid="c7">7</xref>]. In the context of pain, statistical learning can allow the brain to predict future pain, which is crucial for orienting behaviour and maximising well-being [<xref ref-type="bibr" rid="c8">8</xref>, <xref ref-type="bibr" rid="c9">9</xref>]. Statistical learning might also be fundamental to the ability of the nervous system to endogenously regulate pain. Indeed, statistical learning generates predictions about forthcoming pain. We already know that pain expectations can modulate pain levels by gating the reciprocal transmission of neural signals between the brain and spinal cord, as shown by previous work on placebo and nocebo effects [<xref ref-type="bibr" rid="c10">10</xref>–<xref ref-type="bibr" rid="c14">14</xref>].</p>
<p>By using temporal sequences of noxious inputs, we have previously shown that the pain system supports the statistical learning of the basic rate of getting pain by engaging both somatosensory and supramodal cortical regions [<xref ref-type="bibr" rid="c8">8</xref>]. Specifically, both sensorimotor cortical regions and the ventral striatum encode probabilistic predictions about pain intensity, which are updated as a function of learning by engaging parietal and prefrontal regions. According to a Bayesian inference framework, both the predictive inference and its confidence should, in principle, modulate the neural response to noxious inputs and affect perception, as a function of learning. In support of this conjecture, there is evidence that the confidence of probabilistic pain predictions modulates the cortical response to pain [<xref ref-type="bibr" rid="c9">9</xref>]. The relationship is inverse: the lower the confidence, the higher is the early cortical response to noxious inputs (and viceversa), as measured by EEG. This is expected based on Bayesian inference theory: when confidence is low, the brain relies less on his prior beliefs and more on sensory evidence to respond to the input. Bayesian inference theory also predicts that prior expectations and their confidence scale perception [<xref ref-type="bibr" rid="c15">15</xref>]. Thus, we hypothesise that the predictions generated by learning the statistics of noxious inputs in dynamically evolving sequences of stimuli modulate the perception of forthcoming inputs.</p>
<p>Previously, it was found that pain perception is strongly influenced by probabilistic expectations as defined by a cue that predicts high or low pain [<xref ref-type="bibr" rid="c16">16</xref>]. In contrast to such cue-paradigm, the primary aim of our experiment was to determine whether the expectations participants hold about the sequence itself inform their perceptual beliefs about the intensity of the stimuli. To that end, we recruited 27 healthy participants to complete a psycho-physical experiment where we delivered four different, 80-trial-long sequences of evolving thermal stimuli, with four levels of temporal regularity. On each trial, a 2s thermal stimulus was applied, following which participants were asked to either rate their perception of the intensity (<xref rid="fig1" ref-type="fig">Figure 1A</xref>) or to predict the intensity of the next stimulus in the sequence (<xref rid="fig1" ref-type="fig">Figure 1B</xref>). Participants also reported their response confidence.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><title>Task design.</title>
<p>On each trial, each participant received a thermal stimulus lasting 2s from a sequence of intensities. This was followed by a perception (<bold>A</bold>) or a prediction (<bold>B</bold>) input screen, where the y-axis indicates the level of perceived/predicted intensity (0-100) centred around participant’s pain threshold, and the x-axis indicates the level of confidence in one’s perception (0-1). The inter-stimulus interval (ISI; black screen) lasted 2.5s (trial example in <bold>C</bold>). <bold>D</bold>: Example intensity sequences are plotted in green, participant’s perception and prediction responses are in red and black. <bold>E</bold>: Participant’s confidence rating for perception (red) and prediction (black) trials.</p></caption>
<graphic xlink:href="23287656v3_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We contrasted four models of statistical learning, which varied according to the inference strategy used (i.e., optimal Bayesian inference or a heuristic) and the role of expectations on perception. All models used confidence ratings to weight the inference. We anticipate that probabilistic learning weighted by confidence and expectations modulates pain perception. This provides behavioural evidence for a link between learning and endogenous pain regulation. One reason why this is important is that it might help understand individual differences in the ability to endogenously regulate pain. This is particularly relevant for chronic pain, given that endogenous pain regulation can be dysfunctional in several chronic pain conditions [<xref ref-type="bibr" rid="c17">17</xref>–<xref ref-type="bibr" rid="c21">21</xref>], even before chronic pain develops [<xref ref-type="bibr" rid="c22">22</xref>]. Although there is ample evidence for changes in the functional anatomy and connectivity of endogenous pain modulatory systems in chronic pain, their computational mechanisms are poorly understood.</p>
</sec>
<sec id="s2">
<label>2</label>
<title>Results</title>
<sec id="s2a">
<label>2.1</label>
<title>Model-naive performance</title>
<p>Prior to modelling, we first checked whether participant’s performance in the task was affected by the level of temporal regularity, i.e. the sequence condition. We varied the level of volatility and stochasticity across blocks (i.e. conditions), whilst we fixed their overall level within each block; the level of volatility was defined by the number of trials until the mean intensity level changes. The stochasticity is the additional noise that is added on each trial to the underlying mean, often referred to as the observation noise. The changes were often subtle and participants were not informed when they happened. We set two levels (low/high) of each type of uncertainty, achieving a 2x2 factorial design, with the order of conditions randomised across participants. A set of four example sequences of thermal intensities delivered to one of the participant’s can be found in <xref rid="fig1" ref-type="fig">Figure 1C</xref>, alongside their ratings of perception and predictions. Additionally, example confidence ratings for each type of response are plotted in <xref rid="fig1" ref-type="fig">Figure 1D</xref>. Figures S2-3 show the plots of each participant’s responses superimposed onto the sequences of noxious inputs.</p>
<p>As a measure of performance, we calculated the root mean squared error (RMSE) of participants responses (ratings and predictions) compared to the normative noxious input for each condition as in <xref rid="fig2" ref-type="fig">Figure 2</xref> (see also Methods). The lower the RMSE, the more accurate participants’ responses are. Performance in different conditions was analysed with a repeated measures ANOVA, whose results are reported in full in Table S1. Although volatility did not affect rating accuracy (<italic>F</italic>(1, 26) = 0.96, <italic>p</italic> = 0.336, <inline-formula><inline-graphic xlink:href="23287656v3_inline1.gif" mimetype="image" mime-subtype="gif"/></inline-formula>), we found a 2-way interaction between the level of stochasticity of the sequence (low, high) and the type of rating provided (perceived intensity vs. prediction) (<italic>F</italic>(1, 26) = 29.842, <italic>p &lt;</italic> 0.001, <inline-formula><inline-graphic xlink:href="23287656v3_inline2.gif" mimetype="image" mime-subtype="gif"/></inline-formula>). We followed up this interaction in post-hoc comparisons, as reported in Table S2. The performance score differences between all the pairs of stochasticity and response type interactions were significant, apart from the perception ratings in the stochastic environment as compared with perception and prediction performance in the low stochastic setting. Intuitively, the RMSE score analysis revealed an overall trend of participants performing worse on the prediction task, in particular when the</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><p>Participant’s model-naive performance in the task. Violin plots of participant Root Mean Square Error (RMSE) for each condition for <bold>A</bold>: rating and <bold>B</bold>: prediction responses as compared with the input.</p></caption>
<graphic xlink:href="23287656v3_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
<sec id="s2b">
<label>2.2</label>
<title>Modelling strategy</title>
<p>Our models were selected a-priori, following the modelling strategy from [<xref ref-type="bibr" rid="c23">23</xref>] and hence considered the same set of core models for clear extension of the analysis to our non-cue paradigm. The key question for us was whether expectations were used to weight the behavioural estimates during sequence learning. Therefore, we compared Bayesian and non-Bayesian models of sequential learning that weighted their ratings based on prior expectations versus two corresponding models that assumed perfect perception (i.e. not weighted by prior beliefs). As a baseline, we included a random-response model (please see Methods for a formal treatment of the computational models).</p>
<p>According to an optimal Bayesian inference strategy, on each trial, participants update their beliefs about the feature of interest (thermal stimuli) based on probabilistic inference, maintaining a full posterior distribution over its values [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c24">24</xref>]. Operating within a Bayesian paradigm, participants are assumed to track and, following new information, update both the mean of the sequence of interest and the uncertainty around it [<xref ref-type="bibr" rid="c25">25</xref>]. In most cases, such inference makes an assumption about environmental dynamics. For example, a common assumption is that the underlying mean (a hidden/latent state) evolves linearly according to a Gaussian random walk, with the rate of this evolution defined by the the variance of this Gaussian walk (volatility). The observed value is then drawn from another Gaussian with that mean, which has some observation noise (stochasticity). In this case, the observer can infer the latent states through the process of Bayesian filtering [<xref ref-type="bibr" rid="c24">24</xref>], using the Kalman Filter (KF) algorithm [<xref ref-type="bibr" rid="c26">26</xref>] (<xref rid="fig3" ref-type="fig">Figure 3B</xref>).</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><title>Expectation weighted models.</title>
<p>Computational models used in the main analysis to capture participants’ pain perception <inline-formula><inline-graphic xlink:href="23287656v3_inline14.gif" mimetype="image" mime-subtype="gif"/></inline-formula> and prediction <inline-formula><inline-graphic xlink:href="23287656v3_inline15.gif" mimetype="image" mime-subtype="gif"/></inline-formula> ratings. Both types of ratings are affected by confidence rating (<italic>C</italic><sub><italic>t</italic></sub>) on each trial. <bold>A</bold>) In the Reinforcement Learning model, participant’s pain perception (<italic>P</italic><sub><italic>t</italic></sub>) is taken to be weighted sum of the current noxious input (<italic>N</italic><sub><italic>t</italic></sub>) and their current pain expectation (<italic>E</italic><sub><italic>t</italic></sub>). Following the noxious input, participant updates their pain expectation (<italic>E</italic><sub><italic>t</italic>+1</sub>). (<bold>B</bold>) In the Kalman Filter model, a generative model of the environment is assumed (yellow background) - where the mean pain level (<italic>x</italic><sub><italic>t</italic></sub>) evolves according to a Gaussian random walk (volatility <italic>v</italic><sup>2</sup>). The true pain level on each trial (<italic>π</italic><sub><italic>t</italic></sub>) is then drawn from a Gaussian (stochasticity <italic>s</italic><sup>2</sup>). Lastly, the noxious input, <italic>N</italic><sub><italic>t</italic></sub>, is assumed an imperfect indicator of the true pain level (subjective noise <italic>ε</italic><sup>2</sup>). Inference and prediction steps are depicted in a blue box. Participant’s perceived pain is a weighted sum of expectation about the pain level (<italic>m</italic><sub><italic>t</italic></sub>) and current noxious input (<italic>N</italic><sub><italic>t</italic></sub>). Following each observation, <italic>N</italic><sub><italic>t</italic></sub>, participant updates their expectation about the pain level (<italic>m</italic><sub><italic>t</italic>+1</sub>).</p></caption>
<graphic xlink:href="23287656v3_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Sequence learning can also be captured by a heuristic to the Bayesian inference, i.e. a simple reinforcement learning (RL) rule. Here, participants maintain and update a point-estimate of the expected value of the sequence in an adaptive manner, within a non-stationary environment. RL explicitly involves correcting the tracked mean of the sequence proportionally to a trial-by-trial prediction error (PE) - a difference between the expected and actual value of the sequence [<xref ref-type="bibr" rid="c27">27</xref>] (<xref rid="fig3" ref-type="fig">Figure 3A</xref>). Importantly, RL agents do not assume any specific dynamics of the environment and hence are considered model-free.</p>
<p>Both models perform a form of error correction about the underlying sequence. The rate at which this occurs is captured by the learning rate <italic>α</italic> ∈ [0, <xref ref-type="bibr" rid="c1">1</xref>] element. The higher the learning rate, the faster participants update their beliefs about the sequence after each observation. For the RL model, the learning rate <italic>α</italic> is a free parameter that is constant across the trials. On the other hand, the learning rate in the KF model <italic>α</italic><sub><italic>t</italic></sub> (known as the Kalman gain) is calculated on every trial. It depends on participants’ trial-wise belief uncertainty as well as their overall estimation of the inherent noise in the environment (stochasticity, <italic>s</italic>). The belief uncertainty is updated after each observation and depends on participants sense of volatility (<italic>v</italic>) and stochasticity (<italic>s</italic>) in the environment.</p>
<p>Crucially, we also used participants’ trial-by-trial confidence ratings to measure to what extent confidence plays a role in learning. This is captured by the confidence scaling factor <italic>C</italic>, which defines the extent to which confidence affects response (un-)certainty. Intuitively, the higher the confidence scaling factor <italic>C</italic>, the less important role confidence plays in participant’s response. With relatively low values of <italic>C</italic>, when the confidence is low, participants responses are more noisy, i.e. less certain. We demonstrate this in <xref rid="fig4" ref-type="fig">Figure 4</xref> by plotting hypothetical responses (A-F) and the effect on the noise scaling (G-L) as a function of <italic>C</italic> and confidence ratings.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><title>Confidence scaling factor demonstration.</title>
<p><bold>A-F</bold>: For a range of values of the confidence scaling factor <italic>C</italic>, we simulated a set of typical responses a participant would make for various levels of confidence ratings. The belief about the mean of the sequence is set at 50, while the response noise at 10. The confidence scaling factor <italic>C</italic> effectively scales the response noise, adding or reducing response uncertainty. <bold>G-L</bold>: The effect of different levels of parameter <italic>C</italic> on noise scaling. As <italic>C</italic> increases the effect of confidence is diminished.</p></caption>
<graphic xlink:href="23287656v3_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To evaluate the effect of expectation on perceived intensity (on top of statistical learning modulating perception), we expanded the standard RL and KF models by adding a perceptual weighting element, <italic>γ</italic> ∈ [0, <xref ref-type="bibr" rid="c1">1</xref>] (similarly to [<xref ref-type="bibr" rid="c16">16</xref>]). Essentially, <italic>γ</italic> governs how much each participant relies on the normative input on each trial, and how much their expectation of the input influences their reported perception - i.e. they take a weighted average of the two. The higher the <italic>γ</italic>, the bigger the impact of the expectation on perception. Again, in the case of the Reinforcement Learning model (eRL - expectation weighted RL), <italic>γ</italic> is a free parameter that is constant across trials, while in the Kalman Filter model (eKF - expectation weighted KF), <italic>γ</italic><sub><italic>t</italic></sub> is calculated on every trial and depends on: (1) the participants’ trial-wise belief uncertainty, (2) their overall estimation of the inherent noise in the environment (stochasticity, <italic>s</italic>) and (3) the participant’s subjective uncertainty about the level of intensity, <italic>ε</italic>.</p>
<p>Thus, in total we tested 5 models: RL and KF (perception not-weighted by expectations), eRL and eKF (per-ception weighted by expectations), and a baseline random model. We then proceeded to fit these 5 computational models to participants’ responses. For parameter estimation, we used hierarchical Bayesian methods, where we obtained group- and individual-level estimates for each model parameter (see Methods).</p>
</sec>
<sec id="s2c">
<label>2.3</label>
<title>Modelling results</title>
<p>We fit each model for each condition sequence. Example trial-by-trial model prediction plots from one participant can be found in Figure S4. To establish which of the models fitted the data best, we ran model comparison analysis based on the difference in expected log point-wise predictive density (ELPD) between models. The models are ranked according to the ELPD (with the largest providing the best fit). The ratio between the ELPD difference and the standard error around it provides a significance test proxy through the sigma effect. We considered at least a 2 sigma effect as indication of a significant difference. In each condition, the expectation weighted models (eKF and eRL) provided better fit than models without this element (KF and RL; approx. 2-4 sigma difference, as reported in <xref rid="fig5" ref-type="fig">Figure 5A-D</xref>) and Table S5. This suggests that regardless of the levels of volatility and stochasticity, participants still weigh perception of the stimuli with their expectation. In particular, we found that the expectation-weighted KF model offered a better fit than the eRL, although in conditions of high stochasticity this difference was short of significance against the eRL model. This suggests that in learning about temporal regularities in the sequences of thermal stimuli, participants’ expectations modulate the perception of the stimulus. Moreover, this process was best captured by a model that updates the observer’s belief about the mean and the uncertainty of the sequence in a Bayesian manner.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><p>Model comparison for each sequence condition (<bold>A-D</bold>). The dots indicate the ELPD difference between the winning model (eKF) every other model. The line indicates the standard error (SE) of the difference. The non-winning models’ ELPD differences are annotated with the ratio between the ELPD difference and SE indicating the sigma effect, a significance heuristic.</p></caption>
<graphic xlink:href="23287656v3_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>We also found that as the confidence in the response decreases, the response uncertainty is scaled linearly with a negative slope ranging between 0.112-0.276 across conditions (<xref rid="fig6" ref-type="fig">Figure 6</xref>), confirming the intuition that less confidence leads to bigger uncertainty.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><p>(<bold>A-D</bold>): The effect of the confidence scaling factor on noise scaling for each condition. Each coloured line corresponds to one participant, with the black line indicating the mean across all participants. The mean slope for each condition is annotated.</p></caption>
<graphic xlink:href="23287656v3_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>As an additional check, for each participant, condition and response type (perception and prediction), we plotted participants’ ratings against model predicted ratings and calculated a grand mean correlation in Figure S5. Next, we checked whether the parameters of the the winning eKF model differed across different sequence conditions. Given that volatility was fixed within condition, we treated it as a single-context scenario from the point of view of modelling [<xref ref-type="bibr" rid="c28">28</xref>], and we did not interpret its effect on the learning rate [<xref ref-type="bibr" rid="c29">29</xref>]. There were no differences for the group-level parameters; i.e., we did not detect significant differences between conditions in a hypothetical healthy participant group as generalised from our population of participants (Figure S12).</p>
<p>However, we found some differences at the individual-level of parameters (i.e. within our specific population of recruited participants), which we detected by performing repeated-measures ANOVAs (see Figure S13 for visualisation). The stochasticity parameter <italic>s</italic> was affected by the interaction between the levels of stochasticity and volatility (<italic>F</italic>(1, 26) = 35.108, <italic>p &lt;</italic> 0.001, <inline-formula><inline-graphic xlink:href="23287656v3_inline3.gif" mimetype="image" mime-subtype="gif"/></inline-formula>), and was higher in highly stochastic and volatile conditions as compared to conditions where either volatility (<italic>t</italic> = 7.735, <italic>p</italic><sub><italic>bon f</italic></sub> <italic>&lt;</italic> 0.001), stochasticity (<italic>t</italic> = 9.396, <italic>p</italic><sub><italic>bon f</italic></sub> <italic>&lt;</italic> 0.001) or both were low (<italic>t</italic> = 8.826, <italic>p</italic><sub><italic>bon f</italic></sub> <italic>&lt;</italic> 0.001). This suggests that, while participants’ performance was generally worse in highly stochastic environments, participants seem to have attributed this to only one source - stochasticity (<italic>s</italic>), regardless of the source of higher uncertainty in the sequence (stochasticity or volatility).</p>
<p>The response noise <italic>ξ</italic> was modulated by the level of volatility (<italic>F</italic>(1, 26) = 5.079, <italic>p</italic> = 0.033, <inline-formula><inline-graphic xlink:href="23287656v3_inline4.gif" mimetype="image" mime-subtype="gif"/></inline-formula>), where it was smaller in highly volatile conditions. Moreover, we detected a significant interaction between volatility and stochasticity on the confidence scaling factor <italic>C</italic> (<italic>F</italic>(1, 26) = 81.258, <italic>p &lt;</italic> 0.001, <inline-formula><inline-graphic xlink:href="23287656v3_inline5.gif" mimetype="image" mime-subtype="gif"/></inline-formula>), where the values <italic>C</italic> were overall lower when either volatility (<italic>t</italic> = −11.570, <italic>p</italic><sub><italic>bon f</italic></sub> <italic>&lt;</italic> 0.001), stochasticity (<italic>t</italic> = −6.165, <italic>p</italic><sub><italic>bon f</italic></sub> <italic>&lt;</italic> 0.001) or both (<italic>t</italic> = − 4.575, <italic>p</italic><sub><italic>bon f</italic></sub> <italic>&lt;</italic> 0.001) were high as compared to the conditions where both levels of noise were low. This indicates there may have been some trade-off between <italic>ξ</italic> and <italic>C</italic>, as lower values of <italic>C</italic> introduce additional uncertainty when participant’s confidence is low.</p>
<p>Lastly, we found the initial uncertainty belief <italic>w</italic><sub>0</sub> was affected by the interaction between volatility and stochasticity (<italic>F</italic>(1, 26) = 5275.367, <italic>p &lt;</italic> 0.001, <inline-formula><inline-graphic xlink:href="23287656v3_inline6.gif" mimetype="image" mime-subtype="gif"/></inline-formula>) without a consistent pattern. All the other effects were not significant.</p>
<p>In summary, we formalised the process behind pain perception and prediction in noxious time-series within the framework of sequential learning, where the best description of participants’ statistical learning was captured through Bayesian filtering, in particular using a confidence-weighted Kalman Filter model. Most importantly, we discovered that, in addition to weighing their responses with confidence, participants used their expectations about stimulus intensity levels to form a judgement as to what they perceived. This mechanism was present across various levels of uncertainty that defined the sequences (volatility and stochasticity).</p>
</sec>
</sec>
<sec id="s3">
<label>3</label>
<title>Discussion</title>
<p>Statistical learning allows the brain to extract regularities from streams of sensory inputs and is central to perception and cognitive function. Despite its fundamental role, it has often been overlooked in the field of pain research. Yet, chronic pain appears to fluctuate over time. For instance, [<xref ref-type="bibr" rid="c30">30</xref>–<xref ref-type="bibr" rid="c32">32</xref>] reported that chronic back pain ratings vary periodically, over several seconds-minutes and in absence of movements. This temporal aspect of pain is important because periodic temporal structures are easy to learn for the brain [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c8">8</xref>]. If the temporal evolution of pain is learned, it can be used by the brain to regulate its responses to forthcoming pain, effectively shaping how much pain it experiences. Indeed, we show that healthy participants extract temporal regularities from sequences of noxious stimuli and use this probabilistic knowledge to form confidence-weighted judgements and predictions about the level of pain intensity they experience in the sequence. We formalised our results within a Bayesian inference framework, where the belief about the level of pain intensity is updated on each trial according to the the amount of uncertainty participants ascribe to the stimuli and the environment. Importantly, their perception and prediction of pain were influenced by the expected level of intensity that participants held about the sequence before responding. When varying different levels of inherent uncertainty in the sequences of stimuli (stochasticity and volatility), the expectation and confidence weighted models fitted the data better than models weighted for confidence but not for expectations (<xref rid="fig5" ref-type="fig">Figure 5A-D</xref>). The expectation-weighted bayesian (KF) model offered a better fit than the expectation-weighted, model-free RL model, although in conditions of high stochasticity this difference was short of significance. Overall, this suggests that participants’ expectations play a significant role in the perception of sequences of noxious stimuli.</p>
<sec id="s3a">
<label>3.1</label>
<title>Statistical inference and learning in pain sequences</title>
<p>The first main contribution of our work is towards the understanding of the phenomenon of statistical learning in the context of pain. Statistical learning is an important function that the brain employs across the lifespan, with relevance to perception, cognition and learning [<xref ref-type="bibr" rid="c6">6</xref>]. The large majority of past research on statistical learning focused on visual and auditory perception [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c3">3</xref>, <xref ref-type="bibr" rid="c4">4</xref>, <xref ref-type="bibr" rid="c33">33</xref>], with the nociceptive system receiving relatively little attention [<xref ref-type="bibr" rid="c34">34</xref>]. Recently, we showed that the human brain can learn to predict a sequence of two pain levels (low and high) in a manner consistent with optimal Bayesian inference, by engaging sensorimotor regions, parietal, premotor regions and dorsal striatum [<xref ref-type="bibr" rid="c8">8</xref>]. We also found that the confidence of these probabilistic inferences modulates the cortical response to pain, as expected by hierarchical Bayesian inference theory [<xref ref-type="bibr" rid="c9">9</xref>]. Here we tested sequences with a much larger range of stimulus intensities to elucidate the effect of statistical learning and expectations on pain perception. As predicted by hierarchical Bayesian inference theory, we find that the pain intensity judgements are scaled by both expectations and confidence.</p>
<p>Hence, our work highlights the inferential nature of the nociceptive system [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c34">34</xref>–<xref ref-type="bibr" rid="c37">37</xref>], where in addition to the sheer input received by the nociceptors, there is a wealth of a priori knowledge and beliefs the agent holds about themselves and the environment that need to be integrated to form a judgement about pain [<xref ref-type="bibr" rid="c38">38</xref>–<xref ref-type="bibr" rid="c41">41</xref>]. This has an immediate significance for the real world, where weights need to be assigned to prior beliefs and/or stimuli to successfully protect the organism from further damage, but only to an extent to which it is beneficial.</p>
<p>Secondly, our results regarding the effect of expectation on pain perception relate to a much larger literature on this topic. The prime example would be placebo analgesia (i.e. the expectation of pain relief decreasing pain perception) and nocebo hyperalgesia (i.e. the expectation of high level of pain increasing its perception; [<xref ref-type="bibr" rid="c10">10</xref>, <xref ref-type="bibr" rid="c37">37</xref>, <xref ref-type="bibr" rid="c42">42</xref>, <xref ref-type="bibr" rid="c43">43</xref>]. Recent work attempted to capture such expectancy effects within the Bayesian inference framework. For example, [<xref ref-type="bibr" rid="c25">25</xref>] showed that in addition to expectation influencing perceived pain in general, higher level of uncertainty around that expectation attenuated its effect on perception. Similarly, [<xref ref-type="bibr" rid="c44">44</xref>] demonstrated that when the discrepancy between the expectation and outcome (prediction error) is unusually large, the role of expectation is significantly reduced and so the placebo and nocebo effects are not that strong. An unusually large prediction error could be thought of as contributing to increased uncertainty about the stimuli, which mirrors the results from [<xref ref-type="bibr" rid="c25">25</xref>] Bayesian framework. Nevertheless, the types of stimuli used in the above studies (i.e. noxious stimuli cued by non-noxious stimuli) differed from the more ecologically valid sequences of pain that are reported by chronic pain patients [<xref ref-type="bibr" rid="c30">30</xref>], as we indicated above. Furthermore, [<xref ref-type="bibr" rid="c16">16</xref>] used a conditioning paradigm and also found that expectations influence both perception and learning, in a self-reinforcing loop. Our work has followed a similar modelling strategy to [<xref ref-type="bibr" rid="c16">16</xref>], but it goes beyond simple conditioning schedules or sequences of two-level discrete painful stimuli, showing expectancy effects even when the intensities are allowed to vary across a wider range of values and according to more complex statistical temporal structures. Additionally, given the reported role of confidence in the perception of pain [<xref ref-type="bibr" rid="c9">9</xref>, <xref ref-type="bibr" rid="c45">45</xref>], we draw a more complete picture by including participants confidence ratings in our modelling analysis.</p>
<p>Future studies would need to determine whether statistical learning and its effect on pain is altered in chronic pain conditions. This is important because statistical learning could, in principle, influence how a pain state evolves. Once a pain state is initiated, how an individual learns and anticipates the fluctuating pain signals may contribute to determine how well it can be regulated by the nervous system, thus affecting the severity and recurrence of pain flares. This, in turn, would affect whether aversive associations with the instigating stimulus are extinguished or reinforced [<xref ref-type="bibr" rid="c36">36</xref>]. In chronic pain, dysfunctional learning may promote the amplification and maintenance of pain signals, contributing to the reinforcement of aversive associations with incident stimuli, as well as the persistence of pain [<xref ref-type="bibr" rid="c46">46</xref>–<xref ref-type="bibr" rid="c48">48</xref>].</p>
<p>Our paper comes with open tools, which can be adapted in future studies on statistical learning in chronic pain. The key advantage of taking an hypothesis-driven, computational-neuroscience approach to quantify learning is that it allows to go beyond symptoms-mapping, identifying the quantifiable computational principles that mediate the link between symptoms and neural function.</p>
<p>In summary, we show that statistical expectations and confidence scale the judgement of pain in sequences of noxious stimuli as predicted by hierarchical Bayesian inference theory, opening a new avenue of research on the role of learning in pain.</p>
</sec>
</sec>
<sec id="s4">
<label>4</label>
<title>Materials and methods</title>
<sec id="s4a">
<label>4.1</label>
<title>Participants</title>
<p>Thirty-three (18 female) healthy adult participants were recruited for the experiment. The mean age of participants was 22.4 ± 2.7 years old (range: 18-35). Participants had no chronic condition and no infectious illnesses, as well as no skin conditions (e.g. eczema) at the site of stimulus delivery. Moreover, we only recruited participants that had not taken any anti-anxiety, anti-depressive medication, nor any illicit substances, alcohol and pain medication (including NSAIDs such as ibuprofen and paracetamol) in the 24 hours prior to the experiment. All participants gave informed written consent to take part in the study, which was approved by the local ethics committee.</p>
</sec>
<sec id="s4b">
<label>4.2</label>
<title>Protocol</title>
<p>The experimental room’s temperature was maintained between 20°C to 23°C. Upon entry, an infrared thermometer was used to ensure participants temperature was above 36°C at the forehead and forearm of the non-dominant hand, to account for the known effects of temperature on pain perception [<xref ref-type="bibr" rid="c49">49</xref>]. A series of slideshows were presented, which explained the premise of the experiment and demonstrated what the participant would be asked to carry out. Throughout this presentation, questions were asked to ensure participants understood the task. Participants were given multiple opportunities to ask questions throughout the presentation.</p>
<p>We used the Medoc Advanced Thermosensory Stimulator 2 (TSA2) [<xref ref-type="bibr" rid="c50">50</xref>] to deliver thermal stimuli using the CHEPS thermode. The CHEPS thermode allowed for rapid cooling (40°C / sec) and heating (70°C / sec) so transitions between the baseline and stimuli temperatures were minimal. The TSA2 was controlled externally, via Matlab (Mathworks).</p>
<p>We then established the pain threshold, using the method of limits [<xref ref-type="bibr" rid="c51">51</xref>], in order to centre the range of temperature intensities used in the experiment. Each participant was provided with stimuli of increasing temperature, starting from 40°C going up in 0.5°C increments, using an inter-stimulus interval (ISI) of 2.5 sec and and a 2 sec duration. The participant was asked to indicate when the stimuli went from warm to painful - this temperature was noted and the stimuli ended. The procedure was repeated three times, and the average was used as an estimate of the pain threshold.</p>
<p>During the experiment, four sequences of thermal stimuli were delivered. Due to the phenomenon of offset analgesia (OA), where decreases in tonic pain result in a proportionally larger decrease in perceived pain [<xref ref-type="bibr" rid="c52">52</xref>], we chose phasic stimuli, with a duration of 2 sec and an inter-stimulus-interval (ISI) 2.5 seconds. In order to account for individual differences, the temperatures which the levels refer to are based upon the participants threshold.</p>
<p>The median intensity level was defined as threshold, giving a max temperature of 3°C above threshold, which was found to be acceptable by participants. Before the start of the experiment each participant was provided with the highest temperature stimuli that could be presented, given their measured threshold, to ensure they where comfortable with this. Two participants found the stimulus too painful - the temperature range was lowered by 1°C and this was found to be acceptable.</p>
<p>After every trial of each sequence, the participant was asked for either their perception of the previous stimulus, or their prediction for the next stimulus through a 2D VAS (<xref rid="fig1" ref-type="fig">Figure 1B</xref>), presented using PsychToolBox-3 [<xref ref-type="bibr" rid="c53">53</xref>]. The y-axis encodes the intensity of the stimulus either perceived or predicted, ranging from 0 (no heat detected/predicted) to 100 (worst pain imaginable perceived/predicted); on this scale, 50 represents the pain threshold. This was done as a given sequence was centred around the threshold. The x-axis encodes confidence in either perception or prediction, ranging from 0 - completely uncertain (‘unsure’) - to 1 - complete confidence in the rating (‘sure’). Differing background colours were chosen to ensure participants were aware of what was being asked, and throughout the experiment participants were reminded to take care in answering the right question. The mouse movement was limited to be inside of the coloured box, which defined the area of participants’ input. At the beginning of each input screen, the mouse location was uniformly randomised within the input box.</p>
<p>The sequence of response types was randomised so as to retain 40 prediction and 40 perception ratings for each of the four sequence conditions. For an 80-trial long sequence, this gave 80 participant responses. Each sequence condition was separated by a 5 minute break, during which the thermode’s probe was slightly moved around the area of skin on the forearm to reduce sensitisation (i.e. a gradual increase in perceived intensity with repetitive noxious stimuli) [<xref ref-type="bibr" rid="c54">54</xref>]. In the middle of each sequence, there was a 3 minute break. During the ISI, the temperature returned to a base-line of 38°C. One participant was unable to complete the sequence as their threshold was too low, and data from four participants was lost due to Medoc software issues (the remote control failed and the data of 2 out 4 sessions were not saved). We excluded one participant’s whose ratings/predictions were inversely proportional to the noxious input. Thus, we analysed data from 27 participants.</p>
<sec id="s4b1">
<label>4.2.1</label>
<title>Generative process of the painful sequences</title>
<p>We manipulated two sources of uncertainty in the sequence: the stochasticity (<italic>s</italic>) of the observation and the volatility (<italic>v</italic>) of the underlying sequence [<xref ref-type="bibr" rid="c29">29</xref>]. Sequences were defined by two levels (high or low) of stochasticity and volatility, resulting in four different sequences conditions - creating a 2x2 factorial design. Each sequence was defined as a series of chunks, where the intensity for trial <italic>t, i</italic><sub><italic>t</italic></sub> was sampled from <italic>𝒩</italic> (<italic>I, σ</italic> <sup>2</sup>), where <italic>σ</italic> <sup>2</sup> indicates the level of stochasticity (<italic>σ</italic> <sup>2</sup> = 1.75 for high level of stochasticity, <italic>σ</italic> <sup>2</sup> = 0.25 for low level of stochasticity). The mean of the chunk, <italic>I</italic>, was drawn from <italic>𝒰</italic> (3.5, 10.5). To ensure a noticeable difference in chunk intensity to the participant, concurrent chunk means were constrained to be at least 2 intensity levels different. Volatility was implemented by defining the length, or number of trials, of a chunk (<italic>l</italic>) drawn from <italic>𝒰</italic> (<italic>L a, L</italic> + <italic>a</italic>), where <italic>L</italic> is the mean o the chunk length (<italic>L</italic> = 15 for high volatility level, <italic>L</italic> = 25 for low volatility level). A jitter, <italic>a</italic>, was added around the mean to ensure the transition from one chunk to the next was not consistent or predictable. For both high and low volatility conditions we set <italic>a</italic> = 3. Sampled values were then discretised, where any intensities outside the valid intensity range [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c13">13</xref>] were discarded and re-sampled resulting in an 80-trial long sequence for each condition. The mean of each sequence was centred around intensity level 7, i.e. the participants threshold. So defined, six sets of four sequences were sampled. Each participant received one set, with a randomised sequence order. See an example sequence (after subject-specific linear transformation) and one participant’s responses (including confidence ratings) in <xref rid="fig1" ref-type="fig">Figure 1C-D</xref>.</p>
</sec>
</sec>
<sec id="s4c">
<label>4.3</label>
<title>Data pre-processing</title>
<p>Since the intensity values of the noxious input were discretised between 1 and 13, while the participant’s responses (perception and prediction) were given on a 0-100 scale, we applied a linear transformation of the input to map its values onto a common 0-100 range. For each participant, for a set of inputs at perception trials from the concatenated sequence (separate sequence conditions in the order as presented), we fit a linear least-squares regression using Python’s <monospace>scipy.stats.linregress</monospace> function. On rare occasions, when the transformed input was negative, we refit the line using Python’s non-linear least squares function <monospace>scipy.optimize.curve_fit</monospace>, constraining the intercept above 0 [<xref ref-type="bibr" rid="c55">55</xref>]. We then extracted each participant’s optimised slope and intercept and applied the transformation both to the concatenated and condition-specific sequence of inputs. So transformed, the sequences where then used in all the analyses. Plots of each participant transformation can be found in Figure S1. We superimposed participant’s responses onto the noxious input condition sequences in Figure S2.</p>
<p>To capture participant’s model-naive performance in the task, both for the concatenated and condition-specific sequence, we calculated Root Mean Square Error (RMSE) of each participant’s perception (<xref ref-type="disp-formula" rid="eqn1">Eq. 1</xref>) and pre-diction (<xref ref-type="disp-formula" rid="eqn2">Eq. 2</xref>) responses as compared to the input. The lower the RMSE, the higher the response accuracy.
<disp-formula id="eqn1">
<graphic xlink:href="23287656v3_eqn1.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn2">
<graphic xlink:href="23287656v3_eqn2.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>T</italic><sub><italic>P</italic></sub> is the number of perception trials, <inline-formula><inline-graphic xlink:href="23287656v3_inline7.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is participant’s perception response to the stimulus <italic>y</italic><sub><italic>t</italic></sub> at trial <italic>t, T</italic><sub><italic>E</italic></sub> is the number of prediction trials and <inline-formula><inline-graphic xlink:href="23287656v3_inline8.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is participant’s prediction of the next stimulus intensity <italic>y</italic><sub><italic>t</italic>+1</sub> at at trial <italic>t</italic> + 1.</p>
</sec>
<sec id="s4d">
<label>4.4</label>
<title>Models</title>
<sec id="s4d1">
<label>4.4.1</label>
<title>Reinforcement Learning</title>
<sec id="s4d1a">
<title>RL</title>
<p>In reinforcement learning models, learning is driven by discrepancies between the estimate of the expected value and observed values. Before any learning begins, at trial <italic>t</italic> = 1, participants have an initial expectation, <italic>E</italic><sub>1</sub> = <italic>E</italic><sub>0</sub>, which is a free parameter that we estimate.</p>
<p>On each trial, participants receive a thermal input <italic>N</italic><sub><italic>t</italic></sub>. We then calculate the prediction error <italic>δ</italic><sub><italic>t</italic></sub>, defined as the difference between the expectation <italic>E</italic><sub><italic>t</italic></sub> and the input <italic>N</italic><sub><italic>t</italic></sub> (<xref ref-type="disp-formula" rid="eqn3">Eq. 3</xref>).
<disp-formula id="eqn3">
<graphic xlink:href="23287656v3_eqn3.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Participant is then assumed to update their expectation of the stimulus on the next trial as in <xref ref-type="disp-formula" rid="eqn4">Eq. 4</xref>
<disp-formula id="eqn4">
<graphic xlink:href="23287656v3_eqn4.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>α</italic> is the learning rate (free parameter), which governs how fast participants assimilate new information to update their belief.</p>
<p>On trials when participants rate their perceived intensity, we assume no effects on their perception other than confidence rating <italic>c</italic><sub><italic>t</italic></sub> and response noise, so participants perception response <inline-formula><inline-graphic xlink:href="23287656v3_inline9.gif" mimetype="image" mime-subtype="gif"/></inline-formula> is drawn from a Gaussian distribution, with the mean <italic>P</italic><sub><italic>t</italic></sub> = <italic>N</italic><sub><italic>t</italic></sub> and a confidence-scaled response noise <italic>ξ</italic> (free parameter), as in <xref ref-type="disp-formula" rid="eqn5">Eq. 5</xref>
<disp-formula id="eqn5">
<graphic xlink:href="23287656v3_eqn5.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>C</italic> is the confidence scaling factor (free parameter), which defines the extent to which confidence affects response uncertainty. Please, see <xref rid="fig4" ref-type="fig">Figure 4</xref> for an intuition behind confidence scaling.</p>
<p>On trials when participants are asked to predict the intensity of the next thermal stimulus, we use the updated expectation <italic>E</italic><sub><italic>t</italic>+1</sub> to model participants prediction response <inline-formula><inline-graphic xlink:href="23287656v3_inline10.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. This is similarly affected by confidence rating and response noise and is defined as in <xref ref-type="disp-formula" rid="eqn6">Eq. 6</xref>.
<disp-formula id="eqn6">
<graphic xlink:href="23287656v3_eqn6.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
To recap, the RL model has 4 free parameters: the learning rate <italic>α</italic>, response noise <italic>ξ</italic>, the initial expectation <italic>E</italic><sub>0</sub>, and the confidence scaling factor <italic>C</italic>.</p>
</sec>
<sec id="s4d1b">
<title>eRL</title>
<p>Additionally, where we investigate the effects of expectation on the perception of pain [<xref ref-type="bibr" rid="c16">16</xref>], we included an element that allows us express the perception as a weighted sum of the input and expectation (<xref ref-type="disp-formula" rid="eqn7">Eq. 7</xref>)
<disp-formula id="eqn7">
<graphic xlink:href="23287656v3_eqn7.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
where <italic>γ</italic> [0, <xref ref-type="bibr" rid="c1">1</xref>] (free parameter) captures how much participants rely on the normative thermal input vs. their expectation. When <italic>γ</italic> = 0, the expectation plays no role and the model simplifies to that of the standard RL above. In total, the eRL model has 5 free parameters, with the other equations the same as in the RL model, with the exception of the prediction error, which now relies on the expectation-weighted pain perception <italic>P</italic><sub><italic>t</italic></sub> (<xref ref-type="disp-formula" rid="eqn8">Eq. 8</xref>).
<disp-formula id="eqn8">
<graphic xlink:href="23287656v3_eqn8.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
</p>
</sec>
</sec>
<sec id="s4d2">
<label>4.4.2</label>
<title>Kalman Filter</title>
<sec id="s4d2a">
<title>KF</title>
<p>To capture sequential learning in a Bayesian manner, we used the Kalman filter model [<xref ref-type="bibr" rid="c16">16</xref>, <xref ref-type="bibr" rid="c24">24</xref>, <xref ref-type="bibr" rid="c26">26</xref>]. KF assumes a generative model of the environment where the latent state on trial t, <italic>x</italic><sub><italic>t</italic></sub> (the mean of the sequences in the experiment), evolves according to a Gaussian random walk with a fixed drift rate, <italic>v</italic> (volatility), as in <xref ref-type="disp-formula" rid="eqn9">Eq. 9</xref>.
<disp-formula id="eqn9">
<graphic xlink:href="23287656v3_eqn9.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
The observation on trial t, <italic>N</italic><sub><italic>t</italic></sub>, is then drawn from a Gaussian (<xref ref-type="disp-formula" rid="eqn10">Eq. 10</xref>) with a fixed variance, which represents the observation uncertainty <italic>s</italic> (stochasticity).
<disp-formula id="eqn10">
<graphic xlink:href="23287656v3_eqn10.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
As such the KF assumes stable dynamics since the generative process has fixed volatility and stochasticity.</p>
<p>For ease of explanation, we refer to the thermal input at each trial as <italic>N</italic><sub><italic>t</italic></sub>, we also use the <italic>N</italic><sub>1:<italic>t</italic></sub> notation, which refers to a sequence of observations up to and including trial <italic>t</italic>. The model allows to obtain posterior beliefs about the latent state <italic>x</italic><sub><italic>t</italic></sub> given the observations. This is done by tracking an internal estimate of the mean <italic>m</italic><sub><italic>t</italic></sub> and the uncertainty, <italic>w</italic><sub><italic>t</italic></sub>, of the latent state <italic>x</italic><sub><italic>t</italic></sub>.</p>
<p>First, following standard KF results, on each trial, the participant is assumed to hold a prior belief (indicated with <sup>(−)</sup> superscript) about the latent state, <italic>x</italic><sub><italic>t</italic></sub> (<xref ref-type="disp-formula" rid="eqn11">Eq. 11</xref>).
<disp-formula id="eqn11">
<graphic xlink:href="23287656v3_eqn11.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
On the first trial, before any observations, we set <inline-formula><inline-graphic xlink:href="23287656v3_inline11.gif" mimetype="image" mime-subtype="gif"/></inline-formula> (free parameters). In light of the new observation, <italic>N</italic><sub><italic>t</italic></sub> on trial <italic>t</italic>, the tracked mean and uncertainty of the latent state are reweighed based on the new evidence <italic>N</italic><sub><italic>t</italic></sub> and its associated observation uncertainty <italic>s</italic> as in <xref ref-type="disp-formula" rid="eqn12">Eq. 12</xref>.
<disp-formula id="eqn12">
<graphic xlink:href="23287656v3_eqn12.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
We can then define the learning rate <italic>α</italic><sub><italic>t</italic></sub> (<xref ref-type="disp-formula" rid="eqn13">Eq. 13</xref>),
<disp-formula id="eqn13">
<graphic xlink:href="23287656v3_eqn13.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
to get the update rule for the new posterior beliefs (indicated with <sup>(+)</sup> superscript) about the mean (<xref ref-type="disp-formula" rid="eqn14">Eq. 14</xref>) and uncertainty (<xref ref-type="disp-formula" rid="eqn15">Eq. 15</xref>) of <italic>x</italic><sub><italic>t</italic></sub>.
<disp-formula id="eqn14">
<graphic xlink:href="23287656v3_eqn14.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn15">
<graphic xlink:href="23287656v3_eqn15.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Following this new belief, and the assumption about the environmental dynamics (volatility), the participant forms a new prior belief about the latent state <italic>x</italic><sub><italic>t</italic>+1</sub> for the next trial <italic>t</italic> + 1 as in <xref ref-type="disp-formula" rid="eqn16">Eq. 16</xref>.
<disp-formula id="eqn16">
<graphic xlink:href="23287656v3_eqn16.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Where
<disp-formula id="eqn17">
<graphic xlink:href="23287656v3_eqn17.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn18">
<graphic xlink:href="23287656v3_eqn18.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
We can simplify the notation to make it comparable to the RL models. We let, <inline-formula><inline-graphic xlink:href="23287656v3_inline12.gif" mimetype="image" mime-subtype="gif"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="23287656v3_inline13.gif" mimetype="image" mime-subtype="gif"/></inline-formula>. Following a new observation at trial <italic>t</italic>, we calculate the prediction error (<xref ref-type="disp-formula" rid="eqn19">Eq. 19</xref>) and learning rate (<xref ref-type="disp-formula" rid="eqn20">Eq. 20</xref>).
<disp-formula id="eqn19">
<graphic xlink:href="23287656v3_eqn19.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn20">
<graphic xlink:href="23287656v3_eqn20.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
we then update the belief about the mean (<xref ref-type="disp-formula" rid="eqn21">Eq. 21</xref>) and uncertainty (<xref ref-type="disp-formula" rid="eqn22">Eq. 22</xref>) of the latent state for the next trial.
<disp-formula id="eqn21">
<graphic xlink:href="23287656v3_eqn21.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn22">
<graphic xlink:href="23287656v3_eqn22.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Now, mapping this onto the experiment, the mean of the latent state is participants expectation <italic>E</italic><sub><italic>t</italic></sub> = <italic>m</italic><sub><italic>t</italic></sub>, and so we have participant perception rating modelled as in <xref ref-type="disp-formula" rid="eqn23">Eq. 23</xref>.
<disp-formula id="eqn23">
<graphic xlink:href="23287656v3_eqn23.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
and the prediction rating for the next trial as in <xref ref-type="disp-formula" rid="eqn24">Eq. 24</xref>.
<disp-formula id="eqn24">
<graphic xlink:href="23287656v3_eqn24.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
In total the model has 6 free parameters: <italic>s</italic> (environmental stochasticity), <italic>v</italic> (environmental volatility), <italic>ξ</italic> (response noise), <italic>E</italic><sub>0</sub> (initial belief about the mean), <italic>w</italic><sub>0</sub> (initial belief about the uncertainty) and <italic>C</italic> (confidence scaling factor).</p>
</sec>
<sec id="s4d2b">
<title>eKF - expectation weighted Kalman Filter</title>
<p>We can introduce the effect of expectation on the pain perception, by assuming that participants treat the thermal input as an imperfect indicator of the true level of pain [<xref ref-type="bibr" rid="c16">16</xref>]. In this case, the input, <italic>N</italic><sub><italic>t</italic></sub>, is modelled as in <xref ref-type="disp-formula" rid="eqn25">Eq. 25</xref>
<disp-formula id="eqn25">
<graphic xlink:href="23287656v3_eqn25.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
which forms an expression for the likelihood of the observation and adds an additional level to the inference, slightly modifying the Kalman filter assumptions such that:
<disp-formula id="eqn26">
<graphic xlink:href="23287656v3_eqn26.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
However, we can apply the standard KF results and Bayes’ rule to arrive at simple update rules for the participants’ belief about the mean and uncertainty of the latent state <italic>x</italic><sub><italic>t</italic></sub>. From this, we get a prior on the <italic>π</italic><sub><italic>t</italic></sub> defined in <xref ref-type="disp-formula" rid="eqn27">Eq. 27</xref>
<disp-formula id="eqn27">
<graphic xlink:href="23287656v3_eqn27.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
which, following a new input <italic>N</italic><sub><italic>t</italic></sub>, gives us the posterior belief about <italic>π</italic><sub><italic>t</italic></sub> as in <xref ref-type="disp-formula" rid="eqn28">Eq. 28</xref>.
<disp-formula id="eqn28">
<graphic xlink:href="23287656v3_eqn28.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Now, if we define <italic>γ</italic><sub><italic>t</italic></sub> as in <xref ref-type="disp-formula" rid="eqn29">Eq. 29</xref>
<disp-formula id="eqn29">
<graphic xlink:href="23287656v3_eqn29.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
we have that the posterior belief about the mean level of pain <italic>π</italic><sub><italic>t</italic></sub> is calculated as:
<disp-formula id="eqn30">
<graphic xlink:href="23287656v3_eqn30.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
which is a weighted sum of the input <italic>N</italic><sub><italic>t</italic></sub> and participant expectation about the latent state <italic>x</italic><sub><italic>t</italic></sub>, governed by the perceptual weight <italic>γ</italic><sub><italic>t</italic></sub>, analogously to the eRL model. Finally, the posterior belief about <italic>x</italic><sub><italic>t</italic></sub> is obtained in <xref ref-type="disp-formula" rid="eqn31">Eq. 31</xref>.
<disp-formula id="eqn31">
<graphic xlink:href="23287656v3_eqn31.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Now, setting the learning rate as in <xref ref-type="disp-formula" rid="eqn32">Eq. 32</xref>
<disp-formula id="eqn32">
<graphic xlink:href="23287656v3_eqn32.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
we get:
<disp-formula id="eqn33">
<graphic xlink:href="23287656v3_eqn33.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn34">
<graphic xlink:href="23287656v3_eqn34.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
Next, following the same notation simplification as before, we get the update rules for the prior belief about the mean (<xref ref-type="disp-formula" rid="eqn35">Eq. 35</xref>) and uncertainty (<xref ref-type="disp-formula" rid="eqn36">Eq. 36</xref>) of the latent state <italic>x</italic><sub><italic>t</italic>+1</sub> for the next trial.
<disp-formula id="eqn35">
<graphic xlink:href="23287656v3_eqn35.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
<disp-formula id="eqn36">
<graphic xlink:href="23287656v3_eqn36.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
as well as the expression for subjective perception, <italic>P</italic><sub><italic>t</italic></sub>, at trial <italic>t</italic> (<xref ref-type="disp-formula" rid="eqn37">Eq. 37</xref>).
<disp-formula id="eqn37">
<graphic xlink:href="23287656v3_eqn37.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
The perception and prediction responses are modelled analogously as the KF model. In total, the model has 7 free parameters: <italic>ε</italic> (subjective noise), <italic>s</italic> (environmental stochasticity), <italic>v</italic> (environmental volatility), <italic>ξ</italic> (response noise), <italic>E</italic><sub>0</sub> (initial belief about the mean), <italic>w</italic><sub>0</sub> (initial belief about the uncertainty) and <italic>C</italic> (confidence scaling factor).</p>
</sec>
</sec>
<sec id="s4d3">
<label>4.4.3</label>
<title>Random model</title>
<p>As a baseline, we also included a model that performs a random guess. The perceptual/prediction ratings were modelled as in <xref ref-type="disp-formula" rid="eqn38">Eq. 38</xref>.
<disp-formula id="eqn38">
<graphic xlink:href="23287656v3_eqn38.gif" mimetype="image" mime-subtype="gif"/>
</disp-formula>
The model has 3 free parameters: <italic>R, ξ</italic>, and <italic>C</italic>, where <italic>R</italic> is a constant value that participants respond with.</p>
</sec>
</sec>
<sec id="s4e">
<label>4.5</label>
<title>Model fitting</title>
<p>Model parameters were estimated using hierarchical Bayesian methods, performed with RStan package (v. 2.21.0) [<xref ref-type="bibr" rid="c56">56</xref>] in R (v. 4.0.2) based on Markov Chain Monte Carlo techniques (No-U-Turn Hamiltonian Monte Carlo). For the individual level-parameters we used non-centred parametrisation [<xref ref-type="bibr" rid="c57">57</xref>]. For the group-level parameters we used <italic>𝒩</italic> (0, 1) priors for the mean, and the gamma-mixture representation of the Student-t(3,0,1) for the scale [<xref ref-type="bibr" rid="c58">58</xref>]. Parameters in the (0, 1) range were constrained using <monospace>Phi_approx</monospace> - a logistic approximation to the cumulative Normal distribution [<xref ref-type="bibr" rid="c59">59</xref>].</p>
<p>For each condition and each of the four chains, we ran 6000 samples (after discarding 6000 warm-up ones). For each condition, we examined R-hat values for each individual- (including the <italic>𝒩</italic> (0, 1) error term from the non-centred parametrisation) and group-level parameters from each model to verify whether the Markov chains have converged. At the group-level and individual-level, all R-hat values had a value <italic>&lt;</italic> 1.1, indicating convergence. In the random response model, 0.01% − 0.16% iterations saturated the maximum tree depth of 11.</p>
<sec id="s4e1">
<label>4.5.1</label>
<title>Model comparison</title>
<p>For model comparison, we used R package <monospace>loo</monospace>, which provides efficient approximate leave-one-out cross-validation. The package allows to estimate the difference in models’ expected predictive accuracy through the difference in expected log point-wise predictive density (ELPD) [<xref ref-type="bibr" rid="c60">60</xref>]. By looking at the ratio between the ELPD difference and the standard error (SE) of the difference, we get the sigma effect - a heuristic for significance of such model differences. There’s no agreed-upon threshold of SEs that determines significance, but the higher the sigma difference, the more robust is the effect. The closeness of fit can be also captured with LOO information criterion (LOOIC), where the lower LOOIC values indicate better fit.</p>
</sec>
<sec id="s4e2">
<label>4.5.2</label>
<title>Parameter comparison</title>
<p>For the comparison of group-level parameters between conditions,we extracted 95% High Density Intervals (HDI) of the permuted and merged (across chains) posterior samples of each group-level parameter [<xref ref-type="bibr" rid="c61">61</xref>]. To assess significant differences between conditions, we calculated a difference between such defined intervals. In the Bayesian scenario, a significant difference is indicated by the interval not containing the value 0 [<xref ref-type="bibr" rid="c62">62</xref>, <xref ref-type="bibr" rid="c63">63</xref>].</p>
</sec>
<sec id="s4e3">
<label>4.5.3</label>
<title>Parameter and model recovery</title>
<p>To asses the reliability of our modelling analysis [<xref ref-type="bibr" rid="c64">64</xref>], for each model we performed parameter recovery analysis, where we simulated participants’ responses using newly drawn individual-level parameters from the group-level distributions.</p>
<p>We repurposed existing sequences of noxious inputs in the [<xref ref-type="bibr" rid="c1">1</xref>, <xref ref-type="bibr" rid="c13">13</xref>] range (pre-transformation). When then applied a linear transformation to the input sequences using sampled slope and intercept coefficients from a Gaussian distribution of these coefficients that we estimated based on our dataset using R’s <monospace>fitdistrplus</monospace> package. Furthermore, we simulated the confidence ratings based on lag-1 auto-correlation across a moving window of the transformed input sequence.</p>
<p>We then fit the same model to the simulated data and calculated Pearson correlation coefficients <italic>r</italic> between the generated and estimated individual-level parameters. The higher the coefficient <italic>r</italic>, the more reliable the estimates are, which can be categorised as: poor (if r &lt;0.5); fair (if 0.5&lt; r &lt;0.75); good (0.75&lt; r &lt;0.9); excellent (if r &gt;0.9) [<xref ref-type="bibr" rid="c65">65</xref>]. Results are reported in Table S3 and Figures S6-11.</p>
<p>We also performed model recovery analysis [<xref ref-type="bibr" rid="c64">64</xref>], where we first simulated responses using each model and then fit each model-specific dataset with each model. We then counted the number of times a model fit the simulated data best (according to the LOOIC rule), effectively creating an <italic>M</italic> × <italic>M</italic> confusion matrix, where <italic>M</italic> is the number of models. In the case where we have a diagonal matrix of ones, the models are perfectly recoverable and hence as reliable as possible. Results are reported in Table S4.</p>
<p>In Tables S6-S9 we report Bulk and Tail Effective Sample Size (ESS) for each condition, for each model and parameter.</p>
</sec>
</sec>
</sec>
<sec id="d1e1944" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e2080">
<label>Supplementary information</label>
<media xlink:href="supplements/287656_file02.pdf"/>
</supplementary-material>
</sec>
</body>
<back>
<sec id="d1e1959" sec-type="data-availability">
<title>Data Availability</title>
<p>All code and data will be available open source, released upon acceptance of the paper in a peer-reviewed journal.</p>
</sec>
<sec id="s5">
<label>5</label>
<title>Data and code availability</title>
<p>All code and data will be available open source, released upon acceptance of the paper.</p>
</sec>
<ack>
<label>6</label>
<title>Ackowledgements</title>
<p>The study was funded by a MRC Career Development Award to FM (MR/T010614/1) and a UKRI Advanced Pain Discovery Platform grant to both F.M. and B.S. (MR/W027593/1). B.S. was also funded by Wellcome (214251/Z/18/Z), Versus Arthritis (21537), and IITP (MSIT 2019-0-01371). This work has been performed using resources provided by the Cambridge Tier-2 system operated by the University of Cambridge Research Computing Service (<ext-link ext-link-type="uri" xlink:href="http://www.hpc.cam.ac.uk">www.hpc.cam.ac.uk</ext-link>) funded by EPSRC Tier-2 capital grant (EP/T022159/1). HPC access was additionally funded by an EPSRC research infrastructure grant to F.M.. We are grateful to Professor Máté Lengyel and Professor Deborah Talmi for helpful discussions about the study. For the purpose of open access, the author has applied a Creative Commons Attribution (CC BY) licence to any Author Accepted Manuscript version arising from this submission.</p>
</ack>
<sec id="s6">
<label>7</label>
<title>Author contributions</title>
<p>JO, NG, MW, GT, BS and FM designed the study. NG collected the data. JO, NG, MJ and FM analysed the data. JO, NG, MW, BS and FM wrote the article.</p>
</sec>
<sec id="s7">
<label>8</label>
<title>Declaration of interests</title>
<p>The authors declare no competing interests.</p>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><string-name><surname>Dehaene</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Meyniel</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Wacongne</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Wang</surname>, <given-names>L.</given-names></string-name> &amp; <string-name><surname>Pallier</surname>, <given-names>C.</given-names></string-name> <article-title>The Neural Representation of Sequences: From Transition Probabilities to Algebraic Patterns and Linguistic Trees</article-title>. <source>Neuron</source> <volume>88</volume>, <fpage>2</fpage>–<lpage>19</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><string-name><surname>Schapiro</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Turk-Browne</surname>, <given-names>N.</given-names></string-name> <article-title>Statistical learning</article-title>. <source>Brain mapping</source> <volume>3</volume>, <fpage>501</fpage>–<lpage>506</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><string-name><surname>Fiser</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Lengyel</surname>, <given-names>G.</given-names></string-name> <article-title>A common probabilistic framework for perceptual and statistical learning</article-title>. <source>Current Opinion in Neurobiology</source> <volume>58</volume>, <fpage>218</fpage>–<lpage>228</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><string-name><surname>Meyniel</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Maheu</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Dehaene</surname>, <given-names>S.</given-names></string-name> <article-title>Human Inferences about Sequences: A Minimal Transition Probability Model</article-title>. <source>PLOS Computational Biology</source> <volume>12</volume>, <fpage>e1005260</fpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><string-name><surname>Kourtzi</surname>, <given-names>Z.</given-names></string-name> &amp; <string-name><surname>Welchman</surname>, <given-names>A. E.</given-names></string-name> <article-title>Learning predictive structure without a teacher: decision strategies and brain routes</article-title>. <source>Current opinion in neurobiology</source> <volume>58</volume>, <fpage>130</fpage>–<lpage>134</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><string-name><surname>Sherman</surname>, <given-names>B. E.</given-names></string-name>, <string-name><surname>Graves</surname>, <given-names>K. N.</given-names></string-name> &amp; <string-name><surname>Turk-Browne</surname>, <given-names>N. B.</given-names></string-name> <article-title>The prevalence and importance of statistical learning in human cognition and behavior</article-title>. <source>Current Opinion in Behavioral Sciences</source> <volume>32</volume>, <fpage>15</fpage>–<lpage>20</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="book"><string-name><surname>Turk-Browne</surname>, <given-names>N. B.</given-names></string-name>, <string-name><surname>Scholl</surname>, <given-names>B. J.</given-names></string-name>, <string-name><surname>Chun</surname>, <given-names>M. M.</given-names></string-name> &amp; <string-name><surname>Johnson</surname>, <given-names>M. K.</given-names></string-name> <chapter-title>Neural Evidence of Statistical Learning: Efficient Detection of Visual Regularities Without Awareness</chapter-title>. <source>Journal of Cognitive Neuroscience</source> <volume>21</volume>. Conference Name: <publisher-name>Journal of Cognitive Neuroscience</publisher-name>, <fpage>1934</fpage>–<lpage>1945</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><string-name><surname>Mancini</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Zhang</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Seymour</surname>, <given-names>B.</given-names></string-name> <article-title>Computational and neural mechanisms of statistical pain learning</article-title>. <source>Nature Communications</source> <volume>13</volume>, <fpage>6613</fpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><string-name><surname>Mulders</surname>, <given-names>D.</given-names></string-name>, <string-name><surname>Seymour</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Mouraux</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Mancini</surname>, <given-names>F.</given-names></string-name> <article-title>Confidence of probabilistic predictions modulates the cortical response to pain</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>120</volume>, <fpage>e2212252120</fpage> (<year>2023</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="journal"><string-name><surname>Tracey</surname>, <given-names>I.</given-names></string-name> <article-title>Getting the pain you expect: mechanisms of placebo, nocebo and reappraisal effects in humans</article-title>. <source>Nature Medicine</source> <volume>16</volume>, <fpage>1277</fpage>–<lpage>1283</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="book"><string-name><surname>Tinnermann</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Geuter</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Sprenger</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Finsterbusch</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Büchel</surname>, <given-names>C.</given-names></string-name> <chapter-title>Interactions between brain and spinal cord mediate value effects in nocebo hyperalgesia</chapter-title>. <source>Science</source> <volume>358</volume>. Publisher: <publisher-name>American Association for the Advancement of Science</publisher-name>, <fpage>105</fpage>–<lpage>108</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><string-name><surname>Eippert</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Finsterbusch</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Bingel</surname>, <given-names>U.</given-names></string-name> &amp; <string-name><surname>Büchel</surname>, <given-names>C.</given-names></string-name> <article-title>Direct evidence for spinal cord involvement in placebo analgesia</article-title>. <source>Science</source> <volume>326</volume>, <fpage>404</fpage>–<lpage>404</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><string-name><surname>Geuter</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Büchel</surname>, <given-names>C.</given-names></string-name> <article-title>Facilitation of pain in the human spinal cord by nocebo treatment</article-title>. <source>Journal of Neuroscience</source> <volume>33</volume>, <fpage>13784</fpage>–<lpage>13790</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><string-name><surname>Fields</surname>, <given-names>H. L.</given-names></string-name> <article-title>How expectations influence pain</article-title>. <source>Pain</source> <volume>159</volume>, <fpage>S3</fpage>–<lpage>S10</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="book"><string-name><surname>Knill</surname>, <given-names>D. C.</given-names></string-name> &amp; <string-name><surname>Richards</surname>, <given-names>W.</given-names></string-name> <source>Perception as Bayesian inference</source> (<publisher-name>Cambridge University Press</publisher-name>, <year>1996</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="book"><string-name><surname>Jepma</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Koban</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>van Doorn</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Jones</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Wager</surname>, <given-names>T. D.</given-names></string-name> <chapter-title>Behavioural and neural evidence for self-reinforcing expectancy effects on pain</chapter-title>. <source>Nature Human Behaviour</source> <volume>2</volume>. Number: 11 Publisher: <publisher-name>Nature Publishing Group</publisher-name>, <fpage>838</fpage>–<lpage>855</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><string-name><surname>Bushnell</surname>, <given-names>M. C.</given-names></string-name>, <string-name><surname>Čeko</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Low</surname>, <given-names>L. A.</given-names></string-name> <article-title>Cognitive and emotional control of pain and its disruption in chronic pain</article-title>. <source>Nature Reviews Neuroscience</source> <volume>14</volume>, <fpage>502</fpage>–<lpage>511</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="journal"><string-name><surname>Bruehl</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>McCubbin</surname>, <given-names>J. A.</given-names></string-name> &amp; <string-name><surname>Harden</surname>, <given-names>R. N.</given-names></string-name> <article-title>Theoretical review: altered pain regulatory systems in chronic pain</article-title>. <source>Neuroscience &amp; Biobehavioral Reviews</source> <volume>23</volume>, <fpage>877</fpage>–<lpage>890</lpage> (<year>1999</year>).</mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><string-name><surname>Yarnitsky</surname>, <given-names>D.</given-names></string-name> <article-title>Role of endogenous pain modulation in chronic pain mechanisms and treatment</article-title>. <source>Pain</source> <volume>156</volume>, <fpage>S24</fpage>–<lpage>S31</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><string-name><surname>King</surname>, <given-names>C. D.</given-names></string-name> <etal>et al.</etal> <article-title>Deficiency in endogenous modulation of prolonged heat pain in patients with irritable bowel syndrome and temporomandibular disorder</article-title>. <source>Pain</source> <volume>143</volume>, <fpage>172</fpage>–<lpage>178</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><string-name><surname>Bannister</surname>, <given-names>K.</given-names></string-name> &amp; <string-name><surname>Dickenson</surname>, <given-names>A.</given-names></string-name> <article-title>The plasticity of descending controls in pain: translational probing</article-title>. <source>The Journal of physiology</source> <volume>595</volume>, <fpage>4159</fpage>–<lpage>4166</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><string-name><surname>Tracey</surname>, <given-names>I.</given-names></string-name> <article-title>A vulnerability to chronic pain and its interrelationship with resistance to analgesia</article-title>. <source>Brain</source> <volume>139</volume>, <fpage>869</fpage>–<lpage>1872</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><string-name><surname>Jepma</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Koban</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>van Doorn</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Jones</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Wager</surname>, <given-names>T. D.</given-names></string-name> <article-title>Behavioural and neural evidence for self-reinforcing expectancy effects on pain</article-title>. <source>Nature Human Behaviour</source> <volume>2</volume>, <fpage>838</fpage>–<lpage>855</lpage> (<year>2018</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="book"><string-name><surname>Särkkä</surname>, <given-names>S.</given-names></string-name> <source>Bayesian filtering and smoothing</source> (<publisher-name>Cambridge University Press</publisher-name>, <publisher-loc>Cambridge, U.K</publisher-loc>., <year>2013</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><string-name><surname>Hoskin</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title>Sensitivity to pain expectations: A Bayesian model of individual differences</article-title>. <source>Cognition</source> <volume>182</volume>, <fpage>127</fpage>–<lpage>139</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><string-name><surname>Kalman</surname>, <given-names>R. E.</given-names></string-name> <article-title>A New Approach to Linear Filtering and Prediction Problems</article-title>. <source>Transactions of the ASME– Journal of Basic Engineering</source> <volume>82</volume>, <fpage>35</fpage>–<lpage>45</lpage> (<year>1960</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="book"><string-name><surname>Sutton</surname>, <given-names>R. S.</given-names></string-name> &amp; <string-name><surname>Barto</surname>, <given-names>A. G.</given-names></string-name> <source>Reinforcement learning: an introduction</source> <edition>Second</edition> edition (<publisher-name>The MIT Press</publisher-name>, <publisher-loc>Cambridge, Massachusetts</publisher-loc>, <year>2018</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="book"><string-name><surname>Heald</surname>, <given-names>J. B.</given-names></string-name>, <string-name><surname>Lengyel</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Wolpert</surname>, <given-names>D. M.</given-names></string-name> <chapter-title>Contextual inference in learning and memory</chapter-title>. <source>Trends in Cognitive Sciences</source> <volume>0</volume>. Publisher: <publisher-name>Elsevier</publisher-name> (<year>2022</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="book"><string-name><surname>Piray</surname>, <given-names>P.</given-names></string-name> &amp; <string-name><surname>Daw</surname>, <given-names>N. D.</given-names></string-name> <chapter-title>A model for learning based on the joint estimation of stochasticity and volatility</chapter-title>. <source>Nature Communications</source> <volume>12</volume>. Number: 1 Publisher: <publisher-name>Nature Publishing Group</publisher-name>, <fpage>6587</fpage> (<year>2021</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><string-name><surname>Mayr</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Patients with chronic pain exhibit individually unique cortical signatures of pain encoding</article-title>. <source>Human Brain Mapping</source> <volume>43</volume>, <fpage>1676</fpage>–<lpage>1693</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c31"><label>31.</label><mixed-citation publication-type="journal"><string-name><surname>Baliki</surname>, <given-names>M. N.</given-names></string-name> <etal>et al.</etal> <article-title>Corticostriatal functional connectivity predicts transition to chronic back pain</article-title>. <source>Nature neuroscience</source> <volume>15</volume>, <fpage>1117</fpage>–<lpage>1119</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c32"><label>32.</label><mixed-citation publication-type="journal"><string-name><surname>Foss</surname>, <given-names>J. M.</given-names></string-name>, <string-name><surname>Apkarian</surname>, <given-names>A. V.</given-names></string-name> &amp; <string-name><surname>Chialvo</surname>, <given-names>D. R.</given-names></string-name> <article-title>Dynamics of pain: fractal dimension of temporal variability of spontaneous pain differentiates between pain states</article-title>. <source>Journal of neurophysiology</source> <volume>95</volume>, <fpage>730</fpage>–<lpage>736</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c33"><label>33.</label><mixed-citation publication-type="journal"><string-name><surname>Meyniel</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Dehaene</surname>, <given-names>S.</given-names></string-name> <article-title>Brain networks for confidence weighting and hierarchical inference during probabilistic learning</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>114</volume> (<year>2017</year>).</mixed-citation></ref>
<ref id="c34"><label>34.</label><mixed-citation publication-type="journal"><string-name><surname>Tabor</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Thacker</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Moseley</surname>, <given-names>G. L.</given-names></string-name> &amp; <string-name><surname>Körding</surname>, <given-names>K. P.</given-names></string-name> <article-title>Pain: A Statistical Account</article-title>. <source>PLOS Computational Biology</source> <volume>13</volume>, <fpage>e1005142</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c35"><label>35.</label><mixed-citation publication-type="journal"><string-name><surname>Fardo</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal> <article-title>Expectation violation and attention to pain jointly modulate neural gain in somatosensory cortex</article-title>. <source>Neuroimage</source> <volume>153</volume>, <fpage>109</fpage>–<lpage>121</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c36"><label>36.</label><mixed-citation publication-type="journal"><string-name><surname>Seymour</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Mancini</surname>, <given-names>F.</given-names></string-name> <article-title>Hierarchical models of pain: Inference, information-seeking, and adaptive control</article-title>. <source>NeuroImage</source> <volume>222</volume>, <fpage>117212</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c37"><label>37.</label><mixed-citation publication-type="journal"><string-name><surname>Büchel</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Geuter</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Sprenger</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Eippert</surname>, <given-names>F.</given-names></string-name> <article-title>Placebo Analgesia: A Predictive Coding Perspective</article-title>. <source>Neuron</source> <volume>81</volume>, <fpage>1223</fpage>–<lpage>1239</lpage> (<year>2014</year>).</mixed-citation></ref>
<ref id="c38"><label>38.</label><mixed-citation publication-type="journal"><string-name><surname>Yoshida</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Seymour</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Koltzenburg</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Dolan</surname>, <given-names>R. J.</given-names></string-name> <article-title>Uncertainty Increases Pain: Evidence for a Novel Mechanism of Pain Modulation Involving the Periaqueductal Gray</article-title>. <source>Journal of Neuroscience</source> <volume>33</volume>, <fpage>5638</fpage>–<lpage>5646</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c39"><label>39.</label><mixed-citation publication-type="journal"><string-name><surname>Anchisi</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Zanon</surname>, <given-names>M.</given-names></string-name> <article-title>A Bayesian Perspective on Sensory and Cognitive Integration in Pain Perception and Placebo Analgesia</article-title>. <source>PLOS ONE</source> <volume>10</volume>, <fpage>e0117270</fpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c40"><label>40.</label><mixed-citation publication-type="journal"><string-name><surname>Wiech</surname>, <given-names>K.</given-names></string-name> <article-title>Deconstructing the sensation of pain: The influence of cognitive processes on pain perception</article-title>. <source>Science</source> <volume>354</volume>, <fpage>584</fpage>–<lpage>587</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c41"><label>41.</label><mixed-citation publication-type="journal"><string-name><surname>Tabor</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Burr</surname>, <given-names>C.</given-names></string-name> <article-title>Bayesian Learning Models of Pain: A Call to Action</article-title>. <source>Current Opinion in Behavioral Sciences</source> <volume>26</volume>, <fpage>54</fpage>–<lpage>61</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c42"><label>42.</label><mixed-citation publication-type="journal"><string-name><surname>Colloca</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Sigaudo</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Benedetti</surname>, <given-names>F.</given-names></string-name> <article-title>The role of learning in nocebo and placebo effects</article-title>. <source>Pain</source> <volume>136</volume>, <fpage>211</fpage>–<lpage>218</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c43"><label>43.</label><mixed-citation publication-type="journal"><string-name><surname>Blasini</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Corsi</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Klinger</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Colloca</surname>, <given-names>L.</given-names></string-name> <article-title>Nocebo and pain: an overview of the psychoneurobiological mechanisms</article-title>. <source>PAIN Reports</source> <volume>2</volume>, <fpage>e585</fpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c44"><label>44.</label><mixed-citation publication-type="journal"><string-name><surname>Hird</surname>, <given-names>E. J.</given-names></string-name>, <string-name><surname>Charalambous</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>El-Deredy</surname>, <given-names>W.</given-names></string-name>, <string-name><surname>Jones</surname>, <given-names>A. K. P.</given-names></string-name> &amp; <string-name><surname>Talmi</surname>, <given-names>D.</given-names></string-name> <article-title>Boundary effects of expectation in human pain perception</article-title>. <source>Scientific Reports</source> <volume>9</volume>, <fpage>9443</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c45"><label>45.</label><mixed-citation publication-type="journal"><string-name><surname>Brown</surname>, <given-names>C. A.</given-names></string-name>, <string-name><surname>Seymour</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>El-Deredy</surname>, <given-names>W.</given-names></string-name> &amp; <string-name><surname>Jones</surname>, <given-names>A. K.</given-names></string-name> <article-title>Confidence in beliefs about pain predicts expectancy effects on pain perception and anticipatory processing in right anterior insula</article-title>. <source>Pain</source> <volume>139</volume>, <fpage>324</fpage>–<lpage>332</lpage> (<year>2008</year>).</mixed-citation></ref>
<ref id="c46"><label>46.</label><mixed-citation publication-type="journal"><string-name><surname>Seymour</surname>, <given-names>B.</given-names></string-name> <article-title>Pain: a precision signal for reinforcement learning and control</article-title>. <source>Neuron</source> <volume>101</volume>, <fpage>1029</fpage>–<lpage>1041</lpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c47"><label>47.</label><mixed-citation publication-type="journal"><string-name><surname>Baliki</surname>, <given-names>M. N.</given-names></string-name> &amp; <string-name><surname>Apkarian</surname>, <given-names>A. V.</given-names></string-name> <article-title>Nociception, pain, negative moods, and behavior selection</article-title>. <source>Neuron</source> <volume>87</volume>, <fpage>474</fpage>–<lpage>491</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c48"><label>48.</label><mixed-citation publication-type="journal"><string-name><surname>Vlaeyen</surname>, <given-names>J. W.</given-names></string-name>, <string-name><surname>Crombez</surname>, <given-names>G.</given-names></string-name> &amp; <string-name><surname>Linton</surname>, <given-names>S. J.</given-names></string-name> <article-title>The fear-avoidance model of pain</article-title>. <source>Pain</source> <volume>157</volume>, <fpage>1588</fpage>–<lpage>1589</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c49"><label>49.</label><mixed-citation publication-type="journal"><string-name><surname>Strigo</surname>, <given-names>I. A.</given-names></string-name>, <string-name><surname>Carli</surname>, <given-names>F.</given-names></string-name> &amp; <string-name><surname>Bushnell</surname>, <given-names>M. C.</given-names></string-name> <article-title>Effect of ambient temperature on human pain and temperature perception</article-title>. <source>Anesthesiology</source> <volume>92</volume>, <fpage>699</fpage>–<lpage>707</lpage> (<year>2000</year>).</mixed-citation></ref>
<ref id="c50"><label>50.</label><mixed-citation publication-type="web"><collab>Medoc Advanced Medical Systems</collab>. <source>TSA 2 - Advanced Thermosensory Stimulator</source> <ext-link ext-link-type="uri" xlink:href="https://www.medoc-web.com/tsa-2">https://www.medoc-web.com/tsa-2</ext-link>. [Online; accessed <date-in-citation content-type="access-date">15-Aug-2022</date-in-citation>]. <ext-link ext-link-type="uri" xlink:href="https://www.medoc-web.com/tsa-2">https://www.medoc-web.com/tsa-2</ext-link> (<year>2022</year>).</mixed-citation></ref>
<ref id="c51"><label>51.</label><mixed-citation publication-type="journal"><string-name><surname>Lue</surname>, <given-names>Y.-J.</given-names></string-name>, <string-name><surname>Shih</surname>, <given-names>Y.-C.</given-names></string-name><string-name><surname>Lu</surname>, <given-names>Y.-M.</given-names></string-name> &amp; <string-name><surname>Liu</surname>, <given-names>Y.-F.</given-names></string-name> <article-title>Method of Limit and Method of Level for Thermal and Pain Detection Assessment</article-title>. <source>International Journal of Physical Therapy &amp; Rehabilitation</source> <volume>3</volume> (<year>2017</year>).</mixed-citation></ref>
<ref id="c52"><label>52.</label><mixed-citation publication-type="journal"><string-name><surname>Hermans</surname>, <given-names>L.</given-names></string-name> <etal>et al.</etal> <article-title>An Overview of Offset Analgesia and the Comparison with Conditioned Pain Modulation: A Systematic Literature Review</article-title>. <source>Pain Physician</source> <volume>19</volume>, <fpage>307</fpage>–<lpage>326</lpage> (<year>2016</year>).</mixed-citation></ref>
<ref id="c53"><label>53.</label><mixed-citation publication-type="journal"><string-name><surname>Kleiner</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>What’s new in psychtoolbox-3. English (US)</article-title>. <source>Perception</source> <volume>36</volume>, <fpage>1</fpage>–<lpage>16</lpage>. ISSN: <issn>0301-0066</issn> (<year>2007</year>).</mixed-citation></ref>
<ref id="c54"><label>54.</label><mixed-citation publication-type="journal"><string-name><surname>Hollins</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Harper</surname>, <given-names>D.</given-names></string-name> &amp; <string-name><surname>Maixner</surname>, <given-names>W.</given-names></string-name> <article-title>Changes in pain from a repetitive thermal stimulus: the roles of adaptation and sensitization</article-title>. <source>Pain</source> <volume>152</volume>, <fpage>1583</fpage>–<lpage>1590</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c55"><label>55.</label><mixed-citation publication-type="journal"><string-name><surname>Virtanen</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal> <article-title>SciPy 1.0: Fundamental Algorithms for Scientific Computing in Python</article-title>. <source>Nature Methods</source> <volume>17</volume>, <fpage>261</fpage>–<lpage>272</lpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c56"><label>56.</label><mixed-citation publication-type="web"><collab>Stan Development Team</collab>. <source>RStan: the R interface to Stan R package version 2.21.0</source>. <year>2019</year>. <ext-link ext-link-type="uri" xlink:href="http://mc-stan.org/">http://mc-stan.org/</ext-link>.</mixed-citation></ref>
<ref id="c57"><label>57.</label><mixed-citation publication-type="book"><string-name><surname>Papaspiliopoulos</surname>, <given-names>O.</given-names></string-name>, <string-name><surname>Roberts</surname>, <given-names>G. O.</given-names></string-name> &amp; <string-name><surname>Sköld</surname>, <given-names>M.</given-names></string-name> <chapter-title>A General Framework for the Parametrization of Hierarchical Models</chapter-title>. <source>Statistical Science</source> <volume>22</volume>. Publisher: <publisher-name>Institute of Mathematical Statistics</publisher-name>, <fpage>59</fpage>–<lpage>73</lpage> (<year>2007</year>).</mixed-citation></ref>
<ref id="c58"><label>58.</label><mixed-citation publication-type="web"><collab>Stan Development Team</collab>. <source>25.7 Reparameterization Stan User’s Guide</source> <ext-link ext-link-type="uri" xlink:href="https://mc-stan.org/docs/stan-users-guide/reparameterization.html">https://mc-stan.org/docs/stan-users-guide/reparameterization.html</ext-link>. [Online; accessed <date-in-citation content-type="access-date">15-Aug-2022</date-in-citation>].</mixed-citation></ref>
<ref id="c59"><label>59.</label><mixed-citation publication-type="journal"><string-name><surname>Bowling</surname>, <given-names>S. R.</given-names></string-name>, <string-name><surname>Khasawneh</surname>, <given-names>M. T.</given-names></string-name>, <string-name><surname>Kaewkuekool</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Cho</surname>, <given-names>B. R.</given-names></string-name> <article-title>A Logistic Approximation to the Cumulative Normal Distribution</article-title>. <source>Journal of Industrial Engineering and Management</source> <volume>2</volume>, <fpage>114</fpage>–<lpage>27</lpage> (<year>2009</year>).</mixed-citation></ref>
<ref id="c60"><label>60.</label><mixed-citation publication-type="journal"><string-name><surname>Vehtari</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Gelman</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Gabry</surname>, <given-names>J.</given-names></string-name> <article-title>Practical Bayesian model evaluation using leave-one-out cross-validation and WAIC</article-title>. <source>Statistics and Computing</source> <volume>27</volume>. <pub-id pub-id-type="arxiv">1507.04544</pub-id> [stat], <fpage>1413</fpage>–<lpage>1432</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c61"><label>61.</label><mixed-citation publication-type="book"><string-name><surname>Kruschke</surname>, <given-names>J. K.</given-names></string-name> <source>Doing Bayesian data analysis: a tutorial with R, JAGS, and Stan</source> Edition <edition>2</edition> (<publisher-name>Academic Press, Boston</publisher-name>, <year>2015</year>).</mixed-citation></ref>
<ref id="c62"><label>62.</label><mixed-citation publication-type="book"><string-name><surname>Aylward</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <chapter-title>Altered learning under uncertainty in unmedicated mood and anxiety disorders</chapter-title>. <source>Nature Human Behaviour</source> <volume>3</volume>. Number: 10 Publisher: <publisher-name>Nature Publishing Group, 1116–1123</publisher-name> (<year>2019</year>).</mixed-citation></ref>
<ref id="c63"><label>63.</label><mixed-citation publication-type="book"><string-name><surname>Ahn</surname>, <given-names>W.-Y.</given-names></string-name>, <string-name><surname>Haines</surname>, <given-names>N.</given-names></string-name> &amp; <string-name><surname>Zhang</surname>, <given-names>L.</given-names></string-name> <chapter-title>Revealing Neurocomputational Mechanisms of Reinforcement Learning and Decision-Making With the hBayesDM Package</chapter-title>. <source>Computational Psychiatry</source> <volume>1</volume>. Number: 0 Publisher: <publisher-name>Ubiquity Press</publisher-name>, <fpage>24</fpage>–<lpage>57</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c64"><label>64.</label><mixed-citation publication-type="journal"><string-name><surname>Wilson</surname>, <given-names>R. C.</given-names></string-name> &amp; <string-name><surname>Collins</surname>, <given-names>A. G.</given-names></string-name> <article-title>Ten simple rules for the computational modeling of behavioral data</article-title>. <source>eLife</source> <volume>8</volume>, <fpage>e49547</fpage> (<year>2019</year>).</mixed-citation></ref>
<ref id="c65"><label>65.</label><mixed-citation publication-type="journal"><string-name><surname>White</surname>, <given-names>C. N.</given-names></string-name>, <string-name><surname>Servant</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Logan</surname>, <given-names>G. D.</given-names></string-name> <article-title>Testing the validity of conflict drift-diffusion models for use in estimating cognitive processes: A parameter-recovery study</article-title>. <source>Psychonomic Bulletin &amp; Review</source> <volume>25</volume>, <fpage>286</fpage>–<lpage>301</lpage> (<year>2018</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90634.2.sa2</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Ploner</surname>
<given-names>Markus</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Department of Neurology and TUM-Neuroimaging Center, TUM School of Medicine and Health, Technical University of Munich (TUM)</institution>
</institution-wrap>
<city>Munich</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Compelling</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>This study presents a <bold>valuable</bold> insight into a computational mechanism of pain perception. The evidence supporting the authors' claims is <bold>compelling</bold>. The work will be of interest to pain researchers working on computational models and cognitive mechanisms of pain in a Bayesian framework.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90634.2.sa1</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This study examined the role of statistical learning in pain perception, suggesting that individuals' expectations about a sequence of events influence their perception of pain intensity. They incorporated the components of volatility and stochasticity into their experimental design and asked participants (n = 27) to rate the pain intensity, their prediction, and their confidence level. They compared two different inference strategies: Bayesian inference vs. heuristic-employing Kalman filters and model-free reinforcement learning. They showed that the expectation-weighted Kalman filter best explained the temporal pattern of participants' ratings. These results provide evidence for a Bayesian inference perspective on pain, supported by a computational model that elucidates the underlying process.</p>
<p>Strengths:</p>
<p>- Their experimental design included a wide range of input intensities and the levels of volatility and stochasticity. With elaborated computational models, they provide solid evidence that statistical learning shapes pain.</p>
<p>Weaknesses:</p>
<p>- Relevance to clinical pain: While the authors underscore the relevance of their findings to chronic pain, they did not include data pertaining to clinical pain.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90634.2.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The study investigated how statistical aspects of temperature sequences, such as manipulations of stochasticity (i.e., randomness of a sequence) and volatility (i.e., speed at which a sequence unfolded) influenced pain perception. Using an innovative stimulation paradigm and computational modelling of perceptual variables, this study demonstrated that perception is weighted by expectations. Overall, the findings support the conclusion that pain perception is mediated by expectations in a Bayesian manner. The provision of additional details during the review process strengthens the reliability of this conclusion. The methods presented offer tools and frameworks for further research in pain perception and can be extended to investigations into chronic pain processes.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.90634.2.sa3</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Onysk</surname>
<given-names>Jakub</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-0876-5465</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Gregory</surname>
<given-names>Nicholas</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Whitefield</surname>
<given-names>Mia</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Jain</surname>
<given-names>Maeghal</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Turner</surname>
<given-names>Georgia</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8306-8454</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Seymour</surname>
<given-names>Ben</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0003-1724-5832</contrib-id></contrib>
<contrib contrib-type="author">
<name>
<surname>Mancini</surname>
<given-names>Flavia</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0001-8441-9236</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<p><bold>eLife assessment</bold></p>
<p>This study presents a valuable insight into a computational mechanism of pain perception. The evidence supporting the authors’ claims is solid, although the inclusion of 1) more diverse candidate computational models, 2) more systematic analysis of the temporal regularity effects on the model fit, and 3) tests on clinical samples would have strengthened the study. The work will be of interest to pain researchers working on computational models and cognitive mechanisms of pain in a Bayesian framework.</p>
<p>Thank you very much again for considering the manuscript and judging it as a valuable contribution to understanding mechanisms of pain perception. We recognise the above-mentioned points of improvement and elaborate on them in the initial response to the reviewers.</p>
<p>Response to the reviewers</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 1:</bold></p>
<p>Reviewer Comment 1.1 — Selection of candidate computational models: While the paper juxtaposes the simple model-free RL model against a Kalman Filter model in the context of pain perception, the rationale behind this choice remains ambiguous. It prompts the question: could other RL-based models, such as model-based RL or hierarchical RL, offer additional insights? A more detailed explanation of their computational model selection would provide greater clarity and depth to the study.</p>
</disp-quote>
<p>Initial reply: Thank you for this point. Our models were selected a-priori, following the modelling strategy from Jepma et al. (2018) and hence considered the same set of core models for clear extension of the analysis to our non-cue paradigm. The key question for us was whether expectations were used to weight the behavioural estimates, so our main interest was to compare expectation vs non-expectation weighted models.</p>
<p>Model-based and hierarchical RL are very broad terms that can be used to refer to many different models, and we are not clear about which specific models the reviewer is referring to. Our Bayesian models are generative models, i.e. they learn the generative statistics of the environment (which is characterised by inherent stochasticity and volatility) and hence operate model-based analyses of the stimulus dynamics. In our case, this happened hierarchically and it was combined with a simple RL rule.</p>
<p>Revised reply: We clarified our modelling choices in the ”Modelling strategy” subsection of the results section.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 1.2 — Effects of varying levels of volatility and stochasticity: The study commendably integrates varying levels of volatility and stochasticity into its experimental design. However, the depth of analysis concerning the effects of these variables on model fit appears shallow. A looming concern is whether the superior performance of the expectation-weighted Kalman Filter model might be a natural outcome of the experimental design. While the non-significant difference between eKF and eRL for the high stochasticity condition somewhat alleviates this concern, it raises another query: Would a more granular analysis of volatility and stochasticity effects reveal fine-grained model fit patterns?</p>
</disp-quote>
<p>Initial reply: We are sorry that the reviewer finds shallow ”the depth of analysis concerning the effects of these variables on model fit”. We are not sure which analysis the reviewer has in mind when suggesting a ”more granular analysis of volatility and stochasticity effects” to ”reveal fine-grained model fit patterns”. Therefore, we find it difficult to improve our manuscript in this regard. We are happy to add analyses to our paper but we would be greatful for some specific pointers. We have already provided:</p>
<p>•    Analysis of model-naive performance across different levels of stochasticity and volatility (section 2.3, figure 3, supplementary information section 1.1 and tables S1-2)</p>
<p>•    Model fitting for each stochasticity/volatility condition (section 2.4.1, figure 4, supplementary table S5)</p>
<p>•    Group-level and individual-level differences of each model parameter across stochasticity/volatility conditions (supplementary information section 7, figures S4-S5).</p>
<p>•    Effect of confidence on scaling factor for each stochasticity/volatility condition (figure 5)</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 1.3 — Rating instruction: According to Fig. 1A, participants were prompted to rate their responses to the question, ”How much pain DID you just feel?” and to specify their confidence level regarding their pain. It is difficult for me to understand the meaning of confidence in this context, given that they were asked to report their *subjective* feelings. It might have been better to query participants about perceived stimulus intensity levels. This perspective is seemingly echoed in lines 100-101, ”the primary aim of the experiment was to determine whether the expectations participants hold about the sequence inform their perceptual beliefs about the intensity of the stimuli.”</p>
</disp-quote>
<p>Initial reply: Thank you for raising this question, which allows us to clarify our paradigm. On half of the trials, participants were asked to report the perceived intensity of the previous stimulus; on the remaining trials, participants were requested to predict the intensity of the next stimulus. Therefore, we did query ”participants about perceived stimulus intensity levels”, as described at lines 49-55, 296-303, and depicted in figure 1.</p>
<p>The confidence refers to the level of confidence that participants have regarding their rating - how sure they are. This is done in addition to their perceived stimulus intensity and it has been used in a large body of previous studies in any sensory modality.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 1.4 — Relevance to clinical pain: While the authors underscore the relevance of their findings to chronic pain, they did not include data pertaining to clinical pain. Notably, their initial preprint seemed to encompass data from a clinical sample (<ext-link ext-link-type="uri" xlink:href="https://www.medrxiv.org">https://www.medrxiv.org</ext-link> /content/10.1101/2023.03.23.23287656v1), which, for reasons unexplained, has been omitted in the current version. Clarification on this discrepancy would be instrumental in discerning the true relevance of the study’s findings to clinical pain scenarios.</p>
</disp-quote>
<p>Initial reply: The preprint that the Reviewer is referring to was an older version of the manuscript in which we combined two different experiments, which were initially born as separate studies: the one that we submitted to eLife (done in the lab, with noxious stimuli in healthy participants) and an online study with a different statistical learning paradigm (without noxious stimuli, in chronic back pain participants). Unfortunately, the paradigms were different and not directly comparable. Indeed, following submission to a different journal, the manuscript was criticised for this reason. We therefore split the paper in two, and submitted the first study to eLife. We are now planning to perform the same lab-based experiment with noxious stimuli on chronic back pain participants. Progress on this front has been slowed down by the fact that I (Flavia Mancini) am on maternity leave, but it remains top priority once back to work.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 1.5 — Paper organization: The paper’s organization appears a little bit weird, possibly due to the removal of significant content from their initial preprint. Sections 2.12.2 and 2.4 seem more suitable for the Methods section, while 2.3 and 2.4.1 are the only parts that present results. In addition, enhancing clarity through graphical diagrams, especially for the experimental design and computational models, would be quite beneficial. A reference point could be Fig. 1 and Fig. 5 from Jepma et al. (2018), which similarly explored RL and KF models.</p>
</disp-quote>
<p>Initial reply: Thank you for these suggestions. We will consider restructuring the paper in the revised version.</p>
<p>Revised reply: We restructured introduction, results and parts of the methods. We followed the reviewer’s suggestion regarding enhancing clarity through graphical diagrams. We have visualised the experimental design in Figure 1D. Furthemore, we have visualised the two main computational models (eRL and eKF) in Figure 2, following from Jepma et al. (2018). As a result, we have updated the notation in Section 4.4 to be clearer and consistent with the graphical representation (rename the variable referring to observed thermal input from <italic>Ot</italic> to <italic>Nt</italic>).</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 1.6 — In lines 99-100, the statement ”following the work by [23]” would be more helpful if it included a concise summary of the main concepts from the referenced work.</p>
<p>- It would be helpful to have descriptions of the conditions that Figure 1C is elaborating on.</p>
<p>- In line 364, the ”N {t}” in the sentence ”The observation on trial t, N {t}”, should be O {t}.</p>
</disp-quote>
<p>Initial reply: Thank you for spotting these and for providing the suggestions. We will include the correction in the revised version.</p>
<p>Revised reply: We have added the following regarding the lines 99-100:</p>
<p>”We build on the work by [23], who show that pain perception is strongly influenced by expectations as defined by a cue that predicts high or low pain. In contrast to the cue-paradigm from [23], the primary aim of our experiment was to determine whether the expectations participants hold about the sequence itself inform their perceptual beliefs about the intensity of the stimuli.”</p>
<p>See comment in the previous reply, regarding the notation change from <italic>Ot</italic> to <italic>Nt</italic>.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 2:</bold></p>
<p>Reviewer Comment 2.1 — This is a highly interesting and novel finding with potential implications for the understanding and treatment of chronic pain where pain regulation is deficient. The paradigm is clear, the analysis is state-of-the-art, the results are convincing, and the interpretation is adequate.</p>
</disp-quote>
<p>Initial reply: Thank you very much for these positive comments.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 3:</bold></p>
<p>Summary:</p>
<p>I am pleased to have had the opportunity to review this manuscript, which investigated the role of statistical learning in the modulation of pain perception. In short, the study showed that statistical aspects of temperature sequences, with respect to specific manipulations of stochasticity (i.e., randomness of a sequence) and volatility (i.e., speed at which a sequence unfolded) influenced pain perception. Computational modelling of perceptual variables (i.e., multi-dimensional ratings of perceived or predicted stimuli) indicated that models of perception weighted by expectations were the best explanation for the data. My comments below are not intended to undermine or question the quality of this research. Rather, they are offered with the intention of enhancing what is already a significant contribution to the pain neuroscience field. Below, I highlight the strengths and weaknesses of the manuscript and offer suggestions for incorporating additional methodological details.</p>
<p>Strengths:</p>
<p>The manuscript is articulate, coherent, and skilfully written, making it accessible and engaging.</p>
<p>- The innovative stimulation paradigm enables the exploration of expectancy effects on perception without depending on external cues, lending a unique angle to the research.</p>
<p>- By including participants’ ratings of both perceptual aspects and their confidence in what they perceived or predicted, the study provides an additional layer of information to the understanding of perceptual decision-making. This information was thoughtfully incorporated into the modelling, enabling the investigation of how confidence influences learning.</p>
<p>- The computational modelling techniques utilised here are methodologically robust. I commend the authors for their attention to model and parameter recovery, a facet often neglected in previous computational neuroscience studies.</p>
<p>- The well-chosen citations not only reflect a clear grasp of the current research landscape but also contribute thoughtfully to ongoing discussions within the field of pain neuroscience.</p>
</disp-quote>
<p>Initial reply: We are really grateful for reviewer’s insightful comments and for providing useful guidance regarding our methodology. We are also thankful for highlighting the strengths of our manuscript. Below we respond to individual weakness mentioned in the reviews report.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 3.1 — In Figure 1, panel C, the authors illustrate the stimulation intensity, perceived intensity, and prediction intensity on the same scale, facilitating a more direct comparison. It appears that the stimulation intensity has been mathematically transformed to fit a scale from 0 to 100, aligning it with the intensity ratings corresponding to either past or future stimuli. Given that the pain threshold is specifically marked at 50 on this scale, one could logically infer that all ratings falling below this value should be deemed non-painful. However, I find myself uncertain about this interpretation, especially in relation to the term ”arbitrary units” used in the figure. I would greatly appreciate clarification on how to accurately interpret these units, as well as an explanation of the relationship between these values and the definition of pain threshold in this experiment.</p>
</disp-quote>
<p>Initial reply: Indeed, as detailed in the Methods section 4.3, the stimulation intensity was originally transformed from the 1-13 scale to 0-100 scale to match the scales in the participant response screens.</p>
<p>Following the method used to establish the pain threshold, we set the stimulus intensity of 7 as the threshold on the original 1-13 scale. However, during the rating part of the experiment, several of the participants never or very rarely selected a value above 50 (their individually defined pain threshold), despite previously indicating a moment during pain threshold procedure when a stimulus becomes painful. This then results in the re-scaled intensity values as well the perception rating, both on the same 0-100 scale of arbitrary units, to never go above the pain threshold. Please see all participant ratings and inputs in the Figure below. We see that it would be more illustrative to re-plot Figure 1 with a different exemplary participant, whose ratings go above the pain threshold, perhaps with an input intensity on the 1-13 scale on the additional right-hand-side y-axis. We will add this in the revised version as well as highlight the fact above.</p>
<p>Importantly, while values below 50 are deemed non-painful by participants, the thermal stimulation still activates C-fibres involved in nociception, and we would argue that the modelling framework and analysis still applies in this case.</p>
<p>Revised reply: We re-plotted Figure 1E-F with a different exemplary participant, whose rating go above the pain threshold. We also included all participant pain perception and prediction ratings, noxious input sequences and confidence ratings in the supplement in Figures S1-S3.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 3.2 — The method of generating fluctuations in stimulation temperatures, along with the handling of perceptual uncertainty in modelling, requires further elucidation. The current models appear to presume that participants perceive each stimulus accurately, introducing noise only at the response stage. This assumption may fail to capture the inherent uncertainty in the perception of each stimulus intensity, especially when differences in consecutive temperatures are as minimal as 1°C.</p>
</disp-quote>
<p>Initial reply: We agree with the reviewer that there are multiple sources of uncertainty involved in the process of rating the intensity of thermal stimuli - including the perception uncertainty. In order to include an account of inaccurate perception, one would have to consider different sources that contribute to this, which there may be many. In our approach, we consider one, which is captured in the expectation weighted model, more clearly exemplified in the expectation-weighted Kalman-Filter model (eKF). The model assumes participants perception of input as an imperfect indicator of the true level of pain. In this case, it turns out that perception is corrupted as a result of the expectation participants hold about the upcoming stimuli. The extent of this effect is partly governed by a subjective level of noise <italic>ϵ</italic>, which may also subsume other sources of uncertainty beyond the expectation effect. Moreover, the response noise <italic>ξ</italic>, could also subsume any other unexplained sources of noise.</p>
<fig id="sa3fig1">
<label>Author response image 1.</label>
<caption>
<title>Stimulis intensity transformation</title>
</caption>
<graphic mime-subtype="jpg" xlink:href="elife-90634-sa3-fig1.jpg" mimetype="image"/>
</fig>
<p>Revised reply: We clarified our modelling choices in the ”2.2 Modelling strategy” subsection.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 3.3 — A key conclusion drawn is that eKF is a better model than eRL. However, a closer examination of the results reveals that the two models behave very similarly, and it is not clear that they can be readily distinguished based on model recovery and model comparison results.</p>
</disp-quote>
<p>Initial reply: While, the eKF appears to rank higher than the eRL in terms of LOOIC and sigma effects, we don’t wish to make make sweeping statements regarding significance of differences between eRL and eKF, but merely point to the trend in the data. We shall make this clearer in the revised version of the manuscript. However, the most important result is that the models involving expectation-weighing are arguably better capturing the data.</p>
<p>Revised reply: We elaborated on the significance statements in the ”Modelling Results” subsection:</p>
<p>• We considered at least a 2 sigma effect as indication of a significant difference. In each condition, the expectation weighted models (eKF and eRL) provided better fit than models without this element (KF and RL; approx. 2-4 sigma difference, as reported in Figure 5A-D). This suggests that regardless of the levels of volatility and stochasticity, participants still weigh perception of the stimuli with their expectation.</p>
<p>and in the first paragraph of the Discussion:</p>
<p>• When varying different levels of inherent uncertainty in the sequences of stimuli (stochasticity and volatility), the expectation and confidence weighted models fitted the data better than models weighted for confidence but not for expectations (Figure 5A-D). The expectation-weighted bayesian (KF) model offered a better fit than the expectation-weighted, model-free RL model, although in conditions of high stochasticity this difference was short of significance. Overall, this suggests that participants’ expectations play a significant role in the perception of sequences of noxious stimuli.</p>
<p>We are aware of the limitations and lack of clear guidance regarding using sigma effects to establish significance (as per reviewer’s suggestion: <ext-link ext-link-type="uri" xlink:href="https://discourse.mc-stan.org/t/loo-comparison-in-referenceto-standard-error/4009">https://discourse.mc-stan.org/t/loo-comparison-in-referenceto-standard-error/4009</ext-link>). Here we decided to use the above-mentioned threshold of 2-sigma as an indication of significance, but note the potential limitations of the inferences - especially when distinguishing between eRL/eKF models.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 3.4 — Regarding model recovery, the distinction between the eKF and eRL models seems blurred. When the simulation is based on the eKF, there is no ability to distinguish whether either eKF or eRL is better. When the simulation is based on the eRL, the eRL appears to be the best model, but the difference with eKF is small. This raises a few more questions. What is the range of the parameters used for the simulations?</p>
</disp-quote>
<p>Initial reply: We agree that the distinction between eKF and eRL in the model recovery is not that clean-cut, which may in turn point to the similarity between the two models. To simulate the data for the model and parameter recovery analysis, we used the group means and variances estimated on the participant data to sample individual parameter values.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 3.5 — Is it possible that either eRL or eKF are best when different parameters are simulated? Additionally, increasing the number of simulations to at least 100 could provide more convincing model recovery results.</p>
</disp-quote>
<p>Initial reply: It could be a possibility, but would require further investigation and comparison of fits for different bins/ranges of parameters to see if there is any consistent advantage of one model over another is each bin. We will consider adding this analysis, and provide an additional 50 simulations to paint a more convincing picture.</p>
<p>Revised reply: We increased the number of simulations per model pair to ≈ 100 (after rejecting fits based on diagnostics criteria - E-BFMI and divergent transitions) and updated the confusion matrix (Table S4). Although the confusion between eRL and eKF remains, the model recovery shows good distinction between expectation weighted vs non-expectation weighted (and Random) models, which supports our main conclusion in the paper.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 3.6 — Regarding model comparison, the authors reported that ”the expectation-weighted KF model offered a better fit than the eRL, although in conditions of high stochasticity, this difference was short of significance against the eRL model.” This interpretation is based on a significance test that hinges on the ratio between the ELPD and the surrounding standard error (SE). Unfortunately, there’s no agreed-upon threshold of SEs that determines significance, but a general guideline is to consider ”several SEs,” with a higher number typically viewed as more robust. However, the text lacks clarity regarding the specific number of SEs applied in this test. At a cursory glance, it appears that the authors may have employed 2 SEs in their interpretation, while only depicting 1 SE in Figure 4.</p>
</disp-quote>
<p>Initial reply: Indeed, we considered 2 sigma effect as a threshold, however we recognise that there is no agreed-upon threshold, and shall make this and our interpretation clearer regarding the trend in the data, in the revision.</p>
<p>Revised reply: We clarify this further, as per our revised response to Comment 3.3 above. We have also added the following statement in section 4.5.1 (Methods, Model comparison): ”There’s no agreed-upon threshold of SEs that determines significance, but the higher the sigma difference, the more robust is the effect.”</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 3.7 — With respect to parameter recovery, a few additional details could be included for completeness. Specifically, while the range of the learning rate is understandably confined between 0 and 1, the range of other simulated parameters, particularly those without clear boundaries, remains ambiguous. Including scatter plots with the simulated parameters on the xaxis and the recovered parameters on the y-axis would effectively convey this missing information.</p>
<p>Furthermore, it would be beneficial for the authors to clarify whether the same priors were used for both the modelling results presented in the main paper and the parameter recovery presented in the supplementary material.</p>
</disp-quote>
<p>Initial reply: Thanks for this comment and for the suggestions. To simulate the data for the model and parameter recovery analysis, we used the group means and variances estimated on the participant data to sample individual parameter values. The priors on the group and individual-level parameters in the recovery analysis where the same as in the fitting procedure. We will include the requested scatter plots in the next iteration of the manuscript.</p>
<p>Revised reply: We included parameter recovery scatter plots for each model and parameter in the Supplement Figures S7-S11.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 3.8 — While the reliance on R-hat values for convergence in model fitting is standard, a more comprehensive assessment could include estimates of the effective sample size (bulk ESS and/or tail ESS) and the Estimated Bayesian Fraction of Missing Information (EBFMI), to show efficient sampling across the distribution. Consideration of divergences, if any, would further enhance the reliability of the results.</p>
</disp-quote>
<p>Initial reply: Thank you very much for this suggestion, we will aim to include these measures in the revised version.</p>
<p>Revised reply: We have considered the suggested diagnostics and include bulk and tail ESS values for each condition, model, parameter in the Supplement Tables S6-S9. We also report number of chain with low E-BFMI (0), number of divergent transitions (0) and the E-BFMI values per chain in Table S10.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 3.9 — The authors write: ”Going beyond conditioning paradigms based in cuing of pain outcomes, our findings offer a more accurate description of endogenous pain regulation.” Unfortunately, this statement isn’t substantiated by the results. The authors did not engage in a direct comparison between conditioning and sequence-based paradigms. Moreover, even if such a comparison had been made, it remains unclear what would constitute the gold standard for quantifying ”endogenous pain regulation.”</p>
</disp-quote>
<p>Initial reply: This is valid point, indeed we do not compare paradigms in our study, and will remove this statement in the future version.</p>
<p>Revised reply: We have removed this statement from the revised version.</p>
<disp-quote content-type="editor-comment">
<p>Reviewer Comment 3.10 — In relation to the comment on model comparison in my public review, I believe the following link may provide further insight and clarify the basis for my observation. It discusses the use of standard error in model comparison and may be useful for the authors in addressing this particular point: <ext-link ext-link-type="uri" xlink:href="https://discourse.mc-stan.org/t/loo-comparison-in-referenceto-standard-error/4009">https://discourse.mc-stan.org/t/loo-comparison-in-referenceto-standard-error/4009</ext-link></p>
</disp-quote>
<p>Initial reply: Thank you for this suggestion, we will consider the forum discussion in our manuscript.</p>
</body>
</sub-article>
</article>