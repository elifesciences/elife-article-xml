<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">100949</article-id>
<article-id pub-id-type="doi">10.7554/eLife.100949</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.100949.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.5</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>Discovering Root Causal Genes with High Throughput Perturbations</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Strobl</surname>
<given-names>Eric V</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>eric.strobl@pitt.edu</email>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gamazon</surname>
<given-names>Eric R</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/01an3r305</institution-id><institution>University of Pittsburgh</institution></institution-wrap>, <city>Pittsburgh</city>, <country country="US">United States</country></aff>
<aff id="a2"><label>2</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/05dq2gs74</institution-id><institution>Vanderbilt University Medical Center</institution></institution-wrap>, <city>Nashville</city>, <country country="US">United States</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Knowles</surname>
<given-names>David</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Department of Computer Science and Department of Systems Biology</institution>
</institution-wrap>
<city>New York</city>
<country>United States of America</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Moses</surname>
<given-names>Alan M</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>University of Toronto</institution>
</institution-wrap>
<city>Toronto</city>
<country>Canada</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing Interest Statement: The authors have declared no competing interest.</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2024-10-15">
<day>15</day>
<month>10</month>
<year>2024</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2025-02-10">
<day>10</day>
<month>02</month>
<year>2025</year>
</pub-date>
<volume>13</volume>
<elocation-id>RP100949</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-08-13">
<day>13</day>
<month>08</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-08-13">
<day>13</day>
<month>08</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.01.13.574491"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2024-10-15">
<day>15</day>
<month>10</month>
<year>2024</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.100949.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.100949.1.sa3">eLife Assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.100949.1.sa2">Reviewer #1 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.100949.1.sa1">Reviewer #2 (Public review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.100949.1.sa0">Reviewer #3 (Public review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>¬© 2024, Strobl &amp; Gamazon</copyright-statement>
<copyright-year>2024</copyright-year>
<copyright-holder>Strobl &amp; Gamazon</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-100949-v2.pdf"/>
<abstract>
<title>Abstract</title>
<p>Root causal gene expression levels ‚Äì or <italic>root causal genes</italic> for short ‚Äì correspond to the initial changes to gene expression that generate patient symptoms as a downstream effect. Identifying root causal genes is critical towards developing treatments that modify disease near its onset, but no existing algorithms attempt to identify root causal genes from data. RNA-sequencing (RNA-seq) data introduces challenges such as measurement error, high dimensionality and non-linearity that compromise accurate estimation of root causal effects even with state-of-the-art approaches. We therefore instead leverage Perturb-seq, or high throughput perturbations with single cell RNA-seq readout, to learn the causal order between the genes. We then transfer the causal order to bulk RNA-seq and identify root causal genes specific to a given patient for the first time using a novel statistic. Experiments demonstrate large improvements in performance. Applications to macular degeneration and multiple sclerosis also reveal root causal genes that lie on known pathogenic pathways, delineate patient subgroups and implicate a newly defined omnigenic root causal model.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>Further clarification on root causal genes, pathogenesis and the omnigenic root causal model in the Introduction and Discussion; additional experimental results in Supplementary Materials</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p><italic>Root causes of disease</italic> correspond to the most upstream causes of a diagnosis with strong causal effects on the diagnosis. <italic>Pathogenesis</italic> refers to the causal cascade from root causes to the diagnosis. Genetic and non-genetic factors may act as root causes and affect gene expression as an intermediate step during pathogenesis. We introduce root causal gene expression levels ‚Äì or <italic>root causal genes</italic> for short ‚Äì that correspond to the initial changes to <italic>gene expression</italic> induced by genetic and non-genetic root causes that have large causal effects on a downstream diagnosis (<xref rid="fig1" ref-type="fig">Figure 1 (a)</xref>). Root causal genes differ from core genes that directly cause the diagnosis and thus lie at the end, rather than at the beginning, of pathogenesis (<xref ref-type="bibr" rid="c7">Boyle et al., 2017</xref>). Root causal genes also generalize (the expression levels of) driver genes that only account for the effects of somatic mutations primarily in cancer (<xref ref-type="bibr" rid="c35">Mart√≠nez-Jim√©nez et al., 2020</xref>).</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Figure 1.</label>
<caption><p>(a) Toy example where a variable <italic>E</italic><sub>2</sub> simultaneously models genetic and non-genetic root causes that jointly have a large causal effect on a diagnose <italic>Y</italic> through gene expression <inline-formula><inline-graphic xlink:href="574491v5_inline105.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. <italic>E</italic><sub>2</sub> first affects the gene expression level <inline-formula><inline-graphic xlink:href="574491v5_inline106.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, or the root causal gene. The root causal gene then affects other downstream levels during pathogenesis, including the core (or direct causal) gene <inline-formula><inline-graphic xlink:href="574491v5_inline107.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, to ultimately induce a diagnosis <italic>Y</italic>. (b) We hypothesize that the causal effects of most root causes are small, but a few are large (red ellipse), in each patient with disease. As a result, the distribution of these <italic>root causal effects</italic> tends to be right skewed in disease.</p></caption>
<graphic xlink:href="574491v5_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Treating root causal genes can modify disease pathogenesis in its entirety, whereas targeting other causes may only provide symptomatic relief. For example, mutations in Gaucher disease cause decreased expression of wild type beta-glucocerebrosidase, or the root causal gene (<bold><italic>Nagral</italic></bold>, <bold><italic>2014</italic></bold>). We can give a patient blood transfusions to alleviate the fatigue and anemia associated with the disease, but we seek more definitive treatments like recombinant glucocerebrosidase that replaces the deficient enzyme. Enzyme replacement therapy alleviates the associated liver, bone and neurological abnormalities of Gaucher disease as a downstream effect. Identifying root causal genes is therefore critical for developing treatments that eliminate disease near its pathogenic onset.</p>
<p>The problem is further complicated by the existence of complex disease, where a patient may have multiple root causal genes that differ from other patients even within the same diagnostic category (<xref ref-type="bibr" rid="c10">Cano-Gamez and Trynka, 2020</xref>). Complex diseases often have an overwhelming number of causes but, just like a machine usually breaks down due to one or a few root causal problems, the root causal genes may only represent a small subset of the genes because the causal effects of only a few root causes are large (<xref rid="fig1" ref-type="fig">Figure 1 (b)</xref>). We thus also seek to identify <italic>patient-specific</italic> root causal genes in order to classify patients into meaningful biological subgroups each hopefully dictated by only a small group of genes.</p>
<p>No existing method identifies root causal genes from data. Many algorithms focus on discov-ering associational or predictive relations, sometimes visually represented as gene regulatory net-works (<xref ref-type="bibr" rid="c13">Costa-Silva et al., 2017</xref>; <xref ref-type="bibr" rid="c17">Ellington et al., 2023</xref>). Other methods even identify causal relations (<xref ref-type="bibr" rid="c21">Friedman et al., 2000</xref>; <xref ref-type="bibr" rid="c67">Wang et al., 2023</xref>; <xref ref-type="bibr" rid="c69">Wen et al., 2023</xref>; <xref ref-type="bibr" rid="c9">Buschur et al., 2020</xref>), but none pinpoint the <italic>first</italic> gene expression levels that ultimately generate the vast majority of pathogen-esis. Simply learning a causal graph does not resolve the issue because causal graphs do not summarize the effects of <italic>unobserved</italic> root causes, such as unmeasured environmental changes or variants, that are needed to identify all root causal genes. We therefore define the Root Causal Strength (RCS) score to identify all root causal genes unique to each patient. We then design the Root Causal Strength using Perturbations (RCSP) algorithm that estimates RCS from bulk RNA-seq under minimal assumptions by integrating Perturb-seq, or high throughput perturbation experiments using CRISPR-based technologies coupled with single cell RNA-sequencing (<xref ref-type="bibr" rid="c16">Dixit et al., 2016</xref>; <xref ref-type="bibr" rid="c1">Adamson et al., 2016</xref>; <xref ref-type="bibr" rid="c15">Datlinger et al., 2017</xref>). Experiments demonstrate marked improvements in performance, when investigators have access to a large bulk RNA-seq dataset and a genomewide Perturb-seq dataset from a cell line of a disease-relevant tissue. Finally, application of the algorithm to two complex diseases with disparate pathogeneses recovers an <italic>omnigenic root causal model</italic>, where a small set of root causal genes drive pathogenesis but impact many downstream genes within each patient. As a result, nearly all gene expression levels are correlated with the diagnosis at the population level.</p>
</sec>
<sec id="s2">
<title>Results</title>
<p>We briefly summarize the Methods in the first two subsections.</p>
<sec id="s2a">
<title>Definitions</title>
<p><italic>Differential expression analysis</italic> identifies differences in gene expression levels between groups <italic>Y</italic> (<xref ref-type="bibr" rid="c13">Costa-Silva et al., 2017</xref>). A gene <italic>X</italic><sub><italic>i</italic></sub> may be differentially expressed due to multiple reasons. For example, <italic>X</italic><sub><italic>i</italic></sub> may cause <italic>Y</italic>, or a confounder <italic>C</italic> may explain the relation between <italic>X</italic><sub><italic>i</italic></sub> and <italic>Y</italic> such that <italic>X</italic><sub><italic>i</italic></sub> ‚Üê <italic>C</italic> ‚Üí <italic>Y</italic>. In this paper, we take expression analysis a step further by pinpointing <italic>causal</italic> relations from expression levels regardless of the variable type of <italic>Y</italic> (discrete or continuous). We in particular seek to discover <italic>patient-specific root causal genes</italic> from bulk RNA-seq data, which we carefully define below.</p>
<p>We represent a biological system in bulk RNA-seq as a causal graph ùîæ ‚Äì such as in <xref rid="fig2" ref-type="fig">Figure 2 (a)</xref> ‚Äì where <italic>p</italic> vertices <inline-formula><inline-graphic xlink:href="574491v5_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> represent true gene expression levels in a bulk sample and <italic>Y</italic> denotes the patient symptoms or diagnosis. The set <inline-formula><inline-graphic xlink:href="574491v5_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula> contains thousands of genes in practice. Directed edges between the vertices in ùîæ refer to direct causal relations. We assume that gene expression causes patient symptoms but not vice versa so that no edge from <italic>Y</italic> is directed towards <inline-formula><inline-graphic xlink:href="574491v5_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> The set Pa <inline-formula><inline-graphic xlink:href="574491v5_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula> refers to the <italic>parents</italic> of <inline-formula><inline-graphic xlink:href="574491v5_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, or those variables with an edge directed into <inline-formula><inline-graphic xlink:href="574491v5_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. For example, <inline-formula><inline-graphic xlink:href="574491v5_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in <xref rid="fig2" ref-type="fig">Figure 2 (a)</xref>. A <italic>root vertex</italic> corresponds to a vertex with no parents.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Figure 2.</label>
<caption><p>Method overview and synthetic data results. (a) We consider a latent causal graph over the true counts <inline-formula><inline-graphic xlink:href="574491v5_inline108.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. (b) We augment the graph with error terms <bold><italic>E</italic></bold> such that each <italic>E</italic><sub><italic>i</italic></sub> ‚àà <bold><italic>E</italic></bold> in red has an edge directed towards <inline-formula><inline-graphic xlink:href="574491v5_inline109.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. (c) The RCS of <inline-formula><inline-graphic xlink:href="574491v5_inline110.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, denoted by Œ¶<sub>2</sub>, quantifies the magnitude of the <italic>conditional root causal effect</italic>, or the strength of the causal effect from <italic>E</italic><sub>2</sub> to <italic>Y</italic> conditional on <inline-formula><inline-graphic xlink:href="574491v5_inline111.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. (d) We cannot observe <inline-formula><inline-graphic xlink:href="574491v5_inline112.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in practice but instead observe the noisy surrogates <bold><italic>X</italic></bold> in blue corrupted by Poisson measurement error. (e) Perturbing a variable such as <inline-formula><inline-graphic xlink:href="574491v5_inline113.gif" mime-subtype="gif" mimetype="image"/></inline-formula> changes the marginal distributions of downstream variables shown in green under mild conditions. (f) RCSP thus uses the perturbation data to identify (an appropriate superset of) the surrogate parents for each variable in order to compute Œ¶. (g) Violin plots show that RCSP achieved the smallest RMSE to the ground truth RCS values in the synthetic data. (h) RCSP also took about the same amount of time to complete as multivariate regression. Univariate regression only took 11 seconds on average, so its bar is not visible. Error bars denote 95% confidence intervals of the mean. (i) Finally, RCSP maintained low RMSE values regardless of the number of clusters considered.</p></caption>
<graphic xlink:href="574491v5_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>We can associate ùîæ with the structural equation <inline-formula><inline-graphic xlink:href="574491v5_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for each <inline-formula><inline-graphic xlink:href="574491v5_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula> that links each vertex to its parents and error term <italic>E</italic><sub><italic>i</italic></sub> (<bold><italic>Pearl</italic></bold>, <bold><italic>2009</italic></bold>). The error term <italic>E</italic><sub><italic>i</italic></sub> is not simply a regression residual but instead represents the conglomeration of unobserved explanatory variables that only influence <inline-formula><inline-graphic xlink:href="574491v5_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, such as unobserved transcriptional regulators, certain genetic variants and specific environmental conditions. We thus also include the error terms <bold><italic>E</italic></bold> in the directed graph of <xref rid="fig2" ref-type="fig">Figure 2 (b)</xref>. All root vertices are error terms and vice versa. The <italic>root causes</italic> of <italic>Y</italic> are the error terms that cause <italic>Y</italic>, or have a directed path into <italic>Y</italic>. We define the <italic>root causal strength</italic> (RCS) of <inline-formula><inline-graphic xlink:href="574491v5_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula> on <italic>Y</italic> as the following absolute difference (<xref rid="fig2" ref-type="fig">Figure 2 (c)</xref>):
<disp-formula id="eqn1">
<graphic xlink:href="574491v5_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We prove the last equality in the Methods. As a result, RCS Œ¶<sub><italic>i</italic></sub> directly measures the contribution of the gene <inline-formula><inline-graphic xlink:href="574491v5_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula> on <italic>Y</italic> according to its error term <italic>E</italic><sub><italic>i</italic></sub> without recovering the error term values. The algorithm does not impose distributional assumptions or functional restrictions such as additive noise to estimate the error term values as an intermediate step. Moreover Œ¶<sub><italic>i</italic></sub> is patient-specific because the values of <inline-formula><inline-graphic xlink:href="574491v5_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="574491v5_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula> may differ between patients. We have Œ¶<sub><italic>i</italic></sub> = 0 when <italic>E</italic><sub><italic>i</italic></sub> is not a cause of <italic>Y</italic>, and we say that the gene <inline-formula><inline-graphic xlink:href="574491v5_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is a <italic>patient-specific root causal gene</italic> if Œ¶<sub><italic>i</italic></sub> ‚â´ 0, or its (conditional) root causal effect is large as depicted by the red ellipse in <xref rid="fig1" ref-type="fig">Figure 1 (b)</xref>.</p>
</sec>
<sec id="s2b">
<title>Algorithm</title>
<p>We propose an algorithm called Root Causal Strength using Perturbations (RCSP) that estimates Œ¶ = {Œ¶<sub>1</sub>, ‚Ä¶, Œ¶<sub><italic>p</italic></sub>} from genes measured in both bulk RNA-seq and Perturb-seq datasets derived from possibly independent studies but from the same tissue type. We rely on bulk RNA-seq instead of single cell RNA-seq in order to obtain many samples of the label <italic>Y</italic>. We focus on statistical estimation rather than statistical inference because Œ¶<sub><italic>i</italic></sub> &gt; 0 when <italic>E</italic><sub><italic>i</italic></sub> causes <italic>Y</italic> under mild conditions, so we reject the null hypothesis that Œ¶<sub><italic>i</italic></sub> = 0 for many genes if many gene expression levels cause <italic>Y</italic>. However, just like a machine typically breaks down due to only one or a few root causal problems, we hypothesize that only a few genes have large RCS scores Œ¶<sub><italic>i</italic></sub> ‚â´ 0 even in complex disease.</p>
<p>Estimating Œ¶ requires access to the true gene expression levels <inline-formula><inline-graphic xlink:href="574491v5_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and the removal of the effects of confounding. We first control for batch effects representing unwanted sources of technical variation such as different sequencing platforms or protocols. We however can only obtain imperfect counts <bold><italic>X</italic></bold> from RNA sequencing even within each batch (<xref rid="fig2" ref-type="fig">Figure 2 (d)</xref>). Measurement error introduces confounding as well because it prevents us from exactly controlling for the causal effects of the gene expression levels. Investigators usually mitigate measurement error by normalizing the gene expression levels by sequencing depth. We show in the Methods that the Poisson distribution approximates the measurement error distribution induced by the sequencing process to high accuracy (<xref ref-type="bibr" rid="c11">Choudhary and Satija, 2022</xref>; <xref ref-type="bibr" rid="c49">Sarkar and Stephens, 2021</xref>). We leverage this fact to eliminate the need for normalization by sequencing depth using an asymptotic argument where the library size <italic>N</italic> approaches infinity. <italic>N</italic> takes on a value of at least ten million in bulk RNA-seq, but we also empirically verify that the theoretical results hold well in the Supplementary Materials. We thus eliminate the Poisson measurement error and batch effects by controlling for the batches <italic>B</italic> but not <italic>N</italic> in non-linear regression models.</p>
<p>We in particular show that Œ¶<sub><italic>i</italic></sub> in <xref ref-type="disp-formula" rid="eqn1">Equation (1)</xref> is also equivalent to:
<disp-formula id="eqn2">
<graphic xlink:href="574491v5_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="574491v5_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula> refers to the <italic>surrogate parents</italic> of <inline-formula><inline-graphic xlink:href="574491v5_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, or the variables in <bold><italic>X</italic></bold> associated with <inline-formula><inline-graphic xlink:href="574491v5_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. RCSP can identify (an appropriate superset of) the surrogate parents of each variable using perturbation data because perturbing a gene changes the marginal distributions of its downstream effects ‚Äì which the algorithm detects from data under mild assumptions (<xref rid="fig2" ref-type="fig">Figures 2 (e)</xref> and <xref rid="fig2" ref-type="fig">(f)</xref>). The algorithm thus only transfers the binary presence or absence of causal relations from the single cell to bulk data ‚Äì rather than the exact functional relationships ‚Äì in order to remain robust against discrepancies between the two data types; we empirically verify the robustness in the Supplementary Materials. RCSP finally performs the two non-linear regressions needed to estimate <inline-formula><inline-graphic xlink:href="574491v5_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="574491v5_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for each Œ¶<sub><italic>i</italic></sub>. We will compare Œ¶<sub><italic>i</italic></sub> against Statistical Dependence (SD), a measure of correlational strength defined as Œ©<sub><italic>i</italic></sub> = |ùîº(<italic>Y</italic> | <italic>X</italic><sub><italic>i</italic></sub>, <italic>B</italic>) ‚àí ùîº(<italic>Y</italic> | <italic>B</italic>) | where we have removed the conditioning on <inline-formula><inline-graphic xlink:href="574491v5_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
</sec>
<sec id="s2c">
<title>In silico identification of root causal genes</title>
<p>We simulated 30 bulk RNA-seq and Perturb-seq datasets from random directed graphs summarizing causal relations between gene expression levels. We performed single gene knock-down perturbations over 2500 genes and 100 batches. We obtained 200 cell samples from each perturbation, and another 200 controls without perturbations. We therefore generated a total of 2501 √ó 200 = 500, 200 single cell samples for each Perturb-seq dataset. We simulated 200 bulk RNA-seq samples. We compared RCSP against the Additive Noise Model (ANM) (<xref ref-type="bibr" rid="c45">Peters et al., 2014</xref>; <bold><italic>Strobl and Lasko, 2023a</italic></bold>), the Linear Non-Gaussian Acyclic Model (LiNGAM) (<xref ref-type="bibr" rid="c45">Peters et al., 2014</xref>; <xref ref-type="bibr" rid="c60">Strobl and Lasko, 2022</xref>), CausalCell (<xref ref-type="bibr" rid="c69">Wen et al., 2023</xref>), univariate regression residuals (Uni Reg), and multivariate regression residuals (Multi Reg). The first two algorithms are state-of-the-art approaches used for error term extraction and, in theory, root causal discovery. See Methods for comprehensive descriptions of the simulation setup and comparator algorithms.</p>
<p>We summarize accuracy results in <xref rid="fig2" ref-type="fig">Figure 2 (g)</xref> using the Root Mean Squared Error (RMSE) to the ground truth Œ¶ values. All statements about pairwise differences hold true at a Bonferonni corrected threshold of 0.05/5 according to paired two-sided t-tests, since we compared RCSP against a total of five algorithms. RCSP estimated Œ¶ most accurately by a large margin. ANM and LiNGAM are theoretically correct under their respective assumptions, but they struggle to outperform standard multivariate regression due to the presence of measurement error in RNA-seq (Supplementary Materials). Feature selection and causal discovery with CausalCell did not improve performance. Univariate regression performed the worst, since it does not consider the interactions between variables. RCSP achieved the lowest RMSE while completing in about the same amount of time as multivariate regression on average (<xref rid="fig2" ref-type="fig">Figure 2 (h)</xref>). RCSP maintained the lowest RMSE even in the cyclic case, and the performance of the algorithm remained robust to differences between the directed graphs underlying the bulk RNA-seq and Perturb-seq data (Supplementary Materials). We conclude that RCSP both scalably and accurately estimates Œ¶.</p>
<p>We will cluster the RCS values in real data to find patient subgroups. We therefore also performed hierarchical clustering using Ward‚Äôs method (<xref ref-type="bibr" rid="c68">Ward Jr, 1963</xref>) on the values of Œ¶ estimated by RCSP with the synthetic data. We then computed the RMSEs and averaged them within each cluster. We found that RCSP maintained low average RMSE values regardless of the number of clusters considered (<xref rid="fig2" ref-type="fig">Figure 2 (i)</xref>). We conclude that RCSP maintains accurate estimation of Œ¶ across different numbers of clusters.</p>
</sec>
<sec id="s2d">
<title>Oxidative stress in age-related macular degeneration</title>
<p>We ran RCSP on a bulk RNA-seq dataset of 513 individuals with age-related macular degeneration (AMD; GSE115828) and a Perturb-seq dataset of 247,914 cells generated from an immortalized retinal pigment epithelial (RPE) cell line (<xref ref-type="bibr" rid="c46">Ratnapriya et al., 2019</xref>; <xref ref-type="bibr" rid="c48">Replogle et al., 2022</xref>). The Perturbseq dataset contains knockdown experiments of 2,077 genes overlapping with the genes of the bulk dataset. We set the target <italic>Y</italic> to the Minnesota Grading System score, a measure of the severity of AMD based on stereoscopic color fundus photographs. We always included age and sex as a biological variable as covariates. We do not have access to the ground truth values of Œ¶ in real data, so we evaluated RCSP using seven alternative techniques. See Methods for a detailed rationale of the evaluation of real data. RCSP outperformed all other algorithms in this dataset (Supplementary Materials). We therefore only analyze the output of RCSP in detail here.</p>
<p>AMD is a neurodegenerative disease of the aging retina (<xref ref-type="bibr" rid="c27">Hadziahmetovic and Malek, 2021</xref>), so age is a known root cause of the disease. We therefore determined if RCSP identified age as a root cause. Note that RCSP does not need perturbation data of age to compute the RCS values of age, since age has no parents in the directed graph. The algorithm estimated a heavy tailed distribution of the RCS values indicating that most of the RCS values deviated away from zero (<xref rid="fig3" ref-type="fig">Figure 3 (a)</xref>). The Deviation of the RCS (D-RCS), or the standard deviation from an RCS value of zero, measures the tailedness of the distribution while preserving the unit of measurement. The D-RCS of age corresponded to 0.46 ‚Äì more than double that of the nearest gene (<xref rid="fig3" ref-type="fig">Figure 3 (d)</xref>). We conclude that RCSP correctly detected age as a root cause of AMD.</p>
<fig id="fig3" position="float" fig-type="figure">
<label>Figure 3.</label>
<caption><p>Analysis of AMD. (a) The distribution of the RCS scores of age deviated away from zero and had a composite D-RCS of 0.46. (b) However, the majority of gene D-RCS scores concentrated around zero, whereas the majority of gene D-SD scores concentrated around the relatively larger value of 0.10. Furthermore, the D-RCS scores of the genes in (d) mapped onto the ‚Äúamino acid transport across the plasma membrane‚Äù pathway known to be involved in the pathogenesis of AMD in (c). Blue bars survived 5% FDR correction. (e) Drug enrichment analysis revealed four significant drugs, the later three of which have therapeutic potential. (f) Hierarchical clustering revealed four clear clusters according to the elbow method, which we plot by UMAP dimensionality reduction in (g). The RCS scores of the top genes in (d) increased only from the left to right on the first UMAP dimension (x-axis); we provide an example of SLC7A5 in (h) and one of three detected exceptions in (i). We therefore performed pathway enrichment analysis on the black cluster in (g) containing the largest RCS scores. (j) The amino acid transport pathway had a larger degree of enrichment in the black cluster as compared to the global analysis in (c).</p></caption>
<graphic xlink:href="574491v5_fig3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>Root causal genes typically affect many downstream genes before affecting <italic>Y</italic>. We therefore expect to identify few root causal genes but many genes that correlate with <italic>Y</italic>. To evaluate this hypothesis, we examined the distribution of D-RCS relative to the distribution of the Deviation of Statistical Dependence (D-SD), or the standard deviation from an SD value of zero, in <xref rid="fig3" ref-type="fig">Figure 3 (b)</xref>. Notice that the histogram of D-RCS scores in <xref rid="fig3" ref-type="fig">Figure 3 (b)</xref> mimics a folded distribution of <xref rid="fig1" ref-type="fig">Figure 1 (b)</xref>. Thus, few D-RCS scores had large values implying the existence of only a few root causal genes. In contrast, most of the D-SD scores had relatively larger values concentrated around 0.10 implying the existence of many genes correlated with <italic>Y</italic>. We conclude that RCSP identified few root causal genes rather than many correlated genes for AMD.</p>
<p>The pathogenesis of AMD involves the loss of RPE cells. The RPE absorbs light in the back of the retina, but the combination of light and oxygen induces oxidative stress, and then a cascade of events such as immune cell activation, cellular senescence, drusen accumulation, neovascularization and ultimately fibrosis (<xref ref-type="bibr" rid="c3">Barouch and Miller, 2007</xref>). We therefore expect the root causal genes of AMD to include genes involved in oxidative stress during early pathogenesis. The gene MIPEP with the highest D-RCS score in <xref rid="fig3" ref-type="fig">Figure 3 (d)</xref> indeed promotes the maturation of oxidative phosphorylation-related proteins (<xref ref-type="bibr" rid="c52">Shi et al., 2011</xref>). The second gene SLC7A5 is a solute carrier that activates mTORC1 whose hyperactivation increases oxidative stress via lipid peroxidation (<xref ref-type="bibr" rid="c36">Nachef et al., 2021</xref>; <xref ref-type="bibr" rid="c23">Go et al., 2020</xref>). The gene HEATR1 is involved in ribosome biogenesis that is downregulated by oxidative stress (<xref ref-type="bibr" rid="c66">Turi et al., 2018</xref>). The top genes discovered by RCSP thus identify pathways known to be involved in oxidative stress. We further verified that measurement error did not explain their large D-RCS scores in Supplementary Materials.</p>
<p>We subsequently jointly analyzed the D-RCS values of all 2077 genes. We performed pathway enrichment analysis that yielded one pathway ‚Äúamino acid transport across the plasma membrane‚Äù that passed an FDR threshold of 5% (<xref rid="fig3" ref-type="fig">Figure 3 (c)</xref>). The leading edge genes of the pathway included the solute carriers SLC7A5 and SLC1A5. These two genes function in conjunction to increase the efflux of essential amino acids out of the lysosome (<xref ref-type="bibr" rid="c40">Nicklin et al., 2009</xref>; <xref ref-type="bibr" rid="c5">Beaumatin et al., 2019</xref>). Some of these essential amino acids like L-leucine and L-arginine activate mTORC1 that in turn increases lipid peroxidation induced oxidative stress and the subsequent degeneration of the RPE (<xref ref-type="bibr" rid="c36">Nachef et al., 2021</xref>; <xref ref-type="bibr" rid="c23">Go et al., 2020</xref>). We conclude that pathway enrichment analysis correctly identified solute carrier genes involved in a known pathway promoting oxidative stress in AMD.</p>
<p>We next ran drug enrichment analysis with the D-RCS scores. The top compound arsenous acid inhibits RPE proliferation (<xref ref-type="bibr" rid="c65">Su et al., 2020</xref>), but the other three significant drugs have therapeutic potential (<xref rid="fig3" ref-type="fig">Figure 3 (e)</xref>). Busulfan decreases the requirement for intravitreal anti-VEGF injections (<xref ref-type="bibr" rid="c14">Dalvin et al., 2022</xref>). Genistein is a protein kinase inhibitor that similarly attenuates neovascularization (<xref ref-type="bibr" rid="c31">Kinoshita et al., 2014</xref>) and blunts the effect of ischemia on the retina (<xref ref-type="bibr" rid="c29">Kamalden et al., 2011</xref>). Finally, a metabolite of the antiviral agent 3‚Äô-azido-3‚Äô-deoxythymidine inhibits neovascularization and mitigates RPE degeneration (<xref ref-type="bibr" rid="c38">Narendran et al., 2020</xref>). We conclude that the D-RCS scores identified promising drugs for the treatment of AMD.</p>
<p>Hierarchical clustering and UMAP dimensionality reduction on the patient-specific RCS values revealed four clear clusters of patients by the elbow method on the sum of squares plot (<xref rid="fig3" ref-type="fig">Figures 3 (f)</xref> and <xref rid="fig3" ref-type="fig">(g)</xref>, respectively). The RCS scores of most of the top genes exhibited a clear gradation increasing only from the left to the right hand side of the UMAP embedding; we plot an example in <xref rid="fig3" ref-type="fig">Figure 3 (h)</xref>. We found three exceptions to this rule among the top 30 genes (example in <xref rid="fig3" ref-type="fig">Figure 3 (i)</xref> and see Supplementary Materials). RCSP thus detected genes with large RCS scores primarily in the black cluster of <xref rid="fig3" ref-type="fig">Figure 3 (g)</xref>. Pathway enrichment analysis within this cluster alone yielded supra-significant results on the same pathway detected in the global analysis (<xref rid="fig3" ref-type="fig">Figure 3 (j)</xref> versus <xref rid="fig3" ref-type="fig">Figure 3 (c)</xref>). Furthermore, drug enrichment analysis results by cluster confirmed that patients in the black cluster with many root causal genes are likely the hardest to treat (Supplementary Materials). We conclude that RCSP detected a subgroup of patients whose root causal genes have large RCS scores and involve known pathogenic pathways related to oxidative stress.</p>
</sec>
<sec id="s2e">
<title>T cell infiltration in multiple sclerosis</title>
<p>We next ran RCSP on 137 samples collected from CD4+ T cells of multiple sclerosis (MS; GSE137143) as well as Perturb-seq data of 1,989,578 undifferentiated blast cells that can be induced to differentiate into lymphoblasts, or the precursors of T cells and other lymphocytes (<xref ref-type="bibr" rid="c30">Kim et al., 2021</xref>; <xref ref-type="bibr" rid="c48">Replogle et al., 2022</xref>). We set the target <italic>Y</italic> to the Expanded Disability Status Scale score, a measure of MS severity. RCSP outperformed all other algorithms in this dataset as well (Supplementary Materials).</p>
<p>MS progresses over time, and RCSP correctly detected age as a root cause of MS severity with RCS values deviating away from zero (<xref rid="fig4" ref-type="fig">Figure 4 (a)</xref>). The distribution of gene D-RCS scores concentrated around zero with a long tail, whereas the distribution of gene D-SD scores concentrated around a relatively larger value of 0.3 (<xref rid="fig4" ref-type="fig">Figure 4 (b)</xref>). RCSP thus detected an omnigenic root causal model with a few root causal genes but many correlated genes.</p>
<fig id="fig4" position="float" fig-type="figure">
<label>Figure 4.</label>
<caption><p>Analysis of MS. (a) The distribution of the RCS scores of age deviated away from zero with a composite D-RCS of 0.55. (b) The distribution of D-RCS concentrated around zero, whereas the distribution of D-SD concentrated around 0.3. (d) RCSP identified many genes with large D-RCS scores that in turn mapped onto known pathogenic pathways in MS in (c). Hierarchical clustering revealed three clusters in (e), which we plot in two dimensions with UMAP in (f). Top genes did not correlate with either dimension of the UMAP embedding; we provide an example of the MNT gene in (g). (h) Drug enrichment analysis in the green cluster implicated multiple cathepsin inhibitors. Finally, EPH-ephrin signaling survived FDR correction in (c) and was enriched in the pink cluster in (i) which contained more MS patients with the relapsing-remitting subtype in (j); subtypes include relapse-remitting (RR), primary progressive (PP), secondary progressive (SP), clinically isolated syndrome (CIS), and radiologically isolated syndrome (RIS).</p></caption>
<graphic xlink:href="574491v5_fig4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>MS is an inflammatory neurodegenerative disease that damages the myelin sheaths of nerve cells in the brain and spinal cord. T cells may mediate the inflammatory process by crossing a disrupted blood brain barrier and repeatedly attacking the myelin sheaths (<xref ref-type="bibr" rid="c19">Fletcher et al., 2010</xref>). Damage induced by the T cells also perturbs cellular homeostasis and leads to the accumulation of misfolded proteins (<xref ref-type="bibr" rid="c2">Andhavarapu et al., 2019</xref>). The root causal genes of MS thus likely include genes involved in T cell infiltration across the blood brain barrier.</p>
<p>Genes with the highest D-RCS scores included MNT, CERCAM and HERPUD2 (<xref rid="fig4" ref-type="fig">Figure 4 (d)</xref>). MNT is a MYC antagonist that modulates the proliferative and pro-survival signals of T cells after engagement of the T cell receptor (<xref ref-type="bibr" rid="c22">Gnanaprakasam and Wang, 2017</xref>). Similarly, CERCAM is an adhesion molecule expressed at high levels in microvessels of the brain that increases leukocyte transmigration across the blood brain barrier (<xref ref-type="bibr" rid="c57">Starzyk et al., 2000</xref>). HERPUD2 is involved in the endoplasmic-reticulum associated degradation of unfolded proteins (<xref ref-type="bibr" rid="c32">Kokame et al., 2000</xref>). Genes with the highest D-RCS scores thus serve key roles in known pathogenic pathways of MS.</p>
<p>We found multiple genes with high D-RCS scores in MS, in contrast to AMD where age dominated (<xref rid="fig4" ref-type="fig">Figure 4 (d)</xref> versus <xref rid="fig3" ref-type="fig">Figure 3 (d)</xref>). Measurement error did not account for the high scores (Supplementary Materials). We performed pathway enrichment analysis using the D-RCS scores of all genes and discovered two significant pathways at an FDR corrected threshold of 5%: ‚Äúadenomatous polyposis coli (APC) truncation mutants have impaired AXIN binding‚Äù and ‚ÄúEPH-ephrin signaling‚Äù (<xref rid="fig4" ref-type="fig">Figure 4 (c)</xref>). APC and AXIN are both members of the Wnt signaling pathway and regulate levels of beta-catenin (<xref ref-type="bibr" rid="c54">Spink et al., 2000</xref>). Furthermore, inhibition of Wnt/beta-catenin causes CD4+ T cell infiltration into the central nervous system via the blood brain barrier in MS (<xref ref-type="bibr" rid="c33">Lengfeld et al., 2017</xref>). Ephrins similarly regulate T cell migration into the central nervous system (<xref ref-type="bibr" rid="c34">Luo et al., 2016</xref>) and are overexpressed in MS lesions (<xref ref-type="bibr" rid="c53">Sobel, 2005</xref>). The APC-AXIN and EPH-ephrin pathways are thus consistent with the known pathophysiology of central nervous system T cell infiltration in MS.</p>
<p>We subsequently performed hierarchical clustering of the RCS scores. The within cluster sum of squares plot in <xref rid="fig4" ref-type="fig">Figure 4 (e)</xref> revealed the presence of three clusters by the elbow method. We plot the three clusters in a UMAP embedding in <xref rid="fig4" ref-type="fig">Figure 4 (f)</xref>. The clusters did not show a clear relationship with MS symptom severity (Supplementary Materials) or the levels of the top most genes of <xref rid="fig4" ref-type="fig">Figure 4 (d)</xref>; we plot the MNT gene as an example in <xref rid="fig4" ref-type="fig">Figure 4 (g)</xref>. However, further analyses with additional genes revealed that the distribution of many lower ranked genes governed the structure of the UMAP embedding (Supplementary Materials). The D-RCS scores of each cluster also implicated different mechanisms of T cell pathology including APC-AXIN in the green cluster, disturbed T cell homeostasis in the pink cluster and platelet enhanced T cell autoreactivity in the blue cluster (Supplementary Materials).</p>
<p>Global drug enrichment analysis did not yield any significant drugs even at a liberal FDR thresh-old of 10%. We thus ran drug enrichment analysis in each cluster of <xref rid="fig4" ref-type="fig">Figure 4 (f)</xref>. The blue and pink clusters again did not yield significant drugs. However, the third green cluster identified the cysteine cathepsin inhibitors dipeptide-derived nitriles, phenylalinine derivatives, e-64, L-006235 and L-873724 (<xref rid="fig4" ref-type="fig">Figure 4 (h)</xref>); statistical significance of the first three held even after correcting for multiple comparisons with the Bonferroni adjustment of 0.05/4 on the q-values. The leading edge genes of the significant drugs included the cathepsins CTSL, CTSS and CTSB exclusively. These drug enrichment results corroborate multiple experimental findings highlighting the therapeutic efficacy of cathepsin inhibitors in a subgroup of MS patients responsive to interferon therapy (<xref ref-type="bibr" rid="c28">Haves-Zburof et al., 2011</xref>; <xref ref-type="bibr" rid="c8">Burster et al., 2007</xref>).</p>
<p>Prior research has also shown that EPH-ephrin signaling is more prevalent in relapsing-remitting multiple sclerosis than in other subtypes of the disease (<xref ref-type="bibr" rid="c24">Golan et al., 2021</xref>). EPH-ephrin signaling survived FDR correction in our analysis (<xref rid="fig4" ref-type="fig">Figure 4 (c)</xref>). Furthermore, the pathway was more enriched in the pink cluster than in the other two (<xref rid="fig4" ref-type="fig">Figure 4 (i)</xref>). The pink cluster indeed contained a higher proportion of patients with the relapsing-remitting subtype (<xref rid="fig4" ref-type="fig">Figure 4 (j)</xref>). RCSP thus precisely identified the enrichment of EPH-ephrin signaling in the correct subtype of MS.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>We presented a framework for identifying root causal genes, or the gene expression levels directly regulated by root causes with large causal effects on <italic>Y</italic>, by modeling the root causes using the error terms of structural equation models. Each error term represents the conglomeration of unobserved root causes, such as genetic variants or environmental conditions, that directly cause a specific gene. We however do not have access to many of the error terms in practice, so we introduced the root causal strength (RCS) score, or the magnitude of the conditional causal effect of each error term, which we can compute using gene expression levels alone. The RCSP algorithm computes RCS given knowledge of the causal ancestors of each variable, which we obtained by Perturb-seq. RCSP only transfers the causal structure (binary cause-effect relations) from the single cell to bulk data rather than the exact functional relationships in order to remain robust against discrepancies between the two data types. Results with the synthetic data demonstrated marked improvements over existing alternatives. The algorithm also recovered only a few root causal genes that play key roles in known pathogenic pathways and implicate therapeutic drugs in both AMD and MS.</p>
<p>We detected a modest number of root causal genes in both AMD and MS, but virtually all genes were correlated with <italic>Y</italic>. This omnigenic model, where ‚Äúomni-‚Äù refers to the nearly all genes correlated with <italic>Y</italic>, differs from the omnigenic model involving <italic>core genes</italic> (<xref ref-type="bibr" rid="c7">Boyle et al., 2017</xref>). Boyle et al. define core genes as genes that directly affect disease risk. The authors further elaborate that many <italic>peripheral genes</italic> affect the functions of a modest number of core genes, so the peripheral genes often explain most of disease heritability. In contrast, root causal genes may not directly cause <italic>Y</italic> but lie substantially upstream of <italic>Y</italic> in the causal graph. The error terms of upstream root causal genes affect many downstream genes that include both ancestors and non-ancestors of <italic>Y</italic> (<xref rid="fig5" ref-type="fig">Figure 5</xref>). These downstream genes contain traces of the root causal gene error terms that induce the many correlations with <italic>Y</italic>. The root causal model thus assumes sparsity in upstream root causal genes, whereas the core gene model assumes sparsity in the downstream direct causal genes (The omnigenic root causal model makes no statement about the number of direct causal genes, so direct causal genes may be sparse or dense). Further, each causal genetic variant tends to have only a small effect on disease risk in complex disease because the variant can directly cause <italic>Y</italic> or directly cause any causal gene including those with small root causal effects on <italic>Y</italic>; thus, all error terms that cause <italic>Y</italic> can model genetic effects on <italic>Y</italic>. However, the root causal model further elaborates that genetic <italic>and non-genetic factors</italic> often combine to produce a few root causal genes with large root causal effects, where non-genetic factors typically account for the majority of the large effects in complex disease. Many variants may therefore cause many genes in diseases with only a few root causal genes. We finally emphasize that the root causal model accounts for all deleterious effects of the root causal genes, whereas the core gene model only captures the deleterious effects captured by the diagnosis <italic>Y</italic>. For example, the <italic>disease</italic> of diabetes causes retinopathy, but retinopathy is not a part of the diagnostic criteria of diabetes. As a result, the gene expression levels that cause retinopathy but not the <italic>diagnosis</italic> of diabetes are not core genes, even though they are affected by the root causal genes. The sparsity of the root causal genes, the focus on the combined effects of genetic and non-genetic root causes, and the ability to account for root causal effects not represented by the target <italic>Y</italic> motivate us to use the phrase <italic>omnigenic root causal model</italic> in order to distinguish it from the omnigenic core gene model.</p>
<fig id="fig5" position="float" fig-type="figure">
<label>Figure 5.</label>
<caption><p>In this example, two root causal genes <inline-formula><inline-graphic xlink:href="574491v5_inline114.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="574491v5_inline115.gif" mime-subtype="gif" mimetype="image"/></inline-formula> affect many downstream genes and ultimately cause <italic>Y</italic>. Thus all genes <inline-formula><inline-graphic xlink:href="574491v5_inline116.gif" mime-subtype="gif" mimetype="image"/></inline-formula> correlate with <italic>Y</italic>, but only <inline-formula><inline-graphic xlink:href="574491v5_inline117.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="574491v5_inline118.gif" mime-subtype="gif" mimetype="image"/></inline-formula> have large root causal effects on <italic>Y</italic>. The omnigenic root causal model posits that only a few root causal genes affect many downstream genes, so that nearly all genes are correlated with <italic>Y</italic>. Causal genetic variants can directly cause <italic>Y</italic> or cause any gene expression level that causes <italic>Y</italic> ‚Äì including those with small root causal effects ‚Äì but only <inline-formula><inline-graphic xlink:href="574491v5_inline119.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="574491v5_inline120.gif" mime-subtype="gif" mimetype="image"/></inline-formula> have large root causal effects on <italic>Y</italic> due to genetic <italic>and non-genetic</italic> root causes modeled by <italic>E</italic><sub>1</sub> and <italic>E</italic><sub>2</sub>. In contrast, the core gene model assumes only a few direct causal genes <inline-formula><inline-graphic xlink:href="574491v5_inline121.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. These core genes do not account for the deleterious causal effects of <italic>E</italic><sub>1</sub> and <italic>E</italic><sub>2</sub> on <inline-formula><inline-graphic xlink:href="574491v5_inline122.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="574491v5_inline123.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p></caption>
<graphic xlink:href="574491v5_fig5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>We identified root causal genes without imposing parametric assumptions using the RCS metric. Prior measures of root causal effect require restrictive functional relations, such as linear relations or additive noise, and continuous random variables (<xref ref-type="bibr" rid="c58">Strobl and Lasko, 2022</xref>; <xref ref-type="bibr" rid="c64">Strobl et al., 2024</xref>; <bold><italic>Strobl and Lasko, 2023a</italic></bold>). These restrictions ensure exact identifiability of the underlying causal graph and error terms. However, real RNA-seq is obtained from a noisy sequencing process and contains count data arguably corrupted by Poisson measurement error (<xref ref-type="bibr" rid="c49">Sarkar and Stephens, 2021</xref>). The Poisson measurement error introduces confounding that precludes exact recovery of the underlying error terms. The one existing root causal discovery method that can handle Poisson measurement error uses single cell RNA-seq, estimates negative binomial distribution parameters and cannot scale to the thousands of genes required for meaningful root causal detection (<bold><italic>Strobl and Lasko, 2023b</italic></bold>). RCSP rectifies the deficiencies of these past approaches by ensuring accurate root causal detection even in the presence of the counts, measurement error and high dimensionality of RNA-seq.</p>
<p>This study carries other limitations worthy of addressing in future work. The RCS score importantly quantifies root causal strength rather than root causal effect. As a result, the method cannot be used to identify the direction of root causal effect unconditional on the parents. The root causal effect and signed RCS (or expected conditional root causal effect) do not differ by much in practice (Supplementary Materials), but future work may focus on exactly identifying both the strength and direction of the unconditional causal effects of the error terms. Furthermore, RCS achieves patient but not cell-specificity because the algorithm relies on phenotypic labels obtained from bulk RNAseq. RCSP thus cannot identify the potentially different root causal genes present within distinct cell populations. Modern genome-wide Perturb-seq datasets also adequately perturb and measure only a few thousand, rather than all, gene expression levels. RCSP can only identify root causal genes within this perturbed and measured subset. Fourth, RCSP accounts for known batch effects and measurement error but cannot adjust for unknown confounding. Finally, RCSP assumes a directed acyclic graph. We can transform a directed graph with cycles into an acyclic one under equilibrium, but real biological distributions vary across time (<xref ref-type="bibr" rid="c56">Spirtes, 1995</xref>; <xref ref-type="bibr" rid="c6">Bongers et al., 2021</xref>). Future work should thus aim to estimate cell-specific root causal effects under latent confounding and time-varying distributions.</p>
<p>In conclusion, RCSP integrates bulk RNA-seq and Perturb-seq to identify patient-specific root causal genes under a principled causal inference framework using the RCS score. RCS quantifies root causal strength implicitly without requiring normalization by sequencing depth or direct access to the error terms of a structural equation model. The algorithm identifies the necessary causal relations to compute RCS using reliable high throughput perturbation data rather than observational data alone. The RCS scores often suggest an omnigenic root causal model of disease. Enrichment analyses with the RCS scores frequently reveal pathogenic pathways and drug candidates. We conclude that RCSP is a novel, accurate, scalable and disease-agnostic procedure for performing patient-specific root causal gene discovery.</p>
</sec>
<sec id="s4">
<title>Methods and Materials</title>
<sec id="s4a">
<title>Background on Causal Discovery</title>
<p>We denote a singleton variable like <inline-formula><inline-graphic xlink:href="574491v5_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with italics and sets of variables like <inline-formula><inline-graphic xlink:href="574491v5_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with bold italics. We can represent a causal process using a <italic>structural equation model</italic> (SEM) linking the <italic>p</italic> + 1 variables in <inline-formula><inline-graphic xlink:href="574491v5_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula> using a series of deterministic functions:
<disp-formula id="eqn3">
<graphic xlink:href="574491v5_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>f</italic><sub><italic>i</italic></sub> is a function of the <italic>parents</italic>, or direct causes, of <italic>Z</italic><sub><italic>i</italic></sub> and an error term <italic>E</italic><sub><italic>i</italic></sub> ‚àà <bold><italic>E</italic></bold>. The error terms <bold><italic>E</italic></bold> are mutually independent. We will use the terms <italic>vertex</italic> and <italic>variable</italic> interchangeably. A <italic>root vertex</italic> corresponds to a vertex without any parents. On the other hand, a <italic>terminal</italic> or <italic>sink vertex</italic> is not a parent of any other vertex.</p>
<p>We can associate a directed graph to <bold><italic>Z</italic></bold> by drawing a directed edge from each member of Pa(<italic>Z</italic><sub><italic>i</italic></sub>) to <italic>Z</italic><sub><italic>i</italic></sub> for all <italic>Z</italic><sub><italic>i</italic></sub> ‚àà <bold><italic>Z</italic></bold>. A <italic>directed path</italic> from <italic>Z</italic><sub><italic>i</italic></sub> to <italic>Z</italic><sub>j</sub> corresponds to a sequence of adjacent directed edges from <italic>Z</italic><sub><italic>i</italic></sub> to <italic>Z</italic><sub>j</sub>. If such a path exists (or <italic>Z</italic><sub><italic>i</italic></sub> = <italic>Z</italic><sub>j</sub>), then <italic>Z</italic><sub><italic>i</italic></sub> is an <italic>ancestor</italic> of <italic>Z</italic><sub>j</sub> and <italic>Z</italic><sub>j</sub> is a <italic>descendant</italic> of <italic>Z</italic><sub><italic>i</italic></sub>. We collate all ancestors of <italic>Z</italic><sub><italic>i</italic></sub> into the set Anc(<italic>Z</italic><sub><italic>i</italic></sub>). A <italic>cycle</italic> occurs when there exists a directed path from <italic>Z</italic><sub><italic>i</italic></sub> to <italic>Z</italic><sub>j</sub> and the directed edge <italic>Z</italic><sub>j</sub> ‚Üí <italic>Z</italic><sub><italic>i</italic></sub>. A <italic>directed acyclic graph</italic> (DAG) contains no cycles. We <italic>augment</italic> a directed graph by including additional vertices <bold><italic>E</italic></bold> and drawing a directed edge from each <italic>E</italic><sub><italic>i</italic></sub> ‚àà <bold><italic>E</italic></bold> to <italic>X</italic><sub><italic>i</italic></sub> except when <italic>X</italic><sub><italic>i</italic></sub> = <italic>E</italic><sub><italic>i</italic></sub> is already a root vertex. We consider an augmented DAG ùîæ throughout the remainder of this manuscript.</p>
<p>The vertices <italic>Z</italic><sub><italic>i</italic></sub> and <italic>Z</italic><sub>j</sub> are <italic>d-connected</italic> given <bold><italic>W</italic></bold> ‚äÜ <bold><italic>Z</italic></bold> \{<italic>Z</italic><sub><italic>i</italic></sub>, <italic>Z</italic><sub>j</sub>} in ùîæ if there exists a path between <italic>Z</italic><sub><italic>i</italic></sub> and <italic>Z</italic><sub>j</sub> such that every collider on the path is an ancestor of <bold><italic>W</italic></bold> and no non-collider is in <bold><italic>W</italic></bold>. The vertices are <italic>d-separated</italic> if they are not d-connected. Any DAG associated with the SEM in <xref ref-type="disp-formula" rid="eqn3">Equation (3)</xref> also obeys the <italic>global Markov property</italic> where <italic>Z</italic><sub><italic>i</italic></sub> and <italic>Z</italic><sub>j</sub> are conditionally independent given <bold><italic>W</italic></bold> if they are d-separated given <bold><italic>W</italic></bold>. The term <italic>d-separation faithfulness</italic> refers to the converse of the global Markov property where conditional independence implies d-separation. A distribution obeys <italic>unconditional d-separation faithfulness</italic> when we can only guarantee d-separation faithfulness when <bold><italic>W</italic></bold> = ‚àÖ.</p>
</sec>
<sec id="s4b">
<title>Causal Modeling of RNA Sequencing</title>
<p>Performing causal discovery requires careful consideration of the underlying generative process. We therefore propose a causal model for RNA-seq. We differentiate between the biology and the RNA sequencing technology.</p>
<p>We represent a snapshot of a biological causal process using an SEM over <inline-formula><inline-graphic xlink:href="574491v5_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula> obeying <xref ref-type="disp-formula" rid="eqn3">Equation (3)</xref>. We assume that the phenotypic target <italic>Y</italic> is a terminal vertex so that gene expression causes phenotype but not vice versa. Each <inline-formula><inline-graphic xlink:href="574491v5_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula> corresponds to the total number of RNA molecules of a unique gene in a single cell or bulk tissue sample. The error terms model root causes that are outside of gene expression, such as genetic variation or environmental factors. Moreover, the relation from gene expression to <italic>Y</italic> is stochastic because <italic>Y</italic> = <italic>f</italic><sub><italic>Y</italic></sub> (Pa(<italic>Y</italic>), <italic>E</italic><sub><italic>Y</italic></sub>), where <italic>E</italic><sub><italic>Y</italic></sub> introduces the stochasticity. Two individuals may therefore have the exact same error term values over <inline-formula><inline-graphic xlink:href="574491v5_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula> but different instantiations of <italic>Y</italic>.</p>
<p>We unfortunately cannot observe <inline-formula><inline-graphic xlink:href="574491v5_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in practice but instead measure a corrupted count <bold><italic>X</italic></bold> using single cell or bulk RNA-seq technology. We derive the measurement error distribution from first principles. We map an exceedingly small fraction of each <inline-formula><inline-graphic xlink:href="574491v5_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula> within a sample at unequal coverage. Let <italic>œÄ</italic><sub><italic>i</italic>j</sub> denote the probability of mapping one molecule of <inline-formula><inline-graphic xlink:href="574491v5_inline31.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in batch j so that <inline-formula><inline-graphic xlink:href="574491v5_inline32.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is near zero. The law of rare events (<xref rid="c43" ref-type="bibr">Papoulis, 1984</xref>) implies that the Poisson distribution wellapproximates the library size <italic>N</italic> so that <inline-formula><inline-graphic xlink:href="574491v5_inline33.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
<p>We write the probability of mapping <inline-formula><inline-graphic xlink:href="574491v5_inline34.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in a given sample as:
<disp-formula id="ueqn1">
<graphic xlink:href="574491v5_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
This proportion remains virtually unchanged when sampling without replacement because <inline-formula><inline-graphic xlink:href="574491v5_inline35.gif" mime-subtype="gif" mimetype="image"/></inline-formula> with small <inline-formula><inline-graphic xlink:href="574491v5_inline36.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We can therefore approximate sampling <italic>without</italic> replacement by sampling <italic>with</italic> replacement using a multinomial: <bold><italic>X</italic></bold> ‚àº MN(<italic>N</italic>; <italic>P</italic><sub>1j</sub>, ‚Ä¶, <italic>P</italic><sub><italic>p</italic>j</sub>). This multinomial and the Poisson distribution over <italic>N</italic> together imply that the marginal distribution of each <italic>X</italic><sub><italic>i</italic></sub> ‚àà <bold><italic>X</italic></bold> follows an independent Poisson distribution centered at <inline-formula><inline-graphic xlink:href="574491v5_inline37.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, or:
<disp-formula id="eqn4">
<graphic xlink:href="574491v5_eqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We conclude that the measurement error distribution follows a Poisson distribution to high accuracy. Multiple experimental results already corroborate this theoretical conclusion (<xref ref-type="bibr" rid="c26">Gr√ºn et al., 2014</xref>; <xref ref-type="bibr" rid="c49">Sarkar and Stephens, 2021</xref>; <xref ref-type="bibr" rid="c11">Choudhary and Satija, 2022</xref>).</p>
<p>We can represent the biology and the RNA sequencing in a single DAG over <inline-formula><inline-graphic xlink:href="574491v5_inline38.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, where <italic>B</italic> denotes the batch, and <italic>Y</italic> the target variable representing patient symptoms or diagnosis. We provide a toy example in <xref rid="fig6" ref-type="fig">Figure 6</xref>. We draw ùîæ over <bold><italic>Z</italic></bold> in black and make each <inline-formula><inline-graphic xlink:href="574491v5_inline39.gif" mime-subtype="gif" mimetype="image"/></inline-formula> a parent of <italic>X</italic><sub><italic>i</italic></sub> ‚àà <bold><italic>X</italic></bold> in blue. We then include the root vertex <italic>B</italic> as a parent of all members of <bold><italic>X</italic></bold> in green. We augment this graph with the error terms of <inline-formula><inline-graphic xlink:href="574491v5_inline40.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in red and henceforth refer to the augmented DAG as ùîæ. Repeated draws from the represented causal process generates a dataset.</p>
<fig id="fig6" position="float" fig-type="figure">
<label>Figure 6.</label>
<caption><p>An example of a DAG over <inline-formula><inline-graphic xlink:href="574491v5_inline124.gif" mime-subtype="gif" mimetype="image"/></inline-formula> augmented with the error terms <bold><italic>E</italic></bold>. The observed vertices <bold><italic>X</italic></bold> denote counts corrupted by batch <italic>B</italic> effects and Poisson measurement error.</p></caption>
<graphic xlink:href="574491v5_fig6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s4c">
<title>No Need for Normalization by Sequencing Depth</title>
<p>We provide an asymptotic argument that eliminates the need for normalization by sequencing depth when estimating conditional expectations using bulk RNA-seq. The argument applies to the conditional expectations as a whole rather than their individual parameters.</p>
<p>We want to recover the causal relations between <inline-formula><inline-graphic xlink:href="574491v5_inline41.gif" mime-subtype="gif" mimetype="image"/></inline-formula> by removing batch <italic>B</italic> and depth <italic>N</italic> effects from the dataset because they correspond to the sequencing process rather than the underlying biology. We first consider removing sequencing depth by finding stably expressed housekeeping genes. Let <bold>√É</bold> denote the set of housekeeping genes where <inline-formula><inline-graphic xlink:href="574491v5_inline42.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is a constant for each <inline-formula><inline-graphic xlink:href="574491v5_inline43.gif" mime-subtype="gif" mimetype="image"/></inline-formula> similarly <bold><italic>A</italic></bold> refers to the corresponding set with Poisson measurement error. Let <italic>N</italic> = <italic>n</italic> be large enough such that <inline-formula><inline-graphic xlink:href="574491v5_inline44.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for each sample. Then dividing by <inline-formula><inline-graphic xlink:href="574491v5_inline45.gif" mime-subtype="gif" mimetype="image"/></inline-formula> controls for sequencing depth in the following sense:
<disp-formula id="ueqn2">
<graphic xlink:href="574491v5_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where we have divided <inline-formula><inline-graphic xlink:href="574491v5_inline46.gif" mime-subtype="gif" mimetype="image"/></inline-formula> by a constant in the last term. Thus, dividing by <italic>L</italic> removes measurement error within each batch as <italic>N</italic> ‚Üí ‚àû. We assume that <italic>N</italic> is so large that the approximation error is negligible. We only invoke the assumption in bulk RNA-seq, where the library size <italic>N</italic> is on the order of at least tens of millions.</p>
<p>We do not divide by <italic>L</italic> in practice because we may have <italic>L</italic> = 0 with finite <italic>N</italic>. We instead always include <italic>L</italic> ‚à™ <italic>B</italic> in the predictor set of downstream regressions. Conditioning on <italic>L</italic> ‚à™ <italic>B</italic> ensures that all downstream regressions mitigate depth and batch effects with adequate sequencing depth, or that ùîº(<italic>Y</italic> | <sup><bold>≈®</bold></sup>, <italic>B</italic>) = ùîº(<italic>Y</italic> | <bold><italic>U</italic></bold>, <italic>L, B</italic>) for any <inline-formula><inline-graphic xlink:href="574491v5_inline47.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as <italic>N</italic> ‚Üí ‚àû. The equality holds almost surely under a mild smoothness condition:</p>
<statement id="len1">
<label>Lemma 1.</label>
<p><italic>Assume Lipschitz continuity of the conditional expectation for all N</italic> ‚â• <italic>n</italic><sub>0</sub>:
<disp-formula id="ueqn3">
<graphic xlink:href="574491v5_ueqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<italic>where</italic> <inline-formula><inline-graphic xlink:href="574491v5_inline48.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, <italic>C</italic><sub><italic>N</italic></sub> ‚àà <italic>O</italic>(1) <italic>is a positive constant, and we have taken an outer expectation on both sides. Then</italic> ùîº(<italic>Y</italic> | <sup><bold>≈®</bold></sup>) = lim<sub><italic>N</italic>‚Üí‚àû</sub> ùîº(<italic>Y</italic> | <bold><italic>U</italic></bold>, <italic>L, B</italic>) <italic>almost surely</italic>.</p>
</statement>
<p>We delegate proofs to the Supplementary Materials unless proven here in the Methods. Note that <inline-formula><inline-graphic xlink:href="574491v5_inline49.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, so the Lipschitz assumption intuitively means that accurate estimation of <bold>≈®</bold> implies accurate estimation of ùîº(<italic>Y</italic> | <sup><bold>≈®</bold></sup>). Furthermore, conditioning on the library size <italic>N</italic> instead of <italic>L</italic> can introduce spurious dependencies because <italic>N</italic> depends on all of the genes rather than just the stably expressed ones.</p>
<p>We now eliminate the need to condition on <italic>L</italic>. Note that <italic>L</italic> is a sum of independent Poisson distributions given <italic>B</italic> per Expression (4). This implies <italic>Y</italic> ‚ï® <italic>L</italic> | (<bold><italic>U</italic></bold>, <italic>B</italic>) for any <italic>N</italic>, so that ùîº(<italic>Y</italic> |<sup><bold>≈®</bold></sup>) = lim<sub><italic>N</italic>‚Üí‚àû</sub> ùîº(<italic>Y</italic> | <bold><italic>U</italic></bold>, <italic>L, B</italic>) = lim<sub><italic>N</italic>‚Üí‚àû</sub> ùîº(<italic>Y</italic> | <bold><italic>U</italic></bold>, <italic>B</italic>) almost surely. We have proved:</p>
<statement id="the1">
<label>Theorem 1.</label>
<p><italic>Consider the same assumption as Lemma 1. Then</italic> ùîº(<italic>Y</italic> |<sup><bold>≈®</bold></sup>) = lim<sub><italic>N</italic>‚Üí‚àû</sub> ùîº(<italic>Y</italic> | <bold><italic>U</italic></bold>, <italic>B</italic>) <italic>almost surely, where we have eliminated the conditioning on L</italic>.</p>
</statement>
<p>We emphasize again that these equalities hold for the conditional expectation but <italic>not</italic> for the regression parameters; the regression parameters do not converge in general unless we divide by <italic>L</italic>. We will only need to estimate conditional expectations in order to identify root causal genes.</p>
</sec>
<sec id="s4d">
<title>Identifying Root Causal Genes</title>
<p>We showed how to overcome Poisson measurement error without sequencing depth normalization in the previous section. We leverage this technique to define a measure for identifying the root causal genes of <italic>Y</italic>.</p>
<sec id="s4d1">
<title>Definitions</title>
<p>A <italic>root cause</italic> of <italic>Y</italic> corresponds to a root vertex that is an ancestor of <italic>Y</italic> in ùîæ. All root vertices are error terms in an augmented graph. We define the <italic>root causal effect</italic> of any <italic>E</italic><sub><italic>i</italic></sub> ‚àà <bold><italic>E</italic></bold> on <italic>Y</italic> as œí<sub><italic>i</italic></sub> ‚âú ùï°(<italic>Y</italic> | <italic>E</italic><sub><italic>i</italic></sub>) ‚àí ùï°(<italic>Y</italic>) (<xref rid="c59" ref-type="bibr">Strobl, 2024</xref>; <bold><italic>Strobl and Lasko, 2023c</italic></bold>).</p>
<p>We can identify root causes using the following result:</p>
<statement id="pro1">
<label>Proposition 1.</label>
<p><italic>If</italic> <inline-formula><inline-graphic xlink:href="574491v5_inline50.gif" mime-subtype="gif" mimetype="image"/></inline-formula> <italic>Y or</italic> <inline-formula><inline-graphic xlink:href="574491v5_inline51.gif" mime-subtype="gif" mimetype="image"/></inline-formula> <italic>(or both), then E</italic><sub><italic>i</italic></sub> <italic>is a root cause of Y</italic>.</p>
</statement>
<p>We can also claim the backward direction under d-separation faithfulness. We however avoid making this additional assumption because real biological data may not arise from distributions obeying d-separation faithfulness in practice (<xref rid="c58" ref-type="bibr">Strobl, 2022</xref>).</p>
<p>Proposition 1 implies that <italic>E</italic><sub><italic>i</italic></sub> is a root cause of <italic>Y</italic> when:
<disp-formula id="ueqn4">
<graphic xlink:href="574491v5_ueqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The above quantity corresponds to the <italic>conditional root causal effect</italic> but not the root causal effect œí<sub><italic>i</italic></sub> due to the extra conditioning on <inline-formula><inline-graphic xlink:href="574491v5_inline52.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The two terms may also differ in direction; if Œî<sub><italic>i</italic></sub> &gt; 0, then this does not imply that œí<sub><italic>i</italic></sub> &gt; 0, and similarly for negative values. The two variables thus represent different quantities but ‚Äì in terms of priority ‚Äì we would estimate œí<sub><italic>i</italic></sub> when we have nonzero Œî<sub><italic>i</italic></sub>. Experimental results indicate that œí<sub><italic>i</italic></sub> and Œî<sub><italic>i</italic></sub> take on similar values and agree in direction about 95% of the time in practice (Supplementary Materials).</p>
<p>We now encounter two challenges. First, the quantities œí<sub><italic>i</italic></sub> and Œî<sub><italic>i</italic></sub> depend on the unknown error term <italic>E</italic><sub><italic>i</italic></sub>. We can however substitute <italic>E</italic><sub><italic>i</italic></sub> with <inline-formula><inline-graphic xlink:href="574491v5_inline53.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in Œî<sub><italic>i</italic></sub> due to the following result:</p>
<statement id="pro2">
<label>Proposition 2.</label>
<p><italic>We have</italic> <inline-formula><inline-graphic xlink:href="574491v5_inline54.gif" mime-subtype="gif" mimetype="image"/></inline-formula> <italic>under Equation</italic> (3).</p>
</statement>
<p>We can thus compute the conditional root causal effect Œî<sub><italic>i</italic></sub> without access to the error terms:
<disp-formula id="ueqn5">
<graphic xlink:href="574491v5_ueqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
We can determine the root causal status of <italic>E</italic><sub><italic>i</italic></sub> on <italic>Y</italic> when Œî<sub><italic>i</italic></sub> ‚â† 0 per Proposition 1. Nevertheless, the term ‚Äúroot cause‚Äù in colloquial language refers to two concepts simultaneously: a root vertex that causes <italic>Y and</italic> has a large causal effect on <italic>Y</italic>. We thus say that <inline-formula><inline-graphic xlink:href="574491v5_inline55.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is a <italic>root causal gene</italic> of <italic>Y</italic> if Œî<sub><italic>i</italic></sub> ‚â´ 0.</p>
<p>The second challenge involves computing the non-parametric probability distributions of Œî<sub><italic>i</italic></sub> which come at a high cost. We thus define the analogous expected version by:
<disp-formula id="ueqn6">
<graphic xlink:href="574491v5_ueqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>p</italic>(<italic>Y</italic>) denotes the density of <italic>Y</italic>. Observe that if Œî<sub><italic>i</italic></sub> = 0, then Œì<sub><italic>i</italic></sub> = 0. The converse is not true but likely to hold in real data when a change in the probability distribution also changes its expectation. The set <inline-formula><inline-graphic xlink:href="574491v5_inline56.gif" mime-subtype="gif" mimetype="image"/></inline-formula> denotes the <italic>surrogate parents</italic> of <inline-formula><inline-graphic xlink:href="574491v5_inline57.gif" mime-subtype="gif" mimetype="image"/></inline-formula> corresponding to the variables in <bold><italic>X</italic></bold> associated with <inline-formula><inline-graphic xlink:href="574491v5_inline58.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The last equality holds almost surely as <italic>N</italic> ‚Üí ‚àû by Theorem 1.</p>
<p>We call Œ¶ ‚âú |Œì| the <italic>Root Causal Strength</italic> (RCS) of <inline-formula><inline-graphic xlink:href="574491v5_inline59.gif" mime-subtype="gif" mimetype="image"/></inline-formula> on <italic>Y</italic>. The RCS obtains a unique value Œ¶ = <italic>œï</italic><sub><italic>i</italic>j</sub> for each patient j. We say that <inline-formula><inline-graphic xlink:href="574491v5_inline60.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is a root causal gene of <italic>Y</italic> for patient if <italic>œï</italic><sub><italic>i</italic>j</sub> ‚â´ 0, since we posit a right skewed distribution of conditional root causal effects for each patient as in <xref rid="fig1" ref-type="fig">Figure 1 (b)</xref>. We combine the RCS scores across a set of <italic>n</italic> samples using the Deviation of the RCS (D-RCS) <inline-formula><inline-graphic xlink:href="574491v5_inline61.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, or the standard deviation of RCS from zero. We may compute D-RCS for each cluster or globally across all patients depending on the context. We thus likewise say that <inline-formula><inline-graphic xlink:href="574491v5_inline62.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is a root causal gene for a cluster of patients or all patients in a sample if its corresponding D-RCS score for the cluster or the sample is much lager than zero, respectively. Note that we do not specify a particular cutoff value for large (conditional) root causal effects, since the root causal effects likely lie on a continuous graduated scale as opposed to approximately two binary values. Nevertheless, visual inspection of the RCS or D-RCS histograms in disease should approximate a power law, where a large mass is concentrated around zero and a long tail extends to the right similar to folding <xref rid="fig1" ref-type="fig">Figure 1 (b)</xref>.</p>
</sec>
</sec>
<sec id="s4e">
<title>Algorithm</title>
<p>We now design an algorithm called Root Causal Strength using Perturbations (RCSP) that recovers the RCS scores using Perturb-seq and bulk RNA-seq data.</p>
<sec id="s4e1">
<title>Finding Surrogate Ancestors</title>
<p>Computing Œ¶<sub><italic>i</italic></sub> for each <inline-formula><inline-graphic xlink:href="574491v5_inline63.gif" mime-subtype="gif" mimetype="image"/></inline-formula> requires access to the surrogate parents of each variable or, equivalently, the causal graph ùîæ. However, inferring ùîæ using causal discovery algorithms may lead to large statistical errors in the high dimensional setting (<bold><italic>Colombo et al., 2014</italic></bold>) and require restrictive assumptions such as d-separation faithfulness (<xref ref-type="bibr" rid="c55">Spirtes et al., 2000</xref>) or specific functional relations (<xref ref-type="bibr" rid="c45">Peters et al., 2014</xref>).</p>
<p>We instead directly utilize the interventional Perturb-seq data to recover a superset of the surrogate parents. We first leverage the global Markov property and equivalently write:
<disp-formula id="eqn5">
<graphic xlink:href="574491v5_eqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <inline-formula><inline-graphic xlink:href="574491v5_inline64.gif" mime-subtype="gif" mimetype="image"/></inline-formula> denotes the <italic>surrogate ancestors</italic> of <inline-formula><inline-graphic xlink:href="574491v5_inline65.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, or the variables in <bold><italic>X</italic></bold> associated with the ancestors of <inline-formula><inline-graphic xlink:href="574491v5_inline66.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
<p>We discover the surrogate ancestors using unconditional independence tests. For any <italic>X</italic><sub><italic>k</italic></sub> ‚àà <bold><italic>X</italic></bold>, we test <italic>X</italic><sub><italic>k</italic></sub> ‚ï® <italic>P</italic><sub><italic>i</italic></sub> by unpaired two-sided t-test, where <italic>P</italic><sub><italic>i</italic></sub> is an indicator function equal to one when we perturb <italic>X</italic><sub><italic>i</italic></sub> and zero in the control samples of Perturb-seq. <italic>P</italic><sub><italic>i</italic></sub> is thus a parent of <italic>X</italic><sub><italic>i</italic></sub> alone but not a child of <italic>B</italic>, so we do not need to condition on <italic>B</italic>. We use the two-sided t-test to assess for independence because the t-statistic averages over cells to mimic bulk RNA-seq. If we reject the null and conclude that <inline-formula><inline-graphic xlink:href="574491v5_inline67.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, then <italic>X</italic><sub><italic>k</italic></sub> must be a descendant of <italic>P</italic><sub><italic>i</italic></sub> by the global Markov property, so we include <italic>X</italic><sub><italic>k</italic></sub> into the set of surrogate descendants <inline-formula><inline-graphic xlink:href="574491v5_inline68.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. Curating every <italic>X</italic><sub>j</sub> ‚àà <bold><italic>X</italic></bold> such that <inline-formula><inline-graphic xlink:href="574491v5_inline69.gif" mime-subtype="gif" mimetype="image"/></inline-formula> into <inline-formula><inline-graphic xlink:href="574491v5_inline70.gif" mime-subtype="gif" mimetype="image"/></inline-formula> yields the surrogate ancestors of <inline-formula><inline-graphic xlink:href="574491v5_inline71.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as desired.</p>
</sec>
<sec id="s4e2">
<title>Procedure</title>
<p>We now introduce an algorithm called Root Causal Strength using Perturbations (RCSP) that discovers the surrogate ancestors of each variable <inline-formula><inline-graphic xlink:href="574491v5_inline72.gif" mime-subtype="gif" mimetype="image"/></inline-formula> using Perturb-seq and then computes the RCS of each variable using bulk RNA-seq. We summarize RCSP in Algorithm 1.</p>
<p>RCSP takes Perturb-seq and bulk RNA-seq datasets as input. The algorithm first finds the surrogate descendants of each variable in <inline-formula><inline-graphic xlink:href="574491v5_inline73.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in Line 2 in order to identify the surrogate ancestors of each variable in Line 5. Access to the surrogate ancestors and the batches <italic>B</italic> allows RCSP to compute Œ¶<sub><italic>i</italic></sub> for each <italic>X</italic><sub><italic>i</italic></sub> ‚àà <bold><italic>X</italic></bold> from the bulk RNA-seq in Line 6. The algorithm thus outputs the RCS scores Œ¶ as desired.</p>
<p>We certify RCSP as follows:</p>
<statement id="the2">
<label>Theorem 2.</label>
<p><italic>(Fisher consistency) Consider the same assumption as Lemma 1. If unconditional d-separation faithfulness holds, then RCSP recovers</italic> Œ¶ <italic>almost surely as N</italic> ‚Üí ‚àû.</p>
</statement>
<statement id="alg1">
<label>Algorithm 1</label>
<p>Root Causal Strength using Perturbations (RCSP)</p>
<p><fig position="float" fig-type="figure">
<graphic xlink:href="574491v5_alg1.tif" mime-subtype="tiff" mimetype="image"/>
</fig></p>
</statement>
<p>We engineered RCSP to only require <italic>unconditional</italic> d-separation faithfulness because real distributions may not obey full d-separation faithfulness (<xref rid="c58" ref-type="bibr">Strobl, 2022</xref>).</p>
</sec>
</sec>
<sec id="s4f">
<title>Synthetic Data</title>
<sec id="s4f1">
<title>Simulations</title>
<p>We generated a linear SEM obeying <xref ref-type="disp-formula" rid="eqn3">Equation (3)</xref> specifically as <inline-formula><inline-graphic xlink:href="574491v5_inline74.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for every <inline-formula><inline-graphic xlink:href="574491v5_inline75.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and similarly <inline-formula><inline-graphic xlink:href="574491v5_inline76.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We included <italic>p</italic> + 1 = 2500 variables in <inline-formula><inline-graphic xlink:href="574491v5_inline77.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We instantiated the coefficient matrix <italic>Œ≤</italic> by sampling from a Bernoulli(2/(<italic>p</italic> ‚àí 1)) distribution in the upper triangular portion of the matrix. The resultant causal graph thus has an expected neighborhood size of 2. We then randomly permuted the ordering of the variables. We introduced weights into the coefficient matrix by multiplying each entry in <italic>Œ≤</italic> by a weight sampled uniformly from [‚àí1, ‚àí0.25] ‚à™ [0.25, 1]. The error terms each follow a standard Gaussian distribution multiplied by 0.5. We introduced batch effects by drawing each entry of the mapping efficiencies <italic>œÄ</italic> from the uniform distribution between 10 and 1000 for the bulk RNA-seq, and between 0.1 and 1 for the Perturb-seq. We set <inline-formula><inline-graphic xlink:href="574491v5_inline78.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and then obtained the corrupted surrogate <italic>X</italic><sub><italic>i</italic></sub> distributed <inline-formula><inline-graphic xlink:href="574491v5_inline79.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for each <inline-formula><inline-graphic xlink:href="574491v5_inline80.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and batch j. We chose <italic>Y</italic> uniformly at random from the set of vertices with at least one parent and no children. We drew 200 samples for the bulk RNA-seq data to mimic a large but common dataset size. We introduced knockdown perturbations in Perturb-seq by subtracting an offset of two in the softplus function:<inline-formula><inline-graphic xlink:href="574491v5_inline81.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We finally drew 200 samples for the control and each perturbation condition to generate the Perturb-seq data. We repeated the above procedure 30 times.</p>
</sec>
<sec id="s4f2">
<title>Comparators</title>
<p>We compared RCSP against the following four algorithms:</p>
<list list-type="order">
<list-item><p>Additive noise model (ANM) (<xref ref-type="bibr" rid="c45">Peters et al., 2014</xref>; <bold><italic>Strobl and Lasko, 2023a</italic></bold>): performs nonlinear regression of <italic>X</italic><sub><italic>i</italic></sub> on Pa(<italic>X</italic><sub><italic>i</italic></sub>) ‚à™ <italic>B</italic> and then regresses <italic>Y</italic> on the residuals <bold><italic>E</italic></bold> \ <italic>E</italic><sub><italic>i</italic></sub> to estimate |ùîº(<italic>Y</italic> | <bold><italic>E</italic></bold> \ <italic>E</italic><sub><italic>i</italic></sub>) ‚àí ùîº(<italic>Y</italic> | <bold><italic>X</italic></bold>, <italic>B</italic>) | for each <italic>X</italic><sub><italic>i</italic></sub> ‚àà <bold><italic>X</italic></bold>. The non-linear regression residuals are equivalent to the error terms assuming an additive noise model.</p></list-item>
<list-item><p>Linear Non-Gaussian Acyclic Model (LiNGAM) (<xref ref-type="bibr" rid="c45">Peters et al., 2014</xref>; <bold><italic>Strobl and Lasko, 2022</italic></bold>): same as above but performs linear instead of non-linear regression.</p></list-item>
<list-item><p>CausalCell (<xref ref-type="bibr" rid="c69">Wen et al., 2023</xref>): selects the top 50 genes with maximal statistical dependence to <italic>Y</italic>, and then runs the Peter-Clark (PC) algorithm (<xref ref-type="bibr" rid="c55">Spirtes et al., 2000</xref>) using a non-parametric conditional independence test to identify a causal graph among the top 50 genes. The algorithm does not perform root causal inference, so we use ANM as above but condition on the estimated parent sets for the top 50 genes and the ancestors inferred from the Perturb-seq data otherwise.</p></list-item>
<list-item><p>Univariate regression residuals (Uni Reg): regresses <italic>Y</italic> on <italic>X</italic><sub><italic>i</italic></sub> ‚à™ <italic>B</italic> and estimates the absolute residuals | <italic>Y</italic> ‚àí ùîº(<italic>Y</italic> |<italic>X</italic><sub><italic>i</italic></sub>, <italic>B</italic>)| for each <italic>X</italic><sub><italic>i</italic></sub> ‚àà <bold><italic>X</italic></bold>.</p></list-item>
<list-item><p>Multivariate regression residuals (Multi Reg): similar to above but instead computes the absolute residuals after regressing <italic>Y</italic> on (<bold><italic>X</italic></bold> \ <italic>X</italic><sub><italic>i</italic></sub>) ‚à™ <italic>B</italic>.</p></list-item>
</list>
<p>The first two methods are state-of-the-art approaches used for root causal discovery. Univariate and multivariate regressions do not distinguish between predictivity and causality, but we included them as sanity checks. We performed all non-linear regressions using multivariate adaptive regression splines to control for the underlying regressor (<xref ref-type="bibr" rid="c20">Friedman, 1991</xref>). We also standardized all variables before running the regressions to prevent gaming of the marginal variances in causal discovery (<xref ref-type="bibr" rid="c47">Reisach et al., 2021</xref>; <xref ref-type="bibr" rid="c39">Ng et al., 2024</xref>). We compared the algorithms on their accuracy in estimating Œ¶.</p>
</sec>
</sec>
<sec id="s4g">
<title>Real Data</title>
<sec id="s4g1">
<title>Quality Control</title>
<p>We downloaded Perturb-seq datasets of retinal pigment epithelial cells from the RPE-1 cell line, and undifferentiated blast cells from the K562 cell line (<xref ref-type="bibr" rid="c48">Replogle et al., 2022</xref>). We used the genomewide dataset version for the latter. We downloaded the datasets from the scPerturb database on Zenodo (<xref ref-type="bibr" rid="c25">Green et al., 2022</xref>) with the same quality controls as the original paper. Replogle et al. computed adjusted library sizes by equalizing the mean library size of control cells within each batch. Cells with greater than a 2000 or 3000 library size, and less than 25% or 11% mitochondrial RNA were kept, respectively. The parameters were chosen by plotting the adjusted library sizes against the mitochondrial RNA counts and then manually setting thresholds that removed low quality cells likely consisting of ambient mRNA transcripts arising from premature cell lysis or cell death.</p>
<p>We next downloaded bulk RNA-seq datasets derived from patients with age-related macular degeneration (AMD; GSE115828) and multiple sclerosis (MS; GSE137143) (<xref ref-type="bibr" rid="c46">Ratnapriya et al., 2019</xref>; <xref ref-type="bibr" rid="c30">Kim et al., 2021</xref>). We excluded 10 individuals from the AMD dataset including one with an RNA integrity number of 21.92, five missing an integrity number (all others had an integrity number of less than 10), and four without a Minnesota Grading System score. We kept all samples from the MS dataset derived from CD4+ T cells but filtered out genes with a mean of less than 5 counts as done in the original paper.</p>
<p>We finally kept genes that were present in both the AMD bulk dataset and the RPE-1 Perturbseq dataset, yielding a final count of 513 bulk RNA-seq samples and 247,914 Perturb-seq samples across 2,077 genes. We also kept genes that were present in both the MS bulk dataset and the K562 Perturb-seq dataset, yielding a final count of 137 bulk RNA-seq samples and 1,989,578 Perturb-seq samples across 6,882 genes. We included age and sex as a biological variable as covariates for every patient in both datasets in subsequent analyses.</p>
</sec>
<sec id="s4g2">
<title>Evaluation Rationale</title>
<p>We do not have access to the ground truth values of Œ¶ in real data. We instead evaluate the RCSP estimates of Œ¶ using alternative sources of ground truth knowledge. We first assess the accuracy of RCS using the control variable age as follows:</p>
<list list-type="order">
<list-item><p>Determine if the RCS values of age identify age as a root cause with large causal effect in diseases that progress over time.</p>
<p>Second, few root causal genes should drive pathogenesis because the effects of a few error terms distribute over many downstream genes. We verify the sparsity of root causal genes as follows:</p>
</list-item>
<list-item><p>Determine if the distribution of D-RCS concentrates around zero more than the distribution of the Deviation of Statistical Dependence (D-SD) defined as <inline-formula><inline-graphic xlink:href="574491v5_inline82.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for each gene <inline-formula><inline-graphic xlink:href="574491v5_inline83.gif" mime-subtype="gif" mimetype="image"/></inline-formula> where Œ©<sub><italic>i</italic></sub> = |ùîº(<italic>Y</italic> |<italic>X</italic><sub><italic>i</italic></sub>, <italic>B</italic>) ‚àí ùîº(<italic>Y</italic> |<italic>B</italic>)| and <italic>œâ</italic><sub><italic>i</italic>j</sub> its value for patient j.</p>
<p>Despite the sparsity of root causal genes, we still expect the root causal genes to correspond to at least some known causes of disease:</p>
</list-item>
<list-item><p>Determine if genes with the top D-RCS scores correspond to genes known to cause the disease.</p>
<p>Next, the root causal genes initiate the vast majority of pathogenesis, and we often have knowledge of pathogenic pathways even though we may not know the exact gene expression cascade leading to disease. Intervening on root causal genes should also modulate patient symptoms. We thus further evaluate the accuracy of RCSP using pathway and drug enrichment analyses as follows:</p>
</list-item>
<list-item><p>Determine if the D-RCS scores identify known pathogenic pathways of disease in pathway enrichment analysis.</p></list-item>
<list-item><p>Determine if the D-RCS scores identify drugs that treat the disease.</p>
<p>Finally, complex diseases frequently involve multiple pathogenic pathways that differ between patients. Patients with the same complex disease also respond differently to treatment. We hence evaluate the precision of RCS as follows:</p>
</list-item>
<list-item><p>Determine if the patient-specific RCS scores identify subgroups of patients involving different but still known pathogenic pathways.</p></list-item>
<list-item><p>Determine if the patient-specific RCS scores identify subgroups of patients that respond differently to drug treatment.</p>
<p>In summary, we evaluate RCSP in real data based on its ability to (1) identify age as a known root cause, (2) suggest an omnigenic root causal model, (3) recover known causal genes, (4) find known pathogenic pathways, (5) find drugs that treat the disease, and (6,7) delineate patient subgroups.</p>
</list-item>
</list>
</sec>
<sec id="s4g3">
<title>Enrichment Analyses</title>
<p>Multivariate adaptive regression splines introduce sparsity, but enrichment analysis performs better with a dense input. We can estimate the conditional expectations of Œ¶ using any general nonlinear regression method, so we instead estimated the expectations using kernel ridge regression equipped with a radial basis function kernel (<xref ref-type="bibr" rid="c51">Shawe-Taylor and Cristianini, 2004</xref>). We then computed the D-RCS across all patients for each variable in <bold><italic>X</italic></bold>. We ran pathway enrichment analysis using the fast gene set enrichment analysis (FGSEA) algorithm (<xref ref-type="bibr" rid="c50">Sergushichev, 2016</xref>) with one hundred thousand simple permutations using the D-RCS scores and pathway information from the Reactome database (version 1.86.0) (<xref ref-type="bibr" rid="c18">Fabregat et al., 2017</xref>). We likewise performed drug set enrichment analysis with the Drug Signature database (version 1.0) (<xref ref-type="bibr" rid="c70">Yoo et al., 2015</xref>). We repeated the above procedures for the D-RCS of all clusters identified by hierarchical clustering via Ward‚Äôs method (<xref ref-type="bibr" rid="c68">Ward Jr, 1963</xref>).</p>
</sec>
</sec>
</sec>
</body>
<back>
<sec id="s5" sec-type="data-availability">
<title>Data Availability</title>
<p>All datasets analyzed in this study have been previously published and are publicly accessible as follows:</p>
<list list-type="order">
<list-item><p>Bulk RNA-seq for AMD: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE115828">GSE115828</ext-link></p></list-item>
<list-item><p>Bulk RNA-seq for MS: <ext-link ext-link-type="uri" xlink:href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE137143">GSE137143</ext-link></p></list-item>
<list-item><p>Perturb-seq for the RPE-1 and K562 cell lines: DOI <ext-link ext-link-type="uri" xlink:href="https://zenodo.org/records/10044268">10044268</ext-link></p></list-item>
</list>
</sec>
<sec id="s6">
<title>Code Availability</title>
<p>R code needed to replicate all experimental results is available on <ext-link ext-link-type="uri" xlink:href="https://github.com/ericstrobl/RCSP">GitHub</ext-link>.</p>
</sec>
<sec id="s7">
<title>Supplementary Materials</title>
<sec id="s7a">
<title>Additional Synthetic Data Results</title>
<sec id="s7a1">
<title>Normalization by Sequencing Depth</title>
<p>We theoretically showed that RCS does not require normalization by sequencing depth in the Methods using an asymptotic argument. We tested this claim empirically by drawing 200 bulk RNA-seq samples from random DAGs as in the Methods but over <italic>p</italic> + 1 = 250 variables. We varied the mean sequencing depth <italic>N</italic>/<italic>p</italic> of each gene from 15, 20, 30, 50, 90, 170, 330 to 650 counts; multiplying <italic>N</italic>/<italic>p</italic> by <italic>p</italic> recovers the library size <italic>N</italic>. We only included one batch in the bulk RNA-seq in order to isolate the effect of sequencing depth. We compared no normalization, normalization by 10 housekeeping genes, normalization by 20 housekeeping genes, and normalization by library size. We repeated each experiment 100 times and thus generated a total of 100 √ó 4 √ó 8 = 3200 datasets.</p>
<p>We plot the results in <xref rid="figS1" ref-type="fig">Supplementary Figure 1</xref>. All methods improved with increasing mean sequencing depth as expected. The no normalization strategy performed the best at low mean sequencing depths, followed by the housekeeping genes and then total library size. The result even held with a small library size of <italic>N</italic> = 15 √ó 249 = 3735 at the smallest mean sequencing depth of 15, suggesting that the asymptotic argument holds well in bulk RNA-seq where <italic>N</italic>/<italic>p</italic> is often greater than 500 and <italic>N</italic> greater than the tens of millions. However, the average RMSEs of all normalization methods became more similar as sequencing depth increased. We conclude that no normalization exceeds or matches the accuracy of other strategies. We therefore do not normalize by sequencing depth in subsequent analyses.</p>
<fig id="figS1" position="float" fig-type="figure">
<label>Supplementary Figure 1.</label>
<caption><p>Mean RMSE to the ground truth RCS values across different mean sequencing depths and normalization strategies. The no normalization strategy achieved low RMSEs at lower mean sequencing depths, but the performances of all methods converged as the mean sequencing depths increased. Error bars denote 95% confidence intervals of the mean RMSE.</p></caption>
<graphic xlink:href="574491v5_figS1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7a2">
<title>Functional Causal Models and Measurement Error</title>
<p>The experiments in the Results section quantify the accuracies of the algorithms in estimating Œ¶. However, the functional causal models ANM and LiNGAM also estimate the error terms as an intermediate step, whereas RCSP does not. We therefore also investigated the accuracies of ANM and LiNGAM in estimating the error term values.</p>
<p>Theoretical results suggest that ANM and LiNGAM cannot consistently estimate the error terms in RNA-seq due to the Poisson measurement error. We empirically tested this hypothesis by sampling from bulk RNA-seq data as in the Methods but with <italic>p</italic> + 1 = 100 and a batch size of one in order to isolate the effect of measurement error. We repeated the experiment 100 times for bulk RNA-seq sample sizes of 100, 200, 400, 800, 1600 and 3200. We plot the results in <xref rid="figS2" ref-type="fig">Supplementary Figure 2</xref>. The accuracies of ANM and LiNGAM did not improve beyond an RMSE of 0.44 to the ground truth error term values even with a large sample size of 6400. We conclude that ANM and LiNGAM cannot estimate the error terms accurately in the presence of measurement error even with large sample sizes.</p>
<fig id="figS2" position="float" fig-type="figure">
<label>Supplementary Figure 2.</label>
<caption><p>Mean RMSE values to the ground truth error term values across different sample sizes. The accuracies of ANM and LiNGAM do not improve with increasing sample sizes.</p></caption>
<graphic xlink:href="574491v5_figS2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7a3">
<title>Cyclic Causal Graphs</title>
<p>We also evaluated the algorithms on directed graphs with cycles. We generated a linear SEM over <italic>p</italic> + 1 = 1000 variables in <inline-formula><inline-graphic xlink:href="574491v5_inline84.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We sampled the coefficient matrix <italic>Œ≤</italic> from a Bernoulli(1/(<italic>p</italic> ‚àí 1)) distribution but did not restrict the non-zero coefficients to the upper triangular portion of the matrix. We then proceeded to permute the variable ordering and weight each entry as in the Methods for the DAG. We repeated this procedure 30 times and report the results in <xref rid="figS3" ref-type="fig">Supplementary Figure 3</xref>.</p>
<p>RCSP again outperformed all other algorithms even in the cyclic case. The results suggest that conditioning on the surrogate ancestors also estimates the RCS well even in the cyclic case. However, we caution that an error term <italic>E</italic><sub><italic>i</italic></sub> can affect the ancestors of <inline-formula><inline-graphic xlink:href="574491v5_inline85.gif" mime-subtype="gif" mimetype="image"/></inline-formula> when cycles exist. As a result, the RCS may not isolate the causal effect of the error term and thus not truly coincide with the notion of a root causal effect in cyclic causal graphs.</p>
<fig id="figS3" position="float" fig-type="figure">
<label>Supplementary Figure 3.</label>
<caption><p>RCSP achieved the lowest RMSE in cyclic graphs as well. However, error terms can influence ancestors in the cyclic case, so the interpretation of the RCS remains unclear when cycles exist.</p></caption>
<graphic xlink:href="574491v5_figS3.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7a4">
<title>DAG Incongruence</title>
<p>We next assessed the performance of RCSP when the DAG underlying the Perturb-seq data differs from the DAG underlying the bulk RNA-seq data. We considered a mixture of two random DAGs in bulk RNA-seq, where one of the DAGs coincided with the Perturb-seq DAG and second alternate DAG did not. We instantiated and simulated samples from each DAG as per the previous subsection. We generated 0%, 25%, 50%, 75%, and 100% of the bulk RNA-seq samples from the alternate DAG, and the rest from the Perturb-seq DAG. We ideally would like to see the performance of RCSP degrade gracefully, as opposed to abruptly, as the percent of samples derived from the alternate DAG increases.</p>
<p>We summarize results in <xref rid="figS4" ref-type="fig">Supplementary Figure 4</xref>. As expected, RCSP performed the best when we drew all samples from the same underlying DAG for Perturb-seq and bulk RNA-seq. However, the performance of RCSP also degraded slowly as the percent of samples increased from the alternate DAG. We conclude that RCSP can accommodate some differences between the underlying DAGs in Perturb-seq and bulk RNA-seq with only a mild degradation in performance.</p>
<fig id="figS4" position="float" fig-type="figure">
<label>Supplementary Figure 4.</label>
<caption><p>The performance of RCSP degrades gracefully as the percent of samples from the alternate DAG increases.</p></caption>
<graphic xlink:href="574491v5_figS4.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7a5">
<title>Non-Sink Target</title>
<p>We finally considered the scenario where <italic>Y</italic> is a non-sink (or non-terminal) vertex. If <italic>Y</italic> is a parent of a gene expression level, then we cannot properly condition on the parents because modern Perturb-seq datasets usually do not intervene on <italic>Y</italic> or measure <italic>Y</italic>. We therefore empirically investigated the degradation in performance resulting from a non-sink target <italic>Y</italic>, in particular for gene expression levels where <italic>Y</italic> is a parent. We again simulated 200 samples from bulk RNA-seq and each condition of Perturb-seq with a DAG over 1000 vertices, an expected neighborhood size of 2 and a non-sink target <italic>Y</italic>. We then removed the outgoing edges from <italic>Y</italic> and resampled the DAG with a sink target. We compare the results of RCSP for both DAGs in gene expression levels where <italic>Y</italic> is a parent. We plot the results in <xref rid="figS5" ref-type="fig">Supplementary Figure 5</xref>. As expected, we observe a degradation in performance when <italic>Y</italic> is not terminal, where the mean RMSE increased from 0.045 to 0.342. We conclude that RCSP is sensitive to violations of the sink target assumption.</p>
<fig id="figS5" position="float" fig-type="figure">
<label>Supplementary Figure 5.</label>
<caption><p>Results with a sink or non-sink target <italic>Y</italic>. RCSP estimated the RCS scores less accurately with a non-sink target indicating that the algorithm is sensitive to violations of the sink target assumption.</p></caption>
<graphic xlink:href="574491v5_figS5.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7a6">
<title>Root Causal Effect versus Conditional Root Causal Effect</title>
<p>We compared the expected and unconditional root causal effects Œ©<sub><italic>i</italic></sub> ‚âú ùîº(<italic>Y</italic> | <italic>E</italic><sub><italic>i</italic></sub>) ‚àí ùîº(<italic>Y</italic>) to the expected and conditional root causal effects or, equivalently, the signed RCS scores Œì. These root causal effects and conditional root causal effects are not the same, but they are similar. We empirically investigated the differences between the estimated values of Œì and the true values of Œ© using the RMSE and also the percent of samples with incongruent signs; Œì and Œ© have incongruent signs if one is positive and the other is negative. We again drew 200 bulk RNA-seq samples from random DAGs as in the Methods over <italic>p</italic> + 1 = 250 variables with one batch. We varied the bulk RNA-seq sample size from 100, 200, 400 to 800. We also compared true Œì against true Œ© by estimating the two to negligible error using 20,000 samples of <inline-formula><inline-graphic xlink:href="574491v5_inline86.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We repeated each experiment 100 times and thus generated a total of 100 √ó 5 = 500 datasets.</p>
<p>We summarize the results in <xref rid="figS6" ref-type="fig">Supplementary Figure 6</xref>. The estimated Œì values approached the true Œ© values with increasing sample sizes. The true Œì values did not converge exactly to the true Œ© values, but the RMSE remained low at 0.05 and the two values differed in sign only around 5.3% of the time. Increasing the number of samples of <inline-formula><inline-graphic xlink:href="574491v5_inline87.gif" mime-subtype="gif" mimetype="image"/></inline-formula> to 50,000 did not change performance, confirming that we reached the floor. We conclude that the empirical results replicate the theoretical results because Œì and Œ© do not match exactly. However, the two quantities take on similar values and their signs matched around 95% of the time in practice.</p>
<fig id="figS6" position="float" fig-type="figure">
<label>Supplementary Figure 6.</label>
<caption><p>Mean RMSE (blue, left) and percent sign incongruence (green, right) of the expected root causal effects and signed RCS values, respectively. The RMSE continues to decrease with increasing sample size but reaches a floor of around 0.05. Similarly, the percent sign incongruence decreases but reaches a floor of around 5%.</p></caption>
<graphic xlink:href="574491v5_figS6.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
</sec>
<sec id="s7b">
<title>Additional Results for Age-related Macular Degeneration</title>
<sec id="s7b1">
<title>Algorithm Comparisons</title>
<p>We say that an algorithm performs well in real data if it simultaneously (1) identifies a sparse set of root causal genes, (2) recovers known pathogenic pathways with high specificity measured by the sparsity of leading edge genes, and (3) clusters patients into clear subgroups.</p>
<p>We compared the algorithms with the AMD data. We summarize the results in <xref rid="figS7" ref-type="fig">Supplementary Figure 7</xref> plotted on the next page. The figure contains 6 rows and 3 columns. Similar to the D-RCS, we can compute the standard deviation of the output of each algorithm from zero for each gene. The first column in <xref rid="figS7" ref-type="fig">Supplementary Figure 7</xref> denotes the histograms of these standard deviations across the genes. We standardized the outputs to have mean zero and unit variance. We then added the minimum value so that all histograms begin at zero; note that the bars at zero are not visible for many algorithms, since only a few genes attained standard deviations near the minimum. If an algorithm accurately identifies root causal genes, then it should only identify a few genes with large conditional root causal effects under the omnigenic root causal model. The RCSP algorithm had a histogram with large probability mass centered around zero with a long tail to the right. The standard deviations of the outputs of the other algorithms attained large values for nearly all genes. Incorporating feature selection and causal discovery with CausalCell introduced more outliers in the histogram of ANM. We conclude that only RCSP detected an omnigenic root causal model.</p>
<p>We plot the results of pathway enrichment analysis in the second column of <xref rid="figS7" ref-type="fig">Supplementary Figure 7</xref>. RCSP, LiNGAM and univariate regression detected pathways related to oxidative stress in AMD. However, the ‚Äúmitotic prometaphase‚Äù and ‚ÄúDNA strand elongation‚Äù pathways in blue for LiNGAM involved 94 and 27 leading edge genes, respectively. The ‚Äúcellular responses to stimuli‚Äù and ‚Äúsignal transduction‚Äù pathways for multivariate regression also involved 253 and 282 leading edge genes. In contrast, the ‚Äúamino acid plasma membrane transport‚Äù pathway for RCSP involved two leading edge genes. We conclude that RCSP identified a known pathogenic pathway of AMD with the fewest number of leading edge genes.</p>
<p>We finally plot the clustering results in the third column of <xref rid="figS7" ref-type="fig">Supplementary Figure 7</xref>. The RCSP sum of squares plot revealed a sharp elbow at four groups of patients, whereas the other plots did not reveal a clear number of categories using the elbow method. We conclude that only RCSP identified clear subgroups of patients in AMD.</p>
<p>In summary, RCSP detected a small set of root causal genes, identified pathogenic pathways with maximal specificity and discovered distinguishable patient subgroups. We therefore conclude that RCSP outperformed all other algorithms in the AMD dataset.</p>
<fig id="figS7" position="float" fig-type="figure">
<label>Supplementary Figure 7.</label>
<caption><p>Comparison of the algorithms in age-related macular degeneration.</p></caption>
<graphic xlink:href="574491v5_figS7.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7b2">
<title>Effect of Sequencing Depth</title>
<p>Theorem 1 states that RCS scores may exhibit bias with insufficient sequencing depth. The genes with large D-RCS scores may therefore simply have low sequencing depths. To test this hypothesis, we plotted sequencing depth against D-RCS scores. Consistent with Theorem 1, we observed a small negative correlation between D-RCS and sequencing depth (<italic>œÅ</italic> = ‚àí0.16, p=2.04E-13), and D-RCS scores exhibited greater variability at the lowest sequencing depths (<xref rid="figS8" ref-type="fig">Supplementary Figure 8</xref>). However, genes with the largest D-RCS scores had mean sequencing depths interspersed between 20 and 3000. We conclude that genes with the largest D-RCS scores had a variety of sequencing depths ranging from low to high.</p>
<fig id="figS8" position="float" fig-type="figure">
<label>Supplementary Figure 8.</label>
<caption><p>Mean sequencing depth of each gene plotted against their D-RCS scores in AMD. Genes with the largest D-RCS scores (red ellipse) had a variety of sequencing depths.</p></caption>
<graphic xlink:href="574491v5_figS8.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7b3">
<title>Biological Results</title>
<p>We provide the full pathway enrichment analysis results in <xref rid="tblS1" ref-type="table">Supplementary Table 1</xref> corresponding to <xref rid="fig3" ref-type="fig">Figure 3 (c)</xref>. We summarize pathway enrichment analysis of the black cluster of <xref rid="fig3" ref-type="fig">Figure 3 (g)</xref> in <xref rid="fig3" ref-type="fig">Figure 3 (j)</xref>. However, analyses of the blue, green and pink clusters did not yield significant pathways even at a liberal FDR threshold of 10%.</p>
<p>We examined whether the clusters of <xref rid="fig3" ref-type="fig">Figure 3 (g)</xref> differentiate dry and wet macular degeneration. Wet macular degeneration is associated with the highest Minnesota Grading System (MGS) score of 4 (<xref rid="c41" ref-type="bibr">Olsen and Feng, 2004</xref>). We plotted the UMAP embedding against MGS (<xref rid="figS9" ref-type="fig">Supplementary Figure 9 (a)</xref>). None of the two UMAP dimensions correlated significantly with the MGS score (5% uncorrected threshold by Spearman‚Äôs correlation test). These results and the large RCS scores of age in <xref rid="fig3" ref-type="fig">Figure 3 (a)</xref> seem to support the hypothesis that wet macular degeneration is a more severe type of dry macular degeneration. However, MGS does not differentiate between wet macular degeneration and late stage dry macular degeneration involving geographical atrophy. We therefore cannot separate late stage dry and wet macular degeneration using the RCS scores alone.</p>
<table-wrap id="tblS1" orientation="portrait" position="float">
<label>Supplementary Table 1.</label>
<caption><p>Full pathway enrichment analysis results for all patients in the AMD dataset. We list the Entrez gene IDs of up to the top three leading edge genes in the right-most column.</p></caption>
<graphic xlink:href="574491v5_tblS1.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<p>We correlated the two UMAP dimensions with the top 30 genes ranked by their RCS scores. We plot genes with the highest correlation to the first and second UMAP dimensions in <xref rid="figS9" ref-type="fig">Supplementary Figures 9 (b)</xref> and <xref rid="figS9" ref-type="fig">9 (c)</xref>, respectively. Many genes correlated with the first dimension, but only three genes correlated with the second at an FDR threshold of 5%.</p>
<fig id="figS9" position="float" fig-type="figure">
<label>Supplementary Figure 9.</label>
<caption><p>Additional UMAP embedding results for AMD. (a) The UMAP dimensions did not correlate with AMD severity as assessed by the MGS score. Many genes correlated with the first UMAP dimension in (b), but only three genes correlated with the second UMAP dimension in (c). Blue bars passed an FDR threshold of 5%, and error bars denote 95% confidence intervals.</p></caption>
<graphic xlink:href="574491v5_figS9.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>We finally performed drug enrichment analysis in each of the four clusters in <xref rid="fig3" ref-type="fig">Figure 3 (g)</xref>. We summarize the results in <xref rid="figS10" ref-type="fig">Supplementary Figure 10</xref>. Only two drugs ‚Äì and one potentially therapeutic option ‚Äì passed FDR correction in patients in the black cluster with the most identified root causal genes according to the RCS scores. In contrast, enrichment analysis identified many drugs in patients in the green cluster with the lowest RCS scores and thus relatively few root causal genes. The pink and blue clusters yielded moderate results. We conclude that drug enrichment analysis expectedly identified more drugs for patients on the left hand side of the UMAP embedding with fewer root causal genes than on the right hand side with many simultaneous root causal genes.</p>
<fig id="figS10" position="float" fig-type="figure">
<label>Supplementary Figure 10.</label>
<caption><p>Drug enrichment analysis results by cluster in <xref rid="fig3" ref-type="fig">Figure 3</xref> (g). The analyses recovered similar drugs across clusters, but the results for the green cluster in (c) were supra-significant.</p></caption>
<graphic xlink:href="574491v5_figS10.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
</sec>
<sec id="s7c">
<title>Additional Results for Multiple Sclerosis</title>
<sec id="s7c1">
<title>Algorithm Comparisons</title>
<p>We compared the algorithms using the MS data with the same criteria used for the AMD dataset. We summarize the results in <xref rid="figS11" ref-type="fig">Supplementary Figure 11</xref> plotted on the next page. Only the histogram of RCSP had large probability mass centered around zero as shown in the first column. The histogram of LiNGAM contained many outliers, so it appears to spike around a value of 18. The histograms of ANM and CausalCell were again near identical. We conclude that only the histogram of RCSP supported an omnigenic root causal model in MS.</p>
<p>We performed pathway enrichment analysis on the algorithm outputs and summarize the results in the second column of <xref rid="figS11" ref-type="fig">Supplementary Figure 11</xref>. The functional causal models ANM, LiNGAM and CausalCell did not identify significant pathways at an FDR corrected threshold of 0.05. In contrast, multivariate and univariate regression both identified many significant pathways in blue with no specific link to the blood brain barrier. The top six significant pathways for multivariate and univariate regression involved 112 to 831 and 18 to 545 leading edge genes, respectively. In contrast, the two significant pathways of RCSP involved only 2 and 9 leading genes. We conclude that RCSP detected pathogenic pathways of MS with the sparsest set of leading edge genes.</p>
<p>We finally clustered the algorithm outputs into patient subgroups. We list the sum of squares plots in the third column of <xref rid="figS11" ref-type="fig">Supplementary Figure 11</xref>. Univariate regression did not differentiate between the patients because it detected one dominating cluster. RCSP and multivariate regression identified clear subgroups according to the elbow method, whereas the sum of squares plots for ANM, LiNGAM and CausalCell showed no clear cutoffs. We conclude that only RCSP and multivariate regression identified clear patient subgroups in MS.</p>
<p>In summary, only RCSP simultaneously detected an omnigenic root causal model, identified pathogenic pathways with high specificity and discovered clear patient subgroups. We therefore conclude that RCSP also outperformed all other algorithms in the MS dataset.</p>
<fig id="figS11" position="float" fig-type="figure">
<label>Supplementary Figure 11.</label>
<caption><p>Comparison of the algorithms in multiple sclerosis.</p></caption>
<graphic xlink:href="574491v5_figS11.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7c2">
<title>Effect of Sequencing Depth</title>
<p>We plot sequencing depth against the D-RCS scores of each gene similar to the AMD dataset. We again observed a small negative correlation (<italic>œÅ</italic> = ‚àí0.136, p&lt;2.2E-16), indicating that genes with low sequencing depths had slightly higher D-RCS scores on average (<xref rid="figS12" ref-type="fig">Supplementary Figure 12</xref>). However, genes with the largest D-RCS scores again had a variety of sequencing depths. We conclude that sequencing depth has minimal correlation with the largest D-RCS scores.</p>
<fig id="figS12" position="float" fig-type="figure">
<label>Supplementary Figure 12.</label>
<caption><p>Mean sequencing depth of each gene plotted against their D-RCS scores in MS. Genes with the largest D-RCS scores (red ellipse) again had a variety of sequencing depths.</p></caption>
<graphic xlink:href="574491v5_figS12.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7c3">
<title>Biological Results</title>
<p>We provide the full global pathway enrichment analysis results for MS in <xref rid="tblS2" ref-type="table">Supplementary Table 2</xref>. Pathway enrichment analysis of the individual clusters in <xref rid="fig4" ref-type="fig">Figure 4 (f)</xref> consistently implicated EPH-ephrin signaling among the top two pathways. However, each cluster also involved one separate additional pathway (<xref rid="figS13" ref-type="fig">Supplementary Figure 13</xref>). The green cluster involved the same APC-AXIN pathway as the global analysis via beta-catenin. On the other hand, the blue cluster involved ‚Äúplatelet sensitization by LDL.‚Äù Low density lipoprotein enhances platelet aggregation. Platelet degranulation in turn drives the generation of autoreactive T cells in the peripheral circulation during disturbance of the blood brain barrier (<xref ref-type="bibr" rid="c42">Orian et al., 2021</xref>). Finally, CTLA4 regulates T-cell homeostasis and inhibits autommunity for the pink cluster (<xref ref-type="bibr" rid="c4">Basile et al., 2022</xref>). The D-RCS scores of each cluster thus implicate different mechanisms of T cell pathology.</p>
<table-wrap id="tblS2" orientation="portrait" position="float">
<label>Supplementary Table 2.</label>
<caption><p>Full pathway enrichment analysis results for all patients in the MS dataset. We again list up to the top three leading edge genes in the right-most column.</p></caption>
<graphic xlink:href="574491v5_tblS2.tif" mime-subtype="tiff" mimetype="image"/>
</table-wrap>
<fig id="figS13" position="float" fig-type="figure">
<label>Supplementary Figure 13.</label>
<caption><p>Pathway enrichment analysis results by cluster consistently revealed EPH-ephrin signaling as well as an additional pathway implicating T cell pathology.</p></caption>
<graphic xlink:href="574491v5_figS13.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>The severity of MS, as assessed by the Expanded Disability Status Scale (EDSS) score, did not correlate with either dimension of the UMAP embedding (<xref rid="figS14" ref-type="fig">Supplementary Figure 14 (a)</xref>). The top genes in <xref rid="fig4" ref-type="fig">Figure 4</xref> (d) such as MNT and CERCAM also did not correlate. However, lower ranked genes such as TRIP10 did (<xref rid="figS14" ref-type="fig">Supplementary Figure 14 (b)</xref>). An expanded correlation analysis with the top 30 genes revealed significant correlations across a variety of lower ranked genes (<xref rid="figS14" ref-type="fig">Supplementary Figures 14 (c)</xref> and <xref rid="figS14" ref-type="fig">14 (d)</xref>). We conclude that the distribution of lower ranked genes govern the structure of the UMAP embedding in <xref rid="fig4" ref-type="fig">Figure 4 (f)</xref>.</p>
<fig id="figS14" position="float" fig-type="figure">
<label>Supplementary Figure 14.</label>
<caption><p>Additional analyses of the UMAP embedding for MS. (a) The UMAP dimensions did not correlate with MS severity as assessed by EDSS. However, lower ranked genes such as TRIP10 correlated with both dimensions in (b). We expanded the analysis to the top 30 genes and plot the genes with the highest correlations to UMAP dimension one and two in (c) and (d), respectively.</p></caption>
<graphic xlink:href="574491v5_figS14.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
</sec>
<sec id="s7c4">
<title>Proofs</title>
<statement id="lem1a">
<label>Lemma 1.</label>
<p><italic>Assume Lipschitz continuity of the conditional expectation for all N</italic> ‚â• <italic>n</italic><sub>0</sub>:
<disp-formula id="eqn6">
<graphic xlink:href="574491v5_eqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
<italic>where</italic> <inline-formula><inline-graphic xlink:href="574491v5_inline88.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, <italic>C</italic><sub><italic>N</italic></sub> ‚àà <italic>O</italic>(1) <italic>is a positive constant, and we have taken an outer expectation on both sides. Then</italic> ùîº(<italic>Y</italic> | <sup><bold>≈®</bold></sup>) = lim<sub><italic>N</italic>‚Üí‚àû</sub> ùîº(<italic>Y</italic> | <bold><italic>U</italic></bold>, <italic>L, B</italic>) <italic>almost surely</italic>.</p>
<p><italic>Proof</italic>. We can write the following sequence:
<disp-formula id="ueqn7">
<graphic xlink:href="574491v5_ueqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where we have applied Expression (6) at the first inequality. We have <italic>C</italic><sub><italic>N</italic></sub> ‚â§ <italic>C</italic> for all <italic>N</italic> ‚â• <italic>n</italic><sub>0</sub> in the second inequality because <italic>C</italic><sub><italic>N</italic></sub> ‚àà <italic>O</italic>(1). With the above bound, choose <italic>Œ±</italic> &gt; 0 and invoke the Markov inequality:
<disp-formula id="ueqn8">
<graphic xlink:href="574491v5_ueqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</statement>
<p>The conclusion follows because we chose <italic>Œ±</italic> arbitrarily.</p>
<statement id="pro1a">
<label>Proposition 1.</label>
<p><italic>If</italic> <inline-formula><inline-graphic xlink:href="574491v5_inline89.gif" mime-subtype="gif" mimetype="image"/></inline-formula> <italic>or</italic><inline-formula><inline-graphic xlink:href="574491v5_inline90.gif" mime-subtype="gif" mimetype="image"/></inline-formula> <italic>(or both), then E</italic><sub><italic>i</italic></sub> <italic>is a root cause of Y</italic>.</p>
<p><italic>Proof</italic>. If <inline-formula><inline-graphic xlink:href="574491v5_inline91.gif" mime-subtype="gif" mimetype="image"/></inline-formula> or <inline-formula><inline-graphic xlink:href="574491v5_inline92.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (or both), then <italic>E</italic><sub><italic>i</italic></sub> and <italic>Y</italic> are d-connected by the global Markov property. Since <italic>E</italic><sub><italic>i</italic></sub> is a root vertex, the d-connection implies that there exists a directed path from <italic>E</italic><sub><italic>i</italic></sub> to <italic>Y</italic>.</p>
</statement>
<statement id="pro2a">
<label>Proposition 2.</label>
<p><italic>We have</italic> <inline-formula><inline-graphic xlink:href="574491v5_inline93.gif" mime-subtype="gif" mimetype="image"/></inline-formula> <italic>under Equation</italic> (3).</p>
<p><italic>Proof</italic>. We can write:
<disp-formula id="ueqn9">
<graphic xlink:href="574491v5_ueqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
</p>
</statement>
<p>The second equality follows because <inline-formula><inline-graphic xlink:href="574491v5_inline94.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is a constant given <italic>E</italic><sub><italic>i</italic></sub> and <inline-formula><inline-graphic xlink:href="574491v5_inline95.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The third equality follows by the global Markov property because <italic>Y</italic> is a terminal vertex.</p>
<statement id="the2a">
<label>Theorem 2.</label>
<p><italic>(Fisher consistency) Consider the same assumption as Lemma 1. If unconditional d-separation faithfulness holds, then RCSP recovers</italic> Œ¶ <italic>almost surely as N</italic> ‚Üí ‚àû.</p>
<p><italic>Proof</italic>. If <inline-formula><inline-graphic xlink:href="574491v5_inline96.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in Line 2 of Algorithm 1, then <italic>X</italic><sub><italic>k</italic></sub> is a descendant of the root vertex <italic>P</italic><sub><italic>i</italic></sub> under the global Markov property. Similarly, if <italic>X</italic><sub><italic>k</italic></sub> is a descendant of <italic>P</italic><sub><italic>i</italic></sub>, then <italic>X</italic><sub><italic>k</italic></sub> is d-connected to <italic>P</italic><sub><italic>i</italic></sub> so <inline-formula><inline-graphic xlink:href="574491v5_inline97.gif" mime-subtype="gif" mimetype="image"/></inline-formula> by unconditional d-separation faithfulness. Hence, <inline-formula><inline-graphic xlink:href="574491v5_inline98.gif" mime-subtype="gif" mimetype="image"/></inline-formula> contains only and all the surrogate descendants of <inline-formula><inline-graphic xlink:href="574491v5_inline99.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for each <inline-formula><inline-graphic xlink:href="574491v5_inline100.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. This in turn implies that <inline-formula><inline-graphic xlink:href="574491v5_inline101.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in Line 5 of Algorithm 1 contains only and all the surrogate ancestors of. Hence, RCSP now has <inline-formula><inline-graphic xlink:href="574491v5_inline102.gif" mime-subtype="gif" mimetype="image"/></inline-formula> access to the correct set <inline-formula><inline-graphic xlink:href="574491v5_inline103.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as well as <italic>B</italic> for each <inline-formula><inline-graphic xlink:href="574491v5_inline104.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. We finally invoke Theorem 1 to conclude that RCSP recovers Œ¶ almost surely as <italic>N</italic> ‚Üí ‚àû.</p>
</statement>
</sec>
</sec>
</sec>
<ack>
<title>Acknowledgements</title>
<p>Research reported in this report was supported by the National Human Genome Research Institute of the National Institutes of Health under award numbers R01HG011138 and R35HG010718.</p>
</ack>
<ref-list>
<title>References</title>
<ref id="c1"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Adamson</surname> <given-names>B</given-names></string-name>, <string-name><surname>Norman</surname> <given-names>TM</given-names></string-name>, <string-name><surname>Jost</surname> <given-names>M</given-names></string-name>, <string-name><surname>Cho</surname> <given-names>MY</given-names></string-name>, <string-name><surname>Nu√±ez</surname> <given-names>JK</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Villalta</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Gilbert</surname> <given-names>LA</given-names></string-name>, <string-name><surname>Horlbeck</surname> <given-names>MA</given-names></string-name>, <string-name><surname>Hein</surname> <given-names>MY</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>A multiplexed single-cell CRISPR screening platform enables systematic dissection of the unfolded protein response</article-title>. <source>Cell</source>. <year>2016</year>; <volume>167</volume>(<issue>7</issue>):<fpage>1867</fpage>‚Äì<lpage>1882</lpage>.</mixed-citation></ref>
<ref id="c2"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Andhavarapu</surname> <given-names>S</given-names></string-name>, <string-name><surname>Mubariz</surname> <given-names>F</given-names></string-name>, <string-name><surname>Arvas</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bever Jr</surname> <given-names>C</given-names></string-name>, <string-name><surname>Makar</surname> <given-names>TK</given-names></string-name></person-group>. <article-title>Interplay between ER stress and autophagy: a possible mechanism in multiple sclerosis pathology</article-title>. <source>Experimental and Molecular Pathology</source>. <year>2019</year>; <volume>108</volume>:<fpage>183</fpage>‚Äì<lpage>190</lpage>.</mixed-citation></ref>
<ref id="c3"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Barouch</surname> <given-names>FC</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>JW</given-names></string-name></person-group>. <article-title>The role of inflammation and infection in age-related macular degeneration</article-title>. <source>International ophthalmology clinics</source>. <year>2007</year>; <volume>47</volume>(<issue>2</issue>):<fpage>185</fpage>‚Äì<lpage>197</lpage>.</mixed-citation></ref>
<ref id="c4"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Basile</surname> <given-names>MS</given-names></string-name>, <string-name><surname>Bramanti</surname> <given-names>P</given-names></string-name>, <string-name><surname>Mazzon</surname> <given-names>E.</given-names></string-name></person-group> <article-title>The role of cytotoxic T-lymphocyte antigen 4 in the pathogenesis of multiple sclerosis</article-title>. <source>Genes</source>. <year>2022</year>; <volume>13</volume>(<issue>8</issue>):<fpage>1319</fpage>.</mixed-citation></ref>
<ref id="c5"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Beaumatin</surname> <given-names>F</given-names></string-name>, <string-name><surname>O‚Äôprey</surname> <given-names>J</given-names></string-name>, <string-name><surname>Barthet</surname> <given-names>VJ</given-names></string-name>, <string-name><surname>Zunino</surname> <given-names>B</given-names></string-name>, <string-name><surname>Parvy</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Bachmann</surname> <given-names>AM</given-names></string-name>, <string-name><surname>O‚Äôprey</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kania</surname> <given-names>E</given-names></string-name>, <string-name><surname>Gonzalez</surname> <given-names>PS</given-names></string-name>, <string-name><surname>Macintosh</surname> <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>mTORC1 activation requires DRAM-1 by facilitating lysosomal amino acid efflux</article-title>. <source>Molecular Cell</source>. <year>2019</year>; <volume>76</volume>(<issue>1</issue>):<fpage>163</fpage>‚Äì<lpage>176</lpage>.</mixed-citation></ref>
<ref id="c6"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bongers</surname> <given-names>S</given-names></string-name>, <string-name><surname>Forr√©</surname> <given-names>P</given-names></string-name>, <string-name><surname>Peters</surname> <given-names>J</given-names></string-name>, <string-name><surname>Mooij</surname> <given-names>JM</given-names></string-name></person-group>. <article-title>Foundations of structural causal models with cycles and latent variables</article-title>. <source>The Annals of Statistics</source>. <year>2021</year>; <volume>49</volume>(<issue>5</issue>):<fpage>2885</fpage>‚Äì<lpage>2915</lpage>.</mixed-citation></ref>
<ref id="c7"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Boyle</surname> <given-names>EA</given-names></string-name>, <string-name><surname>Li</surname> <given-names>YI</given-names></string-name>, <string-name><surname>Pritchard</surname> <given-names>JK</given-names></string-name></person-group>. <article-title>An expanded view of complex traits: from polygenic to omnigenic</article-title>. <source>Cell</source>. <year>2017</year>; <volume>169</volume>(<issue>7</issue>):<fpage>1177</fpage>‚Äì<lpage>1186</lpage>.</mixed-citation></ref>
<ref id="c8"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Burster</surname> <given-names>T</given-names></string-name>, <string-name><surname>Beck</surname> <given-names>A</given-names></string-name>, <string-name><surname>Poeschel</surname> <given-names>S</given-names></string-name>, <string-name><surname>√òren</surname> <given-names>A</given-names></string-name>, <string-name><surname>Baechle</surname> <given-names>D</given-names></string-name>, <string-name><surname>Reich</surname> <given-names>M</given-names></string-name>, <string-name><surname>Roetzschke</surname> <given-names>O</given-names></string-name>, <string-name><surname>Falk</surname> <given-names>K</given-names></string-name>, <string-name><surname>Boehm</surname> <given-names>BO</given-names></string-name>, <string-name><surname>Youssef</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Interferon-Œ≥ regulates cathepsin G activity in microglia-derived lysosomes and controls the proteolytic processing of myelin basic protein in vitro</article-title>. <source>Immunology</source>. <year>2007</year>; <volume>121</volume>(<issue>1</issue>):<fpage>82</fpage>‚Äì<lpage>93</lpage>.</mixed-citation></ref>
<ref id="c9"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Buschur</surname> <given-names>KL</given-names></string-name>, <string-name><surname>Chikina</surname> <given-names>M</given-names></string-name>, <string-name><surname>Benos</surname> <given-names>PV</given-names></string-name></person-group>. <article-title>Causal network perturbations for instance-specific analysis of single cell and disease samples</article-title>. <source>Bioinformatics</source>. <year>2020</year>; <volume>36</volume>(<issue>8</issue>):<fpage>2515</fpage>‚Äì<lpage>2521</lpage>.</mixed-citation></ref>
<ref id="c10"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Cano-Gamez</surname> <given-names>E</given-names></string-name>, <string-name><surname>Trynka</surname> <given-names>G.</given-names></string-name></person-group> <article-title>From GWAS to function: using functional genomics to identify the mechanisms underlying complex diseases</article-title>. <source>Frontiers in Genetics</source>. <year>2020</year>; <volume>11</volume>:<fpage>424</fpage>.</mixed-citation></ref>
<ref id="c11"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Choudhary</surname> <given-names>S</given-names></string-name>, <string-name><surname>Satija</surname> <given-names>R.</given-names></string-name></person-group> <article-title>Comparison and evaluation of statistical error models for scRNA-seq</article-title>. <source>Genome Biology</source>. <year>2022</year>; <volume>23</volume>(<issue>1</issue>):<fpage>27</fpage>.</mixed-citation></ref>
<ref id="c12"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Colombo</surname> <given-names>D</given-names></string-name>, <string-name><surname>Maathuis</surname> <given-names>MH</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Order-independent constraint-based causal structure learning</article-title>. <source>Journal of Machine Learning Research</source>. <year>2014</year>; <volume>15</volume>(<issue>1</issue>):<fpage>3741</fpage>‚Äì<lpage>3782</lpage>.</mixed-citation></ref>
<ref id="c13"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Costa-Silva</surname> <given-names>J</given-names></string-name>, <string-name><surname>Domingues</surname> <given-names>D</given-names></string-name>, <string-name><surname>Lopes</surname> <given-names>FM</given-names></string-name></person-group>. <article-title>RNA-Seq differential expression analysis: An extended review and a software tool</article-title>. <source>PloS One</source>. <year>2017</year>; <volume>12</volume>(<issue>12</issue>):<fpage>e0190152</fpage>.</mixed-citation></ref>
<ref id="c14"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dalvin</surname> <given-names>LA</given-names></string-name>, <string-name><surname>Olsen</surname> <given-names>TW</given-names></string-name>, <string-name><surname>Bakri</surname> <given-names>SJ</given-names></string-name>, <string-name><surname>McCullough</surname> <given-names>K</given-names></string-name>, <string-name><surname>Tefferi</surname> <given-names>A</given-names></string-name>, <string-name><surname>Al-Kali</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Busulfan treatment for myeloproliferative disease may reduce injection burden in vascular endothelial growth factor-driven retinopathy</article-title>. <source>American Journal of Ophthalmology Case Reports</source>. <year>2022</year>; <volume>26</volume>:<fpage>101554</fpage>.</mixed-citation></ref>
<ref id="c15"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Datlinger</surname> <given-names>P</given-names></string-name>, <string-name><surname>Rendeiro</surname> <given-names>AF</given-names></string-name>, <string-name><surname>Schmidl</surname> <given-names>C</given-names></string-name>, <string-name><surname>Krausgruber</surname> <given-names>T</given-names></string-name>, <string-name><surname>Traxler</surname> <given-names>P</given-names></string-name>, <string-name><surname>Klughammer</surname> <given-names>J</given-names></string-name>, <string-name><surname>Schuster</surname> <given-names>LC</given-names></string-name>, <string-name><surname>Kuchler</surname> <given-names>A</given-names></string-name>, <string-name><surname>Alpar</surname> <given-names>D</given-names></string-name>, <string-name><surname>Bock</surname> <given-names>C.</given-names></string-name></person-group> <article-title>Pooled CRISPR screening with single-cell transcriptome readout</article-title>. <source>Nature methods</source>. <year>2017</year>; <volume>14</volume>(<issue>3</issue>):<fpage>297</fpage>‚Äì<lpage>301</lpage>.</mixed-citation></ref>
<ref id="c16"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Dixit</surname> <given-names>A</given-names></string-name>, <string-name><surname>Parnas</surname> <given-names>O</given-names></string-name>, <string-name><surname>Li</surname> <given-names>B</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>J</given-names></string-name>, <string-name><surname>Fulco</surname> <given-names>CP</given-names></string-name>, <string-name><surname>Jerby-Arnon</surname> <given-names>L</given-names></string-name>, <string-name><surname>Marjanovic</surname> <given-names>ND</given-names></string-name>, <string-name><surname>Dionne</surname> <given-names>D</given-names></string-name>, <string-name><surname>Burks</surname> <given-names>T</given-names></string-name>, <string-name><surname>Raychowdhury</surname> <given-names>R</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Perturb-Seq: dissecting molecular circuits with scalable single-cell RNA profiling of pooled genetic screens</article-title>. <source>Cell</source>. <year>2016</year>; <volume>167</volume>(<issue>7</issue>):<fpage>1853</fpage>‚Äì<lpage>1866</lpage>.</mixed-citation></ref>
<ref id="c17"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Ellington</surname> <given-names>CN</given-names></string-name>, <string-name><surname>Lengerich</surname> <given-names>BJ</given-names></string-name>, <string-name><surname>Watkins</surname> <given-names>TB</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Xiao</surname> <given-names>H</given-names></string-name>, <string-name><surname>Kellis</surname> <given-names>M</given-names></string-name>, <string-name><surname>Xing</surname> <given-names>EP</given-names></string-name></person-group>. <article-title>Contextualized Networks Reveal Heterogeneous Transcriptomic Regulation in Tumors at Sample-Specific Resolution</article-title>. In: <conf-name>Neural Information and Processing Systems Workshop on Generative AI and Biology</conf-name>; <year>2023</year>..</mixed-citation></ref>
<ref id="c18"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fabregat</surname> <given-names>A</given-names></string-name>, <string-name><surname>Sidiropoulos</surname> <given-names>K</given-names></string-name>, <string-name><surname>Viteri</surname> <given-names>G</given-names></string-name>, <string-name><surname>Forner</surname> <given-names>O</given-names></string-name>, <string-name><surname>Marin-Garcia</surname> <given-names>P</given-names></string-name>, <string-name><surname>Arnau</surname> <given-names>V</given-names></string-name>, <string-name><surname>D‚ÄôEustachio</surname> <given-names>P</given-names></string-name>, <string-name><surname>Stein</surname> <given-names>L</given-names></string-name>, <string-name><surname>Hermjakob</surname> <given-names>H.</given-names></string-name></person-group> <article-title>Reactome pathway analysis: a high-performance in-memory approach</article-title>. <source>BMC Bioinformatics</source>. <year>2017</year>; <volume>18</volume>(<issue>1</issue>):<fpage>1</fpage>‚Äì<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c19"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Fletcher</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Lalor</surname> <given-names>S</given-names></string-name>, <string-name><surname>Sweeney</surname> <given-names>C</given-names></string-name>, <string-name><surname>Tubridy</surname> <given-names>N</given-names></string-name>, <string-name><surname>Mills</surname> <given-names>K.</given-names></string-name></person-group> <article-title>T cells in multiple sclerosis and experimental autoimmune encephalomyelitis</article-title>. <source>Clinical &amp; Experimental Immunology</source>. <year>2010</year>; <volume>162</volume>(<issue>1</issue>):<fpage>1</fpage>‚Äì<lpage>11</lpage>.</mixed-citation></ref>
<ref id="c20"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Friedman</surname> <given-names>JH</given-names></string-name></person-group>. <article-title>Multivariate adaptive regression splines</article-title>. <source>The Annals of Statistics</source>. <year>1991</year>; <volume>19</volume>(<issue>1</issue>):<fpage>1</fpage>‚Äì<lpage>67</lpage>.</mixed-citation></ref>
<ref id="c21"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Friedman</surname> <given-names>N</given-names></string-name>, <string-name><surname>Linial</surname> <given-names>M</given-names></string-name>, <string-name><surname>Nachman</surname> <given-names>I</given-names></string-name>, <string-name><surname>Pe‚Äôer</surname> <given-names>D.</given-names></string-name></person-group> <article-title>Using Bayesian networks to analyze expression data</article-title>. In: <conf-name>Proceedings of the Fourth Annual International Conference on Computational Molecular Biology</conf-name>; <year>2000</year>. p. <fpage>127</fpage>‚Äì<lpage>135</lpage>.</mixed-citation></ref>
<ref id="c22"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gnanaprakasam</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>R.</given-names></string-name></person-group> <article-title>MYC in regulating immunity: metabolism and beyond</article-title>. <source>Genes</source>. <year>2017</year>; <volume>8</volume>(<issue>3</issue>):<fpage>88</fpage>.</mixed-citation></ref>
<ref id="c23"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Go</surname> <given-names>YM</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Fernandes</surname> <given-names>J</given-names></string-name>, <string-name><surname>Litwin</surname> <given-names>C</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>R</given-names></string-name>, <string-name><surname>Wensel</surname> <given-names>TG</given-names></string-name>, <string-name><surname>Jones</surname> <given-names>DP</given-names></string-name>, <string-name><surname>Cai</surname> <given-names>J</given-names></string-name>, <string-name><surname>Chen</surname> <given-names>Y.</given-names></string-name></person-group> <article-title>MTOR-initiated metabolic switch and degeneration in the retinal pigment epithelium</article-title>. <source>FASEB Journal</source>. <year>2020</year>; <volume>34</volume>(<issue>9</issue>):<fpage>12502</fpage>.</mixed-citation></ref>
<ref id="c24"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Golan</surname> <given-names>M</given-names></string-name>, <string-name><surname>Krivitsky</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mausner-Fainberg</surname> <given-names>K</given-names></string-name>, <string-name><surname>Benhamou</surname> <given-names>M</given-names></string-name>, <string-name><surname>Vigiser</surname> <given-names>I</given-names></string-name>, <string-name><surname>Regev</surname> <given-names>K</given-names></string-name>, <string-name><surname>Kolb</surname> <given-names>H</given-names></string-name>, <string-name><surname>Karni</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Increased expression of ephrins on immune cells of patients with relapsing remitting multiple sclerosis affects oligodendrocyte differentiation</article-title>. <source>International Journal of Molecular Sciences</source>. <year>2021</year>; <volume>22</volume>(<issue>4</issue>):<fpage>2182</fpage>.</mixed-citation></ref>
<ref id="c25"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Green</surname> <given-names>TD</given-names></string-name>, <string-name><surname>Peidli</surname> <given-names>S</given-names></string-name>, <string-name><surname>Shen</surname> <given-names>C</given-names></string-name>, <string-name><surname>Gross</surname> <given-names>T</given-names></string-name>, <string-name><surname>Min</surname> <given-names>J</given-names></string-name>, <string-name><surname>Garda</surname> <given-names>S</given-names></string-name>, <string-name><surname>Taylor-King</surname> <given-names>JP</given-names></string-name>, <string-name><surname>Marks</surname> <given-names>DS</given-names></string-name>, <string-name><surname>Luna</surname> <given-names>A</given-names></string-name>, <string-name><surname>Bl√ºthgen</surname> <given-names>N</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>scPerturb: Information Resource for Harmonized Single-Cell Perturbation Data</article-title>. In: <conf-name>NeurIPS 2022 Workshop on Learning Meaningful Representations of Life</conf-name>; <year>2022</year>..</mixed-citation></ref>
<ref id="c26"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gr√ºn</surname> <given-names>D</given-names></string-name>, <string-name><surname>Kester</surname> <given-names>L</given-names></string-name>, <string-name><surname>Van Oudenaarden</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Validation of noise models for single-cell transcriptomics</article-title>. <source>Nature Methods</source>. <year>2014</year>; <volume>11</volume>(<issue>6</issue>):<fpage>637</fpage>‚Äì<lpage>640</lpage>.</mixed-citation></ref>
<ref id="c27"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hadziahmetovic</surname> <given-names>M</given-names></string-name>, <string-name><surname>Malek</surname> <given-names>G.</given-names></string-name></person-group> <article-title>Age-related macular degeneration revisited: From pathology and cellular stress to potential therapies</article-title>. <source>Frontiers in Cell and Developmental Biology</source>. <year>2021</year>; <volume>8</volume>:<fpage>612812</fpage>.</mixed-citation></ref>
<ref id="c28"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Haves-Zburof</surname> <given-names>D</given-names></string-name>, <string-name><surname>Paperna</surname> <given-names>T</given-names></string-name>, <string-name><surname>Gour-Lavie</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mandel</surname> <given-names>I</given-names></string-name>, <string-name><surname>Glass-Marmor</surname> <given-names>L</given-names></string-name>, <string-name><surname>Miller</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Cathepsins and their endogenous inhibitors cystatins: expression and modulation in multiple sclerosis</article-title>. <source>Journal of Cellular and Molecular Medicine</source>. <year>2011</year>; <volume>15</volume>(<issue>11</issue>):<fpage>2421</fpage>‚Äì<lpage>2429</lpage>.</mixed-citation></ref>
<ref id="c29"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kamalden</surname> <given-names>T</given-names></string-name>, <string-name><surname>Ji</surname> <given-names>D</given-names></string-name>, <string-name><surname>Fawcett</surname> <given-names>R</given-names></string-name>, <string-name><surname>Osborne</surname> <given-names>N.</given-names></string-name></person-group> <article-title>Genistein blunts the negative effect of ischaemia to the retina caused by an elevation of intraocular pressure</article-title>. <source>Ophthalmic Research</source>. <year>2011</year>; <volume>45</volume>(<issue>2</issue>):<fpage>65</fpage>‚Äì<lpage>72</lpage>.</mixed-citation></ref>
<ref id="c30"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kim</surname> <given-names>K</given-names></string-name>, <string-name><surname>Pr√∂bstel</surname> <given-names>AK</given-names></string-name>, <string-name><surname>Baumann</surname> <given-names>R</given-names></string-name>, <string-name><surname>Dyckow</surname> <given-names>J</given-names></string-name>, <string-name><surname>Landefeld</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kogl</surname> <given-names>E</given-names></string-name>, <string-name><surname>Madireddy</surname> <given-names>L</given-names></string-name>, <string-name><surname>Loudermilk</surname> <given-names>R</given-names></string-name>, <string-name><surname>Eggers</surname> <given-names>EL</given-names></string-name>, <string-name><surname>Singh</surname> <given-names>S</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Cell type-specific transcriptomics identifies neddylation as a novel therapeutic target in multiple sclerosis</article-title>. <source>Brain</source>. <year>2021</year>; <volume>144</volume>(<issue>2</issue>):<fpage>450</fpage>‚Äì<lpage>461</lpage>.</mixed-citation></ref>
<ref id="c31"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kinoshita</surname> <given-names>S</given-names></string-name>, <string-name><surname>Noda</surname> <given-names>K</given-names></string-name>, <string-name><surname>Tagawa</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Inafuku</surname> <given-names>S</given-names></string-name>, <string-name><surname>Dong</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Fukuhara</surname> <given-names>J</given-names></string-name>, <string-name><surname>Dong</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Ando</surname> <given-names>R</given-names></string-name>, <string-name><surname>Kanda</surname> <given-names>A</given-names></string-name>, <string-name><surname>Ishida</surname> <given-names>S.</given-names></string-name></person-group> <article-title>Genistein attenuates choroidal neovascularization</article-title>. <source>The Journal of Nutritional Biochemistry</source>. <year>2014</year>; <volume>25</volume>(<issue>11</issue>):<fpage>1177</fpage>‚Äì<lpage>1182</lpage>.</mixed-citation></ref>
<ref id="c32"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Kokame</surname> <given-names>K</given-names></string-name>, <string-name><surname>Agarwala</surname> <given-names>KL</given-names></string-name>, <string-name><surname>Kato</surname> <given-names>H</given-names></string-name>, <string-name><surname>Miyata</surname> <given-names>T.</given-names></string-name></person-group> <article-title>Herp, a new ubiquitin-like membrane protein induced by endoplasmic reticulum stress</article-title>. <source>Journal of Biological Chemistry</source>. <year>2000</year>; <volume>275</volume>(<issue>42</issue>):<fpage>32846</fpage>‚Äì<lpage>32853</lpage>.</mixed-citation></ref>
<ref id="c33"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Lengfeld</surname> <given-names>JE</given-names></string-name>, <string-name><surname>Lutz</surname> <given-names>SE</given-names></string-name>, <string-name><surname>Smith</surname> <given-names>JR</given-names></string-name>, <string-name><surname>Diaconu</surname> <given-names>C</given-names></string-name>, <string-name><surname>Scott</surname> <given-names>C</given-names></string-name>, <string-name><surname>Kofman</surname> <given-names>SB</given-names></string-name>, <string-name><surname>Choi</surname> <given-names>C</given-names></string-name>, <string-name><surname>Walsh</surname> <given-names>CM</given-names></string-name>, <string-name><surname>Raine</surname> <given-names>CS</given-names></string-name>, <string-name><surname>Agalliu</surname> <given-names>I</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Endothelial Wnt/Œ≤-catenin signaling reduces immune cell infiltration in multiple sclerosis</article-title>. <source>Proceedings of the National Academy of Sciences</source>. <year>2017</year>; <volume>114</volume>(<issue>7</issue>):<fpage>E1168</fpage>‚Äì<lpage>E1177</lpage>.</mixed-citation></ref>
<ref id="c34"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Luo</surname> <given-names>H</given-names></string-name>, <string-name><surname>Broux</surname> <given-names>B</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Hu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Ghannam</surname> <given-names>S</given-names></string-name>, <string-name><surname>Jin</surname> <given-names>W</given-names></string-name>, <string-name><surname>Larochelle</surname> <given-names>C</given-names></string-name>, <string-name><surname>Prat</surname> <given-names>A</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>J.</given-names></string-name></person-group> <article-title>EphrinB1 and EphrinB2 regulate T cell chemotaxis and migration in experimental autoimmune encephalomyelitis and multiple sclerosis</article-title>. <source>Neurobiology of Disease</source>. <year>2016</year>; <volume>91</volume>:<fpage>292</fpage>‚Äì<lpage>306</lpage>.</mixed-citation></ref>
<ref id="c35"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Mart√≠nez-Jim√©nez</surname> <given-names>F</given-names></string-name>, <string-name><surname>Mui√±os</surname> <given-names>F</given-names></string-name>, <string-name><surname>Sent√≠s</surname> <given-names>I</given-names></string-name>, <string-name><surname>Deu-Pons</surname> <given-names>J</given-names></string-name>, <string-name><surname>Reyes-Salazar</surname> <given-names>I</given-names></string-name>, <string-name><surname>Arnedo-Pac</surname> <given-names>C</given-names></string-name>, <string-name><surname>Mularoni</surname> <given-names>L</given-names></string-name>, <string-name><surname>Pich</surname> <given-names>O</given-names></string-name>, <string-name><surname>Bonet</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kranas</surname> <given-names>H</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>A compendium of mutational cancer driver genes</article-title>. <source>Nature Reviews Cancer</source>. <year>2020</year>; <volume>20</volume>(<issue>10</issue>):<fpage>555</fpage>‚Äì<lpage>572</lpage>.</mixed-citation></ref>
<ref id="c36"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nachef</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ali</surname> <given-names>AK</given-names></string-name>, <string-name><surname>Almutairi</surname> <given-names>SM</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>SH</given-names></string-name></person-group>. <article-title>Targeting SLC1A5 and SLC3A2/SLC7A5 as a potential strategy to strengthen anti-tumor immunity in the tumor microenvironment</article-title>. <source>Frontiers in immunology</source>. <year>2021</year>; <volume>12</volume>:<fpage>624324</fpage>.</mixed-citation></ref>
<ref id="c37"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nagral</surname> <given-names>A.</given-names></string-name></person-group> <article-title>Gaucher disease</article-title>. <source>Journal of Clinical and Experimental Hepatology</source>. <year>2014</year>; <volume>4</volume>(<issue>1</issue>):<fpage>37</fpage>‚Äì<lpage>50</lpage>.</mixed-citation></ref>
<ref id="c38"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Narendran</surname> <given-names>S</given-names></string-name>, <string-name><surname>Pereira</surname> <given-names>F</given-names></string-name>, <string-name><surname>Yerramothu</surname> <given-names>P</given-names></string-name>, <string-name><surname>Apicella</surname> <given-names>I</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>Sb</given-names></string-name>, <string-name><surname>Varshney</surname> <given-names>A</given-names></string-name>, <string-name><surname>Baker</surname> <given-names>KL</given-names></string-name>, <string-name><surname>Marion</surname> <given-names>KM</given-names></string-name>, <string-name><surname>Ambati</surname> <given-names>M</given-names></string-name>, <string-name><surname>Ambati</surname> <given-names>VL</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>A clinical metabolite of azidothymidine inhibits experimental choroidal neovascularization and retinal pigmented epithelium degeneration</article-title>. <source>Investigative ophthalmology &amp; visual science</source>. <year>2020</year>; <volume>61</volume>(<issue>10</issue>):<fpage>4</fpage>‚Äì<lpage>4</lpage>.</mixed-citation></ref>
<ref id="c39"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ng</surname> <given-names>I</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>B</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>K.</given-names></string-name></person-group> <article-title>Structure learning with continuous optimization: A sober look and beyond</article-title>. <source>PMLR</source>; <year>2024</year>. p. <fpage>71</fpage>‚Äì<lpage>105</lpage>.</mixed-citation></ref>
<ref id="c40"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nicklin</surname> <given-names>P</given-names></string-name>, <string-name><surname>Bergman</surname> <given-names>P</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>B</given-names></string-name>, <string-name><surname>Triantafellow</surname> <given-names>E</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Nyfeler</surname> <given-names>B</given-names></string-name>, <string-name><surname>Yang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Hild</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kung</surname> <given-names>C</given-names></string-name>, <string-name><surname>Wilson</surname> <given-names>C</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Bidirectional transport of amino acids regulates mTOR and autophagy</article-title>. <source>Cell</source>. <year>2009</year>; <volume>136</volume>(<issue>3</issue>):<fpage>521</fpage>‚Äì<lpage>534</lpage>.</mixed-citation></ref>
<ref id="c41"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Olsen</surname> <given-names>TW</given-names></string-name>, <string-name><surname>Feng</surname> <given-names>X.</given-names></string-name></person-group> <article-title>The Minnesota Grading System of eye bank eyes for age-related macular degeneration</article-title>. <source>Investigative Ophthalmology and Visual Science</source>. <year>2004</year>; <volume>45</volume>(<issue>12</issue>):<fpage>4484</fpage>‚Äì<lpage>4490</lpage>.</mixed-citation></ref>
<ref id="c42"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Orian</surname> <given-names>JM</given-names></string-name>, <string-name><surname>D‚ÄôSouza</surname> <given-names>CS</given-names></string-name>, <string-name><surname>Kocovski</surname> <given-names>P</given-names></string-name>, <string-name><surname>Krippner</surname> <given-names>G</given-names></string-name>, <string-name><surname>Hale</surname> <given-names>MW</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>X</given-names></string-name>, <string-name><surname>Peter</surname> <given-names>K.</given-names></string-name></person-group> <article-title>Platelets in multiple sclerosis: early and central mediators of inflammation and neurodegeneration and attractive targets for molecular imaging and site-directed therapy</article-title>. <source>Frontiers in Immunology</source>. <year>2021</year>; <volume>12</volume>:<fpage>620963</fpage>.</mixed-citation></ref>
<ref id="c43"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Papoulis</surname> <given-names>A.</given-names></string-name></person-group> <source>Probability, Random Variables and Stochastic Processes</source>. <publisher-name>McGraw-Hill</publisher-name>; <year>1984</year>.</mixed-citation></ref>
<ref id="c44"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Pearl</surname> <given-names>J.</given-names></string-name></person-group> <source>Causality</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2009</year>.</mixed-citation></ref>
<ref id="c45"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Peters</surname> <given-names>J</given-names></string-name>, <string-name><surname>Mooij</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Janzing</surname> <given-names>D</given-names></string-name>, <string-name><surname>Sch√∂lkopf</surname> <given-names>B.</given-names></string-name></person-group> <article-title>Causal discovery with continuous additive noise models</article-title>. <source>Journal of Machine Learning Research</source>. <year>2014</year>.</mixed-citation></ref>
<ref id="c46"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ratnapriya</surname> <given-names>R</given-names></string-name>, <string-name><surname>Sosina</surname> <given-names>OA</given-names></string-name>, <string-name><surname>Starostik</surname> <given-names>MR</given-names></string-name>, <string-name><surname>Kwicklis</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kapphahn</surname> <given-names>RJ</given-names></string-name>, <string-name><surname>Fritsche</surname> <given-names>LG</given-names></string-name>, <string-name><surname>Walton</surname> <given-names>A</given-names></string-name>, <string-name><surname>Arvanitis</surname> <given-names>M</given-names></string-name>, <string-name><surname>Gieser</surname> <given-names>L</given-names></string-name>, <string-name><surname>Pietraszkiewicz</surname> <given-names>A</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Retinal transcriptome and eQTL analyses identify genes associated with age-related macular degeneration</article-title>. <source>Nature Genetics</source>. <year>2019</year>; <volume>51</volume>(<issue>4</issue>):<fpage>606</fpage>‚Äì<lpage>610</lpage>.</mixed-citation></ref>
<ref id="c47"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Reisach</surname> <given-names>A</given-names></string-name>, <string-name><surname>Seiler</surname> <given-names>C</given-names></string-name>, <string-name><surname>Weichwald</surname> <given-names>S.</given-names></string-name></person-group> <article-title>Beware of the simulated DAG! causal discovery benchmarks may be easy to game</article-title>. <source>Advances in Neural Information Processing Systems</source>. <year>2021</year>; <volume>34</volume>:<fpage>27772</fpage>‚Äì<lpage>27784</lpage>.</mixed-citation></ref>
<ref id="c48"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Replogle</surname> <given-names>JM</given-names></string-name>, <string-name><surname>Saunders</surname> <given-names>RA</given-names></string-name>, <string-name><surname>Pogson</surname> <given-names>AN</given-names></string-name>, <string-name><surname>Hussmann</surname> <given-names>JA</given-names></string-name>, <string-name><surname>Lenail</surname> <given-names>A</given-names></string-name>, <string-name><surname>Guna</surname> <given-names>A</given-names></string-name>, <string-name><surname>Mascibroda</surname> <given-names>L</given-names></string-name>, <string-name><surname>Wagner</surname> <given-names>EJ</given-names></string-name>, <string-name><surname>Adelman</surname> <given-names>K</given-names></string-name>, <string-name><surname>Lithwick-Yanai</surname> <given-names>G</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Mapping information-rich genotype-phenotype landscapes with genome-scale Perturb-seq</article-title>. <source>Cell</source>. <year>2022</year>; <volume>185</volume>(<issue>14</issue>):<fpage>2559</fpage>‚Äì<lpage>2575</lpage>.</mixed-citation></ref>
<ref id="c49"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sarkar</surname> <given-names>A</given-names></string-name>, <string-name><surname>Stephens</surname> <given-names>M.</given-names></string-name></person-group> <article-title>Separating measurement and expression models clarifies confusion in single-cell RNA sequencing analysis</article-title>. <source>Nature Genetics</source>. <year>2021</year>; <volume>53</volume>(<issue>6</issue>):<fpage>770</fpage>‚Äì<lpage>777</lpage>.</mixed-citation></ref>
<ref id="c50"><mixed-citation publication-type="preprint"><person-group person-group-type="author"><string-name><surname>Sergushichev</surname> <given-names>A.</given-names></string-name></person-group> <article-title>An algorithm for fast preranked gene set enrichment analysis using cumulative statistic calculation</article-title>. <source>BioRxiv</source>. <year>2016</year>; <volume>60012</volume>:<fpage>1</fpage>‚Äì<lpage>9</lpage>.</mixed-citation></ref>
<ref id="c51"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Shawe-Taylor</surname> <given-names>J</given-names></string-name>, <string-name><surname>Cristianini</surname> <given-names>N.</given-names></string-name></person-group> <source>Kernel Methods for Pattern Analysis</source>. <publisher-name>Cambridge University Press</publisher-name>; <year>2004</year>.</mixed-citation></ref>
<ref id="c52"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Shi</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Qu</surname> <given-names>J</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>D</given-names></string-name>, <string-name><surname>Zhao</surname> <given-names>P</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Tam</surname> <given-names>POS</given-names></string-name>, <string-name><surname>Sun</surname> <given-names>L</given-names></string-name>, <string-name><surname>Zuo</surname> <given-names>X</given-names></string-name>, <string-name><surname>Zhou</surname> <given-names>X</given-names></string-name>, <string-name><surname>Xiao</surname> <given-names>X</given-names></string-name>, <etal>et al.</etal></person-group> <article-title>Genetic variants at 13q12. 12 are associated with high myopia in the Han Chinese population</article-title>. <source>The American Journal of Human Genetics</source>. <year>2011</year>; <volume>88</volume>(<issue>6</issue>):<fpage>805</fpage>‚Äì<lpage>813</lpage>.</mixed-citation></ref>
<ref id="c53"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Sobel</surname> <given-names>RA</given-names></string-name></person-group>. <article-title>Ephrin A receptors and ligands in lesions and normal-appearing white matter in multiple sclerosis</article-title>. <source>Brain Pathology</source>. <year>2005</year>; <volume>15</volume>(<issue>1</issue>):<fpage>35</fpage>‚Äì<lpage>45</lpage>.</mixed-citation></ref>
<ref id="c54"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Spink</surname> <given-names>KE</given-names></string-name>, <string-name><surname>Polakis</surname> <given-names>P</given-names></string-name>, <string-name><surname>Weis</surname> <given-names>WI</given-names></string-name></person-group>. <article-title>Structural basis of the Axin‚Äìadenomatous polyposis coli interaction</article-title>. <source>The EMBO journal</source>. <year>2000</year>; <volume>19</volume>(<issue>10</issue>):<fpage>2270</fpage>‚Äì<lpage>2279</lpage>.</mixed-citation></ref>
<ref id="c55"><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Spirtes</surname> <given-names>P</given-names></string-name>, <string-name><surname>Glymour</surname> <given-names>C</given-names></string-name>, <string-name><surname>Scheines</surname> <given-names>R.</given-names></string-name></person-group> <source>Causation, Prediction, and Search</source>. 2nd ed. <publisher-name>MIT press</publisher-name>; <year>2000</year>.</mixed-citation></ref>
<ref id="c56"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Spirtes</surname> <given-names>P.</given-names></string-name></person-group> <article-title>Directed cyclic graphical representations of feedback models</article-title>. In: <conf-name>Proceedings of the Eleventh Conference on Uncertainty in Artificial Intelligence</conf-name>; <year>1995</year>. p. <fpage>491</fpage>‚Äì<lpage>498</lpage>.</mixed-citation></ref>
<ref id="c57"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Starzyk</surname> <given-names>RM</given-names></string-name>, <string-name><surname>Rosenow</surname> <given-names>C</given-names></string-name>, <string-name><surname>Frye</surname> <given-names>J</given-names></string-name>, <string-name><surname>Leismann</surname> <given-names>M</given-names></string-name>, <string-name><surname>Rodzinski</surname> <given-names>E</given-names></string-name>, <string-name><surname>Putney</surname> <given-names>S</given-names></string-name>, <string-name><surname>Tuomanen</surname> <given-names>EI</given-names></string-name></person-group>. <article-title>Cerebral cell adhesion molecule: a novel leukocyte adhesion determinant on blood-brain barrier capillary endothelium</article-title>. <source>The Journal of Infectious Diseases</source>. <year>2000</year>; <volume>181</volume>(<issue>1</issue>):<fpage>181</fpage>‚Äì<lpage>187</lpage>.</mixed-citation></ref>
<ref id="c58"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strobl</surname> <given-names>EV</given-names></string-name></person-group>. <article-title>Causal discovery with a mixture of DAGs</article-title>. <source>Machine Learning</source>. <year>2023</year>; <volume>112</volume>:<fpage>4201</fpage>‚Äì<lpage>4225</lpage>.</mixed-citation></ref>
<ref id="c59"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strobl</surname> <given-names>EV</given-names></string-name></person-group>. <article-title>Counterfactual Formulation of Patient-Specific Root Causes of Disease</article-title>. <source>Journal of Biomedical Informatics</source>. <year>2024</year>;.</mixed-citation></ref>
<ref id="c60"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Strobl</surname> <given-names>EV</given-names></string-name>, <string-name><surname>Lasko</surname> <given-names>TA</given-names></string-name></person-group>. <article-title>Identifying patient-specific root causes of disease</article-title>. In: <conf-name>Proceedings of the 13th ACM International Conference on Bioinformatics, Computational Biology and Health Informatics</conf-name>; <year>2022</year>. p. <fpage>1</fpage>‚Äì<lpage>10</lpage>.</mixed-citation></ref>
<ref id="c61"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strobl</surname> <given-names>EV</given-names></string-name>, <string-name><surname>Lasko</surname> <given-names>TA</given-names></string-name></person-group>. <article-title>Identifying patient-specific root causes with the heteroscedastic noise model</article-title>. <source>Journal of Computational Science</source>. <year>2023</year>; <volume>72</volume>:<fpage>102099</fpage>.</mixed-citation></ref>
<ref id="c62"><mixed-citation publication-type="confproc"><person-group person-group-type="author"><string-name><surname>Strobl</surname> <given-names>EV</given-names></string-name>, <string-name><surname>Lasko</surname> <given-names>TA</given-names></string-name></person-group>. <article-title>Root Causal Inference from Single Cell RNA Sequencing with the Negative Binomial</article-title>. In: <conf-name>Proceedings of the 14th ACM International Conference on Bioinformatics, Computational Biology and Health Informatics BCB ‚Äò23</conf-name>, <publisher-loc>New York, NY, USA</publisher-loc>: <publisher-name>Association for Computing Machinery</publisher-name>; <year>2023</year>.</mixed-citation></ref>
<ref id="c63"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strobl</surname> <given-names>EV</given-names></string-name>, <string-name><surname>Lasko</surname> <given-names>TA</given-names></string-name></person-group>. <article-title>Sample-specific root causal inference with latent variables</article-title>. <source>PMLR</source>; <year>2023</year>. p. <fpage>895</fpage>‚Äì<lpage>915</lpage>.</mixed-citation></ref>
<ref id="c64"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Strobl</surname> <given-names>EV</given-names></string-name>, <string-name><surname>Lasko</surname> <given-names>TA</given-names></string-name>, <string-name><surname>Gamazon</surname> <given-names>ER</given-names></string-name></person-group>. <article-title>Mitigating pathogenesis for target discovery and disease subtyping</article-title>. <source>Computers in Biology and Medicine</source>. <year>2024</year>; <volume>171</volume>:<fpage>108122</fpage>.</mixed-citation></ref>
<ref id="c65"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Su</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Wang</surname> <given-names>F</given-names></string-name>, <string-name><surname>Hu</surname> <given-names>Q</given-names></string-name>, <string-name><surname>Qu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Han</surname> <given-names>Y.</given-names></string-name></person-group> <article-title>Arsenic trioxide inhibits proliferation of retinal pigment epithelium by down-regulating expression of extracellular matrix and p27</article-title>. <source>International Journal of Clinical and Experimental Pathology</source>. <year>2020</year>; <volume>13</volume>(<issue>2</issue>):<fpage>172</fpage>.</mixed-citation></ref>
<ref id="c66"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Turi</surname> <given-names>Z</given-names></string-name>, <string-name><surname>Senkyrikova</surname> <given-names>M</given-names></string-name>, <string-name><surname>Mistrik</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bartek</surname> <given-names>J</given-names></string-name>, <string-name><surname>Moudry</surname> <given-names>P.</given-names></string-name></person-group> <article-title>Perturbation of RNA Polymerase I transcription machinery by ablation of HEATR1 triggers the RPL5/RPL11-MDM2-p53 ribosome biogenesis stress checkpoint pathway in human cells</article-title>. <source>Cell Cycle</source>. <year>2018</year>; <volume>17</volume>(<issue>1</issue>):<fpage>92</fpage>‚Äì<lpage>101</lpage>.</mixed-citation></ref>
<ref id="c67"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wang</surname> <given-names>L</given-names></string-name>, <string-name><surname>Trasanidis</surname> <given-names>N</given-names></string-name>, <string-name><surname>Wu</surname> <given-names>T</given-names></string-name>, <string-name><surname>Dong</surname> <given-names>G</given-names></string-name>, <string-name><surname>Hu</surname> <given-names>M</given-names></string-name>, <string-name><surname>Bauer</surname> <given-names>DE</given-names></string-name>, <string-name><surname>Pinello</surname> <given-names>L.</given-names></string-name></person-group> <article-title>Dictys: dynamic gene regulatory network dissects developmental continuum with single-cell multiomics</article-title>. <source>Nature Methods</source>. <year>2023</year>; <volume>20</volume>(<issue>9</issue>):<fpage>1368</fpage>‚Äì<lpage>1378</lpage>.</mixed-citation></ref>
<ref id="c68"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Ward Jr</surname> <given-names>JH</given-names></string-name></person-group>. <article-title>Hierarchical grouping to optimize an objective function</article-title>. <source>Journal of the American Statistical Association</source>. <year>1963</year>; p. <fpage>236</fpage>‚Äì<lpage>244</lpage>.</mixed-citation></ref>
<ref id="c69"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Wen</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Huang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Guo</surname> <given-names>S</given-names></string-name>, <string-name><surname>Elyahu</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Monsonego</surname> <given-names>A</given-names></string-name>, <string-name><surname>Zhang</surname> <given-names>H</given-names></string-name>, <string-name><surname>Ding</surname> <given-names>Y</given-names></string-name>, <string-name><surname>Zhu</surname> <given-names>H.</given-names></string-name></person-group> <article-title>Applying causal discovery to single-cell analyses using CausalCell</article-title>. <source>Elife</source>. <year>2023</year>; <volume>12</volume>:<elocation-id>e81464</elocation-id>.</mixed-citation></ref>
<ref id="c70"><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Yoo</surname> <given-names>M</given-names></string-name>, <string-name><surname>Shin</surname> <given-names>J</given-names></string-name>, <string-name><surname>Kim</surname> <given-names>J</given-names></string-name>, <string-name><surname>Ryall</surname> <given-names>KA</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>K</given-names></string-name>, <string-name><surname>Lee</surname> <given-names>S</given-names></string-name>, <string-name><surname>Jeon</surname> <given-names>M</given-names></string-name>, <string-name><surname>Kang</surname> <given-names>J</given-names></string-name>, <string-name><surname>Tan</surname> <given-names>AC</given-names></string-name></person-group>. <article-title>DSigDB: drug signatures database for gene set analysis</article-title>. <source>Bioinformatics</source>. <year>2015</year>; <volume>31</volume>(<issue>18</issue>):<fpage>3069</fpage>‚Äì<lpage>3071</lpage>.</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.100949.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Knowles</surname>
<given-names>David</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Department of Computer Science and Department of Systems Biology</institution>
</institution-wrap>
<city>New York</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Solid</kwd>
</kwd-group>
</front-stub>
<body>
<p>This work provides an <bold>important</bold> framework for understanding the primary causes of disease. While the theoretical results rely on strong assumptions about the underlying causal mechanisms, the authors provide <bold>solid</bold> empirical evidence that the framework is robust to modest violations of these assumptions.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.100949.2.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This manuscript seeks to estimate the causal effect of genes on disease. To do so, they introduce a novel algorithm, termed the Root Causal Strength using Perturbations (RCSP) algorithm. RCSP uses perturb-seq to first estimate the gene regulatory network structure among genes, and then uses bulk RNA-seq with phenotype data on the samples to estimate causal effects of genes on the phenotype conditional on the learned network structure. The authors assess the performance of RCSP in comparison to other methods via simulation. Next, they apply RCSP to two real human datasets: 513 individuals age-related macular degeneration and 137 individuals with multiple sclerosis.</p>
<p>Strengths:</p>
<p>The authors tackle an important and ambitious problem - the identification of causal contributors to disease in the context of a causal inference framework. As the authors point out, observational RNA-seq data is insufficient for this kind of causal discovery, since it is very challenging to recover the true underlying graph from observational data; interventional data are needed. However, little perturb-seq data has been generated with annotated phenotype data, and much bulk RNA-seq data has already been generated, so it is useful to propose an algorithm to integrate the two as the authors have done.</p>
<p>The authors also offer substantial theoretical exposition for their work, bringing to bear both the literature on causal discovery as well as literature on the genetic architecture of complex traits. They also benchmark RCSP under multiple challenging simulation settings, including an analysis of RCSP when the underlying graph is not a DAG.</p>
<p>Weaknesses:</p>
<p>The notion of a &quot;root&quot; causal gene - which the authors define based on a graph theoretic notion of topologically sorting graphs - requires a graph that is directed and acyclic. It is the latter that constitutes an important weakness here - it simply is a large simplification of human biology to draw out a DAG including hundreds of genes and a phenotype Y and to claim that the true graph contains no cycles. For example - consider the authors' analysis of T cell infiltration in multiple sclerosis (MS). CD4+ effector T cells have the interesting property that they are stimulated by IL2 as a growth factor; yet IL2 also stimulates the activation of (suppressive) regulatory T cells. What does it mean to analyze CD4+ regulation in disease with a graph that does not consider IL2 (or other cytokine) mediated feedback loops/cycles? To the authors' credit, in the supplementary materials they do consider a simulated example with a cyclic underling causal graph, finding that RCSP performed well comparison to an implementation of the additive noise model (ANM), LiNGAM, CausalCell, and two simpler approaches based on linear regression.</p>
<p>I also encourage the authors to consider more carefully when graph structure learned from perturb-seq can be ported over to bulk RNA-seq. Consider again the MS CD4+ example - the authors first start with a large perturb-seq experiment (Replogle et al., 2022) performed in K562 cells. To what extent are K562 cells, which are derived from a leukemia cell line, suitable for learning the regulatory structure of CD4+ cells from individuals with an MS diagnosis? Presumably this structure is not exactly correct - to what extent is the RCSP algorithm sensitive to false edges in this graph? The authors perform an analysis of this scenario in Supplementary Figure 4, which shows that RCSP is robust to some degree of departure from the underlying true structure. And although challenging - it would be ideal for the RCSP to model or reflect the challenges in correctly identifying the regulatory structure.</p>
<p>It should also be noted that in most perturb-seq experiments, the entire genome is not perturbed, and frequently important TFs (that presumably are very far &quot;upstream&quot; and thus candidate &quot;root&quot; causal genes) are not expressed highly enough to be detected with scRNA-seq. In that context - perhaps slightly modifying the language regarding RCSP's capabilities might be helpful for the manuscript - perhaps it would be better to describe it has an algorithm for causal discovery among a set of genes that were perturbed and measured, rather than a truly complete search for causal factors. Perhaps more broadly - it would also benefit the manuscript to devote slightly more text to describing the kinds of scenarios where RCSP (and similar ideas) would be most appropriately applied - perhaps a well-powered, phenotype annotated perturb-seq dataset performed in a disease relevant primary cell.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.100949.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This paper presents a very interesting use of a causal graph framework to identify the &quot;root genes&quot; of a disease phenotype. Root genes are the genes that cause a cascade of events that ultimately leads to the disease phenotype, assuming the disease progression is linear.</p>
<p>Strengths:</p>
<p>- The methodology has a solid theoretical background.</p>
<p>
- This is a novel use of the causal graph framework to infer root causes in a graph</p>
<p>Comments on revisions:</p>
<p>The authors addressed all of my comments.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.100949.2.sa0</article-id>
<title-group>
<article-title>Author response:</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Strobl</surname>
<given-names>Eric V</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Gamazon</surname>
<given-names>Eric R</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors‚Äô response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 1:</bold></p>
<p>(1) The notion of a ‚Äúroot‚Äù causal gene - which the authors define based on a graph theoretic notion of topologically sorting graphs - requires a graph that is directed and acyclic. It is the latter that constitutes an important weakness here - it simply is a large simplification of human biology to draw out a DAG including hundreds of genes and a phenotype <italic>Y</italic> and to claim that the true graph contains no cycles.</p>
</disp-quote>
<p>We agree that real causal graphs in biology often contain cycles. We now include additional experimental results with cyclic directed graphs in the Supplementary Materials. RCSP outperformed the other algorithms even in this setting, but we caution the reader that the theoretical interpretation of the RCS score may not coincide with a root causal effect when cycles exist:</p>
<p>‚ÄúWe also evaluated the algorithms on directed graphs with cycles. We generated a linear SEM over <italic>œÅ</italic> + 1 = 1000 variables in <inline-formula id="sa3equ1"><inline-graphic xlink:href="elife-100949-sa3-equ1.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. We sampled the coefficient matrix <italic>Œ≤</italic> from a Bernoulli (1/(<italic><italic>p</italic></italic> ‚àí 1)) distribution but did not restrict the non-zero coefficients to the upper triangular portion of the matrix. We then proceeded to permute the variable ordering and weight each entry as in the Methods for the DAG. We repeated this procedure 30 times and report the results in Supplementary Figure 3.</p>
<p>RCSP again outperformed all other algorithms even in the cyclic case. The results suggest that conditioning on the surrogate ancestors also estimates the RCS well even in the cyclic case. However, we caution that an error term <italic>E<sub>i</sub></italic> can affect the ancestors of <inline-formula id="sa3equ2"><inline-graphic xlink:href="elife-100949-sa3-equ2.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> when cycles exist. As a result, the RCS may not isolate the causal effect of the error term and thus not truly coincide with the notion of a root causal effect in cyclic causal graphs.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(2) I also encourage the authors to consider more carefully when graph structure learned from Perturb-seq can be ported over to bulk RNA-seq. Presumably this structure is not exactly correct - to what extent is the RCSP algorithm sensitive to false edges in this graph? This leap - from cell line to primary human cells - is also not modeled in the simulation. Although challenging - it would be ideal for the RCSP to model or reflect the challenges in correctly identifying the regulatory structure.</p>
</disp-quote>
<p>We now include additional experimental results, where we gradually increased the incongruence between the DAG modeling the Perturb-seq and the DAG modeling the bulk RNA-seq using a mixture of graphs. The performance of RCSP degraded gradually, rather than abruptly, with increasing incongruence. We therefore conclude that RCSP is robust to differences between the causal graphs representing Perturb-seq and bulk RNA-seq:</p>
<p>‚ÄúWe next assessed the performance of RCSP when the DAG underlying the Perturb-seq data differs from the DAG underlying the bulk RNA-seq data. We considered a mixture of two random DAGs in bulk RNA-seq, where one of the DAGs coincided with the Perturb-seq DAG and second alternate DAG did not. We instantiated and simulated samples from each DAG as per the previous subsection. We generated 0%, 25%, 50%, 75%, and 100% of the bulk RNA-seq samples from the alternate DAG, and the rest from the Perturb-seq DAG. We ideally would like to see the performance of RCSP degrade gracefully, as opposed to abruptly, as the percent of samples derived from the alternate DAG increases.</p>
<p>We summarize results in Supplementary Figure 4. As expected, RCSP performed the best when we drew all samples from the same underlying DAG for Perturb-seq and bulk RNA-seq. However, the performance of RCSP also degraded slowly as the percent of samples increased from the alternate DAG. We conclude that RCSP can accommodate some differences between the underlying DAGs in Perturb-seq and bulk RNA-seq with only a mild degradation in performance.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(3) It should also be noted that in most Perturb-seq experiments, the entire genome is not perturbed, and frequently important TFs (that presumably are very far ‚Äúupstream‚Äù and thus candidate ‚Äúroot‚Äù causal genes) are not expressed highly enough to be detected with scRNA-seq. In that context - perhaps slightly modifying the language regarding RCSP‚Äôs capabilities might be helpful for the manuscript - perhaps it would be better to describe it as an algorithm for causal discovery among a set of genes that were perturbed and measured, rather than a truly complete search for causal factors. Perhaps more broadly it would also benefit the manuscript to devote slightly more text to describing the kinds of scenarios where RCSP (and similar ideas) would be most appropriately applied - perhaps a well-powered, phenotype annotated Perturb-seq dataset performed in a disease relevant primary cell.</p>
</disp-quote>
<p>We now clarify that Perturb-seq can only identify root causal genes among the perturbed set of genes in the Discussion:</p>
<p>‚ÄúModern genome-wide Perturb-seq datasets also adequately perturb and measure only a few thousand, rather than all, gene expression levels. RCSP can only identify root causal genes within this perturbed and measured subset.‚Äù</p>
<p>We now also describe the scenario where RCSP can identify root causal genes well in the Introduction:</p>
<p>‚ÄúExperiments demonstrate marked improvements in performance, when investigators have access to a large bulk RNA-seq dataset and a genome-wide Perturb-seq dataset from a cell line of a disease-relevant tissue.‚Äù</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 2:</bold></p>
<p>(1) The process from health-to-disease is not linear most of the time with many checks along the way that aim to prevent the disease phenotype. This leads to a non-deterministic nature of the path from health-to-disease. In other words, with the same root gene perturbations, and depending on other factors outside of gene expression, someone may develop a phenotype in a year, another in 10 years and someone else never. Claiming that this information is included in the error terms might not be sufficient to address this issue. The authors should discuss this limitation.</p>
</disp-quote>
<p>The proposed approach accommodates the above non-deterministic nature. The error terms of <inline-formula id="sa3equ3"><inline-graphic xlink:href="elife-100949-sa3-equ3.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> model factors that are outside of gene expression. We model the relation from gene expression to <italic>Y</italic> as probabilistic rather than deterministic because <inline-formula id="sa3equ4"><inline-graphic xlink:href="elife-100949-sa3-equ4.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, where <italic>E<sub>Y</sub></italic> introduces stochasticity. Thus, two individuals with the same instantiations of the root causes may develop disease differently. We now clarify this in Methods:</p>
<p>‚ÄúThe error terms model root causes that are outside of gene expression, such as genetic variation or environmental factors. Moreover, the relation from gene expression to <italic>Y</italic> is stochastic because <inline-formula id="sa3equ5"><inline-graphic xlink:href="elife-100949-sa3-equ5.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, where <italic>E<sub>Y</sub></italic> introduces the stochasticity. Two individuals may therefore have the exact same error term values over <inline-formula id="sa3equ6"><inline-graphic xlink:href="elife-100949-sa3-equ6.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> but different instantiations of Y.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(2) The paper assumes that the network connectivity will remain the same after perturbation. This is not always true due to backup mechanisms in the cells. For example, suppose that a cell wants to create product <italic>P</italic> and it can do it through two alternative paths: Path #1: <italic>A</italic> ‚Üí <italic>B</italic> ‚Üí <italic>P</italic>, Path #2: <italic>A</italic> ‚Üí <italic>C</italic> ‚Üí <italic>P</italic>. Now suppose that path #1 is more efficient, so when <italic>B</italic> can be produced, path #2 is inactive. Once the perturbation blocks element <italic>B</italic> from being produced, the graph connectivity changes by activation of path #2. I did not see the authors taking this into consideration, which seems to be a major limitation in using Perturb-seq results to infer conductivities.</p>
</disp-quote>
<p>We agree that backup mechanisms can exist and therefore now include additional experimental results, where we gradually increased the incongruence between the DAG modeling the Perturb-seq and the DAG modeling the bulk RNA-seq using a mixture of graphs. The performance of RCSP degraded gradually, rather than abruptly, with increasing incongruence. We therefore conclude that RCSP is robust to differences between the causal graphs representing Perturb-seq and bulk RNA-seq:</p>
<p>‚ÄúWe next assessed the performance of RCSP when the DAG underlying the Perturb-seq data differs from the DAG underlying the bulk RNA-seq data. We considered a mixture of two random DAGs in bulk RNA-seq, where one of the DAGs coincided with the Perturb-seq DAG and second alternate DAG did not. We generated 0%, 25%, 50%, 75%, and 100% of the bulk RNA-seq samples from the alternate DAG, and the rest from the Perturb-seq DAG. We ideally would like to see the performance of RCSP degrade gracefully, as opposed to abruptly, as the percent of samples derived from the alternate DAG increases.</p>
<p>We summarize results in Supplementary Figure 4. As expected, RCSP performed the best when we drew all samples from the same underlying DAG for Perturb-seq and bulk RNA-seq. However, the performance of RCSP also degraded slowly as the percent of samples increased from the alternate DAG. We conclude that RCSP can accommodate some differences between the underlying DAGs in Perturb-seq and bulk RNA-seq with only a mild degradation in performance.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(3) There is substantial system heterogeneity that may cause the same phenotype. This goes beyond the authors claim that although the initial gene causes of a disease may differ from person to person, at some point they will all converge to changes in the same set of ‚Äúroot genes.‚Äù This is not true for many diseases, which are defined based on symptoms and lab tests at the patient level. You may have two completely different molecular pathologies that lead to the development of the same symptoms and test results. Breast cancer with its subtypes is a prime example of that. In theory, this issue could be addressed if there is infinite sample size. However, this assumption is largely violated in all existing biological datasets.</p>
</disp-quote>
<p>The proposed method accommodates the above heterogeneity. We do not assume that the root causes affect the same set of root causal genes. Instead the root causes <italic>and</italic> root causal genes may vary from person to person. We write in the Introduction:</p>
<p>‚ÄúThe problem is further complicated by the existence of complex disease, where a patient may have multiple root causal genes that differ from other patients even within the same diagnostic category... We thus also seek to identify <italic>patient-specific</italic> root causal genes in order to classify patients into meaningful biological subgroups each hopefully dictated by only a small group of genes.‚Äù</p>
<p>The root causal genes may further affect different downstream genes at the patient-specific level. However root causal genes tend to have many downstream effects so that virtually every gene expression level becomes correlated with <italic>Y</italic>. We now clarify this by describing the omnigenic root causal model in the Introduction as follows:</p>
<p>‚ÄúFinally, application of the algorithm to two complex diseases with disparate pathogeneses recovers an <italic>omnigenic root causal model</italic>, where a small set of root causal genes drive pathogenesis but impact many downstream genes within each patient. As a result, nearly all gene expression levels are correlated with the diagnosis at the population level.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(4) Were the values of the synthetic variables Z-scored?</p>
</disp-quote>
<p>Yes, all variables were z-scored. We now clarify this in Methods:</p>
<p>‚ÄúWe also standardized all variables before running the regressions to prevent gaming of the marginal variances in causal discovery (Reisach et al., 2021; Ng et al., 2024).‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(5) The algorithm seems to require both RNA-seq and Perturb-seq data (Algorithm 1, page 14). Can it function with RNA-seq data only? What will be different in this case?</p>
</disp-quote>
<p>The algorithm cannot function with observational bulk RNA-seq data only. We included Perturb-seq because causal discovery with observational RNA-seq data alone tends to be inaccurate and unstable, as highlighted by the results of CausalCell. We further emphasize that we do not rely on d-separation faithfulness in Methods, which is typically required for causal discovery from observational data alone:</p>
<p>‚ÄúWe can also claim the backward direction under d-separation faithfulness. We however avoid making this additional assumption because real biological data may not arise from distributions obeying d-separation faithfulness in practice.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(6) Synthetic data generation: how many different graphs (SEMs) did they start from? (30?) How many samples per graph? Did they test different sample sizes?</p>
</disp-quote>
<p>We now clarify that we generate 30 random SEMs, each associated with a DAG. We used 200 samples for the bulk RNA-seq to mimic a relatively large but common sample size. We also drew 200 samples for each perturbation or control in the Perturb-seq data. We did not consider multiple sample sizes due to the time required to complete each run. Instead, we focused on a typical scenario where investigators would apply RCSP. We now write the following in the Methods:</p>
<p>‚ÄúWe drew 200 samples for the bulk RNA-seq data to mimic a large but common dataset size. We introduced knockdown perturbations in Perturb-seq by subtracting an offset of two in the softplus function: <inline-formula id="sa3equ7"><inline-graphic xlink:href="elife-100949-sa3-equ7.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. We finally drew 200 samples for the control and each perturbation condition to generate the Perturb-seq data. We repeated the above procedure 30 times.‚Äù We also include the following in Results:</p>
<p>‚ÄúWe obtained 200 cell samples from each perturbation, and another 200 controls without perturbations. We therefore generated a total of 2501 √ó 200 = 500,200 single cell samples for each Perturb-seq dataset. We simulated 200 bulk RNA-seq samples.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(7) The presentation of comparative results (Supplementary Figures 4 and 7) is not clear. No details are given on how these results were generated. (what does it mean ‚ÄúThe first column denotes the standard deviation of the outputs for each algorithm?‚Äù) Why all other methods have higher SD differences than RCSP? Is it a matter of scaling? Shouldn‚Äôt they have at least some values near zero since the authors ‚Äúadded the minimum value so that all histograms begin at zero?‚Äù</p>
</disp-quote>
<p>Each of these supplementary figures contains a 6 by 3 table of figures. By the first column, we mean column one (with rows 1 through 6) of each figure. The D-RCS and D-SD scores represent standard deviations of the RCS and SD scores from zero of each gene, respectively. We can similarly compute the standard deviation of the outputs of the algorithms. We now clarify this in the Supplementary Materials:</p>
<p>‚ÄúThe figure contains 6 rows and 3 columns. Similar to the D-RCS, we can compute the standard deviation of the output of each algorithm from zero for each gene. The first column in Supplementary Figure 7 denotes the histograms of these standard deviations across the genes.‚Äù</p>
<p>Many histograms do not appear to start at zero because the bars are too small to be visible. We now clarify this in the Supplementary Materials as well:</p>
<p>‚ÄúNote that the bars at zero are not visible for many algorithms, since only a few genes attained standard deviations near the minimum.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(8) Why RCSP results are more like a negative binomial distribution and every other is kind of normal?</p>
</disp-quote>
<p>All other methods have higher standard deviations than RCSP because they fail to compute an accurate measure of the root causal effect. Recall that, just like a machine has a few root causal problems, only a few root casual genes have large root causal effects under the omnigenic root causal model. The results of RCSP look more like a negative binomial distribution because most RCS scores are concentrated around zero and only a few RCS scores are large ‚Äì consistent with the omnigenic root causal model. The other algorithms fail to properly control for the upstream genes and thus attain large standard deviations for nearly all genes. We now clarify these points in the Supplementary Materials as follows:</p>
<p>‚ÄúIf an algorithm accurately identifies root causal genes, then it should only identify a few genes with large conditional root causal effects under the omnigenic root causal model. The RCSP algorithm had a histogram with large probability mass centered around zero with a long tail to the right. The standard deviations of the outputs of the other algorithms attained large values for nearly all genes. Incorporating feature selection and causal discovery with CausalCell introduced more outliers in the histogram of ANM. We conclude that only RCSP detected an omnigenic root causal model.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(9) What is the significance of genes changing expression ‚Äúfrom left to right‚Äù in a UMAP plot? (e.g., Fig. 3h and 3g)</p>
</disp-quote>
<p>The first UMAP dimension captured the variability of the RCS scores for most root causal genes. As a result, we could focus our analysis on the black cluster in Figure 3 (g) with large RCS scores in the subsequent pathway enrichment analysis summarized in Figure 3 (j). If two dimensions were involved, then we would need to analyze at least two clusters (e.g., black and pink), but this was not the case. We now clarify this in Results:</p>
<p>‚ÄúThe RCS scores of most of the top genes exhibited a clear gradation increasing only from the left to the right hand side of the UMAP embedding; we plot an example in Figure 3 (h). We found three exceptions to this rule among the top 30 genes (example in Figure 3 (i) and see Supplementary Materials). RCSP thus detected genes with large RCS scores primarily in the black cluster of Figure 3 (g). Pathway enrichment analysis within this cluster alone yielded supra-significant results on the same pathway detected in the global analysis...‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(10) The authors somewhat overstate the novelty of their algorithm. Representation of GRNs as causal graphs dates back in 2000 with the work of Nir Friedman in yeast. Other methods were developed more recently that look on regulatory network changes at the single sample level which the authors do not seem to be aware (e.g., Ellington et al, NeurIPS 2023 workshop GenBio and Bushur et al, 2019, Bioinformatics are two such examples). The methods they mention are for single cell data and they are not designed to connect single sample-level changes to a person‚Äôs phenotype. The RCS method needs to be put in the right background context in order to bring up what is really novel about it.</p>
</disp-quote>
<p>We agree that many methods already exist for uncovering associational, predictive (Markov, neighborhood) and causal gene regulatory networks. We now cite the above papers. However, the novelty in our manuscript is not causal graph discovery, but rather estimation of root causal effects, detection of root causal genes, and the proposal of the omnigenic root causal model. We now clarify this in the</p>
<p>Introduction:</p>
<p>‚ÄúMany algorithms focus on discovering associational or predictive relations, sometimes visually represented as gene regulatory networks (Costa et al., 2017; Ellington et al., 2023). Other methods even identify causal relations (Friedman et al., 2000; Wang et al., 2023; Wen et al., 2000; Buschur et al., 2000), but none pinpoint the <italic>first</italic> gene expression levels that ultimately generate the vast majority of pathogenesis. Simply learning a causal graph does not resolve the issue because causal graphs do not summarize the effects of <italic>unobserved</italic> root causes, such as unmeasured environmental changes or variants, that are needed to identify all root causal genes. We therefore define the Root Causal Strength (RCS) score...‚Äù</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer 3:</bold></p>
<p>(1) Several assumptions of the method are problematic. The most concerning is that the observational expression changes are all causally upstream of disease. There is work using Mendelian randomization (MR) showing that the <italic>opposite</italic> is more likely to be true: most differential expression in disease cohorts is a consequence rather than a cause of disease (Porcu et al., 2021). Indeed, the oxidative stress of AMD has known cellular responses including the upregulation of p53. The authors need to think carefully about how this impacts their framework. Can the theory say anything in this light? Simulations could also be designed to address robustness.</p>
</disp-quote>
<p>Strictly speaking, we believe that differential expression in disease most likely has a cyclic causal structure: gene expression causes a diagnosis or symptom severity, and a diagnosis or symptom severity lead to treatments and other behavioral changes that perturb gene expression. For example, revTMWR in Porcu et al. (2021) uses trans-variants that are less likely to <italic>directly</italic> cause gene expression and instead directly cause a phenotype. However, TWMR as proposed in Porcu et al. (2019) instead uses cis-eQTLs and finds many putative causal relations from gene expression to phenotype. Thus, both causal directions likely hold.</p>
<p>RCSP uses disease-relevant tissue believed to harbor gene expression levels that cause disease. However, RCSP theoretically cannot handle the scenario where <italic>Y</italic> is a non-sink vertex <italic>and</italic> is a parent of a gene expression level because modern Perturb-seq datasets usually do not perturb or measure <italic>Y</italic>. We therefore empirically investigated the degree of error by running experiments, where we set <italic>Y</italic> to a non-sink vertex, so that it can cause gene expression. We find that the performance of RCSP degrades considerably for gene expression levels that contain <italic>Y</italic> as a parent. Thus RCSP is sensitive to violations of the sink target assumption:</p>
<p>‚ÄúWe finally considered the scenario where <italic>Y</italic> is a non-sink (or non-terminal) vertex. If <italic>Y</italic> is a parent of a gene expression level, then we cannot properly condition on the parents because modern Perturbseq datasets usually do not intervene on <italic>Y</italic> or measure <italic>Y</italic> . We therefore empirically investigated the degradation in performance resulting from a non-sink target <italic>Y</italic>, in particular for gene expression levels where <italic>Y</italic> is a parent. We again simulated 200 samples from bulk RNA-seq and each condition of Perturbseq with a DAG over 1000 vertices, an expected neighborhood size of 2 and a non-sink target <italic>Y</italic> . We then removed the outgoing edges from <italic>Y</italic> and resampled the DAG with a sink target. We compare the results of RCSP for both DAGs in gene expression levels where <italic>Y</italic> is a parent. We plot the results in Supplementary Figure 5. As expected, we observe a degradation in performance when <italic>Y</italic> is not terminal, where the mean RMSE increased from 0.045 to 0.342. We conclude that RCSP is sensitive to violations of the sink target assumption.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(2) A closely related issue is the DAG assumption of no cycles. This assumption is brought to bear because it is required for much classical causal machinery, but is unrealistic in biology where feedback is pervasive. How robust is RCSP to (mild) violations of this assumption? Simulations would be a straightforward way to address this.</p>
</disp-quote>
<p>We agree that real causal graphs in biology often contain cycles. We now include additional experimental results with cyclic directed graphs in the Supplementary Materials. RCSP outperformed the other algorithms even in this setting, but we caution the reader that the theoretical interpretation of the RCS score may not coincide with a root causal effect when cycles exist:</p>
<p>‚ÄúWe also evaluated the algorithms on directed graphs with cycles. We generated a linear SEM over <italic>p</italic> + 1 = 1000 variables in <inline-formula id="sa3equ8"><inline-graphic xlink:href="elife-100949-sa3-equ8.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>. We sampled the coefficient matrix <italic>Œ≤</italic> from a Bernoulli (1/(<italic>p</italic> ‚àí 1)) distribution but did not restrict the non-zero coefficients to the upper triangular portion of the matrix. We then proceeded to permute the variable ordering and weight each entry as in the Methods for the DAG. We repeated this procedure 30 times and report the results in Supplementary Figure 3.</p>
<p>RCSP again outperformed all other algorithms even in the cyclic case. The results suggest that conditioning on the surrogate ancestors also estimates the RCS well even in the cyclic case. However, we caution that an error term <italic>E<sub>i</sub></italic> can affect the ancestors of <inline-formula id="sa3equ9"><inline-graphic xlink:href="elife-100949-sa3-equ9.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, when cycles exist. As a result, the RCS may not isolate the causal effect of the error term and thus not truly coincide with the notion of a root causal effect in cyclic causal graphs.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(3) The authors spend considerable effort arguing that technical sampling noise in <italic>X</italic> can effectively be ignored (at least in bulk). While the mathematical arguments here are reasonable, they miss the bigger picture point that the measured gene expression <italic>X</italic> can only ever be a noisy/biased proxy for the expression changes that caused disease: 1) Those events happened before the disease manifested, possibly early in development for some conditions like neurodevelopmental disorders. 2) bulk RNA-seq gives only an average across cell-types, whereas specific cell-types are likely ‚Äúcausal.‚Äù 3) only a small sample, at a single time point, is typically available. Expression in other parts of the tissue and at different times will be variable.</p>
</disp-quote>
<p>We agree that many other sources of error exist. The causal model of RNA-expression in Methods corresponds to a single snapshot in time for each sample. We now clarify this in the Methods as follows:</p>
<p>‚ÄúWe represent a snapshot of a biological causal process using an SEM over <inline-formula id="sa3equ10"><inline-graphic xlink:href="elife-100949-sa3-equ10.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula> obeying Equation (3).‚Äù</p>
<p>We thus only detect the root causal genes in a single snapshot in time for each sample in bulk RNA-seq. If we cannot detect the root causal effect in a gene due to the signal washing out over time as in (1), or if the root causal effect in different cell types cancel each other out to exactly zero in bulk as in (2), then we cannot detect those root causal genes even with an infinite sample size.</p>
<disp-quote content-type="editor-comment">
<p>(4) While there are connections to the omnigenic model, the latter is somewhat misrepresented. The authors refer to the ‚Äúcore genes‚Äù of the omnigenic model as being at the end (longitudinal) of pathogenesis. The omnigenic model makes no statements about temporal ordering: in causal inference terminology the core genes are simply the direct causes of disease.</p>
</disp-quote>
<p>We now clarify that we use the word <italic>pathogenesis</italic> to mean the causal cascade from root causes to the diagnosis. In this case, the direct causes of the diagnosis correspond to the end of pathogenesis, while the root causes correspond to the beginning. For example, if <inline-formula id="sa3equ11"><inline-graphic xlink:href="elife-100949-sa3-equ11.jpg" mimetype="image" mime-subtype="jpeg"/></inline-formula>, with <italic>Y</italic> a diagnosis, then <italic>X</italic><sub>1</sub> is a root causal gene while <italic>X</italic><sub>2</sub> is a core (direct causal) gene. We now clarify this in the Introduction:</p>
<p>‚Äú<italic>Root causes of disease</italic> correspond to the most upstream causes of a diagnosis with strong causal effects on the diagnosis. <italic>Pathogenesis</italic> refers to the causal cascade from root causes to the diagnosis. Genetic and non-genetic factors may act as root causes and affect gene expression as an intermediate step during pathogenesis. We introduce root causal gene expression levels ‚Äì or <italic>root causal genes</italic> for short ‚Äì that correspond to the initial changes to <italic>gene expression</italic> induced by genetic and non-genetic root causes that have large causal effects on a downstream diagnosis (Figure 1 (a)). Root causal genes differ from core genes that directly cause the diagnosis and thus lie at the end, rather than at the beginning, of pathogenesis (Boyle et al., 2017).‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(5) A key observation underlying the omnigenic model is that genetic heritability is spread throughout the genome (and somewhat concentrated near genes expressed in disease relevant cell types). This implies that (almost) all expressed genes, or their associated (e)SNPs, are ‚Äúroot causes‚Äù.</p>
</disp-quote>
<p>We now clarify that genetic heritability can be spread throughout the genome in the omnigenic root causal model as well in the Discussion:</p>
<p>‚ÄúFurther, each causal genetic variant tends to have only a small effect on disease risk in complex disease because the variant can directly cause <italic>Y</italic> or directly cause any causal gene including those with small root causal effects on <italic>Y</italic> ; thus, all error terms that cause <italic>Y</italic> can model genetic effects on <italic>Y</italic>. However, the root causal model further elaborates that genetic <italic>and non-genetic factors</italic> often combine to produce a few root causal genes with large root causal effects, where non-genetic factors typically account for the majority of the large effects in complex disease. Many variants may therefore cause many genes in diseases with only a few root causal genes.‚Äù</p>
<p>We finally add Figure 5 into the Discussion as a concrete example illustrating the omnigenic root causal model:</p>
<disp-quote content-type="editor-comment">
<p>(6) The claim that root causal genes would be good therapeutic targets feels unfounded. If these are highly variable across individuals then the choice of treatment becomes challenging. By contrast the causal effects may converge on core genes before impacting disease, so that intervening on the core genes might be preferable. The jury is still out on these questions, so the claim should at least be made hypothetical.</p>
</disp-quote>
<p>We clarify that we do not claim that root causal genes are better treatment targets than core genes in terms of magnitudes of causal effects on the phenotype. For example, in the common cold with a virus as the root cause, giving a patient an antiviral will eliminate fever and congestion, but so will giving a decongestant and an antipyretic. We only claim that treating root causal genes can eliminate disease near its pathogenic onset, just like giving an antiviral can eliminate the viral load and stop pathogenesis. We write the following the Introduction:</p>
<p>‚ÄúTreating root causal genes can modify disease pathogenesis in its entirety, whereas targeting other causes may only provide symptomatic relief... Identifying root causal genes is therefore critical for developing treatments that eliminate disease near its pathogenic onset.‚Äù</p>
<p>We also further clarify in the Discussion that root causal genes account for deleterious causal effects not captured by the diagnosis <italic>Y</italic>:</p>
<p>‚ÄúWe finally emphasize that the root causal model accounts for all deleterious effects of the root causal genes, whereas the core gene model only captures the deleterious effects captured by the diagnosis <italic>Y</italic>. For example, the <italic>disease</italic> of diabetes causes retinopathy, but retinopathy is not a part of the diagnostic criteria of diabetes. As a result, the gene expression levels that cause retinopathy but not the <italic>diagnosis</italic> of diabetes are not core genes, even though they are affected by the root causal genes.‚Äù</p>
<p>We do agree that root causal genes may differ substantially between patients, although it is unclear if the heterogeneity is too great to develop treatments.</p>
<disp-quote content-type="editor-comment">
<p>(7) The closest thing to a gold standard I believe we have for ‚Äúroot causal genes‚Äù is integration of molecular QTLs and GWAS, specifically coloc/MR. Here the ‚ÄúE‚Äù of RCSP are explicitly represented as SNPs. I don‚Äôt know if there is good data for AMD but there certainly is for MS. The authors should assess the overlap with their results. Another orthogonal avenue would be to check whether the root causal genes change early in disease progression.</p>
</disp-quote>
<p>Colocalization and Mendelian randomization unfortunately cannot identify root causal effects because they all attempt, either heuristically (colocalization) or rigorously (MR), to identify variants that cause each gene expression level rather than variants that <italic>directly</italic> cause each gene expression level and thus make up the error terms. We therefore need new methods that can identify direct causal variants in order to assess overlap.</p>
<p>We checked whether root causal genes change early in disease progression using knowledge of pathogenesis. In particular, oxidative stress induces pathogenesis in AMD, and RCSP identified root causal genes involved in oxidative stress in AMD:</p>
<p>‚ÄúThe pathogenesis of AMD involves the loss of RPE cells. The RPE absorbs light in the back of the retina, but the combination of light and oxygen induces oxidative stress, and then a cascade of events such as immune cell activation, cellular senescence, drusen accumulation, neovascularization and ultimately fibrosis (Barouch et al., 2007). We therefore expect the root causal genes of AMD to include genes involved in oxidative stress during early pathogenesis. The gene MIPEP with the highest D-RCS score in Figure 3 (d) indeed promotes the maturation of oxidative phosphorylation-related proteins (Shi et al., 2011). The second gene SLC7A5 is a solute carrier that activates mTORC1 whose hyperactivation increases oxidative stress via lipid peroxidation (Nachef et al., 2021; Go et al., 2020). The gene HEATR1 is involved in ribosome biogenesis that is downregulated by oxidative stress (Turi et al., 2018). The top genes discovered by RCSP thus identify pathways known to be involved in oxidative stress.‚Äù</p>
<p>Similarly, T cell infiltration across the blood brain barrier initiates pathogenesis in MS, and RCSP identified root causal genes involved in this infiltration:</p>
<p>‚ÄúGenes with the highest D-RCS scores included MNT, CERCAM and HERPUD2 (Figure 4 (d)). MNT is a MYC antagonist that modulates the proliferative and pro-survival signals of T cells after engagement of the T cell receptor (Gnanaprakasam et al., 2017). Similarly, CERCAM is an adhesion molecule expressed at high levels in microvessels of the brain that increases leukocyte transmigration across the blood brain barrier (Starzyk et al., 2000). HERPUD2 is involved in the endoplasmic-reticulum associated degradation of unfolded proteins (Kokame et al., 2000). Genes with the highest D-RCS scores thus serve key roles in known pathogenic pathways of MS.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(8) The available Perturb-seq datasets have limitations beyond on the control of the authors. 1) The set of genes that are perturbed. The authors address this by simply sub-setting their analysis to the intersection of genes represented in the perturbation and observational data. However, this may mean that a true ancestor of X is not modeled/perturbed, limiting the formal claims that can be made. Additionally, some proportion of genes that are nominally perturbed show little to no actual perturbation effect (for example, due to poor guide RNA choice) which will also lead to missing ancestors.</p>
</disp-quote>
<p>We now clarify that Perturb-seq can only identify root causal genes among the adequately perturbed set of genes in the Discussion:</p>
<p>‚ÄúModern genome-wide Perturb-seq datasets also only adequately perturb and measure a few thousand, rather than all, gene expression levels. RCSP can only identify root causal genes within this perturbed and measured subset.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(9) The authors provide no mechanism for statistical inference/significance for their results at either the individual or aggregated level. While I am a proponent of using effect sizes more than p-values, there is still value in understanding how much signal is present relative to a reasonable null.</p>
</disp-quote>
<p>We now explain that RCSP does not perform statistical inference in Methods because it is not clear how to define the appropriate cut-off for the RCS score under the null distribution:</p>
<p>‚ÄúWe focus on statistical estimation rather than statistical inference because Œ¶<italic><sub>i</sub></italic> <italic>&gt;</italic> 0 when <italic>E<sub>i</sub></italic> causes <italic>Y</italic> under mild conditions, so we reject the null hypothesis that Œ¶<italic><sub>i</sub></italic> = 0 for many genes if many gene expression levels cause <italic>Y</italic>. However, just like a machine typically breaks down due to only one or a few root causal problems, we hypothesize that only a few genes have large RCS scores Œ¶<italic><sub>i</sub></italic> ‚â´ 0 even in complex disease.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(10) I agree with the authors that age coming out of a ‚Äúroot cause‚Äù is potentially encouraging. However, it is also quite different in nature to expression, including being ‚Äúmeasured‚Äù exactly. Will RCSP be biased towards variables that have lower measurement error?</p>
</disp-quote>
<p>We tested the above hypothesis by plotting sequencing depth against the D-RCS scores of each gene. We observed a small negative correlation between sequencing depth and D-RCS scores, indicating the D-RCS scores are slightly biased upwards with low sequencing depth. However, genes with the largest D-RCS scores exhibited a wide variety of sequencing depths in both MS and AMD, suggesting that sequencing depth has minimal effect on the largest D-RCS scores. We now explain these results for AMD in the Supplementary Materials:</p>
<p>‚ÄúTheorem 1 states that RCS scores may exhibit bias with insufficient sequencing depth. The genes with large D-RCS scores may therefore simply have low sequencing depths. To test this hypothesis, we plotted sequencing depth against D-RCS scores. Consistent with Theorem 1, we observed a small negative correlation between D-RCS and sequencing depth (<italic>œÅ</italic> = ‚àí0.16, p=2.04E-13), and D-RCS scores exhibited greater variability at the lowest sequencing depths (Supplementary Figure 8). However, genes with the largest D-RCS scores had mean sequencing depths interspersed between 20 and 3000. We conclude that genes with the largest D-RCS scores had a variety of sequencing depths ranging from low to high.‚Äù</p>
<p>We also report the results for MS:</p>
<p>‚ÄúWe plot sequencing depth against the D-RCS scores of each gene similar to the AMD dataset. We again observed a small negative correlation (<italic>œÅ</italic> = ‚àí0.136, p_&lt;_2.2E-16), indicating that genes with low sequencing depths had slightly higher D-RCS scores on average (Supplementary Figure 12). However, genes with the largest D-RCS scores again had a variety of sequencing depths. We conclude that sequencing depth has minimal correlation with the largest D-RCS scores.‚Äù</p>
<disp-quote content-type="editor-comment">
<p>(11) Finally, it‚Äôs a stretch to call K562 cells ‚Äúlymphoblasts.‚Äù They are more myeloid than lymphoid.</p>
</disp-quote>
<p>We now clarify that K562 cells are undifferentiated blast cells that can be induced to differentiate into lymphoblasts in Results:</p>
<p>‚ÄúWe next ran RCSP on 137 samples collected from CD4+ T cells of multiple sclerosis (MS; GSE137143) as well as Perturb-seq data of 1,989,578 undifferentiated blast cells that can be induced to differentiate into lymphoblasts, or the precursors of T cells and other lymphocytes.‚Äù</p>
</body>
</sub-article>
</article>