<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">105065</article-id>
<article-id pub-id-type="doi">10.7554/eLife.105065</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.105065.1</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories><subj-group subj-group-type="heading">
<subject>Evolutionary Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>The general version of Hamilton’s rule</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" corresp="yes">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-8290-9212</contrib-id>
<name>
<surname>van Veelen</surname>
<given-names>Matthijs</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<email>c.m.vanveelen@uva.nl</email>
</contrib>
<aff id="a1"><label>1</label><institution-wrap><institution-id institution-id-type="ror">https://ror.org/04dkp9463</institution-id><institution>Department of Economics, Universiteit van Amsterdam</institution></institution-wrap>, <city>Amsterdam</city>, <country country="NL">Netherlands</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Rainey</surname>
<given-names>Paul B</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Evolutionary Biology</institution>
</institution-wrap>
<city>Plön</city>
<country>Germany</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Perry</surname>
<given-names>George H</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Pennsylvania State University</institution>
</institution-wrap>
<city>University Park</city>
<country>United States of America</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<fn fn-type="coi-statement"><p>Competing interests: No competing interests declared</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2025-03-24">
<day>24</day>
<month>03</month>
<year>2025</year>
</pub-date>
<volume>14</volume>
<elocation-id>RP105065</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2024-11-18">
<day>18</day>
<month>11</month>
<year>2024</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2024-11-27">
<day>27</day>
<month>11</month>
<year>2024</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2024.11.25.625193"/>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2025, van Veelen</copyright-statement>
<copyright-year>2025</copyright-year>
<copyright-holder>van Veelen</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-105065-v1.pdf"/>
<abstract>
<title>Abstract</title>
<p>The generality of Hamilton’s rule<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref></sup> is much debated<sup><xref ref-type="bibr" rid="c3">3</xref>–<xref ref-type="bibr" rid="c14">14</xref></sup>. In this paper, I show that this debate can be resolved by constructing a general version of Hamilton’s rule, which allows for a large variety of ways in which the fitness of an individual can depend on the social behaviour of oneself and of others. For this, I first derive the Generalized Price equation, which reconnects the Price equation<sup><xref ref-type="bibr" rid="c15">15</xref></sup> with the statistics it borrows its terminology from. The Generalized Price equation moreover shows that there is not just one Price equation, but there is a Price-like equation for every possible true model. This implies that there are also multiple, nested rules to describe selection. The simplest rule is the rule for selection of non-social traits with linear fitness effects. This rule is nested in the classical version of Hamilton’s rule, for which there is consensus that it works for social traits with linear, independent fitness effects. The classical version of Hamilton’s rule, in turn, is nested in more general rules, that for instance allow for nonlinear and/or interdependent fitness effects. The general version of Hamilton’s rule therefore is a constructive solution, that allows us to accurately describe when costly cooperation evolves in a wide variety of circumstances.</p>
</abstract>
<custom-meta-group>
<custom-meta specific-use="meta-only">
<meta-name>publishing-route</meta-name>
<meta-value>prc</meta-value>
</custom-meta>
</custom-meta-group>
</article-meta>
<notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>The appendices that the manuscript refers to have been added.</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Hamilton’s rule<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref></sup> is one of the more famous rules in evolutionary biology. The rule states that altruism will evolve if rb &gt; C, where b is the fitness benefit to the recipient, C is the fitness cost to the donor, and r is the genetic relatedness between them. The generality of Hamilton’s rule however has always been a topic of contention<sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c4">4</xref></sup>, and positions range all the way from “Hamilton’s rule almost never holds”<sup><xref ref-type="bibr" rid="c6">6</xref></sup> to “Inclusive fitness is as general as the genetical theory of natural selection itself”<sup><xref ref-type="bibr" rid="c7">7</xref></sup>.</p>
<p>The claim of generality is not based on the original derivation of Hamilton’s rule<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c16">16</xref></sup>, but on later derivations<sup><xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c17">17</xref>–<xref ref-type="bibr" rid="c22">22</xref></sup> that use the Price equation<sup><xref ref-type="bibr" rid="c15">15</xref></sup>. This tradition also started with Hamilton himself<sup><xref ref-type="bibr" rid="c17">17</xref>,<xref ref-type="bibr" rid="c18">18</xref></sup>. The usefulness of the Price equation as a tool for doing theory, however, is not undisputed <sup><xref ref-type="bibr" rid="c9">9</xref>,<xref ref-type="bibr" rid="c12">12</xref>,<xref ref-type="bibr" rid="c23">23</xref>–<xref ref-type="bibr" rid="c26">26</xref></sup>. One of the remarkable characteristics of the Price equation literature is that it borrows terms from statistics, like regression coefficients, without also inheriting the natural preoccupations of statistics, such as worrying about model choice or statistical significance.</p>
<p>In this paper, I will show that this debate can be resolved by deriving general versions of the Price equation and of Hamilton’s rule. The Generalized Price equation generates a set of Price-like equations; one for every different choice for a statistical model, that may describe how the fitness of an individual depends on its genetic makeup. This makes the original Price equation in regression form a special case; it is the Generalized Price equation in regression form, combined with a linear model. The Generalized Price equation repairs the broken link between the Price equation and statistics; standard statistical considerations concerning model choice now translate one-to-one to considerations concerning which of these Price-like equation describes the population genetic dynamics.</p>
<p>With the Generalized Price equation, I then derive the general version of Hamilton’s rule. Both the limitations of the original Price equation, and ways to overcome these limitations by using the generalized version, are mirrored in the limitations of Hamilton’s rule as we know it, and ways to overcome those. Just like there is not just one Price equation, but a multitude of Price-like equations, there is not just one Hamilton’s rule, but a multitude of Hamilton-like rules. All of them are correct, and all of them are general, but none of them is generally meaningful. A specific Hamilton’s rule, though always correct, is only meaningful if based on the Generalized Price equation, in combination with a model that is appropriately specified for the evolutionary system under study.</p>
<p>The Generalized Price equation puts the debate concerning the validity of Hamilton’s rule in perspective by showing that some arguments are not as decisive as they are currently perceived to be. The side of the debate that claims full generality has repeatedly stressed that Hamilton’s rule, derived with the Price equation, is an identity that holds generally<sup><xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c11">11</xref></sup> (that is, it holds, whatever the parent and the offspring generations are). This is correct, but the general version of Hamilton’s rule shows that being an identity that holds generally cannot be the only relevant characteristic for regarding it as the proper, the right, or the most insightful rule that describes evolution. The reason why this cannot be, is that all Price-like equations generated by the Generalized Price equation, and thereby all Hamilton-like rules produced by them, have those properties; they are all identities that hold with exactly the same generality. To decide between the different Hamilton-like rules, we therefore need additional criteria. When doing empirics, we then have to resort to classical statistics, to see which model agrees with the data. With sufficiently many data, this will then point to a statistical model, and by doing so, it will also point to one of these Hamilton-like rules. An indication that the approach suggested in this paper does indeed pick a Hamilton-like rule that is well-specified, both with modeling and with empirics, is that the quantities in it that we treat as constants are in fact constant, and that they do not change with the composition of the parent population.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>The Generalized Price equation in combination with models for non-social traits</title>
<p>I would like to start with describing how generalizing the Price equation works. By applying this to linear and non-linear fitness functions in a non-social context, I would moreover like to illustrate that for the Price-like equations that this generates, and that are meant to describe population genetic dynamics, there is scope for under- and for overspecification in the same way that there is scope for under- and for overspecification in statistics.</p>
<p>Assume that we track a set of genes, summarized by a <italic>p</italic>-score<sup><xref ref-type="bibr" rid="c19">19</xref></sup>. This <italic>p</italic>-score is a value between 0 and 1. In the simplest possible haploid setup, this reflects the presence or absence of a single gene, in which case an individual’s <italic>p</italic>-score would be 1 if the gene is present, and 0 if it is absent. In less simple setups, the <italic>p</italic>-score can for instance reflect a set of genes that affect the same trait. The change in average <italic>p</italic>-score between the parent and the offspring generation can then be written as a sum of two terms, in what Price called the “covariance form” of his equation<sup><xref ref-type="bibr" rid="c15">15</xref></sup>.
<disp-formula id="eqn1">
<graphic xlink:href="625193v2_eqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here, <inline-formula><inline-graphic xlink:href="625193v2_inline1.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the average fitness in the parent generation; <inline-formula><inline-graphic xlink:href="625193v2_inline2.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is the change in average <italic>p</italic>-score between parent and offspring generation; Cov(<italic>w,p</italic>) is the sample covariance between fitness and <italic>p</italic>-score (see Section 2 of Appendix A for details about the terminology); and <italic>E</italic>(<italic>w</italic> Δ<italic>p</italic>) is the fitness-weighted average difference between the <italic>p</italic>-scores of the parents, and, in an asexual model, the <italic>p</italic>-scores of their offspring, or, in a model with sexual reproduction, the <italic>p</italic>-scores of their successful gametes (all details are in Appendix A).</p>
<p>In order to get to the Generalized Price equation in covariance form, we assume a statistical model that has fitness as a dependent variable, and that contains, at least, 1) a constant term, and 2) a linear term for the <italic>p</italic>-score as an explanatory variable. Besides those two terms, the statistical model may contain any number of other terms as well. This statistical model is then combined with the transition we want to apply the Generalized Price equation to. A transition implies that we know what the <italic>p</italic>-score is for all individuals in the parent population, and that we know how many offspring all individuals have, and therefore what their realized fitness is (this is the number of offspring divided by the ploidy). Combining a transition with a statistical model here means that we choose the parameters of the model so that they minimize the sum of squared differences between the model-predicted fitness <inline-formula><inline-graphic xlink:href="625193v2_inline3.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and the realized fitnesses <inline-formula><inline-graphic xlink:href="625193v2_inline4.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, for individuals. For any model that does indeed include a constant term and a linear term for the <italic>p</italic>-score, we can then replace the realized fitnesses <italic>w</italic><sub><italic>i</italic></sub> in the Price equation with the estimated fitnesses <inline-formula><inline-graphic xlink:href="625193v2_inline5.gif" mime-subtype="gif" mimetype="image"/></inline-formula> according to the model. This leads to the Generalized Price equation in covariance form:
<disp-formula id="eqn2">
<graphic xlink:href="625193v2_eqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The algebra to show that this is an identity is in Appendix A, on pages 12–13. While replacing <italic>w</italic> with <inline-formula><inline-graphic xlink:href="625193v2_inline6.gif" mime-subtype="gif" mimetype="image"/></inline-formula> seems like a minimal change, the important thing to keep in mind, is that this equation is an identity for <italic>any</italic> model that contains a constant, and a linear term for the <italic>p</italic>-score. In other words, for any given transition (that is, for any combination of a parent and an offspring population), the model-predicted fitnesses <inline-formula><inline-graphic xlink:href="625193v2_inline7.gif" mime-subtype="gif" mimetype="image"/></inline-formula>that result from minimizing the sum of squared differences will typically differ, depending on what the model is, but <inline-formula><inline-graphic xlink:href="625193v2_inline8.gif" mime-subtype="gif" mimetype="image"/></inline-formula> equals the sample covariance Cov(<italic>w,p</italic>) for all of these models.</p>
<p>In order to get to what Price calls the “regression form” of the equation, we now choose a set of models, all of which contain a constant and a linear term (which makes it satisfy the condition for the Generalized Price equation to hold). This set of models is given by
<disp-formula id="ueqn1">
<graphic xlink:href="625193v2_ueqn1.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>w</italic><sub><italic>i</italic></sub> is the number of offspring of individual <italic>i; p</italic><sub><italic>i</italic></sub> is the <italic>p</italic>-score of individual <italic>i; α</italic> is a constant term; <italic>β</italic><sub><italic>1</italic></sub>,…, <italic>β</italic><sub><italic>R</italic></sub> are the other coefficients of the model; <italic>R</italic> ≥1 is the error term for individual <italic>R</italic>; and where we assume that <italic>R</italic> ≥1. This gives a different model for every <italic>R</italic>; a linear model for <italic>R</italic> = 1; a quadratic one for <italic>R</italic> = 2 ; and so on. If we now minimize the sum of squared differences between the model-predicted fitnesses <inline-formula><inline-graphic xlink:href="625193v2_inline9.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (the right hand side of the equation above, but without the error term) and the realized fitnesses (on the left hand side of the same equation), then we arrive at values <inline-formula><inline-graphic xlink:href="625193v2_inline10.gif" mime-subtype="gif" mimetype="image"/></inline-formula> for the regression coefficients.</p>
<p>In Appendix A, on page 14, I show that, for every <italic>R</italic> ≥1, and thereby for every model in this set, we can rewrite the Generalized Price equation as follows:
<disp-formula id="eqn3">
<graphic xlink:href="625193v2_eqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
In line with Price’s terminology<sup><xref ref-type="bibr" rid="c15">15</xref></sup>, this would be the “regression form” of the Generalized Price equation. If we take the linear model (<italic>R</italic> =1), then, using Cov(<italic>p, p</italic>) = var (p), the above equation becomes
<disp-formula id="ueqn2">
<graphic xlink:href="625193v2_ueqn2.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Below we will refer to the linear model as Model A. If instead we take the quadratic model <italic>R</italic> =2, the equation becomes
<disp-formula id="ueqn3">
<graphic xlink:href="625193v2_ueqn3.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Below we will refer to the quadratic model as Model B. Again, it is important to remember that both of these equations are identities for every possible transition from a parent to an offspring generation. It is also important to recognize that the <inline-formula><inline-graphic xlink:href="625193v2_inline12.gif" mime-subtype="gif" mimetype="image"/></inline-formula> that we arrive at if we combine Model A with a given transition, and the <inline-formula><inline-graphic xlink:href="625193v2_inline11.gif" mime-subtype="gif" mimetype="image"/></inline-formula> that we arrive at if we use Model B for the same transition, may, and generically will, differ, as we will see.</p>
<p>The following example illustrates how the flexibility of the Generalized Price equation comes with scope for under- and overspecification. The two Price-like equations above, the one for Model A and the one for Model B, are combined with two artificial datasets; one where the offspring generation is generated by Model A; and one where the offspring generation is generated by Model B. Because both equations are identities for all possible transitions between parent and offspring generation, they are also both identities for both of these datasets. Depending on the system under study, the terms in these equations however are not equally meaningful as a description of the population genetic dynamics.</p>
<p>The Generalized Price equation for Model A, in combination with the offspring generation generated by Model A, returns a value for <inline-formula><inline-graphic xlink:href="625193v2_inline13.gif" mime-subtype="gif" mimetype="image"/></inline-formula> that is very close to the true <inline-formula><inline-graphic xlink:href="625193v2_inline14.gif" mime-subtype="gif" mimetype="image"/></inline-formula> while <italic>β</italic><sub>1</sub>. This is depicted in <xref rid="fig1" ref-type="fig">Fig. 1a</xref>. All details are in computation A6 at the end of the Appendices.</p>
<fig id="fig1" position="float" fig-type="figure">
<label>Fig. 1.</label>
<caption><title>Two Price-like equations and two models.</title>
<p>In Model A, the number of offspring follows a binomial distribution with an expected number of offspring of. This means that the model can be summarized as (see computation A6 at the end of the Appendices for details). For the transition depicted in panels a and c, we generated an offspring generation using Model A, with and. Combining the Generalized Price equation with Model A includes choosing and so that they minimize the sum of squared differences between and. In Model B, the number of offspring follows a binomial distribution with an expected number of offspring of, which means that. For the transition depicted in panels b and d, we generated an offspring generation using Model B, with,, and. Combining the Generalized Price equation with Model B includes choosing,, and so that they minimize the sum of squared differences between and. Reproduction is asexual, so parents and their offspring are always identical, and by definition. For both of these models, we started with a population consisting of 2500 parents for each <italic>p</italic>-score, ranging from 0 to 1 in increments of 0.1. The four panels represent the four combinations of the two Price-like equations and the two datasets. The red lines in all panels represent the estimated fitnesses as a function of the <italic>p</italic>-score, as implied by the respective Price equations. The aim of this example is not to show that the estimated fitnesses from Price equation A match the data generated by Model A, and the estimated fitnesses from Price equation B match the data generated by Model B, but the estimated fitnesses from Price equation A do not match the data generated by Model B; that part is obvious. The purpose of this example, instead, is to illustrate that both Price equations remain identities, also when they are overspecified (panel c) or underspecified (panel b) with respect to the transition between parent and offspring population they are applied to. With underspecification, it is also visually clear that the estimated fitnesses do <italic>not</italic> match the data, even though Price equation A remains an identity, also when combined with data generated by Model B.</p></caption>
<graphic xlink:href="625193v2_fig1.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>The Generalized Price equation for Model B, in combination with the offspring generation generated by Model B, returns values for <inline-formula><inline-graphic xlink:href="625193v2_inline15.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="625193v2_inline16.gif" mime-subtype="gif" mimetype="image"/></inline-formula> that are also close to their true values; <inline-formula><inline-graphic xlink:href="625193v2_inline17.gif" mime-subtype="gif" mimetype="image"/></inline-formula> while <italic>β</italic><sub>1</sub>=0 and <inline-formula><inline-graphic xlink:href="625193v2_inline18.gif" mime-subtype="gif" mimetype="image"/></inline-formula> while <italic>β</italic><sub>2</sub>=0 This is depicted in <xref rid="fig1" ref-type="fig">Fig. 1d</xref>.</p>
<p>If we combine the Generalized Price equation for Model B with the offspring generation generated by Model A, then this returns values for and that are also close to their true values;, while ; and, while. This is depicted in <xref rid="fig1" ref-type="fig">Fig. 1b</xref>. Appropriate statistical tests reject that the true <italic>β</italic><sub>2</sub> is different from, but the harm done by using the Generalized Price equation for Model B – which is overspecified for data generated by Model A, because it includes a parameter for <inline-formula><inline-graphic xlink:href="625193v2_inline19.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, which is really 0 – is therefore limited; the estimated coefficient for <italic>β</italic><sub>2</sub> is very close to 0.</p>
<p>The Generalized Price equation for Model A, in combination with the offspring generation generated by Model B, however, does not return values for <inline-formula><inline-graphic xlink:href="625193v2_inline20.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="625193v2_inline21.gif" mime-subtype="gif" mimetype="image"/></inline-formula> that are close to their true values. For <inline-formula><inline-graphic xlink:href="625193v2_inline22.gif" mime-subtype="gif" mimetype="image"/></inline-formula> that is obvious, because the statistical model specification sets it to 0, While <italic>β</italic><sub>2</sub> =1. Moreover, <inline-formula><inline-graphic xlink:href="625193v2_inline23.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and this is also rather different from the true <italic>β</italic><sub>1</sub>, which Is 0. These differences are the result of underspecification. What is important to note here, is that none of this keeps the Generalized Price equation for Model A from being an identity, also for data that are really generated by Model B. Being an identity therefore does not guarantee that the regression coefficients in it have a meaningful interpretation; in this case the <inline-formula><inline-graphic xlink:href="625193v2_inline24.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is not the linear effect of the p-score on fitness.</p>
<p>This also illustrates a general property of the Generalized Price equation. If the data are generated by the model that matches the model that we combine the Generalized Price equation with, then the <inline-formula><inline-graphic xlink:href="625193v2_inline25.gif" mime-subtype="gif" mimetype="image"/></inline-formula> that feature in the regression form are unbiased estimators of the true <italic>β</italic><sub><italic>1</italic></sub>,…, <italic>β</italic><sub><italic>R</italic></sub>. This is exemplified by panel a, where the Generalized Price equation for Model A is applied to an offspring generation that is really generated by Model A, and by panel d, where the Generalized Price equation for Model B is applied to an offspring generation that is really generated by Model B. If, on the other hand, the model that we combine the Generalized Price equation with is underspecified for the underlying model that generated the data – as it is in the panel b of <xref rid="fig1" ref-type="fig">Fig. 1</xref> – then the regression coefficients are not unbiased estimators of any parameter of the true model. As a symptom of this, if the offspring population is indeed generated by a richer model, then the expected values of the regression coefficients <inline-formula><inline-graphic xlink:href="625193v2_inline26.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (that is, what values for <inline-formula><inline-graphic xlink:href="625193v2_inline27.gif" mime-subtype="gif" mimetype="image"/></inline-formula> we will find, on average, if we repeatedly draw an offspring population according to the true model) will depend on the composition of the parent population. Again, none of this keeps the Generalized Price equation for Model A from being an identity, also when applied to data generated by Model B.</p>
<p>The regression form of the original Price equation coincides with the regression form of the Generalized Price equation, combined with the linear model for <italic>R</italic> = 1 (Price Equation A in <xref rid="fig1" ref-type="fig">Fig. 1</xref>). This implies that limitations of the latter are shared with the original Price equation.</p>
<p>In the Price equation literature, the fact that regression coefficients may not be constant is conflated with, and inadequately labelled as, dynamic insufficiency. We will return to this point after introducing the Generalized Price equation in combination with social traits, but it is worthwhile already here to stress that regression coefficients depending on the composition of the parent population is not a sign of dynamic insufficiency, but rather an indication of misspecification.</p>
<p>The next example shows that the problem of misspecification is not limited to applications of the Generalized Price equation in a statistical setting. Misspecification is also possible when the Generalized Price equation is applied to a theoretical model. Section 5 in Appendix A describes the conditions under which one can in fact apply the Generalized Price equation in a modeling setting, so here we will assume that those conditions are satisfied; we assume an infinitely large population, error terms with expected value 0, and, if reproduction is sexual, fair meiosis.</p>
<p>In a modeling setting, it seems almost trivial that there is room for misspecification, if we apply the Generalized Price equation for one model to transitions that follow a different model. It will however be useful to acknowledge that this possibility exists. Below, we will therefore consider a linear model, <italic>w</italic><sub>i</sub> = <italic>α</italic>+ <italic>β</italic><sub>1</sub> <italic>p</italic><sub><italic>i</italic></sub> + ε<sub><italic>i</italic></sub> which we will again refer to as Model A, and a quadratic one <inline-formula><inline-graphic xlink:href="625193v2_inline28.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, which we will refer to as Model B. With infinite populations, such a model then implies that every parent population produces an offspring generation deterministically. If we minimize the squared differences in this transition, with respect to the model that generated the transition, we recover the coefficients of the model exactly (and not with some noise, as in the statistical example above). With two models to combine the Generalized Price equation with, and two models to apply these Price-like equations to, we again have four possible combinations.</p>
<p>As a preparation for moving on to generalizing Hamilton’s rule, I will also point to the rules for selection that the Price-like equations produce.</p>
<list list-type="order">
<list-item><p><italic>The Generalized Price equation for Model A applied to transitions following Model A</italic>.</p>
<p>The Generalized Price equation for Model A is
<disp-formula id="ueqn4">
<graphic xlink:href="625193v2_ueqn4.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
If this equation is applied to a transition that does indeed follow Model A, then the <inline-formula><inline-graphic xlink:href="625193v2_inline29.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in this Price-like equation is equal to the model parameter <italic>β</italic><sub>1</sub>. Translating this equation into a criterion for when higher p-scores are selected for is straightforward: higher p-scores are selected for at all frequencies if and only if <inline-formula><inline-graphic xlink:href="625193v2_inline30.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. With transitions that are generated by Model A, this means that higher p-scores are selected for if and only if <italic>β</italic><sub><italic>1</italic></sub> &gt; 0.</p></list-item>
<list-item><p>The Generalized Price equation for Model B applied to transitions following Model B.</p>
<p>The Generalized Price equation for Model B is
<disp-formula id="ueqn5">
<graphic xlink:href="625193v2_ueqn5.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
If this equation is applied to a transition that does indeed follow Model B,<inline-formula><inline-graphic xlink:href="625193v2_inline31.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is equal to the model parameter β<sub>1</sub>, and <inline-formula><inline-graphic xlink:href="625193v2_inline32.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is equal to the model parameter <italic>β</italic><sub>2</sub>. If we now translate this equation into a criterion for when higher <italic>p</italic>-scores are selected for, then this is still straightforward, but less concise:
<disp-formula id="ueqn6">
<graphic xlink:href="625193v2_ueqn6.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
If we furthermore assume random mating between generations (see Section 5 of Appendix A), then this simplifies to
<disp-formula id="ueqn7">
<graphic xlink:href="625193v2_ueqn7.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where is <inline-formula><inline-graphic xlink:href="625193v2_inline33.gif" mime-subtype="gif" mimetype="image"/></inline-formula> the average <italic>p</italic>-score in the parent population. With transitions that are indeed generated by Model B, this means that higher <italic>p</italic>-scores are selected for if and only if <inline-formula><inline-graphic xlink:href="625193v2_inline34.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. The rule for the Generalized Price equation for Model A, applied to trasitions that follow Model A, is nested in this rule here, in the sense that if we choose <italic>β</italic><sub>2</sub> = 0, this rule reverts to <italic>β</italic><sub>1</sub> &gt; 0.</p></list-item>
<list-item><p><italic>The Generalized Price equation for Model B applied to transitions following Model A</italic></p>
<p>The Generalized Price equation for Model B is still
<disp-formula id="ueqn8">
<graphic xlink:href="625193v2_ueqn8.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
If this equation is applied to a transition that follows Model A, then <inline-formula><inline-graphic xlink:href="625193v2_inline35.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is equal to the model parameter <italic>β</italic><sub>1</sub>, and <inline-formula><inline-graphic xlink:href="625193v2_inline36.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is equal to the model parameter <italic>β</italic><sub>2</sub> which is 0. The overspecification therefore is inconsequential; we end up with the same equation that we arrived at when we applied the Generalized Price equation for Model A to a transition that follows Model A.</p></list-item>
<list-item><p><italic>The Generalized Price equation for Model A applied to transitions following Model B</italic></p></list-item>
</list>
<p>The Generalized Price equation for Model A is still
<disp-formula id="ueqn9">
<graphic xlink:href="625193v2_ueqn9.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
If applied to a transition that follows Model B, then this implies that <inline-formula><inline-graphic xlink:href="625193v2_inline37.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. What is important to realize, is that now <inline-formula><inline-graphic xlink:href="625193v2_inline38.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is no longer a constant, as it depends on the population state through the <inline-formula><inline-graphic xlink:href="625193v2_inline39.gif" mime-subtype="gif" mimetype="image"/></inline-formula>-term. Also, it would be wrong to interpret <inline-formula><inline-graphic xlink:href="625193v2_inline40.gif" mime-subtype="gif" mimetype="image"/></inline-formula> as the linear effect of the gene on fitness, because here <inline-formula><inline-graphic xlink:href="625193v2_inline41.gif" mime-subtype="gif" mimetype="image"/></inline-formula>.</p>
<p>If we translate this equation into a criterion for when higher <italic>p</italic>-scores are is selected for, then this would be the same rule as the one we arrived at when the Generalized Price equation for Model A was applied to Model A, which is that higher <italic>p</italic>-scores are selected for if <inline-formula><inline-graphic xlink:href="625193v2_inline42.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. This is still a rule, and it gets the direction of selection right, but the <inline-formula><inline-graphic xlink:href="625193v2_inline43.gif" mime-subtype="gif" mimetype="image"/></inline-formula> in it does not have a meaningful interpretation anymore. The fact that the regression coefficient <inline-formula><inline-graphic xlink:href="625193v2_inline44.gif" mime-subtype="gif" mimetype="image"/></inline-formula> here changes with the population state moreover reflects misspecification, but now in a modeling context, and also here this does not reflect dynamic insufficiency.</p>
</sec>
<sec id="s2b">
<title>The general version of Hamilton’s rule</title>
<p>For the derivation of the general version of Hamilton’s rule, we need a richer setup, with two variables instead of one: a <italic>p</italic>-score and a <italic>q</italic>-score. The <italic>p</italic>-score represents a set of genes that code for some social behaviour, and the <italic>q</italic>-score of an individual represents the <italic>p</italic>-score of its interaction partner. We assume that both can take values in [0, 1]. We will combine the Generalized Price equation with a general set of models for social traits. This requires some formal notation.</p>
<p>Here we choose a set of models, in which a model is defined by its non-zero coefficients. That is, a model is a choice for a set of non-zero coefficients <italic>E</italic>, where (<italic>k, l</italic>) ∈ <italic>E</italic> if the term <italic>p</italic><sub><italic>i</italic></sub><sup><italic>k</italic></sup><italic>q</italic><sub><italic>i</italic></sub><sup><italic>l</italic></sup> in the model has a non-zero coefficient <italic>β</italic><sub><italic>k, l</italic></sub>. This then defines a model as follows:
<disp-formula id="ueqn10">
<graphic xlink:href="625193v2_ueqn10.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>ε</italic><sub>i</sub> is a noise term with expected value. We assume that coefficients <italic>β</italic><sub>0,0</sub> and <italic>β</italic><sub>1,0</sub> are included, or, in other words, that the model contains a constant and a linear term for the <italic>p</italic>-score.</p>
<p>For any such model, we can then apply the Generalized Price equation, and find the following Price-like equation for the population genetic dynamics (see Section 4 of Appendix A for details).
<disp-formula id="ueqn11">
<graphic xlink:href="625193v2_ueqn11.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
If we define <italic>E</italic>′ as the set of non-zero coefficients of the model, besides the constant term and the linear term for the <italic>p</italic>-score, then the generalized version of Hamilton’s rule is that <inline-formula><inline-graphic xlink:href="625193v2_inline45.gif" mime-subtype="gif" mimetype="image"/></inline-formula> if and only if
<disp-formula id="ueqn12">
<graphic xlink:href="625193v2_ueqn12.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
where <italic>c</italic> = − <italic>β</italic><sub>1,0</sub>, <italic>b</italic><sub><italic>k,l</italic></sub> = <italic>β</italic><sub><italic>k,l</italic></sub>, and <inline-formula><inline-graphic xlink:href="625193v2_inline46.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, both for all (<italic>k, l</italic>) ∈ <italic>E</italic>′. The linear term for the <italic>p</italic>-score still features in this equation, because that is what <italic>c</italic> represents. Details are in Section 3 of Appendix B. In Section 5 of Appendix B this is generalized further to include interactions between more than two individuals.</p>
<p>The general version of Hamilton’s rule produces a set of rules; one for every model of how traits affect fitnesses. Less general models, that are nested in more general ones, come with rules that are nested in more general rules. This includes rules for non-social traits. We get the rules for non-social traits, if the set of model coefficients, besides a constant, only includes coefficients <italic>β</italic><sub><italic>k</italic>,0</sub>, and no coefficients for terms that relate to the <italic>q</italic>-score. The simplest such rule is the linear one that we have seen above, and that we get if the true model only contains a constant, and a term for the linear effect of the <italic>p</italic>-score. Above, we referred to this model as Model A. This rule is nested in the rule for the quadratic model, swhich has a constant, a term for the linear effect of the p-score, and a term for the quadratic effect of the p-score. We referred to this model as Model B above. This describes selection in case of, for instance, heterozygote advantage (see Appendix A, Sections 3 and 5). This rule, in turn, is nested in more general rules for selection of non-social traits that include coefficients <italic>β</italic><sub><italic>k</italic>,0</sub> for <italic>k</italic> &gt; 2.</p>
<p>If we then go back to the rule for non-social traits, but with linear fitness effects only, then this rule is also nested in the classical Hamilton’s rule. The classical Hamilton’s rule is the rule that we get for a model that includes a constant, a term for the linear effect of the p-score, and a term for the linear effect of the <italic>q</italic>-score. This rule, in turn, is nested in the rule that we get when an interaction effect between the <italic>p</italic>- and the <italic>q</italic>-score is added to the model. The classical Hamilton’s rule therefore is itself nested in what one could refer to as Queller’s rule<sup><xref ref-type="bibr" rid="c27">27</xref></sup>. These rules moreover allow for further nesting, if the model we are interested in is more general, or if the data suggest that the true model includes additional non-zero coefficients. Below, we will however restrict attention to these three nested models in order to illustrate how they produce three rules that are nested, and how using the generalized version of Hamilton’s rule allows us to see the debate on the generality of the classical Hamilton’s rule in a new light.</p>
</sec>
<sec id="s2c">
<title>Three models and three rules</title>
<p>In Model 1, the p-score relates to a non-social trait, that only affects the fitness of its carrier. We also referred to this model as Model A before, where we nested it in a different, also non-social, but more general model.
<disp-formula id="ueqn13">
<graphic xlink:href="625193v2_ueqn13.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
In Model 2, the p-score relates to a social trait, that affects the fitness of its carrier, and the fitness of the partner of its carrier. In the fitness function, this is reflected by the effect of the p-score of the partner (the <italic>q</italic>-score) on individual. These effects are moreover assumed to be independent; the effect on the partner is the same, irrespective of the p-score of the partner.
<disp-formula id="ueqn14">
<graphic xlink:href="625193v2_ueqn14.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
In Model 3, the p-score also relates to a social trait, but now the effects are not assumed to be independent; the effect on the partner may depend on the p-score of the partner. This is reflected by the interaction term.
<disp-formula id="ueqn15">
<graphic xlink:href="625193v2_ueqn15.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Model 1: selection of a non-social trait</p>
<p>The Generalized Price equation, in regression form, for Model 1 is
<disp-formula id="ueqn16">
<graphic xlink:href="625193v2_ueqn16.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
The rule that this Price-like equation produces is that higher p-scores will be selected for if and only if <inline-formula><inline-graphic xlink:href="625193v2_inline47.gif" mime-subtype="gif" mimetype="image"/></inline-formula>. This is also the rule that we found above, when we referred to Model 1 as Model A. If the model under consideration is indeed Model 1, then <inline-formula><inline-graphic xlink:href="625193v2_inline48.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, both in the Price-like equation, and in the rule for selection.</p>
<p><italic>Model 2: selection of a linear social trait</italic></p>
<p>The Generalized Price equation, in regression form, for Model 2 is
<disp-formula id="ueqn17">
<graphic xlink:href="625193v2_ueqn17.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
From this, we can see that <inline-formula><inline-graphic xlink:href="625193v2_inline49.gif" mime-subtype="gif" mimetype="image"/></inline-formula> if and only if <inline-formula><inline-graphic xlink:href="625193v2_inline50.gif" mime-subtype="gif" mimetype="image"/></inline-formula> If the model under consideration is indeed Model 2, then, with an infinitely large population, the regression coefficients <inline-formula><inline-graphic xlink:href="625193v2_inline51.gif" mime-subtype="gif" mimetype="image"/></inline-formula>and <inline-formula><inline-graphic xlink:href="625193v2_inline52.gif" mime-subtype="gif" mimetype="image"/></inline-formula> will coincide with the true values of the parameters <italic>β</italic><sub>1,0</sub>and <italic>β</italic><sub>0,1</sub>, respectively, and <inline-formula><inline-graphic xlink:href="625193v2_inline53.gif" mime-subtype="gif" mimetype="image"/></inline-formula> will coincide with relatedness r between the individuals that interact. If we then define <italic>β</italic><sub>1,0</sub>and <italic>β</italic><sub>0,1</sub>, <italic>we</italic> can rewrite this as
<disp-formula id="ueqn18">
<graphic xlink:href="625193v2_ueqn18.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
Here we naturally recognize the classical Hamilton’s rule, because this implies that <inline-formula><inline-graphic xlink:href="625193v2_inline54.gif" mime-subtype="gif" mimetype="image"/></inline-formula> if and only if <italic>rb &gt; c</italic>.</p>
<p>At this point, it is useful to observe that if this is a social trait, and the true model is Model 2, but we combine it with the Generalized Price equation for Model 1, the latter still gets the direction of selection right. In that case, we would still use
<disp-formula id="ueqn19">
<graphic xlink:href="625193v2_ueqn19.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
but now with <inline-formula><inline-graphic xlink:href="625193v2_inline55.gif" mime-subtype="gif" mimetype="image"/></inline-formula> This however is typically not how we describe the evolution of social traits. The reason why we do not describe selection of a social trait with the rule for the non-social model is however <italic>not</italic> that this rule would get the direction of selection wrong; it would not. As a matter of fact, this rule always gets the direction of selection right too. The reason that here we use the classical version of Hamilton’s rule instead, is that this rule reveals the actual population genetic dynamics that govern selection; with a social trait for which <italic>rb &gt; c</italic>, the reason why the genes for the trait are selected is not that the behaviour they induce is good for the fitness of the individual that carries these genes itself; the reason is that the fitness costs of the associated behaviour to the individual itself are outweighed by how much fitness benefits carriers get through related individuals, compared to how much such benefits non-carriers get. In a theory model, this is postulated. With data, and if the sample size is large enough, statistical tests would make the same determination, by pointing to Model 2, and not Model 1, as the true model, if it is in fact the true model.</p>
<p>At this point, we therefore have two Price-like equations: the one for Model 1 and the one for Model 2. Both of these Price-like equations are identities, and both of them are general. When applied to Model 2, however, the Price-like equation for Model 1 is not meaningful, in the sense that the regression coefficient <inline-formula><inline-graphic xlink:href="625193v2_inline56.gif" mime-subtype="gif" mimetype="image"/></inline-formula> does not reflect the effect of the behaviour on the individual itself. As a symptom of this, it is not a constant, and varies with the population state. The core point of the original derivation of Hamilton’s rule, using the original Price equation, therefore is to not use an underspecified model. It is useful to keep this in mind when we are faced with analogous choices between Price-like equations, and between rules based on them, below.</p>
<p><italic>Model 3: selection of a social trait with an interaction effect</italic></p>
<p>The Generalized Price equation in regression form for the third model is
<disp-formula id="ueqn20">
<graphic xlink:href="625193v2_ueqn20.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
If the model under consideration is indeed Model 3, and we assume an infinite population, the regression coefficients <inline-formula><inline-graphic xlink:href="625193v2_inline57.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, and <inline-formula><inline-graphic xlink:href="625193v2_inline58.gif" mime-subtype="gif" mimetype="image"/></inline-formula> will coincide with the true values of the parameters <italic>β</italic><sub>1,0</sub>and <italic>β</italic><sub>0,1</sub>,<sub>;</sub> and <italic>β</italic><sub>1,1</sub>, respectively. Also, in an infinite population model, <inline-formula><inline-graphic xlink:href="625193v2_inline59.gif" mime-subtype="gif" mimetype="image"/></inline-formula> will coincide with relatedness <italic>r</italic>, which we call <italic>r</italic><sub><italic>01</italic></sub> here, in order to distinguish it from <inline-formula><inline-graphic xlink:href="625193v2_inline60.gif" mime-subtype="gif" mimetype="image"/></inline-formula> The latter is what <inline-formula><inline-graphic xlink:href="625193v2_inline61.gif" mime-subtype="gif" mimetype="image"/></inline-formula> will be in an infinite population (see Appendix B). If we then define <italic>c</italic> = −<italic>β</italic><sub>1,0</sub>, <italic>b</italic><sub>1,0</sub> = <italic>β</italic><sub>1,0</sub>, and <italic>b</italic><sub>1,1</sub>=<italic>β</italic><sub>1,1</sub>, we can rewrite the Generalized Price equation in regression form for the third model as
<disp-formula id="ueqn21">
<graphic xlink:href="625193v2_ueqn21.gif" mime-subtype="gif" mimetype="image"/>
</disp-formula>
This does not give us the classical Hamilton’s rule that we are familiar with. It does however give us a correct criterion for when higher p-scores are selected for <inline-formula><inline-graphic xlink:href="625193v2_inline62.gif" mime-subtype="gif" mimetype="image"/></inline-formula> if and only if <italic>r</italic><sub>0,1</sub><italic>b</italic><sub>0,1</sub>+<italic>r</italic><sub>1,1</sub><italic>b</italic><sub>1,1</sub>&gt;<italic>c</italic>. This criterion features two benefits and two relatednesses; besides the classical, linear benefit <italic>b</italic>, which we call <italic>b</italic><sub><italic>0,1</italic></sub> here, it also has an interaction benefit <italic>b</italic><sub>1, 1;</sub> that only fully materializes if both the individual itself and its partner have a <italic>p</italic>-score of 1. If <italic>b</italic><sub>1,1</sub><italic>=</italic> 0, then we are back in Model 2, and this rule reverts to the classical Hamilton’s rule. The rule with a non-zero interaction effect is the same as the rule suggested by Queller<sup><xref ref-type="bibr" rid="c27">27</xref></sup>, if we assume that genotype and phenotype correlate perfectly (see also Section 2 of Appendix B). By choosing ever more general models, we would get a sequence of ever more general rules, but for the purpose of illustration, it suffices to focus on these three, and explore the scope for under- and overspecification within this set of three models.</p>
<p>We can, of course, still apply the Generalized Price equation for Model 1, or the Generalized Price equation for Model 2, to Model 3 in the same way that we can apply the Generalized Price equation for Model 1 to Model 2, as we did above. We do this in detail in Section 2 of Appendix B to make sure that there can be no misunderstanding concerning the details, and the results are shown in <xref rid="fig2" ref-type="fig">Figure 2</xref>. The important observation to make here is that both of these rules <italic>also</italic> get the direction of selection right. The argument for not using these rules for Model 3, even though they do get the direction of selection right, is identical to the argument for not using the rule for selection of non-social traits for social traits: the rule for non-social traits just does not describe the population genetic dynamics for a social trait accurately. This is why we use the conventional version of Hamilton’s rule when modelling social behaviour, and not the rule that we would get if we applied the Generalized Price equation for the non-social model (Model 1). The Price-like equation for the non-social model also gets the direction of selection right, but we know that this version is incomplete, precisely because it leaves out the true social effects we care about unveiling when we use the conventional Hamilton’s rule. For exactly analogous reasons, we should not rely on underspecified versions of the Price equation in other instances, including the case where the conventional Hamilton’s rule itself, in turn, is based on an underspecified Price-like equation.</p>
<fig id="fig2" position="float" fig-type="figure">
<label>Fig. 2.</label>
<caption><title>Three rules and three models.</title>
<p>This table gives all combinations of the three rules and the three models discussed in the example. All rules indicate the direction of selection correctly for all models. Yellow indicates a combination of a rule and a model, where the rule is more general than is needed for the model. This leads to one or more <italic>b’s</italic> being 0. These are relatively harmless overspecifications. Red indicates a combination of a rule and a model, where the rule is not general enough (underspecified) for the model. This leads to <italic>b’s</italic> and <italic>c’s</italic> that depend on the population state. Terms that depend on the population state are abbreviated as follows<inline-formula><inline-graphic xlink:href="625193v2_inline67.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and<inline-formula><inline-graphic xlink:href="625193v2_inline68.gif" mime-subtype="gif" mimetype="image"/></inline-formula> (see Appendix B for calculations). Rule 1 is the standard rule for non-social evolution for linear non-social traits. Rule 2 is the classical Hamilton’s rule. Rule 3 is a rule that allows for an interaction effect, and that one could call dueller’s rule<sup><xref ref-type="bibr" rid="c27">27</xref></sup>. Rule 1 is nested in Rule 2, which is nested in Rule 3, which can be nested in a more general rule as well.</p></caption>
<graphic xlink:href="625193v2_fig2.tif" mime-subtype="tiff" mimetype="image"/>
</fig>
<p>As a symptom of underspecification, if we apply the Generalized Price equation for Model 1 to Model 3, then the value for <inline-formula><inline-graphic xlink:href="625193v2_inline63.gif" mime-subtype="gif" mimetype="image"/></inline-formula> is not a constant, and depends on the population state. Similarly, if we apply the Generalized Price equation for Model 2 to Model 3, then the values for <inline-formula><inline-graphic xlink:href="625193v2_inline64.gif" mime-subtype="gif" mimetype="image"/></inline-formula> and <inline-formula><inline-graphic xlink:href="625193v2_inline65.gif" mime-subtype="gif" mimetype="image"/></inline-formula> are not constants, and depend on the population state. The part of the literature on Hamilton’s rule that has emphasized its full generality, has however insisted that we do always use one and the same equation, even if it is underspecified, and incorporate more general models, such as Model 3, within the classical version of Hamilton’s rule,<sup><xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c11">11</xref>,<xref ref-type="bibr" rid="c19">19</xref>,<xref ref-type="bibr" rid="c22">22</xref>,<xref ref-type="bibr" rid="c28">28</xref>,<xref ref-type="bibr" rid="c29">29</xref></sup>.</p>
<p>The relation between these examples can be summarized in a table that, for the three models and the three rules, represents all nine combinations of them (see <xref rid="fig2" ref-type="fig">Fig. 2</xref>). This matrix of combinations of models and rules also helps to understand what causes the contentiousness of the debate on the generality of Hamilton’s rule. Rule 2, which is the rule that we get from applying the standard Price equation (also known as using the regression method), is a completely general rule, in the sense that whatever the true model is, it always gets the direction of selection right. This is true, but that fact is not a good argument for singling this rule out as more helpful, meaningful, or insightful than other rules. In the example above, we have seen that if we apply the Generalized Price equation (which one could also describe as using the regression method, but now with a richer menu of alternative underlying statistical models) then this can also give us Rule 1 or Rule 3, depending on the statistical model we use. These rules are equally correct, in the sense that they also always get the direction of selection right. They are also equally general, in the sense that they also get it right for every possible model. Being a general rule, that always gets the direction of selection right, therefore, cannot be a criterion for elevating Rule 2 (which is the classical Hamilton’s rule), above the other ones, because Rules 1 and 3 are also general rules, that always get the direction of selection right.</p>
<p>Since being completely general and always getting the direction of selection right does not single out any of the possible rules, we need additional criteria. A natural criterion would be that besides being correct, the terms in the rule would have to be meaningful. More precisely, we think the rule should do what Rule 1 (the rule for evolution of non-social traits) does for Model 1, and what Rule 2 (the classical Hamilton’s rule) does for Model 2, and that is to separate model parameters from properties of the population state, in order to produce an equation that describes the population genetic dynamics. That is what Rule 3 does for Model 3. Ever more general models would moreover require ever more general rules to accurately capture the population dynamics.</p>
<p>The debate in the literature on the generality of Hamilton’s rule is so long-lasting because it mostly focuses on whether or not rules are correct, and not on whether the rules are (also) meaningful. One side of the debate tends to return to the argument that Rule 2 is general and correct<sup><xref ref-type="bibr" rid="c7">7</xref>,<xref ref-type="bibr" rid="c8">8</xref>,<xref ref-type="bibr" rid="c10">10</xref>,<xref ref-type="bibr" rid="c11">11</xref></sup>. The other side of the debate tends to return to models that do not fit Model 2<sup><xref ref-type="bibr" rid="c3">3</xref>-<xref ref-type="bibr" rid="c5">5</xref></sup>. Sometimes arguments on this side take a completely different approach, and rather than describing selection with the Price equation, and then worry about whether or not one can interpret regression coefficients in it as benefits and costs, they start with models with a priori interpretable definitions for <italic>b</italic> and c, for instance by using what is called the counterfactual approach, rather than the regression approach, to define costs and benefits<sup><xref ref-type="bibr" rid="c13">13</xref>,<xref ref-type="bibr" rid="c14">14</xref></sup>. Starting at the opposite end, this can then result in rules that end up getting the direction of selection wrong.</p>
<p>Another recurrent point is that when regression coefficients in the Price equation are found to vary with the state of the parent population, this is often claimed to be the result of the Price equation being dynamically insufficient. In order to point out why that is inaccurate, we can first point to ways in which an underlying model <italic>can</italic> be dynamically insufficient. If we have a model that describes how the fitness of an individual depends on its <italic>p-</italic> and <italic>q-</italic> score, and we are given a parent population, then this model would produce the <italic>p</italic>-scores in the new generation. It would however not generate which individuals are partnered up with whom in the new generation, and therefore it would not identify who has which q-score in the new generation. In this case a full model would have to include more than just the fitness function, but in the absense of assumptions about the matching in the new generation, such a model would be dynamically insufficient. It is however important to notice that this is <italic>not</italic> the same as the regression coefficients <inline-formula><inline-graphic xlink:href="625193v2_inline66.gif" mime-subtype="gif" mimetype="image"/></inline-formula>, depending on the population state, which is regularly also referred to as dynamical insufficiency. Describing this as dynamical insufficiency is incorrect, and the dependence on the population state is really a symptom of misspecification. Section 6 of Appendix A elaborates on this point in a more precise way.</p>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>The general version of Hamilton’s rule provides a positive resolution of a long-standing, heated debate. I derived the Generalized Price equation, which reconnects the Price equation with statistics, and allows us to base rules for selection properly on dynamical models for population genetics that offer the flexibility needed to accommodate a variety of ways in which fitness can depend on traits of individuals and their interaction partners. While previous work focused on the limitations of the original Price equation<sup><xref ref-type="bibr" rid="c23">23</xref>,<xref ref-type="bibr" rid="c24">24</xref>,<xref ref-type="bibr" rid="c26">26</xref></sup>, and on limitations of the classical version of Hamilton’s rule, when there are interaction effects <sup><xref ref-type="bibr" rid="c3">3</xref>,<xref ref-type="bibr" rid="c4">4</xref>,<xref ref-type="bibr" rid="c6">6</xref>,<xref ref-type="bibr" rid="c9">9</xref>,<xref ref-type="bibr" rid="c12">12</xref>-<xref ref-type="bibr" rid="c14">14</xref></sup>, the Generalized Price equation, and the general version of Hamilton’s rule that is derived with it, are constructive contributions that offer alternatives for a large variety of forms the fitness function can have. The insight that comes with it has major implications, also for empirical research on kin selection. It implies that whether or not Hamilton’s rule holds, is not a meaningful empirical question. As a field, we have nonetheless spent quite some time and energy on trying to answer this question. Because the question turns out to be ill-posed, we can stop trying to answer it. The meaningful empirical question that we should focus on instead, is what form the fitness function has, and which version of Hamilton’s rule therefore applies to which social trait.</p>
</sec>

</body>
<back>
<sec id="suppd1e1419" sec-type="supplementary-material">
<title>Additional files</title>
<supplementary-material id="d1e1410">
<label>Appendix A and B.</label>
<media xlink:href="supplements/625193_file02.pdf"/>
</supplementary-material>
</sec>
<ref-list>
<title>References</title>
<ref id="c1"><label>1.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamilton</surname>, <given-names>W. D.</given-names></string-name></person-group> <article-title>The genetical evolution of social behaviour. I</article-title>. <source>J Theor Biol</source> <volume>7</volume>, <fpage>1</fpage>–<lpage>16</lpage> (<year>1964</year>).</mixed-citation></ref>
<ref id="c2"><label>2.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamilton</surname>, <given-names>W. D.</given-names></string-name></person-group> <article-title>The genetical evolution of social behaviour. II</article-title>. <source>J Theor Biol</source> <volume>7</volume>, <fpage>17</fpage>–<lpage>52</lpage> (<year>1964</year>).</mixed-citation></ref>
<ref id="c3"><label>3.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Karlin</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Matessi</surname>, <given-names>C.</given-names></string-name></person-group> <article-title>The eleventh R. A. Fisher Memorial Lecture - Kin selection and altruism</article-title>. <source>Proc R Soc Lond B Biol Sci</source> <volume>219</volume>, <fpage>327</fpage>–<lpage>353</lpage> (<year>1983</year>).</mixed-citation></ref>
<ref id="c4"><label>4.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Matessi</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Karlin</surname>, <given-names>S.</given-names></string-name></person-group> <article-title>On the evolution of altruism by kin selection</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>81</volume>, <fpage>1754</fpage>–<lpage>1758</lpage> (<year>1984</year>).</mixed-citation></ref>
<ref id="c5"><label>5.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Group selection, kin selection, altruism and cooperation: When inclusive fitness is right and when it can be wrong</article-title>. <source>J Theor Biol</source> <volume>259</volume>, (<year>2009</year>).</mixed-citation></ref>
<ref id="c6"><label>6.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nowak</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>Tarnita</surname>, <given-names>C. E.</given-names></string-name> &amp; <string-name><surname>Wilson</surname>, <given-names>E. O.</given-names></string-name></person-group> <article-title>The evolution of eusociality</article-title>. <source>Nature</source> <volume>466</volume>, <fpage>1057</fpage>–<lpage>1062</lpage> (<year>2010</year>).</mixed-citation></ref>
<ref id="c7"><label>7.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Abbot</surname>, <given-names>P.</given-names></string-name> <etal>et al.</etal></person-group> <article-title>Inclusive fitness theory and eusociality</article-title>. <source>Nature</source> <volume>471</volume>, <fpage>E1</fpage>–<lpage>E4</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c8"><label>8.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Gardner</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>West</surname>, <given-names>S. A.</given-names></string-name> &amp; <string-name><surname>Wild</surname>, <given-names>G.</given-names></string-name></person-group> <article-title>The genetical theory of kin selection</article-title>. <source>J Evol Biol</source> <volume>24</volume>, <fpage>1020</fpage>–<lpage>1043</lpage> (<year>2011</year>).</mixed-citation></ref>
<ref id="c9"><label>9.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Allen</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Nowak</surname>, <given-names>M. A.</given-names></string-name> &amp; <string-name><surname>Wilson</surname>, <given-names>E. O.</given-names></string-name></person-group> <article-title>Limitations of inclusive fitness</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>110</volume>, <fpage>20135</fpage>–<lpage>20139</lpage> (<year>2013</year>).</mixed-citation></ref>
<ref id="c10"><label>10.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Marshall</surname>, <given-names>J. A. R.</given-names></string-name></person-group> <source>Social Evolution and Inclusive Fitness Theory: An Introduction</source>. (<publisher-name>Princeton University Press</publisher-name>, <year>2015</year>).</mixed-citation></ref>
<ref id="c11"><label>11.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Rousset</surname>, <given-names>F.</given-names></string-name></person-group> <article-title>Regression, least squares, and the general version of inclusive fitness</article-title>. <source>Evolution (N Y)</source> <volume>69</volume>, <fpage>2963</fpage>–<lpage>2970</lpage> (<year>2015</year>).</mixed-citation></ref>
<ref id="c12"><label>12.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Nowak</surname>, <given-names>M. A.</given-names></string-name>, <string-name><surname>McAvoy</surname>, <given-names>A.</given-names></string-name>, <string-name><surname>Allen</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Wilson</surname>, <given-names>E. O.</given-names></string-name></person-group> <article-title>The general form of Hamilton’s rule makes no predictions and cannot be tested empirically</article-title>. <source>Proceedings of the National Academy of Sciences</source> <volume>114</volume>, <fpage>5665</fpage>–<lpage>5670</lpage> (<year>2017</year>).</mixed-citation></ref>
<ref id="c13"><label>13.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Allen</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Hoffman</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>Simon</surname>, <given-names>B.</given-names></string-name> &amp; <string-name><surname>Veller</surname>, <given-names>C.</given-names></string-name></person-group> <article-title>Hamilton’s rule</article-title>. <source>J Theor Biol</source> <volume>414</volume>, (<year>2017</year>).</mixed-citation></ref>
<ref id="c14"><label>14.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Can Hamilton’s rule be violated?</article-title> <source>eLife</source> <volume>7</volume>, (<year>2018</year>).</mixed-citation></ref>
<ref id="c15"><label>15.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Price</surname>, <given-names>G. R.</given-names></string-name></person-group> <article-title>Selection and Covariance</article-title>. <source>Nature</source> <volume>227</volume>, <fpage>520</fpage>–<lpage>521</lpage> (<year>1970</year>).</mixed-citation></ref>
<ref id="c16"><label>16.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Hamilton’s missing link</article-title>. <source>J Theor Biol</source> <volume>246</volume>, (<year>2007</year>).</mixed-citation></ref>
<ref id="c17"><label>17.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Hamilton</surname>, <given-names>W. D.</given-names></string-name></person-group> <article-title>Selfish and Spiteful Behaviour in an Evolutionary Model</article-title>. <source>Nature</source> <volume>228</volume>, <fpage>1218</fpage>–<lpage>1220</lpage> (<year>1970</year>).</mixed-citation></ref>
<ref id="c18"><label>18.</label><mixed-citation publication-type="book"><person-group person-group-type="author"><string-name><surname>Hamilton</surname>, <given-names>W. D.</given-names></string-name></person-group> <chapter-title>Innate social aptitudes of man: an approach from evolutionary genetics</chapter-title>. In <source>Narrow roads of gene land. Vol 1. Evolution of social behaviour</source>. <person-group person-group-type="editor"><string-name><surname>Fox</surname>, <given-names>R.</given-names></string-name></person-group>) <fpage>315</fpage>–<lpage>352</lpage> (<year>1975</year>). <publisher-name>Malaby Press</publisher-name></mixed-citation></ref>
<ref id="c19"><label>19.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grafen</surname>, <given-names>A.</given-names></string-name></person-group> <article-title>A geometric view of relatedness</article-title>. <source>Oxford surveys in evolutionary biology</source> <volume>2</volume>, <fpage>28</fpage>–<lpage>89</lpage>. (<year>1985</year>).</mixed-citation></ref>
<ref id="c20"><label>20.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taylor</surname>, <given-names>P. D.</given-names></string-name></person-group> <article-title>Evolutionary stability in one-parameter models under weak selection</article-title>. <source>Theor Popul Biol</source> <volume>36</volume>, <fpage>125</fpage>–<lpage>143</lpage> (<year>1989</year>).</mixed-citation></ref>
<ref id="c21"><label>21.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Taylor</surname>, <given-names>P. D.</given-names></string-name> &amp; <string-name><surname>Frank</surname>, <given-names>S. A.</given-names></string-name></person-group> <article-title>How to Make a Kin Selection Model</article-title>. <source>J Theor Biol</source> <volume>180</volume>, <fpage>27</fpage>–<lpage>37</lpage> (<year>1996</year>).</mixed-citation></ref>
<ref id="c22"><label>22.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grafen</surname>, <given-names>A.</given-names></string-name></person-group> <article-title>Optimization of inclusive fitness</article-title>. <source>J Theor Biol</source> <volume>238</volume>, <fpage>541</fpage>–<lpage>563</lpage> (<year>2006</year>).</mixed-citation></ref>
<ref id="c23"><label>23.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>On the use of the Price equation</article-title>. <source>J Theor Biol</source> <volume>237</volume>, (<year>2005</year>).</mixed-citation></ref>
<ref id="c24"><label>24.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name>, <string-name><surname>García</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Sabelis</surname>, <given-names>M. W.</given-names></string-name> &amp; <string-name><surname>Egas</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>Group selection and inclusive fitness are not equivalent; the Price equation vs. models and statistics</article-title>. <source>J Theor Biol</source> <volume>299</volume>, (<year>2012</year>).</mixed-citation></ref>
<ref id="c25"><label>25.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Frank</surname>, <given-names>S. A.</given-names></string-name></person-group> <article-title>Natural selection. IV. The Price equation*</article-title>. <source>J Evol Biol</source> <volume>25</volume>, <fpage>1002</fpage>–<lpage>1019</lpage> (<year>2012</year>).</mixed-citation></ref>
<ref id="c26"><label>26.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>van Veelen</surname>, <given-names>M.</given-names></string-name></person-group> <article-title>The problem with the Price equation</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>375</volume>, <fpage>20190355</fpage> (<year>2020</year>).</mixed-citation></ref>
<ref id="c27"><label>27.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Queller</surname>, <given-names>D. C.</given-names></string-name></person-group> <article-title>Kinship, reciprocity and synergism in the evolution of social behaviour</article-title>. <source>Nature</source> <volume>318</volume>, <fpage>366</fpage>–<lpage>367</lpage> (<year>1985</year>).</mixed-citation></ref>
<ref id="c28"><label>28.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Queller</surname>, <given-names>D. C.</given-names></string-name></person-group> <article-title>A general model for kin selection</article-title>. <source>Evolution (N Y)</source> <volume>46</volume>, <fpage>376</fpage>–<lpage>380</lpage> (<year>1992</year>).</mixed-citation></ref>
<ref id="c29"><label>29.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Grafen</surname>, <given-names>A. News</given-names></string-name></person-group> and Views. <article-title>Evolutionary theory: Hamilton’s rule OK</article-title>. <source>Nature</source> <volume>318</volume>, <fpage>310</fpage>–<lpage>311</lpage> (<year>1985</year>).</mixed-citation></ref>
<ref id="c30"><label>30.</label><mixed-citation publication-type="journal"><person-group person-group-type="author"><string-name><surname>Bourke</surname>, <given-names>A. F. G.</given-names></string-name></person-group> <article-title>Hamilton’s rule and the causes of social evolution</article-title>. <source>Philosophical Transactions of the Royal Society B: Biological Sciences</source> <volume>369</volume>, <fpage>20130362</fpage> (<year>2014</year>).</mixed-citation></ref>
</ref-list>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105065.1.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Rainey</surname>
<given-names>Paul B</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Max Planck Institute for Evolutionary Biology</institution>
</institution-wrap>
<city>Plön</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Valuable</kwd>
</kwd-group>
</front-stub>
<body>
<p>Kin selection and inclusive fitness have generated significant controversy. While not entirely new, this paper reconsiders the general form of Hamilton's rule in which benefits and costs are defined as regression coefficients, with higher-order coefficients being added to accommodate non-linear interactions. The paper is a <bold>valuable</bold> contribution to the field with <bold>convincing</bold>, systematic analysis, giving clarity to long-standing debates.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105065.1.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>There has been intense controversy over the generality of Hamilton's inclusive fitness rule for how evolution works on social behaviors. All generally agree that relatedness can be a game changer, for example allowing for otherwise unselectable altruistic behaviors when c &lt; rb, where c is the fitness cost to the altruism, b is the fitness benefit to another, and r their relatedness. Many complications have been successfully incorporated into the theory, including different reproductive values and viscous population structures.</p>
<p>The controversy has centered on another dimension; Hamilton's original model was for additive fitness, but how does his result hold when fitnesses are non-additive? One approach has been not to worry about a general result but just find results for particular cases. A consistent finding is that the results depend on the frequency of the social allele - non-additivity causes frequency dependence that was absent in Hamilton's approach. Two other approaches derive from Queller via the Price equation. Queller 1 is to find forms like Hamilton's rule, but with additional terms that deal with non-additive interaction, each with an r-like population structure variable multiplied by a b-like fitness effect (Queller 1985). Queller 2 redefines the fitness effects c and b as partial regressions of the actor's and recipient's genes on fitness. This leaves Hamilton's rule intact, just with new definitions of c and b that depend on frequency.</p>
<p>Queller 2 is the version that has been most adopted by the inclusive fitness community along with assertions that Hamilton's rule in completely general. In this paper, van Veelen argues that Queller 1 is the correct approach. He derives a general form that Queller only hinted at. He does so within a more rigorous framework that puts both Price's equation and Hamilton's rule on firmer statistical ground. Within that framework, the Queller 2 approach is seen to be a statistical misspecification - it employs a model without interaction in cases that actually do have interaction. If we accept that this is a fatal flaw, the original version of Hamilton's rule is limited to linear fitness models, which might not be common.</p>
<p>Strengths:</p>
<p>While the approach is not entirely new, this paper provides a more rigorous approach and a more general result. It shows that both Queller 1 and Queller 2 are identities and give accurate results, because both are derived from the Price equation, which is an identity. So why prefer Queller 1? It identifies the misspecification issue with the Queller 2 approach and points out its consequences. For example, it will not give the minimum squared differences between the model and data. It does not separate the behavioral effects of the individuals from the population state (b and c become dependent on r and the population frequency).</p>
<p>The paper also shows how the same problems can apply to non-social traits. Epistasis is the non-additivity of effects of two genes within the individual. (So one wonders why have we not had a similarly fierce controversy over how we should treat epistasis?)</p>
<p>The paper is clearly written. Though somewhat repetitive, particularly in the long supplement, most of that repetition has the purpose of underscoring how the same points apply equally to a variety of different models.</p>
<p>
Finally, this may be a big step towards reconciliation in the inclusive fitness wars. Van Veelen has been one of the harshest critics of inclusive fitness, and now he is proposing a version of it.</p>
<p>Weaknesses:</p>
<p>van Veelen argues that the field essentially abandoned the Queller 1 approach after its publication. I think this is putting it too strongly - there have been a number of theoretical studies that incorporate extra terms with higher-order relatednesses. It is probably accurate to say that there has been relative neglect. But perhaps this is partly due to a perception that this approach is difficult to apply.</p>
<p>The model in this paper is quite elegant and helps clarify conceptual issues, but I wonder how practical it will turn out to be. In terms of modeling complicated cases, I suspect most practitioners will continue doing what they have been doing, for example using population genetics or adaptive dynamics, without worrying about neatly separating out a series of terms multiplying fitness coefficients and population structure coefficients.</p>
<p>For empirical studies, it is going to be hard to even try to estimate all those additional parameters. In reality, even the standard Hamilton's rule is rarely tested by trying to estimate all its parameters. Instead, it is commonly tested more indirectly, for example by comparative tests of the importance of relatedness. That of course would not distinguish between additive and non-additive models that both depend on relatedness, but it does test the core idea of kin selection. It will be interesting to see if van Veelen's approach stimulates new ways of exploring the real world.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105065.1.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>This manuscript reconsiders the &quot;general form&quot; of Hamilton's rule, in which &quot;benefit&quot; and &quot;cost&quot; are defined as regression coefficients. It points out that there is no reason to insist on Hamilton's rule of the form -c+br&gt;0, and that, in fact, arbitrarily many terms (i.e. higher-order regression coefficients) can be added to Hamilton's rule to reflect nonlinear interactions. Furthermore, it argues that insisting on a rule of the form -c+br&gt;0 can result in conditions that are true but meaningless and that statistical considerations should be employed to determine which form of Hamilton's rule is meaningful for a given dataset or model.</p>
<p>Strengths:</p>
<p>The point is an important one. While it is not entirely novel-the idea of adding extra terms to Hamilton's rule has arisen sporadically (Queller 1985, 2011; Fletcher &amp; Zwick 2006; van Veelen et al. 2017)--it is very useful to have a systematic treatment of this point. I think the manuscript can make an important contribution by helping to clarify a number of debates in the literature. I particularly appreciate the heterozygote advantage example in the SI.</p>
<p>Weaknesses:</p>
<p>Although the mathematical analysis is rigorously done and I largely agree with the conclusions, I feel there are some issues regarding terminology, some regarding the state of the field, and the practice of statistics that need to be clarified if the manuscript is truly to resolve the outstanding issues of the field. Otherwise, I worry that it will in some ways add to the confusion.</p>
<p>(1) The &quot;generalized&quot; Price equation: I agree that the equations labeled (PE.C) and (GPE.C) are different in a subtle yet meaningful way. But I do not see any way in which (GPE.C) is more general than (PE.C). That is, I cannot envision any circumstance in which (GPE.C) applies but (PE.C) does not. A term other than &quot;generalized&quot; should be used.</p>
<p>(2) Regression vs covariance forms of the Price equation</p>
<p>I think the author uses &quot;generalized&quot; in reference to what Price called the &quot;regression form&quot; of his equation. But to almost everyone in the field, the &quot;Price Equation&quot; refers to the covariance form. For this reason, it is very confusing when the manuscript refers to the regression form as simply &quot;the Price Equation&quot;.</p>
<p>As an example, in the box on p. 15, the manuscript states &quot;The Price equation can be generalized, in the sense that one can write a variety of Price-like equations for a variety of possible true models, that may have generated the data.&quot; But it is not the Price equation (covariance form) that is being generalized here. It is only the regression that Price used that is being generalized.</p>
<p>To be consistent with the field, I suggest the term &quot;Price Equation&quot; be used only to refer to the covariance form unless it is otherwise specified as in &quot;regression form of the Price equation&quot;.</p>
<p>(3) Sample covariance: The author refers to the covariance in the Price equation as &quot;sample covariance&quot;. This is not correct, since sample covariance has a denominator of N-1 rather than N (Bessel's correction). The correct term, when summing over an entire population, is &quot;population covariance&quot;. Price (1972) was clear about this: &quot;In this paper we will be concerned with population functions and make no use of sample functions&quot;. This point is elaborated on by Frank (2012), in the subsection &quot;Interpretation of Covariance&quot;.</p>
<p>Of course, the difference is negligible when the population is large. However, the author applies the covariance formula to populations as small as N=2, for which the correction factor is significant.</p>
<p>The author objects to using the term &quot;population covariance&quot; (SI, pp. 8-9) on the grounds that it might be misleading if the covariance, regression coefficients, etc. are used for inference because in this case, what is being inferred is not a population statistic but an underlying relationship. However, I am not convinced that statistical inference is or should be the primary use of the Price equation (see next point). At any rate, avoiding potential confusion is not a sufficient reason to use incorrect terminology.</p>
<p>Relatedly, I suggest avoiding using E for the second term in the Price equation, since (as the ms points out), it is not the expectation of any random variable. It is a population mean. There is no reason not to use something like Avg or bar notation to indicate population mean. Price (1972) uses &quot;ave&quot; for average.</p>
<p>I should add, however, that the distinction between population statistics vs sample statistics goes away for regression coefficients (e.g. b, c, and r in Hamilton's rule) since in this case, Bessel's correction cancels out.</p>
<p>(4) Descriptive vs. inferential statistics</p>
<p>When discussing the statistical quantities in the Price Equation, the author appears to treat them all as inferential statistics. That is, he takes the position that the population data are all generated by some probabilistic model and that the goal of computing the statistical quantities in the Price Equation is to correctly infer this model.</p>
<p>It is worth pointing out that those who argue in favor of the Price Equation do not see it this way: &quot;it is a mistake to assume that it must be the evolutionary theorist, writing out covariances, who is performing the equivalent of a statistical analysis.&quot; (Gardner, West, and Wild, 2011); &quot;Neither data nor inferences are considered here&quot; (Rousset 2015). From what I can tell, to the supporters of the Price equation and the regression form of Hamilton's rule, the statistical quantities involved are either population-level *descriptive* statistics (in an empirical context), or else are statistics of random variables (in a stochastic modeling context).</p>
<p>In short, the manuscript seems to argue that Price equation users are performing statistical inference incorrectly, whereas the users insist that they are not doing statistical inference at all.</p>
<p>The problem (and here I think the author would agree with me) arises when users of the Price equation go on to make predictive or causal claims that would require the kind of statistical analysis they claim not to be doing. Claims of the form &quot;Hamilton's rule predicts..&quot; or use of terms like &quot;benefit&quot; and &quot;cost&quot; suggest that one has inferred a predictive or causal relationship in the given data, while somehow bypassing the entire theory of statistical inference.</p>
<p>There is also a third way to use the Price equation which is entirely unobjectionable: as a way to express the relationship between individual-level fitness and population-level gene frequency change in a form that is convenient for further algebraic manipulation. I suspect that this is actually the most common use of the Price equation in practice.</p>
<p>For a paper that aims to clarify these thorny concepts in the literature, I think it is worth pointing out these different interpretations of statistical quantities in the Price equation (descriptive statistics vs inferential statistics vs algebraic manipulation). One can then critique the conclusions that are inappropriately drawn from the Price equation, which would require rigorous statistical inference to draw. Without these clarifications, supporters of the Price equation will again argue that this manuscript has misunderstood the purpose of the equation and that they never claimed to do inference in the first place.</p>
<p>(5) &quot;True&quot; models</p>
<p>Even if one accepts that the statistical quantities in the Price equation are inferential in nature, the author appears to go a step further by asserting that, even in empirical populations, there is a specific &quot;true&quot; model which it is our goal to infer. This assumption manifests at many points in the SI when the author refers to the &quot;true model&quot; or &quot;true, underlying population structure&quot; in the context of an empirical population.</p>
<p>I do not think it is necessary or appropriate, in empirical contexts, to posit the existence of a Platonic &quot;true&quot; model that is generating the data. Real populations are not governed by mathematical models. Moreover, the goal of statistical inference is not to determine the &quot;true model&quot; for given data but to say whether a given statistical model is justified based on this data. Fitting a linear model, for example, does not rule out the possibility there may be higher-order interactions - it just means we do not have a statistical basis to infer these higher-order interactions from the data (say, because their p-scores are insignificant), and so we leave them out.</p>
<p>What we can say is that if we apply the statistical model to data generated by a probabilistic model, and if these models match, then as the number of observations grows to infinity, the estimators in the statistical model converge to the parameters of the data-generating one. But this is a mathematical statement, not a statement about real-world populations.</p>
<p>A resolution I suggest to points 3, 4, and 5 above is:</p>
<p>
*A priori, the statistical quantities in the Price Equation are descriptive statistics, pertaining only to the specific population data given.</p>
<p>
*If one wishes to impute any predictive power, generalizability, or causal meaning to these statistics, all the standard considerations of inferential statistics apply. In particular, one must choose a statistical model that is justified based on the given data. In this case, one is not guaranteed to obtain the standard (linear) Hamilton's rule and may obtain any of an infinite family of rules.</p>
<p>
*If one uses a model that is not justified based on the given data, the results will still be correct for the given population data but will lack any meaning or generalizability beyond that.</p>
<p>
*In particular, if one considers data generated by a probabilistic model, and applies a statistical model that does not match the data-generating one, the results will be misleading, and will not generalize beyond the randomly generated realization one uses.</p>
<p>Of course, the author may propose a different resolution to points 3-5, but they should be resolved somehow. Otherwise, the terminology in the manuscript will be incorrect and the ms will not resolve confusion in the field.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.105065.1.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>There is an interesting mathematical connection - an &quot;isomorphism&quot;-between Price's equation and least-squares linear regression. Some people have misinterpreted this connection as meaning that there is a generality-limiting assumption of linearity within Price's equation, and hence that Hamilton's rule-which is derived from Price's equation-provides only an approximation of the action of natural selection. This is in contrast to the majority view that Hamilton's rule is a fully general and exact result.</p>
<p>To briefly give some mathematical details: Price's equation defines the action of natural selection in relation to a trait of interest as the covariance between fitness w and the genetic breeding value g for the trait, i.e. cov(w,g); this is a fully general result that applies exactly to any arbitrary set of (g,w) data; without any loss of generality this covariance can be expressed as the product of genetic variance var(g) and a coefficient b(w,g), the coefficient simply being defined as b(w,g) = cov(w,g)/var(g) for all var(g) &gt; 0; it happens that if one fits a straight line to the same (g,w) data by means of least-squares regression then the slope of that line is equal to b(w,g).</p>
<p>All of this has already been discussed, repeatedly, in the literature.</p>
<p>Now turn to the present paper: the first sentence of the Abstract says &quot;The generality of Hamilton's rule is much debated&quot;, and then the next sentence says &quot;In this paper, I show that this debate can be resolved by constructing a general version of Hamilton's rule&quot;. But immediately it's clear that this isn't really resolving the debate, what this paper is actually doing is asserting the correctness of the minority view (i.e. that Hamilton's rule as it currently stands is not a general result) and then attempting to build a more general form of Hamilton's rule upon that shaky foundation. Predictably, the paper erroneously interprets the standard formulation of Hamilton's rule as a linear approximation and develops non-linear extensions to improve the goodness of fit for a result that is already exactly correct.</p>
<p>This is not a convincing contribution. It will not change minds or improve understanding of the topic.</p>
<p>Nor is it particularly novel. Smith et al (2010, &quot;A generalisation of Hamilton's rule for the evolution of microbial cooperation&quot; Science 328, 1700-1703) similarly interpreted Hamilton's rule as a linear model and provided a corresponding polynomial expansion - usefully fitting the model to microbial data so as to learn something about the costs and benefits of cooperation in an empirical setting. it's odd that this paper isn't cited here.</p>
</body>
</sub-article>
</article>