<?xml version="1.0" ?><!DOCTYPE article PUBLIC "-//NLM//DTD JATS (Z39.96) Journal Archiving and Interchange DTD v1.3 20210610//EN"  "JATS-archivearticle1-mathml3.dtd"><article xmlns:ali="http://www.niso.org/schemas/ali/1.0/" xmlns:xlink="http://www.w3.org/1999/xlink" article-type="research-article" dtd-version="1.3" xml:lang="en">
<front>
<journal-meta>
<journal-id journal-id-type="nlm-ta">elife</journal-id>
<journal-id journal-id-type="publisher-id">eLife</journal-id>
<journal-title-group>
<journal-title>eLife</journal-title>
</journal-title-group>
<issn publication-format="electronic" pub-type="epub">2050-084X</issn>
<publisher>
<publisher-name>eLife Sciences Publications, Ltd</publisher-name>
</publisher>
</journal-meta>
<article-meta>
<article-id pub-id-type="publisher-id">91512</article-id>
<article-id pub-id-type="doi">10.7554/eLife.91512</article-id>
<article-id pub-id-type="doi" specific-use="version">10.7554/eLife.91512.2</article-id>
<article-version-alternatives>
<article-version article-version-type="publication-state">reviewed preprint</article-version>
<article-version article-version-type="preprint-version">1.2</article-version>
</article-version-alternatives>
<article-categories>
<subj-group subj-group-type="heading">
<subject>Computational and Systems Biology</subject>
</subj-group>
</article-categories>
<title-group>
<article-title>H3-OPT: Accurate prediction of CDR-H3 loop structures of antibodies with deep learning</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Chen</surname>
<given-names>Hedi</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">#</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Fan</surname>
<given-names>Xiaoyu</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">#</xref>
</contrib>
<contrib contrib-type="author" equal-contrib="yes">
<name>
<surname>Zhu</surname>
<given-names>Shuqian</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="author-notes" rid="n1">#</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Pei</surname>
<given-names>Yuchan</given-names>
</name>
<xref ref-type="aff" rid="a2">2</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhang</surname>
<given-names>Xiaochun</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhang</surname>
<given-names>Xiaonan</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Liu</surname>
<given-names>Lihang</given-names>
</name>
<xref ref-type="aff" rid="a3">3</xref>
</contrib>
<contrib contrib-type="author" corresp="yes">
<name>
<surname>Qian</surname>
<given-names>Feng</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<contrib contrib-type="author">
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5830-0669</contrib-id>
<name>
<surname>Tian</surname>
<given-names>Boxue</given-names>
</name>
<xref ref-type="aff" rid="a1">1</xref>
<xref ref-type="corresp" rid="cor1">*</xref>
</contrib>
<aff id="a1"><label>1</label><institution>MOE Key Laboratory of Bioinformatics, State Key Laboratory of Molecular Oncology, School of Pharmaceutical Sciences, Tsinghua University</institution>, Beijing, 100084, <country>China</country></aff>
<aff id="a2"><label>2</label><institution>Tsinghua Institute of Multidisciplinary Biomedical Research, Tsinghua University</institution>, Beijing, 102206, <country>China</country></aff>
<aff id="a3"><label>3</label><institution>Department of Natural Language Processing</institution>, Baidu International Technology (Shenzhen) Co., <institution>Ltd</institution>, Shenzhen 518000, <country>China</country></aff>
</contrib-group>
<contrib-group content-type="section">
<contrib contrib-type="editor">
<name>
<surname>Dötsch</surname>
<given-names>Volker</given-names>
</name>
<role>Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Goethe University Frankfurt</institution>
</institution-wrap>
<city>Frankfurt am Main</city>
<country>Germany</country>
</aff>
</contrib>
<contrib contrib-type="senior_editor">
<name>
<surname>Dötsch</surname>
<given-names>Volker</given-names>
</name>
<role>Senior Editor</role>
<aff>
<institution-wrap>
<institution>Goethe University Frankfurt</institution>
</institution-wrap>
<city>Frankfurt am Main</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<author-notes>
<corresp id="cor1"><label>*</label>To whom correspondence should be addressed: Boxue Tian: <email>boxuetian@mail.tsinghua.edu.cn</email>, Feng Qian: <email>qianfeng@tsinghua.edu.cn</email></corresp>
<fn id="n1" fn-type="equal"><label>#</label><p>These authors contribute equally to this work.</p></fn>
</author-notes>
<pub-date date-type="original-publication" iso-8601-date="2023-10-18">
<day>18</day>
<month>10</month>
<year>2023</year>
</pub-date>
<pub-date date-type="update" iso-8601-date="2024-01-30">
<day>30</day>
<month>01</month>
<year>2024</year>
</pub-date>
<volume>12</volume>
<elocation-id>RP91512</elocation-id>
<history>
<date date-type="sent-for-review" iso-8601-date="2023-08-07">
<day>07</day>
<month>08</month>
<year>2023</year>
</date>
</history>
<pub-history>
<event>
<event-desc>Preprint posted</event-desc>
<date date-type="preprint" iso-8601-date="2023-08-21">
<day>21</day>
<month>08</month>
<year>2023</year>
</date>
<self-uri content-type="preprint" xlink:href="https://doi.org/10.1101/2023.08.19.553933"/>
</event>
<event>
<event-desc>Reviewed preprint v1</event-desc>
<date date-type="reviewed-preprint" iso-8601-date="2023-10-18">
<day>18</day>
<month>10</month>
<year>2023</year>
</date>
<self-uri content-type="reviewed-preprint" xlink:href="https://doi.org/10.7554/eLife.91512.1"/>
<self-uri content-type="editor-report" xlink:href="https://doi.org/10.7554/eLife.91512.1.sa3">eLife assessment</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.91512.1.sa2">Reviewer #1 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.91512.1.sa1">Reviewer #2 (Public Review):</self-uri>
<self-uri content-type="referee-report" xlink:href="https://doi.org/10.7554/eLife.91512.1.sa0">Reviewer #3 (Public Review):</self-uri>
</event>
</pub-history>
<permissions>
<copyright-statement>© 2023, Chen et al</copyright-statement>
<copyright-year>2023</copyright-year>
<copyright-holder>Chen et al</copyright-holder>
<ali:free_to_read/>
<license xlink:href="https://creativecommons.org/licenses/by/4.0/">
<ali:license_ref>https://creativecommons.org/licenses/by/4.0/</ali:license_ref>
<license-p>This article is distributed under the terms of the <ext-link ext-link-type="uri" xlink:href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution License</ext-link>, which permits unrestricted use and redistribution provided that the original author and source are credited.</license-p>
</license>
</permissions>
<self-uri content-type="pdf" xlink:href="elife-preprint-91512-v2.pdf"/>
<abstract>
<title>Abstract</title><p>Accurate prediction of the structurally diverse complementarity determining region heavy chain 3 (CDR-H3) loop structure remains a primary and long-standing challenge for antibody modeling. Here, we present the H3-OPT toolkit for predicting the 3D structures of monoclonal antibodies and nanobodies. H3-OPT combines the strengths of AlphaFold2 with a pre-trained protein language model, and provides a 2.24 Å average RMSD<sub>Cα</sub> between predicted and experimentally determined CDR-H3 loops, thus outperforming other current computational methods in our non-redundant high-quality dataset. The model was validated by experimentally solving three structures of anti-VEGF nanobodies predicted by H3-OPT. We examined the potential applications of H3-OPT through analyzing antibody surface properties and antibody-antigen interactions. This structural prediction tool can be used to optimize antibody-antigen binding, and to engineer therapeutic antibodies with biophysical properties for specialized drug administration route.</p>
</abstract>

</article-meta>
<notes>
<notes notes-type="competing-interest-statement">
<title>Competing Interest Statement</title><p>The authors have declared no competing interest.</p></notes>
<fn-group content-type="summary-of-updates">
<title>Summary of Updates:</title>
<fn fn-type="update"><p>We haved introduced a comparison with OmegaFold and incorporated statistics for some of the comparisons.We have also added brief descriptions of the scope of molecular dynamics calculations and methodological aspects of the experimental determination; Figure 2-5 and Extended data figure 3 revised;merge extended data figure 2 to Figure 3;Table 5 added.</p></fn>
</fn-group>
<fn-group content-type="external-links">
<fn fn-type="dataset"><p>
<ext-link ext-link-type="uri" xlink:href="https://github.com/chdcg/H3-OPT">https://github.com/chdcg/H3-OPT</ext-link>
</p></fn>
</fn-group>
</notes>
</front>
<body>
<sec id="s1">
<title>Introduction</title>
<p>Antibodies protect the host by recognizing and neutralizing foreign microbes or viruses and provide immunity against future infections. Furthermore, the use of therapeutic antibodies is steadily increasing in clinical treatments for infectious diseases, cancers, and autoimmune disorders<sup><xref ref-type="bibr" rid="c1">1</xref>,<xref ref-type="bibr" rid="c2">2</xref></sup>. For example, anti-PD-L1 antibodies block PD-L1/PD-1 interactions to inhibit tumor growth in patients<sup><xref ref-type="bibr" rid="c3">3</xref></sup>. A typical monoclonal antibody (mAb) is composed of heavy and light chains, while a nanobody (Nb) has only a single-domain variable heavy chain. The CDR heavy chain 3 (CDR-H3) loop is the most variable region in both length and amino acid sequence, and it plays a central role in antigen binding for both mAbs and Nbs. The development of effective therapeutic antibodies requires the solved structures of candidate antibodies, including the CDR-H3. However, it is both costly and labor intensive to experimentally obtain structures, and thus computationally predicted structures are often used to guide antibody design<sup><xref ref-type="bibr" rid="c4">4</xref></sup>. Despite major advances in computational methods, structure prediction for CDR-H3 loops remains challenging.</p>
<p>Traditional template-based modeling methods, such as RosettaAntibody<sup><xref ref-type="bibr" rid="c5">5</xref></sup>, PIGS<sup><xref ref-type="bibr" rid="c6">6</xref></sup>, ABodyBuilder<sup><xref ref-type="bibr" rid="c7">7</xref></sup>, and MODELLER<sup><xref ref-type="bibr" rid="c8">8</xref></sup>, often provide demonstrably inaccurate predictions for CDR-H3 sequences<sup><xref ref-type="bibr" rid="c9">9</xref>–<xref ref-type="bibr" rid="c11">11</xref></sup>, and as a result, alternative artificial intelligence (AI)-based approaches, such as AlphaFold2 (AF2)<sup><xref ref-type="bibr" rid="c12">12</xref></sup>, trRosetta<sup><xref ref-type="bibr" rid="c13">13</xref></sup> and RoseTTAFold<sup><xref ref-type="bibr" rid="c14">14</xref></sup>, are increasing in popularity. AF2 has shown comparable accuracy to experimentally determined structures by capturing physical and biological information about protein folding, thus providing a versatile deep learning framework for structure prediction. Structure prediction methods using pre-trained protein language models (PLMs), e.g., HelixFold-Single<sup><xref ref-type="bibr" rid="c15">15</xref></sup>, OmegaFold<sup><xref ref-type="bibr" rid="c16">16</xref></sup>, and ESMFold<sup><xref ref-type="bibr" rid="c17">17</xref></sup>, have shown comparable performance to AF2 with accelerated prediction speed. PLMs can be trained with datasets comprising tens of millions of unlabeled protein sequences in a self-supervised manner, and can be subsequently applied to a variety of downstream tasks, such as druggable protein target prediction<sup><xref ref-type="bibr" rid="c18">18</xref></sup>, predicting protein function, and protein design<sup><xref ref-type="bibr" rid="c19">19</xref>–<xref ref-type="bibr" rid="c21">21</xref></sup>. Antibody-specific tools such as IgFold<sup><xref ref-type="bibr" rid="c22">22</xref></sup>, tFold-Ab<sup><xref ref-type="bibr" rid="c23">23</xref></sup>, DeepAb<sup><xref ref-type="bibr" rid="c24">24</xref></sup> and NanoNet<sup><xref ref-type="bibr" rid="c25">25</xref></sup> have also been developed to improve accuracy in CDR-H3 prediction. Among them, IgFold leverages sequence representations from PLMs to efficiently predict antibody structures within seconds, and notably, IgFold can provide accuracy comparable to AF2, enabling high-throughput prediction of antibody structures.</p>
<p>In this study, we present H3-OPT, which combines features of AF2 and PLMs to predict antibody structures. We compare H3-OPT with several other antibody structure prediction methods and found that it can provide a lower average RMSD<sub>Cα</sub> for CDR-H3 loops than other algorithms in three subsets of varying difficulty. To further validate our model, we experimentally solved the structures of three anti-VEGF nanobodies predicted by H3-OPT<sup><xref ref-type="bibr" rid="c26">26</xref></sup>. We examined the potential applications of H3-OPT through analyzing antibody surface properties and antibody-antigen interactions. We demonstrate the informative value of high-quality H3 loops for predicting binding affinity, and further support the use of H3-OPT as a powerful and versatile tool for studying antigen-antibody interactions. This structural prediction tool can be used to optimize antibody-antigen binding, and to engineer therapeutic antibodies with biophysical properties.</p>
</sec>
<sec id="s2">
<title>Results</title>
<sec id="s2a">
<title>The H3-OPT workflow</title>
<p>Prior to training H3-OPT, we first conducted a thorough evaluation of currently available antibody structure prediction tools, including AF2, RoseTTAFold, trRosetta, NanoNet, DeepAb, MODELLER, and AbodyBuilder (Supplementary Section 1). AF2 provided high-accuracy predictions for the overall structures of both mAbs and Nbs, with template modeling scores (TM-scores) and global distance test scores (GDT scores) greater than 0.9. Based on the relatively higher accuracy of AF2 in structural predictions, its prediction was used to extract structural features of CDR-H3 loops for further optimization by H3-OPT. Using a mAb/Nb sequence and its Fv model structure from AF2 as input, H3-OPT was then used to generate a refined structure. As data quality has large effects on prediction accuracy, we constructed a non-redundant dataset (sequence identity &lt; 0.8) with 1286 high-resolution (&lt;2.5 Å) antibody structures from SAbDab<sup><xref ref-type="bibr" rid="c27">27</xref></sup> (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>). The dataset was then divided into training, validation, and test sets based on amino acid sequence identity, which was done by using the UCLUST<sup><xref ref-type="bibr" rid="c28">28</xref></sup> software. To assess the prediction results, the test set was split into 3 subgroups according to the differences in AF2 accuracy (RMSD, a measure of the difference between the predicted structure and an experimental or reference structure) stemming from the length of CDR-H3 sequence: easy-to-predict targets (0 - 2 Å, Sub1); moderate difficulty targets (2 - 4 Å, Sub2); and challenging-to-predict targets (&gt; 4 Å, Sub3), with average CDR-H3 loop sequence lengths of 9.12, 11.08, and 16.43, respectively.</p>
<fig id="fig1" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 1</label>
<caption><title>| H3-OPT architecture</title>
<p><bold>a,</bold> Schematic for dataset preparation. Structures were screened from the SAbDab database based on resolution and sequence identity. Clustering of the filtered, high-resolution structures yielded three datasets for training (n = 1021), validation (n = 134), and testing (n = 131). <bold>b,</bold> The workflow of H3-OPT includes two modules. The template module determines whether to use PSPM, while the PSPM module optimizes the AF2 input structures. <bold>c,</bold> The Template module retains AF2-predicted loops when the confidence score is greater than 0.8 and grafts CDR-H3 loops onto AF2 models for structures with an available template. <bold>d,</bold> In the PSPM, the network extracts residue-level information and pairwise residue representations from the AF2-predicted models, which are subsequently updated using weight-sharing blocks and concatenated with sequence representations from ESM2. The resulting data is used to predict the 3D coordinates of the H3 loops.</p></caption>
<graphic xlink:href="553933v2_fig1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>The workflow of H3-OPT is depicted in <xref rid="fig1" ref-type="fig">Fig. 1b</xref>. H3-OPT consists of a Template module and a PLM-based structure prediction module (PSPM). The Template module determines whether to use PSPM to optimize CDR-H3 and comprises two sub-modules: a confidence-based module (CBM) and a template-grafting module (TGM). The CBM calculates an AF2 confidence score to evaluate the reliability of CDR-H3 loop sequence inputs through MSA and template searching. The TGM then identifies a template from the H3 template database and grafts the CDR-H3 loop onto the AF2 model if such a template is available (<xref rid="fig1" ref-type="fig">Fig. 1c</xref>). The PSPM contains a series of attention-based components to ensure that the complete structural context is extracted from the input sequences. Specifically, the PSPM employs a row-wise gated attention layer that updates residue-level information and exchanges information within residue pair representations and residue features to infer relationships between the spatial and residue representations. Additionally, by leveraging sequence-level representations from PLMs along with residue-level information, the PSPM can integrate high-information features, such as protein folding patterns, across a vast protein space to predict final three-dimensional (3D) atomic coordinates (<xref rid="fig1" ref-type="fig">Fig. 1d</xref>).</p>
<p>To better understand the contribution of each module to H3-OPT accuracy with varying factors, we next examined how incorporating different approaches through the Template and PSPM modules could improve accuracy of H3-OPT. While AF2 showed markedly stronger predictions than IgFold in Sub1 (<xref rid="fig2" ref-type="fig">Fig. 2a</xref>), IgFold provided higher accuracy in Sub3 (<xref rid="fig3" ref-type="fig">Fig. 3a</xref>). In light of previous studies that showed PLM-based models are computationally more efficient but have unsatisfactory accuracy when high-resolution templates and MSA are available<sup><xref ref-type="bibr" rid="c17">17</xref></sup>, we therefore sought to combine the strengths of AF2 with PLM-based modeling. Similar to IgFold<sup><xref ref-type="bibr" rid="c22">22</xref></sup>, an initial version of H3-OPT lacking the CBM could not replicate the accuracy of AF2 in Sub1. Interestingly, we observed that AF2 confidence score of CDR-H3 shared a strong negative correlation with Cα-RMSDs (Pearson correlation coefficient =-0.67 (<xref rid="fig2" ref-type="fig">Fig. 2b</xref>), which led to us to hypothesize that AF2 models with high confidence scores might be sufficiently accurate, and therefore do not require further optimization. Following this notion, we incorporated a CBM sub-module that could directly retain high-confidence structures from AF2. TGM sub-module was added as a means of grafting identical H3 loop templates from public PDBs onto AF2-predicted models to further improve accuracy. Ablation studies in which the CBM or TGM were excluded to determine their respective contributions to the final predictive accuracy (<xref rid="fig2" ref-type="fig">Fig. 2c-f</xref>) revealed that H3-OPT without the Template Module could generate structures with average Cα-RMSDs of 1.76 Å, 2.76 Å, and 4.86 Å for the Sub1, Sub2, and Sub3 datasets, respectively. Incorporating only the CBM into our model significantly improved RMSD<sub>Cα</sub> score by 0.62 Å for Sub 1, but exerted negligible effects on Sub2 and Sub3. By contrast, including the TGM alone resulted in substantially improved RMSD<sub>Cα</sub> for Sub2 and Sub3 by 0.68 Å and 1.04 Å, respectively, suggesting that templates were more effective for relatively long CDR-H3 antibodies. These results suggested that the combination of TGM and CBM modules could leverage available templates to improve prediction accuracy.</p>
<fig id="fig2" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 2</label>
<caption><title>| Template module and ablation studies</title>
<p><bold>a,</bold> Side-by-side comparison of Cα-RMSDs of AF2 and IgFold for Sub1 (n = 52); color scale for data points reflects CDR3 length. AF2 outperformed IgFold for targets left of the dashed diagonal; IgFold outperformed AF2 for targets right of the dashed diagonal. <bold>b,</bold> Correlations between AF2 confidence score and amino acid sequence length of CDR-H3 loops. Datapoint color indicates Cα-RMSD value for that target. The correlation coefficient for confidence score and CDR-H3 loop length is −0.5921. <bold>c,</bold> The accuracy of H3-OPT in 3 subgroups of the test set. ΔCα-RMSDs were calculated by subtracting the RMSD<sub>Cα</sub> of AF2 from that of H3-OPT. AF2 had higher accuracy for targets above the dashed line; H3-OPT had better accuracy for structures below the dashed line. <bold>d,</bold> Differences in H3-OPT accuracy without the template module. This ablation study means only PSPM is used. <bold>e,</bold> Differences in H3-OPT accuracy without the CBM. This ablation study means input loop is optimized by TGM and PSPM. There are thirty targets in our database with identical CDR-H3 templates. <bold>f,</bold> Differences in H3-OPT accuracy without the TGM. This ablation study means input loop is optimized by CBM and PSPM.</p></caption>
<graphic xlink:href="553933v2_fig2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="fig3" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 3</label>
<caption><title>| PSPM module</title>
<p><bold>a,</bold> Side-by-side comparison of Cα-RMSDs for AF2 and IgFold, IgFold and H3-OPT in the Sub2 (n = 46) and Sub3 (n = 33) test sets, respectively. <bold>b</bold>, Comparison of prediction accuracy between AF2 and H3-OPT for Sub2 and Sub3 targets. Metrics including RMSDs, TM-scores, and GDT-scores were used to quantitatively assess similarity between predicted and experimental structures. <bold>c,</bold> Comparison of prediction accuracy between AF2 and H3-OPT using six metrics (RMSD<sub>Cα</sub>, RMSD<sub>backbone</sub>, RMSD<sub>sidechain</sub>, TM-score, GDT-TS score and GDT-HA score). Radar plots of the mean values of different methods and metrics in predictions of Sub2 and Sub3 targets.</p></caption>
<graphic xlink:href="553933v2_fig3.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>Since the large majority of sequences in Sub2 and Sub3 have long CDR-H3 loops with few sequence homologs, attaining high accuracy in structural predictions becomes increasingly challenging for AF2<sup><xref ref-type="bibr" rid="c29">29</xref></sup>. Inspired by IgFold and other PLM-based methods (<xref rid="fig3" ref-type="fig">Fig 3a</xref>), we thus developed a PSPM module to capture structural information from the sequence embeddings of PLMs<sup><xref ref-type="bibr" rid="c30">30</xref></sup>. The key innovations of the PSPM for our workflow were the integration of sequence-level representations from PLMs and the simplified architecture of AF2. ProtTrans-T5, AntiBERTy, and ESM2 were initially used without fine-tuning, resulting in overall average Cα-RMSDs of 2.40 Å, 2.49 Å, and 2.32 Å, respectively (<xref rid="tbl1" ref-type="table">Table 1</xref>). To improve accuracy, we employed a fine-tuning approach for the downstream CDR-H3 structure prediction task. As ESM2 outperformed other PLMs in our test set, we fine-tuned parameters of all ESM2 hidden layers, which resulted in an overall RMSD<sub>Cα</sub> of 2.24 Å for H3-OPT. It should be noted that most computational models, such as IgFold, froze PLM weights during model training<sup><xref ref-type="bibr" rid="c22">22</xref></sup>. Analysis of test subsets showed that H3-OPT could provide high accuracy in sidechain predictions, high template modeling scores (TM-scores), and high global distance test scores (GDT scores) in Sub2 and Sub3 (<xref rid="fig3" ref-type="fig">Fig. 3b-c</xref>).</p>
<table-wrap id="tbl1" orientation="portrait" position="float">
<label>Table 1.</label>
<caption><title>Performance of H3-OPT with different PLMs</title></caption>
<graphic xlink:href="553933v2_tbl1.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<p>To expand its generalizability, we simplified the Evoformer architecture and introduced parameter-sharing to directly predict Cartesian coordinates of CDR-H3 loops through both residue-level features and pair representations. In residue-level representations, rows represented amino acid types and structural features derived from AF2, while columns represented individual residues from the input sequence. The pair representations contained information about the residue pairs, such as Cα-Cα distance. These residue-level representations were updated by the attention-based layers and continuously communicated with pair representations; the pair representations were then updated via triangular multiplicative layers<sup><xref ref-type="bibr" rid="c29">29</xref></sup>. This simplified architecture improved model efficiency and avoided overfitting. We also applied a structural alignment strategy for feature extraction and model prediction. Given the high conservation of Fv structures, the alignment strategy was designed to effectively capture residue contribution to loop folding, resulting in improved training speed and accuracy. Taken together, H3-OPT provided high-accuracy predictions for CDR-H3 loops, facilitating the development of antibody therapeutics.</p>
</sec>
<sec id="s2b">
<title>H3-OPT provides higher accuracy CDR-H3 models than existing structure prediction software</title>
<p>We then evaluated the performance of H3-OPT against currently available methods, including AF2, IgFold, HelixFold-Single, ESMFold, and OmegaFold. H3-OPT achieved an average Cα root mean square deviation (RMSD<sub>Cα</sub>) of 2.24 Å for CDR-H3, while AF2 and IgFold had CDR-H3 RMSDs of 2.85 Å and 2.87 Å, respectively (<xref rid="fig4" ref-type="fig">Fig. 4a</xref>). HelixFold-Single, OmegaFold, and ESM-Fold generated comparatively poor predictions, with RMSDs for CDR-H3 of 3.39 Å, 3.75 Å, and 4.23 Å, respectively. As shown in <xref rid="fig4" ref-type="fig">Fig. 4b</xref>, H3-OPT provided higher accuracy predictions than other methods in all 3 subgroups, with average RMSDs of 1.10 Å, 2.28 Å and 3.99 Å, respectively. While the predictions of H3-OPT were comparable to AF2 in Sub1, its accuracy was higher than AF2 in Sub2 and Sub3.</p>
<fig id="fig4" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 4</label>
<caption><title>| Accuracy of CDR-H3 loop prediction by H3-OPT</title>
<p><bold>a,</bold> The performance of H3-OPT in the test set (n<sub>mAbs</sub> = 119, n<sub>Nbs</sub> = 12) relative to other methods. The RMSD<sub>Cα</sub> of H3-OPT was significantly lower than other existing methods (<italic>p</italic> &lt; 0.001). <bold>b</bold>, The performance of H3-OPT in structural predictions of 3 subgroups of the test set (n = 52, 46, and 33). <bold>c,</bold> H3-OPT structural predictions for three anti-VEGF nanobodies (PDB ID: 8IIU, 8IJZ, 8IJS).</p></caption>
<graphic xlink:href="553933v2_fig4.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>In light of these results, we then sought to validate H3-OPT using three experimentally determined structures of anti-VEGF nanobodies, including a wild-type (WT) and two mutant (Mut1 and Mut2) structures, that were recently deposited in Protein Data Bank (<xref rid="fig4" ref-type="fig">Fig. 4c</xref>). Although Mut1 (E45A) and Mut2 (Q14N) shared the same CDR-H3 sequences as WT, only minor variations were observed in the CDR-H3. H3-OPT generated accurate predictions with Cα-RMSDs of 1.510 Å, 1.541 Å and 1.411 Å for the WT, Mut1, and Mut2, respectively. Subsequent comparison with IgFold, showed that AlphaFold2 outperformed IgFold on these targets and IgFold could not accurately predict the short helix in CDR-H3, resulting in Cα-RMSDs of 2.776 Å (WT), 2.888 Å (Mut1), and 2.448 Å (Mut2) and more diverse conformations of Mut1 and Mut2. These results indicated that IgFold was capable of learning long-range correlations in protein sequences, but that these long-range correlations could introduce larger errors when MSA and templates were available. These results thus demonstrated that MSA could strongly influence the accuracy for which similar CDR-H3 template structures were available.</p>
</sec>
<sec id="s2c">
<title>H3-OPT can predict antibody surface properties</title>
<p>To demonstrate how improved CDR-H3 structural accuracy can assist antibody engineering, we applied H3-OPT to predict surface properties. Comparison of H3-OPT with AF2 for identifying surface amino acids (SAAs) by the relative accessible surface areas (rASAs) of CDR-H3 loops showed that H3-OPT could predict SAAs, on average, close to that of the native structures (9.46 vs 9.40, <xref rid="fig5" ref-type="fig">Fig. 5a</xref>), whereas AF2 predicted an average of 9.81 SAAs. Furthermore, H3-OPT predicted closer values to native structures than AF2 in predicting diverse surface properties, such as the distribution of hydrophilic or charged SAAs (<xref rid="fig5" ref-type="fig">Fig. 5b</xref>).</p>
<fig id="fig5" position="float" orientation="portrait" fig-type="figure">
<label>Fig. 5</label>
<caption><title>| Analysis of surface patches</title>
<p><bold>a,</bold> Analysis of surface amino acids for predicted H3 loops. Y-axis represents average number of surface residues for H3 loops (n = 131). <bold>b,</bold> Histogram of surface patches with different properties predicted by H3-OPT, AF2, or experimentally solved H3 loops. Error bars show standard deviations. <bold>c,</bold> Solvent-accessible surface area (SASA) analysis of predicted H3 loops. Values represent the difference in SASA between predicted and experimentally determined H3 structures using AF2 or H3-OPT. <bold>d,</bold> Comparison of the charged surface patches between H3-OPT and AF2 for target PDBID: 5U3P. The surface maps compare the surface electrostatic potential of the CDR-H3 loop predicted by H3-OPT or AF2 with the native structure. Darker shading indicates greater difference in electrostatic potential.</p></caption>
<graphic xlink:href="553933v2_fig5.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<p>To examine insights H3-OPT could provide into the biophysical properties of antibodies<sup><xref ref-type="bibr" rid="c31">31</xref></sup>, we next estimated the solvent-accessible surface areas (SASAs). The average SASAs of H3-OPT loops closely resembled that of the native structures, with larger differences in AF2 predictions (<xref rid="fig5" ref-type="fig">Fig. 5c</xref>). Plots of SASA distributions at each alignment position revealed smaller errors in H3-OPT than AF2, with ΔSASA ranging from −12.17 to 9.74 Å<sup>2</sup> (<xref rid="figs1" ref-type="fig">Extended Data Fig. 1</xref>). In addition, comparison of surface charge distributions on the predicted CDR-H3 loops generated by H3-OPT and AF2 in an electrostatic map of a representative structure (PDB 5U3P, <xref rid="fig5" ref-type="fig">Fig. 5d</xref>) showed that H3-OPT predictions were consistent with the experimental structure. These results collectively showed that accurate surface properties predicted by H3-OPT could provide insights into antibody folding and stability, as well as their interactions with antigens.</p>
</sec>
<sec id="s2d">
<title>H3-OPT can facilitate investigation of antibody-antigen interactions</title>
<p>To explore the potential applications of H3-OPT in studying antibody-antigen interactions, we analyzed contact patterns at predicted binding sites. Given that predicting the structure of an antibody-antigen complex remains challenging, we superimposed V<sub>H</sub> fragments from H3-OPT and AF2 onto experimentally determined native complex structures available in our test set. After identifying the contact residues of antigens by H3-OPT, we found that H3-OPT could substantially outperform AF2 (<xref rid="fig6" ref-type="fig">Fig. 6a</xref>), with a median precision of 0.83 and accuracy of 0.97 compared to 0.64 precision and 0.95 accuracy of AF2. Next, we estimated the distances among interface residues, which are related to binding affinity at the interface. We found that H3-OPT had less error in distance metrics than predictions by AF2 across different distance thresholds, with average mean squared errors of 5.61 Å and 7.08 Å, respectively (<xref rid="fig6" ref-type="fig">Fig. 6b</xref>). Furthermore, calculation of H3 contact propensities to assess potential differences in binding patterns between the predicted and native structures using high-quality H3 conformations indicated that H3-OPT also displayed higher accuracy in predicting contact propensities (<xref rid="fig6" ref-type="fig">Fig. 6c</xref>).Finally, to test whether H3-OPT was reliable for investigation of the detailed mechanisms underlying antigen-antibody binding, we generated contact maps and calculated binding affinities for complex structures obtained by H3-OPT, AF2, or through experiments (see Methods for details). We found that contact maps predicted by H3-OPT were consistent with those observed in the experimental structures (<xref rid="fig6" ref-type="fig">Fig. 6d</xref>). Since affinity prediction plays a crucial role in antibody therapeutics engineering, we performed MD simulations to compare the differences in binding affinities between AF2-predicted complexes and H3-OPT-predicted complexes. Calculation of binding affinities through MD simulations showed that the average affinities of structures obtained by H3-OPT prediction were closer to those of experimentally determined structures than values obtained through AF2 (<xref rid="tbl2" ref-type="table">Table 2</xref>). These cumulative findings illustrate the informative value of high-quality H3 loops for predicting binding affinity and facilitating antibody engineering, and further support the use of H3-OPT as a powerful and versatile tool for investigating antigen-antibody interactions.</p>
<table-wrap id="tbl2" orientation="portrait" position="float">
<label>Table 2.</label>
<caption><title>Comparison of binding affinities obtained from MD simulations using AF2 and H3-OPT</title></caption>
<graphic xlink:href="553933v2_tbl2.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<fig id="fig6" position="float" orientation="portrait" fig-type="figure">
<label>Fig.6</label>
<caption><title>| Accuracy of H3-OPT predictions of antibody-antigen interactions</title>
<p><bold>a,</bold> Performance of H3-OPT in binding site prediction. comparison of prediction accuracy between H3-OPT and AF2 for antibody-antigen binding sites (n = 27). Box represents interquartile range (IQR); horizontal line in the center of the box shows median. <bold>b,</bold> Comparison of the mean squared errors of residue pairs between H3-OPT and AF2 under different distance thresholds. The x-axis represents the experimentally determined distance between pairs of contacting residues at the binding site in the native structure. Y-axis shows mean squared errors of H3-OPT and AF2. <bold>c,</bold> Heatmaps of the frequency of pairwise residue-residue contacts across antibody-antigen interfaces. This analysis compares contact frequency of H3 loops predicted by AF2 or H3-OPT with the native structure. Darker shading indicates greater difference in contact frequency. <bold>d,</bold> The predicted H3 loops of two targets interacting with antigens (PDB: 2YC1, 6O9H). The epitopes are highlighted in red and antibody chains are green. H3-OPT could identify the epitopes of different antigens that form the complementary binding interface(s) for the CDR-H3 of antibodies.</p></caption>
<graphic xlink:href="553933v2_fig6.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</sec>
<sec id="s3">
<title>Discussion</title>
<p>Several platforms for in silico antibody engineering have been developed to improve binding affinity<sup><xref ref-type="bibr" rid="c32">32</xref>–<xref ref-type="bibr" rid="c35">35</xref></sup>, humanization<sup><xref ref-type="bibr" rid="c36">36</xref>,<xref ref-type="bibr" rid="c37">37</xref></sup> and stability<sup><xref ref-type="bibr" rid="c38">38</xref>,<xref ref-type="bibr" rid="c39">39</xref></sup>. At present, engineering these biophysical properties of therapeutic antibodies heavily relies on the availability of the structures of thousands of antibodies. The accurate structure of CDR-H3 is crucial for understanding the mechanism(s) of antigen-antibody interactions. Although AF2 performs well when MSA and templates are available, its predictive capability decreases for targets with long CDR-H3 loops. By contrast, PLMs leverage tens of millions of protein sequences to learn relevant structural patterns, consequently enhancing their capacity to predict orphan antibodies<sup><xref ref-type="bibr" rid="c40">40</xref></sup>. The results of IgFold indicate that PLMs, which incorporate transformer-based attention mechanisms, are capable of learning both local and global sequence information<sup><xref ref-type="bibr" rid="c22">22</xref></sup>. While global information can be useful for challenging targets, it may lead to large errors when templates were available, as demonstrated by our case study of anti-VEGF nanobodies (<xref rid="fig4" ref-type="fig">Fig. 4</xref>).</p>
<p>H3-OPT combines the strengths of AF2 and PLMs to predict the structures of mAbs and Nbs, and our results show that combining these features can improve the average RMSD<sub>Cα</sub> by 20% over that of AF2 or IgFold. However, H3-OPT is less efficient than PLM-based methods like IgFold because it relies on AF2 structures. To improve efficiency, one possible solution is to cluster the targets based on sequence identity and compute AF2 structures for each cluster, followed by generation of mutant structures. Despite the lower efficiency, H3-OPT offers several notable advantages over IgFold. First, H3-OPT incorporates a simplified version of Evoformer, which improves training efficiency. In addition, H3-OPT employs an alignment-based strategy to extract structural features that are then used to directly predict the Cα coordinates of H3 loops, effectively capturing the residue features relevant to loop folding. Moreover, we found that IgFold uses an augmented dataset containing AF2-predicted structures, which could potentially propagate errors during model training. In contrast, H3-OPT was trained by using high-quality and non-redundant antibody structures. Finally, H3-OPT also shows lower Cα-RMSDs compared to AF2 or tFold-Ab for the majority (six of seven) of targets in an expanded benchmark dataset, including all antibody structures from CAMEO 2022 (Extended Data Fig.2).</p>
<p>Although H3-OPT can provide high accuracy with a small training dataset, it is likely that a larger dataset containing high-resolution structures will further improve our model. In the current study, we observed that the accuracy of AF2 CDR-H3 predictions was correlated with the length of the H3 loop. Thus, AF2 can provide accurate predictions for short loops with fewer than 10 amino acids, with PLM-based models offering little or no improvement in such cases. Conversely, antibodies with H3 loop lengths exceeding 25 residues (common in Sub3) pose a long-standing challenge for structural prediction algorithms, and none of the existing methods (including H3-OPT) tested here could provide accurate predictions due to a lack of homologous sequences and a high degree of freedom in this subgroup. Notably, H3-OPT outperformed AF2 in Sub3 because the context of protein sequences learned from ESM2 was fine-tuned to fit antibody structures. Furthermore, we envision that antibodies with H3 loop lengths ranging from 10 to 25 amino acids could be further optimized using PLMs with more model parameters. In addition, we attempted to optimize the H3 loop structure through molecular dynamics simulations and quantum mechanics-based methods (Supplementary Section 2). However, these approaches generally yielded less accurate predictions than AF2 due to inaccurately described solvent effects and other environmental factors. The development of a more accurate, physics-based method for modeling long loops may be another potentially effective strategy for improving H3-OPT.</p>
<p>Deep generative models are playing a vital role in the field of protein design, leading to several successful applications<sup><xref ref-type="bibr" rid="c41">41</xref>–<xref ref-type="bibr" rid="c46">46</xref></sup>. These models capture the intricate relationship between sequences and structures, enabling the generation of novel protein scaffolds not existing in nature. However, the potential immunogenicity concerns associated with these newly designed proteins require comprehensive preclinical and clinical investigations. Consequently, conventional mAbs and Nbs remain the prevailing choices in medicine. Recognizing that the properties of antibodies are heavily influenced by their structures, accurate prediction of the structures of mAbs and Nbs is of great significance in optimizing their therapeutic effectiveness and clinical relevance. To this end, H3-OPT has strong potential to accelerate optimization of antibody-antigen binding as well as engineering of therapeutic antibodies with specialized biophysical properties.</p>
</sec>
<sec id="s4">
<title>Method</title>
<sec id="s4a">
<title>H3-OPT dataset</title>
<p>Crystal structures of antibodies were obtained from SAbDab, a non-redundant nanobody database<sup><xref ref-type="bibr" rid="c47">47</xref></sup> and a subset of DeepAb. The structures with resolution greater than 2.5 Å or redundant sequences with 95% or greater identity were removed (<xref rid="fig1" ref-type="fig">Fig. 1a</xref>). We removed the structures with missing loops in CDR-H3 or lengths greater than 45. The structures with missing residues at CDR-H3 loops were also dropped. To enhance the generalizability of H3-OPT, the sequences were clustered based on a 90% similarity cutoff by using UCLUST<sup><xref ref-type="bibr" rid="c28">28</xref></sup>. The resulting clusters were then randomly divided into training, validating, and testing sets to avoid overestimation of performance. The number of sequences in training, validating and testing sets was 1021(925 mAbs, 96 Nbs), 134 (122 mAbs, 12Nbs) and 131 (119 mAbs, 12 Nbs), respectively, with average CDR-H3 loop length of 11.8, 11.9 and 11.7, respectively. Schrödinger v. 2017-2 (Schrödinger, New York, NY, USA), Numpy 1.18.5 and Pandas 1.0.5 was used for data preparation.</p>
</sec>
<sec id="s4b">
<title>Structure preparation</title>
<p>To address the transformational invariance for predicting 3D coordinates, we applied a structural alignment strategy. Prior to feature extraction, we removed all atoms of light chains in mAbs Fv structures and any non-standard residues in native structures. All antibody V<sub>H</sub> native structures were aligned using StructAlign module in Schrödinger with a randomly selected reference structure (PDBID: 1GIG). Next, we superimposed AF2 predicted models to their corresponding native structures. This alignment allowed the model to learn the interactions between residues located in H3 loops while disregarding the rotation and translation of the entire structure. The heavy chain fragments were determined using Chothia definitions<sup><xref ref-type="bibr" rid="c48">48</xref></sup>.</p>
</sec>
<sec id="s4c">
<title>Feature generation</title>
<p>As shown in <xref rid="tbl3" ref-type="table">Table 3</xref>, structural features were extracted and aggregated into the following inputs to PSPM of H3-OPT: A residue feature vector of size [N<sub>res</sub>, 34] was constructed by concatenating “Amino acid type”, “AF2 predicted coordinates”, “AF2 predicted backbone torsion angles”, “Torsion angles mask” and “Predicted residue mask”. The pairwise feature vector of size [N<sub>res</sub>, N<sub>res</sub>, 60] included the “Pairwise distances” and “Pairwise amino acid type”.</p>
<table-wrap id="tbl3" orientation="portrait" position="float">
<label>Table 3.</label>
<caption><title>Features to the model. N<sub>res</sub> is the number of residues.<sup><xref ref-type="bibr" rid="c29">29</xref></sup></title></caption>
<graphic xlink:href="553933v2_tbl3.tif" mimetype="image" mime-subtype="tiff"/>
<graphic xlink:href="553933v2_tbl3a.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s4d">
<title>Network architecture</title>
<p>H3-OPT took the predicted H3 loops of AF2 as input and generate the antibody structure with the optimized CDR-H3 loops as output. H3-OPT was composed of a Template module and a PSPM. The Template module contains two submodules, i.e., CBM and TGM. The CBM calculated the average confidence score of H3 residues and retained AF2 structures with confidence score greater than 0.8. The TGM grafted the template loop structure onto the input AF2 model, when their CDR-H3 sequences were identical. We replaced the predicted CDR-H3 loop generated by AF2 with the template loop by aligning corresponding atoms, which included Cα atoms and carbonyl carbon atoms in the first two residues and Cα atoms and backbone nitrogen atoms in the last two residues.</p>
<p>The input residue-level features are extracted from AF2 predicted structures as mentioned above, resulting in a dimension of <italic>L</italic> × 34, where L is the padding length of antibody heavy chain. Similarly, the pairwise features has a dimension of <italic>L</italic> × <italic>L</italic> × 60. The PSPM network began with a row-wise gated multi-head self-attention layer which updated residue-level features from pair representations. After that, the residue-level information updated the pair representations via outer product mean module. Pair representations were updated by two multiplicative update modules. During training, the weights of the attention layer and the triangle multiplicative update modules were updated 4 times per epoch. Then, the final hidden states from ESM2 (esm2_t33_650M_UR50D) were passed to a linear layer and then concatenated with the residue-level features to enable the learning of latent information from vast protein sequences. To predict all Cα coordinates for the CDR-H3 loop, the output vector was passed through three linear layers with a hidden size of 64. In summary, PSPM utilized an attention-based mechanism to learn the contribution of individual residues and incorporate sequence representations from PLMs into final predictions. We used OpenFold<sup><xref ref-type="bibr" rid="c49">49</xref></sup> (based on GitHub from June 2022: commit 3f57b4a041f063406059f42080ede6d495479617) to implement partial networks of AF2.</p>
<p>We employed a fine-tuning strategy to update the sequence representations in ESM2. Initially, we froze all weights of the 33 representation layers in ESM2 and updated only the weights of the attention layers and pair representation update modules. Subsequently, we fixed all weights of the remaining components in H3-OPT and performed fine-tuning exclusively on all hidden layers of ESM2 for the H3 loop prediction task. Finally, we fine-tuned all parameters of H3-OPT to predict the atomic coordinates of all CDR-H3 Cα atoms.</p>
<p>During training, we trained our model on the training set and validated it on the validation set. The dropout rates of H3-OPT were set to 0.25. Mean squared error (MSE) loss was utilized to train the model. We used Adam optimizer with a learning rate of 1LJ×LJ10<sup>−4</sup>, weight decay of 5LJ×LJ10<sup>−4</sup> for training. The model was trained on an NVIDIA V100 super GPU and took one hour per epoch over the entire training set with a batch size of 64. We randomly selected 10% of all structures for model validation. The H3-OPT was implemented using PyTorch 1.12.1 in Python 3.7.2. The hyperparameters used during training process for H3-OPT were presented in <xref rid="tbl4" ref-type="table">Table 4</xref>.</p>
<table-wrap id="tbl4" orientation="portrait" position="float">
<label>Table 4.</label>
<caption><title>Hyperparameters for H3-OPT models</title></caption>
<graphic xlink:href="553933v2_tbl4.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
<table-wrap id="tbl5" orientation="portrait" position="float">
<label>Table 5.</label>
<caption><title>Average Cα-RMSDs of our test set under different confidence cutoffs</title></caption>
<graphic xlink:href="553933v2_tbl5.tif" mimetype="image" mime-subtype="tiff"/>
</table-wrap>
</sec>
<sec id="s4e">
<title>Structure generation and refinement</title>
<p>We utilized a structure refinement strategy to generate structures of CDR-H3 loops and rectify structural errors. Initially, we used PSPM predictions to modify the Cα coordinates of predicted CDR-H3 loops generated by AF2. Then, we minimized the remaining atoms of the CDR-H3 loops, while keeping their Cα coordinates fixed, by using the OPLS 2005 force field<sup><xref ref-type="bibr" rid="c50">50</xref></sup>. After the initial energy minimization step, we applied a force constant of 10 kcal/mol to these fixed atoms to guarantee complete relaxation of the entire loops.</p>
</sec>
<sec id="s4f">
<title>Validation settings</title>
<p>H3-OPT, AF2, HelixFold-Single, IgFold and ESMFold were compared on the test subset. Given that tFold-Ab is only available on webserver, we compared H3-OPT with tFold-Ab on CAMEO 2022 dataset. We removed the target antibody structures from AF2 database before prediction to evaluate the performance of AF2. This ensured that the predictions depended solely on the information derived from other template structures, thus avoiding biased results. Since all other methods did not require MSA searching, we did not exclude these targets from their database. To predict the entire Fv structures, we included 50 glycine residues as a linker between the heavy chain and the light chain for antibodies<sup><xref ref-type="bibr" rid="c51">51</xref></sup>. The Cα-RMSDs of all predicted H3 loops were calculated after superimposing the V<sub>H</sub> backbone heavy atoms (without CDR-H3) to the reference structures. All structures were generated using publicly available code repositories: AF2 v2.1.1(based on GitHub the November 2021 version at GitHub: commit 91b43223422420d1783ed802c8b3a8382a9309fd), IgFold (based on GitHub from February 2023: commit 6a09298d165ed1deb438c0b6eefcbcb03ed0eca5), HelixFold-Single (based on GitHub from January 2023: commit 5f39b2c2a4ecc00b89ba05b95dc56212bdd5d886) and ESMFold v1 (based on GitHub from October 2022: commit dc823b89c6acb9f67caea53704c2a97524fbd456).</p>
</sec>
<sec id="s4g">
<title>Analysis of SASAs and pairwise residue contacts</title>
<p>We computed the SASAs and rASAs of all CDR-H3 loops by using the ANARCI webserver<sup><xref ref-type="bibr" rid="c52">52</xref></sup> with the default settings. Residue with an rASA greater than 25% was considered surface residues<sup><xref ref-type="bibr" rid="c53">53</xref></sup>. Subsequently, we applied AHo alignment software<sup><xref ref-type="bibr" rid="c54">54</xref></sup> to report the averaged SASA per alignment position. The samples and alignment positions with more than 10 gaps were removed to avoid randomness and bias, reducing the final samples to 123. Finally, the difference in SASAs between H3-OPT and AF2 was calculated by subtracting predicted H3 loops SASAs from the ground truth.</p>
<p>To examine the contribution of H3-OPT in discovering antibody-antigen interactions, we identified contact residue pairs that were within this distance as binding sites by setting a threshold of 5 Å. We next calculated the pairwise residue distance matrices for each individual predicted complex and native structure, where each element represented the closest distance between the heavy atoms of two residues. From these pairwise distances, we derived contact propensity matrices that specifically indicated the presence or absence of interactions between residues.</p>
</sec>
<sec id="s4h">
<title>Analysis of surface electrostatic potential</title>
<p>We generated two-dimensional projections of CDR-H3 loop’s surface electrostatic potential using SURFMAP<sup><xref ref-type="bibr" rid="c55">55</xref></sup> v2.0.0 (based on GitHub from February 2023: commit: e0d51a10debc96775468912ccd8de01e239d1900) with default parameters. The 2D surface maps were calculated by subtracting the surface projection of H3-OPT or AF2 predicted H3 loops to their native structures.</p>
</sec>
<sec id="s4i">
<title>Binding affinity calculation</title>
<p>We analyzed the binding affinities of antibody-antigen complexes predicted by AF2 and H3-OPT. Their relative binding affinities were calculated through molecular dynamics simulations. Initially, the missing side-chains and loops in the antibody structures were filled using the Protein Preparation Wizard module within Schrödinger software. Subsequently, the tLEaP module of AMBER<sup><xref ref-type="bibr" rid="c56">56</xref></sup> was employed to construct the simulation system with the ff19SB force field<sup><xref ref-type="bibr" rid="c57">57</xref></sup> and OPC solvent model<sup><xref ref-type="bibr" rid="c58">58</xref></sup>. Additionally, the simulation system was solvated with a 0.15 M NaCl solution. Energy minimization was performed through a 5000-step steepest descent algorithm, followed by a 5000-step conjugate gradient algorithm. Afterwards, a 25000-step NVT simulation with a time step of 1 fs was performed to gradually heat the system from 0 K to 100 K. A 250000-step NPT simulation with a time step of 2 fs was carried out to further heat the system from 100 K to 298 K. In the production run, 100-ns MD simulations were performed with a time step of 2 fs. The distance cutoff for nonbonded interactions was set to 10 Å, and the Berendsen algorithm was utilized to maintain isotropic pressure coupling at 1 bar. The Langevin algorithm was employed to maintain the simulation temperature at 298 K. The relative binding affinities of the antigen-antibody complexes were evaluated using the MMPBSA module of AMBER software, which computed the MM/GBSA energies for the trajectory frames of last 10 ns.</p>
</sec>
<sec id="s4j">
<title>Crystallization and data collection</title>
<p>The protein expression, purification and crystallization experiments were described previously<sup><xref ref-type="bibr" rid="c26">26</xref>,<xref ref-type="bibr" rid="c59">59</xref></sup>. The proteins used in the crystallization experiments were unlabeled. Upon thawing the frozen protein on ice, we performed a centrifugation step to eliminate any potential crystal nucleus and precipitants. Subsequently, we mixed the protein at a 1:1 ratio with commercial crystal condition kits using the sitting-drop vapor diffusion method facilitated by the Protein Crystallization Screening System (TTP LabTech, mosquito). After several days of optimization, single crystals were successfully cultivated at 21°C and promptly flash-frozen in liquid nitrogen. The diffraction data from various crystals were collected at the Shanghai Synchrotron Research Facility and subsequently processed using the aquarium pipeline.<sup><xref ref-type="bibr" rid="c60">60</xref></sup></p>
</sec>
<sec id="s4k">
<title>Statistics analysis</title>
<p>We conducted two-sided t-test analyses to assess the statistical significance of differences between the various groups. Statistical significance was considered when the p-values were less than 0.05. These statistical analyses were carried out using Python 3.10 with the Scipy library (version 1.10.1).</p>
</sec>
</sec>
<sec id="s5">
<title>Data and code availability</title>
<p>The datasets of our study and the codes of H3-OPT are freely available at <ext-link ext-link-type="uri" xlink:href="https://github.com/chdcg/H3-OPT">https://github.com/chdcg/H3-OPT</ext-link>.</p>
</sec>
<sec id="d1e1045" sec-type="supplementary-material">
<title>Supporting information</title>
<supplementary-material id="d1e1177">
<label>Supplemental information</label>
<media xlink:href="supplements/553933_file09.docx"/>
</supplementary-material>
</sec>
</body>
<back>
<ack>
<title>Acknowledgments</title>
<p>This work was supported by the Tsinghua University Initiative Scientific Research Program (No.20221080048, No.20231080030), the Tsinghua-Peking University Center for Life Sciences (No.20111770319), Tsinghua University - Peking Union Medical College and Hospital Collaboration Foundation (No. 20191080837).</p>
</ack>
<sec id="s6">
<title>Author contributions</title>
<p>H.C. and B.T. conceptualized the project. H.C. and X.F. developed the methodology. S.Z. solved crystal structures. H.C. and L.L. performed structural modeling. H.C. wrote the original paper. Q.F., X.Z., and B.T. edited the paper.</p>
</sec>
<sec id="s7">
<title>Competing interests</title>
<p>The authors declare no competing interests.</p>
</sec>
<ref-list>
<title>Reference</title>
<ref id="c1"><label>1</label><mixed-citation publication-type="journal"><string-name><surname>Meganck</surname>, <given-names>R. M.</given-names></string-name> &amp; <string-name><surname>Baric</surname>, <given-names>R. S</given-names></string-name>. <article-title>Developing therapeutic approaches for twenty-first-century emerging infectious viral diseases</article-title>. <source>Nature Medicine</source> <volume>27</volume>, <fpage>401</fpage>–<lpage>410</lpage> (<year>2021</year>). <pub-id pub-id-type="doi">10.1038/s41591-021-01282-0</pub-id></mixed-citation></ref>
<ref id="c2"><label>2</label><mixed-citation publication-type="journal"><string-name><surname>Kaplon</surname>, <given-names>H.</given-names></string-name> &amp; <string-name><surname>Reichert</surname>, <given-names>J. M</given-names></string-name>. <article-title>Antibodies to watch in 2021</article-title>. <source>MAbs</source> <volume>13</volume>, <fpage>1860476</fpage> (<year>2021</year>). <pub-id pub-id-type="doi">10.1080/19420862.2020.1860476</pub-id></mixed-citation></ref>
<ref id="c3"><label>3</label><mixed-citation publication-type="journal"><string-name><surname>Brahmer</surname>, <given-names>J. R.</given-names></string-name> <etal>et al.</etal> <article-title>Safety and activity of anti-PD-L1 antibody in patients with advanced cancer</article-title>. <source>The New England Journal of Medicine</source> <volume>366</volume>, <fpage>2455</fpage>–<lpage>2465</lpage> (<year>2012</year>). <pub-id pub-id-type="doi">10.1056/NEJMoa1200694</pub-id></mixed-citation></ref>
<ref id="c4"><label>4</label><mixed-citation publication-type="journal"><string-name><surname>Aguilar Rangel</surname>, <given-names>M.</given-names></string-name>, <etal>et al.</etal> <article-title>Fragment-based computational design of antibodies targeting structured epitopes</article-title>. <source>Science Advances</source> <volume>8</volume>, <fpage>eabp9540</fpage> (<year>2022</year>). <pub-id pub-id-type="doi">10.1126/sciadv.abp9540</pub-id></mixed-citation></ref>
<ref id="c5"><label>5</label><mixed-citation publication-type="journal"><string-name><surname>Adolf-Bryfogle</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>RosettaAntibodyDesign (RAbD): A general framework for computational antibody design</article-title>. <source>Plos Comput Biol</source> <volume>14</volume>, <fpage>e1006112</fpage> (<year>2018</year>). <pub-id pub-id-type="doi">10.1371/journal.pcbi.1006112</pub-id></mixed-citation></ref>
<ref id="c6"><label>6</label><mixed-citation publication-type="journal"><string-name><surname>Marcatili</surname>, <given-names>P.</given-names></string-name>, <string-name><surname>Rosi</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Tramontano</surname>, <given-names>A</given-names></string-name>. <article-title>PIGS: automatic prediction of antibody structures</article-title>. <source>Bioinformatics</source> <volume>24</volume>, <fpage>1953</fpage>–<lpage>1954</lpage> (<year>2008</year>). <pub-id pub-id-type="doi">10.1093/bioinformatics/btn341</pub-id></mixed-citation></ref>
<ref id="c7"><label>7</label><mixed-citation publication-type="journal"><string-name><surname>Leem</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Dunbar</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Georges</surname>, <given-names>G.</given-names></string-name>, <string-name><surname>Shi</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Deane</surname>, <given-names>C. M</given-names></string-name>. <article-title>ABodyBuilder: Automated antibody structure prediction with data–driven accuracy estimation</article-title>. <source>mAbs</source> <volume>8</volume>, <fpage>1259</fpage>–<lpage>1268</lpage> (<year>2016</year>). <pub-id pub-id-type="doi">10.1080/19420862.2016.1205773</pub-id></mixed-citation></ref>
<ref id="c8"><label>8</label><mixed-citation publication-type="journal"><string-name><surname>Eswar</surname>, <given-names>N.</given-names></string-name> <etal>et al.</etal> <article-title>Comparative Protein Structure Modeling Using Modeller</article-title>. <source>Current Protocols in Bioinformatics</source> <volume>15</volume>, <fpage>5.6.1</fpage>–<lpage>5.6.30</lpage> (<year>2006</year>). <pub-id pub-id-type="doi">10.1002/0471250953.bi0506s15</pub-id></mixed-citation></ref>
<ref id="c9"><label>9</label><mixed-citation publication-type="journal"><string-name><surname>Almagro</surname>, <given-names>J. C.</given-names></string-name> <etal>et al.</etal> <article-title>Second antibody modeling assessment (AMA-II)</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source> <volume>82</volume>, <fpage>1553</fpage>–<lpage>1562</lpage> (<year>2014</year>). <pub-id pub-id-type="doi">10.1002/prot.24567</pub-id></mixed-citation></ref>
<ref id="c10"><label>10</label><mixed-citation publication-type="journal"><string-name><surname>Teplyakov</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Antibody modeling assessment II. Structures and models</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source> <volume>82</volume>, <fpage>1563</fpage>–<lpage>1582</lpage> (<year>2014</year>). <pub-id pub-id-type="doi">10.1002/prot.24554</pub-id></mixed-citation></ref>
<ref id="c11"><label>11</label><mixed-citation publication-type="journal"><string-name><surname>Almagro</surname>, <given-names>J. C.</given-names></string-name> <etal>et al.</etal> <article-title>Antibody modeling assessment</article-title>. <source>Proteins: Structure, Function, and Bioinformatics</source> <volume>79</volume>, <fpage>3050</fpage>–<lpage>3066</lpage> (<year>2011</year>). <pub-id pub-id-type="doi">10.1002/prot.23130</pub-id></mixed-citation></ref>
<ref id="c12"><label>12</label><mixed-citation publication-type="journal"><string-name><surname>Jumper</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Hassabis</surname>, <given-names>D</given-names></string-name>. <article-title>Protein structure predictions to atomic accuracy with AlphaFold</article-title>. <source>Nature Methods</source> <volume>19</volume>, <fpage>11</fpage>–<lpage>12</lpage> (<year>2022</year>). <pub-id pub-id-type="doi">10.1038/s41592-021-01362-6</pub-id></mixed-citation></ref>
<ref id="c13"><label>13</label><mixed-citation publication-type="journal"><string-name><surname>Du</surname>, <given-names>Z.</given-names></string-name> <etal>et al.</etal> <article-title>The trRosetta server for fast and accurate protein structure prediction</article-title>. <source>Nat Protoc</source> <volume>16</volume>, <fpage>5634</fpage>–<lpage>5651</lpage> (<year>2021</year>). <pub-id pub-id-type="doi">10.1038/s41596-021-00628-9</pub-id></mixed-citation></ref>
<ref id="c14"><label>14</label><mixed-citation publication-type="journal"><string-name><surname>Baek</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>Accurate prediction of protein structures and interactions using a three-track neural network</article-title>. <source>Science</source> <volume>373</volume>, <fpage>871</fpage>–<lpage>876</lpage> (<year>2021</year>). doi:<pub-id pub-id-type="doi">10.1126/science.abj8754</pub-id></mixed-citation></ref>
<ref id="c15"><label>15</label><mixed-citation publication-type="journal"><string-name><surname>Fang</surname>, <given-names>X.</given-names></string-name> <etal>et al.</etal> <article-title>Helixfold-single: Msa-free protein structure prediction by using protein language model as an alternative</article-title>. <source>arXiv preprint arXiv:2207.13921</source> (<year>2022</year>). <pub-id pub-id-type="doi">10.48550/arXiv.2207.13921</pub-id></mixed-citation></ref>
<ref id="c16"><label>16</label><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title>High-resolution de novo structure prediction from primary sequence</article-title>. <source>bioRxiv, 2022.2007.2021.500999</source> (<year>2022</year>). <pub-id pub-id-type="doi">10.1101/2022.07.21.500999</pub-id></mixed-citation></ref>
<ref id="c17"><label>17</label><mixed-citation publication-type="journal"><string-name><surname>Lin</surname>, <given-names>Z.</given-names></string-name> <etal>et al.</etal> <article-title>Evolutionary-scale prediction of atomic-level protein structure with a language model</article-title>. <source>Science</source> <volume>379</volume>, <fpage>1123</fpage>–<lpage>1130</lpage> (<year>2023</year>). <pub-id pub-id-type="doi">10.1126/science.ade2574</pub-id></mixed-citation></ref>
<ref id="c18"><label>18</label><mixed-citation publication-type="journal"><string-name><surname>Chen</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>QuoteTarget: A sequence-based transformer protein language model to identify potentially druggable protein targets</article-title>. <source>Protein Sci</source> <volume>32</volume>, <fpage>e4555</fpage> (<year>2023</year>). <pub-id pub-id-type="doi">10.1002/pro.4555</pub-id></mixed-citation></ref>
<ref id="c19"><label>19</label><mixed-citation publication-type="journal"><string-name><surname>Hie</surname>, <given-names>B. L.</given-names></string-name> <etal>et al.</etal> <article-title>Efficient evolution of human antibodies from general protein language models</article-title>. <source>Nature Biotechnology</source> (<year>2023</year>). <pub-id pub-id-type="doi">10.1038/s41587-023-01763-2</pub-id></mixed-citation></ref>
<ref id="c20"><label>20</label><mixed-citation publication-type="journal"><string-name><surname>Ferruz</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Schmidt</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Höcker</surname>, <given-names>B</given-names></string-name>. <article-title>ProtGPT2 is a deep unsupervised language model for protein design</article-title>. <source>Nature Communications</source> <day>13</day>, <fpage>4348</fpage> (<year>2022</year>). <pub-id pub-id-type="doi">10.1038/s41467-022-32007-7</pub-id></mixed-citation></ref>
<ref id="c21"><label>21</label><mixed-citation publication-type="journal"><string-name><surname>Madani</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Large language models generate functional protein sequences across diverse families</article-title>. <source>Nature Biotechnology</source> (<year>2023</year>). <pub-id pub-id-type="doi">10.1038/s41587-022-01618-2</pub-id></mixed-citation></ref>
<ref id="c22"><label>22</label><mixed-citation publication-type="journal"><string-name><surname>Ruffolo</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Chu</surname>, <given-names>L.-S.</given-names></string-name>, <string-name><surname>Mahajan</surname>, <given-names>S. P.</given-names></string-name> &amp; <string-name><surname>Gray</surname>, <given-names>J. J</given-names></string-name>. <article-title>Fast, accurate antibody structure prediction from deep learning on massive set of natural antibodies</article-title>. <source>Nature Communications</source> <volume>14</volume> (<year>2023</year>). <pub-id pub-id-type="doi">10.1038/s41467-023-38063-x</pub-id></mixed-citation></ref>
<ref id="c23"><label>23</label><mixed-citation publication-type="journal"><string-name><surname>Wu</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Wu</surname>, <given-names>F.</given-names></string-name>, <string-name><surname>Jiang</surname>, <given-names>B.</given-names></string-name>, <string-name><surname>Liu</surname>, <given-names>W.</given-names></string-name> &amp; <string-name><surname>Zhao</surname>, <given-names>P</given-names></string-name>. <article-title>tFold-Ab: Fast and Accurate Antibody Structure Prediction without Sequence Homologs</article-title>. <source>bioRxiv, 2022.2011.2010.515918</source> (<year>2022</year>). <pub-id pub-id-type="doi">10.1101/2022.11.10.515918</pub-id></mixed-citation></ref>
<ref id="c24"><label>24</label><mixed-citation publication-type="journal"><string-name><surname>Ruffolo</surname>, <given-names>J. A.</given-names></string-name>, <string-name><surname>Sulam</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Gray</surname>, <given-names>J. J</given-names></string-name>. <article-title>Antibody structure prediction using interpretable deep learning</article-title>. <source>Patterns</source> <volume>3</volume>, <fpage>100406</fpage> (<year>2022</year>). <pub-id pub-id-type="doi">10.1016/j.patter.2021.100406</pub-id></mixed-citation></ref>
<ref id="c25"><label>25</label><mixed-citation publication-type="journal"><string-name><surname>Cohen</surname>, <given-names>T.</given-names></string-name>, <string-name><surname>Halfon</surname>, <given-names>M.</given-names></string-name> &amp; <string-name><surname>Schneidman-Duhovny</surname>, <given-names>D</given-names></string-name>. <article-title>NanoNet: Rapid and accurate end-to-end nanobody modeling by deep learning</article-title>. <source>Frontiers in Immunology</source> <volume>13</volume>, <fpage>958584</fpage> (<year>2022</year>). <pub-id pub-id-type="doi">10.3389/fimmu.2022.958584</pub-id></mixed-citation></ref>
<ref id="c26"><label>26</label><mixed-citation publication-type="journal"><string-name><surname>Zhu</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Polymorphic nanobody crystals as long-acting intravitreal therapy for wet age-related macular degeneration</article-title>. <source>Bioengineering &amp; Translational Medicine</source>, <fpage>e10523</fpage> (<year>2023</year>). <pub-id pub-id-type="doi">10.1002/btm2.10523</pub-id></mixed-citation></ref>
<ref id="c27"><label>27</label><mixed-citation publication-type="journal"><string-name><surname>Dunbar</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>SAbDab: the structural antibody database</article-title>. <source>Nucleic Acids Res</source> <volume>42</volume>, <fpage>D1140</fpage>–<lpage>1146</lpage> (<year>2014</year>). <pub-id pub-id-type="doi">10.1093/nar/gkt1043</pub-id></mixed-citation></ref>
<ref id="c28"><label>28</label><mixed-citation publication-type="journal"><string-name><surname>Edgar</surname>, <given-names>R. C</given-names></string-name>. <article-title>Search and clustering orders of magnitude faster than BLAST</article-title>. <source>Bioinformatics</source> <volume>26</volume>, <fpage>2460</fpage>–<lpage>2461</lpage> (<year>2010</year>). <pub-id pub-id-type="doi">10.1093/bioinformatics/btq461</pub-id></mixed-citation></ref>
<ref id="c29"><label>29</label><mixed-citation publication-type="journal"><string-name><surname>Jumper</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>Highly accurate protein structure prediction with AlphaFold</article-title>. <source>Nature</source> <volume>596</volume>, <fpage>583</fpage>–<lpage>589</lpage> (<year>2021</year>). <pub-id pub-id-type="doi">10.1038/s41586-021-03819-2</pub-id></mixed-citation></ref>
<ref id="c30"><label>30</label><mixed-citation publication-type="journal"><string-name><surname>Rives</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences</article-title>. <source>PNAS</source> <volume>118</volume> (<year>2021</year>). <pub-id pub-id-type="doi">10.1073/pnas.2016239118</pub-id></mixed-citation></ref>
<ref id="c31"><label>31</label><mixed-citation publication-type="journal"><string-name><surname>Cong</surname>, <given-names>Y.</given-names></string-name> <etal>et al.</etal> <article-title>Anchor-Locker Binding Mechanism of the Coronavirus Spike Protein to Human ACE2: Insights from Computational Analysis</article-title>. <source>Journal of Chemical Information and Modeling</source> <volume>61</volume>, <fpage>3529</fpage>–<lpage>3542</lpage> (<year>2021</year>). <pub-id pub-id-type="doi">10.1021/acs.jcim.1c00241</pub-id></mixed-citation></ref>
<ref id="c32"><label>32</label><mixed-citation publication-type="journal"><string-name><surname>Lippow</surname>, <given-names>S. M.</given-names></string-name>, <string-name><surname>Wittrup</surname>, <given-names>K. D.</given-names></string-name> &amp; <string-name><surname>Tidor</surname>, <given-names>B</given-names></string-name>. <article-title>Computational design of antibody-affinity improvement beyond in vivo maturation</article-title>. <source>Nature Biotechnology</source> <volume>25</volume>, <fpage>1171</fpage>–<lpage>1176</lpage> (<year>2007</year>). <pub-id pub-id-type="doi">10.1038/nbt1336</pub-id></mixed-citation></ref>
<ref id="c33"><label>33</label><mixed-citation publication-type="journal"><string-name><surname>Riahi</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Application of an integrated computational antibody engineering platform to design SARS-CoV-2 neutralizers</article-title>. <source>Antibody Therapeutics</source> <volume>4</volume>, <fpage>109</fpage>–<lpage>122</lpage> (<year>2021</year>). <pub-id pub-id-type="doi">10.1093/abt/tbab011</pub-id></mixed-citation></ref>
<ref id="c34"><label>34</label><mixed-citation publication-type="journal"><string-name><surname>Clark</surname>, <given-names>L. A.</given-names></string-name> <etal>et al.</etal> <article-title>Affinity enhancement of an in vivo matured therapeutic antibody using structure-based computational design</article-title>. <source>Protein Sci</source> <volume>15</volume>, <fpage>949</fpage>–<lpage>960</lpage> (<year>2006</year>). <pub-id pub-id-type="doi">10.1110/ps.052030506</pub-id></mixed-citation></ref>
<ref id="c35"><label>35</label><mixed-citation publication-type="journal"><string-name><surname>Shan</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Deep learning guided optimization of human antibody against SARS-CoV-2 variants with broad neutralization</article-title>. <source>PNAS</source> <volume>119</volume>, <fpage>e2122954119</fpage> (<year>2022</year>). <pub-id pub-id-type="doi">10.1073/pnas.2122954119</pub-id></mixed-citation></ref>
<ref id="c36"><label>36</label><mixed-citation publication-type="journal"><string-name><surname>Choi</surname>, <given-names>Y.</given-names></string-name>, <string-name><surname>Hua</surname>, <given-names>C.</given-names></string-name>, <string-name><surname>Sentman</surname>, <given-names>C. L.</given-names></string-name>, <string-name><surname>Ackerman</surname>, <given-names>M. E.</given-names></string-name> &amp; <string-name><surname>Bailey-Kellogg</surname>, <given-names>C</given-names></string-name>. <article-title>Antibody humanization by structure-based computational protein design</article-title>. <source>mAbs</source> <volume>7</volume>, <fpage>1045</fpage>–<lpage>1057</lpage> (<year>2015</year>). <pub-id pub-id-type="doi">10.1080/19420862.2015.1076600</pub-id></mixed-citation></ref>
<ref id="c37"><label>37</label><mixed-citation publication-type="journal"><string-name><surname>Kurella</surname>, <given-names>V. B.</given-names></string-name> &amp; <string-name><surname>Gali</surname>, <given-names>R</given-names></string-name>. <article-title>Structure guided homology model based design and engineering of mouse antibodies for humanization</article-title>. <source>Bioinformation</source> <volume>10</volume>, <fpage>180</fpage>–<lpage>186</lpage> (<year>2014</year>). <pub-id pub-id-type="doi">10.6026/97320630010180</pub-id></mixed-citation></ref>
<ref id="c38"><label>38</label><mixed-citation publication-type="journal"><string-name><surname>Tomar</surname>, <given-names>D. S.</given-names></string-name>, <string-name><surname>Singh</surname>, <given-names>S. K.</given-names></string-name>, <string-name><surname>Li</surname>, <given-names>L.</given-names></string-name>, <string-name><surname>Broulidakis</surname>, <given-names>M. P.</given-names></string-name> &amp; <string-name><surname>Kumar</surname>, <given-names>S</given-names></string-name>. <article-title>In Silico Prediction of Diffusion Interaction Parameter (k(D)), a Key Indicator of Antibody Solution Behaviors</article-title>. <source>Pharmaceutical Research</source> <volume>35</volume>, <fpage>193</fpage> (<year>2018</year>). <pub-id pub-id-type="doi">10.1007/s11095-018-2466-6</pub-id></mixed-citation></ref>
<ref id="c39"><label>39</label><mixed-citation publication-type="journal"><string-name><surname>Froning</surname>, <given-names>K.</given-names></string-name> <etal>et al.</etal> <article-title>Computational stabilization of T cell receptors allows pairing with antibodies to form bispecifics</article-title>. <source>Nature Communications</source> <volume>11</volume>, <fpage>2330</fpage> (<year>2020</year>). <pub-id pub-id-type="doi">10.1038/s41467-020-16231-7</pub-id></mixed-citation></ref>
<ref id="c40"><label>40</label><mixed-citation publication-type="journal"><string-name><surname>Chowdhury</surname>, <given-names>R.</given-names></string-name> <etal>et al.</etal> <article-title>Single-sequence protein structure prediction using a language model and deep learning</article-title>. <source>Nature Biotechnology</source> <volume>40</volume>, <fpage>1617</fpage>–<lpage>1623</lpage> (<year>2022</year>). <pub-id pub-id-type="doi">10.1038/s41587-022-01432-w</pub-id></mixed-citation></ref>
<ref id="c41"><label>41</label><mixed-citation publication-type="journal"><string-name><surname>Watson</surname>, <given-names>J. L.</given-names></string-name> <etal>et al.</etal> <article-title>De novo design of protein structure and function with RFdiffusion</article-title>. <source>Nature</source> (<year>2023</year>). <pub-id pub-id-type="doi">10.1038/s41586-023-06415-8</pub-id></mixed-citation></ref>
<ref id="c42"><label>42</label><mixed-citation publication-type="journal"><string-name><surname>Dauparas</surname>, <given-names>J.</given-names></string-name> <etal>et al.</etal> <article-title>Robust deep learning-based protein sequence design using ProteinMPNN</article-title>. <source>Science</source> <volume>378</volume>, <fpage>49</fpage>–<lpage>56</lpage> (<year>2022</year>). doi:<pub-id pub-id-type="doi">10.1126/science.add2187</pub-id></mixed-citation></ref>
<ref id="c43"><label>43</label><mixed-citation publication-type="journal"><string-name><surname>Shin</surname>, <given-names>J.-E.</given-names></string-name> <etal>et al.</etal> <article-title>Protein design and variant prediction using autoregressive generative models</article-title>. <source>Nature Communications</source> <volume>12</volume>, <fpage>2403</fpage> (<year>2021</year>). <pub-id pub-id-type="doi">10.1038/s41467-021-22732-w</pub-id></mixed-citation></ref>
<ref id="c44"><label>44</label><mixed-citation publication-type="journal"><string-name><surname>Luo</surname>, <given-names>S.</given-names></string-name> <etal>et al.</etal> <article-title>Antigen-specific antibody design and optimization with diffusion-based generative models for protein structures</article-title>. <source>Advances in Neural Information Processing Systems</source> <volume>35</volume>, <fpage>9754</fpage>–<lpage>9767</lpage> (<year>2022</year>).</mixed-citation></ref>
<ref id="c45"><label>45</label><mixed-citation publication-type="journal"><string-name><surname>Watson</surname>, <given-names>J. L.</given-names></string-name> <etal>et al.</etal> <article-title>Broadly applicable and accurate protein design by integrating structure prediction networks and diffusion generative models</article-title>. <source>bioRxiv, 2022.2012.2009.519842</source> (<year>2022</year>). <pub-id pub-id-type="doi">10.1101/2022.12.09.519842</pub-id></mixed-citation></ref>
<ref id="c46"><label>46</label><mixed-citation publication-type="journal"><string-name><surname>Ingraham</surname>, <given-names>J.</given-names></string-name>, <string-name><surname>Garg</surname>, <given-names>V.</given-names></string-name>, <string-name><surname>Barzilay</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Jaakkola</surname>, <given-names>T</given-names></string-name>. <article-title>Generative models for graph-based protein design</article-title>. <source>Advances in neural information processing systems</source> <volume>32</volume> (<year>2019</year>).</mixed-citation></ref>
<ref id="c47"><label>47</label><mixed-citation publication-type="journal"><string-name><surname>Zavrtanik</surname>, <given-names>U.</given-names></string-name> &amp; <string-name><surname>Hadzi</surname>, <given-names>S</given-names></string-name>. <article-title>A non-redundant data set of nanobody-antigen crystal structures</article-title>. <source>Data Brief</source> <volume>24</volume>, <fpage>103754</fpage> (<year>2019</year>). <pub-id pub-id-type="doi">10.1016/j.dib.2019.103754</pub-id></mixed-citation></ref>
<ref id="c48"><label>48</label><mixed-citation publication-type="journal"><string-name><surname>Chothia</surname>, <given-names>C.</given-names></string-name> &amp; <string-name><surname>Lesk</surname>, <given-names>A. M</given-names></string-name>. <article-title>Canonical structures for the hypervariable regions of immunoglobulins</article-title>. <source>Journal of Molecular Biology</source> <volume>196</volume>, <fpage>901</fpage>–<lpage>917</lpage> (<year>1987</year>). <pub-id pub-id-type="doi">10.1016/0022-2836(87)90412-8</pub-id></mixed-citation></ref>
<ref id="c49"><label>49</label><mixed-citation publication-type="journal"><string-name><surname>Gustaf</surname>, <given-names>A.</given-names></string-name> <etal>et al.</etal> <article-title>OpenFold: Retraining AlphaFold2 yields new insights into its learning mechanisms and capacity for generalization</article-title>. <source>bioRxiv, 2022.2011.2020.517210</source> (<year>2022</year>). <pub-id pub-id-type="doi">10.1101/2022.11.20.517210</pub-id></mixed-citation></ref>
<ref id="c50"><label>50</label><mixed-citation publication-type="journal"><string-name><surname>Banks</surname>, <given-names>J. L.</given-names></string-name> <etal>et al.</etal> <article-title>Integrated Modeling Program, Applied Chemical Theory (IMPACT)</article-title>. <source>Journal of Computational Chemistry</source> <volume>26</volume>, <fpage>1752</fpage>–<lpage>1780</lpage> (<year>2005</year>). <pub-id pub-id-type="doi">10.1002/jcc.20292</pub-id></mixed-citation></ref>
<ref id="c51"><label>51</label><mixed-citation publication-type="journal"><string-name><surname>Mirdita</surname>, <given-names>M.</given-names></string-name> <etal>et al.</etal> <article-title>ColabFold: making protein folding accessible to all</article-title>. <source>Nature Methods</source> <volume>19</volume>, <fpage>679</fpage>–<lpage>682</lpage> (<year>2022</year>). <pub-id pub-id-type="doi">10.1038/s41592-022-01488-1</pub-id></mixed-citation></ref>
<ref id="c52"><label>52</label><mixed-citation publication-type="journal"><string-name><surname>Dunbar</surname>, <given-names>J.</given-names></string-name> &amp; <string-name><surname>Deane</surname>, <given-names>C. M</given-names></string-name>. <article-title>ANARCI: antigen receptor numbering and receptor classification</article-title>. <source>Bioinformatics</source> <volume>32</volume>, <fpage>298</fpage>–<lpage>300</lpage> (<year>2016</year>). <pub-id pub-id-type="doi">10.1093/bioinformatics/btv552</pub-id></mixed-citation></ref>
<ref id="c53"><label>53</label><mixed-citation publication-type="journal"><string-name><surname>Levy</surname>, <given-names>E. D</given-names></string-name>. <article-title>A simple definition of structural regions in proteins and its use in analyzing interface evolution</article-title>. <source>Journal of Molecular Biology</source> <volume>403</volume>, <fpage>660</fpage>–<lpage>670</lpage> (<year>2010</year>). <pub-id pub-id-type="doi">10.1016/j.jmb.2010.09.028</pub-id></mixed-citation></ref>
<ref id="c54"><label>54</label><mixed-citation publication-type="journal"><string-name><surname>Honegger</surname>, <given-names>A.</given-names></string-name> &amp; <string-name><surname>Pluckthun</surname>, <given-names>A</given-names></string-name>. <article-title>Yet another numbering scheme for immunoglobulin variable domains: an automatic modeling and analysis tool</article-title>. <source>Journal of Molecular Biology</source> <volume>309</volume>, <fpage>657</fpage>–<lpage>670</lpage> (<year>2001</year>). <pub-id pub-id-type="doi">10.1006/jmbi.2001.4662</pub-id></mixed-citation></ref>
<ref id="c55"><label>55</label><mixed-citation publication-type="journal"><string-name><surname>Schweke</surname>, <given-names>H.</given-names></string-name>, <string-name><surname>Mucchielli</surname>, <given-names>M.-H.</given-names></string-name>, <string-name><surname>Chevrollier</surname>, <given-names>N.</given-names></string-name>, <string-name><surname>Gosset</surname>, <given-names>S.</given-names></string-name> &amp; <string-name><surname>Lopes</surname>, <given-names>A</given-names></string-name>. <article-title>SURFMAP: A Software for Mapping in Two Dimensions Protein Surface Features</article-title>. <source>Journal of Chemical Information and Modeling</source> <volume>62</volume>, <fpage>1595</fpage>–<lpage>1601</lpage> (<year>2022</year>). <pub-id pub-id-type="doi">10.1021/acs.jcim.1c01269</pub-id></mixed-citation></ref>
<ref id="c56"><label>56</label><mixed-citation publication-type="journal"><string-name><surname>Salomon-Ferrer</surname>, <given-names>R.</given-names></string-name>, <string-name><surname>Case</surname>, <given-names>D. A.</given-names></string-name> &amp; <string-name><surname>Walker</surname>, <given-names>R. C</given-names></string-name>. <article-title>An overview of the Amber biomolecular simulation package</article-title>. <source>Wiley Interdisciplinary Reviews: Computational Molecular Science</source> <volume>3</volume>, <fpage>198</fpage>–<lpage>210</lpage> (<year>2013</year>). <pub-id pub-id-type="doi">10.1002/wcms.1121</pub-id></mixed-citation></ref>
<ref id="c57"><label>57</label><mixed-citation publication-type="journal"><string-name><surname>Tian</surname>, <given-names>C.</given-names></string-name> <etal>et al.</etal> <article-title>ff19SB: Amino-Acid-Specific Protein Backbone Parameters Trained against Quantum Mechanics Energy Surfaces in Solution</article-title>. <source>Journal of Chemical Theory and Computation</source> <volume>16</volume>, <fpage>528</fpage>–<lpage>552</lpage> (<year>2020</year>). <pub-id pub-id-type="doi">10.1021/acs.jctc.9b00591</pub-id></mixed-citation></ref>
<ref id="c58"><label>58</label><mixed-citation publication-type="journal"><string-name><surname>Izadi</surname>, <given-names>S.</given-names></string-name>, <string-name><surname>Anandakrishnan</surname>, <given-names>R.</given-names></string-name> &amp; <string-name><surname>Onufriev</surname>, <given-names>A. V</given-names></string-name>. <article-title>Building Water Models: A Different Approach</article-title>. <source>Journal of Physical Chemistry Letters</source> <volume>5</volume>, <fpage>3863</fpage>–<lpage>3871</lpage> (<year>2014</year>). <pub-id pub-id-type="doi">10.1021/jz501780a</pub-id></mixed-citation></ref>
<ref id="c59"><label>59</label><mixed-citation publication-type="journal"><string-name><surname>Chayen</surname>, <given-names>N. E.</given-names></string-name> &amp; <string-name><surname>Saridakis</surname>, <given-names>E</given-names></string-name>. <article-title>Protein crystallization: from purified protein to diffraction-quality crystal</article-title>. <source>Nat Methods</source> <volume>5</volume>, <fpage>147</fpage>–<lpage>153</lpage> (<year>2008</year>). <pub-id pub-id-type="doi">10.1038/nmeth.f.203</pub-id></mixed-citation></ref>
<ref id="c60"><label>60</label><mixed-citation publication-type="journal"><string-name><surname>Yu</surname>, <given-names>F.</given-names></string-name> <etal>et al.</etal> <article-title>Aquarium: an automatic data-processing and experiment information management system for biological macromolecular crystallography beamlines</article-title>. <source>Journal of Applied Crystallography</source> <volume>52</volume>, <fpage>472</fpage>–<lpage>477</lpage> (<year>2019</year>). <pub-id pub-id-type="doi">10.1107/S1600576719001183</pub-id></mixed-citation></ref>
</ref-list>
<sec>
<fig id="figs1" position="float" orientation="portrait" fig-type="figure">
<label>Extended Data Fig. 1</label>
<caption><title>| Solvent-accessible surface area analysis of predicted H3 loops</title>
<p>The values represent the difference in SASA between H3 structures predicted by AF2 or H3-OPT and experimentally determined structures. Positive values indicate that the predicted structures have more exposed surface area compared to the native structures; negative values indicate less exposed surface area.</p></caption>
<graphic xlink:href="553933v2_figs1.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
<fig id="figs2" position="float" orientation="portrait" fig-type="figure">
<label>Extended Data Fig. 2</label>
<caption><title>| Comparison of accuracy between AF2, H3-OPT, and tFold-Ab methods using the CAMEO 2022 benchmark dataset</title>
<p>The x-axis represents different targets; y-axis represents Cα-RMSD values.</p></caption>
<graphic xlink:href="553933v2_figs2.tif" mimetype="image" mime-subtype="tiff"/>
</fig>
</sec>
</back>
<sub-article id="sa0" article-type="editor-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.91512.2.sa3</article-id>
<title-group>
<article-title>eLife Assessment</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Dötsch</surname>
<given-names>Volker</given-names>
</name>
<role specific-use="editor">Reviewing Editor</role>
<aff>
<institution-wrap>
<institution>Goethe University Frankfurt</institution>
</institution-wrap>
<city>Frankfurt am Main</city>
<country>Germany</country>
</aff>
</contrib>
</contrib-group>
<kwd-group kwd-group-type="evidence-strength">
<kwd>Convincing</kwd>
</kwd-group>
<kwd-group kwd-group-type="claim-importance">
<kwd>Important</kwd>
</kwd-group>
</front-stub>
<body>
<p>This paper presents H3-OPT, a deep learning method that effectively combines existing techniques for the prediction of antibody structure. This work is <bold>important</bold> because the method can aid in the design of antibodies, which are key tools in many research and industrial applications. The experiments for validation are <bold>convincing</bold>, but some further statistical evaluation would be helpful for the readers.</p>
</body>
</sub-article>
<sub-article id="sa1" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.91512.2.sa2</article-id>
<title-group>
<article-title>Reviewer #1 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>The authors developed a deep learning method called H3-OPT, which combines the strength of AF2 and PLM to reach better prediction accuracy of antibody CDR-H3 loops than AF2 and IgFold. These improvements will have an impact on antibody structure prediction and design.</p>
<p>Strengths:</p>
<p>The training data are carefully selected and clustered, the network design is simple and effective.</p>
<p>The improvements include smaller average Ca RMSD, backbone RMSD, side chain RMSD, more accurate surface residues and/or SASA, and more accurate H3 loop-antigen contacts.</p>
<p>The performance is validated from multiple angles.</p>
<p>The revised manuscript has cleared my previous concerns.</p>
</body>
</sub-article>
<sub-article id="sa2" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.91512.2.sa1</article-id>
<title-group>
<article-title>Reviewer #2 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>This work provides a new tool (H3-Opt) for the prediction of antibody and nanobody structures, based on the combination of AlphaFold2 and a pre-trained protein language model, with a focus on predicting the challenging CDR-H3 loops with enhanced accuracy than previously developed approaches. This task is of high value for the development of new therapeutic antibodies. The paper provides an external validation consisting of 131 sequences, with further analysis of the results by segregating the test sets in three subsets of varying difficulty and comparison with other available methods. Furthermore, the approach was validated by comparing three experimentally solved 3D structures of anti-VEGF nanobodies with the H3-Opt predictions</p>
<p>Strengths:</p>
<p>The experimental design to train and validate the new approach has been clearly described, including the dataset compilation and its representative sampling into training, validation and test sets, and structure preparation. The results of the in silico validation are quite convincing and support the authors' conclusions.</p>
<p>The datasets used to train and validate the tool and the code are made available by the authors, which ensures transparency and reproducibiity, and allows future benchmarking exercises with incoming new tools.</p>
<p>Compared to AlphaFold2, the authors' optimization seems to produce better results for the most challenging subsets of the test set.</p>
<p>Weaknesses:</p>
<p>The comparison of affinity predictions derived from AlphaFold2 and H3-opt models, based on molecular dynamics simulations, should have been discussed in depth. In some cases, there are huge differences between the estimations from H3-opt models and those from experimental structures. It seems that the authors obtained average differences of the real delta, instead of average differences of the absolute value of the delta. This can be misleading, because high negative differences might be compensated by high positive differences when computing the mean value. Moreover, it would have been good for the authors to disclose the trajectories from the MD simulations.</p>
</body>
</sub-article>
<sub-article id="sa3" article-type="referee-report">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.91512.2.sa0</article-id>
<title-group>
<article-title>Reviewer #3 (Public Review):</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<anonymous/>
<role specific-use="referee">Reviewer</role>
</contrib>
</contrib-group>
</front-stub>
<body>
<p>Summary:</p>
<p>
The manuscript introduces a new computational framework for choosing 'the best method' according to the case for getting the best possible structural prediction for the CDR-H3 loop. The authors show their strategy improves on average the accuracy of the predictions on datasets of increasingly difficulty in comparison to several state-of-the-art methods. They also show the benefits of improving the structural predictions of the CDR-H3 in the evaluation of different properties that may be relevant for drug discovery and therapeutics design.</p>
<p>Strengths:</p>
<p>
Authors introduce a novel framework, which can be easily adapted and improved. Authors use a well defined dataset to test their new method. A modest average accuracy gain is obtained in comparison to other state-of-the art methods for the same task, while avoiding for testing different prediction approaches. Although the accuracy gain is mainly ascribed to easy cases, the accuracy and precision for moderate to challenging cases is comparable to the best PLM methods (see Fig. 4b and Extended Data Fig. 2), reflecting the present methodological limit in the field.</p>
<p>Weaknesses:</p>
<p>
The proposed method lacks of a confidence score or a warning to help guiding the users in moderate to challenging cases.</p>
</body>
</sub-article>
<sub-article id="sa4" article-type="author-comment">
<front-stub>
<article-id pub-id-type="doi">10.7554/eLife.91512.2.sa4</article-id>
<title-group>
<article-title>Author Response</article-title>
</title-group>
<contrib-group>
<contrib contrib-type="author">
<name>
<surname>Chen</surname>
<given-names>Hedi</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Fan</surname>
<given-names>Xiaoyu</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhu</surname>
<given-names>Shuqian</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Pei</surname>
<given-names>Yuchan</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhang</surname>
<given-names>Xiaochun</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Zhang</surname>
<given-names>Xiaonan</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Liu</surname>
<given-names>Lihang</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Qian</surname>
<given-names>Feng</given-names>
</name>
<role specific-use="author">Author</role>
</contrib>
<contrib contrib-type="author">
<name>
<surname>Tian</surname>
<given-names>Boxue</given-names>
</name>
<role specific-use="author">Author</role>
<contrib-id contrib-id-type="orcid">http://orcid.org/0000-0002-5830-0669</contrib-id></contrib>
</contrib-group>
</front-stub>
<body>
<p>The following is the authors’ response to the original reviews.</p>
<disp-quote content-type="editor-comment">
<p><bold>eLife assessment</bold></p>
<p>This work presents H3-OPT, a deep learning method that effectively combines existing techniques for the prediction of antibody structure. This work is important because the method can aid the design of antibodies, which are key tools in many research and industrial applications. The experiments for validation are solid.</p>
<p>Comments to Author:</p>
<p>Several points remain partially unclear, such as:</p>
<p>1).    Which examples constitute proper validation;</p>
</disp-quote>
<p>Thank you for your kind reminder. We have modified the text of the experiments for validation to identify which examples constitute proper validation. We have corrected the “Finally, H3-OPT also shows lower Cα-RMSDs compared to AF2 or tFold-Ab for the majority of targets in an expanded benchmark dataset, including all antibody structures from CAMEO 2022” into “Finally, H3-OPT also shows lower Cα-RMSDs compared to AF2 or tFold-Ab for the majority (six of seven) of targets in an expanded benchmark dataset, including all antibody structures from CAMEO 2022” and added the following sentence in the experimental validation section of our revised manuscript to clarify which examples constitute proper validation: “AlphaFold2 outperformed IgFold on these targets”.</p>
<disp-quote content-type="editor-comment">
<p>1. What the relevance of the molecular dynamics calculations as performed is;</p>
</disp-quote>
<p>Thank you for your comment, and I apologize for any confusion. The goal of our molecular dynamics calculations is to compare the differences in binding affinities, an important issue of antibody engineering, between AlphaFold2-predicted complexes and H3-OPT-predicted complexes. Molecular dynamics simulations enable the investigation of the dynamic behaviors and interactions of these complexes over time. Unlike other tools for predicting binding free energy, MM/PBSA or MM/GBSA calculations provide dynamic properties of complexes by sampling conformational space, which helps in obtaining more accurate estimates of binding free energy. In summary, our molecular dynamics calculations demonstrated that the binding free energies of H3-OPT-predicted complexes are closer to those of native complexes.
We have included the following sentence in our manuscript to provide an explanation of the molecular dynamics calculations: “Since affinity prediction plays a crucial role in antibody therapeutics engineering, we performed MD simulations to compare the differences in binding affinities between AF2-predicted complexes and H3-OPT-predicted complexes.”.</p>
<disp-quote content-type="editor-comment">
<p>1. The statistics for some of the comparisons;</p>
</disp-quote>
<p>Thank you for the comment. We have incorporated statistics for some of the comparisons in the revised version of our manuscript and added the following sentence in the Methods section: “We conducted two-sided t-test analyses to assess the statistical significance of differences between the various groups. Statistical significance was considered when the p-values were less than 0.05. These statistical analyses were carried out using Python 3.10 with the Scipy library (version 1.10.1).”.</p>
<disp-quote content-type="editor-comment">
<p>1. The lack of comparison with other existing methods.</p>
</disp-quote>
<p>We appreciate your valuable comments and suggestions. Conducting comparisons with a broader set of existing methods can further facilitate discussions on the strengths and weaknesses of each method, as well as the accuracy of our method. In our study, we conducted a comparison of H3-OPT with many existing methods, including AlphaFold2, HelixFold-Single, ESMFold, and IgFold. We demonstrated that several protein structure prediction methods, such as ESMFold and HelixFold-Single, do not match the accuracy of AlphaFold2 in CDR-H3 prediction. Additionally, we performed a detailed comparison between H3-OPT, AlphaFold2, and IgFold (the latest antibody structure prediction method) for each target.</p>
<p>We sincerely thank the comment and have introduced a comparison with OmegaFold. The results have been incorporated into the relevant sections (Fig 4a-b) of the revised manuscript.</p>
<fig id="sa4fig1">
<label>Author response image 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-fig1.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p><bold>Public Reviews</bold></p>
<p>Comments to Author:</p>
<p><bold>Reviewer #1 (Public Review):</bold></p>
<p>Summary:</p>
<p>The authors developed a deep learning method called H3-OPT, which combines the strength of AF2 and PLM to reach better prediction accuracy of antibody CDR-H3 loops than AF2 and IgFold. These improvements will have an impact on antibody structure prediction and design.</p>
<p>Strengths:</p>
<p>The training data are carefully selected and clustered, the network design is simple and effective.</p>
<p>The improvements include smaller average Ca RMSD, backbone RMSD, side chain RMSD, more accurate surface residues and/or SASA, and more accurate H3 loop-antigen contacts.</p>
<p>The performance is validated from multiple angles.</p>
<p>Weaknesses:</p>
<p>1. There are very limited prediction-then-validation cases, basically just one case.</p>
</disp-quote>
<p>Thanks for pointing out this issue. The number of prediction-then-validation cases is helpful to show the generalization ability of our model. However, obtaining experimental structures is both costly and labor-intensive. Furthermore, experimental validation cases only capture a limited portion of the sequence space in comparison to the broader diversity of antibody sequences.</p>
<p>To address this challenge, we have collected different datasets to serve as benchmarks for evaluating the performance of H3-OPT, including our non-redundant test set and the CAMEO dataset. The introduction of these datasets allows for effective assessments of H3-OPT’s performance without biases and tackles the obstacle of limited prediction-then-validation cases.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Public Review):</bold></p>
<p>This work provides a new tool (H3-Opt) for the prediction of antibody and nanobody structures, based on the combination of AlphaFold2 and a pre-trained protein language model, with a focus on predicting the challenging CDR-H3 loops with enhanced accuracy than previously developed approaches. This task is of high value for the development of new therapeutic antibodies. The paper provides an external validation consisting of 131 sequences, with further analysis of the results by segregating the test sets into three subsets of varying difficulty and comparison with other available methods. Furthermore, the approach was validated by comparing three experimentally solved 3D structures of anti-VEGF nanobodies with the H3-Opt predictions</p>
<p>Strengths:</p>
<p>The experimental design to train and validate the new approach has been clearly described, including the dataset compilation and its representative sampling into training, validation and test sets, and structure preparation. The results of the in-silico validation are quite convincing and support the authors' conclusions.</p>
<p>The datasets used to train and validate the tool and the code are made available by the authors, which ensures transparency and reproducibility, and allows future benchmarking exercises with incoming new tools.</p>
<p>Compared to AlphaFold2, the authors' optimization seems to produce better results for the most challenging subsets of the test set.</p>
<p>Weaknesses:</p>
<p>1. The scope of the binding affinity prediction using molecular dynamics is not that clearly justified in the paper.</p>
</disp-quote>
<p>We sincerely appreciate your valuable comment. We have added the following sentence in our manuscript to justify the scope of the molecular dynamics calculations: “Since affinity prediction plays a crucial role in antibody therapeutics engineering, we performed MD simulations to compare the differences in binding affinities between AF2-predicted complexes and H3-OPT-predicted complexes.”.</p>
<disp-quote content-type="editor-comment">
<p>1. Some parts of the manuscript should be clarified, particularly the ones that relate to the experimental validation of the predictions made by the reported method. It is not absolutely clear whether the experimental validation is truly a prospective validation. Since the methodological aspects of the experimental determination are not provided here, it seems that this may not be the case. This is a key aspect of the manuscript that should be described more clearly.</p>
</disp-quote>
<p>Thank you for the reminder about experimental validation of our predictions. The sequence identities of the wild-type nanobody VH domain and H3 loop, when compared with the best template, are 0.816 and 0.647, respectively. As a result, these mutants exhibited low sequence similarity to our dataset, indicating the absence of prediction bias for these targets. Thus, H3-OPT outperformed IgFold on these mutants, demonstrating our model's strong generalization ability. In summary, the experimental validation actually serves as a prospective validation.</p>
<p>Thanks for your comments, we have added the following sentence to provide the methodological aspects of the experimental determination: “The protein expression, purification and crystallization experiments were described previously. The proteins used in the crystallization experiments were unlabeled. Upon thawing the frozen protein on ice, we performed a centrifugation step to eliminate any potential crystal nucleus and precipitants. Subsequently, we mixed the protein at a 1:1 ratio with commercial crystal condition kits using the sitting-drop vapor diffusion method facilitated by the Protein Crystallization Screening System (TTP LabTech, mosquito). After several days of optimization, single crystals were successfully cultivated at 21°C and promptly flash-frozen in liquid nitrogen. The diffraction data from various crystals were collected at the Shanghai Synchrotron Research Facility and subsequently processed using the aquarium pipeline.”</p>
<disp-quote content-type="editor-comment">
<p>1. Some Figures would benefit from a clearer presentation.</p>
</disp-quote>
<p>We sincerely thanks for your careful reading. According to your comments, we have made extensive modifications to make our presentation more convincing and clearer (Fig 2c-f).</p>
<fig id="sa4fig2">
<label>Author response image 2.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-fig2.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Public Review):</bold></p>
<p>Summary:</p>
<p>The manuscript introduces a new computational framework for choosing 'the best method' according to the case for getting the best possible structural prediction for the CDR-H3 loop. The authors show their strategy improves on average the accuracy of the predictions on datasets of increasing difficulty in comparison to several state-of-the-art methods. They also show the benefits of improving the structural predictions of the CDR-H3 in the evaluation of different properties that may be relevant for drug discovery and therapeutic design.</p>
<p>Strengths:</p>
<p>The authors introduce a novel framework, which can be easily adapted and improved. The authors use a well-defined dataset to test their new method. A modest average accuracy gain is obtained in comparison to other state-of-the art methods for the same task while avoiding testing different prediction approaches.</p>
<p>Weaknesses:</p>
<p>1. The accuracy gain is mainly ascribed to easy cases, while the accuracy and precision for moderate to challenging cases are comparable to other PLM methods (see Fig. 4b and Extended Data Fig. 2). That raises the question: how likely is it to be in a moderate or challenging scenario? For example, it is not clear whether the comparison to the solved X-ray structures of anti-VEGF nanobodies represents an easy or challenging case for H3-OPT. The mutant nanobodies seem not to provide any further validation as the single mutations are very far away from the CDR-H3 loop and they do not disrupt the structure in any way. Indeed, RMSD values follow the same trend in H3-OPT and IgFold predictions (Fig. 4c). A more challenging test and interesting application could be solving the structure of a designed or mutated CDR-H3 loop.</p>
</disp-quote>
<p>Thank you for your rigorous consideration. When the experimental structure is unavailable, it is difficult to directly determinate whether the target is easy-to-predict or challenging. We have conducted our non-redundant test set in which the number of easy-to-predict targets is comparable to the other two groups. Due to the limited availability of experimental antibody structures, especially nanobody structures, accurately predicting CDR-H3 remains a challenge. In our manuscript, we discuss the strengths and weakness of AlphaFold2 and other PLM-based methods, and we introduce H3-OPT as a comprehensive solution for antibody CDR3 modeling.</p>
<p>We also appreciate your comment on experimental structures. We fully agree with your opinion and made attempts to solve the experimental structures of seven mutants, including two mutants (Y95F and Q118N) which are close to CDR-H3 loop. Unfortunately, we tried seven different reagent kits with a total of 672 crystallization conditions, but were unable to obtain crystals for these mutants. Despite the mutants we successfully solved may not have significantly disrupted the structures of CDR-H3 loops, they have still provided valuable insights into the differences between MSA-based methods and MSA-free methods (such as IgFold) for antibody structure modeling.</p>
<p>We have further conducted a benchmarking study using two examples, PDBID 5U15 and 5U0R, both consisting of 18 residues in CDR-H3, to evaluate H3-OPT's performance in predicting mutated H3 loops. In the first case (target 5U15), AlphaFold2 failed to provide an accurate prediction of the extended orientation of the H3 loop, resulting in a less accurate prediction (Cα-RMSD = 10.25 Å) compared to H3-OPT (Cα-RMSD = 5.56 Å). In the second case (target 5U0R, a mutant of 5U15 in CDR3 loop), AlphaFold2 and H3-OPT achieved Cα-RMSDs of 6.10 Å and 4.25 Å, respectively. Additionally, the Cα-RMSDs of OmegaFold predictions were 8.05 Å and 9.84 Å, respectively. These findings suggest that both AlphaFold2 and OmegaFold effectively captured the mutation effects on conformations but achieved lower accuracy in predicting long CDR3 loops when compared to H3-OPT.</p>
<disp-quote content-type="editor-comment">
<p>1. The proposed method lacks a confidence score or a warning to help guide the users in moderate to challenging cases.</p>
</disp-quote>
<p>We appreciate your suggestions and we have trained a separate module to predict confidence scores. We used the MSE loss for confidence prediction, where the label error was calculated as the Cα deviation of each residue after alignment. The inputs of this module are the same as those used for H3-OPT, and it generates a confidence score ranging from 0 to 100.</p>
<disp-quote content-type="editor-comment">
<p>1. The fact that AF2 outperforms H3-OPT in some particular cases (e.g. Fig. 2c and Extended Data Fig. 3) raises the question: is there still room for improvements? It is not clear how sensible is H3-OPT to the defined parameters. In the same line, bench-marking against other available prediction algorithms, such as OmegaFold, could shed light on the actual accuracy limit.
We totally understand your concern. Many papers have suggested that PLM-based models are computationally efficient but may have unsatisfactory accuracy when high-resolution templates and MSA are available (Fast, accurate antibody structure prediction from deep learning on massive set of natural antibodies, Ruffolo, J. A. et al, 2023). However, the accuracy of AF2 decreased substantially when the MSA information is limited. Therefore, we directly retained high-confidence structures of AF2 and introduced a PSPM to improve the accuracy of the targets with long CDR-H3 loops and few sequence homologs. The improvement in mean Cα-RMSD demonstrated the room for accurately predicting CDR-H3 loops.</p>
</disp-quote>
<p>We also appreciate your kind comment on defined parameters. In fact, once a benchmark dataset is established, determining an optimal cutoff value through parameter searching can indeed further improve the performance of H3-OPT in CDR3 structure prediction. However, it is important to note that this optimal cutoff value heavily depends on the testing dataset being used. Therefore, we provide a recommended cutoff value and offer a program interface for users who wish to manually define the cutoff value based on their specific requirements. Here, we showed the average Cα-RMSDs of our test set under different confidence cutoffs and the results have been added in the text accordingly.</p>
<table-wrap id="sa4table1">
<label>Author response table 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-table1.jpg" mimetype="image"/>
</table-wrap>
<p>We also appreciate your reminder, and we have conducted a benchmark against OmegaFold. The results have been included in the manuscript (Fig 4a-b).</p>
<fig id="sa4fig3">
<label>Author response image 3.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-fig3.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #1 (Recommendations For The Authors):</bold></p>
<p>1. In Fig 3a, please also compare IgFold and H3-OPT (merge Fig. S2 into Fig 3a)</p>
<p>In Fig 3b, please separate Sub2 and Sub3, and add IgFold's performance.</p>
</disp-quote>
<p>Thank you very much for your professional advice. We have made revisions to the figures based on your suggestions.</p>
<fig id="sa4fig4">
<label>Author response image 4.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-fig4.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>1. For the three experimentally solved structures of anti-VEGF nanobodies, what are the sequence identities of the VH domain and H3 loop, compared to the best available template? What is the length of the H3 loop? Which category (Sub1/2/3) do the targets belong to? What is the performance of AF2 or AF2-Multimer on the three targets?</p>
</disp-quote>
<p>We feel sorry for these confusions. The sequence identities of the VH domain and H3 loop are 0.816 and 0.647, respectively, comparing with the best template. The CDR-H3 lengths of these nanobodies are both 17. According to our classification strategy, these nanobodies belong to Sub1. The confidence scores of these AlphaFold2 predicted loops were all higher than 0.8, and these loops were accepted as the outputs of H3-OPT by CBM.</p>
<disp-quote content-type="editor-comment">
<p>1. Is AF2-Multimer better than AF2, when using the sequences of antibody VH and antigen as input?</p>
</disp-quote>
<p>Thanks for your suggestions. Many papers have benchmarked AlphaFold2-Multimer for protein complex modeling and demonstrated the accuracy of AlphaFold2-Multimer on predicting the protein complex is far from satisfactory (Benchmarking AlphaFold for protein complex modeling reveals accuracy determinants, Rui Yin, et al., 2022). Additionally, there is no significantly difference between AlphaFold2 and AlphaFold2-Multimer on antibody modeling (Structural Modeling of Nanobodies: A Benchmark of State-of-the-Art Artificial Intelligence Programs, Mario S. Valdés-Tresanco, et al., 2023)</p>
<p>From the data perspective, we employed a non-redundant dataset for training and validation. Since these structures are valuable, considering the antigen sequence would reduce the size of our dataset, potentially leading to underfitting.</p>
<disp-quote content-type="editor-comment">
<p>1. For H3 loop grafting, I noticed that only identical target and template H3 sequences can trigger grafting (lines 348-349). How many such cases are in the test set?</p>
</disp-quote>
<p>We appreciate your comment from this perspective. There are thirty targets in our database with identical CDR-H3 templates.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #2 (Recommendations For The Authors):</bold></p>
<list list-type="bullet">
<list-item><p>It is not clear to me whether the three structures apparently used as experimental confirmation of the predictions have been determined previously in this study or not. This is a key aspect, as a retrospective validation does not have the same conceptual value as a prospective, a posteriori validation. Please note that different parts of the text suggest different things in this regard &quot;The model was validated by experimentally solving three structures of anti-VEGF nanobodies predicted by H3-OPT&quot; is not exactly the same as &quot;we then sought to validate H3-OPT using three experimentally determined structures of anti-VEGF nanobodies, including a wild-type (WT) and two mutant (Mut1 and Mut2) structures, that were recently deposited in protein data bank&quot;. The authors are kindly advised to make this point clear. By the way, &quot;protein data bank&quot; should be in upper case letters.</p>
</list-item></list>
</disp-quote>
<p>We gratefully thank you for your feedback and fully understand your concerns. To validate the performance of H3-OPT, we initially solved the structures of both the wild-type and mutants of anti-VEGF nanobodies and submitted these structures to Protein Data Bank. We have corrected “that were recently deposited in protein data bank” into “that were recently deposited in Protein Data Bank” in our revised manuscript.</p>
<disp-quote content-type="editor-comment">
<list list-type="bullet">
<list-item><p>It would be good to clarify the goal and importance of the binding affinity prediction, as it seems a bit disconnected from the rest of the paper. Also, it would be good to include the production MD runs as Sup, Mat.</p>
</list-item></list>
</disp-quote>
<p>Thanks for your valuable comment. We have added the following sentence in our manuscript to clarify the goal and importance of the molecular dynamics calculations: “Since affinity prediction plays a crucial role in antibody therapeutics engineering, we performed MD simulations to compare the differences in binding affinities between AF2-predicted complexes and H3-OPT-predicted complexes.”.
The details of production runs have been described in Method section.</p>
<disp-quote content-type="editor-comment">
<list list-type="bullet">
<list-item><p>Has any statistical test been performed to compare the mean Cα-RMSD values across the modeling approaches included in the benchmark exercise?</p>
</list-item></list>
</disp-quote>
<p>Thanks for this kind recommendation. We conducted a statistical test to assess the performance of different modeling approaches and demonstrated significant improvements with H3-OPT compared to other methods (p&lt;0.001).
Additionally, we have trained H3-OPT with five random seeds and compared mean Cα-RMSD values with all five models of AF2. Here, we showed the average Cα-RMSDs of H3-OPT and AlphaFold2.</p>
<table-wrap id="sa4table2">
<label>Author response table 1.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-table2.jpg" mimetype="image"/>
</table-wrap>
<disp-quote content-type="editor-comment">
<list list-type="bullet">
<list-item><p>In Fig. 2c-f, I think it would be adequate to make the ordering criterion of the data points explicit in the caption or the graph itself.</p>
</list-item></list>
</disp-quote>
<p>We appreciate your comment and suggestion. We have revised the graph in the manuscript accordingly.</p>
<fig id="sa4fig5">
<label>Author response image 5.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-fig5.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<list list-type="bullet">
<list-item><p>Please revise Figure S2 caption and/or its content. It is not clear, in parts b and c, which is the performance of H3-OPT. Why weren´t some other antibody-specific tools such as IgFold included in this comparison?</p>
</list-item></list>
</disp-quote>
<p>Thanks for your comments. The performance of H3-OPT is not included in Figure S2. Prior to training H3-OPT, we conducted several preliminary studies, and the detailed results are available in the supplementary sections. We showed that AlphaFold2 outperformed other methods (including AI-based methods and TBM methods) and produced sub-angstrom predictions in framework regions.
The comparison of IgFold with other methods was discussed in a previous work (Fast, accurate antibody structure prediction from deep learning on massive set of natural antibodies, Ruffolo, J. A. et al, 2023). In that study, we found that IgFold largely yielded results comparable to AlphaFold2 but with lower prediction cost. Additionally, we have also conducted a detailed comparison of CDR-H3 loops with IgFold in our main text.</p>
<disp-quote content-type="editor-comment">
<list list-type="bullet">
<list-item><p>It is stated that &quot;The relative binding affinities of the antigen-antibody complexes were evaluated using the Python script...&quot;. Which Python script?</p>
</list-item></list>
</disp-quote>
<p>Thank you for your comments, and I apologize for the confusion. This python script is a module of AMBER software, we have corrected “The relative binding affinities of the antigen-antibody complexes were evaluated using the python script” into “The relative binding affinities of the antigen-antibody complexes were evaluated using the MMPBSA module of AMBER software”.</p>
<disp-quote content-type="editor-comment">
<p><bold>Reviewer #3 (Recommendations For The Authors):</bold></p>
<p>Does H3-OPT improve the AF2 score on the CDR-H3? It would be interesting to see whether grafted and PSPM loops improve the pLDDT score by using for example AF2Rank [<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1103/PhysRevLett.129.238101">https://doi.org/10.1103/PhysRevLett.129.238101</ext-link>]. That could also be a way to include a confidence score into H3-OPT.</p>
</disp-quote>
<p>We are so grateful for your kind question. H3-OPT could not provide a confidence score for output in current version, so we did not know whether H3-OPT improve the AF2 score or not.</p>
<p>We appreciate your kind recommendations and have calculated the pLDDT scores of all models predicted by H3-OPT and AF2 using AF2Rank. We showed that the average of pLDDT scores of different predicted models did not match the results of Cα-RMSD values.</p>
<table-wrap id="sa4table3">
<label>Author response table 3.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-table3.jpg" mimetype="image"/>
</table-wrap>
<p>Therefore, we have trained a separate module to predict the confidence score of the optimized CDR-H3 loops. We hope that this module can provide users with reliable guidance on whether to use predicted CDR-H3 loops.</p>
<p>The test case of Nb PDB id. 8CWU is an interesting example where AF2 outperforms H3-OPT and PLMs. The top AF2 model according to ColabFold (using default options and no template [<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1038/s41592-022-01488-1]">https://doi.org/10.1038/s41592-022-01488-1]</ext-link>) shows a remarkably good model of the CDR-H3, explaining the low Ca-RMSD in the Extended Data Fig. 3. However, the pLDDT score of the 4 tip residues (out of 12), forming the hairpin of the CDR-H3 loop, pushes down the average value bellow the CBM cut-off of 80. I wonder if there is a lesson to learn from that test case. How sensible is H3-OPT to the CBM cut-off definition? Have the authors tried weighting the residue pLDDT score by some structural criteria before averaging? I guess AF2 may have less confidence in hydrophobic tip residues in exposed loops as the solvent context may not provide enough support for the pLDDT score.</p>
<p>Thanks for your valuable feedback. We showed the average Cα-RMSDs of our test set under different confidence cutoffs and the results have been added in the text accordingly.</p>
<table-wrap id="sa4table4">
<label>Author response table 4.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-table4.jpg" mimetype="image"/>
</table-wrap>
<p>We greatly appreciate your comment on this perspective. Inspired on your kind suggestions, we will explore the relationship between cutoff values and structural information in related work. Your feedback is highly valuable as it will contribute to the development of our approach.</p>
<p>A comparison against the new folding prediction method OmegaFold [<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/2022.07.21.500999">https://doi.org/10.1101/2022.07.21.500999</ext-link>] is missed. OmegaFold seems to outperform AF2, ESM, and IgFold among others in predicting the CDR-H3 loop conformation (See [<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/molecules28103991">https://doi.org/10.3390/molecules28103991</ext-link>] and [<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1101/2022.07.21.500999]">https://doi.org/10.1101/2022.07.21.500999]</ext-link>). Indeed, prediction of anti-VEGF Nb structure (PDB WT_QF_0329, chain B in supplementary data) by OmegaFold as implemented in ColabFold [<ext-link ext-link-type="uri" xlink:href="https://colab.research.google.com/github/sokrypton/ColabFold/blob/main/beta/omegafold.ipynb">https://colab.research.google.com/github/sokrypton/ColabFold/blob/main/beta/omegafold.ipynb</ext-link>] and setting 10 cycles, renders Ca-RMSD 1.472 Å for CDR-H3 (residues 98-115).</p>
<p>We appreciate your valuable suggestion. We have added the comparison against OmegaFold in our manuscript. The results have been included in the manuscript (Fig 4a-b).</p>
<fig id="sa4fig6">
<label>Author response image 6.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-fig6.jpg" mimetype="image"/>
</fig>
<p>In our test set, OmegaFold outperformed ESMFold in predicting the CDR-H3 loop conformation. However, it failed to match the accuracy of AF2, IgFold, and H3-OPT. We discussed the difference between MSA-based methods (such as AlphaFold2) and MSA-free methods (such as IgFold) in predicting CDR-H3 loops. Similarly, OmegaFold provided comparative results with HelixFold-Single and other MSA-free methods but still failed to match the accuracy of AlphaFold2 and H3-OPT on Sub1.</p>
<disp-quote content-type="editor-comment">
<p>The time-consuming step in H3-OPT is the AF2 prediction. However, most of the time is spent in modeling the mAb and Nb scaffolds, which are already very well predicted by PLMs (See Fig. 4 in [<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/molecules28103991]">https://doi.org/10.3390/molecules28103991]</ext-link>). Hence, why not use e.g. OmegaFold as the first step, whose score also correlates to the RMSD values [<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.3390/molecules28103991">https://doi.org/10.3390/molecules28103991</ext-link>]? If that fails, then use AF2 or grafting. Alternatively, use a PLM model to generate a template, remove/mask the CDR loops (at least CDR-H3), and pass it as a template to AF2 to optimize the structure with or without MSA (e.g. using AF2Rank).</p>
</disp-quote>
<p>Thanks for your professional feedbacks. It is really true that the speed of MSA searching limited the application of high-throughput structure prediction. Previous studies have demonstrated that the deep learning methods performed well on framework residues. We once tried to directly predict the conformations of CDR-H3 loops using PLM-based methods, but this initial version of H3-OPT lacking the CBM could not replicate the accuracy of AF2 in Sub1. Similarly, we showed that IgFold and OmegaFold also provide lower accuracy in Sub1 (average Cα-RMSD is 1.71 Å and 1.83 Å, respectively, whereas AF2 predicted an average of 1.07 Å). Therefore, The predictions of AlphaFold2 not only produce scaffolds but also provide the highest quality of CDR-H3 loops when high-resolution templates and MSA are available.</p>
<p>Thank you once again for your kind recommendation. In the current version of H3-OPT, we have highlighted the strengths of H3-OPT in combining the AF2 and PLM models in various scenarios. AF2 can provide accurate predictions for short loops with fewer than 10 amino acids, and PLM-based models show little or no improvement in such cases. In the next version of H3-OPT, as the first step, we plan to replace the AF2 models with other methods if any accurate MSA-free method becomes available in the future.</p>
<disp-quote content-type="editor-comment">
<p>Line 115: The statement &quot;IgFold provided higher accuracy in Sub3&quot; is not supported by Fig. 2a.</p>
</disp-quote>
<p>We are sorry for our carelessness. We have corrected “IgFold provided higher accuracy in Sub3” into “IgFold provided higher accuracy in Sub3 (Fig. 3a)”.</p>
<disp-quote content-type="editor-comment">
<p>Lines 195-203: What is the statistical significance of results in Fig 5a and 5b?</p>
</disp-quote>
<p>Thank you for your kind comments. The surface residues of AF2 models are significantly higher than those of H3-OPT models (p &lt; 0.005). In Fig. 5b, H3-OPT models predicted lower values than AF2 models in terms of various surface properties, including polarity (p &lt;0.05) and hydrophilicity (p &lt; 0.001).</p>
<disp-quote content-type="editor-comment">
<p>Lines 212-213: It is not easy to compare and quantify the differences between electrostatic maps in Fig. 5d. Showing a Dmap (e.g. mapmodel - mapexperiment) would be a better option. Additionally, there is no methodological description of how the maps were generated nor the scale of the represented potential.</p>
</disp-quote>
<p>Thank you for pointing this out. We have modified the figure (Fig. 5d) according to your kind recommendation and added following sentences to clarify the methodological description on the surface electrostatic potential:</p>
<p>“Analysis of surface electrostatic potential</p>
<p>We generated two-dimensional projections of CDR-H3 loop’s surface electrostatic potential using SURFMAP v2.0.0 (based on GitHub from February 2023: commit: e0d51a10debc96775468912ccd8de01e239d1900) with default parameters. The 2D surface maps were calculated by subtracting the surface projection of H3-OPT or AF2 predicted H3 loops to their native structures.”</p>
<fig id="sa4fig7">
<label>Author response image 7.</label>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-fig7.jpg" mimetype="image"/>
</fig>
<disp-quote content-type="editor-comment">
<p>Lines 237-240 and Table 2: What is the meaning of comparing the average free energy of the whole set? Why free energies should be comparable among test cases? I think the correct way is to compare the mean pair-to-pair difference to the experimental structure. Similarly, reporting a precision in the order of 0.01 kcal/mol seems too precise for the used methodology, what is the statistical significance of the results? Were sampling issues accounted for by performing replicates or longer MDs?</p>
</disp-quote>
<p>Thanks for your rigorous advice and pointing out these issues. We have modified the comparisons of free energies of different predicted methods and corrected the precision of these results. The average binding free energies of H3-OPT complexes is lower than AF2 predicted complexes, but there is no significant difference between these energies (p &gt;0.05).</p>
<table-wrap id="sa4table5">
<label>Author response table 4.</label>
<caption>
<title>Comparison of binding affinities obtained from MD simulations using AF2 and H3-OPT.</title>
</caption>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-table5.jpg" mimetype="image"/>
</table-wrap>
<p>Thanks for your comments on this perspective. Longer MD simulations often achieve better convergence for the average behavior of the system, while replicates provide insights into the variability and robustness of the results. In our manuscript, each MD simulation had a length of 100 nanoseconds, with the initial 90 nanoseconds dedicated to achieving system equilibrium, which was verified by monitoring RMSD (Root Mean Square Deviation). The remaining 10 nanoseconds of each simulation were used for the calculation of free energy. This approach allowed us to balance the need for extensive sampling with the verification of system stability.</p>
<disp-quote content-type="editor-comment">
<p>Regarding MD simulations for CDR-H3 refinement, its successful application highly depends on the starting conformation, the force field, and the sampling strategy [<ext-link ext-link-type="uri" xlink:href="https://doi.org/10.1021/acs.jctc.1c00341">https://doi.org/10.1021/acs.jctc.1c00341</ext-link>]. In particular, the applied plan MD seems a very limited strategy (there is not much information about the simulated times in the supplementary material). Similarly, local structure optimizations with QM methods are not expected to improve a starting conformation that is far from the experimental conformation.</p>
</disp-quote>
<p>Thank you very much for your valuable feedback. We fully agree with your insights regarding the limitations of MD simulations. Before training H3-OPT, we showed the challenge of accurately predicting CDR-H3 structures. We then tried to optimize the CDR-H3 loops by computational tools, such as MD simulations and QM methods (detailed information of MD simulations is provided in the main text). Unfortunately, these methods were not expected to improve the accuracy of AF2 predicted CDR-H3 loops. These results showed that MD simulations and QM methods not only are time-consuming, but also failed to optimize the CDR-H3 loops. Therefore, we developed H3-OPT to tackle these issues and improve the accuracy of CDR3-H3 for the development of antibody therapeutics.</p>
<disp-quote content-type="editor-comment">
<p>Text improvements</p>
<p>Relevant statistical and methodological parameters are presented in a dispersed manner throughout the text. For example, the number of structures in test, training, and validation datasets is first presented in the caption of Fig. 4. Similarly, the sequence identity % to define redundancy is defined in the caption of Fig. 1a instead of lines 87-88, where authors define &quot;we constructed a non-redundant dataset with 1286 high-resolution (&lt;2.5 Å)&quot;. Is the sequence redundancy for the CDR-H3 or the whole mAb/Nb?</p>
</disp-quote>
<p>Thank you for pointing out these issues. We have added the number of structures in each subgroup in the caption of Fig. 1a: “Clustering of the filtered, high-resolution structures yielded three datasets for training (n = 1021), validation (n = 134), and testing (n = 131).” and corrected “As data quality has large effects on prediction accuracy, we constructed a non-redundant dataset with 1286 high-resolution (&lt;2.5 Å) antibody structures from SAbDab” into “As data quality has large effects on prediction accuracy, we constructed a non-redundant dataset (sequence identity &lt; 0.8) with 1286 high-resolution (&lt;2.5 Å) antibody structures from SAbDab” in the revised manuscript.
The sequence redundancy applies to the whole mAb/Nb.</p>
<disp-quote content-type="editor-comment">
<p>The description of ablation studies is not easy to follow. For example, what does removing TGM mean in practical terms (e.g. only AF2 is used, or PSPM is applied if AF2 score &lt; 80)? Similarly, what does removing CBM mean in practical terms (e.g. all AF2 models are optimized by PSPM, and no grafting is done)?
Thanks for your comments and suggestions. We have corrected “d, Differences in H3-OPT accuracy without the template module. e, Differences in H3-OPT accuracy without the CBM. f, Differences in H3-OPT accuracy without the TGM.” into “d, Differences in H3-OPT accuracy without the template module. This ablation study means only PSPM is used. e, Differences in H3-OPT accuracy without the CBM. This ablation study means input loop is optimized by TGM and PSPM. f, Differences in H3-OPT accuracy without the TGM. This ablation study means input loop is optimized by CBM and PSPM.”.</p>
<p>Authors should report the values in the text using the same statistical descriptor that is used in the figures to help the analysis by the reader. For example, in lines 223-224 a precision score of 0.75 for H3-OPT is reported in the text (I assume this is the average value), while the median of ~0.85 is shown in Fig. 6a.</p>
</disp-quote>
<p>Thank you for your careful checks. We have corrected “After identifying the contact residues of antigens by H3-OPT, we found that H3-OPT could substantially outperform AF2 (Fig. 6a), with a precision of 0.75 and accuracy of 0.94 compared to 0.66 precision and 0.92 accuracy of AF2.” into “After identifying the contact residues of antigens by H3-OPT, we found that H3-OPT could substantially outperform AF2 (Fig. 6a), with a median precision of 0.83 and accuracy of 0.97 compared to 0.64 precision and 0.95 accuracy of AF2.” in proper place of manuscript.</p>
<disp-quote content-type="editor-comment">
<p>Minor corrections</p>
<p>Lines 91-94: What do length values mean? e.g. is 0-2 Å the RMSD from the experimental structure?</p>
</disp-quote>
<p>We appreciate your comment and apologize for any confusion. The RMSD value is actually from experimental structure. The RMSD value evaluates the deviation of predicted CDR-H3 loop from native structure and also represents the degree of prediction difficulty in AlphaFold2 predictions. We have added following sentence in the proper place of the revised manuscript: “(RMSD, a measure of the difference between the predicted structure and an experimental or reference structure)”.</p>
<disp-quote content-type="editor-comment">
<p>Line 120: is the &quot;AF2 confidence score&quot; for the full-length or CDR-H3?</p>
</disp-quote>
<p>We gratefully appreciate for your valuable comment and have corrected “Interestingly, we observed that AF2 confidence score shared a strong negative correlation with Cα-RMSDs (Pearson correlation coefficient =-0.67 (Fig. 2b)” into “Interestingly, we observed that AF2 confidence score of CDR-H3 shared a strong negative correlation with Cα-RMSDs (Pearson correlation coefficient =-0.67 (Fig. 2b)” in the revised manuscript.</p>
<disp-quote content-type="editor-comment">
<p>Line 166: Do authors mean &quot;Taken&quot; instead of &quot;Token&quot;?</p>
</disp-quote>
<p>We are really sorry for our careless mistakes. Thank you for your reminder.</p>
<disp-quote content-type="editor-comment">
<p>Line 258: Reference to Fig. 1 seems wrong, do authors mean Fig. 4?</p>
</disp-quote>
<p>We sincerely thank the reviewer for careful reading. As suggested by the reviewer, we have corrected the “Fig. 1” into “Fig. 4”.</p>
<fig id="sa4fig8">
<label>Author response image 7.</label>
<caption>
<title>Point out which plot corresponds to AF2 and which one to H3-OPT</title>
</caption>
<graphic mime-subtype="jpg" xlink:href="elife-91512-sa4-fig8.jpg" mimetype="image"/>
</fig>
<p>Thanks for pointing out this issue. We have added the legends of this figure in the proper positions in our manuscript.</p>
</body>
</sub-article>
</article>